var Vie=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var MVe=Vie((Ts,Es)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function o(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=o(c);fetch(c.href,u)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function XO(e,t){const o=new Set(e.split(","));return i=>o.has(i)}const rr={},Xg=[],co=()=>{},Gie=()=>!1,VE=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),QO=e=>e.startsWith("onUpdate:"),Ar=Object.assign,ZO=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},Bie=Object.prototype.hasOwnProperty,qn=(e,t)=>Bie.call(e,t),At=Array.isArray,Qg=e=>nI(e)==="[object Map]",GE=e=>nI(e)==="[object Set]",zf=e=>nI(e)==="[object Date]",tn=e=>typeof e=="function",on=e=>typeof e=="string",Mc=e=>typeof e=="symbol",En=e=>e!==null&&typeof e=="object",b0=e=>(En(e)||tn(e))&&tn(e.then)&&tn(e.catch),b$=Object.prototype.toString,nI=e=>b$.call(e),IT=e=>nI(e).slice(8,-1),nE=e=>nI(e)==="[object Object]",eN=e=>on(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Xy=XO(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),BE=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},$ie=/-(\w)/g,na=BE(e=>e.replace($ie,(t,o)=>o?o.toUpperCase():"")),Hie=/\B([A-Z])/g,Sd=BE(e=>e.replace(Hie,"-$1").toLowerCase()),oI=BE(e=>e.charAt(0).toUpperCase()+e.slice(1)),bT=BE(e=>e?`on${oI(e)}`:""),pd=(e,t)=>!Object.is(e,t),CT=(e,t)=>{for(let o=0;o<e.length;o++)e[o](t)},C$=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},vD=e=>{const t=parseFloat(e);return isNaN(t)?e:t},qie=e=>{const t=on(e)?Number(e):NaN;return isNaN(t)?e:t};let hG;const S$=()=>hG||(hG=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ht(e){if(At(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],c=on(i)?jie(i):Ht(i);if(c)for(const u in c)t[u]=c[u]}return t}else if(on(e)||En(e))return e}const Kie=/;(?![^(]*\))/g,zie=/:([^]+)/,Wie=/\/\*[^]*?\*\//g;function jie(e){const t={};return e.replace(Wie,"").split(Kie).forEach(o=>{if(o){const i=o.split(zie);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function ne(e){let t="";if(on(e))t=e;else if(At(e))for(let o=0;o<e.length;o++){const i=ne(e[o]);i&&(t+=i+" ")}else if(En(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}function bc(e){if(!e)return null;let{class:t,style:o}=e;return t&&!on(t)&&(e.class=ne(t)),o&&(e.style=Ht(o)),e}const Yie="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Jie=XO(Yie);function T$(e){return!!e||e===""}function Xie(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=um(e[i],t[i]);return o}function um(e,t){if(e===t)return!0;let o=zf(e),i=zf(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=Mc(e),i=Mc(t),o||i)return e===t;if(o=At(e),i=At(t),o||i)return o&&i?Xie(e,t):!1;if(o=En(e),i=En(t),o||i){if(!o||!i)return!1;const c=Object.keys(e).length,u=Object.keys(t).length;if(c!==u)return!1;for(const f in e){const p=e.hasOwnProperty(f),m=t.hasOwnProperty(f);if(p&&!m||!p&&m||!um(e[f],t[f]))return!1}}return String(e)===String(t)}function E$(e,t){return e.findIndex(o=>um(o,t))}const pt=e=>on(e)?e:e==null?"":At(e)||En(e)&&(e.toString===b$||!tn(e.toString))?JSON.stringify(e,M$,2):String(e),M$=(e,t)=>t&&t.__v_isRef?M$(e,t.value):Qg(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,c],u)=>(o[sw(i,u)+" =>"]=c,o),{})}:GE(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>sw(o))}:Mc(t)?sw(t):En(t)&&!At(t)&&!nE(t)?String(t):t,sw=(e,t="")=>{var o;return Mc(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bs;class k${constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=bs,!t&&bs&&(this.index=(bs.scopes||(bs.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const o=bs;try{return bs=this,t()}finally{bs=o}}}on(){bs=this}off(){bs=this.parent}stop(t){if(this._active){let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.scopes)for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);if(!this.detached&&this.parent&&!t){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0,this._active=!1}}}function Qie(e){return new k$(e)}function Zie(e,t=bs){t&&t.active&&t.effects.push(e)}function A$(){return bs}function R$(e){bs&&bs.cleanups.push(e)}let Ff;class tN{constructor(t,o,i,c){this.fn=t,this.trigger=o,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Zie(this,c)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Td();for(let t=0;t<this._depsLength;t++){const o=this.deps[t];if(o.computed&&(ese(o.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Ed()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=ad,o=Ff;try{return ad=!0,Ff=this,this._runnings++,fG(this),this.fn()}finally{pG(this),this._runnings--,Ff=o,ad=t}}stop(){this.active&&(fG(this),pG(this),this.onStop&&this.onStop(),this.active=!1)}}function ese(e){return e.value}function fG(e){e._trackId++,e._depsLength=0}function pG(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)w$(e.deps[t],e);e.deps.length=e._depsLength}}function w$(e,t){const o=e.get(t);o!==void 0&&t._trackId!==o&&(e.delete(t),e.size===0&&e.cleanup())}let ad=!0,_D=0;const D$=[];function Td(){D$.push(ad),ad=!1}function Ed(){const e=D$.pop();ad=e===void 0?!0:e}function nN(){_D++}function oN(){for(_D--;!_D&&yD.length;)yD.shift()()}function O$(e,t,o){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&w$(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const yD=[];function N$(e,t,o){nN();for(const i of e.keys()){let c;i._dirtyLevel<t&&(c??(c=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(c??(c=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&yD.push(i.scheduler)))}oN()}const L$=(e,t)=>{const o=new Map;return o.cleanup=e,o.computed=t,o},oE=new WeakMap,Vf=Symbol(""),ID=Symbol("");function ss(e,t,o){if(ad&&Ff){let i=oE.get(e);i||oE.set(e,i=new Map);let c=i.get(o);c||i.set(o,c=L$(()=>i.delete(o))),O$(Ff,c)}}function Tc(e,t,o,i,c,u){const f=oE.get(e);if(!f)return;let p=[];if(t==="clear")p=[...f.values()];else if(o==="length"&&At(e)){const m=Number(i);f.forEach((_,b)=>{(b==="length"||!Mc(b)&&b>=m)&&p.push(_)})}else switch(o!==void 0&&p.push(f.get(o)),t){case"add":At(e)?eN(o)&&p.push(f.get("length")):(p.push(f.get(Vf)),Qg(e)&&p.push(f.get(ID)));break;case"delete":At(e)||(p.push(f.get(Vf)),Qg(e)&&p.push(f.get(ID)));break;case"set":Qg(e)&&p.push(f.get(Vf));break}nN();for(const m of p)m&&N$(m,4);oN()}function tse(e,t){const o=oE.get(e);return o&&o.get(t)}const nse=XO("__proto__,__v_isRef,__isVue"),P$=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Mc)),gG=ose();function ose(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...o){const i=fo(this);for(let u=0,f=this.length;u<f;u++)ss(i,"get",u+"");const c=i[t](...o);return c===-1||c===!1?i[t](...o.map(fo)):c}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...o){Td(),nN();const i=fo(this)[t].apply(this,o);return oN(),Ed(),i}}),e}function rse(e){Mc(e)||(e=String(e));const t=fo(this);return ss(t,"has",e),t.hasOwnProperty(e)}class U${constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){const c=this._isReadonly,u=this._isShallow;if(o==="__v_isReactive")return!c;if(o==="__v_isReadonly")return c;if(o==="__v_isShallow")return u;if(o==="__v_raw")return i===(c?u?vse:G$:u?V$:F$).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const f=At(t);if(!c){if(f&&qn(gG,o))return Reflect.get(gG,o,i);if(o==="hasOwnProperty")return rse}const p=Reflect.get(t,o,i);return(Mc(o)?P$.has(o):nse(o))||(c||ss(t,"get",o),u)?p:No(p)?f&&eN(o)?p:p.value:En(p)?c?Nm(p):Zn(p):p}}class x$ extends U${constructor(t=!1){super(!1,t)}set(t,o,i,c){let u=t[o];if(!this._isShallow){const m=C0(u);if(!rE(i)&&!C0(i)&&(u=fo(u),i=fo(i)),!At(t)&&No(u)&&!No(i))return m?!1:(u.value=i,!0)}const f=At(t)&&eN(o)?Number(o)<t.length:qn(t,o),p=Reflect.set(t,o,i,c);return t===fo(c)&&(f?pd(i,u)&&Tc(t,"set",o,i):Tc(t,"add",o,i)),p}deleteProperty(t,o){const i=qn(t,o);t[o];const c=Reflect.deleteProperty(t,o);return c&&i&&Tc(t,"delete",o,void 0),c}has(t,o){const i=Reflect.has(t,o);return(!Mc(o)||!P$.has(o))&&ss(t,"has",o),i}ownKeys(t){return ss(t,"iterate",At(t)?"length":Vf),Reflect.ownKeys(t)}}class ise extends U${constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const sse=new x$,ase=new ise,lse=new x$(!0),rN=e=>e,$E=e=>Reflect.getPrototypeOf(e);function FS(e,t,o=!1,i=!1){e=e.__v_raw;const c=fo(e),u=fo(t);o||(pd(t,u)&&ss(c,"get",t),ss(c,"get",u));const{has:f}=$E(c),p=i?rN:o?lN:S0;if(f.call(c,t))return p(e.get(t));if(f.call(c,u))return p(e.get(u));e!==c&&e.get(t)}function VS(e,t=!1){const o=this.__v_raw,i=fo(o),c=fo(e);return t||(pd(e,c)&&ss(i,"has",e),ss(i,"has",c)),e===c?o.has(e):o.has(e)||o.has(c)}function GS(e,t=!1){return e=e.__v_raw,!t&&ss(fo(e),"iterate",Vf),Reflect.get(e,"size",e)}function mG(e){e=fo(e);const t=fo(this);return $E(t).has.call(t,e)||(t.add(e),Tc(t,"add",e,e)),this}function vG(e,t){t=fo(t);const o=fo(this),{has:i,get:c}=$E(o);let u=i.call(o,e);u||(e=fo(e),u=i.call(o,e));const f=c.call(o,e);return o.set(e,t),u?pd(t,f)&&Tc(o,"set",e,t):Tc(o,"add",e,t),this}function _G(e){const t=fo(this),{has:o,get:i}=$E(t);let c=o.call(t,e);c||(e=fo(e),c=o.call(t,e)),i&&i.call(t,e);const u=t.delete(e);return c&&Tc(t,"delete",e,void 0),u}function yG(){const e=fo(this),t=e.size!==0,o=e.clear();return t&&Tc(e,"clear",void 0,void 0),o}function BS(e,t){return function(i,c){const u=this,f=u.__v_raw,p=fo(f),m=t?rN:e?lN:S0;return!e&&ss(p,"iterate",Vf),f.forEach((_,b)=>i.call(c,m(_),m(b),u))}}function $S(e,t,o){return function(...i){const c=this.__v_raw,u=fo(c),f=Qg(u),p=e==="entries"||e===Symbol.iterator&&f,m=e==="keys"&&f,_=c[e](...i),b=o?rN:t?lN:S0;return!t&&ss(u,"iterate",m?ID:Vf),{next(){const{value:S,done:T}=_.next();return T?{value:S,done:T}:{value:p?[b(S[0]),b(S[1])]:b(S),done:T}},[Symbol.iterator](){return this}}}}function Uu(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function cse(){const e={get(u){return FS(this,u)},get size(){return GS(this)},has:VS,add:mG,set:vG,delete:_G,clear:yG,forEach:BS(!1,!1)},t={get(u){return FS(this,u,!1,!0)},get size(){return GS(this)},has:VS,add:mG,set:vG,delete:_G,clear:yG,forEach:BS(!1,!0)},o={get(u){return FS(this,u,!0)},get size(){return GS(this,!0)},has(u){return VS.call(this,u,!0)},add:Uu("add"),set:Uu("set"),delete:Uu("delete"),clear:Uu("clear"),forEach:BS(!0,!1)},i={get(u){return FS(this,u,!0,!0)},get size(){return GS(this,!0)},has(u){return VS.call(this,u,!0)},add:Uu("add"),set:Uu("set"),delete:Uu("delete"),clear:Uu("clear"),forEach:BS(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{e[u]=$S(u,!1,!1),o[u]=$S(u,!0,!1),t[u]=$S(u,!1,!0),i[u]=$S(u,!0,!0)}),[e,o,t,i]}const[use,dse,hse,fse]=cse();function iN(e,t){const o=t?e?fse:hse:e?dse:use;return(i,c,u)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?i:Reflect.get(qn(o,c)&&c in i?o:i,c,u)}const pse={get:iN(!1,!1)},gse={get:iN(!1,!0)},mse={get:iN(!0,!1)},F$=new WeakMap,V$=new WeakMap,G$=new WeakMap,vse=new WeakMap;function _se(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yse(e){return e.__v_skip||!Object.isExtensible(e)?0:_se(IT(e))}function Zn(e){return C0(e)?e:aN(e,!1,sse,pse,F$)}function sN(e){return aN(e,!1,lse,gse,V$)}function Nm(e){return aN(e,!0,ase,mse,G$)}function aN(e,t,o,i,c){if(!En(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const u=c.get(e);if(u)return u;const f=yse(e);if(f===0)return e;const p=new Proxy(e,f===2?i:o);return c.set(e,p),p}function Qy(e){return C0(e)?Qy(e.__v_raw):!!(e&&e.__v_isReactive)}function C0(e){return!!(e&&e.__v_isReadonly)}function rE(e){return!!(e&&e.__v_isShallow)}function B$(e){return e?!!e.__v_raw:!1}function fo(e){const t=e&&e.__v_raw;return t?fo(t):e}function Zg(e){return Object.isExtensible(e)&&C$(e,"__v_skip",!0),e}const S0=e=>En(e)?Zn(e):e,lN=e=>En(e)?Nm(e):e;class $${constructor(t,o,i,c){this.getter=t,this._setter=o,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new tN(()=>t(this._value),()=>Zy(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=i}get value(){const t=fo(this);return(!t._cacheable||t.effect.dirty)&&pd(t._value,t._value=t.effect.run())&&Zy(t,4),cN(t),t.effect._dirtyLevel>=2&&Zy(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function Ise(e,t,o=!1){let i,c;const u=tn(e);return u?(i=e,c=co):(i=e.get,c=e.set),new $$(i,c,u||!c,o)}function cN(e){var t;ad&&Ff&&(e=fo(e),O$(Ff,(t=e.dep)!=null?t:e.dep=L$(()=>e.dep=void 0,e instanceof $$?e:void 0)))}function Zy(e,t=4,o){e=fo(e);const i=e.dep;i&&N$(i,t)}function No(e){return!!(e&&e.__v_isRef===!0)}function ae(e){return H$(e,!1)}function Do(e){return H$(e,!0)}function H$(e,t){return No(e)?e:new bse(e,t)}class bse{constructor(t,o){this.__v_isShallow=o,this.dep=void 0,this.__v_isRef=!0,this._rawValue=o?t:fo(t),this._value=o?t:S0(t)}get value(){return cN(this),this._value}set value(t){const o=this.__v_isShallow||rE(t)||C0(t);t=o?t:fo(t),pd(t,this._rawValue)&&(this._rawValue=t,this._value=o?t:S0(t),Zy(this,4))}}function y(e){return No(e)?e.value:e}const Cse={get:(e,t,o)=>y(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const c=e[t];return No(c)&&!No(o)?(c.value=o,!0):Reflect.set(e,t,o,i)}};function q$(e){return Qy(e)?e:new Proxy(e,Cse)}class Sse{constructor(t){this.dep=void 0,this.__v_isRef=!0;const{get:o,set:i}=t(()=>cN(this),()=>Zy(this));this._get=o,this._set=i}get value(){return this._get()}set value(t){this._set(t)}}function Tse(e){return new Sse(e)}function ei(e){const t=At(e)?new Array(e.length):{};for(const o in e)t[o]=K$(e,o);return t}class Ese{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return tse(fo(this._object),this._key)}}class Mse{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Io(e,t,o){return No(e)?e:tn(e)?new Mse(e):En(e)&&arguments.length>1?K$(e,t,o):ae(e)}function K$(e,t,o){const i=e[t];return No(i)?i:new Ese(e,t,o)}/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ld(e,t,o,i){try{return i?e(...i):e()}catch(c){HE(c,t,o)}}function Qs(e,t,o,i){if(tn(e)){const c=ld(e,t,o,i);return c&&b0(c)&&c.catch(u=>{HE(u,t,o)}),c}if(At(e)){const c=[];for(let u=0;u<e.length;u++)c.push(Qs(e[u],t,o,i));return c}}function HE(e,t,o,i=!0){const c=t?t.vnode:null;if(t){let u=t.parent;const f=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const _=u.ec;if(_){for(let b=0;b<_.length;b++)if(_[b](e,f,p)===!1)return}u=u.parent}const m=t.appContext.config.errorHandler;if(m){Td(),ld(m,null,10,[e,f,p]),Ed();return}}kse(e,o,c,i)}function kse(e,t,o,i=!0){console.error(e)}let T0=!1,bD=!1;const Ei=[];let gl=0;const em=[];let ju=null,pf=0;const z$=Promise.resolve();let uN=null;function zt(e){const t=uN||z$;return e?t.then(this?e.bind(this):e):t}function Ase(e){let t=gl+1,o=Ei.length;for(;t<o;){const i=t+o>>>1,c=Ei[i],u=E0(c);u<e||u===e&&c.pre?t=i+1:o=i}return t}function dN(e){(!Ei.length||!Ei.includes(e,T0&&e.allowRecurse?gl+1:gl))&&(e.id==null?Ei.push(e):Ei.splice(Ase(e.id),0,e),W$())}function W$(){!T0&&!bD&&(bD=!0,uN=z$.then(Y$))}function Rse(e){const t=Ei.indexOf(e);t>gl&&Ei.splice(t,1)}function wse(e){At(e)?em.push(...e):(!ju||!ju.includes(e,e.allowRecurse?pf+1:pf))&&em.push(e),W$()}function IG(e,t,o=T0?gl+1:0){for(;o<Ei.length;o++){const i=Ei[o];if(i&&i.pre){if(e&&i.id!==e.uid)continue;Ei.splice(o,1),o--,i()}}}function j$(e){if(em.length){const t=[...new Set(em)].sort((o,i)=>E0(o)-E0(i));if(em.length=0,ju){ju.push(...t);return}for(ju=t,pf=0;pf<ju.length;pf++)ju[pf]();ju=null,pf=0}}const E0=e=>e.id==null?1/0:e.id,Dse=(e,t)=>{const o=E0(e)-E0(t);if(o===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return o};function Y$(e){bD=!1,T0=!0,Ei.sort(Dse);try{for(gl=0;gl<Ei.length;gl++){const t=Ei[gl];t&&t.active!==!1&&ld(t,null,14)}}finally{gl=0,Ei.length=0,j$(),T0=!1,uN=null,(Ei.length||em.length)&&Y$()}}function Ose(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||rr;let c=o;const u=t.startsWith("update:"),f=u&&t.slice(7);if(f&&f in i){const b=`${f==="modelValue"?"model":f}Modifiers`,{number:S,trim:T}=i[b]||rr;T&&(c=o.map(M=>on(M)?M.trim():M)),S&&(c=o.map(vD))}let p,m=i[p=bT(t)]||i[p=bT(na(t))];!m&&u&&(m=i[p=bT(Sd(t))]),m&&Qs(m,e,6,c);const _=i[p+"Once"];if(_){if(!e.emitted)e.emitted={};else if(e.emitted[p])return;e.emitted[p]=!0,Qs(_,e,6,c)}}function J$(e,t,o=!1){const i=t.emitsCache,c=i.get(e);if(c!==void 0)return c;const u=e.emits;let f={},p=!1;if(!tn(e)){const m=_=>{const b=J$(_,t,!0);b&&(p=!0,Ar(f,b))};!o&&t.mixins.length&&t.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}return!u&&!p?(En(e)&&i.set(e,null),null):(At(u)?u.forEach(m=>f[m]=null):Ar(f,u),En(e)&&i.set(e,f),f)}function qE(e,t){return!e||!VE(t)?!1:(t=t.slice(2).replace(/Once$/,""),qn(e,t[0].toLowerCase()+t.slice(1))||qn(e,Sd(t))||qn(e,t))}let Br=null,X$=null;function iE(e){const t=Br;return Br=e,X$=e&&e.type.__scopeId||null,t}function Ne(e,t=Br,o){if(!t||e._n)return e;const i=(...c)=>{i._d&&LG(-1);const u=iE(t);let f;try{f=e(...c)}finally{iE(u),i._d&&LG(1)}return f};return i._n=!0,i._c=!0,i._d=!0,i}function aw(e){const{type:t,vnode:o,proxy:i,withProxy:c,propsOptions:[u],slots:f,attrs:p,emit:m,render:_,renderCache:b,props:S,data:T,setupState:M,ctx:R,inheritAttrs:E}=e,N=iE(e);let D,x;try{if(o.shapeFlag&4){const F=c||i,H=F;D=pl(_.call(H,F,b,S,M,T,R)),x=p}else{const F=t;D=pl(F.length>1?F(S,{attrs:p,slots:f,emit:m}):F(S,null)),x=t.props?p:Nse(p)}}catch(F){r0.length=0,HE(F,e,1),D=Me(Mi)}let L=D;if(x&&E!==!1){const F=Object.keys(x),{shapeFlag:H}=L;F.length&&H&7&&(u&&F.some(QO)&&(x=Lse(x,u)),L=Ac(L,x,!1,!0))}return o.dirs&&(L=Ac(L,null,!1,!0),L.dirs=L.dirs?L.dirs.concat(o.dirs):o.dirs),o.transition&&(L.transition=o.transition),D=L,iE(N),D}const Nse=e=>{let t;for(const o in e)(o==="class"||o==="style"||VE(o))&&((t||(t={}))[o]=e[o]);return t},Lse=(e,t)=>{const o={};for(const i in e)(!QO(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function Pse(e,t,o){const{props:i,children:c,component:u}=e,{props:f,children:p,patchFlag:m}=t,_=u.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&m>=0){if(m&1024)return!0;if(m&16)return i?bG(i,f,_):!!f;if(m&8){const b=t.dynamicProps;for(let S=0;S<b.length;S++){const T=b[S];if(f[T]!==i[T]&&!qE(_,T))return!0}}}else return(c||p)&&(!p||!p.$stable)?!0:i===f?!1:i?f?bG(i,f,_):!0:!!f;return!1}function bG(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let c=0;c<i.length;c++){const u=i[c];if(t[u]!==e[u]&&!qE(o,u))return!0}return!1}function Use({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const hN="components",xse="directives";function pn(e,t){return fN(hN,e,!0,t)||e}const Q$=Symbol.for("v-ndc");function wn(e){return on(e)?fN(hN,e,!1)||e:e||Q$}function KE(e){return fN(xse,e)}function fN(e,t,o=!0,i=!1){const c=Br||ui;if(c){const u=c.type;if(e===hN){const p=Mae(u,!1);if(p&&(p===t||p===na(t)||p===oI(na(t))))return u}const f=CG(c[e]||u[e],t)||CG(c.appContext[e],t);return!f&&i?u:f}}function CG(e,t){return e&&(e[t]||e[na(t)]||e[oI(na(t))])}const Fse=e=>e.__isSuspense;function Vse(e,t){t&&t.pendingBranch?At(e)?t.effects.push(...e):t.effects.push(e):wse(e)}const Gse=Symbol.for("v-scx"),Bse=()=>wt(Gse);function hi(e,t){return pN(e,null,t)}const HS={};function rt(e,t,o){return pN(e,t,o)}function pN(e,t,{immediate:o,deep:i,flush:c,once:u,onTrack:f,onTrigger:p}=rr){if(t&&u){const B=t;t=(...z)=>{B(...z),H()}}const m=ui,_=B=>i===!0?B:If(B,i===!1?1:void 0);let b,S=!1,T=!1;if(No(e)?(b=()=>e.value,S=rE(e)):Qy(e)?(b=()=>_(e),S=!0):At(e)?(T=!0,S=e.some(B=>Qy(B)||rE(B)),b=()=>e.map(B=>{if(No(B))return B.value;if(Qy(B))return _(B);if(tn(B))return ld(B,m,2)})):tn(e)?t?b=()=>ld(e,m,2):b=()=>(M&&M(),Qs(e,m,3,[R])):b=co,t&&i){const B=b;b=()=>If(B())}let M,R=B=>{M=L.onStop=()=>{ld(B,m,4),M=L.onStop=void 0}},E;if(YE)if(R=co,t?o&&Qs(t,m,3,[b(),T?[]:void 0,R]):b(),c==="sync"){const B=Bse();E=B.__watcherHandles||(B.__watcherHandles=[])}else return co;let N=T?new Array(e.length).fill(HS):HS;const D=()=>{if(!(!L.active||!L.dirty))if(t){const B=L.run();(i||S||(T?B.some((z,W)=>pd(z,N[W])):pd(B,N)))&&(M&&M(),Qs(t,m,3,[B,N===HS?void 0:T&&N[0]===HS?[]:N,R]),N=B)}else L.run()};D.allowRecurse=!!t;let x;c==="sync"?x=D:c==="post"?x=()=>es(D,m&&m.suspense):(D.pre=!0,m&&(D.id=m.uid),x=()=>dN(D));const L=new tN(b,co,x),F=A$(),H=()=>{L.stop(),F&&ZO(F.effects,L)};return t?o?D():N=L.run():c==="post"?es(L.run.bind(L),m&&m.suspense):L.run(),E&&E.push(H),H}function $se(e,t,o){const i=this.proxy,c=on(e)?e.includes(".")?Z$(i,e):()=>i[e]:e.bind(i,i);let u;tn(t)?u=t:(u=t.handler,o=t);const f=rI(this),p=pN(c,u.bind(i),o);return f(),p}function Z$(e,t){const o=t.split(".");return()=>{let i=e;for(let c=0;c<o.length&&i;c++)i=i[o[c]];return i}}function If(e,t=1/0,o){if(t<=0||!En(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),t--,No(e))If(e.value,t,o);else if(At(e))for(let i=0;i<e.length;i++)If(e[i],t,o);else if(GE(e)||Qg(e))e.forEach(i=>{If(i,t,o)});else if(nE(e))for(const i in e)If(e[i],t,o);return e}function hn(e,t){if(Br===null)return e;const o=JE(Br)||Br.proxy,i=e.dirs||(e.dirs=[]);for(let c=0;c<t.length;c++){let[u,f,p,m=rr]=t[c];u&&(tn(u)&&(u={mounted:u,updated:u}),u.deep&&If(f),i.push({dir:u,instance:o,value:f,oldValue:void 0,arg:p,modifiers:m}))}return e}function rf(e,t,o,i){const c=e.dirs,u=t&&t.dirs;for(let f=0;f<c.length;f++){const p=c[f];u&&(p.oldValue=u[f].value);let m=p.dir[i];m&&(Td(),Qs(m,o,8,[e.el,p,e,t]),Ed())}}const Yu=Symbol("_leaveCb"),qS=Symbol("_enterCb");function eH(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return fn(()=>{e.isMounted=!0}),Ro(()=>{e.isUnmounting=!0}),e}const $s=[Function,Array],tH={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$s,onEnter:$s,onAfterEnter:$s,onEnterCancelled:$s,onBeforeLeave:$s,onLeave:$s,onAfterLeave:$s,onLeaveCancelled:$s,onBeforeAppear:$s,onAppear:$s,onAfterAppear:$s,onAppearCancelled:$s},Hse={name:"BaseTransition",props:tH,setup(e,{slots:t}){const o=In(),i=eH();return()=>{const c=t.default&&gN(t.default(),!0);if(!c||!c.length)return;let u=c[0];if(c.length>1){for(const T of c)if(T.type!==Mi){u=T;break}}const f=fo(e),{mode:p}=f;if(i.isLeaving)return lw(u);const m=SG(u);if(!m)return lw(u);const _=M0(m,f,i,o);k0(m,_);const b=o.subTree,S=b&&SG(b);if(S&&S.type!==Mi&&!gf(m,S)){const T=M0(S,f,i,o);if(k0(S,T),p==="out-in"&&m.type!==Mi)return i.isLeaving=!0,T.afterLeave=()=>{i.isLeaving=!1,o.update.active!==!1&&(o.effect.dirty=!0,o.update())},lw(u);p==="in-out"&&m.type!==Mi&&(T.delayLeave=(M,R,E)=>{const N=nH(i,S);N[String(S.key)]=S,M[Yu]=()=>{R(),M[Yu]=void 0,delete _.delayedLeave},_.delayedLeave=E})}return u}}},qse=Hse;function nH(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function M0(e,t,o,i){const{appear:c,mode:u,persisted:f=!1,onBeforeEnter:p,onEnter:m,onAfterEnter:_,onEnterCancelled:b,onBeforeLeave:S,onLeave:T,onAfterLeave:M,onLeaveCancelled:R,onBeforeAppear:E,onAppear:N,onAfterAppear:D,onAppearCancelled:x}=t,L=String(e.key),F=nH(o,e),H=(W,Z)=>{W&&Qs(W,i,9,Z)},B=(W,Z)=>{const $=Z[1];H(W,Z),At(W)?W.every(O=>O.length<=1)&&$():W.length<=1&&$()},z={mode:u,persisted:f,beforeEnter(W){let Z=p;if(!o.isMounted)if(c)Z=E||p;else return;W[Yu]&&W[Yu](!0);const $=F[L];$&&gf(e,$)&&$.el[Yu]&&$.el[Yu](),H(Z,[W])},enter(W){let Z=m,$=_,O=b;if(!o.isMounted)if(c)Z=N||m,$=D||_,O=x||b;else return;let X=!1;const le=W[qS]=de=>{X||(X=!0,de?H(O,[W]):H($,[W]),z.delayedLeave&&z.delayedLeave(),W[qS]=void 0)};Z?B(Z,[W,le]):le()},leave(W,Z){const $=String(e.key);if(W[qS]&&W[qS](!0),o.isUnmounting)return Z();H(S,[W]);let O=!1;const X=W[Yu]=le=>{O||(O=!0,Z(),le?H(R,[W]):H(M,[W]),W[Yu]=void 0,F[$]===e&&delete F[$])};F[$]=e,T?B(T,[W,X]):X()},clone(W){return M0(W,t,o,i)}};return z}function lw(e){if(zE(e))return e=Ac(e),e.children=null,e}function SG(e){if(!zE(e))return e;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&tn(o.default))return o.default()}}function k0(e,t){e.shapeFlag&6&&e.component?k0(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function gN(e,t=!1,o){let i=[],c=0;for(let u=0;u<e.length;u++){let f=e[u];const p=o==null?f.key:String(o)+String(f.key!=null?f.key:u);f.type===qt?(f.patchFlag&128&&c++,i=i.concat(gN(f.children,t,p))):(t||f.type!==Mi)&&i.push(p!=null?Ac(f,{key:p}):f)}if(c>1)for(let u=0;u<i.length;u++)i[u].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Se(e,t){return tn(e)?Ar({name:e.name},t,{setup:e}):e}const e0=e=>!!e.type.__asyncLoader,zE=e=>e.type.__isKeepAlive;function Kse(e,t){rH(e,"a",t)}function oH(e,t){rH(e,"da",t)}function rH(e,t,o=ui){const i=e.__wdc||(e.__wdc=()=>{let c=o;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(WE(t,i,o),o){let c=o.parent;for(;c&&c.parent;)zE(c.parent.vnode)&&zse(i,t,o,c),c=c.parent}}function zse(e,t,o,i){const c=WE(t,e,i,!0);Md(()=>{ZO(i[t],c)},o)}function WE(e,t,o=ui,i=!1){if(o){const c=o[e]||(o[e]=[]),u=t.__weh||(t.__weh=(...f)=>{if(o.isUnmounted)return;Td();const p=rI(o),m=Qs(t,o,e,f);return p(),Ed(),m});return i?c.unshift(u):c.push(u),u}}const Dc=e=>(t,o=ui)=>(!YE||e==="sp")&&WE(e,(...i)=>t(...i),o),jE=Dc("bm"),fn=Dc("m"),iH=Dc("bu"),Oc=Dc("u"),Ro=Dc("bum"),Md=Dc("um"),Wse=Dc("sp"),jse=Dc("rtg"),Yse=Dc("rtc");function Jse(e,t=ui){WE("ec",e,t)}function Vn(e,t,o,i){let c;const u=o;if(At(e)||on(e)){c=new Array(e.length);for(let f=0,p=e.length;f<p;f++)c[f]=t(e[f],f,void 0,u)}else if(typeof e=="number"){c=new Array(e);for(let f=0;f<e;f++)c[f]=t(f+1,f,void 0,u)}else if(En(e))if(e[Symbol.iterator])c=Array.from(e,(f,p)=>t(f,p,void 0,u));else{const f=Object.keys(e);c=new Array(f.length);for(let p=0,m=f.length;p<m;p++){const _=f[p];c[p]=t(e[_],_,p,u)}}else c=[];return c}function kc(e,t){for(let o=0;o<t.length;o++){const i=t[o];if(At(i))for(let c=0;c<i.length;c++)e[i[c].name]=i[c].fn;else i&&(e[i.name]=i.key?(...c)=>{const u=i.fn(...c);return u&&(u.key=i.key),u}:i.fn)}return e}function We(e,t,o={},i,c){if(Br.isCE||Br.parent&&e0(Br.parent)&&Br.parent.isCE)return t!=="default"&&(o.name=t),Me("slot",o,i&&i());let u=e[t];u&&u._c&&(u._d=!1),J();const f=u&&sH(u(o)),p=He(qt,{key:o.key||f&&f.key||`_${t}`},f||(i?i():[]),f&&e._===1?64:-2);return p.scopeId&&(p.slotScopeIds=[p.scopeId+"-s"]),u&&u._c&&(u._d=!0),p}function sH(e){return e.some(t=>$o(t)?!(t.type===Mi||t.type===qt&&!sH(t.children)):!0)?e:null}function Xse(e,t){const o={};for(const i in e)o[bT(i)]=e[i];return o}const CD=e=>e?CH(e)?JE(e)||e.proxy:CD(e.parent):null,t0=Ar(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>CD(e.parent),$root:e=>CD(e.root),$emit:e=>e.emit,$options:e=>mN(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,dN(e.update)}),$nextTick:e=>e.n||(e.n=zt.bind(e.proxy)),$watch:e=>$se.bind(e)}),cw=(e,t)=>e!==rr&&!e.__isScriptSetup&&qn(e,t),Qse={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:c,props:u,accessCache:f,type:p,appContext:m}=e;let _;if(t[0]!=="$"){const M=f[t];if(M!==void 0)switch(M){case 1:return i[t];case 2:return c[t];case 4:return o[t];case 3:return u[t]}else{if(cw(i,t))return f[t]=1,i[t];if(c!==rr&&qn(c,t))return f[t]=2,c[t];if((_=e.propsOptions[0])&&qn(_,t))return f[t]=3,u[t];if(o!==rr&&qn(o,t))return f[t]=4,o[t];SD&&(f[t]=0)}}const b=t0[t];let S,T;if(b)return t==="$attrs"&&ss(e.attrs,"get",""),b(e);if((S=p.__cssModules)&&(S=S[t]))return S;if(o!==rr&&qn(o,t))return f[t]=4,o[t];if(T=m.config.globalProperties,qn(T,t))return T[t]},set({_:e},t,o){const{data:i,setupState:c,ctx:u}=e;return cw(c,t)?(c[t]=o,!0):i!==rr&&qn(i,t)?(i[t]=o,!0):qn(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(u[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:c,propsOptions:u}},f){let p;return!!o[f]||e!==rr&&qn(e,f)||cw(t,f)||(p=u[0])&&qn(p,f)||qn(i,f)||qn(t0,f)||qn(c.config.globalProperties,f)},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:qn(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function zr(){return aH().slots}function tp(){return aH().attrs}function aH(){const e=In();return e.setupContext||(e.setupContext=TH(e))}function TG(e){return At(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let SD=!0;function Zse(e){const t=mN(e),o=e.proxy,i=e.ctx;SD=!1,t.beforeCreate&&EG(t.beforeCreate,e,"bc");const{data:c,computed:u,methods:f,watch:p,provide:m,inject:_,created:b,beforeMount:S,mounted:T,beforeUpdate:M,updated:R,activated:E,deactivated:N,beforeDestroy:D,beforeUnmount:x,destroyed:L,unmounted:F,render:H,renderTracked:B,renderTriggered:z,errorCaptured:W,serverPrefetch:Z,expose:$,inheritAttrs:O,components:X,directives:le,filters:de}=t;if(_&&eae(_,i,null),f)for(const ie in f){const oe=f[ie];tn(oe)&&(i[ie]=oe.bind(o))}if(c){const ie=c.call(o,o);En(ie)&&(e.data=Zn(ie))}if(SD=!0,u)for(const ie in u){const oe=u[ie],ee=tn(oe)?oe.bind(o,o):tn(oe.get)?oe.get.bind(o,o):co,Q=!tn(oe)&&tn(oe.set)?oe.set.bind(o):co,ue=K({get:ee,set:Q});Object.defineProperty(i,ie,{enumerable:!0,configurable:!0,get:()=>ue.value,set:me=>ue.value=me})}if(p)for(const ie in p)lH(p[ie],i,o,ie);if(m){const ie=tn(m)?m.call(o):m;Reflect.ownKeys(ie).forEach(oe=>{Ln(oe,ie[oe])})}b&&EG(b,e,"c");function se(ie,oe){At(oe)?oe.forEach(ee=>ie(ee.bind(o))):oe&&ie(oe.bind(o))}if(se(jE,S),se(fn,T),se(iH,M),se(Oc,R),se(Kse,E),se(oH,N),se(Jse,W),se(Yse,B),se(jse,z),se(Ro,x),se(Md,F),se(Wse,Z),At($))if($.length){const ie=e.exposed||(e.exposed={});$.forEach(oe=>{Object.defineProperty(ie,oe,{get:()=>o[oe],set:ee=>o[oe]=ee})})}else e.exposed||(e.exposed={});H&&e.render===co&&(e.render=H),O!=null&&(e.inheritAttrs=O),X&&(e.components=X),le&&(e.directives=le)}function eae(e,t,o=co){At(e)&&(e=TD(e));for(const i in e){const c=e[i];let u;En(c)?"default"in c?u=wt(c.from||i,c.default,!0):u=wt(c.from||i):u=wt(c),No(u)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>u.value,set:f=>u.value=f}):t[i]=u}}function EG(e,t,o){Qs(At(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function lH(e,t,o,i){const c=i.includes(".")?Z$(o,i):()=>o[i];if(on(e)){const u=t[e];tn(u)&&rt(c,u)}else if(tn(e))rt(c,e.bind(o));else if(En(e))if(At(e))e.forEach(u=>lH(u,t,o,i));else{const u=tn(e.handler)?e.handler.bind(o):t[e.handler];tn(u)&&rt(c,u,e)}}function mN(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:c,optionsCache:u,config:{optionMergeStrategies:f}}=e.appContext,p=u.get(t);let m;return p?m=p:!c.length&&!o&&!i?m=t:(m={},c.length&&c.forEach(_=>sE(m,_,f,!0)),sE(m,t,f)),En(t)&&u.set(t,m),m}function sE(e,t,o,i=!1){const{mixins:c,extends:u}=t;u&&sE(e,u,o,!0),c&&c.forEach(f=>sE(e,f,o,!0));for(const f in t)if(!(i&&f==="expose")){const p=tae[f]||o&&o[f];e[f]=p?p(e[f],t[f]):t[f]}return e}const tae={data:MG,props:kG,emits:kG,methods:zy,computed:zy,beforeCreate:Bi,created:Bi,beforeMount:Bi,mounted:Bi,beforeUpdate:Bi,updated:Bi,beforeDestroy:Bi,beforeUnmount:Bi,destroyed:Bi,unmounted:Bi,activated:Bi,deactivated:Bi,errorCaptured:Bi,serverPrefetch:Bi,components:zy,directives:zy,watch:oae,provide:MG,inject:nae};function MG(e,t){return t?e?function(){return Ar(tn(e)?e.call(this,this):e,tn(t)?t.call(this,this):t)}:t:e}function nae(e,t){return zy(TD(e),TD(t))}function TD(e){if(At(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function Bi(e,t){return e?[...new Set([].concat(e,t))]:t}function zy(e,t){return e?Ar(Object.create(null),e,t):t}function kG(e,t){return e?At(e)&&At(t)?[...new Set([...e,...t])]:Ar(Object.create(null),TG(e),TG(t??{})):t}function oae(e,t){if(!e)return t;if(!t)return e;const o=Ar(Object.create(null),e);for(const i in t)o[i]=Bi(e[i],t[i]);return o}function cH(){return{app:null,config:{isNativeTag:Gie,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let rae=0;function iae(e,t){return function(i,c=null){tn(i)||(i=Ar({},i)),c!=null&&!En(c)&&(c=null);const u=cH(),f=new WeakSet;let p=!1;const m=u.app={_uid:rae++,_component:i,_props:c,_container:null,_context:u,_instance:null,version:Aae,get config(){return u.config},set config(_){},use(_,...b){return f.has(_)||(_&&tn(_.install)?(f.add(_),_.install(m,...b)):tn(_)&&(f.add(_),_(m,...b))),m},mixin(_){return u.mixins.includes(_)||u.mixins.push(_),m},component(_,b){return b?(u.components[_]=b,m):u.components[_]},directive(_,b){return b?(u.directives[_]=b,m):u.directives[_]},mount(_,b,S){if(!p){const T=Me(i,c);return T.appContext=u,S===!0?S="svg":S===!1&&(S=void 0),b&&t?t(T,_):e(T,_,S),p=!0,m._container=_,_.__vue_app__=m,JE(T.component)||T.component.proxy}},unmount(){p&&(e(null,m._container),delete m._container.__vue_app__)},provide(_,b){return u.provides[_]=b,m},runWithContext(_){const b=n0;n0=m;try{return _()}finally{n0=b}}};return m}}let n0=null;function Ln(e,t){if(ui){let o=ui.provides;const i=ui.parent&&ui.parent.provides;i===o&&(o=ui.provides=Object.create(i)),o[e]=t}}function wt(e,t,o=!1){const i=ui||Br;if(i||n0){const c=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:n0._context.provides;if(c&&e in c)return c[e];if(arguments.length>1)return o&&tn(t)?t.call(i&&i.proxy):t}}const uH={},dH=()=>Object.create(uH),hH=e=>Object.getPrototypeOf(e)===uH;function sae(e,t,o,i=!1){const c={},u=dH();e.propsDefaults=Object.create(null),fH(e,t,c,u);for(const f in e.propsOptions[0])f in c||(c[f]=void 0);o?e.props=i?c:sN(c):e.type.props?e.props=c:e.props=u,e.attrs=u}function aae(e,t,o,i){const{props:c,attrs:u,vnode:{patchFlag:f}}=e,p=fo(c),[m]=e.propsOptions;let _=!1;if((i||f>0)&&!(f&16)){if(f&8){const b=e.vnode.dynamicProps;for(let S=0;S<b.length;S++){let T=b[S];if(qE(e.emitsOptions,T))continue;const M=t[T];if(m)if(qn(u,T))M!==u[T]&&(u[T]=M,_=!0);else{const R=na(T);c[R]=ED(m,p,R,M,e,!1)}else M!==u[T]&&(u[T]=M,_=!0)}}}else{fH(e,t,c,u)&&(_=!0);let b;for(const S in p)(!t||!qn(t,S)&&((b=Sd(S))===S||!qn(t,b)))&&(m?o&&(o[S]!==void 0||o[b]!==void 0)&&(c[S]=ED(m,p,S,void 0,e,!0)):delete c[S]);if(u!==p)for(const S in u)(!t||!qn(t,S))&&(delete u[S],_=!0)}_&&Tc(e.attrs,"set","")}function fH(e,t,o,i){const[c,u]=e.propsOptions;let f=!1,p;if(t)for(let m in t){if(Xy(m))continue;const _=t[m];let b;c&&qn(c,b=na(m))?!u||!u.includes(b)?o[b]=_:(p||(p={}))[b]=_:qE(e.emitsOptions,m)||(!(m in i)||_!==i[m])&&(i[m]=_,f=!0)}if(u){const m=fo(o),_=p||rr;for(let b=0;b<u.length;b++){const S=u[b];o[S]=ED(c,m,S,_[S],e,!qn(_,S))}}return f}function ED(e,t,o,i,c,u){const f=e[o];if(f!=null){const p=qn(f,"default");if(p&&i===void 0){const m=f.default;if(f.type!==Function&&!f.skipFactory&&tn(m)){const{propsDefaults:_}=c;if(o in _)i=_[o];else{const b=rI(c);i=_[o]=m.call(null,t),b()}}else i=m}f[0]&&(u&&!p?i=!1:f[1]&&(i===""||i===Sd(o))&&(i=!0))}return i}function pH(e,t,o=!1){const i=t.propsCache,c=i.get(e);if(c)return c;const u=e.props,f={},p=[];let m=!1;if(!tn(e)){const b=S=>{m=!0;const[T,M]=pH(S,t,!0);Ar(f,T),M&&p.push(...M)};!o&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}if(!u&&!m)return En(e)&&i.set(e,Xg),Xg;if(At(u))for(let b=0;b<u.length;b++){const S=na(u[b]);AG(S)&&(f[S]=rr)}else if(u)for(const b in u){const S=na(b);if(AG(S)){const T=u[b],M=f[S]=At(T)||tn(T)?{type:T}:Ar({},T);if(M){const R=DG(Boolean,M.type),E=DG(String,M.type);M[0]=R>-1,M[1]=E<0||R<E,(R>-1||qn(M,"default"))&&p.push(S)}}}const _=[f,p];return En(e)&&i.set(e,_),_}function AG(e){return e[0]!=="$"&&!Xy(e)}function RG(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function wG(e,t){return RG(e)===RG(t)}function DG(e,t){return At(t)?t.findIndex(o=>wG(o,e)):tn(t)&&wG(t,e)?0:-1}const gH=e=>e[0]==="_"||e==="$stable",vN=e=>At(e)?e.map(pl):[pl(e)],lae=(e,t,o)=>{if(t._n)return t;const i=Ne((...c)=>vN(t(...c)),o);return i._c=!1,i},mH=(e,t,o)=>{const i=e._ctx;for(const c in e){if(gH(c))continue;const u=e[c];if(tn(u))t[c]=lae(c,u,i);else if(u!=null){const f=vN(u);t[c]=()=>f}}},vH=(e,t)=>{const o=vN(t);e.slots.default=()=>o},cae=(e,t)=>{const o=e.slots=dH();if(e.vnode.shapeFlag&32){const i=t._;i?(Ar(o,t),C$(o,"_",i,!0)):mH(t,o)}else t&&vH(e,t)},uae=(e,t,o)=>{const{vnode:i,slots:c}=e;let u=!0,f=rr;if(i.shapeFlag&32){const p=t._;p?o&&p===1?u=!1:(Ar(c,t),!o&&p===1&&delete c._):(u=!t.$stable,mH(t,c)),f=t}else t&&(vH(e,t),f={default:1});if(u)for(const p in c)!gH(p)&&f[p]==null&&delete c[p]};function MD(e,t,o,i,c=!1){if(At(e)){e.forEach((T,M)=>MD(T,t&&(At(t)?t[M]:t),o,i,c));return}if(e0(i)&&!c)return;const u=i.shapeFlag&4?JE(i.component)||i.component.proxy:i.el,f=c?null:u,{i:p,r:m}=e,_=t&&t.r,b=p.refs===rr?p.refs={}:p.refs,S=p.setupState;if(_!=null&&_!==m&&(on(_)?(b[_]=null,qn(S,_)&&(S[_]=null)):No(_)&&(_.value=null)),tn(m))ld(m,p,12,[f,b]);else{const T=on(m),M=No(m);if(T||M){const R=()=>{if(e.f){const E=T?qn(S,m)?S[m]:b[m]:m.value;c?At(E)&&ZO(E,u):At(E)?E.includes(u)||E.push(u):T?(b[m]=[u],qn(S,m)&&(S[m]=b[m])):(m.value=[u],e.k&&(b[e.k]=m.value))}else T?(b[m]=f,qn(S,m)&&(S[m]=f)):M&&(m.value=f,e.k&&(b[e.k]=f))};f?(R.id=-1,es(R,o)):R()}}}const es=Vse;function dae(e){return hae(e)}function hae(e,t){const o=S$();o.__VUE__=!0;const{insert:i,remove:c,patchProp:u,createElement:f,createText:p,createComment:m,setText:_,setElementText:b,parentNode:S,nextSibling:T,setScopeId:M=co,insertStaticContent:R}=e,E=(Ie,Ae,xe,ot=null,je=null,at=null,ht=void 0,dt=null,ft=!!Ae.dynamicChildren)=>{if(Ie===Ae)return;Ie&&!gf(Ie,Ae)&&(ot=Ee(Ie),me(Ie,je,at,!0),Ie=null),Ae.patchFlag===-2&&(ft=!1,Ae.dynamicChildren=null);const{type:Je,ref:Et,shapeFlag:Nt}=Ae;switch(Je){case Pm:N(Ie,Ae,xe,ot);break;case Mi:D(Ie,Ae,xe,ot);break;case dw:Ie==null&&x(Ae,xe,ot,ht);break;case qt:X(Ie,Ae,xe,ot,je,at,ht,dt,ft);break;default:Nt&1?H(Ie,Ae,xe,ot,je,at,ht,dt,ft):Nt&6?le(Ie,Ae,xe,ot,je,at,ht,dt,ft):(Nt&64||Nt&128)&&Je.process(Ie,Ae,xe,ot,je,at,ht,dt,ft,Ve)}Et!=null&&je&&MD(Et,Ie&&Ie.ref,at,Ae||Ie,!Ae)},N=(Ie,Ae,xe,ot)=>{if(Ie==null)i(Ae.el=p(Ae.children),xe,ot);else{const je=Ae.el=Ie.el;Ae.children!==Ie.children&&_(je,Ae.children)}},D=(Ie,Ae,xe,ot)=>{Ie==null?i(Ae.el=m(Ae.children||""),xe,ot):Ae.el=Ie.el},x=(Ie,Ae,xe,ot)=>{[Ie.el,Ie.anchor]=R(Ie.children,Ae,xe,ot,Ie.el,Ie.anchor)},L=({el:Ie,anchor:Ae},xe,ot)=>{let je;for(;Ie&&Ie!==Ae;)je=T(Ie),i(Ie,xe,ot),Ie=je;i(Ae,xe,ot)},F=({el:Ie,anchor:Ae})=>{let xe;for(;Ie&&Ie!==Ae;)xe=T(Ie),c(Ie),Ie=xe;c(Ae)},H=(Ie,Ae,xe,ot,je,at,ht,dt,ft)=>{Ae.type==="svg"?ht="svg":Ae.type==="math"&&(ht="mathml"),Ie==null?B(Ae,xe,ot,je,at,ht,dt,ft):Z(Ie,Ae,je,at,ht,dt,ft)},B=(Ie,Ae,xe,ot,je,at,ht,dt)=>{let ft,Je;const{props:Et,shapeFlag:Nt,transition:et,dirs:Mt}=Ie;if(ft=Ie.el=f(Ie.type,at,Et&&Et.is,Et),Nt&8?b(ft,Ie.children):Nt&16&&W(Ie.children,ft,null,ot,je,uw(Ie,at),ht,dt),Mt&&rf(Ie,null,ot,"created"),z(ft,Ie,Ie.scopeId,ht,ot),Et){for(const sn in Et)sn!=="value"&&!Xy(sn)&&u(ft,sn,null,Et[sn],at,Ie.children,ot,je,Oe);"value"in Et&&u(ft,"value",null,Et.value,at),(Je=Et.onVnodeBeforeMount)&&dl(Je,ot,Ie)}Mt&&rf(Ie,null,ot,"beforeMount");const Jt=fae(je,et);Jt&&et.beforeEnter(ft),i(ft,Ae,xe),((Je=Et&&Et.onVnodeMounted)||Jt||Mt)&&es(()=>{Je&&dl(Je,ot,Ie),Jt&&et.enter(ft),Mt&&rf(Ie,null,ot,"mounted")},je)},z=(Ie,Ae,xe,ot,je)=>{if(xe&&M(Ie,xe),ot)for(let at=0;at<ot.length;at++)M(Ie,ot[at]);if(je){let at=je.subTree;if(Ae===at){const ht=je.vnode;z(Ie,ht,ht.scopeId,ht.slotScopeIds,je.parent)}}},W=(Ie,Ae,xe,ot,je,at,ht,dt,ft=0)=>{for(let Je=ft;Je<Ie.length;Je++){const Et=Ie[Je]=dt?Ju(Ie[Je]):pl(Ie[Je]);E(null,Et,Ae,xe,ot,je,at,ht,dt)}},Z=(Ie,Ae,xe,ot,je,at,ht)=>{const dt=Ae.el=Ie.el;let{patchFlag:ft,dynamicChildren:Je,dirs:Et}=Ae;ft|=Ie.patchFlag&16;const Nt=Ie.props||rr,et=Ae.props||rr;let Mt;if(xe&&sf(xe,!1),(Mt=et.onVnodeBeforeUpdate)&&dl(Mt,xe,Ae,Ie),Et&&rf(Ae,Ie,xe,"beforeUpdate"),xe&&sf(xe,!0),Je?$(Ie.dynamicChildren,Je,dt,xe,ot,uw(Ae,je),at):ht||oe(Ie,Ae,dt,null,xe,ot,uw(Ae,je),at,!1),ft>0){if(ft&16)O(dt,Ae,Nt,et,xe,ot,je);else if(ft&2&&Nt.class!==et.class&&u(dt,"class",null,et.class,je),ft&4&&u(dt,"style",Nt.style,et.style,je),ft&8){const Jt=Ae.dynamicProps;for(let sn=0;sn<Jt.length;sn++){const gn=Jt[sn],Bt=Nt[gn],nt=et[gn];(nt!==Bt||gn==="value")&&u(dt,gn,Bt,nt,je,Ie.children,xe,ot,Oe)}}ft&1&&Ie.children!==Ae.children&&b(dt,Ae.children)}else!ht&&Je==null&&O(dt,Ae,Nt,et,xe,ot,je);((Mt=et.onVnodeUpdated)||Et)&&es(()=>{Mt&&dl(Mt,xe,Ae,Ie),Et&&rf(Ae,Ie,xe,"updated")},ot)},$=(Ie,Ae,xe,ot,je,at,ht)=>{for(let dt=0;dt<Ae.length;dt++){const ft=Ie[dt],Je=Ae[dt],Et=ft.el&&(ft.type===qt||!gf(ft,Je)||ft.shapeFlag&70)?S(ft.el):xe;E(ft,Je,Et,null,ot,je,at,ht,!0)}},O=(Ie,Ae,xe,ot,je,at,ht)=>{if(xe!==ot){if(xe!==rr)for(const dt in xe)!Xy(dt)&&!(dt in ot)&&u(Ie,dt,xe[dt],null,ht,Ae.children,je,at,Oe);for(const dt in ot){if(Xy(dt))continue;const ft=ot[dt],Je=xe[dt];ft!==Je&&dt!=="value"&&u(Ie,dt,Je,ft,ht,Ae.children,je,at,Oe)}"value"in ot&&u(Ie,"value",xe.value,ot.value,ht)}},X=(Ie,Ae,xe,ot,je,at,ht,dt,ft)=>{const Je=Ae.el=Ie?Ie.el:p(""),Et=Ae.anchor=Ie?Ie.anchor:p("");let{patchFlag:Nt,dynamicChildren:et,slotScopeIds:Mt}=Ae;Mt&&(dt=dt?dt.concat(Mt):Mt),Ie==null?(i(Je,xe,ot),i(Et,xe,ot),W(Ae.children||[],xe,Et,je,at,ht,dt,ft)):Nt>0&&Nt&64&&et&&Ie.dynamicChildren?($(Ie.dynamicChildren,et,xe,je,at,ht,dt),(Ae.key!=null||je&&Ae===je.subTree)&&_N(Ie,Ae,!0)):oe(Ie,Ae,xe,Et,je,at,ht,dt,ft)},le=(Ie,Ae,xe,ot,je,at,ht,dt,ft)=>{Ae.slotScopeIds=dt,Ie==null?Ae.shapeFlag&512?je.ctx.activate(Ae,xe,ot,ht,ft):de(Ae,xe,ot,je,at,ht,ft):he(Ie,Ae,ft)},de=(Ie,Ae,xe,ot,je,at,ht)=>{const dt=Ie.component=Cae(Ie,ot,je);if(zE(Ie)&&(dt.ctx.renderer=Ve),Sae(dt),dt.asyncDep){if(je&&je.registerDep(dt,se),!Ie.el){const ft=dt.subTree=Me(Mi);D(null,ft,Ae,xe)}}else se(dt,Ie,Ae,xe,je,at,ht)},he=(Ie,Ae,xe)=>{const ot=Ae.component=Ie.component;if(Pse(Ie,Ae,xe))if(ot.asyncDep&&!ot.asyncResolved){ie(ot,Ae,xe);return}else ot.next=Ae,Rse(ot.update),ot.effect.dirty=!0,ot.update();else Ae.el=Ie.el,ot.vnode=Ae},se=(Ie,Ae,xe,ot,je,at,ht)=>{const dt=()=>{if(Ie.isMounted){let{next:Et,bu:Nt,u:et,parent:Mt,vnode:Jt}=Ie;{const It=_H(Ie);if(It){Et&&(Et.el=Jt.el,ie(Ie,Et,ht)),It.asyncDep.then(()=>{Ie.isUnmounted||dt()});return}}let sn=Et,gn;sf(Ie,!1),Et?(Et.el=Jt.el,ie(Ie,Et,ht)):Et=Jt,Nt&&CT(Nt),(gn=Et.props&&Et.props.onVnodeBeforeUpdate)&&dl(gn,Mt,Et,Jt),sf(Ie,!0);const Bt=aw(Ie),nt=Ie.subTree;Ie.subTree=Bt,E(nt,Bt,S(nt.el),Ee(nt),Ie,je,at),Et.el=Bt.el,sn===null&&Use(Ie,Bt.el),et&&es(et,je),(gn=Et.props&&Et.props.onVnodeUpdated)&&es(()=>dl(gn,Mt,Et,Jt),je)}else{let Et;const{el:Nt,props:et}=Ae,{bm:Mt,m:Jt,parent:sn}=Ie,gn=e0(Ae);if(sf(Ie,!1),Mt&&CT(Mt),!gn&&(Et=et&&et.onVnodeBeforeMount)&&dl(Et,sn,Ae),sf(Ie,!0),Nt&&st){const Bt=()=>{Ie.subTree=aw(Ie),st(Nt,Ie.subTree,Ie,je,null)};gn?Ae.type.__asyncLoader().then(()=>!Ie.isUnmounted&&Bt()):Bt()}else{const Bt=Ie.subTree=aw(Ie);E(null,Bt,xe,ot,Ie,je,at),Ae.el=Bt.el}if(Jt&&es(Jt,je),!gn&&(Et=et&&et.onVnodeMounted)){const Bt=Ae;es(()=>dl(Et,sn,Bt),je)}(Ae.shapeFlag&256||sn&&e0(sn.vnode)&&sn.vnode.shapeFlag&256)&&Ie.a&&es(Ie.a,je),Ie.isMounted=!0,Ae=xe=ot=null}},ft=Ie.effect=new tN(dt,co,()=>dN(Je),Ie.scope),Je=Ie.update=()=>{ft.dirty&&ft.run()};Je.id=Ie.uid,sf(Ie,!0),Je()},ie=(Ie,Ae,xe)=>{Ae.component=Ie;const ot=Ie.vnode.props;Ie.vnode=Ae,Ie.next=null,aae(Ie,Ae.props,ot,xe),uae(Ie,Ae.children,xe),Td(),IG(Ie),Ed()},oe=(Ie,Ae,xe,ot,je,at,ht,dt,ft=!1)=>{const Je=Ie&&Ie.children,Et=Ie?Ie.shapeFlag:0,Nt=Ae.children,{patchFlag:et,shapeFlag:Mt}=Ae;if(et>0){if(et&128){Q(Je,Nt,xe,ot,je,at,ht,dt,ft);return}else if(et&256){ee(Je,Nt,xe,ot,je,at,ht,dt,ft);return}}Mt&8?(Et&16&&Oe(Je,je,at),Nt!==Je&&b(xe,Nt)):Et&16?Mt&16?Q(Je,Nt,xe,ot,je,at,ht,dt,ft):Oe(Je,je,at,!0):(Et&8&&b(xe,""),Mt&16&&W(Nt,xe,ot,je,at,ht,dt,ft))},ee=(Ie,Ae,xe,ot,je,at,ht,dt,ft)=>{Ie=Ie||Xg,Ae=Ae||Xg;const Je=Ie.length,Et=Ae.length,Nt=Math.min(Je,Et);let et;for(et=0;et<Nt;et++){const Mt=Ae[et]=ft?Ju(Ae[et]):pl(Ae[et]);E(Ie[et],Mt,xe,null,je,at,ht,dt,ft)}Je>Et?Oe(Ie,je,at,!0,!1,Nt):W(Ae,xe,ot,je,at,ht,dt,ft,Nt)},Q=(Ie,Ae,xe,ot,je,at,ht,dt,ft)=>{let Je=0;const Et=Ae.length;let Nt=Ie.length-1,et=Et-1;for(;Je<=Nt&&Je<=et;){const Mt=Ie[Je],Jt=Ae[Je]=ft?Ju(Ae[Je]):pl(Ae[Je]);if(gf(Mt,Jt))E(Mt,Jt,xe,null,je,at,ht,dt,ft);else break;Je++}for(;Je<=Nt&&Je<=et;){const Mt=Ie[Nt],Jt=Ae[et]=ft?Ju(Ae[et]):pl(Ae[et]);if(gf(Mt,Jt))E(Mt,Jt,xe,null,je,at,ht,dt,ft);else break;Nt--,et--}if(Je>Nt){if(Je<=et){const Mt=et+1,Jt=Mt<Et?Ae[Mt].el:ot;for(;Je<=et;)E(null,Ae[Je]=ft?Ju(Ae[Je]):pl(Ae[Je]),xe,Jt,je,at,ht,dt,ft),Je++}}else if(Je>et)for(;Je<=Nt;)me(Ie[Je],je,at,!0),Je++;else{const Mt=Je,Jt=Je,sn=new Map;for(Je=Jt;Je<=et;Je++){const Dt=Ae[Je]=ft?Ju(Ae[Je]):pl(Ae[Je]);Dt.key!=null&&sn.set(Dt.key,Je)}let gn,Bt=0;const nt=et-Jt+1;let It=!1,ct=0;const Ke=new Array(nt);for(Je=0;Je<nt;Je++)Ke[Je]=0;for(Je=Mt;Je<=Nt;Je++){const Dt=Ie[Je];if(Bt>=nt){me(Dt,je,at,!0);continue}let $e;if(Dt.key!=null)$e=sn.get(Dt.key);else for(gn=Jt;gn<=et;gn++)if(Ke[gn-Jt]===0&&gf(Dt,Ae[gn])){$e=gn;break}$e===void 0?me(Dt,je,at,!0):(Ke[$e-Jt]=Je+1,$e>=ct?ct=$e:It=!0,E(Dt,Ae[$e],xe,null,je,at,ht,dt,ft),Bt++)}const Xe=It?pae(Ke):Xg;for(gn=Xe.length-1,Je=nt-1;Je>=0;Je--){const Dt=Jt+Je,$e=Ae[Dt],xt=Dt+1<Et?Ae[Dt+1].el:ot;Ke[Je]===0?E(null,$e,xe,xt,je,at,ht,dt,ft):It&&(gn<0||Je!==Xe[gn]?ue($e,xe,xt,2):gn--)}}},ue=(Ie,Ae,xe,ot,je=null)=>{const{el:at,type:ht,transition:dt,children:ft,shapeFlag:Je}=Ie;if(Je&6){ue(Ie.component.subTree,Ae,xe,ot);return}if(Je&128){Ie.suspense.move(Ae,xe,ot);return}if(Je&64){ht.move(Ie,Ae,xe,Ve);return}if(ht===qt){i(at,Ae,xe);for(let Nt=0;Nt<ft.length;Nt++)ue(ft[Nt],Ae,xe,ot);i(Ie.anchor,Ae,xe);return}if(ht===dw){L(Ie,Ae,xe);return}if(ot!==2&&Je&1&&dt)if(ot===0)dt.beforeEnter(at),i(at,Ae,xe),es(()=>dt.enter(at),je);else{const{leave:Nt,delayLeave:et,afterLeave:Mt}=dt,Jt=()=>i(at,Ae,xe),sn=()=>{Nt(at,()=>{Jt(),Mt&&Mt()})};et?et(at,Jt,sn):sn()}else i(at,Ae,xe)},me=(Ie,Ae,xe,ot=!1,je=!1)=>{const{type:at,props:ht,ref:dt,children:ft,dynamicChildren:Je,shapeFlag:Et,patchFlag:Nt,dirs:et}=Ie;if(dt!=null&&MD(dt,null,xe,Ie,!0),Et&256){Ae.ctx.deactivate(Ie);return}const Mt=Et&1&&et,Jt=!e0(Ie);let sn;if(Jt&&(sn=ht&&ht.onVnodeBeforeUnmount)&&dl(sn,Ae,Ie),Et&6)Ye(Ie.component,xe,ot);else{if(Et&128){Ie.suspense.unmount(xe,ot);return}Mt&&rf(Ie,null,Ae,"beforeUnmount"),Et&64?Ie.type.remove(Ie,Ae,xe,je,Ve,ot):Je&&(at!==qt||Nt>0&&Nt&64)?Oe(Je,Ae,xe,!1,!0):(at===qt&&Nt&384||!je&&Et&16)&&Oe(ft,Ae,xe),ot&&be(Ie)}(Jt&&(sn=ht&&ht.onVnodeUnmounted)||Mt)&&es(()=>{sn&&dl(sn,Ae,Ie),Mt&&rf(Ie,null,Ae,"unmounted")},xe)},be=Ie=>{const{type:Ae,el:xe,anchor:ot,transition:je}=Ie;if(Ae===qt){ke(xe,ot);return}if(Ae===dw){F(Ie);return}const at=()=>{c(xe),je&&!je.persisted&&je.afterLeave&&je.afterLeave()};if(Ie.shapeFlag&1&&je&&!je.persisted){const{leave:ht,delayLeave:dt}=je,ft=()=>ht(xe,at);dt?dt(Ie.el,at,ft):ft()}else at()},ke=(Ie,Ae)=>{let xe;for(;Ie!==Ae;)xe=T(Ie),c(Ie),Ie=xe;c(Ae)},Ye=(Ie,Ae,xe)=>{const{bum:ot,scope:je,update:at,subTree:ht,um:dt}=Ie;ot&&CT(ot),je.stop(),at&&(at.active=!1,me(ht,Ie,Ae,xe)),dt&&es(dt,Ae),es(()=>{Ie.isUnmounted=!0},Ae),Ae&&Ae.pendingBranch&&!Ae.isUnmounted&&Ie.asyncDep&&!Ie.asyncResolved&&Ie.suspenseId===Ae.pendingId&&(Ae.deps--,Ae.deps===0&&Ae.resolve())},Oe=(Ie,Ae,xe,ot=!1,je=!1,at=0)=>{for(let ht=at;ht<Ie.length;ht++)me(Ie[ht],Ae,xe,ot,je)},Ee=Ie=>Ie.shapeFlag&6?Ee(Ie.component.subTree):Ie.shapeFlag&128?Ie.suspense.next():T(Ie.anchor||Ie.el);let we=!1;const Ge=(Ie,Ae,xe)=>{Ie==null?Ae._vnode&&me(Ae._vnode,null,null,!0):E(Ae._vnode||null,Ie,Ae,null,null,null,xe),we||(we=!0,IG(),j$(),we=!1),Ae._vnode=Ie},Ve={p:E,um:me,m:ue,r:be,mt:de,mc:W,pc:oe,pbc:$,n:Ee,o:e};let qe,st;return{render:Ge,hydrate:qe,createApp:iae(Ge,qe)}}function uw({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function sf({effect:e,update:t},o){e.allowRecurse=t.allowRecurse=o}function fae(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function _N(e,t,o=!1){const i=e.children,c=t.children;if(At(i)&&At(c))for(let u=0;u<i.length;u++){const f=i[u];let p=c[u];p.shapeFlag&1&&!p.dynamicChildren&&((p.patchFlag<=0||p.patchFlag===32)&&(p=c[u]=Ju(c[u]),p.el=f.el),o||_N(f,p)),p.type===Pm&&(p.el=f.el)}}function pae(e){const t=e.slice(),o=[0];let i,c,u,f,p;const m=e.length;for(i=0;i<m;i++){const _=e[i];if(_!==0){if(c=o[o.length-1],e[c]<_){t[i]=c,o.push(i);continue}for(u=0,f=o.length-1;u<f;)p=u+f>>1,e[o[p]]<_?u=p+1:f=p;_<e[o[u]]&&(u>0&&(t[i]=o[u-1]),o[u]=i)}}for(u=o.length,f=o[u-1];u-- >0;)o[u]=f,f=t[f];return o}function _H(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_H(t)}const gae=e=>e.__isTeleport,o0=e=>e&&(e.disabled||e.disabled===""),OG=e=>typeof SVGElement<"u"&&e instanceof SVGElement,NG=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,kD=(e,t)=>{const o=e&&e.to;return on(o)?t?t(o):null:o},mae={name:"Teleport",__isTeleport:!0,process(e,t,o,i,c,u,f,p,m,_){const{mc:b,pc:S,pbc:T,o:{insert:M,querySelector:R,createText:E,createComment:N}}=_,D=o0(t.props);let{shapeFlag:x,children:L,dynamicChildren:F}=t;if(e==null){const H=t.el=E(""),B=t.anchor=E("");M(H,o,i),M(B,o,i);const z=t.target=kD(t.props,R),W=t.targetAnchor=E("");z&&(M(W,z),f==="svg"||OG(z)?f="svg":(f==="mathml"||NG(z))&&(f="mathml"));const Z=($,O)=>{x&16&&b(L,$,O,c,u,f,p,m)};D?Z(o,B):z&&Z(z,W)}else{t.el=e.el;const H=t.anchor=e.anchor,B=t.target=e.target,z=t.targetAnchor=e.targetAnchor,W=o0(e.props),Z=W?o:B,$=W?H:z;if(f==="svg"||OG(B)?f="svg":(f==="mathml"||NG(B))&&(f="mathml"),F?(T(e.dynamicChildren,F,Z,c,u,f,p),_N(e,t,!0)):m||S(e,t,Z,$,c,u,f,p,!1),D)W?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):KS(t,o,H,_,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const O=t.target=kD(t.props,R);O&&KS(t,O,null,_,0)}else W&&KS(t,B,z,_,1)}yH(t)},remove(e,t,o,i,{um:c,o:{remove:u}},f){const{shapeFlag:p,children:m,anchor:_,targetAnchor:b,target:S,props:T}=e;if(S&&u(b),f&&u(_),p&16){const M=f||!o0(T);for(let R=0;R<m.length;R++){const E=m[R];c(E,t,o,M,!!E.dynamicChildren)}}},move:KS,hydrate:vae};function KS(e,t,o,{o:{insert:i},m:c},u=2){u===0&&i(e.targetAnchor,t,o);const{el:f,anchor:p,shapeFlag:m,children:_,props:b}=e,S=u===2;if(S&&i(f,t,o),(!S||o0(b))&&m&16)for(let T=0;T<_.length;T++)c(_[T],t,o,2);S&&i(p,t,o)}function vae(e,t,o,i,c,u,{o:{nextSibling:f,parentNode:p,querySelector:m}},_){const b=t.target=kD(t.props,m);if(b){const S=b._lpa||b.firstChild;if(t.shapeFlag&16)if(o0(t.props))t.anchor=_(f(e),t,p(e),o,i,c,u),t.targetAnchor=S;else{t.anchor=f(e);let T=S;for(;T;)if(T=f(T),T&&T.nodeType===8&&T.data==="teleport anchor"){t.targetAnchor=T,b._lpa=t.targetAnchor&&f(t.targetAnchor);break}_(S,t,b,o,i,c,u)}yH(t)}return t.anchor&&f(t.anchor)}const Lm=mae;function yH(e){const t=e.ctx;if(t&&t.ut){let o=e.children[0].el;for(;o&&o!==e.targetAnchor;)o.nodeType===1&&o.setAttribute("data-v-owner",t.uid),o=o.nextSibling;t.ut()}}const qt=Symbol.for("v-fgt"),Pm=Symbol.for("v-txt"),Mi=Symbol.for("v-cmt"),dw=Symbol.for("v-stc"),r0=[];let Ra=null;function J(e=!1){r0.push(Ra=e?null:[])}function _ae(){r0.pop(),Ra=r0[r0.length-1]||null}let A0=1;function LG(e){A0+=e}function IH(e){return e.dynamicChildren=A0>0?Ra||Xg:null,_ae(),A0>0&&Ra&&Ra.push(e),e}function ge(e,t,o,i,c,u){return IH(Ce(e,t,o,i,c,u,!0))}function He(e,t,o,i,c){return IH(Me(e,t,o,i,c,!0))}function $o(e){return e?e.__v_isVNode===!0:!1}function gf(e,t){return e.type===t.type&&e.key===t.key}const bH=({key:e})=>e??null,ST=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?on(e)||No(e)||tn(e)?{i:Br,r:e,k:t,f:!!o}:e:null);function Ce(e,t=null,o=null,i=0,c=null,u=e===qt?0:1,f=!1,p=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&bH(t),ref:t&&ST(t),scopeId:X$,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:i,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Br};return p?(yN(m,o),u&128&&e.normalize(m)):o&&(m.shapeFlag|=on(o)?8:16),A0>0&&!f&&Ra&&(m.patchFlag>0||u&6)&&m.patchFlag!==32&&Ra.push(m),m}const Me=yae;function yae(e,t=null,o=null,i=0,c=null,u=!1){if((!e||e===Q$)&&(e=Mi),$o(e)){const p=Ac(e,t,!0);return o&&yN(p,o),A0>0&&!u&&Ra&&(p.shapeFlag&6?Ra[Ra.indexOf(e)]=p:Ra.push(p)),p.patchFlag|=-2,p}if(kae(e)&&(e=e.__vccOpts),t){t=dm(t);let{class:p,style:m}=t;p&&!on(p)&&(t.class=ne(p)),En(m)&&(B$(m)&&!At(m)&&(m=Ar({},m)),t.style=Ht(m))}const f=on(e)?1:Fse(e)?128:gae(e)?64:En(e)?4:tn(e)?2:0;return Ce(e,t,o,i,c,f,u,!0)}function dm(e){return e?B$(e)||hH(e)?Ar({},e):e:null}function Ac(e,t,o=!1,i=!1){const{props:c,ref:u,patchFlag:f,children:p,transition:m}=e,_=t?Nn(c||{},t):c,b={__v_isVNode:!0,__v_skip:!0,type:e.type,props:_,key:_&&bH(_),ref:t&&t.ref?o&&u?At(u)?u.concat(ST(t)):[u,ST(t)]:ST(t):u,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:p,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==qt?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:m,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ac(e.ssContent),ssFallback:e.ssFallback&&Ac(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return m&&i&&(b.transition=m.clone(b)),b}function On(e=" ",t=0){return Me(Pm,null,e,t)}function Fe(e="",t=!1){return t?(J(),He(Mi,null,e)):Me(Mi,null,e)}function pl(e){return e==null||typeof e=="boolean"?Me(Mi):At(e)?Me(qt,null,e.slice()):typeof e=="object"?Ju(e):Me(Pm,null,String(e))}function Ju(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ac(e)}function yN(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(At(t))o=16;else if(typeof t=="object")if(i&65){const c=t.default;c&&(c._c&&(c._d=!1),yN(e,c()),c._c&&(c._d=!0));return}else{o=32;const c=t._;!c&&!hH(t)?t._ctx=Br:c===3&&Br&&(Br.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else tn(t)?(t={default:t,_ctx:Br},o=32):(t=String(t),i&64?(o=16,t=[On(t)]):o=8);e.children=t,e.shapeFlag|=o}function Nn(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const c in i)if(c==="class")t.class!==i.class&&(t.class=ne([t.class,i.class]));else if(c==="style")t.style=Ht([t.style,i.style]);else if(VE(c)){const u=t[c],f=i[c];f&&u!==f&&!(At(u)&&u.includes(f))&&(t[c]=u?[].concat(u,f):f)}else c!==""&&(t[c]=i[c])}return t}function dl(e,t,o,i=null){Qs(e,t,7,[o,i])}const Iae=cH();let bae=0;function Cae(e,t,o){const i=e.type,c=(t?t.appContext:e.appContext)||Iae,u={uid:bae++,vnode:e,type:i,parent:t,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new k$(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pH(i,c),emitsOptions:J$(i,c),emit:null,emitted:null,propsDefaults:rr,inheritAttrs:i.inheritAttrs,ctx:rr,data:rr,props:rr,attrs:rr,slots:rr,refs:rr,setupState:rr,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=t?t.root:u,u.emit=Ose.bind(null,u),e.ce&&e.ce(u),u}let ui=null;const In=()=>ui||Br;let aE,AD;{const e=S$(),t=(o,i)=>{let c;return(c=e[o])||(c=e[o]=[]),c.push(i),u=>{c.length>1?c.forEach(f=>f(u)):c[0](u)}};aE=t("__VUE_INSTANCE_SETTERS__",o=>ui=o),AD=t("__VUE_SSR_SETTERS__",o=>YE=o)}const rI=e=>{const t=ui;return aE(e),e.scope.on(),()=>{e.scope.off(),aE(t)}},PG=()=>{ui&&ui.scope.off(),aE(null)};function CH(e){return e.vnode.shapeFlag&4}let YE=!1;function Sae(e,t=!1){t&&AD(t);const{props:o,children:i}=e.vnode,c=CH(e);sae(e,o,c,t),cae(e,i);const u=c?Tae(e,t):void 0;return t&&AD(!1),u}function Tae(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Qse);const{setup:i}=o;if(i){const c=e.setupContext=i.length>1?TH(e):null,u=rI(e);Td();const f=ld(i,e,0,[e.props,c]);if(Ed(),u(),b0(f)){if(f.then(PG,PG),t)return f.then(p=>{UG(e,p,t)}).catch(p=>{HE(p,e,0)});e.asyncDep=f}else UG(e,f,t)}else SH(e,t)}function UG(e,t,o){tn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:En(t)&&(e.setupState=q$(t)),SH(e,o)}let xG;function SH(e,t,o){const i=e.type;if(!e.render){if(!t&&xG&&!i.render){const c=i.template||mN(e).template;if(c){const{isCustomElement:u,compilerOptions:f}=e.appContext.config,{delimiters:p,compilerOptions:m}=i,_=Ar(Ar({isCustomElement:u,delimiters:p},f),m);i.render=xG(c,_)}}e.render=i.render||co}{const c=rI(e);Td();try{Zse(e)}finally{Ed(),c()}}}const Eae={get(e,t){return ss(e,"get",""),e[t]}};function TH(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,Eae),slots:e.slots,emit:e.emit,expose:t}}function JE(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(q$(Zg(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in t0)return t0[o](e)},has(t,o){return o in t||o in t0}}))}function Mae(e,t=!0){return tn(e)?e.displayName||e.name:e.name||t&&e.__name}function kae(e){return tn(e)&&"__vccOpts"in e}const K=(e,t)=>Ise(e,t,YE);function Wt(e,t,o){const i=arguments.length;return i===2?En(t)&&!At(t)?$o(t)?Me(e,null,[t]):Me(e,t):Me(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&$o(o)&&(o=[o]),Me(e,t,o))}const Aae="3.4.27",Rae=co;/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const wae="http://www.w3.org/2000/svg",Dae="http://www.w3.org/1998/Math/MathML",Xu=typeof document<"u"?document:null,FG=Xu&&Xu.createElement("template"),Oae={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const c=t==="svg"?Xu.createElementNS(wae,e):t==="mathml"?Xu.createElementNS(Dae,e):Xu.createElement(e,o?{is:o}:void 0);return e==="select"&&i&&i.multiple!=null&&c.setAttribute("multiple",i.multiple),c},createText:e=>Xu.createTextNode(e),createComment:e=>Xu.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xu.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,c,u){const f=o?o.previousSibling:t.lastChild;if(c&&(c===u||c.nextSibling))for(;t.insertBefore(c.cloneNode(!0),o),!(c===u||!(c=c.nextSibling)););else{FG.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const p=FG.content;if(i==="svg"||i==="mathml"){const m=p.firstChild;for(;m.firstChild;)p.appendChild(m.firstChild);p.removeChild(m)}t.insertBefore(p,o)}return[f?f.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},xu="transition",Ly="animation",hm=Symbol("_vtc"),Rr=(e,{slots:t})=>Wt(qse,MH(e),t);Rr.displayName="Transition";const EH={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Nae=Rr.props=Ar({},tH,EH),af=(e,t=[])=>{At(e)?e.forEach(o=>o(...t)):e&&e(...t)},VG=e=>e?At(e)?e.some(t=>t.length>1):e.length>1:!1;function MH(e){const t={};for(const X in e)X in EH||(t[X]=e[X]);if(e.css===!1)return t;const{name:o="v",type:i,duration:c,enterFromClass:u=`${o}-enter-from`,enterActiveClass:f=`${o}-enter-active`,enterToClass:p=`${o}-enter-to`,appearFromClass:m=u,appearActiveClass:_=f,appearToClass:b=p,leaveFromClass:S=`${o}-leave-from`,leaveActiveClass:T=`${o}-leave-active`,leaveToClass:M=`${o}-leave-to`}=e,R=Lae(c),E=R&&R[0],N=R&&R[1],{onBeforeEnter:D,onEnter:x,onEnterCancelled:L,onLeave:F,onLeaveCancelled:H,onBeforeAppear:B=D,onAppear:z=x,onAppearCancelled:W=L}=t,Z=(X,le,de)=>{Gu(X,le?b:p),Gu(X,le?_:f),de&&de()},$=(X,le)=>{X._isLeaving=!1,Gu(X,S),Gu(X,M),Gu(X,T),le&&le()},O=X=>(le,de)=>{const he=X?z:x,se=()=>Z(le,X,de);af(he,[le,se]),GG(()=>{Gu(le,X?m:u),mc(le,X?b:p),VG(he)||BG(le,i,E,se)})};return Ar(t,{onBeforeEnter(X){af(D,[X]),mc(X,u),mc(X,f)},onBeforeAppear(X){af(B,[X]),mc(X,m),mc(X,_)},onEnter:O(!1),onAppear:O(!0),onLeave(X,le){X._isLeaving=!0;const de=()=>$(X,le);mc(X,S),mc(X,T),AH(),GG(()=>{X._isLeaving&&(Gu(X,S),mc(X,M),VG(F)||BG(X,i,N,de))}),af(F,[X,de])},onEnterCancelled(X){Z(X,!1),af(L,[X])},onAppearCancelled(X){Z(X,!0),af(W,[X])},onLeaveCancelled(X){$(X),af(H,[X])}})}function Lae(e){if(e==null)return null;if(En(e))return[hw(e.enter),hw(e.leave)];{const t=hw(e);return[t,t]}}function hw(e){return qie(e)}function mc(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[hm]||(e[hm]=new Set)).add(t)}function Gu(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[hm];o&&(o.delete(t),o.size||(e[hm]=void 0))}function GG(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Pae=0;function BG(e,t,o,i){const c=e._endId=++Pae,u=()=>{c===e._endId&&i()};if(o)return setTimeout(u,o);const{type:f,timeout:p,propCount:m}=kH(e,t);if(!f)return i();const _=f+"end";let b=0;const S=()=>{e.removeEventListener(_,T),u()},T=M=>{M.target===e&&++b>=m&&S()};setTimeout(()=>{b<m&&S()},p+1),e.addEventListener(_,T)}function kH(e,t){const o=window.getComputedStyle(e),i=R=>(o[R]||"").split(", "),c=i(`${xu}Delay`),u=i(`${xu}Duration`),f=$G(c,u),p=i(`${Ly}Delay`),m=i(`${Ly}Duration`),_=$G(p,m);let b=null,S=0,T=0;t===xu?f>0&&(b=xu,S=f,T=u.length):t===Ly?_>0&&(b=Ly,S=_,T=m.length):(S=Math.max(f,_),b=S>0?f>_?xu:Ly:null,T=b?b===xu?u.length:m.length:0);const M=b===xu&&/\b(transform|all)(,|$)/.test(i(`${xu}Property`).toString());return{type:b,timeout:S,propCount:T,hasTransform:M}}function $G(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>HG(o)+HG(e[i])))}function HG(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function AH(){return document.body.offsetHeight}function Uae(e,t,o){const i=e[hm];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const lE=Symbol("_vod"),RH=Symbol("_vsh"),Jn={beforeMount(e,{value:t},{transition:o}){e[lE]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):Py(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),Py(e,!0),i.enter(e)):i.leave(e,()=>{Py(e,!1)}):Py(e,t))},beforeUnmount(e,{value:t}){Py(e,t)}};function Py(e,t){e.style.display=t?e[lE]:"none",e[RH]=!t}const xae=Symbol(""),Fae=/(^|;)\s*display\s*:/;function Vae(e,t,o){const i=e.style,c=on(o);let u=!1;if(o&&!c){if(t)if(on(t))for(const f of t.split(";")){const p=f.slice(0,f.indexOf(":")).trim();o[p]==null&&TT(i,p,"")}else for(const f in t)o[f]==null&&TT(i,f,"");for(const f in o)f==="display"&&(u=!0),TT(i,f,o[f])}else if(c){if(t!==o){const f=i[xae];f&&(o+=";"+f),i.cssText=o,u=Fae.test(o)}}else t&&e.removeAttribute("style");lE in e&&(e[lE]=u?i.display:"",e[RH]&&(i.display="none"))}const qG=/\s*!important$/;function TT(e,t,o){if(At(o))o.forEach(i=>TT(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=Gae(e,t);qG.test(o)?e.setProperty(Sd(i),o.replace(qG,""),"important"):e[i]=o}}const KG=["Webkit","Moz","ms"],fw={};function Gae(e,t){const o=fw[t];if(o)return o;let i=na(t);if(i!=="filter"&&i in e)return fw[t]=i;i=oI(i);for(let c=0;c<KG.length;c++){const u=KG[c]+i;if(u in e)return fw[t]=u}return t}const zG="http://www.w3.org/1999/xlink";function Bae(e,t,o,i,c){if(i&&t.startsWith("xlink:"))o==null?e.removeAttributeNS(zG,t.slice(6,t.length)):e.setAttributeNS(zG,t,o);else{const u=Jie(t);o==null||u&&!T$(o)?e.removeAttribute(t):e.setAttribute(t,u?"":o)}}function $ae(e,t,o,i,c,u,f){if(t==="innerHTML"||t==="textContent"){i&&f(i,c,u),e[t]=o??"";return}const p=e.tagName;if(t==="value"&&p!=="PROGRESS"&&!p.includes("-")){const _=p==="OPTION"?e.getAttribute("value")||"":e.value,b=o??"";(_!==b||!("_value"in e))&&(e.value=b),o==null&&e.removeAttribute(t),e._value=o;return}let m=!1;if(o===""||o==null){const _=typeof e[t];_==="boolean"?o=T$(o):o==null&&_==="string"?(o="",m=!0):_==="number"&&(o=0,m=!0)}try{e[t]=o}catch{}m&&e.removeAttribute(t)}function Zu(e,t,o,i){e.addEventListener(t,o,i)}function Hae(e,t,o,i){e.removeEventListener(t,o,i)}const WG=Symbol("_vei");function qae(e,t,o,i,c=null){const u=e[WG]||(e[WG]={}),f=u[t];if(i&&f)f.value=i;else{const[p,m]=Kae(t);if(i){const _=u[t]=jae(i,c);Zu(e,p,_,m)}else f&&(Hae(e,p,f,m),u[t]=void 0)}}const jG=/(?:Once|Passive|Capture)$/;function Kae(e){let t;if(jG.test(e)){t={};let i;for(;i=e.match(jG);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Sd(e.slice(2)),t]}let pw=0;const zae=Promise.resolve(),Wae=()=>pw||(zae.then(()=>pw=0),pw=Date.now());function jae(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;Qs(Yae(i,o.value),t,5,[i])};return o.value=e,o.attached=Wae(),o}function Yae(e,t){if(At(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>c=>!c._stopped&&i&&i(c))}else return t}const YG=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Jae=(e,t,o,i,c,u,f,p,m)=>{const _=c==="svg";t==="class"?Uae(e,i,_):t==="style"?Vae(e,o,i):VE(t)?QO(t)||qae(e,t,o,i,f):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Xae(e,t,i,_))?$ae(e,t,i,u,f,p,m):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Bae(e,t,i,_))};function Xae(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&YG(t)&&tn(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const c=e.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return YG(t)&&on(o)?!1:t in e}const wH=new WeakMap,DH=new WeakMap,cE=Symbol("_moveCb"),JG=Symbol("_enterCb"),OH={name:"TransitionGroup",props:Ar({},Nae,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=In(),i=eH();let c,u;return Oc(()=>{if(!c.length)return;const f=e.moveClass||`${e.name||"v"}-move`;if(!nle(c[0].el,o.vnode.el,f))return;c.forEach(Zae),c.forEach(ele);const p=c.filter(tle);AH(),p.forEach(m=>{const _=m.el,b=_.style;mc(_,f),b.transform=b.webkitTransform=b.transitionDuration="";const S=_[cE]=T=>{T&&T.target!==_||(!T||/transform$/.test(T.propertyName))&&(_.removeEventListener("transitionend",S),_[cE]=null,Gu(_,f))};_.addEventListener("transitionend",S)})}),()=>{const f=fo(e),p=MH(f);let m=f.tag||qt;if(c=[],u)for(let _=0;_<u.length;_++){const b=u[_];b.el&&b.el instanceof Element&&(c.push(b),k0(b,M0(b,p,i,o)),wH.set(b,b.el.getBoundingClientRect()))}u=t.default?gN(t.default()):[];for(let _=0;_<u.length;_++){const b=u[_];b.key!=null&&k0(b,M0(b,p,i,o))}return Me(m,null,u)}}},Qae=e=>delete e.mode;OH.props;const NH=OH;function Zae(e){const t=e.el;t[cE]&&t[cE](),t[JG]&&t[JG]()}function ele(e){DH.set(e,e.el.getBoundingClientRect())}function tle(e){const t=wH.get(e),o=DH.get(e),i=t.left-o.left,c=t.top-o.top;if(i||c){const u=e.el.style;return u.transform=u.webkitTransform=`translate(${i}px,${c}px)`,u.transitionDuration="0s",e}}function nle(e,t,o){const i=e.cloneNode(),c=e[hm];c&&c.forEach(p=>{p.split(/\s+/).forEach(m=>m&&i.classList.remove(m))}),o.split(/\s+/).forEach(p=>p&&i.classList.add(p)),i.style.display="none";const u=t.nodeType===1?t:t.parentNode;u.appendChild(i);const{hasTransform:f}=kH(i);return u.removeChild(i),f}const fm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return At(t)?o=>CT(t,o):t};function ole(e){e.target.composing=!0}function XG(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ec=Symbol("_assign"),IN={created(e,{modifiers:{lazy:t,trim:o,number:i}},c){e[Ec]=fm(c);const u=i||c.props&&c.props.type==="number";Zu(e,t?"change":"input",f=>{if(f.target.composing)return;let p=e.value;o&&(p=p.trim()),u&&(p=vD(p)),e[Ec](p)}),o&&Zu(e,"change",()=>{e.value=e.value.trim()}),t||(Zu(e,"compositionstart",ole),Zu(e,"compositionend",XG),Zu(e,"change",XG))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:o,trim:i,number:c}},u){if(e[Ec]=fm(u),e.composing)return;const f=(c||e.type==="number")&&!/^0\d/.test(e.value)?vD(e.value):e.value,p=t??"";f!==p&&(document.activeElement===e&&e.type!=="range"&&(o||i&&e.value.trim()===p)||(e.value=p))}},uE={deep:!0,created(e,t,o){e[Ec]=fm(o),Zu(e,"change",()=>{const i=e._modelValue,c=PH(e),u=e.checked,f=e[Ec];if(At(i)){const p=E$(i,c),m=p!==-1;if(u&&!m)f(i.concat(c));else if(!u&&m){const _=[...i];_.splice(p,1),f(_)}}else if(GE(i)){const p=new Set(i);u?p.add(c):p.delete(c),f(p)}else f(UH(e,u))})},mounted:QG,beforeUpdate(e,t,o){e[Ec]=fm(o),QG(e,t,o)}};function QG(e,{value:t,oldValue:o},i){e._modelValue=t,At(t)?e.checked=E$(t,i.props.value)>-1:GE(t)?e.checked=t.has(i.props.value):t!==o&&(e.checked=um(t,UH(e,!0)))}const LH={created(e,{value:t},o){e.checked=um(t,o.props.value),e[Ec]=fm(o),Zu(e,"change",()=>{e[Ec](PH(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[Ec]=fm(i),t!==o&&(e.checked=um(t,i.props.value))}};function PH(e){return"_value"in e?e._value:e.value}function UH(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const rle=["ctrl","shift","alt","meta"],ile={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>rle.some(o=>e[`${o}Key`]&&!t.includes(o))},nn=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=(c,...u)=>{for(let f=0;f<t.length;f++){const p=ile[t[f]];if(p&&p(c,t))return}return e(c,...u)})},sle={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},go=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=c=>{if(!("key"in c))return;const u=Sd(c.key);if(t.some(f=>f===u||sle[f]===u))return e(c)})},ale=Ar({patchProp:Jae},Oae);let ZG;function xH(){return ZG||(ZG=dae(ale))}const gd=(...e)=>{xH().render(...e)},FH=(...e)=>{const t=xH().createApp(...e),{mount:o}=t;return t.mount=i=>{const c=cle(i);if(!c)return;const u=t._component;!tn(u)&&!u.render&&!u.template&&(u.template=c.innerHTML),c.innerHTML="";const f=o(c,!1,lle(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),f},t};function lle(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function cle(e){return on(e)?document.querySelector(e):e}/*!
  * vue-router v4.3.2
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Bg=typeof document<"u";function ule(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Bo=Object.assign;function gw(e,t){const o={};for(const i in t){const c=t[i];o[i]=Na(c)?c.map(e):e(c)}return o}const i0=()=>{},Na=Array.isArray,VH=/#/g,dle=/&/g,hle=/\//g,fle=/=/g,ple=/\?/g,GH=/\+/g,gle=/%5B/g,mle=/%5D/g,BH=/%5E/g,vle=/%60/g,$H=/%7B/g,_le=/%7C/g,HH=/%7D/g,yle=/%20/g;function bN(e){return encodeURI(""+e).replace(_le,"|").replace(gle,"[").replace(mle,"]")}function Ile(e){return bN(e).replace($H,"{").replace(HH,"}").replace(BH,"^")}function RD(e){return bN(e).replace(GH,"%2B").replace(yle,"+").replace(VH,"%23").replace(dle,"%26").replace(vle,"`").replace($H,"{").replace(HH,"}").replace(BH,"^")}function ble(e){return RD(e).replace(fle,"%3D")}function Cle(e){return bN(e).replace(VH,"%23").replace(ple,"%3F")}function Sle(e){return e==null?"":Cle(e).replace(hle,"%2F")}function R0(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const Tle=/\/$/,Ele=e=>e.replace(Tle,"");function mw(e,t,o="/"){let i,c={},u="",f="";const p=t.indexOf("#");let m=t.indexOf("?");return p<m&&p>=0&&(m=-1),m>-1&&(i=t.slice(0,m),u=t.slice(m+1,p>-1?p:t.length),c=e(u)),p>-1&&(i=i||t.slice(0,p),f=t.slice(p,t.length)),i=Rle(i??t,o),{fullPath:i+(u&&"?")+u+f,path:i,query:c,hash:R0(f)}}function Mle(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function e6(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function kle(e,t,o){const i=t.matched.length-1,c=o.matched.length-1;return i>-1&&i===c&&pm(t.matched[i],o.matched[c])&&qH(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function pm(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function qH(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const o in e)if(!Ale(e[o],t[o]))return!1;return!0}function Ale(e,t){return Na(e)?t6(e,t):Na(t)?t6(t,e):e===t}function t6(e,t){return Na(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function Rle(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),c=i[i.length-1];(c===".."||c===".")&&i.push("");let u=o.length-1,f,p;for(f=0;f<i.length;f++)if(p=i[f],p!==".")if(p==="..")u>1&&u--;else break;return o.slice(0,u).join("/")+"/"+i.slice(f).join("/")}var w0;(function(e){e.pop="pop",e.push="push"})(w0||(w0={}));var s0;(function(e){e.back="back",e.forward="forward",e.unknown=""})(s0||(s0={}));function wle(e){if(!e)if(Bg){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Ele(e)}const Dle=/^[^#]+#/;function Ole(e,t){return e.replace(Dle,"#")+t}function Nle(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const XE=()=>({left:window.scrollX,top:window.scrollY});function Lle(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),c=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!c)return;t=Nle(c,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function n6(e,t){return(history.state?history.state.position-t:-1)+e}const wD=new Map;function Ple(e,t){wD.set(e,t)}function Ule(e){const t=wD.get(e);return wD.delete(e),t}let xle=()=>location.protocol+"//"+location.host;function KH(e,t){const{pathname:o,search:i,hash:c}=t,u=e.indexOf("#");if(u>-1){let p=c.includes(e.slice(u))?e.slice(u).length:1,m=c.slice(p);return m[0]!=="/"&&(m="/"+m),e6(m,"")}return e6(o,e)+i+c}function Fle(e,t,o,i){let c=[],u=[],f=null;const p=({state:T})=>{const M=KH(e,location),R=o.value,E=t.value;let N=0;if(T){if(o.value=M,t.value=T,f&&f===R){f=null;return}N=E?T.position-E.position:0}else i(M);c.forEach(D=>{D(o.value,R,{delta:N,type:w0.pop,direction:N?N>0?s0.forward:s0.back:s0.unknown})})};function m(){f=o.value}function _(T){c.push(T);const M=()=>{const R=c.indexOf(T);R>-1&&c.splice(R,1)};return u.push(M),M}function b(){const{history:T}=window;T.state&&T.replaceState(Bo({},T.state,{scroll:XE()}),"")}function S(){for(const T of u)T();u=[],window.removeEventListener("popstate",p),window.removeEventListener("beforeunload",b)}return window.addEventListener("popstate",p),window.addEventListener("beforeunload",b,{passive:!0}),{pauseListeners:m,listen:_,destroy:S}}function o6(e,t,o,i=!1,c=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:c?XE():null}}function Vle(e){const{history:t,location:o}=window,i={value:KH(e,o)},c={value:t.state};c.value||u(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function u(m,_,b){const S=e.indexOf("#"),T=S>-1?(o.host&&document.querySelector("base")?e:e.slice(S))+m:xle()+e+m;try{t[b?"replaceState":"pushState"](_,"",T),c.value=_}catch(M){console.error(M),o[b?"replace":"assign"](T)}}function f(m,_){const b=Bo({},t.state,o6(c.value.back,m,c.value.forward,!0),_,{position:c.value.position});u(m,b,!0),i.value=m}function p(m,_){const b=Bo({},c.value,t.state,{forward:m,scroll:XE()});u(b.current,b,!0);const S=Bo({},o6(i.value,m,null),{position:b.position+1},_);u(m,S,!1),i.value=m}return{location:i,state:c,push:p,replace:f}}function Gle(e){e=wle(e);const t=Vle(e),o=Fle(e,t.state,t.location,t.replace);function i(u,f=!0){f||o.pauseListeners(),history.go(u)}const c=Bo({location:"",base:e,go:i,createHref:Ole.bind(null,e)},t,o);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>t.state.value}),c}function Ble(e){return typeof e=="string"||e&&typeof e=="object"}function zH(e){return typeof e=="string"||typeof e=="symbol"}const Fu={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},WH=Symbol("");var r6;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(r6||(r6={}));function gm(e,t){return Bo(new Error,{type:e,[WH]:!0},t)}function hc(e,t){return e instanceof Error&&WH in e&&(t==null||!!(e.type&t))}const i6="[^/]+?",$le={sensitive:!1,strict:!1,start:!0,end:!0},Hle=/[.+*?^${}()[\]/\\]/g;function qle(e,t){const o=Bo({},$le,t),i=[];let c=o.start?"^":"";const u=[];for(const _ of e){const b=_.length?[]:[90];o.strict&&!_.length&&(c+="/");for(let S=0;S<_.length;S++){const T=_[S];let M=40+(o.sensitive?.25:0);if(T.type===0)S||(c+="/"),c+=T.value.replace(Hle,"\\$&"),M+=40;else if(T.type===1){const{value:R,repeatable:E,optional:N,regexp:D}=T;u.push({name:R,repeatable:E,optional:N});const x=D||i6;if(x!==i6){M+=10;try{new RegExp(`(${x})`)}catch(F){throw new Error(`Invalid custom RegExp for param "${R}" (${x}): `+F.message)}}let L=E?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;S||(L=N&&_.length<2?`(?:/${L})`:"/"+L),N&&(L+="?"),c+=L,M+=20,N&&(M+=-8),E&&(M+=-20),x===".*"&&(M+=-50)}b.push(M)}i.push(b)}if(o.strict&&o.end){const _=i.length-1;i[_][i[_].length-1]+=.7000000000000001}o.strict||(c+="/?"),o.end?c+="$":o.strict&&(c+="(?:/|$)");const f=new RegExp(c,o.sensitive?"":"i");function p(_){const b=_.match(f),S={};if(!b)return null;for(let T=1;T<b.length;T++){const M=b[T]||"",R=u[T-1];S[R.name]=M&&R.repeatable?M.split("/"):M}return S}function m(_){let b="",S=!1;for(const T of e){(!S||!b.endsWith("/"))&&(b+="/"),S=!1;for(const M of T)if(M.type===0)b+=M.value;else if(M.type===1){const{value:R,repeatable:E,optional:N}=M,D=R in _?_[R]:"";if(Na(D)&&!E)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const x=Na(D)?D.join("/"):D;if(!x)if(N)T.length<2&&(b.endsWith("/")?b=b.slice(0,-1):S=!0);else throw new Error(`Missing required param "${R}"`);b+=x}}return b||"/"}return{re:f,score:i,keys:u,parse:p,stringify:m}}function Kle(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function zle(e,t){let o=0;const i=e.score,c=t.score;for(;o<i.length&&o<c.length;){const u=Kle(i[o],c[o]);if(u)return u;o++}if(Math.abs(c.length-i.length)===1){if(s6(i))return 1;if(s6(c))return-1}return c.length-i.length}function s6(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Wle={type:0,value:""},jle=/[a-zA-Z0-9_]/;function Yle(e){if(!e)return[[]];if(e==="/")return[[Wle]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(M){throw new Error(`ERR (${o})/"${_}": ${M}`)}let o=0,i=o;const c=[];let u;function f(){u&&c.push(u),u=[]}let p=0,m,_="",b="";function S(){_&&(o===0?u.push({type:0,value:_}):o===1||o===2||o===3?(u.length>1&&(m==="*"||m==="+")&&t(`A repeatable param (${_}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:_,regexp:b,repeatable:m==="*"||m==="+",optional:m==="*"||m==="?"})):t("Invalid state to consume buffer"),_="")}function T(){_+=m}for(;p<e.length;){if(m=e[p++],m==="\\"&&o!==2){i=o,o=4;continue}switch(o){case 0:m==="/"?(_&&S(),f()):m===":"?(S(),o=1):T();break;case 4:T(),o=i;break;case 1:m==="("?o=2:jle.test(m)?T():(S(),o=0,m!=="*"&&m!=="?"&&m!=="+"&&p--);break;case 2:m===")"?b[b.length-1]=="\\"?b=b.slice(0,-1)+m:o=3:b+=m;break;case 3:S(),o=0,m!=="*"&&m!=="?"&&m!=="+"&&p--,b="";break;default:t("Unknown state");break}}return o===2&&t(`Unfinished custom RegExp for param "${_}"`),S(),f(),c}function Jle(e,t,o){const i=qle(Yle(e.path),o),c=Bo(i,{record:e,parent:t,children:[],alias:[]});return t&&!c.record.aliasOf==!t.record.aliasOf&&t.children.push(c),c}function Xle(e,t){const o=[],i=new Map;t=c6({strict:!1,end:!0,sensitive:!1},t);function c(b){return i.get(b)}function u(b,S,T){const M=!T,R=Qle(b);R.aliasOf=T&&T.record;const E=c6(t,b),N=[R];if("alias"in b){const L=typeof b.alias=="string"?[b.alias]:b.alias;for(const F of L)N.push(Bo({},R,{components:T?T.record.components:R.components,path:F,aliasOf:T?T.record:R}))}let D,x;for(const L of N){const{path:F}=L;if(S&&F[0]!=="/"){const H=S.record.path,B=H[H.length-1]==="/"?"":"/";L.path=S.record.path+(F&&B+F)}if(D=Jle(L,S,E),T?T.alias.push(D):(x=x||D,x!==D&&x.alias.push(D),M&&b.name&&!l6(D)&&f(b.name)),R.children){const H=R.children;for(let B=0;B<H.length;B++)u(H[B],D,T&&T.children[B])}T=T||D,(D.record.components&&Object.keys(D.record.components).length||D.record.name||D.record.redirect)&&m(D)}return x?()=>{f(x)}:i0}function f(b){if(zH(b)){const S=i.get(b);S&&(i.delete(b),o.splice(o.indexOf(S),1),S.children.forEach(f),S.alias.forEach(f))}else{const S=o.indexOf(b);S>-1&&(o.splice(S,1),b.record.name&&i.delete(b.record.name),b.children.forEach(f),b.alias.forEach(f))}}function p(){return o}function m(b){let S=0;for(;S<o.length&&zle(b,o[S])>=0&&(b.record.path!==o[S].record.path||!jH(b,o[S]));)S++;o.splice(S,0,b),b.record.name&&!l6(b)&&i.set(b.record.name,b)}function _(b,S){let T,M={},R,E;if("name"in b&&b.name){if(T=i.get(b.name),!T)throw gm(1,{location:b});E=T.record.name,M=Bo(a6(S.params,T.keys.filter(x=>!x.optional).concat(T.parent?T.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),b.params&&a6(b.params,T.keys.map(x=>x.name))),R=T.stringify(M)}else if(b.path!=null)R=b.path,T=o.find(x=>x.re.test(R)),T&&(M=T.parse(R),E=T.record.name);else{if(T=S.name?i.get(S.name):o.find(x=>x.re.test(S.path)),!T)throw gm(1,{location:b,currentLocation:S});E=T.record.name,M=Bo({},S.params,b.params),R=T.stringify(M)}const N=[];let D=T;for(;D;)N.unshift(D.record),D=D.parent;return{name:E,path:R,params:M,matched:N,meta:ece(N)}}return e.forEach(b=>u(b)),{addRoute:u,resolve:_,removeRoute:f,getRoutes:p,getRecordMatcher:c}}function a6(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function Qle(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Zle(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Zle(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function l6(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function ece(e){return e.reduce((t,o)=>Bo(t,o.meta),{})}function c6(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}function jH(e,t){return t.children.some(o=>o===e||jH(e,o))}function tce(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<i.length;++c){const u=i[c].replace(GH," "),f=u.indexOf("="),p=R0(f<0?u:u.slice(0,f)),m=f<0?null:R0(u.slice(f+1));if(p in t){let _=t[p];Na(_)||(_=t[p]=[_]),_.push(m)}else t[p]=m}return t}function u6(e){let t="";for(let o in e){const i=e[o];if(o=ble(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(Na(i)?i.map(u=>u&&RD(u)):[i&&RD(i)]).forEach(u=>{u!==void 0&&(t+=(t.length?"&":"")+o,u!=null&&(t+="="+u))})}return t}function nce(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=Na(i)?i.map(c=>c==null?null:""+c):i==null?i:""+i)}return t}const oce=Symbol(""),d6=Symbol(""),CN=Symbol(""),SN=Symbol(""),DD=Symbol("");function Uy(){let e=[];function t(i){return e.push(i),()=>{const c=e.indexOf(i);c>-1&&e.splice(c,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Qu(e,t,o,i,c,u=f=>f()){const f=i&&(i.enterCallbacks[c]=i.enterCallbacks[c]||[]);return()=>new Promise((p,m)=>{const _=T=>{T===!1?m(gm(4,{from:o,to:t})):T instanceof Error?m(T):Ble(T)?m(gm(2,{from:t,to:T})):(f&&i.enterCallbacks[c]===f&&typeof T=="function"&&f.push(T),p())},b=u(()=>e.call(i&&i.instances[c],t,o,_));let S=Promise.resolve(b);e.length<3&&(S=S.then(_)),S.catch(T=>m(T))})}function vw(e,t,o,i,c=u=>u()){const u=[];for(const f of e)for(const p in f.components){let m=f.components[p];if(!(t!=="beforeRouteEnter"&&!f.instances[p]))if(rce(m)){const b=(m.__vccOpts||m)[t];b&&u.push(Qu(b,o,i,f,p,c))}else{let _=m();u.push(()=>_.then(b=>{if(!b)return Promise.reject(new Error(`Couldn't resolve component "${p}" at "${f.path}"`));const S=ule(b)?b.default:b;f.components[p]=S;const M=(S.__vccOpts||S)[t];return M&&Qu(M,o,i,f,p,c)()}))}}return u}function rce(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function h6(e){const t=wt(CN),o=wt(SN),i=K(()=>{const m=y(e.to);return t.resolve(m)}),c=K(()=>{const{matched:m}=i.value,{length:_}=m,b=m[_-1],S=o.matched;if(!b||!S.length)return-1;const T=S.findIndex(pm.bind(null,b));if(T>-1)return T;const M=f6(m[_-2]);return _>1&&f6(b)===M&&S[S.length-1].path!==M?S.findIndex(pm.bind(null,m[_-2])):T}),u=K(()=>c.value>-1&&ace(o.params,i.value.params)),f=K(()=>c.value>-1&&c.value===o.matched.length-1&&qH(o.params,i.value.params));function p(m={}){return sce(m)?t[y(e.replace)?"replace":"push"](y(e.to)).catch(i0):Promise.resolve()}return{route:i,href:K(()=>i.value.href),isActive:u,isExactActive:f,navigate:p}}const ice=Se({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:h6,setup(e,{slots:t}){const o=Zn(h6(e)),{options:i}=wt(CN),c=K(()=>({[p6(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[p6(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const u=t.default&&t.default(o);return e.custom?u:Wt("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:c.value},u)}}}),OD=ice;function sce(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function ace(e,t){for(const o in t){const i=t[o],c=e[o];if(typeof i=="string"){if(i!==c)return!1}else if(!Na(c)||c.length!==i.length||i.some((u,f)=>u!==c[f]))return!1}return!0}function f6(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const p6=(e,t,o)=>e??t??o,lce=Se({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=wt(DD),c=K(()=>e.route||i.value),u=wt(d6,0),f=K(()=>{let _=y(u);const{matched:b}=c.value;let S;for(;(S=b[_])&&!S.components;)_++;return _}),p=K(()=>c.value.matched[f.value]);Ln(d6,K(()=>f.value+1)),Ln(oce,p),Ln(DD,c);const m=ae();return rt(()=>[m.value,p.value,e.name],([_,b,S],[T,M,R])=>{b&&(b.instances[S]=_,M&&M!==b&&_&&_===T&&(b.leaveGuards.size||(b.leaveGuards=M.leaveGuards),b.updateGuards.size||(b.updateGuards=M.updateGuards))),_&&b&&(!M||!pm(b,M)||!T)&&(b.enterCallbacks[S]||[]).forEach(E=>E(_))},{flush:"post"}),()=>{const _=c.value,b=e.name,S=p.value,T=S&&S.components[b];if(!T)return g6(o.default,{Component:T,route:_});const M=S.props[b],R=M?M===!0?_.params:typeof M=="function"?M(_):M:null,N=Wt(T,Bo({},R,t,{onVnodeUnmounted:D=>{D.component.isUnmounted&&(S.instances[b]=null)},ref:m}));return g6(o.default,{Component:N,route:_})||N}}});function g6(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const YH=lce;function cce(e){const t=Xle(e.routes,e),o=e.parseQuery||tce,i=e.stringifyQuery||u6,c=e.history,u=Uy(),f=Uy(),p=Uy(),m=Do(Fu);let _=Fu;Bg&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const b=gw.bind(null,Ee=>""+Ee),S=gw.bind(null,Sle),T=gw.bind(null,R0);function M(Ee,we){let Ge,Ve;return zH(Ee)?(Ge=t.getRecordMatcher(Ee),Ve=we):Ve=Ee,t.addRoute(Ve,Ge)}function R(Ee){const we=t.getRecordMatcher(Ee);we&&t.removeRoute(we)}function E(){return t.getRoutes().map(Ee=>Ee.record)}function N(Ee){return!!t.getRecordMatcher(Ee)}function D(Ee,we){if(we=Bo({},we||m.value),typeof Ee=="string"){const Ae=mw(o,Ee,we.path),xe=t.resolve({path:Ae.path},we),ot=c.createHref(Ae.fullPath);return Bo(Ae,xe,{params:T(xe.params),hash:R0(Ae.hash),redirectedFrom:void 0,href:ot})}let Ge;if(Ee.path!=null)Ge=Bo({},Ee,{path:mw(o,Ee.path,we.path).path});else{const Ae=Bo({},Ee.params);for(const xe in Ae)Ae[xe]==null&&delete Ae[xe];Ge=Bo({},Ee,{params:S(Ae)}),we.params=S(we.params)}const Ve=t.resolve(Ge,we),qe=Ee.hash||"";Ve.params=b(T(Ve.params));const st=Mle(i,Bo({},Ee,{hash:Ile(qe),path:Ve.path})),Ie=c.createHref(st);return Bo({fullPath:st,hash:qe,query:i===u6?nce(Ee.query):Ee.query||{}},Ve,{redirectedFrom:void 0,href:Ie})}function x(Ee){return typeof Ee=="string"?mw(o,Ee,m.value.path):Bo({},Ee)}function L(Ee,we){if(_!==Ee)return gm(8,{from:we,to:Ee})}function F(Ee){return z(Ee)}function H(Ee){return F(Bo(x(Ee),{replace:!0}))}function B(Ee){const we=Ee.matched[Ee.matched.length-1];if(we&&we.redirect){const{redirect:Ge}=we;let Ve=typeof Ge=="function"?Ge(Ee):Ge;return typeof Ve=="string"&&(Ve=Ve.includes("?")||Ve.includes("#")?Ve=x(Ve):{path:Ve},Ve.params={}),Bo({query:Ee.query,hash:Ee.hash,params:Ve.path!=null?{}:Ee.params},Ve)}}function z(Ee,we){const Ge=_=D(Ee),Ve=m.value,qe=Ee.state,st=Ee.force,Ie=Ee.replace===!0,Ae=B(Ge);if(Ae)return z(Bo(x(Ae),{state:typeof Ae=="object"?Bo({},qe,Ae.state):qe,force:st,replace:Ie}),we||Ge);const xe=Ge;xe.redirectedFrom=we;let ot;return!st&&kle(i,Ve,Ge)&&(ot=gm(16,{to:xe,from:Ve}),ue(Ve,Ve,!0,!1)),(ot?Promise.resolve(ot):$(xe,Ve)).catch(je=>hc(je)?hc(je,2)?je:Q(je):oe(je,xe,Ve)).then(je=>{if(je){if(hc(je,2))return z(Bo({replace:Ie},x(je.to),{state:typeof je.to=="object"?Bo({},qe,je.to.state):qe,force:st}),we||xe)}else je=X(xe,Ve,!0,Ie,qe);return O(xe,Ve,je),je})}function W(Ee,we){const Ge=L(Ee,we);return Ge?Promise.reject(Ge):Promise.resolve()}function Z(Ee){const we=ke.values().next().value;return we&&typeof we.runWithContext=="function"?we.runWithContext(Ee):Ee()}function $(Ee,we){let Ge;const[Ve,qe,st]=uce(Ee,we);Ge=vw(Ve.reverse(),"beforeRouteLeave",Ee,we);for(const Ae of Ve)Ae.leaveGuards.forEach(xe=>{Ge.push(Qu(xe,Ee,we))});const Ie=W.bind(null,Ee,we);return Ge.push(Ie),Oe(Ge).then(()=>{Ge=[];for(const Ae of u.list())Ge.push(Qu(Ae,Ee,we));return Ge.push(Ie),Oe(Ge)}).then(()=>{Ge=vw(qe,"beforeRouteUpdate",Ee,we);for(const Ae of qe)Ae.updateGuards.forEach(xe=>{Ge.push(Qu(xe,Ee,we))});return Ge.push(Ie),Oe(Ge)}).then(()=>{Ge=[];for(const Ae of st)if(Ae.beforeEnter)if(Na(Ae.beforeEnter))for(const xe of Ae.beforeEnter)Ge.push(Qu(xe,Ee,we));else Ge.push(Qu(Ae.beforeEnter,Ee,we));return Ge.push(Ie),Oe(Ge)}).then(()=>(Ee.matched.forEach(Ae=>Ae.enterCallbacks={}),Ge=vw(st,"beforeRouteEnter",Ee,we,Z),Ge.push(Ie),Oe(Ge))).then(()=>{Ge=[];for(const Ae of f.list())Ge.push(Qu(Ae,Ee,we));return Ge.push(Ie),Oe(Ge)}).catch(Ae=>hc(Ae,8)?Ae:Promise.reject(Ae))}function O(Ee,we,Ge){p.list().forEach(Ve=>Z(()=>Ve(Ee,we,Ge)))}function X(Ee,we,Ge,Ve,qe){const st=L(Ee,we);if(st)return st;const Ie=we===Fu,Ae=Bg?history.state:{};Ge&&(Ve||Ie?c.replace(Ee.fullPath,Bo({scroll:Ie&&Ae&&Ae.scroll},qe)):c.push(Ee.fullPath,qe)),m.value=Ee,ue(Ee,we,Ge,Ie),Q()}let le;function de(){le||(le=c.listen((Ee,we,Ge)=>{if(!Ye.listening)return;const Ve=D(Ee),qe=B(Ve);if(qe){z(Bo(qe,{replace:!0}),Ve).catch(i0);return}_=Ve;const st=m.value;Bg&&Ple(n6(st.fullPath,Ge.delta),XE()),$(Ve,st).catch(Ie=>hc(Ie,12)?Ie:hc(Ie,2)?(z(Ie.to,Ve).then(Ae=>{hc(Ae,20)&&!Ge.delta&&Ge.type===w0.pop&&c.go(-1,!1)}).catch(i0),Promise.reject()):(Ge.delta&&c.go(-Ge.delta,!1),oe(Ie,Ve,st))).then(Ie=>{Ie=Ie||X(Ve,st,!1),Ie&&(Ge.delta&&!hc(Ie,8)?c.go(-Ge.delta,!1):Ge.type===w0.pop&&hc(Ie,20)&&c.go(-1,!1)),O(Ve,st,Ie)}).catch(i0)}))}let he=Uy(),se=Uy(),ie;function oe(Ee,we,Ge){Q(Ee);const Ve=se.list();return Ve.length?Ve.forEach(qe=>qe(Ee,we,Ge)):console.error(Ee),Promise.reject(Ee)}function ee(){return ie&&m.value!==Fu?Promise.resolve():new Promise((Ee,we)=>{he.add([Ee,we])})}function Q(Ee){return ie||(ie=!Ee,de(),he.list().forEach(([we,Ge])=>Ee?Ge(Ee):we()),he.reset()),Ee}function ue(Ee,we,Ge,Ve){const{scrollBehavior:qe}=e;if(!Bg||!qe)return Promise.resolve();const st=!Ge&&Ule(n6(Ee.fullPath,0))||(Ve||!Ge)&&history.state&&history.state.scroll||null;return zt().then(()=>qe(Ee,we,st)).then(Ie=>Ie&&Lle(Ie)).catch(Ie=>oe(Ie,Ee,we))}const me=Ee=>c.go(Ee);let be;const ke=new Set,Ye={currentRoute:m,listening:!0,addRoute:M,removeRoute:R,hasRoute:N,getRoutes:E,resolve:D,options:e,push:F,replace:H,go:me,back:()=>me(-1),forward:()=>me(1),beforeEach:u.add,beforeResolve:f.add,afterEach:p.add,onError:se.add,isReady:ee,install(Ee){const we=this;Ee.component("RouterLink",OD),Ee.component("RouterView",YH),Ee.config.globalProperties.$router=we,Object.defineProperty(Ee.config.globalProperties,"$route",{enumerable:!0,get:()=>y(m)}),Bg&&!be&&m.value===Fu&&(be=!0,F(c.location).catch(qe=>{}));const Ge={};for(const qe in Fu)Object.defineProperty(Ge,qe,{get:()=>m.value[qe],enumerable:!0});Ee.provide(CN,we),Ee.provide(SN,sN(Ge)),Ee.provide(DD,m);const Ve=Ee.unmount;ke.add(Ee),Ee.unmount=function(){ke.delete(Ee),ke.size<1&&(_=Fu,le&&le(),le=null,m.value=Fu,be=!1,ie=!1),Ve()}}};function Oe(Ee){return Ee.reduce((we,Ge)=>we.then(()=>Z(Ge)),Promise.resolve())}return Ye}function uce(e,t){const o=[],i=[],c=[],u=Math.max(t.matched.length,e.matched.length);for(let f=0;f<u;f++){const p=t.matched[f];p&&(e.matched.find(_=>pm(_,p))?i.push(p):o.push(p));const m=e.matched[f];m&&(t.matched.find(_=>pm(_,m))||c.push(m))}return[o,i,c]}function JH(){return wt(SN)}const dce=Se({__name:"App",setup(e){return(t,o)=>(J(),He(y(YH)))}});var ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function la(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var XH={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){function o(r,a){return a.forEach(function(d){d&&typeof d!="string"&&!Array.isArray(d)&&Object.keys(d).forEach(function(g){if(g!=="default"&&!(g in r)){var C=Object.getOwnPropertyDescriptor(d,g);Object.defineProperty(r,g,C.get?C:{enumerable:!0,get:function(){return d[g]}})}})}),Object.freeze(r)}var i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ki<"u"?ki:typeof self<"u"?self:{},c=function(r){try{return!!r()}catch{return!0}},u=!c(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),f=u,p=Function.prototype,m=p.call,_=f&&p.bind.bind(m,m),b=f?_:function(r){return function(){return m.apply(r,arguments)}},S=b,T=S({}.toString),M=S("".slice),R=function(r){return M(T(r),8,-1)},E=c,N=R,D=Object,x=b("".split),L=E(function(){return!D("z").propertyIsEnumerable(0)})?function(r){return N(r)=="String"?x(r,""):D(r)}:D,F=function(r){return r==null},H=F,B=TypeError,z=function(r){if(H(r))throw B("Can't call method on "+r);return r},W=L,Z=z,$=function(r){return W(Z(r))},O=function(r){return r&&r.Math==Math&&r},X=O(typeof globalThis=="object"&&globalThis)||O(typeof window=="object"&&window)||O(typeof self=="object"&&self)||O(typeof i=="object"&&i)||function(){return this}()||Function("return this")(),le={},de={get exports(){return le},set exports(r){le=r}},he=X,se=Object.defineProperty,ie=function(r,a){try{se(he,r,{value:a,configurable:!0,writable:!0})}catch{he[r]=a}return a},oe=ie,ee="__core-js_shared__",Q=X[ee]||oe(ee,{}),ue=Q;(de.exports=function(r,a){return ue[r]||(ue[r]=a!==void 0?a:{})})("versions",[]).push({version:"3.30.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.0/LICENSE",source:"https://github.com/zloirock/core-js"});var me,be,ke=z,Ye=Object,Oe=function(r){return Ye(ke(r))},Ee=Oe,we=b({}.hasOwnProperty),Ge=Object.hasOwn||function(r,a){return we(Ee(r),a)},Ve=b,qe=0,st=Math.random(),Ie=Ve(1 .toString),Ae=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Ie(++qe+st,36)},xe=typeof navigator<"u"&&String(navigator.userAgent)||"",ot=X,je=xe,at=ot.process,ht=ot.Deno,dt=at&&at.versions||ht&&ht.version,ft=dt&&dt.v8;ft&&(be=(me=ft.split("."))[0]>0&&me[0]<4?1:+(me[0]+me[1])),!be&&je&&(!(me=je.match(/Edge\/(\d+)/))||me[1]>=74)&&(me=je.match(/Chrome\/(\d+)/))&&(be=+me[1]);var Je=be,Et=Je,Nt=c,et=!!Object.getOwnPropertySymbols&&!Nt(function(){var r=Symbol();return!String(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&Et&&Et<41}),Mt=et&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Jt=le,sn=Ge,gn=Ae,Bt=et,nt=Mt,It=X.Symbol,ct=Jt("wks"),Ke=nt?It.for||It:It&&It.withoutSetter||gn,Xe=function(r){return sn(ct,r)||(ct[r]=Bt&&sn(It,r)?It[r]:Ke("Symbol."+r)),ct[r]},Dt=typeof document=="object"&&document.all,$e={all:Dt,IS_HTMLDDA:Dt===void 0&&Dt!==void 0},xt=$e.all,jt=$e.IS_HTMLDDA?function(r){return typeof r=="function"||r===xt}:function(r){return typeof r=="function"},Fn=jt,oo=$e.all,zn=$e.IS_HTMLDDA?function(r){return typeof r=="object"?r!==null:Fn(r)||r===oo}:function(r){return typeof r=="object"?r!==null:Fn(r)},kn=zn,Po=String,q=TypeError,xo=function(r){if(kn(r))return r;throw q(Po(r)+" is not an object")},_n={},eo=!c(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ls=eo&&c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Ir={},ks=zn,sr=X.document,ca=ks(sr)&&ks(sr.createElement),As=function(r){return ca?sr.createElement(r):{}},Dd=As,Ct=!eo&&!c(function(){return Object.defineProperty(Dd("div"),"a",{get:function(){return 7}}).a!=7}),Tt=u,Xt=Function.prototype.call,Cn=Tt?Xt.bind(Xt):function(){return Xt.apply(Xt,arguments)},un=X,hr=jt,xn=function(r,a){return arguments.length<2?(d=un[r],hr(d)?d:void 0):un[r]&&un[r][a];var d},Rt=b({}.isPrototypeOf),ko=xn,Lr=jt,wl=Rt,ni=Object,yt=Mt?function(r){return typeof r=="symbol"}:function(r){var a=ko("Symbol");return Lr(a)&&wl(a.prototype,ni(r))},an=String,dn=function(r){try{return an(r)}catch{return"Object"}},ro=jt,Er=dn,gi=TypeError,Ni=function(r){if(ro(r))return r;throw gi(Er(r)+" is not a function")},E1=Ni,Sn=F,Qe=function(r,a){var d=r[a];return Sn(d)?void 0:E1(d)},Dl=Cn,Wm=jt,Ga=zn,EI=TypeError,MI=Cn,kI=zn,Od=yt,Nd=Qe,jm=function(r,a){var d,g;if(a==="string"&&Wm(d=r.toString)&&!Ga(g=Dl(d,r))||Wm(d=r.valueOf)&&!Ga(g=Dl(d,r))||a!=="string"&&Wm(d=r.toString)&&!Ga(g=Dl(d,r)))return g;throw EI("Can't convert object to primitive value")},Ym=TypeError,Mr=Xe("toPrimitive"),Dr=function(r,a){if(!kI(r)||Od(r))return r;var d,g=Nd(r,Mr);if(g){if(a===void 0&&(a="default"),d=MI(g,r,a),!kI(d)||Od(d))return d;throw Ym("Can't convert object to primitive value")}return a===void 0&&(a="number"),jm(r,a)},Qo=Dr,Pr=yt,fr=function(r){var a=Qo(r,"string");return Pr(a)?a:a+""},ap=eo,AI=Ct,Ld=ls,Pd=xo,Jm=fr,RI=TypeError,Ud=Object.defineProperty,wI=Object.getOwnPropertyDescriptor,xd="enumerable",Li="configurable",lp="writable";Ir.f=ap?Ld?function(r,a,d){if(Pd(r),a=Jm(a),Pd(d),typeof r=="function"&&a==="prototype"&&"value"in d&&lp in d&&!d[lp]){var g=wI(r,a);g&&g[lp]&&(r[a]=d.value,d={configurable:Li in d?d[Li]:g[Li],enumerable:xd in d?d[xd]:g[xd],writable:!1})}return Ud(r,a,d)}:Ud:function(r,a,d){if(Pd(r),a=Jm(a),Pd(d),AI)try{return Ud(r,a,d)}catch{}if("get"in d||"set"in d)throw RI("Accessors not supported");return"value"in d&&(r[a]=d.value),r};var DI=Math.ceil,Zo=Math.floor,Fd=Math.trunc||function(r){var a=+r;return(a>0?Zo:DI)(a)},OI=Fd,cs=function(r){var a=+r;return a!=a||a===0?0:OI(a)},Xm=cs,Ol=Math.max,oi=Math.min,Vd=function(r,a){var d=Xm(r);return d<0?Ol(d+a,0):oi(d,a)},NI=cs,ar=Math.min,Ba=function(r){return r>0?ar(NI(r),9007199254740991):0},LI=Ba,Ur=function(r){return LI(r.length)},St=$,Pi=Vd,Fc=Ur,Vc=function(r){return function(a,d,g){var C,A=St(a),w=Fc(A),V=Pi(g,w);if(r&&d!=d){for(;w>V;)if((C=A[V++])!=C)return!0}else for(;w>V;V++)if((r||V in A)&&A[V]===d)return r||V||0;return!r&&-1}},cp={includes:Vc(!0),indexOf:Vc(!1)},Gd={},us=Ge,xr=$,Rs=cp.indexOf,up=Gd,Qm=b([].push),$a=function(r,a){var d,g=xr(r),C=0,A=[];for(d in g)!us(up,d)&&us(g,d)&&Qm(A,d);for(;a.length>C;)us(g,d=a[C++])&&(~Rs(A,d)||Qm(A,d));return A},Bd=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dp=$a,ds=Bd,Zm=Object.keys||function(r){return dp(r,ds)},Gc=eo,hp=ls,$d=Ir,ev=xo,tv=$,PI=Zm;_n.f=Gc&&!hp?Object.defineProperties:function(r,a){ev(r);for(var d,g=tv(a),C=PI(a),A=C.length,w=0;A>w;)$d.f(r,d=C[w++],g[d]);return r};var Ut,ln=xn("document","documentElement"),Re=Ae,nv=le("keys"),Bc=function(r){return nv[r]||(nv[r]=Re(r))},Ui=xo,ov=_n,ws=Bd,UI=Gd,Hd=ln,$c=As,kt="prototype",Bn="script",Wn=Bc("IE_PROTO"),to=function(){},rv=function(r){return"<"+Bn+">"+r+"</"+Bn+">"},xI=function(r){r.write(rv("")),r.close();var a=r.parentWindow.Object;return r=null,a},so=function(){try{Ut=new ActiveXObject("htmlfile")}catch{}var r,a,d;so=typeof document<"u"?document.domain&&Ut?xI(Ut):(a=$c("iframe"),d="java"+Bn+":",a.style.display="none",Hd.appendChild(a),a.src=String(d),(r=a.contentWindow.document).open(),r.write(rv("document.F=Object")),r.close(),r.F):xI(Ut);for(var g=ws.length;g--;)delete so[kt][ws[g]];return so()};UI[Wn]=!0;var Be=Object.create||function(r,a){var d;return r!==null?(to[kt]=Ui(r),d=new to,to[kt]=null,d[Wn]=r):d=so(),a===void 0?d:ov.f(d,a)},Nl=Xe,Uo=Be,fe=Ir.f,qd=Nl("unscopables"),Kd=Array.prototype;Kd[qd]==null&&fe(Kd,qd,{configurable:!0,value:Uo(null)});var ua,Ds,da,Ha=function(r){Kd[qd][r]=!0},kr={},Hc=jt,qc=X.WeakMap,zd=Hc(qc)&&/native code/.test(String(qc)),Kc=function(r,a){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:a}},M1=Ir,FI=Kc,ha=eo?function(r,a,d){return M1.f(r,a,FI(1,d))}:function(r,a,d){return r[a]=d,r},it=zd,fp=X,iv=zn,sv=ha,Wd=Ge,av=Q,VI=Bc,k1=Gd,lv="Object already initialized",Yd=fp.TypeError,cv=fp.WeakMap;if(it||av.state){var Wi=av.state||(av.state=new cv);Wi.get=Wi.get,Wi.has=Wi.has,Wi.set=Wi.set,ua=function(r,a){if(Wi.has(r))throw Yd(lv);return a.facade=r,Wi.set(r,a),a},Ds=function(r){return Wi.get(r)||{}},da=function(r){return Wi.has(r)}}else{var qa=VI("state");k1[qa]=!0,ua=function(r,a){if(Wd(r,qa))throw Yd(lv);return a.facade=r,sv(r,qa,a),a},Ds=function(r){return Wd(r,qa)?r[qa]:{}},da=function(r){return Wd(r,qa)}}var Wr={set:ua,get:Ds,has:da,enforce:function(r){return da(r)?Ds(r):ua(r,{})},getterFor:function(r){return function(a){var d;if(!iv(a)||(d=Ds(a)).type!==r)throw Yd("Incompatible receiver, "+r+" required");return d}}},Ka={},Jd={},er={}.propertyIsEnumerable,pp=Object.getOwnPropertyDescriptor,uv=pp&&!er.call({1:2},1);Jd.f=uv?function(r){var a=pp(this,r);return!!a&&a.enumerable}:er;var dv=eo,hv=Cn,fv=Jd,pv=Kc,gv=$,mv=fr,vv=Ge,_v=Ct,gp=Object.getOwnPropertyDescriptor;Ka.f=dv?gp:function(r,a){if(r=gv(r),a=mv(a),_v)try{return gp(r,a)}catch{}if(vv(r,a))return pv(!hv(fv.f,r,a),r[a])};var zc={},yv={get exports(){return zc},set exports(r){zc=r}},Ll=eo,Iv=Ge,Xd=Function.prototype,mp=Ll&&Object.getOwnPropertyDescriptor,vp=Iv(Xd,"name"),Qd={EXISTS:vp,PROPER:vp&&(function(){}).name==="something",CONFIGURABLE:vp&&(!Ll||Ll&&mp(Xd,"name").configurable)},A1=jt,So=Q,bv=b(Function.toString);A1(So.inspectSource)||(So.inspectSource=function(r){return bv(r)});var Pl=So.inspectSource,Zd=b,GI=c,BI=jt,Ul=Ge,_p=eo,$I=Qd.CONFIGURABLE,HI=Pl,qI=Wr.enforce,KI=Wr.get,zI=String,yp=Object.defineProperty,eh=Zd("".slice),R1=Zd("".replace),Cv=Zd([].join),w1=_p&&!GI(function(){return yp(function(){},"length",{value:8}).length!==8}),fa=String(String).split("String"),Ip=yv.exports=function(r,a,d){eh(zI(a),0,7)==="Symbol("&&(a="["+R1(zI(a),/^Symbol\(([^)]*)\)/,"$1")+"]"),d&&d.getter&&(a="get "+a),d&&d.setter&&(a="set "+a),(!Ul(r,"name")||$I&&r.name!==a)&&(_p?yp(r,"name",{value:a,configurable:!0}):r.name=a),w1&&d&&Ul(d,"arity")&&r.length!==d.arity&&yp(r,"length",{value:d.arity});try{d&&Ul(d,"constructor")&&d.constructor?_p&&yp(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var g=qI(r);return Ul(g,"source")||(g.source=Cv(fa,typeof a=="string"?a:"")),r};Function.prototype.toString=Ip(function(){return BI(this)&&KI(this).source||HI(this)},"toString");var WI=jt,D1=Ir,O1=zc,N1=ie,ji=function(r,a,d,g){g||(g={});var C=g.enumerable,A=g.name!==void 0?g.name:a;if(WI(d)&&O1(d,A,g),g.global)C?r[a]=d:N1(a,d);else{try{g.unsafe?r[a]&&(C=!0):delete r[a]}catch{}C?r[a]=d:D1.f(r,a,{value:d,enumerable:!1,configurable:!g.nonConfigurable,writable:!g.nonWritable})}return r},th={},L1=$a,P1=Bd.concat("length","prototype");th.f=Object.getOwnPropertyNames||function(r){return L1(r,P1)};var Sv={};Sv.f=Object.getOwnPropertySymbols;var za,jI,YI,U1=xn,x1=th,F1=Sv,V1=xo,G1=b([].concat),B1=U1("Reflect","ownKeys")||function(r){var a=x1.f(V1(r)),d=F1.f;return d?G1(a,d(r)):a},JI=Ge,$1=B1,XI=Ka,H1=Ir,QI=function(r,a,d){for(var g=$1(a),C=H1.f,A=XI.f,w=0;w<g.length;w++){var V=g[w];JI(r,V)||d&&JI(d,V)||C(r,V,A(a,V))}},q1=c,K1=jt,z1=/#|\.prototype\./,nh=function(r,a){var d=Tv[oh(r)];return d==Ev||d!=rh&&(K1(a)?q1(a):!!a)},oh=nh.normalize=function(r){return String(r).replace(z1,".").toLowerCase()},Tv=nh.data={},rh=nh.NATIVE="N",Ev=nh.POLYFILL="P",ih=nh,sh=X,ah=Ka.f,Mv=ha,lh=ji,kv=ie,Av=QI,Rv=ih,jo=function(r,a){var d,g,C,A,w,V=r.target,U=r.global,j=r.stat;if(d=U?sh:j?sh[V]||kv(V,{}):(sh[V]||{}).prototype)for(g in a){if(A=a[g],C=r.dontCallGetSet?(w=ah(d,g))&&w.value:d[g],!Rv(U?g:V+(j?".":"#")+g,r.forced)&&C!==void 0){if(typeof A==typeof C)continue;Av(A,C)}(r.sham||C&&C.sham)&&Mv(A,"sham",!0),lh(d,g,A,r)}},wv=!c(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Dv=Ge,Ov=jt,Nv=Oe,Lv=wv,Wc=Bc("IE_PROTO"),ch=Object,Pv=ch.prototype,jc=Lv?ch.getPrototypeOf:function(r){var a=Nv(r);if(Dv(a,Wc))return a[Wc];var d=a.constructor;return Ov(d)&&a instanceof d?d.prototype:a instanceof ch?Pv:null},Uv=c,xv=jt,Fv=zn,uh=jc,ZI=ji,bp=Xe("iterator"),eb=!1;[].keys&&("next"in(YI=[].keys())?(jI=uh(uh(YI)))!==Object.prototype&&(za=jI):eb=!0);var W1=!Fv(za)||Uv(function(){var r={};return za[bp].call(r)!==r});W1&&(za={}),xv(za[bp])||ZI(za,bp,function(){return this});var Vv={IteratorPrototype:za,BUGGY_SAFARI_ITERATORS:eb},Gv=Ir.f,Bv=Ge,tb=Xe("toStringTag"),Wa=function(r,a,d){r&&!d&&(r=r.prototype),r&&!Bv(r,tb)&&Gv(r,tb,{configurable:!0,value:a})},dh=Vv.IteratorPrototype,$v=Be,Hv=Kc,nb=Wa,ob=kr,jr=function(){return this},Cp=function(r,a,d,g){var C=a+" Iterator";return r.prototype=$v(dh,{next:Hv(+!g,d)}),nb(r,C,!1),ob[C]=jr,r},j1=b,Y1=Ni,J1=jt,X1=String,Q1=TypeError,Z1=function(r,a,d){try{return j1(Y1(Object.getOwnPropertyDescriptor(r,a)[d]))}catch{}},qv=xo,hh=function(r){if(typeof r=="object"||J1(r))return r;throw Q1("Can't set "+X1(r)+" as a prototype")},Os=Object.setPrototypeOf||("__proto__"in{}?function(){var r,a=!1,d={};try{(r=Z1(Object.prototype,"__proto__","set"))(d,[]),a=d instanceof Array}catch{}return function(g,C){return qv(g),hh(C),a?r(g,C):g.__proto__=C,g}}():void 0),eM=jo,rb=Cn,Sp=jt,ri=Cp,Kv=jc,zv=Os,ib=Wa,sb=ha,Tp=ji,ab=kr,lb=Qd.PROPER,tM=Qd.CONFIGURABLE,cb=Vv.IteratorPrototype,Ep=Vv.BUGGY_SAFARI_ITERATORS,fh=Xe("iterator"),ub="keys",ph="values",db="entries",Mp=function(){return this},Yc=function(r,a,d,g,C,A,w){ri(d,a,g);var V,U,j,re=function($t){if($t===C&&_t)return _t;if(!Ep&&$t in De)return De[$t];switch($t){case ub:case ph:case db:return function(){return new d(this,$t)}}return function(){return new d(this)}},ce=a+" Iterator",Te=!1,De=r.prototype,ze=De[fh]||De["@@iterator"]||C&&De[C],_t=!Ep&&ze||re(C),Ft=a=="Array"&&De.entries||ze;if(Ft&&(V=Kv(Ft.call(new r)))!==Object.prototype&&V.next&&(Kv(V)!==cb&&(zv?zv(V,cb):Sp(V[fh])||Tp(V,fh,Mp)),ib(V,ce,!0)),lb&&C==ph&&ze&&ze.name!==ph&&(tM?sb(De,"name",ph):(Te=!0,_t=function(){return rb(ze,this)})),C)if(U={values:re(ph),keys:A?_t:re(ub),entries:re(db)},w)for(j in U)(Ep||Te||!(j in De))&&Tp(De,j,U[j]);else eM({target:a,proto:!0,forced:Ep||Te},U);return De[fh]!==_t&&Tp(De,fh,_t,{name:C}),ab[a]=_t,U},Jc=function(r,a){return{value:r,done:a}},gh=$,xl=Ha,Xc=kr,Qc=Wr,Wv=Ir.f,nM=Yc,hb=Jc,fb=eo,kp="Array Iterator",oM=Qc.set,jv=Qc.getterFor(kp),rM=nM(Array,"Array",function(r,a){oM(this,{type:kp,target:gh(r),index:0,kind:a})},function(){var r=jv(this),a=r.target,d=r.kind,g=r.index++;return!a||g>=a.length?(r.target=void 0,hb(void 0,!0)):hb(d=="keys"?g:d=="values"?a[g]:[g,a[g]],!1)},"values"),pb=Xc.Arguments=Xc.Array;if(xl("keys"),xl("values"),xl("entries"),fb&&pb.name!=="values")try{Wv(pb,"name",{value:"values"})}catch{}var gb={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Fl=As("span").classList,Yv=Fl&&Fl.constructor&&Fl.constructor.prototype,Vl=Yv===Object.prototype?void 0:Yv,mb=X,Ap=gb,iM=Vl,mh=rM,Jv=ha,vb=Xe,Xv=vb("iterator"),_b=vb("toStringTag"),Rp=mh.values,wp=function(r,a){if(r){if(r[Xv]!==Rp)try{Jv(r,Xv,Rp)}catch{r[Xv]=Rp}if(r[_b]||Jv(r,_b,a),Ap[a]){for(var d in mh)if(r[d]!==mh[d])try{Jv(r,d,mh[d])}catch{r[d]=mh[d]}}}};for(var Dp in Ap)wp(mb[Dp]&&mb[Dp].prototype,Dp);wp(iM,"DOMTokenList");var ja=typeof process<"u"&&R(process)=="process",yb=zc,Qv=Ir,pa=function(r,a,d){return d.get&&yb(d.get,a,{getter:!0}),d.set&&yb(d.set,a,{setter:!0}),Qv.f(r,a,d)},vh=xn,Zv=pa,e_=eo,Op=Xe("species"),Np=function(r){var a=vh(r);e_&&a&&!a[Op]&&Zv(a,Op,{configurable:!0,get:function(){return this}})},sM=Rt,Ib=TypeError,Zc=function(r,a){if(sM(a,r))return r;throw Ib("Incorrect invocation")},t_={};t_[Xe("toStringTag")]="z";var bb=String(t_)==="[object z]",Cb=jt,_h=R,Sb=Xe("toStringTag"),Tb=Object,Eb=_h(function(){return arguments}())=="Arguments",ga=bb?_h:function(r){var a,d,g;return r===void 0?"Undefined":r===null?"Null":typeof(d=function(C,A){try{return C[A]}catch{}}(a=Tb(r),Sb))=="string"?d:Eb?_h(a):(g=_h(a))=="Object"&&Cb(a.callee)?"Arguments":g},Mb=b,aM=c,kb=jt,lM=ga,cM=Pl,Ab=function(){},uM=[],Rb=xn("Reflect","construct"),n_=/^\s*(?:class|function)\b/,wb=Mb(n_.exec),dM=!n_.exec(Ab),Gl=function(r){if(!kb(r))return!1;try{return Rb(Ab,uM,r),!0}catch{return!1}},Db=function(r){if(!kb(r))return!1;switch(lM(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return dM||!!wb(n_,cM(r))}catch{return!0}};Db.sham=!0;var eu,tu,Ob,o_,r_=!Rb||aM(function(){var r;return Gl(Gl.call)||!Gl(Object)||!Gl(function(){r=!0})||r})?Db:Gl,hM=r_,fM=dn,pM=TypeError,Nb=function(r){if(hM(r))return r;throw pM(fM(r)+" is not a constructor")},Lb=xo,gM=Nb,mM=F,vM=Xe("species"),i_=function(r,a){var d,g=Lb(r).constructor;return g===void 0||mM(d=Lb(g)[vM])?a:gM(d)},_M=u,Pb=Function.prototype,Ub=Pb.apply,xb=Pb.call,Fb=typeof Reflect=="object"&&Reflect.apply||(_M?xb.bind(Ub):function(){return xb.apply(Ub,arguments)}),mi=R,yM=b,yh=function(r){if(mi(r)==="Function")return yM(r)},IM=Ni,bM=u,CM=yh(yh.bind),Ns=function(r,a){return IM(r),a===void 0?r:bM?CM(r,a):function(){return r.apply(a,arguments)}},s_=b([].slice),a_=TypeError,Bl=function(r,a){if(r<a)throw a_("Not enough arguments");return r},nu=/(?:ipad|iphone|ipod).*applewebkit/i.test(xe),ii=X,l_=Fb,c_=Ns,Lp=jt,u_=Ge,ou=c,ru=ln,Ih=s_,Pp=As,d_=Bl,bh=nu,Ch=ja,Sh=ii.setImmediate,Th=ii.clearImmediate,h_=ii.process,Eh=ii.Dispatch,f_=ii.Function,iu=ii.MessageChannel,p_=ii.String,Mh=0,$l={},Up="onreadystatechange";ou(function(){eu=ii.location});var Hl=function(r){if(u_($l,r)){var a=$l[r];delete $l[r],a()}},ql=function(r){return function(){Hl(r)}},su=function(r){Hl(r.data)},au=function(r){ii.postMessage(p_(r),eu.protocol+"//"+eu.host)};Sh&&Th||(Sh=function(r){d_(arguments.length,1);var a=Lp(r)?r:f_(r),d=Ih(arguments,1);return $l[++Mh]=function(){l_(a,void 0,d)},tu(Mh),Mh},Th=function(r){delete $l[r]},Ch?tu=function(r){h_.nextTick(ql(r))}:Eh&&Eh.now?tu=function(r){Eh.now(ql(r))}:iu&&!bh?(o_=(Ob=new iu).port2,Ob.port1.onmessage=su,tu=c_(o_.postMessage,o_)):ii.addEventListener&&Lp(ii.postMessage)&&!ii.importScripts&&eu&&eu.protocol!=="file:"&&!ou(au)?(tu=au,ii.addEventListener("message",su,!1)):tu=Up in Pp("script")?function(r){ru.appendChild(Pp("script"))[Up]=function(){ru.removeChild(this),Hl(r)}}:function(r){setTimeout(ql(r),0)});var tr={set:Sh,clear:Th},n=function(){this.head=null,this.tail=null};n.prototype={add:function(r){var a={item:r,next:null},d=this.tail;d?d.next=a:this.head=a,this.tail=a},get:function(){var r=this.head;if(r)return(this.head=r.next)===null&&(this.tail=null),r.item}};var s,l,h,v,I,k=n,P=/ipad|iphone|ipod/i.test(xe)&&typeof Pebble<"u",G=/web0s(?!.*chrome)/i.test(xe),Y=X,te=Ns,pe=Ka.f,ye=tr.set,ve=k,Ue=nu,ut=P,mt=G,Kt=ja,en=Y.MutationObserver||Y.WebKitMutationObserver,Un=Y.document,vo=Y.process,nr=Y.Promise,pr=pe(Y,"queueMicrotask"),br=pr&&pr.value;if(!br){var Ya=new ve,Ja=function(){var r,a;for(Kt&&(r=vo.domain)&&r.exit();a=Ya.get();)try{a()}catch(d){throw Ya.head&&s(),d}r&&r.enter()};Ue||Kt||mt||!en||!Un?!ut&&nr&&nr.resolve?((v=nr.resolve(void 0)).constructor=nr,I=te(v.then,v),s=function(){I(Ja)}):Kt?s=function(){vo.nextTick(Ja)}:(ye=te(ye,Y),s=function(){ye(Ja)}):(l=!0,h=Un.createTextNode(""),new en(Ja).observe(h,{characterData:!0}),s=function(){h.data=l=!l}),br=function(r){Ya.head||s(),Ya.add(r)}}var lu=br,hs=function(r){try{return{error:!1,value:r()}}catch(a){return{error:!0,value:a}}},Xa=X.Promise,Vb=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",$W=!Vb&&!ja&&typeof window=="object"&&typeof document=="object",HW=X,g_=Xa,qW=jt,KW=ih,zW=Pl,WW=Xe,jW=$W,YW=Vb,SM=Je;g_&&g_.prototype;var JW=WW("species"),y2=!1,I2=qW(HW.PromiseRejectionEvent),XW=KW("Promise",function(){var r=zW(g_),a=r!==String(g_);if(!a&&SM===66)return!0;if(!SM||SM<51||!/native code/.test(r)){var d=new g_(function(C){C(1)}),g=function(C){C(function(){},function(){})};if((d.constructor={})[JW]=g,!(y2=d.then(function(){})instanceof g))return!0}return!a&&(jW||YW)&&!I2}),kh={CONSTRUCTOR:XW,REJECTION_EVENT:I2,SUBCLASSING:y2},xp={},b2=Ni,QW=TypeError,ZW=function(r){var a,d;this.promise=new r(function(g,C){if(a!==void 0||d!==void 0)throw QW("Bad Promise constructor");a=g,d=C}),this.resolve=b2(a),this.reject=b2(d)};xp.f=function(r){return new ZW(r)};var TM,C2,S2,ej=jo,Gb=ja,cu=X,Fp=Cn,T2=ji,E2=Os,tj=Wa,nj=Np,oj=Ni,Bb=jt,rj=zn,ij=Zc,sj=i_,M2=tr.set,EM=lu,aj=function(r,a){try{arguments.length==1?console.error(r):console.error(r,a)}catch{}},lj=hs,cj=k,k2=Wr,$b=Xa,A2=xp,Hb="Promise",R2=kh.CONSTRUCTOR,uj=kh.REJECTION_EVENT,dj=kh.SUBCLASSING,MM=k2.getterFor(Hb),hj=k2.set,Vp=$b&&$b.prototype,Gp=$b,qb=Vp,w2=cu.TypeError,kM=cu.document,AM=cu.process,RM=A2.f,fj=RM,pj=!!(kM&&kM.createEvent&&cu.dispatchEvent),D2="unhandledrejection",O2=function(r){var a;return!(!rj(r)||!Bb(a=r.then))&&a},N2=function(r,a){var d,g,C,A=a.value,w=a.state==1,V=w?r.ok:r.fail,U=r.resolve,j=r.reject,re=r.domain;try{V?(w||(a.rejection===2&&mj(a),a.rejection=1),V===!0?d=A:(re&&re.enter(),d=V(A),re&&(re.exit(),C=!0)),d===r.promise?j(w2("Promise-chain cycle")):(g=O2(d))?Fp(g,d,U,j):U(d)):j(A)}catch(ce){re&&!C&&re.exit(),j(ce)}},L2=function(r,a){r.notified||(r.notified=!0,EM(function(){for(var d,g=r.reactions;d=g.get();)N2(d,r);r.notified=!1,a&&!r.rejection&&gj(r)}))},P2=function(r,a,d){var g,C;pj?((g=kM.createEvent("Event")).promise=a,g.reason=d,g.initEvent(r,!1,!0),cu.dispatchEvent(g)):g={promise:a,reason:d},!uj&&(C=cu["on"+r])?C(g):r===D2&&aj("Unhandled promise rejection",d)},gj=function(r){Fp(M2,cu,function(){var a,d=r.facade,g=r.value;if(U2(r)&&(a=lj(function(){Gb?AM.emit("unhandledRejection",g,d):P2(D2,d,g)}),r.rejection=Gb||U2(r)?2:1,a.error))throw a.value})},U2=function(r){return r.rejection!==1&&!r.parent},mj=function(r){Fp(M2,cu,function(){var a=r.facade;Gb?AM.emit("rejectionHandled",a):P2("rejectionhandled",a,r.value)})},Bp=function(r,a,d){return function(g){r(a,g,d)}},$p=function(r,a,d){r.done||(r.done=!0,d&&(r=d),r.value=a,r.state=2,L2(r,!0))},wM=function(r,a,d){if(!r.done){r.done=!0,d&&(r=d);try{if(r.facade===a)throw w2("Promise can't be resolved itself");var g=O2(a);g?EM(function(){var C={done:!1};try{Fp(g,a,Bp(wM,C,r),Bp($p,C,r))}catch(A){$p(C,A,r)}}):(r.value=a,r.state=1,L2(r,!1))}catch(C){$p({done:!1},C,r)}}};if(R2&&(qb=(Gp=function(r){ij(this,qb),oj(r),Fp(TM,this);var a=MM(this);try{r(Bp(wM,a),Bp($p,a))}catch(d){$p(a,d)}}).prototype,(TM=function(r){hj(this,{type:Hb,done:!1,notified:!1,parent:!1,reactions:new cj,rejection:!1,state:0,value:void 0})}).prototype=T2(qb,"then",function(r,a){var d=MM(this),g=RM(sj(this,Gp));return d.parent=!0,g.ok=!Bb(r)||r,g.fail=Bb(a)&&a,g.domain=Gb?AM.domain:void 0,d.state==0?d.reactions.add(g):EM(function(){N2(g,d)}),g.promise}),C2=function(){var r=new TM,a=MM(r);this.promise=r,this.resolve=Bp(wM,a),this.reject=Bp($p,a)},A2.f=RM=function(r){return r===Gp||r===void 0?new C2(r):fj(r)},Bb($b)&&Vp!==Object.prototype)){S2=Vp.then,dj||T2(Vp,"then",function(r,a){var d=this;return new Gp(function(g,C){Fp(S2,d,g,C)}).then(r,a)},{unsafe:!0});try{delete Vp.constructor}catch{}E2&&E2(Vp,qb)}ej({global:!0,constructor:!0,wrap:!0,forced:R2},{Promise:Gp}),tj(Gp,Hb,!1),nj(Hb);var vj=kr,_j=Xe("iterator"),yj=Array.prototype,DM=function(r){return r!==void 0&&(vj.Array===r||yj[_j]===r)},Ij=ga,x2=Qe,bj=F,Cj=kr,Sj=Xe("iterator"),m_=function(r){if(!bj(r))return x2(r,Sj)||x2(r,"@@iterator")||Cj[Ij(r)]},Tj=Cn,Ej=Ni,Mj=xo,kj=dn,Aj=m_,Rj=TypeError,Kb=function(r,a){var d=arguments.length<2?Aj(r):a;if(Ej(d))return Mj(Tj(d,r));throw Rj(kj(r)+" is not iterable")},wj=Cn,F2=xo,Dj=Qe,V2=function(r,a,d){var g,C;F2(r);try{if(!(g=Dj(r,"return"))){if(a==="throw")throw d;return d}g=wj(g,r)}catch(A){C=!0,g=A}if(a==="throw")throw d;if(C)throw g;return F2(g),d},Oj=Ns,Nj=Cn,Lj=xo,Pj=dn,Uj=DM,xj=Ur,G2=Rt,Fj=Kb,Vj=m_,B2=V2,Gj=TypeError,zb=function(r,a){this.stopped=r,this.result=a},$2=zb.prototype,H2=function(r,a,d){var g,C,A,w,V,U,j,re=d&&d.that,ce=!(!d||!d.AS_ENTRIES),Te=!(!d||!d.IS_RECORD),De=!(!d||!d.IS_ITERATOR),ze=!(!d||!d.INTERRUPTED),_t=Oj(a,re),Ft=function(bt){return g&&B2(g,"normal",bt),new zb(!0,bt)},$t=function(bt){return ce?(Lj(bt),ze?_t(bt[0],bt[1],Ft):_t(bt[0],bt[1])):ze?_t(bt,Ft):_t(bt)};if(Te)g=r.iterator;else if(De)g=r;else{if(!(C=Vj(r)))throw Gj(Pj(r)+" is not iterable");if(Uj(C)){for(A=0,w=xj(r);w>A;A++)if((V=$t(r[A]))&&G2($2,V))return V;return new zb(!1)}g=Fj(r,C)}for(U=Te?r.next:g.next;!(j=Nj(U,g)).done;){try{V=$t(j.value)}catch(bt){B2(g,"throw",bt)}if(typeof V=="object"&&V&&G2($2,V))return V}return new zb(!1)},q2=Xe("iterator"),K2=!1;try{var Bj=0,z2={next:function(){return{done:!!Bj++}},return:function(){K2=!0}};z2[q2]=function(){return this},Array.from(z2,function(){throw 2})}catch{}var W2=function(r,a){if(!a&&!K2)return!1;var d=!1;try{var g={};g[q2]=function(){return{next:function(){return{done:d=!0}}}},r(g)}catch{}return d},$j=Xa,j2=kh.CONSTRUCTOR||!W2(function(r){$j.all(r).then(void 0,function(){})}),Hj=Cn,qj=Ni,Kj=xp,zj=hs,Wj=H2;jo({target:"Promise",stat:!0,forced:j2},{all:function(r){var a=this,d=Kj.f(a),g=d.resolve,C=d.reject,A=zj(function(){var w=qj(a.resolve),V=[],U=0,j=1;Wj(r,function(re){var ce=U++,Te=!1;j++,Hj(w,a,re).then(function(De){Te||(Te=!0,V[ce]=De,--j||g(V))},C)}),--j||g(V)});return A.error&&C(A.value),d.promise}});var jj=jo,Yj=kh.CONSTRUCTOR,OM=Xa,Jj=xn,Xj=jt,Qj=ji,Y2=OM&&OM.prototype;if(jj({target:"Promise",proto:!0,forced:Yj,real:!0},{catch:function(r){return this.then(void 0,r)}}),Xj(OM)){var J2=Jj("Promise").prototype.catch;Y2.catch!==J2&&Qj(Y2,"catch",J2,{unsafe:!0})}var Zj=Cn,eY=Ni,tY=xp,nY=hs,oY=H2;jo({target:"Promise",stat:!0,forced:j2},{race:function(r){var a=this,d=tY.f(a),g=d.reject,C=nY(function(){var A=eY(a.resolve);oY(r,function(w){Zj(A,a,w).then(d.resolve,g)})});return C.error&&g(C.value),d.promise}});var rY=Cn,iY=xp;jo({target:"Promise",stat:!0,forced:kh.CONSTRUCTOR},{reject:function(r){var a=iY.f(this);return rY(a.reject,void 0,r),a.promise}});var sY=xo,aY=zn,lY=xp,X2=function(r,a){if(sY(r),aY(a)&&a.constructor===r)return a;var d=lY.f(r);return(0,d.resolve)(a),d.promise},cY=jo,uY=kh.CONSTRUCTOR,dY=X2;xn("Promise"),cY({target:"Promise",stat:!0,forced:uY},{resolve:function(r){return dY(this,r)}});var hY=jt,fY=zn,Q2=Os,Z2=function(r,a,d){var g,C;return Q2&&hY(g=a.constructor)&&g!==d&&fY(C=g.prototype)&&C!==d.prototype&&Q2(r,C),r},pY=zn,gY=R,mY=Xe("match"),eP=function(r){var a;return pY(r)&&((a=r[mY])!==void 0?!!a:gY(r)=="RegExp")},vY=ga,_Y=String,fs=function(r){if(vY(r)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return _Y(r)},yY=xo,tP=function(){var r=yY(this),a="";return r.hasIndices&&(a+="d"),r.global&&(a+="g"),r.ignoreCase&&(a+="i"),r.multiline&&(a+="m"),r.dotAll&&(a+="s"),r.unicode&&(a+="u"),r.unicodeSets&&(a+="v"),r.sticky&&(a+="y"),a},IY=Cn,bY=Ge,CY=Rt,SY=tP,nP=RegExp.prototype,oP=function(r){var a=r.flags;return a!==void 0||"flags"in nP||bY(r,"flags")||!CY(nP,r)?a:IY(SY,r)},NM=c,LM=X.RegExp,PM=NM(function(){var r=LM("a","y");return r.lastIndex=2,r.exec("abcd")!=null}),TY=PM||NM(function(){return!LM("a","y").sticky}),EY=PM||NM(function(){var r=LM("^r","gy");return r.lastIndex=2,r.exec("str")!=null}),rP={BROKEN_CARET:EY,MISSED_STICKY:TY,UNSUPPORTED_Y:PM},MY=Ir.f,kY=c,AY=X.RegExp,iP=kY(function(){var r=AY(".","s");return!(r.dotAll&&r.exec(`
`)&&r.flags==="s")}),RY=c,wY=X.RegExp,sP=RY(function(){var r=wY("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),DY=eo,UM=X,v_=b,OY=ih,NY=Z2,LY=ha,PY=th.f,aP=Rt,UY=eP,lP=fs,xY=oP,cP=rP,FY=function(r,a,d){d in r||MY(r,d,{configurable:!0,get:function(){return a[d]},set:function(g){a[d]=g}})},VY=ji,GY=c,BY=Ge,$Y=Wr.enforce,HY=Np,uP=iP,dP=sP,qY=Xe("match"),uu=UM.RegExp,Hp=uu.prototype,KY=UM.SyntaxError,zY=v_(Hp.exec),Wb=v_("".charAt),hP=v_("".replace),fP=v_("".indexOf),WY=v_("".slice),jY=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ah=/a/g,xM=/a/g,YY=new uu(Ah)!==Ah,pP=cP.MISSED_STICKY,JY=cP.UNSUPPORTED_Y,XY=DY&&(!YY||pP||uP||dP||GY(function(){return xM[qY]=!1,uu(Ah)!=Ah||uu(xM)==xM||uu(Ah,"i")!="/a/i"}));if(OY("RegExp",XY)){for(var Rh=function(r,a){var d,g,C,A,w,V,U=aP(Hp,this),j=UY(r),re=a===void 0,ce=[],Te=r;if(!U&&j&&re&&r.constructor===Rh)return r;if((j||aP(Hp,r))&&(r=r.source,re&&(a=xY(Te))),r=r===void 0?"":lP(r),a=a===void 0?"":lP(a),Te=r,uP&&"dotAll"in Ah&&(g=!!a&&fP(a,"s")>-1)&&(a=hP(a,/s/g,"")),d=a,pP&&"sticky"in Ah&&(C=!!a&&fP(a,"y")>-1)&&JY&&(a=hP(a,/y/g,"")),dP&&(A=function(De){for(var ze,_t=De.length,Ft=0,$t="",bt=[],yn={},Rn=!1,Gn=!1,Vo=0,qo="";Ft<=_t;Ft++){if((ze=Wb(De,Ft))==="\\")ze+=Wb(De,++Ft);else if(ze==="]")Rn=!1;else if(!Rn)switch(!0){case ze==="[":Rn=!0;break;case ze==="(":zY(jY,WY(De,Ft+1))&&(Ft+=2,Gn=!0),$t+=ze,Vo++;continue;case(ze===">"&&Gn):if(qo===""||BY(yn,qo))throw new KY("Invalid capture group name");yn[qo]=!0,bt[bt.length]=[qo,Vo],Gn=!1,qo="";continue}Gn?qo+=ze:$t+=ze}return[$t,bt]}(r),r=A[0],ce=A[1]),w=NY(uu(r,a),U?this:Hp,Rh),(g||C||ce.length)&&(V=$Y(w),g&&(V.dotAll=!0,V.raw=Rh(function(De){for(var ze,_t=De.length,Ft=0,$t="",bt=!1;Ft<=_t;Ft++)(ze=Wb(De,Ft))!=="\\"?bt||ze!=="."?(ze==="["?bt=!0:ze==="]"&&(bt=!1),$t+=ze):$t+="[\\s\\S]":$t+=ze+Wb(De,++Ft);return $t}(r),d)),C&&(V.sticky=!0),ce.length&&(V.groups=ce)),r!==Te)try{LY(w,"source",Te===""?"(?:)":Te)}catch{}return w},gP=PY(uu),mP=0;gP.length>mP;)FY(Rh,uu,gP[mP++]);Hp.constructor=Rh,Rh.prototype=Hp,VY(UM,"RegExp",Rh,{constructor:!0})}HY("RegExp");var qp=Cn,jb=b,QY=fs,ZY=tP,eJ=rP,tJ=Be,nJ=Wr.get,oJ=iP,rJ=sP,iJ=le("native-string-replace",String.prototype.replace),Yb=RegExp.prototype.exec,FM=Yb,sJ=jb("".charAt),aJ=jb("".indexOf),lJ=jb("".replace),VM=jb("".slice),GM=function(){var r=/a/,a=/b*/g;return qp(Yb,r,"a"),qp(Yb,a,"a"),r.lastIndex!==0||a.lastIndex!==0}(),vP=eJ.BROKEN_CARET,BM=/()??/.exec("")[1]!==void 0;(GM||BM||vP||oJ||rJ)&&(FM=function(r){var a,d,g,C,A,w,V,U=this,j=nJ(U),re=QY(r),ce=j.raw;if(ce)return ce.lastIndex=U.lastIndex,a=qp(FM,ce,re),U.lastIndex=ce.lastIndex,a;var Te=j.groups,De=vP&&U.sticky,ze=qp(ZY,U),_t=U.source,Ft=0,$t=re;if(De&&(ze=lJ(ze,"y",""),aJ(ze,"g")===-1&&(ze+="g"),$t=VM(re,U.lastIndex),U.lastIndex>0&&(!U.multiline||U.multiline&&sJ(re,U.lastIndex-1)!==`
`)&&(_t="(?: "+_t+")",$t=" "+$t,Ft++),d=new RegExp("^(?:"+_t+")",ze)),BM&&(d=new RegExp("^"+_t+"$(?!\\s)",ze)),GM&&(g=U.lastIndex),C=qp(Yb,De?d:U,$t),De?C?(C.input=VM(C.input,Ft),C[0]=VM(C[0],Ft),C.index=U.lastIndex,U.lastIndex+=C[0].length):U.lastIndex=0:GM&&C&&(U.lastIndex=U.global?C.index+C[0].length:g),BM&&C&&C.length>1&&qp(iJ,C[0],d,function(){for(A=1;A<arguments.length-2;A++)arguments[A]===void 0&&(C[A]=void 0)}),C&&Te)for(C.groups=w=tJ(null),A=0;A<Te.length;A++)w[(V=Te[A])[0]]=C[V[1]];return C});var Jb=FM;jo({target:"RegExp",proto:!0,forced:/./.exec!==Jb},{exec:Jb});var cJ=R,_P=Array.isArray||function(r){return cJ(r)=="Array"},yP=_P,uJ=r_,dJ=zn,hJ=Xe("species"),IP=Array,fJ=function(r){var a;return yP(r)&&(a=r.constructor,(uJ(a)&&(a===IP||yP(a.prototype))||dJ(a)&&(a=a[hJ])===null)&&(a=void 0)),a===void 0?IP:a},pJ=Ns,gJ=L,mJ=Oe,vJ=Ur,_J=function(r,a){return new(fJ(r))(a===0?0:a)},bP=b([].push),du=function(r){var a=r==1,d=r==2,g=r==3,C=r==4,A=r==6,w=r==7,V=r==5||A;return function(U,j,re,ce){for(var Te,De,ze=mJ(U),_t=gJ(ze),Ft=pJ(j,re),$t=vJ(_t),bt=0,yn=ce||_J,Rn=a?yn(U,$t):d||w?yn(U,0):void 0;$t>bt;bt++)if((V||bt in _t)&&(De=Ft(Te=_t[bt],bt,ze),r))if(a)Rn[bt]=De;else if(De)switch(r){case 3:return!0;case 5:return Te;case 6:return bt;case 2:bP(Rn,Te)}else switch(r){case 4:return!1;case 7:bP(Rn,Te)}return A?-1:g||C?C:Rn}},CP={forEach:du(0),map:du(1),filter:du(2),some:du(3),every:du(4),find:du(5),findIndex:du(6),filterReject:du(7)},yJ=c,$M=function(r,a){var d=[][r];return!!d&&yJ(function(){d.call(null,a||function(){return 1},1)})},IJ=CP.forEach,bJ=$M("forEach")?[].forEach:function(r){return IJ(this,r,arguments.length>1?arguments[1]:void 0)},SP=X,TP=gb,CJ=Vl,HM=bJ,SJ=ha,EP=function(r){if(r&&r.forEach!==HM)try{SJ(r,"forEach",HM)}catch{r.forEach=HM}};for(var qM in TP)TP[qM]&&EP(SP[qM]&&SP[qM].prototype);EP(CJ);var TJ=Ni,EJ=Oe,MJ=L,kJ=Ur,AJ=TypeError,MP=function(r){return function(a,d,g,C){TJ(d);var A=EJ(a),w=MJ(A),V=kJ(A),U=r?V-1:0,j=r?-1:1;if(g<2)for(;;){if(U in w){C=w[U],U+=j;break}if(U+=j,r?U<0:V<=U)throw AJ("Reduce of empty array with no initial value")}for(;r?U>=0:V>U;U+=j)U in w&&(C=d(C,w[U],U,A));return C}},RJ={left:MP(!1),right:MP(!0)}.left;jo({target:"Array",proto:!0,forced:!ja&&Je>79&&Je<83||!$M("reduce")},{reduce:function(r){var a=arguments.length;return RJ(this,r,a,a>1?arguments[1]:void 0)}});var kP=yh,AP=ji,wJ=Jb,RP=c,wP=Xe,DJ=wP("species"),DP=RegExp.prototype,KM=b,OJ=cs,NJ=fs,LJ=z,PJ=KM("".charAt),OP=KM("".charCodeAt),UJ=KM("".slice),NP=function(r){return function(a,d){var g,C,A=NJ(LJ(a)),w=OJ(d),V=A.length;return w<0||w>=V?r?"":void 0:(g=OP(A,w))<55296||g>56319||w+1===V||(C=OP(A,w+1))<56320||C>57343?r?PJ(A,w):g:r?UJ(A,w,w+2):C-56320+(g-55296<<10)+65536}},zM={codeAt:NP(!1),charAt:NP(!0)},xJ=zM.charAt,WM=b,FJ=Oe,VJ=Math.floor,jM=WM("".charAt),GJ=WM("".replace),YM=WM("".slice),BJ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,$J=/\$([$&'`]|\d{1,2})/g,LP=function(r,a,d,g,C,A){var w=d+r.length,V=g.length,U=$J;return C!==void 0&&(C=FJ(C),U=BJ),GJ(A,U,function(j,re){var ce;switch(jM(re,0)){case"$":return"$";case"&":return r;case"`":return YM(a,0,d);case"'":return YM(a,w);case"<":ce=C[YM(re,1,-1)];break;default:var Te=+re;if(Te===0)return j;if(Te>V){var De=VJ(Te/10);return De===0?j:De<=V?g[De-1]===void 0?jM(re,1):g[De-1]+jM(re,1):j}ce=g[Te-1]}return ce===void 0?"":ce})},PP=Cn,HJ=xo,qJ=jt,KJ=R,zJ=Jb,WJ=TypeError,jJ=Fb,UP=Cn,Xb=b,YJ=function(r,a,d,g){var C=wP(r),A=!RP(function(){var j={};return j[C]=function(){return 7},""[r](j)!=7}),w=A&&!RP(function(){var j=!1,re=/a/;return r==="split"&&((re={}).constructor={},re.constructor[DJ]=function(){return re},re.flags="",re[C]=/./[C]),re.exec=function(){return j=!0,null},re[C](""),!j});if(!A||!w||d){var V=kP(/./[C]),U=a(C,""[r],function(j,re,ce,Te,De){var ze=kP(j),_t=re.exec;return _t===wJ||_t===DP.exec?A&&!De?{done:!0,value:V(re,ce,Te)}:{done:!0,value:ze(ce,re,Te)}:{done:!1}});AP(String.prototype,r,U[0]),AP(DP,C,U[1])}},JJ=c,XJ=xo,QJ=jt,ZJ=F,eX=cs,tX=Ba,Kp=fs,nX=z,oX=function(r,a,d){return a+(d?xJ(r,a).length:1)},rX=Qe,iX=LP,sX=function(r,a){var d=r.exec;if(qJ(d)){var g=PP(d,r,a);return g!==null&&HJ(g),g}if(KJ(r)==="RegExp")return PP(zJ,r,a);throw WJ("RegExp#exec called on incompatible receiver")},JM=Xe("replace"),aX=Math.max,lX=Math.min,cX=Xb([].concat),XM=Xb([].push),xP=Xb("".indexOf),FP=Xb("".slice),uX=function(r){return r===void 0?r:String(r)},dX="a".replace(/./,"$0")==="$0",VP=!!/./[JM]&&/./[JM]("a","$0")==="",hX=!JJ(function(){var r=/./;return r.exec=function(){var a=[];return a.groups={a:"7"},a},"".replace(r,"$<a>")!=="7"});YJ("replace",function(r,a,d){var g=VP?"$":"$0";return[function(C,A){var w=nX(this),V=ZJ(C)?void 0:rX(C,JM);return V?UP(V,C,w,A):UP(a,Kp(w),C,A)},function(C,A){var w=XJ(this),V=Kp(C);if(typeof A=="string"&&xP(A,g)===-1&&xP(A,"$<")===-1){var U=d(a,w,V,A);if(U.done)return U.value}var j=QJ(A);j||(A=Kp(A));var re=w.global;if(re){var ce=w.unicode;w.lastIndex=0}for(var Te=[];;){var De=sX(w,V);if(De===null||(XM(Te,De),!re))break;Kp(De[0])===""&&(w.lastIndex=oX(V,tX(w.lastIndex),ce))}for(var ze="",_t=0,Ft=0;Ft<Te.length;Ft++){for(var $t=Kp((De=Te[Ft])[0]),bt=aX(lX(eX(De.index),V.length),0),yn=[],Rn=1;Rn<De.length;Rn++)XM(yn,uX(De[Rn]));var Gn=De.groups;if(j){var Vo=cX([$t],yn,bt,V);Gn!==void 0&&XM(Vo,Gn);var qo=Kp(jJ(A,void 0,Vo))}else qo=iX($t,V,bt,yn,Gn,A);bt>=_t&&(ze+=FP(V,_t,bt)+qo,_t=bt+$t.length)}return ze+FP(V,_t)}]},!hX||!dX||VP);var fX=cp.includes,pX=Ha;jo({target:"Array",proto:!0,forced:c(function(){return!Array(1).includes()})},{includes:function(r){return fX(this,r,arguments.length>1?arguments[1]:void 0)}}),pX("includes");var gX=cs,mX=fs,vX=z,_X=RangeError,GP=b,yX=Ba,BP=fs,IX=function(r){var a=mX(vX(this)),d="",g=gX(r);if(g<0||g==1/0)throw _X("Wrong number of repetitions");for(;g>0;(g>>>=1)&&(a+=a))1&g&&(d+=a);return d},bX=z,CX=GP(IX),SX=GP("".slice),TX=Math.ceil,$P=function(r){return function(a,d,g){var C,A,w=BP(bX(a)),V=yX(d),U=w.length,j=g===void 0?" ":BP(g);return V<=U||j==""?w:((A=CX(j,TX((C=V-U)/j.length))).length>C&&(A=SX(A,0,C)),r?w+A:A+w)}},EX={start:$P(!1),end:$P(!0)},MX=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(xe),kX=EX.start;jo({target:"String",proto:!0,forced:MX},{padStart:function(r){return kX(this,r,arguments.length>1?arguments[1]:void 0)}});var AX=c,RX=eo,wX=Xe("iterator"),HP=!AX(function(){var r=new URL("b?a=1&b=2&c=3","http://a"),a=r.searchParams,d="";return r.pathname="c%20d",a.forEach(function(g,C){a.delete("b"),d+=C+g}),!a.size&&!RX||!a.sort||r.href!=="http://a/c%20d?a=1&c=3"||a.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!a[wX]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"}),DX=ji,qP=function(r,a,d){for(var g in a)DX(r,g,a[g],d);return r},OX=fr,NX=Ir,LX=Kc,KP=function(r,a,d){var g=OX(a);g in r?NX.f(r,g,LX(0,d)):r[g]=d},zP=Vd,PX=Ur,UX=KP,xX=Array,FX=Math.max,QM=function(r,a,d){for(var g=PX(r),C=zP(a,g),A=zP(d===void 0?g:d,g),w=xX(FX(A-C,0)),V=0;C<A;C++,V++)UX(w,V,r[C]);return w.length=V,w},WP=QM,VX=Math.floor,ZM=function(r,a){var d=r.length,g=VX(d/2);return d<8?GX(r,a):BX(r,ZM(WP(r,0,g),a),ZM(WP(r,g),a),a)},GX=function(r,a){for(var d,g,C=r.length,A=1;A<C;){for(g=A,d=r[A];g&&a(r[g-1],d)>0;)r[g]=r[--g];g!==A++&&(r[g]=d)}return r},BX=function(r,a,d,g){for(var C=a.length,A=d.length,w=0,V=0;w<C||V<A;)r[w+V]=w<C&&V<A?g(a[w],d[V])<=0?a[w++]:d[V++]:w<C?a[w++]:d[V++];return r},ek=ZM,tk=jo,zp=X,Qb=Cn,Qa=b,Wp=eo,jP=HP,YP=ji,$X=pa,HX=qP,qX=Wa,KX=Cp,nk=Wr,JP=Zc,ok=jt,zX=Ge,WX=Ns,jX=ga,YX=xo,XP=zn,ps=fs,JX=Be,QP=Kc,rk=Kb,XX=m_,jp=Bl,QX=ek,ZX=Xe("iterator"),__="URLSearchParams",ZP=__+"Iterator",eU=nk.set,Ls=nk.getterFor(__),eQ=nk.getterFor(ZP),tQ=Object.getOwnPropertyDescriptor,ik=function(r){if(!Wp)return zp[r];var a=tQ(zp,r);return a&&a.value},tU=ik("fetch"),Zb=ik("Request"),y_=ik("Headers"),sk=Zb&&Zb.prototype,nU=y_&&y_.prototype,nQ=zp.RegExp,oQ=zp.TypeError,oU=zp.decodeURIComponent,rQ=zp.encodeURIComponent,iQ=Qa("".charAt),rU=Qa([].join),wh=Qa([].push),ak=Qa("".replace),sQ=Qa([].shift),iU=Qa([].splice),sU=Qa("".split),aQ=Qa("".slice),lQ=/\+/g,aU=Array(4),cQ=function(r){return aU[r-1]||(aU[r-1]=nQ("((?:%[\\da-f]{2}){"+r+"})","gi"))},uQ=function(r){try{return oU(r)}catch{return r}},lU=function(r){var a=ak(r,lQ," "),d=4;try{return oU(a)}catch{for(;d;)a=ak(a,cQ(d--),uQ);return a}},dQ=/[!'()~]|%20/g,hQ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},fQ=function(r){return hQ[r]},cU=function(r){return ak(rQ(r),dQ,fQ)},lk=KX(function(r,a){eU(this,{type:ZP,iterator:rk(Ls(r).entries),kind:a})},"Iterator",function(){var r=eQ(this),a=r.kind,d=r.iterator.next(),g=d.value;return d.done||(d.value=a==="keys"?g.key:a==="values"?g.value:[g.key,g.value]),d},!0),uU=function(r){this.entries=[],this.url=null,r!==void 0&&(XP(r)?this.parseObject(r):this.parseQuery(typeof r=="string"?iQ(r,0)==="?"?aQ(r,1):r:ps(r)))};uU.prototype={type:__,bindURL:function(r){this.url=r,this.update()},parseObject:function(r){var a,d,g,C,A,w,V,U=XX(r);if(U)for(d=(a=rk(r,U)).next;!(g=Qb(d,a)).done;){if(A=(C=rk(YX(g.value))).next,(w=Qb(A,C)).done||(V=Qb(A,C)).done||!Qb(A,C).done)throw oQ("Expected sequence with length 2");wh(this.entries,{key:ps(w.value),value:ps(V.value)})}else for(var j in r)zX(r,j)&&wh(this.entries,{key:j,value:ps(r[j])})},parseQuery:function(r){if(r)for(var a,d,g=sU(r,"&"),C=0;C<g.length;)(a=g[C++]).length&&(d=sU(a,"="),wh(this.entries,{key:lU(sQ(d)),value:lU(rU(d,"="))}))},serialize:function(){for(var r,a=this.entries,d=[],g=0;g<a.length;)r=a[g++],wh(d,cU(r.key)+"="+cU(r.value));return rU(d,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var eC=function(){JP(this,Yp);var r=eU(this,new uU(arguments.length>0?arguments[0]:void 0));Wp||(this.length=r.entries.length)},Yp=eC.prototype;if(HX(Yp,{append:function(r,a){jp(arguments.length,2);var d=Ls(this);wh(d.entries,{key:ps(r),value:ps(a)}),Wp||this.length++,d.updateURL()},delete:function(r){jp(arguments.length,1);for(var a=Ls(this),d=a.entries,g=ps(r),C=0;C<d.length;)d[C].key===g?iU(d,C,1):C++;Wp||(this.length=d.length),a.updateURL()},get:function(r){jp(arguments.length,1);for(var a=Ls(this).entries,d=ps(r),g=0;g<a.length;g++)if(a[g].key===d)return a[g].value;return null},getAll:function(r){jp(arguments.length,1);for(var a=Ls(this).entries,d=ps(r),g=[],C=0;C<a.length;C++)a[C].key===d&&wh(g,a[C].value);return g},has:function(r){jp(arguments.length,1);for(var a=Ls(this).entries,d=ps(r),g=0;g<a.length;)if(a[g++].key===d)return!0;return!1},set:function(r,a){jp(arguments.length,1);for(var d,g=Ls(this),C=g.entries,A=!1,w=ps(r),V=ps(a),U=0;U<C.length;U++)(d=C[U]).key===w&&(A?iU(C,U--,1):(A=!0,d.value=V));A||wh(C,{key:w,value:V}),Wp||(this.length=C.length),g.updateURL()},sort:function(){var r=Ls(this);QX(r.entries,function(a,d){return a.key>d.key?1:-1}),r.updateURL()},forEach:function(r){for(var a,d=Ls(this).entries,g=WX(r,arguments.length>1?arguments[1]:void 0),C=0;C<d.length;)g((a=d[C++]).value,a.key,this)},keys:function(){return new lk(this,"keys")},values:function(){return new lk(this,"values")},entries:function(){return new lk(this,"entries")}},{enumerable:!0}),YP(Yp,ZX,Yp.entries,{name:"entries"}),YP(Yp,"toString",function(){return Ls(this).serialize()},{enumerable:!0}),Wp&&$X(Yp,"size",{get:function(){return Ls(this).entries.length},configurable:!0,enumerable:!0}),qX(eC,__),tk({global:!0,constructor:!0,forced:!jP},{URLSearchParams:eC}),!jP&&ok(y_)){var pQ=Qa(nU.has),gQ=Qa(nU.set),dU=function(r){if(XP(r)){var a,d=r.body;if(jX(d)===__)return a=r.headers?new y_(r.headers):new y_,pQ(a,"content-type")||gQ(a,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),JX(r,{body:QP(0,ps(d)),headers:QP(0,a)})}return r};if(ok(tU)&&tk({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return tU(r,arguments.length>1?dU(arguments[1]):{})}}),ok(Zb)){var ck=function(r){return JP(this,sk),new Zb(r,arguments.length>1?dU(arguments[1]):{})};sk.constructor=ck,ck.prototype=sk,tk({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ck})}}var mQ={URLSearchParams:eC,getState:Ls},hU=`	
\v\f\r                　\u2028\u2029\uFEFF`,vQ=z,_Q=fs,uk=hU,fU=b("".replace),yQ=RegExp("^["+uk+"]+"),IQ=RegExp("(^|[^"+uk+"])["+uk+"]+$"),dk=function(r){return function(a){var d=_Q(vQ(a));return 1&r&&(d=fU(d,yQ,"")),2&r&&(d=fU(d,IQ,"$1")),d}},bQ={start:dk(1),end:dk(2),trim:dk(3)},CQ=Qd.PROPER,SQ=c,pU=hU,TQ=bQ.trim;jo({target:"String",proto:!0,forced:function(r){return SQ(function(){return!!pU[r]()||"​᠎"[r]()!=="​᠎"||CQ&&pU[r].name!==r})}("trim")},{trim:function(){return TQ(this)}});var EQ=jo,MQ=eo,tC=b,kQ=Ge,AQ=jt,RQ=Rt,wQ=fs,DQ=pa,OQ=QI,Kl=X.Symbol,Dh=Kl&&Kl.prototype;if(MQ&&AQ(Kl)&&(!("description"in Dh)||Kl().description!==void 0)){var gU={},nC=function(){var r=arguments.length<1||arguments[0]===void 0?void 0:wQ(arguments[0]),a=RQ(Dh,this)?new Kl(r):r===void 0?Kl():Kl(r);return r===""&&(gU[a]=!0),a};OQ(nC,Kl),nC.prototype=Dh,Dh.constructor=nC;var NQ=String(Kl("test"))=="Symbol(test)",LQ=tC(Dh.valueOf),PQ=tC(Dh.toString),UQ=/^Symbol\((.*)\)[^)]+$/,xQ=tC("".replace),FQ=tC("".slice);DQ(Dh,"description",{configurable:!0,get:function(){var r=LQ(this);if(kQ(gU,r))return"";var a=PQ(r),d=NQ?FQ(a,7,-1):xQ(a,UQ,"$1");return d===""?void 0:d}}),EQ({global:!0,constructor:!0,forced:!0},{Symbol:nC})}var VQ=zM.charAt,GQ=fs,mU=Wr,BQ=Yc,vU=Jc,_U="String Iterator",$Q=mU.set,HQ=mU.getterFor(_U);BQ(String,"String",function(r){$Q(this,{type:_U,string:GQ(r),index:0})},function(){var r,a=HQ(this),d=a.string,g=a.index;return g>=d.length?vU(void 0,!0):(r=VQ(d,g),a.index+=r.length,vU(r,!1))});var Ps,yU=eo,qQ=b,KQ=Cn,zQ=c,hk=Zm,WQ=Sv,jQ=Jd,YQ=Oe,JQ=L,Jp=Object.assign,IU=Object.defineProperty,XQ=qQ([].concat),QQ=!Jp||zQ(function(){if(yU&&Jp({b:1},Jp(IU({},"a",{enumerable:!0,get:function(){IU(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},a={},d=Symbol(),g="abcdefghijklmnopqrst";return r[d]=7,g.split("").forEach(function(C){a[C]=C}),Jp({},r)[d]!=7||hk(Jp({},a)).join("")!=g})?function(r,a){for(var d=YQ(r),g=arguments.length,C=1,A=WQ.f,w=jQ.f;g>C;)for(var V,U=JQ(arguments[C++]),j=A?XQ(hk(U),A(U)):hk(U),re=j.length,ce=0;re>ce;)V=j[ce++],yU&&!KQ(w,U,V)||(d[V]=U[V]);return d}:Jp,ZQ=xo,eZ=V2,tZ=Ns,nZ=Cn,oZ=Oe,rZ=function(r,a,d,g){try{return g?a(ZQ(d)[0],d[1]):a(d)}catch(C){eZ(r,"throw",C)}},iZ=DM,sZ=r_,aZ=Ur,bU=KP,lZ=Kb,cZ=m_,CU=Array,Oh=b,fk=2147483647,uZ=/[^\0-\u007E]/,SU=/[.\u3002\uFF0E\uFF61]/g,TU="Overflow: input needs wider integers to process",EU=RangeError,dZ=Oh(SU.exec),Xp=Math.floor,pk=String.fromCharCode,MU=Oh("".charCodeAt),kU=Oh([].join),hu=Oh([].push),hZ=Oh("".replace),fZ=Oh("".split),pZ=Oh("".toLowerCase),AU=function(r){return r+22+75*(r<26)},gZ=function(r,a,d){var g=0;for(r=d?Xp(r/700):r>>1,r+=Xp(r/a);r>455;)r=Xp(r/35),g+=36;return Xp(g+36*r/(r+38))},mZ=function(r){var a=[];r=function($t){for(var bt=[],yn=0,Rn=$t.length;yn<Rn;){var Gn=MU($t,yn++);if(Gn>=55296&&Gn<=56319&&yn<Rn){var Vo=MU($t,yn++);(64512&Vo)==56320?hu(bt,((1023&Gn)<<10)+(1023&Vo)+65536):(hu(bt,Gn),yn--)}else hu(bt,Gn)}return bt}(r);var d,g,C=r.length,A=128,w=0,V=72;for(d=0;d<r.length;d++)(g=r[d])<128&&hu(a,pk(g));var U=a.length,j=U;for(U&&hu(a,"-");j<C;){var re=fk;for(d=0;d<r.length;d++)(g=r[d])>=A&&g<re&&(re=g);var ce=j+1;if(re-A>Xp((fk-w)/ce))throw EU(TU);for(w+=(re-A)*ce,A=re,d=0;d<r.length;d++){if((g=r[d])<A&&++w>fk)throw EU(TU);if(g==A){for(var Te=w,De=36;;){var ze=De<=V?1:De>=V+26?26:De-V;if(Te<ze)break;var _t=Te-ze,Ft=36-ze;hu(a,pk(AU(ze+_t%Ft))),Te=Xp(_t/Ft),De+=36}hu(a,pk(AU(Te))),V=gZ(w,ce,j==U),w=0,j++}}w++,A++}return kU(a,"")},vZ=jo,gk=eo,_Z=HP,mk=X,RU=Ns,Us=b,oC=ji,xs=pa,yZ=Zc,vk=Ge,_k=QQ,Qp=function(r){var a=oZ(r),d=sZ(this),g=arguments.length,C=g>1?arguments[1]:void 0,A=C!==void 0;A&&(C=tZ(C,g>2?arguments[2]:void 0));var w,V,U,j,re,ce,Te=cZ(a),De=0;if(!Te||this===CU&&iZ(Te))for(w=aZ(a),V=d?new this(w):CU(w);w>De;De++)ce=A?C(a[De],De):a[De],bU(V,De,ce);else for(re=(j=lZ(a,Te)).next,V=d?new this:[];!(U=nZ(re,j)).done;De++)ce=A?rZ(j,C,[U.value,De],!0):U.value,bU(V,De,ce);return V.length=De,V},ma=QM,IZ=zM.codeAt,bZ=function(r){var a,d,g=[],C=fZ(hZ(pZ(r),SU,"."),".");for(a=0;a<C.length;a++)d=C[a],hu(g,dZ(uZ,d)?"xn--"+mZ(d):d);return kU(g,".")},zl=fs,CZ=Wa,SZ=Bl,wU=mQ,DU=Wr,TZ=DU.set,rC=DU.getterFor("URL"),EZ=wU.URLSearchParams,MZ=wU.getState,I_=mk.URL,yk=mk.TypeError,iC=mk.parseInt,kZ=Math.floor,OU=Math.pow,Fs=Us("".charAt),va=Us(/./.exec),b_=Us([].join),AZ=Us(1 .toString),RZ=Us([].pop),Zp=Us([].push),Ik=Us("".replace),wZ=Us([].shift),DZ=Us("".split),C_=Us("".slice),sC=Us("".toLowerCase),OZ=Us([].unshift),bk="Invalid scheme",Nh="Invalid host",NU="Invalid port",LU=/[a-z]/i,NZ=/[\d+-.a-z]/i,Ck=/\d/,LZ=/^0x/i,PZ=/^[0-7]+$/,UZ=/^\d+$/,PU=/^[\da-f]+$/i,xZ=/[\0\t\n\r #%/:<>?@[\\\]^|]/,FZ=/[\0\t\n\r #/:<>?@[\\\]^|]/,VZ=/^[\u0000-\u0020]+/,GZ=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,BZ=/[\t\n\r]/g,S_=function(r){var a,d,g,C;if(typeof r=="number"){for(a=[],d=0;d<4;d++)OZ(a,r%256),r=kZ(r/256);return b_(a,".")}if(typeof r=="object"){for(a="",g=function(A){for(var w=null,V=1,U=null,j=0,re=0;re<8;re++)A[re]!==0?(j>V&&(w=U,V=j),U=null,j=0):(U===null&&(U=re),++j);return j>V&&(w=U,V=j),w}(r),d=0;d<8;d++)C&&r[d]===0||(C&&(C=!1),g===d?(a+=d?":":"::",C=!0):(a+=AZ(r[d],16),d<7&&(a+=":")));return"["+a+"]"}return r},aC={},UU=_k({},aC,{" ":1,'"':1,"<":1,">":1,"`":1}),xU=_k({},UU,{"#":1,"?":1,"{":1,"}":1}),Sk=_k({},xU,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),fu=function(r,a){var d=IZ(r,0);return d>32&&d<127&&!vk(a,r)?r:encodeURIComponent(r)},lC={ftp:21,file:null,http:80,https:443,ws:80,wss:443},T_=function(r,a){var d;return r.length==2&&va(LU,Fs(r,0))&&((d=Fs(r,1))==":"||!a&&d=="|")},FU=function(r){var a;return r.length>1&&T_(C_(r,0,2))&&(r.length==2||(a=Fs(r,2))==="/"||a==="\\"||a==="?"||a==="#")},$Z=function(r){return r==="."||sC(r)==="%2e"},Tk={},VU={},Ek={},GU={},BU={},Mk={},$U={},HU={},cC={},uC={},kk={},Ak={},Rk={},wk={},qU={},Dk={},eg={},Za={},KU={},Lh={},Wl={},Ok=function(r,a,d){var g,C,A,w=zl(r);if(a){if(C=this.parse(w))throw yk(C);this.searchParams=null}else{if(d!==void 0&&(g=new Ok(d,!0)),C=this.parse(w,null,g))throw yk(C);(A=MZ(new EZ)).bindURL(this),this.searchParams=A}};Ok.prototype={type:"URL",parse:function(r,a,d){var g,C,A,w,V,U=this,j=a||Tk,re=0,ce="",Te=!1,De=!1,ze=!1;for(r=zl(r),a||(U.scheme="",U.username="",U.password="",U.host=null,U.port=null,U.path=[],U.query=null,U.fragment=null,U.cannotBeABaseURL=!1,r=Ik(r,VZ,""),r=Ik(r,GZ,"$1")),r=Ik(r,BZ,""),g=Qp(r);re<=g.length;){switch(C=g[re],j){case Tk:if(!C||!va(LU,C)){if(a)return bk;j=Ek;continue}ce+=sC(C),j=VU;break;case VU:if(C&&(va(NZ,C)||C=="+"||C=="-"||C=="."))ce+=sC(C);else{if(C!=":"){if(a)return bk;ce="",j=Ek,re=0;continue}if(a&&(U.isSpecial()!=vk(lC,ce)||ce=="file"&&(U.includesCredentials()||U.port!==null)||U.scheme=="file"&&!U.host))return;if(U.scheme=ce,a)return void(U.isSpecial()&&lC[U.scheme]==U.port&&(U.port=null));ce="",U.scheme=="file"?j=wk:U.isSpecial()&&d&&d.scheme==U.scheme?j=GU:U.isSpecial()?j=HU:g[re+1]=="/"?(j=BU,re++):(U.cannotBeABaseURL=!0,Zp(U.path,""),j=KU)}break;case Ek:if(!d||d.cannotBeABaseURL&&C!="#")return bk;if(d.cannotBeABaseURL&&C=="#"){U.scheme=d.scheme,U.path=ma(d.path),U.query=d.query,U.fragment="",U.cannotBeABaseURL=!0,j=Wl;break}j=d.scheme=="file"?wk:Mk;continue;case GU:if(C!="/"||g[re+1]!="/"){j=Mk;continue}j=cC,re++;break;case BU:if(C=="/"){j=uC;break}j=Za;continue;case Mk:if(U.scheme=d.scheme,C==Ps)U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=ma(d.path),U.query=d.query;else if(C=="/"||C=="\\"&&U.isSpecial())j=$U;else if(C=="?")U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=ma(d.path),U.query="",j=Lh;else{if(C!="#"){U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=ma(d.path),U.path.length--,j=Za;continue}U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=ma(d.path),U.query=d.query,U.fragment="",j=Wl}break;case $U:if(!U.isSpecial()||C!="/"&&C!="\\"){if(C!="/"){U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,j=Za;continue}j=uC}else j=cC;break;case HU:if(j=cC,C!="/"||Fs(ce,re+1)!="/")continue;re++;break;case cC:if(C!="/"&&C!="\\"){j=uC;continue}break;case uC:if(C=="@"){Te&&(ce="%40"+ce),Te=!0,A=Qp(ce);for(var _t=0;_t<A.length;_t++){var Ft=A[_t];if(Ft!=":"||ze){var $t=fu(Ft,Sk);ze?U.password+=$t:U.username+=$t}else ze=!0}ce=""}else if(C==Ps||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()){if(Te&&ce=="")return"Invalid authority";re-=Qp(ce).length+1,ce="",j=kk}else ce+=C;break;case kk:case Ak:if(a&&U.scheme=="file"){j=Dk;continue}if(C!=":"||De){if(C==Ps||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()){if(U.isSpecial()&&ce=="")return Nh;if(a&&ce==""&&(U.includesCredentials()||U.port!==null))return;if(w=U.parseHost(ce))return w;if(ce="",j=eg,a)return;continue}C=="["?De=!0:C=="]"&&(De=!1),ce+=C}else{if(ce=="")return Nh;if(w=U.parseHost(ce))return w;if(ce="",j=Rk,a==Ak)return}break;case Rk:if(!va(Ck,C)){if(C==Ps||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()||a){if(ce!=""){var bt=iC(ce,10);if(bt>65535)return NU;U.port=U.isSpecial()&&bt===lC[U.scheme]?null:bt,ce=""}if(a)return;j=eg;continue}return NU}ce+=C;break;case wk:if(U.scheme="file",C=="/"||C=="\\")j=qU;else{if(!d||d.scheme!="file"){j=Za;continue}if(C==Ps)U.host=d.host,U.path=ma(d.path),U.query=d.query;else if(C=="?")U.host=d.host,U.path=ma(d.path),U.query="",j=Lh;else{if(C!="#"){FU(b_(ma(g,re),""))||(U.host=d.host,U.path=ma(d.path),U.shortenPath()),j=Za;continue}U.host=d.host,U.path=ma(d.path),U.query=d.query,U.fragment="",j=Wl}}break;case qU:if(C=="/"||C=="\\"){j=Dk;break}d&&d.scheme=="file"&&!FU(b_(ma(g,re),""))&&(T_(d.path[0],!0)?Zp(U.path,d.path[0]):U.host=d.host),j=Za;continue;case Dk:if(C==Ps||C=="/"||C=="\\"||C=="?"||C=="#"){if(!a&&T_(ce))j=Za;else if(ce==""){if(U.host="",a)return;j=eg}else{if(w=U.parseHost(ce))return w;if(U.host=="localhost"&&(U.host=""),a)return;ce="",j=eg}continue}ce+=C;break;case eg:if(U.isSpecial()){if(j=Za,C!="/"&&C!="\\")continue}else if(a||C!="?")if(a||C!="#"){if(C!=Ps&&(j=Za,C!="/"))continue}else U.fragment="",j=Wl;else U.query="",j=Lh;break;case Za:if(C==Ps||C=="/"||C=="\\"&&U.isSpecial()||!a&&(C=="?"||C=="#")){if((V=sC(V=ce))===".."||V==="%2e."||V===".%2e"||V==="%2e%2e"?(U.shortenPath(),C=="/"||C=="\\"&&U.isSpecial()||Zp(U.path,"")):$Z(ce)?C=="/"||C=="\\"&&U.isSpecial()||Zp(U.path,""):(U.scheme=="file"&&!U.path.length&&T_(ce)&&(U.host&&(U.host=""),ce=Fs(ce,0)+":"),Zp(U.path,ce)),ce="",U.scheme=="file"&&(C==Ps||C=="?"||C=="#"))for(;U.path.length>1&&U.path[0]==="";)wZ(U.path);C=="?"?(U.query="",j=Lh):C=="#"&&(U.fragment="",j=Wl)}else ce+=fu(C,xU);break;case KU:C=="?"?(U.query="",j=Lh):C=="#"?(U.fragment="",j=Wl):C!=Ps&&(U.path[0]+=fu(C,aC));break;case Lh:a||C!="#"?C!=Ps&&(C=="'"&&U.isSpecial()?U.query+="%27":U.query+=C=="#"?"%23":fu(C,aC)):(U.fragment="",j=Wl);break;case Wl:C!=Ps&&(U.fragment+=fu(C,UU))}re++}},parseHost:function(r){var a,d,g;if(Fs(r,0)=="["){if(Fs(r,r.length-1)!="]"||(a=function(C){var A,w,V,U,j,re,ce,Te=[0,0,0,0,0,0,0,0],De=0,ze=null,_t=0,Ft=function(){return Fs(C,_t)};if(Ft()==":"){if(Fs(C,1)!=":")return;_t+=2,ze=++De}for(;Ft();){if(De==8)return;if(Ft()!=":"){for(A=w=0;w<4&&va(PU,Ft());)A=16*A+iC(Ft(),16),_t++,w++;if(Ft()=="."){if(w==0||(_t-=w,De>6))return;for(V=0;Ft();){if(U=null,V>0){if(!(Ft()=="."&&V<4))return;_t++}if(!va(Ck,Ft()))return;for(;va(Ck,Ft());){if(j=iC(Ft(),10),U===null)U=j;else{if(U==0)return;U=10*U+j}if(U>255)return;_t++}Te[De]=256*Te[De]+U,++V!=2&&V!=4||De++}if(V!=4)return;break}if(Ft()==":"){if(_t++,!Ft())return}else if(Ft())return;Te[De++]=A}else{if(ze!==null)return;_t++,ze=++De}}if(ze!==null)for(re=De-ze,De=7;De!=0&&re>0;)ce=Te[De],Te[De--]=Te[ze+re-1],Te[ze+--re]=ce;else if(De!=8)return;return Te}(C_(r,1,-1)),!a))return Nh;this.host=a}else if(this.isSpecial()){if(r=bZ(r),va(xZ,r)||(a=function(C){var A,w,V,U,j,re,ce,Te=DZ(C,".");if(Te.length&&Te[Te.length-1]==""&&Te.length--,(A=Te.length)>4)return C;for(w=[],V=0;V<A;V++){if((U=Te[V])=="")return C;if(j=10,U.length>1&&Fs(U,0)=="0"&&(j=va(LZ,U)?16:8,U=C_(U,j==8?1:2)),U==="")re=0;else{if(!va(j==10?UZ:j==8?PZ:PU,U))return C;re=iC(U,j)}Zp(w,re)}for(V=0;V<A;V++)if(re=w[V],V==A-1){if(re>=OU(256,5-A))return null}else if(re>255)return null;for(ce=RZ(w),V=0;V<w.length;V++)ce+=w[V]*OU(256,3-V);return ce}(r),a===null))return Nh;this.host=a}else{if(va(FZ,r))return Nh;for(a="",d=Qp(r),g=0;g<d.length;g++)a+=fu(d[g],aC);this.host=a}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return vk(lC,this.scheme)},shortenPath:function(){var r=this.path,a=r.length;!a||this.scheme=="file"&&a==1&&T_(r[0],!0)||r.length--},serialize:function(){var r=this,a=r.scheme,d=r.username,g=r.password,C=r.host,A=r.port,w=r.path,V=r.query,U=r.fragment,j=a+":";return C!==null?(j+="//",r.includesCredentials()&&(j+=d+(g?":"+g:"")+"@"),j+=S_(C),A!==null&&(j+=":"+A)):a=="file"&&(j+="//"),j+=r.cannotBeABaseURL?w[0]:w.length?"/"+b_(w,"/"):"",V!==null&&(j+="?"+V),U!==null&&(j+="#"+U),j},setHref:function(r){var a=this.parse(r);if(a)throw yk(a);this.searchParams.update()},getOrigin:function(){var r=this.scheme,a=this.port;if(r=="blob")try{return new tg(r.path[0]).origin}catch{return"null"}return r!="file"&&this.isSpecial()?r+"://"+S_(this.host)+(a!==null?":"+a:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(r){this.parse(zl(r)+":",Tk)},getUsername:function(){return this.username},setUsername:function(r){var a=Qp(zl(r));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var d=0;d<a.length;d++)this.username+=fu(a[d],Sk)}},getPassword:function(){return this.password},setPassword:function(r){var a=Qp(zl(r));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var d=0;d<a.length;d++)this.password+=fu(a[d],Sk)}},getHost:function(){var r=this.host,a=this.port;return r===null?"":a===null?S_(r):S_(r)+":"+a},setHost:function(r){this.cannotBeABaseURL||this.parse(r,kk)},getHostname:function(){var r=this.host;return r===null?"":S_(r)},setHostname:function(r){this.cannotBeABaseURL||this.parse(r,Ak)},getPort:function(){var r=this.port;return r===null?"":zl(r)},setPort:function(r){this.cannotHaveUsernamePasswordPort()||((r=zl(r))==""?this.port=null:this.parse(r,Rk))},getPathname:function(){var r=this.path;return this.cannotBeABaseURL?r[0]:r.length?"/"+b_(r,"/"):""},setPathname:function(r){this.cannotBeABaseURL||(this.path=[],this.parse(r,eg))},getSearch:function(){var r=this.query;return r?"?"+r:""},setSearch:function(r){(r=zl(r))==""?this.query=null:(Fs(r,0)=="?"&&(r=C_(r,1)),this.query="",this.parse(r,Lh)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var r=this.fragment;return r?"#"+r:""},setHash:function(r){(r=zl(r))!=""?(Fs(r,0)=="#"&&(r=C_(r,1)),this.fragment="",this.parse(r,Wl)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var tg=function(r){var a=yZ(this,xi),d=SZ(arguments.length,1)>1?arguments[1]:void 0,g=TZ(a,new Ok(r,!1,d));gk||(a.href=g.serialize(),a.origin=g.getOrigin(),a.protocol=g.getProtocol(),a.username=g.getUsername(),a.password=g.getPassword(),a.host=g.getHost(),a.hostname=g.getHostname(),a.port=g.getPort(),a.pathname=g.getPathname(),a.search=g.getSearch(),a.searchParams=g.getSearchParams(),a.hash=g.getHash())},xi=tg.prototype,Vs=function(r,a){return{get:function(){return rC(this)[r]()},set:a&&function(d){return rC(this)[a](d)},configurable:!0,enumerable:!0}};if(gk&&(xs(xi,"href",Vs("serialize","setHref")),xs(xi,"origin",Vs("getOrigin")),xs(xi,"protocol",Vs("getProtocol","setProtocol")),xs(xi,"username",Vs("getUsername","setUsername")),xs(xi,"password",Vs("getPassword","setPassword")),xs(xi,"host",Vs("getHost","setHost")),xs(xi,"hostname",Vs("getHostname","setHostname")),xs(xi,"port",Vs("getPort","setPort")),xs(xi,"pathname",Vs("getPathname","setPathname")),xs(xi,"search",Vs("getSearch","setSearch")),xs(xi,"searchParams",Vs("getSearchParams")),xs(xi,"hash",Vs("getHash","setHash"))),oC(xi,"toJSON",function(){return rC(this).serialize()},{enumerable:!0}),oC(xi,"toString",function(){return rC(this).serialize()},{enumerable:!0}),I_){var zU=I_.createObjectURL,WU=I_.revokeObjectURL;zU&&oC(tg,"createObjectURL",RU(zU,I_)),WU&&oC(tg,"revokeObjectURL",RU(WU,I_))}CZ(tg,"URL"),vZ({global:!0,constructor:!0,forced:!_Z,sham:!gk},{URL:tg});var jU=typeof ArrayBuffer<"u"&&typeof DataView<"u",HZ=cs,qZ=Ba,KZ=RangeError,YU=function(r){if(r===void 0)return 0;var a=HZ(r),d=qZ(a);if(a!==d)throw KZ("Wrong length or index");return d},zZ=Array,WZ=Math.abs,jl=Math.pow,jZ=Math.floor,YZ=Math.log,JZ=Math.LN2,XZ={pack:function(r,a,d){var g,C,A,w=zZ(d),V=8*d-a-1,U=(1<<V)-1,j=U>>1,re=a===23?jl(2,-24)-jl(2,-77):0,ce=r<0||r===0&&1/r<0?1:0,Te=0;for((r=WZ(r))!=r||r===1/0?(C=r!=r?1:0,g=U):(g=jZ(YZ(r)/JZ),r*(A=jl(2,-g))<1&&(g--,A*=2),(r+=g+j>=1?re/A:re*jl(2,1-j))*A>=2&&(g++,A/=2),g+j>=U?(C=0,g=U):g+j>=1?(C=(r*A-1)*jl(2,a),g+=j):(C=r*jl(2,j-1)*jl(2,a),g=0));a>=8;)w[Te++]=255&C,C/=256,a-=8;for(g=g<<a|C,V+=a;V>0;)w[Te++]=255&g,g/=256,V-=8;return w[--Te]|=128*ce,w},unpack:function(r,a){var d,g=r.length,C=8*g-a-1,A=(1<<C)-1,w=A>>1,V=C-7,U=g-1,j=r[U--],re=127&j;for(j>>=7;V>0;)re=256*re+r[U--],V-=8;for(d=re&(1<<-V)-1,re>>=-V,V+=a;V>0;)d=256*d+r[U--],V-=8;if(re===0)re=1-w;else{if(re===A)return d?NaN:j?-1/0:1/0;d+=jl(2,a),re-=w}return(j?-1:1)*d*jl(2,re-a)}},QZ=Oe,JU=Vd,ZZ=Ur,XU=function(r){for(var a=QZ(this),d=ZZ(a),g=arguments.length,C=JU(g>1?arguments[1]:void 0,d),A=g>2?arguments[2]:void 0,w=A===void 0?d:JU(A,d);w>C;)a[C++]=r;return a},dC=X,Nk=b,Lk=eo,eee=jU,QU=Qd,ZU=ha,tee=pa,ex=qP,Pk=c,hC=Zc,nee=cs,oee=Ba,fC=YU,tx=XZ,ree=jc,nx=Os,iee=th.f,see=XU,aee=QM,ox=Wa,Uk=Wr,lee=QU.PROPER,rx=QU.CONFIGURABLE,ng="ArrayBuffer",pC="DataView",og="prototype",ix="Wrong index",sx=Uk.getterFor(ng),E_=Uk.getterFor(pC),ax=Uk.set,Gs=dC[ng],_a=Gs,rg=_a&&_a[og],Yl=dC[pC],Ph=Yl&&Yl[og],lx=Object.prototype,cee=dC.Array,gC=dC.RangeError,uee=Nk(see),dee=Nk([].reverse),cx=tx.pack,ux=tx.unpack,dx=function(r){return[255&r]},hx=function(r){return[255&r,r>>8&255]},fx=function(r){return[255&r,r>>8&255,r>>16&255,r>>24&255]},px=function(r){return r[3]<<24|r[2]<<16|r[1]<<8|r[0]},hee=function(r){return cx(r,23,4)},fee=function(r){return cx(r,52,8)},mC=function(r,a,d){tee(r[og],a,{configurable:!0,get:function(){return d(this)[a]}})},pu=function(r,a,d,g){var C=fC(d),A=E_(r);if(C+a>A.byteLength)throw gC(ix);var w=A.bytes,V=C+A.byteOffset,U=aee(w,V,V+a);return g?U:dee(U)},gu=function(r,a,d,g,C,A){var w=fC(d),V=E_(r);if(w+a>V.byteLength)throw gC(ix);for(var U=V.bytes,j=w+V.byteOffset,re=g(+C),ce=0;ce<a;ce++)U[j+ce]=re[A?ce:a-ce-1]};if(eee){var gx=lee&&Gs.name!==ng;if(Pk(function(){Gs(1)})&&Pk(function(){new Gs(-1)})&&!Pk(function(){return new Gs,new Gs(1.5),new Gs(NaN),Gs.length!=1||gx&&!rx}))gx&&rx&&ZU(Gs,"name",ng);else{(_a=function(r){return hC(this,rg),new Gs(fC(r))})[og]=rg;for(var xk,mx=iee(Gs),vx=0;mx.length>vx;)(xk=mx[vx++])in _a||ZU(_a,xk,Gs[xk]);rg.constructor=_a}nx&&ree(Ph)!==lx&&nx(Ph,lx);var vC=new Yl(new _a(2)),_x=Nk(Ph.setInt8);vC.setInt8(0,2147483648),vC.setInt8(1,2147483649),!vC.getInt8(0)&&vC.getInt8(1)||ex(Ph,{setInt8:function(r,a){_x(this,r,a<<24>>24)},setUint8:function(r,a){_x(this,r,a<<24>>24)}},{unsafe:!0})}else rg=(_a=function(r){hC(this,rg);var a=fC(r);ax(this,{type:ng,bytes:uee(cee(a),0),byteLength:a}),Lk||(this.byteLength=a,this.detached=!1)})[og],Ph=(Yl=function(r,a,d){hC(this,Ph),hC(r,rg);var g=sx(r),C=g.byteLength,A=nee(a);if(A<0||A>C)throw gC("Wrong offset");if(A+(d=d===void 0?C-A:oee(d))>C)throw gC("Wrong length");ax(this,{type:pC,buffer:r,byteLength:d,byteOffset:A,bytes:g.bytes}),Lk||(this.buffer=r,this.byteLength=d,this.byteOffset=A)})[og],Lk&&(mC(_a,"byteLength",sx),mC(Yl,"buffer",E_),mC(Yl,"byteLength",E_),mC(Yl,"byteOffset",E_)),ex(Ph,{getInt8:function(r){return pu(this,1,r)[0]<<24>>24},getUint8:function(r){return pu(this,1,r)[0]},getInt16:function(r){var a=pu(this,2,r,arguments.length>1?arguments[1]:void 0);return(a[1]<<8|a[0])<<16>>16},getUint16:function(r){var a=pu(this,2,r,arguments.length>1?arguments[1]:void 0);return a[1]<<8|a[0]},getInt32:function(r){return px(pu(this,4,r,arguments.length>1?arguments[1]:void 0))},getUint32:function(r){return px(pu(this,4,r,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(r){return ux(pu(this,4,r,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(r){return ux(pu(this,8,r,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(r,a){gu(this,1,r,dx,a)},setUint8:function(r,a){gu(this,1,r,dx,a)},setInt16:function(r,a){gu(this,2,r,hx,a,arguments.length>2?arguments[2]:void 0)},setUint16:function(r,a){gu(this,2,r,hx,a,arguments.length>2?arguments[2]:void 0)},setInt32:function(r,a){gu(this,4,r,fx,a,arguments.length>2?arguments[2]:void 0)},setUint32:function(r,a){gu(this,4,r,fx,a,arguments.length>2?arguments[2]:void 0)},setFloat32:function(r,a){gu(this,4,r,hee,a,arguments.length>2?arguments[2]:void 0)},setFloat64:function(r,a){gu(this,8,r,fee,a,arguments.length>2?arguments[2]:void 0)}});ox(_a,ng),ox(Yl,pC);var _C={ArrayBuffer:_a,DataView:Yl},pee=jo,Fk=yh,gee=c,yx=xo,Ix=Vd,mee=Ba,vee=i_,Vk=_C.ArrayBuffer,Gk=_C.DataView,bx=Gk.prototype,Cx=Fk(Vk.prototype.slice),_ee=Fk(bx.getUint8),yee=Fk(bx.setUint8);pee({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:gee(function(){return!new Vk(2).slice(1,void 0).byteLength})},{slice:function(r,a){if(Cx&&a===void 0)return Cx(yx(this),r);for(var d=yx(this).byteLength,g=Ix(r,d),C=Ix(a===void 0?d:a,d),A=new(vee(this,Vk))(mee(C-g)),w=new Gk(this),V=new Gk(A),U=0;g<C;)yee(V,U++,_ee(w,g++));return A}});var Yi,ig,yC,IC={},Sx={get exports(){return IC},set exports(r){IC=r}},Iee=jU,Bk=eo,Fi=X,Tx=jt,bC=zn,mu=Ge,$k=ga,bee=dn,Cee=ha,Hk=ji,See=pa,Tee=Rt,CC=jc,sg=Os,Eee=Xe,Mee=Ae,Ex=Wr.enforce,kee=Wr.get,SC=Fi.Int8Array,qk=SC&&SC.prototype,Mx=Fi.Uint8ClampedArray,kx=Mx&&Mx.prototype,el=SC&&CC(SC),ya=qk&&CC(qk),Aee=Object.prototype,Kk=Fi.TypeError,Ax=Eee("toStringTag"),zk=Mee("TYPED_ARRAY_TAG"),TC="TypedArrayConstructor",Jl=Iee&&!!sg&&$k(Fi.opera)!=="Opera",Rx=!1,Xl={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Wk={BigInt64Array:8,BigUint64Array:8},Dx=function(r){var a=CC(r);if(bC(a)){var d=kee(a);return d&&mu(d,TC)?d[TC]:Dx(a)}},Ox=function(r){if(!bC(r))return!1;var a=$k(r);return mu(Xl,a)||mu(Wk,a)};for(Yi in Xl)(yC=(ig=Fi[Yi])&&ig.prototype)?Ex(yC)[TC]=ig:Jl=!1;for(Yi in Wk)(yC=(ig=Fi[Yi])&&ig.prototype)&&(Ex(yC)[TC]=ig);if((!Jl||!Tx(el)||el===Function.prototype)&&(el=function(){throw Kk("Incorrect invocation")},Jl))for(Yi in Xl)Fi[Yi]&&sg(Fi[Yi],el);if((!Jl||!ya||ya===Aee)&&(ya=el.prototype,Jl))for(Yi in Xl)Fi[Yi]&&sg(Fi[Yi].prototype,ya);if(Jl&&CC(kx)!==ya&&sg(kx,ya),Bk&&!mu(ya,Ax))for(Yi in Rx=!0,See(ya,Ax,{configurable:!0,get:function(){return bC(this)?this[zk]:void 0}}),Xl)Fi[Yi]&&Cee(Fi[Yi],zk,Yi);var Ql={NATIVE_ARRAY_BUFFER_VIEWS:Jl,TYPED_ARRAY_TAG:Rx&&zk,aTypedArray:function(r){if(Ox(r))return r;throw Kk("Target is not a typed array")},aTypedArrayConstructor:function(r){if(Tx(r)&&(!sg||Tee(el,r)))return r;throw Kk(bee(r)+" is not a typed array constructor")},exportTypedArrayMethod:function(r,a,d,g){if(Bk){if(d)for(var C in Xl){var A=Fi[C];if(A&&mu(A.prototype,r))try{delete A.prototype[r]}catch{try{A.prototype[r]=a}catch{}}}ya[r]&&!d||Hk(ya,r,d?a:Jl&&qk[r]||a,g)}},exportTypedArrayStaticMethod:function(r,a,d){var g,C;if(Bk){if(sg){if(d){for(g in Xl)if((C=Fi[g])&&mu(C,r))try{delete C[r]}catch{}}if(el[r]&&!d)return;try{return Hk(el,r,d?a:Jl&&el[r]||a)}catch{}}for(g in Xl)!(C=Fi[g])||C[r]&&!d||Hk(C,r,a)}},getTypedArrayConstructor:Dx,isView:function(r){if(!bC(r))return!1;var a=$k(r);return a==="DataView"||mu(Xl,a)||mu(Wk,a)},isTypedArray:Ox,TypedArray:el,TypedArrayPrototype:ya},Nx=X,jk=c,Ree=W2,wee=Ql.NATIVE_ARRAY_BUFFER_VIEWS,Dee=Nx.ArrayBuffer,Uh=Nx.Int8Array,Lx=!wee||!jk(function(){Uh(1)})||!jk(function(){new Uh(-1)})||!Ree(function(r){new Uh,new Uh(null),new Uh(1.5),new Uh(r)},!0)||jk(function(){return new Uh(new Dee(2),1,void 0).length!==1}),Oee=zn,Nee=Math.floor,Lee=Number.isInteger||function(r){return!Oee(r)&&isFinite(r)&&Nee(r)===r},Pee=cs,Uee=RangeError,xee=function(r){var a=Pee(r);if(a<0)throw Uee("The argument can't be less than 0");return a},Fee=RangeError,Px=function(r,a){var d=xee(r);if(d%a)throw Fee("Wrong offset");return d},Vee=ga,Gee=Dr,Bee=TypeError,Ux=function(r){var a=Gee(r,"number");if(typeof a=="number")throw Bee("Can't convert number to bigint");return BigInt(a)},$ee=Ns,Hee=Cn,qee=Nb,Kee=Oe,zee=Ur,Wee=Kb,jee=m_,Yee=DM,Jee=function(r){var a=Vee(r);return a=="BigInt64Array"||a=="BigUint64Array"},Xee=Ql.aTypedArrayConstructor,Qee=Ux,xx=function(r){var a,d,g,C,A,w,V,U,j=qee(this),re=Kee(r),ce=arguments.length,Te=ce>1?arguments[1]:void 0,De=Te!==void 0,ze=jee(re);if(ze&&!Yee(ze))for(U=(V=Wee(re,ze)).next,re=[];!(w=Hee(U,V)).done;)re.push(w.value);for(De&&ce>2&&(Te=$ee(Te,arguments[2])),d=zee(re),g=new(Xee(j))(d),C=Jee(g),a=0;d>a;a++)A=De?Te(re[a],a):re[a],g[a]=C?Qee(A):+A;return g},Fx=jo,Vx=X,Gx=Cn,Zee=eo,ete=Lx,ag=Ql,Bx=_C,$x=Zc,tte=Kc,M_=ha,nte=Lee,ote=Ba,Hx=YU,Yk=Px,qx=fr,k_=Ge,rte=ga,Jk=zn,ite=yt,ste=Be,ate=Rt,EC=Os,lte=th.f,Kx=xx,cte=CP.forEach,ute=Np,dte=pa,zx=Ir,Wx=Ka,hte=Z2,Xk=Wr.get,fte=Wr.set,pte=Wr.enforce,jx=zx.f,gte=Wx.f,mte=Math.round,Qk=Vx.RangeError,Yx=Bx.ArrayBuffer,vte=Yx.prototype,_te=Bx.DataView,MC=ag.NATIVE_ARRAY_BUFFER_VIEWS,Jx=ag.TYPED_ARRAY_TAG,Xx=ag.TypedArray,A_=ag.TypedArrayPrototype,yte=ag.aTypedArrayConstructor,Zk=ag.isTypedArray,kC="BYTES_PER_ELEMENT",eA="Wrong length",Qx=function(r,a){yte(r);for(var d=0,g=a.length,C=new r(g);g>d;)C[d]=a[d++];return C},AC=function(r,a){dte(r,a,{configurable:!0,get:function(){return Xk(this)[a]}})},Zx=function(r){var a;return ate(vte,r)||(a=rte(r))=="ArrayBuffer"||a=="SharedArrayBuffer"},e3=function(r,a){return Zk(r)&&!ite(a)&&a in r&&nte(+a)&&a>=0},t3=function(r,a){return a=qx(a),e3(r,a)?tte(2,r[a]):gte(r,a)},n3=function(r,a,d){return a=qx(a),!(e3(r,a)&&Jk(d)&&k_(d,"value"))||k_(d,"get")||k_(d,"set")||d.configurable||k_(d,"writable")&&!d.writable||k_(d,"enumerable")&&!d.enumerable?jx(r,a,d):(r[a]=d.value,r)};Zee?(MC||(Wx.f=t3,zx.f=n3,AC(A_,"buffer"),AC(A_,"byteOffset"),AC(A_,"byteLength"),AC(A_,"length")),Fx({target:"Object",stat:!0,forced:!MC},{getOwnPropertyDescriptor:t3,defineProperty:n3}),Sx.exports=function(r,a,d){var g=r.match(/\d+/)[0]/8,C=r+(d?"Clamped":"")+"Array",A="get"+r,w="set"+r,V=Vx[C],U=V,j=U&&U.prototype,re={},ce=function(De,ze){jx(De,ze,{get:function(){return function(_t,Ft){var $t=Xk(_t);return $t.view[A](Ft*g+$t.byteOffset,!0)}(this,ze)},set:function(_t){return function(Ft,$t,bt){var yn=Xk(Ft);d&&(bt=(bt=mte(bt))<0?0:bt>255?255:255&bt),yn.view[w]($t*g+yn.byteOffset,bt,!0)}(this,ze,_t)},enumerable:!0})};MC?ete&&(U=a(function(De,ze,_t,Ft){return $x(De,j),hte(Jk(ze)?Zx(ze)?Ft!==void 0?new V(ze,Yk(_t,g),Ft):_t!==void 0?new V(ze,Yk(_t,g)):new V(ze):Zk(ze)?Qx(U,ze):Gx(Kx,U,ze):new V(Hx(ze)),De,U)}),EC&&EC(U,Xx),cte(lte(V),function(De){De in U||M_(U,De,V[De])}),U.prototype=j):(U=a(function(De,ze,_t,Ft){$x(De,j);var $t,bt,yn,Rn=0,Gn=0;if(Jk(ze)){if(!Zx(ze))return Zk(ze)?Qx(U,ze):Gx(Kx,U,ze);$t=ze,Gn=Yk(_t,g);var Vo=ze.byteLength;if(Ft===void 0){if(Vo%g||(bt=Vo-Gn)<0)throw Qk(eA)}else if((bt=ote(Ft)*g)+Gn>Vo)throw Qk(eA);yn=bt/g}else yn=Hx(ze),$t=new Yx(bt=yn*g);for(fte(De,{buffer:$t,byteOffset:Gn,byteLength:bt,length:yn,view:new _te($t)});Rn<yn;)ce(De,Rn++)}),EC&&EC(U,Xx),j=U.prototype=ste(A_)),j.constructor!==U&&M_(j,"constructor",U),pte(j).TypedArrayConstructor=U,Jx&&M_(j,Jx,C);var Te=U!=V;re[C]=U,Fx({global:!0,constructor:!0,forced:Te,sham:!MC},re),kC in U||M_(U,kC,g),kC in j||M_(j,kC,g),ute(C)}):Sx.exports=function(){},IC("Uint8",function(r){return function(a,d,g){return r(this,a,d,g)}});var Ite=XU,bte=Ux,Cte=ga,Ste=Cn,Tte=c,Ete=Ql.aTypedArray,Mte=Ql.exportTypedArrayMethod,kte=b("".slice);Mte("fill",function(r){var a=arguments.length;Ete(this);var d=kte(Cte(this),0,3)==="Big"?bte(r):+r;return Ste(Ite,this,d,a>1?arguments[1]:void 0,a>2?arguments[2]:void 0)},Tte(function(){var r=0;return new Int8Array(2).fill({valueOf:function(){return r++}}),r!==1}));var o3=X,r3=Cn,tA=Ql,Ate=Ur,Rte=Px,wte=Oe,i3=c,Dte=o3.RangeError,nA=o3.Int8Array,s3=nA&&nA.prototype,a3=s3&&s3.set,Ote=tA.aTypedArray,Nte=tA.exportTypedArrayMethod,oA=!i3(function(){var r=new Uint8ClampedArray(2);return r3(a3,r,{length:1,0:3},1),r[1]!==3}),Lte=oA&&tA.NATIVE_ARRAY_BUFFER_VIEWS&&i3(function(){var r=new nA(2);return r.set(1),r.set("2",1),r[0]!==0||r[1]!==2});Nte("set",function(r){Ote(this);var a=Rte(arguments.length>1?arguments[1]:void 0,1),d=wte(r);if(oA)return r3(a3,this,d,a);var g=this.length,C=Ate(d),A=0;if(C+a>g)throw Dte("Wrong length");for(;A<C;)this[a+A]=d[A++]},!oA||Lte);var l3=xe.match(/firefox\/(\d+)/i),c3=!!l3&&+l3[1],u3=/MSIE|Trident/.test(xe),d3=xe.match(/AppleWebKit\/(\d+)\./),h3=!!d3&&+d3[1],Pte=yh,rA=c,Ute=Ni,xte=ek,f3=c3,Fte=u3,p3=Je,g3=h3,Vte=Ql.aTypedArray,Gte=Ql.exportTypedArrayMethod,R_=X.Uint16Array,lg=R_&&Pte(R_.prototype.sort),Bte=!(!lg||rA(function(){lg(new R_(2),null)})&&rA(function(){lg(new R_(2),{})})),m3=!!lg&&!rA(function(){if(p3)return p3<74;if(f3)return f3<67;if(Fte)return!0;if(g3)return g3<602;var r,a,d=new R_(516),g=Array(516);for(r=0;r<516;r++)a=r%4,d[r]=515-r,g[r]=r-2*a+3;for(lg(d,function(C,A){return(C/4|0)-(A/4|0)}),r=0;r<516;r++)if(d[r]!==g[r])return!0});Gte("sort",function(r){return r!==void 0&&Ute(r),m3?lg(this,r):xte(Vte(this),function(a){return function(d,g){return a!==void 0?+a(d,g)||0:g!=g?-1:d!=d?1:d===0&&g===0?1/d>0&&1/g<0?1:-1:d>g}}(r))},!m3||Bte);var $te=jo,RC=Xa,Hte=c,v3=xn,_3=jt,qte=i_,y3=X2,Kte=ji,iA=RC&&RC.prototype;if($te({target:"Promise",proto:!0,real:!0,forced:!!RC&&Hte(function(){iA.finally.call({then:function(){}},function(){})})},{finally:function(r){var a=qte(this,v3("Promise")),d=_3(r);return this.then(d?function(g){return y3(a,r()).then(function(){return g})}:r,d?function(g){return y3(a,r()).then(function(){throw g})}:r)}}),_3(RC)){var I3=v3("Promise").prototype.finally;iA.finally!==I3&&Kte(iA,"finally",I3,{unsafe:!0})}var zte=Np,sA="ArrayBuffer",b3=_C[sA];jo({global:!0,constructor:!0,forced:X[sA]!==b3},{ArrayBuffer:b3}),zte(sA);var C3=dn,Wte=TypeError,jte=jo,S3=b,Yte=Ni,Jte=Oe,T3=Ur,Xte=function(r,a){if(!delete r[a])throw Wte("Cannot delete property "+C3(a)+" of "+C3(r))},E3=fs,aA=c,Qte=ek,Zte=$M,M3=c3,ene=u3,k3=Je,A3=h3,vu=[],R3=S3(vu.sort),tne=S3(vu.push),nne=aA(function(){vu.sort(void 0)}),one=aA(function(){vu.sort(null)}),rne=Zte("sort"),w3=!aA(function(){if(k3)return k3<70;if(!(M3&&M3>3)){if(ene)return!0;if(A3)return A3<603;var r,a,d,g,C="";for(r=65;r<76;r++){switch(a=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:d=3;break;case 68:case 71:d=4;break;default:d=2}for(g=0;g<47;g++)vu.push({k:a+g,v:d})}for(vu.sort(function(A,w){return w.v-A.v}),g=0;g<vu.length;g++)a=vu[g].k.charAt(0),C.charAt(C.length-1)!==a&&(C+=a);return C!=="DGBEFHACIJK"}});jte({target:"Array",proto:!0,forced:nne||!one||!rne||!w3},{sort:function(r){r!==void 0&&Yte(r);var a=Jte(this);if(w3)return r===void 0?R3(a):R3(a,r);var d,g,C=[],A=T3(a);for(g=0;g<A;g++)g in a&&tne(C,a[g]);for(Qte(C,function(w){return function(V,U){return U===void 0?-1:V===void 0?1:w!==void 0?+w(V,U)||0:E3(V)>E3(U)?1:-1}}(r)),d=T3(C),g=0;g<d;)a[g]=C[g++];for(;g<A;)Xte(a,g++);return a}}),IC("Float32",function(r){return function(a,d,g){return r(this,a,d,g)}});var ine=jo,sne=_P,ane=b([].reverse),D3=[1,2];ine({target:"Array",proto:!0,forced:String(D3)===String(D3.reverse())},{reverse:function(){return sne(this)&&(this.length=this.length),ane(this)}});var lne=jo,cne=Cn,lA=b,O3=z,une=jt,dne=F,hne=eP,w_=fs,fne=Qe,pne=oP,gne=LP,mne=Xe("replace"),vne=TypeError,N3=lA("".indexOf);lA("".replace);var L3=lA("".slice),_ne=Math.max,P3=function(r,a,d){return d>r.length?-1:a===""?d:N3(r,a,d)};lne({target:"String",proto:!0},{replaceAll:function(r,a){var d,g,C,A,w,V,U,j,re=O3(this),ce=0,Te=0,De="";if(!dne(r)){if(hne(r)&&(d=w_(O3(pne(r))),!~N3(d,"g")))throw vne("`.replaceAll` does not allow non-global regexes");if(g=fne(r,mne))return cne(g,r,re,a)}for(C=w_(re),A=w_(r),(w=une(a))||(a=w_(a)),V=A.length,U=_ne(1,V),ce=P3(C,A,0);ce!==-1;)j=w?w_(a(A,ce,C)):gne(A,C,ce,[],void 0,a),De+=L3(C,Te,ce)+j,Te=ce+V,ce=P3(C,A,ce+U);return Te<C.length&&(De+=L3(C,Te)),De}}),(0,Ql.exportTypedArrayStaticMethod)("from",xx,Lx);let U3=!0,x3=!0;function wC(r,a,d){const g=r.match(a);return g&&g.length>=d&&parseInt(g[d],10)}function xh(r,a,d){if(!r.RTCPeerConnection)return;const g=r.RTCPeerConnection.prototype,C=g.addEventListener;g.addEventListener=function(w,V){if(w!==a)return C.apply(this,arguments);const U=j=>{const re=d(j);re&&(V.handleEvent?V.handleEvent(re):V(re))};return this._eventMap=this._eventMap||{},this._eventMap[a]||(this._eventMap[a]=new Map),this._eventMap[a].set(V,U),C.apply(this,[w,U])};const A=g.removeEventListener;g.removeEventListener=function(w,V){if(w!==a||!this._eventMap||!this._eventMap[a])return A.apply(this,arguments);if(!this._eventMap[a].has(V))return A.apply(this,arguments);const U=this._eventMap[a].get(V);return this._eventMap[a].delete(V),this._eventMap[a].size===0&&delete this._eventMap[a],Object.keys(this._eventMap).length===0&&delete this._eventMap,A.apply(this,[w,U])},Object.defineProperty(g,"on"+a,{get(){return this["_on"+a]},set(w){this["_on"+a]&&(this.removeEventListener(a,this["_on"+a]),delete this["_on"+a]),w&&this.addEventListener(a,this["_on"+a]=w)},enumerable:!0,configurable:!0})}function yne(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(U3=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function Ine(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(x3=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function F3(){if(typeof window=="object"){if(U3)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function cA(r,a){x3&&console.warn(r+" is deprecated, please use "+a+" instead.")}function V3(r){return Object.prototype.toString.call(r)==="[object Object]"}function G3(r){return V3(r)?Object.keys(r).reduce(function(a,d){const g=V3(r[d]),C=g?G3(r[d]):r[d],A=g&&!Object.keys(C).length;return C===void 0||A?a:Object.assign(a,{[d]:C})},{}):r}function uA(r,a,d){a&&!d.has(a.id)&&(d.set(a.id,a),Object.keys(a).forEach(g=>{g.endsWith("Id")?uA(r,r.get(a[g]),d):g.endsWith("Ids")&&a[g].forEach(C=>{uA(r,r.get(C),d)})}))}function B3(r,a,d){const g=d?"outbound-rtp":"inbound-rtp",C=new Map;if(a===null)return C;const A=[];return r.forEach(w=>{w.type==="track"&&w.trackIdentifier===a.id&&A.push(w)}),A.forEach(w=>{r.forEach(V=>{V.type===g&&V.trackId===w.id&&uA(r,V,C)})}),C}const $3=F3;function H3(r,a){const d=r&&r.navigator;if(!d.mediaDevices)return;const g=function(w){if(typeof w!="object"||w.mandatory||w.optional)return w;const V={};return Object.keys(w).forEach(U=>{if(U==="require"||U==="advanced"||U==="mediaSource")return;const j=typeof w[U]=="object"?w[U]:{ideal:w[U]};j.exact!==void 0&&typeof j.exact=="number"&&(j.min=j.max=j.exact);const re=function(ce,Te){return ce?ce+Te.charAt(0).toUpperCase()+Te.slice(1):Te==="deviceId"?"sourceId":Te};if(j.ideal!==void 0){V.optional=V.optional||[];let ce={};typeof j.ideal=="number"?(ce[re("min",U)]=j.ideal,V.optional.push(ce),ce={},ce[re("max",U)]=j.ideal,V.optional.push(ce)):(ce[re("",U)]=j.ideal,V.optional.push(ce))}j.exact!==void 0&&typeof j.exact!="number"?(V.mandatory=V.mandatory||{},V.mandatory[re("",U)]=j.exact):["min","max"].forEach(ce=>{j[ce]!==void 0&&(V.mandatory=V.mandatory||{},V.mandatory[re(ce,U)]=j[ce])})}),w.advanced&&(V.optional=(V.optional||[]).concat(w.advanced)),V},C=function(w,V){if(a.version>=61)return V(w);if((w=JSON.parse(JSON.stringify(w)))&&typeof w.audio=="object"){const U=function(j,re,ce){re in j&&!(ce in j)&&(j[ce]=j[re],delete j[re])};U((w=JSON.parse(JSON.stringify(w))).audio,"autoGainControl","googAutoGainControl"),U(w.audio,"noiseSuppression","googNoiseSuppression"),w.audio=g(w.audio)}if(w&&typeof w.video=="object"){let U=w.video.facingMode;U=U&&(typeof U=="object"?U:{ideal:U});const j=a.version<66;if(U&&(U.exact==="user"||U.exact==="environment"||U.ideal==="user"||U.ideal==="environment")&&(!d.mediaDevices.getSupportedConstraints||!d.mediaDevices.getSupportedConstraints().facingMode||j)){let re;if(delete w.video.facingMode,U.exact==="environment"||U.ideal==="environment"?re=["back","rear"]:U.exact!=="user"&&U.ideal!=="user"||(re=["front"]),re)return d.mediaDevices.enumerateDevices().then(ce=>{let Te=(ce=ce.filter(De=>De.kind==="videoinput")).find(De=>re.some(ze=>De.label.toLowerCase().includes(ze)));return!Te&&ce.length&&re.includes("back")&&(Te=ce[ce.length-1]),Te&&(w.video.deviceId=U.exact?{exact:Te.deviceId}:{ideal:Te.deviceId}),w.video=g(w.video),$3("chrome: "+JSON.stringify(w)),V(w)})}w.video=g(w.video)}return $3("chrome: "+JSON.stringify(w)),V(w)},A=function(w){return a.version>=64?w:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[w.name]||w.name,message:w.message,constraint:w.constraint||w.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(d.getUserMedia=(function(w,V,U){C(w,j=>{d.webkitGetUserMedia(j,V,re=>{U&&U(A(re))})})}).bind(d),d.mediaDevices.getUserMedia){const w=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(V){return C(V,U=>w(U).then(j=>{if(U.audio&&!j.getAudioTracks().length||U.video&&!j.getVideoTracks().length)throw j.getTracks().forEach(re=>{re.stop()}),new DOMException("","NotFoundError");return j},j=>Promise.reject(A(j))))}}}function q3(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function K3(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(d){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=d)},enumerable:!0,configurable:!0});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=d=>{d.stream.addEventListener("addtrack",g=>{let C;C=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(w=>w.track&&w.track.id===g.track.id):{track:g.track};const A=new Event("track");A.track=g.track,A.receiver=C,A.transceiver={receiver:C},A.streams=[d.stream],this.dispatchEvent(A)}),d.stream.getTracks().forEach(g=>{let C;C=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(w=>w.track&&w.track.id===g.id):{track:g};const A=new Event("track");A.track=g,A.receiver=C,A.transceiver={receiver:C},A.streams=[d.stream],this.dispatchEvent(A)})},this.addEventListener("addstream",this._ontrackpoly)),a.apply(this,arguments)}}else xh(r,"track",a=>(a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a))}function z3(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const a=function(C,A){return{track:A,get dtmf(){return this._dtmf===void 0&&(A.kind==="audio"?this._dtmf=C.createDTMFSender(A):this._dtmf=null),this._dtmf},_pc:C}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const C=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(w,V){let U=C.apply(this,arguments);return U||(U=a(this,w),this._senders.push(U)),U};const A=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(w){A.apply(this,arguments);const V=this._senders.indexOf(w);V!==-1&&this._senders.splice(V,1)}}const d=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(C){this._senders=this._senders||[],d.apply(this,[C]),C.getTracks().forEach(A=>{this._senders.push(a(this,A))})};const g=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(C){this._senders=this._senders||[],g.apply(this,[C]),C.getTracks().forEach(A=>{const w=this._senders.find(V=>V.track===A);w&&this._senders.splice(this._senders.indexOf(w),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const a=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const d=a.apply(this,[]);return d.forEach(g=>g._pc=this),d},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function W3(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[d,g,C]=arguments;if(arguments.length>0&&typeof d=="function")return a.apply(this,arguments);if(a.length===0&&(arguments.length===0||typeof d!="function"))return a.apply(this,[]);const A=function(V){const U={};return V.result().forEach(j=>{const re={id:j.id,timestamp:j.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[j.type]||j.type};j.names().forEach(ce=>{re[ce]=j.stat(ce)}),U[re.id]=re}),U},w=function(V){return new Map(Object.keys(V).map(U=>[U,V[U]]))};if(arguments.length>=2){const V=function(U){g(w(A(U)))};return a.apply(this,[V,d])}return new Promise((V,U)=>{a.apply(this,[function(j){V(w(A(j)))},U])}).then(g,C)}}function j3(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const d=r.RTCPeerConnection.prototype.getSenders;d&&(r.RTCPeerConnection.prototype.getSenders=function(){const C=d.apply(this,[]);return C.forEach(A=>A._pc=this),C});const g=r.RTCPeerConnection.prototype.addTrack;g&&(r.RTCPeerConnection.prototype.addTrack=function(){const C=g.apply(this,arguments);return C._pc=this,C}),r.RTCRtpSender.prototype.getStats=function(){const C=this;return this._pc.getStats().then(A=>B3(A,C.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const d=r.RTCPeerConnection.prototype.getReceivers;d&&(r.RTCPeerConnection.prototype.getReceivers=function(){const g=d.apply(this,[]);return g.forEach(C=>C._pc=this),g}),xh(r,"track",g=>(g.receiver._pc=g.srcElement,g)),r.RTCRtpReceiver.prototype.getStats=function(){const g=this;return this._pc.getStats().then(C=>B3(C,g.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype)||!("getStats"in r.RTCRtpReceiver.prototype))return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const d=arguments[0];let g,C,A;return this.getSenders().forEach(w=>{w.track===d&&(g?A=!0:g=w)}),this.getReceivers().forEach(w=>(w.track===d&&(C?A=!0:C=w),w.track===d)),A||g&&C?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):g?g.getStats():C?C.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}function Y3(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(A=>this._shimmedLocalStreams[A][0])};const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(A,w){if(!w)return a.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const V=a.apply(this,arguments);return this._shimmedLocalStreams[w.id]?this._shimmedLocalStreams[w.id].indexOf(V)===-1&&this._shimmedLocalStreams[w.id].push(V):this._shimmedLocalStreams[w.id]=[w,V],V};const d=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(A){this._shimmedLocalStreams=this._shimmedLocalStreams||{},A.getTracks().forEach(U=>{if(this.getSenders().find(j=>j.track===U))throw new DOMException("Track already exists.","InvalidAccessError")});const w=this.getSenders();d.apply(this,arguments);const V=this.getSenders().filter(U=>w.indexOf(U)===-1);this._shimmedLocalStreams[A.id]=[A].concat(V)};const g=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(A){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[A.id],g.apply(this,arguments)};const C=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(A){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},A&&Object.keys(this._shimmedLocalStreams).forEach(w=>{const V=this._shimmedLocalStreams[w].indexOf(A);V!==-1&&this._shimmedLocalStreams[w].splice(V,1),this._shimmedLocalStreams[w].length===1&&delete this._shimmedLocalStreams[w]}),C.apply(this,arguments)}}function J3(r,a){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&a.version>=65)return Y3(r);const d=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const U=d.apply(this);return this._reverseStreams=this._reverseStreams||{},U.map(j=>this._reverseStreams[j.id])};const g=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(U){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},U.getTracks().forEach(j=>{if(this.getSenders().find(re=>re.track===j))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[U.id]){const j=new r.MediaStream(U.getTracks());this._streams[U.id]=j,this._reverseStreams[j.id]=U,U=j}g.apply(this,[U])};const C=r.RTCPeerConnection.prototype.removeStream;function A(U,j){let re=j.sdp;return Object.keys(U._reverseStreams||[]).forEach(ce=>{const Te=U._reverseStreams[ce],De=U._streams[Te.id];re=re.replace(new RegExp(De.id,"g"),Te.id)}),new RTCSessionDescription({type:j.type,sdp:re})}r.RTCPeerConnection.prototype.removeStream=function(U){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},C.apply(this,[this._streams[U.id]||U]),delete this._reverseStreams[this._streams[U.id]?this._streams[U.id].id:U.id],delete this._streams[U.id]},r.RTCPeerConnection.prototype.addTrack=function(U,j){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const re=[].slice.call(arguments,1);if(re.length!==1||!re[0].getTracks().find(Te=>Te===U))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(Te=>Te.track===U))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const ce=this._streams[j.id];if(ce)ce.addTrack(U),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const Te=new r.MediaStream([U]);this._streams[j.id]=Te,this._reverseStreams[Te.id]=j,this.addStream(Te)}return this.getSenders().find(Te=>Te.track===U)},["createOffer","createAnswer"].forEach(function(U){const j=r.RTCPeerConnection.prototype[U],re={[U](){const ce=arguments;return arguments.length&&typeof arguments[0]=="function"?j.apply(this,[Te=>{const De=A(this,Te);ce[0].apply(null,[De])},Te=>{ce[1]&&ce[1].apply(null,Te)},arguments[2]]):j.apply(this,arguments).then(Te=>A(this,Te))}};r.RTCPeerConnection.prototype[U]=re[U]});const w=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(U,j){let re=j.sdp;return Object.keys(U._reverseStreams||[]).forEach(ce=>{const Te=U._reverseStreams[ce],De=U._streams[Te.id];re=re.replace(new RegExp(Te.id,"g"),De.id)}),new RTCSessionDescription({type:j.type,sdp:re})}(this,arguments[0]),w.apply(this,arguments)):w.apply(this,arguments)};const V=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const U=V.get.apply(this);return U.type===""?U:A(this,U)}}),r.RTCPeerConnection.prototype.removeTrack=function(U){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!U._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(U._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let j;this._streams=this._streams||{},Object.keys(this._streams).forEach(re=>{this._streams[re].getTracks().find(ce=>U.track===ce)&&(j=this._streams[re])}),j&&(j.getTracks().length===1?this.removeStream(this._reverseStreams[j.id]):j.removeTrack(U.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dA(r,a){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const g=r.RTCPeerConnection.prototype[d],C={[d](){return arguments[0]=new(d==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),g.apply(this,arguments)}};r.RTCPeerConnection.prototype[d]=C[d]})}function X3(r,a){xh(r,"negotiationneeded",d=>{const g=d.target;if(!(a.version<72||g.getConfiguration&&g.getConfiguration().sdpSemantics==="plan-b")||g.signalingState==="stable")return d})}var Q3=Object.freeze({__proto__:null,shimMediaStream:q3,shimOnTrack:K3,shimGetSendersWithDtmf:z3,shimGetStats:W3,shimSenderReceiverGetStats:j3,shimAddTrackRemoveTrackWithNative:Y3,shimAddTrackRemoveTrack:J3,shimPeerConnection:dA,fixNegotiationNeeded:X3,shimGetUserMedia:H3,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(typeof a=="function"?r.navigator.mediaDevices.getDisplayMedia=function(d){return a(d).then(g=>{const C=d.video&&d.video.width,A=d.video&&d.video.height,w=d.video&&d.video.frameRate;return d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:g,maxFrameRate:w||3}},C&&(d.video.mandatory.maxWidth=C),A&&(d.video.mandatory.maxHeight=A),r.navigator.mediaDevices.getUserMedia(d)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function Z3(r,a){const d=r&&r.navigator,g=r&&r.MediaStreamTrack;if(d.getUserMedia=function(C,A,w){cA("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),d.mediaDevices.getUserMedia(C).then(A,w)},!(a.version>55&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){const C=function(w,V,U){V in w&&!(U in w)&&(w[U]=w[V],delete w[V])},A=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(w){return typeof w=="object"&&typeof w.audio=="object"&&(w=JSON.parse(JSON.stringify(w)),C(w.audio,"autoGainControl","mozAutoGainControl"),C(w.audio,"noiseSuppression","mozNoiseSuppression")),A(w)},g&&g.prototype.getSettings){const w=g.prototype.getSettings;g.prototype.getSettings=function(){const V=w.apply(this,arguments);return C(V,"mozAutoGainControl","autoGainControl"),C(V,"mozNoiseSuppression","noiseSuppression"),V}}if(g&&g.prototype.applyConstraints){const w=g.prototype.applyConstraints;g.prototype.applyConstraints=function(V){return this.kind==="audio"&&typeof V=="object"&&(V=JSON.parse(JSON.stringify(V)),C(V,"autoGainControl","mozAutoGainControl"),C(V,"noiseSuppression","mozNoiseSuppression")),w.apply(this,[V])}}}}function eF(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function hA(r,a){if(typeof r!="object"||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(C){const A=r.RTCPeerConnection.prototype[C],w={[C](){return arguments[0]=new(C==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),A.apply(this,arguments)}};r.RTCPeerConnection.prototype[C]=w[C]});const d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[C,A,w]=arguments;return g.apply(this,[C||null]).then(V=>{if(a.version<53&&!A)try{V.forEach(U=>{U.type=d[U.type]||U.type})}catch(U){if(U.name!=="TypeError")throw U;V.forEach((j,re)=>{V.set(re,Object.assign({},j,{type:d[j.type]||j.type}))})}return V}).then(A,w)}}function tF(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const a=r.RTCPeerConnection.prototype.getSenders;a&&(r.RTCPeerConnection.prototype.getSenders=function(){const g=a.apply(this,[]);return g.forEach(C=>C._pc=this),g});const d=r.RTCPeerConnection.prototype.addTrack;d&&(r.RTCPeerConnection.prototype.addTrack=function(){const g=d.apply(this,arguments);return g._pc=this,g}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function nF(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const a=r.RTCPeerConnection.prototype.getReceivers;a&&(r.RTCPeerConnection.prototype.getReceivers=function(){const d=a.apply(this,[]);return d.forEach(g=>g._pc=this),d}),xh(r,"track",d=>(d.receiver._pc=d.srcElement,d)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function oF(r){r.RTCPeerConnection&&!("removeStream"in r.RTCPeerConnection.prototype)&&(r.RTCPeerConnection.prototype.removeStream=function(a){cA("removeStream","removeTrack"),this.getSenders().forEach(d=>{d.track&&a.getTracks().includes(d.track)&&this.removeTrack(d)})})}function rF(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function iF(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.addTransceiver;a&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let d=arguments[1]&&arguments[1].sendEncodings;d===void 0&&(d=[]),d=[...d];const g=d.length>0;g&&d.forEach(A=>{if("rid"in A&&!/^[a-z0-9]{0,16}$/i.test(A.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in A&&!(parseFloat(A.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in A&&!(parseFloat(A.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const C=a.apply(this,arguments);if(g){const{sender:A}=C,w=A.getParameters();(!("encodings"in w)||w.encodings.length===1&&Object.keys(w.encodings[0]).length===0)&&(w.encodings=d,A.sendEncodings=d,this.setParametersPromises.push(A.setParameters(w).then(()=>{delete A.sendEncodings}).catch(()=>{delete A.sendEncodings})))}return C})}function sF(r){if(typeof r!="object"||!r.RTCRtpSender)return;const a=r.RTCRtpSender.prototype.getParameters;a&&(r.RTCRtpSender.prototype.getParameters=function(){const d=a.apply(this,arguments);return"encodings"in d||(d.encodings=[].concat(this.sendEncodings||[{}])),d})}function aF(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}function lF(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}var cF=Object.freeze({__proto__:null,shimOnTrack:eF,shimPeerConnection:hA,shimSenderGetStats:tF,shimReceiverGetStats:nF,shimRemoveStream:oF,shimRTCDataChannel:rF,shimAddTransceiver:iF,shimGetParameters:sF,shimCreateOffer:aF,shimCreateAnswer:lF,shimGetUserMedia:Z3,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video){const g=new DOMException("getDisplayMedia without video constraints is undefined");return g.name="NotFoundError",g.code=8,Promise.reject(g)}return d.video===!0?d.video={mediaSource:a}:d.video.mediaSource=a,r.navigator.mediaDevices.getUserMedia(d)})}});function uF(r){if(typeof r=="object"&&r.RTCPeerConnection){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(d){this._localStreams||(this._localStreams=[]),this._localStreams.includes(d)||this._localStreams.push(d),d.getAudioTracks().forEach(g=>a.call(this,g,d)),d.getVideoTracks().forEach(g=>a.call(this,g,d))},r.RTCPeerConnection.prototype.addTrack=function(d,...g){return g&&g.forEach(C=>{this._localStreams?this._localStreams.includes(C)||this._localStreams.push(C):this._localStreams=[C]}),a.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);const d=this._localStreams.indexOf(a);if(d===-1)return;this._localStreams.splice(d,1);const g=a.getTracks();this.getSenders().forEach(C=>{g.includes(C.track)&&this.removeTrack(C)})})}}function dF(r){if(typeof r=="object"&&r.RTCPeerConnection&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(d){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=d),this.addEventListener("track",this._onaddstreampoly=g=>{g.streams.forEach(C=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(C))return;this._remoteStreams.push(C);const A=new Event("addstream");A.stream=C,this.dispatchEvent(A)})})}});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const d=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(g){g.streams.forEach(C=>{if(d._remoteStreams||(d._remoteStreams=[]),d._remoteStreams.indexOf(C)>=0)return;d._remoteStreams.push(C);const A=new Event("addstream");A.stream=C,d.dispatchEvent(A)})}),a.apply(d,arguments)}}}function hF(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype,d=a.createOffer,g=a.createAnswer,C=a.setLocalDescription,A=a.setRemoteDescription,w=a.addIceCandidate;a.createOffer=function(U,j){const re=arguments.length>=2?arguments[2]:arguments[0],ce=d.apply(this,[re]);return j?(ce.then(U,j),Promise.resolve()):ce},a.createAnswer=function(U,j){const re=arguments.length>=2?arguments[2]:arguments[0],ce=g.apply(this,[re]);return j?(ce.then(U,j),Promise.resolve()):ce};let V=function(U,j,re){const ce=C.apply(this,[U]);return re?(ce.then(j,re),Promise.resolve()):ce};a.setLocalDescription=V,V=function(U,j,re){const ce=A.apply(this,[U]);return re?(ce.then(j,re),Promise.resolve()):ce},a.setRemoteDescription=V,V=function(U,j,re){const ce=w.apply(this,[U]);return re?(ce.then(j,re),Promise.resolve()):ce},a.addIceCandidate=V}function fF(r){const a=r&&r.navigator;if(a.mediaDevices&&a.mediaDevices.getUserMedia){const d=a.mediaDevices,g=d.getUserMedia.bind(d);a.mediaDevices.getUserMedia=C=>g(pF(C))}!a.getUserMedia&&a.mediaDevices&&a.mediaDevices.getUserMedia&&(a.getUserMedia=(function(d,g,C){a.mediaDevices.getUserMedia(d).then(g,C)}).bind(a))}function pF(r){return r&&r.video!==void 0?Object.assign({},r,{video:G3(r.video)}):r}function gF(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection;r.RTCPeerConnection=function(d,g){if(d&&d.iceServers){const C=[];for(let A=0;A<d.iceServers.length;A++){let w=d.iceServers[A];w.urls===void 0&&w.url?(cA("RTCIceServer.url","RTCIceServer.urls"),w=JSON.parse(JSON.stringify(w)),w.urls=w.url,delete w.url,C.push(w)):C.push(d.iceServers[A])}d.iceServers=C}return new a(d,g)},r.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in a&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:()=>a.generateCertificate})}function mF(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function vF(r){const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(d){if(d){d.offerToReceiveAudio!==void 0&&(d.offerToReceiveAudio=!!d.offerToReceiveAudio);const g=this.getTransceivers().find(A=>A.receiver.track.kind==="audio");d.offerToReceiveAudio===!1&&g?g.direction==="sendrecv"?g.setDirection?g.setDirection("sendonly"):g.direction="sendonly":g.direction==="recvonly"&&(g.setDirection?g.setDirection("inactive"):g.direction="inactive"):d.offerToReceiveAudio!==!0||g||this.addTransceiver("audio",{direction:"recvonly"}),d.offerToReceiveVideo!==void 0&&(d.offerToReceiveVideo=!!d.offerToReceiveVideo);const C=this.getTransceivers().find(A=>A.receiver.track.kind==="video");d.offerToReceiveVideo===!1&&C?C.direction==="sendrecv"?C.setDirection?C.setDirection("sendonly"):C.direction="sendonly":C.direction==="recvonly"&&(C.setDirection?C.setDirection("inactive"):C.direction="inactive"):d.offerToReceiveVideo!==!0||C||this.addTransceiver("video",{direction:"recvonly"})}return a.apply(this,arguments)}}function _F(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}var yF=Object.freeze({__proto__:null,shimLocalStreamsAPI:uF,shimRemoteStreamsAPI:dF,shimCallbacksAPI:hF,shimGetUserMedia:fF,shimConstraints:pF,shimRTCIceServerUrls:gF,shimTrackEventTransceiver:mF,shimCreateOfferLegacy:vF,shimAudioContext:_F}),DC={},bne={get exports(){return DC},set exports(r){DC=r}};(function(r){const a={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};a.localCName=a.generateIdentifier(),a.splitLines=function(d){return d.trim().split(`
`).map(g=>g.trim())},a.splitSections=function(d){return d.split(`
m=`).map((g,C)=>(C>0?"m="+g:g).trim()+`\r
`)},a.getDescription=function(d){const g=a.splitSections(d);return g&&g[0]},a.getMediaSections=function(d){const g=a.splitSections(d);return g.shift(),g},a.matchPrefix=function(d,g){return a.splitLines(d).filter(C=>C.indexOf(g)===0)},a.parseCandidate=function(d){let g;g=d.indexOf("a=candidate:")===0?d.substring(12).split(" "):d.substring(10).split(" ");const C={foundation:g[0],component:{1:"rtp",2:"rtcp"}[g[1]]||g[1],protocol:g[2].toLowerCase(),priority:parseInt(g[3],10),ip:g[4],address:g[4],port:parseInt(g[5],10),type:g[7]};for(let A=8;A<g.length;A+=2)switch(g[A]){case"raddr":C.relatedAddress=g[A+1];break;case"rport":C.relatedPort=parseInt(g[A+1],10);break;case"tcptype":C.tcpType=g[A+1];break;case"ufrag":C.ufrag=g[A+1],C.usernameFragment=g[A+1];break;default:C[g[A]]===void 0&&(C[g[A]]=g[A+1])}return C},a.writeCandidate=function(d){const g=[];g.push(d.foundation);const C=d.component;C==="rtp"?g.push(1):C==="rtcp"?g.push(2):g.push(C),g.push(d.protocol.toUpperCase()),g.push(d.priority),g.push(d.address||d.ip),g.push(d.port);const A=d.type;return g.push("typ"),g.push(A),A!=="host"&&d.relatedAddress&&d.relatedPort&&(g.push("raddr"),g.push(d.relatedAddress),g.push("rport"),g.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(g.push("tcptype"),g.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(g.push("ufrag"),g.push(d.usernameFragment||d.ufrag)),"candidate:"+g.join(" ")},a.parseIceOptions=function(d){return d.substring(14).split(" ")},a.parseRtpMap=function(d){let g=d.substring(9).split(" ");const C={payloadType:parseInt(g.shift(),10)};return g=g[0].split("/"),C.name=g[0],C.clockRate=parseInt(g[1],10),C.channels=g.length===3?parseInt(g[2],10):1,C.numChannels=C.channels,C},a.writeRtpMap=function(d){let g=d.payloadType;d.preferredPayloadType!==void 0&&(g=d.preferredPayloadType);const C=d.channels||d.numChannels||1;return"a=rtpmap:"+g+" "+d.name+"/"+d.clockRate+(C!==1?"/"+C:"")+`\r
`},a.parseExtmap=function(d){const g=d.substring(9).split(" ");return{id:parseInt(g[0],10),direction:g[0].indexOf("/")>0?g[0].split("/")[1]:"sendrecv",uri:g[1],attributes:g.slice(2).join(" ")}},a.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+(d.attributes?" "+d.attributes:"")+`\r
`},a.parseFmtp=function(d){const g={};let C;const A=d.substring(d.indexOf(" ")+1).split(";");for(let w=0;w<A.length;w++)C=A[w].trim().split("="),g[C[0].trim()]=C[1];return g},a.writeFmtp=function(d){let g="",C=d.payloadType;if(d.preferredPayloadType!==void 0&&(C=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){const A=[];Object.keys(d.parameters).forEach(w=>{d.parameters[w]!==void 0?A.push(w+"="+d.parameters[w]):A.push(w)}),g+="a=fmtp:"+C+" "+A.join(";")+`\r
`}return g},a.parseRtcpFb=function(d){const g=d.substring(d.indexOf(" ")+1).split(" ");return{type:g.shift(),parameter:g.join(" ")}},a.writeRtcpFb=function(d){let g="",C=d.payloadType;return d.preferredPayloadType!==void 0&&(C=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(A=>{g+="a=rtcp-fb:"+C+" "+A.type+(A.parameter&&A.parameter.length?" "+A.parameter:"")+`\r
`}),g},a.parseSsrcMedia=function(d){const g=d.indexOf(" "),C={ssrc:parseInt(d.substring(7,g),10)},A=d.indexOf(":",g);return A>-1?(C.attribute=d.substring(g+1,A),C.value=d.substring(A+1)):C.attribute=d.substring(g+1),C},a.parseSsrcGroup=function(d){const g=d.substring(13).split(" ");return{semantics:g.shift(),ssrcs:g.map(C=>parseInt(C,10))}},a.getMid=function(d){const g=a.matchPrefix(d,"a=mid:")[0];if(g)return g.substring(6)},a.parseFingerprint=function(d){const g=d.substring(14).split(" ");return{algorithm:g[0].toLowerCase(),value:g[1].toUpperCase()}},a.getDtlsParameters=function(d,g){return{role:"auto",fingerprints:a.matchPrefix(d+g,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(d,g){let C="a=setup:"+g+`\r
`;return d.fingerprints.forEach(A=>{C+="a=fingerprint:"+A.algorithm+" "+A.value+`\r
`}),C},a.parseCryptoLine=function(d){const g=d.substring(9).split(" ");return{tag:parseInt(g[0],10),cryptoSuite:g[1],keyParams:g[2],sessionParams:g.slice(3)}},a.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+(typeof d.keyParams=="object"?a.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+`\r
`},a.parseCryptoKeyParams=function(d){if(d.indexOf("inline:")!==0)return null;const g=d.substring(7).split("|");return{keyMethod:"inline",keySalt:g[0],lifeTime:g[1],mkiValue:g[2]?g[2].split(":")[0]:void 0,mkiLength:g[2]?g[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")},a.getCryptoParameters=function(d,g){return a.matchPrefix(d+g,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(d,g){const C=a.matchPrefix(d+g,"a=ice-ufrag:")[0],A=a.matchPrefix(d+g,"a=ice-pwd:")[0];return C&&A?{usernameFragment:C.substring(12),password:A.substring(10)}:null},a.writeIceParameters=function(d){let g="a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`;return d.iceLite&&(g+=`a=ice-lite\r
`),g},a.parseRtpParameters=function(d){const g={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},C=a.splitLines(d)[0].split(" ");g.profile=C[2];for(let w=3;w<C.length;w++){const V=C[w],U=a.matchPrefix(d,"a=rtpmap:"+V+" ")[0];if(U){const j=a.parseRtpMap(U),re=a.matchPrefix(d,"a=fmtp:"+V+" ");switch(j.parameters=re.length?a.parseFmtp(re[0]):{},j.rtcpFeedback=a.matchPrefix(d,"a=rtcp-fb:"+V+" ").map(a.parseRtcpFb),g.codecs.push(j),j.name.toUpperCase()){case"RED":case"ULPFEC":g.fecMechanisms.push(j.name.toUpperCase())}}}a.matchPrefix(d,"a=extmap:").forEach(w=>{g.headerExtensions.push(a.parseExtmap(w))});const A=a.matchPrefix(d,"a=rtcp-fb:* ").map(a.parseRtcpFb);return g.codecs.forEach(w=>{A.forEach(V=>{w.rtcpFeedback.find(U=>U.type===V.type&&U.parameter===V.parameter)||w.rtcpFeedback.push(V)})}),g},a.writeRtpDescription=function(d,g){let C="";C+="m="+d+" ",C+=g.codecs.length>0?"9":"0",C+=" "+(g.profile||"UDP/TLS/RTP/SAVPF")+" ",C+=g.codecs.map(w=>w.preferredPayloadType!==void 0?w.preferredPayloadType:w.payloadType).join(" ")+`\r
`,C+=`c=IN IP4 0.0.0.0\r
`,C+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,g.codecs.forEach(w=>{C+=a.writeRtpMap(w),C+=a.writeFmtp(w),C+=a.writeRtcpFb(w)});let A=0;return g.codecs.forEach(w=>{w.maxptime>A&&(A=w.maxptime)}),A>0&&(C+="a=maxptime:"+A+`\r
`),g.headerExtensions&&g.headerExtensions.forEach(w=>{C+=a.writeExtmap(w)}),C},a.parseRtpEncodingParameters=function(d){const g=[],C=a.parseRtpParameters(d),A=C.fecMechanisms.indexOf("RED")!==-1,w=C.fecMechanisms.indexOf("ULPFEC")!==-1,V=a.matchPrefix(d,"a=ssrc:").map(Te=>a.parseSsrcMedia(Te)).filter(Te=>Te.attribute==="cname"),U=V.length>0&&V[0].ssrc;let j;const re=a.matchPrefix(d,"a=ssrc-group:FID").map(Te=>Te.substring(17).split(" ").map(De=>parseInt(De,10)));re.length>0&&re[0].length>1&&re[0][0]===U&&(j=re[0][1]),C.codecs.forEach(Te=>{if(Te.name.toUpperCase()==="RTX"&&Te.parameters.apt){let De={ssrc:U,codecPayloadType:parseInt(Te.parameters.apt,10)};U&&j&&(De.rtx={ssrc:j}),g.push(De),A&&(De=JSON.parse(JSON.stringify(De)),De.fec={ssrc:U,mechanism:w?"red+ulpfec":"red"},g.push(De))}}),g.length===0&&U&&g.push({ssrc:U});let ce=a.matchPrefix(d,"b=");return ce.length&&(ce=ce[0].indexOf("b=TIAS:")===0?parseInt(ce[0].substring(7),10):ce[0].indexOf("b=AS:")===0?1e3*parseInt(ce[0].substring(5),10)*.95-16e3:void 0,g.forEach(Te=>{Te.maxBitrate=ce})),g},a.parseRtcpParameters=function(d){const g={},C=a.matchPrefix(d,"a=ssrc:").map(V=>a.parseSsrcMedia(V)).filter(V=>V.attribute==="cname")[0];C&&(g.cname=C.value,g.ssrc=C.ssrc);const A=a.matchPrefix(d,"a=rtcp-rsize");g.reducedSize=A.length>0,g.compound=A.length===0;const w=a.matchPrefix(d,"a=rtcp-mux");return g.mux=w.length>0,g},a.writeRtcpParameters=function(d){let g="";return d.reducedSize&&(g+=`a=rtcp-rsize\r
`),d.mux&&(g+=`a=rtcp-mux\r
`),d.ssrc!==void 0&&d.cname&&(g+="a=ssrc:"+d.ssrc+" cname:"+d.cname+`\r
`),g},a.parseMsid=function(d){let g;const C=a.matchPrefix(d,"a=msid:");if(C.length===1)return g=C[0].substring(7).split(" "),{stream:g[0],track:g[1]};const A=a.matchPrefix(d,"a=ssrc:").map(w=>a.parseSsrcMedia(w)).filter(w=>w.attribute==="msid");return A.length>0?(g=A[0].value.split(" "),{stream:g[0],track:g[1]}):void 0},a.parseSctpDescription=function(d){const g=a.parseMLine(d),C=a.matchPrefix(d,"a=max-message-size:");let A;C.length>0&&(A=parseInt(C[0].substring(19),10)),isNaN(A)&&(A=65536);const w=a.matchPrefix(d,"a=sctp-port:");if(w.length>0)return{port:parseInt(w[0].substring(12),10),protocol:g.fmt,maxMessageSize:A};const V=a.matchPrefix(d,"a=sctpmap:");if(V.length>0){const U=V[0].substring(10).split(" ");return{port:parseInt(U[0],10),protocol:U[1],maxMessageSize:A}}},a.writeSctpDescription=function(d,g){let C=[];return C=d.protocol!=="DTLS/SCTP"?["m="+d.kind+" 9 "+d.protocol+" "+g.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+g.port+`\r
`]:["m="+d.kind+" 9 "+d.protocol+" "+g.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+g.port+" "+g.protocol+` 65535\r
`],g.maxMessageSize!==void 0&&C.push("a=max-message-size:"+g.maxMessageSize+`\r
`),C.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,22)},a.writeSessionBoilerplate=function(d,g,C){let A;const w=g!==void 0?g:2;return A=d||a.generateSessionId(),`v=0\r
o=`+(C||"thisisadapterortc")+" "+A+" "+w+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},a.getDirection=function(d,g){const C=a.splitLines(d);for(let A=0;A<C.length;A++)switch(C[A]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return C[A].substring(2)}return g?a.getDirection(g):"sendrecv"},a.getKind=function(d){return a.splitLines(d)[0].split(" ")[0].substring(2)},a.isRejected=function(d){return d.split(" ",2)[1]==="0"},a.parseMLine=function(d){const g=a.splitLines(d)[0].substring(2).split(" ");return{kind:g[0],port:parseInt(g[1],10),protocol:g[2],fmt:g.slice(3).join(" ")}},a.parseOLine=function(d){const g=a.matchPrefix(d,"o=")[0].substring(2).split(" ");return{username:g[0],sessionId:g[1],sessionVersion:parseInt(g[2],10),netType:g[3],addressType:g[4],address:g[5]}},a.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;const g=a.splitLines(d);for(let C=0;C<g.length;C++)if(g[C].length<2||g[C].charAt(1)!=="=")return!1;return!0},r.exports=a})(bne);var cg=DC,Cne=o({__proto__:null,default:cg},[DC]);function OC(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const a=r.RTCIceCandidate;r.RTCIceCandidate=function(d){if(typeof d=="object"&&d.candidate&&d.candidate.indexOf("a=")===0&&((d=JSON.parse(JSON.stringify(d))).candidate=d.candidate.substring(2)),d.candidate&&d.candidate.length){const g=new a(d),C=cg.parseCandidate(d.candidate);for(const A in C)A in g||Object.defineProperty(g,A,{value:C[A]});return g.toJSON=function(){return{candidate:g.candidate,sdpMid:g.sdpMid,sdpMLineIndex:g.sdpMLineIndex,usernameFragment:g.usernameFragment}},g}return new a(d)},r.RTCIceCandidate.prototype=a.prototype,xh(r,"icecandidate",d=>(d.candidate&&Object.defineProperty(d,"candidate",{value:new r.RTCIceCandidate(d.candidate),writable:"false"}),d))}function fA(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||xh(r,"icecandidate",a=>{if(a.candidate){const d=cg.parseCandidate(a.candidate.candidate);d.type==="relay"&&(a.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[d.priority>>24])}return a})}function NC(r,a){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const d=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,a.browser==="chrome"&&a.version>=76){const{sdpSemantics:g}=this.getConfiguration();g==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(g){if(!g||!g.sdp)return!1;const C=cg.splitSections(g.sdp);return C.shift(),C.some(A=>{const w=cg.parseMLine(A);return w&&w.kind==="application"&&w.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const g=function(U){const j=U.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(j===null||j.length<2)return-1;const re=parseInt(j[1],10);return re!=re?-1:re}(arguments[0]),C=function(U){let j=65536;return a.browser==="firefox"&&(j=a.version<57?U===-1?16384:2147483637:a.version<60?a.version===57?65535:65536:2147483637),j}(g),A=function(U,j){let re=65536;a.browser==="firefox"&&a.version===57&&(re=65535);const ce=cg.matchPrefix(U.sdp,"a=max-message-size:");return ce.length>0?re=parseInt(ce[0].substring(19),10):a.browser==="firefox"&&j!==-1&&(re=2147483637),re}(arguments[0],g);let w;w=C===0&&A===0?Number.POSITIVE_INFINITY:C===0||A===0?Math.max(C,A):Math.min(C,A);const V={};Object.defineProperty(V,"maxMessageSize",{get:()=>w}),this._sctp=V}return d.apply(this,arguments)}}function LC(r){if(!r.RTCPeerConnection||!("createDataChannel"in r.RTCPeerConnection.prototype))return;function a(g,C){const A=g.send;g.send=function(){const w=arguments[0],V=w.length||w.size||w.byteLength;if(g.readyState==="open"&&C.sctp&&V>C.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+C.sctp.maxMessageSize+" bytes)");return A.apply(g,arguments)}}const d=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const g=d.apply(this,arguments);return a(g,this),g},xh(r,"datachannel",g=>(a(g.channel,g.target),g))}function pA(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const a=r.RTCPeerConnection.prototype;Object.defineProperty(a,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(a,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(d){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),d&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=d)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(d=>{const g=a[d];a[d]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=C=>{const A=C.target;if(A._lastConnectionState!==A.connectionState){A._lastConnectionState=A.connectionState;const w=new Event("connectionstatechange",C);A.dispatchEvent(w)}return C},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),g.apply(this,arguments)}})}function gA(r,a){if(!r.RTCPeerConnection||a.browser==="chrome"&&a.version>=71||a.browser==="safari"&&a.version>=605)return;const d=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(g){if(g&&g.sdp&&g.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const C=g.sdp.split(`
`).filter(A=>A.trim()!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&g instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:g.type,sdp:C}):g.sdp=C}return d.apply(this,arguments)}}function PC(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const d=r.RTCPeerConnection.prototype.addIceCandidate;d&&d.length!==0&&(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(a.browser==="chrome"&&a.version<78||a.browser==="firefox"&&a.version<68||a.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function UC(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const d=r.RTCPeerConnection.prototype.setLocalDescription;d&&d.length!==0&&(r.RTCPeerConnection.prototype.setLocalDescription=function(){let g=arguments[0]||{};if(typeof g!="object"||g.type&&g.sdp)return d.apply(this,arguments);if(g={type:g.type,sdp:g.sdp},!g.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":g.type="offer";break;default:g.type="answer"}return g.sdp||g.type!=="offer"&&g.type!=="answer"?d.apply(this,[g]):(g.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(C=>d.apply(this,[C]))})}var Sne=Object.freeze({__proto__:null,shimRTCIceCandidate:OC,shimRTCIceCandidateRelayProtocol:fA,shimMaxMessageSize:NC,shimSendThrowTypeError:LC,shimConnectionState:pA,removeExtmapAllowMixed:gA,shimAddIceCandidateNullOrEmpty:PC,shimParameterlessSetLocalDescription:UC});(function({window:r}={},a={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const d=F3,g=function(A){const w={browser:null,version:null};if(A===void 0||!A.navigator||!A.navigator.userAgent)return w.browser="Not a browser.",w;const{navigator:V}=A;if(V.mozGetUserMedia)w.browser="firefox",w.version=wC(V.userAgent,/Firefox\/(\d+)\./,1);else if(V.webkitGetUserMedia||A.isSecureContext===!1&&A.webkitRTCPeerConnection)w.browser="chrome",w.version=wC(V.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!A.RTCPeerConnection||!V.userAgent.match(/AppleWebKit\/(\d+)\./))return w.browser="Not a supported browser.",w;w.browser="safari",w.version=wC(V.userAgent,/AppleWebKit\/(\d+)\./,1),w.supportsUnifiedPlan=A.RTCRtpTransceiver&&"currentDirection"in A.RTCRtpTransceiver.prototype}return w}(r),C={browserDetails:g,commonShim:Sne,extractVersion:wC,disableLog:yne,disableWarnings:Ine,sdp:Cne};switch(g.browser){case"chrome":if(!Q3||!dA||!a.shimChrome)return d("Chrome shim is not included in this adapter release."),C;if(g.version===null)return d("Chrome shim can not determine version, not shimming."),C;d("adapter.js shimming chrome."),C.browserShim=Q3,PC(r,g),UC(r),H3(r,g),q3(r),dA(r,g),K3(r),J3(r,g),z3(r),W3(r),j3(r),X3(r,g),OC(r),fA(r),pA(r),NC(r,g),LC(r),gA(r,g);break;case"firefox":if(!cF||!hA||!a.shimFirefox)return d("Firefox shim is not included in this adapter release."),C;d("adapter.js shimming firefox."),C.browserShim=cF,PC(r,g),UC(r),Z3(r,g),hA(r,g),eF(r),oF(r),tF(r),nF(r),rF(r),iF(r),sF(r),aF(r),lF(r),OC(r),pA(r),NC(r,g),LC(r);break;case"safari":if(!yF||!a.shimSafari)return d("Safari shim is not included in this adapter release."),C;d("adapter.js shimming safari."),C.browserShim=yF,PC(r,g),UC(r),gF(r),vF(r),hF(r),uF(r),dF(r),mF(r),fF(r),_F(r),OC(r),fA(r),NC(r,g),LC(r),gA(r,g);break;default:d("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Dn,Tne=Object.create,D_=Object.defineProperty,Ene=Object.defineProperties,IF=Object.getOwnPropertyDescriptor,Mne=Object.getOwnPropertyDescriptors,kne=Object.getOwnPropertyNames,xC=Object.getOwnPropertySymbols,bF=Object.getPrototypeOf,mA=Object.prototype.hasOwnProperty,CF=Object.prototype.propertyIsEnumerable,Ane=Reflect.get,vA=Math.pow,_A=(r,a,d)=>a in r?D_(r,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[a]=d,Pn=(r,a)=>{for(var d in a||(a={}))mA.call(a,d)&&_A(r,d,a[d]);if(xC)for(var d of xC(a))CF.call(a,d)&&_A(r,d,a[d]);return r},uo=(r,a)=>Ene(r,Mne(a)),Zl=(r,a)=>()=>(a||r((a={exports:{}}).exports,a),a.exports),O_=(r,a)=>{for(var d in a)D_(r,d,{get:a[d],enumerable:!0})},vi=(r,a,d)=>(d=r!=null?Tne(bF(r)):{},((g,C,A,w)=>{if(C&&typeof C=="object"||typeof C=="function")for(let V of kne(C))!mA.call(g,V)&&V!==A&&D_(g,V,{get:()=>C[V],enumerable:!(w=IF(C,V))||w.enumerable});return g})(!a&&r&&r.__esModule?d:D_(d,"default",{value:r,enumerable:!0}),r)),mn=(r,a,d,g)=>{for(var C,A=IF(a,d),w=r.length-1;w>=0;w--)(C=r[w])&&(A=C(a,d,A)||A);return A&&D_(a,d,A),A},_e=(r,a,d)=>(_A(r,typeof a!="symbol"?a+"":a,d),d),Ia=(r,a,d)=>Ane(bF(r),d,a),Ze=(r,a,d)=>new Promise((g,C)=>{var A=U=>{try{V(d.next(U))}catch(j){C(j)}},w=U=>{try{V(d.throw(U))}catch(j){C(j)}},V=U=>U.done?g(U.value):Promise.resolve(U.value).then(A,w);V((d=d.apply(r,a)).next())}),gs=Zl((r,a)=>{var d=Object.prototype.hasOwnProperty,g="~";function C(){}function A(j,re,ce){this.fn=j,this.context=re,this.once=ce||!1}function w(j,re,ce,Te,De){if(typeof ce!="function")throw new TypeError("The listener must be a function");var ze=new A(ce,Te||j,De),_t=g?g+re:re;return j._events[_t]?j._events[_t].fn?j._events[_t]=[j._events[_t],ze]:j._events[_t].push(ze):(j._events[_t]=ze,j._eventsCount++),j}function V(j,re){--j._eventsCount==0?j._events=new C:delete j._events[re]}function U(){this._events=new C,this._eventsCount=0}Object.create&&(C.prototype=Object.create(null),new C().__proto__||(g=!1)),U.prototype.eventNames=function(){var j,re,ce=[];if(this._eventsCount===0)return ce;for(re in j=this._events)d.call(j,re)&&ce.push(g?re.slice(1):re);return Object.getOwnPropertySymbols?ce.concat(Object.getOwnPropertySymbols(j)):ce},U.prototype.listeners=function(j){var re=g?g+j:j,ce=this._events[re];if(!ce)return[];if(ce.fn)return[ce.fn];for(var Te=0,De=ce.length,ze=new Array(De);Te<De;Te++)ze[Te]=ce[Te].fn;return ze},U.prototype.listenerCount=function(j){var re=g?g+j:j,ce=this._events[re];return ce?ce.fn?1:ce.length:0},U.prototype.emit=function(j,re,ce,Te,De,ze){var _t=g?g+j:j;if(!this._events[_t])return!1;var Ft,$t,bt=this._events[_t],yn=arguments.length;if(bt.fn){switch(bt.once&&this.removeListener(j,bt.fn,void 0,!0),yn){case 1:return bt.fn.call(bt.context),!0;case 2:return bt.fn.call(bt.context,re),!0;case 3:return bt.fn.call(bt.context,re,ce),!0;case 4:return bt.fn.call(bt.context,re,ce,Te),!0;case 5:return bt.fn.call(bt.context,re,ce,Te,De),!0;case 6:return bt.fn.call(bt.context,re,ce,Te,De,ze),!0}for($t=1,Ft=new Array(yn-1);$t<yn;$t++)Ft[$t-1]=arguments[$t];bt.fn.apply(bt.context,Ft)}else{var Rn,Gn=bt.length;for($t=0;$t<Gn;$t++)switch(bt[$t].once&&this.removeListener(j,bt[$t].fn,void 0,!0),yn){case 1:bt[$t].fn.call(bt[$t].context);break;case 2:bt[$t].fn.call(bt[$t].context,re);break;case 3:bt[$t].fn.call(bt[$t].context,re,ce);break;case 4:bt[$t].fn.call(bt[$t].context,re,ce,Te);break;default:if(!Ft)for(Rn=1,Ft=new Array(yn-1);Rn<yn;Rn++)Ft[Rn-1]=arguments[Rn];bt[$t].fn.apply(bt[$t].context,Ft)}}return!0},U.prototype.on=function(j,re,ce){return w(this,j,re,ce,!1)},U.prototype.once=function(j,re,ce){return w(this,j,re,ce,!0)},U.prototype.removeListener=function(j,re,ce,Te){var De=g?g+j:j;if(!this._events[De])return this;if(!re)return V(this,De),this;var ze=this._events[De];if(ze.fn)ze.fn===re&&(!Te||ze.once)&&(!ce||ze.context===ce)&&V(this,De);else{for(var _t=0,Ft=[],$t=ze.length;_t<$t;_t++)(ze[_t].fn!==re||Te&&!ze[_t].once||ce&&ze[_t].context!==ce)&&Ft.push(ze[_t]);Ft.length?this._events[De]=Ft.length===1?Ft[0]:Ft:V(this,De)}return this},U.prototype.removeAllListeners=function(j){var re;return j?(re=g?g+j:j,this._events[re]&&V(this,re)):(this._events=new C,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=g,U.EventEmitter=U,a!==void 0&&(a.exports=U)}),SF=Zl((r,a)=>{var d=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(g){return g.encoding?"rtpmap:%d %s/%s/%s":g.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(g){return g.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(g){return g.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(g){return"extmap:%d"+(g.direction?"/%s":"%v")+(g["encrypt-uri"]?" %s":"%v")+" %s"+(g.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(g){return g.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(g){var C="candidate:%s %d %s %d %s %d typ %s";return C+=g.raddr!=null?" raddr %s rport %d":"%v%v",C+=g.tcptype!=null?" tcptype %s":"%v",g.generation!=null&&(C+=" generation %d"),C+=g["network-id"]!=null?" network-id %d":"%v",C+=g["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(g){var C="ssrc:%d";return g.attribute!=null&&(C+=" %s",g.value!=null&&(C+=":%s")),C}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(g){return g.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(g){return g.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(g){return"imageattr:%s %s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(g){return"simulcast:%s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(g){return"ts-refclk:%s"+(g.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(g){var C="mediaclk:";return C+=g.id!=null?"id=%s %s":"%v%s",C+=g.mediaClockValue!=null?"=%s":"",C+=g.rateNumerator!=null?" rate=%s":"",C+=g.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(g){d[g].forEach(function(C){C.reg||(C.reg=/(.*)/),C.format||(C.format="%s")})})}),Rne=Zl(r=>{var a=function(w){return String(Number(w))===w?Number(w):w},d=function(w,V,U){var j=w.name&&w.names;w.push&&!V[w.push]?V[w.push]=[]:j&&!V[w.name]&&(V[w.name]={});var re=w.push?{}:j?V[w.name]:V;(function(ce,Te,De,ze){if(ze&&!De)Te[ze]=a(ce[1]);else for(var _t=0;_t<De.length;_t+=1)ce[_t+1]!=null&&(Te[De[_t]]=a(ce[_t+1]))})(U.match(w.reg),re,w.names,w.name),w.push&&V[w.push].push(re)},g=SF(),C=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(w){var V={},U=[],j=V;return w.split(/(\r\n|\r|\n)/).filter(C).forEach(function(re){var ce=re[0],Te=re.slice(2);ce==="m"&&(U.push({rtp:[],fmtp:[]}),j=U[U.length-1]);for(var De=0;De<(g[ce]||[]).length;De+=1){var ze=g[ce][De];if(ze.reg.test(Te))return d(ze,j,Te)}}),V.media=U,V};var A=function(w,V){var U=V.split(/=(.+)/,2);return U.length===2?w[U[0]]=a(U[1]):U.length===1&&V.length>1&&(w[U[0]]=void 0),w};r.parseParams=function(w){return w.split(/;\s?/).reduce(A,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(w){return w.toString().split(" ").map(Number)},r.parseRemoteCandidates=function(w){for(var V=[],U=w.split(" ").map(a),j=0;j<U.length;j+=3)V.push({component:U[j],ip:U[j+1],port:U[j+2]});return V},r.parseImageAttributes=function(w){return w.split(" ").map(function(V){return V.substring(1,V.length-1).split(",").reduce(A,{})})},r.parseSimulcastStreamList=function(w){return w.split(";").map(function(V){return V.split(",").map(function(U){var j,re=!1;return U[0]!=="~"?j=a(U):(j=a(U.substring(1,U.length)),re=!0),{scid:j,paused:re}})})}}),wne=Zl((r,a)=>{var d=SF(),g=/%[sdv%]/g,C=function(U){var j=1,re=arguments,ce=re.length;return U.replace(g,function(Te){if(j>=ce)return Te;var De=re[j];switch(j+=1,Te){case"%%":return"%";case"%s":return String(De);case"%d":return Number(De);case"%v":return""}})},A=function(U,j,re){var ce=[U+"="+(j.format instanceof Function?j.format(j.push?re:re[j.name]):j.format)];if(j.names)for(var Te=0;Te<j.names.length;Te+=1){var De=j.names[Te];j.name?ce.push(re[j.name][De]):ce.push(re[j.names[Te]])}else ce.push(re[j.name]);return C.apply(null,ce)},w=["v","o","s","i","u","e","p","c","b","t","r","z","a"],V=["i","c","b","a"];a.exports=function(U,j){j=j||{},U.version==null&&(U.version=0),U.name==null&&(U.name=" "),U.media.forEach(function(De){De.payloads==null&&(De.payloads="")});var re=j.outerOrder||w,ce=j.innerOrder||V,Te=[];return re.forEach(function(De){d[De].forEach(function(ze){ze.name in U&&U[ze.name]!=null?Te.push(A(De,ze,U)):ze.push in U&&U[ze.push]!=null&&U[ze.push].forEach(function(_t){Te.push(A(De,ze,_t))})})}),U.media.forEach(function(De){Te.push(A("m",d.m[0],De)),ce.forEach(function(ze){d[ze].forEach(function(_t){_t.name in De&&De[_t.name]!=null?Te.push(A(ze,_t,De)):_t.push in De&&De[_t.push]!=null&&De[_t.push].forEach(function(Ft){Te.push(A(ze,_t,Ft))})})})}),Te.join(`\r
`)+`\r
`}}),Dne=Zl(r=>{var a=Rne(),d=wne();r.write=d,r.parse=a.parse,r.parseParams=a.parseParams,r.parseFmtpConfig=a.parseFmtpConfig,r.parsePayloads=a.parsePayloads,r.parseRemoteCandidates=a.parseRemoteCandidates,r.parseImageAttributes=a.parseImageAttributes,r.parseSimulcastStreamList=a.parseSimulcastStreamList}),TF=Zl((r,a)=>{var d=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(g){return g.encoding?"rtpmap:%d %s/%s/%s":g.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(g){return g.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(g){return g.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(g){return"extmap:%d"+(g.direction?"/%s":"%v")+(g["encrypt-uri"]?" %s":"%v")+" %s"+(g.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(g){return g.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(g){var C="candidate:%s %d %s %d %s %d typ %s";return C+=g.raddr!=null?" raddr %s rport %d":"%v%v",C+=g.tcptype!=null?" tcptype %s":"%v",g.generation!=null&&(C+=" generation %d"),C+=g["network-id"]!=null?" network-id %d":"%v",C+=g["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(g){var C="ssrc:%d";return g.attribute!=null&&(C+=" %s",g.value!=null&&(C+=":%s")),C}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(g){return g.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(g){return g.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(g){return"imageattr:%s %s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(g){return"simulcast:%s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(g){return"ts-refclk:%s"+(g.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(g){var C="mediaclk:";return C+=g.id!=null?"id=%s %s":"%v%s",C+=g.mediaClockValue!=null?"=%s":"",C+=g.rateNumerator!=null?" rate=%s":"",C+=g.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(g){d[g].forEach(function(C){C.reg||(C.reg=/(.*)/),C.format||(C.format="%s")})})}),One=Zl(r=>{var a=function(w){return String(Number(w))===w?Number(w):w},d=function(w,V,U){var j=w.name&&w.names;w.push&&!V[w.push]?V[w.push]=[]:j&&!V[w.name]&&(V[w.name]={});var re=w.push?{}:j?V[w.name]:V;(function(ce,Te,De,ze){if(ze&&!De)Te[ze]=a(ce[1]);else for(var _t=0;_t<De.length;_t+=1)ce[_t+1]!=null&&(Te[De[_t]]=a(ce[_t+1]))})(U.match(w.reg),re,w.names,w.name),w.push&&V[w.push].push(re)},g=TF(),C=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(w){var V={},U=[],j=V;return w.split(/(\r\n|\r|\n)/).filter(C).forEach(function(re){var ce=re[0],Te=re.slice(2);ce==="m"&&(U.push({rtp:[],fmtp:[]}),j=U[U.length-1]);for(var De=0;De<(g[ce]||[]).length;De+=1){var ze=g[ce][De];if(ze.reg.test(Te))return d(ze,j,Te)}}),V.media=U,V};var A=function(w,V){var U=V.split(/=(.+)/,2);return U.length===2?w[U[0]]=a(U[1]):U.length===1&&V.length>1&&(w[U[0]]=void 0),w};r.parseParams=function(w){return w.split(/;\s?/).reduce(A,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(w){return w.toString().split(" ").map(Number)},r.parseRemoteCandidates=function(w){for(var V=[],U=w.split(" ").map(a),j=0;j<U.length;j+=3)V.push({component:U[j],ip:U[j+1],port:U[j+2]});return V},r.parseImageAttributes=function(w){return w.split(" ").map(function(V){return V.substring(1,V.length-1).split(",").reduce(A,{})})},r.parseSimulcastStreamList=function(w){return w.split(";").map(function(V){return V.split(",").map(function(U){var j,re=!1;return U[0]!=="~"?j=a(U):(j=a(U.substring(1,U.length)),re=!0),{scid:j,paused:re}})})}}),Nne=Zl((r,a)=>{var d=TF(),g=/%[sdv%]/g,C=function(U){var j=1,re=arguments,ce=re.length;return U.replace(g,function(Te){if(j>=ce)return Te;var De=re[j];switch(j+=1,Te){case"%%":return"%";case"%s":return String(De);case"%d":return Number(De);case"%v":return""}})},A=function(U,j,re){var ce=[U+"="+(j.format instanceof Function?j.format(j.push?re:re[j.name]):j.format)];if(j.names)for(var Te=0;Te<j.names.length;Te+=1){var De=j.names[Te];j.name?ce.push(re[j.name][De]):ce.push(re[j.names[Te]])}else ce.push(re[j.name]);return C.apply(null,ce)},w=["v","o","s","i","u","e","p","c","b","t","r","z","a"],V=["i","c","b","a"];a.exports=function(U,j){j=j||{},U.version==null&&(U.version=0),U.name==null&&(U.name=" "),U.media.forEach(function(De){De.payloads==null&&(De.payloads="")});var re=j.outerOrder||w,ce=j.innerOrder||V,Te=[];return re.forEach(function(De){d[De].forEach(function(ze){ze.name in U&&U[ze.name]!=null?Te.push(A(De,ze,U)):ze.push in U&&U[ze.push]!=null&&U[ze.push].forEach(function(_t){Te.push(A(De,ze,_t))})})}),U.media.forEach(function(De){Te.push(A("m",d.m[0],De)),ce.forEach(function(ze){d[ze].forEach(function(_t){_t.name in De&&De[_t.name]!=null?Te.push(A(ze,_t,De)):_t.push in De&&De[_t.push]!=null&&De[_t.push].forEach(function(Ft){Te.push(A(ze,_t,Ft))})})})}),Te.join(`\r
`)+`\r
`}}),EF=Zl(r=>{var a=One(),d=Nne();r.write=d,r.parse=a.parse,r.parseParams=a.parseParams,r.parseFmtpConfig=a.parseFmtpConfig,r.parsePayloads=a.parsePayloads,r.parseRemoteCandidates=a.parseRemoteCandidates,r.parseImageAttributes=a.parseImageAttributes,r.parseSimulcastStreamList=a.parseSimulcastStreamList}),Lne=vi(gs()),MF=((Dn=MF||{})[Dn.INVALID_PARAMETER=4096]="INVALID_PARAMETER",Dn[Dn.INVALID_OPERATION=4097]="INVALID_OPERATION",Dn[Dn.NOT_SUPPORTED=4098]="NOT_SUPPORTED",Dn[Dn.DEVICE_NOT_FOUND=4099]="DEVICE_NOT_FOUND",Dn[Dn.INITIALIZE_FAILED=4100]="INITIALIZE_FAILED",Dn[Dn.SIGNAL_CHANNEL_SETUP_FAILED=16385]="SIGNAL_CHANNEL_SETUP_FAILED",Dn[Dn.SIGNAL_CHANNEL_ERROR=16386]="SIGNAL_CHANNEL_ERROR",Dn[Dn.ICE_TRANSPORT_ERROR=16387]="ICE_TRANSPORT_ERROR",Dn[Dn.JOIN_ROOM_FAILED=16388]="JOIN_ROOM_FAILED",Dn[Dn.CREATE_OFFER_FAILED=16389]="CREATE_OFFER_FAILED",Dn[Dn.SIGNAL_CHANNEL_RECONNECTION_FAILED=16390]="SIGNAL_CHANNEL_RECONNECTION_FAILED",Dn[Dn.UPLINK_RECONNECTION_FAILED=16391]="UPLINK_RECONNECTION_FAILED",Dn[Dn.DOWNLINK_RECONNECTION_FAILED=16392]="DOWNLINK_RECONNECTION_FAILED",Dn[Dn.REMOTE_STREAM_NOT_EXIST=16400]="REMOTE_STREAM_NOT_EXIST",Dn[Dn.CLIENT_BANNED=16448]="CLIENT_BANNED",Dn[Dn.SERVER_TIMEOUT=16449]="SERVER_TIMEOUT",Dn[Dn.SUBSCRIPTION_TIMEOUT=16450]="SUBSCRIPTION_TIMEOUT",Dn[Dn.PLAY_NOT_ALLOWED=16451]="PLAY_NOT_ALLOWED",Dn[Dn.DEVICE_AUTO_RECOVER_FAILED=16452]="DEVICE_AUTO_RECOVER_FAILED",Dn[Dn.START_PUBLISH_CDN_FAILED=16453]="START_PUBLISH_CDN_FAILED",Dn[Dn.STOP_PUBLISH_CDN_FAILED=16454]="STOP_PUBLISH_CDN_FAILED",Dn[Dn.START_MIX_TRANSCODE_FAILED=16455]="START_MIX_TRANSCODE_FAILED",Dn[Dn.STOP_MIX_TRANSCODE_FAILED=16456]="STOP_MIX_TRANSCODE_FAILED",Dn[Dn.NOT_SUPPORTED_H264=16457]="NOT_SUPPORTED_H264",Dn[Dn.SWITCH_ROLE_FAILED=16458]="SWITCH_ROLE_FAILED",Dn[Dn.API_CALL_TIMEOUT=16459]="API_CALL_TIMEOUT",Dn[Dn.SCHEDULE_FAILED=16460]="SCHEDULE_FAILED",Dn[Dn.API_CALL_ABORTED=16461]="API_CALL_ABORTED",Dn[Dn.SPC_INITIALIZED_FAILED=16462]="SPC_INITIALIZED_FAILED",Dn[Dn.UNKNOWN=65535]="UNKNOWN",Dn),rn=MF,Pne=class extends Error{constructor(r){let{name:a="RtcError",message:d,code:g=rn.UNKNOWN,extraCode:C=0,constraint:A}=r,w="<".concat(function(U){for(let j in rn)if(rn[j]===U)return j;return"UNKNOWN"}(g)," 0x").concat(g.toString(16),">"),V="".concat(d).concat(A?" constraint: ".concat(A):"").concat(d!=null&&d.includes(w)?"":" ".concat(w));super(V),_e(this,"code"),_e(this,"extraCode"),_e(this,"message"),_e(this,"originMessage"),_e(this,"name"),_e(this,"constraint"),this.code=g,this.extraCode=C,this.name=a,this.message=V,this.constraint=A,this.originMessage=d}getCode(){return this.code}getExtraCode(){return this.extraCode}toString(){return this.originMessage}},An=Pne,yA=(new Date().getTime(),0),IA=function(){return new Date().getTime()+yA},kF=function(){let r=new Date;return r.setTime(IA()),r.toLocaleString()},tl={};O_(tl,{bytes2ms:()=>_oe,convertObjectNumberToInt:()=>fR,copyProperties:()=>voe,deepClone:()=>sy,deepMerge:()=>Kh,fibonacci:()=>ry,formatedTime:()=>Aoe,getAbilityConfigUrl:()=>poe,getConstructorName:()=>b4,getContainerFromElement:()=>Moe,getEnv:()=>moe,getInternalVersion:()=>Soe,getLoggerUrl:()=>ny,getMuteStateFromFlag:()=>iy,getNetworkType:()=>m4,getNumNetworkType:()=>rS,getReconnectionTimeout:()=>vg,getStringByteLength:()=>hR,getTurnServer:()=>Eoe,getUint32Version:()=>M4,getValueType:()=>Ji,getViewListFromView:()=>sS,glog:()=>Ioe,ipv4ToUint32:()=>iS,isArray:()=>_i,isAudioWorkletSupported:()=>Coe,isBoolean:()=>vs,isConstructor:()=>uR,isEmpty:()=>S4,isFunction:()=>lr,isLangChinese:()=>Tu,isMediaStreamTrack:()=>boe,isNumber:()=>si,isObject:()=>Eu,isOverseaSdkAppId:()=>oS,isPlainObject:()=>oc,isPortrait:()=>E4,isPromise:()=>cR,isRemoteTrack:()=>_g,isString:()=>Ho,isUndefined:()=>Pt,loadImage:()=>aS,ms2bytes:()=>yoe,ms2samples:()=>I4,performanceNow:()=>To,promiseAny:()=>dR,samples2ms:()=>y4,setNetworkType:()=>_4,stringify:()=>rc,stringifyIncludeValue:()=>T4});var AF={};O_(AF,{AUDIO_MUTE_BIT:()=>DA,AUDIO_STAT_BIT:()=>x_,AUX_STAT_BIT:()=>VC,AUX_STREAM_MSID:()=>FF,BACKEND_ENV:()=>RA,BASE_DOC_URL:()=>Fh,BASE_HOST:()=>EA,CAPABILITIES_KEYS:()=>UA,CLASS_NAME:()=>eoe,CLOUD_CONSOLE_URL:()=>xne,DATA_FREEZE_TIMING:()=>NA,DOC_URL:()=>Fne,DTLS_STATE_UNKNOWN:()=>yu,ENV_NAME:()=>Vh,EXCHANGE_SDP_TIMEOUT:()=>qF,INTERVAL:()=>qC,IS_WORKER:()=>FC,IS_WORKLET:()=>SA,KIBANA_EVENT:()=>ec,LOCAL_STREAM_PUBLISH_STATE:()=>KF,LOGGER_CMD_TYPE:()=>P_,LOGGER_DOMAIN:()=>OF,LOGGER_DOMAIN_OVERSEA:()=>NF,LOG_LEVEL:()=>_u,LOG_LEVEL_NAME:()=>noe,MAIN_STREAM_MSID:()=>GC,MICROPHONE_COMMUNICATIONS:()=>toe,MICROPHONE_DEFAULT:()=>V_,NAME:()=>Pe,NETWORK_TYPE:()=>MA,NOT_SUPPORTED_H264:()=>$C,PAUSED_RETRY_COUNT:()=>zF,PEERCONNECTION_CONNECTING_TIMEOUT:()=>LA,PEER_CONNECTION_STATE:()=>Or,PEER_LEAVE_REASON:()=>WF,RAF:()=>PA,RECOVER_CAPTURE_INTERVAL:()=>B_,REMOTE_STREAM_TYPE_AUX:()=>GF,REMOTE_STREAM_TYPE_MAIN:()=>VF,RENDER_FREEZE_TIMING:()=>Jne,RIC:()=>dg,SCHEDULE_DOMAIN:()=>rl,SCHEDULE_TIMEOUT:()=>Zne,SDP_SEMANTICS_PLAN_B:()=>BC,SDP_SEMANTICS_UNIFIED_PLAN:()=>F_,SECOND_HOST:()=>wF,SIGNAL_PING_PONG_INTERVAL:()=>Gne,SIGNAL_PING_TIMEOUT:()=>Vne,SIGNAL_RECONNECTION_COUNT:()=>jne,SMALL_STAT_BIT:()=>wA,SPEAKER_DEFAULT:()=>HC,STORAGE_EXPIRES_TIME:()=>PF,STREAM_TYPE_BIG:()=>Xne,STREAM_TYPE_SMALL:()=>Qne,SUBSCRIBE_SMALL_RETRY_COUNT:()=>G_,SYNC_USER_LIST_INTERVAL:()=>Yne,Scene:()=>xF,Switch:()=>UF,THIRD_HOST:()=>DF,TIMEOUT:()=>$_,TRANSPORT_DIRECTION:()=>ho,TRTC_ERROR_ASSISTANCE:()=>LF,TRTC_QUALITY_BAD:()=>Kne,TRTC_QUALITY_DISCONNECTED:()=>Wne,TRTC_QUALITY_EXCELLENT:()=>$ne,TRTC_QUALITY_GOOD:()=>Hne,TRTC_QUALITY_POOR:()=>qne,TRTC_QUALITY_UNKNOWN:()=>Bne,TRTC_QUALITY_VERY_BAD:()=>zne,UPDATE_OFFER_TIMEOUT:()=>HF,VIDEO_MUTE_BIT:()=>OA,VIDEO_STAT_BIT:()=>U_,audioProfileMap:()=>kA,getRetryCount:()=>ug,getScriptDir:()=>Une,innerVersion:()=>bA,loggerProxy:()=>TA,screenProfileMap:()=>AA,setLoggerProxy:()=>L_,setRetryCount:()=>$F,setVersion:()=>RF,version:()=>nl,videoProfileMap:()=>ol});var bA="4.15.00.1600",nl="5.0.0";function RF(r){nl=r;let[a,d,g]=r.split(".").map(C=>parseInt(C,10));bA="".concat(a,".").concat(Math.min(15,d),".").concat(Math.min(15,g),".").concat(d.toString().padStart(2,"0")).concat(g.toString().padStart(2,"0"))}var CA,N_,ms,FC=typeof importScripts<"u",SA=typeof registerProcessor<"u",Une=()=>{let r=FC?self.location.href:document.currentScript.src;return r.substring(0,r.lastIndexOf("/")+1)},TA="",L_=r=>TA=r,EA="web.sdk.qcloud.com",wF="web.sdk.tencent.cn",DF="web.sdk.cloud.tencent.cn",xne="https://console.cloud.tencent.com/trtc",Fh="https://".concat(EA,"/trtc/webrtc/v5/doc"),Fne="".concat(Fh,"/zh-cn/"),OF="https://yun.tim.qq.com",NF="https://apisgp.my-imcloud.com",LF="trtc_error_assistance",P_={LOG:"jssdk_log",EVENT:"jssdk_event",KEY_POINT:"jssdk_new_endreport",KV_STAT:"jssdk_key_metrics_report"},Vh={QCLOUD:"qcloud",OLD_CLOUD_LADDER:"trtc",WEBRTC:"webrtc"},_u=((ms=_u||{})[ms.TRACE=0]="TRACE",ms[ms.DEBUG=1]="DEBUG",ms[ms.INFO=2]="INFO",ms[ms.WARN=3]="WARN",ms[ms.ERROR=4]="ERROR",ms[ms.NONE=5]="NONE",ms),Vne=18e3,Gne=2e3,MA={unknown:0,wifi:1,"3g":2,"2g":3,"4g":4,wired:5,"5g":6},PF=6048e5,UF=((N_=UF||{}).USEAINS="useAINS",N_.ENABLEDEBUG="enableDebug",N_.USEV2="useV2",N_.USEWT="useWt",N_),kA={standard:{sampleRate:48e3,channelCount:1,bitrate:40},"standard-stereo":{sampleRate:48e3,channelCount:2,bitrate:64},high:{sampleRate:48e3,channelCount:1,bitrate:128},"high-stereo":{sampleRate:48e3,channelCount:2,bitrate:192}},ol={"120p":{width:160,height:120,frameRate:15,bitrate:200},"120p_2":{width:160,height:120,frameRate:15,bitrate:100},"180p":{width:320,height:180,frameRate:15,bitrate:350},"180p_2":{width:320,height:180,frameRate:15,bitrate:150},"240p":{width:320,height:240,frameRate:15,bitrate:400},"240p_2":{width:320,height:240,frameRate:15,bitrate:200},"360p":{width:640,height:360,frameRate:15,bitrate:800},"360p_2":{width:640,height:360,frameRate:15,bitrate:400},"480p":{width:640,height:480,frameRate:15,bitrate:900},"480p_2":{width:640,height:480,frameRate:15,bitrate:500},"720p":{width:1280,height:720,frameRate:15,bitrate:1500},"1080p":{width:1920,height:1080,frameRate:15,bitrate:2e3},"1440p":{width:2560,height:1440,frameRate:30,bitrate:4860},"4K":{width:3840,height:2160,frameRate:30,bitrate:9e3}},AA={"480p":{width:640,height:480,frameRate:5,bitrate:900},"480p_2":{width:640,height:480,frameRate:30,bitrate:1e3},"720p":{width:1280,height:720,frameRate:5,bitrate:1200},"720p_2":{width:1280,height:720,frameRate:30,bitrate:3e3},"1080p":{width:1920,height:1080,frameRate:5,bitrate:1600},"1080p_2":{width:1920,height:1080,frameRate:30,bitrate:4e3}},Pe={CANVAS:"canvas",AUDIO:"audio",VIDEO:"video",SCREEN:"screen",SMALL:"small",BIG:"big",AUXILIARY:"auxiliary",SMALL_VIDEO:"smallVideo",FACING_MODE_USER:"user",FACING_MODE_ENVIRONMENT:"environment",MUTE:"mute",UNMUTE:"unmute",ENDED:"ended",PLAYING:"playing",PAUSE:"pause",ERROR:"error",LOADEDDATA:"loadeddata",AUDIO_INPUT:"audioinput",VIDEO_INPUT:"videoinput",DETAIL:"detail",TEXT:"text",MAIN:"main",BACKUP:"backup",BANNED:"banned",KICK:"kick",USER_TIME_OUT:"user_time_out",ROOM_DISBAND:"room_disband",SEI_MESSAGE:"sei-message",ADD:"add",REMOVE:"remove",REPLACE:"replace",TRACK:"track",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",TRANSCEIVER_DIRECTION_SENDONLY:"sendonly",TRANSCEIVER_DIRECTION_RECVONLY:"recvonly",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture"},ho={INACTIVE:"inactive",SENDONLY:"sendonly",RECVONLY:"recvonly"},RA={OLD_CLOUD_LADDER:"wss://trtc.rtc.qq.com",WEBRTC:"wss://webrtc.qq.com"},xF=((CA=xF||{}).LIVE="live",CA.RTC="rtc",CA),U_=1,wA=2,VC=4,x_=8,DA=64,OA=16,GC="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",FF="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",VF=Pe.MAIN,GF=Pe.AUXILIARY,Bne=0,$ne=1,Hne=2,qne=3,Kne=4,zne=5,Wne=6,yu="unknown",Or={NEW:"new",CONNECTING:"connecting",FAILED:"failed",CLOSED:"closed",DISCONNECTED:"disconnected",CONNECTED:"connected",COMPLETED:"completed"},BF=1/0;function $F(r){BF=r}function ug(){return BF}var Gh,jne=30,ec={JOIN:"join",DELTA_JOIN:"delta-join",REJOIN:"rejoin",LEAVE:"leave",DELTA_LEAVE:"delta-leave",PUBLISH:"publish",DELTA_PUBLISH:"delta-publish",UNPUBLISH:"unpublish",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",UPLINK_CONNECTION:"uplink-connection",UPLINK_RECONNECTION:"uplink-reconnection",DOWNLINK_CONNECTION:"downlink-connection",DOWNLINK_RECONNECTION:"downlink-reconnection",ON_TRACK:"ontrack",ICE_CONNECTION_STATE:"iceConnectionState",LOCAL_STREAM_INITIALIZE:"stream-initialize",SIGNAL_CONNECTION:"websocketConnectionState",SIGNAL_RECONNECTION:"websocketReconnectionState",UPDATE_STREAM:"update-stream",RECOVER_LOCAL_AUDIO_TRACK:"recover-local-audio-track",RECOVER_LOCAL_VIDEO_TRACK:"recover-local-video-track",RECOVER_SUBSCRIPTION:"recover-subscription",START_MIX_TRANSCODE:"start-mix-transcode",STOP_MIX_TRANSCODE:"stop-mix-transcode",PLAYER_ERROR:"player-error",SCHEDULE:"schedule",LOAD_WORKLET:"load-worklet",VIDEO_FROZEN_COUNT:"videoFrozenCount",GET_USER_MEDIA_RETRY:"getUserMedia-retry"},Yne=1e4,HF=1e4,qF=1e4,F_="unified-plan",BC="plan-b",$C=1028,KF=((Gh=KF||{})[Gh.UNPUBLISH=-1]="UNPUBLISH",Gh[Gh.PUBLISHING=0]="PUBLISHING",Gh[Gh.PUBLISHED=1]="PUBLISHED",Gh),NA=500,Jne=1e3,Xne=Pe.BIG,Qne=Pe.SMALL,LA=1e4,rl={MAIN:"schedule.cloud-rtc.com",BACKUP:"schedule.rtc.qcloud.com",MAIN_OVERSEA:"schedule.rtc-web.com",BACKUP_OVERSEA:"schedule.rtc-web.io",MAIN_OVERSEA_OLD:"schedule.rtc.tencentcloud.com",BACKUP_OVERSEA_OLD:"schedule-ecdn.rtc.tencentcloud.com"},Zne=2e3,eoe={TRTC:"TRTC",CLIENT:"Client",LOCAL_STREAM:"LocalStream",REMOTE_STREAM:"RemoteStream",STREAM:"Stream"},zF=5,V_="default",HC=V_,toe="communications",noe=Object.keys(_u),WF=["normal leave","timeout leave","kick","role change"],G_=10,B_=2e3,dg="ric",PA="raf",qC="interval",$_="timeout",UA=["width","height","frameRate","facingMode","sampleRate","sampleSize","channelCount","deviceId","min","max"];function H_(r){let{url:a,body:d,method:g,timeout:C}=r,A=new XMLHttpRequest;return new Promise((w,V)=>{A.onreadystatechange=()=>{if(A.readyState===4)if(A.status>=200&&A.status<300)try{let U=JSON.parse(A.response);w({data:U})}catch{w({data:A.response})}else V({status:A.status,statusText:A.statusText||"request failed!"})},A.timeout=C||5e3,A.open(g||"POST",a,!0),A.send(d)})}function jF(r){return Ze(this,null,function*(){let a=To(),d=JSON.stringify(r);try{if(!CompressionStream||d.length<=2800)return d;let g=new Blob([d],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),C=yield(yield(yield new Response(g)).blob()).arrayBuffer();return cn.debug("compressJSON ".concat(d.length," -> ").concat(C.byteLength," ").concat(To()-a,"ms")),C}catch{return d}})}var Iu=1e8,jn={AVOID_REPEATED_CALL:"AVOID_REPEATED_CALL",INVALID_PARAMETER_REQUIRED:"INVALID_PARAMETER_REQUIRED",INVALID_PARAMETER_TYPE:"INVALID_PARAMETER_TYPE",INVALID_PARAMETER_EMPTY:"INVALID_PARAMETER_EMPTY",INVALID_PARAMETER_INSTANCE:"INVALID_PARAMETER_INSTANCE",INVALID_PARAMETER_RANGE:"INVALID_PARAMETER_RANGE",INVALID_PARAMETER_MIN:"INVALID_PARAMETER_MIN",INVALID_PARAMETER_MAX:"INVALID_PARAMETER_MAX",INVALID_PARAMETER_STREAMTYPE:"INVALID_PARAMETER_STREAMTYPE",API_CALL_TIMEOUT:"API_CALL_TIMEOUT",SIGNAL_CHANNEL_RECONNECTION_FAILED:"SIGNAL_CHANNEL_RECONNECTION_FAILED",SIGNAL_CHANNEL_SETUP_FAILED:"SIGNAL_CHANNEL_SETUP_FAILED",ERROR_MESSAGE:"ERROR_MESSAGE",EXCHANGE_SDP_TIMEOUT:"EXCHANGE_SDP_TIMEOUT",DOWNLINK_RECONNECTION_FAILED:"DOWNLINK_RECONNECTION_FAILED",EXCHANGE_SDP_FAILED:"EXCHANGE_SDP_FAILED",UPDATE_OFFER_TIMEOUT:"UPDATE_OFFER_TIMEOUT",UPLINK_RECONNECTION_FAILED:"UPLINK_RECONNECTION_FAILED",INVALID_RECORDID:"INVALID_RECORDID",INVALID_PURE_AUDIO:"INVALID_PURE_AUDIO",INVALID_STREAMID:"INVALID_STREAMID",INVALID_USER_DEFINE_RECORDID:"INVALID_USER_DEFINE_RECORDID",INVALID_USER_DEFINE_PUSH_ARGS:"INVALID_USER_DEFINE_PUSH_ARGS",INVALID_PROXY:"INVALID_PROXY",INVALID_JOIN:"INVALID_JOIN",INVALID_ROOMID_STRING:"INVALID_ROOMID_STRING",INVALID_ROOMID_INTEGER:"INVALID_ROOMID_INTEGER",INVALID_SIGNAL_CHANNEL:"INVALID_SIGNAL_CHANNEL",JOIN_ROOM_TIMEOUT:"JOIN_ROOM_TIMEOUT",JOIN_ROOM_FAILED:"JOIN_ROOM_FAILED",REJOIN_ROOM_FAILED:"REJOIN_ROOM_FAILED",INVALID_DESTROY:"INVALID_DESTROY",INVALID_PUBLISH:"INVALID_PUBLISH",INVALID_UNPUBLISH:"INVALID_UNPUBLISH",INVALID_AUDIENCE:"INVALID_AUDIENCE",INVALID_INITIALIZE:"INVALID_INITIALIZE",INVALID_DUPLICATE_PUBLISHING:"INVALID_DUPLICATE_PUBLISHING",INVALID_SUBSCRIBE_UNDEFINED:"INVALID_SUBSCRIBE_UNDEFINED",INVALID_SUBSCRIBE_LOCAL:"INVALID_SUBSCRIBE_LOCAL",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",SUBSCRIBE_FAILED:"SUBSCRIBE_FAILED",INVALID_ROLE:"INVALID_ROLE",INVALID_PARAMETER_SWITCH_ROLE:"INVALID_PARAMETER_SWITCH_ROLE",INVALID_OPERATION_SWITCH_ROLE:"INVALID_OPERATION_SWITCH_ROLE",SWITCH_ROLE_TIMEOUT:"SWITCH_ROLE_TIMEOUT",SWITCH_ROLE_FAILED:"SWITCH_ROLE_FAILED",CLIENT_BANNED:"CLIENT_BANNED",INVALID_OPERATION_START_PUBLISH_CDN:"INVALID_OPERATION_START_PUBLISH_CDN",INVALID_OPERATION_STOP_PUBLISH_CDN:"INVALID_OPERATION_STOP_PUBLISH_CDN",INVALID_STREAM_ID:"INVALID_STREAM_ID",START_PUBLISH_CDN_FAILED:"START_PUBLISH_CDN_FAILED",STOP_PUBLISH_CDN_FAILED:"STOP_PUBLISH_CDN_FAILED",START_MIX_TRANSCODE:"START_MIX_TRANSCODE",STOP_MIX_TRANSCODE:"STOP_MIX_TRANSCODE",INVALID_AUDIO_VOLUME:"INVALID_AUDIO_VOLUME",ENABLE_SMALL_STREAM_PUBLISHED:"ENABLE_SMALL_STREAM_PUBLISHED",DISABLE_SMALL_STREAM_PUBLISHED:"DISABLE_SMALL_STREAM_PUBLISHED",NOT_SUPPORTED_SMALL_STREAM:"NOT_SUPPORTED_SMALL_STREAM",INVALID_SMALL_STREAM_PROFILE:"INVALID_SMALL_STREAM_PROFILE",INVALID_PARAMETER_REMOTE_STREAM:"INVALID_PARAMETER_REMOTE_STREAM",INVALID_OPERATION_CHANGE_SMALL:"INVALID_OPERATION_CHANGE_SMALL",REMOTE_NOT_PUBLISH_SMALL_STREAM:"REMOTE_NOT_PUBLISH_SMALL_STREAM",INVALID_SWITCH_DEVICE:"INVALID_SWITCH_DEVICE",INVALID_SWITCH_DEVICE_PUBLISHING:"INVALID_SWITCH_DEVICE_PUBLISHING",INVALID_REPLACE_TRACK:"INVALID_REPLACE_TRACK",INVALID_INITIALIZE_LOCAL_STREAM:"INVALID_INITIALIZE_LOCAL_STREAM",INVALID_ADD_TRACK_REPETITIVE:"INVALID_ADD_TRACK_REPETITIVE",INVALID_ADD_TRACK_REMOVING:"INVALID_ADD_TRACK_REMOVING",INVALID_ADD_TRACK_PUBLISHING:"INVALID_ADD_TRACK_PUBLISHING",INVALID_STREAM_INITIALIZED:"INVALID_STREAM_INITIALIZED",INVALID_ADD_TRACK_NUMBER:"INVALID_ADD_TRACK_NUMBER",INVALID_REMOVE_AUDIO_TRACK:"INVALID_REMOVE_AUDIO_TRACK",INVALID_REMOVE_AUDIO_ADDING:"INVALID_REMOVE_AUDIO_ADDING",INVALID_REMOVE_AUDIO_ON:"INVALID_REMOVE_AUDIO_ON",INVALID_REMOVE_TRACK_PUBLISHING:"INVALID_REMOVE_TRACK_PUBLISHING",INVALID_REMOVE_TRACK_NOT_TRACK:"INVALID_REMOVE_TRACK_NOT_TRACK",INVALID_REMOVE_TRACK_NUMBER:"INVALID_REMOVE_TRACK_NUMBER",INVALID_REPLACE_TRACK_NO_TRACK:"INVALID_REPLACE_TRACK_NO_TRACK",REPEAT_JOIN:"REPEAT_JOIN",CLIENT_DESTROYED:"CLIENT_DESTROYED",NOT_BUG_PACKAGE:"NOT_BUG_PACKAGE",START_MIX_TRANSCODE_FAILED:"START_MIX_TRANSCODE_FAILED",STOP_MIX_TRANSCODE_FAILED:"STOP_MIX_TRANSCODE_FAILED",MIX_TRANSCODE_NOT_STARTED:"MIX_TRANSCODE_NOT_STARTED",CANNOT_LESS_THAN_ZERO:"CANNOT_LESS_THAN_ZERO",MIX_PARAMS_VIDEO_FRAMERATE:"MIX_PARAMS_VIDEO_FRAMERATE",MIX_PARAMS_VIDEO_GOP:"MIX_PARAMS_VIDEO_GOP",MIX_PARAMS_AUDIO_BITRATE:"MIX_PARAMS_AUDIO_BITRATE",MIX_PARAMS_USER_Z_ORDER:"MIX_PARAMS_USER_Z_ORDER",MIX_PARAMS_NOT_SELF:"MIX_PARAMS_NOT_SELF",MIX_PARAMS_USER_STREAM:"MIX_PARAMS_USER_STREAM",INVALID_PLAY:"INVALID_PLAY",INVALID_ELEMENT_ID:"INVALID_ELEMENT_ID",INVALID_ELEMENT_ID_TYPE:"INVALID_ELEMENT_ID_TYPE",PLAY_FAILED:"PLAY_FAILED",INVALID_USERID:"INVALID_USERID",INVALID_CREATE_STREAM_SOURCE:"INVALID_CREATE_STREAM_SOURCE",INVALID_CREATE_STREAM_SCREEN:"INVALID_CREATE_STREAM_SCREEN",INVALID_CREATE_STREAM_AUDIO:"INVALID_CREATE_STREAM_AUDIO",INVALID_CREATE_STREAM_SCREEN_AUDIO:"INVALID_CREATE_STREAM_SCREEN_AUDIO",NOT_SUPPORTED_HTTP:"NOT_SUPPORTED_HTTP",NOT_SUPPORTED_WEBRTC:"NOT_SUPPORTED_WEBRTC",NOT_SUPPORTED_PROFILE:"NOT_SUPPORTED_PROFILE",NOT_SUPPORTED_MEDIA:"NOT_SUPPORTED_MEDIA",NOT_SUPPORTED_H264ENCODE:"NOT_SUPPORTED_H264ENCODE",NOT_SUPPORTED_H264DECODE:"NOT_SUPPORTED_H264DECODE",NOT_SUPPORTED_TRACK:"NOT_SUPPORTED_TRACK",NOT_SUPPORTED_SWITCH_DEVICE:"NOT_SUPPORTED_SWITCH_DEVICE",NOT_SUPPORTED_CAPTURE:"NOT_SUPPORTED_CAPTURE",NOT_SUPPORTED_AUX:"NOT_SUPPORTED_AUX",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",SIGNAL_RESPONSE_FAILED:"SIGNAL_RESPONSE_FAILED",CATCH_HANDLER_ERROR:"CATCH_HANDLER_ERROR",API_NOT_EXIST:"API_NOT_EXIST",CONNECTION_CLOSED:"CONNECTION_CLOSED",SUBSCRIBE_ALL_FALSE:"SUBSCRIBE_ALL_FALSE",SEI_NOT_SUPPORT:"SEI_NOT_SUPPORT",SEI_DISABLED:"SEI_DISABLED",SEI_BEFORE_PUBLISH:"SEI_BEFORE_PUBLISH",SEI_NOT_VIDEO:"SEI_NOT_VIDEO",CALL_FREQUENCY_LIMIT:"CALL_FREQUENCY_LIMIT",CONNECTION_ABORTED:"CONNECTION_ABORTED",API_CALL_ABORTED:"API_CALL_ABORTED",DUPLICATE_AUX:"DUPLICATE_AUX"},ba={AVOID_REPEATED_CALL:r=>"previous ".concat(r.name,"() is ongoing, please avoid repeated calls."),INVALID_PARAMETER_REQUIRED(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' is a required param when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_TYPE(r){let{key:a,rule:d,fnName:g,value:C}=r,A="".concat(a||d.name),w="";return w=Array.isArray(d.type)?d.type.join("|"):d.type,"'".concat(A,"' must be type of ").concat(w," when calling ").concat(g,"(), received type: ").concat(Ji(C),".")},INVALID_PARAMETER_EMPTY(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' cannot be '").concat(C,"' when calling ").concat(g,"().")},INVALID_PARAMETER_INSTANCE(r){let{key:a,rule:d,fnName:g,value:C}=r,A="".concat(a||d.name),w="".concat(d.instanceOf.name||d.instanceOf);return"'".concat(A,"' must be instanceof ").concat(w," when calling ").concat(g,"(), received type: ").concat(Ji(C),".")},INVALID_PARAMETER_RANGE(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' must be one of ").concat(d.values.join("|")," when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_MIN(r){let{key:a,rule:d,fnName:g,value:C}=r;return"the min value of ".concat(a||d.name," is ").concat(d.min,", received: ").concat(C,".")},INVALID_PARAMETER_MAX(r){let{key:a,rule:d,fnName:g,value:C}=r;return"the max value of ".concat(a||d.name," is ").concat(d.max,", received: ").concat(C,".")},API_CALL_TIMEOUT:r=>"".concat(r.commandDesc||r.command," timeout observed."),SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:r=>"SignalChannel setup failure: (errorCode: ".concat(r.errorCode,", errorMsg: ").concat(r.errorMsg," })."),ERROR_MESSAGE(r){let a="".concat(r.type," failed");return r.message&&(a="".concat(a,": ").concat(r.message,".")),a},EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:r=>"exchange sdp failed ".concat(r.errMsg,"."),UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:r=>"'".concat(r,"' must be validate string when useStringRoomId is true."),INVALID_ROOMID_INTEGER:r=>"'".concat(r,"' must be an integer between [1, 4294967294] when useStringRoomId is false."),INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED(r){let{error:a,code:d}=r;return"Failed to join room - ".concat(a," code: ").concat(d)},REJOIN_ROOM_FAILED:r=>"reJoin room: ".concat(r.roomId," failed, please check your network."),INVALID_DESTROY:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:"no permission to publish() under live/".concat("audience",', please call switchRole("',"anchor",'") firstly before publish().'),INVALID_INITIALIZE:"cannot publish stream because stream is not initialized, is switching device, or has been closed.",INVALID_DUPLICATE_PUBLISHING:r=>"duplicate ".concat(r," stream publishing, please unpublish your prev ").concat(r," stream and then re-publish."),INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED(r){let{message:a,userId:d,streamType:g}=r;return"failed to subscribe ".concat(d," ").concat(g," stream, reason: ").concat(a,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as ".concat("anchor"," or ","audience","."),INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:r=>"switchRole failed, errCode: ".concat(r.code," errMsg: ").concat(r.message,"."),CLIENT_BANNED:r=>"client was banned because of ".concat(r.message,"."),INVALID_OPERATION_START_PUBLISH_CDN:"please call startPublishCDNStream() after join room and publish the local stream.",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:r=>"startPublishCDNStream failed, errMsg: ".concat(r.message,"."),STOP_PUBLISH_CDN_FAILED:r=>"stopPublishCDNStream failed, errMsg: ".concat(r.message,"."),INVALID_STREAM_ID:r=>"'".concat(r,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores."),START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",INVALID_OPERATION_CHANGE_SMALL:"cannot switch to the small stream without subscribing to the video of remoteStream.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported on your browser.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_TRACK:"localStream has not this track.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REPLACE_TRACK_NO_TRACK:r=>"cannot replace ".concat(r.kind," track because stream has not ").concat(r.kind," track"),NOT_BUG_PACKAGE:"You need to buy packages, refer to tencent console.",START_MIX_TRANSCODE_FAILED:r=>"startMixTranscode failed, errMsg: ".concat(r.message,"."),STOP_MIX_TRANSCODE_FAILED:r=>"stopMixTranscode failed, errMsg: ".concat(r.message,"."),MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' cannot be less than 0 when calling ").concat(g,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:r=>"'".concat(r,"' is required and must be between 1 and 15."),MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_ELEMENT_ID:r=>{let{key:a,fnName:d}=r;return"'".concat(a,"' is not found in the document object when calling ").concat(d,"().")},INVALID_ELEMENT_ID_TYPE:r=>{let{key:a,fnName:d,type:g}=r;return"the element corresponding to '".concat(a,"' must be instanceof HTMLElement when calling ").concat(d,"(), received: ").concat(g,".")},PLAY_FAILED:r=>"".concat(r.media," play failed，browser exception: ").concat(r.error.toString()),INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"http protocol does not support the ability to capture microphone, camera and screen. please use https to deploy your page.",NOT_SUPPORTED_WEBRTC:"your browser or environment does not support full WebRTC capabilities.",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser or environment does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_TRACK:r=>"".concat(r,"Track is not supported on your browser."),NOT_SUPPORTED_SWITCH_DEVICE:"switchDevice is not supported on your browser.",NOT_SUPPORTED_CAPTURE:"Your browser or environment does not support screen sharing, please check whether the browser version.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone.",CAMERA_NOT_FOUND:"no camera detected, please check your camera.",SIGNAL_RESPONSE_FAILED:r=>"".concat(r.signalResponse," failed, response code is ").concat(r.code," , errMsg: ").concat(r.message,"."),CATCH_HANDLER_ERROR(r){let{name:a,event:d}=r;return"an error was caught on ".concat(a,".on('").concat(d,"', handler), please check your code on 'handler'.")},API_NOT_EXIST(r){let{name:a}=r;return"experimental api ".concat(a," does not exist.")},REPEAT_JOIN:r=>"[".concat(r,"] is calling client.join api or has already joined room, please avoid repeated join."),CONNECTION_CLOSED:"remoteStream has been unsubscribed or unpublished by remote user.",SUBSCRIBE_ALL_FALSE:"cannot subscribe when both audio & video are false, use client.unsubscribe() instead",CLIENT_DESTROYED(r){let{funName:a}=r;return"failed to call ".concat(a,"() because client was destroyed.")},SEI_NOT_SUPPORT:r=>"not support to sendSEIMessage".concat(r===!1?" without using h264 codec":""),SEI_DISABLED:"SEI is disabled",SEI_BEFORE_PUBLISH:"please call sendSEIMessage() after publish() success",SEI_NOT_VIDEO:"cannot send sei when localStream has not video.",CALL_FREQUENCY_LIMIT:r=>{let{isSize:a,name:d,timesInSecond:g,maxSizeInSecond:C}=r;return"api ".concat(d," call ").concat(a?"size":"times"," is over ").concat(a?"".concat(C," bytes"):g," in a second.")},CONNECTION_ABORTED:r=>"connection aborted due to: ".concat(r),API_CALL_ABORTED(r){let a;return a=r.message.includes("REMOTE_STREAM_NOT_EXIST")?"Subscribe ".concat(r.userId," ").concat(r.streamType," stream aborted, reason: remote user ").concat(r.userId," unpublished stream."):"API aborted, reason: ".concat(r.message),a},DUPLICATE_AUX:"only one auxiliary stream can be published in a room.",NOT_SUPPORTED_AUX:"publish auxiliary stream is not supported on your browser.",INVALID_PARAMETER_STREAMTYPE:r=>"'streamType' is required when 'userId' is not '*', calling ".concat(r,"()")},YF={};O_(YF,{ANDROID_VERSION:()=>VA,CHROME_MAJOR_VERSION:()=>gg,CHROME_VERSION:()=>nR,EDGE_VERSION:()=>BA,EDG_MAJOR_VERSION:()=>ZF,EDG_VERSION:()=>$A,FIREFOX_MAJOR_VERSION:()=>QF,FIREFOX_VERSION:()=>GA,HUAWEI_VERSION:()=>QA,IE_VERSION:()=>aoe,IOS_MAIN_VERSION:()=>oR,IOS_VERSION:()=>bu,IPADQQB_VERSION:()=>JA,IS_ANDROID:()=>Bs,IS_ANDROID_WEBVIEW:()=>i4,IS_ANY_SAFARI:()=>Z_,IS_CHROME:()=>nS,IS_CHROME_OS:()=>t4,IS_CHROMIUM_BASE:()=>Q_,IS_EDG:()=>z_,IS_EDGE:()=>K_,IS_ELECTRON:()=>o4,IS_FIREFOX:()=>gr,IS_HEADLESS_CHROME:()=>r4,IS_HUAWEI:()=>coe,IS_HUAWEIBROWSER:()=>eS,IS_IE:()=>e4,IS_IE8:()=>soe,IS_IOS:()=>tc,IS_IOS_13_OR_14:()=>a4,IS_IOS_15_1:()=>s4,IS_IPAD:()=>q_,IS_IPADQQB:()=>XC,IS_IPAD_PRO:()=>FA,IS_IPHONE:()=>hg,IS_IPOD:()=>XF,IS_LINUX:()=>QC,IS_LOCAL:()=>$h,IS_MAC:()=>Bh,IS_MACQQB:()=>JC,IS_MIBROWSER:()=>ZC,IS_MQQB:()=>j_,IS_NATIVE_ANDROID:()=>ioe,IS_OLD_ANDROID:()=>roe,IS_OPPOBROWSER:()=>J_,IS_SAFARI:()=>nc,IS_SAFARI_15_1:()=>uoe,IS_SAMSUNGBROWSER:()=>tS,IS_SOGOU:()=>zC,IS_SOGOUM:()=>KC,IS_TBS:()=>il,IS_UCBROWSER:()=>n4,IS_VIVOBROWSER:()=>X_,IS_WECHAT:()=>jC,IS_WIN:()=>fg,IS_WQQB:()=>YC,IS_WX:()=>loe,IS_X5MQQB:()=>W_,IS_XWEB:()=>WC,MACQQB_VERSION:()=>YA,MI_VERSION:()=>XA,MQQB_VERSION:()=>Y_,OPPO_VERSION:()=>eR,SAFARI_VERSION:()=>ey,SAMSUNG_VERSION:()=>ZA,SOGOUM_VERSION:()=>HA,SOGOU_VERSION:()=>qA,TBS_VERSION:()=>KA,USER_AGENT:()=>Ca,VIVO_VERSION:()=>tR,WECHAT_VERSION:()=>WA,WQQB_VERSION:()=>jA,XWEB_VERSION:()=>zA,browserInfo:()=>Cu,getBrowserInfo:()=>l4,getChromeMajorVersion:()=>pg,getOSName:()=>iR,getOSString:()=>sR,getOSType:()=>doe,getTerminalType:()=>u4,getUserAgentData:()=>rR,isLocalStorageEnabled:()=>Hh});var Ca=typeof navigator>"u"?"":navigator.userAgent,io=r=>new RegExp(r,"i").test(Ca),Fr=r=>{if(io(r)){let a=new RegExp("".concat(r,"\\/([\\d.]+)")),d=Ca.match(a);if(d&&d[1])return d[1]}return""},xA=r=>{if(io(r)){let a=new RegExp("".concat(r,"\\/(\\d+)")),d=Ca.match(a);if(d&&d[1])return parseFloat(d[1])}return NaN},JF=/AppleWebKit\/([\d.]+)/i.exec(Ca),ooe=JF?parseFloat(JF[1]):NaN,q_=io("iPad"),FA=typeof navigator<"u"&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&io("Macintosh"),hg=io("iPhone")&&!q_,XF=io("iPod"),tc=hg||q_||XF||FA,Bs=io("Android"),VA=function(){if(Bs){let r=Ca.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(r){let a=r[1]&&parseFloat(r[1]),d=r[2]&&parseFloat(r[2]);if(a&&d)return parseFloat("".concat(r[1],".").concat(r[2]));if(a)return a}}return NaN}(),roe=Bs&&io("webkit")&&VA<2.3,ioe=Bs&&VA<5&&ooe<537,gr=io("Firefox"),GA=Fr("Firefox"),QF=xA("Firefox"),K_=io("Edge"),BA=Fr("Edge"),z_=io("Edg"),$A=Fr("Edg"),ZF=xA("Edg"),KC=io("SogouMobileBrowser"),HA=Fr("SogouMobileBrowser"),zC=io("MetaSr\\s"),qA=Fr("MetaSr\\s"),il=io("TBS"),KA=Fr("TBS"),WC=io("XWEB"),zA=Fr("XWEB"),soe=io("MSIE\\s8\\.0"),e4=io("MSIE\\/\\d+"),aoe=function(){if(e4){let r=/MSIE\s(\d+)\.\d/.exec(Ca),a=r&&parseFloat(r[1]);return!a&&/Trident\/7.0/i.test(Ca)&&/rv:11.0/.test(Ca)&&(a=11),a}return NaN}(),jC=io("(micromessenger|webbrowser)"),WA=Fr("MicroMessenger"),W_=!il&&io("MQQBrowser")&&io("COVC"),j_=!il&&io("MQQBrowser")&&!io("COVC"),Y_=j_||W_?Fr("MQQBrowser"):"",YC=!il&&io(" QQBrowser"),jA=Fr(" QQBrowser"),JC=!il&&io("QQBrowserLite"),YA=Fr("QQBrowserLite"),XC=!il&&io("MQBHD"),JA=Fr("MQBHD"),fg=io("Windows"),Bh=!tc&&io("MAC OS X"),QC=!Bs&&io("Linux"),t4=io("CrOS"),loe=io("MicroMessenger"),n4=io("UCBrowser"),o4=io("Electron"),ZC=io("MiuiBrowser"),XA=Fr("MiuiBrowser"),eS=io("HuaweiBrowser"),coe=io("Huawei"),QA=Fr("HuaweiBrowser"),tS=io("SamsungBrowser"),ZA=Fr("SamsungBrowser"),J_=io("HeyTapBrowser"),eR=Fr("HeyTapBrowser"),X_=io("VivoBrowser"),tR=Fr("VivoBrowser"),pg=()=>xA("Chrome"),Q_=io("Chrome"),nS=!K_&&!zC&&!KC&&!il&&!WC&&!z_&&!YC&&!ZC&&!eS&&!tS&&!J_&&!X_&&Q_,r4=io("HeadlessChrome"),gg=pg(),nR=Fr("Chrome"),nc=!Q_&&!j_&&!W_&&!JC&&!XC&&io("Safari"),Z_=nc||tc,ey=Fr("Version"),i4=/Android.*(wv|.0.0.0)/.test(Ca),bu=(()=>{if(FA)return ey;if(tc){let r=Ca.match(/OS (\d+)_(\d+)/i);if(r&&r[1]){let a=r[1];return r[2]&&(a+=".".concat(r[2])),a}}return""})(),oR=Number(bu.split(".")[0]),uoe=ey==="15.1",s4=bu==="15.1",a4=(()=>{let r=Number(bu.split(".")[0]);return r===14||r===13})(),$h=typeof location<"u"&&(location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"),Hh=(()=>{let r;return()=>{if(Pt(r))try{r=!!window.localStorage}catch{r=!1}return r}})(),Cu=l4();function l4(){let r=new Map([[gr,["Firefox",GA]],[z_,["Edg",$A]],[nS,["Chrome",nR]],[nc,["Safari",ey]],[il,["TBS",KA]],[WC,["XWEB",zA]],[jC&&hg,["WeChat",WA]],[YC,["QQ(Win)",jA]],[j_,["QQ(Mobile)",Y_]],[W_,["QQ(Mobile X5)",Y_]],[JC,["QQ(Mac)",YA]],[XC,["QQ(iPad)",JA]],[ZC,["MI",XA]],[eS,["HW",QA]],[tS,["Samsung",ZA]],[J_,["OPPO",eR]],[X_,["VIVO",tR]],[K_,["EDGE",BA]],[KC,["SogouMobile",HA]],[zC,["Sogou",qA]]]),a="unknown",d="unknown";return r.has(!0)&&([a,d]=r.get(!0)),{name:a,version:d}}var Sa=null;function rR(){return Ze(this,null,function*(){if(Sa)return Sa;if(!navigator.userAgentData||!lr(navigator.userAgentData.getHighEntropyValues))return null;try{return Sa=yield navigator.userAgentData.getHighEntropyValues(["architecture","bitness","model","platformVersion","fullVersionList"])}catch{return null}})}var c4=new Map([[Bs,"Android"],[tc,"iOS"],[fg,"Windows"],[Bh,"MacOS"],[QC,"Linux"],[t4,"ChromeOS"]]),iR=function(){return c4.get(!0)?c4.get(!0):Sa?Sa.platform:"unknown"},sR=()=>{let r=iR();return r+="/".concat(Cu.name,"/").concat(nc?Cu.version:Cu.version.split(".")[0]),Sa!=null&&Sa.platformVersion&&(r+="/".concat(Sa.platformVersion)),Sa!=null&&Sa.architecture&&(r+="/".concat(Sa.architecture)),r};function u4(){return Bs?4:hg?2:q_?3:Bh?12:fg?5:QC?13:1}function doe(){return Bs?"Android":hg?"iPhone":q_?"iPad":Bh?"Mac":fg?"Windows":QC?"Linux":"unknown"}var d4=(r,a)=>a?"".concat(Fh,"/").concat(r,"/").concat(a):"".concat(Fh,"/").concat(r,"/index.html"),hoe=()=>{if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};let r=localStorage.getItem(LF);if(r){r=JSON.parse(r);let a=document.createElement("script");a.type="text/javascript",a.text=r.message,document.body.appendChild(a);let d=window.TRTC_ERROR_INFO,g=window.TRTC_ERROR_LINK;return document.body.removeChild(a),{TRTC_ERROR_INFO:d,TRTC_ERROR_LINK:g}}return{}};function no(r){let{key:a,data:d,link:g,addDocLink:C=!0}=r,A="",w="",V="";lr(ba[a])?A=ba[a](d):Ho(ba[a])&&(A=ba[a]);let{TRTC_ERROR_INFO:U,TRTC_ERROR_LINK:j}=hoe();g?V="".concat(g.className,".html#").concat(g.fnName):j&&j[a]&&(lr(j[a])?V=j[a](d):Ho(j[a])&&(V=j[a]));let re=A;return Tu()&&(U&&U[a]&&(lr(U[a])?w=U[a](d):Ho(U[a])&&(w=U[a])),w&&(re=C?"".concat(w,`
请查看文档: `).concat(d4("zh-cn",V),`

`):"".concat(w,`

`),re+=A)),C&&(re+=` 
Refer to: `.concat(d4("en",V),`
`)),re}var Xn,ty=function(r){let{retryFunction:a,settings:d,onError:g,onRetrying:C,onRetryFailed:A,onRetrySuccess:w,context:V}=r;return function(){for(var U=arguments.length,j=new Array(U),re=0;re<U;re++)j[re]=arguments[re];let{retries:ce=5,timeout:Te=1e3}=d,De=0,ze=-1,_t=0,Ft=($t,bt)=>Ze(this,null,function*(){let yn=V||this;try{let Rn=yield a.apply(yn,j);De>0&&w&&w.call(this,De),De=0,$t(Rn)}catch(Rn){let Gn=()=>{clearTimeout(ze),De=0,_t=2,bt(Rn)},Vo=()=>{_t!==2&&De<(lr(ce)?ce():ce)?(De++,_t=1,lr(C)&&C.call(this,De,Gn),ze=window.setTimeout(()=>{ze=-1,Ft($t,bt)},lr(Te)?Te(De):Te)):(Gn(),lr(A)&&A.call(this,Rn))};lr(g)?g.call(this,{error:Rn,retry:Vo,reject:bt,retryFuncArgs:j,retriedCount:De}):Vo()}});return new Promise(Ft)}},Qt=new(vi(gs(),1)).default,h4=((Xn=h4||{}).ROOM_DESTROY="1",Xn.JOIN_START="21",Xn.JOIN_SCHEDULE_SUCCESS="22",Xn.JOIN_SIGNAL_CONNECTION_START="23",Xn.JOIN_SIGNAL_CONNECTION_END="24",Xn.JOIN_SEND_CMD="25",Xn.JOIN_RECEIVED_CMD_RES="26",Xn.JOIN_SUCCESS="27",Xn.JOIN_FAILED="28",Xn.LEAVE_START="51",Xn.LEAVE_SEND_CMD="52",Xn.LEAVE_SUCCESS="53",Xn.PUBLISH_START="61",Xn.SEND_FIRST_VIDEO_FRAME="62",Xn.PUBLISH_FAILED="63",Xn.SUBSCRIBE_START="81",Xn.SUBSCRIBE_SUCCESS="82",Xn.SUBSCRIBE_FAILED="84",Xn.UNSUBSCRIBE_SUCCESS="83",Xn.LOCAL_TRACK_CAPTURE_START="101",Xn.LOCAL_TRACK_CAPTURE_SUCCESS="102",Xn.LOCAL_TRACK_CAPTURE_FAILED="103",Xn.LOCAL_TRACK_PUBLISHED="104",Xn.LOCAL_TRACK_UNPUBLISHED="105",Xn.LOCAL_TRACK_REPLACED="106",Xn.SWITCH_DEVICE_SUCCESS="107",Xn.TRACK_MUTED="108",Xn.TRACK_UNMUTED="109",Xn.REMOTE_TRACK_SUBSCRIBED="110",Xn.REMOTE_TRACK_UNSUBSCRIBED="111",Xn.PLAY_TRACK_START="151",Xn.PLAYER_STATE_CHANGED="152",Xn.VIDEO_LOADED_DATA="153",Xn.AUTOPLAY_DIALOG_CLICK_CONFIRM="154",Xn.SIGNAL_CONNECTION_STATE_CHANGED="201",Xn.PEER_CONNECTION_STATE_CHANGED="202",Xn.SINGLE_CONNECTION_STAT="203",Xn.SPC_RECONNECTED="204",Xn.HEARTBEAT_REPORT="251",Xn.RECEIVED_PUBLISHED_USER_LIST="252",Xn.REMOTE_PUBLISH_STATE_CHANGED="253",Xn.AUDIO_LEVEL_INTERVAL="260",Xn.NETWORK_QUALITY="261",Xn),Vr=new class{constructor(){this._roomIdMap=new Map,typeof registerProcessor>"u"&&(this._configs={sdkAppId:"",userId:"",version:nl,env:Vh.QCLOUD,browserVersion:Cu.name+Cu.version,ua:navigator.userAgent})}setConfig(r){let{sdkAppId:a,env:d,userId:g,roomId:C}=r;a!==this._configs.sdkAppId&&(this._configs.sdkAppId=String(a)),this._configs.env=d,this._configs.userId=g,this._roomIdMap.set(g,String(C))}logSuccessEvent(r){$h||!cn.isAbleToUpload||this._configs.env===Vh.QCLOUD&&this.uploadEventToKibana(uo(Pn({},r),{result:"success"}))}logFailedEvent(r){if($h||!cn.isAbleToUpload)return;let{eventType:a,code:d,error:g,userId:C}=r,A={roomId:this._roomIdMap.get(C||this._configs.userId),userId:C,eventType:a,result:"failed",code:d||(g==null?void 0:g.extraCode)||(g==null?void 0:g.code)||rn.UNKNOWN};this._configs.env===Vh.QCLOUD&&this.uploadEventToKibana(uo(Pn({},A),{error:g}))}uploadEventToKibana(r){let a="stat-".concat(r.eventType,"-").concat(r.result);(r.eventType==="delta-join"||r.eventType==="delta-leave"||r.eventType==="delta-publish")&&(a="".concat(r.eventType,":").concat(r.delta)),this.uploadEvent({log:a,userId:r.userId}),r.result==="failed"&&(a="stat-".concat(r.eventType,"-").concat(r.result,"-").concat(r.code),this.uploadEvent({log:a,userId:r.userId,error:r.error}))}uploadEvent(r){let{log:a,userId:d,error:g}=r,C={timestamp:kF(),sdkAppId:this._configs.sdkAppId,userId:d||this._configs.userId,version:nl,log:a};g&&(C.errorInfo=g.message),this.sendRequest(ny(this._configs.sdkAppId,P_.LOG),C)}sendRequest(r,a){cn.isAbleToUpload?H_({url:r,body:JSON.stringify(a)}).catch(()=>{}):setTimeout(()=>{this.sendRequest(r,a)},1e3)}},aR=null,lR=!0;function Su(r){vs(r)&&r!==lR&&(lR=r,cn.info("setIsNeedToSchedule ".concat(r)))}function foe(r){return Ze(this,arguments,function(a){let{userId:d,sdkAppId:g,useStringRoomId:C,roomId:A,userSig:w,version:V,frameWorkType:U}=a;return function*(){if(!lR&&aR)return{isCached:!0,result:aR};let j={delta:0,count:[1,1],msg:[],detail:[]};try{let re=new FormData;re.append("userId",String(d)),re.append("sdkAppId",String(g)),re.append("isStrGroupId",String(C)),re.append("groupId",String(A)),re.append("sdkVersion",V),re.append("userSig",String(w)),U&&re.append("frameWorkType",String(U));let ce=To(),Te=yield function(ze,_t,Ft){return new Promise(($t,bt)=>{let yn=null;dR([g4(Rn=>_t.count[0]=Rn+1,Rn=>{let{error:Gn,retry:Vo,retriedCount:qo,retryFuncArgs:Pu}=Rn;_t.msg[0]=Gn.message,yn||(qo>=2&&(Pu[0]=mg(Ft,Pe.MAIN,!0)),Vo())})(mg(Ft,Pe.MAIN),ze,{get timeout(){return 1e3*ry(2+_t.count[0])}}),g4(Rn=>_t.count[1]=Rn+1,Rn=>{let{error:Gn,retry:Vo,retriedCount:qo,retryFuncArgs:Pu}=Rn;_t.msg[1]=Gn.message,yn||(qo>=2&&(Pu[0]=mg(Ft,Pe.BACKUP,!0)),Vo())})(mg(Ft,Pe.BACKUP),ze,{get timeout(){return 1e3*ry(2+_t.count[1])}})]).then(Rn=>{yn=Rn,$t(yn)}).catch(bt)})}(re,j,g);Te.config&&(Te.config.loggerDomain&&L_(Te.config.loggerDomain),vs(Te.config.scheduleCache)&&Su(!Te.config.scheduleCache)),j.delta=To()-ce;let De=function(ze,_t,Ft){let $t=performance.getEntriesByType("resource"),bt=mg(ze,Pe.MAIN),yn=mg(ze,Pe.BACKUP),Rn={totalCost:0,local:0,dns:0,tcp:0,tls:0,request:0,response:0};for(let Gn of $t)if(Gn.startTime>=Ft&&(Gn.name===bt||Gn.name===yn)&&Gn.transferSize>0){let Vo=Gn.name===bt?Pe.MAIN:Pe.BACKUP,qo=Math.round(Gn.duration),Pu=Math.round(Gn.domainLookupStart-Gn.startTime),Ci=Math.round(Gn.domainLookupEnd-Gn.domainLookupStart),xS=Math.round(Gn.requestStart-Gn.secureConnectionStart),ul=Math.round(Gn.secureConnectionStart-Gn.connectStart),uG=Math.round(Gn.responseStart-Gn.requestStart),dG=Math.round(Gn.responseEnd-Gn.responseStart),Fie=[Pu,Ci,xS,ul,uG,dG];Vr.uploadEvent({log:"stat-schedule-net:".concat(qo,"(").concat(Fie.join("->"),") ").concat(Vo),userId:_t}),Rn=uo(Pn({},Rn),{totalCost:qo,local:Pu,dns:Ci,tcp:ul,tls:xS,request:uG,response:dG});break}return Rn}(Number(g),d,ce);return aR=Te,{isCached:!1,result:Te,detailCost:De}}catch(re){let ce=_i(re)?re[0]:re,Te=si(ce.code)?ce.code:0,De="schedule failed".concat(ce.message?": ".concat(ce.message):""),ze=new An({code:rn.SCHEDULE_FAILED,extraCode:Te,message:no({key:jn.JOIN_ROOM_FAILED,data:{error:De,code:Te}})});throw cn.error(De,Te),ze}}()})}document&&document.head.insertAdjacentHTML("beforeend",Object.values(rl).map(r=>'<link rel="dns-prefetch" href="https://'.concat(r,'">')).join(`\r
`)),Qt.on("28",()=>Su(!0)),Qt.on("63",()=>Su(!0)),Qt.on("84",()=>Su(!0)),Qt.on("201",r=>{r.state==="RECONNECTING"&&Su(!0)}),Qt.on("202",r=>{r.state==="RECONNECTING"&&Su(!0)});var qh={main:"",backup:""};function f4(r){_i(r)?(qh.main=r[0],qh.backup=r[1]):qh.main=r}function mg(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pe.MAIN,d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return"https://".concat(qh[a]||p4(r,a,d),"/api/v1/config")}function poe(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pe.MAIN;return"https://".concat(qh[a]||p4(r,a),"/api/v1/trtcAutoConf")}function p4(r){let a,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pe.MAIN,g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return oS(r)?d===Pe.MAIN?rl.MAIN_OVERSEA:rl.BACKUP_OVERSEA:(a=oS(r)?g?d===Pe.MAIN?rl.MAIN_OVERSEA_OLD:rl.BACKUP_OVERSEA_OLD:d===Pe.MAIN?rl.MAIN_OVERSEA:rl.BACKUP_OVERSEA:d===Pe.MAIN?rl.MAIN:rl.BACKUP,a)}function goe(r,a,d){return new Promise((g,C)=>{H_({url:r,body:a,timeout:d.timeout}).then(A=>{A.data.code===0?g(A.data.data):C({code:A.data.code,message:A.data.msg})}).catch(C)})}var g4=(r,a)=>ty({retryFunction:goe,settings:{retries:3,timeout:0},onError:a,onRetrying:r}),moe=function(){return new URLSearchParams(location.search).get("trtc_env")||""},oS=r=>Number(r)<14e8,ny=function(r,a){let d;d=TA||(oS(r)?NF:OF);let g=Math.floor(Math.random()*vA(2,31));return"".concat(d,"/v5/AVQualityReportSvc/C2S?random=").concat(g,"&sdkappid=").concat(r,"&cmdtype=").concat(a)},oy="unknown";function m4(){if(oy!=="unknown")return oy;let{userAgent:r,connection:a}=navigator,d=(r.match(/NetType\/\S+/)||[])[0]||"";d=d.toLowerCase().replace("nettype/",""),d==="3gnet"&&(d="3g");let g=a&&a.type&&a.type.toLowerCase(),C=a&&a.effectiveType&&a.effectiveType.toLowerCase();return C==="slow-2"&&(C="2g"),g&&(oy=v4(g,C)),oy}function v4(r,a){if(MA[r])return r;switch(r){case"cellular":case"wimax":return a||"unknown";case"ethernet":return"wired";default:return"unknown"}}function _4(r){oy=v4(r)}function rS(){return MA[m4()]}function voe(r,a){for(let d of Reflect.ownKeys(a))if(d!=="constructor"&&d!=="prototype"&&d!=="name"){let g=Object.getOwnPropertyDescriptor(a,d)||"";Object.defineProperty(r,d,g)}return r}function _oe(r){return y4(r/4,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function y4(r){return 1e3*r/(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function yoe(r){return 4*I4(r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function I4(r){return r*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)/1e3}var Ioe=typeof window<"u"&&typeof window.glog=="function"?window.glog:()=>{},Tu=()=>{let r=navigator.language;return r=r.substring(0,2),r==="zh"},oc=function(r){if(!r||typeof r!="object"||Object.prototype.toString.call(r)!="[object Object]")return!1;let a=Object.getPrototypeOf(r);if(a===null)return!0;let d=Object.prototype.hasOwnProperty.call(a,"constructor")&&a.constructor;return typeof d=="function"&&d instanceof d&&Function.prototype.toString.call(d)===Function.prototype.toString.call(Object)};function ry(r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return r<=1?a:ry(r-1,a,(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)+a)}function vg(r){return r>8?3e4:1e3*ry(r)}function Ji(r){return Reflect.apply(Object.prototype.toString,r,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}var lr=r=>typeof r=="function",Pt=r=>r===void 0,Ho=r=>typeof r=="string",si=r=>typeof r=="number",vs=r=>typeof r=="boolean",Eu=r=>Ji(r)==="object",_i=r=>Ji(r)==="array",boe=r=>Ji(r)==="MediaStreamTrack".toLowerCase(),_g=r=>r.isRemote,cR=r=>Ji(r)==="promise",uR=r=>lr(r)&&r.prototype.constructor===r,b4=r=>uR(r)?r.prototype.constructor.name:"",Coe=typeof AudioWorkletNode<"u";function dR(r){return new Promise((a,d)=>{let g=[];r.forEach(C=>{C.then(a).catch(A=>{g.push(A),g.length===r.length&&d(g)})})})}function To(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}var C4=r=>+r<10?"0".concat(r):r,Soe=r=>{let a=r.match(/^\d+\.\d+\.\d+/)[0];if(!a)return r;let d=a.split("."),g=C4(d[1])+C4(d[2]);return d[1]-15>0&&(d[1]="15"),d[2]-15>0&&(d[2]="15"),"".concat(d.join("."),".").concat(g)},Toe=Object.prototype.hasOwnProperty;function S4(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(oc(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let a in r)if(Toe.call(r,a))return!1;return!0}return!1}function iy(r,a){return{userId:a,hasAudio:!!(r&x_),hasVideo:!!(r&U_),hasAuxiliary:!!(r&VC),hasSmall:!!(r&wA),audioMuted:!!(r&DA),videoMuted:!!(r&OA),audioAvailable:!(!(r&x_)||r&DA),videoAvailable:!(!(r&U_)||r&OA)}}function Eoe(r){let a={urls:"turn:".concat(r.url)};return!Pt(r.username)&&!Pt(r.credential)&&(a.username=r.username,a.credential=r.credential,a.credentialType="password",Pt(r.credentialType)||(a.credentialType=r.credentialType)),a}function iS(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Ho(r))return 0;let d=r.split(".");return a?(Number(d[0])<<24|Number(d[1])<<16|Number(d[2])<<8|Number(d[3]))>>>0:(Number(d[3])<<24|Number(d[2])<<16|Number(d[1])<<8|Number(d[0]))>>>0}var Kh=function(r,a,d,g){if(!Eu(r)||!Eu(a))return 0;let C,A=0,w=Object.keys(a);for(let V=0,U=w.length;V<U;V++)if(C=w[V],!(Pt(a[C])||d&&d.includes(C)))if(Eu(r[C])&&Eu(a[C]))A+=Kh(r[C],a[C],d,g);else{if(g&&g.includes(a[C]))continue;r[C]!==a[C]&&(r[C]=sy(a[C]),A+=1)}return A};function sy(r){if(_i(r)){let a=[];return r.forEach((d,g)=>{a[g]=sy(d)}),a}if(Eu(r)){let a={};return Object.keys(r).forEach(d=>{a[d]=sy(r[d])}),a}return r}var sS=r=>{let a=[];if(_i(r))a=[...r];else if(Ho(r)){let d=document.getElementById(r);d&&a.push(d)}else r&&a.push(r);return a},Moe=r=>Ho(r)?document.getElementById(r):r,koe=new Intl.DateTimeFormat("zh-CN",{dateStyle:"short",timeStyle:"medium"}),Aoe=()=>koe.format(new Date);function rc(r,a){let{keysToInclude:d,keysToExclude:g}=a;try{if(_i(r))return"[".concat(r.map(V=>rc(V,{keysToInclude:d,keysToExclude:g})).join(","),"]");if(!oc(r)||!_i(d)&&!_i(g))return JSON.stringify(r);let C={},A=new Set(d),w=new Set(g);return Object.keys(r).forEach(V=>{(w.size===0&&A.has(V)||A.size===0&&!w.has(V))&&(C[V]=oc(r[V])||_i(r[V])?JSON.parse(rc(r[V],{keysToExclude:g,keysToInclude:d})):r[V])}),JSON.stringify(C)}catch{return"{}"}}function T4(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1],d=[];return Object.keys(r).forEach(g=>{a===r[g]&&d.push(g)}),rc(r,{keysToInclude:d})}function hR(r){return r.replace(/[\u4e00-\u9fa5]/g,"aa").length}var E4=()=>{var r,a,d,g;return(r=window.screen)!=null&&r.orientation?!((g=(d=(a=window.screen)==null?void 0:a.orientation)==null?void 0:d.type)==null||!g.includes("portrait")):window.orientation===0||window.orientation===180},aS=r=>Ze(void 0,null,function*(){return new Promise((a,d)=>{let g;if(Ho(r))g=new Image,g.crossOrigin="anonymous",g.src=r;else if(g=r,g.complete)return void a(g);g.onload=()=>a(g),g.onerror=d})}),M4=r=>{let a=r.split(".");return+a[0]<<24|+a[1]<<16|+a[2]<<8|+a[3]},fR=r=>(Object.keys(r).forEach(a=>{si(r[a])&&(a.startsWith("uint")||a.startsWith("int"))?r[a]=Math.floor(r[a]):(oc(r[a])||_i(r[a]))&&fR(r[a])}),r),Roe=Object.prototype.hasOwnProperty;function woe(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(function(a){if(!a||typeof a!="object"||Object.prototype.toString.call(a)!="[object Object]")return!1;let d=Object.getPrototypeOf(a);if(d===null)return!0;let g=Object.prototype.hasOwnProperty.call(d,"constructor")&&d.constructor;return typeof g=="function"&&g instanceof g&&Function.prototype.toString.call(g)===Function.prototype.toString.call(Object)}(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let a in r)if(Roe.call(r,a))return!1;return!0}return!1}var Doe=class{constructor(r){_e(this,"userId"),_e(this,"remoteUserId"),_e(this,"id"),_e(this,"sdkAppId"),_e(this,"type"),_e(this,"isLocal"),this.id=r.id,this.userId=r.userId,this.sdkAppId=r.sdkAppId,this.remoteUserId=r.remoteUserId,this.isLocal=typeof r.isLocal!="boolean"||r.isLocal,this.type=this.isLocal?"":r.type}createChild(r){return Object.setPrototypeOf(r,this)}setUserId(r){this.userId=r}setSdkAppId(r){this.sdkAppId=r}log(r,a){let d=this.isLocal?this.userId:this.remoteUserId;a.unshift("[".concat(this.isLocal?"↑":"↓").concat(this.type&&this.type!=="main"?"*":"").concat(this.id).concat(d?"|".concat(d):"","]")),cn.log(r,a,this.userId===void 0||woe(this.userId),this.userId,this.sdkAppId)}info(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(2,a)}debug(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(1,a)}warn(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(3,a)}error(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(4,a)}},Vt=h4,Ooe=!(tc||Bs||r4),cn=new class{constructor(){_e(this,"_isEnableUploadLog",!0),_e(this,"_localJoinedUser",new Map),_e(this,"_queue",[]),_e(this,"_timeoutId",-1),_e(this,"_logLevel",1),_e(this,"_logLevelToUpload",2),!FC&&!SA&&(this.checkURLParam(),this.installEvents())}get isAbleToUpload(){return this._isEnableUploadLog&&this._timeoutId!==-1}installEvents(){Qt.on(Vt.JOIN_SCHEDULE_SUCCESS,r=>{let{schedule:a}=r;var d;(d=a==null?void 0:a.config)!=null&&d.logLevelToUpload&&_u[a.config.logLevelToUpload]&&(this._logLevelToUpload=a.config.logLevelToUpload)}),Qt.on(Vt.JOIN_SUCCESS,r=>{let{room:a}=r;this.addJoinedUser({userId:a.userId,sdkAppId:a.sdkAppId}),this.startUpload()}),Qt.once(Vt.JOIN_FAILED,()=>{this.startUpload()}),Qt.on(Vt.LEAVE_SUCCESS,r=>{let{room:a}=r;this.deleteJoinedUser(a.userId)})}startUpload(){this._timeoutId===-1&&this.uploadInterval()}addJoinedUser(r){this._localJoinedUser.set(r.userId,r),this.startUpload()}deleteJoinedUser(r){this._localJoinedUser.delete(r)}uploadInterval(){this.upload().catch(()=>{}),this._timeoutId=window.setTimeout(()=>this.uploadInterval(),2e3)}getLogsToUpload(){let r={map:new Map,splicedQueue:[]};if(this._queue[0].forAllJoinedClients&&this._localJoinedUser.size===0)return r;let a=0;for(;a<this._queue.length&&a!==50;a++){let d=this._queue[a];if(d.forAllJoinedClients)this._localJoinedUser.forEach(g=>{let{userId:C,sdkAppId:A}=g;r.map.has(C)?r.map.get(C).logs.push(d):r.map.set(C,{userId:C,sdkAppId:A,logs:[d]})});else if(Ho(d.userId)&&si(d.sdkAppId)){let{userId:g,sdkAppId:C}=d;r.map.has(g)?r.map.get(g).logs.push(d):r.map.set(g,{userId:g,sdkAppId:C,logs:[d]})}}return r.map.size>0&&(r.splicedQueue=this._queue.splice(0,a)),r}upload(){return Ze(this,null,function*(){if(this._queue.length===0||!this._isEnableUploadLog)return;let{map:r,splicedQueue:a}=this.getLogsToUpload();if(r.size===0)return;try{let g=[...r.values()];for(let C=0;C<g.length;C++){let{userId:A,sdkAppId:w,logs:V}=g[C];yield this.uploadLogWithRetry(JSON.stringify({timestamp:kF(),sdkAppId:String(w),userId:A,version:nl,log:V.map(U=>U.log).join(`
`)}),w),V.forEach(U=>U.uploaded=!0)}}catch{}let d=a.filter(g=>!g.uploaded);d.length>0&&(this._queue=d.concat(this._queue))})}uploadLogWithRetry(r,a){return ty({retryFunction:()=>H_({url:ny(a,P_.LOG),body:r,timeout:5e3}),settings:{retries:3,timeout:1e3},onError:d=>{let{retry:g}=d;g()}})()}getPrefix(r){let a=new Date;a.setTime(IA());let d=String(a.getMilliseconds());return"padStart"in String.prototype&&(d=d.toString().padStart(3,"0")),"[".concat(a.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(d,"] <").concat(_u[r],">")}getLogLevel(){return this._logLevel}setLogLevel(r){Pt(_u[r])||(this._logLevel!==r&&this.info("setLogLevel",r),this._logLevel=r)}enableUploadLog(){this._isEnableUploadLog=!0}disableUploadLog(){this.warn("disableUploadLog"),this._isEnableUploadLog=!1}logChunkToString(r){if(Ho(r))return r;try{return r instanceof Error?r.toString():JSON.stringify(r)}catch{return""}}log(r,a){let d=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],g=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0;var A;if(a.unshift(this.getPrefix(r)),this._isEnableUploadLog&&r>=this._logLevelToUpload&&this._queue.push({log:a.reduce((V,U)=>"".concat(V," ").concat(this.logChunkToString(U)).trim(),""),level:r,userId:g,sdkAppId:C,forAllJoinedClients:d}),r<this._logLevel)return;let w=((A=_u[r])==null?void 0:A.toLowerCase())||"info";Ooe?console[w]("%cTRTC%c%s","padding: 1px 4px;border-radius: 3px;color: #fff;background: #1E88E5;","display: inline",...a):console[w](...a)}debug(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(1,a)}info(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(2,a)}warn(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(3,a)}error(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.log(4,a)}createLogger(r){return new Doe(r)}checkURLParam(){let r=new URLSearchParams(location.search).get("logLevelToUpload"),a=r?Number(r):-1;_u[a]&&(this._logLevelToUpload=a)}},k4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let a=16*Math.random()|0;return(r=="x"?a:3&a|8).toString(16)})},yg=new class{constructor(){_e(this,"_prefix","TRTC"),_e(this,"_queue",new Map),this.checkStorage()}getRealKey(r){return"".concat(this._prefix,"_").concat(r)}checkStorage(){Hh()&&(setInterval(this.doFlush.bind(this),2e4),Object.keys(localStorage).filter(r=>{if(r.startsWith(this._prefix)){let a=localStorage.getItem(r);if(!a)return!1;let d=JSON.parse(a);if(d&&d.expiresIn<Date.now())return!0}return!1}).forEach(r=>localStorage.removeItem(r)))}doFlush(){if(Hh())try{for(let[r,a]of this._queue)localStorage.setItem(r,JSON.stringify(a))}catch(r){cn.warn(r)}}getItem(r){if(!Hh())return null;try{let a=localStorage.getItem(this.getRealKey(r));if(!a)return null;let d=JSON.parse(a);return d&&d.expiresIn>=Date.now()?d.value:null}catch(a){cn.warn(a)}}setItem(r,a){if(Hh())try{let d={expiresIn:Date.now()+PF,value:a};this._queue.set(this.getRealKey(r),d)}catch(d){cn.warn(d)}}deleteItem(r){if(!Hh())return!1;try{return r=this.getRealKey(r),this._queue.delete(r),localStorage.removeItem(r),!0}catch(a){return cn.warn(a),!1}}clear(){if(Hh())try{localStorage.clear()}catch(r){cn.warn(r)}}},ay={};O_(ay,{HTTPS_API:()=>xoe,IS_GET_CAPABILITIES_SUPPORTED:()=>U4,IS_GET_SETTINGS_SUPPORTED:()=>Ig,IS_SEI_SUPPORTED:()=>cy,IS_SPC_SUPPORTED:()=>hS,basis:()=>Goe,checkSystemRequirementsInternal:()=>_R,decodeSupportStatus:()=>vR,encodeSupportStatus:()=>mR,getBrowserInfo:()=>Loe,getDisplayResolution:()=>D4,isAddTransceiverSupported:()=>ic,isBrowserSupported:()=>pR,isGetReceiversSupported:()=>uS,isGetSendersSupported:()=>dS,isGetTransceiversSupported:()=>Mu,isGetUserMediaSupported:()=>O4,isMediaDevicesSupported:()=>gR,isMediaSessionSupported:()=>F4,isMediaStreamTrackProcessorSupported:()=>Poe,isReplaceTrackSupported:()=>P4,isScreenCaptureApiAvailable:()=>lS,isSelectedCandidatePair:()=>ly,isSetParametersSupported:()=>yR,isSmallStreamAPISupported:()=>L4,isSmallStreamSupported:()=>cS,isStopTransceiverSupported:()=>Voe,isTRTCSupported:()=>Uoe,isUnifiedPlanDefault:()=>Foe,isUsedInHttpProtocol:()=>zh,isWebAudioSupported:()=>N4,isWebCodecSupported:()=>x4,isWebCodecsSupported:()=>R4,isWebRTCSupported:()=>IR,isWebTransportSupported:()=>V4});var A4=vi(Dne(),1),bo={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isWebCodecsSupported:!1,isMediaDevicesSupported:!1,isScreenShareSupported:!1,isSmallStreamSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1}},Noe=new Map([[gr,["Firefox",GA]],[z_,["Edg",$A]],[nS,["Chrome",nR]],[nc,["Safari",ey]],[il,["TBS",KA]],[WC,["XWEB",zA]],[jC&&hg,["WeChat",WA]],[YC,["QQ(Win)",jA]],[j_,["QQ(Mobile)",Y_]],[W_,["QQ(Mobile X5)",Y_]],[JC,["QQ(Mac)",YA]],[XC,["QQ(iPad)",JA]],[ZC,["MI",XA]],[eS,["HW",QA]],[tS,["Samsung",ZA]],[J_,["OPPO",eR]],[X_,["VIVO",tR]],[K_,["EDGE",BA]],[KC,["SogouMobile",HA]],[zC,["Sogou",qA]]]);function Loe(){let r=Noe.get(!0);return{browserName:r?r[0]:"unknown",browserVersion:r?r[1]:"unknown"}}var pR=function(){return!(n4||K_||z_&&ZF<80||gr&&QF<56)},R4=function(){return["VideoDecoder","VideoEncoder","AudioEncoder","AudioDecoder","MediaStreamTrackGenerator"].every(r=>r in window)},gR=function(){if(!navigator.mediaDevices)return zh()||cn.error(ba.NOT_SUPPORTED_MEDIA),!1;let r=["getUserMedia","enumerateDevices"];return r.filter(a=>a in navigator.mediaDevices).length===r.length},w4=!1;function zh(){return location.protocol==="http:"&&!$h&&(w4||cn.error(no({key:jn.NOT_SUPPORTED_HTTP})),w4=!0,!0)}var Poe=function(){return(window==null?void 0:window.OffscreenCanvas)&&(window==null?void 0:window.MediaStreamTrackProcessor)&&(window==null?void 0:window.MediaStreamTrackGenerator)},mR=function(){return Ze(this,null,function*(){if(bo.detail.isH264EncodeSupported&&bo.detail.isVp8EncodeSupported)return{isH264EncodeSupported:bo.detail.isH264EncodeSupported,isVp8EncodeSupported:bo.detail.isVp8EncodeSupported};let r,a=!1,d=!1;try{let g=new RTCPeerConnection,C=document.createElement(Pe.CANVAS);C.getContext("2d");let A=C.captureStream(0);return g.addTrack(A.getVideoTracks()[0],A),r=yield g.createOffer(),r.sdp.toLowerCase().indexOf("h264")!==-1&&(a=!0),r.sdp.toLowerCase().indexOf("vp8")!==-1&&(d=!0),g.close(),bo.detail.isH264EncodeSupported=a,bo.detail.isVp8EncodeSupported=d,{isH264EncodeSupported:bo.detail.isH264EncodeSupported,isVp8EncodeSupported:bo.detail.isVp8EncodeSupported}}catch{return{isH264EncodeSupported:!1,isVp8EncodeSupported:!1}}})},vR=function(){return Ze(this,null,function*(){if(bo.detail.isH264DecodeSupported&&bo.detail.isVp8DecodeSupported)return{isH264DecodeSupported:bo.detail.isH264DecodeSupported,isVp8DecodeSupported:bo.detail.isVp8DecodeSupported};let r,a=!1,d=!1;try{let g=new RTCPeerConnection;return r=yield g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}),r.sdp.toLowerCase().indexOf("h264")!==-1&&(a=!0),r.sdp.toLowerCase().indexOf("vp8")!==-1&&(d=!0),g.close(),{isH264DecodeSupported:a,isVp8DecodeSupported:d}}catch{return{isH264DecodeSupported:!1,isVp8DecodeSupported:!1}}})},_R=function(){return Ze(this,null,function*(){if(bo.result&&bo.detail.isH264EncodeSupported&&bo.detail.isVp8EncodeSupported&&bo.detail.isH264DecodeSupported&&bo.detail.isVp8DecodeSupported)return bo;let r=pR(),a=IR(),d=R4(),g=gR(),{isH264EncodeSupported:C,isVp8EncodeSupported:A}=yield mR(),{isH264DecodeSupported:w,isVp8DecodeSupported:V}=yield vR();if(!C||!A){let U=yield mR();cn.warn("detect encode again h264:".concat(C," vp8:").concat(A," result: ").concat(JSON.stringify(U))),C=U.isH264EncodeSupported,A=U.isVp8EncodeSupported}if(C&&w&&(J_||X_||i4)&&!il&&pg()<79){let{encode:U,decode:j}=yield function(){return Ze(this,null,function*(){return new Promise(re=>Ze(this,null,function*(){let ce={encode:!1,decode:!1},Te=()=>{};try{cn.warn("start detect h264 supported by encoding and decoding canvas stream");let De=document.createElement("canvas"),ze=De.getContext("2d");De.width=640,De.height=480;let _t=setInterval(()=>{ze.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))},33),Ft=-1,$t=-1;Te=()=>{clearInterval(Ft),clearInterval(_t),clearTimeout($t),yn.close(),Rn.close(),bt.getTracks().forEach(Ci=>Ci.stop())},$t=setTimeout(()=>{Te(),re(ce)},3e3);let bt=De.captureStream(),yn=new RTCPeerConnection({}),Rn=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0});yn.addEventListener("icecandidate",Ci=>Rn.addIceCandidate(Ci.candidate)),Rn.addEventListener("icecandidate",Ci=>yn.addIceCandidate(Ci.candidate)),yn.addTrack(bt.getVideoTracks()[0],bt);let Gn=yield yn.createOffer();yield yn.setLocalDescription(Gn),yield Rn.setRemoteDescription(Gn);let Vo=yield Rn.createAnswer(),qo=A4.default.parse(Vo.sdp),Pu=qo.media[0].rtp.findIndex(Ci=>Ci.codec==="H264");qo.media[0].rtp=[qo.media[0].rtp[Pu]],qo.media[0].fmtp=qo.media[0].fmtp.filter(Ci=>Ci.payload===qo.media[0].rtp[0].payload),qo.media[0].rtcpFb&&(qo.media[0].rtcpFb=qo.media[0].rtcpFb.filter(Ci=>Ci.payload===qo.media[0].rtp[0].payload)),Vo.sdp=A4.default.write(qo),yield Rn.setLocalDescription(Vo),yield yn.setRemoteDescription(Vo),Ft=setInterval(()=>Ze(this,null,function*(){ce.encode&&ce.decode&&(Te(),re(ce));let Ci=yield yn.getStats(),xS=yield Rn.getStats();ce.encode||Ci.forEach(ul=>{ul.type==="outbound-rtp"&&ul.mediaType===Pe.VIDEO&&ul.framesEncoded>0&&(ce.encode=!0)}),ce.decode||xS.forEach(ul=>{ul.type==="inbound-rtp"&&ul.mediaType===Pe.VIDEO&&ul.framesDecoded>0&&(ce.decode=!0)})}),500)}catch(De){Te(),cn.warn(De),re(ce)}}))})}();C=U,w=j}return bo.result=r&&a&&g&&(C||A)&&(w||V),bo.detail.isBrowserSupported=r,bo.detail.isWebRTCSupported=a,bo.detail.isWebCodecsSupported=d,bo.detail.isMediaDevicesSupported=g,bo.detail.isScreenShareSupported=lS(),bo.detail.isSmallStreamSupported=cS(),bo.detail.isH264EncodeSupported=C,bo.detail.isVp8EncodeSupported=A,bo.detail.isH264DecodeSupported=w,bo.detail.isVp8DecodeSupported=V,bo.result||cn.error("".concat(navigator.userAgent," ").concat(T4(bo.detail,!1))),yg.setItem(G4,{ua:navigator.userAgent,checkResult:bo}),bo})},Uoe=function(){return bo.result},lS=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},xoe=(r,a,d)=>{location.protocol==="http:"&&!$h&&(r[a]=()=>{throw new An({code:rn.INVALID_OPERATION,message:ba.NOT_SUPPORTED_HTTP})})},ly=function(r){return!(r.type!=="candidate-pair"||!r.nominated||r.state!=="in-progress"&&r.state!=="succeeded")&&!(vs(r.selected)&&!r.selected)};function D4(){let r="";if(screen.width){let a=screen.width?screen.width*window.devicePixelRatio:"",d=screen.height?screen.height*window.devicePixelRatio:"";r+="".concat(a," * ").concat(d)}return r}function O4(){return navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function N4(){let r={isSupported:!1},a=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"];for(let d=0;d<a.length;d++)if(a[d]in window){r.isSupported=!0;break}return r.isSupported}function L4(){return"captureStream"in HTMLCanvasElement.prototype}function cS(){return!(jC||tc||gg&&gg<63)&&!(!pR()||!L4())}var Foe=function(){if(Pt(window.RTCRtpTransceiver)||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let r=null,a=!1;try{r=new RTCPeerConnection({sdpSemantics:F_}),r.addTransceiver(Pe.AUDIO),a=!0}catch{}return r==null||r.close(),a};function uS(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype}function dS(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype}function Mu(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype}function ic(){return oR!==11&&"RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype}var hS=!(!ic()||Q_&&gg<74);function Voe(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype}function P4(){return"RTCRtpSender"in window&&"replaceTrack"in window.RTCRtpSender.prototype}function yR(){return"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype&&dS()}var Ig=window.MediaStreamTrack&&"getSettings"in MediaStreamTrack.prototype,U4=window.MediaStreamTrack&&"getCapabilities"in MediaStreamTrack.prototype,cy="RTCRtpSender"in window&&"createEncodedStreams"in window.RTCRtpSender.prototype&&pg()>=86,IR=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter(r=>r in window).length>0};function x4(){let r={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1};return Pt(window.AudioDecoder)||(r.AudioDecoder=!0),Pt(window.AudioEncoder)||(r.AudioEncoder=!0),Pt(window.VideoDecoder)||(r.VideoDecoder=!0),Pt(window.VideoEncoder)||(r.VideoEncoder=!0),Pt(window.ImageDecoder)||(r.ImageDecoder=!0),r}function F4(){return"mediaSession"in navigator&&!Pt(navigator.mediaSession.setActionHandler)}function V4(){return!Pt(window.WebTransport)}function Goe(){let r={browser:"".concat(Cu.name,"/").concat(Cu.version),os:iR(),displayResolution:D4(),isScreenShareSupported:lS(),isWebRTCSupported:IR(),isGetUserMediaSupported:O4(),isWebAudioSupported:N4(),isWebSocketsSupported:"WebSocket"in window&&window.WebSocket.CLOSING===2,isWebCodecSupported:x4(),isMediaSessionSupported:F4(),isWebTransportSupported:V4()};return navigator.userAgent.includes("miniProgram")&&(r.browser="mini/".concat(r.browser)),r}var G4="checkResult";(function(){zh();let r=yg.getItem(G4);r&&r.ua===navigator.userAgent&&(bo=r.checkResult),_R()})();var Boe=vi(gs(),1),B4=Symbol("instance"),fS=Symbol("cacheResult"),bR=class{constructor(r,a,d){this.oldState=r,this.newState=a,this.action=d,this.aborted=!1}abort(r){this.aborted=!0,dy.call(r,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},CR=class extends Error{constructor(r,a,d){super(a),this.state=r,this.message=a,this.cause=d}},uy=new Map;function yi(r,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(g,C,A)=>{let w=d.action||C;if(!d.context){let U=uy.get(g)||[];uy.has(g)||uy.set(g,U),U.push({from:r,to:a,action:w})}let V=A.value;A.value=function(){let U=this;for(var j=arguments.length,re=new Array(j),ce=0;ce<j;ce++)re[ce]=arguments[ce];if(d.context&&(U=_o.get(typeof d.context=="function"?d.context.call(this,...re):d.context)),U.state===a)return d.sync?U[fS]:Promise.resolve(U[fS]);U.state instanceof bR&&U.state.action==d.abortAction&&U.state.abort(U);let Te=null;Array.isArray(r)?r.length==0?U.state instanceof bR&&U.state.abort(U):(typeof U.state!="string"||!r.includes(U.state))&&(Te=new CR(U._state,"".concat(U.name," ").concat(w," to ").concat(a," failed: current state ").concat(U._state," not from ").concat(r.join("|")))):r!==U.state&&(Te=new CR(U._state,"".concat(U.name," ").concat(w," to ").concat(a," failed: current state ").concat(U._state," not from ").concat(r)));let De=bt=>{if(d.fail&&d.fail.call(this,bt),d.sync){if(d.ignoreError)return bt;throw bt}return d.ignoreError?Promise.resolve(bt):Promise.reject(bt)};if(Te)return De(Te);let ze=U.state,_t=new bR(ze,a,w);dy.call(U,_t);let Ft=bt=>{var yn;return U[fS]=bt,_t.aborted||(dy.call(U,a),(yn=d.success)===null||yn===void 0||yn.call(this,U[fS])),bt},$t=bt=>{let yn=bt instanceof Error?bt.message:String(bt);return dy.call(U,ze,bt),De(new CR(U._state,"action '".concat(w,"' failed :").concat(yn),bt instanceof Error?bt:new Error(yn)))};try{let bt=V.apply(this,re);return function(yn){return typeof yn=="object"&&yn&&"then"in yn}(bt)?bt.then(Ft).catch($t):d.sync?Ft(bt):Promise.resolve(Ft(bt))}catch(bt){return $t(bt)}}}}var $oe=typeof window<"u"&&window.__AFSM__?(r,a)=>{window.dispatchEvent(new CustomEvent(r,{detail:a}))}:typeof importScripts<"u"?(r,a)=>{postMessage({type:r,payload:a})}:()=>{};function dy(r,a){let d=this._state;this._state=r;let g=r.toString();r&&this.emit(g,d),this.emit(_o.STATECHANGED,r,d,a),this.updateDevTools({value:r,old:d,err:a instanceof Error?a.message:String(a)})}var _o=class extends Boe.default{constructor(r,a,d){super(),this.name=r,this.groupName=a,this._state=_o.INIT,r||(r=Date.now().toString(36)),d?Object.setPrototypeOf(this,d):d=Object.getPrototypeOf(this),a||(this.groupName=this.constructor.name);let g=d[B4];g?this.name=g.name+"-"+g.count++:d[B4]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let r=Object.getPrototypeOf(this),a=uy.get(r)||[],d=new Set,g=[],C=[],A=new Set,w=Object.getPrototypeOf(r);uy.has(w)&&(w.stateDiagram.forEach(U=>d.add(U)),w.allStates.forEach(U=>A.add(U))),a.forEach(U=>{let{from:j,to:re,action:ce}=U;typeof j=="string"?g.push({from:j,to:re,action:ce}):j.length?j.forEach(Te=>{g.push({from:Te,to:re,action:ce})}):C.push({to:re,action:ce})}),g.forEach(U=>{let{from:j,to:re,action:ce}=U;A.add(j),A.add(re),A.add(ce+"ing"),d.add("".concat(j," --> ").concat(ce,"ing : ").concat(ce)),d.add("".concat(ce,"ing --> ").concat(re," : ").concat(ce," 🟢")),d.add("".concat(ce,"ing --> ").concat(j," : ").concat(ce," 🔴"))}),C.forEach(U=>{let{to:j,action:re}=U;d.add("".concat(re,"ing --> ").concat(j," : ").concat(re," 🟢")),A.forEach(ce=>{ce!==j&&d.add("".concat(ce," --> ").concat(re,"ing : ").concat(re))})});let V=[...d];return Object.defineProperties(r,{stateDiagram:{value:V},allStates:{value:A}}),V}static get(r){let a;return typeof r=="string"?(a=_o.instances.get(r),a||_o.instances.set(r,a=new _o(r,void 0,Object.create(_o.prototype)))):(a=_o.instances2.get(r),a||_o.instances2.set(r,a=new _o(r.constructor.name,void 0,Object.create(_o.prototype)))),a}static getState(r){var a;return(a=_o.get(r))===null||a===void 0?void 0:a.state}updateDevTools(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$oe(_o.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},r))}get state(){return this._state}set state(r){dy.call(this,r)}};_o.STATECHANGED="stateChanged",_o.UPDATEAFSM="updateAFSM",_o.INIT="[*]",_o.ON="on",_o.OFF="off",_o.instances=new Map,_o.instances2=new WeakMap;var $4=(window==null?void 0:window.requestIdleCallback)||function(r){let a=Date.now();return setTimeout(()=>{r({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-a))})},1e3)},Hoe=(window==null?void 0:window.cancelIdleCallback)||function(r){clearTimeout(r)},qoe=(window==null?void 0:window.cancelAnimationFrame)||(window==null?void 0:window.mozCancelAnimationFrame),SR=class{static generateTaskID(){return this.currentTaskID++}static run(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$_,a=arguments.length>1?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0;d=Pn(r===qC?{delay:2e3,count:0,backgroundTask:!0}:r===dg?{delay:1e4,count:0}:r===PA?{fps:60,delay:16.6,count:0,backgroundTask:!0}:{delay:2e3,count:0,backgroundTask:!0},d),Eu(a)&&(d=Pn(Pn({},d),a)),lr(r)&&(a=r,r=$_);let g=Pn({taskID:this.generateTaskID(),loopCount:0,intervalID:null,timeoutID:null,rafID:null,ricID:null,taskName:r,callback:a},d);return this.taskMap.set(g.taskID,g),this[r](g),g.taskID}static interval(r){return r.intervalID=setInterval(()=>{r.callback(),r.loopCount+=1,this.isBreakLoop(r)},r.delay)}static intervalInWorker(r){r.delay=(1e3/r.fps).toFixed(2);let a=new Worker(URL.createObjectURL(new Blob([`
        let timerID = null;
        self.onmessage = function (e) {
          if (e.data === 'start') {
            timerID = setInterval(() => {
              self.postMessage('tick');
            }, `.concat(r.delay,`);
          } else if (e.data === 'stop') {
            clearInterval(timerID);
          }
        };
      `)],{type:"application/javascript"})));a.onmessage=d=>{d.data==="tick"&&(r.callback(),r.loopCount+=1,this.isBreakLoop(r)&&a.postMessage("stop"))},r.worker=a,a.postMessage("start")}static timeout(r){let a=()=>{if(r.callback(),r.loopCount+=1,!this.isBreakLoop(r))return r.timeoutID=setTimeout(a,r.delay)};return r.timeoutID=setTimeout(a,r.delay)}static ric(r){let a,d=To(),g=()=>{if(a=To()-d,a>=r.delay&&(d=To()-Math.floor(a%r.delay),r.callback(),r.loopCount+=1),!this.isBreakLoop(r))return r.ricID=$4(g,{timeout:r.delay})};return r.ricID=$4(g,{timeout:r.delay})}static raf(r){r.delay=(1e3/r.fps).toFixed(2);let a,d=To(),g=()=>document.hidden&&r.backgroundTask?(a=To()-d,d=To(),r.callback(),r.loopCount+=1,this.isBreakLoop(r)?void 0:r.timeoutID=setTimeout(g,r.delay-Math.floor(a%r.delay))):(a=To()-d,a>=r.delay&&(d=To()-Math.floor(a%r.delay),r.callback(),r.loopCount+=1),this.isBreakLoop(r)?void 0:r.rafID=requestAnimationFrame(g));if(r.rafID=requestAnimationFrame(g),r.backgroundTask){let C=()=>{if(document.hidden){let A=To()-d;A>=r.delay?g():r.timeoutID=setTimeout(g,r.delay-A)}};document.addEventListener("visibilitychange",C),r.onVisibilitychange=C,document.hidden&&C()}return r.taskID}static hasTask(r){return this.taskMap.has(r)}static clearTask(r){if(!this.taskMap.has(r))return!0;let{intervalID:a,timeoutID:d,rafID:g,ricID:C,onVisibilitychange:A,worker:w}=this.taskMap.get(r);return w&&w.terminate(),a&&clearInterval(a),d&&clearTimeout(d),g&&qoe(g),C&&Hoe(C),A&&document.removeEventListener("visibilitychange",A),this.taskMap.delete(r),!0}static isBreakLoop(r){return!this.taskMap.has(r.taskID)||r.count!==0&&r.loopCount>=r.count&&(this.clearTask(r.taskID),!0)}};SR.taskMap=new Map,SR.currentTaskID=1;var Cr=SR,sl={LOADED_DATA:Pe.LOADEDDATA,MEDIA_TRACK_CHANGED:"media-track-changed",PLAYER_STATE_CHANGED:"player-state-changed"},TR={};O_(TR,{create:()=>al,remove:()=>Xi});var hy=new WeakMap;function al(r,a){hy.has(r)||hy.set(r,[]);let d=hy.get(r),g={add:(C,A)=>("addEventListener"in a?(d.push(a.removeEventListener.bind(a,C,A)),a.addEventListener(C,A)):(d.push(a.off.bind(a,C,A)),a.on(C,A)),g)};return g}function Xi(r){let a=hy.get(r);a&&(a.forEach(d=>d()),hy.delete(r))}var fy=class extends _o{constructor(r,a){super(r.id,"".concat(a,"-player")),this.kind=a,_e(this,"id"),_e(this,"element",null),_e(this,"track"),_e(this,"url"),_e(this,"attr"),_e(this,"muted"),_e(this,"_log"),_e(this,"_pausedRetryCount"),_e(this,"_isElementPlayingFired",!1),_e(this,"_interval"),this.id=r.id,this._log=r.log,this.track=r.track,this.muted=r.muted,this._pausedRetryCount=zF,this._state="STOPPED",this.bindTrackEvents(),this._log.info("create ".concat(a,"-player ").concat(this.id))}get isPlaying(){return this._state==="PLAYING"}get isStopped(){return this._state==="STOPPED"}setAttr(r){this.attr=r}setUrl(r){this.track&&(this.unbindTrackEvents(),this.element&&(this.element.srcObject=null),this.track=null),r!==this.url&&(this.url=r,r!==null&&this.element&&(this.element.crossOrigin="anonymous",this.element.src=r))}play(){return Ze(this,null,function*(){if(!this.isPlaying)try{this.bindAutoPlayEvent(),yield this.element.play()}catch(r){let a=no({key:jn.PLAY_FAILED,data:{media:this.kind,error:r}});if(this.track&&!this.track.muted&&this._log.warn(r),a.includes("NotAllowedError"))throw new An({code:rn.PLAY_NOT_ALLOWED,message:a})}})}stop(){this.unbindEvents(),this._isElementPlayingFired=!1,this.element&&(this.element.remove(),this.element.srcObject=null,this.element=null),this.handleStopped(Pe.ENDED),this._interval>0&&Cr.clearTask(this._interval)}pause(){var r;this.isPlaying&&((r=this.element)==null||r.pause())}resume(){return this.isPlaying?Promise.resolve():s4?this.replay():this.play().catch(()=>{})}setMuted(r){this.element&&(this.element.muted=r),this.muted=r}replay(){return this.stop(),this.play().catch(()=>{})}bindElementEvents(){if(this.element){let r=this.handleElementEvent.bind(this);return al(this.element,this.element).add(Pe.PLAYING,r).add(Pe.ENDED,r).add(Pe.PAUSE,r).add(Pe.ERROR,r).add(Pe.LOADEDDATA,r)}}bindTrackEvents(){if(this.track){let r=this.handleTrackEvent.bind(this);TR==null||TR.create(this.track,this.track).add(Pe.ENDED,r).add(Pe.MUTE,r).add(Pe.UNMUTE,r),this.track.readyState===Pe.ENDED&&this.handleTrackEvent({type:Pe.ENDED}),this.track.muted&&this.handleTrackEvent({type:Pe.MUTE})}}bindAutoPlayEvent(){Qt.on(Vt.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}unbindTrackEvents(){this.track&&Xi(this.track)}unbindEvents(){this.element&&Xi(this.element),this.unbindTrackEvents(),Qt.off(Vt.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}handleElementEvent(r){switch(r.type){case Pe.PLAYING:this._isElementPlayingFired=!0,this._log.info("".concat(this.kind," player is playing")),this.handlePlaying(Pe.PLAYING),this._interval&&(Cr.clearTask(this._interval),this._interval=-1);break;case Pe.ENDED:this._log.info("".concat(this.kind," player is ended")),this.handleStopped(Pe.ENDED);break;case Pe.PAUSE:this._log.info("".concat(this.kind," player is paused")),this.handlePaused(Pe.PAUSE),tc&&(this._interval=Cr.run($_,()=>{this.element&&this._state==="PAUSED"&&this.resume()},{delay:3e3}));break;case Pe.ERROR:if(this.element&&this.element.error){let{code:a,message:d}=this.element.error;this._log.error("".concat(this.kind," player error observed. code: ").concat(a," message: ").concat(d," userAgent: ").concat(navigator.userAgent)),Vr.uploadEvent({log:"stat-".concat(this.kind,"-").concat(ec.PLAYER_ERROR,"-").concat(a,"-").concat(navigator.userAgent),error:this.element.error})}break;case Pe.LOADEDDATA:this.kind===Pe.VIDEO&&this.emit(sl.LOADED_DATA)}}handleTrackEvent(r){switch(r.type){case Pe.ENDED:this._log.info("".concat(this.kind," track is ended")),this.handleStopped(Pe.ENDED);break;case Pe.MUTE:this._log.info("".concat(this.kind," track is unable to provide media output")),this.handlePaused(Pe.MUTE);break;case Pe.UNMUTE:this._log.info("".concat(this.kind," track is able to provide media output")),this._isElementPlayingFired&&this.handlePlaying(Pe.UNMUTE)}}handlePlaying(r){this.emit(sl.PLAYER_STATE_CHANGED,{type:this.kind,state:"PLAYING",reason:r})}handlePaused(r){this.emit(sl.PLAYER_STATE_CHANGED,{type:this.kind,state:"PAUSED",reason:r})}handleStopped(r){this.emit(sl.PLAYER_STATE_CHANGED,{type:this.kind,state:"STOPPED",reason:r})}getElement(){return this.element}};mn([yi([],"PLAYING",{sync:!0})],fy.prototype,"handlePlaying"),mn([yi("PLAYING","PAUSED",{ignoreError:!0,sync:!0})],fy.prototype,"handlePaused"),mn([yi([],"STOPPED",{sync:!0})],fy.prototype,"handleStopped");var sc="trtc_autoplay",ER="".concat(sc,"_mask"),bg="".concat(sc,"_wrapper"),H4="".concat(sc,"_header"),MR="".concat(sc,"_content"),pS="".concat(sc,"_action_wrapper"),kR="".concat(sc,"_question"),AR="".concat(sc,"_collapse"),gS="".concat(sc,"_action_confirm"),q4="".concat(sc,"_detail"),K4="#2473E8",RR="dialog",Koe="".concat(RR,"-show"),zoe="".concat(RR,"-1"),Woe="".concat(RR,"-2"),z4=!1,W4=()=>!!document.querySelector(".".concat(bg)),j4="".concat(Fh,"/").concat(Tu()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),Y4="<br><a href='".concat(j4,"' target='_blank'>").concat(Tu()?"其他方案？":"Any other solution?","</a>"),joe="".concat(Tu()?"浏览器自动播放策略：在用户与页面产生交互（点击、触摸）之前，浏览器禁止播放有声媒体。该弹窗用于帮助用户恢复音视频播放。".concat(Y4):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat(Y4)),Yoe=class{constructor(){if(_e(this,"content","音视频播放被浏览器拦截，请点击“恢复播放”。"),_e(this,"_dialogNode",null),_e(this,"_bodyPosition",""),_e(this,"_showDetail",!1),_e(this,"_isCollapseClicked",!1),_e(this,"_isQuestionClicked",!1),Tu()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!z4){let r=document.createElement("style");r.innerHTML=".".concat(ER,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(ER," div:not(.").concat(pS,"){display:block !important;}.").concat(bg,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(bg," a{color:").concat(K4,";}.").concat(H4,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(MR,"{margin:8px 0;}.").concat(pS,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat(AR,"{margin-right:auto;cursor:pointer}.").concat(kR,"{height:100%;line-height:16px;cursor:pointer;}.").concat(gS,"{margin-left:8px;color:#fff;background:").concat(K4,";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(gS,":hover{opacity:0.9;}.").concat(AR,",.").concat(gS,",.").concat(MR,",.").concat(kR,"{font-size:14px;}@media screen and (max-width:750px){.").concat(bg,"{width:80vw;}}"),document.head.appendChild(r),z4=!0}this.addDiaLog()}createDiaLog(){let r=document.createElement("template");r.innerHTML='<div class="'.concat(ER,`"><div class='`).concat(bg,"'><div class='").concat(H4,"'>").concat(location.host,"</div><div class='").concat(MR,"'>").concat(this.content,"</div><div class='").concat(q4,`' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">`).concat(joe,"</div><div class='").concat(pS,"'></div></div></div>").trim();let a=document.createElement("button");a.className=gS,a.innerText=Tu()?"恢复播放":"Resume",a.onclick=this.onConfirm.bind(this);let d=document.createElement("div");d.className=kR,d.innerHTML=`<?xml version="1.0" encoding="UTF-8"?>
    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>
    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>
    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>
    </svg>
    `,d.onclick=this.onQuestionClick.bind(this);let g=document.createElement("div");g.className=AR,g.innerText="".concat(Tu()?"详情 >":"Detail >"),g.onclick=this.onCollapseClick.bind(this);let C=r.content.firstChild,A=C.querySelector(".".concat(pS));return A.appendChild(g),A.appendChild(d),A.appendChild(a),C}addDiaLog(){W4()||(this._dialogNode=this.createDiaLog(),document.body.appendChild(this._dialogNode),this._dialogNode.onclick=this.onConfirm.bind(this),this._dialogNode.querySelector(".".concat(bg)).onclick=r=>r.stopPropagation(),this._bodyPosition=document.body.style.position,document.body.style.position="fixed",cn.info("show autoplay dialog"),Vr.uploadEvent({log:Koe}))}deleteDiaLog(){this._dialogNode&&(document.body.removeChild(this._dialogNode),document.body.style.position=this._bodyPosition,this._dialogNode=null)}onConfirm(){cn.warn("confirm clicked, try resume stream"),Qt.emit(Vt.AUTOPLAY_DIALOG_CLICK_CONFIRM),this.deleteDiaLog()}onCollapseClick(){let r=this._dialogNode.querySelector(".".concat(q4));r.style.visibility="".concat(this._showDetail?"hidden":"visible"),r.style.height="".concat(this._showDetail?0:"fit-content"),this._showDetail=!this._showDetail,this._isCollapseClicked||Vr.uploadEvent({log:zoe}),this._isCollapseClicked=!0}onQuestionClick(){window.open(j4,"_blank"),this._isQuestionClicked||Vr.uploadEvent({log:Woe}),this._isQuestionClicked=!0}},Wh=class extends fy{constructor(r){super(r,Pe.VIDEO),_e(this,"viewMirror",!1),_e(this,"objectFit"),_e(this,"container"),_e(this,"canvas"),this.container=r.container,this.canvas=r.canvas,Pt(r.viewMirror)||(this.viewMirror=r.viewMirror),Pt(r.objectFit)||(this.objectFit=r.objectFit),this.initializeElement()}initializeElement(){var r;let a=document.createElement(Pe.VIDEO);this.track&&(a.srcObject=new MediaStream([this.track])),a.muted=!0,a.setAttribute("id","video_".concat(this.id)),a.setAttribute("style",this.styleAttribute),this.canvas&&this.canvas.setAttribute("style",this.styleAttribute),a.setAttribute("autoplay","autoplay"),a.setAttribute("playsinline","playsinline"),this.element=a,(r=this.container)==null||r.appendChild(this.elementToRender),this.bindElementEvents()}get styleAttribute(){let r="width: 100%; height: 100%; object-fit: ".concat(this.objectFit,";background-color: black;");return this.viewMirror&&(r+="transform: scaleX(-1);"),r}setContainer(r){var a;this.container=r,this.track&&this.elementToRender&&((a=this.container)==null||a.appendChild(this.elementToRender))}bindElementEvents(){let r=super.bindElementEvents();this.handleElementEvent=this.handleElementEvent.bind(this),r&&r.add(Pe.ENTER_PICTURE_IN_PICTURE,this.handleElementEvent).add(Pe.LEAVE_PICTURE_IN_PICTURE,this.handleElementEvent)}handleElementEvent(r){var a;super.handleElementEvent(r);let d=r.type;if(d===Pe.PAUSE&&(this.container&&document.getElementById(this.container.id)||this._log.warn("".concat(this.kind," player has been remove, element ID: ").concat((a=this.container)==null?void 0:a.id)),this._pausedRetryCount>0&&!W4()&&(this._log.info("".concat(this.kind," player auto resume when paused")),this.resume(),this._pausedRetryCount--)),this.viewMirror&&this.element){let g=this.element.style.transform;d===Pe.ENTER_PICTURE_IN_PICTURE?this.element.style.transform=g.replace("scaleX(-1)",""):d===Pe.LEAVE_PICTURE_IN_PICTURE&&!g.includes("scaleX")&&(this.element.style.transform="".concat(g," scaleX(-1)"))}}setCanvas(r){var a,d;this.canvas!==r&&((a=this.canvas)==null||a.remove(),r==null||r.setAttribute("style",this.styleAttribute),this.canvas=r,r&&((d=this.container)==null||d.appendChild(r)))}setAttr(r){let a=Object.assign({autoplay:"autoplay",playsinline:"playsinline",muted:!0},r);a.style=Object.assign({width:"100%",height:"100%"},a.style),super.setAttr(a)}get mirror(){return this.viewMirror}setRect(r,a){this.elementToRender&&(this.elementToRender.style.width="".concat(r,"px"),this.elementToRender.style.height="".concat(a,"px"))}setViewMirror(r){this.elementToRender&&(this.elementToRender.style.transform=r?"scaleX(-1)":""),this.viewMirror=r}setObjectFit(r){this.elementToRender&&(this.elementToRender.style.objectFit="".concat(r)),this.objectFit=r}stop(){var r;super.stop(),(r=this.canvas)==null||r.remove()}play(){return this.element?this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender):this.initializeElement(),super.play()}get elementToRender(){return this.canvas||this.element}setTrack(r){r!==this.track&&(this.unbindTrackEvents(),this.track=r,this.emit(sl.MEDIA_TRACK_CHANGED,r),r!==null&&(this.bindTrackEvents(),this.element&&(this.element.srcObject=new MediaStream([r]),this.element.remove()),this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender)))}getVideoFrame(){if(this.canvas)return this.canvas.toDataURL("image/png");if(!this.element)return"";let r=document.createElement("canvas");return r.width=this.element.videoWidth,r.height=this.element.videoHeight,r.getContext("2d").drawImage(this.element,0,0),r.toDataURL("image/png")}getElement(){return this.element}};function mS(r,a){return Ze(this,null,function*(){if(!r.audioWorklet)return Promise.reject("audioWorklet is not supported");try{yield r.audioWorklet.addModule(a),cn.info("worklet addModule success")}catch(d){throw cn.info("worklet addModule catch error. ".concat(d.message)),d}})}typeof window<"u"&&(window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext);var jh=new window.AudioContext({sampleRate:48e3}),vS=()=>{jh.state==="suspended"?(jh.resume(),document.addEventListener("click",vS)):jh.state==="interrupted"?jh.resume():document.removeEventListener("click",vS)};document.addEventListener("click",vS),jh.onstatechange=()=>{cn.info("context state: ".concat(jh.state)),vS()};var Ta,po,wR,ku=r=>jh,J4=class{constructor(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.countMap=new Map,this.distributionMap=new Map,this.log=cn.createLogger({id:"kv"}),r&&(Qt.on("102",a=>{let{track:d,cost:g}=a;this.addSuccessEvent({key:d.kind===Pe.AUDIO?DR.START_MICROPHONE:OR.START_CAMERA,cost:g})}),Qt.on("103",a=>{let{track:d,error:g}=a;this.addFailedEvent({key:d.kind===Pe.AUDIO?DR.START_MICROPHONE:OR.START_CAMERA,error:g})}))}getReportData(){let r={msg_sdk_basic_info:{uint32_sdk_version:M4(this.version||nl),uint32_terminal_type:15,bytes_device_name:"",bytes_os_version:"",uint32_framework:30,uint32_network_type:0},stats_count:[...this.countMap.entries()].map(a=>{let[d,g]=a;return{uint32_key:d,uint32_count:g}}),stats_distribution:[...this.distributionMap.entries()].map(a=>{let[d,g]=a;return{uint32_key:d,distribution_items:[...g.entries()].map(C=>{let[A,w]=C;return{uint32_item_key:A,uint32_item_value:w}})}})};return this.countMap.clear(),this.distributionMap.clear(),r}clear(){this.countMap.clear(),this.distributionMap.clear()}isEnumKey(r){let a=+String(r).slice(-3);return a>=700&&a<799}isErrorCodeKey(r){let a=+String(r).slice(-3);return a>=600&&a<699}isCountKey(r){let a=+String(r).slice(-3);return a>=0&&a<599}isNumberKey(r){let a=+String(r).slice(-3);return a>=800&&a<899}addCount(r){let{key:a,useUV:d=!1}=r;this.isCountKey(a)?d&&this.countMap.has(a)||this.countMap.set(a,(this.countMap.get(a)||0)+1):this.log.debug("".concat(a," is not count key, last 3 number should be 0~599"))}addEnum(r){let{key:a,value:d,useUV:g=!0}=r;var C;if(!this.isEnumKey(a))return this.log.debug("".concat(a," is not enum key, last 3 number should be 700~799"));if(g&&this.countMap.has(a))return;this.countMap.set(a,(this.countMap.get(a)||0)+1);let A=((C=this.distributionMap)==null?void 0:C.get(a))||new Map;A.set(d,(A.get(d)||0)+1),this.distributionMap.set(a,A)}addNumber(r){let{key:a,value:d,split:g=100,useUV:C=!1}=r;var A;if(!this.isNumberKey(a))return this.log.debug("".concat(a," is not number key, last 3 number should be 800~899"));if(C&&this.countMap.has(a))return;this.countMap.set(a,(this.countMap.get(a)||0)+1);let w=((A=this.distributionMap)==null?void 0:A.get(a))||new Map,V=0;if(si(g))V=Math.floor(d/g);else for(let U=g.length-1;U>0;U--)if(d>g[U]){V=U;break}w.set(V,(w.get(V)||0)+1),this.distributionMap.set(a,w)}addSuccessEvent(r){let{key:a,cost:d,timeKey:g,split:C}=r;if(a&&(this.addEnum({key:a,value:1,useUV:!1}),d)){let A=+String(a).slice(-3);A<800&&A>=700?this.addNumber({key:g||a+100,value:d,split:C}):g||this.log.debug("time stat ignored, ".concat(a))}}addFailedEvent(r){let{key:a,error:d}=r;if(!a)return;let g=rn.UNKNOWN;si(d)?g=d:(!Pt(d.extraCode)||!Pt(d.code))&&(g=d.extraCode||d.code),this.addEnum({key:a,value:0,useUV:!1}),this.addEnum({key:a,value:g,useUV:!1})}},X4=((po=X4||{})[po.enterRoom=500700]="enterRoom",po[po.exitRoom=500701]="exitRoom",po[po.switchRole=500702]="switchRole",po[po.destroy=500703]="destroy",po[po.startLocalAudio=500704]="startLocalAudio",po[po.updateLocalAudio=500705]="updateLocalAudio",po[po.stopLocalAudio=500706]="stopLocalAudio",po[po.startLocalVideo=500707]="startLocalVideo",po[po.updateLocalVideo=500708]="updateLocalVideo",po[po.stopLocalVideo=500709]="stopLocalVideo",po[po.startScreenShare=500710]="startScreenShare",po[po.updateScreenShare=500711]="updateScreenShare",po[po.stopScreenShare=500712]="stopScreenShare",po[po.startRemoteVideo=500713]="startRemoteVideo",po[po.updateRemoteVideo=500714]="updateRemoteVideo",po[po.stopRemoteVideo=500715]="stopRemoteVideo",po[po.muteRemoteAudio=500716]="muteRemoteAudio",po[po.setRemoteAudioVolume=500717]="setRemoteAudioVolume",po),Q4=((Ta=Q4||{})[Ta.AudioMixer=550700]="AudioMixer",Ta[Ta.AIDenoiser=551700]="AIDenoiser",Ta[Ta.VirtualBackground=570700]="VirtualBackground",Ta[Ta.Beauty=571700]="Beauty",Ta[Ta.Watermark=572700]="Watermark",Ta),Z4=(r=>(r[r.AudioMixer=550701]="AudioMixer",r[r.AIDenoiser=551701]="AIDenoiser",r[r.VirtualBackground=570701]="VirtualBackground",r[r.Beauty=571701]="Beauty",r[r.Watermark=572701]="Watermark",r))(Z4||{}),eV=(r=>(r[r.AudioMixer=550702]="AudioMixer",r[r.AIDenoiser=551702]="AIDenoiser",r[r.VirtualBackground=570702]="VirtualBackground",r[r.Beauty=571702]="Beauty",r[r.Watermark=572702]="Watermark",r))(eV||{}),DR=(r=>(r[r.START_MICROPHONE=501700]="START_MICROPHONE",r[r.MICROPHONE_CAHNNELS=501701]="MICROPHONE_CAHNNELS",r[r.MICROPHONE_SAMPLERATE=501702]="MICROPHONE_SAMPLERATE",r))(DR||{}),OR=((wR=OR||{})[wR.START_CAMERA=511700]="START_CAMERA",wR),Joe=new J4(!0),py=new J4(!1),Co=Joe,Cg=class{constructor(){this.pre=new Set,this.next=new Set,this.connectedNodes=new Set}setContext(r){this.context=r,this.node&&r.addMixWeight()}removeContext(){var r;this.node&&((r=this.context)==null||r.reduceMixWeight()),delete this.context}setNode(r){var a;if(!this.node)try{(a=this.context)==null||a.addMixWeight(),this.node=r,this.preNodeReconnect(),this.reconnect(),Co.addSuccessEvent({key:502701})}catch(d){cn.error(d),Co.addFailedEvent({key:502701,error:d})}}deleteNode(){var r;if(this.node)try{this._disconnect(),delete this.node,(r=this.context)==null||r.reduceMixWeight(),this.preNodeReconnect(),Co.addSuccessEvent({key:502702})}catch(a){cn.error(a),Co.addFailedEvent({key:502702,error:a})}}preNodeReconnect(){this.pre.forEach(r=>{r.node?r.reconnect():r.preNodeReconnect()})}connectNext(r){this.next.forEach(a=>r._connect(a.node)||a.connectNext(r))}_connect(r){return!(!this.node||!r)&&(this.node.connect(r),this.connectedNodes.add(r),!0)}_disconnect(){this.connectedNodes.forEach(r=>{var a;return(a=this.node)==null?void 0:a.disconnect(r)}),this.connectedNodes.clear()}reconnect(){this._disconnect(),this.connectNext(this)}pipeTo(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return a.forEach(g=>{this.next.add(g),g.pre.add(this)}),this}},Xoe=class extends Cg{constructor(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:256;super(),this.fftSize=r,this.dataArray=new Uint8Array(0)}setNode(r){r.fftSize=this.fftSize,this.dataArray=new Uint8Array(r.frequencyBinCount),super.setNode(r)}getByteTimeDomainData(){var r;return(r=this.node)==null||r.getByteTimeDomainData(this.dataArray),this.dataArray}get level(){var r;return(r=this.node)==null||r.getByteTimeDomainData(this.dataArray),Math.max(...this.dataArray)/128-1}get timeDomainPathData(){let r=this.getByteTimeDomainData(),a=0,d=0,g="M".concat(a,",").concat(d);for(let C=0;C<r.length;C++)d=r[C]/128*100/2,g+="L".concat(a,",").concat(d),a+=1;return g}},tV=class{constructor(){this.source=new Cg,this.gain=new Cg,this.destination=new Cg}get volume(){var r;return((r=this.gain.node)==null?void 0:r.gain.value)||1}setVolume(r){r!==1?(this.gain.node||this.gain.setNode(this.source.node.context.createGain()),this.gain.node.gain.value=r):this.gain.node&&this.gain.deleteNode()}replaceSource(r){this.source.deleteNode(),this.source.setNode(function(a){let d=oV.get(a);if(d)return d;let g=ku();if(a instanceof HTMLAudioElement)d=g.createMediaElementSource(a);else{if(!(a instanceof MediaStreamTrack))return a;d=g.createMediaStreamSource(new MediaStream([a]))}return oV.set(a,d),d}(r))}get track(){var r;return(r=this.stream)==null?void 0:r.getAudioTracks()[0]}get stream(){var r;return(r=this.destination.node)==null?void 0:r.stream}},nV=class extends tV{constructor(r){super(),this.context=r,this.denoiser=new Cg,this.source.pipeTo(this.denoiser.pipeTo(this.gain.pipeTo(this.destination)))}connect(){this.context.inputs.has(this)||(this.destination.setNode(this.context.destination),this.source.setContext(this.context),this.denoiser.setContext(this.context),this.gain.setContext(this.context),this.context.inputs.add(this))}disconnect(){!this.context.inputs.has(this)||(this.destination.deleteNode(),this.source.removeContext(),this.denoiser.removeContext(),this.gain.removeContext(),this.context.inputs.delete(this))}remove(){this.gain.deleteNode(),this.denoiser.deleteNode(),this.source.deleteNode(),this.disconnect()}setVolume(r){r!==1?(this.gain.node||this.gain.setNode(this.context.audioContext.createGain()),this.gain.node.gain.value=r):this.gain.node&&this.gain.deleteNode()}},Qoe=class{constructor(){this.audioContext=ku(),this.destination=this.audioContext.createMediaStreamDestination(),this.inputs=new Set,this.mixWeight=0,this.destination.channelCount=1}addMixWeight(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.mixWeight+=r,this.mixWeight-1==r+1>>1&&this.mixOnChange()}reduceMixWeight(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.addMixWeight(-r)}close(){this.inputs.forEach(r=>r.remove())}get mixTrack(){return this.destination.stream.getAudioTracks()[0]}},oV=new WeakMap,Sg=class{constructor(r){_e(this,"_volume",0),_e(this,"_log"),_e(this,"_scriptProcessorNode",null),_e(this,"_audioWorkletNode",null),_e(this,"_interval",200),_e(this,"ready",this.preload());let{log:a}=r;this._log=a,Qt.on(Vt.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}get node(){return this._audioWorkletNode||this._scriptProcessorNode}preload(){return Sg.workletReady||(Sg.workletReady=mS(Sg.audioContext,URL.createObjectURL(new Blob(['class VolumeMeter extends AudioWorkletProcessor{constructor(){super(),this.volume=0,this.intervalTime=200,this.tick=this.intervalTime,this.isStop=!1,this.port.onmessage=t=>{let{data:e}=t;switch(e.name){case"setIntervalTime":this.intervalTime=e.intervalTime;break;case"stop":this.isStop=!0}}}process(t){let e=t[0];if(this.isStop)return!1;if(e.length>0){let i=e[0],s=0;for(let l=0;l<i.length;++l)s=Math.max(Math.abs(i[l]),s);this.volume=s,this.tick-=i.length,this.tick<0&&(this.tick+=this.intervalTime/1e3*sampleRate,this.port.postMessage({volume:this.volume}))}return!0}}registerProcessor("volume-meter",VolumeMeter);'],{type:"application/javascript"})))),Sg.workletReady.then(()=>this.initAudioWorklet()).catch(()=>this.initScriptProcessor())}initAudioWorklet(){if(!this._audioWorkletNode)try{this._audioWorkletNode=new AudioWorkletNode(Sg.audioContext,"volume-meter"),this._audioWorkletNode.port.onmessage=r=>{this._volume=r.data.volume||0},this.handleAudioLevelInterval({interval:this._interval})}catch(r){Vr.logFailedEvent({userId:this._log.userId,eventType:ec.LOAD_WORKLET,error:r}),this.initScriptProcessor()}}initScriptProcessor(){if(!this._scriptProcessorNode)try{this._scriptProcessorNode=ku().createScriptProcessor(2048,1,1),this._scriptProcessorNode.onaudioprocess=r=>{let a=r.inputBuffer.getChannelData(0),d=0;for(let g=0;g<a.length;++g)d+=a[g]*a[g];this._volume=Math.sqrt(d/a.length)||0}}catch(r){this._log.error("volumeMeter init script processor error: ".concat(r))}}destroy(){this._scriptProcessorNode&&(this._scriptProcessorNode.onaudioprocess=null),this._audioWorkletNode&&(this._audioWorkletNode.port.postMessage({name:"stop"}),this._audioWorkletNode.port.onmessage=null),this._audioWorkletNode=null,this._scriptProcessorNode=null,Qt.off(Vt.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}getInternalAudioLevel(){return this._volume}getCalculatedVolume(){return parseFloat(this._volume.toFixed(2))}handleAudioLevelInterval(r){var a;let{interval:d}=r;this._interval=d,(a=this._audioWorkletNode)==null||a.port.postMessage({name:"setIntervalTime",intervalTime:d})}},NR=Sg;_e(NR,"audioContext",ku()),_e(NR,"workletReady");var Zoe=class extends Cg{constructor(r){super(),_e(this,"_volumeMeter"),this._volumeMeter=new NR(r)}deleteNode(){this._volumeMeter.destroy(),super.deleteNode()}init(){return Ze(this,null,function*(){yield this._volumeMeter.preload(),this.setNode(this._volumeMeter.node)})}getCalculatedVolume(){return this._volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this._volumeMeter.getInternalAudioLevel()}},ere=vi(gs(),1),rV=r=>a=>a.deviceId===r,LR=class{constructor(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Input";_e(this,"kind"),_e(this,"type"),_e(this,"devices",[]),this.kind=r,this.type=a}update(r,a){let d=r.filter(g=>g.kind==="".concat(this.kind).concat(this.type.toLocaleLowerCase()));this.devices.length===1&&gy(this.devices[0])||a&&(d.forEach(g=>{if(g.deviceId&&!this.devices.find(rV(g.deviceId))){let C="".concat(this.kind).concat(this.type,"Added");cn.warn("".concat(C,": ").concat(JSON.stringify(g))),a.emit(C,g)}}),this.devices.forEach(g=>{if(g.deviceId&&!d.find(rV(g.deviceId))){let C="".concat(this.kind).concat(this.type,"Removed");cn.warn("".concat(C,": ").concat(JSON.stringify(g))),a.emit(C,g)}})),this.devices=d}hasDevice(r){return!!this.devices.find(a=>a.deviceId===r)}},tre=class extends ere.EventEmitter{constructor(){super(),_e(this,"audioInputs",new LR(Pe.AUDIO)),_e(this,"videoInputs",new LR(Pe.VIDEO)),_e(this,"audioOutputs",new LR(Pe.AUDIO,"Output")),this.init(),navigator.mediaDevices&&(navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",()=>this.update()),"ondevicechange"in navigator.mediaDevices||Cr.run(qC,()=>{this.update()},{delay:1e4}))}init(){PR().then(r=>{this.audioInputs.update(r),this.videoInputs.update(r),this.audioOutputs.update(r)})}update(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){let d=yield PR(a);return r.audioInputs.update(d,r),r.videoInputs.update(d,r),r.audioOutputs.update(d,r),r}()})}},Ii=SA||FC?null:new tre;function gy(r){return r.deviceId===r.groupId&&r.groupId===""}function PR(){return Ze(this,arguments,function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){if(zh()||!gR())return[];let a=yield navigator.mediaDevices.enumerateDevices();if(r!==0){let d={audio:!1,video:!1};if(a.forEach(g=>{gy(g)&&(g.kind===Pe.AUDIO_INPUT?d.audio=!0:g.kind===Pe.VIDEO_INPUT&&(d.video=!0))}),r===2&&(d.audio=!1),r===1&&(d.video=!1),d.audio||d.video){let g;try{g=yield navigator.mediaDevices.getUserMedia(d)}catch(C){cn.debug("capture before getDevices failed: ",C)}a=yield navigator.mediaDevices.enumerateDevices(),g==null||g.getTracks().forEach(C=>C.stop())}}return a.map((d,g)=>{let C={kind:d.kind,deviceId:d.deviceId,groupId:d.groupId,label:d.label||"".concat(d.kind,"_").concat(g)};return d.deviceId.length>0&&UR.add("".concat(d.deviceId,"_").concat(d.kind)),d.getCapabilities&&(C.getCapabilities=()=>d.getCapabilities()),C})}()})}function ac(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Ii.update(r?1:0).then(a=>a.audioInputs.devices)}function Au(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Ii.update(r?2:0).then(a=>a.videoInputs.devices)}var iV=!1;function Tg(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Ze(this,null,function*(){return Ii.update(r?1:0).then(a=>a.audioOutputs.devices)})}var UR=new Set;function sV(r,a){return Ze(this,null,function*(){let d=(yield ac()).find(g=>g.deviceId===V_);return(d==null?void 0:d.groupId)===r&&d.label===a})}var nre=class extends tV{constructor(r){super(),this.log=r,_e(this,"volumeMeter"),_e(this,"analyser",new Xoe),this.volumeMeter=new Zoe({log:this.log})}destory(){this.gain.deleteNode(),this.volumeMeter.deleteNode(),this.analyser.deleteNode(),this.source.deleteNode(),this.destination.deleteNode()}},xR=class extends fy{constructor(r){super(r,Pe.AUDIO),_e(this,"_outputDeviceId"),_e(this,"_volume",1),_e(this,"_destination",ku().createMediaStreamDestination()),_e(this,"pipeline"),_e(this,"volumeMeterMode","worklet"),this.pipeline=new nre(this._log)}getMediaStream(){return this.pipeline.stream||(this.track?new MediaStream([this.track]):null)}initializeElement(){if((bu==="15.2"||bu==="15.3"||bu==="15.4")&&this.muted)return void this._log.info("audioElement is muted.");let r=new Audio;r.setAttribute("autoplay","autoplay"),r.srcObject=this.getMediaStream(),r.muted=this.muted,this.element=r,this.bindElementEvents()}play(){return Ze(this,null,function*(){if(this.track)return this.pipeline.source.node||this.pipeline.replaceSource(this.track),this.element||this.initializeElement(),this._outputDeviceId&&(yield this.setSinkId(this._outputDeviceId)),this.volumeMeterMode==="worklet"?this.pipeline.volumeMeter.init():this.volumeMeterMode==="analyser"&&this.pipeline.analyser.setNode(ku().createAnalyser()),this.setVolume(this._volume),function(){Ze(this,null,function*(){try{iV||(iV=!0,cn.info("speakers:".concat((yield Tg()).map(r=>" ".concat(r.deviceId.slice(0,8),": ").concat(r.label)))))}catch{}})}(),Ia(xR.prototype,this,"play").call(this)})}stop(){this.pipeline.destory(),super.stop()}setSinkId(r){return Ze(this,null,function*(){var a,d;this._outputDeviceId!==r&&(this._outputDeviceId=r),this.element&&this.element.sinkId!==r&&(yield(d=(a=this.element).setSinkId)==null?void 0:d.call(a,r))})}get useDestination(){return!!this.pipeline.stream}setLoop(r){!this.element||(this.element.loop=r)}getAudioLevel(){return this.pipeline.volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this.pipeline.volumeMeter.getInternalAudioLevel()}},ore=class extends xR{constructor(r){super(r),this.pipeline.source.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination)}setTrack(r){this.track!==r&&(this.unbindTrackEvents(),this.track=r,this.emit(sl.MEDIA_TRACK_CHANGED,r),r?(this.bindTrackEvents(),this.pipeline.replaceSource(r),!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([r]))):this.pipeline.source.deleteNode())}setSourceNode(r){!r||this.pipeline.source.node===r||(this.pipeline.replaceSource(r),r instanceof MediaStreamAudioSourceNode?this.pipeline.destination.setNode(this._destination):this.pipeline.destination.deleteNode(),this.element&&(this.element.srcObject=this.getMediaStream(),this.element.play().catch(()=>{}),this.setVolume(this._volume)))}setVolume(r){this._volume=r,this.element&&(this.element.volume=r)}},rre=class extends xR{constructor(r){super(r),_e(this,"_sourceElement"),this.pipeline.source.pipeTo(this.pipeline.gain.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination))}setTrack(r){this.track!==r&&(this.unbindTrackEvents(),this.track=r,this.emit(sl.MEDIA_TRACK_CHANGED,r),r?(this.bindTrackEvents(),this._sourceElement?this._sourceElement.srcObject=new MediaStream([r]):!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([r])),this.pipeline.replaceSource(r)):this.pipeline.source.deleteNode())}setVolume(r){this._volume=r,this.useDestination?(this.pipeline.setVolume(r),this._log.info("set pipeline volume: ".concat(r))):r<=1?(this.element?this._log.info("set element volume: ".concat(r)):this._log.info("set element volume: no element"),this.element&&(this.element.volume=r)):(this._log.info("start set pipeline volume: ".concat(r)),this.pipeline.setVolume(r),this.element&&!this._sourceElement&&(this.pipeline.destination.setNode(this._destination),Xi(this.element),this._sourceElement=this.element,this._sourceElement.muted=!0,this.element=null,this.play()))}stop(){this.pipeline.destory(),this._sourceElement&&(this._sourceElement.srcObject=null,delete this._sourceElement),super.stop()}},FR=class extends _o{constructor(r){let{userId:a,sdkAppId:d,mediaType:g,room:C,PlayerClass:A=g===1?rre:Wh}=r;var w;super(),_e(this,"id",k4()),_e(this,"userId",""),_e(this,"isRemote"),_e(this,"mediaType"),_e(this,"room"),_e(this,"user"),_e(this,"_log"),_e(this,"_inputTrack"),_e(this,"_outputTrack"),_e(this,"isPlayCalled"),_e(this,"container",null),_e(this,"player"),_e(this,"subVideoPlayerMap"),_e(this,"muted",!1),_e(this,"abortCtrl"),_e(this,"objectFit","cover"),_e(this,"mirror"),_e(this,"isScreen",!1),_e(this,"manager"),_e(this,"trackSettings"),this.userId=a||"",this.mediaType=g,this._log=cn.createLogger({id:"".concat(this.kind[0],"t"),userId:(w=C||this.room)==null?void 0:w.userId,remoteUserId:this instanceof wu?void 0:this.userId,sdkAppId:d,type:this.mediaType===2?"auxiliary":"main",isLocal:this instanceof wu}),this.player=new A({id:this.userId||this.id,track:null,muted:!1,container:null,log:this.log}),this.player.on(sl.PLAYER_STATE_CHANGED,V=>{Qt.emit(Vt.PLAYER_STATE_CHANGED,Pn({track:this},V)),this.emit("player-state-changed",V)}),this.kind===Pe.VIDEO&&(this.player.on(sl.LOADED_DATA,()=>{Qt.emit(Vt.VIDEO_LOADED_DATA,{track:this})}),this.player.on(sl.MEDIA_TRACK_CHANGED,V=>{var U;(U=this.subVideoPlayerMap)==null||U.forEach(j=>j.setTrack(V))}))}get log(){return this._log||cn}get kind(){return this.mediaType===1?Pe.AUDIO:Pe.VIDEO}get strMediaType(){return this.mediaType===4?Pe.VIDEO:this.mediaType===2?Pe.SCREEN:Pe.AUDIO}get streamType(){return 2&this.mediaType?"auxiliary":"main"}play(r,a){return Ze(this,null,function*(){let d=_i(r)?r[0]:r;if(this.isPlayCalled)return this.log.info("play update options: ".concat(JSON.stringify(a))),a&&!Pt(a.muted)&&this.setPlayerMute(a.muted),a&&!Pt(a.objectFit)&&(this.objectFit=a.objectFit),void(this.player instanceof Wh&&(this.player.setObjectFit(this.objectFit),this.container!==d&&d&&(this.container=d,this.player.setContainer(d)),_i(r)&&r.length>=1&&(yield this.playSubContainer(r.slice(1),a))));if(a&&!Pt(a.muted)?this.setPlayerMute(a.muted):(!this.isRemote||this.kind===Pe.VIDEO)&&this.setPlayerMute(!0),a&&!Pt(a.objectFit)&&(this.objectFit=a.objectFit),this.player instanceof Wh&&this.player.setObjectFit(this.objectFit),this.isPlayCalled=!0,d&&(this.container=d,this.player instanceof Wh&&this.player.setContainer(d)),Qt.emit(Vt.PLAY_TRACK_START,{track:this}),this._outputTrack){this._log.info("play with options: ".concat(JSON.stringify(a)));try{this.player.setTrack(this.playerMediaTrack),yield this.player.play(),_i(r)&&r.length>1&&(yield this.playSubContainer(r.slice(1),a))}catch(g){throw this.handleAutoPlayFailed(),this.emit("error",g),g}}else this.log.info("play has not mediaTrack, abort")})}setMirror(r,a){if(this.isScreen||this.kind!==Pe.VIDEO||Pt(r)||r===this.mirror)return;this.mirror=r;let d=this.player;a&&(d=a);let g=this.manager;if(vs(this.mirror))return d.setViewMirror(this.mirror),void(g&&(g.mirror=!1));switch(this.mirror){case"view":g&&(g.mirror=!1),d.setViewMirror(!0);break;case"publish":g&&(g.mirror=!0),d.setViewMirror(!0);break;case"both":g&&(g.mirror=!0),d.setViewMirror(!1)}}playSubContainer(r,a){return Ze(this,null,function*(){if(!this._outputTrack||this.kind===Pe.AUDIO)return;this.subVideoPlayerMap||(this.subVideoPlayerMap=new Map),this.subVideoPlayerMap.forEach((g,C)=>{var A;r.find(w=>C===w)||(g.stop(),(A=this.subVideoPlayerMap)==null||A.delete(C))});for(let[g,C]of r.entries()){let A=this.subVideoPlayerMap.get(C);A?a&&(Pt(a.objectFit)||A.setObjectFit(a.objectFit)):this.subVideoPlayerMap.set(C,new Wh({id:this.userId||this.id,track:this.playerMediaTrack,container:C,muted:this.player.muted,objectFit:this.objectFit,log:this.log.createChild({id:"vp-sub".concat(g+1)})}))}let d=[...this.subVideoPlayerMap.values()];for(let g of d)g.setViewMirror(this.player.mirror),yield g.play()})}setAudioOutput(r){return this.player.setSinkId(r)}setAudioVolume(r){this.player.setVolume(r)}getAudioLevel(){return this.player.getAudioLevel()||0}getInternalAudioLevel(){var r;return((r=this.player)==null?void 0:r.getInternalAudioLevel())||0}stop(){!this.isPlayCalled||(this.isPlayCalled=!1,this.player&&(this.log.info("stop ".concat(this.kind," player")),this.player.stop()),this.subVideoPlayerMap&&this.subVideoPlayerMap.size>0&&this.subVideoPlayerMap.forEach(r=>{r.stop()}),this.container=null)}resume(){return Ze(this,null,function*(){var r;!this.isPlayCalled||(yield(r=this.player)==null?void 0:r.resume())})}close(){this.log.info("close"),this.isPlayCalled&&this.stop()}setMute(r){this.muted=r,this._inputTrack&&(this._inputTrack.enabled=!r),this._outputTrack&&(this._outputTrack.enabled=!r),this.emit(r?"mute":"unmute",this),Qt.emit(r?Vt.TRACK_MUTED:Vt.TRACK_UNMUTED,{track:this})}setPlayerMute(r){this.player.setMuted(r)}get mediaTrack(){return this._inputTrack||null}get outMediaTrack(){return this._outputTrack||null}get playerMediaTrack(){return this.outMediaTrack}setInputMediaStreamTrack(r){var a;let d=this._inputTrack;if(r!==d)return this._inputTrack=r,this.trackSettings=(a=r.getSettings)==null?void 0:a.call(r),r.enabled=!this.muted,this.emit("input-media-track-changed",r||null,d||null),this.manager?this.manager.changeInput(this):this.setOutputMediaStreamTrack(r)}setOutputMediaStreamTrack(r){var a;r!==this._outputTrack&&(this.isRemote?this.log.debug("setOutputMediaStreamTrack",r.label):this.log.info("setOutputMediaStreamTrack",(a=r.getSettings)==null?void 0:a.call(r).deviceId,r.label),this._outputTrack=r,this.updatePlayingState(!!r),this.emit("output-media-track-changed",r))}setMediaType(r){this.mediaType=r}updatePlayingState(r){if(this.isPlayCalled){if(r){if(this.player.setTrack(this.playerMediaTrack),this.player.isStopped)return this.player.play().catch(()=>this.handleAutoPlayFailed()),void this.log.info("playing state updated, play ".concat(this.kind))}else if(!this.player.isStopped)return this.player.stop(),void this.log.info("playing state updated, stop ".concat(this.kind))}this.log.debug("updatePlayingState abort ".concat(this.isPlayCalled," ").concat(r," ").concat(this.player.isStopped))}handleAutoPlayFailed(){if(this.room&&this.room.enableAutoPlayDialog)new Yoe;else{let r=()=>{this.resume().then(()=>{document.removeEventListener("click",r,!0),document.removeEventListener("touchstart",r,!0)})};document.addEventListener("click",r,!0),document.addEventListener("touchstart",r,!0)}}getVideoFrame(){return this.player instanceof Wh?this.player.getVideoFrame():""}};mn([yi([],_o.INIT,{sync:!0})],FR.prototype,"close");var ire=Object.prototype.hasOwnProperty,Ru=function(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(oc(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let a in r)if(ire.call(r,a))return!1;return!0}return!1},sre=ty({retryFunction:function(r){return Ze(this,null,function*(){let a=function(A){return{audio:are(A),video:lre(A)}}(r);cn.info("getUserMedia with constraints: ".concat(JSON.stringify(a)));let d=[],g=[],C=["label","deviceId"];a.audio&&(d=yield ac(),cn.info("microphones: ".concat(rc(d,{keysToInclude:C})))),a.video&&(g=yield Au(),cn.info("cameras: ".concat(rc(g,{keysToInclude:C}))));try{let A=yield navigator.mediaDevices.getUserMedia(a);return U4&&A.getTracks().forEach(w=>{cn.info("".concat(w.kind," capabilities: ").concat(rc(w.getCapabilities(),{keysToInclude:UA})))}),A}catch(A){let{message:w}=A;throw A.name==="NotFoundError"&&(r.video&&g&&g.length===0&&(w=no({key:jn.CAMERA_NOT_FOUND})),r.audio&&d&&d.length===0&&(w=no({key:jn.MICROPHONE_NOT_FOUND}))),new An({code:rn.INITIALIZE_FAILED,name:A.name,message:w,constraint:A.constraint})}})},settings:{retries:3,timeout:500},onError:r=>{let{error:a,retry:d,reject:g,retryFuncArgs:C,retriedCount:A}=r,w=A+1;a.name==="NotReadableError"||a.name==="OverconstrainedError"?(w===1?C[0].video&&(C[0].maxResolution=!1,C[0].frameRate&&(C[0].frameRate=C[0].frameRate>10?10:5)):w===2?C[0].useDeviceIdOnly=!0:w===3&&!C[0].useExactDeviceId&&(C[0].useTrueAsConstraint=!0),d()):g(a),C[0].microphoneId&&aV(C[0].microphoneId,!1),C[0].cameraId&&aV(C[0].cameraId,!0)},onRetrying:r=>{cn.warn("getUserMedia NotReadableError observed, retrying [".concat(r,"/3]"))},onRetryFailed:r=>{Vr.logFailedEvent({eventType:ec.GET_USER_MEDIA_RETRY,error:r})},onRetrySuccess:r=>{Vr.logSuccessEvent({eventType:ec.GET_USER_MEDIA_RETRY}),Vr.uploadEvent({log:"stat-".concat(ec.GET_USER_MEDIA_RETRY,"-success-").concat(r)})}});function aV(r,a){return Ze(this,null,function*(){let d=(a?yield Au():yield ac()).find(g=>g.deviceId===r);d&&lr(d.getCapabilities)&&cn.warn(rc(d.getCapabilities(),{keysToInclude:UA}))})}function are(r){if(!r.audio)return!1;if(r.useTrueAsConstraint)return!0;let a={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:r.sampleRate};return!Ru(r.microphoneId)&&(a.deviceId=r.useExactDeviceId?{exact:r.microphoneId}:r.microphoneId,r.useDeviceIdOnly)?a:(si(r.channelCount)&&(a.channelCount=r.channelCount),vs(r.echoCancellation)&&!r.echoCancellation&&(a.echoCancellation=!1),vs(r.noiseSuppression)&&!r.noiseSuppression&&(a.noiseSuppression=!1),vs(r.autoGainControl)&&!r.autoGainControl&&(a.autoGainControl=!1),!!Ru(a)||a)}function lre(r){if(!r.video)return!1;if(r.useTrueAsConstraint)return!0;let{maxResolution:a=!0}=r,d={};return r.cameraId?d.deviceId=r.useExactDeviceId?{exact:r.cameraId}:r.cameraId:r.facingMode&&(d.facingMode=r.facingMode),r.useDeviceIdOnly&&!Ru(d)?d:(r.width&&(d.width={ideal:r.width},a&&!gr&&(d.width.max=r.width)),r.height&&(d.height={ideal:r.height},a&&!gr&&(d.height.max=r.height)),gr&&Bh&&r.width&&r.height&&r.width*r.height<101376&&(d.width=r.width,d.height=r.height),r.frameRate&&(d.frameRate=r.frameRate),!!Ru(d)||d)}var cre=sre;function lV(r){return cr((a,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return Ze(this,null,function*(){return yield r.apply(this,C),a.apply(this,C)})})}function cV(r){return cr((a,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return Ze(this,null,function*(){return r.call(this,a.apply(this,C))})})}function cr(r){return function(a,d,g){return g.value=r(g.value,d),g}}var ure=(()=>{let r=!1,a=document.visibilityState;return()=>{document.visibilityState!==a&&cn.info("visibility change: ".concat(document.visibilityState)),!r&&(document.addEventListener("visibilitychange",()=>{cn.info("visibility change: ".concat(document.visibilityState)),a=document.visibilityState}),r=!0)}})(),dre=0,uV=class{constructor(){this.log=cn.createLogger({id:"fq".concat(++dre)}),this.isRunning=!1,this.queue=[]}get length(){return this.queue.length}get lastQueueItem(){return this.length===0?null:this.queue[this.length-1]}push(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var d,g;let C=Pn({},r),A=new Promise((w,V)=>{C.resolve=w,C.reject=V});return C.promise=A,a?this.length<=1?this.queue.push(C):(g=(d=this.lastQueueItem)==null?void 0:d.promise)==null||g.then(C.resolve,C.reject):this.queue.push(C),this.log.debug("push ".concat(this.length)),this.isRunning||this.callNext(),A}shift(){let r=this.queue.shift();return this.log.debug("shift ".concat(this.length)),r}callNext(){if(this.isRunning||this.length===0)return;this.log.debug("callNext ",this.length);let{fn:r,args:a,context:d,resolve:g,reject:C}=this.queue[0];this.isRunning=!0,r.apply(d,a).then(g,C).finally(()=>{this.isRunning=!1,this.shift(),this.callNext()})}},vy=new WeakMap,_S=new WeakMap;function Eg(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return function(a,d,g){let C=g.value;return g.value=function(){let A=vy.get(this)||new uV;for(var w=arguments.length,V=new Array(w),U=0;U<w;U++)V[U]=arguments[U];return vy.set(this,A),A.push({fn:C,args:V,context:this},r)},g}}function dV(r){return function(a,d,g){let C=g.value;return g.value=function(){var A,w,V;let U=[];for(var j=arguments.length,re=new Array(j),ce=0;ce<j;ce++)re[ce]=arguments[ce];return(w=(A=vy.get(this))==null?void 0:A.queue)==null||w.forEach(Te=>U.push(Te)),(V=_S.get(this))==null||V.forEach(Te=>Te==null?void 0:Te.queue.forEach(De=>U.push(De))),U.forEach(Te=>{Te.reject(new An({code:rn.API_CALL_ABORTED,message:r}))}),vy.delete(this),_S.delete(this),C.apply(this,re)},g}}function yS(r){return function(a,d,g){let C=g.value,A=w=>r(...w);return g.value=function(){for(var w=arguments.length,V=new Array(w),U=0;U<w;U++)V[U]=arguments[U];let j=_S.get(this)||new Map,re=j.get(A(V))||new uV;return j.set(A(V),re),_S.set(this,j),re.push({fn:C,args:V,context:this})},g}}var wu=class extends FR{constructor(r,a){super({mediaType:r,PlayerClass:a}),_e(this,"isRemote",!1),_e(this,"deviceId"),_e(this,"groupId",""),_e(this,"label",""),_e(this,"_isRecapturing",!1),_e(this,"_lastRecaptureTime",0),_e(this,"_onMuteTimeoutId",-1),_e(this,"profile"),this.onTrackMuted=this.onTrackMuted.bind(this),this.onTrackUnmuted=this.onTrackUnmuted.bind(this),this.onTrackEnded=this.onTrackEnded.bind(this)}get isPublished(){return this.state==="publish"}installTrackEvent(r){al(r,r).add(Pe.MUTE,this.onTrackMuted).add(Pe.UNMUTE,this.onTrackUnmuted).add(Pe.ENDED,this.onTrackEnded),r.muted&&this.onTrackMuted(),r.readyState===Pe.ENDED&&this.onTrackEnded()}uninstallTrackEvent(r){Xi(r)}setStateToCapture(){}capture(r){return Ze(this,null,function*(){var a;try{let d,g=To();Qt.emit(Vt.LOCAL_TRACK_CAPTURE_START,{track:this}),r.customSource?(d=new MediaStream,d.addTrack(r.customSource)):((a=this.mediaTrack)==null||a.stop(),d=yield cre(r));let C=d.getTracks()[0];return yield this.setInputMediaStreamTrack(C),r.customSource||(this.updateDeviceIdInUse(),this.listenDeviceChange()),Qt.emit(Vt.LOCAL_TRACK_CAPTURE_SUCCESS,{track:this,cost:To()-g}),d}catch(d){throw Qt.emit(Vt.LOCAL_TRACK_CAPTURE_FAILED,{track:this,error:d}),this.log.error("getUserMedia error observed ".concat(d)),d}})}setInputMediaStreamTrack(r){this.state===_o.INIT&&this.setStateToCapture(),this._inputTrack&&this.uninstallTrackEvent(this._inputTrack);let a=super.setInputMediaStreamTrack(r);return this.installTrackEvent(r),a}setOutputMediaStreamTrack(r){var a;return super.setOutputMediaStreamTrack(r),(a=this.room)==null?void 0:a.replaceTrack(this)}publish(r,a){return this.room=r,this.emit("4",{mediaType:this.strMediaType,state:"starting",prevState:"stopped"}),this.userId=r.userId,this._log.setUserId(r.userId),this._log.setSdkAppId(r.sdkAppId),a}unpublish(){this.room&&this.room.localTracks.delete(this),Qt.emit(Vt.LOCAL_TRACK_UNPUBLISHED,{track:this})}updateDeviceIdInUse(){return Ze(this,null,function*(){if(this.mediaTrack&&Ig){let{deviceId:r,groupId:a}=this.mediaTrack.getSettings(),{label:d}=this.mediaTrack;(yield function(g){return Ze(this,arguments,function(C){let{newDeviceId:A,oldDeviceId:w,oldGroupId:V,oldLabel:U,kind:j}=C;return function*(){return A===w&&(j!==Pe.AUDIO||A!==V_||(yield sV(V,U)))}()})}({newDeviceId:r,oldDeviceId:this.deviceId,oldGroupId:this.groupId,oldLabel:this.label,kind:this.kind}))||(this.deviceId=r,this.label=d,a&&(this.groupId=a),PR().then(g=>{let C=g.find(A=>A.deviceId===r);C&&this.emit("2",C)}))}})}setProfile(r){this.log.info("setProfile",r),Object.assign(this.profile,r)}isNeedToRecapture(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!(!this.deviceId||!this.mediaTrack||this.kind===Pe.AUDIO&&!function(a){if(a instanceof CanvasCaptureMediaStreamTrack||!(a instanceof MediaStreamTrack))return!1;let d=a.label.toLocaleLowerCase();if(d.includes("mic")||d.includes("麦克风"))return!0;let g="".concat(((a==null?void 0:a.getSettings())||{}).deviceId,"_").concat(Pe.AUDIO_INPUT);return!!UR.has(g)}(this.mediaTrack)||this.kind===Pe.VIDEO&&!function(a){if(a instanceof CanvasCaptureMediaStreamTrack||!(a instanceof MediaStreamTrack))return!1;let d=a.label.toLocaleLowerCase();if(d.includes("camera")||d.includes("webcam"))return!0;let g="".concat(((a==null?void 0:a.getSettings())||{}).deviceId,"_").concat(Pe.VIDEO_INPUT);return!!UR.has(g)}(this.mediaTrack)||this._isRecapturing||r&&Bh&&nc)}onTrackMuted(){if(ure(),this.isNeedToRecapture(!0)){if(Date.now()-this._lastRecaptureTime<B_)return void setTimeout(()=>this.onTrackMuted(),B_);this._onMuteTimeoutId=setTimeout(()=>Ze(this,null,function*(){var r;if((r=this.mediaTrack)!=null&&r.muted){if((tc||Bs)&&document.visibilityState!=="visible")return;this.recapture(yield this.getRecoverCaptureDeviceId())}}),5e3)}}onTrackUnmuted(){this._onMuteTimeoutId>0&&clearTimeout(this._onMuteTimeoutId)}onTrackEnded(){return Ze(this,null,function*(){if(this.isNeedToRecapture()){if(Date.now()-this._lastRecaptureTime<B_)return void setTimeout(()=>this.onTrackEnded(),B_);this.recapture(yield this.getRecoverCaptureDeviceId())}})}recapture(r){return Ze(this,null,function*(){var a;if(this._isRecapturing||!this._inputTrack)return;this.log.warn("recapture trying"),(a=this._inputTrack)==null||a.stop(),this._isRecapturing=!0,this._lastRecaptureTime=Date.now();let d={useExactDeviceId:!0};if(r==="user"||r==="environment")d.facingMode=r;else{let g;(this.kind==="audio"?yield ac():yield Au()).find(C=>C.deviceId===r)&&(g=r),d.deviceId=g}return this.capture(d).then(()=>{this._isRecapturing=!1,this.log.warn("recapture success"),this.emit("1",{deviceId:this.deviceId})}).catch(g=>{this._isRecapturing=!1,this.log.warn("recapture failed ".concat(g.message)),this.emit("5",g)})})}getRecoverCaptureDeviceId(){return Ze(this,null,function*(){let r=this instanceof _s;if(r&&this.facingMode)return this.facingMode;let{deviceId:a}=this;if(a){let d=(_y.get(a)||0)+1;if(_y.set(a,d),d>=3){let g=r?(yield Au()).find(C=>!_y.has(C.deviceId)):(yield ac()).find(C=>!_y.has(C.deviceId));g&&(this.log.warn("".concat(a," capture fail ").concat(d," times, change new ").concat(g.deviceId)),a=g.deviceId)}}return a})}close(){var r;super.close(),this._inputTrack&&(this._inputTrack.stop(),this.uninstallTrackEvent(this._inputTrack)),(r=this.manager)==null||r.removeInput(this)}};mn([yi(_o.INIT,"capture",{ignoreError:!0,sync:!0})],wu.prototype,"setStateToCapture"),mn([Eg()],wu.prototype,"capture"),mn([yi("capture","publish",{ignoreError:!0,success(){this.room.localTracks.add(this),Qt.emit(Vt.LOCAL_TRACK_PUBLISHED,{track:this}),this.emit("4",{mediaType:this.strMediaType,state:"started",prevState:"starting"})},fail(r){let a="error",d=r.cause;d.message.includes("timeout")?a="timeout":d.code===rn.API_CALL_ABORTED&&(a="api-call"),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:"starting",reason:a,error:d})}})],wu.prototype,"publish"),mn([cr(r=>function(){return Ze(this,null,function*(){let a=this.state==="publish"?"started":"starting";r.call(this),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:a,reason:"api-call"})})}),yi([],"capture",{sync:!0})],wu.prototype,"unpublish");var _y=new Map;Qt.on(Vt.SWITCH_DEVICE_SUCCESS,r=>{r.track.deviceId&&_y.delete(r.track.deviceId)});var lc=class extends wu{constructor(r){super(1,ore),_e(this,"mediaType",1),_e(this,"volume",0),_e(this,"profile",{echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0,sampleRate:48e3,channelCount:1,bitrate:40}),_e(this,"playerMuted",!0),_e(this,"pipeline"),this.manager=r,this.pipeline=new nV(r),this.handleMicrophoneAdded=this.handleMicrophoneAdded.bind(this),this.handleMicrophoneRemoved=this.handleMicrophoneRemoved.bind(this)}getAudioLevel(){let r=(this.volume||super.getAudioLevel())*this.captureVolume;return r>1?1:r}get playerMediaTrack(){return this.mediaTrack}setInputMediaStreamTrack(r){return Ze(this,null,function*(){yield Ia(lc.prototype,this,"setInputMediaStreamTrack").call(this,r);let a=this.trackSettings||{};Co.addEnum({key:501701,value:a.channelCount||0,useUV:!1}),Co.addEnum({key:501702,value:a.sampleRate||0,useUV:!1}),Co.addEnum({key:502700,value:0});let{sampleRate:d,channelCount:g}=a;this._log.info("local audio track input ".concat(JSON.stringify({sampleRate:d,channelCount:g}))),this.pipeline.replaceSource(r),this.updatePlayingState(!!r)})}capture(r){let{deviceId:a,customSource:d,useExactDeviceId:g=!1}=r;return super.capture({video:!1,audio:!0,microphoneId:a,echoCancellation:this.profile.echoCancellation,autoGainControl:this.profile.autoGainControl,noiseSuppression:this.profile.noiseSuppression,sampleRate:this.profile.sampleRate,channelCount:this.profile.channelCount,useExactDeviceId:g,customSource:d})}switchDevice(r){return Ze(this,null,function*(){if(this.mediaTrack){if(this.deviceId===r&&(r!==V_||(yield sV(this.groupId,this.label))))return;try{this.log.info("switchDevice audio to: ".concat(r)),this.mediaTrack&&this.mediaTrack.stop(),yield this.capture({deviceId:r,useExactDeviceId:!0}),this.room&&(yield this.room.replaceTrack(this)),Qt.emit(Vt.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch microphone success")}catch(a){throw this.log.error("switch microphone failed ".concat(a)),this.deviceId&&this.recapture(this.deviceId),a}}})}listenDeviceChange(){Ii&&!Ii.listeners("audioInputRemoved").includes(this.handleMicrophoneRemoved)&&Ii.on("audioInputRemoved",this.handleMicrophoneRemoved,this)}handleMicrophoneRemoved(r){return Ze(this,null,function*(){if(r.deviceId===this.deviceId){this.log.warn("current microphone is lost: ".concat(JSON.stringify(r)));let a=yield ac();a[0]?this.recapture(a[0].deviceId):Ii.on("audioInputAdded",this.handleMicrophoneAdded,this)}})}handleMicrophoneAdded(r){this.log.warn("microphone added: ".concat(JSON.stringify(r))),this.recapture(r.deviceId)}update3A(r){return Ze(this,arguments,function(a){var d=this;let{echoCancellation:g,noiseSuppression:C,autoGainControl:A}=a;return function*(){let w=!1;!Pt(g)&&g!==d.profile.echoCancellation&&(d.profile.echoCancellation=g,w=!0),!Pt(C)&&C!==d.profile.noiseSuppression&&(d.profile.noiseSuppression=C,w=!0),!Pt(A)&&A!==d.profile.autoGainControl&&(d.profile.autoGainControl=A,w=!0),w&&d.deviceId&&(yield d.recapture(d.deviceId))}()})}get captureVolume(){return this.pipeline.volume}setCaptureVolume(r){this.pipeline.setVolume(r/100),this.pipeline.gain.node&&Co.addEnum({key:502700,value:2}),this.resetPlayerSource()}enableTrackANS(r){if(!this._inputTrack)return;let a=this._inputTrack.getConstraints();return a.noiseSuppression=r,this._inputTrack.applyConstraints(a).catch(d=>this._log.warn("".concat(r?"enable":"disable"," ANS failed "),d))}addDenoiser(r){var a;gg<=92&&((a=this.trackSettings)==null?void 0:a.sampleRate)!==48e3?this._log.warn("denoiser only support sampleRate 48000 before chrome 93"):(Co.addEnum({key:502700,value:1}),this.pipeline.denoiser.setNode(r),this.resetPlayerSource(),this.enableTrackANS(!1))}removeDenoiser(r){this.pipeline.denoiser.node===r&&(this.pipeline.denoiser.deleteNode(),this.resetPlayerSource(),this.enableTrackANS(!0))}resetPlayerSource(){this.player.setSourceNode(this.pipeline.gain.node||this.pipeline.denoiser.node||this.pipeline.source.node)}close(){this.pipeline.remove(),Ii.off("audioInputAdded",this.handleMicrophoneAdded,this),Ii.off("audioInputRemoved",this.handleMicrophoneRemoved,this),super.close()}recapture(r){return Ze(this,null,function*(){try{yield Ia(lc.prototype,this,"recapture").call(this,r)}catch(a){let d=(yield ac()).find(g=>g.deviceId!==r);if(!d)throw a;yield Ia(lc.prototype,this,"recapture").call(this,d.deviceId)}})}},_s=class extends wu{constructor(r){super(arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,Wh),_e(this,"profile",{width:640,height:480,frameRate:15,bitrate:500}),_e(this,"states",{bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0}),_e(this,"small"),_e(this,"isNeedToSetBandwidth"),_e(this,"muteImage"),_e(this,"manager"),this.manager=r;let a=()=>{this.isAllowed2k4k(this.profile)?this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),this.setProfile(uo(Pn({},this.profile),{width:1920,height:1080})),this.applyProfile())};this.on("input-media-track-changed",a),this.on("publish",a),this.handleCameraAdded=this.handleCameraAdded.bind(this),this.handleCameraRemoved=this.handleCameraRemoved.bind(this)}get facingMode(){if(Ig&&this.mediaTrack)return this.mediaTrack.getSettings().facingMode}setMute(r){return Ze(this,null,function*(){var a,d,g;if(Ho(r)){if(this.muteImage===r)return;yield(a=this.manager)==null?void 0:a.deleteWatermark("mute"),yield(d=this.manager)==null?void 0:d.setWatermark({x:0,y:0,width:this.settings.width,height:this.settings.height,type:"mute",zIndex:999,imageUrl:r}),this.muteImage=r,Ia(_s.prototype,this,"setMute").call(this,!1)}else yield(g=this.manager)==null?void 0:g.deleteWatermark("mute"),this.muteImage=void 0,Ia(_s.prototype,this,"setMute").call(this,r)})}capture(r){let{deviceId:a,facingMode:d,useExactDeviceId:g=!1,customSource:C}=r;return super.capture({audio:!1,video:!0,facingMode:d||this.facingMode,cameraId:a,width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate,useExactDeviceId:g,customSource:C})}setProfile(r){let a=Pn({},r),d=a.width>a.height;a.width*a.height<=19200&&Bs&&Q_&&(this.log.warn("resolution is ".concat(a.width,"*").concat(a.height,", fallback to 240*180")),a.width=d?240:180,a.height=d?180:240,a.bitrate=Math.max(a.bitrate,150)),a.width*a.height>921600&&a4&&(a.width=d?1280:720,a.height=d?720:1280,this.log.warn("reset to 1280 * 720 on iOS 13~14")),a.bitrate&&(this.isNeedToSetBandwidth=a.bitrate!==this.profile.bitrate),this.isAllowed2k4k(this.profile)?super.setProfile(a):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),super.setProfile(uo(Pn({},this.profile),{width:1920,height:1080})))}applyProfile(){var r;if(!this.mediaTrack)return;let a=this.settings;return a.height!==this.profile.height||a.width!==this.profile.width||a.frameRate!==this.profile.frameRate?(r=this.mediaTrack)==null?void 0:r.applyConstraints({width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate}).then(()=>{if(this.manager&&this.manager.changeInput(this),this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}),this.isNeedToSetBandwidth&&this.room&&this.room.setBandWidth)return this.isNeedToSetBandwidth=!1,this.room.setBandWidth({bandwidth:this.profile.bitrate,type:Pe.VIDEO,videoType:Pe.BIG})}):void 0}get settings(){let r={width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate};return Ig&&this.mediaTrack&&Object.assign(r,this.mediaTrack.getSettings()),r}get scaleResolutionDownBy(){let{settings:r}=this;return r.width===this.profile.width&&r.height===this.profile.height?1:E4()&&this.profile.width>this.profile.height&&r.height>r.width?Math.max(r.width/this.profile.height,r.height/this.profile.width,1):Math.max(r.width/this.profile.width,r.height/this.profile.height,1)}isAllowed2k4k(r){var a;return!(this.room&&this.room.scheduleResult&&!this.isScreen&&!(r.height*r.width<3686400))||((a=this.room.scheduleResult.trtcAutoConf)==null?void 0:a["2k4k"])===1}isNeedToSwitchDevice(r){return!(!this.mediaTrack||this.deviceId===r||this.facingMode===r)}switchDevice(r){return Ze(this,null,function*(){try{if(!this.isNeedToSwitchDevice(r))return;let a={useExactDeviceId:!0};r==="user"||r==="environment"?a.facingMode=r:a.deviceId=r,this.mediaTrack.stop(),yield this.capture(a),Qt.emit(Vt.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch camera success")}catch(a){throw this.log.error("switch camera failed ".concat(a)),this.deviceId&&this.recapture(this.deviceId),a}})}listenDeviceChange(){Ii&&!Ii.listeners("videoInputRemoved").includes(this.handleCameraRemoved)&&Ii.on("videoInputRemoved",this.handleCameraRemoved,this)}handleCameraRemoved(r){return Ze(this,null,function*(){if(r.deviceId===this.deviceId){this.log.warn("current camera is lost: ".concat(JSON.stringify(r)));let a=yield Au();a[0]?this.recapture(a[0].deviceId):Ii.on("videoInputAdded",this.handleCameraAdded,this)}})}handleCameraAdded(r){return Ze(this,null,function*(){this.log.warn("camera added: ".concat(JSON.stringify(r))),this.recapture(r.deviceId)})}play(r,a){return Ze(this,null,function*(){return Pt(this.mirror)&&!this.isScreen&&this.setMirror("view"),Ia(_s.prototype,this,"play").call(this,r,a)})}close(){Ii.off("videoInputAdded",this.handleCameraAdded,this),Ii.off("videoInputRemoved",this.handleCameraRemoved,this),super.close()}recapture(r){return Ze(this,null,function*(){try{yield Ia(_s.prototype,this,"recapture").call(this,r)}catch(a){let d=(yield Au()).find(g=>g.deviceId!==r);if(!d)throw a;yield Ia(_s.prototype,this,"recapture").call(this,d.deviceId)}})}},hV=k4();if(navigator.mediaDevices&&"setCaptureHandleConfig"in navigator.mediaDevices)try{navigator.mediaDevices.setCaptureHandleConfig({handle:hV,exposeOrigin:!0,permittedOrigins:["*"]})}catch{}var VR,hre=function(r){return Ze(this,null,function*(){let a=null,d=function(A){let w={preferCurrentTab:A.preferDisplaySurface==="current-tab",systemAudio:"include",selfBrowserSurface:"include",surfaceSwitching:"include"},V={width:nc?{max:A.width}:{ideal:A.width,max:A.width},height:nc?{max:A.height}:{ideal:A.height,max:A.height},frameRate:A.frameRate,displaySurface:A.preferDisplaySurface||"monitor"};if(w.video=V,A.systemAudio){let{echoCancellation:U=!0,noiseSuppression:j=!1,autoGainControl:re=!1}=A;w.audio={echoCancellation:U,noiseSuppression:j,autoGainControl:re,sampleRate:48e3}}return w}(r);cn.info("getDisplayMedia with constraints: ".concat(JSON.stringify(d)));let g=yield navigator.mediaDevices.getDisplayMedia(d);r.systemAudio&&g.getAudioTracks().length===0&&(nS&&gg<74||nc||gr)&&cn.warn("Your browser not support capture system audio");let C=g.getVideoTracks()[0];if(C){if(r.frameRate)try{yield C.applyConstraints({frameRate:{min:r.frameRate,ideal:r.frameRate},width:r.width,height:r.height})}catch(A){cn.warn("screen applyConstraints failed: ".concat(A))}r.captureElement&&(yield function(A,w){return Ze(this,null,function*(){var V;if("CropTarget"in window&&"fromElement"in CropTarget&&lr(A.cropTo))try{if(((V=A.getCaptureHandle())==null?void 0:V.handle)!==hV)return;let U=yield CropTarget.fromElement(w);yield A.cropTo(U)}catch(U){cn.warn("cropTo target failed ".concat(U))}})}(C,r.captureElement))}if(r.audio){let A=function(w){let V={echoCancellation:w.echoCancellation,autoGainControl:w.autoGainControl,noiseSuppression:w.noiseSuppression,sampleRate:w.sampleRate,channelCount:w.channelCount};return Pt(w.microphoneId)||(V.deviceId=w.microphoneId),{audio:V,video:!1}}(r);cn.info("getUserMedia with constraints: ".concat(JSON.stringify(A))),a=yield navigator.mediaDevices.getUserMedia(A),g.addTrack(a.getAudioTracks()[0])}return g})},Yh=class extends _s{constructor(r){super(r,2),_e(this,"profile",{width:1920,height:1080,frameRate:5,bitrate:1600}),_e(this,"objectFit","contain"),_e(this,"isScreen",!0),this._log.id="s-".concat(this._log.id)}capture(r){return Ze(this,arguments,function(a){var d=this;let{systemAudio:g=!1,autoGainControl:C,echoCancellation:A,noiseSuppression:w,audioTrack:V,videoTrack:U,captureElement:j,preferDisplaySurface:re}=a;return function*(){try{let ce;return U||V?(ce=new MediaStream,U&&ce.addTrack(U),V&&ce.addTrack(V)):ce=yield hre({audio:!1,systemAudio:g,width:d.profile.width,height:d.profile.height,frameRate:d.profile.frameRate,autoGainControl:C,echoCancellation:A,noiseSuppression:w,captureElement:j,preferDisplaySurface:re}),yield d.setInputMediaStreamTrack(ce.getVideoTracks()[0]),ce}catch(ce){throw d.log.error("getDisplayMedia error observed ".concat(ce)),ce instanceof An?ce:new An({code:rn.INITIALIZE_FAILED,name:ce.name,message:ce.message})}}()})}switchDevice(r){return Ze(this,null,function*(){throw new Error("Method not implemented.")})}},yy=class extends lc{constructor(r){super(r),this._log.id="s-".concat(this._log.id)}},fre=class extends Qoe{constructor(r){super(),this.room=r,_e(this,"_localAudioTrack"),_e(this,"_localScreenAudioTrack"),_e(this,"log",cn.createLogger({id:"am"})),_e(this,"denoiser"),r&&(this.log.setUserId(r.userId),this.log.setSdkAppId(r.sdkAppId))}get _localAudioPipline(){var r;return(r=this._localAudioTrack)==null?void 0:r.pipeline}dump(r){var a,d;if(!this._localAudioTrack)return;let g=[],C=[];(a=this._localAudioPipline)!=null&&a.source.node&&(g.push(this._localAudioPipline.source.node),C.push("mic")),(d=this._localAudioPipline)!=null&&d.denoiser.node&&(g.push(this._localAudioPipline.denoiser.node),C.push("mic-processed")),this.mixWeight>1&&(g.push(this.audioContext.createMediaStreamSource(this._localAudioPipline.stream)),C.push("mix")),this.log.info("dump audio track ".concat(C,", duration: ").concat(r));let A=new AbortController,w=[],V=setTimeout(()=>{this.log.info('dump audio track complete please input "download()" to download.'),A.abort("timeout")},1e3*r),U=()=>{for(let re=0;re<C.length;re++){let ce=URL.createObjectURL(new Blob(w[re])),Te=document.createElement("a");Te.href=ce,Te.download="".concat(C[re],".pcm"),Te.style.display="none",document.body.appendChild(Te),Te.click(),URL.revokeObjectURL(ce),Te.remove()}clearTimeout(V),A.abort("download")},j=function(re){return Ze(this,null,function*(){let ce=ku();VR||(VR=mS(ce,URL.createObjectURL(new Blob(["registerProcessor('dumper', class extends AudioWorkletProcessor {process(inputs) {this.port.postMessage(inputs);return true;}});"],{type:"application/javascript"})))),yield VR;let Te=new AudioWorkletNode(ce,"dumper",{numberOfInputs:re.length,numberOfOutputs:0});return re.forEach((De,ze)=>De.connect(Te,0,ze)),new ReadableStream({start(De){Te.port.onmessage=ze=>{De.enqueue(ze.data)}},cancel(){re.forEach(De=>De.disconnect(Te)),Te.port.close()}})})}(g).then(re=>re.pipeTo(new WritableStream({write(ce){ce.forEach((Te,De)=>w[De]=w[De]?w[De].concat(Te[0]):[Te[0]])}}),A).catch(ce=>U));return{then:j.then.bind(j),download:U}}get hasScreenAudioTrack(){return this._localScreenAudioTrack!==null}get hasAudioTrack(){return this._localAudioTrack!==null}changeInput(r){var a;if(r instanceof yy)this._localScreenAudioTrack=r,r.pipeline.connect(),this.mixOnChange();else if(r instanceof lc)this._localAudioTrack=r,this.destination.channelCount=((a=r.trackSettings)==null?void 0:a.channelCount)||1,this.denoiser&&r.addDenoiser(this.denoiser),r.pipeline.connect(),this.mixOnChange();else if(r instanceof GR)return r.setOutputMediaStreamTrack(r.mediaTrack)}mixOnChange(){var r,a;(r=this._localAudioTrack)==null||r.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localAudioTrack.mediaTrack),(a=this._localScreenAudioTrack)==null||a.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localScreenAudioTrack.mediaTrack)}removeInput(r){r instanceof yy?delete this._localScreenAudioTrack:r instanceof lc&&delete this._localAudioTrack}addDenoiser(r){var a;this.denoiser=r,(a=this._localAudioTrack)==null||a.addDenoiser(r)}removeDenoiser(r){var a;delete this.denoiser,(a=this._localAudioTrack)==null||a.removeDenoiser(r)}destroy(){this.close()}};function fV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:30,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return cr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),w=0;w<C;w++)A[w]=arguments[w];return new Promise((V,U)=>{let j=setTimeout(()=>{let re=new An({code:rn.API_CALL_TIMEOUT,message:"checkPendingPromise ".concat(g,"() timeout ").concat(r,"s")});cn.warn(re),a===2?U(re):a===1&&V()},1e3*r);d.apply(this,A).then(V,U).finally(()=>{clearTimeout(j)})})})}var pV=class extends FR{constructor(r,a,d){super({userId:a.userId,sdkAppId:r.sdkAppId,mediaType:d,room:r}),this.room=r,this.user=a,_e(this,"tinyId"),_e(this,"isRemote",!0),this.tinyId=a.tinyId}setMute(r){this.hasFlag&&super.setMute(r)}setInputMediaStreamTrack(r){super.setInputMediaStreamTrack(r),this.hasFlag&&this.isSubscribed&&this.player.setTrack(this.outMediaTrack)}waitHasMediaTrack(){return new Promise(r=>{this.mediaTrack?r():this.once("input-media-track-changed",r)})}get isSubscribing(){return this.state.toString()==="subscribeing"}get isSubscribed(){return this.state===pV.STATE_SUBSCRIBE}subscribe(r){return r}unsubscribe(){this.player.setTrack(null),this.streamType==="main"&&this.kind==="video"&&this.room.changeType(!1,this.user)}updatePlayingState(r){if(this.isPlayCalled&&this.player.isStopped===r){if(r&&(!this.isSubscribed||!this.hasFlag||!this.outMediaTrack))return void this.log.info("abort play, isSubscribed:".concat(this.isSubscribed," hasFlag:").concat(this.hasFlag," hasTrack:").concat(!!this.outMediaTrack));super.updatePlayingState(r)}}onFlagChanged(){this.updatePlayingState(this.hasFlag)}},Du=pV;_e(Du,"STATE_SUBSCRIBE","subscribe"),mn([fV(5,1)],Du.prototype,"waitHasMediaTrack"),mn([yi(_o.INIT,Du.STATE_SUBSCRIBE,{success(){this.log.info("subscribed"),Qt.emit(Vt.REMOTE_TRACK_SUBSCRIBED,{track:this}),this.updatePlayingState(!0)},ignoreError:!0})],Du.prototype,"subscribe"),mn([yi(Du.STATE_SUBSCRIBE,_o.INIT,{sync:!0,success(){this.log.info("unsubscribed"),this.updatePlayingState(!1),Qt.emit(Vt.REMOTE_TRACK_UNSUBSCRIBED,{track:this})}})],Du.prototype,"unsubscribe");var GR=class extends Du{constructor(r,a){super(r,a,1),_e(this,"volume",0),_e(this,"mediaType",1),_e(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,end2EndDelay:0,jitterBufferDelay:0}),this.manager=r.audioManager}getAudioLevel(){let r=this.volume||super.getAudioLevel();return r>1?1:r}get hasFlag(){return this.user.muteState.hasAudio&&!this.user.muteState.audioMuted}isFlagChanged(r){let a=r.hasAudio&&!r.audioMuted;return this.hasFlag||(this.volume=0),this.hasFlag!==a}},Iy=class extends Du{constructor(r,a){super(r,a,arguments.length>2&&arguments[2]!==void 0?arguments[2]:4),_e(this,"mediaType",4),_e(this,"source"),_e(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,end2EndDelay:0,jitterBufferDelay:0}),this.manager=r.videoManager}get isBig(){return this.mediaType===4}get isSmall(){return this.mediaType===8}changeType(r){this.room.changeType(r,this.user)}get hasFlag(){return this.user.muteState.hasVideo&&!this.user.muteState.videoMuted}isFlagChanged(r){let a=r.hasVideo&&!r.videoMuted;return this.hasFlag!==a}setMirror(r){r==="publish"||r==="both"||super.setMirror(r)}},gV=class extends Iy{constructor(r,a){super(r,a,2),_e(this,"mediaType",2),_e(this,"objectFit","contain")}get hasFlag(){return this.user.muteState.hasAuxiliary}isFlagChanged(r){let a=r.hasAuxiliary;return this.hasFlag!==a}};function by(){}var pre=r=>r(),gre=()=>typeof __FASTRX_DEVTOOLS__<"u",mre=1,Cy=class extends Function{toString(){return"".concat(this.name,"(").concat(this.args.length?[...this.args].join(", "):"",")")}subscribe(r){let a=new vre(r,this,this.streamId++);return cc.subscribe({id:this.id,end:!1},{nodeId:a.sourceId,streamId:a.id}),this(a),a}},mV=class{constructor(){this.defers=new Set,this.disposed=!1}next(r){}complete(){this.dispose()}error(r){this.dispose()}get bindDispose(){return()=>this.dispose()}dispose(){this.disposed=!0,this.complete=by,this.error=by,this.next=by,this.dispose=by,this.subscribe=by,this.doDefer()}subscribe(r){return r instanceof Cy?r.subscribe(this):r(this),this}get bindSubscribe(){return r=>this.subscribe(r)}doDefer(){this.defers.forEach(pre),this.defers.clear()}defer(r){this.defers.add(r)}removeDefer(r){this.defers.delete(r)}reset(){this.disposed=!1,delete this.complete,delete this.next,delete this.dispose,delete this.next,delete this.subscribe}resetNext(){delete this.next}resetComplete(){delete this.complete}resetError(){delete this.error}},vV=class extends mV{constructor(r){super(),this.sink=r,r.defer(this.bindDispose)}next(r){this.sink.next(r)}complete(){this.sink.complete()}error(r){this.sink.error(r)}};function IS(r,a,d){if(gre()){let g=Object.defineProperties(Object.setPrototypeOf(r,Cy.prototype),{streamId:{value:0,writable:!0,configurable:!0},name:{value:a,writable:!0,configurable:!0},args:{value:d,writable:!0,configurable:!0},id:{value:0,writable:!0,configurable:!0}});cc.create(g);for(let C=0;C<d.length;C++){let A=d[C];typeof A=="function"&&A instanceof Cy&&cc.addSource(g,A)}return g}return r}function Ou(r,a){window.postMessage({source:"fastrx-devtools-backend",payload:{event:r,payload:a}})}var vre=class extends vV{constructor(r,a,d){super(r),this.source=a,this.id=d,this.sourceId=r.sourceId,this.defer(()=>{cc.defer(this.source,this.id)})}next(r){cc.next(this.source,this.id,r),this.sink.next(r)}complete(){cc.complete(this.source,this.id),this.sink.complete()}error(r){cc.complete(this.source,this.id,r),this.sink.error(r)}},cc={addSource(r,a){Ou("addSource",{id:r.id,name:r.toString(),source:{id:a.id,name:a.toString()}})},next(r,a,d){Ou("next",{id:r.id,streamId:a,data:d&&d.toString()})},subscribe(r,a){let{id:d,end:g}=r;Ou("subscribe",{id:d,end:g,sink:{nodeId:a&&a.nodeId,streamId:a&&a.streamId}})},complete(r,a,d){Ou("complete",{id:r.id,streamId:a,err:d?d.toString():null})},defer(r,a){Ou("defer",{id:r.id,streamId:a})},pipe(r){Ou("pipe",{name:r.toString(),id:r.id,source:{id:r.source.id,name:r.source.toString()}})},update(r){Ou("update",{id:r.id,name:r.toString()})},create(r){r.id||(r.id=mre++),Ou("create",{name:r.toString(),id:r.id})}},_re=class extends mV{constructor(r){super(),this.source=r,this.sinks=new Set}add(r){r.defer(()=>this.remove(r)),this.sinks.add(r).size===1&&(this.reset(),this.subscribe(this.source))}remove(r){this.sinks.delete(r),this.sinks.size===0&&this.dispose()}next(r){this.sinks.forEach(a=>a.next(r))}complete(){this.sinks.forEach(r=>r.complete()),this.sinks.clear()}error(r){this.sinks.forEach(a=>a.error(r)),this.sinks.clear()}},yre=function(r,a){return function(){for(var d=arguments.length,g=new Array(d),C=0;C<d;C++)g[C]=arguments[C];return A=>{if(A instanceof Cy){let w=IS(V=>{let U=new r(V,...g);U.sourceId=w.id,U.subscribe(A)},a,arguments);return w.source=A,cc.pipe(w),w}return w=>A(new r(w,...g))}}}(class extends vV{constructor(r,a,d){super(r),this.mapper=a,this.thisArg=d}next(r){super.next(this.mapper.call(this.thisArg,r))}},"map");(function(r){for(var a=arguments.length,d=new Array(a>1?a-1:0),g=1;g<a;g++)d[g-1]=arguments[g];d.reduce((C,A)=>A(C),r)})(function(r){return IS(a=>{let d=0,g=setInterval(()=>a.next(d++),r);return a.defer(()=>{clearInterval(g)}),"interval"},"interval",arguments)}(250),yre(()=>performance.now()),function(){return r=>{let a=new _re(r);if(r instanceof Cy){let d=IS(g=>{a.add(g)},"share",arguments);return a.sourceId=d.id,d.source=r,cc.pipe(d),d}return IS(a.add.bind(a),"share",arguments)}}());var Mg=new Map;function Yr(r,a){let d=uo(Pn({},a),{timestamp:IA()});Mg.has(r)?Mg.get(r).push(d):Mg.set(r,[d])}Qt.on(Vt.JOIN_SUCCESS,r=>{let{room:a}=r;Yr(a.userId,{eventId:32788,eventDesc:"join room"})}),Qt.on(Vt.LEAVE_START,r=>{let{room:a}=r;Yr(a.userId,{eventId:32789,eventDesc:"leave room"})}),Qt.on(Vt.LOCAL_TRACK_PUBLISHED,r=>{let{track:a}=r;if(a.room){let d=32769;a.mediaType===4?d=32768:a.mediaType===2&&(d=32805),Yr(a.room.userId,{eventId:d,eventDesc:"publish ".concat(a.kind)})}}),Qt.on(Vt.LOCAL_TRACK_UNPUBLISHED,r=>{let{track:a}=r;if(a.room){let d=32771;a.mediaType===4?d=32770:a.mediaType===2&&(d=32806),Yr(a.room.userId,{eventId:d,eventDesc:"unpublish ".concat(a.kind)})}}),Qt.on(Vt.TRACK_MUTED,r=>{let{track:a}=r;a.room&&(a.kind===Pe.AUDIO?Yr(a.room.userId,{eventId:a.isRemote?32785:32772,eventDesc:"mute audio",remoteUserId:a.isRemote?a.userId:void 0}):Yr(a.room.userId,{eventId:a.isRemote?32784:32773,eventDesc:"mute video",remoteUserId:a.isRemote?a.userId:void 0}))}),Qt.on(Vt.TRACK_UNMUTED,r=>{let{track:a}=r;a.room&&(a.kind===Pe.AUDIO?Yr(a.room.userId,{eventId:a.isRemote?32787:32774,eventDesc:"unmute audio",remoteUserId:a.isRemote?a.userId:void 0}):Yr(a.room.userId,{eventId:a.isRemote?32786:32775,eventDesc:"unmute video",remoteUserId:a.isRemote?a.userId:void 0}))}),Qt.on(Vt.REMOTE_TRACK_SUBSCRIBED,r=>{let{track:a}=r;!a.room||(a.mediaType===1&&Yr(a.room.userId,{eventId:32777,eventDesc:"".concat(Pe.SUBSCRIBE," ").concat(a.kind),remoteUserId:a.userId}),a.mediaType===4&&Yr(a.room.userId,{eventId:32776,eventDesc:"".concat(Pe.SUBSCRIBE," ").concat(a.kind),remoteUserId:a.userId}),a.mediaType===8&&Yr(a.room.userId,{eventId:32803,eventDesc:"".concat(Pe.SUBSCRIBE," ").concat(Pe.SMALL_VIDEO),remoteUserId:a.userId}))}),Qt.on(Vt.REMOTE_TRACK_UNSUBSCRIBED,r=>{let{track:a}=r;!a.room||(a.mediaType===1&&Yr(a.room.userId,{eventId:32779,eventDesc:"".concat(Pe.UNSUBSCRIBE," ").concat(a.kind),remoteUserId:a.userId}),a.mediaType===4&&Yr(a.room.userId,{eventId:32778,eventDesc:"".concat(Pe.UNSUBSCRIBE," ").concat(a.kind),remoteUserId:a.userId}),a.mediaType===8&&Yr(a.room.userId,{eventId:32804,eventDesc:"".concat(Pe.UNSUBSCRIBE," ").concat(Pe.SMALL_VIDEO),remoteUserId:a.userId}))}),Qt.on(Vt.SWITCH_DEVICE_SUCCESS,r=>{let{track:a}=r;a.room&&Yr(a.room.userId,{eventId:a.kind===Pe.VIDEO?32780:32781,eventDesc:"switch ".concat(a.kind===Pe.VIDEO?"camera":"microphone")})}),Qt.on(Vt.LOCAL_TRACK_REPLACED,r=>{let{track:a}=r;a.room&&Yr(a.room.userId,{eventId:a.kind===Pe.VIDEO?32782:32783,eventDesc:"replace ".concat(a.kind)})}),Qt.on(Vt.SIGNAL_CONNECTION_STATE_CHANGED,r=>{let a,d,{room:g,prevState:C,state:A}=r;switch(A){case"CONNECTED":C==="RECONNECTING"?(a=32795,d="signal reconnected"):(a=32791,d="signal connected");break;case"DISCONNECTED":C==="RECONNECTING"?(a=32796,d="signal reconnect fail"):(a=32790,d="signal disconnected");break;case"RECONNECTING":a=32794,d="signal reconnecting"}a&&d&&Yr(g.userId,{eventId:a,eventDesc:d})}),Qt.on(Vt.PEER_CONNECTION_STATE_CHANGED,r=>{let a,d,{room:g,prevState:C,state:A,remoteUserId:w}=r,V=!!w,U=V?"downlink":"uplink";switch(A){case"CONNECTED":C==="RECONNECTING"?(a=V?32801:32798,d="".concat(U," reconnected")):(a=V?32793:32792,d="".concat(U," connected"));break;case"DISCONNECTED":C==="RECONNECTING"&&(a=V?32802:32799,d="".concat(U," reconnect fail"));break;case"RECONNECTING":a=V?32800:32797,d="".concat(U," reconnecting")}a&&d&&Yr(g.userId,{eventId:a,eventDesc:d,remoteUserId:w})});var Ire=vi(gs(),1),bre=class extends Ire.EventEmitter{constructor(r,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"userId";super(),this.mySelfId=r,this._log=a,this.key=d,_e(this,"userMap",new Map),_e(this,"remotePublishedUserMap",new Map)}getPublishedUser(r){return this.remotePublishedUserMap.get(r)}addUser(r){let a=r[this.key],{userId:d,tinyId:g,role:C}=r;if(this.userMap.has(a))return;let A={userId:d,tinyId:g,role:C===20?"anchor":"audience"};this.userMap.set(a,A),this.emit("1",A)}deleteUser(r,a){let d=this.userMap.get(r);if(!d)return;let g="peer leave [".concat(r,"]");Pt(a)||(g+=":".concat(WF[a])),this._log.info(g);let C=this.remotePublishedUserMap.get(r);if(C){let A=C.muteState;C.flag=0,this.emit("5",C.userId),this.deleteRemotePublishedUser(r),this.emit("6",{prevMuteState:A,muteState:C.muteState,flag:0})}this.userMap.delete(r),this.emit("2",d.userId)}setUserList(r){this.userMap.forEach(a=>{r.findIndex(d=>d[this.key]===a[this.key])<0&&this.deleteUser(a[this.key],0)}),r.forEach(a=>{!this.userMap.has(a[this.key])&&a[this.key]!==this.mySelfId&&this.addUser(a)})}addRemotePublishedUser(r){this.remotePublishedUserMap.has(r[this.key])||this.remotePublishedUserMap.set(r[this.key],r)}deleteRemotePublishedUser(r){!this.remotePublishedUserMap.has(r)||this.remotePublishedUserMap.delete(r)}setRemotePublishedUserList(r){this.remotePublishedUserMap.forEach(a=>{let d=a[this.key];if(r.findIndex(g=>g[this.key]===a[this.key])<0){this._log.info("remote [".concat(d,"] unpublish"));let g=a.muteState;a.flag=0,this.emit("5",a.userId),this.deleteRemotePublishedUser(d),this.emit("6",{prevMuteState:g,muteState:a.muteState,flag:0})}}),r.forEach(a=>{var d;let g=a[this.key];if(g===this.mySelfId)return;let{flag:C,userId:A,tinyId:w}=a,V=iy(C,A),U=(d=this.remotePublishedUserMap.get(g))==null?void 0:d.muteState;if(U){let j=this.remotePublishedUserMap.get(g);j&&j.flag!==C&&(j.flag=C,this._log.info("remote publish updated: ".concat(JSON.stringify(j.muteState))),this.emit("6",{prevMuteState:U,muteState:V,flag:C}))}else this._log.info("remote publish. state: ".concat(JSON.stringify(V))),this.addUser({userId:A,tinyId:w,role:20}),this.emit("3",a),this.emit("6",{prevMuteState:iy(0,A),muteState:V,flag:C})})}clear(){this.userMap.clear(),this.remotePublishedUserMap.clear()}};function _V(r){let{timesInSecond:a,maxSizeInSecond:d,getSize:g}=r;return cr((C,A)=>{let w=new Map;return Qt.on(Vt.ROOM_DESTROY,V=>{let{room:U}=V;return w.delete(U)}),function(){let V=w.get(this);for(var U=arguments.length,j=new Array(U),re=0;re<U;re++)j[re]=arguments[re];if(V||(V={callCountInSecond:0,timestamp:0,totalSizeInSecond:0},w.set(this,V)),V.timestamp===0?V.timestamp=Date.now():Date.now()-V.timestamp>1e3&&(V.timestamp=Date.now(),V.callCountInSecond=0,V.totalSizeInSecond=0),g&&(V.totalSizeInSecond+=g(...j)),V.timestamp!==0&&Date.now()-V.timestamp<1e3&&(V.callCountInSecond>=a||V.totalSizeInSecond>d))throw new An({code:rn.INVALID_OPERATION,message:no({key:jn.CALL_FREQUENCY_LIMIT,data:{isTimes:V.callCountInSecond>=a,isSize:V.totalSizeInSecond>d,name:A,timesInSecond:a,maxSizeInSecond:d}})});V.callCountInSecond++,C.call(this,...j)}})}var Lt,yV=!0,uc={SCENE_LIVE:"live",SCENE_RTC:"rtc",ROLE_ANCHOR:"anchor",ROLE_AUDIENCE:"audience",STREAM_TYPE_MAIN:"main",STREAM_TYPE_SUB:"sub",AUDIO_PROFILE_STANDARD:"standard",AUDIO_PROFILE_STANDARD_STEREO:"standard-stereo",AUDIO_PROFILE_HIGH:"high",AUDIO_PROFILE_HIGH_STEREO:"high-stereo",QOS_PREFERENCE_SMOOTH:"smooth",QOS_PREFERENCE_CLEAR:"clear"},Yn={INVALID_PARAMETER:5e3,INVALID_OPERATION:5100,ENV_NOT_SUPPORTED:5200,DEVICE_ERROR:5300,SERVER_ERROR:5400,OPERATION_FAILED:5500,OPERATION_ABORT:5998,UNKNOWN_ERROR:5999},bS=((Lt=bS||{})[Lt.INVALID_PARAMETER=5e3]="INVALID_PARAMETER",Lt[Lt.INVALID_PARAMETER_REQUIRED=5001]="INVALID_PARAMETER_REQUIRED",Lt[Lt.INVALID_PARAMETER_TYPE=5002]="INVALID_PARAMETER_TYPE",Lt[Lt.INVALID_PARAMETER_EMPTY=5003]="INVALID_PARAMETER_EMPTY",Lt[Lt.INVALID_PARAMETER_INSTANCE=5004]="INVALID_PARAMETER_INSTANCE",Lt[Lt.INVALID_PARAMETER_RANGE=5005]="INVALID_PARAMETER_RANGE",Lt[Lt.INVALID_PARAMETER_LESS_THAN_ZERO=5006]="INVALID_PARAMETER_LESS_THAN_ZERO",Lt[Lt.INVALID_PARAMETER_MIN=5007]="INVALID_PARAMETER_MIN",Lt[Lt.INVALID_PARAMETER_MAX=5008]="INVALID_PARAMETER_MAX",Lt[Lt.INVALID_ELEMENT_ID=5009]="INVALID_ELEMENT_ID",Lt[Lt.INVALID_ELEMENT_ID_TYPE=5010]="INVALID_ELEMENT_ID_TYPE",Lt[Lt.INVALID_STREAM_ID=5011]="INVALID_STREAM_ID",Lt[Lt.INVALID_ROOM_ID_STRING=5012]="INVALID_ROOM_ID_STRING",Lt[Lt.INVALID_ROOM_ID_INTEGER=5013]="INVALID_ROOM_ID_INTEGER",Lt[Lt.INVALID_STREAM_TYPE=5014]="INVALID_STREAM_TYPE",Lt[Lt.INVALID_ROOM_ID_REQUIED=5015]="INVALID_ROOM_ID_REQUIED",Lt[Lt.INVALID_ROOM_ID_INTEGER_STRING=5016]="INVALID_ROOM_ID_INTEGER_STRING",Lt[Lt.INVALID_BUFFER_EMPTY=5017]="INVALID_BUFFER_EMPTY",Lt[Lt.INVALID_BUFFER_OVERSIZE=5018]="INVALID_BUFFER_OVERSIZE",Lt[Lt.INVALID_OPERATION=5100]="INVALID_OPERATION",Lt[Lt.INVALID_OPERATION_NOT_JOINED=5101]="INVALID_OPERATION_NOT_JOINED",Lt[Lt.INVALID_OPERATION_REMOTE_USER_NOT_EXIST=5102]="INVALID_OPERATION_REMOTE_USER_NOT_EXIST",Lt[Lt.INVALID_OPERATION_STREAM_TYPE_NOT_EXIST=5103]="INVALID_OPERATION_STREAM_TYPE_NOT_EXIST",Lt[Lt.INVALID_OPERATION_REPEAT_CALL=5104]="INVALID_OPERATION_REPEAT_CALL",Lt[Lt.INVALID_OPERATION_NEED_VIDEO=5105]="INVALID_OPERATION_NEED_VIDEO",Lt[Lt.INVALID_OPERATION_NEED_AUDIO=5106]="INVALID_OPERATION_NEED_AUDIO",Lt[Lt.INVALID_ROLE_AUDIENCE=5107]="INVALID_ROLE_AUDIENCE",Lt[Lt.ENV_NOT_SUPPORTED=5200]="ENV_NOT_SUPPORTED",Lt[Lt.NOT_SUPPORTED_HTTP=5201]="NOT_SUPPORTED_HTTP",Lt[Lt.NOT_SUPPORTED_WEBRTC=5202]="NOT_SUPPORTED_WEBRTC",Lt[Lt.NOT_SUPPORTED_H264_ENCODE=5203]="NOT_SUPPORTED_H264_ENCODE",Lt[Lt.NOT_SUPPORTED_H264_DECODE=5204]="NOT_SUPPORTED_H264_DECODE",Lt[Lt.NOT_SUPPORTED_SCREEN_SHARE=5205]="NOT_SUPPORTED_SCREEN_SHARE",Lt[Lt.NOT_SUPPORTED_SMALL_VIDEO=5206]="NOT_SUPPORTED_SMALL_VIDEO",Lt[Lt.NOT_SUPPORTED_SEI=5207]="NOT_SUPPORTED_SEI",Lt[Lt.NOT_SUPPORTED_WEBGL=5208]="NOT_SUPPORTED_WEBGL",Lt[Lt.NOT_SUPPORTED_CHROME_VERSION=5209]="NOT_SUPPORTED_CHROME_VERSION",Lt[Lt.DEVICE_ERROR=5300]="DEVICE_ERROR",Lt[Lt.DEVICE_NOT_FOUND_ERROR=5301]="DEVICE_NOT_FOUND_ERROR",Lt[Lt.DEVICE_NOT_ALLOWED_ERROR=5302]="DEVICE_NOT_ALLOWED_ERROR",Lt[Lt.DEVICE_NOT_READABLE_ERROR=5303]="DEVICE_NOT_READABLE_ERROR",Lt[Lt.DEVICE_OVERCONSTRAINED_ERROR=5304]="DEVICE_OVERCONSTRAINED_ERROR",Lt[Lt.DEVICE_INVALID_STATE_ERROR=5305]="DEVICE_INVALID_STATE_ERROR",Lt[Lt.DEVICE_SECURITY_ERROR=5306]="DEVICE_SECURITY_ERROR",Lt[Lt.DEVICE_ABORT_ERROR=5307]="DEVICE_ABORT_ERROR",Lt[Lt.CAMERA_RECOVER_FAILED=5308]="CAMERA_RECOVER_FAILED",Lt[Lt.MICROPHONE_RECOVER_FAILED=5309]="MICROPHONE_RECOVER_FAILED",Lt[Lt.SERVER_ERROR=5400]="SERVER_ERROR",Lt[Lt.NEED_TO_BUY=5401]="NEED_TO_BUY",Lt[Lt.ACCOUNT_NO_MONEY=-100013]="ACCOUNT_NO_MONEY",Lt[Lt.OPERATION_FAILED=5500]="OPERATION_FAILED",Lt[Lt.FIREWALL_RESTRICTION=5501]="FIREWALL_RESTRICTION",Lt[Lt.REJOIN_FAILED=5502]="REJOIN_FAILED",Lt[Lt.EVENT_HANDLER_ERROR=5503]="EVENT_HANDLER_ERROR",Lt[Lt.VIDEO_CONTEXT_ERROR=5504]="VIDEO_CONTEXT_ERROR",Lt[Lt.OPERATION_ABORT=5998]="OPERATION_ABORT",Lt[Lt.UNKNOWN_ERROR=5999]="UNKNOWN_ERROR",Lt),IV=uo(Pn({},ba),{INVALID_PARAMETER(r){let{fnName:a}=r;return"the parameters of the '".concat(a,"' you called does not meet the requirements, please check the API documentation.")},INVALID_PARAMETER_REQUIRED(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' is a required param when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_TYPE(r){let{key:a,rule:d,fnName:g,value:C}=r,A="".concat(a||d.name),w="";return w=Array.isArray(d.type)?d.type.join("|"):d.type,"'".concat(A,"' must be type of ").concat(w," when calling ").concat(g,"(), received type: ").concat(Ji(C),".")},INVALID_PARAMETER_EMPTY(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' cannot be '").concat(C,"' when calling ").concat(g,"().")},INVALID_PARAMETER_INSTANCE(r){let{key:a,rule:d,fnName:g,value:C}=r,A="".concat(a||d.name),w="".concat(d.instanceOf.name||d.instanceOf);return"'".concat(A,"' must be instanceof ").concat(w," when calling ").concat(g,"(), received type: ").concat(Ji(C),".")},INVALID_PARAMETER_RANGE(r){let{key:a,rule:d,fnName:g,value:C}=r;return"'".concat(a||d.name,"' must be one of ").concat(d.values.join("|")," when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_LESS_THAN_ZERO(r){let{key:a,rule:d,fnName:g}=r;return"'".concat(a||d.name,"' cannot be less than 0 when calling ").concat(g,"().")},INVALID_PARAMETER_MIN(r){let{key:a,rule:d,value:g}=r;return"the min value of ".concat(a||d.name," is ").concat(d.min,", received: ").concat(g,".")},INVALID_PARAMETER_MAX(r){let{key:a,rule:d,value:g}=r;return"the max value of ".concat(a||d.name," is ").concat(d.max,", received: ").concat(g,".")},INVALID_ELEMENT_ID(r){let{key:a,fnName:d}=r;return"'".concat(a,"' is not found in the document object when calling ").concat(d,"().")},INVALID_ELEMENT_ID_TYPE(r){let{key:a,fnName:d,type:g}=r;return"the element corresponding to '".concat(a,"' must be instanceof HTMLElement when calling ").concat(d,"(), received: ").concat(g,".")},INVALID_STREAM_ID(r){let{key:a}=r;return"'".concat(a,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores.")},INVALID_ROOM_ID_STRING(r){let{key:a}=r;return"'".concat(a,"' must be a valid string.")},INVALID_ROOM_ID_INTEGER(r){let{key:a}=r;return"'".concat(a,"' must be an integer between [1, 4294967294].")},INVALID_ROOM_ID_INTEGER_STRING(r){let{key:a}=r;return"'".concat(a,"' must be an integer but go a string, use 'parseInt' to convert it or use 'strRoomId' instead.")},INVALID_ROOM_ID_REQUIED:()=>"at least one of 'roomId'(between [1, 4294967294]) and 'strRoomId'(not empty) is required.",INVALID_STREAM_TYPE:r=>{let{fnName:a}=r;return"'streamType' is required when 'userId' is not '*', calling ".concat(a,"()")},INVALID_IMAGE_URL:"The 'src' param must be filled in when the background type is image.",INVALID_OPERATION(r){let{fnName:a}=r;return"the API '".concat(a,"' you called does not meet the requirements, please check the API documentation.")},INVALID_OPERATION_NOT_JOINED(r){let{fnName:a}=r;return"cannot ".concat(a," because you are not enter room yet.")},INVALID_OPERATION_REMOTE_USER_NOT_EXIST(r){let{fnName:a,value:d}=r;return"cannot ".concat(a," because remote user(userId: ").concat(d.userId,") does not publishing stream.")},INVALID_OPERATION_STREAM_TYPE_NOT_EXIST(r){let{fnName:a,value:d}=r;return"cannot ".concat(a," because remote user(userId: ").concat(d.userId,") does not publishing ").concat(d.streamType," video.")},INVALID_OPERATION_REPEAT_CALL(r){let{fnName:a}=r;return"you are already ".concat(a,"(), cannot repeated call '").concat(a,"'.")},INVALID_OPERATION_NEED_VIDEO(r){let{fnName:a}=r;return"cannot call '".concat(a,"' because the camera is not turned on.")},INVALID_OPERATION_NEED_AUDIO(r){let{fnName:a}=r;return"cannot call '".concat(a,"' because the microphone is not turned on.")},INVALID_BUFFER_EMPTY:r=>{let{key:a}=r;return"the buffer size of paramerter '".concat(a,"' cannot be empty")},INVALID_BUFFER_OVERSIZE:()=>"buffer size is over 1000 Bytes",INVALID_ROLE_AUDIENCE:()=>"role: '".concat("audience","' cannot call this api."),ENV_NOT_SUPPORTED(r){let{fnName:a}=r;return"the current browser does not support the capability of the function '".concat(a,"' you are calling, please check the API documentation.")},NOT_SUPPORTED_WEBRTC:"the current browser does not support WebRTC capability, please check the SDK documentation.",NOT_SUPPORTED_H264_ENCODE:"this browser does not support H264 encode.",NOT_SUPPORTED_H264_DECODE:"this browser does not support H264 decode.",NOT_SUPPORTED_SCREEN_SHARE:"this browser does not support screen share, please check the browser version.",NOT_SUPPORTED_SMALL_VIDEO:"this browser does not support small video, please check the browser version.",NOT_SUPPORTED_SEI:"this browser does not support SEI, please check the browser version.",NOT_SUPPORTED_WEBGL:"this browser does not support WebGL, please check the browser version.",NOT_SUPPORTED_CHROME_VERSION(r){let{fnName:a}=r;return"cannot call ".concat(a," because the browser version is too low, please upgrade to the latest version")},DEVICE_ERROR(r){let{fnName:a,error:d}=r;return"'".concat(a,"' got device exception").concat(d?", error: ".concat(d.toString(),"."):".")},DEVICE_NOT_FOUND_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"NotFoundError, no ".concat(d," detected, please check your device and the configuration on '").concat(a,"'").concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_NOT_ALLOWED_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"NotAllowedError, you have disabled ".concat(d," access, please allow the current application to use the ").concat(d).concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_NOT_READABLE_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"NotReadableError, the ".concat(d," maybe in use by another APP, please check if the device is pre-occupied by another APP.")},DEVICE_OVERCONSTRAINED_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"OverconstrainedError, the device ID is incorrect, please check whether the device ID passed in is correct".concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_INVALID_STATE_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"InvalidStateError, after the user clicks and interacts with the page, turn on the ".concat(d).concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_SECURITY_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"SecurityError, check whether the system security policy restricts the use of the ".concat(d,", and it is recommended to turn on the ").concat(d," after the user interacts with the page").concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_ABORT_ERROR(r){let{fnName:a,deviceType:d=Jh(a),error:g}=r;return"AbortError, an unknown exception in the system makes the device unusable, recommended to change the device or browser and re-check whether the device is normal".concat(g?" error: ".concat(g.toString(),"."):".")},CAMERA_RECOVER_FAILED(r){let{error:a}=r;return"camera recover capture failed ".concat((a==null?void 0:a.name)||"",": ").concat((a==null?void 0:a.originMessage)||(a==null?void 0:a.message))},MICROPHONE_RECOVER_FAILED(r){let{error:a}=r;return"microphone recover capture failed ".concat((a==null?void 0:a.name)||"",": ").concat((a==null?void 0:a.originMessage)||(a==null?void 0:a.message))},OPERATION_FAILED(r){let{fnName:a,error:d}=r;return"'".concat(a,"' failed, reason: ").concat(d==null?void 0:d.toString())},FIREWALL_RESTRICTION:()=>"media connection failure due to firewall restrictions, please try to change your network.",EVENT_HANDLER_ERROR(r){let{eventName:a}=r;return"an error was caught on trtc.on('".concat(a,"', handler), please check your code on 'handler'.")},VIDEO_CONTEXT_ERROR(r){let{reason:a,error:d}=r;return"video context error ".concat(a," ").concat((d==null?void 0:d.name)||""," ").concat((d==null?void 0:d.message)||"")},SERVER_ERROR(r){let{fnName:a,error:d}=r;return"'".concat(a,"' got server error: ").concat(d==null?void 0:d.toString(),", please check the SDK documentation.")},NEED_TO_BUY(r){let{value:a,url:d}=r;return"You need to buy packages for ".concat(a,". Refer to: ").concat(d)},ACCOUNT_NO_MONEY:r=>{let{fnParams:a}=r;return"your TRTC account run out of credit, please recharge.".concat(a.sdkAppId?" SDKAppId: ".concat(a.sdkAppId):"")},OPERATION_ABORT(r){let{fnName:a}=r;return"'".concat(a,"' abort")},UNKNOWN_ERROR(r){let{fnName:a,error:d}=r;return"'".concat(a,"' throw unknown exception").concat(d?", error: ".concat(d.toString(),"."):".")}});function Jh(r){if(!r)return"camera";let a=r.toLowerCase();return a.includes("screen")?"screen share":a.includes("audio")?"microphone":"camera"}var CS=class extends Error{constructor(r){let{code:a,extraCode:d,message:g="",messageParams:C,fnName:A="",originError:w}=r;var V;let U;U=g||function(j){let re,{code:ce,params:Te,enableDocLink:De=!1}=j,ze="",_t=bS[ce];try{re=IV[_t]}catch{re=IV.UNKNOWN_ERROR}return lr(re)?ze=re(Te):Ho(re)&&(ze=re),Te.fnName&&!ze.includes(Te.fnName)&&(ze[ze.length-1]!=="."&&(ze+="."),ze+=" thrown from ".concat(Te.fnName,"()")),De&&(ze+=" doc:"),ze}({code:d||a,params:Pn({fnName:A,error:w},C)}),super(U),_e(this,"name","RtcError"),_e(this,"code"),_e(this,"extraCode"),_e(this,"functionName"),_e(this,"message"),_e(this,"handler"),_e(this,"originError"),this.name=bS[a],this.code=a,this.extraCode=d,this.functionName=A,this.originError=w,this.message=U,this.extraCode===5302&&((V=this.originError)!=null&&V.message.includes("system"))&&(this.handler=()=>{let j=document.createElement("a");fg?j.href="ms-settings:privacy-".concat({startLocalVideo:"webcam",startLocalAudio:"microphone"}[this.functionName]):Bh&&(j.href="x-apple.systempreferences:com.apple.preference.security?Privacy_".concat({startLocalVideo:"Camera",startLocalAudio:"Microphone",startScreenShare:"ScreenCapture"}[this.functionName])),j.href.length>0&&j.click()})}static convertFrom(r,a,d){let g=r;if(r instanceof An){let{stack:C}=r,A={code:Yn.UNKNOWN_ERROR,fnName:a,originError:r};switch(r.getCode()){case rn.INVALID_PARAMETER:A.code=Yn.INVALID_PARAMETER,A.message=r.message;break;case rn.INVALID_OPERATION:A.code=Yn.INVALID_OPERATION;break;case rn.NOT_SUPPORTED:case rn.NOT_SUPPORTED_H264:A.code=Yn.ENV_NOT_SUPPORTED,r.getCode()===rn.NOT_SUPPORTED_H264&&(A.extraCode=r.message.includes(ba.NOT_SUPPORTED_H264ENCODE)?5203:5204);break;case rn.JOIN_ROOM_FAILED:A.messageParams={fnParams:d};case rn.SERVER_TIMEOUT:case rn.SWITCH_ROLE_FAILED:A.code=Yn.SERVER_ERROR,A.extraCode=r.getExtraCode();break;case rn.API_CALL_ABORTED:A.code=Yn.OPERATION_ABORT;break;case rn.DEVICE_NOT_FOUND:case rn.DEVICE_AUTO_RECOVER_FAILED:case rn.INITIALIZE_FAILED:A.code=5300,r.name&&(A.extraCode=function(w){let V;switch(w){case"NotFoundError":V=5301;break;case"NotAllowedError":V=5302;break;case"NotReadableError":V=5303;break;case"OverconstrainedError":V=5304;break;case"InvalidStateError":V=5305;break;case"SecurityError":V=5306;break;case"AbortError":V=5307;break;default:V=5300}return V}(r.name));break;case rn.UNKNOWN:break;default:A.code=Yn.OPERATION_FAILED}g=new CS(A),C&&(g.stack+=C.substr(C.indexOf(`
`)))}else{if(r instanceof CS)return r;g=new CS({code:Yn.UNKNOWN_ERROR,fnName:a,originError:r})}return g}},Hn=CS,bV={type:"object",properties:{cameraId:{type:"string"},useFrontCamera:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:["string","boolean"],values:[!0,!1,"view","publish","both"]},small:{properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack}}},CV={type:"object",properties:{systemAudio:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},profile:{type:["string","object"],properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack},audioTrack:{instanceOf:MediaStreamTrack}}},kg={type:["string",HTMLElement,null,"array"],arrayItem:{instanceOf:HTMLElement},validate(r,a,d){if(Ho(r)&&!document.getElementById(r))throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5009,fnName:d,messageParams:{key:a}})}},SV={name:"userId",required:!0,type:"string"},TV={type:"object",properties:{microphoneId:{type:"string"},audioTrack:{instanceOf:MediaStreamTrack},captureVolume:{type:"number",min:0},earMonitorVolume:{type:"number",min:0,max:100},profile:{values:[uc.AUDIO_PROFILE_STANDARD,uc.AUDIO_PROFILE_STANDARD_STEREO,uc.AUDIO_PROFILE_HIGH,uc.AUDIO_PROFILE_HIGH_STEREO]},echoCancellation:{type:"boolean"},autoGainControl:{type:"boolean"},noiseSuppression:{type:"boolean"}}};function Sy(r,a){if(!r)throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5101,fnName:a})}function EV(r,a,d){if(!r)throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5102,fnName:a,messageParams:{value:d}})}var Cre={create:[{name:"RoomConfig",instanceOf:Function},{name:"CreateConfig",type:"object",properties:{plugins:{type:"array",arrayItem:{instanceOf:Function}}}}],enterRoom:{name:"EnterRoomConfig",type:"object",required:!0,validate(r,a,d){if(this._room.isJoined)throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5104,fnName:d});if(r.roomId){if(Ho(r.roomId))throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5016,fnName:d,messageParams:{key:a}});if(!(/^[1-9]\d*$/.test(String(r.roomId))&&r.roomId<4294967295))throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5013,fnName:d,messageParams:{key:a}})}else{if(!r.strRoomId)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5015,fnName:d});if(!/^[A-Za-z\d\s!#$%&()+\-:;<=.>?@[\]^_{}|~,]{1,64}$/.test(r.strRoomId))throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5012,fnName:d,messageParams:{key:a}})}},properties:{sdkAppId:{required:!0,type:"number",allowEmpty:!1},userId:{required:!0,type:"string",allowEmpty:!1},userSig:{required:!0,type:"string",allowEmpty:!1},scene:{type:"string",values:["live","rtc"]},role:{type:"string",values:["audience","anchor"]},roomId:{type:["string","number"]},strRoomId:{type:"string"},proxy:{type:["object","string"],properties:{websocketProxy:{type:"string"},turnServer:{type:["object","array"],properties:{url:{required:!0,type:"string"},username:{type:"string"},credential:{type:"string"},credentialType:{type:"string",values:["password"]}}},loggerProxy:{type:"string"},webtransportProxy:{type:"string"}}},enableAutoPlayDialog:{type:"boolean"},userDefineRecordId:{type:"string"}}},startLocalVideo:{name:"LocalVideoConfig",type:"object",properties:{view:kg,mute:{type:["boolean","string"]},publish:{type:"boolean"},option:bV},validate(r){var a;if(((a=r==null?void 0:r.option)==null||!a.videoTrack)&&zh())throw new Hn({code:Yn.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalVideo:{name:"updateLocalVideoConfig",type:"object",required:!0,properties:{view:uo(Pn({},kg),{required:!1}),publish:{type:"boolean"},mute:{type:["boolean","string"]},option:bV}},startLocalAudio:{name:"LocalAudioConfig",type:"object",properties:{publish:{type:"boolean"},option:TV},validate(r){var a;if(((a=r==null?void 0:r.option)==null||!a.audioTrack)&&zh())throw new Hn({code:Yn.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalAudio:{name:"updateLocalAudioConfig",type:"object",required:!0,properties:{publish:{type:"boolean"},mute:{type:"boolean"},option:TV}},startScreenShare:{name:"ScreenShareConfig",type:"object",properties:{view:kg,publish:{type:"boolean"},option:CV},validate(r,a,d,g,C){var A;if(((A=r==null?void 0:r.option)==null||!A.videoTrack)&&zh())throw new Hn({code:Yn.ENV_NOT_SUPPORTED,extraCode:5201});if(!lS())throw new Hn({code:Yn.ENV_NOT_SUPPORTED,fnName:d,extraCode:5205})}},updateScreenShare:{name:"updateScreenShareConfig",type:"object",required:!0,properties:{view:kg,publish:{type:"boolean"},option:CV}},muteRemoteAudio:[SV,{name:"mute",required:!0,type:"boolean"}],setRemoteAudioVolume:[SV,{name:"volume",required:!0,type:"number",min:0}],startRemoteVideo:{name:"startRemoteVideoConfig",type:"object",required:!0,properties:{view:kg,userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(r,a,d){Sy(this._room.isJoined,d);let g=this._room.remotePublishedUserMap.get(r.userId);if(EV(!!g,d,r),g&&(r.streamType==="main"&&!g.muteState.videoAvailable||r.streamType==="sub"&&!g.muteState.hasAuxiliary))throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5103,fnName:d,messageParams:{value:r}})}},updateRemoteVideo:{name:"updateRemoteVideoConfig",type:"object",required:!0,properties:{view:uo(Pn({},kg),{required:!1}),userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(r,a,d){Sy(this._room.isJoined,d);let g=this._room.remotePublishedUserMap.get(r.userId);if(EV(!!g,d,r),g&&(r.streamType==="main"&&!g.muteState.videoAvailable||r.streamType==="sub"&&!g.muteState.hasAuxiliary))throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5103,fnName:d,messageParams:{value:r}})}},stopRemoteVideo:{name:"stopRemoteVideoConfig",type:"object",required:!0,properties:{userId:{type:"string",required:!0},streamType:{values:["main","sub"]}},validate(r,a,d){if(r.userId!=="*"&&Pt(r.streamType))throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5014,fnName:d})}},switchRole:{name:"role",required:!0,values:["anchor","audience"],validate(r,a,d){Sy(this._room.isJoining||this._room.isJoined,d)}},enableAudioVolumeEvaluation:[{name:"interval",type:"number"},{name:"enableInBackground",type:"boolean"}],sendSEIMessage:[{name:"buffer",required:!0,instanceOf:ArrayBuffer,validate(r,a,d,g){if(!cy)throw new Hn({code:Yn.ENV_NOT_SUPPORTED,fnName:d,extraCode:5207});if(!this._room.enableSEI)throw new Hn({code:Yn.INVALID_OPERATION,messageParams:{key:jn.SEI_DISABLED}});if(r.byteLength>1e3)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5018,fnName:d});if(r.byteLength===0)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5017,messageParams:{key:a},fnName:d});if(Sy(this._room.isJoined,d),!this._room.isMainStreamPublished)throw new Hn({code:Yn.INVALID_PARAMETER,messageParams:{key:jn.SEI_BEFORE_PUBLISH}})}},{name:"options",type:"object",properties:{seiPayloadType:{type:"number",values:[5,243]}}}],sendCustomMessage:{name:"message",required:!0,type:"object",properties:{cmdId:{type:"number",required:!0,min:1,max:10},data:{instanceOf:ArrayBuffer,required:!0,validate(r,a,d,g){if(r.byteLength>1e3)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5018,fnName:d});if(r.byteLength===0)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5017,fnName:d,messageParams:{key:a}})}}},validate(r,a,d){if(Sy(this._room.isJoined,d),this._room.scene==="live"&&this._room.role==="audience")throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5107,fnName:d,messageParams:{key:a}})}}},ai={TRTC:Cre},ys=class extends Error{};function Sre(r,a){let d=sy(r);for(let g=0;g<a.length;g++)Kh(d[g],a[g]);return d}function Tre(r){this._resolve=Promise.resolve(r)}function Ere(r){this._reject=Promise.reject(r)}var Ty=class{constructor(r,a){this.instance=r,this.group=a,this.started=!1,this.ops=[],this.startSame=()=>!0,this.mergeUpdate=Sre;let d=Ty.instances.get(r);d?d.set(a,this):Ty.instances.set(r,new Map([[a,this]]))}static get(r,a){let d=Ty.instances.get(r);return d&&d.get(a)||new Ty(r,a)}action(r,a,d){let g=w=>{var V;return r===0?this.started=!0:r===3&&(this.started=!1),this.ops.shift(),(V=this.currentOp)==null||V.action(),w},C=w=>{var V,U;throw this.ops.shift(),r===0&&((V=this.currentOp)==null?void 0:V.type)===2&&this.ops.shift().reject(new ys("start failed")),(U=this.currentOp)==null||U.action(),w},A={type:r,action:()=>a(...A.args).then(g,C),args:d,resolve:Tre,reject:Ere};try{switch(this.state){case 1:if(r===0)throw new ys("already started");break;case 4:if(r===2)throw new ys("not started");break;default:return this.cacheOp(A)}}catch(w){return Promise.reject(w)}return this.ops.push(A),A.promise=a(...A.args).then(g,C)}cacheOp(r){if(this.ops.length===1)switch(this.state){case 0:case 2:if(r.type===0)throw new ys("already start");break;case 3:switch(r.type){case 2:throw new ys("update not allowed when stopping");case 3:return this.currentOp.promise}break;default:throw new ys("unknown state")}else switch(r.type){case 3:if(this.lastOpType===3)return this.lastOp.promise;{let d=new ys("keep stop");if(this.ops.slice(1).forEach(g=>g.reject(d)),this.ops=this.ops.slice(0,1),this.state===3)return this.currentOp.promise}break;case 2:switch(this.lastOpType){case 2:return this.lastOp.args=this.mergeUpdate(this.lastOp.args,r.args),this.lastOp.promise;case 3:throw new ys("update not allowed after stop")}break;case 0:switch(this.lastOpType){case 2:throw new ys("start not allowed after update");case 0:throw new ys("duplicate start");case 3:if(this.startSame(this.currentOp.args,r.args))throw this.ops.pop().reject(new ys("keep start")),new ys("already start")}}r.promise=new Promise((d,g)=>{r._resolve?r._resolve.then(d):r.resolve=d,r._reject?r._reject.catch(g):r.reject=g});let{action:a}=r;return r.action=()=>a().then(r.resolve,r.reject),this.ops.push(r),r.promise}get lastOp(){return this.ops[this.ops.length-1]}get lastOpType(){return this.lastOp.type}get currentOp(){return this.ops[0]}get state(){return this.currentOp?this.currentOp.type:this.started?1:4}},Ey=Ty;Ey.instances=new WeakMap;var SS=new WeakMap,TS=(r,a)=>{if(a instanceof ys){let{stack:d}=a;a=new Hn({code:Yn.OPERATION_ABORT,message:"".concat(r," abort: ").concat(a.message),fnName:r}),d&&(a.stack+=d.substr(d.indexOf(`
`)))}throw a};function Xh(r,a){return cr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),w=0;w<C;w++)A[w]=arguments[w];let V=Ey.get(this,typeof r=="string"?r:r.call(this,...A));return a&&(V.startSame=a.bind(this)),V.action(0,d.bind(this),A).catch(TS.bind(null,g))})}function Ag(r,a){let{merge:d,debounce:g}=a||{};return cr((C,A)=>function(){for(var w=arguments.length,V=new Array(w),U=0;U<w;U++)V[U]=arguments[U];let j=Ey.get(this,typeof r=="string"?r:r.call(this,...V));if(d&&(j.mergeUpdate=d.bind(this)),g&&g.isNeedToDebounce.apply(this,V)){let{delay:re,getKey:ce}=g;return new Promise((Te,De)=>{var ze,_t;let Ft=(ze=SS.get(this))==null?void 0:ze.get(ce(...V));if(Ft){let{timeoutId:bt,resolve:yn}=Ft;clearTimeout(bt),yn()}let $t=setTimeout(()=>{if(j.state===3||j.state===4)return Te();j.action(2,C.bind(this),V).catch(TS.bind(null,A)).then(Te,De)},re);SS.has(this)?(_t=SS.get(this))==null||_t.set(ce(...V),{timeoutId:$t,resolve:Te}):SS.set(this,new Map([[ce(...V),{timeoutId:$t,resolve:Te}]]))})}return j.action(2,C.bind(this),V).catch(TS.bind(null,A))})}function Qh(r){return cr((a,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return Ey.get(this,typeof r=="string"?r:r.call(this,...C)).action(3,a.bind(this),C).catch(TS.bind(null,d))})}var Qn={ERROR:"error",AUTOPLAY_FAILED:"autoplay-failed",KICKED_OUT:"kicked-out",REMOTE_USER_ENTER:"remote-user-enter",REMOTE_USER_EXIT:"remote-user-exit",REMOTE_AUDIO_AVAILABLE:"remote-audio-available",REMOTE_AUDIO_UNAVAILABLE:"remote-audio-unavailable",REMOTE_VIDEO_AVAILABLE:"remote-video-available",REMOTE_VIDEO_UNAVAILABLE:"remote-video-unavailable",AUDIO_VOLUME:"audio-volume",NETWORK_QUALITY:"network-quality",CONNECTION_STATE_CHANGED:"connection-state-changed",AUDIO_PLAY_STATE_CHANGED:"audio-play-state-changed",VIDEO_PLAY_STATE_CHANGED:"video-play-state-changed",SCREEN_SHARE_STOPPED:"screen-share-stopped",DEVICE_CHANGED:"device-changed",PUBLISH_STATE_CHANGED:"publish-state-changed",TRACK:"track",STATISTICS:"statistics",SEI_MESSAGE:"sei-message",CUSTOM_MESSAGE:"custom-message"};function ES(r){return r==="sub"?"auxiliary":r==="auxiliary"?"sub":"main"}function Rg(r){return r===uc.QOS_PREFERENCE_CLEAR?"detail":r===uc.QOS_PREFERENCE_SMOOTH?"motion":""}var MS=new WeakMap;function Vi(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return cr((g,C)=>function(){for(var A=arguments.length,w=new Array(A),V=0;V<A;V++)w[V]=arguments[V];try{BR.call(this,a,w,C,this._name)}catch(U){return Promise.reject(U)}return g.apply(this,w)})}function MV(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return cr((g,C)=>function(){for(var A=arguments.length,w=new Array(A),V=0;V<A;V++)w[V]=arguments[V];try{BR.call(this,a,w,C,this._name)}catch(U){throw U}return g.apply(this,w)})}function BR(r,a,d,g){if(_i(r))for(let C=0;C<r.length;C++)kS.call(this,{rule:r[C],value:a[C],key:r[C].name,fnName:d,className:g});else kS.call(this,{rule:r,value:a[0],key:r.name,fnName:d,className:g})}function kS(r){let{rule:a,value:d,key:g,fnName:C,className:A}=r;function w(j){return{code:Yn.INVALID_PARAMETER,extraCode:j,fnName:C,messageParams:{key:g,rule:a,value:d}}}if(Pt(d)){if(a.required)throw new Hn(w(5001));if(Pt(a.defaultValue))return void(lr(a.validate)&&a.validate.call(this,d,g,C,A,this));d=a.defaultValue}if(Array.isArray(a.type)){let j=!1;for(let re=0;re<a.type.length;re++)a.type[re]===null&&d===null&&(j=!0),lr(a.type[re])&&d instanceof a.type[re]&&(j=!0),Ho(a.type[re])&&Ji(d)===a.type[re].toLowerCase()&&(j=!0);if(!j)throw new Hn({code:Yn.INVALID_PARAMETER,extraCode:5002,fnName:C,messageParams:{key:g,rule:{type:a.type.map(re=>uR(re)?b4(re):Ho(re)?re:Ji(re))},value:d}})}else if(!Pt(a.type)&&Ji(d)!==a.type)throw new Hn(w(5002));if(a.allowEmpty===!1){let j=si(d)&&(d===0||Number.isNaN(d)),re=Ho(d)&&d.trim()==="";if(j||re)throw new Hn(w(5003))}if(a.notLessThanZero&&si(d)&&d<0)throw new Hn(w(5006));if(!Pt(a.min)&&si(d)&&d<a.min)throw new Hn(w(5007));if(!Pt(a.max)&&si(d)&&d>a.max)throw new Hn(w(5008));if(Ho(a.instanceOf)){if(!d||d._name!==a.instanceOf)throw new Hn(w(5004))}else if(lr(a.instanceOf)&&!(d instanceof a.instanceOf))throw new Hn(w(5004));if(Array.isArray(a.values)&&!a.values.includes(d))throw new Hn(w(5005));let{properties:V}=a;oc(V)&&Eu(d)&&Object.keys(V).forEach(j=>{kS.call(this,{rule:V[j],value:d&&d[j],key:"".concat(j),fnName:C,className:A})});let{arrayItem:U}=a;oc(U)&&_i(d)&&d.forEach((j,re)=>{kS.call(this,{rule:U,value:j,key:"".concat(g,"[").concat(re,"]"),fnName:C,className:A})}),lr(a.validate)&&a.validate.call(this,d,g,C,A,this)}function ur(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{getRemoteId:a=()=>"",replaceArg:d,getKVReportKey:g}=r;return cr((C,A)=>function(){for(var w=arguments.length,V=new Array(w),U=0;U<w;U++)V[U]=arguments[U];function j(Te,De,ze){if(ze&&ze.includes(Te))return"hided";if(d){let _t=d(...V);if(V[_t.argIndex]===De)return _t.value}if(De===V||Te in V)return De;try{return De instanceof HTMLElement?"id: ".concat(De.id," type:").concat(Ji(De)):(JSON.stringify(De),De)}catch{return"type:".concat(Ji(De))}}let re=this._log||cn;V.length>0?re.info("".concat(A,"() ").concat(JSON.stringify(V,(Te,De)=>j(Te,De,["userSig","privateMapKey"])))):re.info("".concat(A,"()"));let ce=g?g(...V):X4[A];try{let Te=C.apply(this,V),De=To();return cR(Te)?Te.then(ze=>(re.info("".concat(A,"() success ").concat(a.call(this,...V))),Co.addSuccessEvent({key:ce,cost:To()-De}),ze)).catch(ze=>{throw ze=Hn.convertFrom.call(this,ze,A,V.length===1?V[0]:V),re.error("".concat(A,"() failed ").concat(a.call(this,...V)," ").concat(ze," params: ").concat(JSON.stringify(V,j))),Co.addFailedEvent({key:ce,error:ze}),ze}):(Co.addSuccessEvent({key:ce}),Te)}catch(Te){throw Te=Hn.convertFrom.call(this,Te,A),re.error("".concat(A,"() failed ").concat(Te," params: ").concat(JSON.stringify(V,j))),Co.addFailedEvent({key:ce,error:Te}),Te}})}var $R=r=>cr((a,d)=>function(g,C){return Ze(this,null,function*(){let A=this._plugins.get(g);if(!A)throw this._log.error("plugin ".concat(String(g)," is not found")),new Hn({code:Yn.OPERATION_ABORT,message:"plugin ".concat(String(g)," is not found"),fnName:d});return BR.call(this,A.getValidateRule(r),[C],d,"TRTC"),a.call(this,A,C)})}),HR=0,Mre=class{constructor(r,a){_e(this,"player"),_e(this,"publisher"),_e(this,"mixInput"),this.mixInput=new nV(a),r.url?(this.player=new Audio(r.url),this.player.crossOrigin="anonymous",this.publisher=new Audio(r.url),this.publisher.crossOrigin="anonymous",this.mixInput.replaceSource(this.publisher)):this.mixInput.replaceSource(r.track),r.loop&&(this.loop=r.loop),r.volume&&(this.volume=r.volume),this.mixInput.connect()}reset(){this.seek(0),this.mixInput.connect()}seek(r){!this.player||r<0&&r>this.player.duration||(this.player.currentTime=r,this.publisher.currentTime=r)}play(){var r,a;return(r=this.publisher)==null||r.play(),(a=this.player)==null?void 0:a.play()}pause(){var r,a;(r=this.player)==null||r.pause(),(a=this.publisher)==null||a.pause()}stop(){var r;(r=this.player)==null||r.pause(),this.mixInput.disconnect()}setOperation(r){r==="pause"&&this.pause(),r==="resume"&&(this.pause(),this.play()),r==="stop"&&(this.pause(),this.seek(0))}set volume(r){!this.player||!this.publisher||(this.player.volume=r,this.publisher.volume=r)}set loop(r){!this.player||!this.publisher||(this.player.loop=r,this.publisher.loop=r)}},My=class{constructor(r){this.core=r,_e(this,"log"),_e(this,"mixedMusicMap",new Map),_e(this,"cacheMusicMap",new Map),HR+=1,this.log=r.log.createChild({id:"".concat(this.getAlias()).concat(HR)}),this.log.info("[audioMixer] created id=".concat(this.getAlias()).concat(HR)),this.core=r}getName(){return My.Name}getAlias(){return"ax"}getGroup(r){return r==null?void 0:r.id}getValidateRule(r){switch(r){case"start":return My.startValidateRule;case"update":return My.updateValidateRule;case"stop":return My.stopValidateRule}}start(r){return Ze(this,null,function*(){let{room:a}=this.core;this.log.info("add music source, id: ".concat(r.id," url: ").concat(r.url,", track: ").concat(r.track));let{id:d,url:g}=r;if(this.mixedMusicMap.has(d))return;let C=this.cacheMusicMap.get(d);C?r.url?C.reset():(C.mixInput.replaceSource(r.track),C.mixInput.connect()):(C=new Mre(r,a.audioManager),this.cacheMusicMap.set(d,C)),yield C.play(),this.mixedMusicMap.set(d,C),this.log.info("start mix audio track ".concat(d," success.")),Co.addEnum({key:502700,value:3})})}update(r){return Ze(this,null,function*(){let{id:a,volume:d,loop:g,operation:C,seekFrom:A}=r;this.log.info("update music source, ".concat(JSON.stringify(r)));let w=this.mixedMusicMap.get(a);w?(Pt(d)||(w.volume=d),Pt(g)||(w.loop=g),Pt(C)||w.setOperation(C),Pt(A)||w.seek(A)):this.log.warn("update music source failed, music id: ".concat(a," not found."))})}stop(r){return Ze(this,arguments,function(a){var d=this;let{id:g}=a;return function*(){var C;d.mixedMusicMap.has(g)&&(d.log.info("remove music source, music id: ".concat(g)),(C=d.mixedMusicMap.get(g))==null||C.stop(),d.mixedMusicMap.delete(g)),g==="*"&&d.destroyAllMusic()}()})}destroyAllMusic(){this.log.info("destroy all music source."),this.mixedMusicMap.forEach((r,a)=>this.stop({id:a}))}destroyAllCache(){this.log.info("destroy all music cache."),this.cacheMusicMap.clear()}destroy(){this.log.info("destroy audio mixer plugin."),this.destroyAllMusic(),this.destroyAllCache()}},ky=My;_e(ky,"startValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},url:{type:"string",required:!1},track:{required:!1},loop:{type:"boolean"},volume:{type:"number"}},validate(r,a,d){if(r.url&&r.url!=="*"){let g=r.url.split("?")[0],C=["mp3","ogg","wav","flac"],A=g.split(".").pop(),w=C.indexOf(A)>=0,V=g.startsWith("blob"),U=g.startsWith("data");if(!(w||V||U))throw new Hn({code:Yn.INVALID_PARAMETER,message:"start audioMixer plugin: music url is invalid, please check your file format.",fnName:d})}if(!r.url&&!r.track)throw new Hn({code:Yn.INVALID_PARAMETER,message:"start audioMixer plugin: param url or track is required.",fnName:d})}}),_e(ky,"updateValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},loop:{type:"boolean"},volume:{type:"number"},seekFrom:{type:"number"},operation:{type:"string",values:["pause","resume","stop"]}}}),_e(ky,"stopValidateRule",{name:"options",type:"object",required:!0,properties:{id:{type:"string",required:!0}}}),_e(ky,"Name","AudioMixer");var kre=r=>(r=Number(r))>0&&r<14e8,qR=0,Ay=class{constructor(r){this.core=r,_e(this,"log"),_e(this,"workletReady"),_e(this,"audioContext",ku()),_e(this,"workletNode"),qR+=1,this.log=r.log.createChild({id:"".concat(this.getAlias()).concat(qR)}),this.log.info("[audioDenoiser] created id=".concat(this.getAlias()).concat(qR)),r.assetsPath&&(this.workletReady=mS(this.audioContext,"".concat(r.assetsPath,"/denoiser-wasm.js")),this.workletReady.catch(a=>{this.log.error("Init assets from ".concat(r.assetsPath," failed! Reason: ").concat(a))}))}static startValidateRule(r){return{name:"options",required:!0,type:"object",properties:{sdkAppId:{type:"number",required:!0},userId:{type:"string",required:!0},userSig:{type:"string",required:!0}},validate(a,d,g,C){if(!r.room.audioManager.hasAudioTrack)throw new Hn({code:Yn.INVALID_OPERATION,extraCode:5106,fnName:g})}}}getName(){return Ay.Name}getAlias(){return"ad"}getGroup(){return"AIDenoiser_".concat(Date.now())}getValidateRule(r){switch(r){case"start":return Ay.startValidateRule(this.core);case"update":return Ay.updateValidateRule;case"stop":return Ay.stopValidateRule}}start(r){return Ze(this,null,function*(){let{room:a}=this.core;if(this.workletReady||(this.workletReady=mS(this.audioContext,"".concat(r.assetsPath,"/denoiser-wasm.js")),this.workletReady.catch(d=>{this.log.error("Init assets from ".concat(r.assetsPath," failed! Reason: ").concat(d))})),!this.workletNode){let d=String(Date.now()).slice(0,-3),{auth:g,sign:C,status:A,message:w}=yield function(V){return Ze(this,arguments,function(U){let{sdkAppId:j,userId:re,userSig:ce,timestamp:Te}=U;return function*(){let De="https://".concat(function(Gn){let Vo;return Vo=kre(Gn)?kV.MAIN_OVERSEA:kV.MAIN,Vo}(j),"/api/v1/audioAiAuth?sdkAppId=").concat(j,"&userId=").concat(re,"&userSig=").concat(ce,"&timestamp=").concat(Te),ze=yield fetch(De),{data:{errCode:_t,errMsg:Ft,sign:$t,status:bt}}=yield ze.json();if(bt==="1")return{auth:!0,sign:$t,status:bt,message:Ft};let yn="Init RTCAIDenoiser failed.",Rn="";switch(_t){case 1:Rn="Please check your params.";break;case 2:Rn="You need to buy packages. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 3:Rn="Server is invalid. Please contact our engineer. ";break;case 4:Rn="Your packages is not active. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 5:Rn="Your packages is expired. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 6:Rn="Your version is not supported."}return{auth:!1,status:bt,message:Ft?"".concat(yn," Reason: ").concat(Ft,". ").concat(Rn):"".concat(yn,", ").concat(Rn)}}()})}(uo(Pn({},r),{timestamp:d}));if(!g)throw this.log.info("RTCAIDenoiser: ".concat(r.userId," auth result: ").concat(g,". Message: ").concat(w)),new Hn({code:Yn.INVALID_PARAMETER,message:w});yield this.workletReady,this.workletNode=new AudioWorkletNode(this.audioContext,"trtc-denoiser-processor",{numberOfInputs:1,numberOfOutputs:1}),this.workletNode.port.postMessage({type:"init",data:{sdkAppId:String(r.sdkAppId),userId:r.userId,timestamp:d,sign:C,status:A}}),this.workletNode.port.onmessage=V=>{let{data:U}=V;U.type==="cost"&&this.log.debug("[RTCAIDenoiser] ".concat(U.value))}}this.workletNode.port.postMessage({type:"enable"}),a.audioManager.addDenoiser(this.workletNode),a.sendAbilityStatus({ai_denoise:1})})}update(){return Ze(this,null,function*(){})}stop(){return Ze(this,null,function*(){if(!this.workletNode)return;let{room:r}=this.core;this.workletNode.port.postMessage({type:"disable"}),yield r.audioManager.removeDenoiser(this.workletNode)})}destroy(){}},AS=Ay;_e(AS,"updateValidateRule",{type:"object"}),_e(AS,"stopValidateRule",{type:"object"}),_e(AS,"Name","AIDenoiser");var kV={MAIN:"schedule.cloud-rtc.com",MAIN_OVERSEA:"schedule.rtc.tencentcloud.com"},AV=0,KR=new Set,bi=null;RF("5.6.1");var Are={RtcError:Hn,ErrorCode:Yn,ErrorCodeDictionary:bS},RS=class extends Lne.EventEmitter{constructor(r,a){super(),_e(this,"_room"),_e(this,"_eventListened",new Set),_e(this,"_localVideoTrack",null),_e(this,"_localAudioTrack",null),_e(this,"_localScreenTrack",null),_e(this,"_localScreenAudioTrack",null),_e(this,"_localVideoConfig",null),_e(this,"_localScreenConfig",null),_e(this,"_localAudioConfig",null),_e(this,"_remoteVideoConfigMap",new Map),_e(this,"_remoteAudioConfigMap",new Map),_e(this,"_remoteAudioMuteMap",new Map),_e(this,"_mediaTrackMap",new WeakMap),_e(this,"_log",cn.createLogger({id:"t".concat(++AV)})),_e(this,"_plugins",new Map),_e(this,"_networkQuality",null),_e(this,"_speakerId"),this._room=new r(Pn({logger:this._log,frameWorkType:RS.frameWorkType},a)),this._log.debug(JSON.stringify(a)),Object.defineProperties(this,{dumpAudio:{enumerable:!1,value(d){return this._room.audioManager.dump(d)}}}),a.plugins&&a.plugins.forEach(d=>{this._use(d,a.assetsPath)}),this._use(ky,a.assetsPath),this._use(AS,a.assetsPath),this._room.on("audio-volume",d=>{!d.find(g=>g.userId==="")&&this._localAudioTrack&&d.push({userId:"",volume:Math.floor(100*this._localAudioTrack.getAudioLevel())}),this.emit(Qn.AUDIO_VOLUME,{result:d.sort((g,C)=>C.volume-g.volume)})}),this._room.videoManager.on("error",d=>{let{reason:g,error:C}=d;this._log.error(new Hn({code:Yn.OPERATION_FAILED,extraCode:5504,messageParams:{reason:g,error:C}}))}),this._listenEvents(),this._initActiveSpeaker(),((d,g)=>{let{emit:C}=d;d.emit=function(){for(var A=arguments.length,w=new Array(A),V=0;V<A;V++)w[V]=arguments[V];try{return C.apply(d,w)}catch(U){let j=no({key:jn.CATCH_HANDLER_ERROR,data:{name:g,event:w[0]},addDocLink:!1});return cn.warn("".concat(j,`

`).concat(U.stack)),!1}}})(this,"trtc")}static create(r){}static _create(r,a){var d;yV&&(yV=!1,cn.getLogLevel()!==5&&(console.info("******************************************************************************"),console.info("*   TRTC Web SDK"),console.info("*   API Document: ".concat(Fh,"/en/index.html")),console.info("*   Changelog: ".concat(Fh,"/en/tutorial-01-info-changelog.html")),console.info("*   Report issues: https://github.com/LiteAVSDK/TRTC_Web/issues"),console.info("******************************************************************************")),cn.info("TRTC Web SDK Version:",nl),cn.info("UA:",navigator.userAgent),cn.info("URL: ".concat(location.href).concat(((d=self.frameElement)==null?void 0:d.tagName)==="IFRAME"?" in iframe":"")),rR().then(C=>{if(C){let A="UAData: ".concat(C.platform,"/").concat(C.platformVersion);C.architecture&&C.bitness&&(A+=" ".concat(C.architecture,"/").concat(C.bitness)),C.mobile&&(A+=" mobile"),C.model&&(A+=" model: ".concat(C.model)),C.fullVersionList&&(A+=" ".concat(C.fullVersionList.filter(w=>w.brand!=="Not/A)Brand").map(w=>"".concat(w.brand,"/").concat(w.version)).join(","))),cn.info(A)}}));let g=new RS(r,a||{});return KR.add(g),g}_listenEvents(){al(this,this._room).add("peer-join",r=>{let{userId:a}=r;this.emit(Qn.REMOTE_USER_ENTER,{userId:a})}).add("peer-leave",r=>{this.emit(Qn.REMOTE_USER_EXIT,{userId:r})}).add("banned",r=>{this._exitRoom().then(()=>{this.emit(Qn.KICKED_OUT,{reason:r.reason})})}).add("error",r=>{this._exitRoom().then(()=>{this.emit(Qn.ERROR,Hn.convertFrom(r))})}).add("signal-connection-state-changed",r=>{this.emit(Qn.CONNECTION_STATE_CHANGED,r)}).add("network-quality",r=>{this._networkQuality=r,this.emit(Qn.NETWORK_QUALITY,r)}).add("remote-published",r=>{[r.remoteAudioTrack,r.remoteVideoTrack,r.remoteAuxiliaryTrack].forEach(a=>{al(a,a).add("player-state-changed",d=>{let g=uo(Pn({},d),{userId:r.userId});a.kind===Pe.VIDEO&&(g.streamType=ES(a.streamType)),this.emit(a.kind===Pe.AUDIO?Qn.AUDIO_PLAY_STATE_CHANGED:Qn.VIDEO_PLAY_STATE_CHANGED,g)}).add("error",d=>{d.getCode()===rn.PLAY_NOT_ALLOWED&&this.emit(Qn.AUTOPLAY_FAILED,{userId:a.userId})})})}).add("remote-unpublished",r=>{[r.remoteAudioTrack,r.remoteVideoTrack,r.remoteAuxiliaryTrack].forEach(a=>{Xi(a)})}).add("remote-publish-state-changed",r=>{let{prevMuteState:a,muteState:d}=r,{userId:g}=d,C=a.audioAvailable,A=a.videoAvailable,{audioAvailable:w,videoAvailable:V}=d;w||this._remoteAudioConfigMap.delete(g),V||this._remoteVideoConfigMap.delete("".concat(g,"_","main")),d.hasAuxiliary||this._remoteVideoConfigMap.delete("".concat(g,"_","sub")),C!==w&&(this.emit(w?Qn.REMOTE_AUDIO_AVAILABLE:Qn.REMOTE_AUDIO_UNAVAILABLE,{userId:g}),w?this._onAudioAvailable({userId:g}):this._onAudioUnavailable({userId:g,muteState:d})),A!==V&&(this.emit(V?Qn.REMOTE_VIDEO_AVAILABLE:Qn.REMOTE_VIDEO_UNAVAILABLE,{userId:g,streamType:"main"}),V?this._onVideoAvailable({userId:g,streamType:"main"}):this._onVideoUnavailable({userId:g,streamType:"main"})),a.hasAuxiliary!==d.hasAuxiliary&&(this.emit(d.hasAuxiliary?Qn.REMOTE_VIDEO_AVAILABLE:Qn.REMOTE_VIDEO_UNAVAILABLE,{userId:g,streamType:"sub"}),d.hasAuxiliary?this._onVideoAvailable({userId:g,streamType:"sub"}):this._onVideoUnavailable({userId:g,streamType:"sub"}))}).add("firewall-restriction",()=>{this.emit(Qn.ERROR,new Hn({code:Yn.OPERATION_FAILED,extraCode:5501}))}).add("sei-message",r=>{this.emit(Qn.SEI_MESSAGE,uo(Pn({},r),{streamType:ES(r.streamType)}))}).add("heartbeat-report",r=>{var a,d,g,C,A,w,V;let U={2:"big",3:"small",7:"sub"},j={rtt:r.msg_up_stream_info.msg_network_status.uint32_rtt||((a=r.msg_down_stream_info[0])==null?void 0:a.msg_network_status.uint32_rtt)||((d=this._networkQuality)==null?void 0:d.uplinkRTT)||((g=this._networkQuality)==null?void 0:g.downlinkRTT)||0,upLoss:((C=this._networkQuality)==null?void 0:C.uplinkLoss)||0,downLoss:((A=this._networkQuality)==null?void 0:A.downlinkLoss)||0,bytesSent:r.bytes_sent||0,bytesReceived:r.bytes_received||0,localStatistics:{audio:{bitrate:(((w=r.msg_up_stream_info.msg_audio_status)==null?void 0:w.uint32_audio_codec_bitrate)||0)/1e3,audioLevel:(((V=r.msg_up_stream_info.msg_audio_status)==null?void 0:V.uint32_audio_level)||0)/Iu},video:r.msg_up_stream_info.msg_video_status.filter(re=>U[re.uint32_video_stream_type]).map(re=>({bitrate:(re.uint32_video_codec_bitrate||0)/1e3,width:re.uint32_video_width,height:re.uint32_video_height,frameRate:re.uint32_video_enc_fps,videoType:U[re.uint32_video_stream_type]}))},remoteStatistics:r.msg_down_stream_info.map(re=>({userId:re.msg_user_info.str_identifier,audio:{bitrate:(re.msg_audio_status.uint32_audio_codec_bitrate||0)/1e3,audioLevel:(re.msg_audio_status.uint32_audio_level||0)/Iu},video:re.msg_video_status.map(ce=>({bitrate:(ce.uint32_video_codec_bitrate||0)/1e3,width:ce.uint32_video_width,height:ce.uint32_video_height,frameRate:ce.uint32_video_dec_fps,videoType:U[ce.uint32_video_stream_type]}))}))};this.emit(Qn.STATISTICS,j)}).add("custom-message",r=>{this.emit(Qn.CUSTOM_MESSAGE,r)}),al(this,Ii).add("audioInputAdded",r=>{this.emit(Qn.DEVICE_CHANGED,{type:"microphone",action:"add",device:r})}).add("audioInputRemoved",r=>{this.emit(Qn.DEVICE_CHANGED,{type:"microphone",action:"remove",device:r})}).add("videoInputAdded",r=>{this.emit(Qn.DEVICE_CHANGED,{type:"camera",action:"add",device:r})}).add("videoInputRemoved",r=>{this.emit(Qn.DEVICE_CHANGED,{type:"camera",action:"remove",device:r})}).add("audioOutputAdded",r=>Ze(this,null,function*(){if(this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"add",device:r}),bi&&bi.deviceId===HC){let a=(yield Tg()).find(d=>d.deviceId===HC);a&&bi.groupId!==a.groupId&&(bi=a,this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"active",device:a}))}})).add("audioOutputRemoved",r=>Ze(this,null,function*(){this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"remove",device:r});let a=(yield Tg())[0];a&&bi&&(bi.deviceId===r.deviceId||bi.deviceId===HC&&bi.groupId!==a.groupId)&&(bi=a,this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"active",device:a}))}))}use(r){let a,d;"plugin"in r?(a=r.plugin,d=r.assetsPath):a=r,this._use(a,d||"https://web.sdk.qcloud.com/trtc/webrtc/v5/assets/")}_use(r,a){if(this._plugins.get(r.Name))return void this._log.warn("duplicate install plugin",r.Name);let d=new r(function(g,C,A){return{room:g,assetsPath:A,innerEmitter:Qt,constants:AF,environment:YF,utils:tl,eventLogger:Vr,log:g.getLogger(),errorModule:C,kvStatManager:Co,clearStarted(w,V){let U=w.getAlias(),j=Ey.instances.get(g);if(j)if(V){let re=j.get(U+V);if(!re)return;re.started=!1}else j.forEach((re,ce)=>{ce.startsWith(U)&&(re.started=!1)})}}}(this._room,Are,a));this._plugins.set(r.Name,d)}enterRoom(r){return Ze(this,null,function*(){var a,d;let{scene:g="rtc",enableAutoPlayDialog:C=!0,autoReceiveAudio:A=!0,autoReceiveVideo:w=!1}=r;r.proxy&&(this._room.setProxyServer(r.proxy),!Ho(r.proxy)&&r.proxy.turnServer&&((d=(a=this._room).setTurnServer)==null||d.call(a,r.proxy.turnServer,r.proxy.iceTransportPolicy))),this._room.enableAutoPlayDialog=C,this._room.autoReceiveAudio=A,this._room.autoReceiveVideo=w,vs(r.enableHWEncoder)&&(this._room.enableHWEncoder=r.enableHWEncoder);let V={sdkAppId:r.sdkAppId,userId:r.userId,userSig:r.userSig,privateMapKey:r.privateMapKey||null,role:r.role==="audience"?21:20,roomId:r.roomId||0,strRoomId:r.strRoomId||"",businessInfo:r.businessInfo||null,streamId:null,userDefineRecordId:r.userDefineRecordId||null,frameWorkType:r.frameWorkType,component:r.component,language:r.language};r.strRoomId&&!r.roomId?this._room.useStringRoomId=!0:this._room.useStringRoomId=!1,yield this._room.join(V,g,RS.frameWorkType),this._checkTrackToPublish()})}exitRoom(){return Ze(this,null,function*(){return yield this._exitRoom()})}switchRole(r,a){return Ze(this,null,function*(){a!=null&&a.privateMapKey&&(this._room.privateMapKey=a.privateMapKey),yield this._room.switchRole(r),r==="anchor"&&this._checkTrackToPublish()})}destroy(){Xi(this),this.removeAllListeners(),this._room.destroy(),KR.delete(this),this._localAudioTrack&&this.stopLocalAudio(),this._localVideoTrack&&this.stopLocalVideo(),this._localScreenTrack&&this.stopScreenShare(),this._plugins.forEach(r=>{var a;return(a=r.destroy)==null?void 0:a.call(r)})}startLocalAudio(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0};return function*(){if(r._localAudioTrack)return void r._log.warn("local audio is already started");let{publish:d=!0,mute:g,option:C}=a,A=new lc(r._room.audioManager),w={},V={muted:!0};C&&(Pt(C.microphoneId)?Pt(C.audioTrack)||(w.customSource=C.audioTrack):w.deviceId=C.microphoneId,C&&si(C.captureVolume)&&A.setCaptureVolume(C.captureVolume),Pt(C.profile)||(Ho(C.profile)?kA[C.profile]&&A.setProfile(kA[C.profile]):A.setProfile(C.profile)),si(C.earMonitorVolume)&&(V.muted=!(C.earMonitorVolume>0),V.volume=C.earMonitorVolume),Pt(C.echoCancellation)||(A.profile.echoCancellation=C.echoCancellation),Pt(C.noiseSuppression)||(A.profile.noiseSuppression=C.noiseSuppression),Pt(C.autoGainControl)||(A.profile.autoGainControl=C.autoGainControl)),A.on("5",U=>{r.emit(Qn.ERROR,new Hn({code:Yn.DEVICE_ERROR,extraCode:5309,messageParams:{error:U}}))}),A.on("2",U=>{r.emit(Qn.DEVICE_CHANGED,{type:"microphone",action:"active",device:U})}),A.on("4",U=>{let j;U.error&&(j=Hn.convertFrom(U.error)),r.emit(Qn.PUBLISH_STATE_CHANGED,uo(Pn({},U),{error:j}))}),r._listenOutputTrackChanged(A),r._speakerId&&A.setAudioOutput(r._speakerId),yield A.capture(w),Pt(g)||A.setMute(g),al(A,A).add("player-state-changed",U=>{r.emit(Qn.AUDIO_PLAY_STATE_CHANGED,uo(Pn({},U),{userId:""}))}),d&&r._room.isJoined&&r._room.publish(A).catch(()=>{}),r._localAudioTrack=A,r._localAudioConfig=uo(Pn({},a),{publish:d}),yield r._updateAudioPlayOption({playOption:V,track:A})}()})}updateLocalAudio(r){return Ze(this,null,function*(){if(!this._localAudioTrack||!this._localAudioConfig)return;let{publish:a,mute:d,option:g}=r,C={};g&&(g.microphoneId?yield this._localAudioTrack.switchDevice(g.microphoneId):Pt(g.audioTrack)||(yield this._localAudioTrack.setInputMediaStreamTrack(g.audioTrack)),Pt(g.captureVolume)||this._localAudioTrack.setCaptureVolume(g.captureVolume),Pt(g.earMonitorVolume)||(C.muted=!(g.earMonitorVolume>0),C.volume=g.earMonitorVolume),yield this._localAudioTrack.update3A(g)),this._room.isJoined&&!Pt(a)&&(a&&!this._localAudioConfig.publish&&this._room.publish(this._localAudioTrack).catch(()=>{}),this._localAudioConfig.publish&&!a&&this._room.unpublish(this._localAudioTrack).catch(()=>{})),Pt(d)||this._localAudioTrack.setMute(d),yield this._updateAudioPlayOption({playOption:C,track:this._localAudioTrack,prevConfig:this._localAudioConfig}),Kh(this._localAudioConfig,r)})}stopLocalAudio(){return Ze(this,null,function*(){!this._localAudioTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localAudioTrack).catch(()=>{})),this._localAudioTrack.stop(),this._localAudioTrack.close(),this._room.audioManager.removeInput(this._localAudioTrack),Xi(this._localAudioTrack),this._localAudioTrack=null,this._localAudioConfig=null)})}startLocalVideo(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(r._localVideoTrack)return void r._log.warn("local video is already started");let{view:d,publish:g=!0,mute:C,option:A}=a,w=new _s(r._room.videoManager),V={},U={};if(A&&(A.cameraId?V.deviceId=A.cameraId:Pt(A.useFrontCamera)?Pt(A.videoTrack)||(V.customSource=A.videoTrack):V.facingMode=A.useFrontCamera?Pe.FACING_MODE_USER:Pe.FACING_MODE_ENVIRONMENT,Pt(A.profile)||(Ho(A.profile)?ol[A.profile]&&w.setProfile(ol[A.profile]):w.setProfile(A.profile)),Pt(A.fillMode)||(U.objectFit=A.fillMode),Pt(A.mirror)||(U.mirror=A.mirror),Pt(A.small)||(cS()?Ho(A.small)?w.small=ol[A.small]:A.small===!0?w.small=ol["120p"]:w.small=A.small:r._log.warn("small stream is not supported"))),w.on("5",j=>{r.emit(Qn.ERROR,new Hn({code:Yn.DEVICE_ERROR,extraCode:5308,messageParams:{error:j}}))}),w.on("2",j=>{r.emit(Qn.DEVICE_CHANGED,{type:"camera",action:"active",device:j})}),w.on("4",j=>{let re;j.error&&(re=Hn.convertFrom(j.error)),r.emit(Qn.PUBLISH_STATE_CHANGED,uo(Pn({},j),{error:re}))}),r._listenOutputTrackChanged(w),yield w.capture(V),Pt(C)||(yield w.setMute(C)),w.mediaTrack)if(A!=null&&A.qosPreference){let j=Rg(A.qosPreference);w.mediaTrack.contentHint=j}else A!=null&&A.videoTrack||(w.mediaTrack.contentHint=Rg(uc.QOS_PREFERENCE_SMOOTH));al(w,w).add("player-state-changed",j=>{r.emit(Qn.VIDEO_PLAY_STATE_CHANGED,uo(Pn({},j),{userId:"",streamType:"main"}))}),g&&r._room.isJoined&&r._room.publish(w).catch(()=>{}),r._localVideoTrack=w,r._localVideoConfig=uo(Pn({},a),{view:d,publish:g}),yield r._updateVideoPlayOption({view:d,playOption:U,track:w})}()})}updateLocalVideo(r){return Ze(this,null,function*(){if(!this._localVideoTrack||!this._localVideoConfig)return;let{view:a,publish:d,mute:g,option:C}=r,A={};if(C){if(Pt(C.profile)||(Ho(C.profile)?ol[C.profile]&&this._localVideoTrack.setProfile(ol[C.profile]):this._localVideoTrack.setProfile(C.profile),(!C.cameraId||!this._localVideoTrack.isNeedToSwitchDevice(C.cameraId))&&Pt(C.useFrontCamera)&&this._localVideoTrack.applyProfile()),C.cameraId?yield this._localVideoTrack.switchDevice(C.cameraId):Pt(C.useFrontCamera)?Pt(C.videoTrack)||(yield this._localVideoTrack.setInputMediaStreamTrack(C.videoTrack)):yield this._localVideoTrack.switchDevice(C.useFrontCamera?Pe.FACING_MODE_USER:Pe.FACING_MODE_ENVIRONMENT),Pt(C.fillMode)||(A.objectFit=C.fillMode),Pt(C.mirror)||(A.mirror=C.mirror),C.qosPreference&&this._localVideoTrack.mediaTrack){let w=Rg(C.qosPreference);this._localVideoTrack.mediaTrack.contentHint=w}if(C.small){let w=!this._localVideoTrack.small;cS()?(C.small===!0?this._localVideoTrack.small=ol["120p"]:Ho(C.small)?this._localVideoTrack.small=ol[C.small]:this._localVideoTrack.small=C.small,this._room.videoManager.update(),w&&this._room.enableSmall(!0)):this._log.warn("small stream is not supported")}else C.small===!1&&this._localVideoTrack.small&&(delete this._localVideoTrack.small,this._room.videoManager.update(),this._room.enableSmall(!1))}this._room.isJoined&&!Pt(d)&&(d&&!this._localVideoConfig.publish&&this._room.publish(this._localVideoTrack).catch(()=>{}),this._localVideoConfig.publish&&!d&&this._room.unpublish(this._localVideoTrack).catch(()=>{})),Pt(g)||(yield this._localVideoTrack.setMute(g)),yield this._updateVideoPlayOption({view:a,playOption:A,track:this._localVideoTrack,prevConfig:this._localVideoConfig}),Kh(this._localVideoConfig,r)})}stopLocalVideo(){return Ze(this,null,function*(){!this._localVideoTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localVideoTrack).catch(()=>{})),this._localVideoTrack.stop(),this._localVideoTrack.close(),Xi(this._localVideoTrack),this._localVideoTrack=null,this._localVideoConfig=null)})}startScreenShare(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(r._localScreenTrack)return void r._log.warn("screen share is already started");let{view:d=null,publish:g=!0,option:C}=a,A=new Yh(r._room.videoManager);A.on("4",re=>{let ce;re.error&&(ce=Hn.convertFrom(re.error)),r.emit(Qn.PUBLISH_STATE_CHANGED,uo(Pn({},re),{error:ce}))}),r._listenOutputTrackChanged(A);let w=null,V={},U={};C&&(Pt(C.profile)||(Ho(C.profile)?AA[C.profile]&&A.setProfile(AA[C.profile]):A.setProfile(C.profile)),C.systemAudio&&(V.systemAudio=!0,V.echoCancellation=C.echoCancellation,V.noiseSuppression=C.noiseSuppression,V.autoGainControl=C.autoGainControl),Pt(C.fillMode)||(U.objectFit=C.fillMode),C.videoTrack&&(V.videoTrack=C.videoTrack),C.audioTrack&&(V.audioTrack=C.audioTrack),C.captureElement&&(V.captureElement=C.captureElement),C.preferDisplaySurface&&(V.preferDisplaySurface=C.preferDisplaySurface));let j=yield A.capture(V);if(C!=null&&C.qosPreference){let re=Rg(C.qosPreference);A.mediaTrack.contentHint=re}else C!=null&&C.videoTrack||(A.mediaTrack.contentHint=Rg(uc.QOS_PREFERENCE_CLEAR));if(A.mediaTrack.addEventListener(Pe.ENDED,()=>{r._stopScreenShare(),r.emit(Qn.SCREEN_SHARE_STOPPED)}),j.getAudioTracks()[0]&&(w=new yy(r._room.audioManager),w.setInputMediaStreamTrack(j.getAudioTracks()[0]),r._speakerId&&w.setAudioOutput(r._speakerId)),al(A,A).add("player-state-changed",re=>{r.emit(Qn.VIDEO_PLAY_STATE_CHANGED,uo(Pn({},re),{userId:"",streamType:"sub"}))}),g&&r._room.isJoined){let re=[A];w&&re.push(w),r._room.publish(...re).catch(()=>{})}r._localScreenTrack=A,r._localScreenAudioTrack=w,r._localScreenConfig=uo(Pn({},a),{view:d,publish:g}),yield r._updateVideoPlayOption({view:d,playOption:U,track:A})}()})}updateScreenShare(r){return Ze(this,null,function*(){if(!this._localScreenTrack||!this._localScreenConfig)return;let{view:a,publish:d,option:g}=r,C={};if(g&&(Pt(g.fillMode)||(C.objectFit=g.fillMode),g.qosPreference)){let A=Rg(g.qosPreference);this._localScreenTrack.mediaTrack.contentHint=A}this._room.isJoined&&!Pt(d)&&(d&&!this._localScreenConfig.publish&&(this._room.publish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.publish(this._localScreenAudioTrack).catch(()=>{})),this._localScreenConfig.publish&&!d&&(this._room.unpublish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.unpublish(this._localScreenAudioTrack).catch(()=>{}))),yield this._updateVideoPlayOption({view:a,playOption:C,track:this._localScreenTrack,prevConfig:this._localScreenConfig}),Kh(this._localScreenConfig,r)})}stopScreenShare(){return Ze(this,null,function*(){return yield this._stopScreenShare()})}startRemoteVideo(r){return Ze(this,null,function*(){let{view:a,userId:d,streamType:g,option:C}=r,A="".concat(d,"_").concat(g);if(this._remoteVideoConfigMap.has(A))return void this._log.warn("remote video has already started. userId:".concat(d,", streamType:").concat(g));let w=this._room.remotePublishedUserMap.get(d);if(!w)return;let V={},U=g==="main"?w.remoteVideoTrack:w.remoteAuxiliaryTrack;this._listenOutputTrackChanged(U),C&&(Pt(C.fillMode)||(V.objectFit=C.fillMode),Pt(C.mirror)||(V.mirror=C.mirror),g==="main"&&!Pt(C.small)&&(w.remoteVideoTrack.setMediaType(C.small?8:4),this._room.changeType(C.small,U.user))),yield this._room.subscribe(U),yield this._updateVideoPlayOption({view:a,playOption:V,track:U}),this._emitTrackEvent(U),this._remoteVideoConfigMap.set(A,{config:r}),C&&!Pt(C.receiveWhenViewVisible)&&this._observeView({remoteTrack:U,view:a,receiveWhenViewVisible:C.receiveWhenViewVisible,viewRoot:C==null?void 0:C.viewRoot})})}updateRemoteVideo(r){return Ze(this,null,function*(){var a,d;let{view:g,userId:C,streamType:A,option:w}=r,V="".concat(C,"_").concat(A),U=this._remoteVideoConfigMap.get(V);if(!U||!this._room.remotePublishedUserMap.has(C))return;let j={};w&&(Pt(w.fillMode)||(j.objectFit=w.fillMode),Pt(w.mirror)||(j.mirror=w.mirror));let re=null,ce=this._room.remotePublishedUserMap.get(C);if(A==="main"&&(ce!=null&&ce.muteState.hasVideo)&&(re=ce.remoteVideoTrack),A==="sub"&&(ce!=null&&ce.muteState.hasAuxiliary)&&(re=ce.remoteAuxiliaryTrack),!re)return;let{config:Te}=U;A==="main"&&w&&!Pt(w.small)&&this._room.changeType(w.small,re.user),yield this._updateVideoPlayOption({view:g,playOption:j,track:re,prevConfig:Te}),Kh(Te,r);let De=Pt(w==null?void 0:w.receiveWhenViewVisible)?(a=Te.option)==null?void 0:a.receiveWhenViewVisible:w.receiveWhenViewVisible,ze=Pt(g)?Te.view:g,_t=Pt(w==null?void 0:w.viewRoot)?(d=Te.option)==null?void 0:d.viewRoot:w.viewRoot;this._observeView({remoteTrack:re,view:ze,receiveWhenViewVisible:De,viewRoot:_t})})}stopRemoteVideo(r){return Ze(this,null,function*(){return this._stopRemoteVideo(r)})}_stopRemoteVideo(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Ze(this,null,function*(){let d=[],g=this._room.remotePublishedUserMap.get(r.userId);if(g){let{muteState:A,remoteVideoTrack:w,remoteAuxiliaryTrack:V}=g;r.streamType==="main"&&(w.stop(),A.hasVideo&&d.push(w)),r.streamType==="sub"&&(V.stop(),A.hasAuxiliary&&d.push(V))}for(let A of d)a&&(yield this._room.unsubscribe(A),this._mediaTrackMap.get(A.outMediaTrack)===A.userId&&this._mediaTrackMap.delete(A.outMediaTrack));let C=this._remoteVideoConfigMap.get("".concat(r.userId,"_").concat(r.streamType));C&&C.observer&&C.observer.disconnect(),this._remoteVideoConfigMap.delete("".concat(r.userId,"_").concat(r.streamType))})}muteRemoteAudio(r,a){return Ze(this,null,function*(){if(r==="*")if(a)yield this._stopRemoteAudio({userId:r});else{let d=[...this._room.remotePublishedUserMap.values()];for(let g of d)g.muteState.hasAudio&&(yield this._startRemoteAudio({userId:g.userId}))}else a?yield this._stopRemoteAudio({userId:r}):yield this._startRemoteAudio({userId:r});this._remoteAudioMuteMap.set(r,a)})}setRemoteAudioVolume(r,a){if(r==="*"){let d=[...this._room.remotePublishedUserMap.values()];for(let g of d)this._updateAudioPlayOption({playOption:{volume:a},track:g.remoteAudioTrack})}else if(r){let d=this._room.remotePublishedUserMap.get(r);d&&this._updateAudioPlayOption({playOption:{volume:a},track:d.remoteAudioTrack})}}startPlugin(r,a){return Ze(this,null,function*(){return r.start(a)})}updatePlugin(r,a){return Ze(this,null,function*(){return r.update(a)})}stopPlugin(r,a){return Ze(this,null,function*(){return r.stop(a)})}enableAudioVolumeEvaluation(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._room.enableAudioVolumeEvaluation(r,a)}on(r,a,d){return this.listeners(r).includes(a)||(super.on(r,a,d),this._eventListened.add(r)),this}off(r,a,d){return r==="*"?(this._eventListened.clear(),this.removeAllListeners()):super.off(r,a,d),this}getAudioTrack(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"};var a,d;let g,C="main";if(Ho(r)?g=r:(g=r.userId,r.streamType&&(C=r.streamType)),!g)return C==="sub"?((a=this._localScreenAudioTrack)==null?void 0:a.mediaTrack)||null:((d=this._localAudioTrack)==null?void 0:d.mediaTrack)||null;{let A=this._room.remotePublishedUserMap.get(g);if(A)return A.remoteAudioTrack.mediaTrack}return null}getVideoTrack(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"},{userId:a="",streamType:d="main"}=r;if(a===""){if(d==="main"&&this._localVideoTrack)return this._localVideoTrack.mediaTrack;if(d==="sub"&&this._localScreenTrack)return this._localScreenTrack.mediaTrack}else{let g=this._room.remotePublishedUserMap.get(a);if(g)return d==="main"?g.remoteVideoTrack.mediaTrack:g.remoteAuxiliaryTrack.mediaTrack}return null}getVideoSnapshot(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{userId:a,streamType:d="main"}=r;if(a){let g=this._room.remotePublishedUserMap.get(a);if(d==="main"&&(g!=null&&g.muteState.hasVideo))return g.remoteVideoTrack.getVideoFrame();if(d==="sub"&&(g!=null&&g.muteState.hasAuxiliary))return g.remoteAuxiliaryTrack.getVideoFrame()}else{if(d==="main"&&this._localVideoTrack)return this._localVideoTrack.getVideoFrame();if(d==="sub"&&this._localScreenTrack)return this._localScreenTrack.getVideoFrame()}return""}setCurrentSpeaker(r){var a,d;this._speakerId=r,(a=this._localAudioTrack)==null||a.setAudioOutput(r),(d=this._localScreenAudioTrack)==null||d.setAudioOutput(r),this._room.remotePublishedUserMap.forEach(g=>g.remoteAudioTrack.setAudioOutput(r))}_startRemoteAudio(r){return this._doStartRemoteAudio(r)}_doStartRemoteAudio(r){return Ze(this,null,function*(){let{userId:a,option:d}=r;if(this._remoteAudioConfigMap.has(a))return void this._log.warn("remote audio has already started. userId:".concat(a));let g=this._room.remotePublishedUserMap.get(a);if(!g)return;let C={};d&&(Pt(d.volume)||(C.volume=d.volume));let A=g.remoteAudioTrack;this._listenOutputTrackChanged(A),this._speakerId&&A.setAudioOutput(this._speakerId);try{this._remoteAudioConfigMap.set(a,r),yield this._room.subscribe(A),yield this._updateAudioPlayOption({playOption:C,track:A})}catch(w){throw this._remoteAudioConfigMap.delete(a),w}this._emitTrackEvent(A)})}_stopRemoteAudio(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Ze(this,null,function*(){let d=this._room.remotePublishedUserMap.get(r.userId);d&&(d.remoteAudioTrack.stop(),d.muteState.hasAudio&&a&&(yield this._room.unsubscribe(d.remoteAudioTrack)),this._mediaTrackMap.get(d.remoteAudioTrack.outMediaTrack)===r.userId&&this._mediaTrackMap.delete(d.remoteAudioTrack.outMediaTrack)),this._remoteAudioConfigMap.delete("".concat(r.userId))})}_updateVideoPlayOption(r){return Ze(this,arguments,function(a){let{view:d,playOption:g,track:C,prevConfig:A}=a;return function*(){if(C.setMirror(g.mirror),Pt(d)&&A&&A.view&&!S4(g)){let w=sS(A.view);w.length>0&&(yield C.play(w,g))}if(!Pt(d)){let w=sS(d);w.length>0?yield C.play(w,g):C.stop()}}()})}_updateAudioPlayOption(r){return Ze(this,arguments,function(a){let{playOption:d={},track:g,prevConfig:C}=a;return function*(){if(!g.isPlayCalled)try{yield g.play(null,d)}catch{}Pt(d.muted)||g.setPlayerMute(d.muted),Pt(d.volume)||g.setAudioVolume(d.volume/100)}()})}_listenOutputTrackChanged(r){r.listeners("output-media-track-changed").length===0&&r.on("output-media-track-changed",()=>this._emitTrackEvent(r))}_emitTrackEvent(r){let a=r.isRemote?r.userId:"";r.outMediaTrack&&this._mediaTrackMap.get(r.outMediaTrack)!==a&&(this._mediaTrackMap.set(r.outMediaTrack,a),this.emit(Qn.TRACK,{userId:a,streamType:ES(r.streamType),track:r.outMediaTrack}))}_checkTrackToPublish(){var r,a,d;let g=[];if((r=this._localAudioConfig)!=null&&r.publish&&this._localAudioTrack&&g.push(this._localAudioTrack),(a=this._localVideoConfig)!=null&&a.publish&&this._localVideoTrack&&g.push(this._localVideoTrack),(d=this._localScreenConfig)!=null&&d.publish&&(this._localScreenTrack&&g.push(this._localScreenTrack),this._localScreenAudioTrack&&g.push(this._localScreenAudioTrack)),g.length!==0)return this._room.publish(...g).catch(()=>{})}_observeView(r){let{remoteTrack:a,view:d,receiveWhenViewVisible:g=!1,viewRoot:C}=r;if(Pt(d))return;let A=this._remoteVideoConfigMap.get("".concat(a.userId,"_").concat(ES(a.streamType)));if(!A)return;let w=A.observer||void 0;if(d===null||_i(d)&&d.length===0||!g)return w==null||w.disconnect(),void(a.isSubscribed||this._room.subscribe(a).catch(()=>{}));let V=A.visibleViewMap||new Map,U=-1;(!w||w.root!==C)&&(w==null||w.disconnect(),V.clear(),w=new IntersectionObserver(re=>{re.forEach(ce=>{V.set(ce.target,ce.isIntersecting)}),clearTimeout(U),U=window.setTimeout(()=>{[...V.values()].find(ce=>ce)?a.isSubscribed||this._room.subscribe(a).catch(()=>{}):a.isSubscribed&&this._room.unsubscribe(a).catch(()=>{})},200)},{root:C}));let j=new Set(sS(d));V.forEach((re,ce)=>{j.has(ce)||(w.unobserve(ce),V.delete(ce))}),j.forEach(re=>{V.set(re,!0),w.observe(re)}),w.takeRecords().forEach(re=>{V.set(re.target,re.isIntersecting)}),A.visibleViewMap=V,A.observer=w}_exitRoom(){return Ze(this,null,function*(){this._room.isJoined&&(yield this._room.leave()),new Set([...this._remoteAudioConfigMap.keys(),...this._remoteAudioMuteMap.keys()]).forEach(r=>{this._stopRemoteAudio({userId:r}).catch()}),[...this._remoteVideoConfigMap.keys()].forEach(r=>{let a=r.includes("main")?"main":"sub",d=r.split("_".concat(a))[0];d&&this._stopRemoteVideo({userId:d,streamType:a}).catch()}),this._remoteVideoConfigMap.clear(),this._remoteAudioConfigMap.clear(),this._remoteAudioMuteMap.clear(),this._room.remotePublishedUserMap.forEach(r=>{Xi(r.remoteAudioTrack),Xi(r.remoteVideoTrack),Xi(r.remoteAuxiliaryTrack)})})}_stopScreenShare(){return Ze(this,null,function*(){var r;if(this._localScreenTrack){if(this._room.isJoined){let a=[this._localScreenTrack];this._localScreenAudioTrack&&a.push(this._localScreenAudioTrack),yield(r=this._room)==null?void 0:r.unpublish(...a).catch(()=>{})}this._localScreenTrack.stop(),this._localScreenTrack.close(),this._localScreenAudioTrack&&(this._localScreenAudioTrack.stop(),this._localScreenAudioTrack.close(),this._room.audioManager.removeInput(this._localScreenAudioTrack),this._localScreenAudioTrack=null),Xi(this._localScreenTrack),this._localScreenTrack=null,this._localScreenConfig=null}})}_initActiveSpeaker(){return Ze(this,null,function*(){if(bi&&!gy(bi))this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"active",device:bi});else{let r=yield Tg();if(r[0]&&!gy(r[0]))bi=r[0],this.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"active",device:r[0]});else{let a=d=>{let{track:g}=d;g.kind==="audio"&&(!bi||gy(bi))&&(this._initActiveSpeaker(),Qt.off("102",this._initActiveSpeaker))};Qt.on("102",a)}}})}_onAudioAvailable(r){let{userId:a}=r,d=this._remoteAudioMuteMap.has(a)?this._remoteAudioMuteMap.get(a):this._remoteAudioMuteMap.get("*");(d===!1||this._room.autoReceiveAudio&&!d)&&this._doStartRemoteAudio({userId:a}).catch(()=>{})}_onVideoAvailable(r){let{userId:a,streamType:d}=r;if(!this._room.autoReceiveVideo)return;let g=this._room.remotePublishedUserMap.get(a);if(g){let C=d==="main"?g.remoteVideoTrack:g.remoteAuxiliaryTrack;this._room.subscribe(C).then(()=>{this._emitTrackEvent(C)}).catch(()=>{})}}_onAudioUnavailable(r){let{userId:a,muteState:d}=r;d.hasAudio&&d.audioMuted||this._stopRemoteAudio({userId:a},!1).catch(()=>{})}_onVideoUnavailable(r){let{userId:a,streamType:d}=r;this._stopRemoteVideo({userId:a,streamType:d},!1).catch(()=>{})}sendSEIMessage(r,a){this._room.sendSEI(r,a||{seiPayloadType:243})}sendCustomMessage(r){var a,d;(d=(a=this._room).sendCustomMessage)==null||d.call(a,r)}static setLogLevel(r,a){cn.setLogLevel(r),Pt(a)||(a?cn.enableUploadLog():cn.disableUploadLog())}static isSupported(){return _R()}static getCameraList(){return Au(!0)}static getMicrophoneList(){return ac(!0)}static getSpeakerList(){return Tg(!0)}static setCurrentSpeaker(r){return Ze(this,null,function*(){(yield Tg()).forEach(a=>{a.deviceId===r&&(KR.forEach(d=>{d.setCurrentSpeaker(r),d.emit(Qn.DEVICE_CHANGED,{type:"speaker",action:"active",device:a})}),bi=a)})})}static _addKVStat(r){let{type:a,key:d,value:g,base:C,useUV:A,version:w}=r;switch(w&&(py.version=w),a){case"count":py.addCount({key:d,useUV:A});break;case"enum":py.addEnum({key:d,value:g,useUV:A});break;case"number":py.addNumber({key:d,value:g,split:C})}}},ao=RS;_e(ao,"_loggerManager",cn),_e(ao,"EVENT",Qn),_e(ao,"ERROR_CODE",Yn),_e(ao,"TYPE",uc),_e(ao,"frameWorkType",30),mn([ur({replaceArg:r=>({argIndex:0,value:{name:"plugin"in r?r.plugin.Name:r.Name,assetsPath:"assetsPath"in r?r==null?void 0:r.assetsPath:"default"}})})],ao.prototype,"use"),mn([Vi(ai.TRTC.enterRoom),Xh("room",(r,a)=>{let[d]=r,[g]=a;return(d.roomId||d.strRoomId)===(g.roomId||g.strRoomId)&&d.userId===g.userId&&d.sdkAppId===g.sdkAppId}),cr(r=>function(a){return this._log.setUserId(a.userId),this._log.setSdkAppId(a.sdkAppId),r.call(this,a)}),ur()],ao.prototype,"enterRoom"),mn([ur()],ao.prototype,"exitRoom"),mn([Vi(ai.TRTC.switchRole),Ag("room",{merge:(r,a)=>a}),ur()],ao.prototype,"switchRole"),mn([ur()],ao.prototype,"destroy"),mn([Vi(ai.TRTC.startLocalAudio),Xh("audio",(r,a)=>{let[d]=r,[g]=a;var C,A;return((C=d==null?void 0:d.option)==null?void 0:C.microphoneId)===((A=g==null?void 0:g.option)==null?void 0:A.microphoneId)}),ur()],ao.prototype,"startLocalAudio"),mn([Vi(ai.TRTC.updateLocalAudio),Ag("audio",{debounce:{delay:200,getKey:()=>"".concat(AV,"-localAudio"),isNeedToDebounce:r=>{var a;return!Pt((a=r.option)==null?void 0:a.captureVolume)}}}),ur()],ao.prototype,"updateLocalAudio"),mn([Qh("audio"),ur()],ao.prototype,"stopLocalAudio"),mn([Vi(ai.TRTC.startLocalVideo),Xh("video",(r,a)=>{let[d]=r,[g]=a;var C,A;return((C=d==null?void 0:d.option)==null?void 0:C.cameraId)===((A=g==null?void 0:g.option)==null?void 0:A.cameraId)}),ur()],ao.prototype,"startLocalVideo"),mn([Vi(ai.TRTC.updateLocalVideo),Ag("video"),ur()],ao.prototype,"updateLocalVideo"),mn([Qh("video"),ur()],ao.prototype,"stopLocalVideo"),mn([Vi(ai.TRTC.startScreenShare),Xh("screen",()=>!0),ur()],ao.prototype,"startScreenShare"),mn([Vi(ai.TRTC.updateScreenShare),Ag("screen"),ur()],ao.prototype,"updateScreenShare"),mn([ur()],ao.prototype,"stopScreenShare"),mn([Vi(ai.TRTC.startRemoteVideo),Xh(r=>"v".concat(r.userId).concat(r.streamType),()=>!0),ur({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],ao.prototype,"startRemoteVideo"),mn([Vi(ai.TRTC.updateRemoteVideo),Ag(r=>"v".concat(r.userId).concat(r.streamType)),ur({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],ao.prototype,"updateRemoteVideo"),mn([Vi(ai.TRTC.stopRemoteVideo),cr(r=>function(a){return Ze(this,null,function*(){if(a.userId==="*"){let d=[];return this._room.remotePublishedUserMap.forEach(g=>{this._remoteVideoConfigMap.has("".concat(g.userId,"_","main"))&&d.push(this.stopRemoteVideo({streamType:"main",userId:g.userId}).catch(()=>{})),this._remoteVideoConfigMap.has("".concat(g.userId,"_","sub"))&&d.push(this.stopRemoteVideo({streamType:"sub",userId:g.userId}).catch(()=>{}))}),Promise.all(d)}return r.call(this,a)})}),ur({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],ao.prototype,"stopRemoteVideo"),mn([Qh(r=>"v".concat(r.userId).concat(r.streamType))],ao.prototype,"_stopRemoteVideo"),mn([Vi(...ai.TRTC.muteRemoteAudio),ur({getRemoteId:r=>r})],ao.prototype,"muteRemoteAudio"),mn([MV(...ai.TRTC.setRemoteAudioVolume),function(r,a){return cr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),w=0;w<C;w++)A[w]=arguments[w];var V,U;let j=(V=MS.get(this))==null?void 0:V.get(a(...A));j&&j>0&&clearTimeout(j);let re=window.setTimeout(()=>{d.apply(this,A)},r);MS.has(this)?(U=MS.get(this))==null||U.set(a(...A),re):MS.set(this,new Map([[a(...A),re]]))})}(200,r=>r),ur({getRemoteId:r=>r})],ao.prototype,"setRemoteAudioVolume"),mn([$R("start"),Xh((r,a)=>r.getAlias()+r.getGroup(a)),ur({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>Q4[r.getName()]})],ao.prototype,"startPlugin"),mn([$R("update"),Ag((r,a)=>r.getAlias()+r.getGroup(a)),ur({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>Z4[r.getName()]})],ao.prototype,"updatePlugin"),mn([$R("stop"),Qh((r,a)=>r.getAlias()+r.getGroup(a)),ur({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>eV[r.getName()]})],ao.prototype,"stopPlugin"),mn([MV(...ai.TRTC.enableAudioVolumeEvaluation)],ao.prototype,"enableAudioVolumeEvaluation"),mn([ur()],ao.prototype,"getVideoSnapshot"),mn([ur()],ao.prototype,"setCurrentSpeaker"),mn([Xh(r=>"a".concat(r.userId),()=>!0)],ao.prototype,"_startRemoteAudio"),mn([cr(r=>function(a){return Ze(this,null,function*(){return a.userId==="*"?Promise.all([...this._room.remotePublishedUserMap.values()].map(d=>this._stopRemoteAudio(uo(Pn({},a),{userId:d.userId})).catch(()=>{}))):r.call(this,a)})}),Qh(r=>"a".concat(r.userId))],ao.prototype,"_stopRemoteAudio"),mn([Qh("room")],ao.prototype,"_exitRoom"),mn([Qh("screen")],ao.prototype,"_stopScreenShare"),mn([Vi(...ai.TRTC.sendSEIMessage),_V({timesInSecond:30,maxSizeInSecond:8e3,getSize:function(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return a[0].byteLength}})],ao.prototype,"sendSEIMessage"),mn([Vi(ai.TRTC.sendCustomMessage),_V({timesInSecond:30,maxSizeInSecond:8e3,getSize:r=>r.data.byteLength})],ao.prototype,"sendCustomMessage"),mn([Vi(ai.TRTC.create)],ao,"_create");var wS=ao,Rre=class{constructor(){this._set=new Set,Qt.on(Vt.LEAVE_SUCCESS,this.delete,this)}add(r){let{room:a,roomId:d}=r;if(a.scene==="rtc")return;let g=this.getKey(a.userId,d||a.roomId,a.sdkAppId,a.useStringRoomId);this._set.add(g)}delete(r){let{room:a,roomId:d}=r;if(a.scene==="rtc")return;let g=this.getKey(a.userId,a.roomId||d,a.sdkAppId,a.useStringRoomId);this._set.delete(g)}getKey(r,a,d,g){return"".concat(d,"_").concat(a,"_").concat(r,"_").concat(g)}isJoined(r){let{userId:a,roomId:d,sdkAppId:g,room:C}=r;return C.scene!=="rtc"&&this._set.has(this.getKey(a,d,g,C.useStringRoomId))}};function wre(){return Ze(this,null,function*(){let r,a;try{let ce=yield ac();r=ce&&ce.length}catch{}try{let ce=yield Au();a=ce&&ce.length}catch{}let d={microphone:r,camera:a},{isH264EncodeSupported:g,isVp8EncodeSupported:C,isH264DecodeSupported:A,isVp8DecodeSupported:w}=this.checkSystemResult.detail,V=ay.basis(),U={webRTC:V.isWebRTCSupported,getUserMedia:V.isGetUserMediaSupported,webSocket:V.isWebSocketsSupported,screenShare:V.isScreenShareSupported,webAudio:V.isWebAudioSupported,h264Encode:g,h264Decode:A,vp8Encode:C,vp8Decode:w},j={browser:V.browser,os:V.os,trtc:U,devices:d},re={isWebCodecSupported:V.isWebCodecSupported,isMediaSessionSupported:V.isMediaSessionSupported,isWebTransportSupported:V.isWebTransportSupported};Vr.uploadEvent({log:"trtcstats-".concat(JSON.stringify(j)),userId:this.userId}),this._log.info("TrtcStats-".concat(JSON.stringify(j))),Vr.uploadEvent({log:"trtcadvancedstats-".concat(JSON.stringify(re)),userId:this.userId})})}var Dre=vi(gs(),1),RV=Symbol("instance"),zR=Symbol("cacheResult"),DS=class{constructor(r,a,d){this.oldState=r,this.newState=a,this.action=d,this.aborted=!1}abort(r){this.aborted=!0,wy.call(r,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},WR=class extends Error{constructor(r,a,d){super(a),this.state=r,this.message=a,this.cause=d}},Ry=new Map;function wV(r,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(g,C,A)=>{let w=d.action||C;if(!d.context){let U=Ry.get(g)||[];Ry.has(g)||Ry.set(g,U),U.push({from:r,to:a,action:w})}let V=A.value;A.value=function(){let U=this;for(var j=arguments.length,re=new Array(j),ce=0;ce<j;ce++)re[ce]=arguments[ce];if(d.context&&(U=mr.get(typeof d.context=="function"?d.context.call(this,...re):d.context)),U.state===a)return U[zR];U.state instanceof DS&&U.state.action==d.abortAction&&U.state.abort(U);let Te=null;if(Array.isArray(r)?r.length==0?U.state instanceof DS&&U.state.abort(U):(typeof U.state!="string"||!r.includes(U.state))&&(Te=new WR(U._state,"".concat(U.name," ").concat(w," to ").concat(a," failed: current state ").concat(U._state," not in from config"))):r!==U.state&&(Te=new WR(U._state,"".concat(U.name," ").concat(w," to ").concat(a," failed: current state ").concat(U._state," not from ").concat(r))),Te){if(!d.fail){if(d.ignoreError)return Te;throw Te}d.fail.call(this,Te)}let De=U.state,ze=new DS(De,a,w);wy.call(U,ze);let _t=$t=>{var bt;return U[zR]=$t,ze.aborted||(wy.call(U,a),(bt=d.success)===null||bt===void 0||bt.call(this,U[zR])),$t},Ft=$t=>{let bt=$t instanceof Error?$t.message:String($t);if(wy.call(U,De,$t),!d.fail){if(d.ignoreError)return $t;throw $t}d.fail.call(this,new WR(U._state,"action '".concat(w,"' failed :").concat(bt),$t instanceof Error?$t:new Error(bt)))};try{let $t=V.apply(this,re);return function(bt){return typeof bt=="object"&&bt&&"then"in bt}($t)?$t.then(_t).catch(Ft):_t($t)}catch($t){Ft($t)}}}}var Ore=typeof window<"u"&&window.__AFSM__?(r,a)=>{window.dispatchEvent(new CustomEvent(r,{detail:a}))}:typeof importScripts<"u"?(r,a)=>{postMessage({type:r,payload:a})}:()=>{};function wy(r,a){let d=this._state;this._state=r;let g=r.toString();r&&this.emit(g,d),this.emit(mr.STATECHANGED,r,d,a),this.updateDevTools({value:r,old:d,err:a instanceof Error?a.message:String(a)})}var mr=class extends Dre.default{constructor(r,a,d){super(),this.name=r,this.groupName=a,this._state=mr.INIT,r||(r=Date.now().toString(36)),d?Object.setPrototypeOf(this,d):d=Object.getPrototypeOf(this),a||(this.groupName=this.constructor.name);let g=d[RV];g?this.name=g.name+"-"+g.count++:d[RV]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let r=Object.getPrototypeOf(this),a=Ry.get(r)||[],d=new Set,g=[],C=[],A=new Set,w=Object.getPrototypeOf(r);Ry.has(w)&&(w.stateDiagram.forEach(U=>d.add(U)),w.allStates.forEach(U=>A.add(U))),a.forEach(U=>{let{from:j,to:re,action:ce}=U;typeof j=="string"?g.push({from:j,to:re,action:ce}):j.length?j.forEach(Te=>{g.push({from:Te,to:re,action:ce})}):C.push({to:re,action:ce})}),g.forEach(U=>{let{from:j,to:re,action:ce}=U;A.add(j),A.add(re),A.add(ce+"ing"),d.add("".concat(j," --> ").concat(ce,"ing : ").concat(ce)),d.add("".concat(ce,"ing --> ").concat(re," : ").concat(ce," 🟢")),d.add("".concat(ce,"ing --> ").concat(j," : ").concat(ce," 🔴"))}),C.forEach(U=>{let{to:j,action:re}=U;d.add("".concat(re,"ing --> ").concat(j," : ").concat(re," 🟢")),A.forEach(ce=>{ce!==j&&d.add("".concat(ce," --> ").concat(re,"ing : ").concat(re))})});let V=[...d];return Object.defineProperties(r,{stateDiagram:{value:V},allStates:{value:A}}),V}static get(r){let a;return typeof r=="string"?(a=mr.instances.get(r),a||mr.instances.set(r,a=new mr(r,void 0,Object.create(mr.prototype)))):(a=mr.instances2.get(r),a||mr.instances2.set(r,a=new mr(r.constructor.name,void 0,Object.create(mr.prototype)))),a}static getState(r){var a;return(a=mr.get(r))===null||a===void 0?void 0:a.state}updateDevTools(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ore(mr.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},r))}get state(){return this._state}set state(r){wy.call(this,r)}};mr.STATECHANGED="stateChanged",mr.UPDATEAFSM="updateAFSM",mr.INIT="[*]",mr.ON="on",mr.OFF="off",mr.instances=new Map,mr.instances2=new WeakMap;var Nre=vi(gs()),DV="1",OV="5",jR="2",wg="3",Lre="5",Pre="4",ll={CLIENT_BANNED:9,CHANNEL_SETUP_RESULT:19,CHANNEL_RECONNECT_RESULT:514,JOIN_ROOM_RESULT:20,PEER_JOIN:4134,PEER_LEAVE:4135,STREAM_ADDED:16,STREAM_REMOVED:18,UPLINK_NETWORK_STATS:22,UPDATE_REMOTE_MUTE_STAT:23,PUBLISH_RESULT:4098,PUBLISH_STATE_CHANGE_RESULT:4112,UNPUBLISH_RESULT:4100,SUBSCRIBE_RESULT:4102,UNSUBSCRIBE_RESULT:4104,SUBSCRIBE_CHANGE_RESULT:4106,MUTE_RESULT:4108,UPDATE_OFFER_RESULT:4128,START_PUBLISH_TENCENT_CDN_RES:1286,STOP_PUBLISH_TENCENT_CDN_RES:1288,START_PUBLISH_GIVEN_CDN_RES:777,STOP_PUBLISH_GIVEN_CDN_RES:779,START_MIX_TRANSCODE_RES:781,STOP_MIX_TRANSCODE_RES:783,USER_LIST_RES:4137,SWITCH_ROLE_RES:4110,UPDATE_CONSTRAINT_CONFIG_RES:772,REBUILD_PEER_CONNECTION_RES:4150,SPC_PUBLISH_RESULT:4146,SPC_SUBSCRIBE_RESULT:4156,ABILITY_STATUS_REPORT_RESULT:4158,SERVER_FIRST_PACKAGE_RECEIVED:5e3,RECEIVE_CUSTOM_MSG:4140},Ure=[ll.UPDATE_REMOTE_MUTE_STAT,ll.UPLINK_NETWORK_STATS,ll.USER_LIST_RES,ll.MUTE_RESULT,ll.SERVER_FIRST_PACKAGE_RECEIVED,ll.RECEIVE_CUSTOM_MSG],lo={CLIENT_BANNED:"client-banned",CHANNEL_SETUP_RESULT:"channel-setup-result",CHANNEL_RECONNECT_RESULT:"channel-reconnect-result",JOIN_ROOM_RESULT:"join-room-result",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",UPLINK_NETWORK_STATS:"uplink-network-stats",UPDATE_REMOTE_MUTE_STAT:"update-remote-mute-stat",PUBLISH_RESULT:"publish-result",PUBLISH_STATE_CHANGE_RESULT:"publish-state-change-result",UNPUBLISH_RESULT:"unpublish-result",SUBSCRIBE_RESULT:"subscribe-result",SUBSCRIBE_CHANGE_RESULT:"subscribe-change-result",UNSUBSCRIBE_RESULT:"unsubscribe-result",UPDATE_OFFER_RESULT:"update-offer-result",START_PUBLISH_TENCENT_CDN_RES:"start-publish-tencent-cdn-res",STOP_PUBLISH_TENCENT_CDN_RES:"stop-publish-tencent-cdn-res",START_PUBLISH_GIVEN_CDN_RES:"start-publish-given-cdn-res",STOP_PUBLISH_GIVEN_CDN_RES:"stop-publish-given-cdn-res",START_MIX_TRANSCODE_RES:"start-mix-transcode-res",STOP_MIX_TRANSCODE_RES:"stop-mix-transcode-res",USER_LIST_RES:"user-list-res",SWITCH_ROLE_RES:"switch_role_res",MUTE_RESULT:"mute-result",UPDATE_CONSTRAINT_CONFIG_RES:"update-contraint-config-res",REBUILD_PEER_CONNECTION_RES:"rebuild-pc-res",SPC_PUBLISH_RESULT:"spc-publish-result",SPC_SUBSCRIBE_RESULT:"spc-subscribe-result",ABILITY_STATUS_REPORT_RESULT:"ability-status-report",SERVER_FIRST_PACKAGE_RECEIVED:"first-pkg-received",RECEIVE_CUSTOM_MSG:"receive-custom-msg"},xre="publish_change",Fre="join",Vre="leave",Gre="quality_report",NV="mute_uplink",Bre="publish",LV="publish_state_change",YR="unpublish",$re="subscribe",PV="unsubscribe",UV="subscribe_change",Hre="start_publishing",qre="stop_publishing",Kre="start_push_user_cdn",zre="stop_push_user_cdn",Wre="start_mcu_mix",jre="stop_mcu_mix",Yre="get_user_list",Jre="change_role",xV="update_constraint_config",Xre="rebuild_pc",Qre="join/v2",Zre="publish/v2",eie="subscribe/v3",tie="ability_status_report",nie="reconnect",oie="channel_msg",dc=new WeakMap;function Dy(r){let{settings:a={retries:5,timeout:2e3},onError:d,onRetrying:g,onRetryFailed:C}=r;return function(A,w,V){let U=ty({retryFunction:V.value,settings:a,onError(j){let{error:re,retry:ce,reject:Te,retryFuncArgs:De}=j;d&&d.call(this,re,()=>{var ze;(ze=dc.get(A))!=null&&ze.has(w)?ce():Te(re)},Te,De)},onRetrying(j,re){var ce;lr(g)&&g.call(this,j,re),(ce=dc.get(A))!=null&&ce.has(w)&&(dc.get(A).get(w).stopRetry=re)},onRetryFailed:C});return V.value=function(){let j=dc.get(A);for(var re=arguments.length,ce=new Array(re),Te=0;Te<re;Te++)ce[Te]=arguments[Te];return j?j.set(w,{args:ce}):dc.set(A,new Map([[w,{args:ce}]])),U.apply(this,ce).finally(()=>{var De;return(De=dc.get(A))==null?void 0:De.delete(w)})},V}}function OS(r){let{fnName:a,callback:d,validateArgs:g=!0}=r;return function(C,A,w){let V=w.value;return w.value=function(){for(var U,j,re=arguments.length,ce=new Array(re),Te=0;Te<re;Te++)ce[Te]=arguments[Te];if((U=dc.get(C))!=null&&U.has(a)){let{stopRetry:De,args:ze}=dc.get(C).get(a),_t=!0;if(g){for(let Ft of ze)if(!ce.find($t=>$t===Ft)){_t=!1;break}}_t&&(d&&d.apply(this,ce),De&&De(),(j=dc.get(C))==null||j.delete(a))}return V.apply(this,ce)},w}}var NS=new Set,FV=class extends Nre.default{constructor(r){var a,d;super(),_e(this,"room"),_e(this,"url"),_e(this,"backupUrl"),_e(this,"race"),_e(this,"destroyed",!1),_e(this,"_socketInUse"),_e(this,"_socket"),_e(this,"_backupSocket"),_e(this,"_signalInfo",{tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0}),_e(this,"_currentState","DISCONNECTED"),_e(this,"_isReconnecting",!1),_e(this,"_seq",0),_e(this,"_log"),_e(this,"_lastMessageTime",-1),_e(this,"_connnectStartTime",-1),_e(this,"_stopConnectRetry"),_e(this,"bytesSent",0),_e(this,"bytesReceived",0),_e(this,"keepAlive",!1),this.room=r.room,this.race=!!Pt(r.race)||r.race,(((d=(a=this.room.scheduleResult)==null?void 0:a.config)==null?void 0:d.keepAliveClient)||0)-NS.size>0&&this.room.enableSPC&&(this.keepAlive=!0,NS.add(this)),this.url=r.url,this.backupUrl=r.backupUrl,this._seq=0,this._log=cn.createLogger({id:"ws",userId:this.userId,sdkAppId:this.sdkAppId}),this.onmessage=this.onmessage.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this)}get urlParam(){let r="?sdkAppId=".concat(encodeURIComponent(this.sdkAppId),"&userId=").concat(encodeURIComponent(this.userId),"&userSig=").concat(encodeURIComponent(this.userSig),"&keepAlive=").concat(encodeURIComponent(Number(this.keepAlive)));return this.race?"".concat(r,"&race=1"):r}get _urlWithParam(){return"".concat(this.url).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get _backupUrlWithParam(){return"".concat(this.backupUrl).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get isConnected(){return this._currentState==="CONNECTED"}get isConnecting(){return this._currentState==="CONNECTING"}get sdkAppId(){return this.room.sdkAppId}get userId(){return this.room.userId}get userSig(){return this.room.userSig}get isOnline(){return this._currentState==="CONNECTED"&&Date.now()-this._lastMessageTime<12e3}connect(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1e4;return function*(){if(r.isConnected)return Promise.resolve();r._log.info("connect to [".concat(r.url,", ").concat(r.backupUrl,"]").concat(a?" timeout: ".concat(a):""," keepAlive: ").concat(Number(r.keepAlive))),r.emitConnectionStateChanged("CONNECTING"),r._connnectStartTime=To();let d=[r.connectWS({url:r._urlWithParam,isMain:!0,timeout:a})];r.race&&r._backupUrlWithParam!==r._urlWithParam&&d.push(r.connectWS({url:r._backupUrlWithParam,isMain:!1,timeout:a})),r._socketInUse=yield dR(d),r.unbindAndCloseSocket(r._socketInUse===r._socket?Pe.BACKUP:Pe.MAIN),r.emitConnectionStateChanged("CONNECTED")}()})}connectWS(r){let{url:a,timeout:d,isMain:g}=r,C=new WebSocket(a);this.bindSocket(C),g?this._socket=C:this._backupSocket=C;let A=-1;return new Promise((w,V)=>{C.onclose=V,C.onerror=V,C.onopen=()=>w(C),d&&(A=setTimeout(()=>{this.unbindAndCloseSocket(g?Pe.MAIN:Pe.BACKUP),V(new An({code:rn.SIGNAL_CHANNEL_SETUP_FAILED,message:"ws connect timeout"}))},d))}).finally(()=>{C.onclose=null,C.onerror=null,C.onopen=null,clearTimeout(A)})}bindSocket(r){r.addEventListener("close",this.onclose),r.addEventListener("error",this.onerror),r.addEventListener("message",this.onmessage)}unbindSocket(r){r.removeEventListener("close",this.onclose),r.removeEventListener("error",this.onerror),r.removeEventListener("message",this.onmessage)}unbindAndCloseSocket(r){if(r===Pe.MAIN){if(this._socket){this.unbindSocket(this._socket);try{this._socket.close(1e3)}catch{}this._socket=null}}else if(this._backupSocket){this.unbindSocket(this._backupSocket);try{this._backupSocket.close(1e3)}catch{}this._backupSocket=null}}onclose(r){if(r.target===this._socketInUse&&(this._log.warn("".concat(r.target===this._socket?"main":"backup"," is closed code:").concat(r.code," ").concat(r.reason)),this.emitConnectionStateChanged("DISCONNECTED"),!r.wasClean||r.code!==1e3)){this._socketInUse.onclose=null,this._socketInUse.close(4011);let a=this._socketInUse===this._socket;this.unbindAndCloseSocket(a?Pe.MAIN:Pe.BACKUP),this._socketInUse=null,this.reconnect()}}onerror(r){this._log.error("".concat(r.target===this._socket?"main":"backup"," error observed")),r.target===this._socketInUse&&(this.unbindAndCloseSocket(Pe.MAIN),this.unbindAndCloseSocket(Pe.BACKUP),this._socketInUse=null,this.reconnect())}onmessage(r){if(!this.isConnected)return;this._lastMessageTime=Date.now(),this.bytesReceived+=hR(r.data);let a=JSON.parse(r.data),{cmd:d,data:g}=a,C=Object.values(ll),A=Object.keys(ll)[C.indexOf(d)],w=lo[A];switch(Ure.includes(d)||(this._log.debug("received ".concat(d," msg: ").concat(r.data)),w&&this._log.info("Received event: [ ".concat(w," ]"))),d){case ll.CHANNEL_SETUP_RESULT:if(a.code===0)this._signalInfo.clientIp=g.clientIp,this._signalInfo.signalIp=g.signalInnerIp,g.svrTime&&function(V){yA=V-new Date().getTime();let U=new Date;U.setTime(V),cn.info("baseTime from server: ".concat(U," offset: ").concat(yA))}(g.svrTime),this._log.info("ChannelSetup Success"),Co.addSuccessEvent({key:521701,cost:To()-this._connnectStartTime}),this._connnectStartTime=-1,this.emit(DV,{signalInfo:this._signalInfo});else{let V=new An({code:rn.SIGNAL_CHANNEL_SETUP_FAILED,extraCode:a.code,message:no({key:jn.SIGNAL_CHANNEL_SETUP_FAILED,data:{errorCode:a.code,errorMsg:a.message}})});this._log.error("".concat(a.code,", ").concat(a.message)),this.close(),Co.addFailedEvent({key:521701,error:V}),this.emit(OV,V)}break;case ll.JOIN_ROOM_RESULT:a.code===0&&(this._signalInfo.relayIp=g.relayOuterIp,this._signalInfo.relayInnerIp=g.relayInnerIp,this._signalInfo.relayPort=g.relayPort,this._signalInfo.tinyId=a.tinyId,this._log.info("signalIp:".concat(this._signalInfo.signalIp," clientIp:").concat(this._signalInfo.clientIp," relayIp: ").concat(this._signalInfo.relayIp))),this.emit(w,{data:a});break;default:this.emit(w,{data:a})}}reGetSignalChannelUrl(){return Ze(this,null,function*(){try{Su(!0),yield this.room.schedule(this.room.roomId);let{mainUrl:r,backupUrl:a}=this.room.getSignalChannelUrl();this.url=r,this.backupUrl=a}catch{}})}reconnect(){return Ze(this,null,function*(){if(!this._isReconnecting){if(!this.room.isJoined&&this.keepAlive)return void this.close();this._isReconnecting=!0;try{this._log.warn("reconnect"),yield this.connect();let{roomId:r,useStringRoomId:a}=this.room,{relayIp:d,relayInnerIp:g,relayPort:C}=this._signalInfo,{data:A}=yield this.sendWaitForResponse({command:nie,data:{roomId:r,useStringRoomId:a,relayInnerIp:g,relayOuterIp:d,relayPort:C},responseCommand:lo.CHANNEL_RECONNECT_RESULT});A.code===0?(this._log.warn("reconnect success"),this.stopReconnection(),Co.addSuccessEvent({key:521702,cost:To()-this._connnectStartTime}),this._connnectStartTime=-1,this.room.syncUserList(),this.room.checkConnectionsToReconnect()):(Co.addFailedEvent({key:521702,error:A.code}),this._log.warn("reconnect failed, ".concat(A.code," ").concat(A.message)),this.room.reJoin())}catch(r){this._log.error(r),this.room.reJoin()}}})}send(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isConnected&&!this.room.isLeft){let d={cmd:r,data:a,userId:this.userId,tinyId:this._signalInfo.tinyId,seq:++this._seq},g=JSON.stringify(d);return this._socketInUse.send(g),this.bytesSent+=hR(g),d.seq}}sendWaitForResponse(r){let{command:a,data:d,timeout:g=5e3,responseCommand:C,commandDesc:A,enableLog:w=!0}=r;return new Promise((V,U)=>{let j=setTimeout(()=>{this.off(C,re);let Te=new An({code:rn.API_CALL_TIMEOUT,message:no({key:jn.API_CALL_TIMEOUT,data:{commandDesc:A,command:a}})});w&&this._log.warn(Te),U(Te)},g),re=Te=>{Te.data.seq===ce&&(clearTimeout(j),this.off(C,re),V(Te))};this.on(C,re);let ce=this.send(a,d)})}sendWaitForResponseWithRetry(r){let{commandDesc:a,command:d,retries:g=0,retryTimeout:C=0}=r;return ty({retryFunction:this.sendWaitForResponse,onError:A=>{let{retry:w}=A;this.isOnline?w():(this._log.warn("retry ".concat(d," when connected")),this.once(wg,w))},onRetrying:A=>{this._log.warn("".concat(a||d," timeout observed, retrying [").concat(A,"/").concat(g,"]"))},settings:{retries:g,timeout:C},context:this})(r)}getCurrentState(){return this._currentState}getSignalInfo(){return this._signalInfo}stopReconnection(){this._isReconnecting=!1,this._stopConnectRetry&&this._stopConnectRetry()}close(){this._log.info("closed"),NS.delete(this),this.stopReconnection(),this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._socketInUse=null,this.bytesSent=0,this.bytesReceived=0,this._stopConnectRetry&&this._stopConnectRetry(),this.unbindAndCloseSocket(Pe.MAIN),this.unbindAndCloseSocket(Pe.BACKUP),this.emitConnectionStateChanged("DISCONNECTED")}destroy(){this.close(),this.destroyed=!0}stopKeepAliveIn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3600;if(this.keepAlive){this._log.info("stopKeepAlive in ".concat(r,"s"));let a=setTimeout(()=>{this.keepAlive=!1,this._log.info("close due to not used ".concat(r,"s")),this.close()},1e3*r),d=g=>{g instanceof DS&&g.action==="join"&&(this._log.info("stopKeepAlive clear timeout"),clearTimeout(a),this.room.off(mr.STATECHANGED,d))};this.room.on(mr.STATECHANGED,d)}}emitConnectionStateChanged(r){r!==this._currentState&&(this._log.info("".concat(this._currentState," -> ").concat(r)),this.emit(jR,{prevState:this._currentState,state:r}),this._currentState=r,r==="CONNECTED"?this.emit(wg):r==="DISCONNECTED"&&this.emit(Lre))}};mn([Dy({settings:{retries:1/0,timeout:2e3},onError(r,a){!this.room.isDestroyed&&!this.destroyed&&a()},onRetrying(r,a){this._log.warn("retrying to connect ".concat(r)),r>=3&&r%3==0&&this.reGetSignalChannelUrl(),a&&(this._stopConnectRetry=a,(this.room.isDestroyed||this.destroyed)&&a())}})],FV.prototype,"connect");var rie=vi(gs()),JR=0,XR=!1,LS=new Set,VV=!1,Zh=class{constructor(r){_e(this,"userId"),_e(this,"tinyId"),_e(this,"_sdpSemantics"),_e(this,"_isUplink"),_e(this,"_room"),_e(this,"_log"),_e(this,"_signalChannel"),_e(this,"_isErrorObserved",!1),_e(this,"_waitForPeerConnectionConnectedPromise"),_e(this,"_waitForPeerConnectionConnectedPromiseReject",null),_e(this,"_peerConnection",null),_e(this,"_emitter",new rie.default),_e(this,"_currentState","DISCONNECTED"),_e(this,"_isReconnecting",!1),_e(this,"_reconnectionCount",0),_e(this,"_reconnectionTimer",-1),_e(this,"_isFirstConnection",!0),_e(this,"_prevTime",-1),_e(this,"_enableSEI"),_e(this,"_sei"),_e(this,"_localAddress"),_e(this,"_remoteAddress"),this.userId=r.userId,this.tinyId=r.tinyId,this._room=r.room,this._sdpSemantics=r.room.sdpSemantics,this._isUplink=r.isUplink,this._log=cn.createLogger({id:"n-mpc",userId:this._room.userId,remoteUserId:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=r.signalChannel,this._enableSEI=r.enableSEI}beforeConnect(){this._prevTime<0&&(this._prevTime=To())}afterConnect(r){return Ze(this,null,function*(){try{yield r,this._isFirstConnection?(this._isFirstConnection=!1,Co.addSuccessEvent({key:521705,cost:Math.min(To()-this._prevTime,3e4)})):this._isReconnecting&&Co.addSuccessEvent({key:521706,cost:To()-this._prevTime}),this._prevTime=-1}catch(a){throw this._isFirstConnection?(this._isFirstConnection=!1,Co.addFailedEvent({key:521705,error:a})):this._isReconnecting&&this._reconnectionCount>=3&&Co.addFailedEvent({key:521706,error:a}),a}})}initialize(){let r={encodedInsertableStreams:this._enableSEI&&cy,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"};this._peerConnection=new RTCPeerConnection(r),this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this)}close(r){this._log.info("close connection"),this._emitter.emit("closed",r),this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this._sei&&(this._sei.destroy(),this._sei=null),LS.delete(this)}closePeerConnection(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._peerConnection&&(this._log.info("close pc"),this._peerConnection.onconnectionstatechange=null,this._peerConnection.close(),this._peerConnection=null,r&&this.emitConnectionStateChangedEvent("DISCONNECTED")),this._waitForPeerConnectionConnectedPromiseReject&&this._waitForPeerConnectionConnectedPromiseReject(new An({code:rn.API_CALL_ABORTED,message:"connection closed"}))}getDTLSTransportState(){if(!this._peerConnection)return yu;let r=null;if(this._isUplink){if(!dS()||this._peerConnection.getSenders().length===0)return yu;r=this._peerConnection.getSenders()[0].transport}else{if(!uS()||this._peerConnection.getReceivers().length===0)return yu;r=this._peerConnection.getReceivers()[0].transport}return r?r.state:yu}onConnectionStateChange(r){let a=this._peerConnection.iceConnectionState,d=this.getDTLSTransportState();if(this._log.info("connectionState: ".concat(r.target.connectionState,", ICE: ").concat(a,", DTLS: ").concat(d)),r.target.connectionState===Or.CONNECTING&&this.emitConnectionStateChangedEvent("CONNECTING"),r.target.connectionState===Or.FAILED||r.target.connectionState===Or.CLOSED){let g="connection ".concat(r.target.connectionState,". ICE Transport state: ").concat(a,", DTLS Transport state: ").concat(d),C=new An({message:g,code:rn.ICE_TRANSPORT_ERROR});this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection(),this._isErrorObserved||this._emitter.emit("error",C)}(r.target.connectionState===Or.CONNECTED||r.target.connectionState===Or.COMPLETED)&&(this.logSelectedCandidate(),Vr.logSuccessEvent({userId:this._room.userId,eventType:ec.ICE_CONNECTION_STATE}),this.emitConnectionStateChangedEvent("CONNECTED"))}emitConnectionStateChangedEvent(r){return r!==this._currentState&&(r==="CONNECTED"?(JR=0,XR=!1,VV=!0,LS.add(this)):LS.delete(this),Qt.emit(Vt.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:r,remoteUserId:this._isUplink?void 0:this.userId}),this._emitter.emit("connection-state-changed",{prevState:this._currentState,state:r}),this._currentState=r,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}logSelectedCandidate(){return Ze(this,null,function*(){if(!this._peerConnection)return;let r=yield this._peerConnection.getStats();for(let[,a]of r)if(ly(a)){let d=r.get(a.localCandidateId),g=r.get(a.remoteCandidateId);d&&(this._log.info("local candidate: ".concat(d.candidateType," ").concat(d.protocol,":").concat(d.ip||d.address,":").concat(d.port," ").concat(d.networkType||""," ").concat(d.candidateType==="relay"?"relayProtocol:".concat(d.relayProtocol):"")),this._localAddress="".concat(d.ip||d.address,":").concat(d.port)),g&&(this._log.info("remote candidate: ".concat(g.candidateType," ").concat(g.protocol,":").concat(g.ip||g.address,":").concat(g.port)),this._remoteAddress="".concat(g.protocol,":").concat(g.ip||g.address));break}})}getCurrentState(){return this._currentState}waitForPeerConnectionConnected(){return this._waitForPeerConnectionConnectedPromise||(this._waitForPeerConnectionConnectedPromise=new Promise((r,a)=>{if(this._currentState==="CONNECTED")return r();this._waitForPeerConnectionConnectedPromiseReject=a;let d=w=>{w.state==="CONNECTED"&&(clearTimeout(A),C(),r())},g=w=>{let{room:V}=w;V===this._room&&(clearTimeout(A),C(),a(new An({code:rn.API_CALL_ABORTED,message:no({key:jn.CONNECTION_ABORTED,data:"leave room"})})))},C=()=>{Qt.off(Vt.LEAVE_SUCCESS,g,this),this._emitter.off("connection-state-changed",d,this)},A=setTimeout(()=>{C();let w=new An({code:rn.API_CALL_TIMEOUT,message:"connection timeout"});var V;JR+=1,V=this._signalChannel.isConnected,JR>2&&!XR&&LS.size===0&&V&&(this._log.warn("firewall restriction"),XR=!0,this._emitter.emit("firewall-restriction")),a(w)},LA);Qt.on(Vt.LEAVE_SUCCESS,g,this),this._emitter.on("connection-state-changed",d,this)}),this._waitForPeerConnectionConnectedPromise=this._waitForPeerConnectionConnectedPromise.finally(()=>{this._waitForPeerConnectionConnectedPromise=null,this._waitForPeerConnectionConnectedPromiseReject=null})),this._waitForPeerConnectionConnectedPromise}getReconnectionCount(){return this._reconnectionCount}startReconnection(){this._isReconnecting=!0,this.reconnect()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}stopReconnection(){this._log.info("stop reconnection"),this._isReconnecting=!1,this._reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(wg,this.reconnect,this)}beforeReconnect(){if(this._reconnectionTimer!==-1)return this._log.warn("reconnect() is reconnecting, ignore"),-1;if(this._reconnectionCount>=ug()){this._log.warn("SDK has tried reconnect for ".concat(this._reconnectionCount," times, but all failed, please check your network")),this.stopReconnection();let r=new An({code:this._isUplink?rn.UPLINK_RECONNECTION_FAILED:rn.DOWNLINK_RECONNECTION_FAILED,message:no({key:this._isUplink?jn.UPLINK_RECONNECTION_FAILED:jn.DOWNLINK_RECONNECTION_FAILED})});return this.emitConnectionStateChangedEvent("DISCONNECTED"),this._emitter.emit("error",r),-1}return this._signalChannel.isConnected?(this._reconnectionCount+=1,this._log.warn("reconnect() trying [".concat(this._reconnectionCount,"]")),1):(this._log.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this._signalChannel.once(wg,this.reconnect,this),-1)}on(r,a,d){this._emitter.on(r,a,d)}off(r,a,d){this._emitter.off(r,a,d)}getIsReconnecting(){return this._isReconnecting}get isH264(){var r,a;return!((a=(r=this._peerConnection)==null?void 0:r.remoteDescription)==null||!a.sdp.includes("H264"))}},GV=vi(EF()),Jr=function(r){return GV.default.parse(r)},Nu=function(r){return GV.default.write(r)};function QR(r){return Object.keys(r).filter(a=>r[a])}var BV=class extends Zh{constructor(r){super(uo(Pn({},r),{isUplink:!1})),_e(this,"_flag",0),_e(this,"role","anchor"),_e(this,"remoteAudioTrack"),_e(this,"remoteVideoTrack"),_e(this,"remoteAuxiliaryTrack"),_e(this,"ssrc",{audio:0,video:0,auxiliary:0}),_e(this,"_isSDPExchanging",!1),this.flag=r.flag,this.remoteAudioTrack=r.remoteAudioTrack||new GR(this._room,this),this.remoteVideoTrack=r.remoteVideoTrack||new Iy(this._room,this),this.remoteAuxiliaryTrack=r.remoteAuxiliaryTrack||new gV(this._room,this)}get subscribeState(){let r={audio:!1,video:!1,auxiliary:!1,smallVideo:!1};return this.remoteVideoTrack.isSubscribed&&(8&this.remoteVideoTrack.mediaType?r.smallVideo=!0:r.video=!0),this.remoteAudioTrack.isSubscribed&&(r.audio=!0),this.remoteAuxiliaryTrack.isSubscribed&&(r.auxiliary=!0),r}get muteState(){return iy(this.flag,this.userId)}get flag(){return this._flag}set flag(r){var a,d,g;r!==this._flag&&(this._flag=r,(a=this.remoteAudioTrack)==null||a.onFlagChanged(),(d=this.remoteVideoTrack)==null||d.onFlagChanged(),(g=this.remoteAuxiliaryTrack)==null||g.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(r){return r===Pe.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){super.initialize(),this.installEvents(),this._peerConnection.ontrack=this.onTrack.bind(this)}close(r){super.close(r),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents()}installEvents(){}uninstallEvents(){this._emitter.removeAllListeners()}emitConnectionStateChangedEvent(r){var a,d;let g=this._currentState,C=super.emitConnectionStateChangedEvent(r);return C&&g!==r&&((a=this.remoteVideoTrack)==null||a.emit("connection-state-changed",{prevState:g,state:r}),(d=this.remoteAuxiliaryTrack)==null||d.emit("connection-state-changed",{prevState:g,state:r})),C}onTrack(r){let a=r.streams[0],{track:d}=r,g=a.id===GC?Pe.MAIN:Pe.AUXILIARY;this._log.debug("ontrack ".concat(g," ").concat(d.kind));let C=Pe.AUDIO;d.kind===Pe.VIDEO&&(C=g===Pe.MAIN?Pe.VIDEO:Pe.AUXILIARY);let A=this.remoteAudioTrack;C===Pe.VIDEO?A=this.remoteVideoTrack:C===Pe.AUXILIARY&&(A=this.remoteAuxiliaryTrack),A.setInputMediaStreamTrack(d)}addRRTRLine(r){let a=r.split(`\r
`),d=new Map;a.forEach((C,A)=>{/^a=rtcp-fb:/.test(C)&&a[A+1]&&!/^a=rtcp-fb:/.test(a[A+1])&&d.set(A+1,"".concat(C.match(/^a=rtcp-fb:\d+/)[0]," rrtr"))});let g=[...d];for(let C=0;C<g.length;C++){let[A,w]=g[C];a.splice(A+C,0,w)}return a.join(`\r
`)}addSPSDescription(r){let a=Jr(r);return a.media.forEach(d=>{d.type===Pe.VIDEO&&d.fmtp.forEach(g=>{g.config+=";sps-pps-idr-in-keyframe=1"})}),Nu(a)}removeSDESDescription(r){let a=["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"],d=Jr(r);return d.media.forEach(g=>{!g.ext||(g.ext=g.ext.filter(C=>!a.includes(C.uri)))}),Nu(d)}isSubscriptionStateNotChanged(r){return JSON.stringify(r)===JSON.stringify(this.subscribeState)}subscribe(r,a){return Ze(this,null,function*(){var d,g;try{if((((d=this._peerConnection)==null?void 0:d.connectionState)===Or.NEW||((g=this._peerConnection)==null?void 0:g.connectionState)===Or.CONNECTING)&&(yield this.waitForPeerConnectionConnected()),this.isSubscriptionStateNotChanged(r))return void(this._peerConnection||(this.initialize(),yield this.connect(r)));if(this._log.info("subscribe ".concat(a," ").concat(JSON.stringify(r))),this._peerConnection||this._isSDPExchanging){let C="subscribe_change";Object.values(r).find(A=>A===!0)||(C="unsubscribe"),yield this.sendSubscription(C,r)}else this.initialize(),yield this.connect(r)}catch(C){throw this._room.isJoined&&this.isStreamUnpublished(a)?(this._log.warn("".concat(C.message," ").concat(JSON.stringify(this.muteState))),new An({code:rn.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):C}})}unsubscribe(r){return Ze(this,arguments,function(a){var d=this;let{remoteTracks:g,streamType:C}=a;return function*(){if(d._currentState==="CONNECTED"&&(C==="main"&&!d.isMainStreamSubscribed||C==="auxiliary"&&!d.isAuxStreamSubscribed))return void d._log.info("".concat(C," stream already unsubscribed"));let A=Pn({},d.subscribeState);g.forEach(V=>{switch(V.mediaType){case 1:A.audio=!1;break;case 4:A.video=!1;break;case 8:A.smallVideo=!1;break;case 2:A.auxiliary=!1}});let w="subscribe_change";Object.values(A).find(V=>V===!0)||(w="unsubscribe"),d._log.info("".concat(w==="unsubscribe"?w:"subscribe"," ").concat(C," [").concat(QR(A),"]")),yield d.sendSubscription(w,A),w==="unsubscribe"&&(d.closePeerConnection(),d.emitConnectionStateChangedEvent("DISCONNECTED"))}()})}sendSubscription(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,d={srcTinyId:this.tinyId,srcUserId:this.userId},g=PV,C=lo.UNSUBSCRIBE_RESULT;return r==="subscribe_change"&&(d={audio:a.audio,bigVideo:a.video,auxVideo:a.auxiliary,smallVideo:a.smallVideo,srcTinyId:this.tinyId},g=UV,C=lo.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponse({command:g,data:d,responseCommand:C,timeout:1e4}).then(A=>{let{data:w}=A;if(w.code!==0){let V=new An({code:w.code,message:no({key:jn.ERROR_MESSAGE,data:{type:r,message:w.message}})});throw this._log.error(V),V}})}connect(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState;return function*(){try{yield r.exchangeSDP(a),yield r.waitForPeerConnectionConnected()}catch(d){throw r.closePeerConnection(!0),d}}()})}exchangeSDP(r){return Ze(this,null,function*(){try{this._isSDPExchanging=!0,yield this.createOffer(),this._log.info("createOffer success, sending offer");let{type:a,sdp:d}=this._peerConnection.localDescription,g={type:a,sdp:d,srcUserId:this.userId,srcTinyId:this.tinyId,audio:r.audio,bigVideo:r.video,auxVideo:r.auxiliary,smallVideo:r.smallVideo},C=yield this._signalChannel.sendWaitForResponse({command:$re,commandDesc:"exchange sdp",data:g,responseCommand:lo.SUBSCRIBE_RESULT,timeout:qF});if(!this._peerConnection){let A=new An({code:rn.INVALID_OPERATION,message:no({key:jn.CONNECTION_CLOSED})});throw this._log.warn(A),A}yield this.onSubscribeResult(C),this._isSDPExchanging=!1}catch(a){throw this._isSDPExchanging=!1,a}})}createOffer(){return Ze(this,null,function*(){let r={voiceActivityDetection:!1};ic()&&this._sdpSemantics===F_?(this._peerConnection.addTransceiver(Pe.AUDIO,{direction:ho.RECVONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:ho.RECVONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:ho.RECVONLY})):(r.offerToReceiveAudio=!0,r.offerToReceiveVideo=!0);let a=yield this._peerConnection.createOffer(r);if(a.sdp){let{isH264DecodeSupported:d}=yield vR();d||(this._log.warn("remove h264 desc from sdp"),a.sdp=function(g){let C=Jr(g);return C.media.forEach(A=>{var w,V;if(A.type===Pe.VIDEO){let U=new Set;A.rtp.forEach(re=>{let{payload:ce,codec:Te}=re;return Te==="H264"&&U.add(ce)}),A.fmtp.forEach(re=>{let{payload:ce,config:Te}=re,De=Te.match(/apt=(\d+)/);De&&De[1]&&U.has(Number(De[1]))&&U.add(ce)});let j=re=>{let{payload:ce}=re;return!U.has(ce)};A.rtp=A.rtp.filter(j),A.rtcpFb=(w=A.rtcpFb)==null?void 0:w.filter(j),A.fmtp=A.fmtp.filter(j),A.payloads=(V=A.payloads)==null?void 0:V.split(" ").filter(re=>!U.has(Number(re))).join(" ")}}),Nu(C)}(a.sdp)),a.sdp=this.addRRTRLine(a.sdp),a.sdp=this.addSPSDescription(a.sdp),a.sdp=function(g){let C=Jr(g);return C.media.forEach(A=>{A.type===Pe.AUDIO&&A.fmtp.forEach(w=>{w.config+=";sprop-stereo=1;stereo=1"})}),Nu(C)}(a.sdp),this._sdpSemantics===F_&&(a.sdp=this.removeSDESDescription(a.sdp))}yield this._peerConnection.setLocalDescription(a)})}onSubscribeResult(r){return Ze(this,null,function*(){let{code:a,message:d=""}=r&&r.data||{},{type:g,sdp:C}=r&&r.data&&r.data.data||{};if(a===$C)throw new An({code:rn.NOT_SUPPORTED_H264,message:no({key:jn.NOT_SUPPORTED_H264DECODE})});try{if(a!==0)throw new An({code:a,message:no({key:jn.EXCHANGE_SDP_FAILED,data:{errMsg:d}})});this._log.debug("accept remote answer: ".concat(C)),yield this._peerConnection.setRemoteDescription({type:g,sdp:C}),this._sei&&(this._sei.handleEncodedStreams(),this._sei.onSEIMessage=A=>{this._emitter.emit("sei-message",uo(Pn({},A),{userId:this.userId}))}),this.updateSSRC(C)}catch(A){throw this._log.error(A),A}})}updateSSRC(r){try{Jr(r).media.forEach(a=>{if(a.ssrcs)if(a.type===Pe.AUDIO){let d=a.ssrcs.find(g=>{var C;return(C=g.value)==null?void 0:C.includes(GC)});d&&(this.ssrc.audio=Number(d.id))}else{let d=a.ssrcs.find(C=>{var A;return(A=C.value)==null?void 0:A.includes(GC)}),g=a.ssrcs.find(C=>{var A;return(A=C.value)==null?void 0:A.includes(FF)});d&&(this.ssrc.video=Number(d.id)),g&&(this.ssrc.auxiliary=Number(g.id))}})}catch{}}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}reconnect(){return Ze(this,null,function*(){if(!(Ia(BV.prototype,this,"beforeReconnect").call(this)<0))try{this.closePeerConnection(),this.initialize(),yield this.connect(),this.stopReconnection(),this._log.warn("reconnect() success")}catch{let a=vg(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(a/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},a)}})}getIsReconnecting(){return this._isReconnecting}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}getCurrentState(){return this._currentState}setDelay(r){let{audioDelay:a,videoDelay:d}=r;this.remoteAudioTrack.stat.end2EndDelay=a,this.remoteVideoTrack.stat.end2EndDelay=d}},ZR=BV;mn([cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];return new Promise((C,A)=>{let w=V=>{this._emitter.off("closed",w),A(new An({code:rn.API_CALL_ABORTED,message:no({key:jn.CONNECTION_ABORTED,data:V})}))};this._emitter.on("closed",w),r.apply(this,d).then(C,A).finally(()=>{this._emitter.off("closed",w)})})})],ZR.prototype,"subscribe"),mn([cV(Zh.prototype.afterConnect),lV(Zh.prototype.beforeConnect)],ZR.prototype,"connect");var $V=ZR,HV={voiceActivityDetection:!1},qV=class extends Zh{constructor(r){super(uo(Pn({},r),{isUplink:!0})),_e(this,"localMainAudioTrack",null),_e(this,"localMainVideoTrack",null),_e(this,"localAuxAudioTrack",null),_e(this,"localAuxVideoTrack",null),_e(this,"ssrc",{audio:0,video:0,small:0,auxiliary:0}),_e(this,"_isPublishingAux",!1),_e(this,"_publishingLocalAudioTrack"),_e(this,"_publishingLocalVideoTrack"),_e(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),_e(this,"flag",0)}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var r,a,d,g;let C={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let A=this._peerConnection.getSenders();A&&(Mu()?(C.audio=!((r=A[0])==null||!r.track),C.bigVideo=!((a=A[1])==null||!a.track),C.smallVideo=!((d=A[2])==null||!d.track),C.auxVideo=!((g=A[3])==null||!g.track)):A.forEach(w=>{w.track&&(w.track.kind===Pe.AUDIO?C.audio=!0:(C.bigVideo=!0,this._room.videoManager.hasSmall&&(C.smallVideo=!0)))}))}return C}initialize(){super.initialize(),this.installEvents()}reset(){this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this.uninstallEvents()}close(r){super.close(r),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){this._emitter.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this._emitter.on("connection-state-changed",this.handleConnectionStateChange,this)}uninstallEvents(){this._emitter.off("connection-state-changed",this.handleConnectionStateChange,this)}emitConnectionStateChangedEvent(r,a){var d,g,C;let A=this._currentState,w=super.emitConnectionStateChangedEvent(r);return w&&A!==r&&(a?a.emit("connection-state-changed",{prevState:A,state:r}):((d=this.localMainVideoTrack)==null||d.emit("connection-state-changed",{prevState:A,state:r}),(g=this.localAuxVideoTrack)==null||g.emit("connection-state-changed",{prevState:A,state:r}),(C=this._publishingLocalVideoTrack)==null||C.emit("connection-state-changed",{prevState:A,state:r}))),w}publish(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C,isAuxiliary:A}=a;return function*(){var w;let V;d._peerConnection||d.initialize(),g&&(d._publishingLocalAudioTrack=g),C&&(d._publishingLocalVideoTrack=C),d._isPublishingAux=A,C&&!A&&C.small&&(V=d._room.videoManager.smallTrack),d.sendMediaSettings(),ic()?yield d.publishByTransceiver({localAudioTrack:g,localVideoTrack:C,smallTrack:V,isAuxiliary:A}):yield d.publishByAddTrack({localAudioTrack:g,localVideoTrack:C,smallTrack:V}),d._publishingLocalAudioTrack=null,d._publishingLocalVideoTrack=null,d._isPublishingAux=!1,A?(C&&(d.localAuxVideoTrack=C),g&&(d.localAuxAudioTrack=g)):(C&&(d.localMainVideoTrack=C),g&&(d.localMainAudioTrack=g)),(w=d._sei)==null||w.handleEncodedStreams(),d.installTrackMuteEvents(g,C),d.sendMutedFlag()}()})}publishByTransceiver(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C,smallTrack:A,isAuxiliary:w}=a;return function*(){d._log.info("publish by transceiver");let V=new MediaStream,U=C==null?void 0:C.outMediaTrack,j=g==null?void 0:g.outMediaTrack;j&&V.addTrack(j),U&&V.addTrack(U);let re=d._peerConnection.getTransceivers();if(re.length===0)d._peerConnection.addTransceiver(j||Pe.AUDIO,{direction:ho.SENDONLY,streams:[V]}),d._peerConnection.addTransceiver(w?Pe.VIDEO:U||Pe.VIDEO,{direction:ho.SENDONLY,streams:[V]}),d._peerConnection.addTransceiver(A||Pe.VIDEO,{direction:ho.SENDONLY,streams:[V]}),d._peerConnection.addTransceiver(w&&U||Pe.VIDEO,{direction:ho.SENDONLY,streams:[V]}),yield d.connect();else{let ce=[];if(j&&(re[0].sender.track||ce.push(0),yield re[0].sender.replaceTrack(j),yield d.setBandwidth({bandwidth:(g==null?void 0:g.profile.bitrate)||40,type:Pe.AUDIO})),U){let Te=w?3:1;yield re[Te].sender.replaceTrack(U),yield d.setBandwidth({bandwidth:C.profile.bitrate,type:Pe.VIDEO,videoType:w?Pe.AUXILIARY:Pe.BIG}),ce.push(Te),A&&(yield re[2].sender.replaceTrack(A),yield d.setBandwidth({bandwidth:C.small.bitrate,type:Pe.VIDEO,videoType:Pe.SMALL}),ce.push(2))}yield d.setTransceiverDirection(ho.SENDONLY,ce),yield d.doPublishChange(),C==null||C.emit("connection-state-changed",{prevState:"DISCONNECTED",state:"CONNECTING"}),C==null||C.emit("connection-state-changed",{prevState:"CONNECTING",state:"CONNECTED"})}}()})}publishByAddTrack(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C,smallTrack:A}=a;return function*(){d._log.info("publish by addtrack");let w=C==null?void 0:C.outMediaTrack,V=g==null?void 0:g.outMediaTrack;if(d._peerConnection&&d._peerConnection.connectionState!=="new")return g&&V&&(yield d.addTrack(g)),void(w&&(yield d.addTrack(C)));let U=new MediaStream;if(V&&U.addTrack(V),w&&U.addTrack(w),V&&d._peerConnection.addTrack(V,U),w&&(d._peerConnection.addTrack(w,U),A)){let j=new MediaStream;j.addTrack(A),d._peerConnection.addTrack(A,j)}yield d.connect()}()})}enableSmall(r){return Ze(this,null,function*(){let a=this._peerConnection.getTransceivers();r?this._room.videoManager.smallTrack&&(yield a[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection(ho.SENDONLY,[2])):(yield a[2].sender.replaceTrack(null),yield this.setTransceiverDirection(ho.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];a.forEach(g=>{g&&(g==null||g.on("mute",this.sendMutedFlag,this),g==null||g.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];a.forEach(g=>{g&&(g==null||g.off("mute",this.sendMutedFlag,this),g==null||g.off("unmute",this.sendMutedFlag,this))})}unpublish(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C}=a;return function*(){if(!Mu())return g&&g.outMediaTrack&&!C&&d.localMainVideoTrack?(yield d.removeTrack(g),void(d.localMainAudioTrack=null)):C&&C.outMediaTrack&&!g&&d.localMainAudioTrack?(yield d.removeTrack(C),void(d.localMainVideoTrack=null)):(yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),void d.emitConnectionStateChangedEvent("DISCONNECTED",C));let A=C&&C===d.localAuxVideoTrack,w=C==null?void 0:C.outMediaTrack,V=d._peerConnection.getSenders(),U=[];g&&(yield V[0].replaceTrack(null),U.push(0),A?d.localAuxAudioTrack=null:d.localMainAudioTrack=null),w&&(A?(yield V[3].replaceTrack(null),d.localAuxVideoTrack=null,d._mediaSettings=uo(Pn({},d._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),U.push(3)):(yield V[1].replaceTrack(null),yield V[2].replaceTrack(null),d.localMainVideoTrack=null,d._mediaSettings=uo(Pn({},d._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),U.push(1,2))),d.isMainStreamPublished||d.isAuxStreamPublished?(yield d.setTransceiverDirection(ho.INACTIVE,U),yield d.doPublishChange(!1)):yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),C==null||C.emit("connection-state-changed",{prevState:d._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ze(this,null,function*(){let a={state:this.publishState,constraintConfig:this._mediaSettings},d=yield this._signalChannel.sendWaitForResponse({command:LV,data:a,responseCommand:lo.PUBLISH_STATE_CHANGE_RESULT,enableLog:r});this.checkPublishResultCode(d.data.code,d.data.message)})}doUnpublish(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:YR,commandDesc:"unpublish",responseCommand:lo.UNPUBLISH_RESULT,enableLog:r}).catch(a=>{if(a.getCode()===rn.API_CALL_TIMEOUT)return Promise.resolve();throw a})}updateMediaSettings(){let{detail:{isH264EncodeSupported:r,isVp8EncodeSupported:a}}=this._room.checkSystemResult;r?this._mediaSettings.videoCodec="H264":a&&(this._mediaSettings.videoCodec="VP8");let d=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:g,localAuxVideoTrack:C}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?C=this._publishingLocalVideoTrack:g=this._publishingLocalVideoTrack),Ig){if(d&&d.outMediaTrack){let A=d.outMediaTrack.getSettings();this._mediaSettings.audioChannel=A.channelCount||1,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=A.sampleRate||0}if(g&&g.outMediaTrack){let A=g.outMediaTrack.getSettings();this._mediaSettings.videoWidth=A.width||0,this._mediaSettings.videoHeight=A.height||0,this._mediaSettings.videoFps=A.frameRate||0,this._mediaSettings.videoBps=1e3*g.profile.bitrate,g.small&&(this._mediaSettings.smallVideoWidth=g.small.width,this._mediaSettings.smallVideoHeight=g.small.height,this._mediaSettings.smallVideoFps=g.small.frameRate,this._mediaSettings.smallVideoBps=1e3*g.small.bitrate)}if(C&&C.outMediaTrack){let A=C.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=A.width||0,this._mediaSettings.auxVideoHeight=A.height||0,this._mediaSettings.auxVideoFps=A.frameRate||0,this._mediaSettings.auxVideoBps=1e3*C.profile.bitrate}}else d&&d.outMediaTrack&&(this._mediaSettings.audioChannel=d.profile.channelCount,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=d.profile.sampleRate),g&&g.outMediaTrack&&(this._mediaSettings.videoWidth=g.profile.width,this._mediaSettings.videoHeight=g.profile.height,this._mediaSettings.videoFps=g.profile.frameRate,this._mediaSettings.videoBps=1e3*g.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:xV,data:this._mediaSettings,responseCommand:lo.UPDATE_CONSTRAINT_CONFIG_RES}).then(r=>{r.data.code!==0&&this._log.warn(r.data.message)}).catch(()=>{})}addTrack(r){return Ze(this,null,function*(){var a;if(!this._peerConnection)return;let d=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is adding ".concat(r.kind," track to current published local ").concat(d?Pe.AUXILIARY:Pe.MAIN," stream")),(a=this._sei)==null||a.handleEncodedStreams(),ic()?yield this.addTrackByTransceiver(r,d):yield this.addTrackBySender(r)})}addTrackByTransceiver(r,a){return Ze(this,null,function*(){var d;if(!r.mediaTrack)return;let g=this._peerConnection.getTransceivers();if(r.kind===Pe.AUDIO)yield g[0].sender.replaceTrack(r.outMediaTrack);else{let C=a?3:1;yield g[C].sender.replaceTrack(r.outMediaTrack),C===1&&((d=this.localMainVideoTrack)!=null&&d.small)&&(yield g[2].sender.replaceTrack(this._room.videoManager.smallTrack)),g[C].direction===ho.INACTIVE&&(yield this.setTransceiverDirection(ho.SENDONLY,[C]))}this.updateMediaSettings(),yield this.doPublishChange()})}addTrackBySender(r){return Ze(this,null,function*(){if(!r.outMediaTrack)return;let a=r.outMediaTrack;Mu()&&this._peerConnection.getTransceivers().findIndex(g=>g.direction==="stopped")>=0&&(this._log.warn("transceiver is stopping, negotiate sdp first"),yield this.updateOffer("remove",a));let d=this._peerConnection.getSenders().find(g=>g.track&&g.track.kind===a.kind);if(d&&d.track){this._log.warn("sender already exists, remove sender first");let g=d.track;this.removeSender(d),yield this.updateOffer("remove",g)}if(a&&this._peerConnection.addTrack(a,new MediaStream([a])),a.kind===Pe.VIDEO&&r instanceof _s&&r.small){let g=new MediaStream,{smallTrack:C}=this._room.videoManager;g.addTrack(C),this._peerConnection.addTrack(C,g)}yield this.updateOffer("add",a)})}isNeedToResetOfferOrder(){if(this._sdpSemantics===BC||!this._peerConnection||!this._peerConnection.localDescription)return!1;let{sdp:r}=this._peerConnection.localDescription,a=Jr(r);for(let d=0;d<a.media.length;d++)if(Number(a.media[d].mid)===0&&a.media[d].type===Pe.VIDEO)return!0;return!1}removeSender(r){let a=null;Mu()&&(a=this._peerConnection.getTransceivers().find(d=>d.sender&&d.sender.track===r.track)),this._peerConnection.removeTrack(r),a&&lr(a.stop)&&(this._log.info("stop transceiver"),a.stop())}removeTrack(r){return Ze(this,null,function*(){if(!this._peerConnection)return;let a=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is removing ".concat(r.kind," track from current published local ").concat(a?Pe.AUXILIARY:Pe.MAIN," stream")),ic()?yield this.removeTrackByTransceiver(r,a):yield this.removeTrackBySender(r)})}removeTrackByTransceiver(r,a){return Ze(this,null,function*(){if(!r.outMediaTrack)return;let d=this._peerConnection.getTransceivers();if(r.kind===Pe.AUDIO)yield d[0].sender.replaceTrack(null);else{let g=a?3:1;yield d[g].sender.replaceTrack(null),g===1&&r.small&&(yield d[2].sender.replaceTrack(null)),yield this.setTransceiverDirection(ho.INACTIVE,[g])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(r,a){return Ze(this,null,function*(){if(!gr)return;let d=!1,g=!1;this._log.info("setting transceiver ".concat(a.join(",")," direction to ").concat(r));let C=this._peerConnection.getTransceivers();if(a.forEach(V=>{C[V].direction!==r&&(C[V].direction=r,d=!0)}),d){this._log.info("updating offer");let V=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(V)}let A=-1,w=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(V=>{if(V.match(new RegExp("a=(".concat(ho.INACTIVE,"|").concat(ho.RECVONLY,"|").concat(ho.SENDONLY,")")))&&A++,a.includes(A)){if(r===ho.INACTIVE&&V.includes("a=".concat(ho.RECVONLY)))return g=!0,"a=".concat(r);if(r===ho.SENDONLY&&V.includes("a=".concat(ho.INACTIVE)))return g=!0,"a=".concat(ho.RECVONLY)}return V}).join(`\r
`);g&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:w}))})}removeTrackBySender(r){return Ze(this,null,function*(){if(!r.outMediaTrack)return;if(r.kind===Pe.VIDEO&&this.isNeedToResetOfferOrder()&&this.localMainAudioTrack)return this.reset(),this.initialize(),void(yield this.publish({localAudioTrack:this.localMainAudioTrack,isAuxiliary:!1}));let a=this._peerConnection.getSenders().find(d=>d.track===r.outMediaTrack);a&&(this.removeSender(a),r.kind===Pe.VIDEO&&r.small&&this._peerConnection.getSenders().forEach(d=>{d.track&&d.track.kind===Pe.VIDEO&&this.removeSender(d)})),yield this.updateOffer("remove",r.outMediaTrack)})}replaceTrack(r){return Ze(this,null,function*(){var a;let d,g=(a=this._peerConnection)==null?void 0:a.getSenders();if(!g||g.length===0||!r.mediaTrack||(d=ic()?r.kind===Pe.AUDIO?g[0]:g[1]:g.find(A=>A.track&&A.track.kind===r.kind),!d))return;let C=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is replacing ".concat(r.kind," track on ").concat(C?Pe.AUXILIARY:Pe.MAIN," stream")),r.kind===Pe.AUDIO?yield d.replaceTrack(r.outMediaTrack):r.kind===Pe.VIDEO&&(C?g[3]&&(yield g[3].replaceTrack(r.outMediaTrack)):yield d.replaceTrack(r.outMediaTrack))})}updateOffer(r,a){return Ze(this,null,function*(){try{let d=yield this._peerConnection.createOffer(HV);gr&&d.sdp&&(d.sdp=this.setSDPDirection(d.sdp,"sendrecv")),yield this._peerConnection.setLocalDescription(d);let g=this.updateMediaSettings(),C={action:r,trackId:a.id,kind:a.kind===Pe.VIDEO?"bigVideo":a.kind,type:"offer",sdp:this._peerConnection.localDescription.sdp,constraintConfig:g,state:this.publishState};this._log.info("createOffer success, sending updated offer to remote server"),this._log.debug("updatedOffer: ".concat(C.sdp));let A=yield this._signalChannel.sendWaitForResponse({command:xre,data:C,responseCommand:lo.UPDATE_OFFER_RESULT,timeout:HF,commandDesc:"update offer"}),{code:w,message:V}=A.data;w!==0&&this.checkPublishResultCode(w,V),yield this.acceptAnswer(A.data.data),d.sdp&&this.updateSSRC(d.sdp)}catch(d){throw this._log.error(d),d}})}setBandwidth(r){return Ze(this,arguments,function(a){var d=this;let{bandwidth:g,type:C,videoType:A,sdp:w}=a;return function*(){if(!yR())return w?C===Pe.VIDEO?d.updateVideoBandwidthRestriction(w,g,A):d.updateAudioBandwidthRestriction(w,g):void 0;let V,U=d._peerConnection.getSenders();if(ic()){let j=0;C===Pe.VIDEO&&(j=A===Pe.SMALL?2:A===Pe.AUXILIARY?3:1),V=U[j]}else V=U.find(j=>j.track&&j.track.kind===C);if(V){let j=V.getParameters();(!j.encodings||j.encodings.length===0)&&(j.encodings=[{}]),j.encodings[0].maxBitrate=1e3*g;try{return yield V.setParameters(j),d._log.info("".concat(A||"").concat(C," bandwidth ").concat(g," kbps")),w}catch(re){if(d._log.info("failed to set bandwidth by setting maxBitrate: ".concat(re)),w)return C===Pe.VIDEO?d.updateVideoBandwidthRestriction(w,g,A):d.updateAudioBandwidthRestriction(w,g)}}return w}()})}updateVideoBandwidthRestriction(r,a,d){let g="AS";gr&&(g="TIAS",a*=1e3);let C=0,A=-1;return d===Pe.SMALL?C=1:d===Pe.AUXILIARY&&(C=2),r=r.replace(/m=video (.*)\r\nc=IN (.*)\r\n/g,w=>(A+=1,A===C?"".concat(w,"b=").concat(g,":").concat(a,`\r
`):w))}updateAudioBandwidthRestriction(r,a){let d="AS";return gr&&(d="TIAS",a*=1e3),r=r.replace(/m=audio (.*)\r\nc=IN (.*)\r\n/,`m=audio $1\r
c=IN $2\r
b=`.concat(d,":").concat(a,`\r
`))}removeBandwidthRestriction(r){return r.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}removeVideoOrientation(r){return r.replace(/urn:3gpp:video-orientation/,"")}connect(){return Ze(this,null,function*(){try{yield this.exchangeSDP(),yield this.waitForPeerConnectionConnected()}catch(r){throw this.closePeerConnection(!0),this.uninstallEvents(),r}})}exchangeSDP(){return Ze(this,null,function*(){try{yield this.createOffer(),this._log.info("createOffer success, sending offer to remote server"),yield this.doExchangeSDP()}catch(r){throw r}})}createOffer(){return Ze(this,null,function*(){try{let r=yield this._peerConnection.createOffer(HV);yield this._peerConnection.setLocalDescription(r),r.sdp&&this.updateSSRC(r.sdp)}catch(r){throw r}})}doExchangeSDP(){let r={command:Bre,responseCommand:lo.PUBLISH_RESULT,data:{type:this._peerConnection.localDescription.type,sdp:this.removeVideoOrientation(this._peerConnection.localDescription.sdp),screen:this.localMainVideoTrack instanceof Yh||this.localAuxVideoTrack instanceof Yh,state:this.publishState,constraintConfig:this._mediaSettings},enableLog:!1};return this._log.debug("sending sdp offer: ".concat(r.data.sdp)),this._signalChannel.sendWaitForResponse(r).then(a=>{let{code:d,message:g,data:C}=a.data;return d===0?this.acceptAnswer(C):this.checkPublishResultCode(d,g)})}setSDPDirection(r,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"all",g=Jr(r);return g.media.forEach(C=>{(d==="all"||C.type===d)&&(C.direction=a)}),Nu(g)}acceptAnswer(r){return Ze(this,null,function*(){var a,d,g,C,A;try{let w;if(this._publishingLocalAudioTrack||this._publishingLocalVideoTrack||this.isMainStreamPublished){let U=((a=this._publishingLocalVideoTrack)==null?void 0:a.profile.bitrate)||((d=this.localMainVideoTrack)==null?void 0:d.profile.bitrate),j=((g=this._publishingLocalAudioTrack)==null?void 0:g.profile.bitrate)||((C=this.localMainAudioTrack)==null?void 0:C.profile.bitrate);if(U){let re=this._isPublishingAux?Pe.AUXILIARY:Pe.BIG;w=yield this.setBandwidth({bandwidth:U,type:Pe.VIDEO,sdp:w,videoType:re})}j&&(w=yield this.setBandwidth({bandwidth:j,type:Pe.AUDIO,sdp:w}))}if(w=this.removeVideoOrientation(r.sdp),(A=this._publishingLocalVideoTrack)!=null&&A.small){let{smallStreamConfig:U}=this._room;w=yield this.setBandwidth({bandwidth:this._publishingLocalVideoTrack.small.bitrate||U.bitrate,type:Pe.VIDEO,videoType:Pe.SMALL,sdp:w})}let V={type:r.type,sdp:w};yield this._peerConnection.setRemoteDescription(V),this._log.debug("accepted answer: ".concat(w))}catch(w){throw this._log.error("failed to accept remote answer ".concat(w)),w}})}sendMutedFlag(r){var a,d,g;if(r===this.localAuxAudioTrack||r===this.localAuxVideoTrack)return;let C={audio:!((a=this.localMainAudioTrack)==null||!a.muted),bigVideo:!((d=this.localMainVideoTrack)==null||!d.muted),auxVideo:!((g=this.localAuxVideoTrack)==null||!g.muted)};this._log.info("send muted state: ".concat(JSON.stringify(C))),this._signalChannel.send(NV,C)}getIsReconnecting(){return this._isReconnecting}reconnect(){return Ze(this,null,function*(){if(!(Ia(qV.prototype,this,"beforeReconnect").call(this)<0))try{yield this._signalChannel.sendWaitForResponse({command:YR,responseCommand:lo.UNPUBLISH_RESULT,enableLog:!1}),this.closePeerConnection(),this.initialize(),this.isMainStreamPublished&&(yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0})),this._log.warn("reconnect() uplink reconnect successfully"),this.stopReconnection()}catch{let a=vg(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(a/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},a)}})}handleConnectionStateChange(r){r.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&Qt.emit(Vt.SEND_FIRST_VIDEO_FRAME,{room:this._room})}updateSSRC(r){try{Jr(r).media.forEach((a,d)=>{if(a.type===Pe.AUDIO){let g=a.ssrcs&&a.ssrcs[0];g&&(this.ssrc.audio=Number(g.id))}else{if(this._sdpSemantics===BC&&a.ssrcGroups)return void a.ssrcGroups.forEach((C,A)=>{let w=Number(C.ssrcs.split(" ")[0]);A===0?this.ssrc.video=w:A===1&&(this.ssrc.small=w)});let g=a.ssrcs&&a.ssrcs[0];if(!g)return;switch(d){case 1:this.ssrc.video=Number(g.id);break;case 2:this.ssrc.small=Number(g.id);break;case 3:this.ssrc.auxiliary=Number(g.id)}}})}catch{}}getVideoTrackId(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe.VIDEO;if(this._peerConnection){let a=this._peerConnection.getSenders();if(r===Pe.AUXILIARY&&a[3]&&a[3].track)return a[3].track.id;if(r===Pe.VIDEO&&a[1]&&a[1].track)return a[1].track.id}if(this.localMainVideoTrack&&r===Pe.VIDEO){let a=this.localMainVideoTrack.mediaTrack;if(a)return a.id}if(this.localAuxVideoTrack&&r===Pe.AUXILIARY){let a=this.localAuxVideoTrack.mediaTrack;if(a)return a.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(r,a){if(r!==0)throw r===$C?(this._log.error(ba.NOT_SUPPORTED_H264ENCODE),new An({code:rn.NOT_SUPPORTED_H264,message:no({key:jn.NOT_SUPPORTED_H264ENCODE})})):new An({code:rn.UNKNOWN,message:no({key:jn.SIGNAL_RESPONSE_FAILED,data:{signalResponse:lo.PUBLISH_RESULT,code:r,message:a}})})}sendSEI(r,a){var d;(d=this._sei)==null||d.push(r,a)}},ew=qV;mn([cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];return new Promise((C,A)=>{let w=V=>{this._emitter.off("closed",w),A(new An({code:rn.API_CALL_ABORTED,message:no({key:jn.CONNECTION_ABORTED,data:V})}))};this._emitter.on("closed",w),r.apply(this,d).then(C,A).finally(()=>{this._emitter.off("closed",w)})})})],ew.prototype,"publish"),mn([cV(Zh.prototype.afterConnect),lV(Zh.prototype.beforeConnect)],ew.prototype,"connect");var tw=ew,iie=class{constructor(r,a){this.room=r,_e(this,"_log"),_e(this,"_prevReportTime"),_e(this,"_prevReport",{}),_e(this,"_prevEncoderImplementation"),_e(this,"_prevQualityLimitationReason"),_e(this,"_prevAuxQualityLimitationReason"),_e(this,"_prevDecoderImplementationMap",new Map),_e(this,"totalBytesSent",0),_e(this,"totalBytesReceived",0),_e(this,"_spcStats",null),this._log=a,this._prevReportTime=0,this._prevEncoderImplementation="",this._prevQualityLimitationReason="",this._prevAuxQualityLimitationReason=""}get statInterval(){return this._prevReportTime===0?2:(Date.now()-this._prevReportTime)/1e3}getSenderStats(r){return Ze(this,null,function*(){let a={audio:{bytesSent:0,packetsSent:0,audioLevel:0,totalAudioEnergy:0},video:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},small:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},auxiliary:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},rtt:0},d=r.getPeerConnection(),g=r.getSSRC();if(d)try{if((this._spcStats||(yield d.getStats())).forEach(C=>{var A;if(C.type==="outbound-rtp")if((C.mediaType||C.kind)===Pe.VIDEO){let w,V;if(C.ssrc===g.video?(w=Pe.VIDEO,V=r.localMainVideoTrack):C.ssrc===g.small?w=Pe.SMALL:C.ssrc===g.auxiliary&&(V=r.localAuxVideoTrack,w=Pe.AUXILIARY),!w)return;a[w].bytesSent=C.bytesSent,a[w].packetsSent=C.packetsSent,a[w].framesEncoded=C.framesEncoded,Pt(C.keyFramesEncoded)||(a[w].keyFramesEncoded=C.keyFramesEncoded),Pt(C.nackCount)||(a[w].nackCount=C.nackCount),Pt(C.pliCount)||(a[w].pliCount=C.pliCount),Pt(C.retransmittedPacketsSent)||(a[w].retransmittedPacketsSent=C.retransmittedPacketsSent),Pt(C.totalEncodeTime)||(a[w].totalEncodeTime=C.totalEncodeTime),Pt(C.totalPacketSendDelay)||(a[w].totalPacketSendDelay=C.totalPacketSendDelay),C.ssrc===g.video?(!Pt(C.encoderImplementation)&&this._prevEncoderImplementation!==C.encoderImplementation&&(this._log.info("encoderImplementation change to ".concat(C.encoderImplementation)),this._prevEncoderImplementation=C.encoderImplementation),!Pt(C.qualityLimitationReason)&&C.bytesSent!==0&&this._prevQualityLimitationReason!==C.qualityLimitationReason&&(this._log.info("qualityLimitationReason change to ".concat(C.qualityLimitationReason)),this._prevQualityLimitationReason=C.qualityLimitationReason)):C.ssrc===g.auxiliary&&!Pt(C.qualityLimitationReason)&&C.bytesSent!==0&&this._prevAuxQualityLimitationReason!==C.qualityLimitationReason&&(this._log.info("aux qualityLimitationReason change to ".concat(C.qualityLimitationReason)),this._prevAuxQualityLimitationReason=C.qualityLimitationReason)}else a.audio.bytesSent=C.bytesSent,a.audio.packetsSent=C.packetsSent;else C.type==="candidate-pair"?ly(C)&&si(C.currentRoundTripTime)&&(a.rtt=Math.floor(1e3*C.currentRoundTripTime),this.totalBytesSent=C.bytesSent):C.type==="media-source"&&(C.kind===Pe.AUDIO?(a.audio.audioLevel=C.audioLevel||0,a.audio.totalAudioEnergy=C.totalAudioEnergy||0):C.kind===Pe.VIDEO&&(C.trackIdentifier===r.getVideoTrackId(Pe.VIDEO)?a.video.fpsCapture=C.framesPerSecond:C.trackIdentifier===r.getVideoTrackId(Pe.AUXILIARY)?a.auxiliary.fpsCapture=C.framesPerSecond:a.small.fpsCapture=C.framesPerSecond));if(!Pt(C.audioLevel)&&((A=r.localMainAudioTrack)!=null&&A.mediaTrack)&&C.trackIdentifier===r.localMainAudioTrack.mediaTrack.id&&(a.audio.audioLevel=C.audioLevel||0),!Pt(C.frameWidth)){let w=Pe.SMALL;C.trackIdentifier===r.getVideoTrackId(Pe.VIDEO)||C.ssrc===g.video?w=Pe.VIDEO:(C.trackIdentifier===r.getVideoTrackId(Pe.AUXILIARY)||C.ssrc===g.auxiliary)&&(w=Pe.AUXILIARY),a[w].frameWidth=C.frameWidth,a[w].frameHeight=C.frameHeight,a[w].framesSent=C.framesSent}}),r.localMainAudioTrack){let C=r.localMainAudioTrack.getInternalAudioLevel();a.audio.micAudioLevel=C,a.audio.audioLevel===0&&(a.audio.audioLevel=C)}this.totalBytesSent||(this.totalBytesSent+=a.audio.bytesSent+a.video.bytesSent+a.auxiliary.bytesSent)}catch(C){this._log.warn("failed to getStats on sender connection ".concat(C))}return a})}getReceiverStats(r){return Ze(this,null,function*(){let a={tinyId:r.tinyId,userId:r.userId,rtt:0,hasAudio:!1,hasVideo:!1,hasAuxiliary:!1,isSmallSubscribed:!1,audio:{bytesReceived:0,packetsReceived:0,packetsLost:0,p2pDelay:0,totalJitter:0,totalJitterCount:0,audioLevel:0,totalAudioEnergy:0,insertedSamplesForDeceleration:0,removedSamplesForAcceleration:0},video:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0},auxiliary:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0}},d=r.getPeerConnection();if(d)try{let{ssrc:g}=r,{muteState:C,subscribeState:A}=r;(this._spcStats||(yield d.getStats())).forEach(w=>{if(w.type==="inbound-rtp")if((w.mediaType||w.kind)===Pe.AUDIO){if(w.ssrc!==g.audio||!C.hasAudio)return;a.audio.packetsReceived=w.packetsReceived,a.audio.bytesReceived=w.bytesReceived,a.audio.packetsLost=w.packetsLost,w.insertedSamplesForDeceleration&&(a.audio.insertedSamplesForDeceleration=w.insertedSamplesForDeceleration),w.removedSamplesForAcceleration&&(a.audio.removedSamplesForAcceleration=w.removedSamplesForAcceleration);let{remoteAudioTrack:V}=r;V.stat.packetsReceived=w.packetsReceived,V.stat.bytesReceived=w.bytesReceived,V.stat.packetsLost=w.packetsLost,a.audio.p2pDelay=V.stat.end2EndDelay,w.jitterBufferDelay&&(a.audio.totalJitter=w.jitterBufferDelay,a.audio.totalJitterCount=w.jitterBufferEmittedCount),a.hasAudio=!0}else{if(gr&&w.bytesReceived===0)return;let V;w.ssrc===g.video&&C.hasVideo&&(a.video.packetsReceived=w.packetsReceived,a.video.bytesReceived=w.bytesReceived,a.video.packetsLost=w.packetsLost,a.video.framesReceived=w.framesReceived,a.video.framesDecoded=w.framesDecoded,a.video.fpsDecoded=w.framesPerSecond,a.hasVideo=!0,V=r.remoteVideoTrack,C.hasSmall&&A.smallVideo&&(a.isSmallSubscribed=!0),w.decoderImplementation&&(!this._prevDecoderImplementationMap.has(a.userId)||this._prevDecoderImplementationMap.get(a.userId)!==w.decoderImplementation)&&(this._log.info("".concat(a.userId," decoderImplementation change to ").concat(w.decoderImplementation)),this._prevDecoderImplementationMap.set(a.userId,w.decoderImplementation))),w.ssrc===g.auxiliary&&C.hasAuxiliary&&(a.auxiliary.packetsReceived=w.packetsReceived,a.auxiliary.bytesReceived=w.bytesReceived,a.auxiliary.packetsLost=w.packetsLost,a.auxiliary.framesReceived=w.framesReceived,a.auxiliary.framesDecoded=w.framesDecoded,a.auxiliary.fpsDecoded=w.framesPerSecond,V=r.remoteAuxiliaryTrack,a.hasAuxiliary=!0),V&&(V.stat.packetsReceived=w.packetsReceived,V.stat.bytesReceived=w.bytesReceived,V.stat.packetsLost=w.packetsLost,V.stat.framesReceived=w.framesReceived,V.stat.framesDecoded=w.framesDecoded,w.jitterBufferDelay&&(V.stat.jitterBufferDelay=Math.floor(w.jitterBufferDelay/w.jitterBufferEmittedCount*1e3)))}else w.type==="candidate-pair"&&ly(w)&&si(w.currentRoundTripTime)&&(a.rtt=Math.floor(1e3*w.currentRoundTripTime),this.totalBytesReceived=w.bytesReceived);Pt(w.frameWidth)||((w.trackIdentifier===r.getMainStreamVideoTrackId()||w.ssrc===g.video)&&(a.video.frameWidth=w.frameWidth,a.video.frameHeight=w.frameHeight,r.remoteVideoTrack.stat.frameWidth=w.frameWidth,r.remoteVideoTrack.stat.frameHeight=w.frameHeight),(w.trackIdentifier===r.getAuxStreamVideoTrackId()||w.ssrc===g.auxiliary)&&(a.auxiliary.frameWidth=w.frameWidth,a.auxiliary.frameHeight=w.frameHeight,r.remoteAuxiliaryTrack.stat.frameWidth=w.frameWidth,r.remoteAuxiliaryTrack.stat.frameHeight=w.frameHeight)),!Pt(w.audioLevel)&&r.muteState.audioAvailable&&r.remoteAudioTrack.mediaTrack&&w.trackIdentifier===r.remoteAudioTrack.mediaTrack.id&&(a.audio.audioLevel=w.audioLevel||0,a.audio.totalAudioEnergy=w.totalAudioEnergy||0)}),a.audio.audioLevel===0&&r.muteState.audioAvailable&&(a.audio.audioLevel=r.remoteAudioTrack.getInternalAudioLevel()||0),this.totalBytesReceived||(this.totalBytesReceived+=a.audio.bytesReceived+a.video.bytesReceived+a.auxiliary.bytesReceived)}catch(g){this._log.warn("failed to getStats on receiver connection ".concat(g))}return a})}getStats(r,a){return Ze(this,null,function*(){let d={},g=[];if(this.room.singlePC){let C=this.room.singlePC.getPeerConnection();if(!C)return{senderStats:d,receiverStats:g};let A=yield C.getStats(),w=[],V=new Set(["inbound-rtp","outbound-rtp","track","candidate-pair","media-source"]);A.forEach(U=>V.has(U.type)&&w.push(U)),this._spcStats=w}r&&(d=yield this.getSenderStats(r));for(let[C,A]of a){let w=yield this.getReceiverStats(A);g.push(w)}return{senderStats:d,receiverStats:g}})}getDifferenceValue(r,a){if(Ru(r))return a;let d=a-r;return d<0?0:d}prepareReport(r){let{stats:a,report:d,freezeMap:g}=r;if(!Ru(a.senderStats)){let U={uint32_audio_level:a.senderStats.audio.audioLevel*Iu,uint32_audio_energy:1e6*a.senderStats.audio.totalAudioEnergy,uint32_audio_codec_bitrate:a.senderStats.audio.bytesSent};a.senderStats.audio.micAudioLevel&&(U.uint32_mic_audio_level=a.senderStats.audio.micAudioLevel*Iu);let j=[];if(a.senderStats.video.bytesSent){let ce={uint32_video_stream_type:2,uint32_video_codec_fps:a.senderStats.video.framesSent,uint32_video_capture_fps:a.senderStats.video.fpsCapture,uint32_video_width:a.senderStats.video.frameWidth,uint32_video_height:a.senderStats.video.frameHeight,uint32_video_codec_bitrate:a.senderStats.video.bytesSent,uint32_video_enc_fps:a.senderStats.video.framesEncoded,uint32_key_frame_count:a.senderStats.video.keyFramesEncoded,uint32_nack_count:a.senderStats.video.nackCount,uint32_pli_count:a.senderStats.video.pliCount,uint32_encode_cost:1e3*(a.senderStats.video.totalEncodeTime||0),uint32_send_packet_cost:1e3*(a.senderStats.video.totalPacketSendDelay||0),uint32_video_arq_packets:a.senderStats.video.retransmittedPacketsSent};j.push(ce)}if(a.senderStats.small.bytesSent){let ce={uint32_video_stream_type:3,uint32_video_codec_fps:a.senderStats.small.framesSent||0,uint32_video_capture_fps:a.senderStats.small.fpsCapture||0,uint32_video_width:a.senderStats.small.frameWidth||0,uint32_video_height:a.senderStats.small.frameHeight||0,uint32_video_codec_bitrate:a.senderStats.small.bytesSent,uint32_video_enc_fps:a.senderStats.small.framesEncoded||0,uint32_key_frame_count:a.senderStats.small.keyFramesEncoded,uint32_nack_count:a.senderStats.small.nackCount,uint32_pli_count:a.senderStats.small.pliCount,uint32_encode_cost:1e3*(a.senderStats.small.totalEncodeTime||0),uint32_send_packet_cost:1e3*(a.senderStats.small.totalPacketSendDelay||0),uint32_video_arq_packets:a.senderStats.small.retransmittedPacketsSent};j.push(ce)}if(a.senderStats.auxiliary.bytesSent){let ce={uint32_video_stream_type:7,uint32_video_codec_fps:a.senderStats.auxiliary.framesSent||0,uint32_video_capture_fps:a.senderStats.auxiliary.fpsCapture||0,uint32_video_width:a.senderStats.auxiliary.frameWidth||0,uint32_video_height:a.senderStats.auxiliary.frameHeight||0,uint32_video_codec_bitrate:a.senderStats.auxiliary.bytesSent,uint32_video_enc_fps:a.senderStats.auxiliary.framesEncoded||0,uint32_key_frame_count:a.senderStats.auxiliary.keyFramesEncoded,uint32_nack_count:a.senderStats.auxiliary.nackCount,uint32_pli_count:a.senderStats.auxiliary.pliCount,uint32_encode_cost:1e3*(a.senderStats.auxiliary.totalEncodeTime||0),uint32_send_packet_cost:1e3*(a.senderStats.auxiliary.totalPacketSendDelay||0),uint32_video_arq_packets:a.senderStats.auxiliary.retransmittedPacketsSent};j.push(ce)}let re={uint32_bitrate:0,uint32_lost:0,uint32_rtt:a.senderStats.rtt};d.msg_up_stream_info={msg_audio_status:U,msg_video_status:j,msg_network_status:re}}let{statInterval:C}=this;d.msg_down_stream_info=[],a.receiverStats.forEach(U=>{let j={msg_user_info:{str_identifier:U.userId,uint64_tinyid:U.tinyId},msg_network_status:{uint32_rtt:U.rtt,uint32_bitrate:0,uint32_lost:0},msg_audio_status:{},msg_video_status:[]};if(U.hasAudio){let re={uint32_audio_p2p_delay:U.audio.p2pDelay,uint32_audio_cache_ms:U.audio.totalJitter,uint32_audio_cache_ms_count:U.audio.totalJitterCount,uint32_audio_codec_bitrate:U.audio.bytesReceived,uint32_audio_total_bitrate:U.audio.bytesReceived,uint32_audio_level:1e8*U.audio.audioLevel,uint32_audio_energy:1e6*U.audio.totalAudioEnergy,uint32_audio_receive:U.audio.packetsReceived,uint32_audio_origin_lost:U.audio.packetsLost};j.msg_audio_status=re}if(U.hasVideo){let re=g.get("".concat(U.userId,"_").concat(VF)),ce=re?re.duration:0,Te={uint32_video_stream_type:U.isSmallSubscribed?3:2,uint32_video_receive_fps:U.video.framesReceived,uint32_video_width:U.video.frameWidth,uint32_video_height:U.video.frameHeight,uint32_video_codec_bitrate:U.video.bytesReceived,uint32_video_receive:U.video.packetsReceived,uint32_video_origin_lost:U.video.packetsLost,uint32_video_block_time:ce,uint32_video_dec_fps:U.video.framesDecoded};j.msg_video_status.push(Te)}if(U.hasAuxiliary){let re=g.get("".concat(U.userId,"_").concat(GF)),ce=re?re.duration:0,Te={uint32_video_stream_type:7,uint32_video_receive_fps:U.auxiliary.framesReceived,uint32_video_width:U.auxiliary.frameWidth,uint32_video_height:U.auxiliary.frameHeight,uint32_video_codec_bitrate:U.auxiliary.bytesReceived,uint32_video_receive:U.auxiliary.packetsReceived+U.auxiliary.packetsLost,uint32_video_origin_lost:U.auxiliary.packetsLost,uint32_video_block_time:ce,uint32_video_dec_fps:U.auxiliary.framesDecoded};j.msg_video_status.push(Te)}d.msg_down_stream_info.push(j)});let A=this._prevReport;if(this._prevReport=JSON.parse(JSON.stringify(d)),d.msg_up_stream_info.msg_audio_status&&A.msg_up_stream_info.msg_audio_status){let U=A.msg_up_stream_info.msg_audio_status,j=d.msg_up_stream_info.msg_audio_status;if(U.uint32_audio_codec_bitrate===0)j.uint32_audio_codec_bitrate=0;else{let re=this.getDifferenceValue(U.uint32_audio_codec_bitrate,j.uint32_audio_codec_bitrate);j.uint32_audio_codec_bitrate=Math.round(8*re/C),d.msg_up_stream_info.msg_network_status.uint32_bitrate+=j.uint32_audio_codec_bitrate}}let w=A.msg_up_stream_info.msg_video_status;d.msg_up_stream_info.msg_video_status.forEach(U=>{let j=w.find(ze=>ze.uint32_video_stream_type===U.uint32_video_stream_type);if(!j||j.uint32_video_codec_bitrate===0)return U.uint32_video_codec_bitrate=0,U.uint32_video_enc_fps=0,void(U.uint32_video_codec_fps=0);let re=0,ce=0,Te=0;j&&U.uint32_video_codec_bitrate>=j.uint32_video_codec_bitrate&&(re=j.uint32_video_codec_bitrate,ce=j.uint32_video_enc_fps,Te=j.uint32_video_codec_fps);let De=this.getDifferenceValue(re,U.uint32_video_codec_bitrate);U.uint32_video_codec_bitrate=Math.round(8*De/C),d.msg_up_stream_info.msg_network_status.uint32_bitrate+=U.uint32_video_codec_bitrate,U.uint32_video_enc_fps=Math.round(this.getDifferenceValue(ce,U.uint32_video_enc_fps)/C),U.uint32_video_codec_fps=Math.round(this.getDifferenceValue(Te,U.uint32_video_codec_fps)/C),fg&&pg()===115&&j.uint32_video_width===0&&j.uint32_video_height===0&&j.uint32_video_codec_fps===0&&(U.uint32_video_codec_fps=U.uint32_video_enc_fps),Pt(j.uint32_key_frame_count)||(U.uint32_key_frame_count=Math.round(this.getDifferenceValue(j.uint32_key_frame_count,U.uint32_key_frame_count))),Pt(j.uint32_nack_count)||(U.uint32_nack_count=Math.round(this.getDifferenceValue(j.uint32_nack_count,U.uint32_nack_count))),Pt(j.uint32_pli_count)||(U.uint32_pli_count=Math.round(this.getDifferenceValue(j.uint32_pli_count,U.uint32_pli_count))),Pt(j.uint32_video_arq_packets)||(U.uint32_video_arq_packets=Math.round(this.getDifferenceValue(j.uint32_video_arq_packets,U.uint32_video_arq_packets))),Pt(j.uint32_encode_cost)||(U.uint32_encode_cost=Math.round(this.getDifferenceValue(j.uint32_encode_cost,U.uint32_encode_cost)/C)),Pt(j.uint32_send_packet_cost)||(U.uint32_send_packet_cost=Math.round(this.getDifferenceValue(j.uint32_send_packet_cost,U.uint32_send_packet_cost)/C))});let V=A.msg_down_stream_info;return d.msg_down_stream_info=d.msg_down_stream_info.filter(U=>V.find(j=>j.msg_user_info.uint64_tinyid===U.msg_user_info.uint64_tinyid)),d.msg_down_stream_info.forEach(U=>{let j=V.find(re=>re.msg_user_info.uint64_tinyid===U.msg_user_info.uint64_tinyid);if(Ru(U.msg_audio_status)||Ru(j.msg_audio_status))U.msg_audio_status={};else{let re=U.msg_audio_status,ce=j.msg_audio_status,Te=this.getDifferenceValue(ce.uint32_audio_cache_ms_count,re.uint32_audio_cache_ms_count);delete re.uint32_audio_cache_ms_count,re.uint32_audio_cache_ms=Math.floor(1e3*this.getDifferenceValue(ce.uint32_audio_cache_ms,re.uint32_audio_cache_ms)/Te)||0;let De=this.room.remotePublishedUserMap.get(U.msg_user_info.str_identifier);De&&(De.remoteAudioTrack.stat.jitterBufferDelay=re.uint32_audio_cache_ms),re.uint32_audio_origin_lost=this.getDifferenceValue(ce.uint32_audio_origin_lost,re.uint32_audio_origin_lost),re.uint32_audio_receive=this.getDifferenceValue(ce.uint32_audio_receive,re.uint32_audio_receive),re.uint32_audio_receive+=re.uint32_audio_origin_lost;let ze=this.getDifferenceValue(ce.uint32_audio_codec_bitrate,re.uint32_audio_codec_bitrate);re.uint32_audio_codec_bitrate=Math.round(8*ze/C),re.uint32_audio_total_bitrate=Math.round(8*ze/C)}if(U.msg_video_status&&j.msg_video_status){let re=j.msg_video_status;U.msg_video_status=U.msg_video_status.filter(ce=>re.find(Te=>Te.uint32_video_stream_type===ce.uint32_video_stream_type)),U.msg_video_status.forEach(ce=>{let Te=re.find(Rn=>Rn.uint32_video_stream_type===ce.uint32_video_stream_type),De=Te.uint32_video_receive,ze=Te.uint32_video_origin_lost,_t=Te.uint32_video_codec_bitrate,Ft=Te.uint32_video_receive_fps,$t=Te.uint32_video_dec_fps;ce.uint32_video_origin_lost=this.getDifferenceValue(ze,ce.uint32_video_origin_lost),ce.uint32_video_receive=this.getDifferenceValue(De,ce.uint32_video_receive)+ce.uint32_video_origin_lost;let bt=this.getDifferenceValue(_t,ce.uint32_video_codec_bitrate);ce.uint32_video_codec_bitrate=Math.round(8*bt/C);let yn=this.getDifferenceValue(Ft,ce.uint32_video_receive_fps);ce.uint32_video_receive_fps=Math.round(yn/C),ce.uint32_video_dec_fps=Math.round(this.getDifferenceValue($t,ce.uint32_video_dec_fps)/C)})}}),d}getStatsReport(r){return Ze(this,arguments,function(a){var d=this;let{uplinkConnection:g,downlinkConnections:C,freezeMap:A}=a;return function*(){let w={msg_up_stream_info:{msg_audio_status:{uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_level:0,uint32_audio_energy:0},msg_video_status:[],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}},msg_down_stream_info:[{msg_user_info:{str_identifier:"",uint64_tinyid:0},msg_audio_status:{uint32_audio_cache_ms:0,uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_total_bitrate:0,uint32_audio_level:0,uint32_audio_energy:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_final_lost:0},msg_video_status:[{uint32_video_stream_type:0,uint32_video_receive_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_codec_bitrate:0,uint32_video_receive:0,uint32_video_origin_lost:0,uint32_video_block_time:0,uint32_video_dec_fps:0}],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}}]},V=yield d.getStats(g,C);return JSON.stringify(d._prevReport)==="{}"&&(d._prevReport=JSON.parse(JSON.stringify(w))),d.prepareReport({stats:V,report:w,freezeMap:A}),d._prevReportTime=Date.now(),w}()})}reset(){this._prevReportTime=0,this._prevReport={},this._prevEncoderImplementation="",this._prevQualityLimitationReason="",this._prevDecoderImplementationMap=new Map}},sie=vi(gs()),KV=class extends sie.default{constructor(r){let{signalChannel:a,room:d}=r;super(),_e(this,"_room"),_e(this,"_signalChannel"),_e(this,"_log"),_e(this,"_uplinkRTT",0),_e(this,"_uplinkLoss",0),_e(this,"_downlinkRTT",0),_e(this,"_downlinkLoss",0),_e(this,"_downlinkPrevStatMap",new Map),_e(this,"_downlinkLossAndRTTMap",new Map),_e(this,"_interval",-1),_e(this,"_uplinkNetworkQuality",0),_e(this,"_downlinkNetworkQuality",0),this._room=d,this._signalChannel=a,this._log=cn.createLogger({id:"q",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this.initialize()}get uplinkNetworkQuality(){return this._uplinkNetworkQuality}set uplinkNetworkQuality(r){r!==this._uplinkNetworkQuality&&this._log.info("uplink ".concat(this.uplinkNetworkQuality," -> ").concat(r,", rtt: ").concat(this._uplinkRTT,", loss: ").concat(this._uplinkLoss)),this._uplinkNetworkQuality=r}get downlinkNetworkQuality(){return this._downlinkNetworkQuality}set downlinkNetworkQuality(r){if(r!==this._downlinkNetworkQuality){let{rtt:a,loss:d}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._log.info("downlink ".concat(this.downlinkNetworkQuality," -> ").concat(r,", rtt: ").concat(a,", loss: ").concat(d))}this._downlinkNetworkQuality=r}initialize(){this._signalChannel.on(lo.UPLINK_NETWORK_STATS,r=>{this.handleUplinkNetworkQuality(r)}),this._signalChannel.on(jR,this.handleSignalConnectionStateChange.bind(this)),this.start()}handleUplinkNetworkQuality(r){var a,d;if(r.data.code!==0)return;let g=r.data.data;if(g.delay&&this.updateDelay(g.delay),!this._room.uplinkConnection)return this.uplinkNetworkQuality=0,this._uplinkLoss=0,void(this._uplinkRTT=0);let C=(d=(a=this._room)==null?void 0:a.uplinkConnection)==null?void 0:d.getPeerConnection();if(C&&this.isPeerConnectionDisconnected(C))return this.uplinkNetworkQuality=6,this._uplinkLoss=0,void(this._uplinkRTT=0);let A=g.expectAudPkg+g.expectVidPkg,w=g.recvAudPkg+g.recvVidPkg,V=A-w;A===0&&w===0||(this._uplinkLoss=V<=0?0:Math.round(V/A*100),this._uplinkRTT=g.rtt,this.uplinkNetworkQuality=this.getNetworkQuality(this._uplinkLoss,this._uplinkRTT))}handleDownlinkNetworkQuality(){return Ze(this,null,function*(){if(this._room.remotePublishedUserMap.size===0)return void(this.downlinkNetworkQuality=0);let r=[...this._room.remotePublishedUserMap.values()],a=r.filter(C=>{var A;return((A=C.getPeerConnection())==null?void 0:A.connectionState)===Or.CONNECTED});if(r.filter(C=>this.isPeerConnectionDisconnected(C.getPeerConnection())).length===r.length)return void(this.downlinkNetworkQuality=6);for(let C=0;C<a.length;C++){let A=a[C].getPeerConnection();if(!A)return;let{rtt:w,totalPacketsLost:V,totalPacketsReceived:U}=yield this.getStat(A);if(!this._downlinkPrevStatMap.has(A)){this._downlinkPrevStatMap.set(A,{totalPacketsLost:V,totalPacketsReceived:U});continue}let j=0,re=this._downlinkPrevStatMap.get(A),ce=V-re.totalPacketsLost,Te=U-re.totalPacketsReceived;j=ce<=0||Te<0?0:Math.round(ce/(ce+Te)*100),this._downlinkPrevStatMap.set(A,{totalPacketsLost:V,totalPacketsReceived:U}),this._downlinkLossAndRTTMap.set(A,{rtt:w,loss:j,userId:a[C].getUserId(),audioDelay:a[C].remoteAudioTrack.stat.end2EndDelay,videoDelay:a[C].remoteVideoTrack.stat.end2EndDelay})}if([...this._downlinkPrevStatMap.keys()].forEach(C=>{this.isPeerConnectionDisconnected(C)&&(this._downlinkPrevStatMap.delete(C),this._downlinkLossAndRTTMap.delete(C))}),this._downlinkLossAndRTTMap.size===0)return;let{rtt:d,loss:g}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._downlinkRTT=d,this._downlinkLoss=g,this.downlinkNetworkQuality=this.getNetworkQuality(g,d)})}getStat(r){return Ze(this,null,function*(){let a={rtt:0,totalPacketsLost:0,totalPacketsReceived:0};if(!r||!uS())return a;let d=r.getReceivers();try{for(let g=0;g<d.length;g++)(yield d[g].getStats()).forEach(C=>{C.type==="candidate-pair"&&si(C.currentRoundTripTime)&&(a.rtt=Math.round(1e3*C.currentRoundTripTime)),C.type==="inbound-rtp"&&(C.mediaType===Pe.AUDIO||C.mediaType===Pe.VIDEO)&&(a.totalPacketsLost+=C.packetsLost,a.totalPacketsReceived+=C.packetsReceived)});return a}catch{return a}})}getAverageLossAndRTT(r){let a={rtt:0,loss:0};return Array.isArray(r)&&r.length>0&&(r.forEach(d=>{a.rtt+=d.rtt,a.loss+=d.loss}),Object.keys(a).forEach(d=>{a[d]=Math.round(a[d]/r.length)})),a}getNetworkQuality(r,a){return r>50||a>500?5:r>30||a>350?4:r>20||a>200?3:r>10||a>100?2:r>=0||a>=0?1:0}handleSignalConnectionStateChange(r){r.state==="DISCONNECTED"?(this._uplinkRTT=0,this._uplinkLoss=0,this.uplinkNetworkQuality=6):r.state==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}handleUplinkConnectionStateChange(r){let{state:a}=r;a==="DISCONNECTED"?(this._uplinkLoss=0,this._uplinkRTT=0,this.uplinkNetworkQuality=6):a==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}isPeerConnectionDisconnected(r){return!(!r||r.connectionState!==Or.DISCONNECTED&&r.connectionState!==Or.FAILED&&r.connectionState!==Or.CLOSED)}setUplinkConnection(r){this._room.uplinkConnection=r,this._room.uplinkConnection?this._room.uplinkConnection.on("connection-state-changed",this.handleUplinkConnectionStateChange.bind(this)):(this.uplinkNetworkQuality=0,this._uplinkRTT=0,this._uplinkLoss=0)}start(){this._interval===-1?(this._log.debug("start network quality calculating"),this._interval=Cr.run(dg,()=>{this.handleDownlinkNetworkQuality();let r=[...this._downlinkLossAndRTTMap.values()];Qt.emit(Vt.NETWORK_QUALITY,{room:this._room,uplink:{rtt:this._uplinkRTT,loss:this._uplinkLoss},downlinks:r}),this.emit(KV.EVENT_NETWORK_QUALITY,{uplinkNetworkQuality:this.uplinkNetworkQuality,downlinkNetworkQuality:this.downlinkNetworkQuality,uplinkRTT:this._uplinkRTT,uplinkLoss:this._uplinkLoss,downlinkRTT:this._downlinkRTT,downlinkLoss:this._downlinkLoss,downlinkInfo:r})},{delay:2e3})):this._log.info("network quality calculating is already started")}stop(){this._log.debug("stopped"),this._interval!==-1&&(Cr.clearTask(this._interval),this._interval=-1),this._downlinkLossAndRTTMap.clear(),this._downlinkPrevStatMap.clear()}updateDelay(r){let{tinyIdToUserIdMap:a}=this._room;r.forEach(d=>{let{srcTinyId:g,videoDelay:C,audioDelay:A}=d,w=a.get(g);if(w){let V=this._room.remotePublishedUserMap.get(w);V==null||V.setDelay({videoDelay:C,audioDelay:A})}})}},nw=KV;_e(nw,"EVENT_NETWORK_QUALITY","0");var zV=class{constructor(r){this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._eventMap=new Map,this._frameWorkType=r.frameWorkType||30,this._component=r.component||0,this.connectionType=r.connectionType||1,this._language=r.language||0,this._room=r.room,this._keyPrefix="key_point",this._log=cn.createLogger({id:"kpm",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),Object.getOwnPropertyNames(this.__proto__).forEach(a=>{a.startsWith("handle")&&lr(this[a])&&(this[a]=function(d){let{fn:g,context:C}=d;return function(){try{for(var A=arguments.length,w=new Array(A),V=0;V<A;V++)w[V]=arguments[V];let U=g.apply(C,w);return cR(U)?U.catch(j=>cn.error("".concat(g.name,"() error observed ").concat(j))):U}catch(U){cn.error("".concat(g.name,"() error observed ").concat(U))}}}({fn:this[a],context:this}))}),this.initData(),this.installEvents(),this._intervalId=Cr.run(dg,this.setStorage.bind(this),{delay:2e4})}get _storageKey(){return"".concat(this._keyPrefix,"_").concat(this._room.userId)}initData(){this._firstPublishedUserList=[],this._networkQuality={totalUplinkRTT:0,totalUplinkLoss:0,count:0,totalDownlinkRTTAndLossMap:new Map},this._basicInfo={string_sdk_version:nl,uint32_os_type:15,string_device_name:"",string_http_user_agent:navigator.userAgent,string_os_version:"",uint32_avg_rtt:0,uint32_avg_up_loss:0,uint32_scene:this._room.scene==="live"?1:0,uint32_joining_duration:0,uint32_networkType:0,uint32_framework:this._frameWorkType,uint32_component:this._component,uint32_connection_type:this.connectionType,uint32_caller_coding_language:this._language,string_domain:location.hostname},this._pathJoinRoom={uint64_start_time:0,uint64_send_request_acc_ip_cmd_start_time:0,uint64_send_request_acc_ip_cmd_end_time:0,uint64_send_request_enter_room_cmd_start_time:0,uint64_send_request_enter_room_cmd_end_time:0,uint64_send_first_video_frame_time:0,uint64_recv_userlist_time:0,uint64_end_time:0,int32_send_request_acc_ip_cmd_ret:0,int32_send_request_enter_room_cmd_ret:0,int32_end_ret:0},this._pathLeaveRoom={uint64_start_time:0,uint64_send_request_exit_room_cmd_start_time:0,uint64_send_request_exit_room_cmd_end_time:0,uint64_end_time:0,int32_send_request_exit_room_cmd_ret:0,int32_end_ret:0},this._localStreamStat={totalVideoBitrate:0,totalVideoFPS:0,totalVideoHeight:0,totalVideoWidth:0,totalAudioLevel:0,videoCount:0,audioLevelCount:0,publishStartTime:0,statsToReport:{uint32_audio_capture_db:0,uint32_video_big_capture_fps:0,uint32_video_big_bitrate:0,uint32_video_big_resolution:0}},this._pathMainVideoMap=new Map,this._pathMainAudioMap=new Map,this._pathAuxiliaryMap=new Map,this._remoteStreamStatMap=new Map,rR().then(r=>{this._basicInfo.string_os_version=sR(),this._basicInfo.string_device_name=r&&r.mobile?r.model:this._basicInfo.string_os_version})}addEvent(r,a){return this._eventMap.set(r,a),Qt.on(r,a),this}installEvents(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("unload",this.handleUnload),this._room.once("banned",()=>this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})),this.addEvent(Vt.JOIN_START,this.handleJoinStart).addEvent(Vt.JOIN_SCHEDULE_SUCCESS,this.handleJoinScheduleSuccess).addEvent(Vt.JOIN_SIGNAL_CONNECTION_START,this.handleSignalConnectionStart).addEvent(Vt.JOIN_SIGNAL_CONNECTION_END,this.handleSignalConnectionEnd).addEvent(Vt.JOIN_SEND_CMD,this.handleJoinSendCMD).addEvent(Vt.JOIN_RECEIVED_CMD_RES,this.handleJoinReceivedCMDResponce).addEvent(Vt.JOIN_SUCCESS,this.handleJoinSuccess).addEvent(Vt.JOIN_FAILED,this.handleJoinFailed).addEvent(Vt.LEAVE_START,this.handleLeaveStart).addEvent(Vt.LEAVE_SUCCESS,this.handleLeaveSuccess).addEvent(Vt.LEAVE_SEND_CMD,this.handleLeaveSendCMD).addEvent(Vt.LOCAL_TRACK_CAPTURE_START,this.handleTrackCaptureStart).addEvent(Vt.LOCAL_TRACK_CAPTURE_SUCCESS,this.handleTrackCaptureSuccess).addEvent(Vt.LOCAL_TRACK_CAPTURE_FAILED,this.handleTrackCaptureFailed).addEvent(Vt.PUBLISH_START,this.handlePublishStart).addEvent(Vt.SEND_FIRST_VIDEO_FRAME,this.handleSendFirstVideoFrame).addEvent(Vt.SUBSCRIBE_START,this.handleSubscribeStart).addEvent(Vt.SUBSCRIBE_SUCCESS,this.handleSubscribed).addEvent(Vt.PLAY_TRACK_START,this.handlePlayStart).addEvent(Vt.VIDEO_LOADED_DATA,this.handleVideoLoadedData).addEvent(Vt.PLAYER_STATE_CHANGED,r=>{let{track:a,state:d,type:g}=r;!_g(a)||!this.hitTest(a.room)||d==="PLAYING"&&(g===Pe.AUDIO?this.handleAudioPlaying(a):this.handleVideoPlaying(a))}).addEvent(Vt.NETWORK_QUALITY,this.handleNetworkQuality).addEvent(Vt.HEARTBEAT_REPORT,this.handleHeartbeatStats).addEvent(Vt.RECEIVED_PUBLISHED_USER_LIST,this.handleReceivedPublishUserList).addEvent(Vt.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:a,prevMuteState:d,muteState:g}=r;if(!this.hitTest(a))return;let C=d.hasAudio||d.hasVideo||d.hasSmall,A=d.hasAuxiliary,w=g.hasAudio||g.hasVideo||g.hasSmall,V=g.hasAuxiliary;!C&&w&&this.handleRemoteStreamAdded(g.userId,"main"),!A&&V&&this.handleRemoteStreamAdded(g.userId,"auxiliary")}).addEvent(Vt.SINGLE_CONNECTION_STAT,r=>{let{room:a,stat:d}=r;this.hitTest(a)&&(this._pathJoinRoom.int32_ice_cost=d.ice,this._pathJoinRoom.int32_dtls_cost=d.dtls,this._pathJoinRoom.int32_peer_connection_cost=d.peerConnection)})}uninstallEvents(){window.removeEventListener("unload",this.handleUnload),this._eventMap.forEach((r,a)=>Qt.off(a,r)),this._eventMap.clear()}destroy(){this.uninstallEvents(),Cr.clearTask(this._intervalId)}handleUnload(){this._room.isJoined&&this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})}handleJoinStart(r){this.hitTest(r.room)&&(this._pathJoinRoom.uint64_start_time===0&&(this._pathJoinRoom.uint64_start_time=Date.now(),this.checkStorage()),r.params&&(Pt(r.params.frameWorkType)||(this._frameWorkType=r.params.frameWorkType,this._basicInfo.uint32_framework=this._frameWorkType),Pt(r.params.component)||(this._component=r.params.component,this._basicInfo.uint32_component=this._component),Pt(r.params.language)||(this._language=r.params.language,this._basicInfo.uint32_caller_coding_language=this._language)))}handleJoinScheduleSuccess(r){let{room:a,detailCost:d}=r;if(this.hitTest(a)&&d){let{totalCost:g,local:C,dns:A,tcp:w,tls:V,request:U,response:j}=d;this._pathJoinRoom.int32_schedule_cost=g,this._pathJoinRoom.int32_schedule_local=C,this._pathJoinRoom.int32_schedule_dns=A,this._pathJoinRoom.int32_schedule_tcp=w,this._pathJoinRoom.int32_schedule_tls=V,this._pathJoinRoom.int32_schedule_request=U,this._pathJoinRoom.int32_schedule_response=j}}handleSignalConnectionStart(r){let{room:a}=r;this.hitTest(a)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time=Date.now())}handleSignalConnectionEnd(r){let{room:a,error:d}=r;this.hitTest(a)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time=Date.now(),d&&(this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret=d instanceof An?Number(d.getExtraCode()||d.getCode()):rn.UNKNOWN,this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret))}handleJoinSendCMD(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time=Date.now())}handleJoinReceivedCMDResponce(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time=Date.now(),this._pathJoinRoom.int32_send_request_enter_room_cmd_ret=r.code,r.code!==0&&(this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_enter_room_cmd_ret))}handleJoinSuccess(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_end_time===0&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret=0,this._signalInfo=r.room.getSignalInfo())}handleJoinFailed(r){let{room:a,error:d}=r;this.hitTest(a)&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret===0&&(this._pathJoinRoom.int32_end_ret=d.code||this._pathJoinRoom.int32_send_request_enter_room_cmd_ret||this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret),setTimeout(()=>{this.report()}))}handleReceivedPublishUserList(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_recv_userlist_time===0&&(this._pathJoinRoom.uint64_recv_userlist_time=Date.now(),this._firstPublishedUserList=r.publishedUserList||[])}handleSendFirstVideoFrame(r){let{room:a}=r;!this.hitTest(a)||this._pathJoinRoom.uint64_send_first_video_frame_time===0&&this._pathJoinRoom.uint64_start_time!==0&&(this._pathJoinRoom.uint64_send_first_video_frame_time=Date.now())}handleLeaveStart(r){this.hitTest(r.room)&&(this._pathLeaveRoom.uint64_start_time=Date.now())}handleLeaveSuccess(r){this.hitTest(r.room)&&this._pathLeaveRoom.uint64_end_time===0&&(this._pathLeaveRoom.uint64_end_time=Date.now(),this._pathJoinRoom.uint64_end_time!==0?this._basicInfo.uint32_joining_duration=this._pathLeaveRoom.uint64_end_time-this._pathJoinRoom.uint64_end_time:this._log.warn("pathJoinRoom endTime is 0"),this.report())}handleLeaveSendCMD(r){this.hitTest(r.room)&&(this._pathLeaveRoom.uint64_send_request_exit_room_cmd_start_time=Date.now(),this._pathLeaveRoom.uint64_send_request_exit_room_cmd_end_time=Date.now())}handleRemoteStreamAdded(r,a){var d;let g="".concat(r,"_").concat(a);if(!this._remoteStreamStatMap.has(g)){let C={userId:r,totalVideoFPS:0,totalVideoBitrate:0,totalAudioLevel:0,totalAudioBitrate:0,totalLoss:0,audioCount:0,audioLevelCount:0,videoCount:0,networkQualityCount:0,streamAddedTime:Date.now(),subscribeStartTime:0,subscribedTime:0,playStreamTime:0,statsToReport:uo(Pn({},aie),{msg_user_info:new ow({userId:r,tinyId:(d=this._room.remotePublishedUserMap.get(r))==null?void 0:d.tinyId,role:20})})};C.statsToReport.uint32_stream_type=a==="main"?2:7,this._remoteStreamStatMap.set(g,C)}}handleSubscribeStart(r){let{room:a,remotePublishedUser:d,streamType:g,subscribeState:C}=r;if(!this.hitTest(a))return;let{userId:A,tinyId:w,role:V}=d,U=new ow({userId:A,tinyId:w,role:V==="anchor"?20:21}),j=Date.now(),re="".concat(A,"_").concat(g),ce=this._remoteStreamStatMap.get(re);ce&&ce.subscribeStartTime===0&&(ce.subscribeStartTime=j),g==="main"?(d.muteState.hasVideo&&(C.video||C.smallVideo)&&!this._pathMainVideoMap.has(re)&&this._pathMainVideoMap.set(re,{statsToReport:{msg_user_info:U,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_render_first_frame_time:0,uint64_combine_first_frame_time:0},userId:A,sendSubscribeCMDTime:j}),d.muteState.hasAudio&&C.audio&&!this._pathMainAudioMap.has(re)&&this._pathMainAudioMap.set(re,{statsToReport:{msg_user_info:U,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_play_first_frame_time:0},userId:A,sendSubscribeCMDTime:j})):d.muteState.hasAuxiliary&&C.auxiliary&&!this._pathAuxiliaryMap.has(re)&&this._pathAuxiliaryMap.set(re,{sendSubscribeCMDTime:j})}handleSubscribed(r){let{room:a,remotePublishedUser:d,streamType:g}=r;if(this.hitTest(a)){let C="".concat(d.userId,"_").concat(g),A=this._remoteStreamStatMap.get(C);A&&A.subscribedTime===0&&(A.subscribedTime=Date.now())}}handlePlayStart(r){let{track:a}=r;if(!_g(a)||!this.hitTest(a.room))return;let d="".concat(a.userId,"_").concat(a.streamType),g=this._remoteStreamStatMap.get(d);(g==null?void 0:g.playStreamTime)===0&&(g.playStreamTime=Date.now())}handleVideoLoadedData(r){let{track:a}=r;if(!_g(a)||!this.hitTest(a.room))return;let d="".concat(a.userId,"_").concat(a.streamType),g=this._pathMainVideoMap.get(d);g&&g.statsToReport.uint64_combine_first_frame_time===0&&(g.statsToReport.uint64_combine_first_frame_time=Date.now())}handleVideoPlaying(r){let a="".concat(r.userId,"_").concat(r.streamType),d=Date.now(),g=this._pathMainVideoMap.get(a),C=this._remoteStreamStatMap.get(a);if(g&&(g.statsToReport.uint64_render_first_frame_time===0&&(g.statsToReport.uint64_render_first_frame_time=d),C)){let{statsToReport:w,playStreamTime:V,subscribedTime:U}=C;w.uint32_video_render_first===0&&V-U<=100&&(w.uint32_video_render_first=d-g.sendSubscribeCMDTime)}let A=this._pathAuxiliaryMap.get(a);if(A&&C){let{statsToReport:w,playStreamTime:V,subscribedTime:U}=C;w.uint32_video_render_first===0&&V-U<=100&&(w.uint32_video_render_first=d-A.sendSubscribeCMDTime)}}handleAudioPlaying(r){let a="".concat(r.userId,"_").concat(r.streamType),d=this._pathMainAudioMap.get(a);d&&d.statsToReport.uint64_play_first_frame_time===0&&(d.statsToReport.uint64_play_first_frame_time=Date.now())}handleNetworkQuality(r){this.hitTest(r.room)&&(this._networkQuality.totalUplinkLoss+=r.uplink.loss,this._networkQuality.totalUplinkRTT+=r.uplink.rtt,this._networkQuality.count++,r.downlinks.forEach(a=>{let{rtt:d,loss:g,userId:C,videoDelay:A,audioDelay:w}=a,V=this._networkQuality.totalDownlinkRTTAndLossMap.get(C);if(V)V.totalRTT+=d,V.totalLoss+=g,A&&(V.totalVideoDelay=(V.totalVideoDelay||0)+A,V.videoDelayCount=(V.videoDelayCount||0)+1),w&&(V.totalAudioDelay=(V.totalAudioDelay||0)+w,V.audioDelayCount=(V.audioDelayCount||0)+1),V.count++;else{let U,j,re,ce;A&&(j=A,re=1),w&&(U=w,ce=1),this._networkQuality.totalDownlinkRTTAndLossMap.set(C,{totalRTT:d,totalLoss:g,count:1,totalAudioDelay:U,totalVideoDelay:j,audioDelayCount:ce,videoDelayCount:re})}}))}handleHeartbeatStats(r){if(this.hitTest(r.room)){let{msg_up_stream_info:a,msg_down_stream_info:d}=r.report;if(a.msg_video_status[0]){let{uint32_video_codec_bitrate:g,uint32_video_enc_fps:C,uint32_video_width:A,uint32_video_height:w}=a.msg_video_status[0];this._localStreamStat.totalVideoBitrate+=g,this._localStreamStat.totalVideoFPS+=C,this._localStreamStat.totalVideoWidth+=A,this._localStreamStat.totalVideoHeight+=w,this._localStreamStat.videoCount++}if(a.msg_audio_status){let{uint32_audio_level:g}=a.msg_audio_status;Math.floor(g/Iu*100)>0&&(this._localStreamStat.totalAudioLevel+=g/Iu,this._localStreamStat.audioLevelCount++)}d.forEach(g=>{let{msg_user_info:C,msg_audio_status:A,msg_video_status:w}=g,V=C.str_identifier,U=this._room.remotePublishedUserMap.get(V);if(w.forEach(j=>{let re=j.uint32_video_stream_type===2,ce=j.uint32_video_stream_type===7,Te="".concat(V,"_").concat(re?"main":"auxiliary"),De=this._remoteStreamStatMap.get(Te);if(De&&(re&&(U!=null&&U.remoteVideoTrack.isSubscribed)||ce&&(U!=null&&U.remoteAuxiliaryTrack))){De.totalVideoFPS+=j.uint32_video_receive_fps,De.totalVideoBitrate+=j.uint32_video_codec_bitrate,De.videoCount++,De.statsToReport.uint32_video_width===0&&(De.statsToReport.uint32_video_width=j.uint32_video_width),De.statsToReport.uint32_video_height===0&&(De.statsToReport.uint32_video_height=j.uint32_video_height);let ze=re?U.remoteVideoTrack:U.remoteAuxiliaryTrack;ze.stat.jitterBufferDelay&&(De.videoJitterBufferDelay=ze.stat.jitterBufferDelay),ze.stat.framesReceived&&(De.statsToReport.uint32_video_consume_render_rate=Math.floor(ze.stat.framesDecoded/ze.stat.framesReceived*vA(10,6)))}}),A){let j="".concat(V,"_","main"),re=this._remoteStreamStatMap.get(j);this._remoteStreamStatMap.has(j)&&re&&(U!=null&&U.remoteAudioTrack.isSubscribed)&&(re.totalAudioBitrate+=A.uint32_audio_codec_bitrate,re.audioCount++,U.remoteAudioTrack.stat.jitterBufferDelay&&(re.audioJitterBufferDelay=U.remoteAudioTrack.stat.jitterBufferDelay),Math.floor(A.uint32_audio_level/Iu*100)>0&&(re.totalAudioLevel+=A.uint32_audio_level/Iu,re.audioLevelCount++))}})}}handlePublishStart(r){let{room:a}=r;this.hitTest(a)&&this._localStreamStat.publishStartTime===0&&(this._localStreamStat.publishStartTime=Date.now())}handleTrackCaptureStart(r){let{track:a}=r;a.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_start_time&&(this._pathJoinRoom.uint64_init_audio_start_time=Date.now()),a.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_start_time&&(this._pathJoinRoom.uint64_init_camera_start_time=Date.now())}handleTrackCaptureSuccess(r){let{track:a}=r;a.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=0,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),a.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=0,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}handleTrackCaptureFailed(r){let{track:a,error:d}=r,g={NotFoundError:1,NotAllowedError:2,NotReadableError:3,OverConstrainedError:4,AbortError:5,InvalidStateError:6,SecurityError:7,TypeError:8}[d.name]||(d instanceof An?d.getExtraCode()||d.getCode():rn.UNKNOWN);a.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=g,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),a.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=g,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}hasVideoFlag(r){return this._firstPublishedUserList.findIndex(a=>a.userId===r&&a.flag&U_)>=0}hasAudioFlag(r){return this._firstPublishedUserList.findIndex(a=>a.userId===r&&a.flag&x_)>=0}hasAuxFlag(r){return this._firstPublishedUserList.findIndex(a=>a.userId===r&&a.flag&VC)>=0}hitTest(r){return r===this._room}checkStorage(){return Ze(this,null,function*(){try{let r=yg.getItem(this._storageKey);r&&(yield this.upload(r),yg.deleteItem(this._storageKey))}catch(r){this._log.warn(r)}})}setStorage(){this.prepareReport();let r=this.getReportData();r.msg_path_enter_room.uint64_start_time!==0&&yg.setItem(this._storageKey,r)}prepareReport(){if(this._networkQuality.count>0&&(this._basicInfo.uint32_avg_rtt=Math.floor(this._networkQuality.totalUplinkRTT/this._networkQuality.count),this._basicInfo.uint32_avg_up_loss=Math.floor(this._networkQuality.totalUplinkLoss/this._networkQuality.count)),this._localStreamStat.videoCount>0){this._localStreamStat.statsToReport.uint32_video_big_capture_fps=Math.floor(this._localStreamStat.totalVideoFPS/this._localStreamStat.videoCount),this._localStreamStat.statsToReport.uint32_video_big_bitrate=Math.floor(this._localStreamStat.totalVideoBitrate/this._localStreamStat.videoCount);let r=Math.floor(this._localStreamStat.totalVideoWidth/this._localStreamStat.videoCount),a=Math.floor(this._localStreamStat.totalVideoHeight/this._localStreamStat.videoCount);this._localStreamStat.statsToReport.uint32_video_big_resolution=r<<16|a}this._localStreamStat.audioLevelCount>0&&(this._localStreamStat.statsToReport.uint32_audio_capture_db=Math.floor(this._localStreamStat.totalAudioLevel/this._localStreamStat.audioLevelCount*100)),this._remoteStreamStatMap.forEach((r,a)=>{let{userId:d}=r,g=this._networkQuality.totalDownlinkRTTAndLossMap.get(d);if(g){let{totalLoss:j,count:re,audioDelayCount:ce,videoDelayCount:Te,totalAudioDelay:De,totalVideoDelay:ze}=g;r.statsToReport.uint32_avg_down_loss=Math.floor(j/re),ce&&De&&(r.statsToReport.uint32_audio_network_p2p_delay=Math.floor(De/ce),r.audioJitterBufferDelay&&(r.statsToReport.uint32_p2p_delay=Math.floor(r.statsToReport.uint32_audio_network_p2p_delay+r.audioJitterBufferDelay))),Te&&ze&&(r.statsToReport.uint32_video_network_p2p_delay=Math.floor(ze/Te))}r.videoCount>0&&(r.statsToReport.uint32_video_avg_fps=Math.floor(r.totalVideoFPS/r.videoCount),r.statsToReport.uint32_video_avg_bitrate=Math.floor(r.totalVideoBitrate/r.videoCount)),r.audioCount>0&&(r.statsToReport.uint32_audio_recv_bitrate=r.statsToReport.uint32_audio_bitrate=Math.floor(r.totalAudioBitrate/r.audioCount)),r.audioLevelCount>0&&(r.statsToReport.uint32_audio_play_db=Math.floor(r.totalAudioLevel/r.audioLevelCount*100));let{callDurationCalculator:C}=this._room;C&&(r.statsToReport.uint32_audio_play_time=C.getDuration(a,Pe.AUDIO),r.statsToReport.uint32_video_play_time=C.getDuration(a,Pe.VIDEO)),r.statsToReport.uint32_video_render_first=Math.min(r.statsToReport.uint32_video_render_first,ef);let{badCaseDetector:A}=this._room,{dataFreeze:w,count:V}=A.getDataFreezeDuration(a),{renderFreeze:U}=A.getRenderFreezeDuration(a);r.statsToReport.uint32_video_block_count=V,r.statsToReport.uint32_video_block_time=Math.min(w,r.statsToReport.uint32_video_play_time),r.statsToReport.uint32_video_external_block_time=Math.min(U,r.statsToReport.uint32_video_play_time),A.isBlackStream(a)&&r.statsToReport.uint32_video_avg_fps===0?r.statsToReport.uint32_video_black_screen_subjective=1:r.statsToReport.uint32_video_black_screen_subjective=0,(r.subscribeStartTime===0||r.subscribeStartTime-r.streamAddedTime>100||r.playStreamTime===0)&&(this._pathMainAudioMap.delete(a),this._pathMainVideoMap.delete(a),r.statsToReport.uint32_video_render_first=0)}),this._pathMainAudioMap.forEach((r,a)=>{this.hasAudioFlag(r.userId)?r.statsToReport.uint64_play_first_frame_time-r.statsToReport.uint64_start_enter_time>ef&&(r.statsToReport.uint64_play_first_frame_time=r.statsToReport.uint64_start_enter_time+ef):this._pathMainAudioMap.delete(a)}),this._pathMainVideoMap.forEach((r,a)=>{this.hasVideoFlag(r.userId)?r.statsToReport.uint64_render_first_frame_time-r.statsToReport.uint64_start_enter_time>ef&&(r.statsToReport.uint64_render_first_frame_time=r.statsToReport.uint64_start_enter_time+ef):this._pathMainVideoMap.delete(a)}),this._pathJoinRoom.uint64_end_time-this._pathJoinRoom.uint64_start_time>ef&&(this._pathJoinRoom.uint64_end_time=this._pathJoinRoom.uint64_start_time+ef)}getReportData(){this._basicInfo.uint32_networkType=rS();let r={uint32_sdk_app_id:Number(this._room.sdkAppId),msg_user_info:new ow({userId:this._room.userId,tinyId:this._room.tinyId,role:this._room.role==="anchor"?20:21}),msg_basic_info:this._basicInfo,uint32_acc_ip:iS(this._signalInfo.relayIp),uint32_client_ip:iS(this._signalInfo.clientIp,!1),uint32_acc_port:this._signalInfo.relayPort||0,uint64_timestamp:Date.now(),uint32_seq:Math.floor(Math.random()*vA(2,31)),msg_path_enter_room:this._pathJoinRoom,msg_path_exit_room:this._pathLeaveRoom,msg_path_recv_video:[...this._pathMainVideoMap.values()].map(a=>a.statsToReport),msg_quality_statistics:[...this._remoteStreamStatMap.values()].map(a=>a.statsToReport),str_room_name:String(this._room.roomId||0),msg_path_recv_audio:[...this._pathMainAudioMap.values()].map(a=>a.statsToReport),uint32_info_client_ip:iS(this._signalInfo.clientIp,!1),error_code:[],msg_local_statistics:this._localStreamStat.statsToReport};return fR(r),r}report(){return Ze(this,null,function*(){try{this.prepareReport();let r=this.getReportData();yield this.upload(r),yg.deleteItem(this._storageKey),this.initData()}catch(r){this._log.warn(r)}})}upload(r){return Ze(this,null,function*(){if($h&&!o4||r.msg_path_enter_room.uint64_start_time===0||[EA,wF,DF].findIndex(w=>w===location.host)>=0)return;let a=Number(this._room.sdkAppId),d=yield jF(r),g=d instanceof ArrayBuffer,C="".concat(ny(a,P_.KEY_POINT),"&gzip=").concat(+g),A=!1;navigator.sendBeacon&&(A=navigator.sendBeacon(C,d)),A||H_({url:C,body:d}),this.uploadKVStat(Co),this.uploadKVStat(py)})}setConnectionType(r){this.connectionType=r,this._basicInfo.uint32_connection_type=r}uploadKVStat(r){return Ze(this,null,function*(){let a=r.getReportData();if(a.stats_count.length===0&&a.stats_distribution.length===0)return;a.msg_sdk_basic_info=uo(Pn({},a.msg_sdk_basic_info),{bytes_device_name:this._basicInfo.string_device_name||"",bytes_os_version:this._basicInfo.string_os_version||"",uint32_framework:this._frameWorkType,uint32_network_type:this._basicInfo.uint32_networkType||0}),this._log.debug(a);let d=yield jF(a),g="".concat(ny(+this._room.sdkAppId,P_.KV_STAT),"&gzip=").concat(+(d instanceof ArrayBuffer)),C=!1;navigator.sendBeacon&&(C=navigator.sendBeacon(g,d)),C||H_({url:g,body:d})})}};mn([Dy({settings:{timeout:500,retries:3}})],zV.prototype,"upload");var ef=5e3,aie={msg_user_info:null,uint32_video_avg_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_avg_bitrate:0,uint32_video_block_time:0,uint32_video_play_time:0,uint32_audio_block_time:0,uint32_audio_play_time:0,uint32_audio_play_db:0,uint32_avg_down_loss:0,uint32_stream_type:0,uint32_video_render_first:0,uint32_video_block_count:0,uint32_audio_block_count:0,uint32_audio_bitrate:0,uint32_video_black_screen_subjective:0,uint32_audio_recv_bitrate:0,uint32_video_external_block_time:0,uint32_video_consume_render_rate:0},ow=class{constructor(r){this.str_identifier=String(r.userId),this.str_tinyid=String(r.tinyId||0),this.uint32_role=r.role}},lie=zV,PS=class{constructor(){_e(this,"_startTime"),_e(this,"_endTime"),this._startTime=0,this._endTime=0,this.start()}start(){this._startTime===0&&(this._startTime=To())}stop(){this._endTime===0&&(this._endTime=To())}getDuration(){return this._endTime===0?To()-this._startTime:this._endTime-this._startTime}get endTime(){return this._endTime}},cie=class{constructor(r){_e(this,"_room",null),_e(this,"_durationMap"),_e(this,"_eventMap",new Map),this._room=r.room,this._durationMap=new Map,this.installEvents()}installEvents(){this._eventMap.set(Vt.SUBSCRIBE_SUCCESS,this.handleSubscribed).set(Vt.UNSUBSCRIBE_SUCCESS,this.handleStreamStopped).set(Vt.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:a,prevMuteState:d,muteState:g}=r;var C;let{userId:A}=g;if(!this.hitTest(a))return;d.hasAudio&&!g.hasAudio&&this.stopDurationItem("".concat(A,"_","main"),Pe.AUDIO),d.hasVideo&&!g.hasVideo&&this.stopDurationItem("".concat(A,"_","main"),Pe.VIDEO),d.hasAuxiliary&&!g.hasAuxiliary&&this.stopDurationItem("".concat(A,"_","auxiliary"),Pe.VIDEO);let w=(C=this._room)==null?void 0:C.remotePublishedUserMap.get(A);!w||(!d.hasAudio&&g.hasAudio&&w.remoteAudioTrack.isSubscribed&&this.addDuractionItem(A,Pe.AUDIO,"main"),!d.hasVideo&&g.hasVideo&&w.remoteVideoTrack.isSubscribed&&this.addDuractionItem(A,Pe.VIDEO,"main"),!d.hasAuxiliary&&g.hasAuxiliary&&w.remoteAuxiliaryTrack.isSubscribed&&this.addDuractionItem(A,Pe.VIDEO,"auxiliary"))}),this._eventMap.forEach((r,a)=>Qt.on(a,r,this))}uninstallEvents(){this._eventMap.forEach((r,a)=>Qt.off(a,r,this)),this._eventMap.clear()}handleSubscribed(r){let{room:a,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(a))return;let{userId:C}=g,A="".concat(C,"_").concat(d);if(g.muteState.hasAudio&&d==="main")if(g.remoteAudioTrack.isSubscribed){let w=new PS,V=this._durationMap.get(A);V?this.isRecording(V.audio)||V.audio.push(w):this._durationMap.set(A,{userId:C,type:d,audio:[w],video:[]})}else this.stopDurationItem(A,Pe.AUDIO);if(g.muteState.hasVideo||g.muteState.hasAuxiliary)if(g.remoteVideoTrack.isSubscribed||g.remoteAuxiliaryTrack.isSubscribed){let w=new PS,V=this._durationMap.get(A);V?this.isRecording(V.video)||V.video.push(w):this._durationMap.set(A,{userId:C,type:d,audio:[],video:[w]})}else this.stopDurationItem(A,Pe.VIDEO)}handleStreamStopped(r){let{room:a,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(a))return;let{userId:C}=g,A="".concat(C,"_").concat(d);this.stopDurationItem(A,Pe.AUDIO),this.stopDurationItem(A,Pe.VIDEO)}isRecording(r){return r.findIndex(a=>a.endTime===0)>=0}addDuractionItem(r,a,d){let g="".concat(r,"_").concat(d),C=new PS,A=this._durationMap.get(g);A?this.isRecording(A[a])||A[a].push(C):this._durationMap.set(g,{userId:r,type:d,audio:a===Pe.AUDIO?[C]:[],video:a===Pe.AUDIO?[]:[C]})}stopDurationItem(r,a){if(this._durationMap.has(r)){let d=this._durationMap.get(r)[a].find(g=>g.endTime===0);d&&d.stop()}}hitTest(r){return this._room===r}getDuration(r,a){return this._durationMap.has(r)?this._durationMap.get(r)[a].reduce((d,g)=>d+g.getDuration(),0):0}getDurationMap(){return this._durationMap}reset(){this._durationMap.clear()}destroy(){this._room=null,this.uninstallEvents()}},uie=class{constructor(r){_e(this,"_room"),_e(this,"_renderFreezeMap",new Map),_e(this,"_isVideoPlayingEventFiredMap",new Map),_e(this,"_dataFreezeMap",new Map),_e(this,"_monitorFreezeData",new Map),_e(this,"_eventMap",new Map),this._room=r.room,this.installEvents()}installEvents(){this._eventMap.set(Vt.LEAVE_SUCCESS,r=>{let{room:a}=r;this.hitTest(a)&&this.stop()}).set(Vt.PLAY_TRACK_START,this.onPlayTrackStart).set(Vt.UNSUBSCRIBE_SUCCESS,r=>{let{room:a,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(a))return;let{userId:C}=g,A="".concat(C,"_").concat(d);this.stopDataFreeze({key:A,userId:C,type:d})}).set(Vt.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:a,prevMuteState:d,muteState:g}=r;if(!this.hitTest(a))return;let{userId:C}=g;if(d.hasVideo&&!g.hasVideo){let A="main",w="".concat(g.userId,"_").concat(A);this.stopDataFreeze({key:w,userId:C,type:A})}if(d.hasAuxiliary&&!g.hasAuxiliary){let A="auxiliary",w="".concat(g.userId,"_").concat(A);this.stopDataFreeze({key:w,userId:C,type:A})}}).set(Vt.PLAYER_STATE_CHANGED,r=>{let{track:a,state:d,reason:g,type:C}=r;if(_g(a)&&this.hitTest(a.room)&&C===Pe.VIDEO){if(d==="PLAYING"){let A="".concat(a.userId,"_").concat(a.streamType);this._isVideoPlayingEventFiredMap.set(A,!0)}g===Pe.MUTE?this.onVideoTrackMuted(a):g===Pe.UNMUTE&&this.onVideoTrackUnmuted(a)}}).set(Vt.HEARTBEAT_REPORT,this.onHearBeatReport),this._eventMap.forEach((r,a)=>Qt.on(a,r,this))}uninstallEvents(){this._eventMap.forEach((r,a)=>Qt.off(a,r,this)),this._eventMap.clear()}stop(){this._renderFreezeMap.clear(),this._dataFreezeMap.clear(),this._isVideoPlayingEventFiredMap.clear()}onVideoTrackMuted(r){if(!r.isSubscribed)return;let{userId:a,streamType:d}=r,g="".concat(a,"_").concat(d),C=this._dataFreezeMap.get(g),A=new PS;C?C.durationItemList.push(A):this._dataFreezeMap.set(g,{userId:a,type:d,durationItemList:[A],isFreezing(){let w=this.durationItemList[this.durationItemList.length-1];return w&&w.endTime===0}})}onVideoTrackUnmuted(r){if(!r.isSubscribed)return;let{userId:a,streamType:d}=r,g="".concat(a,"_").concat(d);this.stopDataFreeze({key:g,userId:a,type:d})}onHearBeatReport(r){let{room:a,report:d}=r;!this.hitTest(a)||d.msg_down_stream_info.forEach(g=>{let C=this._room.remotePublishedUserMap.get(g.msg_user_info.str_identifier);if(!C)return;let{userId:A,muteState:w}=C;g.msg_video_status.forEach(V=>{V.uint32_video_stream_type===2&&w.hasVideo&&!w.videoMuted&&C.remoteVideoTrack.isSubscribed&&this.handleRenderFreeze({userId:A,fps:V.uint32_video_dec_fps,type:"main"}),V.uint32_video_stream_type===7&&w.hasAuxiliary&&C.remoteAuxiliaryTrack.isSubscribed&&this.handleRenderFreeze({userId:A,fps:V.uint32_video_dec_fps,type:"auxiliary"})})})}stopDataFreeze(r){let{key:a,userId:d,type:g}=r,C=this._dataFreezeMap.get(a);if(!C||!C.isFreezing())return;let A=C.durationItemList[C.durationItemList.length-1];A.stop();let w=A.getDuration();w>NA?this._monitorFreezeData.set(a,{userId:d,type:g,duration:w}):C.durationItemList.pop()}getTotalDuration(r){return r.reduce((a,d)=>{let g=d.getDuration();return a+Math.min(g,5e3)},0)}handleRenderFreeze(r){return Ze(this,arguments,function(a){var d=this;let{userId:g,fps:C,type:A}=a;return function*(){let w="".concat(g,"_").concat(A),V=d._renderFreezeMap.get(w);if(C<=2){let U=To();V&&!V.isFreeze&&(V.freezeTimeline.push({startTime:U,endTime:0}),V.isFreeze=!0),V||d._renderFreezeMap.set(w,{userId:g,type:A,isFreeze:!0,freezeTimeline:[{startTime:U,endTime:0}],renderFreezeTotal:0})}else if(V&&V.isFreeze){V.isFreeze=!1;let U=V.freezeTimeline.pop();if(U){U.endTime=To();let j=U.endTime-U.startTime;V.freezeTimeline.push(U),V.renderFreezeTotal+=Math.min(5e3,j)}}}()})}onPlayTrackStart(r){let{track:a}=r;if(!_g(a)||!this.hitTest(a.room)||a.kind!==Pe.VIDEO||a.hasFlag)return;let d="".concat(a.userId,"_").concat(a.streamType);this._isVideoPlayingEventFiredMap.has(d)||this._isVideoPlayingEventFiredMap.set(d,!1)}getDataFreezeDuration(r){let a={dataFreeze:0,count:0},d=this._dataFreezeMap.get(r);if(d){if(d.isFreezing()){let g=d.durationItemList[d.durationItemList.length-1];g.stop(),g.getDuration()<NA&&d.durationItemList.pop()}a.dataFreeze=this.getTotalDuration(d.durationItemList),a.count=d.durationItemList.length}return a}getRenderFreezeDuration(r){let a=this._renderFreezeMap.get(r),d=0,g=0;if(a)if(a.isFreeze){let C=To()-a.freezeTimeline[a.freezeTimeline.length-1].startTime;d=a.renderFreezeTotal+Math.min(C,5e3),g=a.freezeTimeline.length}else d=a.renderFreezeTotal;return{renderFreeze:d,count:g}}getMonitorFreeze(){return this._monitorFreezeData}isBlackStream(r){return!!this._isVideoPlayingEventFiredMap.has(r)&&!this._isVideoPlayingEventFiredMap.get(r)}resetMonitor(){this._monitorFreezeData.clear()}hitTest(r){return r===this._room}destroy(){this.uninstallEvents()}},die=vi(gs(),1),hie=[-1,-1,1,-1,-1,1,1,1],fie=[0,0,1,0,0,1,1,1],tf=class extends _o{constructor(r,a){if(super(),this.context=r,_e(this,"name"),_e(this,"input"),_e(this,"output"),_e(this,"texture"),_e(this,"image"),_e(this,"ctx2d",null),_e(this,"fbo"),_e(this,"width",0),_e(this,"height",0),_e(this,"x",0),_e(this,"y",0),_e(this,"program"),_e(this,"vertexShader"),_e(this,"fragmentShader"),_e(this,"totalFrames",0),_e(this,"dropFrames",0),_e(this,"matchInputSize",!0),_e(this,"texCoordBuffer"),_e(this,"positionBuffer"),_e(this,"lastInfo",{name:"",timestamp:0,totalFrames:0,x:0,y:0,width:0,height:0,fps:0}),_e(this,"cost",0),_e(this,"_canvas",null),this.context.on("disconnect",this.close,this),this.name=a.name,this.matchInputSize=a.matchInputSize!==!1,this.width=a.width||r.width,this.height=a.height||r.height,r instanceof Lu){if(r.ctx&&a.create2d){let d=document.createElement("canvas"),g=typeof d.transferControlToOffscreen=="function"?d.transferControlToOffscreen():d;g.width=this.width,g.height=this.height,this.ctx2d=g.getContext("2d"),this.image=g,this._canvas=g}}else try{let d=r.ctx;this.texCoordBuffer=this.createBuffer(fie),this.positionBuffer=this.createBuffer(hie),a.createTexture!==!1&&(this.texture=d.createTexture(),this.useTexture(),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.pixelStorei(d.PACK_ALIGNMENT,1),d.pixelStorei(d.UNPACK_ALIGNMENT,1)),a.useFbo&&(this.fbo=d.createFramebuffer(),this.useBufferFrame(),this.useTexture(),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,this.width,this.height,0,d.RGBA,d.UNSIGNED_BYTE,null),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this.texture,0)),a.useDefaultProgram?this.program=r.defaultProgam:(a.vertexShaderSource||a.fragmentShaderSource)&&(this.vertexShader=a.vertexShaderSource?r.createShader(d.VERTEX_SHADER,a.vertexShaderSource):r.defaultVShader,this.fragmentShader=a.fragmentShaderSource?r.createShader(d.FRAGMENT_SHADER,a.fragmentShaderSource):r.defaultFShader,this.program=r.createProgram(this.vertexShader,this.fragmentShader))}catch(d){this.context.destroy(d)}}createFramebuffer(r){let a=this.context.ctx,d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),d}connect(r){for(var a=arguments.length,d=new Array(a>1?a-1:0),g=1;g<a;g++)d[g-1]=arguments[g];return r.addInput(this,...d),this.output=r,r}addInput(r){this.input=r,this.matchInputSize&&r.width&&r.height&&this.resize(r.width,r.height)}requestFrame(r){let a=Date.now();return!!(this.context instanceof cl&&this.render(r)||this.context instanceof Lu&&this.render2d(r))&&(this.totalFrames++,this.cost=Date.now()-a,!0)}render2d(r){var a;return!((a=this.input)==null||!a.requestFrame(r))&&this.draw2d(this.input.image,0,0,this.width,this.height)}disconnect(){for(var r,a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];(r=this.output)==null||r.removeInput(this,...d),delete this.output}removeInput(r){delete this.input}close(){var r,a;if(this.context.off("disconnect",this.close,this),(r=this.output)==null||r.removeInput(this),delete this.output,(a=this.input)==null||a.disconnect(),this.context instanceof cl){let d=this.context.ctx;d.deleteBuffer(this.texCoordBuffer),d.deleteBuffer(this.positionBuffer),this.fbo&&d.deleteFramebuffer(this.fbo),this.texture&&d.deleteTexture(this.texture),this.vertexShader&&this.vertexShader!==this.context.defaultVShader&&d.deleteShader(this.vertexShader),this.fragmentShader&&this.fragmentShader!==this.context.defaultFShader&&d.deleteShader(this.fragmentShader),this.program&&this.program!==this.context.defaultProgam&&d.deleteProgram(this.program)}this._canvas&&(this._canvas.width=0,this._canvas.height=0,this.ctx2d=null),this.removeAllListeners()}useTexture(){this.useTextures(this.texture)}useInputTexture(){var r;this.useTextures((r=this.input)==null?void 0:r.texture)}useTextures(){let r=this.context.ctx;for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];d.forEach((C,A)=>{C&&(r.activeTexture(r.TEXTURE0+A),r.bindTexture(r.TEXTURE_2D,C))})}useProgram(){this.context.ctx.useProgram(this.program)}useBufferFrame(){let r=this.context.ctx;r.bindFramebuffer(r.FRAMEBUFFER,this.fbo||null)}createBuffer(r){let a=this.context.ctx,d=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,d),a.bufferData(a.ARRAY_BUFFER,new Float32Array(r),a.STATIC_DRAW),d}setTexBuffer(r){let a=this.context.ctx;a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(r),a.STATIC_DRAW)}setPosBuffer(r){let a=this.context.ctx;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(r),a.STATIC_DRAW)}changeBufferData(r,a){let d=this.context.ctx;d.bindBuffer(d.ARRAY_BUFFER,r),d.bufferData(d.ARRAY_BUFFER,new Float32Array(a),d.STATIC_DRAW)}setAttributes(){let r=this.context.ctx;for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];d.forEach((C,A)=>{r.enableVertexAttribArray(A),r.bindBuffer(r.ARRAY_BUFFER,C),r.vertexAttribPointer(A,2,r.FLOAT,!1,0,0)})}getVertexPoint(r,a){return[r/this.width*2-1,a/this.height*2-1]}layout2texCoords(r){return[...this.getVertexPoint(r.x,r.y),...this.getVertexPoint(r.x+r.width,r.y),...this.getVertexPoint(r.x,r.y+r.height),...this.getVertexPoint(r.x+r.width,r.y+r.height)]}resize(r,a){if(this.width!==r||this.height!==a){if(this.width=r,this.height=a,this._canvas&&(this._canvas.width=r,this._canvas.height=a),this.texture&&this.fbo){this.useTexture();let d=this.context.ctx;d.texImage2D(d.TEXTURE_2D,0,d.RGBA,r,a,0,d.RGBA,d.UNSIGNED_BYTE,null)}this.output&&this.output.matchInputSize&&this.output.resize(r,a)}}draw(r,a){this.setAttributes(r||this.positionBuffer,a||this.texCoordBuffer);let d=this.context.ctx;d.drawArrays(d.TRIANGLE_STRIP,0,4)}draw2d(r,a,d,g,C){return!(!this.ctx2d||!r)&&(r instanceof ImageData?this.ctx2d.putImageData(r,a,d):this.ctx2d.drawImage(r,a,d,g,C),!0)}getInfo(){var r;let{totalFrames:a,x:d,y:g,width:C,height:A,name:w,cost:V}=this,U=Date.now(),j=(a-this.lastInfo.totalFrames)/((U-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:a,x:d,y:g,width:C,height:A,timestamp:U,fps:j,name:w,cost:V},Pn({parent:(r=this.input)==null?void 0:r.getInfo()},this.lastInfo)}createTexture(r){let a=this.context.ctx,d=a.createTexture();return this.useTextures(d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.PACK_ALIGNMENT,1),a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,r),d}};mn([yi(_o.INIT,"connected",{sync:!0})],tf.prototype,"connect"),mn([yi("connected",_o.INIT,{ignoreError:!0,sync:!0})],tf.prototype,"disconnect"),mn([yi([],"closed",{sync:!0})],tf.prototype,"close");var pie=[0,1,1,1,0,0,1,0],WV=class extends tf{constructor(r,a){super(r,Object.assign({useDefaultProgram:!0,createTexture:!1,name:"destination"},a)),_e(this,"_intervalId",0),_e(this,"_sequence",0),_e(this,"checkGLError",!1),r instanceof Lu?this.ctx2d=r.ctx:r.available&&(a!=null&&a.mirrorUpAndDown)&&this.setTexBuffer(pie)}start(r){this._intervalId=Cr.run("intervalInWorker",()=>{if(r!==this.context.frameRate&&(Cr.clearTask(this._intervalId),this.start(this.context.frameRate)),this.requestFrame(this._sequence++),this.checkGLError&&this.context instanceof cl){let a=this.context.ctx.getError();a&&this.context.destroy(new Error("".concat(this.name," req ").concat(this._sequence," render ").concat(this.totalFrames," faild ").concat(a)))}},{fps:this.context.frameRate})}render(r){var a;return!((a=this.input)==null||!a.requestFrame(r))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}addInput(r){for(var a=arguments.length,d=new Array(a>1?a-1:0),g=1;g<a;g++)d[g-1]=arguments[g];super.addInput(r,...d),this.start(this.context.frameRate)}removeInput(r){super.removeInput(r),Cr.clearTask(this._intervalId)}resize(r,a){super.resize(r,a),this.context.setSize(r,a)}},rw=class extends WV{constructor(r,a){super(r,a),_e(this,"_videoTrack"),[this._videoTrack]=r._canvas.captureStream(r.frameRate).getVideoTracks();let d=g=>{var C;let A=()=>{var V;return(V=this._videoTrack)==null?void 0:V.removeEventListener(g,w)},w=()=>{A(),this.context.destroy(new Error("video track ".concat(g)))};this.once("closed",A),(C=this._videoTrack)==null||C.addEventListener(g,w)};r instanceof cl&&d("mute"),d("ended")}get videoTrack(){return this._videoTrack}close(){var r;super.close(),(r=this._videoTrack)==null||r.stop(),delete this._videoTrack}},gie=class extends rw{render(r){var a;return!((a=this.input)==null||!a.requestFrame(r))}},mie=class extends rw{constructor(r,a){super(r,{name:"smallDestination"}),this.resolution=a}resize(r,a){let d,g=r*a,C=this.resolution.width*this.resolution.height;cn.info("big res: ".concat(r,"*").concat(a," small res: ").concat(this.resolution.width,"*").concat(this.resolution.height," ")),g>C?d=g/C:(cn.warn("Small stream resolution is not smaller than big stream, which is invalid. big: ".concat(r," * ").concat(a," small: ").concat(this.resolution.width," * ").concat(this.resolution.height)),d=g/19200),super.resize(r/Math.sqrt(d),a/Math.sqrt(d))}},jV=class extends tf{constructor(r,a,d){super(r,Pn({name:"imageSource"},d)),this.image=a,_e(this,"_image"),_e(this,"_totalFrames",0),_e(this,"_autoResize",!1),this._autoResize=(d==null?void 0:d.autoResize)!==!1}_render(r,a){let{width:d,height:g}=this;if(this.image instanceof HTMLVideoElement){if(lr(this.image.getVideoPlaybackQuality)&&!Z_){let C=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===C)return!1;this._totalFrames=C,this.dropFrames=this._totalFrames-this.totalFrames}if({videoWidth:d,videoHeight:g}=this.image,!d||!g)return!1;this.image.width=d,this.image.height=g}else if(this.image instanceof HTMLImageElement||this.image instanceof ImageData||this.image instanceof ImageBitmap){if({width:d,height:g}=this.image,this.image!==this._image)this._image=this.image;else if(d===this.width&&g===this.height)return!1}else(this.image instanceof HTMLCanvasElement||this.image instanceof OffscreenCanvas)&&({width:d,height:g}=this.image,this._image=this.image);if(!this._autoResize)return!0;if(this.width===d&&this.height===g&&this.totalFrames){if(a){this.useTexture();let C=this.context.ctx;C.texSubImage2D(C.TEXTURE_2D,0,0,0,C.RGBA,C.UNSIGNED_BYTE,this.image)}}else{if(a){this.useTexture();let C=this.context.ctx;C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,this.image)}this.resize(d,g)}return!0}render(r){return this._render(r,!0)}render2d(r){return this._render(r,!1)}},YV=class extends jV{constructor(r,a,d){let g=document.createElement("video");g.setAttribute("playsinline","playsinline"),g.setAttribute("muted",""),super(r,g,d),this._videoTrack=a,_e(this,"_mediaStream"),this.name="videoTrackSource",this._mediaStream=new MediaStream([a]),this.image.srcObject=this._mediaStream,this.image.play()}replaceTrack(r){var a,d;this._videoTrack!==r&&((a=this._mediaStream)==null||a.removeTrack(this._videoTrack),this._videoTrack=r,(d=this._mediaStream)==null||d.addTrack(this._videoTrack),this.image.play())}close(){var r;super.close(),(r=this._mediaStream)==null||r.removeTrack(this._videoTrack),delete this._mediaStream,this.image.srcObject=null}},JV=class extends _o{constructor(r){super(),_e(this,"frameRate"),_e(this,"_canvas"),_e(this,"log"),_e(this,"hasAlpha",!1),_e(this,"name"),this.name=r.name,this.log=r.logger.createChild({id:"vc-".concat(this.name)}),this.frameRate=r.frameRate}set width(r){this._canvas&&(this._canvas.width=r)}get width(){var r;return((r=this._canvas)==null?void 0:r.width)||0}set height(r){this._canvas&&(this._canvas.height=r)}get height(){var r;return((r=this._canvas)==null?void 0:r.height)||0}setSize(r,a){this._canvas&&(this._canvas.width=r,this._canvas.height=a)}createVideoTrackSource(r){return new YV(this,r)}createVideoTrackDestination(r){return new rw(this,r)}createVideoImageSource(r,a){return new jV(this,r,a)}get available(){return this.state==="created"}disconnect(){this.emit("disconnect")}},vie={alpha:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0,powerPreference:"low-power"},cl=class extends JV{constructor(){super(...arguments),_e(this,"defaultProgam"),_e(this,"defaultVShader"),_e(this,"defaultFShader"),_e(this,"ctx")}create(){if(this._canvas||(this._canvas=document.createElement("canvas")),this.ctx=this._canvas.getContext("webgl2",vie),!this.ctx)throw new Error("webgl2 not supported");this.defaultVShader=this.createShader(this.ctx.VERTEX_SHADER,`
// 顶点着色器
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoord;

void main() {
  gl_Position = a_position;
  v_texCoord = a_texCoord;
}
`),this.defaultFShader=this.createShader(this.ctx.FRAGMENT_SHADER,`
// 片元着色器
precision mediump float;
varying vec2 v_texCoord;
uniform sampler2D u_texture;

void main() {
  gl_FragColor = texture2D(u_texture, v_texCoord);
} `),this.defaultProgam=this.createProgram(this.defaultVShader,this.defaultFShader),this._canvas.addEventListener("webglcontextlost",()=>{this.destroy(new Error("webgl context lost"))}),this.log.info("video context created use webgl")}destroy(r){return this.disconnect(),this.log.info("video context destroy ".concat(r?": ".concat(r):"")),this.ctx&&(this.ctx.deleteShader(this.defaultVShader),this.ctx.deleteShader(this.defaultFShader),this.ctx.deleteProgram(this.defaultProgam),delete this.ctx),r}set width(r){var a;(a=this.ctx)==null||a.viewport(0,0,r,this.height),super.width=r}set height(r){var a;(a=this.ctx)==null||a.viewport(0,0,this.width,r),super.height=r}setSize(r,a){var d;(d=this.ctx)==null||d.viewport(0,0,r,a),super.setSize(r,a)}createShader(r,a){let d=this.ctx,g=d.createShader(r);return d.shaderSource(g,a),d.compileShader(g),g}createProgram(r,a){let d=this.ctx,g=d.createProgram();return d.attachShader(g,r),d.attachShader(g,a),d.linkProgram(g),d.getProgramParameter(g,d.LINK_STATUS)||this.log.error(d.getProgramInfoLog(g)),g}};mn([yi(_o.INIT,"created",{sync:!0})],cl.prototype,"create"),mn([yi("created",_o.INIT,{ignoreError:!0,sync:!0,success(r){r&&this.emit("unavailable",r),this.removeAllListeners()}})],cl.prototype,"destroy");var Lu=class extends JV{constructor(){super(...arguments),_e(this,"ctx")}create(r){if(this.hasAlpha=r.alpha,this._canvas=document.createElement("canvas"),this.ctx=this._canvas.getContext("2d",{alpha:r.alpha}),!this.ctx)throw new Error("2d context not supported");this.log.info("video context created use 2d")}destroy(r){this.disconnect(),this.log.info("video context destroy ".concat(r?": ".concat(r):"")),delete this.ctx,this._canvas&&(this._canvas.remove(),this._canvas.width=0,this._canvas.height=0,delete this._canvas),this.removeAllListeners()}};mn([yi(_o.INIT,"created",{sync:!0})],Lu.prototype,"create"),mn([yi("created",_o.INIT,{ignoreError:!0,sync:!0})],Lu.prototype,"destroy");var _ie=[1,0,0,0,1,1,0,1],yie=class extends tf{constructor(r){if(super(r,{useDefaultProgram:!0,useFbo:!0,create2d:!0,name:"mirror"}),r instanceof cl)try{this.setTexBuffer(_ie)}catch(a){r.destroy(a)}}draw2d(r,a,d,g,C){if(this.ctx2d){this.ctx2d.save(),this.ctx2d.scale(-1,1),this.ctx2d.translate(-this.width,0);let A=super.draw2d(r,a,d,g,C);return this.ctx2d.restore(),A}return!1}render(r){var a;return!((a=this.input)==null||!a.requestFrame(r))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}},Iie=class{constructor(r,a){this.node=r,this.layout=a,_e(this,"positionBuffer")}get x(){return this.layout.x||this.node.x}get y(){return this.layout.y||this.node.y}get width(){return this.layout.width||this.node.width}get height(){return this.layout.height||this.node.height}get right(){return this.x+this.width}get bottom(){return this.y+this.height}},bie=class extends tf{constructor(r){super(r,{useDefaultProgram:!0,useFbo:!0,name:"mix",create2d:!0}),_e(this,"inputs",[])}addInput(r,a){if(this.inputs[a.zIndex])throw new Error("input already exists");let d=new Iie(r,a);this.inputs[a.zIndex]=d}resize(r,a){let d=this.inputs.reduce((g,C)=>C?Object.assign(g,{width:Math.max(g.width,C.right),height:Math.max(g.height,C.bottom)}):g,{width:0,height:0});super.resize(d.width,d.height),this.context instanceof cl&&this.inputs.forEach(g=>{if(g){let C=this.layout2texCoords(g);g.positionBuffer?this.changeBufferData(g.positionBuffer,C):g.positionBuffer=this.createBuffer(C)}})}connect(r){for(var a=arguments.length,d=new Array(a>1?a-1:0),g=1;g<a;g++)d[g-1]=arguments[g];return super.connect(r,...d),this.resize(0,0),r}removeInput(r){this.inputs[this.inputs.findIndex(a=>(a==null?void 0:a.node)===r)]=void 0}render(r){let a=this.context.ctx;if(a.clearColor(0,0,0,0),!this.inputs.reduce((d,g)=>(!g||!g.node.requestFrame(r))&&d,!0)&&a){this.useProgram(),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),this.useBufferFrame();for(let d=0;d<this.inputs.length;d++){let g=this.inputs[d];g&&(g.node.useTexture(),this.draw(g.positionBuffer))}return!0}return!1}render2d(r){if(!this.inputs.reduce((a,d)=>(!d||!d.node.requestFrame(r))&&a,!0)&&this.ctx2d){this.ctx2d.clearRect(0,0,this.width,this.height);for(let a=0;a<this.inputs.length;a++){let d=this.inputs[a];d&&this.draw2d(d.node.image,d.x,d.y,d.width,d.height)}return!0}return!1}getInfo(){let{totalFrames:r,x:a,y:d,width:g,height:C,name:A}=this,w=Date.now(),V=(r-this.lastInfo.totalFrames)/((w-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:r,x:a,y:d,width:g,height:C,timestamp:w,fps:V,name:A},Pn({parent:this.inputs.filter(U=>U).map(U=>U.node.getInfo())},this.lastInfo)}close(){super.close(),this.inputs.forEach(r=>{var a,d;if(r&&((a=r.node)==null||a.disconnect(),r.positionBuffer&&this.context instanceof cl))try{(d=this.context.ctx)==null||d.deleteBuffer(r.positionBuffer)}catch{}})}},Cie=class extends YV{constructor(r,a){super(r,a.input,{name:"vb",create2d:!1,useDefaultProgram:!1,useFbo:!1,createTexture:!0}),_e(this,"ready",!1),_e(this,"_bgTexture"),_e(this,"_waterMarkTexture"),_e(this,"_lastMaskTexture"),_e(this,"_lastMaskFbo"),_e(this,"_textureValid",!1),_e(this,"_selfieTextureValid",!1),_e(this,"_selfieSegmentation"),_e(this,"wasm"),_e(this,"_prePrograme"),_e(this,"_segmentationMask"),_e(this,"_weixin",!1),this._selfieSegmentation=a.selfieSegmentation,this._selfieSegmentation.onResults=this.onPredict.bind(this),this.init(a).catch(()=>this.context.destroy(new Error("selfie_segmentation init faild")))}init(r){return Ze(this,null,function*(){let a=r.Wasm,d=this.context.ctx;if(this.wasm=new a.AllIn1(d),this.wasm.blurRadius=r.blurRadius||3,this.wasm.mirror=!!r.mirror,this.wasm.vbMode=r.bg==="blur"?1:r.bg instanceof HTMLImageElement?2:r.bg==="green"?3:0,r.waterMark){let{x:g,y:C,width:A,height:w}=r.waterMark;this.wasm.setWaterMark(g,C,A,w)}if(this.program=this.wasm.init(),this.useProgram(),this.setAttributes(this.positionBuffer,this.texCoordBuffer),d.uniform1i(d.getUniformLocation(this.program,"mask"),1),r.bg instanceof HTMLImageElement&&(d.uniform1i(d.getUniformLocation(this.program,"bg"),2),this._bgTexture=this.createTexture(r.bg)),r.waterMark&&(d.uniform1i(d.getUniformLocation(this.program,"waterMark"),3),this._waterMarkTexture=this.createTexture(r.waterMark.image)),d.uniform1i(d.getUniformLocation(this.program,"lastMask"),4),this._weixin){let g=this.context.createShader(d.FRAGMENT_SHADER,`#version 300 es
precision highp float;
uniform sampler2D u_texture;
uniform sampler2D mask;

in vec2 v_texCoord;
out vec4 outColor;
void main() {
  outColor = vec4(texture(u_texture, v_texCoord).rgb, texture(mask, v_texCoord).a);
}`),C=this.context.createShader(d.VERTEX_SHADER,`#version 300 es
in vec2 a_position;
in vec2 a_texCoord;
out vec2 v_texCoord;
void main() {
  gl_Position = vec4(a_position.x, a_position.y, 0, 1);
  v_texCoord = a_texCoord;
}`);this._prePrograme=this.context.createProgram(C,g),d.useProgram(this._prePrograme),this.setAttributes(this.positionBuffer,this.texCoordBuffer),d.uniform1i(d.getUniformLocation(this._prePrograme,"mask"),1)}this.ready=!0})}onPredict(r){let a=this.context.ctx;this._weixin&&(this._lastMaskTexture||(this._lastMaskTexture=this.createTexture(this.image),this._lastMaskFbo=this.createFramebuffer(this._lastMaskTexture))),this.useProgram(),this._weixin?this.useTexture():this._selfieSegmentation.bindTexture(),a.activeTexture(a.TEXTURE1),this._selfieSegmentation.bindTexture2d(r),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,this._bgTexture||null),a.activeTexture(a.TEXTURE3),a.bindTexture(a.TEXTURE_2D,this._waterMarkTexture||null),this.useBufferFrame(),a.drawArrays(a.TRIANGLE_STRIP,0,4),this._segmentationMask=r,this.totalFrames++}render(r){let a=this.context.ctx;if(typeof this.image.getVideoPlaybackQuality=="function"&&!Z_){let A=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===A)return!1;this._totalFrames=A,this.dropFrames=this._totalFrames-this.totalFrames}let{videoWidth:d,videoHeight:g}=this.image;this.image.width=d,this.image.height=g;let C=!1;if(this.totalFrames)this._weixin?this.useTexture():this._selfieSegmentation.bindTexture(),C=this._selfieTextureValid,this._selfieTextureValid=!0;else{if(!this.program)return!1;this.useTexture(),C=this._textureValid,this._textureValid=!0}return this.width===d&&this.height===g&&C?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.image):(this.resize(d,g),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.image)),this.ready&&(this._weixin&&(a.useProgram(this._prePrograme),this.useTexture(),this._segmentationMask&&(a.activeTexture(a.TEXTURE1),this._selfieSegmentation.bindTexture2d(this._segmentationMask),a.bindFramebuffer(a.FRAMEBUFFER,this._lastMaskFbo||null)),a.drawArrays(a.TRIANGLE_STRIP,0,4),this._selfieSegmentation.bindTexture(),this._segmentationMask?a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,0,0,d,g):a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,d,g,0)),this._selfieSegmentation.send(d,g)),this.totalFrames||(a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,this._bgTexture||null),a.activeTexture(a.TEXTURE3),a.bindTexture(a.TEXTURE_2D,this._waterMarkTexture||null),a.drawArrays(a.TRIANGLE_STRIP,0,4)),!1}close(){var r;super.close();let a=this.context.ctx;this._bgTexture&&a.deleteTexture(this._bgTexture),this._waterMarkTexture&&a.deleteTexture(this._waterMarkTexture),this._lastMaskTexture&&a.deleteTexture(this._lastMaskTexture),this._lastMaskFbo&&a.deleteFramebuffer(this._lastMaskFbo),this._prePrograme&&a.deleteProgram(this._prePrograme),(r=this.wasm)==null||r.close()}},Sie=class extends die.EventEmitter{constructor(r){super(),this.room=r,_e(this,"videoContext"),_e(this,"_glVideoContext"),_e(this,"_2dVideoContext"),_e(this,"destination"),_e(this,"smallVideoContext"),_e(this,"smallDestination"),_e(this,"smallTrackSource"),_e(this,"smallImageSource"),_e(this,"_isMirror",!1),_e(this,"cameraTrack"),_e(this,"cameraNode"),_e(this,"mirrorNode"),_e(this,"mixNode"),_e(this,"screenTrack"),_e(this,"screenNode"),_e(this,"selfModel",!1),_e(this,"blurRadius",3),_e(this,"arTrack"),_e(this,"Wasm"),_e(this,"waterMarkNode"),_e(this,"_waterMarkOption"),_e(this,"watermarkImageList",[]),_e(this,"_isMixScreen",!1),_e(this,"_virtualBackground"),_e(this,"virtualBackgroundInstance"),_e(this,"isUsingArTrack",!1),_e(this,"_bgAssetPath"),_e(this,"log",cn.createLogger({id:"vm"})),_e(this,"_checkId",0),_e(this,"_use2d",!1),_e(this,"_autoSwitchRenderMode",!0),_e(this,"_selfieSegmentation"),r&&(this.log.setUserId(r.userId),this.log.setSdkAppId(r.sdkAppId)),this.smallVideoContext=new Lu({frameRate:15,logger:this.log,name:"s"}),this.enablePrintDetail()}get _hasVirtualBg(){return!!this._virtualBackground}get _hasWaterMark(){return this.watermarkImageList.length>0}get renderMode(){return this._autoSwitchRenderMode?"auto":this._use2d?"2d":"webgl"}set renderMode(r){if(this._autoSwitchRenderMode=r==="auto",this._autoSwitchRenderMode)return;let a=r==="2d";this._use2d!==a&&(this._use2d=a,this.clear(),this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.update())}get2dVideoContext(){return this._2dVideoContext?this._2dVideoContext.destroy():this._2dVideoContext=new Lu({frameRate:15,logger:this.log,name:"m"}),this._2dVideoContext.create({alpha:this._hasWaterMark||this._hasVirtualBg}),this.sendCreateResult("videoCtx2d",this._2dVideoContext.ctx?void 0:new Error("create 2d context failed")),this._2dVideoContext}getGlVideoContext(){if(this._glVideoContext){if(this._glVideoContext.available)return this._glVideoContext}else this._glVideoContext=new cl({frameRate:15,logger:this.log,name:"m"});try{this._glVideoContext.create(),this.sendCreateResult(),this._glVideoContext.on("unavailable",(r,a)=>{this.emit("error",{reason:r,error:a}),this.log.warn("video context unavailable",r,a),this.sendCreateResult("videoCtxGl",a||new Error(r)),this.update()})}catch(r){this.emit("error",{reason:"create",error:r}),this.sendCreateResult("videoCtxGl",r)}return this._glVideoContext}enablePrintDetail(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3;this._checkId=Cr.run(qC,()=>{this.destination&&this.log.debug(this.destination.getInfo())},{delay:r})}destroy(){var r,a;(r=this._2dVideoContext)==null||r.destroy(),(a=this._glVideoContext)==null||a.destroy(),this.smallVideoContext.destroy(),Cr.clearTask(this._checkId)}get needAlpha(){return this._hasWaterMark||this._hasVirtualBg}get active(){return(Z_||this._isMixScreen||this._isMirror||this._hasWaterMark||this._hasVirtualBg)&&this.checkOrCreateVideoContext()}sendCreateResult(){let r=arguments.length>1?arguments[1]:void 0,a=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"videoCtxGl")==="videoCtxGl"?512700:512701;r?Co.addFailedEvent({key:a,error:r}):Co.addSuccessEvent({key:a})}checkOrCreateVideoContext(){let r=this._use2d;if(this._autoSwitchRenderMode&&(this._use2d=!this._hasVirtualBg),this.videoContext)if(this.videoContext.available){let a=!this.videoContext.hasAlpha&&this.needAlpha;if(this._autoSwitchRenderMode&&r===this._hasVirtualBg)this.clear();else{if(!a||!this._use2d)return!0;this.clear()}}else this.clear(),this._use2d=!0;return this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.videoContext.available}get smallTrack(){var r;return(r=this.smallDestination)==null?void 0:r.videoTrack}get hasSmall(){return!!this.smallTrack}get initialTrack(){var r;return(r=this.cameraTrack)==null?void 0:r.mediaTrack}initVirtualBackground(r){return this._selfieSegmentation=r,this._selfieSegmentation.changeModel()}_setMainOutput(r){var a;let d=this.cameraTrack,{small:g,settings:C,player:A}=d;g?(this.smallVideoContext.available||(this.smallVideoContext.create({alpha:!1}),this.smallDestination=new mie(this.smallVideoContext,g)),this.smallVideoContext.frameRate=g.frameRate,this.smallDestination.resolution=g,r?(this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource),this.smallImageSource?this.smallImageSource.image=r:(this.smallImageSource=this.smallVideoContext.createVideoImageSource(r),this.smallImageSource.connect(this.smallDestination))):(this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource?this.smallTrackSource.replaceTrack(this.initialTrack):(this.smallTrackSource=this.smallVideoContext.createVideoTrackSource(this.initialTrack),this.smallTrackSource.width=C.width,this.smallTrackSource.height=C.height,this.smallTrackSource.connect(this.smallDestination)))):this.smallVideoContext.available&&(this.smallVideoContext.destroy(),delete this.smallDestination,delete this.smallTrackSource,delete this.smallImageSource),Z_&&A.setCanvas(r);let w=r&&((a=this.destination)==null?void 0:a.videoTrack)||this.initialTrack;return this.isUsingArTrack&&this.arTrack&&(this.emit("output-track-changed"),w=this.arTrack),this._selfieSegmentation&&r&&(this._selfieSegmentation._glName||this._selfieSegmentation.setCanvas(r)),d.setOutputMediaStreamTrack(w)}update(){return Ze(this,null,function*(){var r,a;if(!this.cameraTrack||!this.cameraTrack.mediaTrack)return;if(!this.active)return this.cameraNode&&this.clear(),this._setMainOutput();let{settings:d,profile:g}=this.cameraTrack;if(this._use2d||!this._selfieSegmentation?(this.destination||(this.destination=this.videoContext.createVideoTrackDestination({name:"mainDestination"})),this.cameraNode?this.cameraNode.replaceTrack(this.initialTrack):(this.cameraNode=this.videoContext.createVideoTrackSource(this.initialTrack),this.cameraNode.resize(d.width,d.height))):(this.cameraNode&&this.cameraNode.close(),this.destination||(this.destination=new gie(this.videoContext,{name:"mainDestination"})),this.cameraNode=new Cie(this.videoContext,{input:this.cameraTrack.mediaTrack,mirror:this._isMirror,bg:this._virtualBackground,selfModel:this.selfModel,waterMark:this._waterMarkOption,useTflite:!0,blurRadius:this.blurRadius,assetPath:this._bgAssetPath,selfieSegmentation:this._selfieSegmentation,Wasm:this.Wasm}),this.cameraNode.connect(this.destination)),this.videoContext.frameRate=g.frameRate,this._use2d){let C=this.cameraNode;C.disconnect(),this._isMirror&&(this.mirrorNode||(this.mirrorNode=new yie(this.videoContext)),C=C.connect(this.mirrorNode),C.disconnect(),this.log.info("start mirror")),this.mixNode&&this.mixNode.close(),delete this.mixNode,(this._isMixScreen||this._hasWaterMark)&&(this.mixNode=new bie(this.videoContext),C.connect(this.mixNode,{zIndex:1}),this._hasWaterMark&&!this.waterMarkNode&&this._waterMarkOption&&(this.waterMarkNode=this.videoContext.createVideoImageSource(this._waterMarkOption.image,{autoResize:!1}),this.waterMarkNode.resize(this._waterMarkOption.width,this._waterMarkOption.height),this.waterMarkNode.x=this._waterMarkOption.x,this.waterMarkNode.y=this._waterMarkOption.y),(r=this.waterMarkNode)==null||r.connect(this.mixNode,{zIndex:2}),this._isMixScreen&&this.screenTrack&&!this.screenNode&&(this.screenNode=this.videoContext.createVideoTrackSource(this.screenTrack.mediaTrack)),(a=this.screenNode)==null||a.connect(this.mixNode,{zIndex:0}),C=this.mixNode,this.log.info("start mix","".concat(this.mixNode.width,"x").concat(this.mixNode.height))),C.connect(this.destination)}return this._setMainOutput(this.videoContext._canvas)})}changeInput(r){if(this.log.info("change input"),r instanceof Yh)return this.setScreenTrack(r);if(r instanceof _s)return this.setCameraTrack(r);if(r instanceof Iy){let a=r.mediaTrack;if(oR===17&&+bu.split(".")[1]<4&&!r.source&&r.player.element){let d=new Lu({frameRate:15,logger:this.log,name:r.userId});d.create({alpha:!1});let g=d.createVideoImageSource(r.player.element);r.source=g;let C=new WV(d);g.connect(C),r.player.setCanvas(d._canvas)}return r.setOutputMediaStreamTrack(a)}}removeInput(r){var a;r instanceof Yh?((a=this.screenNode)==null||a.close(),delete this.screenNode,delete this.screenTrack,this.update()):r instanceof _s?(this.clear(),delete this.cameraTrack,this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource)):r instanceof Iy&&r.source&&r.source.context.destroy()}setCameraTrack(r){return Ze(this,null,function*(){this.cameraTrack=r,this.update()})}setScreenTrack(r){return this.screenTrack=r,this._isMixScreen&&(this.screenNode?this.screenNode.replaceTrack(r.mediaTrack):this.update()),r.setOutputMediaStreamTrack(r.mediaTrack)}getWatermarkImage(r,a){return Ze(this,null,function*(){let d=document.createElement("canvas");a&&r&&(d.height=a,d.width=r);let g=d.getContext("2d");if(!g)throw new An({code:rn.NOT_SUPPORTED,message:"Make image failed because of canvas context is null"});return this.watermarkImageList.sort((C,A)=>C.zIndex-A.zIndex),this.watermarkImageList.forEach(C=>{let{image:A,x:w,y:V,width:U,height:j}=C;g.drawImage(A,w,V,U,j)}),aS(d.toDataURL())})}pushWaterMarkImageList(r){let{type:a}=r;this.watermarkImageList.some(d=>d.imageUrl===r.imageUrl&&d.height===r.height&&d.width===r.width&&d.x===r.x&&d.y===r.y&&d.type===r.type&&d.zIndex===r.zIndex)||((a==="mute"||a==="watermark")&&(this.watermarkImageList=this.watermarkImageList.filter(d=>d.type!==a)),this.watermarkImageList.push(r))}setWatermark(r){return Ze(this,null,function*(){let a;try{a=yield aS((r==null?void 0:r.imageElement)||r.imageUrl)}catch{throw new An({code:rn.INVALID_PARAMETER,message:"load image failed, url: ".concat(r.imageUrl)})}let{x:d=0,y:g=0,width:C=a.width,height:A=a.height,type:w="watermark",zIndex:V=2}=r;this.pushWaterMarkImageList({x:d,y:g,width:C,height:A,image:a,zIndex:V,type:w,imageUrl:r.imageUrl}),yield this.freshWatermark(),this.log.info("set watermark",JSON.stringify(this.watermarkImageList))})}deleteWatermark(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"watermark";return Ze(this,null,function*(){this.watermarkImageList=this.watermarkImageList.filter(a=>a.type!==r),this.log.info("delete watermark",r,JSON.stringify(this.watermarkImageList)),yield this.freshWatermark()})}freshWatermark(){return Ze(this,null,function*(){var r,a,d;(r=this.waterMarkNode)==null||r.close(),delete this.waterMarkNode,delete this._waterMarkOption;let g=yield this.getWatermarkImage((a=this.cameraTrack)==null?void 0:a.settings.width,(d=this.cameraTrack)==null?void 0:d.settings.height);this._waterMarkOption={x:0,y:0,width:g.width,height:g.height,image:g},this.update()})}setVirtualBackground(r){return Ze(this,null,function*(){if(r){if(this._use2d&&!this._autoSwitchRenderMode)return Promise.reject(new Error("not support virtual background in 2d mode"));this._bgAssetPath=r.assetPath,r.type==="image"?this._virtualBackground=yield aS(r.imageUrl):(this.blurRadius=r.blurRadius||3,this._virtualBackground=r.type)}else this._virtualBackground=void 0;this.log.info("".concat(this._virtualBackground?"start":"stop"," visual background, ").concat((r==null?void 0:r.type)||"")),this.update()})}get mixScreen(){return this._isMixScreen}set mixScreen(r){var a;this._isMixScreen=r,this._isMixScreen||((a=this.screenNode)==null||a.close(),delete this.screenNode),this.update()}set mirror(r){var a;this._isMirror!==r&&(this._isMirror=r,this._isMirror||((a=this.mirrorNode)==null||a.close(),delete this.mirrorNode),this.update())}get mirror(){return this._isMirror}enableAr(r){this.arTrack=r,this.isUsingArTrack=!0,this.update()}updateAr(){return Ze(this,null,function*(){var r;(r=this.cameraTrack)==null||!r.mediaTrack||(yield this.virtualBackgroundInstance.ar.updateInputTrack(this.cameraTrack.mediaTrack.clone()))})}disableAr(){var r;this.isUsingArTrack=!1,(r=this.arTrack)==null||r.stop(),this.arTrack=void 0,this.update()}clear(){var r;(r=this.videoContext)==null||r.disconnect(),delete this.destination,delete this.cameraNode,delete this.mirrorNode,delete this.screenNode,delete this.waterMarkNode}},Tie=0,Eie=class extends _o{constructor(r){super("room"),this.seq=++Tie,this.role="anchor",this.localTracks=new Set,this.enableAutoPlayDialog=!0,this.autoReceiveAudio=!0,this.autoReceiveVideo=!0,this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null},this._isUsingCachedSchedule=!1,this._log=cn.createLogger({id:"r".concat(this.seq)}),this._joinedTimestamp=0,this.isDestroyed=!1,this.useStringRoomId=!!r.useStringRoomId,vs(r.autoReceiveAudio)&&(this.autoReceiveAudio=r.autoReceiveAudio),vs(r.autoReceiveVideo)&&(this.autoReceiveVideo=r.autoReceiveVideo),vs(r.enableAutoPlayDialog)&&(this.enableAutoPlayDialog=r.enableAutoPlayDialog),this._sdkType=r.sdkType,this.keyPointManager=new lie({room:this,frameWorkType:r.frameWorkType,component:r.component,language:r.language}),this.callDurationCalculator=new cie({room:this}),this.badCaseDetector=new uie({room:this}),this.audioManager=new fre(this),this.videoManager=new Sie(this)}get isMainStreamPublished(){for(let r of this.localTracks)if(4&r.mediaType)return!0;return!1}get isAuxStreamPublished(){for(let r of this.localTracks)if(2&r.mediaType)return!0;return!1}get hasAuxStream(){for(let r of this.remotePublishedUserMap.values())if(r.muteState.hasAuxiliary)return!0;return this.isAuxStreamPublished}getLogger(){return this._log}get isJoining(){return this.state.toString()==="joining"}get isJoined(){return this.state==="joined"}get isLeft(){return this.state==="left"}addTrack(r){return Ze(this,null,function*(){return this.publish(r)})}removeTrack(r){return Ze(this,null,function*(){return this.unpublish(r)})}replaceTrack(r){return Ze(this,null,function*(){})}setEncodedDataProcessingListener(r){throw new Error("Method not implemented.")}enableAIVoice(r){throw new Error("Method not implemented.")}setProxyServer(r){if(Ho(r))r.startsWith("wss://")?this.proxy_ws=r:r.startsWith("https://")&&(this.proxy_wt=r);else if(oc(r)){let{websocketProxy:a,webtransportProxy:d,loggerProxy:g,scheduleProxy:C,unifiedProxy:A}=r;this.proxy_ws=a,this.proxy_wt=d,this.proxy_unified=A,A?(f4([A,A]),L_("https://".concat(A))):(g&&L_(g),C&&f4(C))}Qt.once(Vt.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({sched_domain:qh.main,sched_back_domain:qh.backup,signal_domain:this.proxy_ws||this.proxy_wt||""}))}getRemoteAudioStats(){return Ze(this,null,function*(){let r={};return this.remotePublishedUserMap.forEach(a=>{r[a.userId]=a.remoteAudioTrack.stat}),r})}getTransportStats(){return Ze(this,null,function*(){var r;let a={rtt:((r=this.quality)==null?void 0:r.uplinkRTT)||0,downlinksRTT:{}};if(this.quality)for(let d of this.quality.downlinkInfo)a.downlinksRTT[d.userId]=d.rtt;return a})}getRemoteVideoStats(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"main";return function*(){let d={};return r.remotePublishedUserMap.forEach(g=>{let C=a==="auxiliary"?g.remoteAuxiliaryTrack:g.remoteVideoTrack;d[g.userId]=C.stat}),d}()})}checkDestroy(){if(this.isDestroyed)throw new An({code:rn.INVALID_OPERATION,message:no({key:jn.CLIENT_DESTROYED,data:{funName:"join"}})})}destroy(){if(this.isJoined)throw this._log.warn(ba.INVALID_DESTROY),new An({code:rn.INVALID_OPERATION,message:no({key:jn.INVALID_DESTROY})});this._log.info("destroy room"),this.audioManager.destroy(),this.videoManager.destroy(),this.keyPointManager.destroy(),this.callDurationCalculator.destroy(),this.badCaseDetector.destroy(),this.isDestroyed=!0,Qt.emit(Vt.ROOM_DESTROY,{room:this})}schedule(r,a){return Ze(this,null,function*(){var d,g;let C=To();try{let{isCached:A,result:w,detailCost:V}=yield foe({userId:this.userId,sdkAppId:this.sdkAppId,roomId:r,useStringRoomId:this.useStringRoomId,version:nl,userSig:this.userSig,frameWorkType:a});this._isUsingCachedSchedule=A,this._log.info("schedule cache:".concat(+A," ").concat(rc(w,{keysToExclude:["username","credential"]}))),A&&Qt.once(Vt.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({scheduleCache:1})),this.scheduleResult=Pn(Pn({},this.scheduleResult),w),si((d=w.config)==null?void 0:d.retryCount)&&$F(w.config.retryCount),Ho((g=w.config)==null?void 0:g.loggerDomain)&&L_(w.config.loggerDomain),Qt.emit(Vt.JOIN_SCHEDULE_SUCCESS,{room:this,schedule:this.scheduleResult,detailCost:V}),Co.addSuccessEvent({key:521700,cost:To()-C,split:50})}catch(A){throw Co.addFailedEvent({key:521700,error:A}),A}})}},Mie=vi(gs()),XV=vi(EF()),kie=r=>{let{serverAbility:a,clientAbility:d,offerSDP:g,enableCustomMessage:C}=r,A=Jr(g),w={extmapAllowMixed:"extmap-allow-mixed",groups:A.groups,icelite:"ice-lite",media:[],msidSemantic:{semantic:"",token:"WMS"},name:"-",origin:{address:"127.0.0.1",username:"-",sessionId:String(Date.now()),sessionVersion:1,netType:"IN",ipVer:4},timing:{start:0,stop:0},version:0},V={candidates:a.candidates.map(U=>({component:1,foundation:"1",generation:0,ip:U.ip,port:U.port,priority:U.priority,transport:U.foundation,type:U.type})),connection:{version:4,ip:"0.0.0.0"},direction:Pe.TRANSCEIVER_DIRECTION_RECVONLY,ext:a.audio.extensions.map(U=>({value:U.id,uri:U.uri})),fingerprint:{type:a.dtls.hash,hash:a.dtls.fingerprint},fmtp:[{payload:a.audio.codecs[0].payload,config:a.audio.codecs[0].fmtp}],icePwd:a.ice.password,iceUfrag:a.ice.ufrag,mid:"0",payloads:String(a.audio.codecs[0].payload),port:A.media[0].port,protocol:A.media[0].protocol,type:Pe.AUDIO,setup:a.dtls.setup,rtcpFb:a.audio.codecs[0].rtcpfb.map(U=>({payload:a.audio.codecs[0].payload,type:U.id,subtype:U.params[0]})),rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[{payload:a.audio.codecs[0].payload,codec:a.audio.codecs[0].codec,rate:a.audio.codecs[0].rate,encoding:a.audio.codecs[0].channels}]};return w.media.push(V),[1,2,3].forEach(U=>{w.media.push(QV({mid:U,serverAbility:a,clientAbility:d,parsedOffer:A}))}),C&&w.media.push(A.media.find(U=>U.mid==="dc")),Nu(w)},QV=r=>{let{mid:a,serverAbility:d,clientAbility:g,parsedOffer:C,useAllCodec:A=!1}=r,w={candidates:d.candidates.map(V=>({component:1,foundation:"1",generation:0,ip:V.ip,port:V.port,priority:V.priority,transport:V.foundation,type:V.type})),connection:{version:4,ip:"0.0.0.0"},direction:Pe.TRANSCEIVER_DIRECTION_RECVONLY,ext:d.video.extensions.map(V=>({value:V.id,uri:V.uri})),fingerprint:{type:d.dtls.hash,hash:d.dtls.fingerprint},fmtp:[],icePwd:d.ice.password,iceUfrag:d.ice.ufrag,mid:String(a),payloads:"",port:C.media[0].port,protocol:C.media[0].protocol,type:Pe.VIDEO,setup:d.dtls.setup,rtcpFb:[],rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[]};if(d.video.codecs.length>0)if(A)for(let V=0;V<d.video.codecs.length;V++)US(w,d.video.codecs[V]);else{let V=d.video.codecs.findIndex(U=>U.codec.toLowerCase()===(d.useVp8?"vp8":"h264"));US(w,d.video.codecs[V])}else if(A)for(let V=0;V<g.video.codecs.length;V++)US(w,g.video.codecs[V]);else US(w,g.video.codecs[0]);return w.payloads=w.payloads.trim(),w},US=(r,a)=>{r.payloads="".concat(r.payloads," ").concat(a.payload),r.fmtp.push({payload:a.payload,config:a.fmtp}),r.rtcpFb=[...r.rtcpFb||[],...(a.rtcpfb||a.rtcpFb).map(d=>({payload:a.payload,type:d.id,subtype:d.params[0]}))],r.rtp.push({payload:a.payload,codec:a.codec.toUpperCase(),rate:a.rate}),a.rtx&&(r.payloads="".concat(r.payloads," ").concat(a.rtx),r.fmtp.push({payload:a.rtx,config:"apt=".concat(a.payload)}),r.rtp.push({payload:a.rtx,codec:"rtx",rate:a.rate}))},Ea,Aie=r=>{let a=XV.default.parse(r);return a.media.forEach(d=>{var g;(d.type===Pe.AUDIO||d.type===Pe.VIDEO)&&(function(C){if(!C.rtcpFb)return;let A=[];C.rtcpFb.forEach((w,V)=>{var U;A.push(w),C.rtcpFb&&((U=C.rtcpFb[V+1])==null?void 0:U.payload)!==w.payload&&w.type!=="rrtr"&&A.push({payload:w.payload,type:"rrtr"})}),C.rtcpFb=A}(d),function(C){C.type===Pe.VIDEO&&C.fmtp&&C.fmtp.forEach(A=>{A.config.includes("apt")||(A.config+=";sps-pps-idr-in-keyframe=1")})}(d),function(C){C.type===Pe.AUDIO&&C.fmtp&&C.fmtp.forEach(A=>{A.config+=";sprop-stereo=1;stereo=1"})}(d),function(C){let A=new Set(["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"]);C.ext&&(C.ext=C.ext.filter(w=>!A.has(w.uri)))}(d)),(g=d.payloads)!=null&&g.includes("datachannel")&&a.groups&&d.mid&&(a.groups[0].mids=a.groups[0].mids.replace(d.mid,"dc"),d.mid="dc")}),XV.default.write(a)},ZV=class{constructor(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.dataView=r,this.isSEI&&(a?this.addPreventionByte():this.removePreventionByte())}addPreventionByte(){let r=this.seiPayloadStartIndex,a=this.dataView.byteLength-2,d=[],g=0;for(let A=r;A<=a;A++){let w=this.dataView.getInt8(A);switch(w){case 0:case 1:case 2:case 3:g===2&&(d.push(3),g=0),w==0?g++:g=0,d.push(w);break;default:g=0,d.push(w)}}d.push(this.dataView.getInt8(this.dataView.byteLength-1));let C=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,r),...d]).buffer);this.dataView=C}removePreventionByte(){let r=this.seiPayloadStartIndex,a=this.dataView.byteLength-1,d=[],g=0;for(let A=r;A<=a;A++)switch(this.dataView.getInt8(A)){case 0:g++,d.push(this.dataView.getInt8(A));break;case 3:g!==2&&d.push(this.dataView.getInt8(A)),g=0;break;default:d.push(this.dataView.getInt8(A)),g=0}let C=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,r),...d]).buffer);this.dataView=C}get isSEI(){return this.dataView.getUint8(4)===6}get seiPayloadStartIndex(){let r=6;for(let a=6;a<this.dataView.buffer.byteLength&&(r++,this.dataView.getUint8(a)===255);a++);return r}get seiPayloadType(){return this.isSEI?this.dataView.getUint8(5):null}get seiPayload(){if(!this.isSEI)return null;let r=0,a=6;for(let C=6;C<this.dataView.buffer.byteLength;C++){let A=this.dataView.getUint8(C);if(a++,A!==255){r+=A;break}r+=255}let d=new ArrayBuffer(r),g=new DataView(d);for(let C=0;C<d.byteLength;C++,a++)g.setInt8(C,this.dataView.getInt8(a));return g}},Rie=class{constructor(r,a){this._singlePC=r,this._log=a,_e(this,"_seiMessageList",[]),_e(this,"_smallSeiMessageList",[]),_e(this,"_seiPayloadType",243),_e(this,"_seiAbortMap",new Map),_e(this,"_nonSeiAbortMap",new Map),_e(this,"onSEIMessage",null)}isRunning(r){return this._seiAbortMap.has(r)}start(r){let a=r.direction===Pe.TRANSCEIVER_DIRECTION_SENDONLY,d=(a?r.sender:r.receiver).createEncodedStreams(),g=d.readable,C=d.writable,A=new TransformStream({transform:a?(V,U)=>this.encodeVideoFrame(V,U,r):(V,U)=>this.decodeVideoFrame(V,U,r)}),w=new AbortController;g.pipeThrough(A).pipeTo(C,w).catch(V=>{V!=="destroy"&&this._log.warn(V)}),this._seiAbortMap.set(r,w)}restart(r){this.stop(r),this.start(r)}stop(r){var a;(a=this._seiAbortMap.get(r))==null||a.abort(),this._seiAbortMap.delete(r)}destroy(){this._seiAbortMap.forEach(r=>r.abort("destroy")),this._seiAbortMap.clear(),this._nonSeiAbortMap.forEach(r=>r.abort("destroy")),this._nonSeiAbortMap.clear(),this.onSEIMessage=null}handleEncodedStreams(){try{this._singlePC.getPeerConnection().getTransceivers().forEach((r,a)=>{var d,g;if(r.direction!=="inactive"&&r.mid)if(a<4)a===1||a===2?this.isRunning(r)||this.start(r):this._nonSeiAbortMap.has(r)||this.pipeSenderOrReceiver(r);else{let C=(a-4)%3==1,A=(a-4)%3==2;((g=(d=r.receiver)==null?void 0:d.track)==null?void 0:g.kind)===Pe.VIDEO&&(C||A)?this.isRunning(r)||this.start(r):this._nonSeiAbortMap.has(r)||this.pipeSenderOrReceiver(r)}})}catch(r){this._log.warn(r)}}pipeSenderOrReceiver(r){let a=r.direction===Pe.TRANSCEIVER_DIRECTION_SENDONLY?r.sender:r.receiver,{readable:d,writable:g}=a.createEncodedStreams(),C=new AbortController;this._nonSeiAbortMap.set(r,C),d.pipeTo(g,C).catch(()=>{})}push(r,a){var d,g;a&&a.seiPayloadType&&(this._seiPayloadType=a.seiPayloadType),this._seiMessageList.push(r),(g=(d=this._singlePC.getPeerConnection())==null?void 0:d.getSenders()[2])!=null&&g.track&&this._smallSeiMessageList.push(r)}hasSEI(r){let a=new DataView(r);return a.getInt32(0)===1&&a.getInt8(4)===6}isEmptyFrame(r){return r.type==="empty"||r.data.byteLength===0}getNaluCount(r){let a=0,d=0,g=new DataView(r);for(let C=0;C<r.byteLength;C++)switch(g.getUint8(C)){case 0:a++;break;case 1:(a===2||a===3)&&d++,a=0;break;default:a=0}return d}encodeVideoFrame(r,a,d){try{let g=Number(d.mid)===2?this._smallSeiMessageList:this._seiMessageList;if(this._singlePC.isUsingH264&&g.length>0&&!this.isEmptyFrame(r)){let C=9-this.getNaluCount(r.data);if(C<=0)return;let A=g.splice(0,C).reverse().map(this.encodeSEINalu.bind(this)),w=A.reduce((ce,Te)=>ce+Te.dataView.byteLength,0),V=new ArrayBuffer(w+r.data.byteLength),U=new DataView(V),j=new DataView(r.data),re=0;for(let ce=0;ce<A.length;ce++)for(let Te=0;Te<A[ce].dataView.byteLength;Te++)U.setInt8(re++,A[ce].dataView.getInt8(Te));for(let ce=0;ce<r.data.byteLength;ce++)U.setInt8(re++,j.getInt8(ce));r.data=V,this._log.debug("".concat(A.length," sei sent"))}}catch(g){this._log.warn(g)}a.enqueue(r)}decodeVideoFrame(r,a,d){try{if(this._singlePC.isUsingH264&&!this.isEmptyFrame(r)&&this.hasSEI(r.data)){let g=[],C=new DataView(r.data),A=0,w=-1,V=-1;for(let U=0;U<r.data.byteLength;U++){let j=C.getUint8(U);if(j===0)A++;else if(j===1){if(A===2||A===3){let re=U-A;if(w===-1?w=re:V===-1&&(V=re,g.push(new ZV(new DataView(C.buffer.slice(w,V)))),w=re,V=-1),C.getUint8(U+1)!==6){r.data=new DataView(C.buffer.slice(re)).buffer;break}}A=0}else A=0}this._log.debug("".concat(g.length," sei received")),lr(this.onSEIMessage)&&g.reverse().forEach(U=>{let j=Number(d.mid);this.onSEIMessage({seiPayloadType:U.seiPayloadType,data:U.seiPayload.buffer,mid:j,streamType:(j-4)%3==2?"auxiliary":"main"})})}}catch(g){this._log.warn(g)}a.enqueue(r)}encodeSEINalu(r){let a=r.byteLength,d=parseInt(String(a/255),10),g=a%255,C=[];C.push(0,0,0,1,6,this._seiPayloadType);for(let w=0;w<d;w++)C.push(255);C.push(g);let A=new DataView(r);return C.push(...new Uint8Array(A.buffer)),C.push(128),new ZV(new DataView(new Uint8Array(C).buffer),!0)}},nf=((Ea=nf||{}).TRACK="track",Ea.DATA_CHANNEL_MESSAGE="data_channel_msg",Ea[Ea.CONNECTION_STATE_CHANGED="connection-state-changed"]="CONNECTION_STATE_CHANGED",Ea[Ea.FIREWALL_RESTRICTION="firewall-restriction"]="FIREWALL_RESTRICTION",Ea.RECONNECTED="spc-reconnected",Ea.RECONNECT_FAILED="spc-reconnect-failed",Ea.ERROR="error",Ea.SEI_MESSAGE="sei-message",Ea),eG=0,tG=!1,wie=new Set,Die=1,Oy=class extends Mie.default{constructor(r){let{signalChannel:a,room:d,enableCustomMessage:g}=r;super(),_e(this,"stat",{iceStartTime:0,iceEndTime:0,dtlsStartTime:0,dtlsEndTime:0,peerConnectionStartTime:0,peerConnectionEndTime:0}),_e(this,"currentState","DISCONNECTED"),_e(this,"_room"),_e(this,"_signalChannel"),_e(this,"_peerConnection",null),_e(this,"_datachannel",null),_e(this,"_enableCustomMessage"),_e(this,"_log"),_e(this,"_downlinkMIDMap",new Map),_e(this,"_downlinkMIDUserIDMap",new Map),_e(this,"_reconnectionTimer",-1),_e(this,"reconnectionCount",0),_e(this,"clientAbility"),_e(this,"_serverAbility",null),_e(this,"addDownlinkQueue",new Set),_e(this,"removeDownlinkQueue",new Set),_e(this,"_parsedAnswer",null),_e(this,"_updateSDPPromise",null),_e(this,"_waitForPCConnectedPromise"),_e(this,"_waitForPCConnectedPromiseReject",null),_e(this,"_isSDPLogged",!1),_e(this,"seiCodec",null),this._room=d,this._enableCustomMessage=g,this._signalChannel=a,this._log=cn.createLogger({id:"spc".concat(Die++),userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this._room.enableSEI&&cy&&(this._log.info("create sei codec"),this.seiCodec=new Rie(this,this._log),this.seiCodec.onSEIMessage=C=>{this.emit("sei-message",{userId:this._downlinkMIDUserIDMap.get(C.mid),data:C.data,seiPayloadType:C.seiPayloadType,streamType:C.streamType})})}get isH264EncodeSupported(){let r=this._room.checkSystemResult.detail.isH264EncodeSupported;return this._serverAbility&&(r=r&&!!this._serverAbility.video.codecs.find(a=>a.codec.toLowerCase()==="h264")),r}get isVP8EncodeSupported(){let r=this._room.checkSystemResult.detail.isVp8EncodeSupported;return this._serverAbility&&(r=r&&this._serverAbility.useVp8),r}get videoCodec(){var r;return(r=this._serverAbility)!=null&&r.useVp8?"vp8":"h264"}get isUsingH264(){return this.videoCodec==="h264"}get uplinkSSRC(){return this._peerConnection&&this._peerConnection.localDescription?(r=>{let a=Jr(r),d={audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0};return a.media.forEach((g,C)=>{var A;if(g.ssrcs&&!Pt(g.ssrcs[0].id)){let w=Number(g.ssrcs[0].id),V=Number((A=g.ssrcs.filter(U=>U.attribute==="cname")[1])==null?void 0:A.id);switch(C){case 0:d.audioSsrc=w;break;case 1:d.bigVideoSsrc=w,d.bigVideoRtxSsrc=V;break;case 2:d.smallVideoSsrc=w,d.smallVideoRtxSsrc=V;break;case 3:d.auxVideoSsrc=w,d.auxVideoRtxSsrc=V}}}),d})(this._peerConnection.localDescription.sdp):{audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0}}get isReconnecting(){return this.currentState==="RECONNECTING"||this._reconnectionTimer>0||this.reconnectionCount>0}get dtlsTransport(){if(!this._peerConnection)return null;let r=this._peerConnection.getSenders();return r.length===0?null:r[0].transport}initialize(){return Ze(this,null,function*(){let r;try{return this._peerConnection=new RTCPeerConnection({encodedInsertableStreams:this._room.enableSEI&&cy,offerExtmapAllowMixed:!0,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._room.sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"}),this._peerConnection.oniceconnectionstatechange=()=>{if(!this._peerConnection)return;let a=this._peerConnection.iceConnectionState;this._log.debug("ice state: ".concat(a)),a==="checking"&&this.stat.iceStartTime===0?this.stat.iceStartTime=Date.now():a==="connected"&&this.stat.iceEndTime===0&&(this.stat.iceEndTime=Date.now())},this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this),this._peerConnection.ontrack=a=>this.emit("track",a),this._enableCustomMessage&&(this._datachannel=this._peerConnection.createDataChannel("".concat(this._room.userId,"dc")),this._datachannel.binaryType="arraybuffer",this._datachannel.onopen=()=>{this._log.info("datachannel open")},this._datachannel.onclose=()=>{this._log.warn("datachannel close")},this._datachannel.onmessage=a=>{let d=new Nie(a.data);this.emit("data_channel_msg",{data:d})},this._datachannel.onerror=a=>{this._log.warn("datachannel error",a)}),this._peerConnection.addTransceiver(Pe.AUDIO,{direction:Pe.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:Pe.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:Pe.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:Pe.TRANSCEIVER_DIRECTION_SENDONLY}),r=yield this._peerConnection.createOffer(),yield this.setOffer(r),this.dtlsTransport&&(this.dtlsTransport.onstatechange=()=>{let{dtlsTransport:a}=this;!a||(this._log.debug("dtls state: ".concat(a.state)),a.state==="connecting"&&this.stat.dtlsStartTime===0?this.stat.dtlsStartTime=Date.now():a.state==="connected"&&this.stat.dtlsEndTime===0&&(this.stat.dtlsEndTime=Date.now()))}),this.clientAbility=((a,d)=>{var g,C;let A=Jr(a),w={ice:{ufrag:"",password:""},dtls:{hash:"",fingerprint:"",setup:""},audio:{codecs:[],extensions:[]},video:{codecs:[],extensions:[]},useDataChannel:d};w.ice.ufrag=String(A.media[0].iceUfrag),w.ice.password=A.media[0].icePwd||"",A.fingerprint&&(w.dtls.hash=A.fingerprint.type,w.dtls.fingerprint=A.fingerprint.hash,w.dtls.setup=A.setup||""),A.media[0].fingerprint&&(w.dtls.hash=A.media[0].fingerprint.type,w.dtls.fingerprint=A.media[0].fingerprint.hash),w.dtls.setup=A.media[0].setup||"";let V=A.media[0],U=A.media[1];V.ext&&(w.audio.extensions=V.ext.map(re=>({id:re.value,uri:re.uri}))),U.ext&&(w.video.extensions=U.ext.map(re=>({id:re.value,uri:re.uri})));let j={codec:V.rtp[0].codec,fmtp:V.fmtp[0].config,payload:V.fmtp[0].payload,rate:V.rtp[0].rate,channel:V.rtp[0].encoding,rtcpFb:[],rtx:0};(g=V.rtcpFb)==null||g.forEach(re=>{let{payload:ce,type:Te,subtype:De}=re;if(ce===j.payload){let ze={id:Te,params:[]};De&&ze.params.push(De),j.rtcpFb.push(ze)}}),w.audio.codecs.push(j);for(let re=0;re<U.rtp.length;re++){if(["rtx","red","ulpfec"].includes(U.rtp[re].codec))continue;let ce=U.fmtp.filter(Te=>Te.payload===U.rtp[re].payload)[0];w.video.codecs.push({payload:U.rtp[re].payload,codec:U.rtp[re].codec,fmtp:ce?ce.config:"",rate:U.rtp[re].rate,rtx:((C=U.rtp[re+1])==null?void 0:C.codec)==="rtx"?U.rtp[re+1].payload:0,rtcpFb:((U==null?void 0:U.rtcpFb)||[]).filter(Te=>Te.payload===U.rtp[re].payload).map(Te=>{let{type:De,subtype:ze}=Te;return{id:De,params:ze?[ze]:[]}})})}return w})(r.sdp,this._enableCustomMessage),Co.addSuccessEvent({key:521707}),this.clientAbility}catch(a){throw Co.addFailedEvent({key:521707,error:a}),this._log.error("initialize failed ".concat(a,` 
offer: `).concat(r==null?void 0:r.sdp)),a}})}connect(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return Ze(this,null,function*(){var d;try{if(this.currentState==="CONNECTED")return;let g=To(),C={type:"answer",sdp:kie({serverAbility:r,clientAbility:this.clientAbility,offerSDP:this._peerConnection.localDescription.sdp,enableCustomMessage:this._enableCustomMessage})};this._serverAbility=r,yield this.setAnswer(C),yield this.waitForPeerConnectionConnected(),a||Co.addSuccessEvent({key:521703,cost:To()-g}),(d=this.seiCodec)==null||d.handleEncodedStreams()}catch(g){let C=g instanceof An&&g.code===rn.API_CALL_ABORTED;throw C||this._log.error("connect failed: ".concat(g),r),this.reset(),!C&&!this.isReconnecting&&(Co.addFailedEvent({key:521703,error:g}),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),g}})}reconnect(){return Ze(this,null,function*(){if(this._reconnectionTimer===-1){if(!this._signalChannel.isConnected)return this._log.warn("reconnect() wait signal channel is connected"),void this._signalChannel.once(wg,this.reconnect,this);try{this.reconnectionCount++,this._log.warn("reconnect() trying [".concat(this.reconnectionCount,"]")),this.reset();let r=yield this.initialize(),a=yield this._signalChannel.sendWaitForResponse({command:Xre,responseCommand:lo.REBUILD_PEER_CONNECTION_RES,data:{ability:r},enableLog:!1});if(a.data.code!==0)throw new An({code:a.data.code,message:a.data.message});yield this.connect(a.data.data.ability,!0),Co.addSuccessEvent({key:521704}),this._log.warn("reconnect() success"),this.stopReconnection(),Qt.emit(Vt.SPC_RECONNECTED,{room:this._room}),this.emit("spc-reconnected")}catch(r){if(!this.isReconnecting)return;if(r!=null&&r.message.includes("timeout")){let a=vg(this.reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(a/1e3,"s")),this._reconnectionTimer=window.setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},a)}else this._log.error("reconnect() failed ".concat(r==null?void 0:r.code," ").concat(r)),Co.addFailedEvent({key:521704,error:r}),this.reconnectionCount>=ug()&&this._log.warn("SDK has tried reconnect for ".concat(ug()," times, but all failed, please check your network")),this.stopReconnection(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.emit("error")}}else this._log.warn("reconnect() is reconnecting, ignore current reconnection")})}getPeerConnection(){return this._peerConnection}startReconnection(){return Ze(this,null,function*(){this._log.warn("start reconnect"),this._updateSDPPromise=null,this.emitConnectionStateChangedEvent("RECONNECTING"),yield this.reconnect()})}stopReconnection(){this.isReconnecting&&(this._log.info("stop reconnect"),this.reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(wg,this.reconnect,this))}checkPeerConnectionToReconnect(){var r;!this.isReconnecting&&((r=this._peerConnection)==null?void 0:r.connectionState)===Or.CLOSED&&this.startReconnection()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}onConnectionStateChange(r){let a=this._peerConnection.iceConnectionState,d=this.getDTLSTransportState();this._log.info("connectionState: ".concat(r.target.connectionState," ICE: ").concat(a," DTLS: ").concat(d)),r.target.connectionState===Or.CONNECTING&&(this.stat.peerConnectionStartTime===0&&(this.stat.peerConnectionStartTime=Date.now()),this.emitConnectionStateChangedEvent("CONNECTING")),(r.target.connectionState===Or.FAILED||r.target.connectionState===Or.CLOSED)&&(this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),(r.target.connectionState===Or.CONNECTED||r.target.connectionState===Or.COMPLETED)&&(this.stat.peerConnectionEndTime===0&&(this.stat.peerConnectionEndTime=Date.now()),Qt.emit(Vt.SINGLE_CONNECTION_STAT,{room:this._room,stat:{ice:this.stat.iceEndTime-this.stat.iceStartTime,dtls:this.stat.dtlsEndTime-this.stat.dtlsStartTime,peerConnection:this.stat.peerConnectionEndTime-this.stat.peerConnectionStartTime}}),this.logSelectedCandidate(),this.emitConnectionStateChangedEvent("CONNECTED"))}getDTLSTransportState(){if(!this._peerConnection)return yu;let r=null;return dS()&&this._peerConnection.getSenders().length!==0?(r=this._peerConnection.getSenders()[0].transport,uS()&&this._peerConnection.getReceivers().length!==0&&r?r.state:yu):yu}emitConnectionStateChangedEvent(r){r!==this.currentState&&(this.currentState==="RECONNECTING"&&r==="CONNECTING"||(this.emit(nf.CONNECTION_STATE_CHANGED,{prevState:this.currentState,state:r}),this.currentState=r))}logSelectedCandidate(){return Ze(this,null,function*(){if(!this._peerConnection)return;let r=yield this._peerConnection.getStats();for(let[a,d]of r)if(ly(d)){let g=r.get(d.localCandidateId),C=r.get(d.remoteCandidateId);g&&(this._log.info("local candidate: ".concat(g.candidateType," ").concat(g.protocol,":").concat(g.ip||g.address,":").concat(g.port," ").concat(g.networkType||""," ").concat(g.candidateType==="relay"?"relayProtocol:".concat(g.relayProtocol):"")),g.networkType&&_4(g.networkType)),C&&this._log.info("remote candidate: ".concat(C.candidateType," ").concat(C.protocol,":").concat(C.ip||C.address,":").concat(C.port));break}})}waitForPeerConnectionConnected(){return this._waitForPCConnectedPromise||(this._waitForPCConnectedPromise=new Promise((r,a)=>{if(this.currentState==="CONNECTED")return r();this._waitForPCConnectedPromiseReject=a;let d=w=>{w.state==="CONNECTED"&&(clearTimeout(A),C(),r())},g=w=>{let{room:V}=w;V===this._room&&(clearTimeout(A),C(),a(new An({code:rn.API_CALL_ABORTED,message:no({key:jn.CONNECTION_ABORTED,data:"leave room"})})))},C=()=>{Qt.off(Vt.LEAVE_SUCCESS,g,this),this.off(nf.CONNECTION_STATE_CHANGED,d,this)},A=setTimeout(()=>{C();let w=new An({code:rn.API_CALL_TIMEOUT,message:"connection timeout"});var V;eG+=1,V=this._signalChannel.isConnected,eG>2&&!tG&&wie.size===0&&V&&(this._log.warn("firewall restriction"),tG=!0,this.emit(nf.FIREWALL_RESTRICTION)),a(w)},LA);Qt.on(Vt.LEAVE_SUCCESS,g,this),this.on(nf.CONNECTION_STATE_CHANGED,d,this)}),this._waitForPCConnectedPromise=this._waitForPCConnectedPromise.finally(()=>{this._waitForPCConnectedPromise=null,this._waitForPCConnectedPromiseReject=null})),this._waitForPCConnectedPromise}waitForReconnected(){return this.isReconnecting?new Promise((r,a)=>{this.once("spc-reconnected",r),this.once("error",a)}):Promise.resolve()}addDownlink(r){return Ze(this,null,function*(){var a;if(this._log.info("addDownlink(".concat(r.userId,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise),this.updateLocalAndRemoteSDPConfig(r),this.addDownlinkQueue.size===0)try{yield this.updateSDP(),(a=this.seiCodec)==null||a.handleEncodedStreams(),this._log.info("addDownlink(".concat(r.userId,") done"))}catch(d){this._log.error("addDownlink(".concat(r.userId,") failed ").concat(d)),yield this.startReconnection()}})}updateLocalAndRemoteSDPConfig(r){let{ssrc:a,userId:d,tinyId:g}=r;if(!this._peerConnection)return;this._log.info("updateLocalAndRemoteSDPConfig ".concat(d," ").concat(JSON.stringify(a)));let C=this._peerConnection.getTransceivers().filter(ce=>ce.direction==="inactive").slice(0,3).map(ce=>(ce.direction=Pe.TRANSCEIVER_DIRECTION_RECVONLY,Number(ce.mid)));this._parsedAnswer||(this._parsedAnswer=Jr(this._peerConnection.remoteDescription.sdp));let A,w,V,U=this._parsedAnswer.media.filter(ce=>{var Te;return(Te=ce.ssrcs)==null?void 0:Te.find(De=>{var ze;return(ze=De.value)==null?void 0:ze.includes(g)})});if(U.length===3)A=U[0],w=U[1],V=U[2];else if(C.length===3)A=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[0])),w=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[1])),V=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[2]));else if(C.length===0){this._peerConnection.addTransceiver(Pe.AUDIO,{direction:Pe.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:Pe.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(Pe.VIDEO,{direction:Pe.TRANSCEIVER_DIRECTION_RECVONLY}),A=JSON.parse(JSON.stringify(this._parsedAnswer.media[0]));let ce=QV({mid:1,serverAbility:this._serverAbility,clientAbility:this.clientAbility,parsedOffer:Jr(this._peerConnection.localDescription.sdp),useAllCodec:!0});w=JSON.parse(JSON.stringify(ce)),V=JSON.parse(JSON.stringify(ce)),A.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(A),w.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(w),V.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(V)}A.direction=Pe.TRANSCEIVER_DIRECTION_SENDONLY;let j="".concat(g,"-").concat(a.audio);A.ssrcs=[{id:a.audio,attribute:"cname",value:"".concat(j)},{id:a.audio,attribute:"msid",value:"".concat(j,"-").concat(Pe.MAIN," ").concat(j,"-audio")}],w.direction=Pe.TRANSCEIVER_DIRECTION_SENDONLY,w.ssrcs=[{id:a.video,attribute:"cname",value:"".concat(j)},{id:a.video,attribute:"msid",value:"".concat(j,"-").concat(Pe.MAIN," ").concat(j,"-bigvideo")},{id:a.videoRtx,attribute:"cname",value:"".concat(j)},{id:a.videoRtx,attribute:"msid",value:"".concat(j,"-").concat(Pe.MAIN," ").concat(j,"-bigvideo")}],w.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(a.video," ").concat(a.videoRtx)}],V.direction=Pe.TRANSCEIVER_DIRECTION_SENDONLY;let re="".concat(j,"-aux");V.ssrcs=[{id:a.auxiliary,attribute:"cname",value:re},{id:a.auxiliary,attribute:"msid",value:"".concat(re," ").concat(j,"-aux").concat(Pe.VIDEO)},{id:a.auxiliaryRtx,attribute:"cname",value:"".concat(re," ").concat(j,"-aux").concat(Pe.VIDEO)},{id:a.auxiliaryRtx,attribute:"msid",value:"".concat(re," ").concat(j,"-aux").concat(Pe.VIDEO)}],V.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(a.auxiliary," ").concat(a.auxiliaryRtx)}],this._parsedAnswer.groups&&(this._parsedAnswer.groups[0].mids=this._parsedAnswer.media.map(ce=>ce.mid).join(" ")),this._downlinkMIDMap.set(d,[A.mid,w.mid,V.mid]),this._downlinkMIDUserIDMap.set(A.mid,d),this._downlinkMIDUserIDMap.set(w.mid,d),this._downlinkMIDUserIDMap.set(V.mid,d)}removeDownlink(r){return Ze(this,null,function*(){if(!this._downlinkMIDMap.has(r)||!this._peerConnection)return;this._log.info("removeDownlink(".concat(r,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise);let a=this._downlinkMIDMap.get(r),d=!1;this._peerConnection.getTransceivers().forEach(g=>{a!=null&&a.includes(Number(g.mid))&&(d=!0,g.direction="inactive")}),this._parsedAnswer||(this._parsedAnswer=Jr(this._peerConnection.remoteDescription.sdp)),this._parsedAnswer.media.forEach(g=>{a!=null&&a.includes(Number(g.mid))&&(d=!0,g.direction="inactive",g.ssrcs=[],g.ssrcGroups=[])}),this.removeDownlinkQueue.size===0&&d&&(yield this.updateSDP()),this._downlinkMIDMap.delete(r),a==null||a.forEach(g=>this._downlinkMIDUserIDMap.delete(g)),this._log.info("removeDownlink(".concat(r,") done"))})}setBandwidth(r){return Ze(this,null,function*(){if(!this._peerConnection)return;let{audio:a,bigVideo:d,smallVideo:g,auxVideo:C}=r;try{if(yR()){let A=this._peerConnection.getSenders().slice(0,4);for(let V=0;V<A.length;V++){let U,j=A[V];V===0&&a?U=a:V===1&&d?U=d:V===2&&g?U=g:V===3&&C&&(U=C),U&&(yield this.setSenderMaxBitrate(j,U))}let w=!1;d&&A[1].track&&(w=this.setStartBitrate(1,d)),C&&A[3].track&&(w=this.setStartBitrate(3,C)||w),w&&(yield this.updateSDP())}else yield this.setBandwidthBySDP(r);this._log.info("setBandwidth ".concat(JSON.stringify(r)))}catch(A){this._log.error("failed to set bandwidth: ".concat(A))}})}setStartBitrate(r,a){var d,g;return!((d=this._peerConnection)==null||!d.remoteDescription||(this._parsedAnswer||(this._parsedAnswer=Jr(this._peerConnection.remoteDescription.sdp)),(g=this._parsedAnswer.media[r])==null||!g.fmtp[0]))&&(this._parsedAnswer.media[r].fmtp[0].config+=";x-google-start-bitrate=".concat(a>5e3?5e3:a),!0)}setSenderMaxBitrate(r,a){let d=r.getParameters();return(!d.encodings||d.encodings.length===0)&&(d.encodings=[{}]),a==="unlimited"?delete d.encodings[0].maxBitrate:d.encodings[0].maxBitrate=1e3*a,r.setParameters(d)}setBandwidthBySDP(r){let{audio:a,bigVideo:d,smallVideo:g,auxVideo:C}=r;if(!this._peerConnection||!this._peerConnection.localDescription)return;let A=Jr(this._peerConnection.localDescription.sdp);this._parsedAnswer||(this._parsedAnswer=Jr(this._peerConnection.remoteDescription.sdp));let w=gr?"TIAS":"AS";a&&(A.media[0].bandwidth=[{type:w,limit:gr?1e3*a:a}],this._parsedAnswer.media[0].bandwidth=[{type:w,limit:gr?1e3*a:a}]),d&&(A.media[1].bandwidth=[{type:w,limit:gr?1e3*d:d}],this._parsedAnswer.media[1].bandwidth=[{type:w,limit:gr?1e3*d:d}]),g&&(A.media[2].bandwidth=[{type:w,limit:gr?1e3*g:g}],this._parsedAnswer.media[2].bandwidth=[{type:w,limit:gr?1e3*g:g}]),C&&(A.media[3].bandwidth=[{type:w,limit:gr?1e3*C:C}],this._parsedAnswer.media[3].bandwidth=[{type:w,limit:gr?1e3*C:C}]);let V={type:"offer",sdp:Nu(A)};return this.updateSDP({localDescription:V})}setScaleResolutionDownBy(r,a){if(a===1)return;let d=r.getParameters();return(!d.encodings||d.encodings.length===0)&&(d.encodings=[{}]),d.encodings[0].scaleResolutionDownBy=a,r.setParameters(d)}updateSDP(){let{localDescription:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._parsedAnswer)return Promise.resolve();let a=Nu(this._parsedAnswer);return this._updateSDPPromise=new Promise((d,g)=>Ze(this,null,function*(){var C,A;try{!r&&this._peerConnection&&(this._log.info("creating offer"),r=yield this._peerConnection.createOffer()),r&&(yield this.setOffer(r)),yield this.setAnswer({type:"answer",sdp:a}),this._updateSDPPromise=null,d()}catch(w){this._log.error(w),!this._isSDPLogged&&this._peerConnection&&(this._log.warn("current offer: ".concat(this.filterSDPDirection((C=this._peerConnection.localDescription)==null?void 0:C.sdp),` 
next offer: `).concat(this.filterSDPDirection(r==null?void 0:r.sdp))),this._log.warn("current answer: ".concat(this.filterSDPDirection((A=this._peerConnection.remoteDescription)==null?void 0:A.sdp),` 
next answer: `).concat(this.filterSDPDirection(a))),this._log.warn("offer: ".concat(r==null?void 0:r.sdp)),this._log.warn("answer: ".concat(a)),this._log.warn("transceivers: ".concat(JSON.stringify(this._peerConnection.getTransceivers().map(V=>{let{mid:U,currentDirection:j,direction:re,stopped:ce}=V;return{mid:U,currentDirection:j,direction:re,stopped:ce}})))),this._log.warn("parsedAnswer: ".concat(JSON.stringify(this._parsedAnswer))),this._isSDPLogged=!0),this._updateSDPPromise=null,g(w)}})),this._updateSDPPromise}filterSDPDirection(){return Jr(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").media.map(r=>r.direction)}setOffer(r){return this._log.info("setting offer"),this._peerConnection.setLocalDescription({type:"offer",sdp:Aie(r.sdp)})}setAnswer(r){return this._log.info("setting answer"),this._room.enableHWEncoder&&r.sdp&&(r.sdp=r.sdp.replaceAll("42e01f","42001f")),this._peerConnection.setRemoteDescription(r)}sendDataChannelMessage(r){var a;(a=this._datachannel)==null||a.send(r)}reset(){var r;(r=this._peerConnection)==null||r.close(),this._waitForPCConnectedPromise=null,this._parsedAnswer=null}close(){this._log.info("close pc"),this.seiCodec&&(this.seiCodec.destroy(),this.seiCodec=null),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this._downlinkMIDMap.clear(),this.stopReconnection(),this.removeAllListeners()}sendSEI(r,a){var d;(d=this.seiCodec)==null||d.push(r,a)}};mn([dV("reconnect")],Oy.prototype,"startReconnection"),mn([yS(r=>r.userId)],Oy.prototype,"addDownlink"),mn([yS(r=>r)],Oy.prototype,"removeDownlink"),mn([Eg(!0)],Oy.prototype,"updateSDP");var Oie=class{constructor(r){_e(this,"tag"),_e(this,"len"),_e(this,"data");let a=new DataView(r);this.tag=a.getUint16(),this.len=a.getUint16(2),this.data=new Uint8Array(r).slice(4,4+this.len).buffer}},Nie=class{constructor(r){_e(this,"tinyId"),_e(this,"data");let a=new DataView(r),d=0,g=[];for(;d<a.byteLength;){let C=a.getUint16(d+2),A=new Oie(new Uint8Array(r).slice(d,d+2+2+C).buffer);g.push(A),d+=4+C}g.forEach(C=>{C.tag===1?this.tinyId=new TextDecoder().decode(C.data):C.tag===2&&(this.data=C.data)})}},nG=new Set;function Dg(){let r=Math.floor(4294967296*Math.random());return nG.has(r)?Dg():(nG.add(r),r)}var Lie=vi(gs()),oG=class extends Lie.default{constructor(r){super(),_e(this,"userId"),_e(this,"tinyId"),_e(this,"_sdpSemantics"),_e(this,"_isUplink"),_e(this,"_room"),_e(this,"_log"),_e(this,"_signalChannel"),_e(this,"_currentState","DISCONNECTED"),_e(this,"_prevTime",-1),_e(this,"_enableSEI"),this.userId=r.userId,this.tinyId=r.tinyId,this._room=r.room,this._sdpSemantics=r.room.sdpSemantics,this._isUplink=r.isUplink,this._log=cn.createLogger({id:"n",userId:this._room.userId,remoteUserId:this._isUplink?void 0:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=r.signalChannel,this._enableSEI=r.enableSEI}get _peerConnection(){var r;return((r=this.singlePC)==null?void 0:r.getPeerConnection())||null}get singlePC(){return this._room.singlePC}close(r){this._log.info("close connection"),this.emit("closed",r)}emitConnectionStateChangedEvent(r){return r!==this._currentState&&(Qt.emit(Vt.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:r,remoteUserId:this._isUplink?void 0:this.userId}),this.emit("connection-state-changed",{prevState:this._currentState,state:r}),this._currentState=r,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}getCurrentState(){return this._currentState}get isH264(){var r,a;return!((a=(r=this._peerConnection)==null?void 0:r.remoteDescription)==null||!a.sdp.includes("H264"))}},rG=class extends oG{constructor(r){super(uo(Pn({},r),{isUplink:!0})),_e(this,"localMainAudioTrack",null),_e(this,"localMainVideoTrack",null),_e(this,"localAuxAudioTrack",null),_e(this,"localAuxVideoTrack",null),_e(this,"_isPublishingAux",!1),_e(this,"_publishingLocalAudioTrack"),_e(this,"_publishingLocalVideoTrack"),_e(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),_e(this,"_flag",0),_e(this,"_checkPublishStateTimeoutId",-1),this.initialize()}get ssrc(){if(!this.singlePC)return{audio:0,video:0,videoRtx:0,small:0,smallRtx:0,auxiliary:0,auxiliaryRtx:0};let{audioSsrc:r,bigVideoSsrc:a,bigVideoRtxSsrc:d,smallVideoSsrc:g,smallVideoRtxSsrc:C,auxVideoSsrc:A,auxVideoRtxSsrc:w}=this.singlePC.uplinkSSRC;return{audio:r||0,video:a||0,videoRtx:d||0,small:g||0,smallRtx:C||0,auxiliary:A||0,auxiliaryRtx:w||0}}get flag(){return this._flag}set flag(r){this._flag!==r&&(this._flag=r,this.checkPublishState())}checkPublishState(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!r&&this._checkPublishStateTimeoutId>0)return;let{publishState:a,serverPublishState:d}=this,g=Object.keys(a).find(C=>a[C]!==d[C]);if(g){if(!r)return void(this._checkPublishStateTimeoutId=Cr.run($_,()=>this.checkPublishState(!0),{delay:1e4,count:1}));this._log.warn("publish state not matched, ".concat(g," local:").concat(a[g]," server:").concat(d[g]," ").concat(sR())),Co.addCount({key:521e3})}Cr.clearTask(this._checkPublishStateTimeoutId),this._checkPublishStateTimeoutId=-1}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var r,a,d,g;let C={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let A=this._peerConnection.getSenders();A&&(Mu()?(C.audio=!((r=A[0])==null||!r.track),C.bigVideo=!((a=A[1])==null||!a.track),C.smallVideo=!((d=A[2])==null||!d.track),C.auxVideo=!((g=A[3])==null||!g.track)):A.forEach(w=>{w.track&&(w.track.kind===Pe.AUDIO?C.audio=!0:(C.bigVideo=!0,this._room.videoManager.hasSmall&&(C.smallVideo=!0)))}))}return C}get serverPublishState(){return{audio:!!(this.flag&x_),bigVideo:!!(this.flag&U_),smallVideo:!!(this.flag&wA),auxVideo:!!(this.flag&VC)}}get muteState(){var r,a,d;return{audio:!((r=this.localMainAudioTrack)==null||!r.muted),bigVideo:!((a=this.localMainVideoTrack)==null||!a.muted),auxVideo:!((d=this.localAuxVideoTrack)==null||!d.muted)}}initialize(){this.installEvents()}reset(){this.uninstallEvents(),this.uninstallTrackMuteEvents(this.localMainAudioTrack,this.localMainVideoTrack,this.localAuxVideoTrack)}close(r){super.close(r),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){var r;this.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this.on("connection-state-changed",this.handleConnectionStateChange,this),this.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||(r=this.singlePC)==null||r.on("spc-reconnected",this.onSinglePCReconnected,this)}uninstallEvents(){var r;this.off("connection-state-changed",this.handleConnectionStateChange,this),(r=this.singlePC)==null||r.off("spc-reconnected",this.onSinglePCReconnected,this)}emitConnectionStateChangedEvent(r,a){var d,g,C;let A=this._currentState,w=super.emitConnectionStateChangedEvent(r);return w&&A!==r&&(a?a.emit("connection-state-changed",{prevState:A,state:r}):((d=this.localMainVideoTrack)==null||d.emit("connection-state-changed",{prevState:A,state:r}),(g=this.localAuxVideoTrack)==null||g.emit("connection-state-changed",{prevState:A,state:r}),(C=this._publishingLocalVideoTrack)==null||C.emit("connection-state-changed",{prevState:A,state:r}))),w}publish(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C,isAuxiliary:A}=a;return function*(){var w,V,U,j,re,ce,Te;if(!d.singlePC)return;yield d.singlePC.waitForPeerConnectionConnected();let De,{publishState:ze,muteState:_t}=d;if(g&&(d._publishingLocalAudioTrack=g,ze.audio=!0,_t.audio=g.muted),C){if(!d.singlePC.isH264EncodeSupported&&!d.singlePC.isVP8EncodeSupported)throw new An({code:rn.NOT_SUPPORTED_H264,message:no({key:jn.NOT_SUPPORTED_H264ENCODE})});Bs&&pg()===115&&C.profile.width*C.profile.height<=230400&&(d._log.warn("fallback video to 480p"),C.setProfile(ol["480p_2"]),yield C.applyProfile()),d._publishingLocalVideoTrack=C,A?(ze.auxVideo=!0,_t.auxVideo=C.muted):(ze.bigVideo=!0,_t.bigVideo=C.muted)}if(d._isPublishingAux=A,C&&!A&&C.small&&(De=d._room.videoManager.smallTrack,ze.smallVideo=!0),yield d._signalChannel.sendWaitForResponseWithRetry({command:Zre,responseCommand:lo.SPC_PUBLISH_RESULT,data:uo(Pn({},d.singlePC.uplinkSSRC),{state:ze,muteState:_t}),retries:3}),yield d.publishByTransceiver({localAudioTrack:g,localVideoTrack:C,smallTrack:De,isAuxiliary:A}),(w=d.singlePC.seiCodec)==null||w.handleEncodedStreams(),d._publishingLocalAudioTrack=null,d._publishingLocalVideoTrack=null,d._isPublishingAux=!1,A)C&&(d.localAuxVideoTrack=C),g&&(d.localAuxAudioTrack=g);else{if(C){d.localMainVideoTrack=C;let{scaleResolutionDownBy:Ft}=C;Ft>1&&(d._log.warn("setScaleResolutionDownBy main ".concat(Ft)),yield d.singlePC.setScaleResolutionDownBy(d._peerConnection.getSenders()[1],Ft))}g&&(d.localMainAudioTrack=g)}yield d.singlePC.setBandwidth({audio:((V=d.localMainAudioTrack)==null?void 0:V.profile.bitrate)||((U=d.localAuxAudioTrack)==null?void 0:U.profile.bitrate),bigVideo:(j=d.localMainVideoTrack)==null?void 0:j.profile.bitrate,smallVideo:(ce=(re=d.localMainVideoTrack)==null?void 0:re.small)==null?void 0:ce.bitrate,auxVideo:(Te=d.localAuxVideoTrack)==null?void 0:Te.profile.bitrate}),d.sendMediaSettings(),d.installTrackMuteEvents(g,C)}()})}publishByTransceiver(r){let{localAudioTrack:a,localVideoTrack:d,smallTrack:g,isAuxiliary:C}=r;if(!ic())return;this._log.info("publish by transceiver");let A=d==null?void 0:d.outMediaTrack,w=a==null?void 0:a.outMediaTrack,V=this._peerConnection.getTransceivers(),U=[],j=[];if(w){let ce=V[0].sender.replaceTrack(w);j.push(0),U.push(ce)}if(A)if(C){let ce=V[3].sender.replaceTrack(A);j.push(3),U.push(ce)}else{let ce=V[1].sender.replaceTrack(A);j.push(1),U.push(ce)}if(g){let ce=V[2].sender.replaceTrack(g);j.push(2),U.push(ce)}let re=this.setTransceiverDirection(ho.SENDONLY,j);return U.push(re),Promise.all(U)}enableSmall(r){return Ze(this,null,function*(){if(!this.singlePC)return;let a=this._peerConnection.getTransceivers();r?this._room.videoManager.smallTrack&&(yield a[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection(ho.SENDONLY,[2])):(yield a[2].sender.replaceTrack(null),yield this.setTransceiverDirection(ho.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];a.forEach(g=>{g&&(g==null||g.on("mute",this.sendMutedFlag,this),g==null||g.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];a.forEach(g=>{g&&(g==null||g.off("mute",this.sendMutedFlag,this),g==null||g.off("unmute",this.sendMutedFlag,this))})}unpublish(r){return Ze(this,arguments,function(a){var d=this;let{localAudioTrack:g,localVideoTrack:C}=a;return function*(){let A=C&&C===d.localAuxVideoTrack,w=C==null?void 0:C.outMediaTrack,V=d._peerConnection.getSenders(),U=[];g&&(yield V[0].replaceTrack(null),U.push(0),A?d.localAuxAudioTrack=null:d.localMainAudioTrack=null),w&&(A?(yield V[3].replaceTrack(null),d.localAuxVideoTrack=null,d._mediaSettings=uo(Pn({},d._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),U.push(3)):(yield V[1].replaceTrack(null),yield V[2].replaceTrack(null),d.localMainVideoTrack=null,d._mediaSettings=uo(Pn({},d._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),U.push(1,2))),d.isMainStreamPublished||d.isAuxStreamPublished?(yield d.setTransceiverDirection(ho.INACTIVE,U),yield d.doPublishChange(!1)):yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),C==null||C.emit("connection-state-changed",{prevState:d._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ze(this,null,function*(){let a={state:this.publishState,constraintConfig:this._mediaSettings},d=yield this._signalChannel.sendWaitForResponseWithRetry({command:LV,data:a,responseCommand:lo.PUBLISH_STATE_CHANGE_RESULT,enableLog:r,retries:3});this.checkPublishResultCode(d.data.code,d.data.message)})}doUnpublish(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:YR,commandDesc:"unpublish",responseCommand:lo.UNPUBLISH_RESULT,enableLog:r}).catch(a=>{if(a.getCode()===rn.API_CALL_TIMEOUT)return Promise.resolve();throw a})}updateMediaSettings(){let{detail:{isH264EncodeSupported:r,isVp8EncodeSupported:a}}=this._room.checkSystemResult;r?this._mediaSettings.videoCodec="H264":a&&(this._mediaSettings.videoCodec="VP8");let d=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:g,localAuxVideoTrack:C}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?C=this._publishingLocalVideoTrack:g=this._publishingLocalVideoTrack),Ig){if(d&&d.outMediaTrack){let A=d.outMediaTrack.getSettings();this._mediaSettings.audioChannel=A.channelCount||1,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=A.sampleRate||0}if(g&&g.outMediaTrack){let A=g.outMediaTrack.getSettings();this._mediaSettings.videoWidth=A.width||0,this._mediaSettings.videoHeight=A.height||0,this._mediaSettings.videoFps=A.frameRate||0,this._mediaSettings.videoBps=1e3*g.profile.bitrate,g.small&&(this._mediaSettings.smallVideoWidth=g.small.width,this._mediaSettings.smallVideoHeight=g.small.height,this._mediaSettings.smallVideoFps=g.small.frameRate,this._mediaSettings.smallVideoBps=1e3*g.small.bitrate)}if(C&&C.outMediaTrack){let A=C.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=A.width||0,this._mediaSettings.auxVideoHeight=A.height||0,this._mediaSettings.auxVideoFps=A.frameRate||0,this._mediaSettings.auxVideoBps=1e3*C.profile.bitrate}}else d&&d.outMediaTrack&&(this._mediaSettings.audioChannel=d.profile.channelCount,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=d.profile.sampleRate),g&&g.outMediaTrack&&(this._mediaSettings.videoWidth=g.profile.width,this._mediaSettings.videoHeight=g.profile.height,this._mediaSettings.videoFps=g.profile.frameRate,this._mediaSettings.videoBps=1e3*g.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:xV,data:this._mediaSettings,responseCommand:lo.UPDATE_CONSTRAINT_CONFIG_RES}).then(r=>{r.data.code!==0&&this._log.warn(r.data.message)}).catch(()=>{})}addTrack(r){return Ze(this,null,function*(){if(!this._peerConnection)return;let a=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is adding ".concat(r.kind," track to current published local ").concat(a?Pe.AUXILIARY:Pe.MAIN," stream")),Mu()&&(yield this.addTrackByTransceiver(r,a))})}addTrackByTransceiver(r,a){return Ze(this,null,function*(){var d;if(!r.mediaTrack)return;let g=this._peerConnection.getTransceivers();if(r.kind===Pe.AUDIO)yield g[0].sender.replaceTrack(r.outMediaTrack);else{let C=a?3:1;yield g[C].sender.replaceTrack(r.outMediaTrack),C===1&&((d=this.localMainVideoTrack)!=null&&d.small)&&(yield g[2].sender.replaceTrack(this._room.videoManager.smallTrack)),g[C].direction===ho.INACTIVE&&(yield this.setTransceiverDirection(ho.SENDONLY,[C]))}this.updateMediaSettings(),yield this.doPublishChange()})}removeTrack(r){return Ze(this,null,function*(){if(!this._peerConnection)return;let a=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is removing ".concat(r.kind," track from current published local ").concat(a?Pe.AUXILIARY:Pe.MAIN," stream")),Mu()&&(yield this.removeTrackByTransceiver(r,a))})}removeTrackByTransceiver(r,a){return Ze(this,null,function*(){if(!r.mediaTrack)return;let d=this._peerConnection.getTransceivers();if(r.kind===Pe.AUDIO)yield d[0].sender.replaceTrack(null);else{let g=a?3:1;yield d[g].sender.replaceTrack(null),g===1&&this._room.videoManager.hasSmall&&(yield d[2].sender.replaceTrack(null)),yield this.setTransceiverDirection(ho.INACTIVE,[g])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(r,a){return Ze(this,null,function*(){if(!gr)return;let d=!1,g=!1;this._log.info("setting transceiver ".concat(a.join(",")," direction to ").concat(r));let C=this._peerConnection.getTransceivers();if(a.forEach(V=>{C[V].direction!==r&&(C[V].direction=r,d=!0)}),d){this._log.info("updating offer");let V=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(V)}let A=-1,w=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(V=>{if(V.match(new RegExp("a=(".concat(ho.INACTIVE,"|").concat(ho.RECVONLY,"|").concat(ho.SENDONLY,")")))&&A++,a.includes(A)){if(r===ho.INACTIVE&&V.includes("a=".concat(ho.RECVONLY)))return g=!0,"a=".concat(r);if(r===ho.SENDONLY&&V.includes("a=".concat(ho.INACTIVE)))return g=!0,"a=".concat(ho.RECVONLY)}return V}).join(`\r
`);g&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:w}))})}replaceTrack(r){return Ze(this,null,function*(){var a;let d=(a=this._peerConnection)==null?void 0:a.getSenders(),g=r.outMediaTrack||r.mediaTrack;if(!d||d.length===0||!g||d.find(A=>A.track===g))return;let C=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is replacing ".concat(g.kind," track on ").concat(C?Pe.AUXILIARY:Pe.MAIN," stream")),g.kind===Pe.AUDIO&&d[0]&&(yield d[0].replaceTrack(g)),g.kind===Pe.VIDEO&&(!C&&d[1]&&(yield d[1].replaceTrack(g)),C&&d[3]&&(yield d[3].replaceTrack(g)))})}setBandwidth(r){return Ze(this,arguments,function(a){var d=this;let{bandwidth:g,type:C,videoType:A}=a;return function*(){if(d.singlePC){let w={};C===Pe.AUDIO?w.audio=g:A==="big"?w.bigVideo=g:A==="small"?w.smallVideo=g:w.auxVideo=g,yield d.singlePC.setBandwidth(w)}}()})}sendMutedFlag(r){r===this.localAuxAudioTrack||r===this.localAuxVideoTrack||(this._log.info("send muted state: ".concat(JSON.stringify(this.muteState))),this._signalChannel.sendWaitForResponseWithRetry({command:NV,responseCommand:lo.MUTE_RESULT,data:this.muteState,retries:3}).catch(()=>{}))}handleConnectionStateChange(r){r.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&Qt.emit(Vt.SEND_FIRST_VIDEO_FRAME,{room:this._room})}getVideoTrackId(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe.VIDEO;if(this._peerConnection){let a=this._peerConnection.getSenders();if(r===Pe.AUXILIARY&&a[3]&&a[3].track)return a[3].track.id;if(r===Pe.VIDEO&&a[1]&&a[1].track)return a[1].track.id}if(this.localMainVideoTrack&&r===Pe.VIDEO){let a=this.localMainVideoTrack.mediaTrack;if(a)return a.id}if(this.localAuxVideoTrack&&r===Pe.AUXILIARY){let a=this.localAuxVideoTrack.mediaTrack;if(a)return a.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(r,a){if(r!==0)throw r===$C?(this._log.error(ba.NOT_SUPPORTED_H264ENCODE),new An({code:rn.NOT_SUPPORTED_H264,message:no({key:jn.NOT_SUPPORTED_H264ENCODE})})):new An({code:rn.UNKNOWN,message:no({key:jn.SIGNAL_RESPONSE_FAILED,data:{signalResponse:lo.PUBLISH_RESULT,code:r,message:a}})})}onSinglePCReconnected(){return Ze(this,null,function*(){this.isMainStreamPublished&&(this._log.warn("republish main stream"),yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(this._log.warn("republish aux stream"),yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0}))})}};function iG(r){return Object.keys(r).filter(a=>r[a])}var iw=class extends oG{constructor(r){super(uo(Pn({},r),{isUplink:!1})),_e(this,"_flag",0),_e(this,"role","anchor"),_e(this,"remoteAudioTrack"),_e(this,"remoteVideoTrack"),_e(this,"remoteAuxiliaryTrack"),_e(this,"ssrc",{audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0}),this.flag=r.flag,this.remoteAudioTrack=new GR(this._room,this),this.remoteVideoTrack=new Iy(this._room,this),this.remoteAuxiliaryTrack=new gV(this._room,this),this.initialize()}get subscribeState(){return{audio:this.remoteAudioTrack.isSubscribed||this.remoteAudioTrack.isSubscribing,video:this.remoteVideoTrack.isBig&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),smallVideo:this.remoteVideoTrack.isSmall&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),auxiliary:this.remoteAuxiliaryTrack.isSubscribed||this.remoteAuxiliaryTrack.isSubscribing}}get muteState(){return iy(this.flag,this.userId)}get flag(){return this._flag}set flag(r){var a,d,g;r!==this._flag&&(this._flag=r,(a=this.remoteAudioTrack)==null||a.onFlagChanged(),(d=this.remoteVideoTrack)==null||d.onFlagChanged(),(g=this.remoteAuxiliaryTrack)==null||g.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(r){return r===Pe.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){this.installEvents()}close(r){super.close(r),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents(),this.removeDownlink()}installEvents(){!this.singlePC||(this.listeners("track").includes(this.onTrack)||this.singlePC.on("track",this.onTrack,this),this.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||this.singlePC.on("spc-reconnected",this.onSinglePCReconnected,this))}uninstallEvents(){!this.singlePC||(this.singlePC.off("track",this.onTrack,this),this.singlePC.off("spc-reconnected",this.onSinglePCReconnected,this))}emitConnectionStateChangedEvent(r){var a,d;let g=this._currentState,C=super.emitConnectionStateChangedEvent(r);return C&&g!==r&&((a=this.remoteVideoTrack)==null||a.emit("connection-state-changed",{prevState:g,state:r}),(d=this.remoteAuxiliaryTrack)==null||d.emit("connection-state-changed",{prevState:g,state:r})),C}onTrack(r){let a=r.streams[0],{track:d}=r;if(!a.id.includes(this.tinyId))return;let g=a.id.includes("aux")?"auxiliary":"main";this._log.debug("ontrack ".concat(g," ").concat(d.kind));let C=Pe.AUDIO;d.kind===Pe.VIDEO&&(C=g===Pe.MAIN?Pe.VIDEO:Pe.AUXILIARY);let A=this.remoteAudioTrack;C===Pe.VIDEO?A=this.remoteVideoTrack:C===Pe.AUXILIARY&&(A=this.remoteAuxiliaryTrack),A.setInputMediaStreamTrack(d)}isSubscriptionStateNotChanged(r){return JSON.stringify(r)===JSON.stringify(this.subscribeState)}subscribe(r,a){return Ze(this,null,function*(){try{if(this.isSubscriptionStateNotChanged(r))return;if(this._log.info("subscribe ".concat(a," ").concat(iG(r))),this.hasSSRC){let d="subscribe_change";Object.values(r).find(g=>g===!0)||(d="unsubscribe"),yield this.sendSubscription(d,r)}else yield this.doSubscribe(r),this.checkTrackEnded(r)}catch(d){throw this._room.isJoined&&this.isStreamUnpublished(a)?(this._log.warn("".concat(d.message," ").concat(JSON.stringify(this.muteState))),new An({code:rn.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):d}})}checkTrackEnded(r){var a,d,g;(r.audio&&((a=this.remoteAudioTrack.mediaTrack)==null?void 0:a.readyState)==="ended"||r.video&&((d=this.remoteVideoTrack.mediaTrack)==null?void 0:d.readyState)==="ended"||r.auxiliary&&((g=this.remoteAuxiliaryTrack.mediaTrack)==null?void 0:g.readState)==="ended")&&this.singlePC&&!this.singlePC.isReconnecting&&(this._log.warn("remote track ended start spc reconnect"),this.singlePC.startReconnection())}unsubscribe(r){return Ze(this,arguments,function(a){var d=this;let{remoteTracks:g,streamType:C}=a;return function*(){var A;if(C==="main"&&!d.isMainStreamSubscribed||C==="auxiliary"&&!d.isAuxStreamSubscribed)return void d._log.info("".concat(C," stream already unsubscribed"));let w=Pn({},d.subscribeState);g.forEach(U=>{switch(U.mediaType){case 1:w.audio=!1;break;case 4:w.video=!1;break;case 8:w.smallVideo=!1;break;case 2:w.auxiliary=!1}});let V="subscribe_change";Object.values(w).find(U=>U===!0)||(V="unsubscribe"),d._log.info("".concat(V==="unsubscribe"?V:"subscribe"," ").concat(C," [").concat(iG(w),"]")),V==="unsubscribe"&&((A=d.singlePC)==null||A.removeDownlinkQueue.add(d.tinyId)),yield d.sendSubscription(V,w),V==="unsubscribe"&&(yield d.removeDownlink())}()})}sendSubscription(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,d={srcTinyId:this.tinyId,srcUserId:this.userId},g=PV,C=lo.UNSUBSCRIBE_RESULT;return r==="subscribe_change"&&(d={audio:a.audio,bigVideo:a.video,auxVideo:a.auxiliary,smallVideo:a.smallVideo,srcTinyId:this.tinyId},g=UV,C=lo.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponseWithRetry({command:g,data:d,responseCommand:C,timeout:1e4,retries:3}).then(A=>{let{data:w}=A;if(w.code!==0){let V=new An({code:w.code,message:no({key:jn.ERROR_MESSAGE,data:{type:r,message:w.message}})});throw this._log.error(V),V}})}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}setDelay(r){let{audioDelay:a,videoDelay:d}=r;this.remoteAudioTrack.stat.end2EndDelay=a,this.remoteVideoTrack.stat.end2EndDelay=d}onSinglePCReconnected(){(this.ssrc.audio||this.ssrc.video||this.ssrc.auxiliary)&&(this._log.warn("resubscribe ".concat(JSON.stringify(this.subscribeState))),this.doSubscribe(this.subscribeState))}get hasSSRC(){return this.ssrc.audio&&this.ssrc.video&&this.ssrc.auxiliary}doSubscribe(){return Ze(this,arguments,function(){var r=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState,d=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return function*(){if(r.singlePC){if(r.singlePC.addDownlinkQueue.add(r.tinyId),yield r.singlePC.waitForPeerConnectionConnected(),d||!r.hasSSRC){let g={audioSsrc:Dg(),bigVideoSsrc:Dg(),bigVideoRtxSsrc:Dg(),auxVideoSsrc:Dg(),auxVideoRtxSsrc:Dg()},{audioSsrc:C,bigVideoSsrc:A,bigVideoRtxSsrc:w,auxVideoSsrc:V,auxVideoRtxSsrc:U}=g;r.ssrc={audio:C,video:A,videoRtx:w,auxiliary:V,auxiliaryRtx:U},r.singlePC.addDownlinkQueue.delete(r.tinyId),yield r.singlePC.addDownlink({userId:r.userId,tinyId:r.tinyId,ssrc:r.ssrc});try{let j=yield r._signalChannel.sendWaitForResponseWithRetry({command:eie,responseCommand:lo.SPC_SUBSCRIBE_RESULT,data:{srcUserId:r.userId,srcTinyId:r.tinyId,audio:a.audio,bigVideo:a.video,auxVideo:a.auxiliary,smallVideo:a.smallVideo,customData:!1,ssrc:g},retries:3,retryTimeout:0});if(j.data.code!==0)throw new An({code:j.data.code,message:j.data.message})}catch(j){throw yield r.removeDownlink(),j}return}r.singlePC.addDownlinkQueue.delete(r.tinyId),yield r.singlePC.addDownlink({userId:r.userId,tinyId:r.tinyId,ssrc:r.ssrc})}}()})}removeDownlink(){return Ze(this,null,function*(){!this.singlePC||(this.ssrc={audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0},this.singlePC.removeDownlinkQueue.delete(this.tinyId),yield this.singlePC.removeDownlink(this.userId))})}};mn([Eg(),cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];return new Promise((C,A)=>{let w=V=>{this.off("closed",w),A(new An({code:rn.API_CALL_ABORTED,message:no({key:jn.CONNECTION_ABORTED,data:V})}))};this.on("closed",w),r.apply(this,d).then(C,A).finally(()=>{this.off("closed",w)})})})],iw.prototype,"subscribe"),mn([Eg()],iw.prototype,"unsubscribe");var Pie=iw,Uie=vi(gs()),sG=class extends Uie.EventEmitter{constructor(r,a){super(),this.room=r,this.signalChannel=a,_e(this,"log"),_e(this,"cmdIdSeqMap",new Map),_e(this,"messageMap",new Map),this.log=cn.createLogger({id:"cmm",userId:r.userId}),this.onReceiveMsg=this.onReceiveMsg.bind(this),a.on(lo.RECEIVE_CUSTOM_MSG,this.onReceiveMsg)}send(r){let{cmdId:a,data:d}=r,g=this.cmdIdSeqMap.get(a)||Math.floor(16383*Math.random()),C={cmdId:a,msg:btoa(String.fromCharCode(...new Uint8Array(d))),ordered:!0,reliable:!0,streamSeq:g};this.cmdIdSeqMap.set(a,g+1),this.signalChannel.send(oie,C)}onReceiveMsg(r){let{data:a}=r.data,d=this.room.tinyIdToUserIdMap.get(a.srcTinyId);if(d){let g={userId:d,cmdId:a.cmdId,seq:a.streamSeq,data:Uint8Array.from(atob(a.msg),C=>C.charCodeAt(0)).buffer};if(a.ordered){let C="".concat(d,"_").concat(g.cmdId),A=this.messageMap.get(C);if(!A||Math.abs(A.lastSeq-g.seq)>sG.SEQ_INTERVAL)this.messageMap.set(C,{lastSeq:g.seq,cachedMessageMap:new Map}),this.emitMessage(g);else if(g.seq>A.lastSeq){if(g.seq===A.lastSeq+1)this.emitMessage(g);else if(!A.cachedMessageMap.has(g.seq)){let w=setTimeout(()=>this.emitMessage(g,!0),5e3);A.cachedMessageMap.set(g.seq,{message:g,timeoutId:w})}}else this.log.debug("drop message ".concat(g.userId,"-").concat(g.cmdId,"-").concat(g.seq))}else this.emit("message",g)}}emitMessage(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var d;let g=this.messageMap.get("".concat(r.userId,"_").concat(r.cmdId)),C=r;if(g){if(a){let w=[...g.cachedMessageMap.values()].sort((V,U)=>V.message.seq-U.message.seq);w[0]&&(C=w[0].message)}C.seq-g.lastSeq>1&&this.log.debug("msg lost userId: ".concat(C.userId," seq: ").concat(g.lastSeq," -> ").concat(C.seq)),g.lastSeq=C.seq,clearTimeout((d=g.cachedMessageMap.get(C.seq))==null?void 0:d.timeoutId),g.cachedMessageMap.delete(C.seq)}this.emit("message",C);let A=g==null?void 0:g.cachedMessageMap.get(C.seq+1);A&&this.emitMessage(A.message)}},aG=sG;_e(aG,"SEQ_INTERVAL",300);var lG,{isString:cG,isUndefined:Og,getNetworkType:xie,isEmpty:Ny}=tl,of=class extends Eie{constructor(r){super(r),this._heartbeat=-1,this._lastHeartBeatTime=-1,this._joinTimeout=-1,this._firstPublishedList=null,this._joinReject=null,this._isRelayChanged=!1,this._signalChannel=null,this.uplinkConnection=null,this.singlePC=null,this.enableSPC=hS,this._changeBigSmallRecords=new Map,this._networkQuality=null,this._turnServers=[],this._syncUserListInterval=-1,this._smallStreamConfig={bitrate:100,frameRate:15,height:120,width:160},this.enableSEI=!1,this._enableAudioVolumeEvaluation=!1,this._audioVolumeIntervalId=0,this._enableMultiAuxStream=!1,this._pureAudioPushMode=!1,this.enableHWEncoder=!1,this._stats=new iie(this,this._log),this.userManager=new bre(this.userId,this._log),this._version=nl,this.sdpSemantics=BC,Og(r.sdpSemantics)?ay.isUnifiedPlanDefault()&&(this.sdpSemantics=F_):this.sdpSemantics=r.sdpSemantics,this._log.info("sdpSemantics: ".concat(this.sdpSemantics,", netType: ").concat(xie())),r.iceTransportPolicy&&(this._iceTransportPolicy=r.iceTransportPolicy),this._enableMultiAuxStream=!Og(r.enableMultiAuxStream)&&r.enableMultiAuxStream,this.enableSEI=r.enableSEI,!Og(r.enableSPC)&&hS&&(this.enableSPC=r.enableSPC),this.enableHWEncoder=r.enableHWEncoder||!1,this._initBusinessInfo(r)}get isMainStreamPublished(){var r;return!((r=this.uplinkConnection)==null||!r.isMainStreamPublished)}get isMainAudioPublished(){var r;return!((r=this.uplinkConnection)==null||!r.localMainAudioTrack)}get isAuxStreamPublished(){var r;return!((r=this.uplinkConnection)==null||!r.isAuxStreamPublished)}get hasAuxStream(){return[...this.remotePublishedUserMap.values()].findIndex(r=>r.muteState.hasAuxiliary)>=0}get userMap(){return this.userManager.userMap}get remotePublishedUserMap(){return this.userManager.remotePublishedUserMap}get tinyIdToUserIdMap(){return new Map([...this.userMap.values()].map(r=>[r.tinyId,r.userId]))}join(r,a,d){return Ze(this,null,function*(){return this.userManager.mySelfId=this.userId,this.userManager.on("1",g=>{this.emit("peer-join",g)}),this.userManager.on("2",g=>{this.closeDownLinkConnection(g,"remote user exitRoom"),this.emit("peer-leave",g)}),this.userManager.on("3",this.createDownlinkConnection,this),this.userManager.on("5",this.closeDownLinkConnection,this),this.userManager.on("6",g=>{var C=((A,w)=>{var V={};for(var U in A)mA.call(A,U)&&w.indexOf(U)<0&&(V[U]=A[U]);if(A!=null&&xC)for(var U of xC(A))w.indexOf(U)<0&&CF.call(A,U)&&(V[U]=A[U]);return V})(g,[]);Qt.emit(Vt.REMOTE_PUBLISH_STATE_CHANGED,Pn({room:this},C)),this.emit("remote-publish-state-changed",Pn({},C))}),this._joinOptions=r,new Promise((g,C)=>Ze(this,null,function*(){var A,w;this._joinReject=C;try{this.checkDestroy();try{yield Promise.all([this.initialize(),this.initSinglePC()])}catch(V){if(!(V instanceof An&&V.code===rn.SPC_INITIALIZED_FAILED))return C(V);(A=this._signalChannel)==null||A.destroy(),yield this.initialize()}yield this.doJoin(r,(w=this.singlePC)==null?void 0:w.clientAbility),g(),this._firstPublishedList&&this.onPublishedUserList({data:{userList:this._firstPublishedList}})}catch(V){C(V)}this._joinReject=null}))})}initSinglePC(){return Ze(this,null,function*(){if(this.enableSPC&&!this.singlePC){this.singlePC=new Oy({signalChannel:this._signalChannel,room:this,enableCustomMessage:!1}),this.singlePC.on("sei-message",r=>this.emit("sei-message",r)),this.singlePC.once("error",()=>this.fallbackToMPC());try{return yield this.singlePC.initialize()}catch(r){throw this.fallbackToMPC(),new An({code:rn.SPC_INITIALIZED_FAILED,message:r==null?void 0:r.message})}}})}doJoin(r,a){return new Promise((d,g)=>Ze(this,null,function*(){var C,A,w;r.privateMapKey&&(this.privateMapKey=r.privateMapKey),this._signalChannel.once(OV,j=>{this.clearJoinTimeout(),Qt.emit(Vt.JOIN_SIGNAL_CONNECTION_END,{room:this,error:j}),g(j)}),vs((A=(C=this.scheduleResult)==null?void 0:C.config)==null?void 0:A.singlePC)&&hS&&(this.enableSPC=this.scheduleResult.config.singlePC),this.keyPointManager.setConnectionType(this.singlePC?1:2);let V={roomId:String(r.roomId||r.strRoomId),useStringRoomId:this.useStringRoomId,privateMapKey:this.privateMapKey,trtcRole:r.role,trtcScene:this.scene==="live"?2:1,sdpSemantics:this.sdpSemantics,version:this._version,ua:navigator&&navigator.userAgent||"",terminalType:u4(),netType:rS(),bussinessInfo:this._businessInfo,ability:a,sdkType:this._sdkType,userSig:this.userSig};this._log.debug("join room signal data: ".concat(JSON.stringify(V)));let U=5e3;(w=this.scheduleResult.config)!=null&&w.enterRoomTimeout&&this.scheduleResult.config.enterRoomTimeout>=1&&(U=1e3*this.scheduleResult.config.enterRoomTimeout),this._joinTimeout=window.setTimeout(()=>{g(new An({code:rn.JOIN_ROOM_FAILED,message:no({key:jn.JOIN_ROOM_TIMEOUT})}))},U),Qt.emit(Vt.JOIN_SEND_CMD,{room:this}),this._signalChannel.send(this.singlePC?Qre:Fre,V),this._signalChannel.once(lo.JOIN_ROOM_RESULT,j=>{this.clearJoinTimeout();let{code:re,message:ce,data:Te,tinyId:De}=j.data;Qt.emit(Vt.JOIN_RECEIVED_CMD_RES,{room:this,code:re}),re===0?(this._log.info("Join room success, start heartbeat"),De&&(this.tinyId=De),this.startHeartbeat(),this.syncUserList(),this.startSyncUserListInterval(),this._firstPublishedList=Te.publishers,this.singlePC&&this.singlePC.connect(Te.ability).catch(()=>{}),d()):(this._log.error("Join room failed result: ".concat(re," error: ").concat(ce)),g(new An({code:rn.JOIN_ROOM_FAILED,extraCode:re,message:no({key:jn.JOIN_ROOM_FAILED,data:{error:ce,code:re}})})))})}))}reJoin(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ze(this,null,function*(){if(this.isJoined)try{this._log.warn("reJoin pending: ".concat(this._joinOptions.roomId));let a,d=[];if(this.singlePC&&(this.singlePC.close(),this.singlePC=null,d.push(this.initSinglePC().then(g=>(a=g,g)))),this._signalChannel&&(this._signalChannel.race=r,this._signalChannel.close(),d.push(this._signalChannel.connect())),yield Promise.all(d),yield this.doJoin(uo(Pn({},this._joinOptions),{role:this.role==="anchor"?20:21,privateMapKey:this.privateMapKey}),a),this._log.warn("reJoin success"),Vr.logSuccessEvent({userId:this.userId,eventType:ec.REJOIN}),this.singlePC){let g=C=>{var A;C.state==="CONNECTED"&&((A=this.singlePC)==null||A.off(nf.CONNECTION_STATE_CHANGED,g),this.uplinkConnection instanceof rG&&this.uplinkConnection.onSinglePCReconnected(),this.remotePublishedUserMap.forEach(w=>{w.installEvents(),w.onSinglePCReconnected()}))};this.singlePC.on(nf.CONNECTION_STATE_CHANGED,g),this.checkConnectionsToReconnect(),this.uplinkConnection instanceof tw&&!this.uplinkConnection.getIsReconnecting()&&this.uplinkConnection.startReconnection()}}catch(a){this._log.warn("reJoin fail ".concat(a)),this.reset(),Vr.logFailedEvent({userId:this.userId,eventType:ec.REJOIN,error:a}),this.emit("error",new An({code:rn.JOIN_ROOM_FAILED,message:no({key:jn.REJOIN_ROOM_FAILED,data:{roomId:this._joinOptions.roomId}})}))}else this._log.warn("reJoin abort")})}initialize(){return Ze(this,null,function*(){let{mainUrl:r,backupUrl:a}=this.getSignalChannelUrl(),d=this._signalChannel||function(C){return[...NS.values()].find(w=>w.room.userId===C&&!w.room.isJoined)||null}(this.userId),g=!!(d&&d.isConnected&&d.keepAlive);return this._log.info("".concat(g?"reuse":"setup"," signal channel")),g?(d.url=r,d.backupUrl=a,d.room=this,this._signalChannel=d):(this._signalChannel=new FV({sdkAppId:this.sdkAppId,userId:this.userId,userSig:this.userSig,url:r,backupUrl:a,race:this.enableSPC&&!this.proxy_ws,room:this}),this._customMessageManager=new aG(this,this._signalChannel),this._customMessageManager.on("message",C=>{this.emit("custom-message",C)})),this._networkQuality||(this._networkQuality=new nw({signalChannel:this._signalChannel,room:this}),this._networkQuality.on(nw.EVENT_NETWORK_QUALITY,C=>{this.emit("network-quality",C)})),al(this,this._signalChannel).add(jR,C=>{Qt.emit(Vt.SIGNAL_CONNECTION_STATE_CHANGED,Pn({room:this},C)),this.emit("signal-connection-state-changed",C)}).add(Pre,C=>{this.reset(),this.emit("error",C)}).add(lo.PEER_JOIN,C=>{let{srcTinyId:A,userId:w,role:V}=C.data.data;this.userManager.addUser({userId:w,tinyId:A,role:V})}).add(lo.PEER_LEAVE,C=>{let{userId:A,reason:w=0}=C.data.data;this.userManager.deleteUser(A,w)}).add(lo.UPDATE_REMOTE_MUTE_STAT,C=>{this._lastHeartBeatTime>0&&Date.now()-this._lastHeartBeatTime>=1e4&&this.doHeartbeat(),this.onPublishedUserList(C.data)}).add(lo.CLIENT_BANNED,C=>{let A=C.data.data,{reason:w}=A;if(Vr.uploadEvent({log:"stat-banned:".concat(w),userId:this.userId}),w==="user_time_out")return this._log.warn("".concat(w," last heart beat time: ").concat(this._lastHeartBeatTime," interval: ").concat(Date.now()-this._lastHeartBeatTime,", visibility: ").concat(document.visibilityState)),void this.reJoin();this._log[w==="kick"?"error":"info"]("user was banned because of [".concat(w,"]")),this.reset(),this.emit("banned",{reason:w})}),this._signalChannel.once(DV,C=>{this.tinyId=C.signalInfo.tinyId,Qt.emit(Vt.JOIN_SIGNAL_CONNECTION_END,{room:this})}),Qt.emit(Vt.JOIN_SIGNAL_CONNECTION_START,{room:this}),yield this._signalChannel.connect(),g&&Qt.emit(Vt.JOIN_SIGNAL_CONNECTION_END,{room:this}),g})}setSignalChannel(r){this._signalChannel=r,r||Xi(this)}leave(){return Ze(this,null,function*(){var r;try{yield this.doHeartbeat()}catch{}this._log.info("leave() => leaving room"),Qt.emit(Vt.LEAVE_SEND_CMD,{room:this}),(r=this._signalChannel)==null||r.send(Vre)})}clearNetworkQuality(){this._networkQuality&&(this._networkQuality.stop(),this._networkQuality=null)}closeConnections(){this.remotePublishedUserMap.forEach(r=>{this.closeDownLinkConnection(r.userId,"you exitRoom")})}clearJoinTimeout(){clearTimeout(this._joinTimeout),this._joinTimeout=-1}startHeartbeat(){this._heartbeat===-1&&(this._heartbeat=Cr.run(dg,this.doHeartbeat.bind(this),{delay:2e3}))}stopHeartbeat(){this._heartbeat!==-1&&(this._log.info("stopHeartbeat"),Cr.clearTask(this._heartbeat),this._heartbeat=-1,this._lastHeartBeatTime=-1)}doHeartbeat(){return Ze(this,null,function*(){var r;let a=this.badCaseDetector.getMonitorFreeze(),d=yield this._stats.getStatsReport({uplinkConnection:this.uplinkConnection,downlinkConnections:this.remotePublishedUserMap,freezeMap:a});if(this.badCaseDetector.resetMonitor(),(r=this._signalChannel)==null||!r.isConnected)return;let g=this._signalChannel.isConnected?function(w){if(Mg.has(w)){let V=Mg.get(w).map(U=>({uint32_event_id:U.eventId,uint64_date:U.timestamp,str_userid:U.remoteUserId,str_event_json:U.eventDesc}));return Mg.delete(w),V}return[]}(this.userId):[],C=Pn({str_sdk_version:bA,uint64_datetime:new Date().getTime(),msg_user_info:{str_identifier:this.userId,uint64_tinyid:this.tinyId},msg_device_info:{uint32_terminal_type:15,str_device_name:navigator.platform,str_os_version:"",uint32_net_type:rS()},msg_event_msg:g,str_acc_ip:this.getSignalInfo().relayIp,str_client_ip:this.getSignalInfo().clientIp},d);Qt.emit(Vt.HEARTBEAT_REPORT,{room:this,report:C}),this._signalChannel.send(Gre,C),this.emit("heartbeat-report",uo(Pn({},C),{bytes_sent:this._stats.totalBytesSent+this._signalChannel.bytesSent,bytes_received:this._stats.totalBytesReceived+this._signalChannel.bytesReceived}));let A=Date.now();this._lastHeartBeatTime>0&&A-this._lastHeartBeatTime>1e4&&this._log.warn("heartbeat took ".concat(A-this._lastHeartBeatTime)),this._signalChannel.isConnected&&(this._lastHeartBeatTime=A),!this._isRelayChanged&&this.isRelayMaybeFailed()&&(this.reJoin(),this._isRelayChanged=!0)})}onPublishedUserList(r){if(!this.isJoined)return;let a=r.data.userList.map(d=>{let{userId:g,srcTinyId:C,flag:A}=d;g===this.userId&&this.uplinkConnection&&(this.uplinkConnection.flag=A);let w=this.remotePublishedUserMap.get(g);return w&&this.checkSubscribeBigSmallVideo(w),{userId:g,tinyId:C,flag:A}});Qt.emit(Vt.RECEIVED_PUBLISHED_USER_LIST,{room:this,publishedUserList:a}),this.userManager.setRemotePublishedUserList(a)}closeUplink(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"you unpublished";this.uplinkConnection&&(this.localTracks.size>0&&this.uplinkConnection.doUnpublish(),this.uplinkConnection.close(r),this.uplinkConnection=null),this.localTracks.forEach(a=>a.unpublish()),this.localTracks.clear()}createDownlinkConnection(r){let{userId:a,tinyId:d,flag:g}=r,C=new(this.singlePC?Pie:$V)({userId:a,tinyId:d,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:g});this.userManager.addRemotePublishedUser(C),this.installDownlinkEvents(C,a),this.emit("remote-published",C)}closeDownLinkConnection(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"remote user unpublished",d=this.remotePublishedUserMap.get(r);d&&(d.close(a),this.emit("remote-unpublished",d))}installDownlinkEvents(r,a){r.on("error",d=>{let g=d.getCode();g!==rn.ICE_TRANSPORT_ERROR&&(g===rn.DOWNLINK_RECONNECTION_FAILED&&this.closeDownLinkConnection(a),this.emit("error",d))}),r.on("connection-state-changed",d=>{this.emit("media-connection-state-changed",uo(Pn({},d),{userId:r.userId}))}),r.on("firewall-restriction",()=>{this.emit("firewall-restriction")})}startSyncUserListInterval(){this._syncUserListInterval===-1&&(this._syncUserListInterval=Cr.run(dg,this.syncUserList.bind(this)))}stopSyncUserListInterval(){Cr.clearTask(this._syncUserListInterval),this._syncUserListInterval=-1}syncUserList(){return this.getUserList().then(r=>{this.userManager.setUserList(r)}).catch(r=>{this._log.debug("sync user list failed: ".concat(r))})}getUserList(){var r;return(r=this._signalChannel)!=null&&r.isConnected?this._signalChannel.sendWaitForResponse({command:Yre,responseCommand:lo.USER_LIST_RES,enableLog:!1,timeout:2e3}).then(a=>{let{data:d}=a,{code:g,message:C}=d;if(g===0)return(d.data&&d.data.userList||[]).map(A=>{let{userId:w,srcTinyId:V,role:U}=A;return{userId:w,tinyId:V,role:U}});throw no({key:jn.SIGNAL_RESPONSE_FAILED,data:{signalResponse:lo.USER_LIST_RES,code:g,message:C}})}):Promise.reject("not connected")}getAllConnections(){let r=[...this.remotePublishedUserMap.values()];return this.uplinkConnection&&r.push(this.uplinkConnection),r}isRelayMaybeFailed(){if(this._signalChannel&&!this._signalChannel.isOnline||!VV)return!1;if(this.singlePC)return this.singlePC.reconnectionCount>6;let r=this.getAllConnections();if(r.length===0)return!1;for(let a=0;a<r.length;a++)if(r[a].getReconnectionCount()<6)return!1;return!0}checkConnectionsToReconnect(){var r;this.singlePC?((r=this.singlePC.getPeerConnection())==null?void 0:r.connectionState)===Or.CLOSED&&!this.singlePC.isReconnecting&&(this._log.warn("spc pc is closed but not reconnect"),this.singlePC.startReconnection()):this.getAllConnections().forEach(a=>{if(a instanceof Zh&&!a.getIsReconnecting()){let d=a.getPeerConnection();d&&d.connectionState===Or.CLOSED&&(this._log.warn("[".concat(a.getUserId(),"] pc is closed but not reconnect")),a.startReconnection())}})}fallbackToMPC(){return Ze(this,null,function*(){var r;if(this._log.warn("fallback to multi pc"),Vr.uploadEvent({log:"stat-fallback",userId:this.userId}),this.enableSPC=!1,(r=this.singlePC)==null||r.close(),this.singlePC=null,this.isJoined&&(yield this.reJoin(!1)),this.uplinkConnection){let a=this.uplinkConnection;this.uplinkConnection=new tw({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),a.isMainStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:a.localMainAudioTrack,localVideoTrack:a.localMainVideoTrack,isAuxiliary:!1})),a.isAuxStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:a.localAuxAudioTrack,localVideoTrack:a.localAuxVideoTrack,isAuxiliary:!0})),a.close()}this.remotePublishedUserMap.forEach(a=>{let d=new $V({userId:a.userId,tinyId:a.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:a.flag,remoteAudioTrack:a.remoteAudioTrack,remoteVideoTrack:a.remoteVideoTrack,remoteAuxiliaryTrack:a.remoteAuxiliaryTrack});this.installDownlinkEvents(d,a.userId),this.remotePublishedUserMap.set(a.userId,d),a.isMainStreamSubscribed&&d.subscribe(a.subscribeState,"main"),a.isAuxStreamSubscribed&&d.subscribe(a.subscribeState,"auxiliary")})})}destroy(){this.isDestroyed||(this._signalChannel&&(this._log.info("destroying SignalChannel"),this._signalChannel.close(),this._signalChannel=null),super.destroy(),this._joinReject&&(this._joinReject(new An({code:rn.INVALID_OPERATION,message:no({key:jn.CLIENT_DESTROYED,data:{funName:"join"}})})),this.clearJoinTimeout(),this.reset()),this.removeAllListeners())}switchRole(r){return Ze(this,null,function*(){this.role!==r&&(r==="audience"&&this.uplinkConnection&&this.closeUplink("you switch role to audience"),yield this.doSwitchRole(r))})}doSwitchRole(r){let a={command:Jre,data:{role:r==="anchor"?20:21,privateMapKey:this.privateMapKey},responseCommand:lo.SWITCH_ROLE_RES,retries:1};return this._log.info("switchRole signal data: ".concat(JSON.stringify(a.data))),this._signalChannel.sendWaitForResponseWithRetry(a).then(d=>{let{code:g,message:C}=d.data;if(g!==0)throw new An({code:rn.SWITCH_ROLE_FAILED,message:no({key:jn.SWITCH_ROLE_FAILED,data:{message:C,code:g}})});this.role=r}).catch(d=>{throw d instanceof An&&d.getCode()===rn.API_CALL_TIMEOUT&&(d=new An({code:rn.SWITCH_ROLE_FAILED,message:no({key:jn.SWITCH_ROLE_TIMEOUT})})),this._log.error(d),d})}publish(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return Ze(this,null,function*(){let g={},C={};a.forEach(U=>{U instanceof lc&&(U instanceof yy?C.audio=U:g.audio=U),U instanceof _s&&(U instanceof Yh&&U.mediaType===2?C.video=U:g.video=U)});let A=Ny(g),w=Ny(C);(!A||!w)&&!this.uplinkConnection&&(this.singlePC?this.uplinkConnection=new rG({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}):this.uplinkConnection=new tw({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),this.uplinkConnection.on("connection-state-changed",U=>{this.emit("media-connection-state-changed",uo(Pn({},U),{userId:this.userId}))}),this.uplinkConnection.on("firewall-restriction",()=>{this.emit("firewall-restriction")}),this.uplinkConnection.on("error",U=>{let j=U.getCode();j!==rn.ICE_TRANSPORT_ERROR&&(j===rn.UPLINK_RECONNECTION_FAILED&&this.closeUplink(),this.emit("error",U))}));let V=a.map(U=>U.kind).join(",");A||(this._log.info("publish() => main ".concat(V)),yield this.uplinkConnection.publish({localAudioTrack:g.audio,localVideoTrack:g.video,isAuxiliary:!1}),this._log.info("main is published")),w||(this._log.info("publish() => aux ".concat(V)),yield this.uplinkConnection.publish({localAudioTrack:C.audio,localVideoTrack:C.video,isAuxiliary:!0}),this._log.info("aux is published"))})}unpublish(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return Ze(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||!this.isMainStreamPublished&&!this.isAuxStreamPublished||!this.uplinkConnection)return;let g={},C={};a.forEach(A=>{!A.mediaTrack||!A.isPublished||(A instanceof lc&&(A instanceof yy?C.audio=A:g.audio=A),A instanceof _s&&(A instanceof Yh&&A.mediaType===2?C.video=A:g.video=A))});try{let A=a.map(w=>w.kind).join(",");Ny(g)||(this._log.info("unpublish() => main ".concat(A)),yield this.uplinkConnection.unpublish({localAudioTrack:g.audio,localVideoTrack:g.video})),Ny(C)||(this._log.info("unpublish() => aux ".concat(A)),yield this.uplinkConnection.unpublish({localAudioTrack:C.audio,localVideoTrack:C.video}))}catch{}this.localTracks.size===0&&this.closeUplink("you unpublished")})}addTrack(r){if(!this.uplinkConnection||!r.mediaTrack)return Promise.resolve();let a=this.uplinkConnection.addTrack(r);return r.publish(this,a),a}removeTrack(r){return this.uplinkConnection&&r.mediaTrack?this.uplinkConnection.removeTrack(r).then(a=>(r.unpublish(),a)):Promise.resolve()}replaceTrack(r){return this.uplinkConnection&&r.mediaTrack&&P4()?this.uplinkConnection.replaceTrack(r).then(a=>{Qt.emit(Vt.LOCAL_TRACK_REPLACED,{track:r})}):Promise.resolve()}setBandWidth(r){return Ze(this,null,function*(){!this.uplinkConnection||(yield this.uplinkConnection.setBandwidth(r),yield this.uplinkConnection.sendMediaSettings())})}enableSmall(r){return Ze(this,null,function*(){if(!this.uplinkConnection||!this.uplinkConnection.localMainVideoTrack)return Promise.resolve();r&&this.uplinkConnection.localMainVideoTrack.small&&(yield this.setBandWidth({type:Pe.VIDEO,videoType:Pe.SMALL,bandwidth:this.uplinkConnection.localMainVideoTrack.small.bitrate})),yield this.uplinkConnection.enableSmall(r)})}subscribe(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return Ze(this,null,function*(){if(a=a.filter(w=>!w.isSubscribed),a.length===0)return;let{userId:g}=a[0],C=this.remotePublishedUserMap.get(g);if(!C)return;let A=a.find(w=>w.mediaType===2)?"auxiliary":"main";try{let w=Pn({},C.subscribeState);a.forEach(U=>{switch(U.mediaType){case 1:w.audio=!0;break;case 4:w.video=!0;break;case 8:w.smallVideo=!0;break;case 2:w.auxiliary=!0}});let V=this._changeBigSmallRecords.get(g);V&&V.options.smallVideo&&C.muteState.hasSmall&&w.video&&(w.video=!1,w.smallVideo=!0),Qt.emit(Vt.SUBSCRIBE_START,{room:this,streamType:A,remotePublishedUser:C,subscribeState:w}),this._log.info("subscribe() => ".concat(g," ").concat(A," [").concat(QR(w),"] prev: [").concat(QR(C.subscribeState),"]")),yield C.subscribe(w,A),this._log.info("subscribe ".concat(g," ").concat(A," done"));for(let U of a)U.mediaTrack||(yield U.waitHasMediaTrack());Qt.emit(Vt.SUBSCRIBE_SUCCESS,{room:this,streamType:A,remotePublishedUser:C})}catch(w){let V=w instanceof An?w.getCode():rn.UNKNOWN,U=w;throw w instanceof An?V===rn.REMOTE_STREAM_NOT_EXIST&&(U=new An({code:rn.API_CALL_ABORTED,message:no({key:jn.API_CALL_ABORTED,data:{message:w.message,userId:g,streamType:A}})}),this._log.warn(U)):(U=new An({code:V,message:no({key:jn.SUBSCRIBE_FAILED,data:{message:w.message,userId:g,streamType:A}})}),this._log.error(U)),U}})}unsubscribe(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return Ze(this,null,function*(){let{userId:g}=a[0],C=this.remotePublishedUserMap.get(g);if(!C)return;let A=a.find(w=>w.mediaType===2)?"auxiliary":"main";this._log.info("unsubscribe() => ".concat(g," ").concat(A));try{yield C.unsubscribe({remoteTracks:a,streamType:A})}catch(w){this._log.warn("unsubscribe() => failed ".concat(w))}a.forEach(w=>{w.unsubscribe(),w.mediaType===8&&w.setMediaType(4)}),Qt.emit(Vt.UNSUBSCRIBE_SUCCESS,{room:this,streamType:A,remotePublishedUser:C})})}setEncodedDataProcessingListener(r){throw new Error("Method not implemented.")}enableAudioVolumeEvaluation(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,a=arguments.length>1?arguments[1]:void 0;if(r<=0)return this._enableAudioVolumeEvaluation=!1,void Cr.clearTask(this._audioVolumeIntervalId);r=Math.floor(Math.max(r,100)),Qt.emit(Vt.AUDIO_LEVEL_INTERVAL,{interval:r}),this._audioVolumeIntervalId&&Cr.clearTask(this._audioVolumeIntervalId),this._enableAudioVolumeEvaluation=!0,this._audioVolumeIntervalId=Cr.run(PA,()=>{var d;let g=[];(d=this.remotePublishedUserMap)==null||d.forEach(C=>{if(C.muteState.hasAudio){let A=Math.floor(100*C.remoteAudioTrack.getAudioLevel());g.push({userId:C.userId,volume:A})}}),this.emit("audio-volume",g)},{fps:1e3/r,backgroundTask:a})}getLocalAudioStats(){return Ze(this,null,function*(){let r={};if(r[this.userId]={bytesSent:0,packetsSent:0},this.uplinkConnection){let a=yield this._stats.getSenderStats(this.uplinkConnection);r[this.userId]={bytesSent:a.audio.bytesSent,packetsSent:a.audio.packetsSent}}return r})}getLocalVideoStats(){return Ze(this,null,function*(){let r={};if(r[this.userId]={bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0},this.uplinkConnection){let{video:{bytesSent:a,packetsSent:d,framesEncoded:g,framesSent:C,frameWidth:A,frameHeight:w}}=yield this._stats.getSenderStats(this.uplinkConnection);r[this.userId]={bytesSent:a,packetsSent:d,framesEncoded:g,framesSent:C,frameWidth:A,frameHeight:w}}return r})}getTransportStats(){return Ze(this,null,function*(){let r={rtt:0,downlinksRTT:{}};if(this.uplinkConnection){let a=yield this._stats.getSenderStats(this.uplinkConnection);r.rtt=a.rtt}for(let[,a]of this.remotePublishedUserMap){let d=yield this._stats.getReceiverStats(a);r.downlinksRTT[d.userId]=d.rtt}return r})}getRemoteVideoStats(r){return Ze(this,null,function*(){let a={};for(let[d,g]of this.remotePublishedUserMap)r==="main"&&g.muteState.hasVideo&&(a[d]=g.remoteVideoTrack.stat),r==="auxiliary"&&g.muteState.hasAuxiliary&&(a[d]=g.remoteAuxiliaryTrack.stat);return a})}getRemoteAudioStats(){return Ze(this,null,function*(){let r={};for(let[a,d]of this.remotePublishedUserMap)d.muteState.hasAudio&&(r[a]=d.remoteAudioTrack.stat);return r})}setTurnServer(r,a){this._log.info("set turn server: ".concat(JSON.stringify(r)," ").concat(a||""));let d=[];Array.isArray(r)?r.forEach(g=>d.push(tl.getTurnServer(g))):tl.isPlainObject(r)&&d.push(tl.getTurnServer(r)),this._turnServers=d,a&&(this._iceTransportPolicy=a)}sendStartMixTranscode(r){return this._signalChannel.sendWaitForResponse({command:Wre,data:r,timeout:5e3,responseCommand:lo.START_MIX_TRANSCODE_RES,commandDesc:"startMixTranscode"})}sendStopMixTranscode(r){return this._signalChannel.sendWaitForResponse({command:jre,data:r,timeout:5e3,responseCommand:lo.STOP_MIX_TRANSCODE_RES,commandDesc:"stopMixTranscode"})}sendStartPublishCDN(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:a?Hre:Kre,data:r,timeout:5e3,responseCommand:a?lo.START_PUBLISH_TENCENT_CDN_RES:lo.START_PUBLISH_GIVEN_CDN_RES,commandDesc:"startPublishCDN"})}sendStopPublishCDN(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:a?qre:zre,data:r,timeout:5e3,responseCommand:a?lo.STOP_PUBLISH_TENCENT_CDN_RES:lo.STOP_PUBLISH_GIVEN_CDN_RES,commandDesc:"stopPublishCDN"})}sendAbilityStatus(r){var a;(a=this._signalChannel)==null||a.sendWaitForResponse({command:tie,data:r,timeout:5e3,responseCommand:lo.ABILITY_STATUS_REPORT_RESULT,commandDesc:"ability status report"}).catch(d=>{})}getIceServers(){return this._turnServers.length===0&&this.scheduleResult.iceServers?this.scheduleResult.iceServers:this._turnServers}getIceTransportPolicy(){return this._iceTransportPolicy||this.scheduleResult.iceTransportPolicy||"all"}getLogger(){return this._log}enableAIVoice(){throw new Error("Method not implemented.")}getSignalChannelUrl(){let r={mainUrl:"",backupUrl:""},a=tl.getEnv();return a?(r.mainUrl="wss://".concat(a,".rtc.qq.com"),r.backupUrl=r.mainUrl):this.proxy_ws?(r.mainUrl=this.proxy_ws,r.backupUrl=r.mainUrl):Array.isArray(this.scheduleResult.domains)&&this.scheduleResult.domains.length>0&&(r.mainUrl="wss://".concat(this.scheduleResult.domains[0]),r.backupUrl=r.mainUrl,this.scheduleResult.domains[1]&&(r.backupUrl="wss://".concat(this.scheduleResult.domains[1]))),r}getSignalInfo(){var r;return((r=this._signalChannel)==null?void 0:r.getSignalInfo())||{clientIp:"",relayIp:""}}reset(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.stopSyncUserListInterval(),this.stopHeartbeat(),this.closeConnections(),this.clearNetworkQuality(),this.closeUplink("you exitRoom"),this._signalChannel&&(r&&this._signalChannel.keepAlive&&this._signalChannel.isConnected?this._signalChannel.stopKeepAliveIn(3600):this._signalChannel.close(),this.setSignalChannel(null)),this._stats.reset(),this.userManager.clear(),this.userManager.removeAllListeners(),this.singlePC&&(this.singlePC.close(),this.singlePC=null),this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null}}checkSubscribeBigSmallVideo(r){return Ze(this,null,function*(){let{subscribeState:a,userId:d,muteState:{hasSmall:g,hasVideo:C}}=r;if(!g&&!C||!a.video&&!a.smallVideo)return;let A=this._changeBigSmallRecords.get(d);if(!A||A.isSubscribing||A.reSubscribeCount<=0)return;let{options:w,reSubscribeCount:V}=A;if(w.video&&a.video||w.smallVideo&&a.smallVideo&&g)return;let U={audio:r.remoteAudioTrack.isSubscribed||r.remoteAudioTrack.isSubscribing,auxiliary:r.remoteAuxiliaryTrack.isSubscribed||r.remoteAuxiliaryTrack.isSubscribing,video:w.video,smallVideo:w.smallVideo};try{if(!g&&U.smallVideo&&(U.video=!0,U.smallVideo=!1),U.smallVideo===a.smallVideo&&U.video===a.video)return;A.isSubscribing=!0,A.reSubscribeCount=V-1,yield r.subscribe(U,"main"),r.remoteVideoTrack.setMediaType(U.smallVideo?8:4),this._log.info("change [".concat(d,"] to ").concat(U.smallVideo?"small":"big"," video successfully. count ").concat(G_-A.reSubscribeCount,".")),A.isSubscribing=!1,A.reSubscribeCount=G_}catch{this._log.info("change [".concat(d,"] to ").concat(U.smallVideo?"small":"big"," video failed. count ").concat(G_-A.reSubscribeCount,".")),A.isSubscribing=!1,A.reSubscribeCount===0&&this._changeBigSmallRecords.delete(d)}})}changeType(r,a){let d={options:{video:!r,smallVideo:r},isSubscribing:!1,reSubscribeCount:G_};this._changeBigSmallRecords.set(a.userId,d),this._log.info("set [".concat(a.userId,"] video prefer type: ").concat(r?"small":"big"))}get smallStreamConfig(){return this._smallStreamConfig}_initBusinessInfo(r){this._businessInfo=r.businessInfo;let a={};if(cG(r.businessInfo)&&(a=JSON.parse(r.businessInfo)),!Og(r.pureAudioPushMode)){if(!Number.isInteger(Number(r.pureAudioPushMode)))throw new An({code:rn.INVALID_PARAMETER,message:no({key:jn.INVALID_PURE_AUDIO})});this._pureAudioPushMode=r.pureAudioPushMode,a.Str_uc_params||(a.Str_uc_params={}),a.Str_uc_params.pure_audio_push_mod=this._pureAudioPushMode}if(!Og(r.userDefineRecordId)){let d=/^[A-Za-z0-9_-]{1,64}$/gi;if(r.userDefineRecordId.match(d)===null)throw new An({code:rn.INVALID_PARAMETER,message:no({key:jn.INVALID_USER_DEFINE_RECORDID})});a.Str_uc_params||(a.Str_uc_params={}),a.Str_uc_params.userdefine_record_id=r.userDefineRecordId}if(!Og(r.userDefinePushArgs)){if(!(cG(r.userDefinePushArgs)&&String(r.userDefinePushArgs)&&String(r.userDefinePushArgs).length<=256))throw new An({code:rn.INVALID_PARAMETER,message:no({key:jn.INVALID_USER_DEFINE_PUSH_ARGS})});a.Str_uc_params||(a.Str_uc_params={}),a.Str_uc_params.userdefine_push_args=r.userDefinePushArgs}Ny(a)||(this._businessInfo=JSON.stringify(a))}sendSEI(r,a){this.singlePC&&this.singlePC.sendSEI(r,a)}sendCustomMessage(r){var a;(a=this._customMessageManager)==null||a.send(r)}};return mn([wV(["left",mr.INIT],"joined"),Dy({settings:{retries:1,timeout:0},onError(r,a,d){this._isUsingCachedSchedule&&!this.isDestroyed?(this._log.warn("is using cached schedule, retry join"),Su(!0),this.reset(),a()):this._signalChannel&&this._signalChannel.isConnected&&this._signalChannel.keepAlive?(this._log.warn("is using keepAlive ws, retry join"),this._signalChannel.close(),this.reset(),a()):(this.reset(),this._log.error(r),d(r))}}),cr(r=>{let a=new Rre;return function(d,g,C){return Ze(this,null,function*(){let A=String(d.roomId||d.strRoomId);if(this.userId=d.userId,this.sdkAppId=d.sdkAppId,this.userSig=d.userSig,this._log.setSdkAppId(this.sdkAppId),this._log.setUserId(this.userId),this.scene=g,d.privateMapKey=d.privateMapKey||"",this.isJoined)throw new An({code:rn.INVALID_OPERATION,message:no({key:jn.INVALID_JOIN})});if(this.checkDestroy(),a.isJoined({userId:this.userId,roomId:A,sdkAppId:this.sdkAppId,room:this}))throw new An({code:rn.INVALID_OPERATION,message:no({key:jn.REPEAT_JOIN,data:this.userId})});a.add({room:this,roomId:A}),this.role=d.role===21?"audience":"anchor",this._log.info("Join() => joining room: ".concat(A," useStringRoomId: ").concat(this.useStringRoomId," scene: ").concat(this.scene," role: ").concat(this.role)),Qt.emit(Vt.JOIN_START,{room:this,roomId:A,params:d}),this.checkSystemResult=yield ay.checkSystemRequirementsInternal(),this.checkDestroy();let w=tl.getEnv();w||(w=Vh.QCLOUD,this.proxy_ws&&(this.proxy_ws.startsWith(RA.OLD_CLOUD_LADDER)?w=Vh.OLD_CLOUD_LADDER:this.proxy_ws.startsWith(RA.WEBRTC)&&(w=Vh.WEBRTC))),Vr.setConfig({env:w,sdkAppId:String(this.sdkAppId),userId:this.userId,roomId:A}),wre.call(this);let{isH264EncodeSupported:V,isVp8EncodeSupported:U}=this.checkSystemResult.detail;if(!ay.isWebRTCSupported()||!V&&!U)throw new An({code:rn.NOT_SUPPORTED,message:no({key:jn.NOT_SUPPORTED_WEBRTC})});try{!this.proxy_ws&&!this.proxy_wt&&!this.scheduleResult.domains&&!tl.getEnv()&&(yield this.schedule(A,C));let j=yield r.call(this,d,g,C);return this.roomId=A,this._joinedTimestamp=tl.performanceNow(),Qt.emit(Vt.JOIN_SUCCESS,{room:this}),Vr.uploadEvent({log:"stat-conv-".concat(Number($h),"-").concat(location.hostname),userId:this.userId}),j}catch(j){throw a.delete({room:this,roomId:A}),Qt.emit(Vt.JOIN_FAILED,{room:this,error:j}),j}})}})],of.prototype,"join"),mn([wV("joined","left",{ignoreError:!0,success(){this.reset(!0)}}),cr(r=>function(){return Ze(this,null,function*(){Qt.emit(Vt.LEAVE_START,{room:this}),yield r.call(this),Qt.emit(Vt.LEAVE_SUCCESS,{room:this,roomId:this.roomId})})}),dV("leave room"),OS({fnName:"publish",validateArgs:!1}),OS({fnName:"unsubscribe",validateArgs:!1})],of.prototype,"leave"),mn([Eg(),cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];return Ze(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||(d=d.filter(A=>A.outMediaTrack&&A.state==="capture"),!d.length))return;Qt.emit("61",{room:this});let C=r.apply(this,d);return d.forEach(A=>A.publish(this,C)),C})}),Dy({settings:{retries:ug,timeout:r=>vg(r)},onError(r,a,d){var g;(g=r.message)!=null&&g.includes("timeout")?(this._log.warn("publish timeout"),a()):(this._log.error("publish failed: ".concat(r)),d(r),Qt.emit(Vt.PUBLISH_FAILED,{room:this}))}})],of.prototype,"publish"),mn([OS({fnName:"publish"}),(lG="api-call",function(r,a,d){let g=d.value;return d.value=function(){for(var C=arguments.length,A=new Array(C),w=0;w<C;w++)A[w]=arguments[w];let V=vy.get(this);if(V){let U=V.queue.filter((j,re)=>{if(re===0)return!0;let ce=!0;return j.args.forEach(Te=>{A.find(De=>De===Te)||(ce=!1)}),!ce||(j.reject(new An({code:rn.API_CALL_ABORTED,message:lG})),!1)});V.queue=U}return g.apply(this,A)},d}),Eg(),cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];let C=r.apply(this,d);return d.forEach(A=>A.unpublish()),C})],of.prototype,"unpublish"),mn([yS(function(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return a[0].userId}),fV(),cr(r=>function(){for(var a=arguments.length,d=new Array(a),g=0;g<a;g++)d[g]=arguments[g];let C=r.apply(this,d);return d.forEach(A=>!A.isSubscribed&&A.subscribe(C)),C}),Dy({settings:{retries:ug,timeout:r=>vg(r)},onError(r,a,d,g){r.message.includes("timeout")?(this._log.warn("subscribe timeout"),a()):(this._log.error("subscribe failed: ".concat(r)),d(r),Qt.emit(Vt.SUBSCRIBE_FAILED,{room:this,remoteTracks:g}))}})],of.prototype,"subscribe"),mn([OS({fnName:"subscribe",callback(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];this.singlePC||a.forEach(g=>{let C=this.remotePublishedUserMap.get(g.userId);C&&!C.isMainStreamSubscribed&&!C.isAuxStreamSubscribed&&C.close("you unsubscribed")})}}),yS(function(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return a[0].userId})],of.prototype,"unsubscribe"),wS.create=wS._create.bind(wS,of),wS})})(XH);var hce=XH.exports;const xy=la(hce);var mm=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},ml=[],qs=[],fce=typeof Uint8Array<"u"?Uint8Array:Array,TN=!1;function QH(){TN=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,o=e.length;t<o;++t)ml[t]=e[t],qs[e.charCodeAt(t)]=t;qs[45]=62,qs[95]=63}function pce(e,t,o){for(var i,c,u=[],f=t;f<o;f+=3)i=(e[f]<<16)+(e[f+1]<<8)+e[f+2],u.push(ml[(c=i)>>18&63]+ml[c>>12&63]+ml[c>>6&63]+ml[63&c]);return u.join("")}function m6(e){var t;TN||QH();for(var o=e.length,i=o%3,c="",u=[],f=0,p=o-i;f<p;f+=16383)u.push(pce(e,f,f+16383>p?p:f+16383));return i===1?(t=e[o-1],c+=ml[t>>2],c+=ml[t<<4&63],c+="=="):i===2&&(t=(e[o-2]<<8)+e[o-1],c+=ml[t>>10],c+=ml[t>>4&63],c+=ml[t<<2&63],c+="="),u.push(c),u.join("")}function zS(e,t,o,i,c){var u,f,p=8*c-i-1,m=(1<<p)-1,_=m>>1,b=-7,S=o?c-1:0,T=o?-1:1,M=e[t+S];for(S+=T,u=M&(1<<-b)-1,M>>=-b,b+=p;b>0;u=256*u+e[t+S],S+=T,b-=8);for(f=u&(1<<-b)-1,u>>=-b,b+=i;b>0;f=256*f+e[t+S],S+=T,b-=8);if(u===0)u=1-_;else{if(u===m)return f?NaN:1/0*(M?-1:1);f+=Math.pow(2,i),u-=_}return(M?-1:1)*f*Math.pow(2,u-i)}function ZH(e,t,o,i,c,u){var f,p,m,_=8*u-c-1,b=(1<<_)-1,S=b>>1,T=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=i?0:u-1,R=i?1:-1,E=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(p=isNaN(t)?1:0,f=b):(f=Math.floor(Math.log(t)/Math.LN2),t*(m=Math.pow(2,-f))<1&&(f--,m*=2),(t+=f+S>=1?T/m:T*Math.pow(2,1-S))*m>=2&&(f++,m/=2),f+S>=b?(p=0,f=b):f+S>=1?(p=(t*m-1)*Math.pow(2,c),f+=S):(p=t*Math.pow(2,S-1)*Math.pow(2,c),f=0));c>=8;e[o+M]=255&p,M+=R,p/=256,c-=8);for(f=f<<c|p,_+=c;_>0;e[o+M]=255&f,M+=R,f/=256,_-=8);e[o+M-R]|=128*E}var gce={}.toString,e7=Array.isArray||function(e){return gce.call(e)=="[object Array]"};function ND(){return Ot.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Cc(e,t){if(ND()<t)throw new RangeError("Invalid typed array length");return Ot.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Ot.prototype:(e===null&&(e=new Ot(t)),e.length=t),e}function Ot(e,t,o){if(!(Ot.TYPED_ARRAY_SUPPORT||this instanceof Ot))return new Ot(e,t,o);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return LD(this,e)}return t7(this,e,t,o)}function t7(e,t,o,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?function(c,u,f,p){if(u.byteLength,f<0||u.byteLength<f)throw new RangeError("'offset' is out of bounds");if(u.byteLength<f+(p||0))throw new RangeError("'length' is out of bounds");return u=f===void 0&&p===void 0?new Uint8Array(u):p===void 0?new Uint8Array(u,f):new Uint8Array(u,f,p),Ot.TYPED_ARRAY_SUPPORT?(c=u).__proto__=Ot.prototype:c=_w(c,u),c}(e,t,o,i):typeof t=="string"?function(c,u,f){if(typeof f=="string"&&f!==""||(f="utf8"),!Ot.isEncoding(f))throw new TypeError('"encoding" must be a valid string encoding');var p=0|o7(u,f),m=(c=Cc(c,p)).write(u,f);return m!==p&&(c=c.slice(0,m)),c}(e,t,o):function(c,u){if(vl(u)){var f=0|EN(u.length);return(c=Cc(c,f)).length===0||u.copy(c,0,0,f),c}if(u){if(typeof ArrayBuffer<"u"&&u.buffer instanceof ArrayBuffer||"length"in u)return typeof u.length!="number"||(p=u.length)!=p?Cc(c,0):_w(c,u);if(u.type==="Buffer"&&e7(u.data))return _w(c,u.data)}var p;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function n7(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function LD(e,t){if(n7(t),e=Cc(e,t<0?0:0|EN(t)),!Ot.TYPED_ARRAY_SUPPORT)for(var o=0;o<t;++o)e[o]=0;return e}function _w(e,t){var o=t.length<0?0:0|EN(t.length);e=Cc(e,o);for(var i=0;i<o;i+=1)e[i]=255&t[i];return e}function EN(e){if(e>=ND())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ND().toString(16)+" bytes");return 0|e}function vl(e){return!(e==null||!e._isBuffer)}function o7(e,t){if(vl(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var o=e.length;if(o===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":case void 0:return dE(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return a7(e).length;default:if(i)return dE(e).length;t=(""+t).toLowerCase(),i=!0}}function mce(e,t,o){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Ece(this,t,o);case"utf8":case"utf-8":return i7(this,t,o);case"ascii":return Sce(this,t,o);case"latin1":case"binary":return Tce(this,t,o);case"base64":return Cce(this,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mce(this,t,o);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function lf(e,t,o){var i=e[t];e[t]=e[o],e[o]=i}function v6(e,t,o,i,c){if(e.length===0)return-1;if(typeof o=="string"?(i=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,isNaN(o)&&(o=c?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(c)return-1;o=e.length-1}else if(o<0){if(!c)return-1;o=0}if(typeof t=="string"&&(t=Ot.from(t,i)),vl(t))return t.length===0?-1:_6(e,t,o,i,c);if(typeof t=="number")return t&=255,Ot.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?c?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):_6(e,[t],o,i,c);throw new TypeError("val must be string, number or Buffer")}function _6(e,t,o,i,c){var u,f=1,p=e.length,m=t.length;if(i!==void 0&&((i=String(i).toLowerCase())==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(e.length<2||t.length<2)return-1;f=2,p/=2,m/=2,o/=2}function _(M,R){return f===1?M[R]:M.readUInt16BE(R*f)}if(c){var b=-1;for(u=o;u<p;u++)if(_(e,u)===_(t,b===-1?0:u-b)){if(b===-1&&(b=u),u-b+1===m)return b*f}else b!==-1&&(u-=u-b),b=-1}else for(o+m>p&&(o=p-m),u=o;u>=0;u--){for(var S=!0,T=0;T<m;T++)if(_(e,u+T)!==_(t,T)){S=!1;break}if(S)return u}return-1}function vce(e,t,o,i){o=Number(o)||0;var c=e.length-o;i?(i=Number(i))>c&&(i=c):i=c;var u=t.length;if(u%2!=0)throw new TypeError("Invalid hex string");i>u/2&&(i=u/2);for(var f=0;f<i;++f){var p=parseInt(t.substr(2*f,2),16);if(isNaN(p))return f;e[o+f]=p}return f}function _ce(e,t,o,i){return QE(dE(t,e.length-o),e,o,i)}function r7(e,t,o,i){return QE(function(c){for(var u=[],f=0;f<c.length;++f)u.push(255&c.charCodeAt(f));return u}(t),e,o,i)}function yce(e,t,o,i){return r7(e,t,o,i)}function Ice(e,t,o,i){return QE(a7(t),e,o,i)}function bce(e,t,o,i){return QE(function(c,u){for(var f,p,m,_=[],b=0;b<c.length&&!((u-=2)<0);++b)f=c.charCodeAt(b),p=f>>8,m=f%256,_.push(m),_.push(p);return _}(t,e.length-o),e,o,i)}function Cce(e,t,o){return t===0&&o===e.length?m6(e):m6(e.slice(t,o))}function i7(e,t,o){o=Math.min(e.length,o);for(var i=[],c=t;c<o;){var u,f,p,m,_=e[c],b=null,S=_>239?4:_>223?3:_>191?2:1;if(c+S<=o)switch(S){case 1:_<128&&(b=_);break;case 2:(192&(u=e[c+1]))==128&&(m=(31&_)<<6|63&u)>127&&(b=m);break;case 3:u=e[c+1],f=e[c+2],(192&u)==128&&(192&f)==128&&(m=(15&_)<<12|(63&u)<<6|63&f)>2047&&(m<55296||m>57343)&&(b=m);break;case 4:u=e[c+1],f=e[c+2],p=e[c+3],(192&u)==128&&(192&f)==128&&(192&p)==128&&(m=(15&_)<<18|(63&u)<<12|(63&f)<<6|63&p)>65535&&m<1114112&&(b=m)}b===null?(b=65533,S=1):b>65535&&(b-=65536,i.push(b>>>10&1023|55296),b=56320|1023&b),i.push(b),c+=S}return function(T){var M=T.length;if(M<=y6)return String.fromCharCode.apply(String,T);for(var R="",E=0;E<M;)R+=String.fromCharCode.apply(String,T.slice(E,E+=y6));return R}(i)}Ot.TYPED_ARRAY_SUPPORT=mm.TYPED_ARRAY_SUPPORT===void 0||mm.TYPED_ARRAY_SUPPORT,Ot.poolSize=8192,Ot._augment=function(e){return e.__proto__=Ot.prototype,e},Ot.from=function(e,t,o){return t7(null,e,t,o)},Ot.TYPED_ARRAY_SUPPORT&&(Ot.prototype.__proto__=Uint8Array.prototype,Ot.__proto__=Uint8Array),Ot.alloc=function(e,t,o){return function(i,c,u,f){return n7(c),c<=0?Cc(i,c):u!==void 0?typeof f=="string"?Cc(i,c).fill(u,f):Cc(i,c).fill(u):Cc(i,c)}(null,e,t,o)},Ot.allocUnsafe=function(e){return LD(null,e)},Ot.allocUnsafeSlow=function(e){return LD(null,e)},Ot.isBuffer=iI,Ot.compare=function(e,t){if(!vl(e)||!vl(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var o=e.length,i=t.length,c=0,u=Math.min(o,i);c<u;++c)if(e[c]!==t[c]){o=e[c],i=t[c];break}return o<i?-1:i<o?1:0},Ot.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ot.concat=function(e,t){if(!e7(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return Ot.alloc(0);var o;if(t===void 0)for(t=0,o=0;o<e.length;++o)t+=e[o].length;var i=Ot.allocUnsafe(t),c=0;for(o=0;o<e.length;++o){var u=e[o];if(!vl(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,c),c+=u.length}return i},Ot.byteLength=o7,Ot.prototype._isBuffer=!0,Ot.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)lf(this,t,t+1);return this},Ot.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)lf(this,t,t+3),lf(this,t+1,t+2);return this},Ot.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)lf(this,t,t+7),lf(this,t+1,t+6),lf(this,t+2,t+5),lf(this,t+3,t+4);return this},Ot.prototype.toString=function(){var e=0|this.length;return e===0?"":arguments.length===0?i7(this,0,e):mce.apply(this,arguments)},Ot.prototype.equals=function(e){if(!vl(e))throw new TypeError("Argument must be a Buffer");return this===e||Ot.compare(this,e)===0},Ot.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Ot.prototype.compare=function(e,t,o,i,c){if(!vl(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),o===void 0&&(o=e?e.length:0),i===void 0&&(i=0),c===void 0&&(c=this.length),t<0||o>e.length||i<0||c>this.length)throw new RangeError("out of range index");if(i>=c&&t>=o)return 0;if(i>=c)return-1;if(t>=o)return 1;if(this===e)return 0;for(var u=(c>>>=0)-(i>>>=0),f=(o>>>=0)-(t>>>=0),p=Math.min(u,f),m=this.slice(i,c),_=e.slice(t,o),b=0;b<p;++b)if(m[b]!==_[b]){u=m[b],f=_[b];break}return u<f?-1:f<u?1:0},Ot.prototype.includes=function(e,t,o){return this.indexOf(e,t,o)!==-1},Ot.prototype.indexOf=function(e,t,o){return v6(this,e,t,o,!0)},Ot.prototype.lastIndexOf=function(e,t,o){return v6(this,e,t,o,!1)},Ot.prototype.write=function(e,t,o,i){if(t===void 0)i="utf8",o=this.length,t=0;else if(o===void 0&&typeof t=="string")i=t,o=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(o)?(o|=0,i===void 0&&(i="utf8")):(i=o,o=void 0)}var c=this.length-t;if((o===void 0||o>c)&&(o=c),e.length>0&&(o<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var u=!1;;)switch(i){case"hex":return vce(this,e,t,o);case"utf8":case"utf-8":return _ce(this,e,t,o);case"ascii":return r7(this,e,t,o);case"latin1":case"binary":return yce(this,e,t,o);case"base64":return Ice(this,e,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return bce(this,e,t,o);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),u=!0}},Ot.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var y6=4096;function Sce(e,t,o){var i="";o=Math.min(e.length,o);for(var c=t;c<o;++c)i+=String.fromCharCode(127&e[c]);return i}function Tce(e,t,o){var i="";o=Math.min(e.length,o);for(var c=t;c<o;++c)i+=String.fromCharCode(e[c]);return i}function Ece(e,t,o){var i=e.length;(!t||t<0)&&(t=0),(!o||o<0||o>i)&&(o=i);for(var c="",u=t;u<o;++u)c+=Ace(e[u]);return c}function Mce(e,t,o){for(var i=e.slice(t,o),c="",u=0;u<i.length;u+=2)c+=String.fromCharCode(i[u]+256*i[u+1]);return c}function Xr(e,t,o){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>o)throw new RangeError("Trying to access beyond buffer length")}function Qi(e,t,o,i,c,u){if(!vl(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>c||t<u)throw new RangeError('"value" argument is out of bounds');if(o+i>e.length)throw new RangeError("Index out of range")}function WS(e,t,o,i){t<0&&(t=65535+t+1);for(var c=0,u=Math.min(e.length-o,2);c<u;++c)e[o+c]=(t&255<<8*(i?c:1-c))>>>8*(i?c:1-c)}function jS(e,t,o,i){t<0&&(t=4294967295+t+1);for(var c=0,u=Math.min(e.length-o,4);c<u;++c)e[o+c]=t>>>8*(i?c:3-c)&255}function s7(e,t,o,i,c,u){if(o+i>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function I6(e,t,o,i,c){return c||s7(e,0,o,4),ZH(e,t,o,i,23,4),o+4}function b6(e,t,o,i,c){return c||s7(e,0,o,8),ZH(e,t,o,i,52,8),o+8}Ot.prototype.slice=function(e,t){var o,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=t===void 0?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),Ot.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=Ot.prototype;else{var c=t-e;o=new Ot(c,void 0);for(var u=0;u<c;++u)o[u]=this[u+e]}return o},Ot.prototype.readUIntLE=function(e,t,o){e|=0,t|=0,o||Xr(e,t,this.length);for(var i=this[e],c=1,u=0;++u<t&&(c*=256);)i+=this[e+u]*c;return i},Ot.prototype.readUIntBE=function(e,t,o){e|=0,t|=0,o||Xr(e,t,this.length);for(var i=this[e+--t],c=1;t>0&&(c*=256);)i+=this[e+--t]*c;return i},Ot.prototype.readUInt8=function(e,t){return t||Xr(e,1,this.length),this[e]},Ot.prototype.readUInt16LE=function(e,t){return t||Xr(e,2,this.length),this[e]|this[e+1]<<8},Ot.prototype.readUInt16BE=function(e,t){return t||Xr(e,2,this.length),this[e]<<8|this[e+1]},Ot.prototype.readUInt32LE=function(e,t){return t||Xr(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ot.prototype.readUInt32BE=function(e,t){return t||Xr(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ot.prototype.readIntLE=function(e,t,o){e|=0,t|=0,o||Xr(e,t,this.length);for(var i=this[e],c=1,u=0;++u<t&&(c*=256);)i+=this[e+u]*c;return i>=(c*=128)&&(i-=Math.pow(2,8*t)),i},Ot.prototype.readIntBE=function(e,t,o){e|=0,t|=0,o||Xr(e,t,this.length);for(var i=t,c=1,u=this[e+--i];i>0&&(c*=256);)u+=this[e+--i]*c;return u>=(c*=128)&&(u-=Math.pow(2,8*t)),u},Ot.prototype.readInt8=function(e,t){return t||Xr(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ot.prototype.readInt16LE=function(e,t){t||Xr(e,2,this.length);var o=this[e]|this[e+1]<<8;return 32768&o?4294901760|o:o},Ot.prototype.readInt16BE=function(e,t){t||Xr(e,2,this.length);var o=this[e+1]|this[e]<<8;return 32768&o?4294901760|o:o},Ot.prototype.readInt32LE=function(e,t){return t||Xr(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ot.prototype.readInt32BE=function(e,t){return t||Xr(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ot.prototype.readFloatLE=function(e,t){return t||Xr(e,4,this.length),zS(this,e,!0,23,4)},Ot.prototype.readFloatBE=function(e,t){return t||Xr(e,4,this.length),zS(this,e,!1,23,4)},Ot.prototype.readDoubleLE=function(e,t){return t||Xr(e,8,this.length),zS(this,e,!0,52,8)},Ot.prototype.readDoubleBE=function(e,t){return t||Xr(e,8,this.length),zS(this,e,!1,52,8)},Ot.prototype.writeUIntLE=function(e,t,o,i){e=+e,t|=0,o|=0,i||Qi(this,e,t,o,Math.pow(2,8*o)-1,0);var c=1,u=0;for(this[t]=255&e;++u<o&&(c*=256);)this[t+u]=e/c&255;return t+o},Ot.prototype.writeUIntBE=function(e,t,o,i){e=+e,t|=0,o|=0,i||Qi(this,e,t,o,Math.pow(2,8*o)-1,0);var c=o-1,u=1;for(this[t+c]=255&e;--c>=0&&(u*=256);)this[t+c]=e/u&255;return t+o},Ot.prototype.writeUInt8=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,1,255,0),Ot.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Ot.prototype.writeUInt16LE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,2,65535,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):WS(this,e,t,!0),t+2},Ot.prototype.writeUInt16BE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,2,65535,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):WS(this,e,t,!1),t+2},Ot.prototype.writeUInt32LE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,4,4294967295,0),Ot.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):jS(this,e,t,!0),t+4},Ot.prototype.writeUInt32BE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,4,4294967295,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):jS(this,e,t,!1),t+4},Ot.prototype.writeIntLE=function(e,t,o,i){if(e=+e,t|=0,!i){var c=Math.pow(2,8*o-1);Qi(this,e,t,o,c-1,-c)}var u=0,f=1,p=0;for(this[t]=255&e;++u<o&&(f*=256);)e<0&&p===0&&this[t+u-1]!==0&&(p=1),this[t+u]=(e/f>>0)-p&255;return t+o},Ot.prototype.writeIntBE=function(e,t,o,i){if(e=+e,t|=0,!i){var c=Math.pow(2,8*o-1);Qi(this,e,t,o,c-1,-c)}var u=o-1,f=1,p=0;for(this[t+u]=255&e;--u>=0&&(f*=256);)e<0&&p===0&&this[t+u+1]!==0&&(p=1),this[t+u]=(e/f>>0)-p&255;return t+o},Ot.prototype.writeInt8=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,1,127,-128),Ot.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ot.prototype.writeInt16LE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,2,32767,-32768),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):WS(this,e,t,!0),t+2},Ot.prototype.writeInt16BE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,2,32767,-32768),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):WS(this,e,t,!1),t+2},Ot.prototype.writeInt32LE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,4,2147483647,-2147483648),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):jS(this,e,t,!0),t+4},Ot.prototype.writeInt32BE=function(e,t,o){return e=+e,t|=0,o||Qi(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):jS(this,e,t,!1),t+4},Ot.prototype.writeFloatLE=function(e,t,o){return I6(this,e,t,!0,o)},Ot.prototype.writeFloatBE=function(e,t,o){return I6(this,e,t,!1,o)},Ot.prototype.writeDoubleLE=function(e,t,o){return b6(this,e,t,!0,o)},Ot.prototype.writeDoubleBE=function(e,t,o){return b6(this,e,t,!1,o)},Ot.prototype.copy=function(e,t,o,i){if(o||(o=0),i||i===0||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<o&&(i=o),i===o||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-o&&(i=e.length-t+o);var c,u=i-o;if(this===e&&o<t&&t<i)for(c=u-1;c>=0;--c)e[c+t]=this[c+o];else if(u<1e3||!Ot.TYPED_ARRAY_SUPPORT)for(c=0;c<u;++c)e[c+t]=this[c+o];else Uint8Array.prototype.set.call(e,this.subarray(o,o+u),t);return u},Ot.prototype.fill=function(e,t,o,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,o=this.length):typeof o=="string"&&(i=o,o=this.length),e.length===1){var c=e.charCodeAt(0);c<256&&(e=c)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!Ot.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e&=255);if(t<0||this.length<t||this.length<o)throw new RangeError("Out of range index");if(o<=t)return this;var u;if(t>>>=0,o=o===void 0?this.length:o>>>0,e||(e=0),typeof e=="number")for(u=t;u<o;++u)this[u]=e;else{var f=vl(e)?e:dE(new Ot(e,i).toString()),p=f.length;for(u=0;u<o-t;++u)this[u+t]=f[u%p]}return this};var kce=/[^+\/0-9A-Za-z-_]/g;function Ace(e){return e<16?"0"+e.toString(16):e.toString(16)}function dE(e,t){var o;t=t||1/0;for(var i=e.length,c=null,u=[],f=0;f<i;++f){if((o=e.charCodeAt(f))>55295&&o<57344){if(!c){if(o>56319){(t-=3)>-1&&u.push(239,191,189);continue}if(f+1===i){(t-=3)>-1&&u.push(239,191,189);continue}c=o;continue}if(o<56320){(t-=3)>-1&&u.push(239,191,189),c=o;continue}o=65536+(c-55296<<10|o-56320)}else c&&(t-=3)>-1&&u.push(239,191,189);if(c=null,o<128){if((t-=1)<0)break;u.push(o)}else if(o<2048){if((t-=2)<0)break;u.push(o>>6|192,63&o|128)}else if(o<65536){if((t-=3)<0)break;u.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;u.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return u}function a7(e){return function(t){var o,i,c,u,f,p;TN||QH();var m=t.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");f=t[m-2]==="="?2:t[m-1]==="="?1:0,p=new fce(3*m/4-f),c=f>0?m-4:m;var _=0;for(o=0,i=0;o<c;o+=4,i+=3)u=qs[t.charCodeAt(o)]<<18|qs[t.charCodeAt(o+1)]<<12|qs[t.charCodeAt(o+2)]<<6|qs[t.charCodeAt(o+3)],p[_++]=u>>16&255,p[_++]=u>>8&255,p[_++]=255&u;return f===2?(u=qs[t.charCodeAt(o)]<<2|qs[t.charCodeAt(o+1)]>>4,p[_++]=255&u):f===1&&(u=qs[t.charCodeAt(o)]<<10|qs[t.charCodeAt(o+1)]<<4|qs[t.charCodeAt(o+2)]>>2,p[_++]=u>>8&255,p[_++]=255&u),p}(function(t){if((t=function(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}(t).replace(kce,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(e))}function QE(e,t,o,i){for(var c=0;c<i&&!(c+o>=t.length||c>=e.length);++c)t[c+o]=e[c];return c}function iI(e){return e!=null&&(!!e._isBuffer||C6(e)||function(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&C6(t.slice(0,0))}(e))}function C6(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Eo(e,t){return e(t={exports:{}},t.exports),t.exports}var Ao=Eo(function(e,t){var o;e.exports=(o=o||function(i,c){var u=Object.create||function(){function N(){}return function(D){var x;return N.prototype=D,x=new N,N.prototype=null,x}}(),f={},p=f.lib={},m=p.Base={extend:function(N){var D=u(this);return N&&D.mixIn(N),D.hasOwnProperty("init")&&this.init!==D.init||(D.init=function(){D.$super.init.apply(this,arguments)}),D.init.prototype=D,D.$super=this,D},create:function(){var N=this.extend();return N.init.apply(N,arguments),N},init:function(){},mixIn:function(N){for(var D in N)N.hasOwnProperty(D)&&(this[D]=N[D]);N.hasOwnProperty("toString")&&(this.toString=N.toString)},clone:function(){return this.init.prototype.extend(this)}},_=p.WordArray=m.extend({init:function(N,D){N=this.words=N||[],this.sigBytes=D??4*N.length},toString:function(N){return(N||S).stringify(this)},concat:function(N){var D=this.words,x=N.words,L=this.sigBytes,F=N.sigBytes;if(this.clamp(),L%4)for(var H=0;H<F;H++){var B=x[H>>>2]>>>24-H%4*8&255;D[L+H>>>2]|=B<<24-(L+H)%4*8}else for(var H=0;H<F;H+=4)D[L+H>>>2]=x[H>>>2];return this.sigBytes+=F,this},clamp:function(){var N=this.words,D=this.sigBytes;N[D>>>2]&=4294967295<<32-D%4*8,N.length=i.ceil(D/4)},clone:function(){var N=m.clone.call(this);return N.words=this.words.slice(0),N},random:function(N){for(var D,x=[],L=function(z){var z=z,W=987654321,Z=4294967295;return function(){var $=((W=36969*(65535&W)+(W>>16)&Z)<<16)+(z=18e3*(65535&z)+(z>>16)&Z)&Z;return $/=4294967296,($+=.5)*(i.random()>.5?1:-1)}},F=0;F<N;F+=4){var H=L(4294967296*(D||i.random()));D=987654071*H(),x.push(4294967296*H()|0)}return new _.init(x,N)}}),b=f.enc={},S=b.Hex={stringify:function(N){for(var D=N.words,x=N.sigBytes,L=[],F=0;F<x;F++){var H=D[F>>>2]>>>24-F%4*8&255;L.push((H>>>4).toString(16)),L.push((15&H).toString(16))}return L.join("")},parse:function(N){for(var D=N.length,x=[],L=0;L<D;L+=2)x[L>>>3]|=parseInt(N.substr(L,2),16)<<24-L%8*4;return new _.init(x,D/2)}},T=b.Latin1={stringify:function(N){for(var D=N.words,x=N.sigBytes,L=[],F=0;F<x;F++){var H=D[F>>>2]>>>24-F%4*8&255;L.push(String.fromCharCode(H))}return L.join("")},parse:function(N){for(var D=N.length,x=[],L=0;L<D;L++)x[L>>>2]|=(255&N.charCodeAt(L))<<24-L%4*8;return new _.init(x,D)}},M=b.Utf8={stringify:function(N){try{return decodeURIComponent(escape(T.stringify(N)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(N){return T.parse(unescape(encodeURIComponent(N)))}},R=p.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new _.init,this._nDataBytes=0},_append:function(N){typeof N=="string"&&(N=M.parse(N)),this._data.concat(N),this._nDataBytes+=N.sigBytes},_process:function(N){var D=this._data,x=D.words,L=D.sigBytes,F=this.blockSize,H=4*F,B=L/H,z=(B=N?i.ceil(B):i.max((0|B)-this._minBufferSize,0))*F,W=i.min(4*z,L);if(z){for(var Z=0;Z<z;Z+=F)this._doProcessBlock(x,Z);var $=x.splice(0,z);D.sigBytes-=W}return new _.init($,W)},clone:function(){var N=m.clone.call(this);return N._data=this._data.clone(),N},_minBufferSize:0}),E=(p.Hasher=R.extend({cfg:m.extend(),init:function(N){this.cfg=this.cfg.extend(N),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(N){return this._append(N),this._process(),this},finalize:function(N){N&&this._append(N);var D=this._doFinalize();return D},blockSize:16,_createHelper:function(N){return function(D,x){return new N.init(x).finalize(D)}},_createHmacHelper:function(N){return function(D,x){return new E.HMAC.init(N,x).finalize(D)}}}),f.algo={});return f}(Math),o)}),S6=(Eo(function(e,t){var o,i,c,u,f,p;e.exports=(c=(i=o=Ao).lib,u=c.Base,f=c.WordArray,(p=i.x64={}).Word=u.extend({init:function(m,_){this.high=m,this.low=_}}),p.WordArray=u.extend({init:function(m,_){m=this.words=m||[],this.sigBytes=_??8*m.length},toX32:function(){for(var m=this.words,_=m.length,b=[],S=0;S<_;S++){var T=m[S];b.push(T.high),b.push(T.low)}return f.create(b,this.sigBytes)},clone:function(){for(var m=u.clone.call(this),_=m.words=this.words.slice(0),b=_.length,S=0;S<b;S++)_[S]=_[S].clone();return m}}),o)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){if(typeof ArrayBuffer=="function"){var i=o.lib.WordArray,c=i.init;(i.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var f=u.byteLength,p=[],m=0;m<f;m++)p[m>>>2]|=u[m]<<24-m%4*8;c.call(this,p,f)}else c.apply(this,arguments)}).prototype=i}}(),o.lib.WordArray)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.WordArray,u=i.enc;function f(p){return p<<8&4278255360|p>>>8&16711935}u.Utf16=u.Utf16BE={stringify:function(p){for(var m=p.words,_=p.sigBytes,b=[],S=0;S<_;S+=2){var T=m[S>>>2]>>>16-S%4*8&65535;b.push(String.fromCharCode(T))}return b.join("")},parse:function(p){for(var m=p.length,_=[],b=0;b<m;b++)_[b>>>1]|=p.charCodeAt(b)<<16-b%2*16;return c.create(_,2*m)}},u.Utf16LE={stringify:function(p){for(var m=p.words,_=p.sigBytes,b=[],S=0;S<_;S+=2){var T=f(m[S>>>2]>>>16-S%4*8&65535);b.push(String.fromCharCode(T))}return b.join("")},parse:function(p){for(var m=p.length,_=[],b=0;b<m;b++)_[b>>>1]|=f(p.charCodeAt(b)<<16-b%2*16);return c.create(_,2*m)}}}(),o.enc.Utf16)}),Eo(function(e,t){var o,i,c;e.exports=(c=(i=o=Ao).lib.WordArray,i.enc.Base64={stringify:function(u){var f=u.words,p=u.sigBytes,m=this._map;u.clamp();for(var _=[],b=0;b<p;b+=3)for(var S=(f[b>>>2]>>>24-b%4*8&255)<<16|(f[b+1>>>2]>>>24-(b+1)%4*8&255)<<8|f[b+2>>>2]>>>24-(b+2)%4*8&255,T=0;T<4&&b+.75*T<p;T++)_.push(m.charAt(S>>>6*(3-T)&63));var M=m.charAt(64);if(M)for(;_.length%4;)_.push(M);return _.join("")},parse:function(u){var f=u.length,p=this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var _=0;_<p.length;_++)m[p.charCodeAt(_)]=_}var b=p.charAt(64);if(b){var S=u.indexOf(b);S!==-1&&(f=S)}return function(T,M,R){for(var E=[],N=0,D=0;D<M;D++)if(D%4){var x=R[T.charCodeAt(D-1)]<<D%4*2,L=R[T.charCodeAt(D)]>>>6-D%4*2;E[N>>>2]|=(x|L)<<24-N%4*8,N++}return c.create(E,N)}(u,f,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,m=c.algo,_=[];(function(){for(var E=0;E<64;E++)_[E]=4294967296*i.abs(i.sin(E+1))|0})();var b=m.MD5=p.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(E,N){for(var D=0;D<16;D++){var x=N+D,L=E[x];E[x]=16711935&(L<<8|L>>>24)|4278255360&(L<<24|L>>>8)}var F=this._hash.words,H=E[N+0],B=E[N+1],z=E[N+2],W=E[N+3],Z=E[N+4],$=E[N+5],O=E[N+6],X=E[N+7],le=E[N+8],de=E[N+9],he=E[N+10],se=E[N+11],ie=E[N+12],oe=E[N+13],ee=E[N+14],Q=E[N+15],ue=F[0],me=F[1],be=F[2],ke=F[3];ue=S(ue,me,be,ke,H,7,_[0]),ke=S(ke,ue,me,be,B,12,_[1]),be=S(be,ke,ue,me,z,17,_[2]),me=S(me,be,ke,ue,W,22,_[3]),ue=S(ue,me,be,ke,Z,7,_[4]),ke=S(ke,ue,me,be,$,12,_[5]),be=S(be,ke,ue,me,O,17,_[6]),me=S(me,be,ke,ue,X,22,_[7]),ue=S(ue,me,be,ke,le,7,_[8]),ke=S(ke,ue,me,be,de,12,_[9]),be=S(be,ke,ue,me,he,17,_[10]),me=S(me,be,ke,ue,se,22,_[11]),ue=S(ue,me,be,ke,ie,7,_[12]),ke=S(ke,ue,me,be,oe,12,_[13]),be=S(be,ke,ue,me,ee,17,_[14]),ue=T(ue,me=S(me,be,ke,ue,Q,22,_[15]),be,ke,B,5,_[16]),ke=T(ke,ue,me,be,O,9,_[17]),be=T(be,ke,ue,me,se,14,_[18]),me=T(me,be,ke,ue,H,20,_[19]),ue=T(ue,me,be,ke,$,5,_[20]),ke=T(ke,ue,me,be,he,9,_[21]),be=T(be,ke,ue,me,Q,14,_[22]),me=T(me,be,ke,ue,Z,20,_[23]),ue=T(ue,me,be,ke,de,5,_[24]),ke=T(ke,ue,me,be,ee,9,_[25]),be=T(be,ke,ue,me,W,14,_[26]),me=T(me,be,ke,ue,le,20,_[27]),ue=T(ue,me,be,ke,oe,5,_[28]),ke=T(ke,ue,me,be,z,9,_[29]),be=T(be,ke,ue,me,X,14,_[30]),ue=M(ue,me=T(me,be,ke,ue,ie,20,_[31]),be,ke,$,4,_[32]),ke=M(ke,ue,me,be,le,11,_[33]),be=M(be,ke,ue,me,se,16,_[34]),me=M(me,be,ke,ue,ee,23,_[35]),ue=M(ue,me,be,ke,B,4,_[36]),ke=M(ke,ue,me,be,Z,11,_[37]),be=M(be,ke,ue,me,X,16,_[38]),me=M(me,be,ke,ue,he,23,_[39]),ue=M(ue,me,be,ke,oe,4,_[40]),ke=M(ke,ue,me,be,H,11,_[41]),be=M(be,ke,ue,me,W,16,_[42]),me=M(me,be,ke,ue,O,23,_[43]),ue=M(ue,me,be,ke,de,4,_[44]),ke=M(ke,ue,me,be,ie,11,_[45]),be=M(be,ke,ue,me,Q,16,_[46]),ue=R(ue,me=M(me,be,ke,ue,z,23,_[47]),be,ke,H,6,_[48]),ke=R(ke,ue,me,be,X,10,_[49]),be=R(be,ke,ue,me,ee,15,_[50]),me=R(me,be,ke,ue,$,21,_[51]),ue=R(ue,me,be,ke,ie,6,_[52]),ke=R(ke,ue,me,be,W,10,_[53]),be=R(be,ke,ue,me,he,15,_[54]),me=R(me,be,ke,ue,B,21,_[55]),ue=R(ue,me,be,ke,le,6,_[56]),ke=R(ke,ue,me,be,Q,10,_[57]),be=R(be,ke,ue,me,O,15,_[58]),me=R(me,be,ke,ue,oe,21,_[59]),ue=R(ue,me,be,ke,Z,6,_[60]),ke=R(ke,ue,me,be,se,10,_[61]),be=R(be,ke,ue,me,z,15,_[62]),me=R(me,be,ke,ue,de,21,_[63]),F[0]=F[0]+ue|0,F[1]=F[1]+me|0,F[2]=F[2]+be|0,F[3]=F[3]+ke|0},_doFinalize:function(){var E=this._data,N=E.words,D=8*this._nDataBytes,x=8*E.sigBytes;N[x>>>5]|=128<<24-x%32;var L=i.floor(D/4294967296),F=D;N[15+(x+64>>>9<<4)]=16711935&(L<<8|L>>>24)|4278255360&(L<<24|L>>>8),N[14+(x+64>>>9<<4)]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),E.sigBytes=4*(N.length+1),this._process();for(var H=this._hash,B=H.words,z=0;z<4;z++){var W=B[z];B[z]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8)}return H},clone:function(){var E=p.clone.call(this);return E._hash=this._hash.clone(),E}});function S(E,N,D,x,L,F,H){var B=E+(N&D|~N&x)+L+H;return(B<<F|B>>>32-F)+N}function T(E,N,D,x,L,F,H){var B=E+(N&x|D&~x)+L+H;return(B<<F|B>>>32-F)+N}function M(E,N,D,x,L,F,H){var B=E+(N^D^x)+L+H;return(B<<F|B>>>32-F)+N}function R(E,N,D,x,L,F,H){var B=E+(D^(N|~x))+L+H;return(B<<F|B>>>32-F)+N}c.MD5=p._createHelper(b),c.HmacMD5=p._createHmacHelper(b)}(Math),o.MD5)}),Eo(function(e,t){var o,i,c,u,f,p,m,_;e.exports=(c=(i=o=Ao).lib,u=c.WordArray,f=c.Hasher,p=i.algo,m=[],_=p.SHA1=f.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(b,S){for(var T=this._hash.words,M=T[0],R=T[1],E=T[2],N=T[3],D=T[4],x=0;x<80;x++){if(x<16)m[x]=0|b[S+x];else{var L=m[x-3]^m[x-8]^m[x-14]^m[x-16];m[x]=L<<1|L>>>31}var F=(M<<5|M>>>27)+D+m[x];F+=x<20?1518500249+(R&E|~R&N):x<40?1859775393+(R^E^N):x<60?(R&E|R&N|E&N)-1894007588:(R^E^N)-899497514,D=N,N=E,E=R<<30|R>>>2,R=M,M=F}T[0]=T[0]+M|0,T[1]=T[1]+R|0,T[2]=T[2]+E|0,T[3]=T[3]+N|0,T[4]=T[4]+D|0},_doFinalize:function(){var b=this._data,S=b.words,T=8*this._nDataBytes,M=8*b.sigBytes;return S[M>>>5]|=128<<24-M%32,S[14+(M+64>>>9<<4)]=Math.floor(T/4294967296),S[15+(M+64>>>9<<4)]=T,b.sigBytes=4*S.length,this._process(),this._hash},clone:function(){var b=f.clone.call(this);return b._hash=this._hash.clone(),b}}),i.SHA1=f._createHelper(_),i.HmacSHA1=f._createHmacHelper(_),o.SHA1)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,m=c.algo,_=[],b=[];(function(){function M(D){for(var x=i.sqrt(D),L=2;L<=x;L++)if(!(D%L))return!1;return!0}function R(D){return 4294967296*(D-(0|D))|0}for(var E=2,N=0;N<64;)M(E)&&(N<8&&(_[N]=R(i.pow(E,.5))),b[N]=R(i.pow(E,1/3)),N++),E++})();var S=[],T=m.SHA256=p.extend({_doReset:function(){this._hash=new f.init(_.slice(0))},_doProcessBlock:function(M,R){for(var E=this._hash.words,N=E[0],D=E[1],x=E[2],L=E[3],F=E[4],H=E[5],B=E[6],z=E[7],W=0;W<64;W++){if(W<16)S[W]=0|M[R+W];else{var Z=S[W-15],$=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,O=S[W-2],X=(O<<15|O>>>17)^(O<<13|O>>>19)^O>>>10;S[W]=$+S[W-7]+X+S[W-16]}var le=N&D^N&x^D&x,de=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),he=z+((F<<26|F>>>6)^(F<<21|F>>>11)^(F<<7|F>>>25))+(F&H^~F&B)+b[W]+S[W];z=B,B=H,H=F,F=L+he|0,L=x,x=D,D=N,N=he+(de+le)|0}E[0]=E[0]+N|0,E[1]=E[1]+D|0,E[2]=E[2]+x|0,E[3]=E[3]+L|0,E[4]=E[4]+F|0,E[5]=E[5]+H|0,E[6]=E[6]+B|0,E[7]=E[7]+z|0},_doFinalize:function(){var M=this._data,R=M.words,E=8*this._nDataBytes,N=8*M.sigBytes;return R[N>>>5]|=128<<24-N%32,R[14+(N+64>>>9<<4)]=i.floor(E/4294967296),R[15+(N+64>>>9<<4)]=E,M.sigBytes=4*R.length,this._process(),this._hash},clone:function(){var M=p.clone.call(this);return M._hash=this._hash.clone(),M}});c.SHA256=p._createHelper(T),c.HmacSHA256=p._createHmacHelper(T)}(Math),o.SHA256)}),Eo(function(e,t){var o,i,c,u,f,p;e.exports=(c=(i=o=Ao).lib.WordArray,u=i.algo,f=u.SHA256,p=u.SHA224=f.extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var m=f._doFinalize.call(this);return m.sigBytes-=4,m}}),i.SHA224=f._createHelper(p),i.HmacSHA224=f._createHmacHelper(p),o.SHA224)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.Hasher,u=i.x64,f=u.Word,p=u.WordArray,m=i.algo;function _(){return f.create.apply(f,arguments)}var b=[_(1116352408,3609767458),_(1899447441,602891725),_(3049323471,3964484399),_(3921009573,2173295548),_(961987163,4081628472),_(1508970993,3053834265),_(2453635748,2937671579),_(2870763221,3664609560),_(3624381080,2734883394),_(310598401,1164996542),_(607225278,1323610764),_(1426881987,3590304994),_(1925078388,4068182383),_(2162078206,991336113),_(2614888103,633803317),_(3248222580,3479774868),_(3835390401,2666613458),_(4022224774,944711139),_(264347078,2341262773),_(604807628,2007800933),_(770255983,1495990901),_(1249150122,1856431235),_(1555081692,3175218132),_(1996064986,2198950837),_(2554220882,3999719339),_(2821834349,766784016),_(2952996808,2566594879),_(3210313671,3203337956),_(3336571891,1034457026),_(3584528711,2466948901),_(113926993,3758326383),_(338241895,168717936),_(666307205,1188179964),_(773529912,1546045734),_(1294757372,1522805485),_(1396182291,2643833823),_(1695183700,2343527390),_(1986661051,1014477480),_(2177026350,1206759142),_(2456956037,344077627),_(2730485921,1290863460),_(2820302411,3158454273),_(3259730800,3505952657),_(3345764771,106217008),_(3516065817,3606008344),_(3600352804,1432725776),_(4094571909,1467031594),_(275423344,851169720),_(430227734,3100823752),_(506948616,1363258195),_(659060556,3750685593),_(883997877,3785050280),_(958139571,3318307427),_(1322822218,3812723403),_(1537002063,2003034995),_(1747873779,3602036899),_(1955562222,1575990012),_(2024104815,1125592928),_(2227730452,2716904306),_(2361852424,442776044),_(2428436474,593698344),_(2756734187,3733110249),_(3204031479,2999351573),_(3329325298,3815920427),_(3391569614,3928383900),_(3515267271,566280711),_(3940187606,3454069534),_(4118630271,4000239992),_(116418474,1914138554),_(174292421,2731055270),_(289380356,3203993006),_(460393269,320620315),_(685471733,587496836),_(852142971,1086792851),_(1017036298,365543100),_(1126000580,2618297676),_(1288033470,3409855158),_(1501505948,4234509866),_(1607167915,987167468),_(1816402316,1246189591)],S=[];(function(){for(var M=0;M<80;M++)S[M]=_()})();var T=m.SHA512=c.extend({_doReset:function(){this._hash=new p.init([new f.init(1779033703,4089235720),new f.init(3144134277,2227873595),new f.init(1013904242,4271175723),new f.init(2773480762,1595750129),new f.init(1359893119,2917565137),new f.init(2600822924,725511199),new f.init(528734635,4215389547),new f.init(1541459225,327033209)])},_doProcessBlock:function(M,R){for(var E=this._hash.words,N=E[0],D=E[1],x=E[2],L=E[3],F=E[4],H=E[5],B=E[6],z=E[7],W=N.high,Z=N.low,$=D.high,O=D.low,X=x.high,le=x.low,de=L.high,he=L.low,se=F.high,ie=F.low,oe=H.high,ee=H.low,Q=B.high,ue=B.low,me=z.high,be=z.low,ke=W,Ye=Z,Oe=$,Ee=O,we=X,Ge=le,Ve=de,qe=he,st=se,Ie=ie,Ae=oe,xe=ee,ot=Q,je=ue,at=me,ht=be,dt=0;dt<80;dt++){var ft=S[dt];if(dt<16)var Je=ft.high=0|M[R+2*dt],Et=ft.low=0|M[R+2*dt+1];else{var Nt=S[dt-15],et=Nt.high,Mt=Nt.low,Jt=(et>>>1|Mt<<31)^(et>>>8|Mt<<24)^et>>>7,sn=(Mt>>>1|et<<31)^(Mt>>>8|et<<24)^(Mt>>>7|et<<25),gn=S[dt-2],Bt=gn.high,nt=gn.low,It=(Bt>>>19|nt<<13)^(Bt<<3|nt>>>29)^Bt>>>6,ct=(nt>>>19|Bt<<13)^(nt<<3|Bt>>>29)^(nt>>>6|Bt<<26),Ke=S[dt-7],Xe=Ke.high,Dt=Ke.low,$e=S[dt-16],xt=$e.high,jt=$e.low;Je=(Je=(Je=Jt+Xe+((Et=sn+Dt)>>>0<sn>>>0?1:0))+It+((Et+=ct)>>>0<ct>>>0?1:0))+xt+((Et+=jt)>>>0<jt>>>0?1:0),ft.high=Je,ft.low=Et}var Fn,oo=st&Ae^~st&ot,zn=Ie&xe^~Ie&je,kn=ke&Oe^ke&we^Oe&we,Po=Ye&Ee^Ye&Ge^Ee&Ge,q=(ke>>>28|Ye<<4)^(ke<<30|Ye>>>2)^(ke<<25|Ye>>>7),xo=(Ye>>>28|ke<<4)^(Ye<<30|ke>>>2)^(Ye<<25|ke>>>7),_n=(st>>>14|Ie<<18)^(st>>>18|Ie<<14)^(st<<23|Ie>>>9),eo=(Ie>>>14|st<<18)^(Ie>>>18|st<<14)^(Ie<<23|st>>>9),ls=b[dt],Ir=ls.high,ks=ls.low,sr=at+_n+((Fn=ht+eo)>>>0<ht>>>0?1:0),ca=xo+Po;at=ot,ht=je,ot=Ae,je=xe,Ae=st,xe=Ie,st=Ve+(sr=(sr=(sr=sr+oo+((Fn+=zn)>>>0<zn>>>0?1:0))+Ir+((Fn+=ks)>>>0<ks>>>0?1:0))+Je+((Fn+=Et)>>>0<Et>>>0?1:0))+((Ie=qe+Fn|0)>>>0<qe>>>0?1:0)|0,Ve=we,qe=Ge,we=Oe,Ge=Ee,Oe=ke,Ee=Ye,ke=sr+(q+kn+(ca>>>0<xo>>>0?1:0))+((Ye=Fn+ca|0)>>>0<Fn>>>0?1:0)|0}Z=N.low=Z+Ye,N.high=W+ke+(Z>>>0<Ye>>>0?1:0),O=D.low=O+Ee,D.high=$+Oe+(O>>>0<Ee>>>0?1:0),le=x.low=le+Ge,x.high=X+we+(le>>>0<Ge>>>0?1:0),he=L.low=he+qe,L.high=de+Ve+(he>>>0<qe>>>0?1:0),ie=F.low=ie+Ie,F.high=se+st+(ie>>>0<Ie>>>0?1:0),ee=H.low=ee+xe,H.high=oe+Ae+(ee>>>0<xe>>>0?1:0),ue=B.low=ue+je,B.high=Q+ot+(ue>>>0<je>>>0?1:0),be=z.low=be+ht,z.high=me+at+(be>>>0<ht>>>0?1:0)},_doFinalize:function(){var M=this._data,R=M.words,E=8*this._nDataBytes,N=8*M.sigBytes;return R[N>>>5]|=128<<24-N%32,R[30+(N+128>>>10<<5)]=Math.floor(E/4294967296),R[31+(N+128>>>10<<5)]=E,M.sigBytes=4*R.length,this._process(),this._hash.toX32()},clone:function(){var M=c.clone.call(this);return M._hash=this._hash.clone(),M},blockSize:32});i.SHA512=c._createHelper(T),i.HmacSHA512=c._createHmacHelper(T)}(),o.SHA512)}),Eo(function(e,t){var o,i,c,u,f,p,m,_;e.exports=(c=(i=o=Ao).x64,u=c.Word,f=c.WordArray,p=i.algo,m=p.SHA512,_=p.SHA384=m.extend({_doReset:function(){this._hash=new f.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var b=m._doFinalize.call(this);return b.sigBytes-=16,b}}),i.SHA384=m._createHelper(_),i.HmacSHA384=m._createHmacHelper(_),o.SHA384)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,m=c.x64.Word,_=c.algo,b=[],S=[],T=[];(function(){for(var E=1,N=0,D=0;D<24;D++){b[E+5*N]=(D+1)*(D+2)/2%64;var x=(2*E+3*N)%5;E=N%5,N=x}for(E=0;E<5;E++)for(N=0;N<5;N++)S[E+5*N]=N+(2*E+3*N)%5*5;for(var L=1,F=0;F<24;F++){for(var H=0,B=0,z=0;z<7;z++){if(1&L){var W=(1<<z)-1;W<32?B^=1<<W:H^=1<<W-32}128&L?L=L<<1^113:L<<=1}T[F]=m.create(H,B)}})();var M=[];(function(){for(var E=0;E<25;E++)M[E]=m.create()})();var R=_.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var E=this._state=[],N=0;N<25;N++)E[N]=new m.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(E,N){for(var D=this._state,x=this.blockSize/2,L=0;L<x;L++){var F=E[N+2*L],H=E[N+2*L+1];F=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),H=16711935&(H<<8|H>>>24)|4278255360&(H<<24|H>>>8),(be=D[L]).high^=H,be.low^=F}for(var B=0;B<24;B++){for(var z=0;z<5;z++){for(var W=0,Z=0,$=0;$<5;$++)W^=(be=D[z+5*$]).high,Z^=be.low;var O=M[z];O.high=W,O.low=Z}for(z=0;z<5;z++){var X=M[(z+4)%5],le=M[(z+1)%5],de=le.high,he=le.low;for(W=X.high^(de<<1|he>>>31),Z=X.low^(he<<1|de>>>31),$=0;$<5;$++)(be=D[z+5*$]).high^=W,be.low^=Z}for(var se=1;se<25;se++){var ie=(be=D[se]).high,oe=be.low,ee=b[se];ee<32?(W=ie<<ee|oe>>>32-ee,Z=oe<<ee|ie>>>32-ee):(W=oe<<ee-32|ie>>>64-ee,Z=ie<<ee-32|oe>>>64-ee);var Q=M[S[se]];Q.high=W,Q.low=Z}var ue=M[0],me=D[0];for(ue.high=me.high,ue.low=me.low,z=0;z<5;z++)for($=0;$<5;$++){var be=D[se=z+5*$],ke=M[se],Ye=M[(z+1)%5+5*$],Oe=M[(z+2)%5+5*$];be.high=ke.high^~Ye.high&Oe.high,be.low=ke.low^~Ye.low&Oe.low}be=D[0];var Ee=T[B];be.high^=Ee.high,be.low^=Ee.low}},_doFinalize:function(){var E=this._data,N=E.words,D=(this._nDataBytes,8*E.sigBytes),x=32*this.blockSize;N[D>>>5]|=1<<24-D%32,N[(i.ceil((D+1)/x)*x>>>5)-1]|=128,E.sigBytes=4*N.length,this._process();for(var L=this._state,F=this.cfg.outputLength/8,H=F/8,B=[],z=0;z<H;z++){var W=L[z],Z=W.high,$=W.low;Z=16711935&(Z<<8|Z>>>24)|4278255360&(Z<<24|Z>>>8),$=16711935&($<<8|$>>>24)|4278255360&($<<24|$>>>8),B.push($),B.push(Z)}return new f.init(B,F)},clone:function(){for(var E=p.clone.call(this),N=E._state=this._state.slice(0),D=0;D<25;D++)N[D]=N[D].clone();return E}});c.SHA3=p._createHelper(R),c.HmacSHA3=p._createHmacHelper(R)}(Math),o.SHA3)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,m=c.algo,_=f.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),b=f.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),S=f.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=f.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),M=f.create([0,1518500249,1859775393,2400959708,2840853838]),R=f.create([1352829926,1548603684,1836072691,2053994217,0]),E=m.RIPEMD160=p.extend({_doReset:function(){this._hash=f.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,z){for(var W=0;W<16;W++){var Z=z+W,$=B[Z];B[Z]=16711935&($<<8|$>>>24)|4278255360&($<<24|$>>>8)}var O,X,le,de,he,se,ie,oe,ee,Q,ue,me=this._hash.words,be=M.words,ke=R.words,Ye=_.words,Oe=b.words,Ee=S.words,we=T.words;for(se=O=me[0],ie=X=me[1],oe=le=me[2],ee=de=me[3],Q=he=me[4],W=0;W<80;W+=1)ue=O+B[z+Ye[W]]|0,ue+=W<16?N(X,le,de)+be[0]:W<32?D(X,le,de)+be[1]:W<48?x(X,le,de)+be[2]:W<64?L(X,le,de)+be[3]:F(X,le,de)+be[4],ue=(ue=H(ue|=0,Ee[W]))+he|0,O=he,he=de,de=H(le,10),le=X,X=ue,ue=se+B[z+Oe[W]]|0,ue+=W<16?F(ie,oe,ee)+ke[0]:W<32?L(ie,oe,ee)+ke[1]:W<48?x(ie,oe,ee)+ke[2]:W<64?D(ie,oe,ee)+ke[3]:N(ie,oe,ee)+ke[4],ue=(ue=H(ue|=0,we[W]))+Q|0,se=Q,Q=ee,ee=H(oe,10),oe=ie,ie=ue;ue=me[1]+le+ee|0,me[1]=me[2]+de+Q|0,me[2]=me[3]+he+se|0,me[3]=me[4]+O+ie|0,me[4]=me[0]+X+oe|0,me[0]=ue},_doFinalize:function(){var B=this._data,z=B.words,W=8*this._nDataBytes,Z=8*B.sigBytes;z[Z>>>5]|=128<<24-Z%32,z[14+(Z+64>>>9<<4)]=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8),B.sigBytes=4*(z.length+1),this._process();for(var $=this._hash,O=$.words,X=0;X<5;X++){var le=O[X];O[X]=16711935&(le<<8|le>>>24)|4278255360&(le<<24|le>>>8)}return $},clone:function(){var B=p.clone.call(this);return B._hash=this._hash.clone(),B}});function N(B,z,W){return B^z^W}function D(B,z,W){return B&z|~B&W}function x(B,z,W){return(B|~z)^W}function L(B,z,W){return B&W|z&~W}function F(B,z,W){return B^(z|~W)}function H(B,z){return B<<z|B>>>32-z}c.RIPEMD160=p._createHelper(E),c.HmacRIPEMD160=p._createHmacHelper(E)}(),o.RIPEMD160)}),Eo(function(e,t){var o,i,c,u,f,p;e.exports=(i=(o=Ao).lib,c=i.Base,u=o.enc,f=u.Utf8,p=o.algo,void(p.HMAC=c.extend({init:function(m,_){m=this._hasher=new m.init,typeof _=="string"&&(_=f.parse(_));var b=m.blockSize,S=4*b;_.sigBytes>S&&(_=m.finalize(_)),_.clamp();for(var T=this._oKey=_.clone(),M=this._iKey=_.clone(),R=T.words,E=M.words,N=0;N<b;N++)R[N]^=1549556828,E[N]^=909522486;T.sigBytes=M.sigBytes=S,this.reset()},reset:function(){var m=this._hasher;m.reset(),m.update(this._iKey)},update:function(m){return this._hasher.update(m),this},finalize:function(m){var _=this._hasher,b=_.finalize(m);_.reset();var S=_.finalize(this._oKey.clone().concat(b));return S}})))}),Eo(function(e,t){var o,i,c,u,f,p,m,_,b;e.exports=(c=(i=o=Ao).lib,u=c.Base,f=c.WordArray,p=i.algo,m=p.SHA1,_=p.HMAC,b=p.PBKDF2=u.extend({cfg:u.extend({keySize:4,hasher:m,iterations:1}),init:function(S){this.cfg=this.cfg.extend(S)},compute:function(S,T){for(var M=this.cfg,R=_.create(M.hasher,S),E=f.create(),N=f.create([1]),D=E.words,x=N.words,L=M.keySize,F=M.iterations;D.length<L;){var H=R.update(T).finalize(N);R.reset();for(var B=H.words,z=B.length,W=H,Z=1;Z<F;Z++){W=R.finalize(W),R.reset();for(var $=W.words,O=0;O<z;O++)B[O]^=$[O]}E.concat(H),x[0]++}return E.sigBytes=4*L,E}}),i.PBKDF2=function(S,T,M){return b.create(M).compute(S,T)},o.PBKDF2)}),Eo(function(e,t){var o,i,c,u,f,p,m,_;e.exports=(c=(i=o=Ao).lib,u=c.Base,f=c.WordArray,p=i.algo,m=p.MD5,_=p.EvpKDF=u.extend({cfg:u.extend({keySize:4,hasher:m,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(b,S){for(var T=this.cfg,M=T.hasher.create(),R=f.create(),E=R.words,N=T.keySize,D=T.iterations;E.length<N;){x&&M.update(x);var x=M.update(b).finalize(S);M.reset();for(var L=1;L<D;L++)x=M.finalize(x),M.reset();R.concat(x)}return R.sigBytes=4*N,R}}),i.EvpKDF=function(b,S,T){return _.create(T).compute(b,S)},o.EvpKDF)}),Eo(function(e,t){var o,i,c,u,f,p,m,_,b,S,T,M,R,E,N,D,x,L,F,H,B,z,W,Z;e.exports=void((o=Ao).lib.Cipher||(c=o,u=c.lib,f=u.Base,p=u.WordArray,m=u.BufferedBlockAlgorithm,_=c.enc,_.Utf8,b=_.Base64,S=c.algo,T=S.EvpKDF,M=u.Cipher=m.extend({cfg:f.extend(),createEncryptor:function($,O){return this.create(this._ENC_XFORM_MODE,$,O)},createDecryptor:function($,O){return this.create(this._DEC_XFORM_MODE,$,O)},init:function($,O,X){this.cfg=this.cfg.extend(X),this._xformMode=$,this._key=O,this.reset()},reset:function(){m.reset.call(this),this._doReset()},process:function($){return this._append($),this._process()},finalize:function($){$&&this._append($);var O=this._doFinalize();return O},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function $(O){return typeof O=="string"?Z:B}return function(O){return{encrypt:function(X,le,de){return $(le).encrypt(O,X,le,de)},decrypt:function(X,le,de){return $(le).decrypt(O,X,le,de)}}}}()}),u.StreamCipher=M.extend({_doFinalize:function(){var $=this._process(!0);return $},blockSize:1}),R=c.mode={},E=u.BlockCipherMode=f.extend({createEncryptor:function($,O){return this.Encryptor.create($,O)},createDecryptor:function($,O){return this.Decryptor.create($,O)},init:function($,O){this._cipher=$,this._iv=O}}),N=R.CBC=function(){var $=E.extend();function O(X,le,de){var he=this._iv;if(he){var se=he;this._iv=i}else var se=this._prevBlock;for(var ie=0;ie<de;ie++)X[le+ie]^=se[ie]}return $.Encryptor=$.extend({processBlock:function(X,le){var de=this._cipher,he=de.blockSize;O.call(this,X,le,he),de.encryptBlock(X,le),this._prevBlock=X.slice(le,le+he)}}),$.Decryptor=$.extend({processBlock:function(X,le){var de=this._cipher,he=de.blockSize,se=X.slice(le,le+he);de.decryptBlock(X,le),O.call(this,X,le,he),this._prevBlock=se}}),$}(),D=c.pad={},x=D.Pkcs7={pad:function($,O){for(var X=4*O,le=X-$.sigBytes%X,de=le<<24|le<<16|le<<8|le,he=[],se=0;se<le;se+=4)he.push(de);var ie=p.create(he,le);$.concat(ie)},unpad:function($){var O=255&$.words[$.sigBytes-1>>>2];$.sigBytes-=O}},u.BlockCipher=M.extend({cfg:M.cfg.extend({mode:N,padding:x}),reset:function(){M.reset.call(this);var $=this.cfg,O=$.iv,X=$.mode;if(this._xformMode==this._ENC_XFORM_MODE)var le=X.createEncryptor;else{var le=X.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==le?this._mode.init(this,O&&O.words):(this._mode=le.call(X,this,O&&O.words),this._mode.__creator=le)},_doProcessBlock:function($,O){this._mode.processBlock($,O)},_doFinalize:function(){var $=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){$.pad(this._data,this.blockSize);var O=this._process(!0)}else{var O=this._process(!0);$.unpad(O)}return O},blockSize:4}),L=u.CipherParams=f.extend({init:function($){this.mixIn($)},toString:function($){return($||this.formatter).stringify(this)}}),F=c.format={},H=F.OpenSSL={stringify:function($){var O=$.ciphertext,X=$.salt;if(X)var le=p.create([1398893684,1701076831]).concat(X).concat(O);else var le=O;return le.toString(b)},parse:function($){var O=b.parse($),X=O.words;if(X[0]==1398893684&&X[1]==1701076831){var le=p.create(X.slice(2,4));X.splice(0,4),O.sigBytes-=16}return L.create({ciphertext:O,salt:le})}},B=u.SerializableCipher=f.extend({cfg:f.extend({format:H}),encrypt:function($,O,X,le){le=this.cfg.extend(le);var de=$.createEncryptor(X,le),he=de.finalize(O),se=de.cfg;return L.create({ciphertext:he,key:X,iv:se.iv,algorithm:$,mode:se.mode,padding:se.padding,blockSize:$.blockSize,formatter:le.format})},decrypt:function($,O,X,le){le=this.cfg.extend(le),O=this._parse(O,le.format);var de=$.createDecryptor(X,le).finalize(O.ciphertext);return de},_parse:function($,O){return typeof $=="string"?O.parse($,this):$}}),z=c.kdf={},W=z.OpenSSL={execute:function($,O,X,le){le||(le=p.random(8));var de=T.create({keySize:O+X}).compute($,le),he=p.create(de.words.slice(O),4*X);return de.sigBytes=4*O,L.create({key:de,iv:he,salt:le})}},Z=u.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:W}),encrypt:function($,O,X,le){var de=(le=this.cfg.extend(le)).kdf.execute(X,$.keySize,$.ivSize);le.iv=de.iv;var he=B.encrypt.call(this,$,O,de.key,le);return he.mixIn(de),he},decrypt:function($,O,X,le){le=this.cfg.extend(le),O=this._parse(O,le.format);var de=le.kdf.execute(X,$.keySize,$.ivSize,O.salt);le.iv=de.iv;var he=B.decrypt.call(this,$,O,de.key,le);return he}})))}),Eo(function(e,t){var o;e.exports=((o=Ao).mode.CFB=function(){var i=o.lib.BlockCipherMode.extend();function c(u,f,p,m){var _=this._iv;if(_){var b=_.slice(0);this._iv=void 0}else b=this._prevBlock;m.encryptBlock(b,0);for(var S=0;S<p;S++)u[f+S]^=b[S]}return i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,m=p.blockSize;c.call(this,u,f,m,p),this._prevBlock=u.slice(f,f+m)}}),i.Decryptor=i.extend({processBlock:function(u,f){var p=this._cipher,m=p.blockSize,_=u.slice(f,f+m);c.call(this,u,f,m,p),this._prevBlock=_}}),i}(),o.mode.CFB)}),Eo(function(e,t){var o,i,c;e.exports=((o=Ao).mode.CTR=(i=o.lib.BlockCipherMode.extend(),c=i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,m=p.blockSize,_=this._iv,b=this._counter;_&&(b=this._counter=_.slice(0),this._iv=void 0);var S=b.slice(0);p.encryptBlock(S,0),b[m-1]=b[m-1]+1|0;for(var T=0;T<m;T++)u[f+T]^=S[T]}}),i.Decryptor=c,i),o.mode.CTR)}),Eo(function(e,t){var o;e.exports=((o=Ao).mode.CTRGladman=function(){var i=o.lib.BlockCipherMode.extend();function c(f){if((f>>24&255)==255){var p=f>>16&255,m=f>>8&255,_=255&f;p===255?(p=0,m===255?(m=0,_===255?_=0:++_):++m):++p,f=0,f+=p<<16,f+=m<<8,f+=_}else f+=1<<24;return f}var u=i.Encryptor=i.extend({processBlock:function(f,p){var m=this._cipher,_=m.blockSize,b=this._iv,S=this._counter;b&&(S=this._counter=b.slice(0),this._iv=void 0),function(R){(R[0]=c(R[0]))===0&&(R[1]=c(R[1]))}(S);var T=S.slice(0);m.encryptBlock(T,0);for(var M=0;M<_;M++)f[p+M]^=T[M]}});return i.Decryptor=u,i}(),o.mode.CTRGladman)}),Eo(function(e,t){var o,i,c;e.exports=((o=Ao).mode.OFB=(i=o.lib.BlockCipherMode.extend(),c=i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,m=p.blockSize,_=this._iv,b=this._keystream;_&&(b=this._keystream=_.slice(0),this._iv=void 0),p.encryptBlock(b,0);for(var S=0;S<m;S++)u[f+S]^=b[S]}}),i.Decryptor=c,i),o.mode.OFB)}),Eo(function(e,t){var o,i;e.exports=((o=Ao).mode.ECB=((i=o.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(c,u){this._cipher.encryptBlock(c,u)}}),i.Decryptor=i.extend({processBlock:function(c,u){this._cipher.decryptBlock(c,u)}}),i),o.mode.ECB)}),Eo(function(e,t){var o;e.exports=((o=Ao).pad.AnsiX923={pad:function(i,c){var u=i.sigBytes,f=4*c,p=f-u%f,m=u+p-1;i.clamp(),i.words[m>>>2]|=p<<24-m%4*8,i.sigBytes+=p},unpad:function(i){var c=255&i.words[i.sigBytes-1>>>2];i.sigBytes-=c}},o.pad.Ansix923)}),Eo(function(e,t){var o;e.exports=((o=Ao).pad.Iso10126={pad:function(i,c){var u=4*c,f=u-i.sigBytes%u;i.concat(o.lib.WordArray.random(f-1)).concat(o.lib.WordArray.create([f<<24],1))},unpad:function(i){var c=255&i.words[i.sigBytes-1>>>2];i.sigBytes-=c}},o.pad.Iso10126)}),Eo(function(e,t){var o;e.exports=((o=Ao).pad.Iso97971={pad:function(i,c){i.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(i,c)},unpad:function(i){o.pad.ZeroPadding.unpad(i),i.sigBytes--}},o.pad.Iso97971)}),Eo(function(e,t){var o;e.exports=((o=Ao).pad.ZeroPadding={pad:function(i,c){var u=4*c;i.clamp(),i.sigBytes+=u-(i.sigBytes%u||u)},unpad:function(i){for(var c=i.words,u=i.sigBytes-1;!(c[u>>>2]>>>24-u%4*8&255);)u--;i.sigBytes=u+1}},o.pad.ZeroPadding)}),Eo(function(e,t){var o;e.exports=((o=Ao).pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding)}),Eo(function(e,t){var o,i,c,u;e.exports=(c=(i=o=Ao).lib.CipherParams,u=i.enc.Hex,i.format.Hex={stringify:function(f){return f.ciphertext.toString(u)},parse:function(f){var p=u.parse(f);return c.create({ciphertext:p})}},o.format.Hex)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.BlockCipher,u=i.algo,f=[],p=[],m=[],_=[],b=[],S=[],T=[],M=[],R=[],E=[];(function(){for(var x=[],L=0;L<256;L++)x[L]=L<128?L<<1:L<<1^283;var F=0,H=0;for(L=0;L<256;L++){var B=H^H<<1^H<<2^H<<3^H<<4;B=B>>>8^255&B^99,f[F]=B,p[B]=F;var z=x[F],W=x[z],Z=x[W],$=257*x[B]^16843008*B;m[F]=$<<24|$>>>8,_[F]=$<<16|$>>>16,b[F]=$<<8|$>>>24,S[F]=$,$=16843009*Z^65537*W^257*z^16843008*F,T[B]=$<<24|$>>>8,M[B]=$<<16|$>>>16,R[B]=$<<8|$>>>24,E[B]=$,F?(F=z^x[x[x[Z^z]]],H^=x[x[H]]):F=H=1}})();var N=[0,1,2,4,8,16,32,64,128,27,54],D=u.AES=c.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var x=this._keyPriorReset=this._key,L=x.words,F=x.sigBytes/4,H=4*((this._nRounds=F+6)+1),B=this._keySchedule=[],z=0;z<H;z++)if(z<F)B[z]=L[z];else{var W=B[z-1];z%F?F>6&&z%F==4&&(W=f[W>>>24]<<24|f[W>>>16&255]<<16|f[W>>>8&255]<<8|f[255&W]):(W=f[(W=W<<8|W>>>24)>>>24]<<24|f[W>>>16&255]<<16|f[W>>>8&255]<<8|f[255&W],W^=N[z/F|0]<<24),B[z]=B[z-F]^W}for(var Z=this._invKeySchedule=[],$=0;$<H;$++)z=H-$,W=$%4?B[z]:B[z-4],Z[$]=$<4||z<=4?W:T[f[W>>>24]]^M[f[W>>>16&255]]^R[f[W>>>8&255]]^E[f[255&W]]}},encryptBlock:function(x,L){this._doCryptBlock(x,L,this._keySchedule,m,_,b,S,f)},decryptBlock:function(x,L){var F=x[L+1];x[L+1]=x[L+3],x[L+3]=F,this._doCryptBlock(x,L,this._invKeySchedule,T,M,R,E,p),F=x[L+1],x[L+1]=x[L+3],x[L+3]=F},_doCryptBlock:function(x,L,F,H,B,z,W,Z){for(var $=this._nRounds,O=x[L]^F[0],X=x[L+1]^F[1],le=x[L+2]^F[2],de=x[L+3]^F[3],he=4,se=1;se<$;se++){var ie=H[O>>>24]^B[X>>>16&255]^z[le>>>8&255]^W[255&de]^F[he++],oe=H[X>>>24]^B[le>>>16&255]^z[de>>>8&255]^W[255&O]^F[he++],ee=H[le>>>24]^B[de>>>16&255]^z[O>>>8&255]^W[255&X]^F[he++],Q=H[de>>>24]^B[O>>>16&255]^z[X>>>8&255]^W[255&le]^F[he++];O=ie,X=oe,le=ee,de=Q}ie=(Z[O>>>24]<<24|Z[X>>>16&255]<<16|Z[le>>>8&255]<<8|Z[255&de])^F[he++],oe=(Z[X>>>24]<<24|Z[le>>>16&255]<<16|Z[de>>>8&255]<<8|Z[255&O])^F[he++],ee=(Z[le>>>24]<<24|Z[de>>>16&255]<<16|Z[O>>>8&255]<<8|Z[255&X])^F[he++],Q=(Z[de>>>24]<<24|Z[O>>>16&255]<<16|Z[X>>>8&255]<<8|Z[255&le])^F[he++],x[L]=ie,x[L+1]=oe,x[L+2]=ee,x[L+3]=Q},keySize:8});i.AES=c._createHelper(D)}(),o.AES)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib,u=c.WordArray,f=c.BlockCipher,p=i.algo,m=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],_=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],b=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],S=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],T=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],M=p.DES=f.extend({_doReset:function(){for(var D=this._key.words,x=[],L=0;L<56;L++){var F=m[L]-1;x[L]=D[F>>>5]>>>31-F%32&1}for(var H=this._subKeys=[],B=0;B<16;B++){var z=H[B]=[],W=b[B];for(L=0;L<24;L++)z[L/6|0]|=x[(_[L]-1+W)%28]<<31-L%6,z[4+(L/6|0)]|=x[28+(_[L+24]-1+W)%28]<<31-L%6;for(z[0]=z[0]<<1|z[0]>>>31,L=1;L<7;L++)z[L]=z[L]>>>4*(L-1)+3;z[7]=z[7]<<5|z[7]>>>27}var Z=this._invSubKeys=[];for(L=0;L<16;L++)Z[L]=H[15-L]},encryptBlock:function(D,x){this._doCryptBlock(D,x,this._subKeys)},decryptBlock:function(D,x){this._doCryptBlock(D,x,this._invSubKeys)},_doCryptBlock:function(D,x,L){this._lBlock=D[x],this._rBlock=D[x+1],R.call(this,4,252645135),R.call(this,16,65535),E.call(this,2,858993459),E.call(this,8,16711935),R.call(this,1,1431655765);for(var F=0;F<16;F++){for(var H=L[F],B=this._lBlock,z=this._rBlock,W=0,Z=0;Z<8;Z++)W|=S[Z][((z^H[Z])&T[Z])>>>0];this._lBlock=z,this._rBlock=B^W}var $=this._lBlock;this._lBlock=this._rBlock,this._rBlock=$,R.call(this,1,1431655765),E.call(this,8,16711935),E.call(this,2,858993459),R.call(this,16,65535),R.call(this,4,252645135),D[x]=this._lBlock,D[x+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function R(D,x){var L=(this._lBlock>>>D^this._rBlock)&x;this._rBlock^=L,this._lBlock^=L<<D}function E(D,x){var L=(this._rBlock>>>D^this._lBlock)&x;this._lBlock^=L,this._rBlock^=L<<D}i.DES=f._createHelper(M);var N=p.TripleDES=f.extend({_doReset:function(){var D=this._key.words;this._des1=M.createEncryptor(u.create(D.slice(0,2))),this._des2=M.createEncryptor(u.create(D.slice(2,4))),this._des3=M.createEncryptor(u.create(D.slice(4,6)))},encryptBlock:function(D,x){this._des1.encryptBlock(D,x),this._des2.decryptBlock(D,x),this._des3.encryptBlock(D,x)},decryptBlock:function(D,x){this._des3.decryptBlock(D,x),this._des2.encryptBlock(D,x),this._des1.decryptBlock(D,x)},keySize:6,ivSize:2,blockSize:2});i.TripleDES=f._createHelper(N)}(),o.TripleDES)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=u.RC4=c.extend({_doReset:function(){for(var _=this._key,b=_.words,S=_.sigBytes,T=this._S=[],M=0;M<256;M++)T[M]=M;M=0;for(var R=0;M<256;M++){var E=M%S,N=b[E>>>2]>>>24-E%4*8&255;R=(R+T[M]+N)%256;var D=T[M];T[M]=T[R],T[R]=D}this._i=this._j=0},_doProcessBlock:function(_,b){_[b]^=p.call(this)},keySize:8,ivSize:0});function p(){for(var _=this._S,b=this._i,S=this._j,T=0,M=0;M<4;M++){S=(S+_[b=(b+1)%256])%256;var R=_[b];_[b]=_[S],_[S]=R,T|=_[(_[b]+_[S])%256]<<24-8*M}return this._i=b,this._j=S,T}i.RC4=c._createHelper(f);var m=u.RC4Drop=f.extend({cfg:f.cfg.extend({drop:192}),_doReset:function(){f._doReset.call(this);for(var _=this.cfg.drop;_>0;_--)p.call(this)}});i.RC4Drop=c._createHelper(m)}(),o.RC4)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=[],p=[],m=[],_=u.Rabbit=c.extend({_doReset:function(){for(var S=this._key.words,T=this.cfg.iv,M=0;M<4;M++)S[M]=16711935&(S[M]<<8|S[M]>>>24)|4278255360&(S[M]<<24|S[M]>>>8);var R=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],E=this._C=[S[2]<<16|S[2]>>>16,4294901760&S[0]|65535&S[1],S[3]<<16|S[3]>>>16,4294901760&S[1]|65535&S[2],S[0]<<16|S[0]>>>16,4294901760&S[2]|65535&S[3],S[1]<<16|S[1]>>>16,4294901760&S[3]|65535&S[0]];for(this._b=0,M=0;M<4;M++)b.call(this);for(M=0;M<8;M++)E[M]^=R[M+4&7];if(T){var N=T.words,D=N[0],x=N[1],L=16711935&(D<<8|D>>>24)|4278255360&(D<<24|D>>>8),F=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8),H=L>>>16|4294901760&F,B=F<<16|65535&L;for(E[0]^=L,E[1]^=H,E[2]^=F,E[3]^=B,E[4]^=L,E[5]^=H,E[6]^=F,E[7]^=B,M=0;M<4;M++)b.call(this)}},_doProcessBlock:function(S,T){var M=this._X;b.call(this),f[0]=M[0]^M[5]>>>16^M[3]<<16,f[1]=M[2]^M[7]>>>16^M[5]<<16,f[2]=M[4]^M[1]>>>16^M[7]<<16,f[3]=M[6]^M[3]>>>16^M[1]<<16;for(var R=0;R<4;R++)f[R]=16711935&(f[R]<<8|f[R]>>>24)|4278255360&(f[R]<<24|f[R]>>>8),S[T+R]^=f[R]},blockSize:4,ivSize:2});function b(){for(var S=this._X,T=this._C,M=0;M<8;M++)p[M]=T[M];for(T[0]=T[0]+1295307597+this._b|0,T[1]=T[1]+3545052371+(T[0]>>>0<p[0]>>>0?1:0)|0,T[2]=T[2]+886263092+(T[1]>>>0<p[1]>>>0?1:0)|0,T[3]=T[3]+1295307597+(T[2]>>>0<p[2]>>>0?1:0)|0,T[4]=T[4]+3545052371+(T[3]>>>0<p[3]>>>0?1:0)|0,T[5]=T[5]+886263092+(T[4]>>>0<p[4]>>>0?1:0)|0,T[6]=T[6]+1295307597+(T[5]>>>0<p[5]>>>0?1:0)|0,T[7]=T[7]+3545052371+(T[6]>>>0<p[6]>>>0?1:0)|0,this._b=T[7]>>>0<p[7]>>>0?1:0,M=0;M<8;M++){var R=S[M]+T[M],E=65535&R,N=R>>>16,D=((E*E>>>17)+E*N>>>15)+N*N,x=((4294901760&R)*R|0)+((65535&R)*R|0);m[M]=D^x}S[0]=m[0]+(m[7]<<16|m[7]>>>16)+(m[6]<<16|m[6]>>>16)|0,S[1]=m[1]+(m[0]<<8|m[0]>>>24)+m[7]|0,S[2]=m[2]+(m[1]<<16|m[1]>>>16)+(m[0]<<16|m[0]>>>16)|0,S[3]=m[3]+(m[2]<<8|m[2]>>>24)+m[1]|0,S[4]=m[4]+(m[3]<<16|m[3]>>>16)+(m[2]<<16|m[2]>>>16)|0,S[5]=m[5]+(m[4]<<8|m[4]>>>24)+m[3]|0,S[6]=m[6]+(m[5]<<16|m[5]>>>16)+(m[4]<<16|m[4]>>>16)|0,S[7]=m[7]+(m[6]<<8|m[6]>>>24)+m[5]|0}i.Rabbit=c._createHelper(_)}(),o.Rabbit)}),Eo(function(e,t){var o;e.exports=(o=Ao,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=[],p=[],m=[],_=u.RabbitLegacy=c.extend({_doReset:function(){var S=this._key.words,T=this.cfg.iv,M=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],R=this._C=[S[2]<<16|S[2]>>>16,4294901760&S[0]|65535&S[1],S[3]<<16|S[3]>>>16,4294901760&S[1]|65535&S[2],S[0]<<16|S[0]>>>16,4294901760&S[2]|65535&S[3],S[1]<<16|S[1]>>>16,4294901760&S[3]|65535&S[0]];this._b=0;for(var E=0;E<4;E++)b.call(this);for(E=0;E<8;E++)R[E]^=M[E+4&7];if(T){var N=T.words,D=N[0],x=N[1],L=16711935&(D<<8|D>>>24)|4278255360&(D<<24|D>>>8),F=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8),H=L>>>16|4294901760&F,B=F<<16|65535&L;for(R[0]^=L,R[1]^=H,R[2]^=F,R[3]^=B,R[4]^=L,R[5]^=H,R[6]^=F,R[7]^=B,E=0;E<4;E++)b.call(this)}},_doProcessBlock:function(S,T){var M=this._X;b.call(this),f[0]=M[0]^M[5]>>>16^M[3]<<16,f[1]=M[2]^M[7]>>>16^M[5]<<16,f[2]=M[4]^M[1]>>>16^M[7]<<16,f[3]=M[6]^M[3]>>>16^M[1]<<16;for(var R=0;R<4;R++)f[R]=16711935&(f[R]<<8|f[R]>>>24)|4278255360&(f[R]<<24|f[R]>>>8),S[T+R]^=f[R]},blockSize:4,ivSize:2});function b(){for(var S=this._X,T=this._C,M=0;M<8;M++)p[M]=T[M];for(T[0]=T[0]+1295307597+this._b|0,T[1]=T[1]+3545052371+(T[0]>>>0<p[0]>>>0?1:0)|0,T[2]=T[2]+886263092+(T[1]>>>0<p[1]>>>0?1:0)|0,T[3]=T[3]+1295307597+(T[2]>>>0<p[2]>>>0?1:0)|0,T[4]=T[4]+3545052371+(T[3]>>>0<p[3]>>>0?1:0)|0,T[5]=T[5]+886263092+(T[4]>>>0<p[4]>>>0?1:0)|0,T[6]=T[6]+1295307597+(T[5]>>>0<p[5]>>>0?1:0)|0,T[7]=T[7]+3545052371+(T[6]>>>0<p[6]>>>0?1:0)|0,this._b=T[7]>>>0<p[7]>>>0?1:0,M=0;M<8;M++){var R=S[M]+T[M],E=65535&R,N=R>>>16,D=((E*E>>>17)+E*N>>>15)+N*N,x=((4294901760&R)*R|0)+((65535&R)*R|0);m[M]=D^x}S[0]=m[0]+(m[7]<<16|m[7]>>>16)+(m[6]<<16|m[6]>>>16)|0,S[1]=m[1]+(m[0]<<8|m[0]>>>24)+m[7]|0,S[2]=m[2]+(m[1]<<16|m[1]>>>16)+(m[0]<<16|m[0]>>>16)|0,S[3]=m[3]+(m[2]<<8|m[2]>>>24)+m[1]|0,S[4]=m[4]+(m[3]<<16|m[3]>>>16)+(m[2]<<16|m[2]>>>16)|0,S[5]=m[5]+(m[4]<<8|m[4]>>>24)+m[3]|0,S[6]=m[6]+(m[5]<<16|m[5]>>>16)+(m[4]<<16|m[4]>>>16)|0,S[7]=m[7]+(m[6]<<8|m[6]>>>24)+m[5]|0}i.RabbitLegacy=c._createHelper(_)}(),o.RabbitLegacy)}),Eo(function(e,t){e.exports=Ao}));function l7(){throw new Error("setTimeout has not been defined")}function c7(){throw new Error("clearTimeout has not been defined")}var Bu=l7,$u=c7;function u7(e){if(Bu===setTimeout)return setTimeout(e,0);if((Bu===l7||!Bu)&&setTimeout)return Bu=setTimeout,setTimeout(e,0);try{return Bu(e,0)}catch{try{return Bu.call(null,e,0)}catch{return Bu.call(this,e,0)}}}typeof mm.setTimeout=="function"&&(Bu=setTimeout),typeof mm.clearTimeout=="function"&&($u=clearTimeout);var bf,Sc=[],tm=!1,ET=-1;function Rce(){tm&&bf&&(tm=!1,bf.length?Sc=bf.concat(Sc):ET=-1,Sc.length&&d7())}function d7(){if(!tm){var e=u7(Rce);tm=!0;for(var t=Sc.length;t;){for(bf=Sc,Sc=[];++ET<t;)bf&&bf[ET].run();ET=-1,t=Sc.length}bf=null,tm=!1,function(o){if($u===clearTimeout)return clearTimeout(o);if(($u===c7||!$u)&&clearTimeout)return $u=clearTimeout,clearTimeout(o);try{$u(o)}catch{try{return $u.call(null,o)}catch{return $u.call(this,o)}}}(e)}}function li(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];Sc.push(new h7(e,t)),Sc.length!==1||tm||u7(d7)}function h7(e,t){this.fun=e,this.array=t}h7.prototype.run=function(){this.fun.apply(null,this.array)};var Fy=mm.performance||{};Fy.now||Fy.mozNow||Fy.msNow||Fy.oNow||Fy.webkitNow;function Hu(){}function Mo(){Mo.init.call(this)}function f7(e){return e._maxListeners===void 0?Mo.defaultMaxListeners:e._maxListeners}function wce(e,t,o){if(t)e.call(o);else for(var i=e.length,c=sI(e,i),u=0;u<i;++u)c[u].call(o)}function Dce(e,t,o,i){if(t)e.call(o,i);else for(var c=e.length,u=sI(e,c),f=0;f<c;++f)u[f].call(o,i)}function Oce(e,t,o,i,c){if(t)e.call(o,i,c);else for(var u=e.length,f=sI(e,u),p=0;p<u;++p)f[p].call(o,i,c)}function Nce(e,t,o,i,c,u){if(t)e.call(o,i,c,u);else for(var f=e.length,p=sI(e,f),m=0;m<f;++m)p[m].call(o,i,c,u)}function Lce(e,t,o,i){if(t)e.apply(o,i);else for(var c=e.length,u=sI(e,c),f=0;f<c;++f)u[f].apply(o,i)}function T6(e,t,o,i){var c,u,f,p;if(typeof o!="function")throw new TypeError('"listener" argument must be a function');if((u=e._events)?(u.newListener&&(e.emit("newListener",t,o.listener?o.listener:o),u=e._events),f=u[t]):(u=e._events=new Hu,e._eventsCount=0),f){if(typeof f=="function"?f=u[t]=i?[o,f]:[f,o]:i?f.unshift(o):f.push(o),!f.warned&&(c=f7(e))&&c>0&&f.length>c){f.warned=!0;var m=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");m.name="MaxListenersExceededWarning",m.emitter=e,m.type=t,m.count=f.length,p=m,typeof console.warn=="function"?console.warn(p):console.log(p)}}else f=u[t]=o,++e._eventsCount;return e}function E6(e,t,o){var i=!1;function c(){e.removeListener(t,c),i||(i=!0,o.apply(e,arguments))}return c.listener=o,c}function M6(e){var t=this._events;if(t){var o=t[e];if(typeof o=="function")return 1;if(o)return o.length}return 0}function sI(e,t){for(var o=new Array(t);t--;)o[t]=e[t];return o}Hu.prototype=Object.create(null),Mo.EventEmitter=Mo,Mo.usingDomains=!1,Mo.prototype.domain=void 0,Mo.prototype._events=void 0,Mo.prototype._maxListeners=void 0,Mo.defaultMaxListeners=10,Mo.init=function(){this.domain=null,Mo.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Hu,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Mo.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Mo.prototype.getMaxListeners=function(){return f7(this)},Mo.prototype.emit=function(e){var t,o,i,c,u,f,p,m=e==="error";if(f=this._events)m=m&&f.error==null;else if(!m)return!1;if(p=this.domain,m){if(t=arguments[1],!p){if(t instanceof Error)throw t;var _=new Error('Uncaught, unspecified "error" event. ('+t+")");throw _.context=t,_}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=p,t.domainThrown=!1,p.emit("error",t),!1}if(!(o=f[e]))return!1;var b=typeof o=="function";switch(i=arguments.length){case 1:wce(o,b,this);break;case 2:Dce(o,b,this,arguments[1]);break;case 3:Oce(o,b,this,arguments[1],arguments[2]);break;case 4:Nce(o,b,this,arguments[1],arguments[2],arguments[3]);break;default:for(c=new Array(i-1),u=1;u<i;u++)c[u-1]=arguments[u];Lce(o,b,this,c)}return!0},Mo.prototype.addListener=function(e,t){return T6(this,e,t,!1)},Mo.prototype.on=Mo.prototype.addListener,Mo.prototype.prependListener=function(e,t){return T6(this,e,t,!0)},Mo.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,E6(this,e,t)),this},Mo.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,E6(this,e,t)),this},Mo.prototype.removeListener=function(e,t){var o,i,c,u,f;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(o=i[e]))return this;if(o===t||o.listener&&o.listener===t)--this._eventsCount==0?this._events=new Hu:(delete i[e],i.removeListener&&this.emit("removeListener",e,o.listener||t));else if(typeof o!="function"){for(c=-1,u=o.length;u-- >0;)if(o[u]===t||o[u].listener&&o[u].listener===t){f=o[u].listener,c=u;break}if(c<0)return this;if(o.length===1){if(o[0]=void 0,--this._eventsCount==0)return this._events=new Hu,this;delete i[e]}else(function(p,m){for(var _=m,b=_+1,S=p.length;b<S;_+=1,b+=1)p[_]=p[b];p.pop()})(o,c);i.removeListener&&this.emit("removeListener",e,f||t)}return this},Mo.prototype.removeAllListeners=function(e){var t,o;if(!(o=this._events))return this;if(!o.removeListener)return arguments.length===0?(this._events=new Hu,this._eventsCount=0):o[e]&&(--this._eventsCount==0?this._events=new Hu:delete o[e]),this;if(arguments.length===0){for(var i,c=Object.keys(o),u=0;u<c.length;++u)(i=c[u])!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new Hu,this._eventsCount=0,this}if(typeof(t=o[e])=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},Mo.prototype.listeners=function(e){var t,o=this._events;return o&&(t=o[e])?typeof t=="function"?[t.listener||t]:function(i){for(var c=new Array(i.length),u=0;u<c.length;++u)c[u]=i[u].listener||i[u];return c}(t):[]},Mo.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):M6.call(e,t)},Mo.prototype.listenerCount=M6,Mo.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ts=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e},Pce=/%[sdj%]/g;function Uce(e){if(!PD(e)){for(var t=[],o=0;o<arguments.length;o++)t.push(cd(arguments[o]));return t.join(" ")}o=1;for(var i=arguments,c=i.length,u=String(e).replace(Pce,function(p){if(p==="%%")return"%";if(o>=c)return p;switch(p){case"%s":return String(i[o++]);case"%d":return Number(i[o++]);case"%j":try{return JSON.stringify(i[o++])}catch{return"[Circular]"}default:return p}}),f=i[o];o<c;f=i[++o])MN(f)||!aI(f)?u+=" "+f:u+=" "+cd(f);return u}function p7(e,t){if(nd(mm.process))return function(){return p7(e,t).apply(this,arguments)};var o=!1;return function(){return o||(console.error(t),o=!0),e.apply(this,arguments)}}var yw,YS={};function cd(e,t){var o={seen:[],stylize:Fce};return arguments.length>=3&&(o.depth=arguments[2]),arguments.length>=4&&(o.colors=arguments[3]),g7(t)?o.showHidden=t:t&&function(i,c){if(!c||!aI(c))return i;for(var u=Object.keys(c),f=u.length;f--;)i[u[f]]=c[u[f]]}(o,t),nd(o.showHidden)&&(o.showHidden=!1),nd(o.depth)&&(o.depth=2),nd(o.colors)&&(o.colors=!1),nd(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=xce),hE(o,e,o.depth)}function xce(e,t){var o=cd.styles[t];return o?"\x1B["+cd.colors[o][0]+"m"+e+"\x1B["+cd.colors[o][1]+"m":e}function Fce(e,t){return e}function hE(e,t,o){if(e.customInspect&&t&&Tw(t.inspect)&&t.inspect!==cd&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(o,e);return PD(i)||(i=hE(e,i,o)),i}var c=function(M,R){if(nd(R))return M.stylize("undefined","undefined");if(PD(R)){var E="'"+JSON.stringify(R).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return M.stylize(E,"string")}if(N=R,typeof N=="number")return M.stylize(""+R,"number");var N;if(g7(R))return M.stylize(""+R,"boolean");if(MN(R))return M.stylize("null","null")}(e,t);if(c)return c;var u=Object.keys(t),f=function(M){var R={};return M.forEach(function(E,N){R[E]=!0}),R}(u);if(e.showHidden&&(u=Object.getOwnPropertyNames(t)),Sw(t)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return Iw(t);if(u.length===0){if(Tw(t)){var p=t.name?": "+t.name:"";return e.stylize("[Function"+p+"]","special")}if(Cw(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k6(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Sw(t))return Iw(t)}var m,_,b="",S=!1,T=["{","}"];return m=t,Array.isArray(m)&&(S=!0,T=["[","]"]),Tw(t)&&(b=" [Function"+(t.name?": "+t.name:"")+"]"),Cw(t)&&(b=" "+RegExp.prototype.toString.call(t)),k6(t)&&(b=" "+Date.prototype.toUTCString.call(t)),Sw(t)&&(b=" "+Iw(t)),u.length!==0||S&&t.length!=0?o<0?Cw(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),_=S?function(M,R,E,N,D){for(var x=[],L=0,F=R.length;L<F;++L)m7(R,String(L))?x.push(bw(M,R,E,N,String(L),!0)):x.push("");return D.forEach(function(H){H.match(/^\d+$/)||x.push(bw(M,R,E,N,H,!0))}),x}(e,t,o,f,u):u.map(function(M){return bw(e,t,o,f,M,S)}),e.seen.pop(),function(M,R,E){return M.reduce(function(N,D){return D.indexOf(`
`),N+D.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?E[0]+(R===""?"":R+`
 `)+" "+M.join(`,
  `)+" "+E[1]:E[0]+R+" "+M.join(", ")+" "+E[1]}(_,b,T)):T[0]+b+T[1]}function Iw(e){return"["+Error.prototype.toString.call(e)+"]"}function bw(e,t,o,i,c,u){var f,p,m;if((m=Object.getOwnPropertyDescriptor(t,c)||{value:t[c]}).get?p=m.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):m.set&&(p=e.stylize("[Setter]","special")),m7(i,c)||(f="["+c+"]"),p||(e.seen.indexOf(m.value)<0?(p=MN(o)?hE(e,m.value,null):hE(e,m.value,o-1)).indexOf(`
`)>-1&&(p=u?p.split(`
`).map(function(_){return"  "+_}).join(`
`).substr(2):`
`+p.split(`
`).map(function(_){return"   "+_}).join(`
`)):p=e.stylize("[Circular]","special")),nd(f)){if(u&&c.match(/^\d+$/))return p;(f=JSON.stringify(""+c)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=e.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=e.stylize(f,"string"))}return f+": "+p}function g7(e){return typeof e=="boolean"}function MN(e){return e===null}function PD(e){return typeof e=="string"}function nd(e){return e===void 0}function Cw(e){return aI(e)&&kN(e)==="[object RegExp]"}function aI(e){return typeof e=="object"&&e!==null}function k6(e){return aI(e)&&kN(e)==="[object Date]"}function Sw(e){return aI(e)&&(kN(e)==="[object Error]"||e instanceof Error)}function Tw(e){return typeof e=="function"}function kN(e){return Object.prototype.toString.call(e)}function m7(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ff(){this.head=null,this.tail=null,this.length=0}cd.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},cd.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},ff.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},ff.prototype.unshift=function(e){var t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length},ff.prototype.shift=function(){if(this.length!==0){var e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},ff.prototype.clear=function(){this.head=this.tail=null,this.length=0},ff.prototype.join=function(e){if(this.length===0)return"";for(var t=this.head,o=""+t.data;t=t.next;)o+=e+t.data;return o},ff.prototype.concat=function(e){if(this.length===0)return Ot.alloc(0);if(this.length===1)return this.head.data;for(var t=Ot.allocUnsafe(e>>>0),o=this.head,i=0;o;)o.data.copy(t,i),i+=o.data.length,o=o.next;return t};var Vce=Ot.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a0(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!Vce(t))throw new Error("Unknown encoding: "+t)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Bce;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=$ce;break;default:return void(this.write=Gce)}this.charBuffer=new Ot(6),this.charReceived=0,this.charLength=0}function Gce(e){return e.toString(this.encoding)}function Bce(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function $ce(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}a0.prototype.write=function(e){for(var t="";this.charLength;){var o=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,o),this.charReceived+=o,this.charReceived<this.charLength)return"";if(e=e.slice(o,e.length),!((c=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&c<=56319)){if(this.charReceived=this.charLength=0,e.length===0)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived);var c;if(i=(t+=e.toString(this.encoding,0,i)).length-1,(c=t.charCodeAt(i))>=55296&&c<=56319){var u=this.surrogateSize;return this.charLength+=u,this.charReceived+=u,this.charBuffer.copy(this.charBuffer,u,0,u),e.copy(this.charBuffer,0,0,u),t.substring(0,i)}return t},a0.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var o=e[e.length-t];if(t==1&&o>>5==6){this.charLength=2;break}if(t<=2&&o>>4==14){this.charLength=3;break}if(t<=3&&o>>3==30){this.charLength=4;break}}this.charReceived=t},a0.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var o=this.charReceived,i=this.charBuffer,c=this.encoding;t+=i.slice(0,o).toString(c)}return t},Sr.ReadableState=v7;var Go=function(e){return nd(yw)&&(yw=""),e=e.toUpperCase(),YS[e]||(new RegExp("\\b"+e+"\\b","i").test(yw)?YS[e]=function(){var t=Uce.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:YS[e]=function(){}),YS[e]}("stream");function v7(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Zs&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=o||o===0?o:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new ff,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new a0(e.encoding),this.encoding=e.encoding)}function Sr(e){if(!(this instanceof Sr))return new Sr(e);this._readableState=new v7(e,this),this.readable=!0,e&&typeof e.read=="function"&&(this._read=e.read),Mo.call(this)}function A6(e,t,o,i,c){var u=function(_,b){var S=null;return iI(b)||typeof b=="string"||b==null||_.objectMode||(S=new TypeError("Invalid non-string/buffer chunk")),S}(t,o);if(u)e.emit("error",u);else if(o===null)t.reading=!1,function(_,b){if(!b.ended){if(b.decoder){var S=b.decoder.end();S&&S.length&&(b.buffer.push(S),b.length+=b.objectMode?1:S.length)}b.ended=!0,fE(_)}}(e,t);else if(t.objectMode||o&&o.length>0)if(t.ended&&!c){var f=new Error("stream.push() after EOF");e.emit("error",f)}else if(t.endEmitted&&c){var p=new Error("stream.unshift() after end event");e.emit("error",p)}else{var m;!t.decoder||c||i||(o=t.decoder.write(o),m=!t.objectMode&&o.length===0),c||(t.reading=!1),m||(t.flowing&&t.length===0&&!t.sync?(e.emit("data",o),e.read(0)):(t.length+=t.objectMode?1:o.length,c?t.buffer.unshift(o):t.buffer.push(o),t.needReadable&&fE(e))),function(_,b){b.readingMore||(b.readingMore=!0,li(Hce,_,b))}(e,t)}else c||(t.reading=!1);return function(_){return!_.ended&&(_.needReadable||_.length<_.highWaterMark||_.length===0)}(t)}ts(Sr,Mo),Sr.prototype.push=function(e,t){var o=this._readableState;return o.objectMode||typeof e!="string"||(t=t||o.defaultEncoding)!==o.encoding&&(e=Ot.from(e,t),t=""),A6(this,o,e,t,!1)},Sr.prototype.unshift=function(e){return A6(this,this._readableState,e,"",!0)},Sr.prototype.isPaused=function(){return this._readableState.flowing===!1},Sr.prototype.setEncoding=function(e){return this._readableState.decoder=new a0(e),this._readableState.encoding=e,this};var R6=8388608;function w6(e,t){return e<=0||t.length===0&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(o){return o>=R6?o=R6:(o--,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,o|=o>>>16,o++),o}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function fE(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Go("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?li(D6,e):D6(e))}function D6(e){Go("emit readable"),e.emit("readable"),AN(e)}function Hce(e,t){for(var o=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Go("maybeReadMore read 0"),e.read(0),o!==t.length);)o=t.length;t.readingMore=!1}function qce(e){Go("readable nexttick read 0"),e.read(0)}function Kce(e,t){t.reading||(Go("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),AN(e),t.flowing&&!t.reading&&e.read(0)}function AN(e){var t=e._readableState;for(Go("flow",t.flowing);t.flowing&&e.read()!==null;);}function O6(e,t){return t.length===0?null:(t.objectMode?o=t.buffer.shift():!e||e>=t.length?(o=t.decoder?t.buffer.join(""):t.buffer.length===1?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):o=function(i,c,u){var f;return i<c.head.data.length?(f=c.head.data.slice(0,i),c.head.data=c.head.data.slice(i)):f=i===c.head.data.length?c.shift():u?function(p,m){var _=m.head,b=1,S=_.data;for(p-=S.length;_=_.next;){var T=_.data,M=p>T.length?T.length:p;if(M===T.length?S+=T:S+=T.slice(0,p),(p-=M)===0){M===T.length?(++b,_.next?m.head=_.next:m.head=m.tail=null):(m.head=_,_.data=T.slice(M));break}++b}return m.length-=b,S}(i,c):function(p,m){var _=Ot.allocUnsafe(p),b=m.head,S=1;for(b.data.copy(_),p-=b.data.length;b=b.next;){var T=b.data,M=p>T.length?T.length:p;if(T.copy(_,_.length-p,0,M),(p-=M)===0){M===T.length?(++S,b.next?m.head=b.next:m.head=m.tail=null):(m.head=b,b.data=T.slice(M));break}++S}return m.length-=S,_}(i,c),f}(e,t.buffer,t.decoder),o);var o}function Ew(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,li(zce,t,e))}function zce(e,t){e.endEmitted||e.length!==0||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function N6(e,t){for(var o=0,i=e.length;o<i;o++)if(e[o]===t)return o;return-1}function Wce(){}function jce(e,t,o){this.chunk=e,this.encoding=t,this.callback=o,this.next=null}function UD(e,t){Object.defineProperty(this,"buffer",{get:p7(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Zs&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var o=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=o||o===0?o:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var c=e.decodeStrings===!1;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(u){(function(f,p){var m=f._writableState,_=m.sync,b=m.writecb;if(function(T){T.writing=!1,T.writecb=null,T.length-=T.writelen,T.writelen=0}(m),p)(function(T,M,R,E,N){--M.pendingcb,R?li(N,E):N(E),T._writableState.errorEmitted=!0,T.emit("error",E)})(f,m,_,p,b);else{var S=y7(m);S||m.corked||m.bufferProcessing||!m.bufferedRequest||_7(f,m),_?li(L6,f,m,S,b):L6(f,m,S,b)}})(t,u)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new b7(this)}function Ti(e){if(!(this instanceof Ti||this instanceof Zs))return new Ti(e);this._writableState=new UD(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev)),Mo.call(this)}function xD(e,t,o,i,c,u,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,o?e._writev(c,t.onwrite):e._write(c,u,t.onwrite),t.sync=!1}function L6(e,t,o,i){o||function(c,u){u.length===0&&u.needDrain&&(u.needDrain=!1,c.emit("drain"))}(e,t),t.pendingcb--,i(),I7(e,t)}function _7(e,t){t.bufferProcessing=!0;var o=t.bufferedRequest;if(e._writev&&o&&o.next){var i=t.bufferedRequestCount,c=new Array(i),u=t.corkedRequestsFree;u.entry=o;for(var f=0;o;)c[f]=o,o=o.next,f+=1;xD(e,t,!0,t.length,c,"",u.finish),t.pendingcb++,t.lastBufferedRequest=null,u.next?(t.corkedRequestsFree=u.next,u.next=null):t.corkedRequestsFree=new b7(t)}else{for(;o;){var p=o.chunk,m=o.encoding,_=o.callback;if(xD(e,t,!1,t.objectMode?1:p.length,p,m,_),o=o.next,t.writing)break}o===null&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=o,t.bufferProcessing=!1}function y7(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function P6(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function I7(e,t){var o=y7(t);return o&&(t.pendingcb===0?(P6(e,t),t.finished=!0,e.emit("finish")):P6(e,t)),o}function b7(e){var t=this;this.next=null,this.entry=null,this.finish=function(o){var i=t.entry;for(t.entry=null;i;){var c=i.callback;e.pendingcb--,c(o),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Sr.prototype.read=function(e){Go("read",e),e=parseInt(e,10);var t=this._readableState,o=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Go("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?Ew(this):fE(this),null;if((e=w6(e,t))===0&&t.ended)return t.length===0&&Ew(this),null;var i,c=t.needReadable;return Go("need readable",c),(t.length===0||t.length-e<t.highWaterMark)&&Go("length less than watermark",c=!0),t.ended||t.reading?Go("reading or ended",c=!1):c&&(Go("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=w6(o,t))),(i=e>0?O6(e,t):null)===null?(t.needReadable=!0,e=0):t.length-=e,t.length===0&&(t.ended||(t.needReadable=!0),o!==e&&t.ended&&Ew(this)),i!==null&&this.emit("data",i),i},Sr.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Sr.prototype.pipe=function(e,t){var o=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,Go("pipe count=%d opts=%j",i.pipesCount,t);var c=!t||t.end!==!1?f:_;function u(N){Go("onunpipe"),N===o&&_()}function f(){Go("onend"),e.end()}i.endEmitted?li(c):o.once("end",c),e.on("unpipe",u);var p=function(N){return function(){var D=N._readableState;Go("pipeOnDrain",D.awaitDrain),D.awaitDrain&&D.awaitDrain--,D.awaitDrain===0&&N.listeners("data").length&&(D.flowing=!0,AN(N))}}(o);e.on("drain",p);var m=!1;function _(){Go("cleanup"),e.removeListener("close",M),e.removeListener("finish",R),e.removeListener("drain",p),e.removeListener("error",T),e.removeListener("unpipe",u),o.removeListener("end",f),o.removeListener("end",_),o.removeListener("data",S),m=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||p()}var b=!1;function S(N){Go("ondata"),b=!1,e.write(N)!==!1||b||((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&N6(i.pipes,e)!==-1)&&!m&&(Go("false write response, pause",o._readableState.awaitDrain),o._readableState.awaitDrain++,b=!0),o.pause())}function T(N){var D;Go("onerror",N),E(),e.removeListener("error",T),D="error",e.listeners(D).length===0&&e.emit("error",N)}function M(){e.removeListener("finish",R),E()}function R(){Go("onfinish"),e.removeListener("close",M),E()}function E(){Go("unpipe"),o.unpipe(e)}return o.on("data",S),function(N,D,x){if(typeof N.prependListener=="function")return N.prependListener(D,x);N._events&&N._events[D]?Array.isArray(N._events[D])?N._events[D].unshift(x):N._events[D]=[x,N._events[D]]:N.on(D,x)}(e,"error",T),e.once("close",M),e.once("finish",R),e.emit("pipe",o),i.flowing||(Go("pipe resume"),o.resume()),e},Sr.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var o=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var c=0;c<i;c++)o[c].emit("unpipe",this);return this}var u=N6(t.pipes,e);return u===-1?this:(t.pipes.splice(u,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Sr.prototype.on=function(e,t){var o=Mo.prototype.on.call(this,e,t);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&fE(this):li(qce,this))}return o},Sr.prototype.addListener=Sr.prototype.on,Sr.prototype.resume=function(){var e=this._readableState;return e.flowing||(Go("resume"),e.flowing=!0,function(t,o){o.resumeScheduled||(o.resumeScheduled=!0,li(Kce,t,o))}(this,e)),this},Sr.prototype.pause=function(){return Go("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Go("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Sr.prototype.wrap=function(e){var t=this._readableState,o=!1,i=this;for(var c in e.on("end",function(){if(Go("wrapped end"),t.decoder&&!t.ended){var u=t.decoder.end();u&&u.length&&i.push(u)}i.push(null)}),e.on("data",function(u){Go("wrapped data"),t.decoder&&(u=t.decoder.write(u)),t.objectMode&&u==null||(t.objectMode||u&&u.length)&&(i.push(u)||(o=!0,e.pause()))}),e)this[c]===void 0&&typeof e[c]=="function"&&(this[c]=function(u){return function(){return e[u].apply(e,arguments)}}(c));return function(u,f){for(var p=0,m=u.length;p<m;p++)f(u[p],p)}(["error","close","destroy","pause","resume"],function(u){e.on(u,i.emit.bind(i,u))}),i._read=function(u){Go("wrapped _read",u),o&&(o=!1,e.resume())},i},Sr._fromList=O6,Ti.WritableState=UD,ts(Ti,Mo),UD.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Ti.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Ti.prototype.write=function(e,t,o){var i=this._writableState,c=!1;return typeof t=="function"&&(o=t,t=null),Ot.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),typeof o!="function"&&(o=Wce),i.ended?function(u,f){var p=new Error("write after end");u.emit("error",p),li(f,p)}(this,o):function(u,f,p,m){var _=!0,b=!1;return p===null?b=new TypeError("May not write null values to stream"):Ot.isBuffer(p)||typeof p=="string"||p===void 0||f.objectMode||(b=new TypeError("Invalid non-string/buffer chunk")),b&&(u.emit("error",b),li(m,b),_=!1),_}(this,i,e,o)&&(i.pendingcb++,c=function(u,f,p,m,_){p=function(M,R,E){return M.objectMode||M.decodeStrings===!1||typeof R!="string"||(R=Ot.from(R,E)),R}(f,p,m),Ot.isBuffer(p)&&(m="buffer");var b=f.objectMode?1:p.length;f.length+=b;var S=f.length<f.highWaterMark;if(S||(f.needDrain=!0),f.writing||f.corked){var T=f.lastBufferedRequest;f.lastBufferedRequest=new jce(p,m,_),T?T.next=f.lastBufferedRequest:f.bufferedRequest=f.lastBufferedRequest,f.bufferedRequestCount+=1}else xD(u,f,!1,b,p,m,_);return S}(this,i,e,t,o)),c},Ti.prototype.cork=function(){this._writableState.corked++},Ti.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_7(this,e))},Ti.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Ti.prototype._write=function(e,t,o){o(new Error("not implemented"))},Ti.prototype._writev=null,Ti.prototype.end=function(e,t,o){var i=this._writableState;typeof e=="function"?(o=e,e=null,t=null):typeof t=="function"&&(o=t,t=null),e!=null&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(c,u,f){u.ending=!0,I7(c,u),f&&(u.finished?li(f):c.once("finish",f)),u.ended=!0,c.writable=!1}(this,i,o)},ts(Zs,Sr);for(var U6=Object.keys(Ti.prototype),Mw=0;Mw<U6.length;Mw++){var kw=U6[Mw];Zs.prototype[kw]||(Zs.prototype[kw]=Ti.prototype[kw])}function Zs(e){if(!(this instanceof Zs))return new Zs(e);Sr.call(this,e),Ti.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",Yce)}function Yce(){this.allowHalfOpen||this._writableState.ended||li(Jce,this)}function Jce(e){e.end()}function Xce(e){this.afterTransform=function(t,o){return function(i,c,u){var f=i._transformState;f.transforming=!1;var p=f.writecb;if(!p)return i.emit("error",new Error("no writecb in Transform class"));f.writechunk=null,f.writecb=null,u!=null&&i.push(u),p(c);var m=i._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&i._read(m.highWaterMark)}(e,t,o)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function zs(e){if(!(this instanceof zs))return new zs(e);Zs.call(this,e),this._transformState=new Xce(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(o){x6(t,o)}):x6(t)})}function x6(e,t){if(t)return e.emit("error",t);var o=e._writableState,i=e._transformState;if(o.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function l0(e){if(!(this instanceof l0))return new l0(e);zs.call(this,e)}function fc(){Mo.call(this)}ts(zs,Zs),zs.prototype.push=function(e,t){return this._transformState.needTransform=!1,Zs.prototype.push.call(this,e,t)},zs.prototype._transform=function(e,t,o){throw new Error("Not implemented")},zs.prototype._write=function(e,t,o){var i=this._transformState;if(i.writecb=o,i.writechunk=e,i.writeencoding=t,!i.transforming){var c=this._readableState;(i.needTransform||c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}},zs.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},ts(l0,zs),l0.prototype._transform=function(e,t,o){o(null,e)},ts(fc,Mo),fc.Readable=Sr,fc.Writable=Ti,fc.Duplex=Zs,fc.Transform=zs,fc.PassThrough=l0,fc.Stream=fc,fc.prototype.pipe=function(e,t){var o=this;function i(b){e.writable&&e.write(b)===!1&&o.pause&&o.pause()}function c(){o.readable&&o.resume&&o.resume()}o.on("data",i),e.on("drain",c),e._isStdio||t&&t.end===!1||(o.on("end",f),o.on("close",p));var u=!1;function f(){u||(u=!0,e.end())}function p(){u||(u=!0,typeof e.destroy=="function"&&e.destroy())}function m(b){if(_(),Mo.listenerCount(this,"error")===0)throw b}function _(){o.removeListener("data",i),e.removeListener("drain",c),o.removeListener("end",f),o.removeListener("close",p),o.removeListener("error",m),e.removeListener("error",m),o.removeListener("end",_),o.removeListener("close",_),e.removeListener("close",_)}return o.on("error",m),e.on("error",m),o.on("end",_),o.on("close",_),e.on("close",_),e.emit("pipe",o),e};var C7={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function Qce(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function yc(e,t,o,i,c){if(t.subarray&&e.subarray)e.set(t.subarray(o,o+i),c);else for(var u=0;u<i;u++)e[c+u]=t[o+u]}var pE=Uint8Array,js=Uint16Array,gE=Int32Array,Zce=4,F6=0,V6=1,eue=2;function Um(e){for(var t=e.length;--t>=0;)e[t]=0}var tue=0,S7=1,nue=2,RN=29,lI=256,D0=lI+1+RN,nm=30,wN=19,G6=2*D0+1,Cf=15,Aw=16,oue=7,DN=256,T7=16,E7=17,M7=18,FD=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],MT=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],rue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B6=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vc=new Array(2*(D0+2));Um(vc);var c0=new Array(2*nm);Um(c0);var O0=new Array(512);Um(O0);var N0=new Array(256);Um(N0);var ON=new Array(RN);Um(ON);var $6,H6,q6,mE=new Array(nm);function Rw(e,t,o,i,c){this.static_tree=e,this.extra_bits=t,this.extra_base=o,this.elems=i,this.max_length=c,this.has_stree=e&&e.length}function ww(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function k7(e){return e<256?O0[e]:O0[256+(e>>>7)]}function L0(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function ns(e,t,o){e.bi_valid>Aw-o?(e.bi_buf|=t<<e.bi_valid&65535,L0(e,e.bi_buf),e.bi_buf=t>>Aw-e.bi_valid,e.bi_valid+=o-Aw):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=o)}function _l(e,t,o){ns(e,o[2*t],o[2*t+1])}function A7(e,t){var o=0;do o|=1&e,e>>>=1,o<<=1;while(--t>0);return o>>>1}function R7(e,t,o){var i,c,u=new Array(Cf+1),f=0;for(i=1;i<=Cf;i++)u[i]=f=f+o[i-1]<<1;for(c=0;c<=t;c++){var p=e[2*c+1];p!==0&&(e[2*c]=A7(u[p]++,p))}}function w7(e){var t;for(t=0;t<D0;t++)e.dyn_ltree[2*t]=0;for(t=0;t<nm;t++)e.dyn_dtree[2*t]=0;for(t=0;t<wN;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*DN]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function D7(e){e.bi_valid>8?L0(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function K6(e,t,o,i){var c=2*t,u=2*o;return e[c]<e[u]||e[c]===e[u]&&i[t]<=i[o]}function Dw(e,t,o){for(var i=e.heap[o],c=o<<1;c<=e.heap_len&&(c<e.heap_len&&K6(t,e.heap[c+1],e.heap[c],e.depth)&&c++,!K6(t,i,e.heap[c],e.depth));)e.heap[o]=e.heap[c],o=c,c<<=1;e.heap[o]=i}function z6(e,t,o){var i,c,u,f,p=0;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+2*p]<<8|e.pending_buf[e.d_buf+2*p+1],c=e.pending_buf[e.l_buf+p],p++,i===0?_l(e,c,t):(_l(e,(u=N0[c])+lI+1,t),(f=FD[u])!==0&&ns(e,c-=ON[u],f),_l(e,u=k7(--i),o),(f=MT[u])!==0&&ns(e,i-=mE[u],f));while(p<e.last_lit);_l(e,DN,t)}function Ow(e,t){var o,i,c,u=t.dyn_tree,f=t.stat_desc.static_tree,p=t.stat_desc.has_stree,m=t.stat_desc.elems,_=-1;for(e.heap_len=0,e.heap_max=G6,o=0;o<m;o++)u[2*o]!==0?(e.heap[++e.heap_len]=_=o,e.depth[o]=0):u[2*o+1]=0;for(;e.heap_len<2;)u[2*(c=e.heap[++e.heap_len]=_<2?++_:0)]=1,e.depth[c]=0,e.opt_len--,p&&(e.static_len-=f[2*c+1]);for(t.max_code=_,o=e.heap_len>>1;o>=1;o--)Dw(e,u,o);c=m;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Dw(e,u,1),i=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=i,u[2*c]=u[2*o]+u[2*i],e.depth[c]=(e.depth[o]>=e.depth[i]?e.depth[o]:e.depth[i])+1,u[2*o+1]=u[2*i+1]=c,e.heap[1]=c++,Dw(e,u,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(b,S){var T,M,R,E,N,D,x=S.dyn_tree,L=S.max_code,F=S.stat_desc.static_tree,H=S.stat_desc.has_stree,B=S.stat_desc.extra_bits,z=S.stat_desc.extra_base,W=S.stat_desc.max_length,Z=0;for(E=0;E<=Cf;E++)b.bl_count[E]=0;for(x[2*b.heap[b.heap_max]+1]=0,T=b.heap_max+1;T<G6;T++)(E=x[2*x[2*(M=b.heap[T])+1]+1]+1)>W&&(E=W,Z++),x[2*M+1]=E,M>L||(b.bl_count[E]++,N=0,M>=z&&(N=B[M-z]),D=x[2*M],b.opt_len+=D*(E+N),H&&(b.static_len+=D*(F[2*M+1]+N)));if(Z!==0){do{for(E=W-1;b.bl_count[E]===0;)E--;b.bl_count[E]--,b.bl_count[E+1]+=2,b.bl_count[W]--,Z-=2}while(Z>0);for(E=W;E!==0;E--)for(M=b.bl_count[E];M!==0;)(R=b.heap[--T])>L||(x[2*R+1]!==E&&(b.opt_len+=(E-x[2*R+1])*x[2*R],x[2*R+1]=E),M--)}}(e,t),R7(u,_,e.bl_count)}function W6(e,t,o){var i,c,u=-1,f=t[1],p=0,m=7,_=4;for(f===0&&(m=138,_=3),t[2*(o+1)+1]=65535,i=0;i<=o;i++)c=f,f=t[2*(i+1)+1],++p<m&&c===f||(p<_?e.bl_tree[2*c]+=p:c!==0?(c!==u&&e.bl_tree[2*c]++,e.bl_tree[2*T7]++):p<=10?e.bl_tree[2*E7]++:e.bl_tree[2*M7]++,p=0,u=c,f===0?(m=138,_=3):c===f?(m=6,_=3):(m=7,_=4))}function j6(e,t,o){var i,c,u=-1,f=t[1],p=0,m=7,_=4;for(f===0&&(m=138,_=3),i=0;i<=o;i++)if(c=f,f=t[2*(i+1)+1],!(++p<m&&c===f)){if(p<_)do _l(e,c,e.bl_tree);while(--p!=0);else c!==0?(c!==u&&(_l(e,c,e.bl_tree),p--),_l(e,T7,e.bl_tree),ns(e,p-3,2)):p<=10?(_l(e,E7,e.bl_tree),ns(e,p-3,3)):(_l(e,M7,e.bl_tree),ns(e,p-11,7));p=0,u=c,f===0?(m=138,_=3):c===f?(m=6,_=3):(m=7,_=4)}}Um(mE);var Y6=!1;function iue(e){Y6||(function(){var t,o,i,c,u,f=new Array(Cf+1);for(i=0,c=0;c<RN-1;c++)for(ON[c]=i,t=0;t<1<<FD[c];t++)N0[i++]=c;for(N0[i-1]=c,u=0,c=0;c<16;c++)for(mE[c]=u,t=0;t<1<<MT[c];t++)O0[u++]=c;for(u>>=7;c<nm;c++)for(mE[c]=u<<7,t=0;t<1<<MT[c]-7;t++)O0[256+u++]=c;for(o=0;o<=Cf;o++)f[o]=0;for(t=0;t<=143;)vc[2*t+1]=8,t++,f[8]++;for(;t<=255;)vc[2*t+1]=9,t++,f[9]++;for(;t<=279;)vc[2*t+1]=7,t++,f[7]++;for(;t<=287;)vc[2*t+1]=8,t++,f[8]++;for(R7(vc,D0+1,f),t=0;t<nm;t++)c0[2*t+1]=5,c0[2*t]=A7(t,5);$6=new Rw(vc,FD,lI+1,D0,Cf),H6=new Rw(c0,MT,0,nm,Cf),q6=new Rw(new Array(0),rue,0,wN,oue)}(),Y6=!0),e.l_desc=new ww(e.dyn_ltree,$6),e.d_desc=new ww(e.dyn_dtree,H6),e.bl_desc=new ww(e.bl_tree,q6),e.bi_buf=0,e.bi_valid=0,w7(e)}function O7(e,t,o,i){ns(e,(tue<<1)+(i?1:0),3),function(c,u,f,p){D7(c),L0(c,f),L0(c,~f),yc(c.pending_buf,c.window,u,f,c.pending),c.pending+=f}(e,t,o)}function sue(e){ns(e,S7<<1,3),_l(e,DN,vc),function(t){t.bi_valid===16?(L0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(e)}function aue(e,t,o,i){var c,u,f=0;e.level>0?(e.strm.data_type===eue&&(e.strm.data_type=function(p){var m,_=4093624447;for(m=0;m<=31;m++,_>>>=1)if(1&_&&p.dyn_ltree[2*m]!==0)return F6;if(p.dyn_ltree[18]!==0||p.dyn_ltree[20]!==0||p.dyn_ltree[26]!==0)return V6;for(m=32;m<lI;m++)if(p.dyn_ltree[2*m]!==0)return V6;return F6}(e)),Ow(e,e.l_desc),Ow(e,e.d_desc),f=function(p){var m;for(W6(p,p.dyn_ltree,p.l_desc.max_code),W6(p,p.dyn_dtree,p.d_desc.max_code),Ow(p,p.bl_desc),m=wN-1;m>=3&&p.bl_tree[2*B6[m]+1]===0;m--);return p.opt_len+=3*(m+1)+5+5+4,m}(e),c=e.opt_len+3+7>>>3,(u=e.static_len+3+7>>>3)<=c&&(c=u)):c=u=o+5,o+4<=c&&t!==-1?O7(e,t,o,i):e.strategy===Zce||u===c?(ns(e,(S7<<1)+(i?1:0),3),z6(e,vc,c0)):(ns(e,(nue<<1)+(i?1:0),3),function(p,m,_,b){var S;for(ns(p,m-257,5),ns(p,_-1,5),ns(p,b-4,4),S=0;S<b;S++)ns(p,p.bl_tree[2*B6[S]+1],3);j6(p,p.dyn_ltree,m-1),j6(p,p.dyn_dtree,_-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,f+1),z6(e,e.dyn_ltree,e.dyn_dtree)),w7(e),i&&D7(e)}function ud(e,t,o){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&o,e.last_lit++,t===0?e.dyn_ltree[2*o]++:(e.matches++,t--,e.dyn_ltree[2*(N0[o]+lI+1)]++,e.dyn_dtree[2*k7(t)]++),e.last_lit===e.lit_bufsize-1}function VD(e,t,o,i){for(var c=65535&e|0,u=e>>>16&65535|0,f=0;o!==0;){o-=f=o>2e3?2e3:o;do u=u+(c=c+t[i++]|0)|0;while(--f);c%=65521,u%=65521}return c|u<<16|0}var lue=function(){for(var e,t=[],o=0;o<256;o++){e=o;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[o]=e}return t}();function Qr(e,t,o,i){var c=lue,u=i+o;e^=-1;for(var f=i;f<u;f++)e=e>>>8^c[255&(e^t[f])];return-1^e}var zg,Gf=0,cue=1,uue=3,ed=4,J6=5,mf=0,X6=1,Bf=-2,due=-3,Nw=-5,hue=-1,fue=1,JS=2,pue=3,gue=4,mue=2,NN=8,vue=9,GD=286,_ue=30,yue=19,Iue=2*GD+1,bue=15,Fo=3,od=258,Da=od+Fo+1,Cue=32,LN=42,BD=69,kT=73,AT=91,RT=103,Sf=113,Wy=666,Zr=1,u0=2,Tf=3,om=4,Sue=3;function rd(e,t){return e.msg=C7[t],t}function Q6(e){return(e<<1)-(e>4?9:0)}function vf(e){for(var t=e.length;--t>=0;)e[t]=0}function qu(e){var t=e.state,o=t.pending;o>e.avail_out&&(o=e.avail_out),o!==0&&(yc(e.output,t.pending_buf,t.pending_out,o,e.next_out),e.next_out+=o,t.pending_out+=o,e.total_out+=o,e.avail_out-=o,t.pending-=o,t.pending===0&&(t.pending_out=0))}function ci(e,t){aue(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qu(e.strm)}function wo(e,t){e.pending_buf[e.pending++]=t}function Vy(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function N7(e,t){var o,i,c=e.max_chain_length,u=e.strstart,f=e.prev_length,p=e.nice_match,m=e.strstart>e.w_size-Da?e.strstart-(e.w_size-Da):0,_=e.window,b=e.w_mask,S=e.prev,T=e.strstart+od,M=_[u+f-1],R=_[u+f];e.prev_length>=e.good_match&&(c>>=2),p>e.lookahead&&(p=e.lookahead);do if(_[(o=t)+f]===R&&_[o+f-1]===M&&_[o]===_[u]&&_[++o]===_[u+1]){u+=2,o++;do;while(_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&u<T);if(i=od-(T-u),u=T-od,i>f){if(e.match_start=t,f=i,i>=p)break;M=_[u+f-1],R=_[u+f]}}while((t=S[t&b])>m&&--c!=0);return f<=e.lookahead?f:e.lookahead}function P0(e){var t,o,i,c,u,f,p,m,_,b,S=e.w_size;do{if(c=e.window_size-e.lookahead-e.strstart,e.strstart>=S+(S-Da)){yc(e.window,e.window,S,S,0),e.match_start-=S,e.strstart-=S,e.block_start-=S,t=o=e.hash_size;do i=e.head[--t],e.head[t]=i>=S?i-S:0;while(--o);t=o=S;do i=e.prev[--t],e.prev[t]=i>=S?i-S:0;while(--o);c+=S}if(e.strm.avail_in===0)break;if(f=e.strm,p=e.window,m=e.strstart+e.lookahead,_=c,b=void 0,(b=f.avail_in)>_&&(b=_),o=b===0?0:(f.avail_in-=b,yc(p,f.input,f.next_in,b,m),f.state.wrap===1?f.adler=VD(f.adler,p,b,m):f.state.wrap===2&&(f.adler=Qr(f.adler,p,b,m)),f.next_in+=b,f.total_in+=b,b),e.lookahead+=o,e.lookahead+e.insert>=Fo)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+Fo-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<Fo)););}while(e.lookahead<Da&&e.strm.avail_in!==0)}function Lw(e,t){for(var o,i;;){if(e.lookahead<Da){if(P0(e),e.lookahead<Da&&t===Gf)return Zr;if(e.lookahead===0)break}if(o=0,e.lookahead>=Fo&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Fo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),o!==0&&e.strstart-o<=e.w_size-Da&&(e.match_length=N7(e,o)),e.match_length>=Fo)if(i=ud(e,e.strstart-e.match_start,e.match_length-Fo),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Fo){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Fo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=ud(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ci(e,!1),e.strm.avail_out===0))return Zr}return e.insert=e.strstart<Fo-1?e.strstart:Fo-1,t===ed?(ci(e,!0),e.strm.avail_out===0?Tf:om):e.last_lit&&(ci(e,!1),e.strm.avail_out===0)?Zr:u0}function Ng(e,t){for(var o,i,c;;){if(e.lookahead<Da){if(P0(e),e.lookahead<Da&&t===Gf)return Zr;if(e.lookahead===0)break}if(o=0,e.lookahead>=Fo&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Fo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Fo-1,o!==0&&e.prev_length<e.max_lazy_match&&e.strstart-o<=e.w_size-Da&&(e.match_length=N7(e,o),e.match_length<=5&&(e.strategy===fue||e.match_length===Fo&&e.strstart-e.match_start>4096)&&(e.match_length=Fo-1)),e.prev_length>=Fo&&e.match_length<=e.prev_length){c=e.strstart+e.lookahead-Fo,i=ud(e,e.strstart-1-e.prev_match,e.prev_length-Fo),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=c&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Fo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=Fo-1,e.strstart++,i&&(ci(e,!1),e.strm.avail_out===0))return Zr}else if(e.match_available){if((i=ud(e,0,e.window[e.strstart-1]))&&ci(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Zr}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=ud(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Fo-1?e.strstart:Fo-1,t===ed?(ci(e,!0),e.strm.avail_out===0?Tf:om):e.last_lit&&(ci(e,!1),e.strm.avail_out===0)?Zr:u0}function hl(e,t,o,i,c){this.good_length=e,this.max_lazy=t,this.nice_length=o,this.max_chain=i,this.func=c}function Tue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=NN,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new js(2*Iue),this.dyn_dtree=new js(2*(2*_ue+1)),this.bl_tree=new js(2*(2*yue+1)),vf(this.dyn_ltree),vf(this.dyn_dtree),vf(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new js(bue+1),this.heap=new js(2*GD+1),vf(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new js(2*GD+1),vf(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z6(e){var t,o=function(i){var c;return i&&i.state?(i.total_in=i.total_out=0,i.data_type=mue,(c=i.state).pending=0,c.pending_out=0,c.wrap<0&&(c.wrap=-c.wrap),c.status=c.wrap?LN:Sf,i.adler=c.wrap===2?0:1,c.last_flush=Gf,iue(c),mf):rd(i,Bf)}(e);return o===mf&&((t=e.state).window_size=2*t.w_size,vf(t.head),t.max_lazy_match=zg[t.level].max_lazy,t.good_match=zg[t.level].good_length,t.nice_match=zg[t.level].nice_length,t.max_chain_length=zg[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Fo-1,t.match_available=0,t.ins_h=0),o}function Eue(e,t){var o,i,c,u;if(!e||!e.state||t>J6||t<0)return e?rd(e,Bf):Bf;if(i=e.state,!e.output||!e.input&&e.avail_in!==0||i.status===Wy&&t!==ed)return rd(e,e.avail_out===0?Nw:Bf);if(i.strm=e,o=i.last_flush,i.last_flush=t,i.status===LN)if(i.wrap===2)e.adler=0,wo(i,31),wo(i,139),wo(i,8),i.gzhead?(wo(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),wo(i,255&i.gzhead.time),wo(i,i.gzhead.time>>8&255),wo(i,i.gzhead.time>>16&255),wo(i,i.gzhead.time>>24&255),wo(i,i.level===9?2:i.strategy>=JS||i.level<2?4:0),wo(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(wo(i,255&i.gzhead.extra.length),wo(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Qr(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=BD):(wo(i,0),wo(i,0),wo(i,0),wo(i,0),wo(i,0),wo(i,i.level===9?2:i.strategy>=JS||i.level<2?4:0),wo(i,Sue),i.status=Sf);else{var f=NN+(i.w_bits-8<<4)<<8;f|=(i.strategy>=JS||i.level<2?0:i.level<6?1:i.level===6?2:3)<<6,i.strstart!==0&&(f|=Cue),f+=31-f%31,i.status=Sf,Vy(i,f),i.strstart!==0&&(Vy(i,e.adler>>>16),Vy(i,65535&e.adler)),e.adler=1}if(i.status===BD)if(i.gzhead.extra){for(c=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),qu(e),c=i.pending,i.pending!==i.pending_buf_size));)wo(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=kT)}else i.status=kT;if(i.status===kT)if(i.gzhead.name){c=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),qu(e),c=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,wo(i,u)}while(u!==0);i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),u===0&&(i.gzindex=0,i.status=AT)}else i.status=AT;if(i.status===AT)if(i.gzhead.comment){c=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),qu(e),c=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,wo(i,u)}while(u!==0);i.gzhead.hcrc&&i.pending>c&&(e.adler=Qr(e.adler,i.pending_buf,i.pending-c,c)),u===0&&(i.status=RT)}else i.status=RT;if(i.status===RT&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&qu(e),i.pending+2<=i.pending_buf_size&&(wo(i,255&e.adler),wo(i,e.adler>>8&255),e.adler=0,i.status=Sf)):i.status=Sf),i.pending!==0){if(qu(e),e.avail_out===0)return i.last_flush=-1,mf}else if(e.avail_in===0&&Q6(t)<=Q6(o)&&t!==ed)return rd(e,Nw);if(i.status===Wy&&e.avail_in!==0)return rd(e,Nw);if(e.avail_in!==0||i.lookahead!==0||t!==Gf&&i.status!==Wy){var p=i.strategy===JS?function(m,_){for(var b;;){if(m.lookahead===0&&(P0(m),m.lookahead===0)){if(_===Gf)return Zr;break}if(m.match_length=0,b=ud(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++,b&&(ci(m,!1),m.strm.avail_out===0))return Zr}return m.insert=0,_===ed?(ci(m,!0),m.strm.avail_out===0?Tf:om):m.last_lit&&(ci(m,!1),m.strm.avail_out===0)?Zr:u0}(i,t):i.strategy===pue?function(m,_){for(var b,S,T,M,R=m.window;;){if(m.lookahead<=od){if(P0(m),m.lookahead<=od&&_===Gf)return Zr;if(m.lookahead===0)break}if(m.match_length=0,m.lookahead>=Fo&&m.strstart>0&&(S=R[T=m.strstart-1])===R[++T]&&S===R[++T]&&S===R[++T]){M=m.strstart+od;do;while(S===R[++T]&&S===R[++T]&&S===R[++T]&&S===R[++T]&&S===R[++T]&&S===R[++T]&&S===R[++T]&&S===R[++T]&&T<M);m.match_length=od-(M-T),m.match_length>m.lookahead&&(m.match_length=m.lookahead)}if(m.match_length>=Fo?(b=ud(m,1,m.match_length-Fo),m.lookahead-=m.match_length,m.strstart+=m.match_length,m.match_length=0):(b=ud(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++),b&&(ci(m,!1),m.strm.avail_out===0))return Zr}return m.insert=0,_===ed?(ci(m,!0),m.strm.avail_out===0?Tf:om):m.last_lit&&(ci(m,!1),m.strm.avail_out===0)?Zr:u0}(i,t):zg[i.level].func(i,t);if(p!==Tf&&p!==om||(i.status=Wy),p===Zr||p===Tf)return e.avail_out===0&&(i.last_flush=-1),mf;if(p===u0&&(t===cue?sue(i):t!==J6&&(O7(i,0,0,!1),t===uue&&(vf(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),qu(e),e.avail_out===0))return i.last_flush=-1,mf}return t!==ed?mf:i.wrap<=0?X6:(i.wrap===2?(wo(i,255&e.adler),wo(i,e.adler>>8&255),wo(i,e.adler>>16&255),wo(i,e.adler>>24&255),wo(i,255&e.total_in),wo(i,e.total_in>>8&255),wo(i,e.total_in>>16&255),wo(i,e.total_in>>24&255)):(Vy(i,e.adler>>>16),Vy(i,65535&e.adler)),qu(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?mf:X6)}zg=[new hl(0,0,0,0,function(e,t){var o=65535;for(o>e.pending_buf_size-5&&(o=e.pending_buf_size-5);;){if(e.lookahead<=1){if(P0(e),e.lookahead===0&&t===Gf)return Zr;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+o;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,ci(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Da&&(ci(e,!1),e.strm.avail_out===0))return Zr}return e.insert=0,t===ed?(ci(e,!0),e.strm.avail_out===0?Tf:om):(e.strstart>e.block_start&&(ci(e,!1),e.strm.avail_out),Zr)}),new hl(4,4,8,4,Lw),new hl(4,5,16,8,Lw),new hl(4,6,32,32,Lw),new hl(4,4,16,16,Ng),new hl(8,16,32,32,Ng),new hl(8,16,128,128,Ng),new hl(8,32,128,256,Ng),new hl(32,128,258,1024,Ng),new hl(32,258,258,4096,Ng)];var XS=30,Mue=12;function kue(e,t){var o,i,c,u,f,p,m,_,b,S,T,M,R,E,N,D,x,L,F,H,B,z,W,Z,$;o=e.state,i=e.next_in,Z=e.input,c=i+(e.avail_in-5),u=e.next_out,$=e.output,f=u-(t-e.avail_out),p=u+(e.avail_out-257),m=o.dmax,_=o.wsize,b=o.whave,S=o.wnext,T=o.window,M=o.hold,R=o.bits,E=o.lencode,N=o.distcode,D=(1<<o.lenbits)-1,x=(1<<o.distbits)-1;e:do{R<15&&(M+=Z[i++]<<R,R+=8,M+=Z[i++]<<R,R+=8),L=E[M&D];t:for(;;){if(M>>>=F=L>>>24,R-=F,(F=L>>>16&255)===0)$[u++]=65535&L;else{if(!(16&F)){if(!(64&F)){L=E[(65535&L)+(M&(1<<F)-1)];continue t}if(32&F){o.mode=Mue;break e}e.msg="invalid literal/length code",o.mode=XS;break e}H=65535&L,(F&=15)&&(R<F&&(M+=Z[i++]<<R,R+=8),H+=M&(1<<F)-1,M>>>=F,R-=F),R<15&&(M+=Z[i++]<<R,R+=8,M+=Z[i++]<<R,R+=8),L=N[M&x];n:for(;;){if(M>>>=F=L>>>24,R-=F,!(16&(F=L>>>16&255))){if(!(64&F)){L=N[(65535&L)+(M&(1<<F)-1)];continue n}e.msg="invalid distance code",o.mode=XS;break e}if(B=65535&L,R<(F&=15)&&(M+=Z[i++]<<R,(R+=8)<F&&(M+=Z[i++]<<R,R+=8)),(B+=M&(1<<F)-1)>m){e.msg="invalid distance too far back",o.mode=XS;break e}if(M>>>=F,R-=F,B>(F=u-f)){if((F=B-F)>b&&o.sane){e.msg="invalid distance too far back",o.mode=XS;break e}if(z=0,W=T,S===0){if(z+=_-F,F<H){H-=F;do $[u++]=T[z++];while(--F);z=u-B,W=$}}else if(S<F){if(z+=_+S-F,(F-=S)<H){H-=F;do $[u++]=T[z++];while(--F);if(z=0,S<H){H-=F=S;do $[u++]=T[z++];while(--F);z=u-B,W=$}}}else if(z+=S-F,F<H){H-=F;do $[u++]=T[z++];while(--F);z=u-B,W=$}for(;H>2;)$[u++]=W[z++],$[u++]=W[z++],$[u++]=W[z++],H-=3;H&&($[u++]=W[z++],H>1&&($[u++]=W[z++]))}else{z=u-B;do $[u++]=$[z++],$[u++]=$[z++],$[u++]=$[z++],H-=3;while(H>2);H&&($[u++]=$[z++],H>1&&($[u++]=$[z++]))}break}}break}}while(i<c&&u<p);i-=H=R>>3,M&=(1<<(R-=H<<3))-1,e.next_in=i,e.next_out=u,e.avail_in=i<c?c-i+5:5-(i-c),e.avail_out=u<p?p-u+257:257-(u-p),o.hold=M,o.bits=R}var Lg=15,e5=852,t5=592,n5=0,Pw=1,o5=2,Aue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Rue=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],wue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Due=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function d0(e,t,o,i,c,u,f,p){var m,_,b,S,T,M,R,E,N,D=p.bits,x=0,L=0,F=0,H=0,B=0,z=0,W=0,Z=0,$=0,O=0,X=null,le=0,de=new js(Lg+1),he=new js(Lg+1),se=null,ie=0;for(x=0;x<=Lg;x++)de[x]=0;for(L=0;L<i;L++)de[t[o+L]]++;for(B=D,H=Lg;H>=1&&de[H]===0;H--);if(B>H&&(B=H),H===0)return c[u++]=20971520,c[u++]=20971520,p.bits=1,0;for(F=1;F<H&&de[F]===0;F++);for(B<F&&(B=F),Z=1,x=1;x<=Lg;x++)if(Z<<=1,(Z-=de[x])<0)return-1;if(Z>0&&(e===n5||H!==1))return-1;for(he[1]=0,x=1;x<Lg;x++)he[x+1]=he[x]+de[x];for(L=0;L<i;L++)t[o+L]!==0&&(f[he[t[o+L]]++]=L);if(e===n5?(X=se=f,M=19):e===Pw?(X=Aue,le-=257,se=Rue,ie-=257,M=256):(X=wue,se=Due,M=-1),O=0,L=0,x=F,T=u,z=B,W=0,b=-1,S=($=1<<B)-1,e===Pw&&$>e5||e===o5&&$>t5)return 1;for(;;){R=x-W,f[L]<M?(E=0,N=f[L]):f[L]>M?(E=se[ie+f[L]],N=X[le+f[L]]):(E=96,N=0),m=1<<x-W,F=_=1<<z;do c[T+(O>>W)+(_-=m)]=R<<24|E<<16|N|0;while(_!==0);for(m=1<<x-1;O&m;)m>>=1;if(m!==0?(O&=m-1,O+=m):O=0,L++,--de[x]==0){if(x===H)break;x=t[o+f[L]]}if(x>B&&(O&S)!==b){for(W===0&&(W=B),T+=F,Z=1<<(z=x-W);z+W<H&&!((Z-=de[z+W])<=0);)z++,Z<<=1;if($+=1<<z,e===Pw&&$>e5||e===o5&&$>t5)return 1;c[b=O&S]=B<<24|z<<16|T-u|0}}return O!==0&&(c[T+O]=x-W<<24|64<<16|0),p.bits=B,0}var Oue=0,L7=1,P7=2,r5=4,Nue=5,QS=6,vE=0,Lue=1,Pue=2,dd=-2,Uue=-3,xue=-4,Fue=-5,i5=8,U7=1,s5=2,a5=3,l5=4,c5=5,u5=6,d5=7,h5=8,f5=9,p5=10,g5=11,pc=12,Uw=13,m5=14,xw=15,v5=16,_5=17,y5=18,I5=19,ZS=20,eT=21,b5=22,C5=23,S5=24,T5=25,E5=26,Fw=27,M5=28,k5=29,dr=30,Vue=31,Gue=32,Bue=852,$ue=592;function A5(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Hue(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new js(320),this.work=new js(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x7(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function(o){var i;return o&&o.state?(i=o.state,o.total_in=o.total_out=i.total=0,o.msg="",i.wrap&&(o.adler=1&i.wrap),i.mode=U7,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new gE(Bue),i.distcode=i.distdyn=new gE($ue),i.sane=1,i.back=-1,vE):dd}(e)):dd}function que(e,t){var o,i;return e?(i=new Hue,e.state=i,i.window=null,(o=function(c,u){var f,p;return c&&c.state?(p=c.state,u<0?(f=0,u=-u):(f=1+(u>>4),u<48&&(u&=15)),u&&(u<8||u>15)?dd:(p.window!==null&&p.wbits!==u&&(p.window=null),p.wrap=f,p.wbits=u,x7(c))):dd}(e,t))!==vE&&(e.state=null),o):dd}var Vw,Gw,R5=!0;function Kue(e){if(R5){var t;for(Vw=new gE(512),Gw=new gE(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(d0(L7,e.lens,0,288,Vw,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;d0(P7,e.lens,0,32,Gw,0,e.work,{bits:5}),R5=!1}e.lencode=Vw,e.lenbits=9,e.distcode=Gw,e.distbits=5}function zue(e,t){var o,i,c,u,f,p,m,_,b,S,T,M,R,E,N,D,x,L,F,H,B,z,W,Z,$=0,O=new pE(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return dd;(o=e.state).mode===pc&&(o.mode=Uw),f=e.next_out,c=e.output,m=e.avail_out,u=e.next_in,i=e.input,p=e.avail_in,_=o.hold,b=o.bits,S=p,T=m,z=vE;e:for(;;)switch(o.mode){case U7:if(o.wrap===0){o.mode=Uw;break}for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(2&o.wrap&&_===35615){o.check=0,O[0]=255&_,O[1]=_>>>8&255,o.check=Qr(o.check,O,2,0),_=0,b=0,o.mode=s5;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&_)<<8)+(_>>8))%31){e.msg="incorrect header check",o.mode=dr;break}if((15&_)!==i5){e.msg="unknown compression method",o.mode=dr;break}if(b-=4,B=8+(15&(_>>>=4)),o.wbits===0)o.wbits=B;else if(B>o.wbits){e.msg="invalid window size",o.mode=dr;break}o.dmax=1<<B,e.adler=o.check=1,o.mode=512&_?p5:pc,_=0,b=0;break;case s5:for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(o.flags=_,(255&o.flags)!==i5){e.msg="unknown compression method",o.mode=dr;break}if(57344&o.flags){e.msg="unknown header flags set",o.mode=dr;break}o.head&&(o.head.text=_>>8&1),512&o.flags&&(O[0]=255&_,O[1]=_>>>8&255,o.check=Qr(o.check,O,2,0)),_=0,b=0,o.mode=a5;case a5:for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.head&&(o.head.time=_),512&o.flags&&(O[0]=255&_,O[1]=_>>>8&255,O[2]=_>>>16&255,O[3]=_>>>24&255,o.check=Qr(o.check,O,4,0)),_=0,b=0,o.mode=l5;case l5:for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.head&&(o.head.xflags=255&_,o.head.os=_>>8),512&o.flags&&(O[0]=255&_,O[1]=_>>>8&255,o.check=Qr(o.check,O,2,0)),_=0,b=0,o.mode=c5;case c5:if(1024&o.flags){for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.length=_,o.head&&(o.head.extra_len=_),512&o.flags&&(O[0]=255&_,O[1]=_>>>8&255,o.check=Qr(o.check,O,2,0)),_=0,b=0}else o.head&&(o.head.extra=null);o.mode=u5;case u5:if(1024&o.flags&&((M=o.length)>p&&(M=p),M&&(o.head&&(B=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),yc(o.head.extra,i,u,M,B)),512&o.flags&&(o.check=Qr(o.check,i,M,u)),p-=M,u+=M,o.length-=M),o.length))break e;o.length=0,o.mode=d5;case d5:if(2048&o.flags){if(p===0)break e;M=0;do B=i[u+M++],o.head&&B&&o.length<65536&&(o.head.name+=String.fromCharCode(B));while(B&&M<p);if(512&o.flags&&(o.check=Qr(o.check,i,M,u)),p-=M,u+=M,B)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=h5;case h5:if(4096&o.flags){if(p===0)break e;M=0;do B=i[u+M++],o.head&&B&&o.length<65536&&(o.head.comment+=String.fromCharCode(B));while(B&&M<p);if(512&o.flags&&(o.check=Qr(o.check,i,M,u)),p-=M,u+=M,B)break e}else o.head&&(o.head.comment=null);o.mode=f5;case f5:if(512&o.flags){for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_!==(65535&o.check)){e.msg="header crc mismatch",o.mode=dr;break}_=0,b=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),e.adler=o.check=0,o.mode=pc;break;case p5:for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}e.adler=o.check=A5(_),_=0,b=0,o.mode=g5;case g5:if(o.havedict===0)return e.next_out=f,e.avail_out=m,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,Pue;e.adler=o.check=1,o.mode=pc;case pc:if(t===Nue||t===QS)break e;case Uw:if(o.last){_>>>=7&b,b-=7&b,o.mode=Fw;break}for(;b<3;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}switch(o.last=1&_,b-=1,3&(_>>>=1)){case 0:o.mode=m5;break;case 1:if(Kue(o),o.mode=ZS,t===QS){_>>>=2,b-=2;break e}break;case 2:o.mode=_5;break;case 3:e.msg="invalid block type",o.mode=dr}_>>>=2,b-=2;break;case m5:for(_>>>=7&b,b-=7&b;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if((65535&_)!=(_>>>16^65535)){e.msg="invalid stored block lengths",o.mode=dr;break}if(o.length=65535&_,_=0,b=0,o.mode=xw,t===QS)break e;case xw:o.mode=v5;case v5:if(M=o.length){if(M>p&&(M=p),M>m&&(M=m),M===0)break e;yc(c,i,u,M,f),p-=M,u+=M,m-=M,f+=M,o.length-=M;break}o.mode=pc;break;case _5:for(;b<14;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(o.nlen=257+(31&_),_>>>=5,b-=5,o.ndist=1+(31&_),_>>>=5,b-=5,o.ncode=4+(15&_),_>>>=4,b-=4,o.nlen>286||o.ndist>30){e.msg="too many length or distance symbols",o.mode=dr;break}o.have=0,o.mode=y5;case y5:for(;o.have<o.ncode;){for(;b<3;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.lens[X[o.have++]]=7&_,_>>>=3,b-=3}for(;o.have<19;)o.lens[X[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,W={bits:o.lenbits},z=d0(Oue,o.lens,0,19,o.lencode,0,o.work,W),o.lenbits=W.bits,z){e.msg="invalid code lengths set",o.mode=dr;break}o.have=0,o.mode=I5;case I5:for(;o.have<o.nlen+o.ndist;){for(;D=($=o.lencode[_&(1<<o.lenbits)-1])>>>16&255,x=65535&$,!((N=$>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(x<16)_>>>=N,b-=N,o.lens[o.have++]=x;else{if(x===16){for(Z=N+2;b<Z;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_>>>=N,b-=N,o.have===0){e.msg="invalid bit length repeat",o.mode=dr;break}B=o.lens[o.have-1],M=3+(3&_),_>>>=2,b-=2}else if(x===17){for(Z=N+3;b<Z;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}b-=N,B=0,M=3+(7&(_>>>=N)),_>>>=3,b-=3}else{for(Z=N+7;b<Z;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}b-=N,B=0,M=11+(127&(_>>>=N)),_>>>=7,b-=7}if(o.have+M>o.nlen+o.ndist){e.msg="invalid bit length repeat",o.mode=dr;break}for(;M--;)o.lens[o.have++]=B}}if(o.mode===dr)break;if(o.lens[256]===0){e.msg="invalid code -- missing end-of-block",o.mode=dr;break}if(o.lenbits=9,W={bits:o.lenbits},z=d0(L7,o.lens,0,o.nlen,o.lencode,0,o.work,W),o.lenbits=W.bits,z){e.msg="invalid literal/lengths set",o.mode=dr;break}if(o.distbits=6,o.distcode=o.distdyn,W={bits:o.distbits},z=d0(P7,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,W),o.distbits=W.bits,z){e.msg="invalid distances set",o.mode=dr;break}if(o.mode=ZS,t===QS)break e;case ZS:o.mode=eT;case eT:if(p>=6&&m>=258){e.next_out=f,e.avail_out=m,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,kue(e,T),f=e.next_out,c=e.output,m=e.avail_out,u=e.next_in,i=e.input,p=e.avail_in,_=o.hold,b=o.bits,o.mode===pc&&(o.back=-1);break}for(o.back=0;D=($=o.lencode[_&(1<<o.lenbits)-1])>>>16&255,x=65535&$,!((N=$>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(D&&!(240&D)){for(L=N,F=D,H=x;D=($=o.lencode[H+((_&(1<<L+F)-1)>>L)])>>>16&255,x=65535&$,!(L+(N=$>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}_>>>=L,b-=L,o.back+=L}if(_>>>=N,b-=N,o.back+=N,o.length=x,D===0){o.mode=E5;break}if(32&D){o.back=-1,o.mode=pc;break}if(64&D){e.msg="invalid literal/length code",o.mode=dr;break}o.extra=15&D,o.mode=b5;case b5:if(o.extra){for(Z=o.extra;b<Z;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.length+=_&(1<<o.extra)-1,_>>>=o.extra,b-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=C5;case C5:for(;D=($=o.distcode[_&(1<<o.distbits)-1])>>>16&255,x=65535&$,!((N=$>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(!(240&D)){for(L=N,F=D,H=x;D=($=o.distcode[H+((_&(1<<L+F)-1)>>L)])>>>16&255,x=65535&$,!(L+(N=$>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}_>>>=L,b-=L,o.back+=L}if(_>>>=N,b-=N,o.back+=N,64&D){e.msg="invalid distance code",o.mode=dr;break}o.offset=x,o.extra=15&D,o.mode=S5;case S5:if(o.extra){for(Z=o.extra;b<Z;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.offset+=_&(1<<o.extra)-1,_>>>=o.extra,b-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){e.msg="invalid distance too far back",o.mode=dr;break}o.mode=T5;case T5:if(m===0)break e;if(M=T-m,o.offset>M){if((M=o.offset-M)>o.whave&&o.sane){e.msg="invalid distance too far back",o.mode=dr;break}M>o.wnext?(M-=o.wnext,R=o.wsize-M):R=o.wnext-M,M>o.length&&(M=o.length),E=o.window}else E=c,R=f-o.offset,M=o.length;M>m&&(M=m),m-=M,o.length-=M;do c[f++]=E[R++];while(--M);o.length===0&&(o.mode=eT);break;case E5:if(m===0)break e;c[f++]=o.length,m--,o.mode=eT;break;case Fw:if(o.wrap){for(;b<32;){if(p===0)break e;p--,_|=i[u++]<<b,b+=8}if(T-=m,e.total_out+=T,o.total+=T,T&&(e.adler=o.check=o.flags?Qr(o.check,c,T,f-T):VD(o.check,c,T,f-T)),T=m,(o.flags?_:A5(_))!==o.check){e.msg="incorrect data check",o.mode=dr;break}_=0,b=0}o.mode=M5;case M5:if(o.wrap&&o.flags){for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_!==(4294967295&o.total)){e.msg="incorrect length check",o.mode=dr;break}_=0,b=0}o.mode=k5;case k5:z=Lue;break e;case dr:z=Uue;break e;case Vue:return xue;case Gue:default:return dd}return e.next_out=f,e.avail_out=m,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,(o.wsize||T!==e.avail_out&&o.mode<dr&&(o.mode<Fw||t!==r5))&&function(le,de,he,se){var ie,oe=le.state;oe.window===null&&(oe.wsize=1<<oe.wbits,oe.wnext=0,oe.whave=0,oe.window=new pE(oe.wsize)),se>=oe.wsize?(yc(oe.window,de,he-oe.wsize,oe.wsize,0),oe.wnext=0,oe.whave=oe.wsize):((ie=oe.wsize-oe.wnext)>se&&(ie=se),yc(oe.window,de,he-se,ie,oe.wnext),(se-=ie)?(yc(oe.window,de,he-se,se,0),oe.wnext=se,oe.whave=oe.wsize):(oe.wnext+=ie,oe.wnext===oe.wsize&&(oe.wnext=0),oe.whave<oe.wsize&&(oe.whave+=ie)))}(e,e.output,e.next_out,T-e.avail_out),S-=e.avail_in,T-=e.avail_out,e.total_in+=S,e.total_out+=T,o.total+=T,o.wrap&&T&&(e.adler=o.check=o.flags?Qr(o.check,c,T,e.next_out-T):VD(o.check,c,T,e.next_out-T)),e.data_type=o.bits+(o.last?64:0)+(o.mode===pc?128:0)+(o.mode===ZS||o.mode===xw?256:0),(S===0&&T===0||t===r5)&&z===vE&&(z=Fue),z}var tT,Wg=1,h0=7;function fl(e){if(e<Wg||e>h0)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function Wue(e,t){for(var o=0;o<e.length;o++)this[t+o]=e[o]}fl.prototype.init=function(e,t,o,i,c){var u;switch(this.windowBits=e,this.level=t,this.memLevel=o,this.strategy=i,this.mode!==3&&this.mode!==4||(this.windowBits+=16),this.mode===h0&&(this.windowBits+=32),this.mode!==5&&this.mode!==6||(this.windowBits=-this.windowBits),this.strm=new Qce,this.mode){case Wg:case 3:case 5:u=function(f,p,m,_,b,S){if(!f)return Bf;var T=1;if(p===hue&&(p=6),_<0?(T=0,_=-_):_>15&&(T=2,_-=16),b<1||b>vue||m!==NN||_<8||_>15||p<0||p>9||S<0||S>gue)return rd(f,Bf);_===8&&(_=9);var M=new Tue;return f.state=M,M.strm=f,M.wrap=T,M.gzhead=null,M.w_bits=_,M.w_size=1<<M.w_bits,M.w_mask=M.w_size-1,M.hash_bits=b+7,M.hash_size=1<<M.hash_bits,M.hash_mask=M.hash_size-1,M.hash_shift=~~((M.hash_bits+Fo-1)/Fo),M.window=new pE(2*M.w_size),M.head=new js(M.hash_size),M.prev=new js(M.w_size),M.lit_bufsize=1<<b+6,M.pending_buf_size=4*M.lit_bufsize,M.pending_buf=new pE(M.pending_buf_size),M.d_buf=1*M.lit_bufsize,M.l_buf=3*M.lit_bufsize,M.level=p,M.strategy=S,M.method=m,Z6(f)}(this.strm,this.level,8,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case h0:u=que(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}u===0?(this.write_in_progress=!1,this.init_done=!0):this._error(u)},fl.prototype.params=function(){throw new Error("deflateParams Not supported")},fl.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===0)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},fl.prototype.write=function(e,t,o,i,c,u,f){this._writeCheck(),this.write_in_progress=!0;var p=this;return li(function(){p.write_in_progress=!1;var m=p._write(e,t,o,i,c,u,f);p.callback(m[0],m[1]),p.pending_close&&p.close()}),this},fl.prototype.writeSync=function(e,t,o,i,c,u,f){return this._writeCheck(),this._write(e,t,o,i,c,u,f)},fl.prototype._write=function(e,t,o,i,c,u,f){if(this.write_in_progress=!0,e!==0&&e!==1&&e!==2&&e!==3&&e!==4&&e!==5)throw new Error("Invalid flush value");t==null&&(t=new Ot(0),i=0,o=0),c._set?c.set=c._set:c.set=Wue;var p,m=this.strm;switch(m.avail_in=i,m.input=t,m.next_in=o,m.avail_out=f,m.output=c,m.next_out=u,this.mode){case Wg:case 3:case 5:p=Eue(m,e);break;case h0:case 2:case 4:case 6:p=zue(m,e);break;default:throw new Error("Unknown mode "+this.mode)}return p!==1&&p!==0&&this._error(p),this.write_in_progress=!1,[m.avail_in,m.avail_out]},fl.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===Wg||this.mode===3||this.mode===5?function(e){var t;e&&e.state&&((t=e.state.status)!==LN&&t!==BD&&t!==kT&&t!==AT&&t!==RT&&t!==Sf&&t!==Wy?rd(e,Bf):(e.state=null,t===Sf&&rd(e,due)))}(this.strm):function(e){if(!e||!e.state)return dd;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},fl.prototype.reset=function(){switch(this.mode){case Wg:case 5:tT=Z6(this.strm);break;case 2:case 6:tT=x7(this.strm)}tT!==0&&this._error(tT)},fl.prototype._error=function(e){this.onerror(C7[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var w5=Object.freeze({NONE:0,DEFLATE:Wg,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:h0,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:fl}),vn={};Object.keys(w5).forEach(function(e){vn[e]=w5[e]}),vn.Z_MIN_WINDOWBITS=8,vn.Z_MAX_WINDOWBITS=15,vn.Z_DEFAULT_WINDOWBITS=15,vn.Z_MIN_CHUNK=64,vn.Z_MAX_CHUNK=1/0,vn.Z_DEFAULT_CHUNK=16384,vn.Z_MIN_MEMLEVEL=1,vn.Z_MAX_MEMLEVEL=9,vn.Z_DEFAULT_MEMLEVEL=8,vn.Z_MIN_LEVEL=-1,vn.Z_MAX_LEVEL=9,vn.Z_DEFAULT_LEVEL=vn.Z_DEFAULT_COMPRESSION;var wT={Z_OK:vn.Z_OK,Z_STREAM_END:vn.Z_STREAM_END,Z_NEED_DICT:vn.Z_NEED_DICT,Z_ERRNO:vn.Z_ERRNO,Z_STREAM_ERROR:vn.Z_STREAM_ERROR,Z_DATA_ERROR:vn.Z_DATA_ERROR,Z_MEM_ERROR:vn.Z_MEM_ERROR,Z_BUF_ERROR:vn.Z_BUF_ERROR,Z_VERSION_ERROR:vn.Z_VERSION_ERROR};function cf(e,t,o){var i=[],c=0;function u(){for(var p;(p=e.read())!==null;)i.push(p),c+=p.length;e.once("readable",u)}function f(){var p=Ot.concat(i,c);i=[],o(null,p),e.close()}e.on("error",function(p){e.removeListener("end",f),e.removeListener("readable",u),o(p)}),e.on("end",f),e.end(t),u()}function uf(e,t){if(typeof t=="string"&&(t=new Ot(t)),!iI(t))throw new TypeError("Not a string or buffer");var o=vn.Z_FINISH;return e._processChunk(t,o)}function Ef(e){if(!(this instanceof Ef))return new Ef(e);vr.call(this,e,vn.DEFLATE)}function Mf(e){if(!(this instanceof Mf))return new Mf(e);vr.call(this,e,vn.INFLATE)}function kf(e){if(!(this instanceof kf))return new kf(e);vr.call(this,e,vn.GZIP)}function Af(e){if(!(this instanceof Af))return new Af(e);vr.call(this,e,vn.GUNZIP)}function Rf(e){if(!(this instanceof Rf))return new Rf(e);vr.call(this,e,vn.DEFLATERAW)}function wf(e){if(!(this instanceof wf))return new wf(e);vr.call(this,e,vn.INFLATERAW)}function Df(e){if(!(this instanceof Df))return new Df(e);vr.call(this,e,vn.UNZIP)}function vr(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||vn.Z_DEFAULT_CHUNK,zs.call(this,e),e.flush&&e.flush!==vn.Z_NO_FLUSH&&e.flush!==vn.Z_PARTIAL_FLUSH&&e.flush!==vn.Z_SYNC_FLUSH&&e.flush!==vn.Z_FULL_FLUSH&&e.flush!==vn.Z_FINISH&&e.flush!==vn.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||vn.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<vn.Z_MIN_CHUNK||e.chunkSize>vn.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<vn.Z_MIN_WINDOWBITS||e.windowBits>vn.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<vn.Z_MIN_LEVEL||e.level>vn.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<vn.Z_MIN_MEMLEVEL||e.memLevel>vn.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=vn.Z_FILTERED&&e.strategy!=vn.Z_HUFFMAN_ONLY&&e.strategy!=vn.Z_RLE&&e.strategy!=vn.Z_FIXED&&e.strategy!=vn.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!iI(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new vn.Zlib(t);var o=this;this._hadError=!1,this._binding.onerror=function(u,f){o._binding=null,o._hadError=!0;var p=new Error(u);p.errno=f,p.code=vn.codes[f],o.emit("error",p)};var i=vn.Z_DEFAULT_COMPRESSION;typeof e.level=="number"&&(i=e.level);var c=vn.Z_DEFAULT_STRATEGY;typeof e.strategy=="number"&&(c=e.strategy),this._binding.init(e.windowBits||vn.Z_DEFAULT_WINDOWBITS,i,e.memLevel||vn.Z_DEFAULT_MEMLEVEL,c,e.dictionary),this._buffer=new Ot(this._chunkSize),this._offset=0,this._closed=!1,this._level=i,this._strategy=c,this.once("end",this.close)}Object.keys(wT).forEach(function(e){wT[wT[e]]=e}),ts(vr,zs),vr.prototype.params=function(e,t,o){if(e<vn.Z_MIN_LEVEL||e>vn.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=vn.Z_FILTERED&&t!=vn.Z_HUFFMAN_ONLY&&t!=vn.Z_RLE&&t!=vn.Z_FIXED&&t!=vn.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var i=this;this.flush(vn.Z_SYNC_FLUSH,function(){i._binding.params(e,t),i._hadError||(i._level=e,i._strategy=t,o&&o())})}else li(o)},vr.prototype.reset=function(){return this._binding.reset()},vr.prototype._flush=function(e){this._transform(new Ot(0),"",e)},vr.prototype.flush=function(e,t){var o=this._writableState;if((typeof e=="function"||e===void 0&&!t)&&(t=e,e=vn.Z_FULL_FLUSH),o.ended)t&&li(t);else if(o.ending)t&&this.once("end",t);else if(o.needDrain){var i=this;this.once("drain",function(){i.flush(t)})}else this._flushFlag=e,this.write(new Ot(0),"",t)},vr.prototype.close=function(e){if(e&&li(e),!this._closed){this._closed=!0,this._binding.close();var t=this;li(function(){t.emit("close")})}},vr.prototype._transform=function(e,t,o){var i,c=this._writableState,u=(c.ending||c.ended)&&(!e||c.length===e.length);if(!e===null&&!iI(e))return o(new Error("invalid input"));u?i=vn.Z_FINISH:(i=this._flushFlag,e.length>=c.length&&(this._flushFlag=this._opts.flush||vn.Z_NO_FLUSH)),this._processChunk(e,i,o)},vr.prototype._processChunk=function(e,t,o){var i=e&&e.length,c=this._chunkSize-this._offset,u=0,f=this,p=typeof o=="function";if(!p){var m,_=[],b=0;this.on("error",function(E){m=E});do var S=this._binding.writeSync(t,e,u,i,this._buffer,this._offset,c);while(!this._hadError&&R(S[0],S[1]));if(this._hadError)throw m;var T=Ot.concat(_,b);return this.close(),T}var M=this._binding.write(t,e,u,i,this._buffer,this._offset,c);function R(E,N){if(!f._hadError){var D=c-N;if(function(F,H){if(!F)throw new Error(H)}(D>=0,"have should not go down"),D>0){var x=f._buffer.slice(f._offset,f._offset+D);f._offset+=D,p?f.push(x):(_.push(x),b+=x.length)}if((N===0||f._offset>=f._chunkSize)&&(c=f._chunkSize,f._offset=0,f._buffer=new Ot(f._chunkSize)),N===0){if(u+=i-E,i=E,!p)return!0;var L=f._binding.write(t,e,u,i,f._buffer,f._offset,f._chunkSize);return L.callback=R,void(L.buffer=e)}if(!p)return!1;o()}}M.buffer=e,M.callback=R},ts(Ef,vr),ts(Mf,vr),ts(kf,vr),ts(Af,vr),ts(Rf,vr),ts(wf,vr),ts(Df,vr);var D5={codes:wT,createDeflate:function(e){return new Ef(e)},createInflate:function(e){return new Mf(e)},createDeflateRaw:function(e){return new Rf(e)},createInflateRaw:function(e){return new wf(e)},createGzip:function(e){return new kf(e)},createGunzip:function(e){return new Af(e)},createUnzip:function(e){return new Df(e)},deflate:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new Ef(t),e,o)},deflateSync:function(e,t){return uf(new Ef(t),e)},gzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new kf(t),e,o)},gzipSync:function(e,t){return uf(new kf(t),e)},deflateRaw:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new Rf(t),e,o)},deflateRawSync:function(e,t){return uf(new Rf(t),e)},unzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new Df(t),e,o)},unzipSync:function(e,t){return uf(new Df(t),e)},inflate:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new Mf(t),e,o)},inflateSync:function(e,t){return uf(new Mf(t),e)},gunzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new Af(t),e,o)},gunzipSync:function(e,t){return uf(new Af(t),e)},inflateRaw:function(e,t,o){return typeof t=="function"&&(o=t,t={}),cf(new wf(t),e,o)},inflateRawSync:function(e,t){return uf(new wf(t),e)},Deflate:Ef,Inflate:Mf,Gzip:kf,Gunzip:Af,DeflateRaw:Rf,InflateRaw:wf,Unzip:Df,Zlib:vr};class jue{constructor(t,o,i){this.SDKAPPID=t,this.EXPIRETIME=i,this.PRIVATEKEY=o}genTestUserSig(t){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(t)?this._isNumber(this.EXPIRETIME)?(console.log("sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+t+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(t,this.EXPIRETIME,null)):(console.error("expireTime must be a number"),""):(console.error("userID must be a string"),""):(console.error("privateKey must be a string"),""):(console.error("sdkAppID must be a number"),"")}newBuffer(t,o){return Ot.from?Ot.from(t,o):new Ot(t,o)}unescape(t){return t.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}escape(t){return t.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}encode(t){return this.escape(this.newBuffer(t).toString("base64"))}decode(t){return this.newBuffer(this.unescape(t),"base64")}base64encode(t){return this.newBuffer(t).toString("base64")}base64decode(t){return this.newBuffer(t,"base64").toString()}_hmacsha256(t,o,i,c){let u="TLS.identifier:"+t+`
`;u+="TLS.sdkappid:"+this.SDKAPPID+`
`,u+="TLS.time:"+o+`
`,u+="TLS.expire:"+i+`
`,c!=null&&(u+="TLS.userbuf:"+c+`
`);let f=S6.HmacSHA256(u,this.PRIVATEKEY);return S6.enc.Base64.stringify(f)}_utc(){return Math.round(Date.now()/1e3)}_isNumber(t){return t!==null&&(typeof t=="number"&&!isNaN(t-0)||typeof t=="object"&&t.constructor===Number)}_isString(t){return typeof t=="string"}genSigWithUserbuf(t,o,i){let c=this._utc(),u={"TLS.ver":"2.0","TLS.identifier":t,"TLS.sdkappid":this.SDKAPPID,"TLS.time":c,"TLS.expire":o},f="";if(i!=null){let b=this.base64encode(i);u["TLS.userbuf"]=b,f=this._hmacsha256(t,c,o,b)}else f=this._hmacsha256(t,c,o,null);u["TLS.sig"]=f;let p=JSON.stringify(u),m=D5.deflateSync(this.newBuffer(p)).toString("base64"),_=this.escape(m);return console.log("ret="+_),_}validate(t){let o=this.decode(t),i=D5.inflateSync(o);console.log("validate ret="+i)}}function F7({sdkAppId:e,userId:t,sdkSecretKey:o}){if(!t){console.error("Missing userID parameter.");return}if(!e){console.error("Missing SDKAppID parameter.");return}if(!o){console.error("Missing SecretKey parameter.");return}const i=e,c=604800,u=o;return{userSig:new jue(i,u,c).genTestUserSig(t),SDKAppID:e}}const Yue={class:"flex items-center flex-col text-center p-12 h-screen"},Jue={class:"container1 h-full mb-4"},Xue=["id"],O5=20009280,Que="304be4b653f1d54a6ab7199bb6d8b3ca7ccc4e4f488154492d8bb9934ec7c898",Zue=Se({__name:"VideoChat",setup(e){const t=JH(),o=Number(t.query.roomId),i=String(t.query.userId);let c,u=ae([]);const f=xy.create();fn(()=>{alert(`房间号为${o}`),c=F7({sdkAppId:O5,userId:i,sdkSecretKey:Que}).userSig,f.on(xy.EVENT.REMOTE_VIDEO_AVAILABLE,async({userId:R,streamType:E})=>{if(E==xy.TYPE.STREAM_TYPE_MAIN){u.value.includes(R)||u.value.push(`${R}`),await zt(),await f.startRemoteVideo({userId:R,streamType:E,view:`${R}`});for(let N of u.value)console.log(N,"1111111111")}}),f.on(xy.EVENT.REMOTE_VIDEO_UNAVAILABLE,M);function M(R){const{streamType:E}=R;f.stopRemoteVideo({userId:R.userId,streamType:E}),E===xy.TYPE.STREAM_TYPE_MAIN&&(u.value=u.value.filter(N=>N!==`${R.userId}`),console.log("11111"+u))}});const p=async()=>{await f.stopLocalVideo(),await f.exitRoom()},m=async()=>{try{await f.enterRoom({sdkAppId:O5,userId:i,userSig:c,roomId:o}),console.log("enter room successfully")}catch(M){console.error("failed to enter room "+M)}};async function _(){await f.startLocalAudio()}async function b(){await f.stopLocalAudio()}const S=async()=>{const M=document.getElementById("localvideo");await f.startLocalVideo({view:M})};async function T(){await f.stopLocalVideo()}return(M,R)=>(J(),ge("div",Yue,[Ce("div",Jue,[Ce("div",{ref:"localVideo",class:"w-96 h-full bg-gray-200 mb-4 object-cover",id:"localvideo"},pt(y(i)),513),(J(!0),ge(qt,null,Vn(y(u),E=>(J(),ge(qt,{key:E},[y(u).includes(E)?(J(),ge("div",{key:0,class:"w-96 h-full bg-gray-200 mb-4 object-cover",id:E},pt(E)+" 在线："+pt(y(u).includes(E)),9,Xue)):Fe("",!0)],64))),128))]),Ce("div",{class:"flex gap-3 mb-1 mt-3"},[Ce("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:m}," 进入房间 "),Ce("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:_}," 打开麦克风 "),Ce("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:S}," 打开摄像头 "),Ce("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:b}," 关闭麦克风 "),Ce("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:T}," 关闭摄像头 "),Ce("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:p}," 挂断视频 ")])]))}}),ede=(e,t)=>{const o=e.__vccOpts||e;for(const[i,c]of t)o[i]=c;return o},tde=ede(Zue,[["__scopeId","data-v-bf234a3f"]]),nde={class:"parent"},ode=Ce("h1",{style:{"font-weight":"700","font-family":"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif","font-style":"italic","font-size":"larger"}},"欢迎来到通信小屋",-1),rde={class:"containerlogin gap-4 mb-4"},ide={style:{"text-align":"center"}},sde=Se({__name:"login",setup(e){const t=ae(""),o=ae("");function i(){console.log(`${o.value}${t.value}`),console.log(!(!t||!o))}return(c,u)=>{const f=pn("el-input"),p=pn("el-form-item"),m=pn("el-form");return J(),ge("div",nde,[ode,Ce("div",rde,[Me(m,{"label-width":"auto",style:{"max-width":"600px"}},{default:Ne(()=>[Me(p,{label:"用户名"},{default:Ne(()=>[Me(f,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=_=>t.value=_),style:{width:"240px"},placeholder:"初始化你的用户名",clearable:""},null,8,["modelValue"])]),_:1}),Me(p,{label:"房间号或用户名"},{default:Ne(()=>[Me(f,{modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=_=>o.value=_),style:{width:"240px"},placeholder:"创建数字房间号或会话用户名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),Ce("div",ide,[Ce("button",{class:"rounded-md px-4 py-2 text-sm font-semibold text-white mr-5",style:Ht({backgroundColor:!t.value||!o.value?"gray":"indigo"}),onClick:i},[On(" 文字聊天 "),t.value&&o.value?(J(),He(y(OD),{key:0,to:{path:"/videoChatByTRTC/Chat",query:{roomId:o.value,userId:t.value}},class:"button"},{default:Ne(()=>[On(" 进入房间 ")]),_:1},8,["to"])):Fe("",!0)],4),Ce("button",{class:"rounded-md px-4 py-2 text-sm font-semibold text-white",style:Ht({backgroundColor:!t.value||!o.value?"gray":"indigo"}),onClick:i},[On(" 视频 "),t.value&&o.value?(J(),He(y(OD),{key:0,to:{path:"/videoChatByTRTC/VideoChat",query:{roomId:o.value,userId:t.value}},class:"button"},{default:Ne(()=>[On(" 进入房间 ")]),_:1},8,["to"])):Fe("",!0)],4)])])}}});var V7={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){function o(n,s){var l,h=Object.keys(n);return Object.getOwnPropertySymbols&&(l=Object.getOwnPropertySymbols(n),s&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(n,v).enumerable})),h.push.apply(h,l)),h}function i(n){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?o(Object(l),!0).forEach(function(h){m(n,h,l[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):o(Object(l)).forEach(function(h){Object.defineProperty(n,h,Object.getOwnPropertyDescriptor(l,h))})}return n}function c(n){return(c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(n)}function u(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function f(n,s){for(var l=0;l<s.length;l++){var h=s[l];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(n,h.key,h)}}function p(n,s,l){return s&&f(n.prototype,s),l&&f(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n}function m(n,s,l){return s in n?Object.defineProperty(n,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):n[s]=l,n}function _(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&S(n,s)}function b(n){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)})(n)}function S(n,s){return(S=Object.setPrototypeOf||function(l,h){return l.__proto__=h,l})(n,s)}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M(n,s,l){return(M=T()?Reflect.construct:function(h,P,I){var k=[null],P=(k.push.apply(k,P),new(Function.bind.apply(h,k)));return I&&S(P,I.prototype),P}).apply(null,arguments)}function R(n){var s=typeof Map=="function"?new Map:void 0;return function(l){if(l===null||Function.toString.call(l).indexOf("[native code]")===-1)return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(s!==void 0){if(s.has(l))return s.get(l);s.set(l,h)}function h(){return M(l,arguments,b(this).constructor)}return h.prototype=Object.create(l.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),S(h,l)}(n)}function E(n,s){if(n==null)return{};var l,h=function(k,P){if(k==null)return{};for(var G,Y={},te=Object.keys(k),pe=0;pe<te.length;pe++)G=te[pe],0<=P.indexOf(G)||(Y[G]=k[G]);return Y}(n,s);if(Object.getOwnPropertySymbols)for(var v=Object.getOwnPropertySymbols(n),I=0;I<v.length;I++)l=v[I],0<=s.indexOf(l)||Object.prototype.propertyIsEnumerable.call(n,l)&&(h[l]=n[l]);return h}function N(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function D(n){var s=T();return function(){var l,h=b(n),h=(l=s?(l=b(this).constructor,Reflect.construct(h,arguments,l)):h.apply(this,arguments),this);if(l&&(typeof l=="object"||typeof l=="function"))return l;if(l!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N(h)}}function x(n,s){return F(n)||function(l,h){var v=l==null?null:typeof Symbol<"u"&&l[Symbol.iterator]||l["@@iterator"];if(v!=null){var I,k,P=[],G=!0,Y=!1;try{for(v=v.call(l);!(G=(I=v.next()).done)&&(P.push(I.value),!h||P.length!==h);G=!0);}catch(te){Y=!0,k=te}finally{try{G||v.return==null||v.return()}finally{if(Y)throw k}}return P}}(n,s)||B(n,s)||W()}function L(n){return function(s){if(Array.isArray(s))return z(s)}(n)||H(n)||B(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function F(n){if(Array.isArray(n))return n}function H(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function B(n,s){if(n){if(typeof n=="string")return z(n,s);var l=Object.prototype.toString.call(n).slice(8,-1);return(l=l==="Object"&&n.constructor?n.constructor.name:l)==="Map"||l==="Set"?Array.from(n):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?z(n,s):void 0}}function z(n,s){(s==null||s>n.length)&&(s=n.length);for(var l=0,h=new Array(s);l<s;l++)h[l]=n[l];return h}function W(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z(n,s){var l,h=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!h){if(Array.isArray(n)||(h=B(n))||s&&n&&typeof n.length=="number")return h&&(n=h),l=0,{s:s=function(){},n:function(){return l>=n.length?{done:!0}:{done:!1,value:n[l++]}},e:function(P){throw P},f:s};throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v,I=!0,k=!1;return{s:function(){h=h.call(n)},n:function(){var P=h.next();return I=P.done,P},e:function(P){k=!0,v=P},f:function(){try{I||h.return==null||h.return()}finally{if(k)throw v}}}}var $={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",MY_FOLLOWERS_LIST_UPDATED:"onMyFollowersListUpdated",MY_FOLLOWING_LIST_UPDATED:"onMyFollowingListUpdated",MUTUAL_FOLLOWERS_LIST_UPDATED:"onMutualFollowersListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",ALL_RECEIVE_MESSAGE_OPT_UPDATED:"onAllReceiveMessageOptUpdated"},O={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_ROOM:"Room",GRP_LIVE:"Live",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3,IOS_OFFLINE_PUSH_NO_SOUND:"push.no_sound",IOS_OFFLINE_PUSH_DEFAULT_SOUND:"default"},X={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},le=(p(ke,[{key:"use",value:function(n){if(typeof n!="function")throw"middleware must be a function";return this.cache.push(n),this}},{key:"next",value:function(n){if(this.middlewares&&0<this.middlewares.length)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(n){return this.middlewares=this.cache.map(function(s){return s}),this.options=n,this.next()}}]),ke),de=(p(be,[{key:"equal",value:function(n){return n!==null&&this.low===n.low&&this.high===n.high}},{key:"toString",value:function(){var n=Number(this.high).toString(16),s=Number(this.low).toString(16);if(s.length<8)for(var l=8-s.length;l;)s="0"+s,l--;return n+s}}]),be),he={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT:"wss://wsssgp.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT:"wss://wsskr.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT:"wss://wssger.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT:"wss://wssind.my-imcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.18.188"},JPN:{DEFAULT:"wss://wssjpn.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT:"wss://wssusa.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT:"wss://wssidn.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},se={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15},ie="1.7.3",oe=537048168,ee="CHINA",Q={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){this.CURRENT=he.PRODUCTION[0<arguments.length&&arguments[0]!==void 0?arguments[0]:ee]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GRP:"group_open_http_svc",GRP_AV:"group_open_avchatroom_http_svc",GRP_COMMUNITY:"million_group_open_http_svc",GRP_ATTR:"group_open_attr_http_svc",FD:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GRP_NO_AUTH:"group_open_http_noauth_svc",BIG_GRP_POLLING:"group_open_long_polling_http_svc",BIG_GRP_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MSG:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MSG_SEARCH:"message_search",FOLLOW:"follow",OFFLINE_PUSH_REPORT:"offline_push_report",IM_MSG_LOGIC:"im_msg_db_logic"}},ue={SEARCH_GRP_SNS:new de(0,Math.pow(2,1)).toString(),AV_HISTORY_MSG:new de(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new de(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new de(0,Math.pow(2,4)).toString(),AV_MBR_LIST:new de(0,Math.pow(2,6)).toString(),USER_STATUS:new de(0,Math.pow(2,7)).toString(),CONV_MARK:new de(0,Math.pow(2,9)).toString(),CONV_GROUP:new de(0,Math.pow(2,10)).toString(),AV_BAN_MBR:new de(0,Math.pow(2,11)).toString(),MSG_EXT:new de(0,Math.pow(2,13)).toString(),GRP_COUNTER:new de(0,Math.pow(2,15)).toString(),PLUGIN_TRANSLATE:new de(Math.pow(2,6)).toString(),PLUGIN_VOICE_TO_TEXT:new de(Math.pow(2,7)).toString(),PLUGIN_CS:new de(Math.pow(2,8)).toString(),PLUGIN_PUSH:new de(Math.pow(2,9)).toString(),PLUGIN_BOT:new de(Math.pow(2,10)).toString(),MSG_REACTION:new de(Math.pow(2,16)).toString(),FOLLOW:new de(Math.pow(2,20)).toString()},me="group_profile";function be(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;u(this,be),this.high=n,this.low=s}function ke(){u(this,ke),this.cache=[],this.options=null}Q.HOST.setCurrent(ee);var Ye=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,Oe=Ye&&typeof wx.createGamePortal=="function",Ee=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,we=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,Ge=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,Ve=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,Wn=typeof jd<"u"&&typeof jd.getSystemInfoSync=="function",qe=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",st=typeof uni<"u",Ie=Ye||Ee||we||Ge||Ve||qe||Wn,Ae=(typeof uni<"u"||typeof window<"u")&&!Ie,xe=Ee?qq:we?tt:Ge?swan:Ve?my:Ye?wx:qe?uni:Wn?jd:{},ot=Ae&&window&&window.navigator&&window.navigator.userAgent||"",Wn=/(micromessenger|webbrowser)/i.test(ot),kt=/AppleWebKit\/([\d.]+)/i.exec(ot);kt&&parseFloat(kt.pop()),kt="WEB",Wn?kt="WEB":Ee?kt="QQ_MP":we?kt="TT_MP":Ge?kt="BAIDU_MP":Ve?kt="ALI_MP":Ye?kt="WX_MP":qe&&(kt="UNI_NATIVE_APP");var je=se[kt],Wn=/iPad/i.test(ot),kt=/iPhone/i.test(ot)&&!Wn,Bn=/iPod/i.test(ot),at=kt||Wn||Bn,ht=(kt=ot.match(/OS (\d+)_/i))&&kt[1]?kt[1]:null,dt=/Android/i.test(ot),ft=function(){var n=ot.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!n)return null;var s=n[1]&&parseFloat(n[1]),l=n[2]&&parseFloat(n[2]);return s&&l?parseFloat(n[1]+"."+n[2]):s||null}(),Wn=/Edge/i.test(ot),Bn=!Wn&&/Chrome/i.test(ot),Je=((kt=ot.match(/Chrome\/(\d+)/))&&kt[1]&&parseFloat(kt[1]),/MSIE/.test(ot)||-1<ot.indexOf("Trident")&&-1<ot.indexOf("rv:11.0")),Et=kt=!(kt=(kt=/MSIE\s(\d+)\.\d/.exec(ot))&&parseFloat(kt[1]))&&/Trident\/7.0/i.test(ot)&&/rv:11.0/.test(ot)?11:kt,Nt=/Safari/i.test(ot)&&!Bn&&!dt&&!Wn;(kt=ot.match(/TBS\/(\d+)/i))&&kt[1]&&kt[1];for(var et,Mt=/Windows/i.test(ot),Jt=/MAC OS X/i.test(ot),sn=Ae&&typeof Worker<"u"&&!Je,gn=dt||at,Bt=Ae&&window.tencent_cloud_im_csig_flutter_for_web_25F_cy!==void 0,nt=function(){if(typeof window>"u"||window.navigator===void 0)return!1;var n=window.navigator.standalone;return!(!at||n||Nt)}(),It=typeof console<"u"?console:typeof ki<"u"&&ki.console?ki.console:typeof window<"u"&&window.console?window.console:{},ct=function(){},Ke=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Xe=Ke.length;Xe--;)et=Ke[Xe],console[et]||(It[et]=ct);function Dt(){var n=new Date;return n.setTime(oo()),n}function $e(){Fn=0}function xt(){return Math.floor(oo()/1e3)}var jt=It,Fn=0,oo=function(){return new Date().getTime()+Fn},zn=0;function kn(){return Xm()?"%c Chat %c":"Chat"}function Po(){var n=Dt();return n.toLocaleTimeString("en-US",{hour12:!1})+"."+function(s){var l;switch(s.toString().length){case 1:l="00"+s;break;case 2:l="0"+s;break;default:l=s}return l}(n.getMilliseconds())}var q={arguments2String:function(n){var s="";if(n.length===1)s=n[0];else for(var l=0,h=n.length;l<h;l++)Dl(n[l])?Wm(n[l])?s+=EI(n[l]):s+=JSON.stringify(n[l]):s+=n[l],s+=" ";return s},_exec:function(n,s){Xm()?jt[n](kn(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Po(),s):jt[n]("".concat(kn()," ").concat(Po()," ").concat(s))},d:function(){var n;zn<=-1&&(n=this.arguments2String(arguments),this._exec("debug",n))},l:function(){var n;zn<=0&&(n=this.arguments2String(arguments),this._exec("log",n))},log:function(){var n;zn<=0&&(n=this.arguments2String(arguments),this._exec("log",n))},i:function(){var n;zn<=1&&(n=this.arguments2String(arguments),this._exec("info",n))},w:function(){var n;zn<=2&&(n=this.arguments2String(arguments),this._exec("warn",n))},e:function(){var n;zn<=3&&(n=this.arguments2String(arguments),this._exec("error",n))},setLevel:function(n){n<4&&this._exec("log","set level from "+zn+" to "+n),zn=n},getLevel:function(){return zn}},xo={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Bn="Tag_Profile_IM_",_n={NICK:"".concat(Bn,"Nick"),GENDER:"".concat(Bn,"Gender"),BIRTHDAY:"".concat(Bn,"BirthDay"),LOCATION:"".concat(Bn,"Location"),SELFSIGNATURE:"".concat(Bn,"SelfSignature"),ALLOWTYPE:"".concat(Bn,"AllowType"),LANGUAGE:"".concat(Bn,"Language"),AVATAR:"".concat(Bn,"Image"),MESSAGESETTINGS:"".concat(Bn,"MsgSettings"),ADMINFORBIDTYPE:"".concat(Bn,"AdminForbidType"),LEVEL:"".concat(Bn,"Level"),ROLE:"".concat(Bn,"Role")},eo={GROUP:"".concat("Tag_SNS_IM_","Group"),REMARK:"".concat("Tag_SNS_IM_","Remark"),ADDSOURCE:"".concat("Tag_SNS_IM_","AddSource"),ADDWORDING:"".concat("Tag_SNS_IM_","Wording"),ADDTIME:"".concat("Tag_SNS_IM_","AddTime")},Wn="Gender_Type_",ls={UNKNOWN:"".concat(Wn,"Unknown"),FEMALE:"".concat(Wn,"Female"),MALE:"".concat(Wn,"Male")},Ir={NONE:"".concat("AdminForbid_Type_","None"),SEND_OUT:"".concat("AdminForbid_Type_","SendOut")},ks={NEED_CONFIRM:"".concat("AllowType_Type_","NeedConfirm"),ALLOW_ANY:"".concat("AllowType_Type_","AllowAny"),DENY_ANY:"".concat("AllowType_Type_","DenyAny")},sr="JoinedSuccess",ca="WaitAdminApproval",As="@TOPIC#_",Dd=Object.prototype.hasOwnProperty;function Ct(n){if(n==null)return!0;if(typeof n=="boolean")return!1;if(typeof n=="number")return n===0;if(typeof n=="string"||typeof n=="function"||Array.isArray(n))return n.length===0;if(n instanceof Error)return n.message==="";if(xn(n)){for(var s in n)if(Dd.call(n,s))return!1;return!0}return!!(Tt(n)||Xt(n)||Cn(n))&&n.size===0}function Tt(n){return Ga(n)==="map"}function Xt(n){return Ga(n)==="set"}function Cn(n){return Ga(n)==="file"}function un(n){return n!==null&&(typeof n=="number"&&!isNaN(+n)||c(n)==="object"&&n.constructor===Number)}function hr(n){return n!==null&&c(n)==="object"}function xn(n){if(c(n)==="object"&&n!==null){if((n=Object.getPrototypeOf(n))===null)return 1;for(var s=n;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return n===s}}function Rt(n){return typeof Array.isArray=="function"?Array.isArray(n):Ga(n)==="array"}function ko(n){return typeof n=="function"}function Lr(n){return Ga(n)==="filelist"}function wl(n){return typeof n=="string"&&(n=n[0],!/[^a-zA-Z0-9]/.test(n))}function ni(n,s,l,h){if(!Dl(n)||!Dl(s))return 0;for(var v,I=0,k=Object.keys(s),P=0,G=k.length;P<G;P++)if(v=k[P],!(Qe(s[v])||l&&l.includes(v)))if(Dl(n[v])&&Dl(s[v]))I+=ni(n[v],s[v],l,h);else{if(h&&h.includes(s[v]))continue;n[v]!==s[v]&&(n[v]=s[v],I+=1)}return I}function yt(n,s){var l,h=new Map,v=Z(n.entries());try{for(v.s();!(l=v.n()).done;){var I=x(l.value,2),k=I[0],P=I[1];h.set(k,s?JSON.stringify(P):JSON.parse(JSON.stringify(P)))}}catch(G){v.e(G)}finally{v.f()}return h}function an(n){if(n.length===0)return 0;for(var s=0,l=0,h=typeof document<"u"&&document.characterSet!==void 0?document.characterSet:"UTF-8";n[s]!==void 0;)l+=n[s++].charCodeAt[s]<=255?1:h===!1?3:2;return l}function dn(n){return n=n||99999999,Math.round(Math.random()*n)}function ro(){for(var n="",s=32;0<s;--s)n+=MI[Math.floor(Math.random()*kI)];return n}function Er(n,s){for(var l in n)if(n[l]===s)return 1}function gi(n){return n.indexOf("http://")===-1||n.indexOf("https://")===-1?"https://"+n:n.replace(/https|http/,"https")}function Ni(n){if(Object.getOwnPropertyNames(n).length===0)return Object.create(null);var s,l,h=Array.isArray(n)?[]:Object.create(null);for(l in n)n[l]!==null?n[l]!==void 0?(s=c(n[l]),0<=["string","number","function","boolean"].indexOf(s)?h[l]=n[l]:h[l]=Ni(n[l])):h[l]=void 0:h[l]=null;return h}var E1=["url"],Sn=function(n){return typeof n=="string"},Qe=function(n){return n===void 0},Dl=function(n){return Rt(n)||hr(n)},Wm=function(n){return n instanceof Error},Ga=function(n){return Object.prototype.toString.call(n).match(/^\[object (.*)\]$/)[1].toLowerCase()},EI=(Date.now||(Date.now=function(){return new Date().getTime()}),function(n){return JSON.stringify(n,["message","code"])}),MI="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",kI=MI.length,Od={};function Nd(n,s){if(!Rt(n)||!Rt(s))return!1;var l=!1;return s.forEach(function(I){var v=I.key,I=I.value,k=n.find(function(P){return P.key===v});k?k.value!==I&&(k.value=I,l=!0):(n.push({key:v,value:I}),l=!0)}),l}function jm(n){return Ct(n)?[]:n.filter(function(s){return s.isModified===!0})}function Ym(n){return Ct(n)?[]:n.filter(function(s){return s.isModified===!1})}function Mr(n){return n===O.GRP_AVCHATROOM}function Dr(l){var s=l.type,l=l.groupID;return s===O.GRP_COMMUNITY||"".concat(l).startsWith("@TGS#_")&&!"".concat(l).includes(As)}function Qo(n){return"".concat(n).startsWith("@TGS#_")&&"".concat(n).includes(As)}function Pr(n){return Sn(n)&&n.slice(0,3)===O.CONV_C2C}function fr(n){return Sn(n)&&n.slice(0,5)===O.CONV_GROUP}function ap(n){return Sn(n)&&n===O.CONV_SYSTEM}function AI(n,s){var l={};return Object.keys(n).forEach(function(h){l[h]=s(n[h],h)}),l}function Ld(n){return Ie?new Promise(function(s,l){xe.getImageInfo({src:n,success:function(h){s({width:h.width,height:h.height})},fail:function(){s({width:0,height:0})}})}):Je&&Et===9?Promise.resolve({width:0,height:0}):new Promise(function(s,l){var h=new Image;h.onload=function(){s({width:this.width,height:this.height}),h=null},h.onerror=function(){s({width:0,height:0}),h=null},h.src=n})}function Pd(){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(n()+n()).concat(n()).concat(n()).concat(n()).concat(n()).concat(n()).concat(n())}function Jm(){var n=dt?"android":at?"ios":Mt?"windows":Jt?"mac":"unknown";if(Ie)try{var s=xe.getSystemInfoSync().platform;s!==void 0&&(n=s)}catch{}return n}function RI(n,s){n=n.split("."),s=s.split(".");for(var l=Math.max(n.length,s.length);n.length<l;)n.push("0");for(;s.length<l;)s.push("0");for(var h=0;h<l;h++){var v=parseInt(n[h]),I=parseInt(s[h]);if(I<v)return 1;if(v<I)return-1}return 0}function Ud(l){var s=l.originUrl,s=s===void 0?void 0:s,h=l.originWidth,v=l.originHeight,l=l.min,l=l===void 0?198:l,h=parseInt(h),v=parseInt(v),I={url:void 0,width:0,height:0};return(h<=v?h:v)<=l?(I.url=s,I.width=h,I.height=v):(v<=h?(I.width=Math.ceil(h*l/v),I.height=l):(I.width=l,I.height=Math.ceil(v*l/h)),v=s&&-1<s.indexOf("?")?"".concat(s,"&"):"".concat(s,"?"),I.url="".concat(v,l===198?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")),Qe(s)?(I.url,E(I,E1)):I}function wI(n){var s=n[2];n[2]=n[1],n[1]=s;for(var l=0;l<n.length;l++)n[l].setType(l)}function xd(n){return n=n.servcmd,n.slice(n.indexOf(".")+1)}function Li(n,s){return Math.round(Number(n)*Math.pow(10,s))/Math.pow(10,s)}function lp(n,s){return n.includes(s)}function DI(n,s){return n.includes(s)}function Zo(n){return n.split(As)[0]}var Fd=function(n,s,l){if(Qe(s))return"";switch(n){case O.MSG_TEXT:return s.text;case O.MSG_IMAGE:return l?"[Image]":"[图片]";case O.MSG_LOCATION:return l?"[Location]":"[位置]";case O.MSG_AUDIO:return l?"[Voice]":"[语音]";case O.MSG_VIDEO:return l?"[Video]":"[视频]";case O.MSG_FILE:return l?"[File]":"[文件]";case O.MSG_CUSTOM:return l?"[Custom Messages]":"[自定义消息]";case O.MSG_GRP_TIP:return l?"[Group Notification]":"[群提示消息]";case O.MSG_GRP_SYS_NOTICE:return l?"[Group System Message]":"[群系统通知]";case O.MSG_FACE:return l?"[Animated Sticker]":"[动画表情]";case O.MSG_MERGER:return l?"[Chat Record]":"[聊天记录]";default:return""}};function OI(n){return n===O.MSG_TEXT||n===O.MSG_CUSTOM||n===O.MSG_LOCATION||n===O.MSG_FACE}function cs(n){var s=[];if(!Sn(n))return s;var l=n.length;if(l===0)return s;for(var h=l-1;0<=h;h--)n[h]==="1"&&s.push(Math.pow(2,l-h-1));return s}function Xm(){return!Je&&!Ie}function Ol(n){return"the length of userIDList cannot exceed ".concat(n)}function oi(n,s){var l;if(n)return l=n,s&&(n.startsWith("http://")?l=n.replace(/^http:\/\/[^/]+/,s):n.startsWith("https://")&&(l=n.replace(/^https:\/\/[^/]+/,s))),l}function Vd(n){var s;if(Rt(n)&&n.length!==0)return s=0,n.forEach(function(l){s+=l}),s.toFixed(0)}function NI(n){var s;if(Rt(n)&&n.length!==0)return s=0,n.forEach(function(l){s+=l}),(s/n.length).toFixed(0)}function ar(n,h,v){var h=!(1<arguments.length&&h!==void 0)||h,v=!(2<arguments.length&&v!==void 0)||v,I=Date.now();return h?v?"".concat(I-n," ms"):"".concat(Math.round((I-n)/1e3)," s"):v?I-n:Math.round((I-n)/1e3)}function Ba(n){return!!(n&&1<n)}function LI(n,s,l,h){if(s===void 0)return 1;var v,I,k=!0;return s.required&&Ct(n)&&(q.e("[".concat(l,'] Missing required params: "').concat(h,'".')),k=!1),Ct(n)||(v=Ga(n))!==(I=s.type.toLowerCase())&&(v==="asyncfunction"&&I==="function"||(q.e("[".concat(l,'] Invalid params: type check failed for "').concat(h,'". Expected ').concat(s.type,".")),k=!1)),s.validator&&!s.validator(n,l,h)&&(q.e("[".concat(l,'] Invalid params: custom validator check failed for "').concat(h,'".')),k=!1),k}function Ur(n){return!!n&&(!!(Pr(n)||fr(n)||ap(n))||((n=to("InvalidConversationID",n))&&q.w(n),!1))}function St(n){n.desc!==""&&to("API_REFER")!==""&&q.w("[".concat(n.api,"] | ").concat(n.paramName," | ").concat(n.desc,", ").concat(to("API_REFER")).concat(n.api))}function Pi(){return to("StringRequiredLog")}function Fc(n){return to("NonEmptyStringRequiredLog",n)}function Vc(){return to("NumberRequiredLog")}function cp(){return to("UndefinedNotAllowedLog")}function Gd(){return to("FileRequiredLog")}function us(){return to("FunctionRequiredLog")}function xr(){return to("ArrayRequiredLog")}function Rs(){return to("NonEmptyArrayLog")}function up(){return to("CallbackMissingLog")}function Qm(){return to("PositiveIntegerRequiredLog")}function $a(n,s){return to("StringNotLongerThanLog",n,s)}function Bd(n,s){return to("NumberGreaterOrEqualLog",n,s)}function dp(n){return to("KeyValueStringRequiredLog",n)}function ds(){return to("PlainObjectRequiredLog")}function Zm(){return to("NonEmptyContentRequiredLog")}function Gc(){return to("FileNotSelectedLog")}function hp(){return to("MessageInstanceRequiredLog")}function $d(){return to("NonAnonymousFunctionLog")}function ev(){return to("MessageExtensionNotAvailableLog")}function tv(){return to("MessageReactionRequiredLog")}function PI(n,s){return to("MaximumArrayLengthLog",n,s)}function Ut(n){return{code:0,data:n||{}}}function ln(n){return Promise.resolve(Ut(n))}function Re(n){var s=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(n instanceof so)return s&&Nl!==null&&Nl.emit($.ERROR,n),Promise.reject(n);if(n instanceof Error)return l=new so({code:Be.UNCAUGHT_ERROR}),s&&Nl!==null&&Nl.emit($.ERROR,l),Promise.reject(l);if(Qe(n)||Qe(n.code))return Promise.reject(new so({code:Be.UNCAUGHT_ERROR}));var l=new so(n);return s&&Nl!==null&&Nl.emit($.ERROR,l),Promise.reject(l)}var nv,Bc="unSend",Ui="success",ov="fail",ws="notStart",UI="pending",Hd="resolved",$c="rejected",kt={type:"String",required:!0},Bn={type:"Array",required:!0},Wn={type:"Object",required:!0},tr={type:"Boolean",required:!0},Uo={type:"number",required:!0},to=null,rv={hookGetAPITips:function(n){to=n},login:{userID:kt,userSig:kt},addToBlacklist:{userIDList:Bn},removeFromBlacklist:{userIDList:Bn},on:[{name:"eventName",type:"String",validator:function(n,s,l){return typeof n=="string"&&n.length!==0||(St({api:s,paramName:l,desc:Fc(l)}),!1)}},{name:"handler",type:"Function",validator:function(n,s,l){return typeof n!="function"?(St({api:s,paramName:l,desc:us()}),!1):(n.name===""&&St({api:s,paramName:l,desc:$d()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(n,s,l){return typeof n=="string"&&n.length!==0||(St({api:s,paramName:l,desc:Fc(l)}),!1)}},{name:"handler",type:"Function",validator:function(n,s,l){return typeof n!="function"?(St({api:s,paramName:l,desc:us()}),!1):(n.name===""&&St({api:s,paramName:l,desc:$d()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(n,s,l){return typeof n=="string"&&n.length!==0||(St({api:s,paramName:l,desc:Fc(l)}),!1)}},{name:"handler",type:"Function",validator:function(n,s,l){return typeof n!="function"?(St({api:s,paramName:l,desc:us()}),!1):(n.name===""&&St({api:s,paramName:l,desc:$d()}),!0)}}],sendMessage:[i({name:"message"},Wn)],setMessageExtensions:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return n.status===Ui&&n.isSupportExtension===!0||(St({api:s,paramName:l,desc:ev()}),!1)}}),i({name:"extensions"},Bn)],getMessageExtensions:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return n.status===Ui&&n.isSupportExtension===!0||(St({api:s,paramName:l,desc:ev()}),!1)}})],deleteMessageExtensions:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return n.status===Ui&&n.isSupportExtension===!0||(St({api:s,paramName:l,desc:ev()}),!1)}})],addMessageReaction:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return n.status===Ui||(St({api:s,paramName:l,desc:tv()}),!1)}}),i({name:"reactionID"},kt)],removeMessageReaction:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return n.status===Ui||(St({api:s,paramName:l,desc:tv()}),!1)}}),i({name:"reactionID"},kt)],getMessageReactions:{messageList:i({},Bn)},getAllUserListOfMessageReaction:{message:i(i({},Wn),{},{validator:function(n,s,l){return n.status===Ui||(St({api:s,paramName:l,desc:tv()}),!1)}}),reactionID:i({},kt),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:i(i({},kt),{},{validator:Ur}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(n,s,l){return!(!Qe(n)&&!/^[1-9][0-9]*$/.test(n)&&(St({api:s,paramName:l,desc:Qm()}),1))}}},getMessageListHopping:{conversationID:i(i({},kt),{},{validator:Ur}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(n,s,l){return!(!Qe(n)&&n!==0&&n!==1&&(St({api:s,paramName:l,desc:to("0Or1RequiredLog")}),1))}},count:{type:"Number",validator:function(n,s,l){return!(!Qe(n)&&!/^[1-9][0-9]*$/.test(n)&&(St({api:s,paramName:l,desc:Qm}),1))}}},setMessageRead:{conversationID:i(i({},kt),{},{validator:Ur})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(n,s,l){return!n||[O.READ_ALL_C2C_MSG,O.READ_ALL_GROUP_MSG,O.READ_ALL_MSG].indexOf(n)!==-1||(St({api:s,paramName:l,desc:to("ValidScopeRequired")}),!1)}}},getConversationProfile:[i(i({name:"conversationID"},kt),{},{validator:Ur})],clearHistoryMessage:[i(i({name:"conversationID"},kt),{},{validator:Ur})],pinConversation:{conversationID:i(i({},kt),{},{validator:Ur}),isPinned:i({},tr)},setConversationDraft:{conversationID:i(i({},kt),{},{validator:Ur}),draftText:{type:"String",validator:function(n,s,l){return!!Sn(n)||(St({api:s,paramName:l,desc:Pi()}),!1)}}},setConversationCustomData:{conversationIDList:i({},Bn),customData:{type:"String",validator:function(n,s,l){return Sn(n)?!(256<n.length&&(St({api:s,paramName:l,desc:$a(l,256)}),1)):(St({api:s,paramName:l,desc:Pi()}),!1)}}},markConversation:{conversationIDList:i({},Bn),markType:{type:"number",validator:function(n,s,l){return un(n)?n<=0?(St({api:s,paramName:l,desc:to("NumberGreaterThanLog",l,0)}),!1):!(n>=Math.pow(2,64)&&(St({api:s,paramName:l,desc:to("NumberLessThanLog",l,"Math.pow(2,64)")}),1)):(St({api:s,paramName:l,desc:Vc()}),!1)}},enableMark:i({},tr)},createConversationGroup:{conversationIDList:i({},Bn),groupName:i(i({},kt),{},{validator:function(n,s,l){return!(!n||32<n.length&&(St({api:s,paramName:l,desc:$a(l,32)}),1))}})},deleteConversationGroup:[i({name:"groupName"},kt)],renameConversationGroup:{oldName:i({},kt),newName:i(i({},kt),{},{validator:function(n,s,l){return!(!n||32<n.length&&(St({api:s,paramName:l,desc:$a(l,32)}),1))}})},addConversationsToGroup:{conversationIDList:i({},Bn),groupName:i({},kt)},deleteConversationsFromGroup:{conversationIDList:i({},Bn),groupName:i({},kt)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:kt,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:Bn},createGroup:{name:kt},joinGroup:{groupID:kt,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[i({name:"groupID"},kt)],handleApplication:{message:Wn,handleAction:kt,handleMessage:{type:"String"}},changeGroupOwner:{groupID:kt,newOwnerID:kt},updateGroupProfile:{groupID:kt,muteAllMembers:{type:"Boolean"}},dismissGroup:[i({name:"groupID"},kt)],searchGroupByID:[i({name:"groupID"},kt)],getGroupOnlineMemberCount:[i({name:"groupID"},kt)],initGroupAttributes:{groupID:kt,groupAttributes:i(i({},Wn),{},{validator:function(n,s,l){var h=!0;return Object.keys(n).forEach(function(v){if(!Sn(n[v]))return St({api:s,paramName:l,desc:dp("value")}),h=!1}),h}})},setGroupAttributes:{groupID:kt,groupAttributes:i(i({},Wn),{},{validator:function(n,s,l){var h=!0;return Object.keys(n).forEach(function(v){if(!Sn(n[v]))return St({api:s,paramName:l,desc:dp("value")}),h=!1}),h}})},deleteGroupAttributes:{groupID:kt,keyList:{type:"Array",validator:function(n,s,l){return Qe(n)||!Rt(n)?(St({api:s,paramName:l,desc:xr()}),!1):!!Ct(n)||(h=!0,n.forEach(function(v){if(!Sn(v))return St({api:s,paramName:l,desc:to("StringArrayRequiredLog")}),h=!1}),h);var h}}},getGroupAttributes:{groupID:kt,keyList:{type:"Array",validator:function(n,s,l){return Qe(n)||!Rt(n)?(St({api:s,paramName:l,desc:xr()}),!1):!!Ct(n)||(h=!0,n.forEach(function(v){if(!Sn(v))return St({api:s,paramName:l,desc:dp("key")}),h=!1}),h);var h}}},setGroupCounters:{groupID:kt,counters:Wn},increaseGroupCounter:{groupID:kt,key:kt,value:Uo},decreaseGroupCounter:{groupID:kt,key:kt,value:Uo},getGroupCounters:{groupID:kt},getGroupMemberList:{groupID:kt,count:{type:"Number"}},getGroupMemberProfile:{groupID:kt,userIDList:Bn,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:kt,userIDList:Bn},setGroupMemberRole:{groupID:kt,userID:kt,role:kt},setGroupMemberMuteTime:{groupID:kt,userID:kt,muteTime:{type:"Number",validator:function(n){return 0<=n}}},setGroupMemberNameCard:{groupID:kt,userID:{type:"String"},nameCard:{type:"String",validator:function(n,s,l){return Sn(n)?(n.length,!0):(St({api:s,paramName:l,desc:Pi()}),!1)}}},setGroupMemberCustomField:{groupID:kt,userID:{type:"String"},memberCustomField:Bn},deleteGroupMember:{groupID:kt},markGroupMemberList:{groupID:kt,markType:{type:"number",validator:function(n,s,l){return un(n)?!(n<1e3&&(St({api:s,paramName:l,desc:Bd(l,1e3)}),1)):(St({api:s,paramName:l,desc:Vc()}),!1)}},userIDList:i({},Bn),enableMark:i({},tr)},createTextMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?Sn(n.text)?n.text.length!==0||(St({api:s,paramName:"payload.text",desc:Zm()}),!1):(St({api:s,paramName:"payload.text",desc:Pi()}),!1):(St({api:s,paramName:l,desc:ds()}),!1)}})},createTextAtMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?Sn(n.text)?n.text.length===0?(St({api:s,paramName:"payload.text",desc:Zm()}),!1):!(n.atUserList&&!Rt(n.atUserList)&&(St({api:s,paramName:"payload.atUserList",desc:xr()}),1)):(St({api:s,paramName:"payload.text",desc:Pi()}),!1):(St({api:s,paramName:l,desc:ds()}),!1)}})},createCustomMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?n.data&&!Sn(n.data)?(St({api:s,paramName:"payload.data",desc:Pi()}),!1):n.description&&!Sn(n.description)?(St({api:s,paramName:"payload.description",desc:Pi()}),!1):!(n.extension&&!Sn(n.extension)&&(St({api:s,paramName:"payload.extension",desc:Pi()}),1)):(St({api:s,paramName:"payload",desc:ds()}),!1)}})},createImageMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){if(!xn(n))return St({api:s,paramName:l,desc:ds()}),!1;if(Qe(n.file))return St({api:s,paramName:"payload.file",desc:cp()}),!1;if(Ae){if(!(n.file instanceof HTMLInputElement||Cn(n.file)))return xn(n.file)&&typeof uni<"u"?n.file.tempFilePaths.length!==0&&n.file.tempFiles.length!==0||(St({api:s,paramName:"payload.file",desc:Gc()}),!1):(St({api:s,paramName:"payload.file",desc:Gd()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:s,paramName:"payload.file",desc:Gc()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:up()}),!0}}})},createAudioMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return!!xn(n)||(St({api:s,paramName:l,desc:ds()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:up()}),!0}}},createVideoMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){if(!xn(n))return St({api:s,paramName:l,desc:ds()}),!1;if(Qe(n.file))return St({api:s,paramName:"payload.file",desc:cp()}),!1;if(Ae){if(!(n.file instanceof HTMLInputElement||Cn(n.file)))return xn(n.file)&&typeof uni<"u"?!!Cn(n.file.tempFile)||(St({api:s,paramName:"payload.file",desc:Gc()}),!1):(St({api:s,paramName:"payload.file",desc:Gd()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:s,paramName:"payload.file",desc:Gc()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:up()}),!0}}},createFaceMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?un(n.index)?!!Sn(n.data)||(St({api:s,paramName:"payload.data",desc:Pi()}),!1):(St({api:s,paramName:"payload.index",desc:Vc()}),!1):(St({api:s,paramName:l,desc:ds()}),!1)}})},createFileMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){if(!xn(n))return St({api:s,paramName:l,desc:ds()}),!1;if(Qe(n.file))return St({api:s,paramName:"payload.file",desc:cp()}),!1;if(Ae){if(!(n.file instanceof HTMLInputElement||Cn(n.file)))return xn(n.file)&&typeof uni<"u"?n.file.tempFilePaths.length!==0&&n.file.tempFiles.length!==0||(St({api:s,paramName:"payload.file",desc:Gc()}),!1):(St({api:s,paramName:"payload.file",desc:Gd()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:s,paramName:"payload.file",desc:Gc()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:up()}),!0}}},createLocationMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?Sn(n.description)?un(n.longitude)?!!un(n.latitude)||(St({api:s,paramName:"payload.latitude",desc:Vc()}),!1):(St({api:s,paramName:"payload.longitude",desc:Vc()}),!1):(St({api:s,paramName:"payload.description",desc:Pi()}),!1):(St({api:s,paramName:l,desc:ds()}),!1)}})},createMergerMessage:{to:kt,conversationType:kt,payload:i(i({},Wn),{},{validator:function(n,s,l){if(Ct(n.messageList))return St({api:s,paramName:"payload.messageList",desc:Rs()}),!1;if(Ct(n.compatibleText))return St({api:s,paramName:"payload.compatibleText",desc:Fc("compatibleText")}),!1;var h=!1;return n.messageList.forEach(function(v){v.status===ov&&(h=!0)}),!h||(St({api:s,paramName:"payload.messageList",desc:to("MergeFailedMessageLog")}),!1)}})},revokeMessage:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return Ct(n)?(St({api:s,paramName:l,desc:hp()}),!1):n.conversationType===O.CONV_SYSTEM?(St({api:s,paramName:l,desc:to("MessageCanBeRevokedDesc")}),!1):n.isRevoked!==!0||(St({api:s,paramName:l,desc:to("MessageRevokedLog")}),!1)}})],deleteMessage:[i(i({name:"messageList"},Bn),{},{validator:function(n,s,l){return!Ct(n)||(St({api:s,paramName:l,desc:Rs()}),!1)}})],translateText:{sourceTextList:Bn,sourceLanguage:kt,targetLanguage:kt},convertVoiceToText:{message:i(i({},Wn),{},{validator:function(n,s,l){return Ct(n)?(St({api:s,paramName:l,desc:hp()}),!1):n.type===O.MSG_AUDIO&&n.status===Ui||(St({api:s,paramName:l,desc:to("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return Ct(n)?(St({api:s,paramName:l,desc:hp()}),!1):n.conversationType===O.CONV_SYSTEM?(St({api:s,paramName:l,desc:to("MessageCanBeModifiedLog")}),!1):n._onlineOnlyFlag!==!0||(St({api:s,paramName:l,desc:to("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:{type:"Array",required:!1,validator:function(n,s,l){return!(n&&(Rt(n)?n.length===0?(St({api:s,paramName:l,desc:Rs()}),1):5<n.length&&(St({api:s,paramName:l,desc:PI(l,5)}),1):(St({api:s,paramName:l,desc:xr()}),1)))}},keywordListMatchType:{type:"String",required:!1,validator:function(n,s,l){return!n||n==="or"||n==="and"||St({api:s,paramName:l,desc:"".concat(n," is invalid match type")})}},senderUserIDList:{type:"Array",required:!1,validator:function(n,s,l){return!(n&&(Rt(n)?(n.length===0&&St({api:s,paramName:l,desc:Rs()}),5<n.length&&(St({api:s,paramName:l,desc:PI(l,5)}),1)):(St({api:s,paramName:l,desc:xr()}),1)))}},messageTypeList:{type:"Array",required:!1,validator:function(n,s,l){if(!n)return!0;if(!Rt(n))return St({api:s,paramName:l,desc:xr()}),!1;n.length===0&&St({api:s,paramName:l,desc:Rs()});var h=[O.MSG_TEXT,O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_FILE,O.MSG_VIDEO,O.MSG_LOCATION,O.MSG_CUSTOM,O.MSG_MERGER];return!(0<n.filter(function(v){return h.indexOf(v)===-1}).length&&(St({api:s,paramName:l,desc:to("ContainsUnsupportedMessageTypeLog",l)}),1))}},conversationID:{type:"String",required:!1,validator:function(n){return!n||Ur(n)}},timePosition:{type:"number",required:!1,validator:function(n,s,l){return!(n&&n<0&&(St({api:s,paramName:l,desc:Bd(l,0)}),1))}},timePeriod:{type:"number",required:!1,validator:function(n,s,l){return!(n&&n<0&&(St({api:s,paramName:l,desc:Bd(l,0)}),1))}},cursor:{type:"String",required:!1}},getUserProfile:{userIDList:{type:"Array",validator:function(n,s,l){return Rt(n)?(n.length===0&&St({api:s,paramName:l,desc:Rs()}),!0):(St({api:s,paramName:l,desc:xr()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(n,s,l){return!!Qe(n)||!!Rt(n)||(St({api:s,paramName:l,desc:xr()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(n,s,l){return!!Sn(n)||(St({api:s,paramName:l,desc:Pi()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(n,s,l){return Rt(n)?n.length!==0||(St({api:s,paramName:l,desc:Rs()}),!1):(St({api:s,paramName:l,desc:xr()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(n,s,l){return Rt(n)?n.length!==0||(St({api:s,paramName:l,desc:Rs()}),!1):(St({api:s,paramName:l,desc:xr()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(n,s,l){return!n||!!Rt(n)||(St({api:s,paramName:l,desc:xr()}),!1)}}},addFriend:{to:kt,source:{type:"String",required:!0,validator:function(n,s,l){return!(!n||(n.startsWith("AddSource_Type_")?8<n.replace("AddSource_Type_","").length&&(St({api:s,paramName:l,desc:$a("keyword",8)}),1):(St({api:s,paramName:l,desc:to("SourcePrefixLog")}),1)))}},remark:{type:"String",required:!1,validator:function(n,s,l){return!(Sn(n)&&96<n.length&&(St({api:s,paramName:l,desc:$a(l,96)}),1))}}},deleteFriend:{userIDList:Bn},checkFriend:{userIDList:Bn},getFriendProfile:{userIDList:Bn},updateFriend:{userID:kt,remark:{type:"String",required:!1,validator:function(n,s,l){return!(Sn(n)&&96<n.length&&(St({api:s,paramName:l,desc:$a(l,96)}),1))}},friendCustomField:{type:"Array",required:!1,validator:function(n,s,l){if(n){if(!Rt(n))return St({api:s,paramName:l,desc:xr()}),!1;var h=!0;return n.forEach(function(v){return Sn(v.key)&&v.key.indexOf("Tag_SNS_Custom")!==-1?Sn(v.value)?8<v.key.replace("Tag_SNS_Custom_","").length?(St({api:s,paramName:l,desc:$a("keyword",8)}),h=!1):void 0:(St({api:s,paramName:l,desc:dp("value")}),h=!1):(St({api:s,paramName:l,desc:to("FriendCustomFieldPrefixLog")}),h=!1)}),h}return!0}}},acceptFriendApplication:{userID:kt},refuseFriendApplication:{userID:kt},deleteFriendApplication:{userID:kt},createFriendGroup:{name:kt},deleteFriendGroup:{name:kt},addToFriendGroup:{name:kt,userIDList:Bn},removeFromFriendGroup:{name:kt,userIDList:Bn},renameFriendGroup:{oldName:kt,newName:kt},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(n,s,l){return Rt(n)?n.length!==0||(St({api:s,paramName:l,desc:Rs()}),!1):(St({api:s,paramName:l,desc:xr()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(n,s,l){return Rt(n)?n.length!==0||(St({api:s,paramName:l,desc:Rs()}),!1):(St({api:s,paramName:l,desc:xr()}),!1)}}],createTopicInCommunity:{groupID:kt,topicName:kt},deleteTopicFromCommunity:{groupID:kt,topicIDList:{type:"Array",validator:function(n,s,l){return!n||!!Rt(n)||(St({api:s,paramName:l,desc:xr()}),!1)}}},updateTopicProfile:{groupID:kt,topicID:kt},getTopicList:{groupID:kt,topicIDList:{type:"Array",validator:function(n,s,l){return!n||!!Rt(n)||(St({api:s,paramName:l,desc:xr()}),!1)}}},followUser:[i({name:"userIDList"},Bn)],unfollowUser:[i({name:"userIDList"},Bn)],getMyFollowingList:[i(i({name:"startIndex"},kt),{},{required:!1})],getMyFollowersList:[i(i({name:"startIndex"},kt),{},{required:!1})],getMutualFollowersList:[i(i({name:"startIndex"},kt),{},{required:!1})],getUserFollowInfo:[i(i({name:"userIDList"},Bn),{},{required:!1})],checkFollowType:[i({name:"userIDList"},Bn)],addSignalingListener:[{name:"eventName",type:"String",validator:function(n,s,l){return typeof n=="string"&&n.length!==0||(St({api:s,paramName:l,desc:Fc(l)}),!1)}},{name:"handler",type:"Function",validator:function(n,s,l){return typeof n!="function"?(St({api:s,paramName:l,desc:us()}),!1):(n.name===""&&St({api:s,paramName:l,desc:$d()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(n,s,l){return typeof n=="string"&&n.length!==0||(St({api:s,paramName:l,desc:Fc(l)}),!1)}},{name:"handler",type:"Function",validator:function(n,s,l){return typeof n!="function"?(St({api:s,paramName:l,desc:us()}),!1):(n.name===""&&St({api:s,paramName:l,desc:$d()}),!0)}}],invite:{userID:kt},inviteSync:[i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?!!Sn(n.userID)||(St({api:s,paramName:"options.userID",desc:Pi()}),!1):(St({api:s,paramName:"options",desc:ds()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:us()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:us()}),!0}}],inviteInGroup:{groupID:kt,inviteeList:Bn},inviteInGroupSync:[i(i({},Wn),{},{validator:function(n,s,l){return xn(n)?Sn(n.groupID)?!!Rt(n.inviteeList)||(St({api:s,paramName:"options.inviteeList",desc:xr()}),!1):(St({api:s,paramName:"options.groupID",desc:Pi()}),!1):(St({api:s,paramName:"options",desc:ds()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:us()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(n,s,l){return Qe(n)&&St({api:s,paramName:l,desc:us()}),!0}}],accept:{inviteID:kt},reject:{inviteID:kt},getSignalingInfo:[i(i({name:"message"},Wn),{},{validator:function(n,s,l){return!Ct(n)||(St({api:s,paramName:l,desc:hp()}),!1)}})],modifyInvitation:{inviteID:kt,data:kt}},xI={login:1,logout:1,getLoginUser:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,searchCloudMessages:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,setMessageRemindType:1,setAllReceiveMessageOpt:1,getAllReceiveMessageOpt:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,followUser:1,unfollowUser:1,getMyFollowingList:1,getMyFollowersList:1,getMutualFollowersList:1,getUserFollowInfo:1,checkFollowType:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},so=(_(Xd,R(Error)),nv=D(Xd),p(Xd)),Be={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AVCHATROOM:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_FUNCTION_ERROR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AVCHATROOM:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,CANNOT_JOIN_WORK:2601,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AVCHATROOM:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,CANNOT_DISMISS_WORK:2622,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AVCHATROOM:2661,CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN:2662,NOT_OWNER:2681,CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM:2682,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AVCHATROOM:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,CANNOT_FIND_PROTOCOL:2997,CANNOT_FIND_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,CANNOT_USE_COMMERCIAL_ABILITY:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020,MSG_SEARCH_CURSOR_INVALID:27002,MSG_SEARCH_CURSOR_EXPIRED:27003},Nl=null,Uo=(p(Iv,[{key:"isLoggedIn",value:function(){return this._m.get(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.get(12).isOversea()}},{key:"isPrivateNetWork",value:function(){return this._m.get(12).isPrivateNetWork()}},{key:"getFileDownloadProxy",value:function(){return this._m.get(12).getFileDownloadProxy()}},{key:"getMyUserID",value:function(){return this._m.get(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.get(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.get(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.get(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.get(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.get(12).isDevMode()}},{key:"get",value:function(n){return this._m.get(n)}},{key:"getPlatform",value:function(){return je}},{key:"getCloudConfig",value:function(n){return this._m.get(23).getCloudConfig(n)}},{key:"emitOuterEvent",value:function(n,s){this._m.getOuterEmitterInstance().emit(n,s)}},{key:"emitInnerEvent",value:function(n,s){this._m.getInnerEmitterInstance().emit(n,s)}},{key:"getInnerEmitterInstance",value:function(){return this._m.getInnerEmitterInstance()}},{key:"generateTjgID",value:function(n){return this._m.get(12).getTinyID()+"-"+n.random}},{key:"req",value:function(n){return this._m.get(20).req(n)}},{key:"canIUse",value:function(n){return this._m.get(27).canIUse(n)}},{key:"getErrorMessage",value:function(n,s,l){return this._m.getErrorMessage(n,s,l)}},{key:"outputWarning",value:function(n,s,l){n=this.getErrorMessage(n,s,l),n&&q.w(n)}},{key:"cannotUseCommercialAbility",value:function(n){var s=Be.CANNOT_USE_COMMERCIAL_ABILITY;return Re({code:s,message:this.getErrorMessage(s,n)})}}]),Iv),fe={LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MSG:"getmsg",SEND_C2C_MSG:"sendmsg",SEND_GRP_MSG:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BL:"black_list_get",ADD_TO_BL:"black_list_add",RM_FROM_BL:"black_list_delete",GET_FD_LIST:"friend_get",GET_FD_PROFILE:"friend_get_specified",CHECK_FD:"friend_check",DEL_FD:"friend_delete",ADD_FD:"friend_add",UPDATE_FD:"friend_update",RESPOND_FD_APPLICATION:"friend_response",GET_FD_APPLICATION_LIST:"pendency_get",DEL_FD_APPLICATION:"pendency_delete",REFUSE_FD_APPLICATION:"pendency_refuse",REPORT_FD_APPLICATION:"pendency_report",GET_FD_GRP_LIST:"group_get",CREATE_FD_GRP:"group_add",DEL_FD_GRP:"group_delete",UPDATE_FD_GRP:"group_update",REVOKE_C2C_MSG:"msgwithdraw",SET_C2C_MSG_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MSG:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DEL_C2C_MSG:"delete_c2c_msg_ramble",MODIFY_C2C_MSG:"modify_c2c_msg",MODIFY_C2C_MSG_EXT:"set_key_values",GET_C2C_MSG_EXT:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",RM_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONV_LIST:"page_get",DEL_CONV:"batch_delete",CLEAR_HISTORY_MSG:"clear_msg",PIN_CONV:"top",DEL_GROUP_AT_TIPS:"deletemsg",SET_CONV_CUSTOM_DATA:"set_conv_custom_data",MARK_CONV:"mark_contact",CREATE_CONV_GRP:"create_contact_group",DEL_CONV_GRP:"del_contact_group",RENAME_CONV_GRP:"update_contact_group",ADD_CONV_TO_GRP:"add_conv_to_group",DEL_CONV_FROM_GRP:"del_conv_from_group",GET_CONV_GRP_LIST:"get_contact_group",SEARCH_CONV_GRP_MARK:"search_contact_group",GET_GRP_LIST:"get_joined_group_list",GET_GRP_PROFILE:"get_group_self_member_info",CREATE_GRP:"create_group",DISMISS_GRP:"destroy_group",UPDATE_GRP_PROFILE:"modify_group_base_info",APPLY_JOIN_GRP:"apply_join_group",APPLY_JOIN_GRP_NOAUTH:"apply_join_group_noauth",QUIT_GRP:"quit_group",SEARCH_GRP:"get_group_public_info",CHANGE_GRP_OWNER:"change_group_owner",HANDLE_GRP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GRP:"handle_invite_join_permission_group",HANDLE_GRP_INVITATION:"handle_invite_join_group",REVOKE_GRP_MSG:"group_msg_recall",SET_GRP_MSG_READ:"msg_read_report",SET_ALL_MSG_READ:"read_all_unread_msg",GET_GRP_ROAMING_MSG:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GRP_PENDENCY:"get_pendency",DEL_GRP_SYSTEM_NOTICE:"deletemsg",AV_POLLING:"get_msg",AV_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MBR_NUM:"get_online_member_num",DEL_GRP_MSG:"delete_group_ramble_msg_by_seq",MODIFY_GRP_MSG:"modify_group_msg",SET_GRP_ATTR:"set_group_attr",MODIFY_GRP_ATTR:"modify_group_attr",DEL_GRP_ATTR:"delete_group_attr",CLEAR_GRP_ATTR:"clear_group_attr",GET_GRP_ATTR:"get_group_attr",MODIFY_GRP_MSG_EXT:"group_set_key_values",GET_GRP_MSG_EXT:"group_get_key_values",GET_GRP_NOTIFY:"batch_get_group_notify",UPDATE_GRP_COUNTER:"update_group_counter",GET_GRP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",RM_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GRP_MBR_LIST:"get_group_member_info",GET_AV_MBR_LIST:"get_members",GET_GRP_MBR_PROFILE:"get_specified_group_member_info",ADD_GRP_MBR:"add_group_member",DEL_GRP_MBR:"delete_group_member",BAN_AV_MBR:"ban_group_member",MODIFY_GRP_MBR_INFO:"modify_group_member_info",MARK_AV_MBR_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MSG_PUSH:"msg_push",MSG_CLOUD_SEARCH:"query",MULTI_MSG_PUSH:"multi_msg_push_ws",MSG_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MSG:"save_relay_json_msg",DOWNLOAD_MERGER_MSG:"get_relay_json_msg",FETCH_CLOUD_CTRL_CONFIG:"fetch_config",PUSHED_CLOUD_CTRL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DEL_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUB_USER_STATUS:"ws_status_subscribe",UNSUB_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PUSH_REPORT:"uniapp_sdk_report",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition",FOLLOW:"follow_add",UNFOLLOW:"follow_delete",GET_FOLLOW:"follow_get",GET_FOLLOW_INFO:"follow_get_info",CHECK_FOLLOW_TYPE:"follow_check",SET_ALL_RECEIVE_MSG_OPT:"ws_set_do_not_disturb",GET_ALL_RECEIVE_MSG_OPT:"ws_get_do_not_disturb"},qd="networkRTT",Kd="messageE2EDelay",ua="sendMessageC2C",Ds="sendMessageGroup",da="sendMessageGroupAV",Ha="sendMessageRichMedia",kr="cosUpload",Hc="messageReceivedGroup",qc="messageReceivedGroupAVPush",zd="messageReceivedGroupAVPull",Kc=(m(tr={},qd,2),m(tr,Kd,3),m(tr,ua,4),m(tr,Ds,5),m(tr,da,6),m(tr,Ha,7),m(tr,Hc,8),m(tr,qc,9),m(tr,zd,10),m(tr,kr,11),tr),M1={info:4,warning:5,error:6},FI={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},ha={login:4,plugin_search:16,plugin_translate:16,plugin_voice_to_text:16,plugin_cs:16,plugin_push:16,plugin_bot:16,plugin_emoji_reaction:16},it=(p(Ll,[{key:"updateTimeStamp",value:function(){this.timestamp=oo()}},{key:"start",value:function(n){return this._startts=n,this}},{key:"end",value:function(){var n,s=this,l=0<arguments.length&&arguments[0]!==void 0&&arguments[0];this._sentFlag||(this._netMonitorModule&&(n=this._netMonitorModule.getNetworkType(),this.setNetworkType(n)),n=oo(),this.costTime===0&&(this.costTime=n-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(n)),l?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout(function(){s._sentFlag=!0,s._eventStatModule&&s._eventStatModule.pushIn(s)},0))}},{key:"setError",value:function(n){if(!(n instanceof Error))return q.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;var s=!0;return(s=this._netMonitorModule?this._netMonitorModule.isOnline():s)?(n.code&&this.setCode(n.code),n.message&&this.setMoreMessage(n.message)):this.setCode(Be.NO_NETWORK),this.setLevel("error"),this}},{key:"setCode",value:function(n){return Qe(n)||this._sentFlag||(n==="ECONNABORTED"&&(this.code=103),un(n)?this.code=n:q.w("".concat(this._n,".setCode value not a number, please check!"),n,c(n))),this}},{key:"setMessage",value:function(n){return Qe(n)||this._sentFlag||(un(n)&&(this.message=n.toString()),Sn(n)&&(this.message=n)),this}},{key:"setCostTime",value:function(n){return this.costTime=n,this}},{key:"setLevel",value:function(n){return Qe(n)||this._sentFlag||(this.level=M1[n]),this}},{key:"setMoreMessage",value:function(n){return Ct(this.moreMessage)?this.moreMessage="".concat(n):this.moreMessage+=" ".concat(n),this}},{key:"setNetworkType",value:function(n){return Qe(n)?q.w("".concat(this._n,".setNetworkType value is undefined, please check!")):(n=FI[n.toLowerCase()],Qe(n)||(this.networkType=n)),this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(n){return this.uiPlatform=n,this}},{key:"setExtension",value:function(n){return this.extension=n,this}},{key:"setEventType",value:function(n){return this.eventType=n,this}}],[{key:"bindEventStatModule",value:function(n){Ll.prototype._eventStatModule=n}},{key:"bindNetMonitorModule",value:function(n){Ll.prototype._netMonitorModule=n}}]),Ll),fp=(p(yv,[{key:"setText",value:function(n){this.content.text=n}},{key:"sendable",value:function(){return this.content.text.length!==0}}]),yv),iv=(p(zc,[{key:"_initImageInfoModel",value:function(){var n=this;this._ImageInfoModel=function(s){this.instanceID=dn(9999999),this.sizeType=s.type||0,this.type=0,this.size=s.size||0,this.width=s.width||0,this.height=s.height||0,this.imageUrl=s.imageUrl||s.url||"",this.url=oi(s.url||n._imageMemoryURL,n._fileDownloadProxy)},this._ImageInfoModel.prototype={setSizeType:function(s){this.sizeType=s},setType:function(s){this.type=s},setImageUrl:function(s){s&&(this.imageUrl=s)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(n){for(var s,l=0,h=null;l<=2;)s=Qe(n)||Qe(n[l])?{type:0,size:0,width:0,height:0,url:""}:n[l],(h=new this._ImageInfoModel(s)).setSizeType(l+1),h.setType(l),this.addImageInfo(h),l++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(n){for(var s,l=this.content.imageInfoArray.length,h=0;h<l;h++)s=this.content.imageInfoArray[h],n[h].size&&(s.size=n[h].size),n[h].url&&s.setImageUrl(n[h].url),n[h].width&&(s.width=n[h].width),n[h].height&&(s.height=n[h].height)}},{key:"_autoFixUrl",value:function(){for(var n=this.content.imageInfoArray.length,s="",l="",h=["http","https"],v=null,I=0;I<n;I++)this.content.imageInfoArray[I].url&&(v=this.content.imageInfoArray[I]).imageUrl!==""&&(l=v.imageUrl.slice(0,v.imageUrl.indexOf("://")+1),s=v.imageUrl.slice(v.imageUrl.indexOf("://")+1),h.indexOf(l)<0&&(l="https:"),this.content.imageInfoArray[I].setImageUrl([l,s].join("")))}},{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateImageFormat",value:function(n){this.content.imageFormat=xo[n.toUpperCase()]||xo.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(n){n!==void 0&&0<n.files.length&&(this._imageMemoryURL=window.URL.createObjectURL(n.files[0]))}},{key:"createImageDataASURLInWXMiniApp",value:function(n){n&&n.url&&(this._imageMemoryURL=n.url)}},{key:"replaceImageInfo",value:function(n,s){this.content.imageInfoArray[s]instanceof this._ImageInfoModel||(this.content.imageInfoArray[s]=n)}},{key:"addImageInfo",value:function(n){3<=this.content.imageInfoArray.length||this.content.imageInfoArray.push(n)}},{key:"updateAccessSideImageInfoArray",value:function(){var n=this.content.imageInfoArray,l=n[0],s=l.width,s=s===void 0?0:s,l=l.height,l=l===void 0?0:l;s!==0&&l!==0&&(wI(n),Object.assign(n[2],Ud({originWidth:s,originHeight:l,min:720})))}},{key:"sendable",value:function(){return this.content.imageInfoArray.length!==0&&this.content.imageInfoArray[0].imageUrl!==""&&this.content.imageInfoArray[0].size!==0}}]),zc),sv=(p(gp,[{key:"sendable",value:function(){return this.content!==null}}]),gp),Wd=(p(_v,[{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateAudioUrl",value:function(n){this.content.remoteAudioUrl=n}},{key:"sendable",value:function(){return this.content.remoteAudioUrl!==""}}]),_v),av={from:!0,groupID:!0,groupName:!0,to:!0},VI=(p(vv,[{key:"_initContent",value:function(n){var s=this;Object.keys(n).forEach(function(l){switch(l){case"remarkInfo":break;case"groupProfile":s.content.groupProfile={},s._initGroupProfile(n[l]);break;case"operatorInfo":break;case"memberInfoList":case"msgMemberInfo":s._updateMemberList(n[l]);break;case"memberExtraInfo":case"onlineMemberInfo":break;case"memberNum":s.content[l]=n[l],s.content.memberCount=n[l];break;case"newGroupProfile":s.content.newGroupProfile={},s._initNewGroupProfile(n[l]);break;default:s.content[l]=n[l]}}),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(n){for(var s=Object.keys(n),l=0;l<s.length;l++){var h=s[l];av[h]&&(this.content.groupProfile[h]=n[h])}}},{key:"_updateMemberList",value:function(n){Ct(this.content.memberList)?this.content.memberList=n:this.content.memberList.forEach(function(s){n.forEach(function(l){s.userID===l.userID&&Object.assign(s,l)})})}},{key:"_initNewGroupProfile",value:function(n){for(var s=Object.keys(n),l=0;l<s.length;l++){var h=s[l];this.content.newGroupProfile[h]=h!=="muteAllMembers"?n[h]:n[h]===1}}}]),vv),k1={from:!0,groupID:!0,groupName:!0,to:!0,groupType:!0},lv=(p(mv,[{key:"_initContent",value:function(n){var s=this;Object.keys(n).forEach(function(l){switch(l){case"memberInfoList":break;case"remarkInfo":s.content.handleMessage=n[l];break;case"groupProfile":s.content.groupProfile={},s._initGroupProfile(n[l]);break;default:s.content[l]=n[l]}})}},{key:"_initGroupProfile",value:function(n){for(var s=Object.keys(n),l=0;l<s.length;l++){var h=s[l];k1[h]&&(h==="groupName"?this.content.groupProfile.name=n[h]:this.content.groupProfile[h]=n[h])}}}]),mv),Yd=(p(gv,[{key:"_getFileInfo",value:function(l){if(!Qe(l.fileName)&&!Qe(l.fileSize))return{size:l.fileSize,name:l.fileName};var s,l=l.file.files[0];return qe&&(l.path&&l.path.indexOf(".")!==-1&&(s=l.path.slice(l.path.lastIndexOf(".")+1).toLowerCase(),l.type=s,l.name||(l.name="".concat(dn(999999),".").concat(s))),l.name||(l.type="",l.name=l.path.slice(l.path.lastIndexOf("/")+1).toLowerCase()),l.suffix&&(l.type=l.suffix),l.url||(l.url=l.path)),{size:l.size,name:l.name}}},{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateFileUrl",value:function(n){this.content.fileUrl=n}},{key:"sendable",value:function(){return this.content.fileUrl!==""&&this.content.fileName!==""&&this.content.fileSize!==0}}]),gv),cv=(p(pv,[{key:"setData",value:function(n){return this.content.data=n,this}},{key:"setDescription",value:function(n){return this.content.description=n,this}},{key:"setExtension",value:function(n){return this.content.extension=n,this}},{key:"sendable",value:function(){return this.content.data.length!==0||this.content.description.length!==0||this.content.extension.length!==0}}]),pv),Wi=(p(fv,[{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateVideoUrl",value:function(n){n&&(this.content.remoteVideoUrl=n)}},{key:"updateSnapshotInfo",value:function(h){var s=h.snapshotUrl,l=h.snapshotWidth,h=h.snapshotHeight;Ct(s)||(this.content.thumbUrl=this.content.snapshotUrl=s),Ct(l)||(this.content.thumbWidth=this.content.snapshotWidth=Number(l)),Ct(h)||(this.content.thumbHeight=this.content.snapshotHeight=Number(h))}},{key:"sendable",value:function(){return this.content.remoteVideoUrl!==""}}]),fv),qa=(p(hv,[{key:"sendable",value:function(){return!0}}]),hv),Wr=(p(dv,[{key:"_patchRichMediaPayload",value:function(n,s){n===O.MSG_IMAGE?s.imageInfoArray.forEach(function(l){!l.imageUrl&&l.url&&(l.imageUrl=l.url,l.sizeType=l.type,l.type===1?l.type=0:l.type===3&&(l.type=1))}):n===O.MSG_VIDEO?!s.remoteVideoUrl&&s.videoUrl&&(s.remoteVideoUrl=s.videoUrl):n===O.MSG_AUDIO?!s.remoteAudioUrl&&s.url&&(s.remoteAudioUrl=s.url):n===O.MSG_FILE&&!s.fileUrl&&s.url&&(s.fileUrl=s.url,s.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(n,s,l){l&&(n===O.MSG_IMAGE?s.imageInfoArray.forEach(function(h){h.url=oi(h.url,l)}):n===O.MSG_VIDEO?(s.videoUrl=oi(s.videoUrl,l),s.snapshotUrl=oi(s.thumbUrl,l),s.snapshotHeight=s.thumbHeight,s.snapshotWidth=s.thumbWidth):n===O.MSG_AUDIO?s.url=oi(s.url,l):n===O.MSG_FILE&&(s.fileUrl=oi(s.fileUrl,l)))}}]),dv),Ka=(p(uv,[{key:"sendable",value:function(){return!Ct(this.content.messageList)||!Ct(this.content.downloadKey)}}]),uv),Jd={1:O.MSG_PRIORITY_HIGH,2:O.MSG_PRIORITY_NORMAL,3:O.MSG_PRIORITY_LOW,4:O.MSG_PRIORITY_LOWEST},er=(p(pp,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(n){n!==null&&(Sn(n.nick)&&(this.nick=n.nick),Sn(n.avatar)&&(this.avatar=n.avatar),n=n.messageFromAccountExtraInformation,xn(n)&&Sn(n.nameCard)&&(this.nameCard=n.nameCard))}},{key:"handleGroupAtInfo",value:function(n){var s=this;n.payload&&n.payload.atUserList&&n.payload.atUserList.forEach(function(l){l!==O.MSG_AT_ALL?(s._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:l}),s.atUserList.push(l)):(s._groupAtInfoList.push({groupAtAllFlag:1}),s.atUserList.push(O.MSG_AT_ALL))}),Rt(n.groupAtInfo)&&n.groupAtInfo.forEach(function(l){l.groupAtAllFlag===0?s.atUserList.push(l.groupAtUserID):l.groupAtAllFlag===1&&s.atUserList.push(O.MSG_AT_ALL)})}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(n){n&&(this.status=this.from?Ui:Bc,this.from||(this.from=n)),this._initFlow(n),this._initSequence(n),this._concatConversationID(n),this.generateMessageID()}},{key:"isSendable",value:function(){return this._elements.length!==0&&(this._relayFlag===!0||typeof this._elements[0].sendable=="function"&&this._elements[0].sendable())}},{key:"_initTo",value:function(n){this.conversationType===O.CONV_GROUP&&(this.to=n.groupID)}},{key:"_initSequence",value:function(n){var s,l,h;this.clientSequence===0&&n&&(this.clientSequence=!!(n=n)&&(Od[n]===void 0&&(h=new Date,s="3".concat(h.getHours()).slice(-2),l="0".concat(h.getMinutes()).slice(-2),h="0".concat(h.getSeconds()).slice(-2),Od[n]=parseInt([s,l,h,"0001"].join("")),h=l=s=null,q.l("autoIncrementIndex start index:".concat(Od[n]))),Od[n]++)),this.sequence===0&&this.conversationType===O.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===O.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(n){n!==""&&(n===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(n){var s=this.to,l=this.conversationType;l!==O.CONV_SYSTEM?(n=l===O.CONV_C2C?n===this.from?s:this.from:this.to,this.conversationID=n?"".concat(l).concat(n):null):this.conversationID=O.CONV_SYSTEM}},{key:"isElement",value:function(n){return n instanceof fp||n instanceof iv||n instanceof sv||n instanceof Wd||n instanceof Yd||n instanceof Wi||n instanceof VI||n instanceof lv||n instanceof cv||n instanceof qa||n instanceof Ka}},{key:"setElement",value:function(n,s){var l=this;if(this.isElement(n))return this._elements=[n],void this._initProxy();function h(I){if(I.type&&I.content)switch(I.type){case O.MSG_TEXT:l.setTextElement(I.content);break;case O.MSG_IMAGE:l.setImageElement(I.content,s);break;case O.MSG_AUDIO:l.setAudioElement(I.content,s);break;case O.MSG_FILE:l.setFileElement(I.content,s);break;case O.MSG_VIDEO:l.setVideoElement(I.content,s);break;case O.MSG_CUSTOM:l.setCustomElement(I.content);break;case O.MSG_LOCATION:l.setLocationElement(I.content);break;case O.MSG_GRP_TIP:l.setGroupTipElement(I.content);break;case O.MSG_GRP_SYS_NOTICE:l.setGroupSystemNoticeElement(I.content);break;case O.MSG_FACE:l.setFaceElement(I.content);break;case O.MSG_MERGER:l.setMergerElement(I.content,s)}}if(Rt(n))for(var v=0;v<n.length;v++)h(n[v]);else h(n);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(n){n=typeof n=="string"?n:n.text,n=new fp({text:n}),this._elements.push(n)}},{key:"setImageElement",value:function(n,s){n=new iv(n,s),this._elements.push(n)}},{key:"setAudioElement",value:function(n,s){n=new Wd(n,s),this._elements.push(n)}},{key:"setFileElement",value:function(n,s){n=new Yd(n,s),this._elements.push(n)}},{key:"setVideoElement",value:function(n,s){n=new Wi(n,s),this._elements.push(n)}},{key:"setLocationElement",value:function(n){n=new qa(n),this._elements.push(n)}},{key:"setCustomElement",value:function(n){n=new cv(n),this._elements.push(n)}},{key:"setGroupTipElement",value:function(n){var s,l={},h=n.operationType;Ct(n.memberInfoList)?n.operatorInfo&&(l=n.operatorInfo):h!==O.GRP_TIP_MBR_JOIN&&h!==O.GRP_TIP_MBR_KICKED_OUT&&h!==O.GRP_TIP_MBR_SET_ADMIN&&h!==O.GRP_TIP_MBR_CANCELED_ADMIN||(l=n.memberInfoList[0]),Ct(n.memberExtraInfo)||(s=n.memberExtraInfo.reason,n.msgMemberInfo.forEach(function(v){v.reason=s})),h=l.nick,l=l.avatar,Sn(h)&&(this.nick=h),Sn(l)&&(this.avatar=l),h=new VI(n),this._elements.push(h)}},{key:"setGroupSystemNoticeElement",value:function(n){n=new lv(n),this._elements.push(n)}},{key:"setFaceElement",value:function(n){n=new sv(n),this._elements.push(n)}},{key:"setMergerElement",value:function(n,s){n=new Ka(n,s),this._elements.push(n)}},{key:"setIsRead",value:function(n){this.isRead=n}},{key:"setRelayFlag",value:function(n){this._relayFlag=n}},{key:"_computePriority",value:function(n){return Qe(n)?O.MSG_PRIORITY_NORMAL:Sn(n)&&Object.values(Jd).indexOf(n)!==-1?n:un(n)&&(n=""+n,Object.keys(Jd).indexOf(n)!==-1)?Jd[n]:O.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(l){var s=l.nick,l=l.avatar;Sn(s)&&(this.nick=s),Sn(l)&&(this.avatar=l)}},{key:"setNameCard",value:function(n){Sn(n)&&(this.nameCard=n)}},{key:"initC2CReadReceiptInfo",value:function(n){this.conversationType===O.CONV_C2C&&this.needReadReceipt===!0&&(this.readReceiptInfo.isPeerRead=n===1)}}]),pp);function pp(n){u(this,pp),this.ID="",this.conversationID=n.conversationID||null,this.conversationType=n.conversationType||O.CONV_C2C,this.conversationSubType=n.conversationSubType,this.time=n.time||Math.ceil(Date.now()/1e3),this.sequence=n.sequence||0,this.clientSequence=n.clientSequence||n.sequence||0,this.random=n.random||n.random===0?n.random:dn(),this.priority=this._computePriority(n.priority),this.nick=n.nick||"",this.avatar=n.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=Ba(n.checkResult),this._elements=[],this.isPlaceMessage=n.isPlaceMessage||0,this.isRevoked=n.isPlaceMessage===2||n.msgFlagBits===8,this.from=n.from||null,this.to=n.to||null,this.flow="",this.isSystemMessage=n.isSystemMessage||!1,this.protocol=n.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=n.status||Ui,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=n.cloudCustomData||"",this.isDeleted=!1,this.isModified=!1,this._isExcludedFromUnreadCount=!(!n.messageControlInfo||n.messageControlInfo.excludedFromUnreadCount!==1),this._isExcludedFromLastMessage=!(!n.messageControlInfo||n.messageControlInfo.excludedFromLastMessage!==1),this.clientTime=n.clientTime||xt()||0,this.senderTinyID=n.senderTinyID||n.tinyID||"",this.readReceiptInfo=n.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0},this.needReadReceipt=n.needReadReceipt===!0||n.needReadReceipt===1,this.version=n.messageVersion||0,this.isBroadcastMessage=n.isBroadcastMessage||!1,this._receiverList=n.receiverList||void 0,this.isSupportExtension=n.isSupportExtension===!0||n.isSupportExtension===1,this._cmConfigID=n.customModerationConfigurationID,this.revoker=n.revokerInfo&&n.revokerInfo.revoker||"",this.revokerInfo=n.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=n.revokeReason||"",this.reInitialize(n.currentUser),this.extractGroupInfo(n.groupProfile||null),this.handleGroupAtInfo(n),this.initC2CReadReceiptInfo(n.readReceiptSentByPeer)}function uv(n,s){var l,h,v,I,k,P,G;u(this,uv),this.type=O.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},n.downloadKey?(h=n.downloadKey,v=n.pbDownloadKey,I=n.title,k=n.abstractList,P=n.compatibleText,l=n.version,this.content.downloadKey=h,this.content.pbDownloadKey=v,this.content.title=I,this.content.abstractList=k,this.content.compatibleText=P,this.content.version=l||0):Ct(n.messageList)?n.layersOverLimit===1&&(this.content.layersOverLimit=!0):(h=n.messageList,v=n.title,I=n.abstractList,k=n.compatibleText,P=n.version,G=[],h.forEach(function(Y){Ct(Y)||(Y=new Wr(Y,s),G.push(Y))}),this.content.messageList=G,this.content.title=v,this.content.abstractList=I,this.content.compatibleText=k,this.content.version=P||0)}function dv(n,s){var l,h;u(this,dv),this.from=n.from,this.messageSender=n.from,this.time=n.time,this.messageSequence=n.sequence,this.clientSequence=n.clientSequence||n.sequence,this.messageRandom=n.random,this.cloudCustomData=n.cloudCustomData||"",this.clientTime=n.clientTime||void 0,n.ID?(this.ID=n.ID||"",this.nick=n.nick||"",this.avatar=n.avatar||"",n.messageBody?this.messageBody=JSON.parse(JSON.stringify(n.messageBody)):this.messageBody=[{type:n.type,payload:n.payload}],n.conversationType?n.conversationType.startsWith(O.CONV_C2C)?this.receiverUserID=n.to:n.conversationType.startsWith(O.CONV_GROUP)&&(this.receiverGroupID=n.to):n.receiverGroupID?this.receiverGroupID=n.receiverGroupID:n.receiverUserID&&(this.receiverUserID=n.receiverUserID),this.messageReceiver=n.to||n.messageReceiver):(this.nick=n.nick||"",this.avatar=n.avatar||"",this.messageBody=[],l=n.elements[0].type,h=n.elements[0].content,this._patchRichMediaPayload(l,h),this._updateRichMediaDownloadUrl(l,h,s),l===O.MSG_MERGER?this.messageBody.push({type:l,payload:new Ka(h).content}):this.messageBody.push({type:l,payload:h}),n.groupID&&(this.receiverGroupID=n.groupID,this.messageReceiver=n.groupID),n.to&&(this.receiverUserID=n.to,this.messageReceiver=n.to),this.ID="".concat(n.tinyID,"-").concat(n.clientTime,"-").concat(n.random))}function hv(h){u(this,hv),this.type=O.MSG_LOCATION;var s=h.description,l=h.longitude,h=h.latitude;this.content={description:s,longitude:l,latitude:h}}function fv(n,s){u(this,fv),this.type=O.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:n.remoteVideoUrl||n.videoUrl||"",videoFormat:n.videoFormat,videoSecond:parseInt(n.videoSecond,10),videoSize:n.videoSize,videoUrl:oi(n.videoUrl,s),videoDownloadFlag:2,videoUUID:n.videoUUID,thumbUUID:n.thumbUUID,thumbFormat:n.thumbFormat,thumbWidth:n.thumbWidth,snapshotWidth:n.thumbWidth,thumbHeight:n.thumbHeight,snapshotHeight:n.thumbHeight,thumbSize:n.thumbSize,snapshotSize:n.thumbSize,thumbDownloadFlag:2,thumbUrl:oi(n.thumbUrl,s),snapshotUrl:oi(n.thumbUrl,s)}}function pv(n){u(this,pv),this.type=O.MSG_CUSTOM,this.content={data:n.data||"",description:n.description||"",extension:n.extension||""}}function gv(n,s){u(this,gv),this.type=O.MSG_FILE,this._percent=0;var l=this._getFileInfo(n);this.content={downloadFlag:2,fileUrl:oi(n.url||n.fileUrl,s)||"",uuid:n.uuid,fileName:l.name||"",fileSize:l.size||0}}function mv(n){u(this,mv),this.type=O.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(n)}function vv(n){u(this,vv),this.type=O.MSG_GRP_TIP,this.content={},this._initContent(n)}function _v(n,s){u(this,_v),this.type=O.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:n.second,size:n.size,url:oi(n.url,s),remoteAudioUrl:n.url||"",uuid:n.uuid}}function gp(n){u(this,gp),this.type=O.MSG_FACE,this.content=n||null}function zc(n,s){u(this,zc),this._imageMemoryURL="",this._fileDownloadProxy=s,Ie?this.createImageDataASURLInWXMiniApp(n.file):this.createImageDataASURLInWeb(n.file),this._initImageInfoModel(),this.type=O.MSG_IMAGE,this._percent=0,this.content={imageFormat:n.imageFormat||xo.UNKNOWN,uuid:n.uuid,imageInfoArray:[]},this.initImageInfoArray(n.imageInfoArray),this._autoFixUrl()}function yv(n){u(this,yv),this.type=O.MSG_TEXT,this.content={text:n.text||""}}function Ll(n){u(this,Ll),this._n="SSOLogData",this.eventType=ha[n]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=n,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=oo()}function Iv(n){u(this,Iv),this._m=n,this._n=""}function Xd(v){u(this,Xd),s=nv.call(this);var s,l=v.code,h=v.message,v=v.data;return s.code=l,h?s.message=h:s._getErrorMessage&&(s.message=s._getErrorMessage(s.code)),s.data=v||{},s}function mp(n){if(xn(n))return{pushFlag:n.disablePush===!0?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:(l=(l=(s=n).apnsInfo)===void 0?{}:l,h=s.ignoreIOSBadge,s=s.disableVoipPush,h=l.ignoreIOSBadge===!0||(h!==void 0&&h)===!0?1:0,v=void 0,Qe(s)||(v=s===!1?1:0),Qe(l.disableVoipPush)||(v=l.disableVoipPush===!1?1:0),i(i({},l),{},{badgeMode:h,isVoipPush:v})),androidInfo:(l=(l=(s=n).androidInfo)===void 0?{}:l,s=s.androidOPPOChannelID,s=l.OPPOChannelID||(s===void 0?"":s),i(i({},l),{},{Sound:(v=(h=l.sound||"").lastIndexOf("."))===-1?h:h.slice(0,v),OPPOChannelID:s,GoogleChannelID:l.FCMChannelID||""}))};var s,l,h,v}_(Pl,Uo),vp=D(Pl),p(Pl,[{key:"onNewC2CMessage",value:function(l){var I=l.dataList,s=l.isInstantMessage,h=l.C2CRemainingUnreadList,v=l.C2CPairUnreadList,l=l.isSyncingEnded,I=(q.d("".concat(this._n,".onNewC2CMessage count:").concat(I.length," isInstantMessage:").concat(s)),this._newC2CMessageStoredAndSummary({dataList:I,C2CRemainingUnreadList:h,C2CPairUnreadList:v,isInstantMessage:s})),h=I.conversationOptionsList,v=I.messageList,I=I.isUnreadC2CMessage,k=jm(v),k=(0<k.length&&this.emitOuterEvent($.MESSAGE_MODIFIED,k),this.get(11).onNewMessage({conversationOptionsList:h,isInstantMessage:s,isUnreadC2CMessage:I,isSyncingEnded:l}),Ym(v));s&&0<k.length&&this.emitOuterEvent($.MESSAGE_RECEIVED,k),v.length=0}},{key:"_newC2CMessageStoredAndSummary",value:function(n){for(var s=n.dataList,l=n.C2CRemainingUnreadList,h=n.C2CPairUnreadList,v=n.isInstantMessage,I=null,k=[],P=[],G={},Y=this.get(26),te=!1,pe=this.get(11),ye=this.get(4),ve=this.getFileDownloadProxy(),Ue=0,ut=s.length;Ue<ut;Ue++)if(this._isC2CNotice(s[Ue]))this._noticeFromUnreadDBList.push(s[Ue].eventArray[0].c2CNotifyMsgArray[0]);else{var mt=s[Ue],Kt=(mt.currentUser=this.getMyUserID(),mt.conversationType=O.CONV_C2C,mt.isSystemMessage=!!mt.isSystemMessage,(Qe(mt.nick)||Qe(mt.avatar))&&(te=!0,q.d("".concat(this._n,"._newC2CMessageStoredAndSummary nick or avatar missing!"))),(I=new er(mt)).setElement(mt.elements,ve),I.setNickAndAvatar({nick:mt.nick,avatar:mt.avatar}),I.conversationID);if(v){if(this._messageFromUnreadDBMap.get(I.ID))continue;var en,Un,vo=!1,nr=(I.from!==this.getMyUserID()?(Un=pe.getLatestMessageSentByPeer(Kt))&&(en=Un.nick,Un=Un.avatar,te?I.setNickAndAvatar({nick:en,avatar:Un}):en===I.nick&&Un===I.avatar||(vo=!0)):(en=pe.getLatestMessageSentByMe(Kt))&&(Un=en.nick,nr=en.avatar,Un===I.nick&&nr===I.avatar||(pe.modifyMessageSentByMe({conversationID:Kt,latestNick:I.nick,latestAvatar:I.avatar}),ye.mockOnNickAvatarModified(I.nick,I.avatar))),s[Ue].isModified===1);if(pe.isMessageSentByCurrentInstance(I)?I.isModified=nr:nr=!1,mt.msgLifeTime===0)I._onlineOnlyFlag=!0,pe.isMessageSentByCurrentInstance(I)||P.push(I);else{if(!pe.pushIntoMessageList(P,I,nr))continue;vo&&(pe.modifyMessageSentByPeer({conversationID:Kt,latestNick:I.nick,latestAvatar:I.avatar}),pe.updateUserProfileSpecifiedKey({conversationID:Kt,nick:I.nick,avatar:I.avatar}))}v&&0<I.clientTime&&Y.addMessageDelay(I.clientTime)}else this._messageFromUnreadDBMap.set(I.ID,I);if(mt.msgLifeTime!==0){if(I._onlineOnlyFlag===!1){if(vo=pe.getLastMessageTime(Kt),un(vo)&&I.time<vo)continue;Qe(G[Kt])?(mt=0,I.flow==="in"&&(I._isExcludedFromUnreadCount||(mt=1)),G[Kt]=k.push({conversationID:Kt,unreadCount:mt,type:I.conversationType,subType:I.conversationSubType,lastMessage:I._isExcludedFromLastMessage?"":I})-1):(mt=G[Kt],k[mt].type=I.conversationType,k[mt].subType=I.conversationSubType,k[mt].lastMessage=I._isExcludedFromLastMessage?"":I,I.flow==="in"&&(I._isExcludedFromUnreadCount||k[mt].unreadCount++))}}else I._onlineOnlyFlag=!0}this._handleRevokedNoticeFromUnreadDB();var pr=!1;if(Rt(h))for(var br=0,Ya=h.length;br<Ya;br++)(function(hs){var Xa;0<h[hs].unreadCount&&(pr=!0,(Xa=k.find(function(Vb){return Vb.conversationID==="C2C".concat(h[hs].from)}))?Xa.unreadCount=h[hs].unreadCount:k.push({conversationID:"C2C".concat(h[hs].from),unreadCount:h[hs].unreadCount,type:O.CONV_C2C}))})(br);if(Rt(l))for(var Ja=0,lu=l.length;Ja<lu;Ja++)(function(hs){k.find(function(Xa){return Xa.conversationID==="C2C".concat(l[hs].from)})||k.push({conversationID:"C2C".concat(l[hs].from),type:O.CONV_C2C,lastMsgTime:l[hs].lastMsgTime})})(Ja);return{conversationOptionsList:k,messageList:P,isUnreadC2CMessage:pr}}},{key:"getMessageListFromUnreadDB",value:function(){return L(this._messageFromUnreadDBMap.values())}},{key:"_isC2CNotice",value:function(n){return n=n.eventArray,!(!Rt(n)||n[0].event!==10)}},{key:"_handleRevokedNoticeFromUnreadDB",value:function(){var n,s=this._noticeFromUnreadDBList.length;s!==0&&(q.l("".concat(this._n,"._handleRevokedNoticeFromUnreadDB count:").concat(s)),n=[],this._noticeFromUnreadDBList.forEach(function(l){l.hasOwnProperty("c2cMessageRevokedNotify")&&n.push(l)}),this.onC2CMessageRevoked({dataList:n}),this._noticeFromUnreadDBList.length=0,n.length=0)}},{key:"onC2CMessageRevoked",value:function(n){var s,l=this,h=this.get(11),v=[];n.dataList.forEach(function(I){I.c2cMessageRevokedNotify&&(I=I.c2cMessageRevokedNotify.revokedInfos,Qe(I)||I.forEach(function(k){var P=l.getMyUserID()===k.from?"".concat(O.CONV_C2C).concat(k.to):"".concat(O.CONV_C2C).concat(k.from);s=h.revoke(P,k.sequence,k.random);var G,Y=k.revokerInfo&&k.revokerInfo.revoker,te=k.revokerInfo&&k.revokerInfo.reason||"";s?G=s:(G={conversationID:P,sequence:k.sequence},k.tinyID&&k.clientTime&&k.random&&(G.ID="".concat(k.tinyID,"-").concat(k.clientTime,"-").concat(k.random)),k.time&&(G.time=k.time)),G&&(G.revoker=Y,G.revokeReason=te,G.revokerInfo={userID:Y,nick:"",avatar:""},v.push(G))}))}),v.length!==0&&(h.onMessageRevoked(v),q.l("".concat(this._n,".onC2CMessageRevoked count:").concat(v.length)),h.updateRevokerInfo(v).then(function(I){l.emitOuterEvent($.MESSAGE_REVOKED,I)}))}},{key:"onC2CMessageReadReceipt",value:function(n){var s=this;n.dataList.forEach(function(l){var h;Ct(l.c2cMessageReadReceipt)||(h=l.c2cMessageReadReceipt.to,l.c2cMessageReadReceipt.uinPairReadArray.forEach(function(I){var I=I.peerReadTime,k=(q.d("".concat(s._n,"._onC2CMessageReadReceipt to:").concat(h," peerReadTime:").concat(I)),"".concat(O.CONV_C2C).concat(h)),P=s.get(11);P.recordPeerReadTime(k,I),P.updateMessageIsPeerReadProperty(k,I)}))})}},{key:"onC2CMessageReadNotice",value:function(n){var s=this;n.dataList.forEach(function(l){var h;Ct(l.c2cMessageReadNotice)||(h=s.get(11),l.c2cMessageReadNotice.uinPairReadArray.forEach(function(I){var k=I.from,I=I.peerReadTime,k=(q.d("".concat(s._n,".onC2CMessageReadNotice from:").concat(k," lastReadTime:").concat(I)),"".concat(O.CONV_C2C).concat(k));h.updateIsReadAfterReadReport({conversationID:k,lastMessageTime:I}),h.updateUnreadCount(k)}))})}},{key:"onC2CMessageModified",value:function(n){q.d("".concat(this._n,".onC2CMessageModified options:"),JSON.stringify(n));var s=this.get(11);n.dataList.forEach(function(l){s.onMessageModified(i(i({},l),{},{conversationType:O.CONV_C2C}))})}},{key:"onReadReceiptList",value:function(l){q.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(l));var l=l.dataList,s=l.userID,l=l.readReceiptList;this.get(11).updateReadReceiptInfo({userID:s,readReceiptList:l})}},{key:"sendMessage",value:function(n,s){return n=this._createC2CMessagePack(n,s),this.req(n)}},{key:"_createC2CMessagePack",value:function(n,s){var l,h,v=null,I=(s&&(s.offlinePushInfo&&(v=s.offlinePushInfo),s.onlineUserOnly===!0&&(v?v.disablePush=!0:v={disablePush:!0})),""),k=(Sn(n.cloudCustomData)&&0<n.cloudCustomData.length&&(I=n.cloudCustomData),[]),P=(xn(s)&&xn(s.messageControlInfo)&&(P=(h=s.messageControlInfo).excludedFromUnreadCount,l=h.excludedFromLastMessage,h=h.excludedFromContentModeration,P===!0&&k.push("NoUnread"),l===!0&&k.push("NoLastMsg"),h===!0&&k.push("NoMsgCheck")),this.isOnlineMessage(n,s)?0:void 0);return{proto:fe.SEND_C2C_MSG,tjgID:this.generateTjgID(n),data:{fromAccount:this.getMyUserID(),toAccount:n.to,msgBody:n.getElements(),cloudCustomData:I,msgSeq:n.sequence,msgRandom:n.random,msgLifeTime:P,nick:n.nick,avatar:n.avatar,offlinePushInfo:mp(v),messageControlInfo:P!==0?k:void 0,clientTime:n.clientTime,needReadReceipt:n.needReadReceipt===!0?1:0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0,cmConfigID:n._cmConfigID}}}},{key:"isOnlineMessage",value:function(n,s){return!(!s||s.onlineUserOnly!==!0)}},{key:"revokeMessage",value:function(n){return this.req({proto:fe.REVOKE_C2C_MSG,data:{msgInfo:{fromAccount:n.from,toAccount:n.to,msgSeq:n.sequence,msgRandom:n.random,msgTimeStamp:n.time}}})}},{key:"deleteMessage",value:function(l){var s=l.to,l=l.keyList;return q.l("".concat(this._n,".deleteMessage toAccount:").concat(s," count:").concat(l.length)),this.req({proto:fe.DEL_C2C_MSG,data:{fromAccount:this.getMyUserID(),to:s,keyList:l}})}},{key:"modifyRemoteMessage",value:function(Y){var s=Y.from,l=Y.to,h=Y.version,h=h===void 0?0:h,v=Y.sequence,I=Y.random,k=Y.time,P=Y.payload,G=Y.type,Y=Y.cloudCustomData,te=void 0;return OI(G)&&(te=[]).push({type:G,content:P}),this.req({proto:fe.MODIFY_C2C_MSG,data:{from:s,to:l,version:h,sequence:v,random:I,time:k,elements:te,cloudCustomData:Y}})}},{key:"setMessageRead",value:function(I){var s=this,l=I.conversationID,h=I.lastMessageTime,v="".concat(this._n,".").concat("setMessageRead"),I="conversationID:".concat(l," lastMessageTime:").concat(h),k=(q.l("".concat(v," ").concat(I)),un(h)||this.outputWarning("DoNotModifyLastTime"),new it("setMessageRead"));return k.setMessage(I),this.req({proto:fe.SET_C2C_MSG_READ,data:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:l.replace("C2C",""),lastMessageTime:h,receipt:1}]}}}).then(function(){k.end(),q.l("".concat(v," ok"));var P=s.get(11);return P.updateIsReadAfterReadReport({conversationID:l,lastMessageTime:h}),P.updateUnreadCount(l),Ut()}).catch(function(P){return k.setError(P).end(),q.l("".concat(v," failed. error:"),P),Re(P)})}},{key:"getRoamingMessage",value:function(P){var s=this,l="".concat(this._n,".getRoamingMessage"),h=P.peerAccount,v=P.conversationID,I=P.count,k=P.lastMessageTime,P=P.messageKey,G="peerAccount:".concat(h," count:").concat(I||15," lastMessageTime:").concat(k||0," messageKey:").concat(P),Y=(q.l("".concat(l," ").concat(G)),new it("getC2CRoamingMessages"));return this.req({proto:fe.GET_C2C_ROAMING_MSG,data:{peerAccount:h,count:I||15,lastMessageTime:k||0,messageKey:P}}).then(function(ut){var ut=ut.data,ve=ut.complete,Ue=ut.messageList,pe=ut.messageKey,ut=ut.lastMessageTime,ye=(Qe(Ue)?q.l("".concat(l," ok. complete:").concat(ve," but messageList is undefined!")):q.l("".concat(l," ok. complete:").concat(ve," count:").concat(Ue.length)),Y.setMessage("".concat(G," complete:").concat(ve," length:").concat(Ue.length)).end(),s.get(11)),ve=(ve===1&&ye.setCompleted(v),ye.onRoamingMessage(Ue,v)),Ue=(ye.modifyMessageList(v),ye.updateIsRead(v),ye.updateRoamingMessageKeyAndTime(v,pe,ut),ye.getPeerReadTime(v)),ut=(q.l("".concat(l," update isPeerRead property. conversationID:").concat(v," peerReadTime:").concat(Ue)),Ue?ye.updateMessageIsPeerReadProperty(v,Ue):(pe=v.replace(O.CONV_C2C,""),s.getRemotePeerReadTime([pe]).then(function(){ye.updateMessageIsPeerReadProperty(v,ye.getPeerReadTime(v))})),"");return 0<ve.length?ut=ve[0].ID:(Ue=ye.getLocalOldestMessage(v))&&(ut=Ue.ID),q.l("".concat(l," nextReqID:").concat(ut," stored message count:").concat(ve.length)),{nextReqID:ut,storedMessageList:ve}}).catch(function(te){return Y.setMessage(G).setError(te).end(),q.w("".concat(l," failed. error:"),te),Re(te)})}},{key:"getRoamingMessagesHopping",value:function(n){var s=this,l="".concat(this._n,".getRoamingMessagesHopping"),h=n.peerAccount,v=n.time,v=v===void 0?0:v,I=n.count,k=n.direction,P="".concat(O.CONV_C2C).concat(h),G="peerAccount:".concat(h," count:").concat(I," time:").concat(v," direction:").concat(k),Y=(q.l("".concat(l," ").concat(G)),new it("getC2CRoamingMessagesHopping"));return this.req({proto:fe.GET_C2C_ROAMING_MSG,data:{peerAccount:h,count:I+1,lastMessageTime:v,direction:k}}).then(function(pe){var pe=pe.data,Ue=pe.complete,ve=pe.messageList,ve=ve===void 0?[]:ve,pe=pe.lastMessageTime,ye=(q.l("".concat(l," ok. complete:").concat(Ue," count:").concat(ve.length)),Y.setMessage("".concat(G," complete:").concat(Ue," length:").concat(ve.length)).end(),Ue!==1&&(k===1?ve.pop():ve.shift()),s.get(11)),ve=ye.onRoamingMessage(ve,P,!1),Ue=(s._modifyMessageList(P,ve),s._computeResult({complete:Ue,lastMessageTime:pe,resultList:ve}));return ye.storeHoppingMessageList(Ue.messageList),Ut(Ue)}).catch(function(te){return Y.setMessage(G).setError(te).end(),q.w("".concat(l," failed. error:"),te),Re(te)})}},{key:"_computeResult",value:function(h){var s=h.complete,s=s===void 0?0:s,l=h.lastMessageTime,h=h.resultList,h={messageList:L(h===void 0?[]:h),isCompleted:!1,nextMessageTime:""};return s===1?h.isCompleted=!0:h.nextMessageTime=l,h}},{key:"_modifyMessageList",value:function(n,s){if(n=this.get(11).getLocalConversation(n),n)for(var l=n.userProfile.nick,h=n.userProfile.avatar,n=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),v=n.nick,I=n.avatar,k=s.length-1;0<=k;k--){var P=s[k];P.flow==="in"&&(P.nick!==l&&P.setNickAndAvatar({nick:l}),P.avatar!==h&&P.setNickAndAvatar({avatar:h})),P.flow==="out"&&(P.nick!==v&&P.setNickAndAvatar({nick:v}),P.avatar!==I&&P.setNickAndAvatar({avatar:I}))}}},{key:"getRemotePeerReadTime",value:function(n){var s=this,l="".concat(this._n,".getRemotePeerReadTime");if(Ct(n))return q.w("".concat(l," userIDList is empty!")),Promise.resolve();var h=new it("getPeerReadTime");return q.l("".concat(l," userIDList:").concat(n)),this.req({proto:fe.GET_C2C_PEER_READ_TIME,data:{userIDList:n}}).then(function(v){var I=v.data.peerReadTimeList;q.l("".concat(l," ok. peerReadTimeList:").concat(I));for(var k="",P=s.get(11),G=0;G<n.length;G++)k+="".concat(n[G],"-").concat(I[G]," "),0<I[G]&&P.recordPeerReadTime("C2C".concat(n[G]),I[G]);h.setMessage(k).end()}).catch(function(v){h.setError(v).end(),q.w("".concat(l," failed. error:"),v)})}},{key:"sendReadReceipt",value:function(v){var s=v[0].conversationID.replace(O.CONV_C2C,""),l=new it("sendReadReceipt"),h=(l.setMessage("peerAccount:".concat(s)),this.getMyUserID()),v=v.filter(function(k){return k.from!==h&&k.needReadReceipt===!0}).map(function(k){return{fromAccount:k.from,toAccount:k.to,sequence:k.sequence,random:k.random,time:k.time,clientTime:k.clientTime}});if(v.length===0)return Re({code:Be.READ_RECEIPT_MSG_LIST_EMPTY});var I="".concat(this._n,".").concat("sendReadReceipt");return q.l("".concat(I,". peerAccount:").concat(s," length:").concat(v.length)),this.req({proto:fe.SEND_C2C_READ_RECEIPT,data:{peerAccount:s,messageInfoList:v}}).then(function(k){return l.end(),q.l("".concat(I," ok")),Ut()}).catch(function(k){return l.setError(k).end(),q.w("".concat(I," failed. error:"),k),Re(k)})}},{key:"getReadReceiptList",value:function(h){var s="".concat(this._n,".getReadReceiptList"),l=this.getMyUserID(),h=h.filter(function(v){return v.from===l&&v.needReadReceipt===!0});return q.l("".concat(s," userID:").concat(l," messageList length:").concat(h.length)),ln({messageList:h})}},{key:"getMessageExtensions",value:function(n,s){return q.l("".concat(this._n,".getMessageExtensions startSequence:").concat(s)),this.req({proto:fe.GET_C2C_MSG_EXT,data:{from:n.from,to:n.to,messageKey:this.getMessageKey(n),startSequence:s}})}},{key:"modifyMessageExtensions",value:function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return q.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(l)),this.req({proto:fe.MODIFY_C2C_MSG_EXT,data:{from:n.from,to:n.to,messageKey:this.getMessageKey(n),extensionList:s,operateType:l}})}},{key:"getMessageKey",value:function(h){var s=h.clientSequence,l=h.random,h=h.time;return"".concat(s,"_").concat(l,"_").concat(h)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._messageFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]);var vp,Qd=Pl,A1=(p(bv,[{key:"getLocalOldestMessageByConversationID",value:function(n){return!n||!this.list.has(n)?null:(n=this.list.get(n).values(),n?n.next().value:null)}},{key:"pushIn",value:function(n){var s=1<arguments.length&&arguments[1]!==void 0&&arguments[1],l=n.conversationID,h=!0,v=(this.list.has(l)||this.list.set(l,new Map),this._getUniqueIDOfMessage(n));if(this.list.get(l).has(v)){var I=this.list.get(l).get(v);if(!s||I.isModified===!0)return!1}return this.list.get(l).set(v,n),this._setLatestMessageSentByPeer(l,n),this._setLatestMessageSentByMe(l,n),h}},{key:"unshift",value:function(n,s){var l;if(Rt(n)?0<n.length&&(l=n[0].conversationID,this._unshiftMultipleMessages(n,s)):(l=n.conversationID,this._unshiftSingleMessage(n,s)),l){var h=Array.from(this.list.get(l).values()),n=h.length;if(n!==0){for(var v=n-1;0<=v;v--)if(h[v].flow==="out"){this._setLatestMessageSentByMe(l,h[v]);break}if(l.startsWith(O.CONV_C2C)){for(var I=n-1;0<=I;I--)if(h[I].flow==="in"){this._setLatestMessageSentByPeer(l,h[I]);break}}}}}},{key:"_unshiftSingleMessage",value:function(n,s){var l=n.conversationID,h=this._getUniqueIDOfMessage(n);if(!this.list.has(l))return this.list.set(l,new Map),this.list.get(l).set(h,n),void s.push(n);var v=this.list.get(l),I=Array.from(v);v.has(h)||(I.unshift([h,n]),this.list.set(l,new Map(I)),s.push(n))}},{key:"_unshiftMultipleMessages",value:function(n,s){for(var l=n.length,h=[],v=n[0].conversationID,I=this.list.get(v),k=this.list.has(v)?Array.from(I):[],P=0;P<l;P++){var G=this._getUniqueIDOfMessage(n[P]);I&&I.has(G)||(h.push([G,n[P]]),s.push(n[P]))}this.list.set(v,new Map(h.concat(k)))}},{key:"remove",value:function(l){var s=l.conversationID,l=this._getUniqueIDOfMessage(l);this.list.has(s)&&this.list.get(s).delete(l)}},{key:"revoke",value:function(n,s,l){var h;return q.d("revoke message",n,s,l),this.list.has(n)?(h=this.list.get(n),this._updateMessageIsRevoked(h,s,l)):this._hoppingMessageMap.has(n)?(h=this._hoppingMessageMap.get(n),this._updateMessageIsRevoked(h,s,l)):null}},{key:"_updateMessageIsRevoked",value:function(n,s,l){var h,v=Z(n);try{for(v.s();!(h=v.n()).done;){var I=x(h.value,2)[1];if(I.sequence===s&&(Qe(l)||I.random===l))return I.isRevoked||(I.isRevoked=!0),I}}catch(k){v.e(k)}finally{v.f()}}},{key:"removeByConversationID",value:function(n){var s=this.list.has(n);q.l("".concat(this._n,".removeByConversationID conversationID:").concat(n," has:").concat(s)),s&&(this.list.delete(n),this._latestMessageSentByPeerMap.delete(n),this._latestMessageSentByMeMap.delete(n))}},{key:"findMessage",value:function(n){var s=null;return s=(s=this._findMessage(n,this.list))?s:this._findMessage(n,this._hoppingMessageMap)}},{key:"_findMessage",value:function(n,s){var l,h=null,v=Z(s);try{for(v.s();!(l=v.n()).done;)for(var I=L(x(l.value,2)[1].values()),k=I.length,P=0;P<k;P++)if(I[P].ID===n){h=I[P];break}}catch(G){v.e(G)}finally{v.f()}return h}},{key:"updateMessageIsPeerReadProperty",value:function(n,s){var l,h=[];return this.list.has(n)?(l=this.list.get(n),h=this._updateMessageIsPeerReadProperty(l,s)):this._hoppingMessageMap.has(n)&&(l=this._hoppingMessageMap.get(n),h=this._updateMessageIsPeerReadProperty(l,s)),q.l("".concat(this._n,".updateMessageIsPeerReadProperty conversationID:").concat(n," peerReadTime:").concat(s," count:").concat(h.length)),h}},{key:"_updateMessageIsPeerReadProperty",value:function(n,s){var l,h=[],v=Z(n);try{for(v.s();!(l=v.n()).done;){var I=x(l.value,2)[1];I.time<=s&&!I.isPeerRead&&I.flow==="out"&&(I.isPeerRead=!0,h.push(I))}}catch(k){v.e(k)}finally{v.f()}return h}},{key:"updateMessageIsModifiedProperty",value:function(n){var s=n.conversationID;this.list.has(s)&&(n=this._getUniqueIDOfMessage(n),(s=this.list.get(s).get(n))&&(s.isModified=!0))}},{key:"hasLocalMessageList",value:function(n){return this.list.has(n)}},{key:"getLocalMessageList",value:function(n){return this.hasLocalMessageList(n)?L(this.list.get(n).values()):[]}},{key:"getLocalMaxSequence",value:function(n){return this.hasLocalMessageList(n)?(n=L(this.list.get(n).values()).map(function(s){return s.sequence}),Math.max.apply(Math,L(n))):0}},{key:"getLocalMaxTime",value:function(n){return this.hasLocalMessageList(n)?(n=L(this.list.get(n).values()).map(function(s){return s.time}),Math.max.apply(Math,L(n))):0}},{key:"hasLocalMessage",value:function(n,s){for(var l=!1,h=this.getLocalMessageList(n),v=h.length,I=0;I<v;I++)h[I].ID===s&&(l=!0);return l}},{key:"getLocalMessage",value:function(n,s){for(var l=null,h=this.getLocalMessageList(n),v=h.length,I=0;I<v;I++)if(h[I].ID===s){l=h[I];break}return l}},{key:"getLocalLastMessage",value:function(n){return n=this.getLocalMessageList(n),n[n.length-1]}},{key:"getLocalSecondLastMessage",value:function(n){return n=this.getLocalMessageList(n),n[n.length-2]}},{key:"getLocalOldestMessage",value:function(n){return this.getLocalMessageList(n)[0]}},{key:"_setLatestMessageSentByPeer",value:function(n,s){n.startsWith(O.CONV_C2C)&&s.flow==="in"&&this._latestMessageSentByPeerMap.set(n,s)}},{key:"_setLatestMessageSentByMe",value:function(n,s){s.flow==="out"&&this._latestMessageSentByMeMap.set(n,s)}},{key:"getLatestMessageSentByPeer",value:function(n){return this._latestMessageSentByPeerMap.get(n)}},{key:"getLatestMessageSentByMe",value:function(n){return this._latestMessageSentByMeMap.get(n)}},{key:"modifyMessageSentByPeer",value:function(v){var s=v.conversationID,l=v.latestNick,h=v.latestAvatar,v=this.list.get(s);if(!Ct(v)){var I=Array.from(v.values()),v=I.length;if(v!==0){for(var k=null,P=0,G=!1,Y=v-1;0<=Y;Y--)I[Y].flow==="in"&&((k=I[Y]).nick!==l&&(k.setNickAndAvatar({nick:l}),G=!0),k.avatar!==h&&(k.setNickAndAvatar({avatar:h}),G=!0),G&&(P+=1));q.l("".concat(this._n,".modifyMessageSentByPeer conversationID:").concat(s," count:").concat(P))}}}},{key:"modifyMessageSentByMe",value:function(v){var s=v.conversationID,l=v.latestNick,h=v.latestAvatar,v=this.list.get(s);if(!Ct(v)){var I=Array.from(v.values()),v=I.length;if(v!==0){for(var k=null,P=0,G=!1,Y=v-1;0<=Y;Y--)I[Y].flow==="out"&&((k=I[Y]).nick!==l&&(k.setNickAndAvatar({nick:l}),G=!0),k.avatar!==h&&(k.setNickAndAvatar({avatar:h}),G=!0),G&&(P+=1));q.l("".concat(this._n,".modifyMessageSentByMe conversationID:").concat(s," count:").concat(P))}}}},{key:"getTopicConversationIDList",value:function(n){return L(this.list.keys()).filter(function(s){return s.startsWith("".concat(O.CONV_GROUP).concat(n))})}},{key:"traversal",value:function(){if(this.list.size!==0&&q.getLevel()===-1){console.group("conversationID-messageCount");var n,s=Z(this.list);try{for(s.s();!(n=s.n()).done;){var l=x(n.value,2),h=l[0],v=l[1];console.log("".concat(h,"-").concat(v.size))}}catch(I){s.e(I)}finally{s.f()}console.groupEnd()}}},{key:"onMessageModified",value:function(n,s){if(!this.list.has(n)&&!this._hoppingMessageMap.has(n))return{isUpdated:!1,message:null};var l="".concat(this._n,".onMessageModified"),h=this._getUniqueIDOfMessage(s),v=this._getTargetMessage(n,h),I=!!v;return q.l("".concat(l," conversationID:").concat(n," uniqueID:").concat(h," has:").concat(I)),I?(n=s.messageVersion,h=s.elements,I=s.cloudCustomData,s=s.checkResult,q.l("".concat(l," localVersion:").concat(v.version," remoteVersion:").concat(n)),v.version<n?(v.version=n,v._elements=JSON.parse(JSON.stringify(h)),v.payload=JSON.parse(JSON.stringify(h[0].content)),v.type=h[0].type,v.cloudCustomData=I,v.isModified=!0,v.hasRiskContent=Ba(s),{isUpdated:!0,message:v}):{isUpdated:!1,message:v}):{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMessage",value:function(I){var s=I.from,l=I.to,h=I.random,v=I.sequence,I=I.time;return"".concat(s,"-").concat(l,"-").concat(h,"-").concat(v,"-").concat(I)}},{key:"_getTargetMessage",value:function(n,s){if(this.list.has(n))return this.list.get(n).get(s);var l=void 0;if(this._hoppingMessageMap.has(n)){for(var h=L(this._hoppingMessageMap.get(n).values()),v=0;v<h.length;v++)if(this._getUniqueIDOfMessage(h[v])===s){l=h[v];break}}return l}},{key:"storeHoppingMessageList",value:function(n){if(n.length!==0){var s=n[0].conversationID,l=n.length;this._hoppingMessageMap.has(s)||this._hoppingMessageMap.set(s,new Map);for(var h=this._hoppingMessageMap.get(s),v=0;v<l;v++){var I=n[v];h.has(I.ID)||h.set(I.ID,I)}}}},{key:"getHoppingMessage",value:function(n,s){if(this._hoppingMessageMap.has(n))return this._hoppingMessageMap.get(n).get(s)}},{key:"reset",value:function(){this.list.clear(),this._latestMessageSentByPeerMap.clear(),this._latestMessageSentByMeMap.clear(),this._hoppingMessageMap.clear()}}]),bv),So={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG_UPDATED:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)};function bv(){u(this,bv),this.list=new Map,this._n="MessageListHandler",this._latestMessageSentByPeerMap=new Map,this._latestMessageSentByMeMap=new Map,this._hoppingMessageMap=new Map}function Pl(n){return u(this,Pl),(n=vp.call(this,n))._n="C2CModule",n._messageFromUnreadDBMap=new Map,n._noticeFromUnreadDBList=[],n}function Zd(n){this.mixin(n)}Zd.mixin=function(n){n=n.prototype||n,n._isReady=!1,n.ready=function(s){if(s)return this._isReady?void(1<arguments.length&&arguments[1]!==void 0&&arguments[1]?s.call(this):setTimeout(s,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(s))},n.triggerReady=function(){var s=this;this._isReady=!0,setTimeout(function(){var l=s._readyQueue;s._readyQueue=[],l&&0<l.length&&l.forEach(function(h){h.call(this)},s)},1)},n.resetReady=function(){this._isReady=!1,this._readyQueue=[]},n.isReady=function(){return this._isReady}};function GI(n,s,l){return Qe(n)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:l&&n.ID||n instanceof er?{lastTime:n.time||0,lastSequence:n.sequence||0,fromAccount:n.from||"",messageForShow:Fd(n.type,n.payload,s),payload:n.payload||null,type:n.type||null,isRevoked:n.isRevoked||!1,cloudCustomData:n.cloudCustomData||"",onlineOnlyFlag:n._onlineOnlyFlag||!1,nick:n.nick||"",nameCard:n.nameCard||"",version:n.version||0,isPeerRead:n.isPeerRead||!1,revoker:n.revoker||null}:i(i({},n),{},{messageForShow:Fd(n.type,n.payload,s)})}function BI(n,s){return Ct(n)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:n.time||0,lastSequence:n.sequence||0,fromAccount:n.from||"",payload:n.payload||null,type:n.type||"",messageForShow:Fd(n.type,n.payload,s),nick:n.nick||"",avatar:n.avatar||"",version:n.version||0,cloudCustomData:n.cloudCustomData||"",isRevoked:n.isRevoked||!1,revoker:n.revoker||null}}function Ul(n){var s=String(n).replace(/[=]+$/,""),l="";if(s.length%4==1)return"";for(var h,v,I=0,k=0;v=s.charAt(k++);~v&&(h=I%4?64*h+v:v,I++%4)&&(l+=String.fromCharCode(255&h>>(-2*I&6))))v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(v);try{return decodeURIComponent(escape(l))}catch{return""}}var _p,$I,HI,qI,KI,zI=["jpg","jpeg","gif","png","bmp","image","webp"],yp=["mp4","quicktime","mov"],eh=(p(Fv,[{key:"validate",value:function(n){var s,l=!0,h="";if(Ct(n))return{valid:!1,tips:"empty options"};if(n.profileCustomField)for(var v=n.profileCustomField.length,I=null,k=0;k<v;k++){if(I=n.profileCustomField[k],!Sn(I.key)||I.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!Sn(I.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(s in n)if(Object.prototype.hasOwnProperty.call(n,s)){if(s==="profileCustomField")continue;if(Ct(n[s])&&!Sn(n[s])&&!un(n[s])){h="key:"+s+", invalid value:"+n[s],l=!1;continue}switch(s){case"nick":Sn(n[s])||(l=!(h="nick must be a string")),500<an(n[s])&&(h="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(an(n[s])," bytes"),l=!1);break;case"gender":Er(ls,n.gender)||(h="key:gender, invalid value:"+n.gender,l=!1);break;case"birthday":un(n.birthday)||(l=!(h="birthday must be a number"));break;case"location":Sn(n.location)||(l=!(h="location must be a string"));break;case"selfSignature":Sn(n.selfSignature)||(l=!(h="selfSignature must be a string"));break;case"allowType":Er(ks,n.allowType)||(h="key:allowType, invalid value:"+n.allowType,l=!1);break;case"language":un(n.language)||(l=!(h="language must be a number"));break;case"avatar":Sn(n.avatar)||(l=!(h="avatar must be a string"));break;case"messageSettings":n.messageSettings!==0&&n.messageSettings!==1&&(l=!(h="messageSettings must be 0 or 1"));break;case"adminForbidType":Er(Ir,n.adminForbidType)||(h="key:adminForbidType, invalid value:"+n.adminForbidType,l=!1);break;case"level":un(n.level)||(l=!(h="level must be a number"));break;case"role":un(n.role)||(l=!(h="role must be a number"));break;default:h="unknown key:"+s+"  "+n[s],l=!1}}return{valid:l,tips:h}}}]),Fv),R1=p(function n(s){u(this,n),this.value=s,this.next=null}),Cv=(p(xv,[{key:"set",value:function(n){var s,l=new R1(n);this.map.size<this.MAX_LENGTH?this.pTail===null?(this.pTail=l,this.pNodeToDel=l):(this.pTail.next=l,this.pTail=l):(s=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,this.map.delete(s.value),s.next=null,s=null,this.pTail.next=l,this.pTail=l),this.map.set(n,1)}},{key:"has",value:function(n){return this.map.has(n)}},{key:"delete",value:function(n){this.has(n)&&this.map.delete(n)}},{key:"tail",value:function(){return this.pTail}},{key:"size",value:function(){return this.map.size}},{key:"data",value:function(){return Array.from(this.map.keys())}},{key:"reset",value:function(){for(var n;this.pNodeToDel!==null;)n=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,n.next=null,n=null;this.pTail=null,this.map.clear()}}]),xv),w1=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],fa=(p(Uv,[{key:"memberNum",get:function(){return this.memberCount},set:function(n){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(n){}},{key:"_initGroup",value:function(n){for(var s in n)w1.indexOf(s)<0||(s!=="selfInfo"?(s==="memberNum"&&(this.memberCount=n[s]),s==="maxMemberNum"&&(this.maxMemberCount=n[s]),s!=="isSupportTopic"?this[s]=n[s]:this.isSupportTopic=n[s]===1):this.updateSelfInfo(n[s]))}},{key:"updateGroup",value:function(l){var s=this,l=(l.appid=void 0,l.grossTopicNextMsgSeq=void 0,l.selfInfo&&(l.selfInfo.grossTopicReadSeq=void 0),JSON.parse(JSON.stringify(l)));l.lastMsgTime&&(this.lastMessage.lastTime=l.lastMsgTime),Qe(l.muteAllMembers)||(l.muteAllMembers==="On"?l.muteAllMembers=!0:l.muteAllMembers=!1),l.groupCustomField&&Nd(this.groupCustomField,l.groupCustomField),Qe(l.memberNum)||(this.memberCount=l.memberNum),Qe(l.maxMemberNum)||(this.maxMemberCount=l.maxMemberNum),Qe(l.isSupportTopic)||(this.isSupportTopic=un(l.isSupportTopic)?l.isSupportTopic===1:l.isSupportTopic),ni(this,l,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),Rt(l.members)&&0<l.members.length&&l.members.forEach(function(h){h.userID===s.selfInfo.userID&&ni(s.selfInfo,h,["sequence"])})}},{key:"updateSelfInfo",value:function(n){n={nameCard:n.nameCard,joinTime:n.joinTime,role:n.role,messageRemindType:n.messageRemindType,readedSequence:n.readedSequence,excludedUnreadSequenceList:n.excludedUnreadSequenceList},ni(this.selfInfo,i({},n),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(n){this.selfInfo.nameCard=n}}]),Uv),Ip=(p(jc,[{key:"toAccount",get:function(){return this.conversationID.startsWith(O.CONV_C2C)?this.conversationID.replace(O.CONV_C2C,""):this.conversationID.startsWith(O.CONV_GROUP)?this.conversationID.replace(O.CONV_GROUP,""):""}},{key:"_initProfile",value:function(n){var s=this;Object.keys(n).forEach(function(l){switch(l){case"userProfile":s.userProfile=n.userProfile;break;case"groupProfile":s.groupProfile=n.groupProfile}}),Qe(this.userProfile)&&this.type===O.CONV_C2C?this.userProfile=new eh({userID:n.conversationID.replace("C2C","")}):Qe(this.groupProfile)&&this.type===O.CONV_GROUP&&(this.groupProfile=new fa({groupID:n.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(h){var s=h.nextUnreadCount,l=h.isFromGetConversations,h=h.isUnreadC2CMessage;Qe(s)||(Mr(this.subType)?this.unreadCount=0:l&&this.type===O.CONV_GROUP||l&&this.type===O.CONV_TOPIC||h&&this.type===O.CONV_C2C?this.unreadCount=s:this.unreadCount=this.unreadCount+s)}},{key:"updateLastMessage",value:function(n){this.lastMessage=GI(n)}},{key:"updateGroupAtInfoList",value:function(n){var s;this._isNeedMergeGroupAtInfo(n)||((s=(F(s=n.groupAtType)||H(s)||B(s)||W()).slice(0)).indexOf(O.CONV_AT_ME)!==-1&&s.indexOf(O.CONV_AT_ALL)!==-1&&(s=[O.CONV_AT_ALL_AT_ME]),s={from:n.from,groupID:n.groupID,topicID:n.topicID,messageSequence:n.sequence,atTypeArray:s,__random:n.__random,__sequence:n.__sequence},this.groupAtInfoList.push(s))}},{key:"_isNeedMergeGroupAtInfo",value:function(n){var s=n.groupID,l=n.sequence;if(!Dr({groupID:s}))return!1;var h=!1;return this.groupAtInfoList.forEach(function(v){v.messageSequence===l&&(-1<v.atTypeArray.indexOf(O.CONV_AT_ME)&&-1<n.groupAtType.indexOf(O.CONV_AT_ALL)&&(v.atTypeArray=[O.CONV_AT_ALL_AT_ME]),-1<v.atTypeArray.indexOf(O.CONV_AT_ALL)&&-1<n.groupAtType.indexOf(O.CONV_AT_ME)&&(v.atTypeArray=[O.CONV_AT_ALL_AT_ME],v.__random=n.__random,v.__sequence=n.__sequence),h=!0)}),h}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(l){var s=l.sequence,l=l.time;return this.type===O.CONV_C2C&&s===this.lastMessage.lastSequence&&l===this.lastMessage.lastTime||this.type===O.CONV_GROUP&&s===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(n){this.lastMessage.isRevoked=n}},{key:"setLastMessageRevoker",value:function(n){this.lastMessage.revoker=n}},{key:"setDraftText",value:function(n){this.draftText=n}}]),jc),WI=(m(Bn={},O.MSG_REMIND_ACPT_AND_NOTE,0),m(Bn,O.MSG_REMIND_DISCARD,1),m(Bn,O.MSG_REMIND_ACPT_NOT_NOTE,2),Bn),D1=(p(Pv,[{key:"onAllReceiveMessageOptNotify",value:function(n){n=this._handleResult(n),this._convM.emitOuterEvent($.ALL_RECEIVE_MESSAGE_OPT_UPDATED,n)}},{key:"getC2CMessageRemindType",value:function(n){var s=this,l="".concat(this._n,".getC2CMessageRemindType");return this._convM.req({proto:fe.GET_C2C_PEER_MUTE_NOTIFICATIONS,data:{toAccount:this._convM.getMyUserID(),userIDList:n}}).then(function(h){q.l("".concat(l," ok. userIDList:").concat(n)),h=h.data.muteFlagList,s._convM.onC2CMessageRemindTypeFetched(h)}).catch(function(h){q.e("".concat(l," failed. error:"),h)})}},{key:"set",value:function(n){return n.groupID?this._setGroupMessageRemindType(n):Rt(n.userIDList)?this._setC2CMessageRemindType(n):void 0}},{key:"_setGroupMessageRemindType",value:function(n){var s=this,l="".concat(this._n,"._setGroupMessageRemindType"),h=n.groupID,v=n.messageRemindType,I="groupID:".concat(h," messageRemindType:").concat(v),k=new it("setMessageRemindType"),P=(k.setMessage(I),this._get(7));return P?P.modifyGroupMemberInfo({groupID:h,messageRemindType:v,userID:this._convM.getMyUserID()}).then(function(){k.end(),q.l("".concat(l," ok. ").concat(I));var G=s.onGroupMessageRemindTypeUpdated(n);return s._convM.emitTotalUnreadMessageCountUpdate(),Ut(G)}).catch(function(G){return k.setError(G).end(),q.e("".concat(l," failed. error:"),G),Re(G)}):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"onGroupMessageRemindTypeUpdated",value:function(v){var s,l,h=v.groupID,v=v.messageRemindType,I=(q.l("".concat(this._n,".onGroupMessageRemindTypeUpdated groupID:").concat(h," messageRemindType:").concat(v)),this._get(7).getLocalGroupProfile(h));return I&&(I.selfInfo.messageRemindType=v),Qo(h)?(s=Zo(l=h),(l=this._get(10).getLocalTopic(s,l))&&(l.updateSelfInfo({messageRemindType:v}),this._convM.emitOuterEvent($.TOPIC_UPDATED,{groupID:s,topic:l})),{topic:l}):(this._convM.patchMessageRemindType({ID:h,isC2CConversation:!1,messageRemindType:v})&&this._emitConversationUpdate(),{group:I})}},{key:"_setC2CMessageRemindType",value:function(k){var s=this,l="".concat(this._n,"._setC2CMessageRemindType"),h=k.userIDList,v=k.messageRemindType,I=h.slice(0,30),k=WI[v]||0,P="userIDList:".concat(I," messageRemindType:").concat(v),G=new it("setMessageRemindType");return G.setMessage(P),this._convM.req({proto:fe.SET_C2C_PEER_MUTE_NOTIFICATIONS,data:{userIDList:I,muteFlag:k}}).then(function(ye){G.end();var ye=ye.data.errorList,te=[],pe=[],ye=(Rt(ye)&&ye.forEach(function(Ue){te.push(Ue.userID),pe.push({userID:Ue.userID,code:Ue.errorCode})}),I.filter(function(Ue){return te.indexOf(Ue)===-1})),ve=(q.l("".concat(l," ok. ").concat(P," successUserIDList:").concat(ye," failureUserIDList:").concat(JSON.stringify(pe))),0);return ye.forEach(function(Ue){s._convM.patchMessageRemindType({ID:Ue,isC2CConversation:!0,messageRemindType:v})&&(ve+=1)}),1<=ve&&s._emitConversationUpdate(),I.length=te.length=0,s._convM.emitTotalUnreadMessageCountUpdate(),ln({successUserIDList:ye.map(function(Ue){return{userID:Ue}}),failureUserIDList:pe})}).catch(function(Y){return G.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"_get",value:function(n){return this._convM.get(n)}},{key:"_emitConversationUpdate",value:function(){this._convM.emitConversationUpdate(!0,!1)}},{key:"setAllReceiveMessageOpt",value:function(k){var s="".concat(this._n,".").concat("setAllReceiveMessageOpt"),l=k.messageRemindType,l=l===void 0?O.MSG_REMIND_ACPT_NOT_NOTE:l,h=k.isRepeated,h=h===void 0||h,I=this._calcStartAndEndTime(k),v=I.startTime,v=v===void 0?0:v,I=I.endTime,I=I===void 0?0:I,k=JSON.stringify(k),P=new it("setAllReceiveMessageOpt");return P.setMessage(k),q.l("".concat(s," options:").concat(k)),this._convM.req({proto:fe.SET_ALL_RECEIVE_MSG_OPT,data:{messageRemindType:WI[l],startTime:v,endTime:I,isRepeated:h?1:0}}).then(function(G){return P.end(),q.l("".concat(s," ok.")),Ut(G)}).catch(function(G){return P.setError(G).end(),q.e("".concat(s," failed. error:"),G),Re(G)})}},{key:"_calcStartAndEndTime",value:function(I){var s=I.startHour,s=s===void 0?0:s,l=I.startMinute,l=l===void 0?0:l,h=I.startSecond,h=h===void 0?0:h,v=I.duration,v=v===void 0?0:v,I=I.isRepeated,I=I===void 0||I,P=new Date,G=P.getFullYear(),k=P.getMonth(),P=P.getDate(),G=Math.round(new Date(G,k,P,s,l,h).getTime()/1e3);return{startTime:G,endTime:I&&86400<=v?G+86400:G+v}}},{key:"getAllReceiveMessageOpt",value:function(){var n=this,s="".concat(this._n,".").concat("getAllReceiveMessageOpt"),l=new it("getAllReceiveMessageOpt");return this._convM.req({proto:fe.GET_ALL_RECEIVE_MSG_OPT,data:{toAccount:this._convM.getMyUserID()}}).then(function(h){return h=h.data,l.setMessage(JSON.stringify(h)).end(),q.l("".concat(s," ok. data:").concat(JSON.stringify(h))),h=n._handleResult(h),Ut(h)}).catch(function(h){return l.setError(h).end(),q.e("".concat(s," failed. error:"),h),Re(h)})}},{key:"_handleResult",value:function(v){var s=v.messageRemindType,l=v.startTime,h=v.endTime,v=v.isRepeated,I=O.MSG_REMIND_ACPT_AND_NOTE;return s===1&&(I=O.MSG_REMIND_DISCARD),{messageRemindType:I=s===2?O.MSG_REMIND_ACPT_NOT_NOTE:I,startTime:l,endTime:h,isRepeated:v===1}}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),Pv),O1=(p(ch,[{key:"setConvCustomData",value:function(n){var s=this,l="".concat(this._n,".").concat("setConvCustomData"),h=n.conversationIDList,v=n.customData,I=(q.l("".concat(l," options:"),n),new it("setConvCustomData")),k=(I.setMessage(JSON.stringify(n)),{fromAccount:this._getMyUserID(),itemList:[]}),P=[],G=[];return h.forEach(function(Y){if(!s._hasLocalConversation(Y))return s._onConversationNotFound(G,Y),!0;if(!Pr(Y)&&!fr(Y))return s._onConversationIDInvalid(G,Y),!0;var te={operationType:2,contactItem:void 0,customMark:v};Pr(Y)?te.contactItem={type:1,toAccount:Y.replace(O.CONV_C2C,"")}:fr(Y)&&(te.contactItem={type:2,groupID:Y.replace(O.CONV_GROUP,"")}),k.itemList.push(te)}),G.length===h.length?ln({successConversationIDList:P,failureConversationIDList:G}):this._convM.req({proto:fe.SET_CONV_CUSTOM_DATA,data:k}).then(function(ve){I.end(),q.l("".concat(l," ok"));var te,pe,ye,ve=ve.data.resultItem;return Rt(ve)&&(ye=!1,ve.forEach(function(Ue){te=s._concatConversationID(Ue.contactItem),Ue.resultCode===0?(P.push(te),(pe=s._getLocalConversation(te))&&pe.customData!==v&&(pe.customData=v,ye=!0)):G.push({conversationID:te,code:Ue.resultCode,message:Ue.resultInfo})}),ye===!0&&s._emitConversationUpdate()),Ut({successConversationIDList:P,failureConversationIDList:G})}).catch(function(Y){return I.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"markConversation",value:function(Y){var s=this;if(!this._convM.canIUse(ue.CONV_MARK))return this._convM.cannotUseCommercialAbility("markConversation");var l="".concat(this._n,".").concat("markConversation"),h=Y.conversationIDList,v=Y.markType,I=Y.enableMark,k=(q.l("".concat(l," options:"),Y),new it("markConversation")),P=(k.setMessage(JSON.stringify(Y)),void 0),G=void 0,Y=this._getFlagBit(v),te=(I===!0?G=[Y]:P=[Y],{fromAccount:this._getMyUserID(),itemList:[]}),pe=[],ye=[];return h.forEach(function(ve){if(!s._hasLocalConversation(ve))return s._onConversationNotFound(ye,ve),!0;if(!Pr(ve)&&!fr(ve))return s._onConversationIDInvalid(ye,ve),!0;var Ue={operationType:1,contactItem:void 0,clearMark:P,setMark:G};Pr(ve)?Ue.contactItem={type:1,toAccount:ve.replace(O.CONV_C2C,"")}:fr(ve)&&(Ue.contactItem={type:2,groupID:ve.replace(O.CONV_GROUP,"")}),te.itemList.push(Ue)}),ye.length===h.length?ln({successConversationIDList:pe,failureConversationIDList:ye}):this._convM.req({proto:fe.MARK_CONV,data:te}).then(function(Kt){k.end(),q.l("".concat(l," ok"));var Ue,ut,mt,Kt=Kt.data.resultItem;return Rt(Kt)&&(mt=!1,Kt.forEach(function(en){var Un;Ue=s._concatConversationID(en.contactItem),en.resultCode===0?(pe.push(Ue),(ut=s._getLocalConversation(Ue))&&(Un=ut.markList.indexOf(v),I===!0?Un===-1&&(ut.markList.push(v),mt=!0):Un!==-1&&(ut.markList.splice(Un,1),mt=!0))):ye.push({conversationID:Ue,code:en.resultCode,message:en.resultInfo})}),mt===!0&&s._emitConversationUpdate()),Ut({successConversationIDList:pe,failureConversationIDList:ye})}).catch(function(ve){return k.setError(ve).end(),q.e("".concat(l," failed. error:"),ve),Re(ve)})}},{key:"getLocalConvGroupList",value:function(){var n=this;return q.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===$c?this.getRemoteConvGroupList().then(function(){return Ut(L(n._convGroupMap.values()))}):ln(L(this._convGroupMap.values()))}},{key:"searchConvGroupAndMark",value:function(n,s){var l=this,h="".concat(this._n,".searchConvGroupAndMark"),v=[];return n.forEach(function(I){s===1?v.push({type:1,toAccount:I}):s===2&&v.push({type:2,groupID:I})}),q.l("".concat(h," type:").concat(s," list:"),n),this._convM.req({proto:fe.SEARCH_CONV_GRP_MARK,data:{fromAccount:this._getMyUserID(),contactItem:v}}).then(function(P){var P=P.data,k=P.contactItem,P=P.groupItem;q.l("".concat(h," ok. contactItem:"),k,"groupItem:",P),l._fillConvGroupMap(P),l._handleContactItem(k),l._emitConversationUpdate()}).catch(function(I){q.w("".concat(h," failed. error:"),I)})}},{key:"_fillConvGroupMap",value:function(n){var s=this;Rt(n)&&n.forEach(function(v){var h=v.convGroupID,v=v.groupName;s._convGroupMap.set(h,v)})}},{key:"_handleContactItem",value:function(n){var s,l=this;Rt(n)&&n.forEach(function(h){var v=[],I=h.standardMark,k=h.customData,P=h.convGroupIDList;Rt(P)&&P.forEach(function(G){l._convGroupMap.has(G)&&v.push(l._convGroupMap.get(G))}),s=l._concatConversationID(h),(s=l._getLocalConversation(s))&&(s.markList=cs(I),s.customData=k||"",s.conversationGroupList=[].concat(v))})}},{key:"getRemoteConvGroupList",value:function(){var n=this,s="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=UI,this._convM.req({proto:fe.GET_CONV_GRP_LIST,data:{fromAccount:this._getMyUserID(),startIndex:this._startIndex}}).then(function(k){var k=k.data,h=k.completeFlag,v=k.contactItem,I=k.nextStartIndex,I=I===void 0?0:I,k=k.groupItem;if(n._startIndex=I,q.l("".concat(s," completeFlag:").concat(h," nextStartIndex:").concat(I,", groupItem:"),k,"contactItem:",v),n._fillConvGroupMap(k),n._handleContactItem(v),h===0)return n.getRemoteConvGroupList();h===1&&(n._pagingStatus=Hd,n._emitConversationUpdate(),n._emitConvGroupListUpdate())}).catch(function(l){n._pagingStatus=$c,q.w("".concat(s," failed. error:"),l)})}},{key:"createConvGroup",value:function(n){var s=this,I="createConversationGroup";if(!this._convM.canIUse(ue.CONV_GROUP))return this._convM.cannotUseCommercialAbility(I);var l="".concat(this._n,".").concat(I),h=(q.l("".concat(l," options:"),n),new it(I)),v=(h.setMessage(JSON.stringify(n)),n.groupName),I=n.conversationIDList,k={fromAccount:this._getMyUserID(),itemList:[{groupName:v,contactItem:[]}]},P=[],G=[];return I.forEach(function(Y){return s._hasLocalConversation(Y)?Pr(Y)||fr(Y)?void(Pr(Y)?k.itemList[0].contactItem.push({type:1,toAccount:Y.replace(O.CONV_C2C,"")}):fr(Y)&&k.itemList[0].contactItem.push({type:2,groupID:Y.replace(O.CONV_GROUP,"")})):(s._onConversationIDInvalid(G,Y),!0):(s._onConversationNotFound(G,Y),!0)}),G.length===I.length?ln({successConversationIDList:P,failureConversationIDList:G}):this._convM.req({proto:fe.CREATE_CONV_GRP,data:k}).then(function(Ue){h.end(),q.l("".concat(l," ok"));var te,pe,ye,Ue=Ue.data.groupResultItem[0],ve=Ue.groupItem,Ue=Ue.resultItem;return xn(ve)&&(s._convGroupMap.set(ve.convGroupID,ve.groupName),s._emitConvGroupListUpdate()),Rt(Ue)&&(ye=!1,Ue.forEach(function(ut){te=s._concatConversationID(ut.contactItem),ut.resultCode===0?(P.push(te),(pe=s._getLocalConversation(te))&&pe.conversationGroupList.indexOf(v)===-1&&(pe.conversationGroupList.push(v),ye=!0)):G.push({conversationID:te,code:ut.resultCode,message:ut.resultInfo})}),ye===!0&&(s._emitConversationUpdate(),s._emitConvGroupListUpdate())),Ut({successConversationIDList:P,failureConversationIDList:G})}).catch(function(Y){return h.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"deleteConvGroup",value:function(n){var s=this,l="deleteConversationGroup";if(!this._convM.canIUse(ue.CONV_GROUP))return this._convM.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=(q.l("".concat(h," groupName:").concat(n)),new it(l));return v.setMessage(n),this._convM.req({proto:fe.DEL_CONV_GRP,data:{fromAccount:this._getMyUserID(),groupName:[n]}}).then(function(P){v.end(),q.l("".concat(h," ok"));var k,P=P.data.groupItem;Rt(P)&&(k=!1,P.forEach(function(G){s._convGroupMap.has(G.convGroupID)&&(s._convGroupMap.delete(G.convGroupID),k=!0)}),k===!0&&s._emitConvGroupListUpdate()),s._eraseFromConversationGroupList([n])}).catch(function(I){return v.setError(I).end(),q.e("".concat(h," failed. error:"),I),Re(I)})}},{key:"renameConvGroup",value:function(n){var s=this,l="renameConversationGroup";if(!this._convM.canIUse(ue.CONV_GROUP))return this._convM.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=(q.l("".concat(h," options:"),n),new it(l)),I=(v.setMessage(JSON.stringify(n)),n.oldName),k=n.newName;return this._convM.req({proto:fe.RENAME_CONV_GRP,data:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:I,newName:k}}}).then(function(te){v.end(),q.l("".concat(h," ok")),te=te.data.updateGroupResult.convGroupID,s._convGroupMap.set(te,k),s._emitConvGroupListUpdate();var G,Y,te=s._convM.getLocalConversationList(),pe=!1;te.forEach(function(ye){G=ye.conversationGroupList,(Y=G.indexOf(I))!==-1&&(G.splice(Y,1,k),pe=!0)}),pe===!0&&s._emitConversationUpdate()}).catch(function(P){return v.setError(P).end(),q.e("".concat(h," failed. error:"),P),Re(P)})}},{key:"addConvsToGroup",value:function(n){var s=this,v="addConversationsToGroup";if(!this._convM.canIUse(ue.CONV_GROUP))return this._convM.cannotUseCommercialAbility(v);var l="".concat(this._n,".").concat(v),h=(q.l("".concat(l," options:"),n),new it(v)),v=(h.setMessage(JSON.stringify(n)),n.conversationIDList),I=n.groupName,k={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:I,updateItem:[]}},P=[],G=[];return v.forEach(function(Y){return s._hasLocalConversation(Y)?Pr(Y)||fr(Y)?void(Pr(Y)?k.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:Y.replace(O.CONV_C2C,"")}}):fr(Y)&&k.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:Y.replace(O.CONV_GROUP,"")}})):(s._onConversationIDInvalid(G,Y),!0):(s._onConversationNotFound(G,Y),!0)}),G.length===v.length?ln({successConversationIDList:P,failureConversationIDList:G}):this._convM.req({proto:fe.ADD_CONV_TO_GRP,data:k}).then(function(ve){h.end(),q.l("".concat(l," ok"));var te,pe,ye,ve=ve.data.updateGroupResult.contactResultItem;return Rt(ve)&&(ye=!1,ve.forEach(function(Ue){te=s._concatConversationID(Ue.contactItem),Ue.resultCode===0?(pe=s._getLocalConversation(te))&&pe.conversationGroupList.indexOf(I)===-1&&(pe.conversationGroupList.push(I),P.push(te),ye=!0):G.push({conversationID:te,code:Ue.resultCode,message:Ue.resultInfo})}),ye===!0&&(s._emitConversationUpdate(),s._emitConvInGroupUpdate(I))),Ut({successConversationIDList:P,failureConversationIDList:G})}).catch(function(Y){return h.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"deleteConvsFromGroup",value:function(n){var s=this,v="deleteConversationsFromGroup";if(!this._convM.canIUse(ue.CONV_GROUP))return this._convM.cannotUseCommercialAbility(v);var l="".concat(this._n,".").concat(v),h=(q.l("".concat(l," options:"),n),new it(v)),v=(h.setMessage(JSON.stringify(n)),n.conversationIDList),I=n.groupName,k={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:I,updateItem:[]}},P=[],G=[];return v.forEach(function(Y){return s._hasLocalConversation(Y)?Pr(Y)||fr(Y)?void(Pr(Y)?k.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:Y.replace(O.CONV_C2C,"")}}):fr(Y)&&k.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:Y.replace(O.CONV_GROUP,"")}})):(s._onConversationIDInvalid(G,Y),!0):(s._onConversationNotFound(G,Y),!0)}),G.length===v.length?ln({successConversationIDList:P,failureConversationIDList:G}):this._convM.req({proto:fe.DEL_CONV_FROM_GRP,data:k}).then(function(ve){h.end(),q.l("".concat(l," ok"));var te,pe,ye,ve=ve.data.updateGroupResult.contactResultItem;return Rt(ve)&&(ye=!1,ve.forEach(function(Ue){var ut;te=s._concatConversationID(Ue.contactItem),Ue.resultCode===0?!(pe=s._getLocalConversation(te))||(ut=pe.conversationGroupList.indexOf(I))!==-1&&(pe.conversationGroupList.splice(ut,1),P.push(te),ye=!0):G.push({conversationID:te,code:Ue.resultCode,message:Ue.resultInfo})}),ye===!0&&(s._emitConversationUpdate(),s._emitConvInGroupUpdate(I))),Ut({successConversationIDList:P,failureConversationIDList:G})}).catch(function(Y){return h.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"onConvMarkUpdated",value:function(n){var s,l,h=this;Ct(n)||(q.l("".concat(this._n,".onConvMarkUpdated markItemList:"),n),l=!1,n.forEach(function(G){var I=G.recentContactItem,k=G.optType,P=G.standardMark,G=G.customMark;s=h._concatConversationID(I),(s=h._getLocalConversation(s))&&(k===1?l=h._diffStandardMark(s,P):k===2?l=h._diffCustomMark(s,G):k===3&&(l=h._diffStandardMark(s,P)||h._diffCustomMark(s,G)))}),l===!0&&this._emitConversationUpdate())}},{key:"_diffStandardMark",value:function(n,l){var l=cs(l),h=!1;return function(v,I){if(v===I)return!0;if(!v||!I||v.length!==I.length)return!1;for(var k=0,P=v.length;k<P;k++)if(v[k]!==I[k])return!1;return!0}(n.markList,l)!==!0&&(n.markList=l,h=!0),h}},{key:"_diffCustomMark",value:function(n,s){var l=!1;return n.customData!==s&&s!==void 0&&(n.customData=s,l=!0),l}},{key:"onConvGroupCreated",value:function(n){var s=this,l=(q.l("".concat(this._n,".onConvGroupCreated resultList:"),n),!1),h=!1;Rt(n)&&(n.forEach(function(v){var G=v.msgGroupItem,I=G.groupID,k=G.groupName;s._convGroupMap.get(I)!==k&&(s._convGroupMap.set(I,k),h=!0);var P,G=v.msgRecentContactItem;Rt(G)&&G.forEach(function(Y){P=s._concatConversationID(Y),(P=s._getLocalConversation(P))&&P.conversationGroupList.indexOf(k)===-1&&(P.conversationGroupList.push(k),l=!0)})}),l===!0&&this._emitConversationUpdate(),h===!0&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(n){var s,l=this,h=(q.l("".concat(this._n,".onConvGroupDeleted groupItemList:"),n),[]);Rt(n)&&(s=!1,n.forEach(function(k){var I=k.groupID,k=k.groupName;l._convGroupMap.has(I)&&(l._convGroupMap.delete(I),s=!0,h.push(k))}),s===!0&&this._emitConvGroupListUpdate()),this._eraseFromConversationGroupList(h)}},{key:"_eraseFromConversationGroupList",value:function(n){Ct(n)||(this._convM.getLocalConversationList().forEach(function(s){s.conversationGroupList=s.conversationGroupList.filter(function(l){return!n.includes(l)})}),this._emitConversationUpdate())}},{key:"onConvGroupNameUpdated",value:function(n){q.l("".concat(this._n,".onConvGroupNameUpdated options:"),n);var s,l,h,v=n.groupID,I=n.groupName,k=n.oldGroupName;this._convGroupMap.get(v)!==I&&(this._convGroupMap.set(v,I),this._emitConvGroupListUpdate(),n=this._convM.getLocalConversationList(),h=!1,n.forEach(function(P){s=P.conversationGroupList,(l=s.indexOf(k))!==-1&&(s.splice(l,1,I),h=!0)}),h===!0&&this._emitConversationUpdate())}},{key:"onConvInGroupUpdated",value:function(k){var s,l,h,v=this,I=(q.l("".concat(this._n,".onConvInGroupUpdated options:"),k),k.oldGroupName),k=k.recentContactUpdateGroupItem;Rt(k)&&(h=!1,k.forEach(function(Y){var G=Y.contactOptType,Y=Y.recentContactItem;s=v._concatConversationID(Y),(s=v._getLocalConversation(s))&&(l=s.conversationGroupList.indexOf(I),G===1?l===-1&&(s.conversationGroupList.push(I),h=!0):G===2&&l!==-1&&(s.conversationGroupList.splice(l,1),h=!0))}),h===!0&&(this._emitConversationUpdate(),this._emitConvInGroupUpdate(I)))}},{key:"onConvAddedToOrDeletedFromGroup",value:function(v){var s,l,h=this,I=(q.l("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),v),v.msgRecentContactItem),v=v.msgRecentContactUpdateContactItem,I=this._concatConversationID(I),k=this._getLocalConversation(I);k&&Rt(v)&&(l=!1,v.forEach(function(Y){var G=Y.groupOptType,Y=Y.recentContactGroupItem.groupName;s=k.conversationGroupList.indexOf(Y),G===1?s===-1&&(k.conversationGroupList.push(Y),l=!0):G===2&&s!==-1&&(k.conversationGroupList.splice(s,1),l=!0),l===!0&&h._emitConvInGroupUpdate(Y)}),l===!0&&this._emitConversationUpdate())}},{key:"onConvGroupListSynced",value:function(n){Rt(n)&&n.length!==0&&(q.l("".concat(this._n,".onConvGroupListSynced groupItem:"),n),this._fillConvGroupMap(n))}},{key:"getConvGroupListByID",value:function(n){var s,l=this;if(!Ct(n))return s=[],n.forEach(function(h){l._convGroupMap.has(h)&&s.push(l._convGroupMap.get(h))}),s}},{key:"_onConversationNotFound",value:function(n,s){n.push({conversationID:s,code:Be.CONV_NOT_FOUND,message:this._convM.getErrorMessage(Be.CONV_NOT_FOUND)})}},{key:"_onConversationIDInvalid",value:function(n,s){n.push({conversationID:s,code:Be.INVALID_CONV_ID,message:this._convM.getErrorMessage(Be.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(n){for(var s=n.toString(2),l=s.length,h=l-1;0<=h;h--)if(s[h]==="1")return l-h-1}},{key:"_concatConversationID",value:function(I){var s,l=I.type,h=I.to,v=I.groupID,I=I.userID;return l===1?Qe(I)?Qe(h)||(s="".concat(O.CONV_C2C).concat(h)):s="".concat(O.CONV_C2C).concat(I):l===2&&(s="".concat(O.CONV_GROUP).concat(v)),s}},{key:"_getMyUserID",value:function(){return this._convM.getMyUserID()}},{key:"_getLocalConversation",value:function(n){return this._convM.getLocalConversation(n)}},{key:"_hasLocalConversation",value:function(n){return this._convM.hasLocalConversation(n)}},{key:"_emitConversationUpdate",value:function(){this._convM.emitConversationUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._convM.emitOuterEvent($.CONVERSATION_GROUP_LIST_UPDATED,L(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(n){var s={groupName:n,conversationList:[]},l=this._convM.getLocalConversationList();s.conversationList=l.filter(function(h){return h.conversationGroupList.includes(n)}),this._convM.emitOuterEvent($.CONVERSATION_IN_GROUP_UPDATED,s)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=ws}}]),ch),N1=(_(Wc,Uo),KI=D(Wc),p(Wc,[{key:"_initListeners",value:function(){var n=this.getInnerEmitterInstance();n.on(So.A2KEY_AND_TINYID_UPDATED,this._init,this),n.on(So.PROFILE_UPDATED,this._onProfileUpdated,this)}},{key:"onCheckTimer",value:function(n){n%60==0&&this._messageListHandler.traversal()}},{key:"_init",value:function(){var n=this,s=(q.l("".concat(this._n,"._init")),this.get(13).getItem("conversationMap")),l=this.isIntl(),h=this.isUsingChatCore();if(s){for(var v=s.length,I=0;I<v;I++){var k=s[I];if(k){if(this._isNonExistentAccount(k.conversationID))continue;if(k.groupProfile){var P=k.groupProfile.type;if(Mr(P))continue}}this._conversationMap.set(k.conversationID,new Ip(s[I],l,h))}this.emitConversationUpdate(!0,!1)}this.ready(function(){0<n._tmpGroupList.length&&(n.updateConversationGroupProfile(n._tmpGroupList),n._tmpGroupList.length=0)}),this.syncConversationList()}},{key:"_isNonExistentAccount",value:function(n){var s;return(s=n.startsWith(O.CONV_C2C)?n.replace(O.CONV_C2C,""):s)==="@TLS#ERROR"||s==="@TLS#NOT_FOUND"}},{key:"onMessageSent",value:function(n){this._onSendOrReceiveMessage({conversationOptionsList:n.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(n){this._onSendOrReceiveMessage(n)}},{key:"_onSendOrReceiveMessage",value:function(n){var s=this,l=n.conversationOptionsList,h=n.isInstantMessage,h=h===void 0||h,v=n.isUnreadC2CMessage,v=v!==void 0&&v,I=n.updateUnreadCount,I=I===void 0||I,k=n.isSyncingEnded,k=k!==void 0&&k;this._isReady?l.length!==0?(h===!0&&this._checkNewConversation(l),this._updateLocalConversationList({conversationOptionsList:l,isInstantMessage:h,isUnreadC2CMessage:v,isFromGetConversations:!1,updateUnreadCount:I}),h||(this._convIDFromUnreadDBMap=new Map([].concat(L(this._convIDFromUnreadDBMap),L(l.map(function(P){return[P.conversationID,1]})))),this._diffAndDeleteConversation(),k&&this.emitInnerEvent(So.C2C_UNREAD_HANDLE_COMPLETED)),0<l.filter(function(P){return!s._isConvNeedShow(P.conversationID)}).length||this.emitConversationUpdate()):k&&this.emitInnerEvent(So.C2C_UNREAD_HANDLE_COMPLETED):this.ready(function(){s._onSendOrReceiveMessage(n)})}},{key:"updateConversationGroupProfile",value:function(n){var s,l=this;Rt(n)&&n.length===0||(this._conversationMap.size!==0?(s=!1,n.forEach(function(h){var v="GROUP".concat(h.groupID);l._conversationMap.has(v)&&(s=!0,(v=l._conversationMap.get(v)).groupProfile=JSON.parse(JSON.stringify(h)),v.lastMessage.lastSequence<h.nextMessageSeq&&(v.lastMessage.lastSequence=h.nextMessageSeq-1),v.subType||(v.subType=h.type))}),s&&this.emitConversationUpdate(!0,!1)):this._tmpGroupList=n)}},{key:"_updateConversationUserProfile",value:function(n){var s=this;n.data.forEach(function(l){var h="C2C".concat(l.userID);s._conversationMap.has(h)&&(s._conversationMap.get(h).userProfile=l)}),this.emitConversationUpdate(!0,!1)}},{key:"onMessageRevoked",value:function(n){var s,l,h,v=this;n.length!==0&&(s=null,l=!1,h=[],n.forEach(function(I){(s=v._conversationMap.get(I.conversationID))&&(s.reduceUnreadCount()&&(l=s.type!==O.CONV_TOPIC),s.type===O.CONV_TOPIC?h.push(I):s.isLastMessageRevoked({sequence:I.sequence,time:I.time})&&(s.setLastMessageRevoked(!0),s.setLastMessageRevoker(I.revoker),l=!0))}),this.get(10).onMessageRevoked(h),l&&this.emitConversationUpdate(!0,!1))}},{key:"updateRevokerInfo",value:function(n){for(var s=new Set,l=0;l<n.length;l++){var h=n[l].revoker;s.add(h)}var v=L(s),I=this.get(4);return new Promise(function(k){I.getUserProfile({userIDList:v}).then(function(P){if(P=P.data,!Rt(P)||P.length===0)return k(n);var G,Y={},te=Z(P);try{for(te.s();!(G=te.n()).done;){var pe=G.value,ye=pe.userID,ve=pe.nick,Ue=pe.avatar;Y[ye]={nick:ve,avatar:Ue}}}catch(ut){te.e(ut)}finally{te.f()}n.forEach(function(ut){var mt=ut.revoker;Y[mt]&&(ut.revokerInfo.nick=Y[mt].nick||"",ut.revokerInfo.avatar=Y[mt].avatar||"")}),k(n)}).catch(function(){k(n)})})}},{key:"isLastMessageRevoked",value:function(n){var s=!1,l=n.conversationID,h=n.sequence,v=n.time,I=this._conversationMap.get(l);return I&&(s=I.type===O.CONV_TOPIC?this.get(10).isLastMessageRevoked({topicID:l.replace(O.CONV_GROUP,""),sequence:h}):I.isLastMessageRevoked({sequence:h,time:v})),q.l("".concat(this._n,".isLastMessageRevoked options:").concat(JSON.stringify(n)," ret:").concat(s)),s}},{key:"onMessageDeleted",value:function(n){var s=this;if(n.length!==0){var l=null;n.forEach(function(G){(l=s._messageListHandler.getLocalMessage(G.conversationID,G.ID))&&(l.isDeleted=!0),G!==l&&(G.isDeleted=!0)});for(var n=n[0].conversationID,h=this._messageListHandler.getLocalMessageList(n),v={},I=h.length-1;0<=I;I--)if(!h[I].isDeleted){v=h[I];break}var k,P=this._conversationMap.get(n);P&&(k=!1,P.lastMessage.lastSequence===v.sequence&&P.lastMessage.lastTime===v.time||(Ct(v)&&(v=void 0),P.updateLastMessage(v),P.type!==O.CONV_TOPIC&&(k=!0),q.l("".concat(this._n,".onMessageDeleted. update conversationID:").concat(n," with lastMessage:"),P.lastMessage)),n.startsWith(O.CONV_C2C)&&this.updateUnreadCount(n),k&&this.emitConversationUpdate(!0,!1))}}},{key:"onMessageModified",value:function(n){var s="".concat(this._n,".onMessageModified"),te=n.conversationType,l=n.from,h=n.to,v=n.time,I=n.sequence,k=n.elements,P=n.cloudCustomData,G=n.messageVersion,pe=this.getMyUserID(),Y="".concat(te).concat(h),pe=(h===pe&&te===O.CONV_C2C&&(Y="".concat(te).concat(l)),this._messageListHandler.onMessageModified(Y,n)),te=pe.isUpdated,pe=pe.message,ye=(te===!0&&this.emitOuterEvent($.MESSAGE_MODIFIED,[pe]),this._isTopicConversation(Y));return pe===null?q.l("".concat(s," message is null! options:").concat(JSON.stringify(n),"}")):q.l("".concat(s," isUpdated:").concat(te," isTopicMessage:").concat(ye," from:").concat(l," to:").concat(h," sequence:").concat(pe.sequence," time:").concat(pe.time)),ye?this.get(10).onMessageModified(n):!(te=this._conversationMap.get(Y))||(l=te.lastMessage)&&l.lastTime===v&&l.lastSequence===I&&l.version!==G&&(q.l("".concat(s," conversationID:").concat(Y," lastMessage updated")),l.type=k[0].type,l.payload=k[0].content,l.messageForShow=Fd(l.type,l.payload,this.isIntl()),l.cloudCustomData=P,l.version=G,this.emitConversationUpdate(!0,!1)),pe}},{key:"onNewGroupAtTips",value:function(l){var s=this,l=l.dataList,h=null;l.forEach(function(v){v.groupAtTips?h=v.groupAtTips:v.elements?h=i(i({},v.elements),{},{sync:!0}):v.groupAtType&&(h=i(i({},v),{},{sync:!0})),h.__random=v.random,h.__sequence=v.clientSequence,s._tmpGroupAtTipsList.push(h)}),q.d("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var n,s=this;this._tmpGroupAtTipsList.length!==0&&(n=!1,this._tmpGroupAtTipsList.forEach(function(l){var h,v=l.groupID,I=l.from,k=l.topicID,k=k===void 0?void 0:k,P=l.sync,P=P!==void 0&&P;I!==s.getMyUserID()&&(Qe(k)?(I=s._conversationMap.get("".concat(O.CONV_GROUP).concat(v)))&&(I.updateGroupAtInfoList(l),n=!0):((v=s._conversationMap.get("".concat(O.CONV_GROUP).concat(k)))&&(v.updateGroupAtInfoList(l),I=s.get(10),h=v.groupAtInfoList,I.onConversationProxy({topicID:k,groupAtInfoList:h})),Ct(v)&&P&&(s.updateTopicConversation([{conversationID:"".concat(O.CONV_GROUP).concat(k),type:O.CONV_TOPIC}]),s._conversationMap.get("".concat(O.CONV_GROUP).concat(k)).updateGroupAtInfoList(l))))}),n&&this.emitConversationUpdate(!0,!1),this._tmpGroupAtTipsList.length=0)}},{key:"_checkNewConversation",value:function(n){var s=this,l=[],h=[];n.forEach(function(v){s._conversationMap.has(v.conversationID)||(v.type===O.CONV_C2C?l.push(v.conversationID.replace(O.CONV_C2C,"")):v.type===O.CONV_GROUP&&h.push(v.conversationID.replace(O.CONV_GROUP,"")))}),0<l.length&&(this._onNewC2CConversation(l),l=null),0<h.length&&(this._onNewGroupConversation(h),h=null)}},{key:"_onNewC2CConversation",value:function(n){this.get(6).getRemotePeerReadTime(n),this._messageRemindHandler.getC2CMessageRemindType(n),this._convGroupHandler.searchConvGroupAndMark(n,1)}},{key:"_onNewGroupConversation",value:function(n){var s=this.get(7);s&&s.getMessageRemindType(n),this._convGroupHandler.searchConvGroupAndMark(n,2)}},{key:"_setStorageConversationList",value:function(){var n=0<arguments.length&&arguments[0]!==void 0&&arguments[0],s=this.getLocalConversationList().filter(function(l){return l.type===O.CONV_C2C||l.type===O.CONV_GROUP&&l.lastMessage.type!==O.MSG_GRP_TIP}).slice(0,20).map(function(l){return{conversationID:l.conversationID,type:l.type,subType:l.subType,lastMessage:l.lastMessage,groupProfile:l.groupProfile,userProfile:l.userProfile}});this.get(13).setItem("conversationMap",s,n)}},{key:"emitConversationUpdate",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],l=this.getLocalConversationList();!s||(s=this.get(7))&&s.updateGroupLastMessage(l),n&&(this.get(12).isPartialUpdatedConvs()?(this._diffConvMap(this._convMapForDiff,this._conversationMap),0<this._partialUpdatedConvMap.size&&(this.emitOuterEvent($.CONVERSATION_LIST_UPDATED),this.emitTotalUnreadMessageCountUpdate(),this._convMapForDiff.clear(),this._convMapForDiff=yt(this._conversationMap,!0)),this._convMapForDiff.size===0&&(this._convMapForDiff=yt(this._conversationMap,!0))):(this.emitOuterEvent($.CONVERSATION_LIST_UPDATED),this.emitTotalUnreadMessageCountUpdate()))}},{key:"_diffConvMap",value:function(n,s){var l,h=Z(n);try{for(h.s();!(l=h.n()).done;){var v=x(l.value,2),I=v[0],k=v[1];s.has(I)&&k===JSON.stringify(s.get(I))||this._partialUpdatedConvMap.set(I,s.get(I))}}catch(P){h.e(P)}finally{h.f()}}},{key:"getPartialUpdatedConvs",value:function(){var n=L(yt(this._partialUpdatedConvMap,!1).values());return this._partialUpdatedConvMap.clear(),n}},{key:"getLocalConversationList",value:function(){var n=this;return L(this._conversationMap.values()).filter(function(s){return n._isConvNeedShow(s.conversationID)})}},{key:"getLocalConversation",value:function(n){return this._conversationMap.get(n)}},{key:"hasLocalConversation",value:function(n){return this._conversationMap.has(n)}},{key:"getLocalOldestMessage",value:function(n){return this._messageListHandler.getLocalOldestMessage(n)}},{key:"syncConversationList",value:function(){var n=this,s=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],l="syncConversationList",h=new it(l);return this._pagingStatus===ws&&this._conversationMap.clear(),this._pagingGetConversationList(s).then(function(v){var I=NI(n._pagingGetCostList),k=Vd(n._pagingGetCostList),k=(n._pagingGetCostList.length=0,n._pagingStatus=Hd,n._diffAndDeleteConversation(),n.emitConversationUpdate(!0,!1),n._setStorageConversationList(),n._handleC2CPeerReadTime(),n.emitInnerEvent(So.CONV_SYNC_COMPLETED),"count:".concat(n._conversationMap.size," sum:").concat(k," avg:").concat(I));return q.l("".concat(n._n,".").concat(l,". ").concat(k)),h.setMessage(k).end(),v}).catch(function(v){return n._pagingStatus=$c,h.setMessage(n._pagingTimeStamp).setError(v).end(),Re(v)})}},{key:"_diffAndDeleteConversation",value:function(){var n,s=this;this._isSyncCompleted()&&(n=[],this._conversationMap.forEach(function(l,h){!s._pagingConvIDMap.has(h)&&s._convIDFromUnreadDBMap.has(h)&&(s._conversationMap.delete(h),n.push(h))}),q.l("".concat(this._n,"._diffAndDeleteConversation list:").concat(n)),n=null)}},{key:"_pagingGetConversationList",value:function(){var n=this,s=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],l="".concat(this._n,"._pagingGetConversationList"),h=(q.l("".concat(l," incrementalPullFlag:").concat(s," timeStamp:").concat(this._pagingTimeStamp," startIndex:").concat(this._pagingStartIndex)+" pinnedTimeStamp:".concat(this._pagingPinnedTimeStamp," pinnedStartIndex:").concat(this._pagingPinnedStartIndex)),Date.now());return this._pagingStatus=UI,this.req({proto:fe.PAGING_GET_CONV_LIST,data:{fromAccount:this.getMyUserID(),timeStamp:s?this._pagingTimeStamp:0,startIndex:s?this._pagingStartIndex:0,pinnedTimeStamp:s?this._pagingPinnedTimeStamp:0,pinnedStartIndex:s?this._pagingPinnedStartIndex:0,orderType:1}}).then(function(pe){var pe=pe.data,I=pe.completeFlag,k=pe.conversations,k=k===void 0?[]:k,P=pe.timeStamp,G=pe.startIndex,Y=pe.pinnedTimeStamp,te=pe.pinnedStartIndex,pe=pe.groupItem;if(n._pagingGetCostList.push(ar(h,!1)),q.l("".concat(l," ok. completeFlag:").concat(I," count:").concat(k.length," cost:").concat(ar(h))),n._convGroupHandler.onConvGroupListSynced(pe),0<k.length&&(pe=n._getConversationOptions(k),n._pagingConvIDMap=new Map([].concat(L(n._pagingConvIDMap),L(pe.map(function(ye){return[ye.conversationID,1]})))),n._updateLocalConversationList({conversationOptionsList:pe,isFromGetConversations:!0,updateUnreadCount:!0}),n.isLoggedIn()&&n.emitConversationUpdate()),!n._isReady){if(!n.isLoggedIn())return ln();n.triggerReady()}return n._pagingTimeStamp=P,n._pagingStartIndex=G,n._pagingPinnedTimeStamp=Y,n._pagingPinnedStartIndex=te,I!==1?n._pagingGetConversationList():(n._handleGroupAtTipsList(),n._convGroupHandler.getRemoteConvGroupList(),ln())}).catch(function(v){throw n.isLoggedIn()&&(n._isReady||(q.w("".concat(l," failed. error:"),v),n.triggerReady())),v})}},{key:"_updateLocalConversationList",value:function(h){var s=h.isFromGetConversations,l=Date.now(),h=this._getTmpConversationListMapping(h);this._conversationMap=new Map(this._sortConversationList([].concat(L(h.toBeUpdatedConversationList),L(this._conversationMap)))),s||this._updateUserOrGroupProfile(h.newConversationList),q.l("".concat(this._n,"._updateLocalConversationList cost:").concat(ar(l)))}},{key:"_getTmpConversationListMapping",value:function(n){for(var s=n.conversationOptionsList,l=n.isFromGetConversations,h=n.isInstantMessage,v=n.isUnreadC2CMessage,I=v!==void 0&&v,k=n.updateUnreadCount,P=[],G=[],Y=this.get(7),te=this.get(8),pe=this.isIntl(),ye=this.isUsingChatCore(),ve=0,Ue=s.length;ve<Ue;ve++){var ut,mt,Kt,en,Un=new Ip(s[ve],pe,ye),vo=Un.conversationID;this._isNonExistentAccount(vo)||(this._conversationMap.has(vo)?(ut=this._conversationMap.get(vo),!(mt=["unreadCount","allowType","adminForbidType","payload"])===h&&mt.push("lastMessage"),typeof h=="boolean"&&mt.push("isPinned"),en=s[ve].lastMessage,(Kt=!Qe(en))||s[ve].type===O.CONV_TOPIC||this._onLastMessageNotExist(s[ve]),Qe(h)&&Kt&&ut.lastMessage.payload===null&&(ut.lastMessage.payload=en.payload),Ct(ut.lastMessage.revoker)||(ut.lastMessage.revoker=null),ni(ut,Un,mt,[null,void 0,"",0,NaN]),k===!0&&ut.updateUnreadCount({nextUnreadCount:Un.unreadCount,isFromGetConversations:l,isUnreadC2CMessage:I}),h&&Kt&&(en.payload&&(ut.lastMessage.payload=en.payload),ut.type===O.CONV_GROUP&&(ut.lastMessage.nameCard=en.nameCard,ut.lastMessage.nick=en.nick)),Kt&&ut.lastMessage.cloudCustomData!==en.cloudCustomData&&(ut.lastMessage.cloudCustomData=en.cloudCustomData||""),this._conversationMap.delete(vo),P.push([vo,ut])):(Un.type===O.CONV_GROUP&&Y?(mt=Un.groupProfile.groupID,(Kt=Y.getLocalGroupProfile(mt))&&(Un.groupProfile=Kt,k===!0&&Un.updateUnreadCount({nextUnreadCount:0}))):Un.type===O.CONV_C2C&&(en=vo.replace(O.CONV_C2C,""),te&&te.isMyFriend(en)&&(Un.remark=te.getFriendRemark(en))),G.push(Un),P.push([vo,Un])))}for(var nr,pr,br,Ya=this.get(10),Ja=P.length,lu=0;lu<Ja;lu++)P[lu][1].type===O.CONV_TOPIC&&(nr=(br=P[lu][1]).conversationID,pr=br.unreadCount,br=br.groupAtInfoList,Ya.onConversationProxy({topicID:nr.replace(O.CONV_GROUP,""),unreadCount:pr,groupAtInfoList:Ct(br)?void 0:br}));return{toBeUpdatedConversationList:P,newConversationList:G}}},{key:"_onLastMessageNotExist",value:function(n){new it("lastMessageNotExist").setMessage(JSON.stringify(n)).end()}},{key:"_sortConversationList",value:function(n){var s=[],l=[],h=[],v=[];return n.forEach(function(I){(I[1].isPinned===!0?Ct(I[1].lastMessage.lastTime)?l:s:Ct(I[1].lastMessage.lastTime)?v:h).push(I)}),s.sort(function(I,k){return k[1].lastMessage.lastTime-I[1].lastMessage.lastTime}).concat(l).concat(h.sort(function(I,k){return k[1].lastMessage.lastTime-I[1].lastMessage.lastTime})).concat(v)}},{key:"_sortConversationListAndEmitEvent",value:function(){this._conversationMap=new Map(this._sortConversationList(L(this._conversationMap))),this.emitConversationUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(n){var s,l,h,v,I=this;n.length!==0&&(s=[],l=[],h=this.get(4),v=this.get(7),n.forEach(function(k){var P;k.type===O.CONV_C2C?s.push(k.toAccount):k.type===O.CONV_GROUP&&(P=k.toAccount,v.hasLocalGroup(P)?k.groupProfile=v.getLocalGroupProfile(P):l.push(P))}),q.l("".concat(this._n,"._updateUserOrGroupProfile c2cUserIDList:").concat(s," groupIDList:").concat(l)),0<s.length&&h.getUserProfile({userIDList:s}).then(function(k){k=k.data,Rt(k)?k.forEach(function(P){I._doUpdateUserProfile("C2C".concat(P.userID),P)}):I._doUpdateUserProfile("C2C".concat(k.userID),k)}),0<l.length&&v.getGroupProfileAdvance({groupIDList:l,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then(function(P){var P=P.data.successGroupList,G=!1;P.forEach(function(Y){var te="GROUP".concat(Y.groupID);I._conversationMap.has(te)&&(te=I._conversationMap.get(te),ni(te.groupProfile,Y,[],[null,void 0,"",0,NaN]),!te.subType&&Y.type&&(te.subType=Y.type),G=!0)}),G&&I.emitConversationUpdate()}))}},{key:"_doUpdateUserProfile",value:function(n,s){this.hasLocalConversation(n)&&(this.getLocalConversation(n).userProfile=s,this.emitConversationUpdate())}},{key:"_getConversationOptions",value:function(v){var s=this,l=[],v=v.filter(function(P){var k=P.type,P=P.userID;return k===1&&!s._isNonExistentAccount(P)||k===2}),h=this.getMyUserID(),v=v.map(function(I){var k;return Qe(I.lastMsg)&&(I.lastMsg={elements:[]}),I.type===1?(k={userID:I.userID,nick:I.peerNick,avatar:I.peerAvatar},l.push(k),{conversationID:"C2C".concat(I.userID),type:"C2C",lastMessage:{lastTime:I.time,lastSequence:I.sequence,fromAccount:I.lastC2CMsgFromAccount,type:I.lastMsg.elements[0]?I.lastMsg.elements[0].type:null,payload:I.lastMsg.elements[0]?s._amendLayersOverLimitProperty(I.lastMsg.elements[0].content):null,cloudCustomData:I.lastMsg.cloudCustomData||"",isRevoked:I.lastMessageFlag===8,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:I.lastC2CMsgFromAccount===h&&I.time<=I.c2cPeerReadTime,revoker:I.lastMsg.revokerInfo?I.lastMsg.revokerInfo.revoker:null},userProfile:new eh(k),peerReadTime:I.c2cPeerReadTime,isPinned:I.isPinned===1,customData:I.customMark||"",markList:cs(I.standardMark),conversationGroupList:s._convGroupHandler.getConvGroupListByID(I.contactGroupId),remark:I.friendRemark||"",messageRemindType:s._transMessageRemindType(I.messageRemindType)}):{conversationID:"GROUP".concat(I.groupID),type:"GROUP",lastMessage:i(i({lastTime:I.time,lastSequence:I.sequence,fromAccount:I.msgGroupFromAccount},s._patchTypeAndPayload(I)),{},{cloudCustomData:I.lastMsg.cloudCustomData||"",isRevoked:I.lastMessageFlag===2,onlineOnlyFlag:!1,nick:I.senderNick||"",nameCard:I.senderNameCard||"",revoker:I.lastMsg.revokerInfo?I.lastMsg.revokerInfo.revoker:null}),groupProfile:new fa({groupID:I.groupID,name:I.groupNick,avatar:I.groupImage,type:I.groupType,nextMessageSeq:I.nextMessageSeq}),unreadCount:s._computeGroupUnreadCount(I),peerReadTime:0,isPinned:I.isPinned===1,version:0,customData:I.customMark||"",markList:cs(I.standardMark),conversationGroupList:s._convGroupHandler.getConvGroupListByID(I.contactGroupId),messageRemindType:s._transMessageRemindType(I.messageRemindType)}});return 0<l.length&&this.get(4).onConversationsProfileUpdated(l),v}},{key:"_transMessageRemindType",value:function(n){var s="";return n===0?s=O.MSG_REMIND_ACPT_AND_NOTE:n===1?s=O.MSG_REMIND_DISCARD:n===2?s=O.MSG_REMIND_ACPT_NOT_NOTE:n===3&&(s=O.RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT),s}},{key:"_computeGroupUnreadCount",value:function(s){var l=s.unreadCount,s=s.noUnreadCount,l=(l===void 0?0:l)-(s===void 0?0:s);return 0<l?l:0}},{key:"_patchTypeAndPayload",value:function(h){var h=h.lastMsg,s=h.event,l=h.elements,l=l===void 0?[]:l,h=h.groupTips,h=h===void 0?{}:h;return Qe(s===void 0?void 0:s)||Ct(h)?{type:l[0]?l[0].type:null,payload:l[0]?this._amendLayersOverLimitProperty(l[0].content):null}:((s=new er(h)).setElement({type:O.MSG_GRP_TIP,content:i(i({},h.elements),{},{groupProfile:h.groupProfile})}),l=JSON.parse(JSON.stringify(s.payload)),s=null,{type:O.MSG_GRP_TIP,payload:l})}},{key:"_amendLayersOverLimitProperty",value:function(n){var s=n.layersOverLimit;return s===0?n.layersOverLimit=!1:s===1&&(n.layersOverLimit=!0),n}},{key:"getLocalMessageList",value:function(n){return this._messageListHandler.getLocalMessageList(n)}},{key:"deleteLocalMessage",value:function(n){n instanceof er&&this._messageListHandler.remove(n)}},{key:"onConversationDeleted",value:function(n){Rt(n)&&(n=n.map(function(v){var l=v.type,h=v.userID,v=v.groupID;return l===1?"".concat(O.CONV_C2C).concat(h):l===2?"".concat(O.CONV_GROUP).concat(v):void 0}),q.l("".concat(this._n,".onConversationDeleted conversationIDList:").concat(n)),this.deleteLocalConversationList(n))}},{key:"onConversationPinned",value:function(n){var s,l=this;Rt(n)&&(s=!1,n.forEach(function(P){var v,I=P.type,k=P.userID,P=P.groupID;I===1?v=l.getLocalConversation("".concat(O.CONV_C2C).concat(k)):I===2&&(v=l.getLocalConversation("".concat(O.CONV_GROUP).concat(P))),v&&(q.l("".concat(l._n,".onConversationPinned conversationID:").concat(v.conversationID," isPinned:").concat(v.isPinned)),v.isPinned||(v.isPinned=!0,s=!0))}),s&&this._sortConversationListAndEmitEvent())}},{key:"onConversationUnpinned",value:function(n){var s,l=this;Rt(n)&&(s=!1,n.forEach(function(P){var v,I=P.type,k=P.userID,P=P.groupID;I===1?v=l.getLocalConversation("".concat(O.CONV_C2C).concat(k)):I===2&&(v=l.getLocalConversation("".concat(O.CONV_GROUP).concat(P))),v&&(q.l("".concat(l._n,".onConversationUnpinned conversationID:").concat(v.conversationID," isPinned:").concat(v.isPinned)),v.isPinned&&(v.isPinned=!1,s=!0))}),s&&this._sortConversationListAndEmitEvent())}},{key:"getMessageList",value:function(v){var s=this,l=v.conversationID,h=v.nextReqMessageID,v=v.count,I="".concat(this._n,".getMessageList"),G=this.getLocalConversation(l),k="";if(G&&G.groupProfile&&(k=G.groupProfile.type),Mr(k))return q.l("".concat(I," not available in avchatroom. conversationID:").concat(l)),ln({messageList:[],nextReqMessageID:"",isCompleted:!0});(Qe(v)||15<v)&&(v=15),!h&&this._isNotInCommunity(l)&&(this._messageListHandler.removeByConversationID(l),this._completedMap.delete(l),this._roamingMessageSequenceMap.delete(l));var P=this._computeRemainingCount({conversationID:l,nextReqMessageID:h}),G=this._completedMap.has(l);return q.l("".concat(I," conversationID:").concat(l," nextReqMessageID:").concat(h)+" remainingCount:".concat(P," count:").concat(v," isCompleted:").concat(G)),this._needGetHistory({conversationID:l,remainingCount:P,count:v})?this.getHistoryMessages({conversationID:l,nextReqMessageID:h,count:20}).then(function(Ue){var ve=Ue.nextReqID,Ue=Ue.storedMessageList,te=s._completedMap.has(l),pe=Ue,ye={nextReqMessageID:te?"":ve,messageList:pe=0<P?s._messageListHandler.getLocalMessageList(l).slice(0,Ue.length+P):pe,isCompleted:te},ve=ye.messageList.filter(function(ut){return ut.isRevoked})||[],Ue=pe.map(function(ut){return ut.sequence});return q.l("".concat(I," ret.nextReqMessageID:").concat(ye.nextReqMessageID," ret.isCompleted:").concat(ye.isCompleted," ret.length:").concat(pe.length," sequenceList:"),Ue),Rt(ve)&&ve.length!==0?s.updateRevokerInfo(ve).then(function(ut){return ut.forEach(function(mt){var Kt=mt.revokerInfo;ye.messageList=ye.messageList.map(function(en){return en.ID===mt.ID&&Kt&&(en.revokeReason=Kt.reason||"",en.revokerInfo={userID:Kt.revoker||en.revoker,nick:Kt.nick,avatar:Kt.avatar}),en})}),Ut(ye)}):Ut(ye)}):(this.modifyMessageList(l),k=this._getMessageListFromMemory({conversationID:l,nextReqMessageID:h,count:v}),ln(k))}},{key:"_getMessageListFromMemory",value:function(h){var s=h.conversationID,l=h.nextReqMessageID,h=h.count,v="".concat(this._n,"._getMessageListFromMemory"),I=this._messageListHandler.getLocalMessageList(s),k=I.length,P=0,G={isCompleted:!1,nextReqMessageID:"",messageList:[]};return l?(P=I.findIndex(function(Y){return Y.ID===l}))>h?(G.messageList=I.slice(P-h,P),G.nextReqMessageID=I[P-h].ID):(G.messageList=I.slice(0,P),G.isCompleted=!0):h<k?(G.messageList=I.slice(P=k-h,k),G.nextReqMessageID=I[P].ID):(G.messageList=I.slice(0,k),G.isCompleted=!0),q.l("".concat(v," conversationID:").concat(s)+" ret.nextReqMessageID:".concat(G.nextReqMessageID," ret.isCompleted:").concat(G.isCompleted," ret.length:").concat(G.messageList.length)),G}},{key:"getMessageListHopping",value:function(P){var s,l,h=P.conversationID,v=P.sequence,I=P.time,k=P.count,P=P.direction,P=P===void 0?0:P;return(Qe(k)||15<k)&&(k=15),h.startsWith(O.CONV_C2C)?(s=this.get(6),l=h.replace(O.CONV_C2C,""),s.getRoamingMessagesHopping({peerAccount:l,time:I,count:k,direction:P})):h.startsWith(O.CONV_GROUP)?(s=this.get(7),l=h.replace(O.CONV_GROUP,""),s.getRoamingMessagesHopping({groupID:l,sequence:v,count:k,direction:P})):void 0}},{key:"_computeRemainingCount",value:function(h){var s=h.conversationID,l=h.nextReqMessageID,h=this._messageListHandler.getLocalMessageList(s),v=h.length;return q.l("".concat(this._n,"._computeRemainingCount conversationID:").concat(s," nextReqMessageID:").concat(l," length:").concat(v)),l?(v=0,Pr(s)?v=h.findIndex(function(I){return I.ID===l}):fr(s)&&(v=l.indexOf("-")!==-1?h.findIndex(function(I){return I.ID===l}):h.findIndex(function(I){return I.sequence===l})),v=v===-1?0:v):v}},{key:"_getMessageListSize",value:function(n){return this._messageListHandler.getLocalMessageList(n).length}},{key:"_needGetHistory",value:function(h){var s=h.conversationID,l=h.remainingCount,h=h.count,v=this.getLocalConversation(s),I="";if(v&&v.groupProfile&&(I=v.groupProfile.type),ap(s)||Mr(I))return!1;if(v=!1,I="".concat(this._n,"._needGetHistory conversationID:").concat(s),fr(s)){var k=this._isPagingGetGroupListCompleted(),P=this._getLocalGroupCount(),G=this._hasLocalGroup(s),Y=this._isTopicConversation(s);if(q.l("".concat(I," isGroupListCompleted:").concat(k," localGroupCount:").concat(P)+" isGroupInList:".concat(G," isTopic:").concat(Y)),k&&P<=500&&!G&&!Y)return v}return v=l<=h&&!this._completedMap.has(s),q.l("".concat(I," ret:").concat(v)),v}},{key:"_isTopicConversation",value:function(n){return n=n.replace(O.CONV_GROUP,""),Qo(n)}},{key:"getHistoryMessages",value:function(h){var s=h.conversationID,h=h.count;if(s===O.CONV_SYSTEM)return ln();var l=15,h=(20<h&&(l=20),null);if(Pr(s))return v=this._roamingMessageKeyAndTimeMap.has(s),(h=this.get(6))?h.getRoamingMessage({conversationID:s,peerAccount:s.replace(O.CONV_C2C,""),count:l,lastMessageTime:v?this._roamingMessageKeyAndTimeMap.get(s).lastMessageTime:0,messageKey:v?this._roamingMessageKeyAndTimeMap.get(s).messageKey:""}):Re({code:Be.CANNOT_FIND_MODULE});if(fr(s)){if(!(h=this.get(7)))return Re({code:Be.CANNOT_FIND_MODULE});var v=s.replace(O.CONV_GROUP,""),k=null,I=0,k=((k=this._conversationMap.has(s)&&!Qo(v)?this._conversationMap.get(s).lastMessage:k)&&(I=k.lastSequence),this._roamingMessageSequenceMap.get(s));return h.getRoamingMessage({conversationID:s,groupID:v,count:l,sequence:k||I})}return ln()}},{key:"patchConversationLastMessage",value:function(n){var s,l,h=1<arguments.length&&arguments[1]!==void 0&&arguments[1],v=this.getLocalConversation(n);v&&(s=(l=v.lastMessage).messageForShow,l=l.payload,!(Ct(s)||Ct(l)||h)||(s=this._messageListHandler.getLocalMessageList(n)).length!==0&&(l=s[s.length-1],q.l("".concat(this._n,".patchConversationLastMessage bForceUpdate:").concat(h," conversationID:").concat(n," payload:"),l.payload),v.updateLastMessage(l)))}},{key:"onRoamingMessage",value:function(){for(var n,s,l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],h=1<arguments.length?arguments[1]:void 0,v=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],I=h.startsWith(O.CONV_C2C)?O.CONV_C2C:O.CONV_GROUP,k=null,P=[],G=[],ve=0,Ue=l.length,Y=I===O.CONV_GROUP,te=this.getFileDownloadProxy(),pe=function(){Y?--ve:++ve},ye=function(){return Y?Ue<=ve:ve<Ue},ve=Y?l.length-1:0,Ue=Y?0:l.length;ye();pe())Y&&l[ve].sequence===1&&v&&this.setCompleted(h),l[ve].isPlaceMessage!==1&&((k=new er(l[ve])).to=l[ve].to,I!==O.CONV_GROUP||Qe(l[ve].topicID)||(k.to=l[ve].topicID),k.isSystemMessage=!!l[ve].isSystemMessage,k.conversationType=I,n=l[ve].event===4?{type:O.MSG_GRP_TIP,content:i(i({},l[ve].elements),{},{groupProfile:l[ve].groupProfile})}:l[ve].elements,Y||k.setNickAndAvatar({nick:l[ve].nick,avatar:l[ve].avatar}),Ct(n)?((s=new it("emptyMessageBody")).setMessage("from:".concat(k.from," to:").concat(k.to," sequence:").concat(k.sequence," event:").concat(l[ve].event)),s.setLevel("warning").end()):(k.setElement(n,te),k.reInitialize(this.getMyUserID()),P.push(k)));return pe=ye=null,v?(this._messageListHandler.unshift(P,G),P=null,G):(G=null,P)}},{key:"findMessage",value:function(n){return this._messageListHandler.findMessage(n)}},{key:"_isNotInCommunity",value:function(n){var s=!1;return n.startsWith(O.CONV_GROUP)&&this._isTopicConversation(n)&&(n=Zo(n.replace(O.CONV_GROUP,"")),this.get(7).hasLocalGroup(n)||(s=!0)),s}},{key:"deleteTopicRoamingMessageInfo",value:function(n){var s=this;Dr({groupID:n})&&this._messageListHandler.getTopicConversationIDList(n).forEach(function(l){s._completedMap.delete(l),s._roamingMessageSequenceMap.delete(l)})}},{key:"deleteGroupRoamingMessageInfo",value:function(n){n="".concat(O.CONV_GROUP).concat(n),this._completedMap.delete(n),this._roamingMessageSequenceMap.delete(n)}},{key:"setMessageRead",value:function(h){var s=h.conversationID,l=this.getLocalConversation(s),h="".concat(this._n,".setMessageRead");if(q.l("".concat(h," conversationID:").concat(s," unreadCount:").concat(l?l.unreadCount:0)),!l||(l.type!==O.CONV_GROUP&&l.type!==O.CONV_TOPIC||Ct(l.groupAtInfoList)||this.deleteGroupAtTips(s),l.unreadCount===0))return ln();var v=this._messageListHandler.getLocalLastMessage(s),I=l.lastMessage.lastTime,k=this._messageListHandler.getLocalMaxTime(s),k=(I<k&&(q.l("".concat(h," update lastMessageTime from ").concat(I," to ").concat(k)),I=k),this._messageListHandler.getLocalMaxSequence(s)),P=l.lastMessage.lastSequence,G=(P<k&&(q.l("".concat(h," update lastMessageSeq from ").concat(P," to ").concat(k)),P=k),l.type===O.CONV_TOPIC&&Qe(v)&&(h=this.get(10),v=Zo(k=s.replace(O.CONV_GROUP,"")),(h=h.getLocalTopic(v,k))&&(P=h.nextMessageSeq-1)),null);switch(l.type){case O.CONV_C2C:return(G=this.get(6))?G.setMessageRead({conversationID:s,lastMessageTime:I}):Re({code:Be.CANNOT_FIND_MODULE});case O.CONV_GROUP:case O.CONV_TOPIC:return(G=this.get(7))?G.setMessageRead({conversationID:s,lastMessageSeq:P}):Re({code:Be.CANNOT_FIND_MODULE});case O.CONV_SYSTEM:return l.unreadCount=0,this.emitConversationUpdate(!0,!1),ln();default:return ln()}}},{key:"setAllMessageRead",value:function(){var n=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l="setAllMessageRead",h="".concat(this._n,".").concat(l),v=(s.scope||(s.scope=O.READ_ALL_MSG),q.l("".concat(h," options:"),s),this._createSetAllMessageReadPack(s));if(v.readAllC2CMessage===0&&v.groupMessageReadInfoList.length===0)return ln();var I=new it(l);return this.req({proto:fe.SET_ALL_MSG_READ,data:v}).then(function(k){return k=k.data,k=n._handleAllMessageRead(k),I.setMessage("scope:".concat(s.scope," failureGroups:").concat(JSON.stringify(k))).end(),ln()}).catch(function(k){return I.setError(k).end(),q.w("".concat(h," failed. error:"),k),Re({code:k&&k.code?k.code:Be.MSG_UNREAD_ALL_FAIL,message:k&&k.message?k.message:void 0})})}},{key:"setConversationCustomData",value:function(n){return this._convGroupHandler.setConvCustomData(n)}},{key:"markConversation",value:function(n){return this._convGroupHandler.markConversation(n)}},{key:"getConversationGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConversationGroup",value:function(n){return this._convGroupHandler.createConvGroup(n)}},{key:"deleteConversationGroup",value:function(n){return this._convGroupHandler.deleteConvGroup(n)}},{key:"renameConversationGroup",value:function(n){return this._convGroupHandler.renameConvGroup(n)}},{key:"addConversationsToGroup",value:function(n){return this._convGroupHandler.addConvsToGroup(n)}},{key:"deleteConversationsFromGroup",value:function(n){return this._convGroupHandler.deleteConvsFromGroup(n)}},{key:"onConversationMarkUpdated",value:function(n){this._convGroupHandler.onConvMarkUpdated(n)}},{key:"onConversationGroupCreated",value:function(n){this._convGroupHandler.onConvGroupCreated(n)}},{key:"onConversationGroupDeleted",value:function(n){this._convGroupHandler.onConvGroupDeleted(n)}},{key:"onConversationGroupNameUpdated",value:function(n){this._convGroupHandler.onConvGroupNameUpdated(n)}},{key:"onConversationInGroupUpdated",value:function(n){this._convGroupHandler.onConvInGroupUpdated(n)}},{key:"onConversationAddedToOrDeletedFromGroup",value:function(n){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(n)}},{key:"_getConversationLastMessageSequence",value:function(l){var s=this._messageListHandler.getLocalLastMessage(l.conversationID),l=l.lastMessage.lastSequence;return l=s&&l<s.sequence?s.sequence:l}},{key:"_getConversationLastMessageTime",value:function(l){var s=this._messageListHandler.getLocalLastMessage(l.conversationID),l=l.lastMessage.lastTime;return l=s&&l<s.time?s.time:l}},{key:"_createSetAllMessageReadPack",value:function(n){var s,l={readAllC2CMessage:0,groupMessageReadInfoList:[]},h=n.scope,v=Z(this._conversationMap);try{for(v.s();!(s=v.n()).done;){var I,k=x(s.value,2)[1];if(0<k.unreadCount)if(k.type===O.CONV_C2C&&l.readAllC2CMessage===0){if(h===O.READ_ALL_MSG)l.readAllC2CMessage=1;else if(h===O.READ_ALL_C2C_MSG){l.readAllC2CMessage=1;break}}else k.type!==O.CONV_GROUP||h!==O.READ_ALL_GROUP_MSG&&h!==O.READ_ALL_MSG||(I=this._getConversationLastMessageSequence(k),l.groupMessageReadInfoList.push({groupID:k.groupProfile.groupID,messageSequence:I}))}}catch(P){v.e(P)}finally{v.f()}return l}},{key:"onPushedAllMessageRead",value:function(n){this._handleAllMessageRead(n)}},{key:"_handleAllMessageRead",value:function(s){var l=s.groupMessageReadInfoList,s=s.readAllC2CMessage,l=this._parseGroupReadInfo(l);return 1<=this._updateAllConversationUnreadCount({readAllC2CMessage:s})&&this.emitConversationUpdate(!0,!1),l}},{key:"_parseGroupReadInfo",value:function(n){var s=[];if(n&&n.length)for(var l=0,h=n.length;l<h;l++){var P=n[l],v=P.groupID,I=P.sequence,k=P.retCode,P=P.lastMessageSeq;Qe(k)?this._remoteGroupReadSequenceMap.set(v,P):(this._remoteGroupReadSequenceMap.set(v,I),k!==0&&s.push("".concat(v,"-").concat(I,"-").concat(k)))}return s}},{key:"_updateAllConversationUnreadCount",value:function(n){var s,l=n.readAllC2CMessage,h=0,v=Z(this._conversationMap);try{for(v.s();!(s=v.n()).done;){var I,k,P,G,Y=x(s.value,2),te=Y[0],pe=Y[1];1<=pe.unreadCount&&(l===1&&pe.type===O.CONV_C2C?(I=this._getConversationLastMessageTime(pe),this.updateIsReadAfterReadReport({conversationID:te,lastMessageTime:I})):pe.type===O.CONV_GROUP&&(k=te.replace(O.CONV_GROUP,""),this._remoteGroupReadSequenceMap.has(k)&&(P=this._remoteGroupReadSequenceMap.get(k),G=this._getConversationLastMessageSequence(pe),this.updateIsReadAfterReadReport({conversationID:te,remoteReadSequence:P}),P<=G&&this._remoteGroupReadSequenceMap.delete(k))),this.updateUnreadCount(te,!1)&&(h+=1))}}catch(ye){v.e(ye)}finally{v.f()}return h}},{key:"isRemoteRead",value:function(h){var s,l=h.conversationID,h=h.sequence,v=l.replace(O.CONV_GROUP,""),I=!1;return this._remoteGroupReadSequenceMap.has(v)&&(h<=(s=this._remoteGroupReadSequenceMap.get(v))&&(I=!0,q.l("".concat(this._n,".isRemoteRead conversationID:").concat(l," messageSequence:").concat(h," remoteReadSequence:").concat(s))),s+10<=h&&this._remoteGroupReadSequenceMap.delete(v)),I}},{key:"updateIsReadAfterReadReport",value:function(n){var s=n.conversationID,l=n.lastMessageSeq,h=n.lastMessageTime,v=this._messageListHandler.getLocalMessageList(s);if(v.length!==0){for(var I,k=v.length-1;0<=k;k--)if(I=v[k],!(h&&I.time>h||l&&I.sequence>l)){if(I.flow==="in"&&I.isRead)break;I.setIsRead(!0)}}}},{key:"updateUnreadCount",value:function(n){var s,l=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],h=!1,v=this.getLocalConversation(n),I=this._messageListHandler.getLocalMessageList(n);if(v)return(s=v.unreadCount)!==(I=I.filter(function(k){return!k.isRead&&!k._onlineOnlyFlag&&!k.isDeleted}).length)&&(v.unreadCount=I,h=!0,q.l("".concat(this._n,".updateUnreadCount from ").concat(s," to ").concat(I,", conversationID:").concat(n)),l===!0&&this.emitConversationUpdate(!0,!1)),h&&v.type===O.CONV_TOPIC&&(s=v.unreadCount,I=this.get(10),l=n.replace(O.CONV_GROUP,""),I.onConversationProxy({topicID:l,unreadCount:s})),h}},{key:"clearGroupAtInfoList",value:function(n){var s,l=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],h=this.getLocalConversation(n);h&&0<h.groupAtInfoList.length&&(h.clearGroupAtInfoList(),q.l("".concat(this._n,".clearGroupAtInfoList conversationID:").concat(n)),h.type===O.CONV_TOPIC&&(h=h.groupAtInfoList,s=this.get(10),n=n.replace(O.CONV_GROUP,""),s.onConversationProxy({topicID:n,groupAtInfoList:h})),l===!0&&this.emitConversationUpdate(!0,!1))}},{key:"updateReadReceiptInfo",value:function(n){var s,l,h,v=this,P=n.userID,I=P===void 0?void 0:P,P=n.groupID,k=P===void 0?void 0:P,P=n.readReceiptList;Ct(P)||(s=[],Qe(I)?Qe(k)||(l="".concat(O.CONV_GROUP).concat(k),P.forEach(function(te){var pe=te.tinyID,ye=te.clientTime,ve=te.random,Y=te.readCount,te=te.unreadCount,pe="".concat(pe,"-").concat(ye,"-").concat(ve),ye=v._messageListHandler.getLocalMessage(l,pe)||v._messageListHandler.getHoppingMessage(l,pe),ve={groupID:k,messageID:pe,readCount:0,unreadCount:0};ye&&(un(Y)&&(ye.readReceiptInfo.readCount=Y,ve.readCount=Y),un(te)&&(ye.readReceiptInfo.unreadCount=te,ve.unreadCount=te),s.push(ve))})):(h="".concat(O.CONV_C2C).concat(I),P.forEach(function(Y){var te=Y.tinyID,pe=Y.clientTime,Y=Y.random,te="".concat(te,"-").concat(pe,"-").concat(Y),pe=v._messageListHandler.getLocalMessage(h,te)||v._messageListHandler.getHoppingMessage(h,te);pe&&!pe.readReceiptInfo.isPeerRead&&(pe.readReceiptInfo.isPeerRead=!0,s.push({userID:I,messageID:te,isPeerRead:!0}))})),0<s.length&&this.emitOuterEvent($.MESSAGE_READ_RECEIPT_RECEIVED,s))}},{key:"updateIsRead",value:function(n){var s=this.getLocalConversation(n),l=this.getLocalMessageList(n);if(s&&l.length!==0&&!ap(s.type)){for(var h=[],v=0,I=l.length;v<I;v++)l[v].flow!=="in"?l[v].flow!=="out"||l[v].isRead||l[v].setIsRead(!0):h.push(l[v]);var k=0;k=s.type===O.CONV_C2C?(n=h.slice(-s.unreadCount).filter(function(G){return G.isRevoked}).length,h.length-s.unreadCount-n):h.length-s.unreadCount;for(var P=0;P<k&&!h[P].isRead;P++)h[P].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(n){var s=this,l="".concat(this._n,".deleteGroupAtTips"),v=(q.l("".concat(l)),this._conversationMap.get(n));if(!v)return Promise.resolve();var h=v.groupAtInfoList;if(h.length===0)return Promise.resolve();var v=void 0,I=(n.startsWith(O.CONV_GROUP)&&(v=n.replace(O.CONV_GROUP,"")),L(h));if((Dr({groupID:v})||Qo(v))&&(I=h.filter(function(P){return!P.atTypeArray.includes(O.CONV_AT_ALL)})).length===0)return this.clearGroupAtInfoList(n,!1),Promise.resolve();var k=this.getMyUserID();return this.req({proto:fe.DEL_GROUP_AT_TIPS,data:{messageListToDelete:I.map(function(P){return{from:P.from,to:k,messageSeq:P.__sequence,messageRandom:P.__random,groupID:Qe(P.topicID)?P.groupID:P.topicID}})}}).then(function(){return q.l("".concat(l," ok. count:").concat(h.length)),s.clearGroupAtInfoList(n,!1),Promise.resolve()}).catch(function(P){return q.e("".concat(l," failed. error:"),P),Re(P)})}},{key:"appendToMessageList",value:function(n){return this._messageListHandler.pushIn(n)}},{key:"setMessageRandom",value:function(n){this.singlyLinkedList.set(n.random)}},{key:"deleteMessageRandom",value:function(n){this.singlyLinkedList.delete(n.random)}},{key:"pushIntoMessageList",value:function(n,s,l){return!(!this._messageListHandler.pushIn(s,l)||this._isMessageFromCurrentInstance(s)&&!l||(n.push(s),0))}},{key:"_isMessageFromCurrentInstance",value:function(n){return this.singlyLinkedList.has(n.random)}},{key:"revoke",value:function(n,s,l){return this._messageListHandler.revoke(n,s,l)}},{key:"getPeerReadTime",value:function(n){return this._peerReadTimeMap.get(n)}},{key:"recordPeerReadTime",value:function(n,s){(!this._peerReadTimeMap.has(n)||this._peerReadTimeMap.get(n)<s)&&this._peerReadTimeMap.set(n,s)}},{key:"updateMessageIsPeerReadProperty",value:function(n,s){var l;n.startsWith(O.CONV_C2C)&&0<s&&(0<(l=this._messageListHandler.updateMessageIsPeerReadProperty(n,s)).length&&this.emitOuterEvent($.MESSAGE_READ_BY_PEER,l),this._conversationMap.has(n)&&(Ct(l=this._conversationMap.get(n).lastMessage)||l.fromAccount===this.getMyUserID()&&l.lastTime<=s&&!l.isPeerRead&&(l.isPeerRead=!0,this.emitConversationUpdate(!0,!1))))}},{key:"updateMessageIsModifiedProperty",value:function(n){this._messageListHandler.updateMessageIsModifiedProperty(n)}},{key:"setCompleted",value:function(n){q.l("".concat(this._n,".setCompleted. conversationID:").concat(n)),this._completedMap.set(n,!0)}},{key:"updateRoamingMessageKeyAndTime",value:function(n,s,l){this._roamingMessageKeyAndTimeMap.set(n,{messageKey:s,lastMessageTime:l})}},{key:"updateRoamingMessageSequence",value:function(n,s){this._roamingMessageSequenceMap.set(n,s)}},{key:"getConversationList",value:function(n){var s,l=this,h="".concat(this._n,".").concat("getConversationList"),v="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._conversationMap.size,", options:").concat(JSON.stringify(n));return q.l("".concat(h,". ").concat(v)),this._pagingStatus===$c?((s=new it("getConversationList")).setMessage(v),this.syncConversationList().then(function(){s.end();var I=l._getConversationList(n);return Ut({conversationList:I,isSyncCompleted:l._isSyncCompleted()})}).catch(function(I){return s.setError(I).end(),q.e("".concat(h," failed. error:"),I),Re(I)})):(v=this._getConversationList(n),q.l("".concat(h,". returned conversation count:").concat(v.length)),ln({conversationList:v,isSyncCompleted:this._isSyncCompleted()}))}},{key:"_getConversationList",value:function(n){var s,l,h,v,I,k=this;return Qe(n)?this.getLocalConversationList():Rt(n)?n.length===0?[]:this.getLocalConversationList().filter(function(P){return n.includes(P.conversationID)}):xn(n)?(s=n.type,l=n.markType,h=n.groupName,v=n.hasUnreadCount,I=n.hasGroupAtInfo,this.getLocalConversationList().filter(function(P){return k._filterType(P,s)&&k._filterMarkType(P,l)&&k._filterGroupName(P,h)&&k._filterUnreadCount(P,v)&&k._filterGroupAtInfo(P,I)})):[]}},{key:"_filterType",value:function(n,s){return s!==O.CONV_C2C&&s!==O.CONV_GROUP||n.type===s}},{key:"_filterGroupName",value:function(n,s){return!Sn(s)||(s===""?n.conversationGroupList.length===0:n.conversationGroupList.includes(s))}},{key:"_filterMarkType",value:function(n,s){return!un(s)||(s===0?n.markList.length===0:n.markList.includes(s))}},{key:"_filterUnreadCount",value:function(n,s){var l=!0;return s===!0?l=1<=n.unreadCount:s===!1&&(l=n.unreadCount===0),l}},{key:"_filterGroupAtInfo",value:function(n,s){var l=!0;return s===!0?l=1<=n.groupAtInfoList.length:s===!1&&(l=n.groupAtInfoList.length===0),l}},{key:"_handleC2CPeerReadTime",value:function(){var n,s=Z(this._conversationMap);try{for(s.s();!(n=s.n()).done;){var l=x(n.value,2),h=l[0],v=l[1];v.type===O.CONV_C2C&&(q.d("".concat(this._n,"._handleC2CPeerReadTime conversationID:").concat(h," peerReadTime:").concat(v.peerReadTime)),this.recordPeerReadTime(h,v.peerReadTime))}}catch(I){s.e(I)}finally{s.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var n=this.get(7);return!n||n.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var n=this.get(7);return n?n.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(n){var s=this.get(7);return!!s&&s.hasLocalGroup(n.replace(O.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(n){var s,l=this;if((s=this._conversationMap.has(n)?this._conversationMap.get(n):new Ip({conversationID:n,type:n.slice(0,3)===O.CONV_C2C?O.CONV_C2C:O.CONV_GROUP},this.isIntl(),this.isUsingChatCore()))._isInfoCompleted||s.type===O.CONV_SYSTEM)return ln({conversation:s});if(fr(n)&&!this._hasLocalGroup(n))return ln({conversation:s});var h="".concat(this._n,".").concat("getConversationProfile"),v=new it("getConversationProfile");return q.l("".concat(h,". conversationID:").concat(n," remark:").concat(s.remark," lastMessage:"),s.lastMessage),this._updateUserOrGroupProfileCompletely(s).then(function(I){v.setMessage("conversationID:".concat(n," unreadCount:").concat(I.data.conversation.unreadCount)).end();var k,P=l.get(8);return P&&s.type===O.CONV_C2C&&(k=n.replace(O.CONV_C2C,""),P.isMyFriend(k)&&(P=P.getFriendRemark(k),s.remark!==P&&(s.remark=P,q.l("".concat(h,". conversationID:").concat(n," patch remark:").concat(s.remark))))),q.l("".concat(h," ok. conversationID:").concat(n)),I}).catch(function(I){return v.setError(I).setMessage("conversationID:".concat(n)).end(),q.e("".concat(h," failed. error:"),I),Re(I)})}},{key:"_updateUserOrGroupProfileCompletely",value:function(n){var s=this;return n.type===O.CONV_C2C?this.get(4).getUserProfile({userIDList:[n.toAccount]}).then(function(l){return l=l.data,l.length===0?Re(new so({code:Be.USER_OR_GRP_NOT_FOUND})):(n.userProfile=l[0],n._isInfoCompleted=!0,s._unshiftConversation(n),ln({conversation:n}))}):this.get(7).getGroupProfile({groupID:n.toAccount}).then(function(l){return n.groupProfile=l.data.group,n._isInfoCompleted=!0,s._unshiftConversation(n),ln({conversation:n})})}},{key:"_unshiftConversation",value:function(n){n instanceof Ip&&!this._conversationMap.has(n.conversationID)&&(this._conversationMap=new Map([[n.conversationID,n]].concat(L(this._conversationMap))),this._setStorageConversationList(),this.emitConversationUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(n){var s=this;n.data.forEach(function(l){var h=l.userID;h===s.getMyUserID()?s._onMyProfileModified({latestNick:l.nick,latestAvatar:l.avatar}):(h=s._conversationMap.get("".concat(O.CONV_C2C).concat(h)))&&(h.userProfile=l)})}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===Hd}},{key:"_errorLog",value:function(n,s,l,h){var v=new Error("Params validate failed."),I="".concat(this.getErrorMessage("API_REFER")).concat(n);throw q.w("[".concat(n,"] | ").concat(s," | ").concat(this.getErrorMessage(l,h),", ").concat(I)),q.e("[".concat(n,"] Invalid ").concat(s,": type check failed for ").concat(s,".")),v}},{key:"_isValidConversationID",value:function(n){return Pr(n)||fr(n)||ap(n)}},{key:"deleteConversation",value:function(n){var s=this,l="deleteConversation";return Sn(n)||hr(n)||this._errorLog(l,"options","StringOrObjectRequiredLog"),Sn(n)?(this._isValidConversationID(n)||this._errorLog(l,"options","InvalidConversationID",n),q.l("".concat(this._n,".").concat(l," conversationID:").concat(n)),this.deleteConversationList({conversationIDList:[n],flag:1})):(Rt(n.conversationIDList)||this._errorLog(l,"conversationIDList","ArrayRequiredLog"),n.conversationIDList.length===0&&this._errorLog(l,"conversationIDList","NonEmptyArrayLog"),n.conversationIDList.forEach(function(h){s._isValidConversationID(h)||s._errorLog(l,"conversationIDList","InvalidConversationID",h)}),"clearHistoryMessage"in n&&typeof n.clearHistoryMessage!="boolean"&&this._errorLog(l,"clearHistoryMessage","BooleanRequiredLog"),100<n.conversationIDList.length&&(n.conversationIDList=n.conversationIDList.slice(0,100)),this.deleteConversationList(n))}},{key:"deleteConversationList",value:function(h){var s=h.conversationIDList,s=s===void 0?[]:s,l=h.clearHistoryMessage,l=l===void 0||l,h=h.flag,v=h===void 0?0:h,I="".concat(this._n,".").concat("deleteConversationList"),k=(q.l("".concat(I," conversationIDList.length:").concat(s.length," clearHistoryMessage:").concat(l)),new it("deleteConversationList"));return k.setMessage("conversationIDList:".concat(s)),Promise.all([this.rmLocalOnlyConversationList(s),this.rmLocalAndRemoteConversationList(s,l)]).then(function(P){return k.end(),P=[].concat(L(P[0]),L(P[1])),P.length===0?Re(new so({code:Be.CONV_NOT_FOUND})):(q.l("".concat(I," ok")),ln(v===1?{conversationID:P[0]}:{conversationIDList:P}))}).catch(function(P){return k.setError(P).end(),q.e("".concat(I," failed. error:"),P),Re(P)})}},{key:"rmLocalOnlyConversationList",value:function(n){var s=this;return n.filter(function(l){if(!s._conversationMap.has(l))return!1;var h=s.getLocalConversation(l).type;return h!==O.CONV_GROUP||s._hasLocalGroup(l)?h===O.CONV_SYSTEM&&(s.get(7).deleteGroupSystemNotice({messageList:s._messageListHandler.getLocalMessageList(l)}),s.deleteLocalConversation(l),!0):(s.deleteLocalConversation(l),!0)})}},{key:"rmLocalAndRemoteConversationList",value:function(n,s){var l=this,h={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:s?1:0};return n.forEach(function(v){var I;l._conversationMap.has(v)&&((I=l.getLocalConversation(v).type)===O.CONV_C2C?h.conversationList.push({toAccount:v.replace(I,""),type:1}):I===O.CONV_GROUP&&l._hasLocalGroup(v)&&h.conversationList.push({toGroupID:v.replace(I,""),type:2}))}),h.conversationList.length===0?[]:this.req({proto:fe.DEL_CONV,data:h}).then(function(v){var I=[];return 0<v.data.resultList.length&&v.data.resultList.map(function(k){k.code===0&&(k=k.type===1?"".concat(O.CONV_C2C).concat(k.to):"".concat(O.CONV_GROUP).concat(k.groupID),I.push(k))}),l.deleteLocalConversationList(I),I})}},{key:"setConversationDraft",value:function(l){var s=l.conversationID,l=l.draftText,h="".concat(this._n,".").concat("setConversationDraft");return q.l("".concat(h," conversationID:").concat(s," draftText:").concat(l)),this._conversationMap.has(s)?(h=this._conversationMap.get(s),h.setDraftText(l),ln({code:0,conversation:h})):Re({code:Be.CONV_NOT_FOUND})}},{key:"clearHistoryMessage",value:function(n){var s=this,l={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(n))return Re({code:Be.CONV_NOT_FOUND});var h=this._conversationMap.get(n).type;if(h===O.CONV_C2C)l.type=1,l.toAccount=n.replace(O.CONV_C2C,"");else{if(h!==O.CONV_GROUP)return h===O.CONV_SYSTEM?(this.get(7).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(n)}),ln({conversationID:n})):Re({code:Be.CONV_UN_RECORDED_TYPE});l.type=2,l.toGroupID=n.replace(O.CONV_GROUP,"")}var v="".concat(this._n,".").concat("clearHistoryMessage"),I=new it("clearHistoryMessage");return I.setMessage("conversationID:".concat(n)),q.l("".concat(v,". conversationID:").concat(n)),this.setMessageRead({conversationID:n}).then(function(){return s.req({proto:fe.CLEAR_HISTORY_MSG,data:l})}).then(function(){I.end(),q.l("".concat(v," ok")),s._messageListHandler.removeByConversationID(n),s.setCompleted(n);var k=s.getLocalConversation(n);return k&&(k.updateLastMessage(),s._sortConversationListAndEmitEvent()),ln({conversationID:n})}).catch(function(k){return I.setError(k).end(),q.e("".concat(v," failed. error:"),k),Re(k)})}},{key:"pinConversation",value:function(P){var s=this,l=P.conversationID,h=P.isPinned;if(!this._conversationMap.has(l))return Re({code:Be.CONV_NOT_FOUND});var v=this.getLocalConversation(l);if(v.isPinned===h)return ln({conversationID:l});var I="".concat(this._n,".").concat("pinConversation"),k=new it("pinConversation"),P=(k.setMessage("conversationID:".concat(l," isPinned:").concat(h)),q.l("".concat(I,". conversationID:").concat(l," isPinned:").concat(h)),null);return Pr(l)?P={type:1,toAccount:l.replace(O.CONV_C2C,"")}:fr(l)&&(P={type:2,groupID:l.replace(O.CONV_GROUP,"")}),this.req({proto:fe.PIN_CONV,data:{fromAccount:this.getMyUserID(),operationType:h===!0?1:2,itemList:[P]}}).then(function(){return k.end(),q.l("".concat(I," ok")),v.isPinned!==h&&(v.isPinned=h,s._sortConversationListAndEmitEvent()),Ut({conversationID:l})}).catch(function(G){return k.setError(G).end(),q.e("".concat(I," failed. error:"),G),Re(G)})}},{key:"setMessageRemindType",value:function(n){return this._messageRemindHandler.set(n)}},{key:"patchMessageRemindType",value:function(n){var s=n.ID,v=n.isC2CConversation,l=n.messageRemindType,h=!1,v=this.getLocalConversation("".concat(v?O.CONV_C2C:O.CONV_GROUP).concat(s));return v&&v.messageRemindType!==l&&(v.messageRemindType=l,h=!0),q.d("".concat(this._n,".patchMessageRemindType options:"),n,"ret:".concat(h)),h}},{key:"onC2CMessageRemindTypeFetched",value:function(n){var s,l=this;Rt(n)&&0<n.length&&(s=0,n.forEach(function(I){var v=I.userID,I=I.muteFlag,I=l._transMessageRemindType(I);l.patchMessageRemindType({ID:v,isC2CConversation:!0,messageRemindType:I})===!0&&(s+=1)}),q.l("".concat(this._n,".onC2CMessageRemindTypeFetched updateCount:").concat(s)),1<=s&&this.emitConversationUpdate(!0,!1))}},{key:"onC2CMessageRemindTypeSynced",value:function(n){var s=this,l="".concat(this._n,".onC2CMessageRemindTypeSynced");q.d(l,n),n.dataList.forEach(function(h){var v;Ct(h.muteNotificationsSync)||(v=(h=h.muteNotificationsSync).to,h=h.muteFlag,h=s._transMessageRemindType(h),s.patchMessageRemindType({ID:v,isC2CConversation:!(v=0),messageRemindType:h})&&(v+=1),q.l("".concat(l," updateCount:").concat(v)),1<=v&&s.emitConversationUpdate(!0,!1))})}},{key:"onGroupMessageRemindTypeUpdated",value:function(n){q.d("".concat(this._n,".onGroupMessageRemindTypeUpdated options:"),n),this._messageRemindHandler.onGroupMessageRemindTypeUpdated(n)}},{key:"deleteLocalConversation",value:function(n){var s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],l=this._conversationMap.has(n);q.l("".concat(this._n,".deleteLocalConversation conversationID:").concat(n," has:").concat(l)),l&&(this._conversationMap.delete(n),this._roamingMessageKeyAndTimeMap.has(n)&&this._roamingMessageKeyAndTimeMap.delete(n),this._roamingMessageSequenceMap.has(n)&&this._roamingMessageSequenceMap.delete(n),this._setStorageConversationList(),this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),s)&&(l=!this._isTopicConversation(n),this.emitConversationUpdate(l,!1))}},{key:"recoverMessageOnInviteGroup",value:function(n){var s,l,h,v,I=this.get(7);I&&(v=this.getLocalLastMessage(n),s=this.getLocalSecondLastMessage(n),h=l=1,v&&(l=v.sequence),s&&(h=s.sequence),v=I.getGroupRemoteLastSeq(n.replace(O.CONV_GROUP,"")),q.l("".concat(this._n,".recoverMessageOnInviteGroup conversationID:").concat(n," localLastSeq:").concat(l," localSecondLastSeq:").concat(h)+" remoteLastSeq:".concat(v)),this._roamingMessageSequenceMap.has(n)&&this._roamingMessageSequenceMap.delete(n),this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),1<l-h?this._recursiveGetMessageList([],n,!1,l,h):1<v-l&&this._recursiveGetMessageList([],n,!0,v,l))}},{key:"_recursiveGetMessageList",value:function(n,s,l,h,v,I){var k=this;this.getMessageList({conversationID:s,nextReqMessageID:I}).then(function(G){var G=G.data.messageList,Y=G.filter(function(te){return l?te.sequence>v&&te.sequence<=h:te.sequence>v&&te.sequence<h});n.unshift.apply(n,L(Y)),0<G.length&&G[0].sequence>v&&n.length<100?k._recursiveGetMessageList(n,s,l,h,v,G[0].ID):k._emitMessageReceived(s,n)})}},{key:"_emitMessageReceived",value:function(n,s){var l,h=this;0<s.length&&(l=this.hasLocalConversation(n),q.l("".concat(this._n,"._emitMessageReceived conversationID:").concat(n," has:").concat(l," sequenceList:"),s.map(function(v){return v.sequence})),this.emitOuterEvent($.MESSAGE_RECEIVED,s),l?this.patchConversationLastMessage(n,!0):this.getConversationProfile(n).then(function(){h.patchConversationLastMessage(n,!0)}))}},{key:"deleteLocalConversationList",value:function(n){var s=this,l=!1;n.forEach(function(h){s._conversationMap.has(h)&&(s.deleteLocalConversation(h,!1),l=!0)}),q.l("".concat(this._n,".deleteLocalConversationList conversationIDList.length:").concat(n.length," isConvIDExisted:").concat(l)),l&&this.emitConversationUpdate(!0,!1)}},{key:"isMessageSentByCurrentInstance",value:function(n){return!(!this._messageListHandler.hasLocalMessage(n.conversationID,n.ID)&&!this.singlyLinkedList.has(n.random))}},{key:"modifyMessageList",value:function(n){var s,l;n.startsWith(O.CONV_C2C)&&this._conversationMap.has(n)&&(l=this._conversationMap.get(n),s=Date.now(),this._messageListHandler.modifyMessageSentByPeer({conversationID:n,latestNick:l.userProfile.nick,latestAvatar:l.userProfile.avatar}),l=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),this._messageListHandler.modifyMessageSentByMe({conversationID:n,latestNick:l.nick,latestAvatar:l.avatar}),q.l("".concat(this._n,".modifyMessageList conversationID:").concat(n," cost:").concat(ar(s))))}},{key:"updateUserProfileSpecifiedKey",value:function(h){q.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),h);var s=h.conversationID,l=h.nick,h=h.avatar;this._conversationMap.has(s)&&(s=this._conversationMap.get(s).userProfile,Sn(l)&&s.nick!==l&&(s.nick=l),Sn(h)&&s.avatar!==h&&(s.avatar=h),this.emitConversationUpdate(!0,!1))}},{key:"_onMyProfileModified",value:function(n){var s=this,l=this.getLocalConversationList(),h=Date.now();l.forEach(function(v){s.modifyMessageSentByMe(i({conversationID:v.conversationID},n))}),q.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat(ar(h)))}},{key:"modifyMessageSentByMe",value:function(n){this._messageListHandler.modifyMessageSentByMe(n)}},{key:"getLatestMessageSentByMe",value:function(n){return this._messageListHandler.getLatestMessageSentByMe(n)}},{key:"modifyMessageSentByPeer",value:function(n){this._messageListHandler.modifyMessageSentByPeer(n)}},{key:"getLatestMessageSentByPeer",value:function(n){return this._messageListHandler.getLatestMessageSentByPeer(n)}},{key:"pushIntoNoticeResult",value:function(n,s){return!(!this._messageListHandler.pushIn(s)||this.singlyLinkedList.has(s.random)||(n.push(s),0))}},{key:"getLocalLastMessage",value:function(n){return this._messageListHandler.getLocalLastMessage(n)}},{key:"getLocalSecondLastMessage",value:function(n){return this._messageListHandler.getLocalSecondLastMessage(n)}},{key:"checkAndPatchRemark",value:function(){var n,s,l=this.get(8);this._conversationMap.size===0||!l||(n=L(this._conversationMap.values()).filter(function(h){return h.type===O.CONV_C2C})).length!==0&&(s=0,n.forEach(function(h){var v=h.conversationID.replace(O.CONV_C2C,"");l.isMyFriend(v)&&(v=l.getFriendRemark(v),h.remark!==v&&(h.remark=v,s+=1))}),q.l("".concat(this._n,".checkAndPatchRemark. c2c conversation count:").concat(n.length,", patched count:").concat(s)))}},{key:"updateTopicConversation",value:function(n){this._updateLocalConversationList({conversationOptionsList:n,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(n){var s=n[0],l=null;return s.conversationType===O.CONV_C2C?l=this._m.get(6):s.conversationType===O.CONV_GROUP&&(l=this._m.get(7)),l?l.sendReadReceipt(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getReadReceiptList",value:function(n){var s=n[0],l=null;return s.conversationType===O.CONV_C2C?l=this._m.get(6):s.conversationType===O.CONV_GROUP&&(l=this._m.get(7)),l?l.getReadReceiptList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getLastMessageTime",value:function(n){return n=this.getLocalConversation(n),n?n.lastMessage.lastTime:0}},{key:"getTotalUnreadMessageCount",value:function(){var n=this.getLocalConversationList(),s=0;return n.forEach(function(l){l.type!==O.CONV_SYSTEM&&(l.messageRemindType!==""&&l.messageRemindType!==O.MSG_REMIND_ACPT_AND_NOTE||(s+=l.unreadCount))}),s}},{key:"emitTotalUnreadMessageCountUpdate",value:function(){var n=this.getTotalUnreadMessageCount();this._convTotalUnreadCount!==n&&(q.l("".concat(this._n,".emitTotalUnreadMessageCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(n)),this._convTotalUnreadCount=n,this.emitOuterEvent($.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"_isConvNeedShow",value:function(h){if(h=this.getLocalConversation(h),Qe(h))return!0;var s=h.type===O.CONV_TOPIC,l=h.type===O.CONV_GROUP&&h.groupProfile.type===O.GRP_ROOM,h=h.type===O.CONV_GROUP&&h.groupProfile.type===O.GRP_LIVE;return!(s||l||h)}},{key:"setAllReceiveMessageOpt",value:function(n){return this._messageRemindHandler.setAllReceiveMessageOpt(n)}},{key:"getAllReceiveMessageOpt",value:function(){return this._messageRemindHandler.getAllReceiveMessageOpt()}},{key:"onAllReceiveMessageOptNotify",value:function(n){this._messageRemindHandler.onAllReceiveMessageOptNotify(n)}},{key:"clearUnreadCount",value:function(n){n=this.getLocalConversation(n),n&&0<n.unreadCount&&(n.unreadCount=0,this.emitConversationUpdate(!0,!1))}},{key:"storeHoppingMessageList",value:function(n){this._messageListHandler.storeHoppingMessageList(n)}},{key:"getHoppingMessage",value:function(n,s){return this._messageListHandler.getHoppingMessage(n,s)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._setStorageConversationList(!0),this._pagingStatus=ws,this._messageListHandler.reset(),this._messageRemindHandler.reset(),this._roamingMessageKeyAndTimeMap.clear(),this._roamingMessageSequenceMap.clear(),this.singlyLinkedList.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._conversationMap.clear(),this._pagingTimeStamp=0,this._pagingStartIndex=0,this._pagingPinnedTimeStamp=0,this._pagingPinnedStartIndex=0,this._remoteGroupReadSequenceMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this._convMapForDiff.clear(),this._partialUpdatedConvMap.clear(),this.resetReady()}}]),Wc),ji=(p(Lv,[{key:"onCheckTimer",value:function(n){n%1==0&&0<this._cachedGroupTipsMap.size&&this._checkCachedGroupTips()}},{key:"_checkCachedGroupTips",value:function(){var n=this;this._cachedGroupTipsMap.forEach(function(s,l){var h=n._checkCountMap.get(l),v=n._grpM.hasLocalGroup(l);q.l("".concat(n._n,"._checkCachedGroupTips groupID:").concat(l," hasLocalGroup:").concat(v," checkCount:").concat(h)),v?(n._notifyCachedGroupTips(l),n._checkCountMap.delete(l),n._grpM.deleteUnjoinedAVChatRoom(l)):h>=n.MAX_CHECK_COUNT?(n._deleteCachedGroupTips(l),n._checkCountMap.delete(l)):n._checkCountMap.set(l,++h)})}},{key:"onNewGroupTips",value:function(h){q.l("".concat(this._n,".onNewGroupTips options:").concat(JSON.stringify(h.dataList)));var h=this.newGroupTipsStoredAndSummary(h),s=h.eventDataList,l=h.result,h=h.AVChatRoomMessageList;0<h.length&&this._grpM.onAVChatRoomMessage(h),0<s.length&&(this._grpM.updateNextMessageSeq(s),this._grpM.get(11).onNewMessage({conversationOptionsList:s,isInstantMessage:!0})),0<l.length&&(this._grpM.emitOuterEvent($.MESSAGE_RECEIVED,l),this.handleMessageList(l))}},{key:"newGroupTipsStoredAndSummary",value:function(n){for(var s=n.event,l=n.dataList,h=null,v=[],I=[],k={},P=[],G=0,Y=l.length;G<Y;G++){var te=Ni(l[G]);if(!(s===6&&(this._grpM.isGroupAttributesUpdatedNotice(te)||this._grpM.isGroupCountersNotice(te)))){var Ue=te.groupProfile,pe=Ue.groupID,ye=Ue.communityType,ye=ye===void 0?0:ye,ve=Ue.topicID,ve=ve===void 0?void 0:ve,Ue=Ue.invisible,ut=void 0,mt=this._grpM.isMessageFromTopic(ye,ve),Kt=(mt&&(ut=O.CONV_TOPIC,te.to=ve),this._grpM.hasLocalGroup(pe));if(Kt||!this._grpM.isUnjoinedAVChatRoom(pe))if(Kt||mt)if(this._grpM.isMessageFromOrToAVChatroom(pe))te.event=s,P.push(te);else if(te.currentUser=this._grpM.getMyUserID(),te.conversationType=O.CONV_GROUP,(h=new er(te)).setElement({type:O.MSG_GRP_TIP,content:i(i({},te.elements),{},{groupProfile:te.groupProfile})}),h.isSystemMessage=!1,Ue!==1){var Kt=this._grpM.get(11),mt=h,Ue=mt.conversationID,mt=mt.sequence;if(s===6)h._onlineOnlyFlag=!0,I.push(h);else if(!Kt.pushIntoNoticeResult(I,h))continue;this._grpM.isMessageFromCommunityOfTopic(ye,ve)||s===6&&Kt.getLocalConversation(Ue)||(s!==6&&this._qualityStat(h),ye=Kt.isRemoteRead({conversationID:Ue,sequence:mt}),Qe(k[Ue])?(ve=0,h.flow==="in"&&(h._isExcludedFromUnreadCount||h._onlineOnlyFlag||ye||(ve=1)),k[Ue]=v.push({conversationID:Ue,unreadCount:ve,type:Qe(ut)?h.conversationType:ut,subType:h.conversationSubType,lastMessage:h._isExcludedFromLastMessage?"":h})-1):(v[Kt=k[Ue]].type=h.conversationType,v[Kt].subType=h.conversationSubType,v[Kt].lastMessage=h._isExcludedFromLastMessage?"":h,h.flow==="in"&&(h._isExcludedFromUnreadCount||h._onlineOnlyFlag||ye||v[Kt].unreadCount++)))}else this._qualityStat(h);else this._cacheGroupTipsAndProbe({groupID:pe,event:s,item:te})}}return{eventDataList:v,result:I,AVChatRoomMessageList:P}}},{key:"_qualityStat",value:function(n){this._grpM.get(26).addMessageSequence({key:Hc,message:n})}},{key:"handleMessageList",value:function(n){var s=this;n.forEach(function(l){switch(l.payload.operationType){case 1:s._onNewMemberComeIn(l);break;case 2:s._onMemberQuit(l);break;case 3:s._onMemberKickedOut(l);break;case 4:s._onMemberSetAdmin(l);break;case 5:s._onMemberCancelledAdmin(l);break;case 6:s._onGroupProfileModified(l);break;case 7:s._onMemberInfoModified(l);break;case 8:s._onTopicProfileUpdated(l);break;default:q.w("".concat(s._n,".handleMessageList unknown operationType:").concat(l.payload.operationType))}})}},{key:"_onNewMemberComeIn",value:function(l){var l=l.payload,s=l.memberNum,l=l.groupProfile.groupID,l=this._grpM.getLocalGroupProfile(l);l&&un(s)&&l.memberCount!==s&&(l.memberCount=s,this._updateConversationGroupProfile(l))}},{key:"_onMemberQuit",value:function(n){var l=n.payload,s=l.memberNum,l=l.groupProfile.groupID,h=this._grpM.getLocalGroupProfile(l);h&&un(s)&&h.memberCount!==s&&(h.memberCount=s,this._updateConversationGroupProfile(h)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(l,n.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(n){var l=n.payload,s=l.memberNum,l=l.groupProfile.groupID,h=this._grpM.getLocalGroupProfile(l);h&&un(s)&&h.memberCount!==s&&(h.memberCount=s,this._updateConversationGroupProfile(h)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(l,n.payload.userIDList)}},{key:"_updateConversationGroupProfile",value:function(n){this._grpM.get(11).updateConversationGroupProfile([n])}},{key:"_onMemberSetAdmin",value:function(l){var s=l.payload.groupProfile.groupID,l=l.payload.userIDList,h=this._grpM.getGroupMemberHandler();l.forEach(function(v){v=h.getLocalGroupMemberInfo(s,v),v&&v.updateRole(O.GRP_MBR_ROLE_ADMIN)})}},{key:"_onMemberCancelledAdmin",value:function(l){var s=l.payload.groupProfile.groupID,l=l.payload.userIDList,h=this._grpM.getGroupMemberHandler();l.forEach(function(v){v=h.getLocalGroupMemberInfo(s,v),v&&v.updateRole(O.GRP_MBR_ROLE_MEMBER)})}},{key:"_onGroupProfileModified",value:function(v){var s=this,v=v.payload,l=v.newGroupProfile,v=v.groupProfile.groupID,h=this._grpM.getLocalGroupProfile(v),v=(Object.keys(l).forEach(function(I){switch(I){case"ownerID":s._ownerChanged(h,l);break;case"groupName":h.name=l[I];break;default:h[I]=l[I]}}),!h.isSupportTopic);this._grpM.emitGroupListUpdate(!0,v)}},{key:"_ownerChanged",value:function(l,s){var l=l.groupID,h=this._grpM.getLocalGroupProfile(l),v=this._grpM.getMyUserID();v===s.ownerID&&(h.updateGroup({selfInfo:{role:O.GRP_MBR_ROLE_OWNER}}),h=(s=this._grpM.getGroupMemberHandler()).getLocalGroupMemberInfo(l,v),v=this._grpM.getLocalGroupProfile(l).ownerID,s=s.getLocalGroupMemberInfo(l,v),h&&h.updateRole(O.GRP_MBR_ROLE_OWNER),s&&s.updateRole(O.GRP_MBR_ROLE_MEMBER))}},{key:"_onMemberInfoModified",value:function(n){var s=n.to,h=n.payload,l=h.groupProfile,h=h.memberList,v=l.groupID,I=(Qo(s)&&this._updateTopicMuteTime(n),this._grpM.getGroupMemberHandler());h.forEach(function(k){var P=I.getLocalGroupMemberInfo(v,k.userID);P&&un(k.muteTime)&&P.updateMuteUntil(k.muteTime)})}},{key:"_updateTopicMuteTime",value:function(h){var s=h.to,h=h.payload,v=h.groupProfile,h=h.memberList,l=h===void 0?[]:h,h=this._grpM.get(10),v=v.groupID,I=h.getLocalTopic(v,s);if(I){for(var k=!1,P=0;P<l.length;P++){var G=l[P];if(G.userID===this._grpM.getMyUserID()&&0<=G.muteTime){I.updateSelfInfo({muteTime:G.muteTime}),k=!0;break}}k&&this._grpM.emitOuterEvent($.TOPIC_UPDATED,{groupID:v,topic:I})}}},{key:"_onTopicProfileUpdated",value:function(n){var l=n.payload,s=l.groupProfile.groupID,l=l.newTopicInfo;this._grpM.get(10).onTopicProfileUpdated(i({groupID:s,topicID:n.to},l))}},{key:"_cacheGroupTips",value:function(n,s){this._cachedGroupTipsMap.has(n)||this._cachedGroupTipsMap.set(n,[]),this._cachedGroupTipsMap.get(n).push(s)}},{key:"_deleteCachedGroupTips",value:function(n){this._cachedGroupTipsMap.has(n)&&this._cachedGroupTipsMap.delete(n)}},{key:"_notifyCachedGroupTips",value:function(n){var s=this,l=this._cachedGroupTipsMap.get(n)||[];l.forEach(function(h){s.onNewGroupTips(h)}),this._deleteCachedGroupTips(n),q.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(n," count:").concat(l.length))}},{key:"_cacheGroupTipsAndProbe",value:function(v){var s=this,l=v.groupID,h=v.event,v=v.item;this._cacheGroupTips(l,{event:h,dataList:[v]}),this._grpM.getGroupSimplifiedInfo(l).then(function(I){I.type===O.GRP_AVCHATROOM?s._grpM.hasLocalGroup(l)?s._notifyCachedGroupTips(l):s._grpM.setUnjoinedAVChatRoom(l):(s._grpM.updateGroupMap([I]),s._notifyCachedGroupTips(l))}),this._checkCountMap.has(l)||this._checkCountMap.set(l,0),q.l("".concat(this._n,"._cacheGroupTipsAndProbe groupID:").concat(l))}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear()}}]),Lv),th=(p(Nv,[{key:"onCheckTimer",value:function(n){n%1==0&&0<this._cachedGroupMessageMap.size&&this._checkCachedGroupMessage()}},{key:"_checkCachedGroupMessage",value:function(){var n=this;this._cachedGroupMessageMap.forEach(function(s,l){var h=n._checkCountMap.get(l),v=n._grpM.hasLocalGroup(l);q.l("".concat(n._n,"._checkCachedGroupMessage groupID:").concat(l," hasLocalGroup:").concat(v," checkCount:").concat(h)),v?(n._notifyCachedGroupMessage(l),n._checkCountMap.delete(l),n._grpM.deleteUnjoinedAVChatRoom(l)):h>=n.MAX_CHECK_COUNT?(n._deleteCachedGroupMessage(l),n._checkCountMap.delete(l)):n._checkCountMap.set(l,++h)})}},{key:"handleUpdateGroupLastMessage",value:function(n){var s="".concat(this._n,".handleUpdateGroupLastMessage");if(this._grpM.getGroupMap().size!==0){for(var l,h,v,I,k=!1,P=0,G=n.length;P<G;P++)(l=n[P]).type===O.CONV_GROUP&&l.lastMessage.lastSequence!==0&&l.lastMessage.payload!==null&&(h=l.conversationID.split(/^GROUP/)[1],(h=this._grpM.getLocalGroupProfile(h))&&(v=h.lastMessage,I=l.lastMessage,JSON.stringify(v)!==JSON.stringify(I)&&(h.lastMessage=i({},l.lastMessage),k=!0)));q.l("".concat(s," conversation count:").concat(n.length,", local group count:").concat(this._grpM.getLocalGroupList().length," isGroupListUpdated:").concat(k)),k&&(this._grpM.sortLocalGroupList(),this._grpM.emitGroupListUpdate(!0,!1))}else this.tempConversationList=n}},{key:"onNewGroupMessage",value:function(n){q.d("".concat(this._n,".onNewGroupMessage count:").concat(n.dataList.length));var h=this._newGroupMessageStoredAndSummary(n),s=h.conversationOptionsList,l=h.messageList,h=h.AVChatRoomMessageList,h=(0<h.length&&this._grpM.onAVChatRoomMessage(h),jm(l)),h=(0<h.length&&this._grpM.emitOuterEvent($.MESSAGE_MODIFIED,h),0<s.length&&(this._grpM.updateNextMessageSeq(s),this._grpM.get(11).onNewMessage({conversationOptionsList:s,isInstantMessage:n.isInstantMessage||!0,updateUnreadCount:n.updateUnreadCount||!0})),Ym(l));0<h.length&&this._grpM.emitOuterEvent($.MESSAGE_RECEIVED,h),l.length=0}},{key:"_newGroupMessageStoredAndSummary",value:function(n){var s=n.dataList,l=n.event,h=n.isInstantMessage,v=null,I=[],k=[],P=[],G={},Y=this._grpM.getFileDownloadProxy(),te=s.length;1<te&&s.sort(function(br,Ya){return br.sequence-Ya.sequence});for(var pe=this._grpM.get(11),ye=this._grpM.get(4),ve=0;ve<te;ve++){var Ue,ut=Ni(s[ve]),Un=ut.groupProfile,mt=Un.groupID,Kt=Un.communityType,Kt=Kt===void 0?0:Kt,en=Un.topicID,en=en===void 0?void 0:en,Un=Un.invisible,vo=void 0,nr=this._grpM.isMessageFromTopic(Kt,en),pr=(nr&&(vo=O.CONV_TOPIC,ut.to=en),this._grpM.hasLocalGroup(mt));!pr&&this._grpM.isUnjoinedAVChatRoom(mt)||(pr||nr?this._grpM.isMessageFromOrToAVChatroom(mt)?(ut.event=l,P.push(ut)):(ut.currentUser=this._grpM.getMyUserID(),ut.conversationType=O.CONV_GROUP,ut.isSystemMessage=!!ut.isSystemMessage,(v=new er(ut)).setElement(ut.elements,Y),Un!==1?(pr=s[ve].isModified===1,pe.isMessageSentByCurrentInstance(v)?v.isModified=pr:pr=!1,ut.onlineOnlyFlag===1?(v._onlineOnlyFlag=!0,pe.isMessageSentByCurrentInstance(v)||k.push(v)):this._grpM.isMessageFromCommunityOfTopic(Kt,en)?k.push(v):(v.from!==this._grpM.getMyUserID()||(nr=pe.getLatestMessageSentByMe(v.conversationID))&&(Un=nr.nick,Kt=nr.avatar,Un===v.nick&&Kt===v.avatar||(pe.modifyMessageSentByMe({conversationID:Ue,latestNick:v.nick,latestAvatar:v.avatar}),ye.mockOnNickAvatarModified(v.nick,v.avatar))),pe.pushIntoMessageList(k,v,pr)&&(this._qualityStat(h,v),Ue=(en=v).conversationID,nr=en.sequence,Un=pe.isRemoteRead({conversationID:Ue,sequence:nr}),Qe(G[Ue])?(Kt=0,v.flow==="in"&&(v._isExcludedFromUnreadCount||Un||(Kt=1)),G[Ue]=I.push({conversationID:Ue,unreadCount:Kt,type:Qe(vo)?v.conversationType:vo,subType:v.conversationSubType,lastMessage:v._isExcludedFromLastMessage?"":v})-1):(I[pr=G[Ue]].type=Qe(vo)?v.conversationType:vo,I[pr].subType=v.conversationSubType,I[pr].lastMessage=v._isExcludedFromLastMessage?"":v,v.flow==="in"&&(v._isExcludedFromUnreadCount||Un||I[pr].unreadCount++))))):this._qualityStat(h,v)):this._cacheGroupMessageAndProbe({groupID:mt,event:l,item:ut}))}return{conversationOptionsList:I,messageList:k,AVChatRoomMessageList:P}}},{key:"_qualityStat",value:function(n,s){var l=this._grpM.get(26);l.addMessageSequence({key:Hc,message:s}),n&&0<s.clientTime&&l.addMessageDelay(s.clientTime)}},{key:"onGroupMessageRevoked",value:function(n){var s=this,l=this._grpM.get(11),h=[],v=[];n.dataList.forEach(function(I){var k=I.elements.revokedInfos,P=I.revokerInfo,G=I.groupProfile,Y=!1;G&&(Y=Dr({groupID:G.groupID})||!Ct(G.topicID)),Qe(k)||k.forEach(function(te){var pe,ye=Ct(te.topicID)?"GROUP".concat(te.groupID):"GROUP".concat(te.topicID),ve=l.getLocalConversation(ye),Ue=te.revokerInfo&&te.revokerInfo.revoker||P&&P.revoker,ut=P&&P.reason||"";ve&&Mr(ve.type)?pe={conversationID:ye,sequence:te.sequence,ID:"".concat(te.tinyID,"-").concat(te.clientTime,"-").concat(te.random)}:(ve=l.revoke(ye,te.sequence,te.random))?pe=ve:(pe={conversationID:ye,sequence:te.sequence},te.tinyID&&te.clientTime&&te.random&&(pe.ID="".concat(te.tinyID,"-").concat(te.clientTime,"-").concat(te.random)),te.time&&(pe.time=te.time)),pe&&(pe.revoker=Ue,pe.revokeReason=ut,pe.revokerInfo={userID:Ue,nick:"",avatar:""},Y?(pe.revokerInfo.nick=G.nick,pe.revokerInfo.avatar=G.avatar,h.push(pe)):v.push(pe))})}),v.length===0&&h.length===0||(l.onMessageRevoked([].concat(h,v)),0<h.length&&this._grpM.emitOuterEvent($.MESSAGE_REVOKED,h),0<v.length&&l.updateRevokerInfo(v).then(function(I){s._grpM.emitOuterEvent($.MESSAGE_REVOKED,I)}))}},{key:"_groupListTreeShaking",value:function(n){for(var s=new Map(L(this._grpM.getGroupMap())),l=0,h=n.length;l<h;l++)s.delete(n[l].groupID);this._grpM.hasJoinedAVChatRoom()&&this._grpM.getJoinedAVChatRoom().forEach(function(P){s.delete(P)}),this._grpM.getGroupMap().forEach(function(P,G){P.isSupportTopic&&s.delete(G)});for(var v=L(s.keys()),I=0,k=v.length;I<k;I++)this._grpM.deleteGroup(v[I])}},{key:"syncGroupList",value:function(){var n=this,v=0<arguments.length&&arguments[0]!==void 0&&arguments[0],s=(this._pagingStatus===ws&&this._grpM.clearGroupMap(),["Type","Name","FaceUrl","NextMsgSeq","LastMsgTime","AtInfoList","LastRecallTime"]),l=this.PAGING_GRP_COUNT_LIMIT,h=[];if(v===!0)return this._pagingGetGroupListWithTopic({limit:l,offset:0,groupBaseInfoFilter:s,groupList:h});var v="syncGroupList",I="".concat(this._n,".").concat(v),k=new it(v);return this._pagingGetGroupList({limit:l,offset:0,groupBaseInfoFilter:s,groupList:h}).then(function(){var P=NI(n._pagingGetCostList),G=Vd(n._pagingGetCostList),Y=(n._pagingGetCostList.length=0,n._pagingStatus=Hd,n._groupListTreeShaking(h),n._grpM.updateGroupMap(h),n._grpM.getLocalGroupList().length),Y="count:".concat(Y," sum:").concat(G," avg:").concat(P);return q.l("".concat(I," ok. ").concat(Y)),k.setMessage(Y).end(),n.tempConversationList&&(n.handleUpdateGroupLastMessage(n.tempConversationList),n.tempConversationList=null),n._grpM.emitGroupListUpdate(!0,!0),Ut({groupList:n._grpM.getLocalGroupList()})}).catch(function(P){return n._pagingStatus=$c,k.setError(P).end(),q.e("".concat(I," failed. error:"),P),Re(P)})}},{key:"getGroupList",value:function(){var n=this,s="".concat(this._n,".").concat("getGroupList");if(q.l("".concat(s," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===$c||this._pagingStatus===ws)return this.syncGroupList().then(function(){var h=n._grpM.getLocalGroupList();return Ut({groupList:h,isSyncCompleted:n.isPagingGetCompleted()})}).catch(function(h){return q.e("".concat(s," failed. error:"),h),Re(h)});var l=this._grpM.getLocalGroupList();return q.l("".concat(s,". returned group count:").concat(l.length)),ln({groupList:l,isSyncCompleted:this.isPagingGetCompleted()})}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===Hd}},{key:"_pagingGetGroupList",value:function(n){var s=this,l="".concat(this._n,".").concat("_pagingGetGroupList"),h=n.isCommunityRelay,v=h!==void 0&&h,I=n.limit,k=n.offset,P=n.groupBaseInfoFilter,G=n.groupList,Y=Date.now();return this._grpM.req({proto:fe.GET_GRP_LIST,data:{type:v?O.GRP_COMMUNITY:void 0,memberAccount:this._grpM.getMyUserID(),limit:I,offset:k,responseFilter:{groupBaseInfoFilter:P,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then(function(ve){var ve=ve.data,pe=ve.groups,pe=pe===void 0?[]:pe,ve=ve.totalCount,pe=(G.push.apply(G,L(pe)),s._handleGroupAtInfoWithoutTopic(v,pe),k+I),ye=!(pe<ve),ve="offset:".concat(k," limit:").concat(I," totalCount:").concat(ve," isCompleted:").concat(ye," ")+"currentCount:".concat(G.length," isCommunityRelay:").concat(v);return s._pagingGetCostList.push(ar(Y,!1)),q.l("".concat(l," ok. ").concat(ve," cost:").concat(ar(Y))),v||ye?!v&&ye?(q.l("".concat(l," start to get community list")),k=0,s._pagingGetGroupList({limit:I,offset:k,groupBaseInfoFilter:P,groupList:G,isCommunityRelay:!0})):v&&!ye?(k=pe,s._pagingGetGroupList({limit:I,offset:k,groupBaseInfoFilter:P,groupList:G,isCommunityRelay:!0})):Ut({groupList:G}):(k=pe,s._pagingGetGroupList({limit:I,offset:k,groupBaseInfoFilter:P,groupList:G}))}).catch(function(te){return te.code===10018?(q.w("".concat(s.logPrefix," response size exceeds the limit, request count:").concat(I)),I=50,s._pagingGetGroupList({limit:I,offset:k,groupBaseInfoFilter:P,groupList:G,isCommunityRelay:v})):v?(te.code===11e3&&q.l("".concat(l," ok. community unavailable")),ln({groupList:G})):Re(te)})}},{key:"_pagingGetGroupListWithTopic",value:function(n){var s=this,l="".concat(this._n,"._pagingGetGroupListWithTopic"),h=n.limit,v=n.offset,I=n.groupBaseInfoFilter,k=n.groupList,P=Date.now();return this._grpM.req({proto:fe.GET_GRP_LIST,data:{type:O.GRP_COMMUNITY,memberAccount:this._grpM.getMyUserID(),limit:h,offset:v,responseFilter:{groupBaseInfoFilter:I,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]},isSupportTopic:1}}).then(function(Y){var Y=Y.data,te=Y.groups,Y=Y.totalCount,te=(k.push.apply(k,L(te===void 0?[]:te)),v+h),pe=!(te<Y);return q.l("".concat(l," ok. offset:").concat(v," limit:").concat(h," totalCount:").concat(Y," isCompleted:").concat(pe," currentCount:").concat(k.length," cost:").concat(ar(P))),pe?(s._grpM.updateGroupMap(k),s._grpM.emitGroupListUpdate(!0,!1),Y=s._grpM.getLocalGroupList().filter(function(ye){return ye.isSupportTopic===!0}),Ut({groupList:Y})):(v=te,s._pagingGetGroupListWithTopic({limit:h,offset:v,groupBaseInfoFilter:I,groupList:k}))}).catch(function(G){return G.code===10018?(q.w("".concat(s.logPrefix," response size exceeds the limit, request count:").concat(h)),h=50,s._pagingGetGroupListWithTopic({limit:h,offset:v,groupBaseInfoFilter:I,groupList:k})):Re(G)})}},{key:"_cacheGroupMessage",value:function(n,s){this._cachedGroupMessageMap.has(n)||this._cachedGroupMessageMap.set(n,[]),this._cachedGroupMessageMap.get(n).push(s)}},{key:"_deleteCachedGroupMessage",value:function(n){this._cachedGroupMessageMap.has(n)&&this._cachedGroupMessageMap.delete(n)}},{key:"_notifyCachedGroupMessage",value:function(n){var s=this,l=this._cachedGroupMessageMap.get(n)||[];l.forEach(function(h){s.onNewGroupMessage(h)}),this._deleteCachedGroupMessage(n),q.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(n," count:").concat(l.length))}},{key:"_cacheGroupMessageAndProbe",value:function(v){var s=this,l=v.groupID,h=v.event,v=v.item;this._cacheGroupMessage(l,{event:h,dataList:[v]}),this._grpM.getGroupSimplifiedInfo(l).then(function(I){I.type===O.GRP_AVCHATROOM?s._grpM.hasLocalGroup(l)?s._notifyCachedGroupMessage(l):s._grpM.setUnjoinedAVChatRoom(l):(s._grpM.updateGroupMap([I]),s._notifyCachedGroupMessage(l))}),this._checkCountMap.has(l)||this._checkCountMap.set(l,0),q.l("".concat(this._n,"._cacheGroupMessageAndProbe groupID:").concat(l))}},{key:"_handleGroupAtInfoWithoutTopic",value:function(n,s){var l=this;n&&s.length!==0&&s.forEach(function(I){var v=I.groupID,I=I.groupAtInfoList,k=[];Qe(I)||(I.forEach(function(P){k.push(i(i({},P),{},{groupID:v}))}),l._grpM.get(11).onNewGroupAtTips({dataList:k}))})}},{key:"setPagingGroupCount",value:function(n){Qe(n)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(n,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._pagingStatus=ws,this._pagingGetCostList=[]}}]),Nv),L1=(p(Ov,[{key:"_onCloudConfigUpdated",value:function(){var n=this._grpM.getCloudConfig("grp_attr_cache_time");Qe(n)||(this.CACHE_EXPIRE_TIME=Number(n))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach(function(n){n.localMainSequence=0})}},{key:"isGroupAttributesUpdatedNotice",value:function(l){var s=l.to,l=l.elements.newGroupProfile,h=!Qe(l)&&!Ct(l.groupAttributeOption);return h&&this._onGroupAttributesUpdated({groupID:s,groupAttributeOption:l.groupAttributeOption}),h}},{key:"_onGroupAttributesUpdated",value:function(k){var s=this,l=k.groupID,k=k.groupAttributeOption,h=k.mainSequence,v=k.isWithChangedAttributeInfo,I=k.groupAttributeList,I=I===void 0?[]:I,k=k.operationType;if(q.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(l," isWithChangedAttributeInfo:").concat(v," operationType:").concat(k)),!Qe(k)){this._groupAttributesCopy=this._getCachedAttributes({groupID:l});var P=h-this._getLocalGroupAttributes(l).localMainSequence;if(P!=0){if(v===1&&P==1)return this._refreshCachedGroupAttributes({groupID:l,remoteMainSequence:h,groupAttributeList:I,operationType:k}),void this._emitGroupAttributesUpdated(l);this._hasLocalGroupAttributes(l)&&(v=this._getLocalGroupAttributes(l).avChatRoomKey,this._getGroupAttributes({groupID:l,avChatRoomKey:v}).then(function(){s._emitGroupAttributesUpdated(l)}))}}}},{key:"initGroupAttributesCache",value:function(l){var s=l.groupID,l=l.avChatRoomKey,l=l===void 0?void 0:l;this._groupAttributesMap.set(s,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:l}),q.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(s," avChatRoomKey:").concat(l))}},{key:"initGroupAttributes",value:function(I){var s=this,l=I.groupID,h=I.groupAttributes,I=this._getLocalGroupAttributes(l),v=I.remoteMainSequence,I=I.avChatRoomKey,k=new it("initGroupAttributes");return k.setMessage("groupID:".concat(l," avChatRoomKey:").concat(I," mainSequence:").concat(v)),this._grpM.req({proto:fe.SET_GRP_ATTR,data:{groupID:l,avChatRoomKey:I,mainSequence:v,groupAttributeList:this._transformGroupAttributes(h)}}).then(function(Y){q.l("".concat(s._n,".").concat("initGroupAttributes"," ok. groupID:").concat(l));var Y=Y.data,G=Y.mainSequence,Y=L(Y.groupAttributeList);return Y.forEach(function(te){te.value=h[te.key]}),s._groupAttributesCopy=s._getCachedAttributes({groupID:l}),s._refreshCachedGroupAttributes({groupID:l,remoteMainSequence:G,groupAttributeList:Y,operationType:1}),s._emitGroupAttributesUpdated(l),k.end(),Ut({groupAttributes:h})}).catch(function(P){return k.setError(P).end(),Re(P)})}},{key:"setGroupAttributes",value:function(G){var s=this,l="".concat(this._n,".").concat("setGroupAttributes"),h=G.groupID,v=G.groupAttributes,G=this._getLocalGroupAttributes(h),I=G.remoteMainSequence,k=G.avChatRoomKey,P=G.attributes,G=this._transformGroupAttributes(v),Y=(G.forEach(function(te){var pe=te.key;te.sequence=0,P.has(pe)&&(te.sequence=P.get(pe).sequence)}),new it("setGroupAttributes"));return Y.setMessage("groupID:".concat(h," groupAttributes:").concat(JSON.stringify(v))),q.l("".concat(l,". groupID:").concat(h," mainSequence:").concat(I)),this._grpM.req({proto:fe.MODIFY_GRP_ATTR,data:{groupID:h,avChatRoomKey:k,mainSequence:I,groupAttributeList:G}}).then(function(ye){q.l("".concat(l," ok."));var ye=ye.data,pe=ye.mainSequence,ye=L(ye.groupAttributeList);return ye.forEach(function(ve){ve.value=v[ve.key]}),s._groupAttributesCopy=s._getCachedAttributes({groupID:h}),s._refreshCachedGroupAttributes({groupID:h,remoteMainSequence:pe,groupAttributeList:ye,operationType:2}),s._emitGroupAttributesUpdated(h),Y.end(),Ut({groupAttributes:v})}).catch(function(te){return Y.setError(te).end(),Re(te)})}},{key:"deleteGroupAttributes",value:function(h){var s=this,l=h.groupID,h=h.keyList,h=h===void 0?[]:h,P=this._getLocalGroupAttributes(l),v=P.remoteMainSequence,Y=P.avChatRoomKey,I=P.attributes,k=L(I.keys()),P=fe.CLEAR_GRP_ATTR,G=3,Y={groupID:l,avChatRoomKey:Y,mainSequence:v},te=[],pe=(0<h.length&&(k=[],P=fe.DEL_GRP_ATTR,G=4,h.forEach(function(ye){var ve=0;I.has(ye)&&(ve=I.get(ye).sequence,k.push(ye)),te.push({key:ye,sequence:ve})}),Y.groupAttributeList=te),new it("deleteGroupAttributes"));return pe.setMessage("groupID:".concat(l," mainSequence:").concat(v," keyList:").concat(h," proto:").concat(P)),this._grpM.req({proto:P,data:Y}).then(function(ye){return q.l("".concat(s._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(l)),ye=ye.data.mainSequence,s._groupAttributesCopy=s._getCachedAttributes({groupID:l}),s._refreshCachedGroupAttributes({groupID:l,remoteMainSequence:ye,groupAttributeList:te,operationType:G}),s._emitGroupAttributesUpdated(l),pe.end(),Ut({keyList:k})}).catch(function(ye){return pe.setError(ye).end(),Re(ye)})}},{key:"getGroupAttributes",value:function(n){var s=this,l="".concat(this._n,".").concat("getGroupAttributes"),h=n.groupID,P=this._getLocalGroupAttributes(h),v=P.avChatRoomKey,I=P.lastUpdateTime,k=P.localMainSequence,P=P.remoteMainSequence,G=new it("getGroupAttributes");return G.setMessage("groupID:".concat(h," localMainSequence:").concat(k," remoteMainSequence:").concat(P," keyList:").concat(n.keyList)),Date.now()-I>=this.CACHE_EXPIRE_TIME||k<P?this._getGroupAttributes({groupID:h,avChatRoomKey:v}).then(function(Y){return G.setMoreMessage("get attributes from remote. count:".concat(Y.length)).end(),q.l("".concat(l," from remote. groupID:").concat(h)),Y=s._getCachedAttributes(n),Ut({groupAttributes:Y})}).catch(function(Y){return G.setError(Y).end(),Re(Y)}):(G.setMoreMessage("get attributes from cache").end(),q.l("".concat(l," from cache. groupID:").concat(h)),I=this._getCachedAttributes(n),ln({groupAttributes:I}))}},{key:"_getGroupAttributes",value:function(n){var s=this,l=0;return Qe(n.avChatRoomKey)||(l=1),this._grpM.req({proto:fe.GET_GRP_ATTR,data:i(i({},n),{},{groupType:l})}).then(function(I){q.l("".concat(s._n,"._getGroupAttributes ok. groupID:").concat(n.groupID));var I=I.data,v=I.mainSequence,I=I.groupAttributeList,k=L(I);return Qe(v)||s._refreshCachedGroupAttributes({groupID:n.groupID,remoteMainSequence:v,groupAttributeList:k,operationType:5}),I}).catch(function(h){return Re(h)})}},{key:"_refreshCachedGroupAttributes",value:function(v){var s=v.groupID,l=v.remoteMainSequence,h=v.groupAttributeList,v=v.operationType;if(this._hasLocalGroupAttributes(s)){var I=this._getLocalGroupAttributes(s),k=I.localMainSequence;if(v===5||l-k==1)I.remoteMainSequence=l,I.localMainSequence=l,I.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:I,groupAttributeList:h,operationType:v});else{if(k===l)return;I.remoteMainSequence=l}this._groupAttributesMap.set(s,I),h="operationType:".concat(v," localMainSequence:").concat(k," remoteMainSequence:").concat(l),q.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(h))}}},{key:"_getCachedAttributes",value:function(l){var s=l.groupID,l=l.keyList,l=l===void 0?[]:l,h={};if(this._hasLocalGroupAttributes(s)){var v=this._getLocalGroupAttributes(s).attributes;if(0<l.length)l.forEach(function(G){v.has(G)&&(h[G]=v.get(G).value)});else{var I,k=Z(v.keys());try{for(k.s();!(I=k.n()).done;){var P=I.value;h[P]=v.get(P).value}}catch(G){k.e(G)}finally{k.f()}}}return h}},{key:"_updateCachedAttributes",value:function(h){var s=h.groupAttributes,l=h.groupAttributeList,h=h.operationType;h!==3?h!==4?(h===1&&s.attributes.clear(),l.forEach(function(P){var I=P.key,k=P.value,P=P.sequence;s.attributes.set(I,{value:k,sequence:P})})):l.forEach(function(v){s.attributes.delete(v.key)}):s.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(n){return this._groupAttributesMap.has(n)}},{key:"_getLocalGroupAttributes",value:function(n){return this._hasLocalGroupAttributes(n)||this.initGroupAttributesCache({groupID:n}),this._groupAttributesMap.get(n)}},{key:"_transformGroupAttributes",value:function(n){var s=[];return Object.keys(n).forEach(function(l){s.push({key:l,value:n[l]})}),s}},{key:"_emitGroupAttributesUpdated",value:function(n){var s=this._getCachedAttributes({groupID:n}),h=this._computeAttrChangedInfo(s),l=h.updatedKeyList,h=h.deletedKeyList;q.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(l.length,", delete:").concat(h.length)),l.length===0&&h.length===0||this._grpM.emitOuterEvent($.GROUP_ATTRIBUTES_UPDATED,{groupID:n,groupAttributes:s,updatedKeyList:l,deletedKeyList:h})}},{key:"_computeAttrChangedInfo",value:function(n){var s=this,l=[],h=[];return Object.keys(n).forEach(function(v){n[v]!==s._groupAttributesCopy[v]&&l.push(v)}),Object.keys(this._groupAttributesCopy).forEach(function(v){Qe(n[v])&&h.push(v)}),this._groupAttributesCopy={},{updatedKeyList:l,deletedKeyList:h}}},{key:"deleteLocalGroupAttributes",value:function(n){this._hasLocalGroupAttributes(n)&&this._groupAttributesMap.delete(n)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),Ov),P1=(p(Dv,[{key:"_onCloudConfigUpdated",value:function(){var n=this._grpM.getCloudConfig("grp_counter_expire_time");Qe(n)||(this.EXPIRE_TIME=Number(n))}},{key:"isGroupCountersNotice",value:function(l){var s=l.to,l=l.elements.groupCounterInfo,h=!1;return Ct(l)||(this._onGroupCountersUpdated({groupID:s,groupCounterInfo:l}),h=!0),h}},{key:"_onGroupCountersUpdated",value:function(n){var s=this,l=n.groupID;n.groupCounterInfo.forEach(function(k){var v=k.type,I=k.groupCounterSeq,k=k.counterList,k=k===void 0?[]:k;v!==0&&v!==2||(s._updateLocalGroupCounters({groupID:l,groupCounterSeq:I,counterList:k}),k.forEach(function(P){s._grpM.emitOuterEvent($.GROUP_COUNTER_UPDATED,{groupID:l,key:P.key,value:P.value})})),v===1&&s._deleteLocalGroupCounters({groupID:l,groupCounterSeq:I,counterList:k})}),q.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(l))}},{key:"initGroupCountersCache",value:function(l){var s=l.groupID,l=l.avChatRoomKey;this._groupCountersMap.set(s,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:l}),q.l("".concat(this._n,".initGroupCountersCache groupID:").concat(s," avChatRoomKey:").concat(l))}},{key:"setGroupCounters",value:function(h){if(!this._grpM.canIUse(ue.GRP_COUNTER))return this._grpM.cannotUseCommercialAbility("setGroupCounters");var s="".concat(this._n,".").concat("setGroupCounters"),l=h.groupID,h=h.counters,h=this._convertObjectToList(h),v=this._getLocalGroupCounters(l).avChatRoomKey,I="groupID:".concat(l," count:").concat(h.length),k=new it("setGroupCounters");return k.setMessage("".concat(I)),q.l("".concat(s,". ").concat(I)),this._updateGroupCounters({groupID:l,counterList:h,avChatRoomKey:v,mode:"Set"}).then(function(P){return k.end(),q.l("".concat(s," ok.")),Ut({counters:P})}).catch(function(P){return k.setError(P).end(),q.e("".concat(s," failed. error:"),P),Re(P)})}},{key:"increaseGroupCounter",value:function(I){var s="increaseGroupCounter";if(!this._grpM.canIUse(ue.GRP_COUNTER))return this._grpM.cannotUseCommercialAbility(s);var l="".concat(this._n,".").concat(s),h=I.groupID,v=I.key,I=I.value,k=this._getLocalGroupCounters(h).avChatRoomKey,P="groupID:".concat(h," key:").concat(v," value:").concat(I),G=new it(s);return G.setMessage("".concat(P)),q.l("".concat(l,". ").concat(P)),this._updateGroupCounters({groupID:h,counterList:[{key:v,value:I}],avChatRoomKey:k,mode:"Increase"}).then(function(Y){return G.end(),q.l("".concat(l," ok.")),Ut({counters:Y})}).catch(function(Y){return G.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"decreaseGroupCounter",value:function(I){var s="decreaseGroupCounter";if(!this._grpM.canIUse(ue.GRP_COUNTER))return this._grpM.cannotUseCommercialAbility(s);var l="".concat(this._n,".").concat(s),h=I.groupID,v=I.key,I=I.value,k=this._getLocalGroupCounters(h).avChatRoomKey,P="groupID:".concat(h," key:").concat(v," value:").concat(I),G=new it(s);return G.setMessage("".concat(P)),q.l("".concat(l,". ").concat(P)),this._updateGroupCounters({groupID:h,counterList:[{key:v,value:I}],avChatRoomKey:k,mode:"Decrease"}).then(function(Y){return G.end(),q.l("".concat(l," ok.")),Ut({counters:Y})}).catch(function(Y){return G.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"getGroupCounters",value:function(k){var s=this;if(!this._grpM.canIUse(ue.GRP_COUNTER))return this._grpM.cannotUseCommercialAbility("getGroupCounters");var l="".concat(this._n,".").concat("getGroupCounters"),h=k.groupID,k=k.keyList,v=k===void 0?[]:k,k=this._getLocalGroupCounters(h),I=k.avChatRoomKey,k=k.lastUpdateTime,P=new it("getGroupCounters");return P.setMessage("groupID:".concat(h)),Date.now()-k>=this.EXPIRE_TIME?this._getRemoteGroupCounters({groupID:h,avChatRoomKey:I}).then(function(G){return P.setMoreMessage("from remote. count:".concat(G.length)).end(),q.l("".concat(l," from remote. groupID:").concat(h)),G=s._getLocalCounters(h,v),Ut({counters:G})}).catch(function(G){return P.setError(G).end(),Re(G)}):(P.setMoreMessage("from cache").end(),q.l("".concat(l," from cache. groupID:").concat(h)),k=this._getLocalCounters(h,v),ln({counters:k}))}},{key:"_getRemoteGroupCounters",value:function(n){var s=this;return this._grpM.req({proto:fe.GET_GRP_COUNTER,data:i({},n)}).then(function(v){var v=v.data,h=v.counterList,h=h===void 0?[]:h,v=v.groupCounterSeq;return s._updateLocalGroupCounters({groupID:n.groupID,counterList:h,groupCounterSeq:v}),q.l("".concat(s._n,"._getRemoteGroupCounters ok. groupID:").concat(n.groupID)),h}).catch(function(l){return Re(l)})}},{key:"_convertObjectToList",value:function(n){var s=[];return Object.keys(n).forEach(function(l){s.push({key:l,value:n[l]})}),s}},{key:"_updateGroupCounters",value:function(n){var s="".concat(this._n,"._updateGroupCounters"),l=n.groupID,h=n.avChatRoomKey,v=n.mode;return q.l("".concat(s,". groupID:").concat(l," avChatRoomKey:").concat(h," mode:").concat(v)),this._grpM.req({proto:fe.UPDATE_GRP_COUNTER,data:i({},n)}).then(function(k){q.l("".concat(s," ok."));var k=k.data.counterList,P={};return(k===void 0?[]:k).forEach(function(te){var Y=te.key,te=te.value;P[Y]=te}),P}).catch(function(I){return Re(I)})}},{key:"_hasLocalGroupCounters",value:function(n){return this._groupCountersMap.has(n)}},{key:"_getLocalGroupCounters",value:function(n){return this._hasLocalGroupCounters(n)||this.initGroupCountersCache({groupID:n}),this._groupCountersMap.get(n)}},{key:"_updateLocalGroupCounters",value:function(k){var s,l,h,v=k.groupID,I=k.counterList,I=I===void 0?[]:I,k=k.groupCounterSeq;this._hasLocalGroupCounters(v)&&(h=this._getLocalGroupCounters(v),s=h.counters,l=h.avChatRoomKey,h=h.groupCounterSeq,0<k&&k<h||(I.forEach(function(Y){var G=Y.key,Y=Y.value;s.set(G,Y)}),this._groupCountersMap.set(v,{lastUpdateTime:Date.now(),groupCounterSeq:k,counters:s,avChatRoomKey:l})))}},{key:"_deleteLocalGroupCounters",value:function(I){var s,l,h=I.groupID,v=I.counterList,v=v===void 0?[]:v,I=I.groupCounterSeq;this._hasLocalGroupCounters(h)&&(l=this._getLocalGroupCounters(h),s=l.counters,l=l.avChatRoomKey,v.forEach(function(k){s.delete(k.key)}),this._groupCountersMap.set(h,{lastUpdateTime:Date.now(),groupCounterSeq:I,counters:s,avChatRoomKey:l}))}},{key:"_getLocalCounters",value:function(n,s){var l={};if(!this._hasLocalGroupCounters(n))return l;var h=this._getLocalGroupCounters(n).counters;if(0<s.length)s.forEach(function(P){h.has(P)&&(l[P]=h.get(P))});else{var v,I=Z(h.keys());try{for(I.s();!(v=I.n()).done;){var k=v.value;l[k]=h.get(k)}}catch(P){I.e(P)}finally{I.f()}}return l}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),Dv),Sv=(p(wv,[{key:"start",value:function(){var n=this._grpM.isLoggedIn();n||(this._proto=fe.AV_NOAUTH_POLLING),q.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(n)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var n=this,s=this._onInit(this._groupID);this._grpM.req({proto:this._proto,data:s}).then(function(l){n._onSuccess(n._groupID,l),n.isRunning()&&(clearTimeout(n._timeoutID),n._timeoutID=setTimeout(n._request.bind(n),n._manager.getPollingInterval()))}).catch(function(l){n._onFail(n._groupID,l),n.isRunning()&&(clearTimeout(n._timeoutID),n._timeoutID=setTimeout(n._request.bind(n),n._manager.MAX_POLLING_INTERVAL))})}},{key:"stop",value:function(){q.l("".concat(this._n,".stop")),0<this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),wv),za={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0,100:!0},jI=(p(jo,[{key:"hasJoinedAVChatRoom",value:function(){var n=[];return 0<(n=0<this._joinedGroupMap.size?L(this._joinedGroupMap.values()).filter(function(s){return s.type===O.GRP_AVCHATROOM}):n).length}},{key:"getJoinedLiveList",value:function(){var n=[];return n=0<this._joinedGroupMap.size?L(this._joinedGroupMap.values()).filter(function(s){return s.type===O.GRP_LIVE}):n}},{key:"checkJoinedAVChatRoomByID",value:function(n){return this._joinedGroupMap.has(n)}},{key:"getJoinedAVChatRoom",value:function(){return 0<this._joinedGroupMap.size?L(this._joinedGroupMap.keys()):[]}},{key:"_updatedata",value:function(n){var s=this._pollingRequestInfoMap.get(n);return n===L(this._pollingInstanceMap.keys())[0]?i(i({},s),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):i(i({},s),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(n,s){var l,G=s.data,h=G.key,v=G.nextSeq,I=G.rspMsgList,k=G.errorCode,P=G.nextBroadcastSeq,G=G.broadcastMessageList;k!==0?(k=this._pollingRequestInfoMap.get(n),l=new it("longPollingAVError"),k=k?"".concat(k.key,"-").concat(k.startSeq):"requestInfo is undefined",l.setMessage("".concat(n,"-").concat(k,"-").concat(s.errorInfo)).setCode(s.errorCode).end(!0)):this.checkJoinedAVChatRoomByID(n)&&(Sn(h)&&un(v)&&this._pollingRequestInfoMap.set(n,{key:h,startSeq:v}),un(P)&&P>this._startBroadcastSeq&&(this._startBroadcastSeq=P),Rt(I)&&0<I.length?(I.forEach(function(Y){Y.to=Y.groupID}),this.onMessage(I,n)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(G))}},{key:"_handleFailure",value:function(n,s){}},{key:"onMessage",value:function(n,s){if(Rt(n)&&n.length!==0){var l="".concat(this._n,".onMessage"),h=(s&&(l+=" groupID:".concat(s)),this._pollingNoMessageCount!==0&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL),null),v=[],I=this._get(11),k=this._get(26),P=n.length,G=(1<P&&n.sort(function(Ue,ut){return Ue.sequence-ut.sequence}),this._get(12).isUnlimitedAVChatRoom()),Y=!1;q.getLevel()<=0&&(s=n.map(function(Ue){return Ue.sequence}),q.l("".concat(l," count:").concat(s.length," sequenceList:").concat(s)),s.length=0);for(var te=0;te<P;te++){var pe=this.restoreMessageFromSimplified(n[te]);if(za[pe.event]){if(pe.event===6&&(this._grpM.isGroupAttributesUpdatedNotice(pe)||this._grpM.isGroupCountersNotice(pe)))continue;if(pe.event!==20)if(pe.event!==21)if(pe.event!==100){var h=this.packMessage(pe,pe.event),ye=pe.isModified===1,Y=pe.isHistoryMessage===1;if(!G){if(this.sequencesLinkedList.has(h.sequence))continue;this.sequencesLinkedList.set(h.sequence)}var ve=this.messageIDLinkedList.has(h.ID);ve?q.w("".concat(l," ID:").concat(h.ID," has:").concat(ve)):(this.messageIDLinkedList.set(h.ID),ve=!1,!Y&&this._isMessageSentByCurrentInstance(h)?ye&&(ve=!0,h.isModified=ye,I.updateMessageIsModifiedProperty(h)):ve=!0,ve&&(h.conversationType===O.CONV_SYSTEM&&h.payload.operationType===5&&this._onGroupDismissed(h.payload.groupProfile.groupID),Y||h.conversationType===O.CONV_SYSTEM||(ye=h.conversationID.replace(O.CONV_GROUP,""),this._pollingInstanceMap.has(ye)?this._grpM.isLoggedIn()&&k.addMessageSequence({key:zd,message:h}):(h.type!==O.MSG_GRP_TIP&&0<h.clientTime&&k.addMessageDelay(h.clientTime),k.addMessageSequence({key:qc,message:h}))),v.push(h)))}else this.onRoomCustomData(pe);else this._get(34).onMessageReactionNotify({event:21,dataList:pe.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(pe)}else q.w("".concat(l,". unknown event:").concat(pe.event))}v.length!==0&&(0<(s=jm(v)).length&&this._grpM.emitOuterEvent($.MESSAGE_MODIFIED,s),Y||0<(s=this.packConversationOption(v)).length&&I.onNewMessage({conversationOptionsList:s,isInstantMessage:!0}),this._checkMessageStacked(v),0<(s=Ym(v)).length&&this._grpM.emitOuterEvent($.MESSAGE_RECEIVED,s),v.length=0)}}},{key:"handleMessageRevokedNotice",value:function(n){var s=this,l=n.groupID,h=n.elements.revokeMsgList,v=n.revokerInfo,I=[];h.forEach(function(Y){var te=Y.tinyID,P=Y.clientTime,G=Y.random,Y=Y.sequence,te={conversationID:"".concat(O.CONV_GROUP).concat(l),ID:"".concat(te,"-").concat(P,"-").concat(G),revoker:v.revoker,revokeReason:v.reason||"",revokerInfo:{userID:v.revoker,nick:"",avatar:""},sequence:Y};I.push(te)}),I.length!==0&&this._get(11).updateRevokerInfo(I).then(function(k){s._grpM.emitOuterEvent($.MESSAGE_REVOKED,k)})}},{key:"isBroadcastOrNormal",value:function(n){return n===3||n===17}},{key:"isGroupTip",value:function(n){return n===4||n===6}},{key:"isGroupSystemNotice",value:function(n){return n===5}},{key:"restoreGroupTipElements",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},v=n.operatorInfo,v=v===void 0?{}:v,I=n.operatorID,s=n.userIDList,s=s===void 0?[]:s,l=n.operationType,l=(un(n.groupJoinType)||l!==1&&l!==2||(n.groupJoinType=l===2?0:1),v.userID),h=v.avatar,v=v.nick,I=(n.operatorInfo={userID:l===void 0?I:l,avatar:h===void 0?"":h,nick:v===void 0?"":v},s.map(function(k){return{userID:k}}));return n.memberInfoList=n.memberInfoList||I,n}},{key:"restoreMessageFromSimplified",value:function(n){var s,l,h,v=n.event;return this.isBroadcastOrNormal(v)&&(n.cloudCustomData=n.cloudCustomData||"",n.elements=n.elements.map(function(I){var k;return I.type===O.MSG_CUSTOM&&(k=I.content,I.content=i({data:"",description:"",extension:""},k===void 0?{}:k)),I})),(this.isGroupTip(v)||this.isGroupSystemNotice(v))&&(n.from=n.from||"@TIM#SYSTEM"),this.isGroupTip(v)&&(n.elements=this.restoreGroupTipElements(n.elements),l=(h=(h=n.elements)===void 0?{}:h).operationType,s=h.operatorInfo,l===1&&(l=[{userID:(s===void 0?{}:s).userID}],h.memberInfoList=h.memberInfoList||l)),this.isGroupSystemNotice(v)&&(h=(s=n.elements).memberInfoList,l=s.operatorInfo,n.elements.memberInfoList=i({userID:n.elements.operatorID,avatar:"",nick:""},h=h||(l===void 0?{}:l)),n.elements=i({authentication:"",remarkInfo:"",messageKey:1e3*n.time},n.elements),v=Object.keys(n.elements).filter(function(I){return I!=="operatorInfo"}).reduce(function(I,k){return i(i({},I),{},m({},k,n.elements[k]))},{}),n.elements=v),n}},{key:"_onGroupDismissed",value:function(n){q.l("".concat(this._n,"._onGroupDismissed groupID:").concat(n)),this._grpM.deleteLocalGroupAndConversation(n),this.reset(n)}},{key:"_checkMessageStacked",value:function(l){var s="MessageStacked",l=l.length;100<=l&&(this._grpM.outputWarning(s,l),this._reportMessageStackedCount<5&&(new it(s).setMessage("count:".concat(l," groupID:").concat(L(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(n){return!!this._get(11).isMessageSentByCurrentInstance(n)}},{key:"packMessage",value:function(h,s){h.currentUser=this._grpM.getMyUserID(),h.conversationType=s===5?O.CONV_SYSTEM:O.CONV_GROUP,h.isSystemMessage=!!h.isSystemMessage;var l=new er(h),h=this.packElements(h,s);return l.setElement(h,this._grpM.getFileDownloadProxy()),l}},{key:"packElements",value:function(n,s){return s===4||s===6?(this._updateMemberCountByGroupTips(n),{type:O.MSG_GRP_TIP,content:i(i({},n.elements),{},{groupProfile:n.groupProfile})}):s===5?{type:O.MSG_GRP_SYS_NOTICE,content:i(i({},n.elements),{},{groupProfile:i(i({},n.groupProfile),{},{groupID:n.groupID})})}:n.elements}},{key:"packConversationOption",value:function(n){for(var s=new Map,l=0;l<n.length;l++){var h,v=n[l],I=v.conversationID;s.has(I)?((h=s.get(I)).lastMessage=v).flow==="in"&&h.unreadCount++:s.set(I,{conversationID:v.conversationID,unreadCount:v.flow==="out"?0:1,type:v.conversationType,subType:v.conversationSubType,lastMessage:v})}return L(s.values())}},{key:"_updateMemberCountByGroupTips",value:function(I){var s,l,h,v=I.groupProfile.groupID,I=I.elements.onlineMemberInfo,I=I===void 0?void 0:I;Ct(I)||(s=(s=I.onlineMemberNum)===void 0?0:s,I=(I=I.expireTime)===void 0?this.DEFAULT_EXPIRE_TIME:I,l=this._onlineMemberCountMap.get(v)||{},h=Date.now(),Ct(l)?Object.assign(l,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:h,memberCount:s,expireTime:I}):(l.latestUpdateTime=h,l.memberCount=s),this._onlineMemberCountMap.set(v,l))}},{key:"_onBroadcastMessage",value:function(n){if(!Ct(n)){for(var s=[],l=n.length,h=null,v=0;v<l;v++){var I=this.restoreMessageFromSimplified(n[v]);za[I.event]?((h=this.packMessage(I,I.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(h.ID)||(s.push(h),this._broadcastMessageIDMap.set(h.ID,1))):q.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(I.event))}0<s.length&&this._grpM.emitOuterEvent($.MESSAGE_RECEIVED,s)}}},{key:"start",value:function(n){var s;this._pollingInstanceMap.has(n)?(s=this._pollingInstanceMap.get(n)).isRunning()||s.start():((s=new Sv({manager:this,groupID:n,onInit:this._updatedata.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)})).start(),this._pollingInstanceMap.set(n,s),q.l("".concat(this._n,".start groupID:").concat(n)))}},{key:"handleJoinResult",value:function(n){var s=this;return this._preCheck(n.group).then(function(){var l=n.longPollingKey,h=n.group,v=h.groupID;return s._joinedGroupMap.set(v,h),s._grpM.updateGroupMap([h]),s._grpM.deleteUnjoinedAVChatRoom(v),s._grpM.emitGroupListUpdate(!0,!1),Qe(l)?ln({status:sr,group:h}):Promise.resolve()})}},{key:"startRunLoop",value:function(n){var s=this;return this.handleJoinResult(n).then(function(){var l=n.longPollingKey,h=n.group,v=n.startSeq,I=h.groupID;return s._pollingRequestInfoMap.set(I,{key:l,startSeq:v===void 0?0:v}),s.start(I),s._grpM.isLoggedIn()?ln({status:sr,group:h}):ln({status:sr})})}},{key:"_preCheck",value:function(l){if(this._get(12).isUnlimitedAVChatRoom()||!this.hasJoinedAVChatRoom()||l.type===O.GRP_LIVE)return Promise.resolve();var l=x(this._joinedGroupMap.entries().next().value,2),s=l[0],l=l[1];if(this._grpM.isLoggedIn()){if(l.selfInfo.role!==O.GRP_MBR_ROLE_OWNER&&l.ownerID!==this._grpM.getMyUserID())return this._grpM.quitGroup(s);this._grpM.deleteLocalGroupAndConversation(s)}else this._grpM.deleteLocalGroupAndConversation(s);return this.reset(s),Promise.resolve()}},{key:"joinWithoutAuth",value:function(n){var s=this,l=n.groupID,h="".concat(this._n,".").concat("joinWithoutAuth"),v=new it("joinWithoutAuth");return this._grpM.req({proto:fe.APPLY_JOIN_GRP_NOAUTH,data:n}).then(function(I){if(I=I.data.longPollingKey,v.setMessage("groupID:".concat(l," longPollingKey:").concat(I)).end(!0),Qe(I))return Re({code:Be.CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN});q.l("".concat(h," ok. groupID:").concat(l)),s._get(11).setCompleted("".concat(O.CONV_GROUP).concat(l));var k=new fa({groupID:l});return s.startRunLoop({group:k,longPollingKey:I}),Ut({status:sr})}).catch(function(I){return q.e("".concat(h," failed. groupID:").concat(l," error:"),I),v.setError(I).setMessage("groupID:".concat(l)).end(!0),Re(I)}).finally(function(){s._grpM.get(14).reportAtOnce()})}},{key:"getGroupOnlineMemberCount",value:function(n){var s=this._onlineMemberCountMap.get(n)||{},l=Date.now();return Ct(s)||l-s.lastSyncTime>1e3*s.expireTime&&1e4<l-s.latestUpdateTime&&3e3<l-s.lastReqTime?(s.lastReqTime=l,this._onlineMemberCountMap.set(n,s),this._getGroupOnlineMemberCount(n).then(function(h){return Ut({memberCount:h.memberCount})}).catch(function(h){return Re(h)})):ln({memberCount:s.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(n){var s=this,l="".concat(this._n,".").concat("_getGroupOnlineMemberCount"),h=new it("_getGroupOnlineMemberCount");return this._grpM.requestOnlineCount(n).then(function(P){var I=s._onlineMemberCountMap.get(n)||{},P=P.data,k=P.memberCount,k=k===void 0?0:k,P=P.expireTime,P=P===void 0?s.DEFAULT_EXPIRE_TIME:P,G=(q.l("".concat(l," ok. groupID:").concat(n," memberCount:").concat(k," expireTime:").concat(P)),Date.now());return Ct(I)&&(I.lastReqTime=G),s._onlineMemberCountMap.set(n,Object.assign(I,{lastSyncTime:G,latestUpdateTime:G,memberCount:k,expireTime:P})),{memberCount:k}}).catch(function(v){return q.w("".concat(l," failed. error:"),v),h.setCode(v.code).setMessage("groupID:".concat(n," error:").concat(JSON.stringify(v))).end(),Promise.reject(v)})}},{key:"_get",value:function(n){return this._grpM.get(n)}},{key:"setPollingInterval",value:function(n){Qe(n)||(un(n)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=n:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(n,10))}},{key:"setPollingIntervalPlus",value:function(n){Qe(n)||(un(n)?this.DEFAULT_POLLING_INTERVAL_PLUS=n:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(n,10))}},{key:"setPollingNoMessageCount",value:function(n){Qe(n)||(un(n)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=n:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(n,10))}},{key:"setPollingSimplifiedMessage",value:function(n){Qe(n)||n!=="0"&&n!=="1"||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(n,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(n){n=n.payload.groupProfile.groupID,q.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(n)),this._grpM.deleteLocalGroupAndConversation(n),this.reset(n)}},{key:"restartPolling",value:function(){q.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var n,s=Z(this._pollingInstanceMap.values());try{for(s.s();!(n=s.n()).done;){var l=n.value;l.stop(),l.start()}}catch(h){s.e(h)}finally{s.f()}}},{key:"getPollingTimerID",value:function(n){if(!this._pollingInstanceMap.has(n))return-1;var s=this._pollingInstanceMap.get(n).getPollingTimerID();return q.l("".concat(this._n,".getPollingTimerID groupID:").concat(n," timerID:").concat(s)),s}},{key:"hasPollingInstance",value:function(n){return this._pollingInstanceMap.has(n)}},{key:"onRoomCustomData",value:function(v){var s=v.groupID,l=v.sequence,h=v.time,v=v.elements,v=v&&v.content;this._get(30).onRoomCustomDataReceived(v),q.l("".concat(this._n,".onRoomCustomData groupID:").concat(s," sequence:").concat(l," time:").concat(h," data:").concat(v))}},{key:"reset",value:function(n){if(n){q.l("".concat(this._n,".reset groupID:").concat(n));var s=this._pollingInstanceMap.get(n);s&&s.stop(),this._pollingInstanceMap.delete(n),this._joinedGroupMap.delete(n),this._pollingRequestInfoMap.delete(n),this._onlineMemberCountMap.delete(n)}else{q.l("".concat(this._n,".reset all"));var l,h=Z(this._pollingInstanceMap.values());try{for(h.s();!(l=h.n()).done;)l.value.stop()}catch(v){h.e(v)}finally{h.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this.sequencesLinkedList.reset(),this.messageIDLinkedList.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),jo),YI=(p(Rv,[{key:"updateMember",value:function(n){Qe(n.onlineStatus)||(this.isOnline=n.onlineStatus==="Online");var s=[null,void 0,"",0,NaN];n.memberCustomField&&Nd(this.memberCustomField,n.memberCustomField),ni(this,n,["memberCustomField","marks","onlineStatus"],s)}},{key:"updateRole",value:function(n){["Owner","Admin","Member"].indexOf(n)<0||(this.role=n)}},{key:"updateMuteUntil",value:function(n){Qe(n)||(this.muteUntil=Math.floor((Date.now()+1e3*n)/1e3))}},{key:"updateNameCard",value:function(n){Qe(n)||(this.nameCard=n)}},{key:"updateMemberCustomField",value:function(n){n&&Nd(this.memberCustomField,n)}}]),Rv),U1=(p(Av,[{key:"_onProfileUpdated",value:function(n){for(var s=this,l=n.data,h=0;h<l.length;h++)(function(v){var I=l[v];s.groupMemberListMap.forEach(function(k){k.has(I.userID)&&k.get(I.userID).updateMember({nick:I.nick,avatar:I.avatar})})})(h)}},{key:"deleteGroupMemberList",value:function(n){this.groupMemberListMap.delete(n)}},{key:"getGroupMemberList",value:function(P){var s,l=this,h=P.groupID,v=P.role,v=v===void 0?void 0:v,pe=P.offset,I=pe===void 0?0:pe,pe=P.count,k=pe===void 0?15:pe,pe=P.filter,P=pe===void 0?void 0:pe,G="".concat(this._n,".").concat("getGroupMemberList"),pe=this._grpM.hasLocalGroup(h);if(q.l("".concat(G," groupID:").concat(h," role:").concat(v," offset:").concat(I," count:").concat(k," hasLocalGroup:").concat(pe)),!pe)return ln({memberList:[],offset:0});if(this._grpM.getLocalGroupProfile(h).type===O.GRP_AVCHATROOM){if(this._grpM.canIUse(ue.AV_MBR_LIST))return this._getAVChatRoomMemberList({groupID:h,offset:I,filter:P});this._grpM.outputWarning("LiveOnlineMember")}v!==O.GRP_MBR_ROLE_ADMIN&&v!==O.GRP_MBR_ROLE_OWNER&&v!==O.GRP_MBR_ROLE_MEMBER||(s=v);var Y=new it("getGroupMemberList"),te=0,pe={groupID:h,limit:100<k?100:k,memberRoleFilter:s?[s]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER},ye=(Dr({groupID:h})?pe.next="".concat(I):(pe.offset=I,te=I+k),[]);return this._grpM.req({proto:fe.GET_GRP_MBR_LIST,data:pe}).then(function(mt){var mt=mt.data,Ue=mt.members,ut=mt.memberNum,mt=mt.next,mt=mt===void 0?void 0:mt;return Qe(mt)||(te=Ct(mt)?0:mt),Rt(Ue)&&Ue.length!==0?(l._grpM.hasLocalGroup(h)&&(l._grpM.getLocalGroupProfile(h).memberNum=ut),ye=l._updateLocalGroupMemberMap(h,Ue),l._grpM.get(4).getUserProfile({userIDList:Ue.map(function(Kt){return Kt.userID}),tagList:[_n.NICK,_n.AVATAR]})):(te=0,Promise.resolve([]))}).then(function(ve){return ve=ve.data,!Rt(ve)||ve.length===0?ln({memberList:[],offset:te}):(ve=ve.map(function(Ue){return{userID:Ue.userID,nick:Ue.nick,avatar:Ue.avatar}}),l._updateLocalGroupMemberMap(h,ve),ye.length<k&&(te=0),Y.setMessage("groupID:".concat(h," offset:").concat(I," count:").concat(k)).end(),q.l("".concat(G," ok.")),Ut({memberList:ye,offset:te}))}).catch(function(ve){return Y.setError(ve).end(),q.e("".concat(G," failed. error:"),ve),Re(ve)})}},{key:"_getAVChatRoomMemberList",value:function(v){var s=this,l=v.groupID,h=v.offset,v=v.filter,I="".concat(this._n,".").concat("_getAVChatRoomMemberList"),k=new it("_getAVChatRoomMemberList");return k.setMessage("groupID:".concat(l," offset:").concat(h," filter:").concat(v)),this._grpM.req({proto:fe.GET_AV_MBR_LIST,data:{groupID:l,offset:h,filter:v}}).then(function(G){var G=G.data,Y=G.memberList,Y=Y===void 0?[]:Y,G=G.offset,G=G===void 0?0:G,Y=(k.end(),q.l("".concat(I," ok. member count:").concat(Y.length,", next request timestamp:").concat(G)),Y.map(function(te){return i(i({},te),{},{onlineStatus:"Online"})})),Y=s._updateLocalGroupMemberMap(l,Y);return Ut({memberList:Y,offset:G})}).catch(function(P){return k.setError(P).end(),q.e("".concat(I," failed. error:"),P),Re(P)})}},{key:"getGroupMemberProfile",value:function(n){var s=this,l="getGroupMemberProfile",k="".concat(this._n,".").concat(l),h="groupID:".concat(n.groupID),v=(5<n.userIDList.length?h+=" userIDList.length:".concat(n.userIDList.length):h+=" userIDList:".concat(n.userIDList),q.l("".concat(k," ").concat(h)),50<n.userIDList.length&&(n.userIDList=n.userIDList.slice(0,50)),n.groupID),I=n.userIDList,k=this._grpM.getLocalGroupProfile(v);if(k&&Mr(k.type))return Re({code:k=Be.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM,message:this._grpM.getErrorMessage(k,l)});var P=new it(l);return P.setMessage(h),this._getGroupMemberProfileAdvance(i(i({},n),{},{userIDList:I})).then(function(G){return G=G.data.members,Rt(G)&&G.length!==0?(s._updateLocalGroupMemberMap(v,G),s._grpM.get(4).getUserProfile({userIDList:G.map(function(Y){return Y.userID}),tagList:[_n.NICK,_n.AVATAR]})):ln([])}).then(function(G){return G=G.data.map(function(Y){return{userID:Y.userID,nick:Y.nick,avatar:Y.avatar}}),s._updateLocalGroupMemberMap(v,G),G=I.filter(function(Y){return s.hasLocalGroupMember(v,Y)}).map(function(Y){return s.getLocalGroupMemberInfo(v,Y)}),P.end(),Ut({memberList:G})})}},{key:"addGroupMember",value:function(n){var s=this,l="".concat(this._n,".").concat("addGroupMember"),h=n.groupID,v=this._grpM.getLocalGroupProfile(h),I=v.type,k=new it("addGroupMember");return k.setMessage("groupID:".concat(h," groupType:").concat(I)),Mr(I)?(I=new so({code:Be.CANNOT_ADD_MEMBER_IN_AVCHATROOM}),k.setError(I).end(),Re(I)):(n.userIDList=n.userIDList.map(function(P){return{userID:P}}),q.l("".concat(l," groupID:").concat(h)),this._grpM.req({proto:fe.ADD_GRP_MBR,data:n}).then(function(pe){var pe=pe.data.members,G=(q.l("".concat(l," ok")),pe.filter(function(ve){return ve.result===1}).map(function(ve){return ve.userID})),Y=pe.filter(function(ve){return ve.result===0}).map(function(ve){return ve.userID}),te=pe.filter(function(ve){return ve.result===2}).map(function(ve){return ve.userID}),pe=pe.filter(function(ve){return ve.result===4}).map(function(ve){return ve.userID}),ye="groupID:".concat(n.groupID,", ")+"successUserIDList:".concat(G,", ")+"failureUserIDList:".concat(Y,", ")+"existedUserIDList:".concat(te,", ")+"overLimitUserIDList:".concat(pe);return k.setMoreMessage(ye).end(),G.length===0?Ut({successUserIDList:G,failureUserIDList:Y,existedUserIDList:te,overLimitUserIDList:pe}):(s._updateConversationGroupProfile(v),Ut({successUserIDList:G,failureUserIDList:Y,existedUserIDList:te,overLimitUserIDList:pe,group:v}))}).catch(function(P){return k.setError(P).end(),q.e("".concat(l," failed. error:"),P),Re(P)}))}},{key:"deleteGroupMember",value:function(n){var s=this,l="".concat(this._n,".").concat("deleteGroupMember"),h=n.groupID,v=n.userIDList,I=this._grpM.getLocalGroupProfile(h);if(Qe(I))return Re({code:Be.CANNOT_FIND_GRP});if(Mr(I.type))return this._grpM.canIUse(ue.AV_BAN_MBR)?this._banAVChatRoomMember(n):this._grpM.cannotUseCommercialAbility("deleteGroupMember");var k="groupID:".concat(h," ").concat(5<v.length?"userIDList.length:".concat(v.length):"userIDList:".concat(v)),P=(q.l("".concat(l," groupID:").concat(h," userIDList:"),v),new it("deleteGroupMember"));return P.setMessage(k),this._grpM.req({proto:fe.DEL_GRP_MBR,data:n}).then(function(){return P.end(),q.l("".concat(l," ok")),s._updateConversationGroupProfile(I),s.deleteLocalGroupMembers(h,v),Ut({group:I,userIDList:v})}).catch(function(G){return P.setError(G).end(),q.e("".concat(l," failed. error:"),G),Re(G)})}},{key:"_updateConversationGroupProfile",value:function(n){this._grpM.get(11).updateConversationGroupProfile([n])}},{key:"_banAVChatRoomMember",value:function(n){var s=this,l="".concat(this._n,".").concat("_banAVChatRoomMember"),h=n.groupID,v=n.userIDList,I="groupID:".concat(h," ").concat(5<v.length?"userIDList.length:".concat(v.length):"userIDList:".concat(v)),k=new it("_banAVChatRoomMember"),P=(k.setMessage(I),q.l("".concat(l," groupID:").concat(h," userIDList:"),v),this._grpM.getLocalGroupProfile(h));return Qe(n.duration)||n.duration===0?Re({code:Be.BAN_DURATION_INVALID}):this._grpM.req({proto:fe.BAN_AV_MBR,data:n}).then(function(){return k.end(),q.l("".concat(l," ok")),s.deleteLocalGroupMembers(h,v),Ut({group:P,userIDList:v})}).catch(function(G){return k.setError(G).end(),q.e("".concat(l," failed. error:"),G),Re(G)})}},{key:"setGroupMemberMuteTime",value:function(v){var s=this,l=v.groupID,h=v.userID,v=v.muteTime,I="".concat(this._n,".").concat("setGroupMemberMuteTime");if(h===this._grpM.getMyUserID())return Re({code:Be.CANNOT_MUTE_SELF});var k="groupID:".concat(l," userID:").concat(h," muteTime:").concat(v),P=(q.l("".concat(I," ").concat(k)),new it("setGroupMemberMuteTime"));return P.setMessage(k),this.modifyGroupMemberInfo({groupID:l,userID:h,muteTime:v}).then(function(G){P.end(),q.l("".concat(I," ok"));var Y=s._grpM.getLocalGroupProfile(l);return Ut({group:Y,member:G})}).catch(function(G){return P.setError(G).end(),q.e("".concat(I," failed. error:"),G),Re(G)})}},{key:"setGroupMemberRole",value:function(v){var s="".concat(this._n,".").concat("setGroupMemberRole"),l=v.groupID,h=v.userID,v=v.role,I="groupID:".concat(l," userID:").concat(h," role:").concat(v),k=this._grpM.getLocalGroupProfile(l);if(!k||k.type===O.GRP_WORK||k.type===O.GRP_AVCHATROOM)return Re({code:Be.CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM});if(k&&k.selfInfo.role!==O.GRP_MBR_ROLE_OWNER)return Re({code:Be.NOT_OWNER});var P=[O.GRP_MBR_ROLE_ADMIN,O.GRP_MBR_ROLE_MEMBER];if(Dr({groupID:l})&&P.push(O.GRP_MBR_ROLE_CUSTOM),P.indexOf(v)<0)return Re({code:Be.INVALID_MEMBER_ROLE});if(h===this._grpM.getMyUserID())return Re({code:Be.CANNOT_SET_SELF_MEMBER_ROLE});var G=new it("setGroupMemberRole");return G.setMessage(I),q.l("".concat(s," ").concat(I)),this.modifyGroupMemberInfo({groupID:l,userID:h,role:v}).then(function(Y){return G.end(),q.l("".concat(s," ok")),Ut({group:k,member:Y})}).catch(function(Y){return G.setError(Y).end(),q.e("".concat(s," failed. error:"),Y),Re(Y)})}},{key:"_filterProfanity",value:function(n,s){var h=this._grpM.get(29);if(!h)return!0;var h=h.filterText(s[n],"group_member_profile"),l=h.isAllowedToSend,h=h.modifiedText;return l===!0&&(s[n]=h,!0)}},{key:"setGroupMemberNameCard",value:function(G){var s=this,l="setGroupMemberNameCard",h="".concat(this._n,".").concat(l);if(G.nameCard&&this._filterProfanity("nameCard",G)===!1)return Re({code:Be.PROFANITY_FOUND});var v=G.groupID,P=G.userID,I=P===void 0?this._grpM.getMyUserID():P,k=G.nameCard,P="groupID:".concat(v," userID:").concat(I," nameCard:").concat(k),G=(q.l("".concat(h," ").concat(P)),this._grpM.getLocalGroupProfile(v));if(G&&Mr(G.type))return Re({code:G=Be.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM,message:this._grpM.getErrorMessage(G,l)});var Y=new it(l);return Y.setMessage(P),this.modifyGroupMemberInfo({groupID:v,userID:I,nameCard:k}).then(function(te){q.l("".concat(h," ok")),Y.end();var pe=s._grpM.getLocalGroupProfile(v);return I===s._grpM.getMyUserID()&&pe&&pe.setSelfNameCard(k),Ut({group:pe,member:te})}).catch(function(te){return Y.setError(te).end(),q.e("".concat(h," failed. error:"),te),Re(te)})}},{key:"setGroupMemberCustomField",value:function(k){var s=this,l="setGroupMemberCustomField",h="".concat(this._n,".").concat(l),v=k.groupID,I=k.userID,I=I===void 0?this._grpM.getMyUserID():I,k=k.memberCustomField,P="groupID:".concat(v," userID:").concat(I," memberCustomField:").concat(JSON.stringify(k)),G=(q.l("".concat(h," ").concat(P)),this._grpM.getLocalGroupProfile(v));if(G&&Mr(G.type))return Re({code:G=Be.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM,message:this._grpM.getErrorMessage(G,l)});var Y=new it(l);return Y.setMessage(P),this.modifyGroupMemberInfo({groupID:v,userID:I,memberCustomField:k}).then(function(te){Y.end(),q.l("".concat(h," ok"));var pe=s._grpM.getLocalGroupProfile(v);return Ut({group:pe,member:te})}).catch(function(te){return Y.setError(te).end(),q.e("".concat(h," failed. error:"),te),Re(te)})}},{key:"modifyGroupMemberInfo",value:function(n){var s=this,l=n.groupID,h=n.userID,v=void 0;return Qo(l)&&(l=Zo(v=l)),this._grpM.req({proto:fe.MODIFY_GRP_MBR_INFO,data:i(i({},n),{},{groupID:l,topicID:v})}).then(function(){if(s.hasLocalGroupMember(l,h))return I=s.getLocalGroupMemberInfo(l,h),Qe(n.muteTime)||I.updateMuteUntil(n.muteTime),Qe(n.role)||I.updateRole(n.role),Qe(n.nameCard)||I.updateNameCard(n.nameCard),Qe(n.memberCustomField)||I.updateMemberCustomField(n.memberCustomField),I;var I=s._grpM.getLocalGroupProfile(l);return I&&!Mr(I.type)?s.getGroupMemberProfile({groupID:l,userIDList:[h]}).then(function(k){return x(k.data.memberList,1)[0]}):void 0})}},{key:"markGroupMemberList",value:function(I){var s="".concat(this._n,".").concat("markGroupMemberList"),l=I.groupID,h=I.markType,G=I.enableMark,I=I.userIDList,v=I===void 0?[]:I,I="groupID:".concat(l," markType:").concat(h," enableMark:").concat(G," userIDList count:").concat(v.length),k=(q.l("".concat(s," ").concat(I)),2),P=[],G=(G===!0&&(k=1),L(v)),Y=(500<v.length&&(G=v.slice(0,500),q.w("".concat(s," ").concat(Ol(500)))),G.forEach(function(te){P.push({userID:te,markType:[h]})}),G=null,new it("markGroupMemberList"));return Y.setMessage(I),this._grpM.req({proto:fe.MARK_AV_MBR_INFO,data:{groupID:l,operationType:k,memberList:P}}).then(function(ve){var ve=ve.data.memberList,ve=ve===void 0?[]:ve,pe=[],ye=[],ve=(ve.length===v.length?pe.push.apply(pe,L(v)):(ve.forEach(function(Ue){pe.push(Ue.userID)}),v.forEach(function(Ue){pe.includes(Ue)||ye.push(Ue)})),"success count:".concat(pe.length," fail count:").concat(ye.length));return Y.setMessage(ve).end(),q.l("".concat(s," ok. ").concat(ve)),Ut({successUserIDList:pe,failureUserIDList:ye})}).catch(function(te){return Y.setError(te).end(),q.e("".concat(s," failed. error:"),te),Re(te)})}},{key:"_getGroupMemberProfileAdvance",value:function(n){return this._grpM.req({proto:fe.GET_GRP_MBR_PROFILE,data:i(i({},n),{},{memberInfoFilter:n.memberInfoFilter||this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(n,s){var l=this;return Rt(s)&&s.length!==0?s.map(function(h){return l.hasLocalGroupMember(n,h.userID)?l.getLocalGroupMemberInfo(n,h.userID).updateMember(h):l.setLocalGroupMember(n,new YI(h)),l.getLocalGroupMemberInfo(n,h.userID)}):[]}},{key:"deleteLocalGroupMembers",value:function(n,s){var l=this.groupMemberListMap.get(n);l&&s.forEach(function(h){l.delete(h)})}},{key:"getLocalGroupMemberInfo",value:function(n,s){return this.groupMemberListMap.has(n)?this.groupMemberListMap.get(n).get(s):null}},{key:"setLocalGroupMember",value:function(n,s){this.groupMemberListMap.has(n)?this.groupMemberListMap.get(n).set(s.userID,s):(s=new Map().set(s.userID,s),this.groupMemberListMap.set(n,s))}},{key:"getLocalGroupMemberList",value:function(n){return this.groupMemberListMap.get(n)}},{key:"hasLocalGroupMember",value:function(n,s){return this.groupMemberListMap.has(n)&&this.groupMemberListMap.get(n).has(s)}},{key:"hasLocalGroupMemberMap",value:function(n){return this.groupMemberListMap.has(n)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),Av),x1=(p(kv,[{key:"onNewGroupSystemNotice",value:function(l){var v=l.dataList,s=l.isSyncingEnded,l=l.isInstantMessage,v=(q.d("".concat(this._n,".onReceiveSystemNotice count:").concat(v.length)),this.newSystemNoticeStoredAndSummary({notifiesList:v,isInstantMessage:l})),h=v.eventDataList,v=v.result;0<h.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:h,isInstantMessage:l}),this._onReceivedGroupSystemNotice({result:v,isInstantMessage:l})),l?0<v.length&&this._grpM.emitOuterEvent($.MESSAGE_RECEIVED,v):s===!0&&this._clearGroupSystemNotice()}},{key:"newSystemNoticeStoredAndSummary",value:function(n){for(var s=n.notifiesList,l=n.isInstantMessage,h=null,v=s.length,P=0,I=[],k={conversationID:O.CONV_SYSTEM,unreadCount:0,type:O.CONV_SYSTEM,subType:null,lastMessage:null},P=0;P<v;P++){var G=s[P],te=G.groupProfile,Y=te.communityType,te=te.topicID,te=te===void 0?void 0:te,ye=G.elements,pe=ye.topicIDList,pe=pe===void 0?void 0:pe,ye=ye.operationType;if(!((Y===void 0?0:Y)!==2||Ct(te)&&Ct(pe))){if([17,18,20].includes(ye)){this._handleTopicSystemNotice(G);continue}Ct(te)||(G.to=te)}G.elements.operationType!==15&&(G.currentUser=this._grpM.getMyUserID(),G.conversationType=O.CONV_SYSTEM,G.conversationID=O.CONV_SYSTEM,(h=new er(G)).setElement({type:O.MSG_GRP_SYS_NOTICE,content:i(i({},G.elements),{},{groupProfile:i({},G.groupProfile)})}),h.isSystemMessage=!0,(h.sequence===1&&h.random===1||h.sequence===2&&h.random===2)&&(h.sequence=dn(),h.random=dn(),h.generateMessageID(),q.l("".concat(this._n,".newSystemNoticeStoredAndSummary sequence and random maybe duplicated, regenerate. ID:").concat(h.ID))),this._grpM.get(11).pushIntoNoticeResult(I,h)&&(l?k.unreadCount++:h.setIsRead(!0),k.subType=h.conversationSubType))}return k.lastMessage=I[I.length-1],{eventDataList:0<I.length?[k]:[],result:I}}},{key:"_clearGroupSystemNotice",value:function(){var n=this;this._getPendencyList().then(function(l){l.forEach(function(v){n.pendencyMap.set("".concat(v.from,"_").concat(v.groupID,"_").concat(v.to),v)});var l=n._grpM.get(11).getLocalMessageList(O.CONV_SYSTEM),h=[];l.forEach(function(v){var P=v.payload,I=P.operatorID,k=P.operationType,P=P.groupProfile;k===1&&(k="".concat(I,"_").concat(P.groupID,"_").concat(P.to),(I=n.pendencyMap.get(k))&&un(I.handled)&&I.handled!==0&&h.push(v))}),n.deleteGroupSystemNotice({messageList:h})})}},{key:"deleteGroupSystemNotice",value:function(n){var s=this,l="".concat(this._n,".deleteGroupSystemNotice");return Rt(n.messageList)&&n.messageList.length!==0?(q.l("".concat(l," ")+n.messageList.map(function(h){return h.ID})),this._grpM.req({proto:fe.DEL_GRP_SYSTEM_NOTICE,data:{messageListToDelete:n.messageList.map(function(h){return{from:O.CONV_SYSTEM,messageSeq:h.clientSequence,messageRandom:h.random}})}}).then(function(){q.l("".concat(l," ok"));var h=s._grpM.get(11);return n.messageList.forEach(function(v){h.deleteLocalMessage(v)}),Ut()}).catch(function(h){return q.e("".concat(l," error:"),h),Re(h)})):ln()}},{key:"_getPendencyList",value:function(){var n=this,h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},s=h.type,l=h.startTime,h=h.limit;return this._grpM.req({proto:fe.GET_GRP_PENDENCY,data:{type:s===void 0?void 0:s,startTime:l===void 0?0:l,limit:h===void 0?20:h,handleAccount:this._grpM.getMyUserID()}}).then(function(v){var I=v.data.pendencyList;return v.data.nextStartTime!==0?n._getPendencyList({startTime:v.data.nextStartTime}).then(function(k){return[].concat(L(I),L(k))}):I})}},{key:"getGroupApplicationList",value:function(){var n=this;return this._getPendencyList().then(function(s){return n._getPendencyList({type:O.GRP_COMMUNITY}).then(function(l){return s.push.apply(s,L(l)),n._handlePendencyResult(s)}).catch(function(l){return n._handlePendencyResult(s)})})}},{key:"_handlePendencyResult",value:function(n){var s=this,l=[];return n.forEach(function(h){s.pendencyMap.set("".concat(h.from,"_").concat(h.groupID,"_").concat(h.to),h),h.handled===0&&l.push({applicant:h.from,applicantNick:h.fromUserNickName,groupName:h.groupName,groupID:h.groupID,authentication:h.authentication,messageKey:h.time,applicationType:h.applicationType,userID:h.userID,note:h.note})}),ln({applicationList:l})}},{key:"_onReceivedGroupSystemNotice",value:function(n){var s=this,l=n.result;n.isInstantMessage&&l.forEach(function(h){switch(h.payload.operationType){case 1:break;case 2:s._onApplyJoinGroup(h);break;case 3:break;case 4:s._onMemberKicked(h);break;case 5:s._onGroupDismissed(h);break;case 6:break;case 7:s._onInviteGroup(h);break;case 8:s._onQuitGroup(h);break;case 9:s._onSetManager(h);break;case 10:s._onDeleteManager(h);break;case 11:case 12:case 15:break;case 20:s._onMessageRemindTypeSynced(h);break;case 21:s._grpM.onAVChatRoomMemberBanned(h)}})}},{key:"_onApplyJoinGroup",value:function(h){var s=this,h=h.payload.groupProfile,l=h.groupID,h=h.groupType,v=this._grpM.hasLocalGroup(l);q.l("".concat(this._n,"._onApplyJoinGroup groupID:").concat(l," groupType:").concat(h," hasGroup:").concat(v)),v||Mr(h)||this._grpM.getGroupProfile({groupID:l}).then(function(k){var k=k.data.group;k&&(s._grpM.updateGroupMap([k]),k=!k.isSupportTopic,s._grpM.emitGroupListUpdate(!0,k))})}},{key:"_onMemberKicked",value:function(n){n=n.payload.groupProfile.groupID,this._grpM.hasLocalGroup(n)&&this._grpM.deleteLocalGroupAndConversation(n)}},{key:"_onGroupDismissed",value:function(s){var s=s.payload.groupProfile.groupID,l=(this._grpM.hasLocalGroup(s)&&this._grpM.deleteLocalGroupAndConversation(s),this._grpM._AVChatRoomHandler);l&&l.checkJoinedAVChatRoomByID(s)&&l.reset(s)}},{key:"_onInviteGroup",value:function(h){var s=this,l=h.payload.groupProfile.groupID,h=this._grpM.hasLocalGroup(l);q.l("".concat(this._n,"._onInviteGroup groupID:").concat(l," hasGroup:").concat(h)),this._grpM.getGroupProfile({groupID:l}).then(function(){s._grpM.emitGroupListUpdate(),s._grpM.get(11).recoverMessageOnInviteGroup("".concat(O.CONV_GROUP).concat(l))})}},{key:"_onQuitGroup",value:function(l){var l=l.payload.groupProfile,s=l.groupID,l=l.groupType,h=this._grpM.hasLocalGroup(s);q.l("".concat(this._n,"._onQuitGroup groupID:").concat(s," groupType:").concat(l," hasGroup:").concat(h)),h&&this._grpM.deleteLocalGroupAndConversation(s)}},{key:"_onSetManager",value:function(l){var l=l.payload.groupProfile,s=l.to,l=l.groupID,l=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(l,s);l&&l.updateRole(O.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(l){var l=l.payload.groupProfile,s=l.to,l=l.groupID,l=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(l,s);l&&l.updateRole(O.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(l){var s=l.payload.groupProfile.groupID,l=l.payload.messageRemindType;this._grpM.get(11).onGroupMessageRemindTypeUpdated({groupID:s,messageRemindType:l})}},{key:"_handleTopicSystemNotice",value:function(I){var l=I.groupProfile,s=l.groupID,l=l.topicID,I=I.elements,h=I.operationType,v=I.topicIDList,I=I.messageRemindType,k=this._grpM.get(10);h===17?k.onTopicCreated({groupID:s,topicID:l}):h===18?k.onTopicDeleted({groupID:s,topicIDList:v}):h===20&&k.onTopicMessageRemindTypeUpdated({groupID:s,topicID:l,messageRemindType:I})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),kv),F1=["relayFlag"],V1=(_(lh,Uo),qI=D(lh),p(lh,[{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("polling_interval"),s=this.getCloudConfig("polling_interval_plus"),l=this.getCloudConfig("polling_no_msg_count"),h=this.getCloudConfig("polling_simplified_msg"),v=this.getCloudConfig("paging_grp_count");q.l("".concat(this._n,"._onCloudConfigUpdated pollingInterval:").concat(n)+" pollingIntervalPlus:".concat(s," pollingNoMessageCount:").concat(l)+" pollingSimplifiedMessage:".concat(h," pagingGroupCount:").concat(v)),this._AVChatRoomHandler.setPollingInterval(n),this._AVChatRoomHandler.setPollingIntervalPlus(s),this._AVChatRoomHandler.setPollingNoMessageCount(l),this._AVChatRoomHandler.setPollingSimplifiedMessage(h),this._commonGroupHandler.setPagingGroupCount(v)}},{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(n),this._groupTipsHandler.onCheckTimer(n))}},{key:"guardForAVChatRoom",value:function(n){var s,l=this;return n.conversationType===O.CONV_GROUP?(s=Qo(n.to)?Zo(n.to):n.to,this.hasLocalGroup(s)?ln():this.getGroupProfile({groupID:s}).then(function(v){var v=v.data.group.type;return q.l("".concat(l._n,".guardForAVChatRoom. groupID:").concat(s," type:").concat(v)),v===O.GRP_AVCHATROOM?Re(new so({code:v=Be.MSG_SEND_FAIL_NOT_IN_AVCHATROOM,message:l.getErrorMessage(v,n.from,s),data:{message:n}})):ln()})):ln()}},{key:"checkJoinedAVChatRoomByID",value:function(n){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n)}},{key:"onNewGroupMessage",value:function(n){this._commonGroupHandler.onNewGroupMessage(n)}},{key:"updateNextMessageSeq",value:function(n){var s,l=this;Rt(n)&&(s=this.get(10),n.forEach(function(h){var v=h.conversationID.replace(O.CONV_GROUP,"");Qo(v)&&s.updateLastMessage(v,h.lastMessage),l.groupMap.has(v)&&(l.groupMap.get(v).nextMessageSeq=h.lastMessage.sequence+1)}))}},{key:"onNewGroupTips",value:function(n){this._groupTipsHandler.onNewGroupTips(n)}},{key:"onGroupMessageRevoked",value:function(n){this._commonGroupHandler.onGroupMessageRevoked(n)}},{key:"onNewGroupSystemNotice",value:function(n){this._groupSystemNoticeHandler.onNewGroupSystemNotice(n)}},{key:"onGroupMessageReadNotice",value:function(n){var s=this;n.dataList.forEach(function(v){var h,v=v.elements.groupMessageReadNotice;Qe(v)||(h=s.get(11),v.forEach(function(P){var G=P.groupID,k=P.topicID,k=k===void 0?void 0:k,P=P.lastMessageSeq,G=(q.d("".concat(s._n,".onGroupMessageReadNotice groupID:").concat(G," lastMessageSeq:").concat(P)),"".concat(O.CONV_GROUP).concat(G)),Y=!0;Ct(k)||(G="".concat(O.CONV_GROUP).concat(k),Y=!1),h.updateIsReadAfterReadReport({conversationID:G,lastMessageSeq:P}),h.updateUnreadCount(G,Y),h.clearGroupAtInfoList(G,Y)}))})}},{key:"onReadReceiptList",value:function(n){var s=this;q.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(n)),n.dataList.forEach(function(I){var h=I.groupProfile,I=I.elements,h=h.groupID,v=s.get(11),I=I.readReceiptList;v.updateReadReceiptInfo({groupID:h,readReceiptList:I})})}},{key:"onGroupMessageModified",value:function(n){q.d("".concat(this._n,".onGroupMessageModified options:"),JSON.stringify(n));var s=this.get(11);n.dataList.forEach(function(l){s.onMessageModified(i(i({},l),{},{conversationType:O.CONV_GROUP,to:l.topicID||l.groupID}))})}},{key:"deleteGroupSystemNotice",value:function(n){this._groupSystemNoticeHandler.deleteGroupSystemNotice(n)}},{key:"initGroupMap",value:function(n){this.groupMap.set(n.groupID,new fa(n))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(n){this.groupMap.delete(n)}},{key:"updateGroupMap",value:function(n){var s,l=this,h=this.get(11);n.forEach(function(G){s=G.groupID,l.groupMap.has(s)?l.groupMap.get(s).updateGroup(G):(l.groupMap.set(s,new fa(G)),h.deleteGroupRoamingMessageInfo(s))});var v,I=this.getMyUserID(),k=Z(this.groupMap);try{for(k.s();!(v=k.n()).done;){var P=x(v.value,2)[1];P.selfInfo.userID=I,P.selfInfo.role==="Owner"&&(P.ownerID=I)}}catch(G){k.e(G)}finally{k.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return L(this.groupMap.values()).filter(function(n){return n.type!==O.GRP_ROOM&&n.type!==O.GRP_LIVE})}},{key:"getLocalGroupProfile",value:function(n){return this.groupMap.get(n)}},{key:"sortLocalGroupList",value:function(){var n=L(this.groupMap).filter(function(s){return s=x(s,2),s[0],!Ct(s[1].lastMessage)});n.sort(function(s,l){return l[1].lastMessage.lastTime-s[1].lastMessage.lastTime}),this.groupMap=new Map(L(n))}},{key:"updateGroupLastMessage",value:function(n){this._commonGroupHandler.handleUpdateGroupLastMessage(n)}},{key:"emitGroupListUpdate",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],l=this.getLocalGroupList();n&&this.emitOuterEvent($.GROUP_LIST_UPDATED),s&&(n=JSON.parse(JSON.stringify(l)),this.get(11).updateConversationGroupProfile(n))}},{key:"getMyNameCardByGroupID",value:function(n){return n=this.getLocalGroupProfile(n),n?n.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMessageRemindType",value:function(n){var s=this;!Rt(n)||n.length===0||(n=n.filter(function(l){return!Mr(s.getLocalGroupProfile(l).type)})).length!==0&&(q.l("".concat(this._n,".getMessageRemindType groupIDList:").concat(n)),this.getGroupProfileAdvance({groupIDList:n,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then(function(h){var h=h.data.successGroupList,v=s.get(11);h.forEach(function(I){v.onGroupMessageRemindTypeUpdated({groupID:I.groupID,messageRemindType:Rt(I.members)?I.members[0].messageRemindType:""})})}))}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(n){var s=this,l="".concat(this._n,".").concat("getGroupProfile"),h=new it("getGroupProfile"),v=n.groupID,I=n.groupCustomFieldFilter;return q.l("".concat(l," groupID:").concat(v)),this.getGroupProfileAdvance({groupIDList:[v],responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],groupCustomFieldFilter:I,memberInfoFilter:["Role","JoinTime","MsgSeq","MsgFlag","NameCard"]}}).then(function(G){var G=G.data,P=G.successGroupList,G=G.failureGroupList;return q.l("".concat(l," ok")),0<G.length?Re(G[0]):((G=Mr(P[0].type)&&!s.hasLocalGroup(v)?new fa(P[0]):(s.updateGroupMap(P),s.getLocalGroupProfile(v))).isSupportTopic||s.get(11).updateConversationGroupProfile([G]),h.setMessage("groupID:".concat(v," type:").concat(G.type," muteAllMembers:").concat(G.muteAllMembers," ownerID:").concat(G.ownerID)).end(),Ut({group:G}))}).catch(function(k){return h.setError(k).setMessage("groupID:".concat(n.groupID)).end(),q.e("".concat(l," failed. error:"),k),Re(k)})}},{key:"getGroupProfileAdvance",value:function(n){var s,l="".concat(this._n,".getGroupProfileAdvance"),I=n.groupIDList,h=(Rt(I)&&50<I.length&&(this.outputWarning("GetGroupProfileLimit"),I.length=50),[]),v=[],I=(I.forEach(function(k){(Dr({groupID:k})?v:h).push(k)}),[]);return 0<h.length&&(s=this._getGroupProfileAdvance(i(i({},n),{},{groupIDList:h})),I.push(s)),0<v.length&&(s=this._getGroupProfileAdvance(i(i({},n),{},{groupIDList:v,relayFlag:0<h.length})),I.push(s)),Promise.all(I).then(function(k){var P=[],G=[];return k.forEach(function(Y){P.push.apply(P,L(Y.successGroupList)),G.push.apply(G,L(Y.failureGroupList))}),Ut({successGroupList:P,failureGroupList:G})}).catch(function(k){return q.e("".concat(l," failed. error:"),k),Re(k)})}},{key:"_getGroupProfileAdvance",value:function(n){var s=this,l=n.relayFlag,h=l!==void 0&&l,v=E(n,F1);return this.req({proto:fe.GET_GRP_PROFILE,data:v}).then(function(I){return q.l("".concat(s._n,"._getGroupProfileAdvance ok. options:"),v),I=I.data.groups,{successGroupList:I.filter(function(k){return Qe(k.errorCode)||k.errorCode===0}),failureGroupList:I.filter(function(k){return k.errorCode&&k.errorCode!==0}).map(function(k){return new so({code:k.errorCode,message:k.errorInfo,data:{groupID:k.groupID}})})}}).catch(function(I){return h&&Dr({groupID:n.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:Re(I)})}},{key:"createGroup",value:function(n){var s=this,l=[O.GRP_PUBLIC,O.GRP_WORK,O.GRP_MEETING,O.GRP_AVCHATROOM,O.GRP_COMMUNITY],h="".concat(this._n,".").concat("createGroup"),v=n.type,I=n.groupID;if(n.name&&this._filterProfanity("name",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.introduction&&this._filterProfanity("introduction",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.notification&&this._filterProfanity("notification",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(!l.includes(v))return Re({code:Be.ILLEGAL_GRP_TYPE});if(!Dr({type:v})){if(!Ct(I)&&Dr({groupID:I}))return Re({code:Be.ILLEGAL_GRP_ID});n.isSupportTopic=void 0}if(Mr(v)&&!Qe(n.memberList)&&0<n.memberList.length&&(n.memberList=void 0),this._canIUseJoinOption(v)||Qe(n.joinOption)||(n.joinOption=void 0),Dr({type:v})){if(!Ct(I)&&!Dr({groupID:I}))return Re({code:Be.ILLEGAL_GRP_ID});n.isSupportTopic=n.isSupportTopic===!0?1:0}var k=new it("createGroup"),P=(q.l("".concat(h," options:"),n),null),G=[];return this.req({proto:fe.CREATE_GRP,data:i(i({},n),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then(function(ye){var ye=ye.data,te=ye.groupID,ye=ye.overLimitUserIDList,pe=ye===void 0?[]:ye,ye=(P=te,G=pe,"groupType:".concat(n.type," groupID:").concat(te," overLimitUserIDList:").concat(pe));if(k.setMessage(ye).end(),q.l("".concat(h," ok. ").concat(ye)),n.type===O.GRP_AVCHATROOM)return s.getGroupProfile({groupID:te});if(n.type===O.GRP_COMMUNITY&&n.isSupportTopic===1)return s.getGroupProfile({groupID:te});Ct(n.memberList)||Ct(pe)||(n.memberList=n.memberList.filter(function(mt){return pe.indexOf(mt.userID)===-1})),s.updateGroupMap([i(i({},n),{},{groupID:te})]);var ye=s.get(2),ut="",ve=0,Ue=(n.type===O.GRP_COMMUNITY?(ut=s.isIntl()?"Create Community":"创建社群",ve=1):ut=s.isIntl()?"Create Group":"创建群组",s.get(4).getMyNick()),ut=ye.createCustomMessage({to:te,conversationType:O.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:ut,cmd:ve,opUser:Ue||s.getMyUserID(),version:4})}});return ye.sendMessageInstance(ut),s.emitGroupListUpdate(),s.getGroupProfile({groupID:te})}).then(function(te){var te=te.data.group,ye=te.selfInfo,pe=ye.nameCard,ye=ye.joinTime;return te.updateSelfInfo({nameCard:pe,joinTime:ye,messageRemindType:O.MSG_REMIND_ACPT_AND_NOTE,role:O.GRP_MBR_ROLE_OWNER}),Ut({group:te,overLimitUserIDList:G})}).catch(function(Y){var te;return k.setMessage("groupType:".concat(n.type)).setError(Y).end(),Y.code===10010||Y.code===10007?(s._silentlyGetGroupProfile(Y.code,P),s.updateGroupMap([i(i({},n),{},{groupID:P})]),(te=s.getLocalGroupProfile(P)).selfInfo.role=O.GRP_MBR_ROLE_OWNER,Ut({group:te,overLimitUserIDList:G})):(q.e("".concat(h," failed. error:"),Y),Re(Y))})}},{key:"dismissGroup",value:function(n){var s=this,l="".concat(this._n,".").concat("dismissGroup"),h="groupID:".concat(n);if(this.hasLocalGroup(n)&&this.getLocalGroupProfile(n).type===O.GRP_WORK)return Re(new so({code:Be.CANNOT_DISMISS_WORK}));var v=new it("dismissGroup");return v.setMessage(h),q.l("".concat(l," ").concat(h)),this.req({proto:fe.DISMISS_GRP,data:{groupID:n}}).then(function(){return v.end(),q.l("".concat(l," ok")),s.deleteLocalGroupAndConversation(n),s.checkJoinedAVChatRoomByID(n)&&s._AVChatRoomHandler.reset(n),s._groupAttributesHandler.deleteLocalGroupAttributes(n),Ut({groupID:n})}).catch(function(I){return v.setError(I).end(),q.e("".concat(l," failed. error:"),I),Re(I)})}},{key:"updateGroupProfile",value:function(n){var s,l=this,h="".concat(this._n,".").concat("updateGroupProfile");if(this.hasLocalGroup(n.groupID)&&(s=this.getLocalGroupProfile(n.groupID).type,this._canIUseJoinOption(s)||Qe(n.joinOption)||(q.w("".concat(h," joinOption is unavailable for Work/Meeting/AVChatRoom")),n.joinOption=void 0)),Qe(n.muteAllMembers)||(n.muteAllMembers?n.muteAllMembers="On":n.muteAllMembers="Off"),n.name&&this._filterProfanity("name",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.introduction&&this._filterProfanity("introduction",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.notification&&this._filterProfanity("notification",n)===!1)return Re({code:Be.PROFANITY_FOUND});var v=new it("updateGroupProfile");return v.setMessage(JSON.stringify(n)),q.l("".concat(h," groupID:").concat(n.groupID)),this.req({proto:fe.UPDATE_GRP_PROFILE,data:n}).then(function(){return v.end(),q.l("".concat(h," ok")),l.hasLocalGroup(n.groupID)&&l.groupMap.get(n.groupID).updateGroup(n),Ut({group:l.groupMap.get(n.groupID)})}).catch(function(I){return v.setError(I).end(),q.l("".concat(h," failed. error:"),I),Re(I)})}},{key:"_filterProfanity",value:function(n,s){var h=this.get(29);if(!h)return!0;var h=h.filterText(s[n],me),l=h.isAllowedToSend,h=h.modifiedText;return l===!0&&(s[n]=h,!0)}},{key:"joinGroup",value:function(n){var s=this,l=n.groupID,h=n.type,v="".concat(this._n,".joinGroup");if(h===O.GRP_WORK)return Re({code:Be.CANNOT_JOIN_WORK});if(this.deleteUnjoinedAVChatRoom(l),this.hasLocalGroup(l)){if(!this.isLoggedIn())return ln({status:O.JOIN_STATUS_ALREADY_IN_GROUP});var I=new it("applyJoinGroup");return this.getGroupProfile({groupID:l}).then(function(){return I.setMessage("groupID:".concat(l," joinedStatus:").concat(O.JOIN_STATUS_ALREADY_IN_GROUP)).end(),ln({status:O.JOIN_STATUS_ALREADY_IN_GROUP})}).catch(function(k){return I.setMessage("groupID:".concat(l," unjoined")).end(),q.w("".concat(v," ").concat(l," was unjoined, now join!")),s.groupMap.delete(l),s.applyJoinGroup(n)})}return q.l("".concat(v," groupID:").concat(l)),this.isLoggedIn()?this.applyJoinGroup(n):this._AVChatRoomHandler.joinWithoutAuth(n)}},{key:"applyJoinGroup",value:function(I){var s=this,l="".concat(this._n,".").concat("applyJoinGroup"),h=I.groupID;if(!Ct(I.applyMessage)&&this._filterProfanity("applyMessage",I)===!1)return Re({code:Be.PROFANITY_FOUND});var v=new it("applyJoinGroup"),I=i({},I),k=this.canIUse(ue.AV_HISTORY_MSG);return k&&(I.historyMessageFlag=1),this.get(11).deleteTopicRoamingMessageInfo(h),this.req({proto:fe.APPLY_JOIN_GRP,data:I}).then(function(Ue){var Ue=Ue.data,G=Ue.joinedStatus,Y=Ue.longPollingKey,te=Ue.startSeq,pe=Ue.avChatRoomFlag,ye=Ue.avChatRoomKey,ve=Ue.messageList,Ue="groupID:".concat(h," joinedStatus:").concat(G," longPollingKey:").concat(Y," startSeq:").concat(te)+" avChatRoomFlag:".concat(pe," canGetAVChatRoomHistoryMessage:").concat(k,",")+" history message count:".concat(Ct(ve)?0:ve.length);switch(v.setMessage(Ue).end(),q.l("".concat(l," ok. ").concat(Ue)),G){case ca:return Ut({status:ca});case sr:return s.getGroupProfile({groupID:h}).then(function(mt){return mt=mt.data.group,s._handleJoinResult({group:mt,avChatRoomFlag:pe,longPollingKey:Y,startSeq:te,avChatRoomKey:ye,messageList:ve})}).catch(function(mt){var Kt;return mt.code===10010||mt.code===10007?(s._silentlyGetGroupProfile(mt.code,h),Kt=new fa({groupID:h}),s.updateGroupMap([Kt]),s._handleJoinResult({group:Kt,avChatRoomFlag:pe,longPollingKey:Y,startSeq:te,avChatRoomKey:ye,messageList:ve})):(q.e("".concat(l," failed. error:"),mt),Re(mt))});default:var ut=new so({code:Be.JOIN_GRP_FAIL});return q.e("".concat(l," failed. error:"),ut),Re(ut)}}).catch(function(P){return v.setMessage("groupID:".concat(h)).setError(P).end(),q.e("".concat(l," failed. error:"),P),Re(P)})}},{key:"_handleJoinResult",value:function(n){var s=this,l=n.group,h=n.avChatRoomFlag,v=n.longPollingKey,I=n.startSeq,k=n.avChatRoomKey,P=n.messageList,G=l.groupID;return h===1?(this.get(11).setCompleted("".concat(O.CONV_GROUP).concat(G)),this._groupAttributesHandler.initGroupAttributesCache({groupID:G,avChatRoomKey:k}),this._groupCountersHandler.initGroupCountersCache({groupID:G,avChatRoomKey:k}),(n=Qe(v)?this._AVChatRoomHandler.handleJoinResult({group:l}):this._AVChatRoomHandler.startRunLoop({group:l,longPollingKey:v,startSeq:I})).then(function(){s._onAVChatRoomHistoryMessage(P,G)}),n):(this.emitGroupListUpdate(!0,!1),Ut({status:sr,group:l}))}},{key:"quitGroup",value:function(n){var s=this,l="".concat(this._n,".").concat("quitGroup"),h="groupID:".concat(n),v=(q.l("".concat(l," ").concat(h)),this.checkJoinedAVChatRoomByID(n));if(!v&&!this.hasLocalGroup(n))return Re({code:Be.MEMBER_NOT_IN_GRP});if(v&&!this.isLoggedIn())return q.l("".concat(l," anonymously ok. ").concat(h)),this.deleteLocalGroupAndConversation(n),this._AVChatRoomHandler.reset(n),ln({groupID:n});var I=new it("quitGroup");return I.setMessage(h),this.req({proto:fe.QUIT_GRP,data:{groupID:n}}).then(function(){return I.end(),q.l("".concat(l," ok")),s.deleteLocalGroupAndConversation(n),v&&s._AVChatRoomHandler.reset(n),s._groupAttributesHandler.deleteLocalGroupAttributes(n),Ut({groupID:n})}).catch(function(k){return I.setError(k).end(),q.e("".concat(l," failed. error:"),k),Re(k)})}},{key:"searchGroupByID",value:function(n){var s="".concat(this._n,".").concat("searchGroupByID"),l={groupIDList:[n]},h=new it("searchGroupByID");return h.setMessage("groupID:".concat(n)),q.l("".concat(s," groupID:").concat(n)),this.req({proto:fe.SEARCH_GRP,data:l}).then(function(v){if(v=v.data.groupProfile,v[0].errorCode!==0)throw new so({code:v[0].errorCode,message:v[0].errorInfo});return h.end(),q.l("".concat(s," ok")),Ut({group:new fa(v[0])})}).catch(function(v){return h.setError(v).end(),q.w("".concat(s," failed. error:"),v),Re(v)})}},{key:"changeGroupOwner",value:function(n){var s=this,l="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(n.groupID)&&this.getLocalGroupProfile(n.groupID).type===O.GRP_AVCHATROOM)return Re({code:Be.CANNOT_CHANGE_OWNER_IN_AVCHATROOM});if(n.newOwnerID===this.getMyUserID())return Re({code:Be.CANNOT_CHANGE_OWNER_TO_SELF});var h=new it("changeGroupOwner");return h.setMessage("groupID:".concat(n.groupID," newOwnerID:").concat(n.newOwnerID)),q.l("".concat(l," groupID:").concat(n.groupID)),this.req({proto:fe.CHANGE_GRP_OWNER,data:n}).then(function(){h.end(),q.l("".concat(l," ok"));var v,I=n.groupID,k=n.newOwnerID,P=(s.groupMap.get(I).ownerID=k,s._groupMemberHandler.getLocalGroupMemberList(I));return P instanceof Map&&(v=P.get(s.getMyUserID()),Qe(v)||(v.updateRole("Member"),s.groupMap.get(I).selfInfo.role="Member"),v=P.get(k),Qe(v)||v.updateRole("Owner")),s.emitGroupListUpdate(!0,!1),Ut({group:s.groupMap.get(I)})}).catch(function(v){return h.setError(v).end(),q.e("".concat(l," failed. error:"),v),Re(v)})}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(n){var s,l,h,v,I,k=this,P="".concat(this._n,".").concat("handleGroupApplication"),G=n.handleAction,Y=n.handleMessage,te=n.message,pe=n.application,ye=(te?(s=te.payload.operatorID,l=te.payload.groupProfile.groupID,h=te.payload.authentication,v=te.payload.messageKey):pe&&(s=pe.applicant,l=pe.groupID,h=pe.authentication,v=pe.messageKey),fe.HANDLE_GRP_APPLICATION),ve=(pe&&pe.applicationType===2&&(ye=fe.HANDLE_INVITE_JOIN_GRP,I=pe.userID),new it("handleGroupApplication"));return ve.setMessage("groupID:".concat(l)),q.l("".concat(P," groupID:").concat(l)),this.req({proto:ye,data:{handleAction:G,handleMessage:Y,applicant:s,invitee:I,groupID:l,authentication:h,messageKey:v}}).then(function(){return ve.end(),q.l("".concat(P," ok")),te&&k._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[n.message]}),Ut({group:k.getLocalGroupProfile(l)})}).catch(function(Ue){return ve.setError(Ue).end(),q.e("".concat(P," failed. error"),Ue),Re(Ue)})}},{key:"handleGroupInvitation",value:function(n){var s=this,l="".concat(this._n,".").concat("handleGroupInvitation"),k=n.message.payload,h=k.groupProfile.groupID,v=k.authentication,I=k.messageKey,k=k.operatorID,P=n.handleAction,G=new it("handleGroupInvitation");return G.setMessage("groupID:".concat(h," inviter:").concat(k," handleAction:").concat(P)),q.l("".concat(l," groupID:").concat(h," inviter:").concat(k," handleAction:").concat(P)),this.req({proto:fe.HANDLE_GRP_INVITATION,data:i(i({},n),{},{inviter:k,groupID:h,authentication:v,messageKey:I})}).then(function(){return G.end(),q.l("".concat(l," ok")),s._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[n.message]}),Ut({group:s.getLocalGroupProfile(h)})}).catch(function(Y){return G.setError(Y).end(),q.e("".concat(l," failed. error"),Y),Re(Y)})}},{key:"getGroupOnlineMemberCount",value:function(n){var s=this,l="".concat(this._n,".getGroupOnlineMemberCount"),h=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n),v=this.hasLocalGroup(n);if(q.l("".concat(l," groupID:").concat(n," isAVChatRoom:").concat(h," has:").concat(v)),h)return this._AVChatRoomHandler.getGroupOnlineMemberCount(n);if(!v)return ln({memberCount:0});if(h=Date.now(),this._onlineMemberCountMap.has(n)){if(v=this._onlineMemberCountMap.get(n),h-v.lastReqTime<=6e4)return ln({memberCount:v.memberCount});v.lastReqTime=h}return this.requestOnlineCount(n).then(function(I){return I=I.data.memberCount,I=I===void 0?0:I,s._onlineMemberCountMap.set(n,{lastReqTime:Date.now(),memberCount:I}),q.l("".concat(l," ok. groupID:").concat(n," memberCount:").concat(I)),ln({memberCount:I})}).catch(function(I){return q.w("".concat(l," failed. error:"),I),Promise.reject(I)})}},{key:"requestOnlineCount",value:function(n){return this.req({proto:fe.GET_ONLINE_MBR_NUM,data:{groupID:n}})}},{key:"hasLocalGroup",value:function(n){return this.groupMap.has(n)}},{key:"deleteLocalGroupAndConversation",value:function(n){var s,l=this.checkJoinedAVChatRoomByID(n),h=(q.l("".concat(this._n,".deleteLocalGroupAndConversation groupID:").concat(n," isJoinedAVChatRoom:").concat(l)),this.get(11)),v="".concat(O.CONV_GROUP).concat(n);l&&h.deleteLocalConversation(v),Dr({groupID:n})&&(s=this.getLocalGroupProfile(n))&&s.isSupportTopic===!0&&this.get(10).deleteTopicListInCommunity(n),h.clearUnreadCount(v),this._deleteLocalGroup(n),this._onlineMemberCountMap.delete(n),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(n){this.groupMap.delete(n),this._groupMemberHandler.deleteGroupMemberList(n)}},{key:"sendMessage",value:function(n,s){return Rt(n._receiverList)&&0<n._receiverList.length&&!this.canIUse(ue.MSG_TO_SPECIFIED_GRP_MBR)?this.cannotUseCommercialAbility("group direct messages"):(n=this.createGroupMessagePack(n,s),this.req(n))}},{key:"createGroupMessagePack",value:function(n,G){var l=null,h=(G&&G.offlinePushInfo&&(l=G.offlinePushInfo),""),v=(Sn(n.cloudCustomData)&&0<n.cloudCustomData.length&&(h=n.cloudCustomData),[]),I=(xn(G)&&xn(G.messageControlInfo)&&(I=(P=G.messageControlInfo).excludedFromUnreadCount,k=P.excludedFromLastMessage,P=P.excludedFromContentModeration,I===!0&&v.push("NoUnread"),k===!0&&v.push("NoLastMsg"),P===!0&&v.push("NoMsgCheck")),void 0),k=(Rt(n._receiverList)&&0<n._receiverList.length&&(I=n._receiverList,50<n._receiverList.length&&(I=n._receiverList.slice(0,50),this.outputWarning("ReceiverListLimit"))),this.isOnlineMessage(n,G)?1:0),P=n.getGroupAtInfoList(),G={fromAccount:this.getMyUserID(),groupID:n.to,msgBody:n.getElements(),cloudCustomData:h,random:n.random,priority:n.priority,clientSequence:n.clientSequence,groupAtInfo:n.type!==O.MSG_TEXT||Ct(P)?void 0:P,onlineOnlyFlag:k,clientTime:n.clientTime,offlinePushInfo:mp(l),messageControlInfo:k==0?v:void 0,needReadReceipt:n.needReadReceipt!==!0||this.isMessageFromOrToAVChatroom(n.to)?0:1,receiverList:I,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0,cmConfigID:n._cmConfigID};return Qo(n.to)&&(G.groupID=Zo(n.to),G.topicID=n.to),{proto:fe.SEND_GRP_MSG,tjgID:this.generateTjgID(n),data:G}}},{key:"revokeMessage",value:function(n){var s={groupID:n.to,msgSeqList:[{msgSeq:n.sequence}]};return Qo(n.to)&&(s.groupID=Zo(n.to),s.topicID=n.to),this.req({proto:fe.REVOKE_GRP_MSG,data:s})}},{key:"deleteMessage",value:function(l){var s=l.to,l=l.keyList,l=(q.l("".concat(this._n,".deleteMessage groupID:").concat(s," count:").concat(l.length)),{groupID:s,deleter:this.getMyUserID(),keyList:l});return Qo(s)&&(l.groupID=Zo(s),l.topicID=s),this.req({proto:fe.DEL_GRP_MSG,data:l})}},{key:"modifyRemoteMessage",value:function(I){var G=I.to,s=I.sequence,l=I.payload,h=I.type,v=I.version,v=v===void 0?0:v,I=I.cloudCustomData,k=G,P=void 0,G=(Qo(G)&&(k=Zo(G),P=G),void 0);return OI(h)&&(G=[]).push({type:h,content:l}),this.req({proto:fe.MODIFY_GRP_MSG,data:{groupID:k,topicID:P,sequence:s,version:v,elements:G,cloudCustomData:I}})}},{key:"getRoamingMessage",value:function(I){var s=this,l="".concat(this._n,".getRoamingMessage"),h=I.conversationID,v=I.groupID,I=I.sequence,k=new it("getGroupRoamingMessages"),P=0,G=void 0;return Qo(v)&&(v=Zo(G=v)),this._computeLastSequence({groupID:v,topicID:G,sequence:I}).then(function(Y){return P=Y,q.l("".concat(l," groupID:").concat(v," startSequence:").concat(P)),s.req({proto:fe.GET_GRP_ROAMING_MSG,data:{groupID:v,count:21,sequence:P,topicID:G}})}).then(function(ve){var ye=ve.data,te=ye.messageList,pe=ye.complete,ye=ye.invisibleSequenceList,ye=ye===void 0?[]:ye,ve=ve.data.nextSequence,ve=ve===void 0?0:ve,Ue=(Qe(te)?q.l("".concat(l," ok. complete:").concat(pe," nextSequence:").concat(ve," but messageList is undefined!")):q.l("".concat(l," ok. complete:").concat(pe," nextSequence:").concat(ve," count:").concat(te.length)),k.setMessage("groupID:".concat(v," topicID:").concat(G," startSequence:").concat(P," complete:").concat(pe," nextSequence:").concat(ve)).end(),s.get(11)),ut=[];return Ct(te)?1<=ve&&Ue.updateRoamingMessageSequence(h,ve):(Ue.updateRoamingMessageSequence(h,ve),ut=Ue.onRoamingMessage(te,h),Ue.updateIsRead(h),Ue.patchConversationLastMessage(h)),(pe===2||ve<1)&&(Ue.setCompleted(h),ve=""),q.l("".concat(l," nextReqID:").concat(ve,", stored message count:").concat(ut.length,", invisible sequence count:").concat(ye.length)),{nextReqID:ve+"",storedMessageList:ut}}).catch(function(Y){return k.setError(Y).setMessage("groupID:".concat(v," topicID:").concat(G," startSequence:").concat(P)).end(),q.w("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"_getGroupIDOfMessage",value:function(n){return n.conversationID.replace(O.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(n){var s="".concat(this._n,".").concat("getReadReceiptList"),l=this._getGroupIDOfMessage(n[0]),h=this.getMyUserID(),v=n.filter(function(k){return k.from===h&&k.needReadReceipt===!0}).map(function(k){return{sequence:k.sequence}});if(q.l("".concat(s," groupID:").concat(l," sequenceList:").concat(JSON.stringify(v))),v.length===0)return ln({messageList:n});var I=new it("getReadReceiptList");return I.setMessage("groupID:".concat(l)),this.req({proto:fe.GET_READ_RECEIPT,data:{groupID:l,sequenceList:v}}).then(function(k){return I.end(),q.l("".concat(s," ok")),k=k.data.readReceiptList,Rt(k)&&k.forEach(function(P){n.forEach(function(G){P.code===0&&P.sequence===G.sequence&&(G.readReceiptInfo.readCount=P.readCount,G.readReceiptInfo.unreadCount=P.unreadCount)})}),Ut({messageList:n})}).catch(function(k){return I.setError(k).end(),q.w("".concat(s," failed. error:"),k),Re(k)})}},{key:"sendReadReceipt",value:function(I){var s="".concat(this._n,".").concat("sendReadReceipt"),l=this._getGroupIDOfMessage(I[0]),h=new it("sendReadReceipt"),v=(h.setMessage("groupID:".concat(l)),this.getMyUserID()),I=I.filter(function(k){return k.from!==v&&k.needReadReceipt===!0}).map(function(k){return{sequence:k.sequence}});return I.length===0?Re({code:Be.READ_RECEIPT_MSG_LIST_EMPTY}):(q.l("".concat(s,". sequenceList:").concat(JSON.stringify(I))),this.req({proto:fe.SEND_READ_RECEIPT,data:{groupID:l,sequenceList:I}}).then(function(k){return h.end(),q.l("".concat(s," ok")),Ut()}).catch(function(k){return h.setError(k).end(),q.w("".concat(s," failed. error:"),k),Re(k)}))}},{key:"getReadReceiptDetail",value:function(te){var s=this,v=te.message,G=te.filter,Y=te.cursor,te=te.count,l=this._getGroupIDOfMessage(v),h=v.ID,v=v.sequence,I="".concat(this._n,".").concat("getReadReceiptDetail"),k=this._receiptDetailCompleteMap.get(h)||!1,P=G!==0&&G!==1?0:G,G=Sn(Y)?Y:"",Y=!un(te)||te<=0||100<=te?100:te,te="groupID:".concat(l," sequence:").concat(v," cursor:").concat(G," filter:").concat(P," completeFlag:").concat(k),pe=(q.l("".concat(I," ").concat(te)),{cursor:"",isCompleted:!1,messageID:h,unreadUserIDList:[],readUserIDList:[]}),ye=new it("getReadReceiptDetail");return ye.setMessage(te),this.req({proto:fe.GET_READ_RECEIPT_DETAIL,data:{groupID:l,sequence:v,flag:P,cursor:G,count:Y}}).then(function(Kt){ye.end();var Kt=Kt.data,Ue=Kt.cursor,ut=Kt.isCompleted,mt=Kt.unreadUserIDList,Kt=Kt.readUserIDList;return pe.cursor=Ue,ut===1&&(pe.isCompleted=!0,s._receiptDetailCompleteMap.set(h,!0)),P===0?pe.readUserIDList=Kt.map(function(en){return en.userID}):P===1&&(pe.unreadUserIDList=mt.map(function(en){return en.userID})),q.l("".concat(I," ok")),Ut(pe)}).catch(function(ve){return ye.setError(ve).end(),q.w("".concat(I," failed. error:"),ve),Re(ve)})}},{key:"getRoamingMessagesHopping",value:function(n){var s=this,l="".concat(this._n,".getRoamingMessagesHopping"),h=n.groupID,v=n.count,I=n.sequence,k=n.direction,P=I;if(Qe(I)){if(k===1)return ln({messageList:[],isCompleted:!0,nextMessageSeq:""});this.hasLocalGroup(h)&&(P=1<(G=this.getLocalGroupProfile(h).nextMessageSeq)?G-1:0),Qo(h)&&(P=0)}else k===1&&(P=I+v-1);var G=void 0,Y=(Qo(h)&&(h=Zo(G=h)),"".concat(G?"topicID:".concat(G):"groupID:".concat(h)," sequence:").concat(I," direction:").concat(k)),te=(q.l("".concat(l," ").concat(Y)),new it("getGroupRoamingMessagesHopping"));return this.req({proto:fe.GET_GRP_ROAMING_MSG,data:{groupID:h,topicID:G,count:v,sequence:P}}).then(function(ve){var ve=ve.data,ye=ve.messageList,ve=ve.complete,Ue="complete:".concat(ve," count:").concat(ye?ye.length:0);return q.l("".concat(l," ok. ").concat(Ue)),te.setMessage("".concat(Y," ").concat(Ue)).end(),ve===2||Ct(ye)?(Ue=s._computeResult(),Ut(Ue)):(ve="".concat(O.CONV_GROUP).concat(n.groupID),Ue=s.get(11),ve=Ue.onRoamingMessage(ye,ve,!1),ye=s._computeResult({direction:k,sequence:I,remoteMessageList:ye,processedMessageList:ve}),Ue.storeHoppingMessageList(ye.messageList),Ut(ye))}).catch(function(pe){return te.setError(pe).setMessage("groupID:".concat(h," sequence:").concat(I," count:").concat(v)).end(),q.w("".concat(l," failed. error:"),pe),Re(pe)})}},{key:"_computeResult",value:function(I){var s={messageList:[],isCompleted:!1,nextMessageSeq:""};if(Qe(I))return s.isCompleted=!0,s;var l=I.direction,h=I.sequence,v=I.remoteMessageList,v=v===void 0?[]:v,I=I.processedMessageList,I=I===void 0?[]:I,k=v.length;return l===1?(s.nextMessageSeq=v[0].sequence+1,I.forEach(function(P){P.sequence>=h&&s.messageList.push(P)}),s.messageList.length===0&&v[0].sequence<h&&(s.isCompleted=!0,s.nextMessageSeq="")):(s.nextMessageSeq=v[k-1].sequence-1,s.messageList=L(I),s.nextMessageSeq===0&&(s.isCompleted=!0,s.nextMessageSeq="")),s}},{key:"setMessageRead",value:function(I){var s=this,l=I.conversationID,h=I.lastMessageSeq,v="".concat(this._n,".").concat("setMessageRead"),I="conversationID:".concat(l," lastMessageSeq:").concat(h),k=(q.l("".concat(v," ").concat(I)),un(h)||this.outputWarning("DoNotModifyLastSeq"),new it("setMessageRead")),P=(k.setMessage(I),l.replace(O.CONV_GROUP,"")),G=void 0;return Qo(P)&&(P=Zo(G=P)),this.req({proto:fe.SET_GRP_MSG_READ,data:{groupID:P,topicID:G,messageReadSeq:h}}).then(function(){k.end(),q.l("".concat(v," ok"));var Y,te=s.get(11),pe=(te.updateIsReadAfterReadReport({conversationID:l,lastMessageSeq:h}),!0);return Qe(G)||(pe=!1,(Y=s.get(10).getLocalTopic(P,G))&&Y.updateSelfInfo({readedSequence:h})),te.updateUnreadCount(l,pe),Ut()}).catch(function(Y){return k.setError(Y).end(),q.l("".concat(v," failed. error:"),Y),Re(Y)})}},{key:"_computeLastSequence",value:function(h){var s=h.groupID,l=h.topicID,l=l===void 0?void 0:l,h=h.sequence;return 0<h?Promise.resolve(h):Qe(l)?this.getGroupLastSequence(s):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(n){var s="".concat(this._n,".").concat("getGroupLastSequence"),l=new it("getGroupLastSequence"),h=0,v="",I="groupID:".concat(n);if(this.hasLocalGroup(n)){var k=this.getLocalGroupProfile(n),P=k.lastMessage;if(0<P.lastSequence&&P.onlineOnlyFlag===!1)return h=P.lastSequence,v="".concat(I,", ").concat(h," from group.lastMessage.lastSequence"),q.l("".concat(s," ").concat(v)),l.setMessage(v).end(),Promise.resolve(h);if(1<k.nextMessageSeq)return h=k.nextMessageSeq-1,v="".concat(I,", ").concat(h," from group.nextMessageSeq"),q.l("".concat(s," ").concat(v)),l.setMessage(v).end(),Promise.resolve(h)}return P=this.get(11).getLocalConversation("GROUP".concat(n)),P&&P.lastMessage.lastSequence&&P.lastMessage.onlineOnlyFlag===!1?(h=P.lastMessage.lastSequence,v="".concat(I,", ").concat(h," from conversation.lastMessage.lastSequence"),q.l("".concat(s," ").concat(v)),l.setMessage(v).end(),Promise.resolve(h)):this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then(function(G){return G=G.data.successGroupList,Ct(G)?q.w("".concat(s," ").concat(I,", empty successGroupList")):(h=G[0].nextMessageSeq-1,v="".concat(I,", ").concat(h," from remote"),q.l("".concat(s," ").concat(v))),l.setMessage(v).end(),h}).catch(function(G){return l.setError(G).setMessage(I).end(),q.w("".concat(s," failed. error:"),G),Re(G)})}},{key:"isMessageFromOrToAVChatroom",value:function(n){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"getGroupRemoteLastSeq",value:function(n){return n=this.getLocalGroupProfile(n),n?n.nextMessageSeq-1:1}},{key:"isOnlineMessage",value:function(n,s){return!(!this._canIUseOnlineOnlyFlag(n)||!s||s.onlineUserOnly!==!0)}},{key:"_canIUseOnlineOnlyFlag",value:function(n){var s=this.getJoinedAVChatRoom();return!s||!s.includes(n.to)||n.conversationType!==O.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(n,s){var l;Ct(n)||(q.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(s," count:").concat(n.length)),l=[],n.forEach(function(h){l.push(i(i({},h),{},{isHistoryMessage:1}))}),this.onAVChatRoomMessage(l,s))}},{key:"onAVChatRoomMessage",value:function(n){this._AVChatRoomHandler.onMessage(n,1<arguments.length&&arguments[1]!==void 0?arguments[1]:"")}},{key:"onAVChatRoomMemberBanned",value:function(n){this._AVChatRoomHandler.onAVChatRoomMemberBanned(n)}},{key:"getGroupSimplifiedInfo",value:function(n){var s=new it("getGroupSimplifiedInfo");return this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["Type","Name"]}}).then(function(l){return l=l.data.successGroupList,s.setMessage("groupID:".concat(n," type:").concat(l[0].type)).end(),l[0]}).catch(function(l){s.setError(l).setMessage("groupID:".concat(n)).end()})}},{key:"setUnjoinedAVChatRoom",value:function(n){this._unjoinedAVChatRoomList.set(n,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(n){this._unjoinedAVChatRoomList.has(n)&&this._unjoinedAVChatRoomList.delete(n)}},{key:"isUnjoinedAVChatRoom",value:function(n){return this._unjoinedAVChatRoomList.has(n)}},{key:"isGroupAttributesUpdatedNotice",value:function(n){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(n)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(n){return this._groupAttributesHandler.initGroupAttributes(n)}},{key:"setGroupAttributes",value:function(n){return this._groupAttributesHandler.setGroupAttributes(n)}},{key:"deleteGroupAttributes",value:function(n){return this._groupAttributesHandler.deleteGroupAttributes(n)}},{key:"getGroupAttributes",value:function(n){return this._groupAttributesHandler.getGroupAttributes(n)}},{key:"isMessageFromTopic",value:function(n,s){return n===2&&!Ct(s)}},{key:"isMessageFromCommunityOfTopic",value:function(n,s){return n===2&&Ct(s)}},{key:"getMessageExtensions",value:function(n,s){return q.l("".concat(this._n,".getMessageExtensions startSequence:").concat(s)),this.req({proto:fe.GET_GRP_MSG_EXT,data:{groupID:n.to,messageSequence:n.sequence,startSequence:s}})}},{key:"modifyMessageExtensions",value:function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return q.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(l)),this.req({proto:fe.MODIFY_GRP_MSG_EXT,data:{groupID:n.to,messageSequence:n.sequence,extensionList:s,operateType:l}})}},{key:"_genNotifyReqList",value:function(n){for(var s=[],l=0,h=n.length;l<h;l++){var v=n[l],P=this.getLocalGroupProfile(v).type,I=this._getGroupLastRevokedTime(v),k=1e3*oo(),P={notifyType:1,limit:20,type:Dr({type:P,groupID:v})?O.GRP_COMMUNITY:void 0,groupID:v,beginTime:I,endTime:k};s.push(P)}return s}},{key:"getGroupNotify",value:function(n){var s=this,l="".concat(this._n,".getGroupNotify"),h=n.filter(function(I){var P=s.getLocalGroupProfile(I),k=P.type,P=P.isSupportTopic;return s.hasLocalGroup(I)&&!Mr(k)&&!P}),v="filteredGroupIDList.length:".concat(h.length);h.length<=10&&(v="filteredGroupIDList:".concat(JSON.stringify(h))),q.l("".concat(l," ").concat(v)),h.length!==0&&this.req({proto:fe.GET_GRP_NOTIFY,data:{notifyReqList:this._genNotifyReqList(n)}}).then(function(G){var k,G=G.data.notifyRspList,P=[],G=(Rt(G)&&(k={dataList:[]},G.forEach(function(Y){var te=Y.nextRevokedTime,pe=Y.groupID;k.dataList.push({elements:{revokedInfos:s._genRevokedInfos(Y)}}),te!==0?(s._setGroupLastRevokedTime(pe,te),P.push(pe)):s._setGroupLastRevokedTime(pe,1e3*oo())}),s.onGroupMessageRevoked(k)),0<P.length&&s.getGroupNotify(P),"nextGroupIDList.length:".concat(P.length));P.length<=10&&(G="nextGroupIDList:".concat(JSON.stringify(P))),q.l("".concat(l," ").concat(G))}).catch(function(I){q.e("".concat(l," failed. error:"),I)})}},{key:"_genRevokedInfos",value:function(n){var s=n.notifyList,l=n.groupID,h=[];return Rt(s)&&s.forEach(function(v){h.push({groupID:l,sequence:v.sequence,random:v.random,revokerInfo:i({},v.revokerInfo)})}),h}},{key:"_getGroupLastRevokedTime",value:function(n){return this.hasLocalGroup(n)?this.getLocalGroupProfile(n)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(n,s){this.hasLocalGroup(n)&&(this.getLocalGroupProfile(n)._lastRevokedTime=s)}},{key:"isGroupCountersNotice",value:function(n){return this._groupCountersHandler.isGroupCountersNotice(n)}},{key:"setGroupCounters",value:function(n){return this._groupCountersHandler.setGroupCounters(n)}},{key:"increaseGroupCounter",value:function(n){return this._groupCountersHandler.increaseGroupCounter(n)}},{key:"decreaseGroupCounter",value:function(n){return this._groupCountersHandler.decreaseGroupCounter(n)}},{key:"getGroupCounters",value:function(n){return this._groupCountersHandler.getGroupCounters(n)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(n){return this._groupMemberHandler.getGroupMemberList(n)}},{key:"getGroupMemberProfile",value:function(n){return this._groupMemberHandler.getGroupMemberProfile(n)}},{key:"addGroupMember",value:function(n){return this._groupMemberHandler.addGroupMember(n)}},{key:"deleteGroupMember",value:function(n){return this._groupMemberHandler.deleteGroupMember(n)}},{key:"setGroupMemberMuteTime",value:function(n){return this._groupMemberHandler.setGroupMemberMuteTime(n)}},{key:"setGroupMemberRole",value:function(n){return this._groupMemberHandler.setGroupMemberRole(n)}},{key:"setGroupMemberNameCard",value:function(n){return this._groupMemberHandler.setGroupMemberNameCard(n)}},{key:"setGroupMemberCustomField",value:function(n){return this._groupMemberHandler.setGroupMemberCustomField(n)}},{key:"markGroupMemberList",value:function(n){return this._groupMemberHandler.markGroupMemberList(n)}},{key:"modifyGroupMemberInfo",value:function(n){return this._groupMemberHandler.modifyGroupMemberInfo(n)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(n){if(!n)return-1;var s=this.getLocalGroupProfile(n);return s&&Mr(s.type)?this._AVChatRoomHandler.getPollingTimerID(n):-1}},{key:"_canIUseJoinOption",value:function(n){return n===O.GRP_PUBLIC||Dr({type:n})}},{key:"_silentlyGetGroupProfile",value:function(n,s){var l=setTimeout(this.getGroupProfile.bind(this,{groupID:s}),3e3);this._timeoutIDs.push(l),q.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(n," groupID:").concat(s," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach(function(n){clearTimeout(n)}),this._timeoutIDs=[]}},{key:"startMessageLongPolling",value:function(h){var s=h.groupID,l=h.longPollingKey,h=h.longPollingSequence,h=h===void 0?1:h,I=this.get(12).isUnlimitedAVChatRoom(),v=(this._AVChatRoomHandler.hasPollingInstance(s)&&this.stopMessageLongPolling({groupID:s}),this._AVChatRoomHandler.getJoinedLiveList()),I=(!I&&0<v.length&&this.stopMessageLongPolling({groupID:v[0]}),new fa({groupID:s,type:O.GRP_LIVE}));return q.l("".concat(this._n,".startMessageLongPolling groupID:").concat(s," longPollingKey:").concat(l," longPollingSequence:").concat(h)),this._AVChatRoomHandler.startRunLoop({group:I,longPollingKey:l,startSeq:h})}},{key:"stopMessageLongPolling",value:function(s){var s=s.groupID,l=this.get(11);return this._AVChatRoomHandler.reset(s),this._deleteLocalGroup(s),l.deleteLocalConversation("".concat(O.CONV_GROUP).concat(s)),q.l("".concat(this._n,".stopMessageLongPolling ok, groupID:").concat(s)),ln({groupID:s})}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}]),lh),G1=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],B1=(p(Mv,[{key:"_initTopic",value:function(n){for(var s in n)G1.indexOf(s)<0||(s==="selfInfo"?this.updateSelfInfo(n[s]):this[s]=s==="muteAllMembers"?n[s]===1:n[s])}},{key:"updateUnreadCount",value:function(){this.unreadCount=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0}},{key:"updateNextMessageSeq",value:function(n){this.nextMessageSeq=n}},{key:"updateLastMessage",value:function(n){this.lastMessage=BI(n)}},{key:"updateGroupAtInfoList",value:function(n){this.groupAtInfoList=JSON.parse(JSON.stringify(n))}},{key:"updateTopic",value:function(n){Qe(n.selfInfo)||this.updateSelfInfo(n.selfInfo),Qe(n.muteAllMembers)||(this.muteAllMembers=n.muteAllMembers===1),ni(this,n,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(n){return ni(this.selfInfo,n,[],[""])!==0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(n){return n.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(n){this.lastMessage.isRevoked=n}},{key:"setLastMessageRevoker",value:function(n){this.lastMessage.revoker=n}}]),Mv),JI=(_(ah,Uo),HI=D(ah),p(ah,[{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("topic_cache_time"),s=this.getCloudConfig("topic_last_active_time");Qe(n)||(this.TOPIC_CACHE_TIME=Number(n)),Qe(s)||(this.TOPIC_LAST_ACTIVE_TIME=Number(s))}},{key:"onTopicCreated",value:function(n){var s=n.groupID;this.resetGetTopicTime(s),this.emitOuterEvent($.TOPIC_CREATED,n)}},{key:"onTopicDeleted",value:function(n){var s=this,l=n.groupID,h=n.topicIDList;(h===void 0?[]:h).forEach(function(v){s._deleteLocalTopic(l,v)}),this.emitOuterEvent($.TOPIC_DELETED,n)}},{key:"onTopicMessageRemindTypeUpdated",value:function(v){var s,l=v.groupID,h=v.topicID,v=v.messageRemindType,I=this.getLocalTopic(l,h);I&&((s=I.updateSelfInfo({messageRemindType:v}))&&this.emitOuterEvent($.TOPIC_UPDATED,{groupID:l,topic:I}),q.l("".concat(this._n,".onTopicMessageRemindTypeUpdated topicID:").concat(h)+" messageRemindType:".concat(v," isTopicUpdated:").concat(s)))}},{key:"onTopicProfileUpdated",value:function(n){var s=n.groupID,l=n.topicID,l=this.getLocalTopic(s,l);l&&(l.updateTopic(n),this.emitOuterEvent($.TOPIC_UPDATED,{groupID:s,topic:l}))}},{key:"onConversationProxy",value:function(l){var v=l.topicID,s=l.unreadCount,l=l.groupAtInfoList,h=Zo(v),v=this.getLocalTopic(h,v),I=!1;v&&(Qe(s)||v.unreadCount===s||(v.updateUnreadCount(s),I=!0),Qe(l)||(v.updateGroupAtInfoList(l),I=!0)),I&&this.emitOuterEvent($.TOPIC_UPDATED,{groupID:h,topic:v})}},{key:"onMessageSent",value:function(l){var s=l.groupID,h=l.topicID,l=l.lastMessage,h=this.getLocalTopic(s,h);h&&(h.nextMessageSeq+=1,h.updateLastMessage(l),this.emitOuterEvent($.TOPIC_UPDATED,{groupID:s,topic:h}))}},{key:"onMessageModified",value:function(n){var s,l=n.to,h=n.time,v=n.sequence,I=n.elements,k=n.cloudCustomData,P=n.messageVersion,G=Zo(l),Y=this.getLocalTopic(G,l);Y&&(s=Y.lastMessage,q.d("".concat(this._n,".onMessageModified topicID:").concat(l," lastMessage:"),JSON.stringify(s),"options:",JSON.stringify(n)),s&&(s.payload===null||s.lastTime===h&&s.lastSequence===v&&s.version!==P)&&(s.type=I[0].type,s.payload=I[0].content,s.messageForShow=Fd(s.type,s.payload,this.isIntl()),s.cloudCustomData=k,s.version=P,s.lastSequence=v,s.lastTime=h,this.emitOuterEvent($.TOPIC_UPDATED,{groupID:G,topic:Y})))}},{key:"onMessageRevoked",value:function(n){var s,l,h,v=this;n.length!==0&&(l=s=null,h=!1,n.forEach(function(I){var k=I.to;l=Zo(k),(s=v.getLocalTopic(l,k))&&(s.reduceUnreadCount()&&(h=!0),s.isLastMessageRevoked(I)&&(s.setLastMessageRevoked(!0),s.setLastMessageRevoker(I.revoker),h=!0))}),h&&this.emitOuterEvent($.TOPIC_UPDATED,{groupID:l,topic:s}))}},{key:"isLastMessageRevoked",value:function(s){var h=s.topicID,s=s.sequence,l=Zo(h),l=this.getLocalTopic(l,h),h=!1;return h=l?l.isLastMessageRevoked({sequence:s}):h}},{key:"getJoinedCommunityList",value:function(){return this.get(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(n){var s=this,l="".concat(this._n,".").concat("createTopicInCommunity"),h=n.topicID;if(!Qe(h)&&!Qo(h))return Re({code:Be.ILLEGAL_TOPIC_ID});if(n.topicName&&this._filterProfanity("topicName",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.introduction&&this._filterProfanity("introduction",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.notification&&this._filterProfanity("notification",n)===!1)return Re({code:Be.PROFANITY_FOUND});var v=new it("createTopicInCommunity");return this.req({proto:fe.CREATE_TOPIC,data:i({},n)}).then(function(I){return I=I.data.topicID,v.setMessage("topicID:".concat(I)).end(),q.l("".concat(l," ok. topicID:").concat(I)),s._updateTopicMap([i(i({},n),{},{topicID:I})]),Ut({topicID:I})}).catch(function(I){return v.setError(I).end(),q.e("".concat(l," failed. error:"),I),Re(I)})}},{key:"deleteTopicFromCommunity",value:function(v){var s=this,l="".concat(this._n,".").concat("deleteTopicFromCommunity"),h=v.groupID,v=v.topicIDList,v=v===void 0?[]:v,I=new it("deleteTopicFromCommunity");return I.setMessage("groupID:".concat(h," topicIDList:").concat(v)),this.req({proto:fe.DEL_TOPIC,data:{groupID:h,topicIDList:v}}).then(function(Y){var Y=Y.data.resultList,P=[],G=[],Y=((Y===void 0?[]:Y).forEach(function(ve){var pe=ve.topicID,ye=ve.errorCode,ve=ve.errorInfo;ye===0?P.push({topicID:pe}):G.push({topicID:pe,code:ye,message:ve})}),"success count:".concat(P.length,", fail count:").concat(G.length));return I.setMoreMessage(Y).end(),q.l("".concat(l," ok. ").concat(Y)),P.forEach(function(te){s._deleteLocalTopic(h,te.topicID)}),Ut({successTopicList:P,failureTopicList:G})}).catch(function(k){return I.setError(k).end(),q.e("".concat(l," failed. error:"),k),Re(k)})}},{key:"updateTopicProfile",value:function(n){var s=this,l="".concat(this._n,".").concat("updateTopicProfile");if(q.l("".concat(l," options:"),n),n.topicName&&this._filterProfanity("topicName",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.introduction&&this._filterProfanity("introduction",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.notification&&this._filterProfanity("notification",n)===!1)return Re({code:Be.PROFANITY_FOUND});var h=new it("updateTopicProfile");return h.setMessage("groupID:".concat(n.groupID," topicID:").concat(n.topicID)),Qe(n.muteAllMembers)||(n.muteAllMembers=n.muteAllMembers===!0?"On":"Off"),this.req({proto:fe.UPDATE_TOPIC_PROFILE,data:i({},n)}).then(function(){return h.end(),q.l("".concat(l," ok")),s._updateTopicMap([n]),Ut({topic:s.getLocalTopic(n.groupID,n.topicID)})}).catch(function(v){return h.setError(v).end(),q.e("".concat(l," failed. error:"),v),Re(v)})}},{key:"getTopicList",value:function(v){var s=this,l="".concat(this._n,".").concat("getTopicList"),h=v.groupID,v=v.topicIDList,v=v===void 0?[]:v,I=v.length===0,k=new it("getTopicList");if(k.setMessage("groupID:".concat(h)),this._getTopicTimeMap.has(h)){var G=this._getTopicTimeMap.get(h),P=G.isGetAll,G=G.time;if((P||!P&&!I)&&Date.now()-G<1e3*this.TOPIC_CACHE_TIME&&(P=this._getLocalTopicList(h,v),I||P.length===v.length))return k.setMoreMessage("from cache, topic count:".concat(P.length)).end(),q.l("".concat(l," groupID:").concat(h," from cache, topic count:").concat(P.length)),ln({successTopicList:P,failureTopicList:[]})}return this.req({proto:fe.GET_TOPIC_LIST,data:{groupID:h,topicIDList:v}}).then(function(ve){var ve=ve.data.topicInfoList,te=[],pe=[],ye=[],ve=((ve===void 0?[]:ve).forEach(function(en){var ut=en.topic,mt=en.selfInfo,Kt=en.errorCode,en=en.errorInfo,Un=ut.topicID;Kt===0?(te.push(i(i({},ut),{},{selfInfo:mt})),pe.push(Un)):ye.push({topicID:Un,code:Kt,message:en})}),s._updateTopicMap(te),s._handleTopicAtInfo(te),"success count:".concat(pe.length,", fail count:").concat(ye.length)),ve=(k.setMoreMessage(ve).end(),q.l("".concat(l," groupID:").concat(h," from remote, ").concat(ve)),[]);return Ct(pe)||(s._getTopicTimeMap.set(h,{time:Date.now(),isGetAll:I}),ve=s._getLocalTopicList(h,pe)),Ut({successTopicList:ve,failureTopicList:ye})}).catch(function(Y){return k.setError(Y).end(),q.e("".concat(l," failed. error:"),Y),Re(Y)})}},{key:"hasLocalTopic",value:function(n,s){return!!this._topicMap.has(n)&&this._topicMap.get(n).has(s)}},{key:"getLocalTopic",value:function(n,s){var l=null;return l=this._topicMap.has(n)?this._topicMap.get(n).get(s):l}},{key:"_getLocalTopicList",value:function(l){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],l=this._topicMap.get(l),h=[];return l&&(h=L(l.values())),s.length===0?h:h.filter(function(v){return s.includes(v.topicID)})}},{key:"_deleteLocalTopic",value:function(n,s){this._topicMap.has(n)&&this._topicMap.get(n).has(s)&&(this._topicMap.get(n).delete(s),q.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(n," topicID:").concat(s)))}},{key:"_updateTopicMap",value:function(n){var s=this,l=[];n.forEach(function(P){var v=P.groupID,I=P.topicID,k=null,P=(s._topicMap.has(v)||s._topicMap.set(v,new Map),s._topicMap.get(v).has(I)?(k=s._topicMap.get(v).get(I)).updateTopic(P):(s._getTopicLastMessage(P),k=new B1(P,s.isIntl()),s._topicMap.get(v).set(I,k)),s._computeUnreadCount(k));k.updateUnreadCount(P),l.push({conversationID:"".concat(O.CONV_GROUP).concat(I),type:O.CONV_TOPIC,unreadCount:P})}),0<l.length&&this.get(11).updateTopicConversation(l)}},{key:"resetGetTopicTime",value:function(n){var s=this;Qe(n)?L(this._getTopicTimeMap.keys()).forEach(function(l){s._getTopicTimeMap.set(l,0)}):this._getTopicTimeMap.set(n,0)}},{key:"getTopicListOnReconnected",value:function(){var n=this,s=L(this._topicMap.keys()),l=[],h=this.get(11);s.forEach(function(v){var I=[],k=n._getLocalTopicList(v);h.deleteTopicRoamingMessageInfo(v),k.forEach(function(P){var G=P.lastMessage.lastTime,G=G===void 0?0:G;Date.now()-1e3*G<1e3*n.TOPIC_LAST_ACTIVE_TIME&&I.push(P.topicID)}),0<I.length&&l.push({groupID:v,topicIDList:I})}),q.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(l.length)),this._relayGetTopicList(l)}},{key:"_relayGetTopicList",value:function(n){var s,l,h,v=this;n.length!==0&&(l=5<(s=n.shift()).topicIDList.length?"topicIDList.length:".concat(s.topicIDList.length):"topicIDList:".concat(s.topicIDList),(h=new it("relayGetTopicList")).setMessage(l),q.l("".concat(this._n,"._relayGetTopicList. ").concat(l)),this.getTopicList(s).then(function(){h.end(),v._relayGetTopicList(n)}).catch(function(I){h.setError(I).end(),v._relayGetTopicList(n)}))}},{key:"_handleTopicAtInfo",value:function(n){var s=this;n.length!==0&&n.forEach(function(I){var h=I.groupID,v=I.topicID,I=I.groupAtInfoList,k=[];Qe(I)||(I.forEach(function(P){k.push(i(i({},P),{},{groupID:h,topicID:v}))}),s.get(11).onNewGroupAtTips({dataList:k}))})}},{key:"_getTopicLastMessage",value:function(n){var s;Qe(n.lastMsg)||(s={time:n.lastMsg.time,sequence:n.lastMsg.sequence,from:n.lastMsg.from,payload:n.lastMsg.elements[0]?n.lastMsg.elements[0].content:null,type:n.lastMsg.elements[0]?n.lastMsg.elements[0].type:"",nick:n.lastMsg.nick,avatar:n.lastMsg.avatar,version:n.lastMsg.messageVersion,cloudCustomData:n.lastMsg.cloudCustomData,isRevoked:n.lastMsg.isPlaceMessage===2,revoker:Ct(n.lastMsg.revokerInfo)?null:n.lastMsg.revokerInfo.revoker},n.lastMessage=s)}},{key:"deleteTopicListInCommunity",value:function(n){var s=this,l=this._getLocalTopicList(n),h=this.get(11);l.forEach(function(v){v=v.topicID,s._deleteLocalTopic(n,v),s._getTopicTimeMap.delete(n),h.deleteLocalConversation("".concat(O.CONV_GROUP).concat(v))})}},{key:"_computeUnreadCount",value:function(n){var s,v=n.selfInfo,l=v.excludedUnreadSequenceList,h=v.readedSequence,v=n.nextMessageSeq-n.selfInfo.readedSequence-1;return Rt(l)&&(s=0,l.forEach(function(I){h<=I&&I<=n.nextMessageSeq-1&&(s+=1)}),1<=s&&(v-=s)),v<0?0:v}},{key:"_filterProfanity",value:function(n,s){var h=this.get(29);if(!h)return!0;var h=h.filterText(s[n],me),l=h.isAllowedToSend,h=h.modifiedText;return l===!0&&(s[n]=h,!0)}},{key:"updateLastMessage",value:function(v,s){var l,h=Zo(v),v=this.getLocalTopic(h,v);v&&(l=s.sequence+1,v.updateNextMessageSeq(l),v.updateLastMessage(s),this.emitOuterEvent($.TOPIC_UPDATED,{groupID:h,topic:v}))}},{key:"getMessageExtensions",value:function(n,s){q.l("".concat(this._n,".getMessageExtensions startSequence:").concat(s));var l=Zo(n.to);return this.req({proto:fe.GET_GRP_MSG_EXT,data:{groupID:l,topicID:n.to,messageSequence:n.sequence,startSequence:s}})}},{key:"modifyMessageExtensions",value:function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,h=(q.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(l)),Zo(n.to));return this.req({proto:fe.MODIFY_GRP_MSG_EXT,data:{groupID:h,topicID:n.to,messageSequence:n.sequence,extensionList:s,operateType:l}})}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),ah),$1=(p(sh,[{key:"setExpirationTime",value:function(n){this.expirationTime=n}},{key:"getUserProfile",value:function(n){var s=this,l="".concat(this._n,".").concat("getUserProfile"),h=n.userIDList;n.fromAccount=this._userM.getMyAccount(),100<h.length&&(q.w("".concat(l," ").concat(Ol(100))),h.length=100);for(var v,I=[],k=[],P=0,G=h.length;P<G;P++)v=h[P],this._userM.isMyFriend(v)&&this._contains(v)?k.push(this._getProfileFromMap(v)):I.push(v);if(I.length===0)return ln(k);n.toAccount=I;var Y=n.bFromGetMyProfile||!1,te=[],pe=(n.toAccount.forEach(function(ye){te.push({toAccount:ye,standardSequence:0,customSequence:0})}),n.userItem=te,new it("getUserProfile"));return pe.setMessage(5<h.length?"userIDList.length:".concat(h.length):"userIDList:".concat(h)),this._userM.req({proto:fe.GET_USER_PROFILE,data:n}).then(function(ye){return pe.end(),q.i("".concat(l," ok")),ye=s._handleResponse(ye).concat(k),Ut(Y?ye[0]:ye)}).catch(function(ye){return pe.setError(ye).end(),q.e("".concat(l," failed. error:"),ye),Re(ye)})}},{key:"getMyProfile",value:function(){var n,s=this._userM.getMyAccount(),l="".concat(this._n,".getMyProfile");return q.l("".concat(l," myAccount:").concat(s)),this._fill(),this._contains(s)?(n=this._getProfileFromMap(s),q.d("".concat(l," from cache, myProfile:").concat(JSON.stringify(n))),ln(n)):this.getUserProfile({fromAccount:s,userIDList:[s],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(n){var s=n.data.userProfileItem;if(!Rt(s))return[];for(var l=[],n=Date.now(),h=0,v=s.length;h<v;h++){var k=s[h],I=k.to,k=k.profileItem;I!=="@TLS#NOT_FOUND"&&I!==""&&(I=this._update(I,this._getLatestProfileFromResponse(I,k)).latestProfile,l.push(I))}return q.l("".concat(this._n,"._handleResponse cost:").concat(ar(n))),l}},{key:"_getLatestProfileFromResponse",value:function(n,s){var l={userID:n,profileCustomField:[]};if(!Ct(s))for(var h=0,v=s.length;h<v;h++)if(-1<s[h].tag.indexOf("Tag_Profile_Custom"))l.profileCustomField.push({key:s[h].tag,value:s[h].value});else switch(s[h].tag){case _n.NICK:l.nick=s[h].value;break;case _n.GENDER:l.gender=s[h].value;break;case _n.BIRTHDAY:l.birthday=s[h].value;break;case _n.LOCATION:l.location=s[h].value;break;case _n.SELFSIGNATURE:l.selfSignature=s[h].value;break;case _n.ALLOWTYPE:l.allowType=s[h].value;break;case _n.LANGUAGE:l.language=s[h].value;break;case _n.AVATAR:l.avatar=s[h].value;break;case _n.MESSAGESETTINGS:l.messageSettings=s[h].value;break;case _n.ADMINFORBIDTYPE:l.adminForbidType=s[h].value;break;case _n.LEVEL:l.level=s[h].value;break;case _n.ROLE:l.role=s[h].value;break;default:q.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),s[h].tag,s[h].value)}return l}},{key:"updateMyProfile",value:function(n){var s=this,l="".concat(this._n,".").concat("updateMyProfile");if(n.nick&&this._userM.filterProfanity("nick",n)===!1)return Re({code:Be.PROFANITY_FOUND});if(n.selfSignature&&this._userM.filterProfanity("selfSignature",n)===!1)return Re({code:Be.PROFANITY_FOUND});var h=new it("updateMyProfile"),v=(h.setMessage(JSON.stringify(n)),new eh().validate(n));if(!v.valid)return h.setCode(Be.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(v.tips)).end(),q.e("".concat(l," info:").concat(v.tips)),Re({code:Be.UPDATE_PROFILE_INVALID_PARAM});var I,k=[];for(I in n)Object.prototype.hasOwnProperty.call(n,I)&&(I==="profileCustomField"?n.profileCustomField.forEach(function(G){k.push({tag:G.key,value:G.value})}):k.push({tag:_n[I.toUpperCase()],value:n[I]}));if(k.length===0)return v=new so({code:Be.UPDATE_PROFILE_NO_KEY}),h.setError(v).end(),q.e("".concat(l," failed. error:"),v),Re(v);var P=this._userM.getMyAccount();return this._userM.req({proto:fe.UPDATE_MY_PROFILE,data:{fromAccount:P,profileItem:k}}).then(function(G){h.end(),q.i("".concat(l," ok"));var te=s._update(P,n),Y=te.isProfileUpdated,te=te.latestProfile;return Y===!0&&s._userM.emitOuterEvent($.PROFILE_UPDATED,[te]),ln(te)}).catch(function(G){return h.setError(G).end(),q.e("".concat(l," failed. error:"),G),Re(G)})}},{key:"onProfileModified",value:function(n){var s=n.dataList;if(!Ct(s)){var l=s.length;q.d("".concat(this._n,".onProfileModified count:").concat(l," dataList:"),n.dataList);for(var h=[],v=0;v<l;v++){var k=s[v].userID,k=this._update(k,this._getLatestProfileFromResponse(k,s[v].profileList)),I=k.isProfileUpdated,k=k.latestProfile;I===!0&&h.push(k)}0<h.length&&(this._userM.emitInnerEvent(So.PROFILE_UPDATED,h),this._userM.emitOuterEvent($.PROFILE_UPDATED,h))}}},{key:"_fill",value:function(){if(this.accountProfileMap.size===0){for(var n=this._getCachedProfiles(),s=Date.now(),l=0,h=n.length;l<h;l++)s-n[l].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(n[l].userID,n[l]);q.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(n,s){var l,h=!1,v=Date.now();return this._contains(n)?(l=this._getProfileFromMap(n),s.profileCustomField&&Nd(l.profileCustomField,s.profileCustomField)===!0&&(l.lastUpdatedTime=v,h=!0),0<ni(l,s,["profileCustomField"])&&(l.lastUpdatedTime=v,h=!0)):(l=new eh(s),!this._userM.isMyFriend(n)&&n!==this._userM.getMyAccount()||(l.lastUpdatedTime=v,h=!0,this.accountProfileMap.set(n,l))),this._flush(n===this._userM.getMyAccount()),h===!0&&q.l("".concat(this._n,"._update account:").concat(n," isProfileUpdated:").concat(h)),{isProfileUpdated:h,latestProfile:l}}},{key:"_flush",value:function(n){var s=L(this.accountProfileMap.values()),l=this._userM.getStorageModule();q.d("".concat(this._n,"._flush length:").concat(s.length," flushAtOnce:").concat(n)),l.setItem(this.TAG,s,n)}},{key:"_contains",value:function(n){return this.accountProfileMap.has(n)}},{key:"_getProfileFromMap",value:function(n){return this.accountProfileMap.get(n)}},{key:"_getCachedProfiles",value:function(){var n=this._userM.getStorageModule().getItem(this.TAG);return Ct(n)?[]:n}},{key:"onConversationsProfileUpdated",value:function(n){for(var s,l,h,v=[],I=0,k=n.length;I<k;I++)l=(s=n[I]).userID,this._userM.isMyFriend(l)&&(this._contains(l)?(h=this._getProfileFromMap(l),0<ni(h,s)&&v.push(l)):v.push(s.userID));v.length!==0&&(q.i("".concat(this._n,".onConversationsProfileUpdated toAccountList:").concat(v)),this.getUserProfile({userIDList:v}))}},{key:"getNickAndAvatarByUserID",value:function(n){return this._contains(n)?{nick:(n=this._getProfileFromMap(n)).nick,avatar:n.avatar}:{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(v){var s=this,l=L(new Set(v)),h=(q.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(v.length," uniqueUserIDList.length:").concat(l.length)),[]);if(v.length===0)return Promise.resolve(h);var v=this._createUserIDListGroup(l),I=[];return v.forEach(function(k){I.push(s.getUserProfile({userIDList:k}))}),Promise.all(I).then(function(k){return k.forEach(function(P){P=P.data.map(function(G){return{userID:G.userID,nick:G.nick,avatar:G.avatar}}),h.push.apply(h,L(P))}),h})}},{key:"_createUserIDListGroup",value:function(n){for(var s=[],l=0;l<n.length;)s.push(n.slice(l,l+=100));return s}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),sh),XI=p(function n(s){u(this,n)}),H1=(p(ih,[{key:"getLocalBlacklist",value:function(){return L(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var n=this,s="".concat(this._n,".getBlacklist"),l={fromAccount:this._userM.getMyAccount(),maxLimited:this.maxLimited,startIndex:0,lastSequence:this.currentSequence},h=new it("getBlacklist");return this._userM.req({proto:fe.GET_BL,data:l}).then(function(k){var k=k.data,I=k.blackListItem,k=k.currentSequence,P=Ct(I)?0:I.length;h.setMessage("count:".concat(P)).end(),q.i("".concat(s," ok")),n.currentSequence=k,n._handleResponse(I,!0),n._userM.emitOuterEvent($.BLACKLIST_UPDATED,L(n._blacklistMap.keys()))}).catch(function(v){return h.setError(v).end(),q.e("".concat(s," failed. error:"),v),Re(v)})}},{key:"addBlacklist",value:function(n){var s,l,h=this,v=new it("addToBlacklist"),I="".concat(this._n,".addBlacklist"),k=this._userM.getMyAccount();return n.userIDList.length===1&&n.userIDList[0]===k?(l=this._userM.getErrorMessage(s=Be.CANNOT_ADD_SELF_TO_BLACKLIST),v.setCode(s).setMessage(l).end(),l=new so({code:s}),q.e("".concat(I," failed. error:"),l),Re(l)):(n.userIDList.includes(k)&&(n.userIDList=n.userIDList.filter(function(P){return P!==k})),n.fromAccount=this._userM.getMyAccount(),n.toAccount=n.userIDList,this._userM.req({proto:fe.ADD_TO_BL,data:n}).then(function(P){return v.setMessage(5<n.userIDList.length?"userIDList.length:".concat(n.userIDList.length):"userIDList:".concat(n.userIDList)).end(),q.i("".concat(I," ok")),h._handleResponse(P.resultItem,!0),Ut(L(h._blacklistMap.keys()))}).catch(function(P){return v.setError(P).end(),q.e("".concat(I," failed. error:"),P),Re(P)}))}},{key:"_handleResponse",value:function(n,s){if(!Ct(n))for(var l,h,v,I=0,k=n.length;I<k;I++)h=n[I].to,v=n[I].resultCode,!Qe(v)&&v!==0||(s?((l=this._blacklistMap.has(h)?this._blacklistMap.get(h):new XI).userID=h,Ct(n[I].addBlackTimeStamp)||(l.timeStamp=n[I].addBlackTimeStamp),this._blacklistMap.set(h,l)):this._blacklistMap.has(h)&&(l=this._blacklistMap.get(h),this._blacklistMap.delete(h)));q.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(s))}},{key:"deleteBlacklist",value:function(n){var s=this,l="".concat(this._n,".deleteBlacklist"),h=new it("removeFromBlacklist");return n.fromAccount=this._userM.getMyAccount(),n.toAccount=n.userIDList,this._userM.req({proto:fe.RM_FROM_BL,data:n}).then(function(v){return h.setMessage(5<n.userIDList.length?"userIDList.length:".concat(n.userIDList.length):"userIDList:".concat(n.userIDList)).end(),q.i("".concat(l," ok")),s._handleResponse(v.data.resultItem,!1),Ut(L(s._blacklistMap.keys()))}).catch(function(v){return h.setError(v).end(),q.e("".concat(l," failed. error:"),v),Re(v)})}},{key:"onAccountDeleted",value:function(n){for(var s=0,l=n.length;s<l;s++){var h=n[s];this._blacklistMap.has(h)&&this._blacklistMap.delete(h)}var v=n.length;0<v&&(q.l("".concat(this._n,".onAccountDeleted count:").concat(v," ").concat(v<30?"userIDList:".concat(n):"")),this._userM.emitOuterEvent($.BLACKLIST_UPDATED,L(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(n){for(var s,l=[],h=0,v=n.length;h<v;h++)s=n[h],this._blacklistMap.has(s)||(this._blacklistMap.set(s,new XI({userID:s})),l.push(s));0<l.length&&(q.l("".concat(this._n,".onAccountAdded count:").concat(l.length," userIDList:"),l),this._userM.emitOuterEvent($.BLACKLIST_UPDATED,L(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this.startIndex=0,this.maxLimited=100,this.currentSequence=0}}]),ih),QI=(p(Ev,[{key:"_onCloudConfigUpdated",value:function(){var n=this._userM.getCloudConfig("status_query_count"),s=this._userM.getCloudConfig("status_sub_count"),l=this._userM.getCloudConfig("status_unsub_count");q.l("".concat(this._n,"._onCloudConfigUpdated statusQueryCount:").concat(n," statusSubscribeCount:").concat(s)+" statusUnsubscribeCount:".concat(l)),Qe(n)||(this.MAX_QUERY_USER_COUNT=parseInt(n,10)),Qe(n)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(s,10)),Qe(n)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(l,10))}},{key:"onUserStatusUpdated",value:function(h){var h=h.dataList,s=this._userM.getMyUserID(),l=this._userM.get(12),h=h.map(function(P){var I=P.to,k=P.statusType,P=P.customStatus,P=Ul(P);return I===s&&l.setCustomStatus(P),{userID:I,statusType:k,customStatus:P}});q.l("".concat(this._n,".onUserStatusUpdated list:").concat(JSON.stringify(h))),this._userM.emitOuterEvent($.USER_STATUS_UPDATED,h)}},{key:"setSelfStatus",value:function(n){var s=this,l="".concat(this._n,".setSelfStatus");if(this._userM.filterProfanity("customStatus",n)===!1)return Re({code:Be.PROFANITY_FOUND});var h=new it("setSelfStatus"),v=n.customStatus;return this._userM.req({proto:fe.SET_SELF_STATUS,data:{customStatus:v}}).then(function(I){return h.setMessage("customStatus:".concat(v)).end(),q.l("".concat(l," ok. customStatus:").concat(v)),s._userM.get(12).setCustomStatus(v),Ut({userID:s._userM.getMyUserID(),statusType:1,customStatus:v})}).catch(function(I){return h.setError(I).end(),q.e("".concat(l," failed. error:"),I),Re(I)})}},{key:"getUserStatus",value:function(h){var s="".concat(this._n,".").concat("getUserStatus"),h=h.userIDList,l=h===void 0?[]:h,h=this._userM.getMyUserID(),v=L(l),I=void 0,k=v.indexOf(h);if(-1<k&&(v.splice(k,1),I={userID:h,statusType:1,customStatus:this._userM.get(12).getCustomStatus()}),v.length===0)return ln({successUserList:[I],failureUserList:[]});if(!this._userM.canIUse(ue.USER_STATUS))return this._userM.cannotUseCommercialAbility("getUserStatus");v.length>this.MAX_QUERY_USER_COUNT&&(q.w("".concat(s," ").concat(Ol(this.MAX_QUERY_USER_COUNT))),v=l.slice(0,this.MAX_QUERY_USER_COUNT));var P=new it("getUserStatus");return this._userM.req({proto:fe.GET_USER_STATUS,data:{userIDList:v}}).then(function(te){var te=te.data,Y=te.successUserList,Y=Y===void 0?[]:Y,te=te.failureUserList,te=te===void 0?[]:te,Y=Y.map(function(ut){var ve=ut.userID,Ue=ut.statusType,ut=ut.customStatus;return{userID:ve,statusType:Ue,customStatus:Ul(ut)}}),te=te.map(function(mt){var ve=mt.userID,Ue=mt.invalidUserID,ut=mt.errorCode,mt=mt.errorInfo;return{userID:Ct(Ue)?ve:Ue,code:ut,message:mt}}),pe=(Qe(I)||Y.unshift(I),"userID count:".concat(l.length,", success count:").concat(Y.length,", fail count:").concat(te.length));return P.setMessage("".concat(pe)).end(),q.l("".concat(s," ok. ").concat(pe,".")),Ut({successUserList:Y,failureUserList:te})}).catch(function(G){return P.setMessage("userID count:".concat(l.length)).setError(G).end(),q.e("".concat(s," failed. error:"),G),Re(G)})}},{key:"subscribeUserStatus",value:function(h){var s="subscribeUserStatus";if(!this._userM.canIUse(ue.USER_STATUS))return this._userM.cannotUseCommercialAbility(s);var l="".concat(this._n,".").concat(s),h=h.userIDList,h=h===void 0?[]:h,v=L(h),I=(v.length>this.MAX_SUBSCRIBE_USER_COUNT&&(q.w("".concat(l," ").concat(Ol(this.MAX_SUBSCRIBE_USER_COUNT))),v=h.slice(0,this.MAX_SUBSCRIBE_USER_COUNT)),new it(s)),k="userID count:".concat(h.length);return q.l("".concat(l," ").concat(k)),this._userM.req({proto:fe.SUB_USER_STATUS,data:{userIDList:v}}).then(function(P){return P=P.data.failureUserList,P=(P===void 0?[]:P).map(function(ye){var Y=ye.userID,te=ye.invalidUserID,pe=ye.errorCode,ye=ye.errorInfo;return{userID:Ct(te)?Y:te,code:pe,message:ye}}),I.setMessage("".concat(k," fail count:").concat(P.length)).end(),q.l("".concat(l," ok. fail count:").concat(P.length,".")),Ut({failureUserList:P})}).catch(function(P){return I.setMessage(k).setError(P).end(),q.e("".concat(l," failed. error:"),P),Re(P)})}},{key:"unsubscribeUserStatus",value:function(l){var k="unsubscribeUserStatus";if(!this._userM.canIUse(ue.USER_STATUS))return this._userM.cannotUseCommercialAbility(k);var s="".concat(this._n,".").concat(k),l=(l||{}).userIDList,l=l===void 0?[]:l,h=L(l),v=(l.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(q.w("".concat(s," ").concat(Ol(this.MAX_UNSUBSCRIBE_USER_COUNT))),h=l.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT)),new it(k)),I="userID count:".concat(l.length),k=(q.l("".concat(s," ").concat(I)),{userIDList:h});return h.length===0&&(k.userIDList=void 0,k.unsubscribeAll=1),this._userM.req({proto:fe.UNSUB_USER_STATUS,data:k}).then(function(P){return P=P.data.failureUserList,P=(P===void 0?[]:P).map(function(ye){var Y=ye.userID,te=ye.invalidUserID,pe=ye.errorCode,ye=ye.errorInfo;return{userID:Ct(te)?Y:te,code:pe,message:ye}}),v.setMessage("".concat(I," fail count:").concat(P.length)).end(),q.l("".concat(s," ok. fail count:").concat(P.length,".")),Ut({failureUserList:P})}).catch(function(P){return v.setMessage("".concat(I)).setError(P).end(),q.e("".concat(s," failed. error:"),P),Re(P)})}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),Ev),q1=(_(rh,Uo),$I=D(rh),p(rh,[{key:"onContextUpdated",value:function(n){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(n,s){q.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(n," avatar:").concat(s)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:_n.NICK,value:n},{tag:_n.AVATAR,value:s}]}]})}},{key:"onProfileModified",value:function(n){this._profileHandler.onProfileModified(n)}},{key:"onRelationChainModified",value:function(h){var s,l,h=h.dataList;Ct(h)||(s=[],h.forEach(function(v){v.blackListDelAccount&&s.push.apply(s,L(v.blackListDelAccount))}),0<s.length&&this._blacklistHandler.onAccountDeleted(s),l=[],h.forEach(function(v){v.blackListAddAccount&&l.push.apply(l,L(v.blackListAddAccount))}),0<l.length&&this._blacklistHandler.onAccountAdded(l))}},{key:"onConversationsProfileUpdated",value:function(n){this._profileHandler.onConversationsProfileUpdated(n)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.get(13)}},{key:"filterProfanity",value:function(n,s){var h=this.get(29);if(!h)return!0;var h=h.filterText(s[n],"user_profile"),l=h.isAllowedToSend,h=h.modifiedText;return l===!0&&(s[n]=h,!0)}},{key:"isMyFriend",value:function(n){var s=this.get(8);return!!s&&s.isMyFriend(n)}},{key:"getUserProfile",value:function(n){return this._profileHandler.getUserProfile(n)}},{key:"updateMyProfile",value:function(n){return this._profileHandler.updateMyProfile(n)}},{key:"getNickAndAvatarByUserID",value:function(n){return this._profileHandler.getNickAndAvatarByUserID(n)}},{key:"getUserNickAndAvatar",value:function(n){return this._profileHandler.getUserNickAndAvatar(n)}},{key:"getLocalBlacklist",value:function(){var n=this._blacklistHandler.getLocalBlacklist();return ln(n)}},{key:"addBlacklist",value:function(n){return this._blacklistHandler.addBlacklist(n)}},{key:"deleteBlacklist",value:function(n){return this._blacklistHandler.deleteBlacklist(n)}},{key:"onUserStatusUpdated",value:function(n){this._userStatusHandler.onUserStatusUpdated(n)}},{key:"setSelfStatus",value:function(n){return this._userStatusHandler.setSelfStatus(n)}},{key:"getUserStatus",value:function(n){return this._userStatusHandler.getUserStatus(n)}},{key:"subscribeUserStatus",value:function(n){return this._userStatusHandler.subscribeUserStatus(n)}},{key:"unsubscribeUserStatus",value:function(n){return this._userStatusHandler.unsubscribeUserStatus(n)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),rh),K1=(p(Tv,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isTestEnv",value:function(){return this._isTestEnv}},{key:"isPartialUpdatedConvs",value:function(){return this._isPartialUpdatedConvs}},{key:"isSingaporeSite",value:function(){return 2e7<=this._SDKAppID&&this._SDKAppID<3e7||172e7<=this._SDKAppID&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return 3e7<=this._SDKAppID&&this._SDKAppID<4e7||173e7<=this._SDKAppID&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return 4e7<=this._SDKAppID&&this._SDKAppID<5e7||174e7<=this._SDKAppID&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return 5e7<=this._SDKAppID&&this._SDKAppID<6e7||175e7<=this._SDKAppID&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return 6e7<=this._SDKAppID&&this._SDKAppID<7e7||176e7<=this._SDKAppID&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return 7e7<=this._SDKAppID&&this._SDKAppID<8e7||177e7<=this._SDKAppID&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return 8e7<=this._SDKAppID&&this._SDKAppID<9e7||178e7<=this._SDKAppID&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return(n=this._SDKAppID)===0||2e7<=n&&n<9e7||172e7<=n&&n<179e7;var n}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(n){this._isUsingChatCore=n}},{key:"getUIPlatform",value:function(){return this._uiPlatform}},{key:"setUIPlatform",value:function(n){this._uiPlatform=n}},{key:"setUserID",value:function(n){this._userID=n}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(n){this._userSig=n}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(n){this._tinyID=n,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(n){this._customStatus=n}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return Bt?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(n){this._statusInstanceID=n}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(n){this._a2Key=n}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(n){this._applicationID=n}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"_isTUIKit",value:function(){var n=!1,s=!1,l=!1,h=!1,P=[];Ie&&(P=Object.keys(xe));for(var v=0,I=(P=Ae?Object.keys(st?uni:window):P).length;v<I;v++)if(P[v].toLowerCase().includes("uikit")){n=!0;break}var k,P=null,G=(Ie&&!ko(xe.createGamePortal)&&ko(getApp)&&!Qe(getApp())&&(k=getApp().globalData,xn(k)&&k.isTUIKit===!0&&(s=!0)),this._m.get(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))===!0&&(l=!0),null);if(Ye&&!we&&typeof uni>"u"&&__wxConfig&&(G=__wxConfig.pages),Ee&&typeof uni>"u"&&__qqConfig&&(G=__qqConfig.pages),Rt(G)&&0<G.length){for(var Y=0,te=G.length;Y<te;Y++)if(G[Y].toLowerCase().includes("tui")){h=!0;break}G=null}return n||s||l||h}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),Tv),z1={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12},nh=(_(oh,Uo),_p=D(oh),p(oh,[{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&n%this._helloInterval==0&&this._hello()}},{key:"getPushModule",value:function(){var n=void 0,s=this.get(36),l=this.get(28);return s.canIUseTIMPush()?n=s:l.canIUseOfflinePush()&&(n=l),n}},{key:"login",value:function(h){if(this.isLoggedIn())return s=this.getMyUserID(),(s=this.getErrorMessage("RepeatLogin",s))&&q.w(s),ln({actionStatus:"OK",errorCode:0,errorInfo:s,repeatLogin:!0});if(Date.now()-this._lastLoginTs<=15e3)return this.outputWarning("LoggingIn",h.userID),Re({code:Be.REPEAT_LOGIN});q.l("".concat(this._n,".login userID:").concat(h.userID));var s=this._checkLoginInfo(h);if(s.code!==0)return Re(s);var s=this.get(12),l=h.userID,h=h.userSig;return s.setUserID(l),s.setUserSig(h),this.get(20).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var n=this,s=this.get(12),l=s.getScene(),h=0,v=l,I=(l&&l.startsWith("k-")&&(v=z1[l],l="tuikit"),new it("login")),P=(I.setMessage("".concat(v)).setMoreMessage("identifier:".concat(this.getMyUserID())),l==="tuikit"),k=0,P=(st?k=P?v===3||v===4||v===5||v===6?31:v===9||v===10||v===11||v===12?32:4:3:Ie?k=Oe?36:l==="tuikit"?12:11:Ae&&(k=Bt?l==="flutter_web_uikit"?21:20:this._isReactUIKit()?gn?25:24:P?v===1||v===2?29:v===7||v===8?30:gn?17:14:gn?16:13),I.setUIPlatform(k),s.setUIPlatform(k),this.getPushModule()),G=(P&&(this._isWebUniapp=P.getUniAppPlatform(),v=this._getStatusInstanceID(),s.setStatusInstanceID(v),this.get(20).updateProtocolConfig(),h=P.getDeviceBrand()),"".concat(this._n,"._login"));return this._lastLoginTs=Date.now(),this.req({proto:fe.LOGIN,data:{deviceBrand:h,isWebUniapp:this._isWebUniapp}}).then(function(Y){n._lastLoginTs=0;var vo=Date.now(),te=null,Kt=Y.data,pe=Kt.a2Key,ye=Kt.tinyID,ve=Kt.helloInterval,Ue=Kt.instanceID,ut=Kt.timeStamp,mt=Kt.customStatus,mt=mt===void 0?"":mt,Kt=Kt.purchaseBits,en=1e3*ut,Un=vo-I.getStartTs(),Un=en+parseInt(Un/2)-vo,vo=I.getStartTs()+Un;if(I.start(vo),vo=en,Fn=Un,(en=new Date).setTime(vo),q.i("baseTime from server:".concat(en," offset:").concat(Fn)),!ye)throw te=new so({code:Be.NO_TINYID}),I.setError(te).end(),te;if(!pe)throw te=new so({code:Be.NO_A2KEY}),I.setError(te).end(),te;return vo=Ul(mt),en="scene:".concat(l," helloInterval:").concat(ve," instanceID:").concat(Ue," timeStamp:").concat(ut," offset:").concat(Un," customStatus:").concat(vo," "),q.l("".concat(G," ok. ").concat(en)),te="",mt="",Ye&&ko(xe.getAccountInfoSync)&&(ut=xe.getAccountInfoSync().miniProgram)&&(te=ut.appId,mt=ut.envVersion),I.setMoreMessage("".concat(en," href:").concat(Ae?window.location.href:""," mpAppId:").concat(te," envVersion:").concat(mt)).end(),s.setA2Key(pe),s.setTinyID(ye),s.setStatusInstanceID(Ue),s.setCustomStatus(vo),Kt&&n.get(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:Kt}),n.get(20).updateProtocolConfig(),n.emitInnerEvent(So.A2KEY_AND_TINYID_UPDATED),n._helloInterval=ve,n.triggerReady(),Un=n.getPushModule(),Un&&(uni.setStorageSync("timUniAppInstanceID",Ue),Un.init()),n._fetchCloudControlConfig(),n.get(29).init(),Y}).catch(function(Y){return I.setError(Y).end(!0),n._m.setNotReadyReason(Be.LOGIN_FAILED),q.e("".concat(G," failed. error:"),Y),n._lastLoginTs=0,n._m.onLoginFailed(),Re(Y)})}},{key:"logout",value:function(){var n=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0;if(!this.isLoggedIn())return Re({code:Be.USER_NOT_LOGGED_IN});new it("logout").setMessage("identifier:".concat(this.getMyUserID())).end(!0);var l="".concat(this._n,".logout");return q.i("".concat(l," type:").concat(s)),s===0&&this._m.setNotReadyReason(Be.LOGGED_OUT),this.req({proto:fe.LOGOUT,data:{type:s}}).then(function(){return n.resetReady(),ln({})}).catch(function(h){return q.e("".concat(l," error:"),h),n.resetReady(),ln({})})}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.get(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")||0}},{key:"_hello",value:function(){var n=this;this._lastWsHelloTs=Date.now(),this.req({proto:fe.HELLO,data:{isWebUniapp:this._isWebUniapp}}).catch(function(s){q.w("".concat(n._n,"._hello error:"),s)})}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(n){var s=0;return Ct(this.get(12).getSDKAppID())?s=Be.NO_SDKAPPID:Ct(n.userID)?s=Be.NO_IDENTIFIER:Ct(n.userSig)&&(s=Be.NO_USERSIG),{code:s}}},{key:"_isReactUIKit",value:function(){return Ae&&window.tencent_cloud_im_csig_react_uikit_23F_xa!==void 0}},{key:"onMultipleAccountKickedOut",value:function(n){var s=this;new it("kickedOut").setMessage("type:".concat(O.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),q.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.logout(1).then(function(){s.emitOuterEvent($.KICKED_OUT,{type:O.KICKED_OUT_MULT_ACCOUNT}),s._m.setNotReadyReason(Be.KICKED_OUT_MULT_ACCOUNT),s._m.reset()})}},{key:"onMultipleDeviceKickedOut",value:function(n){var s=this;new it("kickedOut").setMessage("type:".concat(O.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),q.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.logout(1).then(function(){s.emitOuterEvent($.KICKED_OUT,{type:O.KICKED_OUT_MULT_DEVICE}),s._m.setNotReadyReason(Be.KICKED_OUT_MULT_DEVICE),s._m.reset()})}},{key:"onUserSigExpired",value:function(){new it("kickedOut").setMessage(O.KICKED_OUT_USERSIG_EXPIRED).end(!0),q.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),this.get(12).getStatusInstanceID()!==0&&(this.emitOuterEvent($.KICKED_OUT,{type:O.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(Be.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(n){new it("kickedOut").setMessage("type:".concat(O.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),q.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.get(12).getStatusInstanceID()!==0&&(this.emitOuterEvent($.KICKED_OUT,{type:O.KICKED_OUT_REST_API}),this._m.setNotReadyReason(Be.KICKED_OUT_REST_API),this._m.reset(),this.get(21).onRestApiKickedOut())}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),oh);function oh(n){return u(this,oh),(n=_p.call(this,n))._n="SignModule",n._helloInterval=120,n._lastLoginTs=0,n._lastWsHelloTs=0,n._isWebUniapp=0,Zd.mixin(N(n)),n}function Tv(n,s){u(this,Tv),this._m=n,this._isLoggedIn=!1,this._SDKAppID=s.SDKAppID,this._userID=s.userID||"",this._userSig=s.userSig||"",this._version="3.3.5",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=s.unlimitedAVChatRoom,this._scene=s.scene||"",this._oversea=s.oversea,this._instanceID=s.instanceID,this._statusInstanceID=0,this._isDevMode=s.devMode,this._isTestEnv=s.testEnv,this._proxyServer=s.proxyServer,this._fileUploadProxy=s.fileUploadProxy,this._fileDownloadProxy=s.fileDownloadProxy,this._applicationID=0,this._isPartialUpdatedConvs=s.partialUpdatedConversations,this._isUsingChatCore=!1,this._uiPlatform=0}function rh(n){return u(this,rh),(n=$I.call(this,n))._n="UserModule",n._profileHandler=new $1(N(n)),n._blacklistHandler=new H1(N(n)),n._userStatusHandler=new QI(N(n)),n.getInnerEmitterInstance().on(So.A2KEY_AND_TINYID_UPDATED,n.onContextUpdated,N(n)),n}function Ev(n){u(this,Ev),this._userM=n,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userM.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}function ih(n){u(this,ih),this._userM=n,this._n="BlacklistHandler",this._blacklistMap=new Map,this.startIndex=0,this.maxLimited=100,this.currentSequence=0}function sh(n){u(this,sh),this._userM=n,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}function ah(n){return u(this,ah),(n=HI.call(this,n))._n="TopicModule",n._topicMap=new Map,n._getTopicTimeMap=new Map,n.TOPIC_CACHE_TIME=300,n.TOPIC_LAST_ACTIVE_TIME=3600,n.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function Mv(n,s){u(this,Mv),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=BI(n.lastMessage,s),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(n)}function lh(n){return u(this,lh),(n=qI.call(this,n))._n="GroupModule",n._commonGroupHandler=new th(N(n)),n._groupAttributesHandler=new L1(N(n)),n._groupCountersHandler=new P1(N(n)),n._AVChatRoomHandler=new jI(N(n)),n._groupTipsHandler=new ji(N(n)),n._groupSystemNoticeHandler=new x1(N(n)),n._groupMemberHandler=new U1(N(n)),n.groupMap=new Map,n._unjoinedAVChatRoomList=new Map,n._receiptDetailCompleteMap=new Map,n._onlineMemberCountMap=new Map,n._timeoutIDs=[],n.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function kv(n){u(this,kv),this._grpM=n,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}function Av(n){u(this,Av),this._grpM=n,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._grpM.getInnerEmitterInstance().on(So.PROFILE_UPDATED,this._onProfileUpdated,this)}function Rv(n){u(this,Rv),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline=!1,this.updateMember(n)}function jo(n){u(this,jo),this._grpM=n,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this.sequencesLinkedList=new Cv(200),this.messageIDLinkedList=new Cv(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}function wv(I){u(this,wv);var s=I.manager,l=I.groupID,h=I.onInit,v=I.onSuccess,I=I.onFail;this._n="Polling",this._manager=s,this._grpM=s._grpM,this._onInit=h,this._onSuccess=v,this._onFail=I,this._groupID=l,this._timeoutID=-1,this._isRunning=!1,this._proto=fe.AV_POLLING}function Dv(n){u(this,Dv),this._grpM=n,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._grpM.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}function Ov(n){u(this,Ov),this._grpM=n,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._grpM.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}function Nv(n){u(this,Nv),this._grpM=n,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._pagingStatus=ws,this._pagingGetCostList=[],n.getInnerEmitterInstance().on(So.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)}function Lv(n){u(this,Lv),this._grpM=n,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4}function Wc(n){return u(this,Wc),(n=KI.call(this,n))._n="ConversationModule",Zd.mixin(N(n)),n._messageListHandler=new A1,n._messageRemindHandler=new D1(N(n)),n._convGroupHandler=new O1(N(n)),n.singlyLinkedList=new Cv(100),n._pagingStatus=ws,n._pagingTimeStamp=0,n._pagingStartIndex=0,n._pagingPinnedTimeStamp=0,n._pagingPinnedStartIndex=0,n._pagingConvIDMap=new Map,n._convIDFromUnreadDBMap=new Map,n._conversationMap=new Map,n._tmpGroupList=[],n._tmpGroupAtTipsList=[],n._peerReadTimeMap=new Map,n._completedMap=new Map,n._roamingMessageKeyAndTimeMap=new Map,n._roamingMessageSequenceMap=new Map,n._remoteGroupReadSequenceMap=new Map,n._convTotalUnreadCount=0,n._pagingGetCostList=[],n._convMapForDiff=new Map,n._partialUpdatedConvMap=new Map,n._initListeners(),n}function ch(n){u(this,ch),this._convM=n,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=ws}function Pv(n){u(this,Pv),this._convM=n,this._n="MessageRemindHandler"}function jc(n,s){var l=2<arguments.length&&arguments[2]!==void 0&&arguments[2];u(this,jc),this.conversationID=n.conversationID||"",this.unreadCount=n.unreadCount||0,this.type=n.type||"",this.lastMessage=GI(n.lastMessage,s,l),n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=n.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=n.isPinned||!1,this.messageRemindType=n.messageRemindType,this.markList=n.markList||[],this.customData=n.customData||"",this.conversationGroupList=n.conversationGroupList||[],this.draftText=n.draftText||"",this._initProfile(n),this.subType=this.groupProfile?this.groupProfile.type:""}function Uv(n){u(this,Uv),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(n)}function xv(n){u(this,xv),this.MAX_LENGTH=n,this.pTail=null,this.pNodeToDel=null,this.map=new Map}function Fv(n){var s=this;u(this,Fv),Ct(n)||(this.userID=n.userID||"",this.nick=n.nick||"",this.gender=n.gender||"",this.birthday=n.birthday||0,this.location=n.location||"",this.selfSignature=n.selfSignature||"",this.allowType=n.allowType||O.ALLOW_TYPE_ALLOW_ANY,this.language=n.language||0,this.avatar=n.avatar||"",this.messageSettings=n.messageSettings||0,this.adminForbidType=n.adminForbidType||O.FORBID_TYPE_NONE,this.level=n.level||0,this.role=n.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],Ct(n.profileCustomField)||n.profileCustomField.forEach(function(l){s.profileCustomField.push({key:l.key,value:l.value})}))}function uh(){return null}function ZI(n){var s=n.get(12);return{SDKType:10,SDKAppID:s.getSDKAppID(),SDKVersion:s.getVersion(),tinyID:Number(s.getTinyID()),userID:s.getUserID(),platform:n.getPlatform(),instanceID:s.getInstanceID(),traceID:oo()}}p(Hv,[{key:"_errorTolerantHandle",value:function(){Ie||!Qe(window)&&this._canIUseCookies()||(this.getItem=uh,this.setItem=uh,this.removeItem=uh,this.clear=uh)}},{key:"onCheckTimer",value:function(n){n%20==0&&this._storageQueue.size!==0&&this._doFlush()}},{key:"_doFlush",value:function(){try{var n,s=Z(this._storageQueue);try{for(s.s();!(n=s.n()).done;){var l=x(n.value,2),h=l[0],v=l[1];this._setStorageSync(this._getKey(h),v)}}catch(I){s.e(I)}finally{s.f()}this._storageQueue.clear()}catch(I){q.w("".concat(this._n,"._doFlush error:"),I)}}},{key:"_getPrefix",value:function(){var n=this._m.get(12);return"TIM_".concat(n.getSDKAppID(),"_").concat(n.getUserID(),"_")}},{key:"_getKey",value:function(n){return"".concat(this._getPrefix()).concat(n)}},{key:"getItem",value:function(n){var s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var l=s?this._getKey(n):n;return this.getStorageSync(l)}catch(h){return q.w("".concat(this._n,".getItem error:"),h),{}}}},{key:"setItem",value:function(n,s){var l;2<arguments.length&&arguments[2]!==void 0&&arguments[2]?(l=!(3<arguments.length&&arguments[3]!==void 0)||arguments[3]?this._getKey(n):n,this._setStorageSync(l,s)):this._storageQueue.set(n,s)}},{key:"clear",value:function(){try{Ie?xe.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(n){q.w("".concat(this._n,".clear error:"),n)}}},{key:"removeItem",value:function(n){var s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var l=s?this._getKey(n):n;this._removeStorageSync(l)}catch(h){q.w("".concat(this._n,".removeItem error:"),h)}}},{key:"getSize",value:function(n){var s=this,l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"b";try{var h={size:0,limitSize:5242880,unit:l};if(Object.defineProperty(h,"leftSize",{enumerable:!0,get:function(){return h.limitSize-h.size}}),Ie&&(h.limitSize=1024*xe.getStorageInfoSync().limitSize),n)h.size=JSON.stringify(this.getItem(n)).length+this._getKey(n).length;else if(Ie)xe.getStorageInfoSync().keys.forEach(function(I){h.size+=JSON.stringify(s.getStorageSync(I)).length+s._getKey(I).length});else if(this._canIUseCookies())for(var v in localStorage)localStorage.hasOwnProperty(v)&&(h.size+=localStorage.getItem(v).length+v.length);return this._convertUnit(h)}catch(I){q.w("".concat(this._n," error:"),I)}}},{key:"_convertUnit",value:function(n){var s,l={},h=n.unit;for(s in l.unit=h,n)typeof n[s]=="number"&&(h.toLowerCase()==="kb"?l[s]=Math.round(n[s]/1024):h.toLowerCase()==="mb"?l[s]=Math.round(n[s]/1024/1024):l[s]=n[s]);return l}},{key:"_setStorageSync",value:function(n,s){Ie?Ve?my.setStorageSync({key:n,data:s}):xe.setStorageSync(n,s):this._canIUseCookies()&&localStorage.setItem(n,JSON.stringify(s))}},{key:"getStorageSync",value:function(n){return Ie?Ve?my.getStorageSync({key:n}).data:xe.getStorageSync(n):this._canIUseCookies()?JSON.parse(localStorage.getItem(n)):{}}},{key:"_removeStorageSync",value:function(n){Ie?Ve?my.removeStorageSync({key:n}):xe.removeStorageSync(n):this._canIUseCookies()&&localStorage.removeItem(n)}},{key:"_canIUseCookies",value:function(){return navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._doFlush()}}]);var bp,eb=Hv,W1=(p($v,[{key:"pushIn",value:function(n){q.d("".concat(this._n,".pushIn"),this._report.length,n),this._report.push(n)}},{key:"backfill",value:function(n){var s;Rt(n)&&n.length!==0&&(q.d("".concat(this._n,".backfill"),this._report.length,n.length),(s=this._report).unshift.apply(s,L(n)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return this._report.length===0}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var n=this._report.slice();return this._reset(),n}}]),$v),Vv=(_(dh,Uo),bp=D(dh),p(dh,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var n=this,s=this.get(13),l=s.getItem(this.TAG,!1);!Ct(l)&&ko(l.forEach)&&(q.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(l.length)),l.forEach(function(h){n._reportBody.pushIn(h)}),s.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("evt_rpt_threshold"),s=this.getCloudConfig("evt_rpt_waiting"),l=this.getCloudConfig("evt_rpt_level"),h=this.getCloudConfig("evt_rpt_sdkappid_bl"),v=this.getCloudConfig("evt_rpt_tinyid_wl");Qe(n)||(this.MIN_THRESHOLD=Number(n)),Qe(s)||(this.WAITING_TIME=Number(s)),Qe(l)||(this.REPORT_LEVEL=l.split(",").map(function(I){return Number(I)})),Qe(h)||(this.REPORT_SDKAPPID_BLACKLIST=h.split(",").map(function(I){return Number(I)})),Qe(v)||(this.REPORT_TINYID_WHITELIST=v.split(","))}},{key:"pushIn",value:function(n){n instanceof it&&(n.updateTimeStamp(),this._reportBody.pushIn(n),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(n){var s=this,h=this.get(12),l=h.getSDKAppID(),h=h.getTinyID();return lp(this.REPORT_SDKAPPID_BLACKLIST,l)&&!DI(this.REPORT_TINYID_WHITELIST,h)?[]:n.filter(function(v){return s.REPORT_LEVEL.includes(v.level)})}},{key:"_report",value:function(){var n,s,l=this;this._reportBody.isEmpty()||(n=this._reportBody.getLogsInMemory(),(s=this._filterLogs(n)).length!==0?(s={header:ZI(this),event:s},this.req({proto:fe.SSO_STAT,data:i({},s)}).then(function(){l._lastReportTime=Date.now()}).catch(function(h){q.w("".concat(l._n,"._report failed. error:"),h),l._lastReportTime=Date.now(),l._reportBody.backfill(n),l._reportBody.getLogsNumInMemory()>l.MAX_THRESHOLD&&l._flushAtOnce()})):this._lastReportTime=Date.now())}},{key:"_flushAtOnce",value:function(){var n=this.get(13),s=n.getItem(this.TAG,!1),l=this._reportBody.getLogsInMemory(),h="".concat(this._n,"._flushAtOnce");Ct(s)?(q.l("".concat(h," count:").concat(l.length)),n.setItem(this.TAG,l,!0,!1)):((l=l.concat(s)).length>this.MAX_THRESHOLD&&(l=l.slice(0,this.MAX_THRESHOLD)),q.l("".concat(h," count:").concat(l.length)),n.setItem(this.TAG,l,!0,!1))}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),dh),Gv="none",Bv="online",tb=(p(Wa,[{key:"start",value:function(){var n=this,s="".concat(this._n,".start");Ie?(xe.getNetworkType({success:function(l){n._networkType=l.networkType||l.subtype||"",l.networkType===Gv?q.w("".concat(s," no network, please check!")):q.i("".concat(s," networkType:").concat(l.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),xe.onNetworkStatusChange(this._mpNetworkStatusCallback)):(this._networkType=Bv,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window&&(window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback)))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:Bv})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:Gv})}},{key:"_onNetworkStatusChange",value:function(l){var s=l.isConnected,l=l.networkType,h="".concat(this._n,"._onNetworkStatusChange"),v=!1,I="previous:".concat(this._networkType," current:").concat(l);s?(q.i("".concat(h," ").concat(I)),this._networkType!==l&&(v=!0,this._networkType=l,this._m.get(21).reConnect(!0))):this._networkType!==l&&(v=!0,this._networkType=l,q.w("".concat(h," no network, please check!")),this._m.get(21).offline()),v&&new it("networkChange").setMessage("isConnected:".concat(s," ").concat(I)).end()}},{key:"isOnline",value:function(){return this._networkType!==Gv}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),Ie?this._mpNetworkStatusCallback!==null&&(xe.offNetworkStatusChange&&(qe||we?xe.offNetworkStatusChange(this._mpNetworkStatusCallback):xe.offNetworkStatusChange()),this._mpNetworkStatusCallback=null):window&&(this._webOnlineCallback!==null&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),this._onWebOffline!==null&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null))}}]),Wa);function Wa(n){u(this,Wa),this._m=n,this._networkType=Bv,this._n="NetMonitorModule",this.MAX_WAIT_TIME=3e3,this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null}function dh(n){u(this,dh),(n=bp.call(this,n))._n="EventStatModule",n.TAG="im-ssolog-event",n._reportBody=new W1,n.MIN_THRESHOLD=20,n.MAX_THRESHOLD=100,n.WAITING_TIME=6e4,n.REPORT_LEVEL=[4,5,6],n.REPORT_SDKAPPID_BLACKLIST=[],n.REPORT_TINYID_WHITELIST=[],n._lastReportTime=Date.now();var s=n.getInnerEmitterInstance();return s.on(So.A2KEY_AND_TINYID_UPDATED,n._onLoginSuccess,N(n)),s.on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function $v(n){u(this,$v),this._n="SSOLogBody",this._report=[]}function Hv(n){u(this,Hv),this._m=n,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}kt=Wn={exports:{}},ob=Object.prototype.hasOwnProperty,jr="~",Object.create&&(Os.prototype=Object.create(null),new Os().__proto__||(jr=!1)),ri.prototype.eventNames=function(){var n,s,l=[];if(this._eventsCount===0)return l;for(s in n=this._events)ob.call(n,s)&&l.push(jr?s.slice(1):s);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(n)):l},ri.prototype.listeners=function(s){var s=jr?jr+s:s,l=this._events[s];if(!l)return[];if(l.fn)return[l.fn];for(var h=0,v=l.length,I=new Array(v);h<v;h++)I[h]=l[h].fn;return I},ri.prototype.listenerCount=function(n){return n=jr?jr+n:n,n=this._events[n],n?n.fn?1:n.length:0},ri.prototype.emit=function(n,s,l,h,v,I){var k=jr?jr+n:n;if(!this._events[k])return!1;var P,G=this._events[k],Y=arguments.length;if(G.fn){switch(G.once&&this.removeListener(n,G.fn,void 0,!0),Y){case 1:return G.fn.call(G.context),!0;case 2:return G.fn.call(G.context,s),!0;case 3:return G.fn.call(G.context,s,l),!0;case 4:return G.fn.call(G.context,s,l,h),!0;case 5:return G.fn.call(G.context,s,l,h,v),!0;case 6:return G.fn.call(G.context,s,l,h,v,I),!0}for(ye=1,P=new Array(Y-1);ye<Y;ye++)P[ye-1]=arguments[ye];G.fn.apply(G.context,P)}else for(var te,pe=G.length,ye=0;ye<pe;ye++)switch(G[ye].once&&this.removeListener(n,G[ye].fn,void 0,!0),Y){case 1:G[ye].fn.call(G[ye].context);break;case 2:G[ye].fn.call(G[ye].context,s);break;case 3:G[ye].fn.call(G[ye].context,s,l);break;case 4:G[ye].fn.call(G[ye].context,s,l,h);break;default:if(!P)for(te=1,P=new Array(Y-1);te<Y;te++)P[te-1]=arguments[te];G[ye].fn.apply(G[ye].context,P)}return!0},ri.prototype.on=function(n,s,l){return rb(this,n,s,l,!1)},ri.prototype.once=function(n,s,l){return rb(this,n,s,l,!0)},ri.prototype.removeListener=function(n,s,l,h){if(n=jr?jr+n:n,!this._events[n])return this;if(!s)return Sp(this,n),this;var v=this._events[n];if(v.fn)v.fn!==s||h&&!v.once||l&&v.context!==l||Sp(this,n);else{for(var I=0,k=[],P=v.length;I<P;I++)(v[I].fn!==s||h&&!v[I].once||l&&v[I].context!==l)&&k.push(v[I]);k.length?this._events[n]=k.length===1?k[0]:k:Sp(this,n)}return this},ri.prototype.removeAllListeners=function(n){return n?(n=jr?jr+n:n,this._events[n]&&Sp(this,n)):(this._events=new Os,this._eventsCount=0),this},ri.prototype.off=ri.prototype.removeListener,ri.prototype.addListener=ri.prototype.on,ri.prefixed=jr,kt.exports=ri.EventEmitter=ri;var nb,ob,jr,Cp=Wn.exports,j1=["requestSnapshotUrl"],Y1=(_(hh,Uo),nb=D(hh),p(hh,[{key:"_init",value:function(){var n=this.get(18);this.TIMUploadPlugin=n.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin?this._initUploaderMethod():(this.COSSDK=n.getPlugin(n=Ie?"cos-wx-sdk":"cos-js-sdk"),this.COSSDK?(this._getAuthorizationKey(),this.outputWarning("CosReplacement",n)):this.outputWarning("PluginUndetected"))}},{key:"_onCloudConfigUpdated",value:function(){var n="".concat(this._n,"._onCloudConfigUpdated"),s=this.getCloudConfig("upload_size_limit"),l=this.getCloudConfig("simple_cos");if(q.l("".concat(n," uploadSizeLimit:").concat(s," simpleCos:").concat(l)),!Qe(s))try{var h=JSON.parse(s);this.UPLOAD_SIZE_LIMIT={A:h.a?1048576*parseInt(h.a):this.UPLOAD_SIZE_LIMIT.A,F:h.f?1048576*parseInt(h.f):this.UPLOAD_SIZE_LIMIT.F,I:h.i?1048576*parseInt(h.i):this.UPLOAD_SIZE_LIMIT.I,V:h.v?1048576*parseInt(h.v):this.UPLOAD_SIZE_LIMIT.V}}catch{}Qe(l)||(this.isSimpleCos=l==="1")}},{key:"_getAuthorizationKey",value:function(){var n=this,s="".concat(this._n,".").concat("_getAuthorizationKey"),l=new it("_getAuthorizationKey"),h=Math.ceil(Date.now()/1e3);this.req({proto:fe.COS_SIGN,data:{duration:this.expiredTimeLimit}}).then(function(I){var I=I.data,k=(q.l("".concat(s," ok. data:"),I),I.expiredTime-h);l.setMessage("requestId:".concat(I.requestId," requestTime:").concat(h," expiredTime:").concat(I.expiredTime," diff:").concat(k,"s")).end(),!Ie&&I.region&&(n.region=I.region),n.appid=I.appid,n.bucketName=I.bucketName,n.ciUrl=I.ciUrl,n.directory=I.directory,n.downloadUrl=I.downloadUrl,n.uploadUrl=I.uploadUrl,n.cosOptions={secretId:I.secretId,secretKey:I.secretKey,sessionToken:I.sessionToken,expiredTime:I.expiredTime},q.l("".concat(s," ok. region:").concat(n.region," bucketName:").concat(n.bucketName)),n._initUploaderMethod()}).catch(function(v){l.setError(v).end(),q.w("".concat(s," failed. error:"),v)})}},{key:"_getCosPreSigUrl",value:function(n){var s=this,l="".concat(this._n,".").concat("_getCosPreSigUrl"),h=Math.ceil(Date.now()/1e3),v=new it("_getCosPreSigUrl"),I={uploadMethod:n.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:n.userID,conversationType:n.conversationType,uploadConfig:[{fileID:1,fileType:n.fileType,fileName:n.fileName}]},k=fe.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(I={fileType:n.fileType,fileName:n.fileName,uploadMethod:n.uploadMethod,duration:n.duration},k=fe.COS_PRE_SIG),this.req({proto:k,data:I}).then(function(te){s.tryCount=0;var G,Y,te=te.data||{},pe=(q.l("".concat(l," ok. isSimpleCos:").concat(s.isSimpleCos," data:"),te),"");return pe=s.isSimpleCos?(G=(Y=te.preSig[0]).uploadUrl,Y=Y.fileKey,"uploadIP:".concat(te.uploadIP," uploadUrl:").concat(G," fileKey:").concat(Y," cost:").concat(ar(h))):"requestId:".concat(te.requestId," expiredTime:").concat(te.expiredTime," diff:").concat(te.expiredTime-h,"s"),v.setMessage(pe).end(),te}).catch(function(P){return P.code===-1&&(P.code=Be.COS_GET_SIG_FAIL),v.setError(P).end(),q.w("".concat(l," failed. error:"),P),s.tryCount<1?(s.tryCount++,s._getCosPreSigUrl(n)):(s.tryCount=0,Re({code:Be.COS_GET_SIG_FAIL}))})}},{key:"_initUploaderMethod",value:function(){var n=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(s,l){n.timUploadPlugin.uploadFile(s,l)});this.appid&&(this.cos=Ie?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=Ie?function(s,l){n.cos.postObject(s,l)}:function(s,l){n.cos.uploadFiles(s,l)})}},{key:"onCheckTimer",value:function(n){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&n%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"_getAuthorization",value:function(n,s){s({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(n){if(n._relayFlag===!0)return Promise.resolve();var s=this.get(26);switch(n.type){case O.MSG_IMAGE:return s.addTotalCount(kr),this._uploadImage(n);case O.MSG_FILE:return s.addTotalCount(kr),this._uploadFile(n);case O.MSG_AUDIO:return s.addTotalCount(kr),this._uploadAudio(n);case O.MSG_VIDEO:return s.addTotalCount(kr),this._uploadVideo(n);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(n){var s=this,l=this.get(2),h=n.getElements()[0],v=l.getMessageOption(n.clientSequence);return this.doUploadImage({file:v.payload.file,to:v.to,message:n,onProgress:function(I){if(h.updatePercent(I),ko(v.onProgress))try{v.onProgress(I)}catch{return Re({code:Be.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then(function(en){var k=en.location,P=en.fileType,G=en.fileSize,Y=en.width,te=en.height,pe=en.smallImageUrl,ye=en.smallImageWidth,ve=en.smallImageHeight,Ue=en.largeImageUrl,ut=en.largeImageWidth,mt=en.largeImageHeight,Kt=en.imageInfoArray,en=s.isPrivateNetWork()?k:gi(k);h.updateImageFormat(P);var Un,vo,nr={size:G,url:en,width:Y,height:te};if(Kt&&0<Kt.length)for(var pr=0;pr<Kt.length;pr++){var br=Kt[pr];br.type===1?Un=br:br.type===2?vo=br:nr=i(i({},nr),br)}else vo=pe&&Ue?(Un={url:pe,width:ye,height:ve},{url:Ue,width:ut,height:mt}):(Un=Ud({originUrl:en,originWidth:Y,originHeight:te,min:198}),Ud({originUrl:en,originWidth:Y,originHeight:te,min:720}));return h.updateImageInfoArray([i({},nr),i({},vo),i({},Un)]),n})}},{key:"_uploadFile",value:function(n){var s=this,l=this.get(2),h=n.getElements()[0],v=l.getMessageOption(n.clientSequence);return this.doUploadFile({file:v.payload.file,to:v.to,message:n,onProgress:function(I){if(h.updatePercent(I),ko(v.onProgress))try{v.onProgress(I)}catch{return Re({code:Be.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then(function(I){return I=I.location,I=s.isPrivateNetWork()?I:gi(I),h.updateFileUrl(I),n})}},{key:"_uploadAudio",value:function(n){var s=this,l=this.get(2),h=n.getElements()[0],v=l.getMessageOption(n.clientSequence);return this.doUploadAudio({file:v.payload.file,to:v.to,message:n,onProgress:function(I){if(h.updatePercent(I),ko(v.onProgress))try{v.onProgress(I)}catch{return Re({code:Be.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then(function(I){return I=I.location,I=s.isPrivateNetWork()?I:gi(I),h.updateAudioUrl(I),n})}},{key:"_uploadVideo",value:function(n){var s=this,l=this.get(2),h=n.getElements()[0],v=l.getMessageOption(n.clientSequence);return this.doUploadVideo({file:v.payload.file,to:v.to,message:n,onProgress:function(I){if(h.updatePercent(I),ko(v.onProgress))try{v.onProgress(I)}catch{return Re({code:Be.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then(function(k){var P=k.location,k=k.snapshotInfo,P=s.isPrivateNetWork()?P:gi(P);return h.updateVideoUrl(P),Ct(k)||h.updateSnapshotInfo(k),n})}},{key:"_checkSizeError",value:function(n){var s="";return n==="A"?s="audio":n==="I"?s="image":n==="V"?s="video":n==="F"&&(s="file"),Re({code:Be["MSG_".concat(n,"_SIZE_LIMIT")],message:this.getErrorMessage("UploadSizeLimit",s,"".concat(this.UPLOAD_SIZE_LIMIT[n]/1048576,"MB"))})}},{key:"doUploadImage",value:function(n){var s=this;if(!n.file||this._isEmptyFileList(n.file.files))return Re({code:Be.MSG_I_SELECT_F_FIRST});var l=this._checkImageType(n.file);if(l!==!0||(l=this._checkImageSize(n.file),l!==!0))return l;var h=null;return this._setUploadFileType(1),this.uploadByCOS(n).then(function(v){if(h=v,s.isPrivateNetWork())return I=s.getFileDownloadProxy(),Ld(oi(v.location,I));if(Rt(h.imageInfoArray)){var I=h.imageInfoArray.find(function(k){return k.type===3});if(I)return I}return Ld("https://".concat(v.location))}).then(function(v){return h.width=v.width,h.height=v.height,Promise.resolve(h)})}},{key:"_checkImageType",value:function(n){var s="",s=Ie?n.url.slice(n.url.lastIndexOf(".")+1):n.files[0].name.slice(n.files[0].name.lastIndexOf(".")+1);return 0<=zI.indexOf(s.toLowerCase())||Re({code:Be.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(n){return(n=(Ie?n:n.files[0]).size)===0?Re({code:Be.MSG_F_IS_EMPTY}):n<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(n){return!n.file||this._isEmptyFileList(n.file.files)?Re({code:Be.MSG_F_SELECT_F_FIRST}):n.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):n.file.files[0].size===0?Re({code:Be.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(n))}},{key:"doUploadVideo",value:function(n){return n.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):n.file.videoFile.size===0?Re({code:Be.MSG_F_IS_EMPTY}):yp.indexOf(n.file.videoFile.type)===-1?Re({code:Be.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),Ie?this.handleVideoUpload(i(i({},n),{},{file:n.file.videoFile})):Ae?this.handleVideoUpload(n):void 0)}},{key:"handleVideoUpload",value:function(n){var s=this;return new Promise(function(l,h){s.uploadByCOS(n).then(function(v){l(v)}).catch(function(){s.uploadByCOS(n).then(function(v){l(v)}).catch(function(){h(new so({code:Be.MSG_V_UPLOAD_FAIL}))})})})}},{key:"doUploadAudio",value:function(n){return n.file?n.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):n.file.size===0?Re({code:Be.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(n)):Re({code:Be.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(n){var s=this;if(!ko(this._cosUploadMethod))return this.outputWarning("PluginUndetected"),Re({code:Be.COS_UNDETECTED});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(n);var l=new it("upload"),h="".concat(this._n,".uploadByCOS"),v=Date.now(),I=this._getFile(n);return new Promise(function(k,P){var G=Ie?s._createCosOptionsWXMiniApp(n):s._createCosOptionsWeb(n),Y=s;s._cosUploadMethod(G,function(te,pe){var ye=Object.create(null);if(pe){if(te||Rt(pe.files)&&pe.files[0].error)return ve=new so({code:Be.MSG_F_UPLOAD_FAIL}),l.setError(ve).end(),q.l("".concat(h," failed. error:"),pe.files[0].error),pe.files[0].error.statusCode===403&&(q.w("".concat(h," failed. cos AccessKeyId was invalid, regain auth key!")),s._getAuthorizationKey()),void P(ve);ye.fileName=I.name,ye.fileSize=I.size,ye.fileType=I.type.slice(I.type.indexOf("/")+1).toLowerCase(),ye.location=(Ie?pe:pe.files[0].data).Location;var ve=Date.now()-v,pe=Y._formatFileSize(I.size),Ue=Y._formatSpeed(1e3*I.size/ve),pe="size:".concat(pe," time:").concat(ve,"ms speed:").concat(Ue),Ue=(q.l("".concat(h," success. name:").concat(I.name," ").concat(pe)),k(ye),s.get(26));return Ue.addCost(kr,ve),Ue.addFileSize(kr,I.size),void l.setMessage(pe).end()}ye=new so({code:Be.MSG_F_UPLOAD_FAIL}),l.setError(ye).end(),q.w("".concat(h," failed. error:"),te),te.statusCode===403&&(q.w("".concat(h," failed. cos AccessKeyId was invalid, regain auth key!")),s._getAuthorizationKey()),P(ye)})})}},{key:"_uploadWithPreSigUrl",value:function(n){var s=this,l="".concat(this._n,"._uploadWithPreSigUrl"),h=this._getFile(n);return this._createCosOptionsPreSigUrl(n).then(function(v){return new Promise(function(I,k){var P=new it("upload"),G=v.requestSnapshotUrl,Y=G===void 0?void 0:G,te=E(v,j1),pe=Date.now();s._cosUploadMethod(te,function(ye,ve){var Ue,ut,mt;return ye||ve.statusCode===403?(P.setError(new so(ye)).end(),ut={HttpStatusCode:9999,CostTime:ar(pe,!1),error:ye,url:v.url},ve.data&&ve.data.uploadIP&&(ut.uploadIP=ve.data.uploadIP),s._uploadSSOLog(ut),q.l("".concat(l," failed, error:"),ye),void k(new so({code:Be.MSG_F_UPLOAD_FAIL}))):(Ue=Object.create(null),ut=ve.data.location||"",s.isPrivateNetWork()||ut.indexOf("https://")!==0&&ut.indexOf("http://")!==0||(ut=ut.split("//")[1]),Ue.fileName=h.name,Ue.fileSize=h.size,Ue.fileType=h.type.slice(h.type.indexOf("/")+1).toLowerCase(),Ue.location=ut,ye=ar(pe,!1),ut=s._formatFileSize(h.size),mt=s._formatSpeed(1e3*h.size/ye),ut="size:".concat(ut," time:").concat(ye,"ms speed:").concat(mt," res:").concat(JSON.stringify(ve.data)),q.l("".concat(l," ok. name:").concat(h.name," ").concat(ut)),P.setMessage(ut).end(),mt={HttpStatusCode:ve.statusCode,FileSize:h.size,CostTime:ye,url:v.url},ve.data&&ve.data.uploadIP&&(mt.uploadIP=ve.data.uploadIP),s._uploadSSOLog(mt),(ut=s.get(26)).addCost(kr,ye),ut.addFileSize(kr,h.size),mt=[],te.thumbUrl&&te.largeUrl&&mt.push.apply(mt,[s._getSmallImageInfoByUrl(te.thumbUrl,Ue),s._getLargeImageInfoByUrl(te.largeUrl,Ue)]),s.uploadFileType===1&&s.isSimpleCos&&!s.isPrivateNetWork()&&(mt.push(s._getImageInfoArray(te.downloadUrl,Ue)),ve.data.uploadIP&&mt.push(s._getDownloadIP(te.downloadUrl.split("//")[1].split("/")[0],Ue))),Y&&mt.push(s._getSnapshotInfoByUrl(Y,Ue)),0<mt.length?Promise.all(mt).then(function(){I(Ue)}):void I(Ue))})})})}},{key:"_getDownloadIP",value:function(n,s){var l="".concat(this._n,"._getDownloadIP"),h=Date.now();return this.req({proto:fe.GET_IP,data:{domainName:n}}).then(function(v){var I;v.data&&v.data.ip&&(q.l("".concat(l," ok. downloadIP:").concat(v.data.ip," cost:").concat(ar(h))),(I=s.location.split("/"))[0]=v.data.ip,s.location=I.join("/"))}).catch(function(v){})}},{key:"_getImageInfoArray",value:function(n,s){var l=this,h="".concat(this._n,"._getImageInfoArray"),v=Date.now();return this.req({proto:fe.GET_IMAGE_INFO,data:{imageUrl:n}}).then(function(I){return I=I.data||{},q.l("".concat(h," ok. data: ").concat(JSON.stringify(I)," cost:").concat(ar(v))),s.imageInfoArray=I.imageInfoArray,I}).catch(function(I){s.imageInfoArray=void 0,l._uploadSSOLog({HttpStatusCode:1e4,CostTime:ar(v,!1),url:n})})}},{key:"_uploadSSOLog",value:function(n){var s,l;this.isSimpleCos&&((s=new it).setEventType(18),n.error&&s.setError(new so(n.error)),l="HttpStatusCode:".concat(n.HttpStatusCode,"|CosRequestId:").concat(n.CosRequestId||"","|")+"FileAlreadyExist:".concat(n.FileAlreadyExist||0,"|FileSize:").concat(n.FileSize||0,"|CostTime:").concat(n.CostTime),n.uploadIP&&(l+="|FinalIP:".concat(n.uploadIP)),s.setMessage("OK").setMoreMessage(n.url).setExtension(l).end())}},{key:"_getRawOrUploadProxyUrl",value:function(n){var s=this.get(12).getFileUploadProxy(),l=n;return l=s?n.replace(/^https:\/\/[^/]+/,s):l}},{key:"_getFile",value:function(n){return Rt(n.file.files)||Lr(n.file.files)?n.file.files[0]:n.file}},{key:"_formatFileSize",value:function(n){return n<1024?n+"B":n<1048576?Math.floor(n/1024)+"KB":Math.floor(n/1048576)+"MB"}},{key:"_formatSpeed",value:function(n){return n<=1048576?Li(n/1024,1)+"KB/s":Li(n/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(n){var s=this._getFile(n),l=s.name,l=l.slice(l.lastIndexOf(".")),l=this._genFileName("".concat(dn(999999)).concat(l));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(l),Body:s}],SliceSize:1048576,onProgress:function(h){if(typeof n.onProgress=="function")try{n.onProgress(h.percent)}catch(v){q.w("onProgress callback error:",v)}},onFileFinish:function(h,v,I){}}}},{key:"_createCosOptionsWXMiniApp",value:function(n){var l=this._getFile(n),s=this._genFileName(l.name),l=l.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(s),FilePath:l,onProgress:function(h){if(q.l(JSON.stringify(h)),typeof n.onProgress=="function")try{n.onProgress(h.percent)}catch(v){q.w("onProgress callback error:",v)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(n){var s,l=this,h="",v="",k=0,I=this._getFile(n),k=Ie?(h=n.message.type===O.MSG_FILE?(s=(s=I.name).slice(s.lastIndexOf(".")),this._genFileName("".concat(dn(999999)).concat(s))):this._genFileName(I.name),v=I.url,1):(s=(s=I.name).slice(s.lastIndexOf(".")),h=this._genFileName("".concat(dn(999999)).concat(s)),v=I,0);return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:h,uploadMethod:k,duration:this.duration,userID:n.message.from,conversationType:Pr(n.message.conversationID)?1:2}).then(function(Ue){var ve=l.isSimpleCos?Ue.preSig[0]:Ue,G=ve.uploadUrl,Y=ve.downloadUrl,te=ve.requestSnapshotUrl,te=te===void 0?void 0:te,pe=ve.thumbUrl,ye=ve.largeUrl,ve=ve.fileKey,Ue=Ue.uploadIP,Ue=Ue===void 0?"":Ue;return{url:l._getRawOrUploadProxyUrl(G),fileType:l.uploadFileType,fileName:h,resources:v,downloadUrl:Y,requestSnapshotUrl:te,thumbUrl:pe,largeUrl:ye,fileKey:ve,uploadIP:!l.isPrivateNetWork()&&Ue,onProgress:function(ut){if(typeof n.onProgress=="function")try{n.onProgress(ut.percent)}catch(mt){q.w("onProgress callback error:",mt),q.e(mt)}}}})}},{key:"_genFileName",value:function(n){return"".concat(Pd(),"-").concat(n)}},{key:"_setUploadFileType",value:function(n){this.uploadFileType=n}},{key:"_getSnapshotInfoByUrl",value:function(n,s){var l=this,h="_getSnapshotInfoByUrl",v=new it(h);return this.req({proto:fe.VIDEO_COVER,data:{platform:this.getPlatform(),coverName:this._genFileName(dn(99999)),requestSnapshotUrl:n}}).then(function(G){var k=(G.data||{}).snapshotUrl;if(q.l("".concat(l._n,".").concat(h," ok. snapshotUrl:").concat(k)),v.setMessage("snapshotUrl:".concat(k)).end(),Ct(k))return{};var P,G=k;return l.isPrivateNetWork()&&(P=l.getFileDownloadProxy(),G=oi(k,P)),Ld(G).then(function(Y){s.snapshotInfo={snapshotUrl:k,snapshotWidth:Y.width,snapshotHeight:Y.height}})}).catch(function(I){return q.w("".concat(l._n,".").concat(h," failed. error:"),I),v.setCode(I.errorCode).setMessage(I.errorInfo).end(),{}})}},{key:"_getSmallImageInfoByUrl",value:function(n,s){var l,h=n;return this.isPrivateNetWork()&&(l=this.getFileDownloadProxy(),h=oi(n,l)),Ld(h).then(function(v){s.smallImageUrl=n,s.smallImageWidth=v.width,s.smallImageHeight=v.height})}},{key:"_getLargeImageInfoByUrl",value:function(n,s){var l,h=n;return this.isPrivateNetWork()&&(l=this.getFileDownloadProxy(),h=oi(n,l)),Ld(h).then(function(v){s.largeImageUrl=n,s.largeImageWidth=v.width,s.largeImageHeight=v.height})}},{key:"_isEmptyFileList",value:function(n){return!(!Lr(n)||n.length!==0)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),hh),J1=["downloadKey","pbDownloadKey","messageList"],X1=(p(qv,[{key:"uploadMergerMessage",value:function(h,s){var l="".concat(this._n,".").concat("uploadMergerMessage"),h=(q.d("".concat(l," message:"),h,"messageBytes:".concat(s)),h.payload.messageList),v=h.length,I=new it("uploadMergerMessage");return this._msgM.req({proto:fe.UPLOAD_MERGER_MSG,data:{messageList:h}}).then(function(P){q.d("".concat(l," ok. response:"),P.data);var P=P.data,G=P.pbDownloadKey,P=P.downloadKey,G={pbDownloadKey:G,downloadKey:P,messageNumber:v};return I.setMessage("".concat(v,"-").concat(s,"-").concat(P)).end(),G}).catch(function(k){throw q.w("".concat(l," failed. error:"),k),I.setError(k).end(),k})}},{key:"downloadMergerMessage",value:function(n){var s="".concat(this._n,".").concat("downloadMergerMessage"),l=(q.d("".concat(s," message:"),n),n.payload.downloadKey),h=this._msgM.getFileDownloadProxy(),v=new it("downloadMergerMessage");return v.setMessage("downloadKey:".concat(l)),this._msgM.req({proto:fe.DOWNLOAD_MERGER_MSG,data:{downloadKey:l}}).then(function(I){var k,P;return q.d("".concat(s," ok. response:"),I.data),ko(n.clearElement)?((k=n.payload).downloadKey,k.pbDownloadKey,k.messageList,k=E(k,J1),n.clearElement(),n.setElement({type:n.type,content:i({messageList:I.data.messageList},k)},h)):(P=[],I.data.messageList.forEach(function(G){Ct(G)||(G=new Wr(G,h),P.push(G))}),n.payload.messageList=P,n.payload.downloadKey="",n.payload.pbDownloadKey=""),v.end(),n}).catch(function(I){throw q.w("".concat(s," failed. key:").concat(l," error:"),I),v.setError(I).end(),I})}},{key:"createMergerMessagePack",value:function(n,s,l){return n.conversationType===O.CONV_C2C?this._createC2CMergerMessagePack(n,s,l):this._createGroupMergerMessagePack(n,s,l)}},{key:"_createC2CMergerMessagePack",value:function(n,s,G){var h=null,v=(s&&(s.offlinePushInfo&&(h=s.offlinePushInfo),s.onlineUserOnly===!0&&(h?h.disablePush=!0:h={disablePush:!0})),[]),I=(xn(s)&&xn(s.messageControlInfo)&&(I=(P=s.messageControlInfo).excludedFromUnreadCount,k=P.excludedFromLastMessage,P=P.excludedFromContentModeration,I===!0&&v.push("NoUnread"),k===!0&&v.push("NoLastMsg"),P===!0&&v.push("NoMsgCheck")),""),k=(Sn(n.cloudCustomData)&&0<n.cloudCustomData.length&&(I=n.cloudCustomData),G.pbDownloadKey),P=G.downloadKey,G=G.messageNumber,pe=n.payload,Y=pe.title,te=pe.abstractList,pe=pe.compatibleText,ye=this._msgM.get(6),ye=ye&&ye.isOnlineMessage(n,s)?0:void 0;return{proto:fe.SEND_C2C_MSG,tjgID:this._msgM.generateTjgID(n),data:{fromAccount:this._msgM.getMyUserID(),toAccount:n.to,msgBody:[{msgType:n.type,msgContent:{pbDownloadKey:k,downloadKey:P,title:Y,abstractList:te,compatibleText:pe,messageNumber:G}}],cloudCustomData:I,clientTime:n.clientTime,msgSeq:n.sequence,msgRandom:n.random,msgLifeTime:ye,offlinePushInfo:mp(h),messageControlInfo:ye!==0?v:void 0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(n,ve,G){var h=null,v=(ve&&ve.offlinePushInfo&&(h=ve.offlinePushInfo),[]),I=(xn(ve)&&xn(ve.messageControlInfo)&&(I=(P=ve.messageControlInfo).excludedFromUnreadCount,k=P.excludedFromLastMessage,P=P.excludedFromContentModeration,I===!0&&v.push("NoUnread"),k===!0&&v.push("NoLastMsg"),P===!0&&v.push("NoMsgCheck")),""),k=(Sn(n.cloudCustomData)&&0<n.cloudCustomData.length&&(I=n.cloudCustomData),G.pbDownloadKey),P=G.downloadKey,G=G.messageNumber,pe=n.payload,Y=pe.title,te=pe.abstractList,pe=pe.compatibleText,ye=this._msgM.get(7),ve=ye&&ye.isOnlineMessage(n,ve)?1:0;return{proto:fe.SEND_GRP_MSG,tjgID:this._msgM.generateTjgID(n),data:{fromAccount:this._msgM.getMyUserID(),groupID:n.to,msgBody:[{msgType:n.type,msgContent:{pbDownloadKey:k,downloadKey:P,title:Y,abstractList:te,compatibleText:pe,messageNumber:G}}],random:n.random,priority:n.priority,clientSequence:n.clientSequence,groupAtInfo:void 0,cloudCustomData:I,onlineOnlyFlag:ve,offlinePushInfo:mp(h),clientTime:n.clientTime,needReadReceipt:n.needReadReceipt!==!0||ye.isMessageFromOrToAVChatroom(n.to)?0:1,messageControlInfo:ve==0?v:void 0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0}}}}]),qv),Q1={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},Z1=[Be.MSG_ONPROGRESS_FUNCTION_ERROR,Be.MSG_I_SELECT_F_FIRST,Be.MSG_I_TYPES_LIMIT,Be.MSG_F_IS_EMPTY,Be.MSG_I_SIZE_LIMIT,Be.MSG_F_SELECT_F_FIRST,Be.MSG_F_SIZE_LIMIT,Be.MSG_V_SIZE_LIMIT,Be.MSG_V_TYPES_LIMIT,Be.MSG_A_UPLOAD_FAIL,Be.MSG_A_SIZE_LIMIT,Be.COS_UNDETECTED];function qv(n){u(this,qv),this._n="MergerMessageHandler",this._msgM=n}function hh(n){u(this,hh),(n=nb.call(this,n))._n="UploadModule",n.TIMUploadPlugin=null,n.timUploadPlugin=null,n.COSSDK=null,n._cosUploadMethod=null,n.expiredTimeLimit=600,n.appid=0,n.bucketName="",n.ciUrl="",n.directory="",n.downloadUrl="",n.uploadUrl="",n.region="ap-shanghai",n.cos=null,n.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},n.uploadFileType="",n.duration=900,n.tryCount=0,n.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},n.isSimpleCos=!1;var s=n.getInnerEmitterInstance();return s.on(So.A2KEY_AND_TINYID_UPDATED,n._init,N(n)),s.on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function Os(){}function eM(n,s,l){this.fn=n,this.context=s,this.once=l||!1}function rb(n,s,l,h,v){if(typeof l!="function")throw new TypeError("The listener must be a function");return l=new eM(l,h||n,v),h=jr?jr+s:s,n._events[h]?n._events[h].fn?n._events[h]=[n._events[h],l]:n._events[h].push(l):(n._events[h]=l,n._eventsCount++),n}function Sp(n,s){--n._eventsCount==0?n._events=new Os:delete n._events[s]}function ri(){this._events=new Os,this._eventsCount=0}function Kv(n){var s=!1;return Object.values(Q1).includes(n)&&(s=!0),s=120001<=n&&n<=13e4||10100<=n&&n<=10200?!0:s}var zv,ib,sb,Tp,ab,lb,tM=["conversationID","timePosition","timePeriod"],cb=(_(Qc,Uo),lb=D(Qc),p(Qc,[{key:"createTextMessage",value:function(l){var h=this.getMyUserID(),s=(l.currentUser=h,l.senderTinyID=this.getMyTinyID(),new er(l)),l=Sn(l.payload)?l.payload:l.payload.text,l=new fp({text:l}),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),s}},{key:"createImageMessage",value:function(n){var s=this.getMyUserID(),l=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),new er(n));if(Ie){var v=n.payload.file;if(Cn(v))return void this.outputWarning("FileUnsupportedInMP","createImageMessage");var h=v.tempFiles[0].path||v.tempFiles[0].tempFilePath,v={url:h,name:h.slice(h.lastIndexOf("/")+1),size:v.tempFiles&&v.tempFiles[0].size||1,type:h.slice(h.lastIndexOf(".")+1).toLowerCase()};n.payload.file=v}else Ae&&(Cn(n.payload.file)?(h=n.payload.file,n.payload.file={files:[h]}):xn(n.payload.file)&&typeof uni<"u"&&(v=n.payload.file.tempFiles[0],n.payload.file={files:[v]}));return h=new iv({imageFormat:xo.UNKNOWN,uuid:this._generateUUID(n.payload.file),file:n.payload.file}),v=this._getNickAndAvatarByUserID(s),l.setElement(h),l.setNickAndAvatar(v),l.setNameCard(this._getNameCardByGroupID(l)),this._messageOptionsMap.set(l.clientSequence,n),l}},{key:"createAudioMessage",value:function(n){var l=n.payload.file,h=(Ie&&(h={url:l.tempFilePath,name:l.tempFilePath.slice(l.tempFilePath.lastIndexOf("/")+1),size:l.fileSize,second:parseInt(l.duration)/1e3,type:l.tempFilePath.slice(l.tempFilePath.lastIndexOf(".")+1).toLowerCase()},n.payload.file=h),this.getMyUserID()),s=(n.currentUser=h,n.senderTinyID=this.getMyTinyID(),new er(n)),l=new Wd({second:Math.floor(l.duration/1e3),size:l.fileSize||l.size,url:l.tempFilePath,uuid:this._generateUUID(n.payload.file)}),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,n),s}},{key:"createVideoMessage",value:function(n){var s=this.getMyUserID(),l=(n.currentUser=s,n.senderTinyID=this.getMyTinyID(),n.payload.file.thumbUrl="",n.payload.file.thumbSize=0,{});if(Ie){if(Ve)return void this.outputWarning("VideoUnsupportedInAlipay");if(Cn(n.payload.file))return void this.outputWarning("FileUnsupportedInMP","createVideoMessage");var h=n.payload.file;Rt(h.tempFiles)&&(h=h.tempFiles[0]),l.url=h.tempFilePath,l.name=h.tempFilePath.slice(h.tempFilePath.lastIndexOf("/")+1),l.size=h.size||1,l.second=h.duration||0,l.type=h.tempFilePath.slice(h.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else Ae&&(Cn(n.payload.file)?(h=n.payload.file,n.payload.file.files=[h]):xn(n.payload.file)&&typeof uni<"u"&&(h=n.payload.file.tempFile,n.payload.file.files=[h]),h=n.payload.file,l.url=window.URL.createObjectURL(h.files[0]),l.name=h.files[0].name,l.size=h.files[0].size||1,l.second=h.files[0].duration||0,l.type=h.files[0].type.split("/")[1]);return n.payload.file.videoFile=l,h=new er(n),l=new Wi({videoFormat:l.type,videoSecond:Li(l.second,0),videoSize:l.size,remoteVideoUrl:"",videoUrl:l.url,videoUUID:this._generateUUID(n.payload.file.videoFile),thumbUUID:this._generateUUID(n.payload.file.videoFile),thumbWidth:n.payload.file.width||200,thumbHeight:n.payload.file.height||200,thumbUrl:n.payload.file.thumbUrl,thumbSize:n.payload.file.thumbSize,thumbFormat:n.payload.file.thumbUrl.slice(n.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),s=this._getNickAndAvatarByUserID(s),h.setElement(l),h.setNickAndAvatar(s),h.setNameCard(this._getNameCardByGroupID(h)),this._messageOptionsMap.set(h.clientSequence,n),h}},{key:"createCustomMessage",value:function(l){var h=this.getMyUserID(),s=(l.currentUser=h,l.senderTinyID=this.getMyTinyID(),new er(l)),l=new cv({data:l.payload.data,description:l.payload.description,extension:l.payload.extension}),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),s}},{key:"createFaceMessage",value:function(l){var h=this.getMyUserID(),s=(l.currentUser=h,l.senderTinyID=this.getMyTinyID(),new er(l)),l=new sv(l.payload),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),s}},{key:"createMergerMessage",value:function(h){var s=this.getMyUserID(),s=(h.currentUser=s,h.senderTinyID=this.getMyTinyID(),this._getNickAndAvatarByUserID(s)),l=new er(h),h=new Ka(h.payload);return l.setElement(h),l.setNickAndAvatar(s),l.setNameCard(this._getNameCardByGroupID(l)),l.setRelayFlag(!0),l}},{key:"createForwardMessage",value:function(n){var s=n.to,l=n.conversationType,h=n.priority,v=n.payload,I=n.needReadReceipt,k=n.receiverList;if(!Rt(v._elements))return Re({code:Be.MSG_FORWARD_INVALID_ELEMENTS});var P=this.getMyUserID(),G=this._getNickAndAvatarByUserID(P);return v.type===O.MSG_GRP_TIP?Re({code:Be.MSG_FORWARD_TYPE_INVALID}):(l={to:s,conversationType:l,conversationID:"".concat(l).concat(s),priority:h,isPlaceMessage:0,status:Bc,currentUser:P,senderTinyID:this.getMyTinyID(),cloudCustomData:n.cloudCustomData||v.cloudCustomData||"",needReadReceipt:I,receiverList:k,isSupportExtension:n.isSupportExtension||!1},s=new er(l),s.setElement(v._elements[0]),s.setNickAndAvatar(G),s.setNameCard(this._getNameCardByGroupID(v)),s.setRelayFlag(!0),s)}},{key:"downloadMergerMessage",value:function(n){return this._mergerMessageHandler.downloadMergerMessage(n)}},{key:"createFileMessage",value:function(n){if(Ie){if(!Ye&&!Ee&&!qe)return;var l=xe.getSystemInfoSync().SDKVersion;if(Ye&&RI(l,"2.5.0")<0)return void this.outputWarning("WXChooseMessageFile");if(Ee&&RI(l,"1.18.0")<0)return void this.outputWarning("QQChooseMessageFile")}Ae||qe?Cn(n.payload.file)?(l=n.payload.file,n.payload.file={files:[l]}):xn(n.payload.file)&&typeof uni<"u"&&(s=(l=n.payload.file).tempFiles,l=l.files,h=null,Rt(s)?h=s[0]:Rt(l)&&(h=l[0]),n.payload.file={files:[h]}):(Ye||Ee)&&(l=i(i({},(s=n.payload.file.tempFiles)[0]),{},{url:s[0].path}),n.payload.file={files:[l]});var h=this.getMyUserID(),s=(n.currentUser=h,n.senderTinyID=this.getMyTinyID(),new er(n)),l=new Yd({uuid:this._generateUUID(n.payload.file),file:n.payload.file}),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,n),s}},{key:"createLocationMessage",value:function(l){var h=this.getMyUserID(),s=(l.currentUser=h,l.senderTinyID=this.getMyTinyID(),new er(l)),l=new qa(l.payload),h=this._getNickAndAvatarByUserID(h);return s.setElement(l),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),s}},{key:"_onCannotFindModule",value:function(){return Re({code:Be.CANNOT_FIND_MODULE})}},{key:"sendMessageInstance",value:function(n,s){var l=this;if(this.get(29).filterMessage(n,s)===!1)return n.hasRiskContent=!0,this._onSendMessageFailed(n,new so({code:Be.PROFANITY_FOUND}));var h=null;if(n.conversationType===O.CONV_C2C)h=this.get(6);else{if(n.conversationType!==O.CONV_GROUP)return Re({code:Be.MSG_INVALID_CONV_TYPE});h=this.get(7)}if(!h)return Re({code:Be.CANNOT_FIND_MODULE});var v,I="".concat(this._n,".sendMessageInstance"),k=this.get(11),P=h.isOnlineMessage(n,s);return this.get(17).upload(n).then(function(){return l._getSendMessageSpecifiedKey(n)===Ha&&l.get(26).addSuccessCount(kr),l._guardForGroup(n).then(function(){if(!n.isSendable())return Re({code:Be.MSG_F_URL_IS_EMPTY});l._addSendMessageTotalCount(n),v=Date.now();var G=function(Y){var te="utf-8";Ae&&document&&(te=document.charset.toLowerCase());var pe,ye=0,ve=Y.length;if(te==="utf-8"||te==="utf8")for(var Ue=0;Ue<ve;Ue++)(pe=Y.codePointAt(Ue))<=127?ye+=1:pe<=2047?ye+=2:pe<=65535?ye+=3:(ye+=4,Ue++);else if(te==="utf-16"||te==="utf16")for(var ut=0;ut<ve;ut++)(pe=Y.codePointAt(ut))<=65535?ye+=2:(ye+=4,ut++);else ye=Y.replace(/[^\x00-\xff]/g,"aa").length;return ye}(JSON.stringify(n));return n.type===O.MSG_MERGER&&11264<G?l._mergerMessageHandler.uploadMergerMessage(n,G).then(function(Y){return Y=l._mergerMessageHandler.createMergerMessagePack(n,s,Y),l.req(Y)}):(k.setMessageRandom(n),h.sendMessage(n,s))}).then(function(ye){var Y,ye=ye.data,te=ye.time,pe=ye.sequence,ve=ye.readReceiptCode,ye=ye.messageDropReason,ve=(un(ve)&&ve!==0&&(new it("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(pe," readReceiptCode:").concat(ve)).end(),q.w("".concat(I," readReceiptCode:").concat(ve," message:").concat(l.getErrorMessage(ve)))),ye&&(ve=new it("messageDropReason"),ye="from:".concat(n.from," to:").concat(n.to," sequence:").concat(pe," messageDropReason:").concat(ye),ve.setMessage(ye).end(),q.w("".concat(I," ").concat(ye))),l._addSendMessageSuccessCount(n,v),l._messageOptionsMap.delete(n.clientSequence),n.isResend===!0&&(Y=k.findMessage(n.ID))&&(q.l("".concat(I," resend ok. ID:").concat(Y.ID)),k.deleteLocalMessage(Y)),n.status=Ui,n.time=te,!1);return n.conversationType===O.CONV_GROUP?n.sequence=pe:n.conversationType!==O.CONV_C2C||(ye=k.getLatestMessageSentByMe(n.conversationID))&&(Y=ye.nick,te=ye.avatar,Y===n.nick&&te===n.avatar||(ve=!0)),ve&&k.modifyMessageSentByMe({conversationID:n.conversationID,latestNick:n.nick,latestAvatar:n.avatar}),P===!0?n._onlineOnlyFlag=!0:(k.appendToMessageList(n),pe=n,xn(s)&&xn(s.messageControlInfo)&&(s.messageControlInfo.excludedFromLastMessage===!0&&(n._isExcludedFromLastMessage=!0,pe=""),s.messageControlInfo.excludedFromUnreadCount===!0&&(n._isExcludedFromUnreadCount=!0)),ye=n.conversationType,Qo(n.to)&&(ye=O.CONV_TOPIC,l.get(10).onMessageSent({groupID:Zo(n.to),topicID:n.to,lastMessage:pe})),k.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:ye,subType:n.conversationSubType,lastMessage:pe}]})),n._relayFlag||n.type!=="TIMImageElem"||wI(n.payload.imageInfoArray),Ut({message:n})})}).catch(function(G){return l._onSendMessageFailed(n,G,P)})}},{key:"_guardForGroup",value:function(n){if(n.conversationType!==O.CONV_GROUP)return Promise.resolve();var s=this.get(7);if(!s)return this._onCannotFindModule();if(Dr({groupID:n.to})){var l=s.getLocalGroupProfile(n.to);if(l&&l.isSupportTopic)return Re({code:Be.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return s.guardForAVChatRoom(n)}},{key:"_onSendMessageFailed",value:function(n,s){var v=2<arguments.length&&arguments[2]!==void 0&&arguments[2],l="".concat(this._n,"._onSendMessageFailed"),h=(n.status=ov,s.code!==80001&&s.code!==80004||(n.hasRiskContent=!0),this.get(11)),I=(h.deleteMessageRandom(n),10100<=s.code&&s.code<=10200||120001<=s.code&&s.code<=13e4),v=(v||I||h.appendToMessageList(n)===!0&&q.l("".concat(l," message stored, ID:").concat(n.ID)),this._addSendMessageFailCountOnUser(n,s),new it("sendMessage")),I="tjg_id:".concat(this.generateTjgID(n)," type:").concat(n.type," from:").concat(n.from," to:").concat(n.to);return Ae&&("connection"in navigator&&(h=navigator.connection,I+=" downlink:".concat(h.downlink," effectiveType:").concat(h.effectiveType," rtt:").concat(h.rtt)),"memory"in window.performance&&(h=window.performance.memory,I+=" usedJSHeapSize:".concat(h.usedJSHeapSize," totalJSHeapSize:").concat(h.totalJSHeapSize," jsHeapSizeLimit:").concat(h.jsHeapSizeLimit))),v.setMessage(I).setError(s).end(),q.e("".concat(l," error:"),s),Re(new so({code:s&&s.code?s.code:Be.MSG_SEND_FAIL,message:s&&s.message?s.message:void 0,data:{message:n}}))}},{key:"_getSendMessageSpecifiedKey",value:function(n){if([O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_VIDEO,O.MSG_FILE].includes(n.type))return Ha;if(n.conversationType===O.CONV_C2C)return ua;if(n.conversationType===O.CONV_GROUP){var s=this.get(7);if(s&&(s=s.getLocalGroupProfile(n.to),s))return n=s.type,Mr(n)?da:Ds}}},{key:"_addSendMessageTotalCount",value:function(n){n=this._getSendMessageSpecifiedKey(n),n&&this.get(26).addTotalCount(n)}},{key:"_addSendMessageSuccessCount",value:function(h,s){var l,h=this._getSendMessageSpecifiedKey(h);h&&((l=this.get(26)).addSuccessCount(h),l.addCost(h,ar(s,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(I,h){var l,h=h.code,h=h===void 0?-1:h,v=this.get(26),I=this._getSendMessageSpecifiedKey(I);I===Ha&&(l=!1,l=Z1.includes(h)?!0:l)?v.addFailedCountOfUserSide(kr):Kv(h)&&I&&v.addFailedCountOfUserSide(I)}},{key:"resendMessage",value:function(n,s){return n.isResend=!0,n.status=Bc,this.sendMessageInstance(n,s)}},{key:"revokeMessage",value:function(n){var s=this,l=null;if(n.conversationType===O.CONV_C2C?l=this.get(6):n.conversationType===O.CONV_GROUP&&(l=this.get(7)),!l)return this._onCannotFindModule();var h=new it("revokeMessage"),v=(h.setMessage("tjg_id:".concat(this.generateTjgID(n)," type:").concat(n.type," from:").concat(n.from," to:").concat(n.to)),"".concat(this._n,".").concat("revokeMessage"));return l.revokeMessage(n).then(function(k){var k=k.data.recallRetList;return Ct(k)||k[0].retCode===0?(q.i("".concat(v," ok. ID:").concat(n.ID)),n.isRevoked=!0,h.end(),s.get(11).onMessageRevoked([n]),Ut({message:n})):(k=new so({code:k[0].retCode,data:{message:n}}),h.setCode(k.code).setMoreMessage(k.message).end(),Re(k))}).catch(function(I){h.setError(I).end();var k=new so({code:I&&I.code?I.code:Be.MSG_REVOKE_FAIL,message:I&&I.message?I.message:void 0,data:{message:n}});return q.w("".concat(v," failed. error:"),I),Re(k)})}},{key:"deleteMessage",value:function(n){var s=this,l=null,h=n[0],v=h.conversationID,I="",k=[],P=[];if(h.conversationType===O.CONV_C2C)l=this.get(6),I=v.replace(O.CONV_C2C,""),n.forEach(function(te){te&&te.status===Ui&&te.conversationID===v&&(te._onlineOnlyFlag||k.push("".concat(te.sequence,"_").concat(te.random,"_").concat(te.time)),P.push(te))});else if(h.conversationType===O.CONV_GROUP)l=this.get(7),I=v.replace(O.CONV_GROUP,""),n.forEach(function(te){te&&te.status===Ui&&te.conversationID===v&&(te._onlineOnlyFlag||k.push("".concat(te.sequence)),P.push(te))});else if(h.conversationType===O.CONV_SYSTEM)return Re({code:Be.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!l)return this._onCannotFindModule();if(k.length===0)return this._onMessageDeleted(P);30<k.length&&(k=k.slice(0,30),P=P.slice(0,30));var G=new it("deleteMessage"),Y=(G.setMessage("to:".concat(I," count:").concat(k.length)),"".concat(this._n,".").concat("deleteMessage"));return l.deleteMessage({to:I,keyList:k}).then(function(te){return G.end(),q.i("".concat(Y," ok")),s._onMessageDeleted(P)}).catch(function(te){return G.setError(te).end(),q.w("".concat(Y," failed. error:"),te),te=new so({code:te&&te.code?te.code:Be.MSG_DELETE_FAIL,message:te&&te.message?te.message:void 0}),Re(te)})}},{key:"_onMessageDeleted",value:function(n){return this.get(11).onMessageDeleted(n),ln({messageList:n})}},{key:"translateText",value:function(v){var s="".concat(this._n,".").concat("translateText"),l=v.sourceTextList,h=v.sourceLanguage,v=v.targetLanguage,I=new it("translateText");return I.setMessage("sourceLanguage:".concat(h," targetLanguage:").concat(v)),this.req({proto:fe.TRANSLATE_TEXT,data:{sourceTextList:l,source:h||"auto",target:v,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then(function(Y){var Y=Y.data,P=Y.error,G=Y.requestID,Y=Y.translatedTextList;if(P.code===0)return I.end(),q.i("".concat(s," ok. requestID:").concat(G)),Ut({translatedTextList:Y});throw i(i({},P),{},{requestID:G})}).catch(function(k){return I.setCode(k.code).setMoreMessage(k.requestID).end(),q.w("".concat(s," failed. error:"),k),Re({code:Be.TRANSLATE_TEXT_FAIL})})}},{key:"convertVoiceToText",value:function(v){var l=v.message,v=v.language,s=l.payload.url,l=(l.from===this.getMyUserID()&&l.flow==="out"&&(s=l.payload.remoteAudioUrl),/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/);if(!l.test(s))return Re({code:Be.UNSUPPORTED_VOICE_FORMAT});var l=l.exec(s)[1]||"mp3",h="16k_zh-PY",v=(v?v==="zh (cmn-Hans-CN)"?h="16k_zh":v==="en-US"?h="16k_en":v==="yue-Hant-HK"?h="16k_yue":v==="ja-JP"&&(h="16k_ja"):h="16k_zh-PY","serviceType:".concat(h," url:").concat(s)),I="".concat(this._n,".").concat("convertVoiceToText"),k=(q.i("".concat(I," ").concat(v)),new it("convertVoiceToText"));return k.setMessage(v),this.req({proto:fe.VOICE_TO_TEXT,data:{url:s,language:h,SDKAppID:this.getSDKAppID(),format:l}}).then(function(te){var te=te.data,G=te.error,Y=te.requestID,te=te.result;if(G.code===0)return k.end(),q.i("".concat(I," ok. requestID:").concat(Y)),Ut({result:te});throw i(i({},G),{},{requestID:Y})}).catch(function(P){return k.setCode(P.code).setMoreMessage(P.requestID||"").end(),q.w("".concat(I," failed. error:"),P),Re({code:Be.VOICE_TO_TEXT_FAIL})})}},{key:"modifyRemoteMessage",value:function(n){var s=this,l=null,h=n.conversationType,v=n.to,I=this.get(7);if(!I)return this._onCannotFindModule();if(I.isMessageFromOrToAVChatroom(v))return Re({code:Be.MSG_MODIFY_DISABLED_IN_AVCHATROOM,data:{message:n}});if(this.get(29).filterMessage(n)===!1)return n.hasRiskContent=!0,Re({code:Be.PROFANITY_FOUND,data:{message:n}});h===O.CONV_C2C?l=this.get(6):h===O.CONV_GROUP&&(l=this.get(7));var k=new it("modifyMessage"),P=(k.setMessage("to:".concat(v)),"".concat(this._n,".modifyRemoteMessage"));return l.modifyRemoteMessage(n).then(function(G){return k.end(),q.i("".concat(P," ok")),G=s._onModifyRemoteMessageResp(n,G.data),Ut({message:G})}).catch(function(G){var Y;return k.setCode(G.code).setMoreMessage(G.message).end(),q.w("".concat(P," failed. error:"),G),G.code===20027?(Y=s._onModifyRemoteMessageResp(n,G.data),Re({code:Be.MSG_MODIFY_CONFLICT,data:{message:Y}})):Re({code:G.code,message:G.message,data:{message:n}})})}},{key:"_generateSearchdata",value:function(v){var s=v.conversationID,l=v.timePosition,h=v.timePeriod,v=E(v,tM);return Qe(s)||(Pr(s)&&(v.account=s.replace(O.CONV_C2C,"")),fr(s)&&(v.groupID=s.replace(O.CONV_GROUP,""))),un(h)&&0<h&&(un(l)&&0<l?v.startTime=l-h:v.startTime=xt()-h),v.startTime&&v.startTime<0&&(v.startTime=void 0),un(l)&&0<l&&(v.endTime=l),v}},{key:"searchCloudMessages",value:function(n){var s=this,l="searchCloudMessages",h="".concat(this._n,".").concat(l);if(!n)return Re({code:Be.OPTIONS_IS_EMPTY,message:this.getErrorMessage(Be.OPTIONS_IS_EMPTY,l)});var v=n.keywordList,I=n.keywordListMatchType,k=n.conversationID,P=n.cursor,G=Rt(n.senderUserIDList)&&0<n.senderUserIDList.length,Y=Rt(n.messageTypeList)&&0<n.messageTypeList.length;if(!v&&!G&&!Y)throw q.e("[".concat(l,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var te=Date.now(),pe=new it(l),ye="keywordList:".concat(v," keywordListMatchType:").concat(I," ")+"conversationID:".concat(k," cursor:").concat(P);return q.l("".concat(h," ").concat(ye)),this.req({proto:fe.MSG_CLOUD_SEARCH,data:this._generateSearchdata(n)}).then(function(ut){var mt=ut.data,Ue=mt.code,mt=mt.message;if(Ue!==0)return mt=s.getErrorMessage(Ue===60020?"SearchCloudMessagesUnavailable":Ue)||mt,Ue=new so({code:Ue,message:mt}),pe.setMessage(ye).setError(Ue).end(),Re(Ue);s.get(27).isSearchCloudMessagesEnabled();var mt=ut.data,Ue=mt.cursor,ut=mt.totalCount,mt=mt.searchResult,Kt="totalCount:".concat(ut," cost:").concat(ar(te)),Kt=(q.l("".concat(h," ok. cursor:").concat(Ue," ").concat(Kt)),pe.setMessage("".concat(ye," ").concat(Kt)).end(),s._handleSearchResults(mt,!n.conversationID));return Ut({searchResultList:Kt,cursor:Ue,totalCount:ut})}).catch(function(ve){return pe.setMessage(ye).setError(ve).end(),Re(ve)})}},{key:"_handleSearchResults",value:function(n,s){var l=this.get(11);return Rt(n)&&n.length!==0?n.map(function(k){var v=k.groupID,P=k.userID,I=k.messageCount,k=k.messageList,P=v?"".concat(O.CONV_GROUP).concat(v):"".concat(O.CONV_C2C).concat(P),G={conversationID:P,messageCount:I,messageList:[]};return s&&1<I||k&&0<k.length&&(I=l.onRoamingMessage(k,P,!1),v&&I.reverse(),G.messageList=I),G}):[]}},{key:"_onModifyRemoteMessageResp",value:function(P,te){q.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),te);var l=P.conversationType,h=P.from,v=P.to,I=P.random,k=P.sequence,P=P.time,G=te.elements,Y=te.messageVersion,te=te.cloudCustomData,te=te===void 0?"":te;return this.get(11).onMessageModified({conversationType:l,from:h,to:v,time:P,random:I,sequence:k,elements:G,cloudCustomData:te,messageVersion:Y})}},{key:"_generateUUID",value:function(l){var s=this.get(12),s="".concat(s.getSDKAppID(),"-").concat(s.getUserID(),"-").concat(ro()),l=l.name||l.value||l.url||l.tempFilePath,l=l&&l.slice(l.lastIndexOf(".")+1);return s=l?"".concat(s,".").concat(l):s}},{key:"getMessageOption",value:function(n){return this._messageOptionsMap.get(n)}},{key:"_getNickAndAvatarByUserID",value:function(n){return this.get(4).getNickAndAvatarByUserID(n)}},{key:"_getNameCardByGroupID",value:function(n){if(n.conversationType===O.CONV_GROUP){var s=this.get(7);if(s)return s.getMyNameCardByGroupID(n.to)}return""}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),Qc),Ep=(_(Xc,Uo),ab=D(Xc),p(Xc,[{key:"onMessageExtensionNotify",value:function(I){var s=this,I=I.dataList,P=I.messageInfo,l=I.operateType,h=I.operateResultList,v=I.tinyID,I=I.globalSequence,k=P.clientTime,P=P.random,G="".concat(v,"-").concat(k,"-").concat(P),Y=[],te=[],pe=(q.l("".concat(this._n,".onMessageExtensionNotify messageID:").concat(G," operateType:").concat(l," globalSequence:").concat(I)),this._updateGlobalSequence(G,I),!1),ye=!1;h.forEach(function(ve){var Ue=ve.extensions,Ue=Ue===void 0?[]:Ue,ut=ve.clearSequence;l===1?(pe=!0,Ue.forEach(function(mt){Y.push({key:mt.key,value:mt.value})}),s._updateLocalExtension(G,Ue)):l===2?(ye=!0,Ue.forEach(function(mt){te.push(mt.key)}),s._updateLocalExtension(G,Ue)):l===3&&(ye=!0,s._hasLocalExtension(G)&&s._getLocalExtension(G).forEach(function(mt,Kt){mt.seq<=ut&&!Ct(mt.value)&&te.push(Kt)}),s._clearLocalExtension(G,ut))}),pe&&this.emitOuterEvent($.MESSAGE_EXTENSIONS_UPDATED,{messageID:G,extensions:Y}),ye&&this.emitOuterEvent($.MESSAGE_EXTENSIONS_DELETED,{messageID:G,keyList:te})}},{key:"setMessageExtensions",value:function(n,Y){var l="setMessageExtensions";if(!this.canIUse(ue.MSG_EXT))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=n.ID,I=n.conversationID,k=n.sequence,P=n.time,G=L(Y),Y=(20<Y.length&&(G=Y.slice(0,20),q.w("".concat(h,". the length of extensions cannot exceed 20."))),"conversationID:".concat(I," messageID:").concat(v," sequence:").concat(k," time:").concat(P," count:").concat(G.length)),te=new it(l);return te.setMessage(Y),q.l("".concat(h," ").concat(Y)),this._modifyMessageExtensions(n,G).then(function(ve){var ye=ve.resultList,Ue=ve.successCount,ve=ve.failureCount,Ue="success count:".concat(Ue," fail count:").concat(ve);return te.setMoreMessage(Ue).end(),q.l("".concat(h," ok. ").concat(Ue)),Ut({extensions:ye})}).catch(function(pe){return te.setError(pe).end(),q.e("".concat(h," failed. error:"),pe),Re(pe)})}},{key:"getMessageExtensions",value:function(n){var s=this,l="getMessageExtensions";if(!this.canIUse(ue.MSG_EXT))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=n.ID,P=n.conversationID,I=n.sequence,k=n.time,P="conversationID:".concat(P," messageID:").concat(v," sequence:").concat(I," time:").concat(k),G=new it(l),Y=(G.setMessage(P),q.l("".concat(h," ").concat(P)),void 0);return this.getMessageExtensionsMap.has(v)&&(Y=this._getGlobalSequence(v)),this._getMessageExtensions(n,Y).then(function(te){return G.end(),q.l("".concat(h," ok. total count:").concat(te.length)),Qe(Y)&&0<te.length&&s.getMessageExtensionsMap.set(v,1),Ut({extensions:te})}).catch(function(te){return G.setError(te).end(),q.e("".concat(h," failed. error:"),te),Re(te)})}},{key:"deleteMessageExtensions",value:function(n,k){var l="deleteMessageExtensions";if(!this.canIUse(ue.MSG_EXT))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=[],I=3,k=(Ct(k)||(I=2,k.forEach(function(pe){v.push({key:pe,value:"",seq:0})})),n.ID),Y=n.conversationID,P=n.sequence,G=n.time,Y="conversationID:".concat(Y," messageID:").concat(k," sequence:").concat(P," time:").concat(G," operateType:").concat(I),te=new it(l);return te.setMessage(Y),q.l("".concat(h," ").concat(Y)),this._modifyMessageExtensions(n,v,I).then(function(Ue){var ye=Ue.resultList,ve=Ue.successCount,Ue=Ue.failureCount,ut="";return I===2&&(ut="success count:".concat(ve," fail count:").concat(Ue)),te.setMoreMessage("".concat(ut)).end(),q.l("".concat(h," ok. ").concat(ut)),Ut({extensions:ye})}).catch(function(pe){return te.setError(pe).end(),q.e("".concat(h," failed. error:"),pe),Re(pe)})}},{key:"_modifyMessageExtensions",value:function(n,s){var l=this,h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,v=Qo(n.to)?O.CONV_TOPIC:n.conversationType,I=void 0,k=(h!==3&&(I=this._getRequestExtensions(n,s)),null);switch(v){case O.CONV_C2C:k=this.get(6);break;case O.CONV_GROUP:k=this.get(7);break;case O.CONV_TOPIC:k=this.get(10);break;default:return Re({code:Be.CANNOT_FIND_MODULE})}return k.modifyMessageExtensions(n,I,h).then(function(Y){var Y=Y.data,G=Y.extensions,Y=Y.seq,te=[],pe=0,ye=0,ve=[];return(G=Ct(G)?[]:G).forEach(function(en){var ut=en.errorCode,en=en.extension,mt=en.key,Kt=en.value,en=en.seq;te.push({code:ut,key:mt,value:Kt}),ut===0?pe++:ye++,ve.push({key:mt,value:Kt,seq:en})}),l._updateGlobalSequence(n.ID,Y),0<ve.length&&(l._updateLocalExtension(n.ID,ve),ve=null),{resultList:te,successCount:pe,failureCount:ye}}).catch(function(P){return Re(P)})}},{key:"_getRequestExtensions",value:function(n,s){var l,h=[];return this._hasLocalExtension(n.ID)?(l=this._getLocalExtension(n.ID),s.forEach(function(k){var I=k.key,k=k.value,P=0;l.has(I)&&(P=l.get(I).seq),h.push({key:I,value:k,seq:P})})):s.forEach(function(k){var I=k.key,k=k.value;h.push({key:I,value:k,seq:0})}),h}},{key:"_getMessageExtensions",value:function(n,s){var l=this,h="".concat(this._n,"._getMessageExtensions"),v=n.ID,I=n.to,k=null;switch(Qo(I)?O.CONV_TOPIC:n.conversationType){case O.CONV_C2C:k=this.get(6);break;case O.CONV_GROUP:k=this.get(7);break;case O.CONV_TOPIC:k=this.get(10);break;default:return Re({code:Be.CANNOT_FIND_MODULE})}return k.getMessageExtensions(n,s).then(function(te){var te=te.data,pe=te.extensions,G=te.completeFlag,Y=te.globalSequence,te=te.clearSequence,pe=Ct(pe)?[]:pe;return q.l("".concat(h," ok. completeFlag:").concat(G," globalSequence:").concat(Y," clearSequence:").concat(te," count:").concat(pe.length)),l._updateLocalExtension(v,pe),l._clearLocalExtension(v,te),l._updateGlobalSequence(v,Y),G!==1?(te=pe.slice(-1)[0].seq+1,l._getMessageExtensions(n,te)):l._getLocalExtensions(v)}).catch(function(P){return Re(P)})}},{key:"_hasLocalExtension",value:function(n){return this.messageExtensionMap.has(n)}},{key:"_getLocalExtension",value:function(n){return this.messageExtensionMap.get(n)}},{key:"_updateLocalExtension",value:function(n,s){this._hasLocalExtension(n)||this.messageExtensionMap.set(n,new Map);var l=this._getLocalExtension(n);s.forEach(function(k){var v=k.key,I=k.value,k=k.seq;l.set(v,{value:I===void 0?"":I,seq:k})})}},{key:"_clearLocalExtension",value:function(n,s){var l;s<=0||!this._hasLocalExtension(n)||(l=this._getLocalExtension(n)).forEach(function(h,v){h.seq<=s&&l.delete(v)})}},{key:"_getLocalExtensions",value:function(n){var s=[];return this._hasLocalExtension(n)&&this._getLocalExtension(n).forEach(function(l,h){l=l.value,Ct(l)||s.push({key:h,value:l})}),s}},{key:"_getGlobalSequence",value:function(n){return this.globalSeqMap.get(n)}},{key:"_updateGlobalSequence",value:function(n,s){this.globalSeqMap.set(n,s)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this.messageExtensionMap.clear(),this.globalSeqMap.clear(),this.getMessageExtensionsMap.clear()}}]),Xc),fh=(_(xl,Uo),Tp=D(xl),p(xl,[{key:"onMessageReactionNotifyList",value:function(l){var s=this,l=(l||{}).dataList;(l===void 0?[]:l).forEach(function(v){var k=v.C2CMessageInfo,P=v.groupMessageInfo,P=P===void 0?{}:P,v=v.reactionList,v=v===void 0?[]:v,k=i(i({},k===void 0?{}:k),P),P=k.tinyID,I=k.clientTime,k=k.random,P="".concat(P,"-").concat(I,"-").concat(k),G=[];v.forEach(function(Y){Qe(Y.userIDList)&&(Y.userIDList=[],Y.count=0),G.push.apply(G,L(Y.userIDList))}),q.l("".concat(s._n,".onMessageReactionNotifyList messageID:").concat(P," reactionList:").concat(v.length)),s._handleReactionSummary([{messageID:P,reactionList:v}],G).then(function(Y){s.emitOuterEvent($.MESSAGE_REACTIONS_UPDATED,i({},Y[0]))})})}},{key:"onMessageReactionNotify",value:function(l){var l=l.dataList||{},h=l.C2CMessageInfo,v=l.groupMessageInfo,v=v===void 0?{}:v,s=l.reactionID,l=l.operateType,h=i(i({},h===void 0?{}:h),v),v=h.tinyID,I=h.clientTime,h=h.random,v="".concat(v,"-").concat(I,"-").concat(h),I=(q.l("".concat(this._n,".onMessageReactionNotify messageID:").concat(v," reactionID:").concat(s," operateType:").concat(l)),l===1?this._addReactedByMyselfMap(v,s):this._removeReactedByMyselfMap(v,s),"".concat(v,"-").concat(s));this._reactionInfoMap.has(I)&&((h=this._reactionInfoMap.get(I)).reactedByMyself=l===1,this.emitOuterEvent($.MESSAGE_REACTIONS_UPDATED,{messageID:v,reactionList:[h]}))}},{key:"addMessageReaction",value:function(n,s){var l=this,h="addMessageReaction";if(!this.canIUse(ue.MSG_REACTION))return this.cannotUseCommercialAbility(h);var v="".concat(this._n,".").concat(h),P=n.ID,I=n.conversationID,I="conversationID:".concat(I," messageID:").concat(P," reactionID:").concat(s),k=new it(h),P=(k.setMessage(I),q.l("".concat(v," ").concat(I)),this._createReactionOperationPack(n,s,1));return this._addReactedByMyselfMap(n.ID,s),this.req(P).then(function(){return k.end(),q.l("".concat(v," ok.")),Ut()}).catch(function(G){return l._removeReactedByMyselfMap(n.ID,s),k.setError(G).end(),q.e("".concat(v," failed. error:"),G),Re(G)})}},{key:"removeMessageReaction",value:function(n,s){var l="removeMessageReaction";if(!this.canIUse(ue.MSG_REACTION))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),k=n.ID,v=n.conversationID,v="conversationID:".concat(v," messageID:").concat(k," reactionID:").concat(s),I=new it(l),k=(I.setMessage(v),q.l("".concat(h," ").concat(v)),this._createReactionOperationPack(n,s,2));return this._removeReactedByMyselfMap(n.ID,s),this.req(k).then(function(){return I.end(),q.l("".concat(h," ok.")),Ut()}).catch(function(P){return I.setError(P).end(),q.e("".concat(h," failed. error:"),P),Re(P)})}},{key:"getMessageReactions",value:function(n){var s=this,l="getMessageReactions";if(!this.canIUse(ue.MSG_REACTION))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),v=n.messageList,G=n.maxUserCountPerReaction,I=v[0].conversationID,I="conversationID:".concat(I," maxUserCountPerReaction:").concat(G," messageList:").concat(v.length),k=new it(l),P=(k.setMessage(I),q.l("".concat(h," ").concat(I)),new Map),G=this._createReactionSummaryPack(i(i({},n),{},{messageIDMap:P}));return this.req(G).then(function(te){var te=te.data.resultList,pe=[],ye=[];return(te===void 0?[]:te).forEach(function(ut){var Ue=ut.messageKey,Ue=Ue===void 0?void 0:Ue,mt=ut.messageSequence,mt=mt===void 0?void 0:mt,ut=ut.reactionList,ut=ut===void 0?[]:ut,mt=Qe(Ue)?P.get(mt):P.get(Ue);pe.push({messageID:mt,reactionList:ut}),ut.forEach(function(Kt){ye.push.apply(ye,L(Kt.userIDList))})}),s._handleReactionSummary(pe,ye)}).then(function(Y){return k.end(),q.l("".concat(h," ok.")),P.clear(),Ut({resultList:Y})}).catch(function(Y){return k.setError(Y).end(),q.e("".concat(h," failed. error:"),Y),Re(Y)})}},{key:"getAllUserListOfMessageReaction",value:function(n){var s=this,l="getAllUserListOfMessageReaction";if(!this.canIUse(ue.MSG_REACTION))return this.cannotUseCommercialAbility(l);var h="".concat(this._n,".").concat(l),P=n.message,v=n.reactionID,I=n.nextSeq,k=n.count,te=P.ID,P=P.conversationID,P="conversationID:".concat(P," messageID:").concat(te," reactionID:").concat(v," nextSeq:").concat(I," count:").concat(k),G=new it(l),Y=(G.setMessage(P),q.l("".concat(h," ").concat(P)),{userList:[],nextSeq:0,isCompleted:!1}),te=this._createReactionUserListPack(n);return this.req(te).then(function(ve){var ve=ve.data,ye=ve.userIDList,ye=ye===void 0?[]:ye,ve=ve.nextSeq,ve=ve===void 0?0:ve;return Y.nextSeq=ve,Y.isCompleted=ve===0,s.get(4).getUserNickAndAvatar(ye)}).then(function(pe){return Y.userList=pe,G.end(),q.l("".concat(h," ok.")),Ut(Y)}).catch(function(pe){return G.setError(pe).end(),q.e("".concat(h," failed. error:"),pe),Re(pe)})}},{key:"_createReactionOperationPack",value:function(n,k,l){var h,v,I=void 0,k={reactionID:k,userIDList:[this.getMyUserID()]};return n.conversationType===O.CONV_C2C&&(h=this.get(6),I=l===1?fe.ADD_C2C_MSG_REACTION:fe.RM_C2C_MSG_REACTION,k.from=n.from,k.to=n.to,k.messageKey=h.getMessageKey(n)),n.conversationType===O.CONV_GROUP&&(h=void 0,v=n.to,Qo(n.to)&&(v=Zo(h=n.to)),I=l===1?fe.ADD_GRP_MSG_REACTION:fe.RM_GRP_MSG_REACTION,k.groupID=v,k.topicID=h,k.messageSequence=n.sequence),{proto:I,data:k}}},{key:"_createReactionSummaryPack",value:function(P){var s,l,h,v=P.messageList,I=P.maxUserCountPerReaction,I=I===void 0?10:I,k=P.messageIDMap,P=v[0],G=void 0,Y=void 0;return P.conversationType===O.CONV_C2C&&(s=this.get(6),l=v.map(function(te){var pe=s.getMessageKey(te);return k.set(pe,te.ID),pe}),G=fe.GET_C2C_MSG_REACTIONS,Y={from:P.from,to:P.to,messageKeyList:l,count:I}),P.conversationType===O.CONV_GROUP&&(l=void 0,h=P.to,Qo(P.to)&&(h=Zo(l=P.to)),P=v.map(function(te){return k.set(te.sequence,te.ID),te.sequence}),G=fe.GET_GRP_MSG_REACTIONS,Y={groupID:h,topicID:l,messageSequenceList:P,count:I}),{proto:G,data:Y}}},{key:"_createReactionUserListPack",value:function(h){var s=h.message,I=h.reactionID,l=h.nextSeq,h=h.count,h=h===void 0?100:h,v=void 0,I={reactionID:I,nextSeq:l===void 0?0:l,count:100<h?100:h};return s.conversationType===O.CONV_C2C&&(l=this.get(6),v=fe.GET_C2C_MSG_REACTION_USER_LIST,I.from=s.from,I.to=s.to,I.messageKey=l.getMessageKey(s)),s.conversationType===O.CONV_GROUP&&(h=void 0,l=s.to,Qo(s.to)&&(l=Zo(h=s.to)),v=fe.GET_GRP_MSG_REACTION_USER_LIST,I.groupID=l,I.topicID=h,I.messageSequence=s.sequence),{proto:v,data:I}}},{key:"_handleReactionSummary",value:function(n,s){var l=this;return this.get(4).getUserNickAndAvatar(s).then(function(h){var v=[];return n.forEach(function(I){var k=[];I.reactionList.forEach(function(te){var G=te.reactionID,Y=te.count,ye=te.userIDList,te=te.reactedByMyself,te=te===void 0?void 0:te,pe=[],ye=(ye.forEach(function(ve){h.forEach(function(Ue){ve===Ue.userID&&pe.push(Ue)})}),{reactionID:G,totalUserCount:Y,partialUserList:pe,reactedByMyself:l._computeReactedByMyself({reactedByMyself:te,messageID:I.messageID,reactionID:G})});k.push(ye),Qe(te)&&!l._reactedByMyselfMap.has(I.messageID)&&(Y="".concat(I.messageID,"-").concat(G),l._reactionInfoMap.set(Y,ye))}),v.push({messageID:I.messageID,reactionList:k})}),v})}},{key:"_addReactedByMyselfMap",value:function(n,s){this._reactedByMyselfMap.has(n)||this._reactedByMyselfMap.set(n,[]),n=this._reactedByMyselfMap.get(n),n.indexOf(s)===-1&&n.push(s)}},{key:"_removeReactedByMyselfMap",value:function(n,s){!this._reactedByMyselfMap.has(n)||-1<(s=(n=this._reactedByMyselfMap.get(n)).indexOf(s))&&n.splice(s,1)}},{key:"_computeReactedByMyself",value:function(h){var s=h.reactedByMyself,l=h.messageID,h=h.reactionID;return Qe(s)?!!this._reactedByMyselfMap.has(l)&&this._reactedByMyselfMap.get(l).includes(h):s===1}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}]),xl),ub=(_(gh,Uo),sb=D(gh),p(gh,[{key:"sendMessage",value:function(n){var s=this,l=this._constructMessageInstance(n);if(l===null)return Re({code:Be.MSG_SEND_FAIL});this._addSendMessageTotalCount(l);var h=Date.now();return this.get(11).setMessageRandom(l),this._sendComboMessage(l,n).then(function(k){var k=k.data,P=k.time,I=k.sequence,k=k.readReceiptCode,k=(un(k)&&k!==0&&(new it("sendMessageWithReceipt").setMessage("from:".concat(l.from," to:").concat(l.to," sequence:").concat(I," readReceiptCode:").concat(k)).end(),q.w("".concat(s._n,".sendMessage readReceiptCode:").concat(k," message:").concat(s.getErrorMessage(k)))),s._addSendMessageSuccessCount(l,h),s.get(11)),P=(l.status=Ui,l.time=P,l.conversationType===O.CONV_GROUP&&(l.sequence=I),k.appendToMessageList(l),l);return l._isExcludedFromLastMessage===!0&&(P=""),k.onMessageSent({conversationOptionsList:[{conversationID:l.conversationID,unreadCount:0,type:l.conversationType,subType:l.conversationSubType,lastMessage:P}]}),Ut({message:l})}).catch(function(v){return s._onSendMessageFailed(l,v)})}},{key:"_sendComboMessage",value:function(n,s){var l=this._m.get(20),h="";return n.conversationType===O.CONV_C2C&&(h="".concat(Q.NAME.OPEN_IM,".").concat(fe.SEND_C2C_MSG)),n.conversationType===O.CONV_GROUP&&(h="".concat(Q.NAME.GROUP,".").concat(fe.SEND_GRP_MSG)),l.sendComboMessage({servcmd:h,data:s})}},{key:"_constructMessageInstance",value:function(n){var s="".concat(this._n,"._constructMessageInstance"),l=null;try{var h,v=this.getMyUserID(),I={};I.senderTinyID=this.getMyTinyID(),I.currentUser=v,I.from=n.From_Account||v,n.GroupId?(I.conversationID="".concat(O.CONV_GROUP).concat(n.GroupId),I.conversationType=O.CONV_GROUP,I.to=n.GroupId):n.To_Account&&(I.conversationID="".concat(O.CONV_C2C).concat(n.To_Account),I.conversationType=O.CONV_C2C,I.to=n.To_Account),I.time=n.MsgTimeStamp||0,I.random=n.Random||n.MsgRandom||0,I.priority=n.MsgPriority,Sn(n.CloudCustomData)&&0<n.CloudCustomData.length&&(I.cloudCustomData=n.CloudCustomData),Rt(n.SendMsgControl)&&(I.messageControlInfo={},n.SendMsgControl.includes("NoUnread")&&(I.messageControlInfo.excludedFromUnreadCount=1),n.SendMsgControl.includes("NoLastMsg")&&(I.messageControlInfo.excludedFromLastMessage=1)),I.conversationType===O.CONV_GROUP&&Rt(n.To_Account)&&0<n.To_Account.length&&(h=n.To_Account,50<n.To_Account.length&&(h=n.To_Account.slice(0,50),q.w("".concat(s," To_Account must be less than or equal to 50."))),I.receiverList=L(h),n.To_Account=L(h)),n.IsNeedReadReceipt!==1&&n.NeedReadReceipt!==1||(I.needReadReceipt=!0),n.SupportMessageExtension===1&&(I.isSupportExtension=!0),(l=new er(I)).status=Bc,n.MsgClientTime=l.clientTime,l.conversationType===O.CONV_C2C&&(n.MsgSeq=l.sequence);for(var k,P=n.MsgBody.length,G=0;G<P;G++)(k=n.MsgBody[G]).MsgType==="TIMTextElem"?l.setTextElement(k.MsgContent.Text):k.MsgType==="TIMCustomElem"?l.setCustomElement({data:k.MsgContent.Data||"",description:k.MsgContent.Desc||"",extension:k.MsgContent.Ext||""}):k.MsgType==="TIMFaceElem"&&l.setFaceElement({index:k.MsgContent.Index,data:k.MsgContent.Data});var Y=l.getElements();l.payload=Y[0].content,l.type=Y[0].type}catch(te){l=null,q.e("".concat(s," failed. error:"),te)}return l}},{key:"_onSendMessageFailed",value:function(n,s){return n.status=ov,this.get(11).deleteMessageRandom(n),this._addSendMessageFailCountOnUser(n,s),new it("sendMessage").setMessage("tjg_id:".concat(this.generateTjgID(n)," type:").concat(n.type," from:").concat(n.from," to:").concat(n.to)).setError(s).end(),q.e("".concat(this._n,"._onSendMessageFailed error:"),s),Re(new so({code:s&&s.code?s.code:Be.MSG_SEND_FAIL,message:s&&s.message?s.message:void 0,data:{message:n}}))}},{key:"_getSendMessageSpecifiedKey",value:function(n){if(n.conversationType===O.CONV_C2C)return ua;if(n.conversationType===O.CONV_GROUP){var n=this.get(7).getLocalGroupProfile(n.to);if(n)return n=n.type,Mr(n)?da:Ds}}},{key:"_addSendMessageTotalCount",value:function(n){n=this._getSendMessageSpecifiedKey(n),n&&this.get(26).addTotalCount(n)}},{key:"_addSendMessageSuccessCount",value:function(h,s){var l,h=this._getSendMessageSpecifiedKey(h);h&&((l=this.get(26)).addSuccessCount(h),l.addCost(h,ar(s,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(v,l){var l=l.code,l=l===void 0?-1:l,h=this.get(26),v=this._getSendMessageSpecifiedKey(v);Kv(l)&&v&&h.addFailedCountOfUserSide(v)}}]),gh),ph=(_(Jc,Uo),ib=D(Jc),p(Jc,[{key:"registerPlugin",value:function(n){var s=this;Object.keys(n).forEach(function(l){s.plugins[l]=n[l]}),new it("registerPlugin").setMessage("".concat(Object.keys(n))).end()}},{key:"getPlugin",value:function(n){return this.plugins[n]}},{key:"reset",value:function(){}}]),Jc),db=(_(Yc,Uo),zv=D(Yc),p(Yc,[{key:"_onLoginSuccess",value:function(n){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(v){var s=this,l=v.cookie,h=v.syncFlag,v=v.isOnlineSync,I="".concat(this._n,"._startSync");q.l("".concat(I," cookie:").concat(l," syncFlag:").concat(h," isOnlineSync:").concat(v)),this.req({proto:fe.SYNC_UNREAD_MSG,data:{cookie:l,syncFlag:h,isOnlineSync:v}}).then(function(k){var G=k.data,P=G.cookie,G=G.syncFlag;Ct(s._cookie=P)||(G===0||G===1?(s._dispatchUnreadMessage(i(i({},k.data),{},{isSyncingEnded:!1})),s._startSync({cookie:P,syncFlag:G,isOnlineSync:0})):G===2&&s._dispatchUnreadMessage(i(i({},k.data),{},{isSyncingEnded:!0})))}).catch(function(k){q.e("".concat(I," failed. error:"),k)})}},{key:"_dispatchUnreadMessage",value:function(n){n.eventArray&&this.get(20).onMessage({head:{},body:{eventArray:n.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:n.isSyncingEnded}}),this.get(6).onNewC2CMessage({dataList:n.messageList,isInstantMessage:!!n.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:n.C2CRemainingUnreadList,C2CPairUnreadList:n.C2CPairUnreadList,isSyncingEnded:n.isSyncingEnded})}},{key:"startOnlineSync",value:function(){q.l("".concat(this._n,".startOnlineSync")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"startSyncOnReconnected",value:function(){q.l("".concat(this._n,".startSyncOnReconnected.")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),Yc),Mp={request:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList",cmConfigID:"CustomModerationConfigID"},response:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself",Level:"messageRemindType"},ignoreKeyWord:["C2C","ID","USP"]};function Yc(n){return u(this,Yc),(n=zv.call(this,n))._n="SyncUnreadMessageModule",n._cookie="",n._onlineSyncFlag=!1,n.getInnerEmitterInstance().on(So.A2KEY_AND_TINYID_UPDATED,n._onLoginSuccess,N(n)),n}function Jc(n){return u(this,Jc),(n=ib.call(this,n))._n="PluginModule",n.plugins={},n}function gh(n){return u(this,gh),(n=sb.call(this,n))._n="ComboMessageModule",n}function xl(n){return u(this,xl),(n=Tp.call(this,n))._n="MessageReactionModule",n._reactedByMyselfMap=new Map,n._reactionInfoMap=new Map,n}function Xc(n){return u(this,Xc),(n=ab.call(this,n))._n="MessageExtensionModule",n.messageExtensionMap=new Map,n.globalSeqMap=new Map,n.getMessageExtensionsMap=new Map,n}function Qc(n){return u(this,Qc),(n=lb.call(this,n))._n="MessageModule",n._messageOptionsMap=new Map,n._mergerMessageHandler=new X1(N(n)),n}function Wv(n,s){if(typeof n!="string"&&!Array.isArray(n))throw new TypeError("Expected the input to be `string | string[]`");return s=Object.assign({pascalCase:!1},s),(n=Array.isArray(n)?n.map(function(l){return l.trim()}).filter(function(l){return l.length}).join("-"):n.trim()).length===0?"":n.length===1?s.pascalCase?n.toUpperCase():n.toLowerCase():(n=n=(n=n!==n.toLowerCase()?nM(n):n).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(l,h){return h.toUpperCase()}).replace(/\d+(\w|$)/g,function(l){return l.toUpperCase()}),s.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)}var nM=function(n){for(var s=!1,l=!1,h=!1,v=0;v<n.length;v++){var I=n[v];s&&/[a-zA-Z]/.test(I)&&I.toUpperCase()===I?(n=n.slice(0,v)+"-"+n.slice(v),h=l,l=!(s=!1),v++):l&&h&&/[a-zA-Z]/.test(I)&&I.toLowerCase()===I?(n=n.slice(0,v-1)+"-"+n.slice(v-1),h=l,s=!(l=!1)):(s=I.toLowerCase()===I&&I.toUpperCase()!==I,h=l,l=I.toUpperCase()===I&&I.toLowerCase()!==I)}return n};function hb(n,s){var l=0;return function h(v,I){return 100<++l?(l--,v):Rt(v)?(k=v.map(function(te){return hr(te)?h(te,I):te}),l--,k):hr(v)?(P=v,G=function(te,pe){if(!wl(pe))return!1;if(pe!==Wv(pe))for(var ye=0;ye<Mp.ignoreKeyWord.length&&!pe.includes(Mp.ignoreKeyWord[ye]);ye++);var ve;return Qe(I[pe])?(ve=pe)==="OPPOChannelID"?ve:ve[0].toUpperCase()+Wv(ve).slice(1):I[pe]},Y=Object.create(null),Object.keys(P).forEach(function(te){var pe=G(P[te],te);pe&&(Y[pe]=P[te])}),k=AI(k=Y,function(te,pe){return Rt(te)||hr(te)?h(te,I):te}),l--,k):void 0;var k,P,G,Y}(n,s)}for(var fb,kp=String.fromCharCode,oM=function(n){var s=0|n.charCodeAt(0);if(55296<=s)if(s<56320)if(n=0|n.charCodeAt(1),56320<=n&&n<=57343){if(65535<(s=(s<<10)+n-56613888|0))return kp(240|s>>>18,128|s>>>12&63,128|s>>>6&63,128|63&s)}else s=65533;else s<=57343&&(s=65533);return s<=2047?kp(192|s>>>6,128|63&s):kp(224|s>>>12,128|s>>>6&63,128|63&s)},jv=function(n){for(var s=n===void 0?"":(""+n).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,oM),l=0|s.length,h=new Uint8Array(l),v=0;v<l;v=v+1|0)h[v]=0|s.charCodeAt(v);return h},rM=(p(e_,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(n){this._handler.onOpen({id:this._id,res:JSON.stringify(n)})}},{key:"_onClose",value:function(n){this._handler.onClose({id:this._id,e:n})}},{key:"_onMessage",value:function(n){n=this._canIUseBinaryFrame?this._isAppCompressedData(n.data)?this._handler.inflate(n.data):function(s){for(var l=new Uint8Array(s),h="",v=0,I=l.length;v<I;){var k=l[v],P=0,G=0;if(k<=127?(P=0,G=255&k):k<=223?(P=1,G=31&k):k<=239?(P=2,G=15&k):k<=244&&(P=3,G=7&k),0<I-v-P)for(var Y=0;Y<P;)G=G<<6|63&(k=l[v+Y+1]),Y+=1;else G=65533,P=I-v;h+=String.fromCodePoint(G),v+=P+1}return h}(n.data):n.data,this._handler.onMessage({data:n})}},{key:"_isAppCompressedData",value:function(n){return n=new Uint8Array(n),n[0]===67&&n[1]===79&&n[2]===77&&n[3]===80}},{key:"_onError",value:function(n){this._handler.onError({id:this._id,e:n})}},{key:"setIsWorkerEnabled",value:function(n){this._isWorkerEnabled=!0}},{key:"close",value:function(n){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:n}),this._workerSocket.terminate(),this._workerSocket=null),Ve)return xe.offSocketClose(),xe.offSocketMessage(),xe.offSocketOpen(),xe.offSocketError(),void xe.closeSocket();this._socket&&(Ie?(this._socket.onClose(function(){}),this._socket.onOpen(function(){}),this._socket.onMessage(function(){}),this._socket.onError(function(){})):Ae&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),Ge?this._socket.close({code:n}):this._socket.close(n),this._socket=null)}},{key:"send",value:function(n){this._workerSocket?this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?jv(n.data).buffer:n.data}):Ve?xe.sendSocketMessage({data:n.data,fail:function(){n.fail&&n.requestID&&n.fail(n.requestID)}}):this._socket&&(Ie?this._socket.send({data:this._canIUseBinaryFrame?jv(n.data).buffer:n.data,fail:function(){n.fail&&n.requestID&&n.fail(n.requestID)}}):Ae&&this._socket.send(this._canIUseBinaryFrame?jv(n.data):n.data))}}]),e_),pb=["keyMap"],gb=["keyMap"],Fl="connected",Yv="connecting",Vl="disconnected",mb=(p(Zv,[{key:"_setWebsocketHost",value:function(){var n=this._chM.get(12);this._currentSite=ee,this._chM.isOversea()&&(this._currentSite="OVERSEA"),n.isSingaporeSite()?this._currentSite="SINGAPORE":n.isKoreaSite()?this._currentSite="KOREA":n.isGermanySite()?this._currentSite="GERMANY":n.isIndiaSite()?this._currentSite="IND":n.isJapanSite()?this._currentSite="JPN":n.isUSASite()?this._currentSite="USA":n.isIndonesiaSite()&&(this._currentSite="INDONESIA"),Q.HOST.setCurrent(this._currentSite)}},{key:"_initConnection",value:function(){Qe(Q.HOST.CURRENT.BACKUP)||this._url===""?this._url=Q.HOST.CURRENT.DEFAULT:this._url===Q.HOST.CURRENT.DEFAULT?this._url=Q.HOST.CURRENT.BACKUP:this._url===Q.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?Q.HOST.CURRENT.ANYCAST:Q.HOST.CURRENT.DEFAULT:this._url===Q.HOST.CURRENT.ANYCAST&&(Q.HOST.CURRENT.ANYCAST="",this._url=Q.HOST.CURRENT.DEFAULT);var n=this._chM.get(12),s=n.getProxyServer();Ct(s)||(this._url=s),n.isTestEnv()&&(this._url=he.TEST[this._currentSite].DEFAULT),this._connect(),this._nextPingTs=0}},{key:"_canIUseAnyCast",value:function(){return Ae&&Q.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(n){n%1==0&&(this._checkPromiseMap(),this._checkNativeAppWS())}},{key:"_checkPromiseMap",value:function(){var n=this;this._promiseMap.size!==0&&this._promiseMap.forEach(function(v,l){var h=v.reject,v=v.timestamp,I=15e3;l.indexOf(fe.LOGIN)!==-1?I=9e4:l.indexOf(fe.PING)!==-1&&(I=3e3),Date.now()-v>=I&&(q.l("".concat(n._n,"._checkPromiseMap request timeout, delete requestID:").concat(l)),n._promiseMap.delete(l),h(new so({code:Be.NETWORK_TIMEOUT})),n._chM.onRequestTimeout())})}},{key:"_checkNativeAppWS",value:function(){qe&&!this.isConnected()&&this._reConnect()}},{key:"onOpen",value:function(n){var s,l;this._readyState!==Vl&&(this._onOpenTs=Date.now(),l=n.id,n=n.res,this._socketID=l,s=ar(this._startTs,!1),l="socketID:".concat(l," res:").concat(n),q.l("".concat(this._n,"._onOpen cost:").concat(s," ms. ").concat(l)),new it("wsOnOpen").setMessage(s).setCostTime(s).setMoreMessage(l).end(),this._readyState=Fl,this._reConnectCount=0,this._resend(),this._reConnectFlag===!0&&(this._chM.onReconnected(),this._reConnectFlag=!1),this._chM.onOpen())}},{key:"onClose",value:function(h){var s=new it("wsOnClose"),l=h.id,h=h.e,v="sourceSocketID:".concat(l," currentSocketID:").concat(this._socketID," code:").concat(h.code," reason:").concat(h.reason),I=0;this._onOpenTs!==0&&(I=Date.now()-this._onOpenTs),s.setMessage(I).setCostTime(I).setMoreMessage(v).setCode(h.code).end(!0),q.l("".concat(this._n,"._onClose ").concat(v," onlineTime:").concat(I)),l===this._socketID&&(this._readyState=Vl,I<1e3?this._chM.onReconnectFailed():this._chM.onClose())}},{key:"onError",value:function(l){var s=l.id,l=l.e,h="sourceSocketID:".concat(s," currentSocketID:").concat(this._socketID);new it("wsOnError").setMessage(l.errMsg||EI(l)).setMoreMessage(h).setLevel("error").end(!0),q.w("".concat(this._n,"._onError"),l,h),s===this._socketID&&(this._readyState=Vl,this._chM.onError())}},{key:"onMessage",value:function(n){var s;try{s=JSON.parse(n.data)}catch{new it("jsonParseError").setMessage(n.data).end()}if(s&&s.head){var l,h,v,n=this._getRequestIDFromHead(s.head),I=s.body;if(this._chM.get(30).isTRTCCommand(n)||(v=xd(s.head),I=function P(G,Y){return Rt(G)?G.map(function(ve){return hr(ve)?P(ve,Y):ve}):hr(G)?(te=G,pe=function(ve,Ue){return Qe(Y[Ue])?Wv(Ue):Y[Ue]},ye={},Object.keys(te).forEach(function(ve){ye[pe(te[ve],ve)]=te[ve]}),AI(ye,function(ve){return Rt(ve)||hr(ve)?P(ve,Y):ve})):void 0;var te,pe,ye}(s.body,this._getResponseKeyMap(v))),q.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(I)," requestID:").concat(n," has:").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n))return l=(v=this._promiseMap.get(n)).resolve,h=v.reject,v=v.timestamp,this._promiseMap.delete(n),this._calcRTT(v),void(I.errorCode&&I.errorCode!==0?(this._chM.onErrorCodeNotZero(I),h(new so({code:I.errorCode,message:I.errorInfo||"",data:n.includes(fe.MODIFY_C2C_MSG)||n.includes(fe.MODIFY_GRP_MSG)?{elements:I.elements,messageVersion:I.messageVersion,cloudCustomData:I.cloudCustomData}:void 0}))):l(Ut(I)));this._chM.onMessage({head:s.head,body:I})}}},{key:"_calcRTT",value:function(n){n=Date.now()-n,this._chM.get(26).addRTT(n)}},{key:"_connect",value:function(){this._startTs=Date.now(),this._onOpenTs=0,this._socket=new rM(this),this._socketID=this._socket.getID(),this._readyState=Yv,q.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new it("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end()}},{key:"getURL",value:function(){this._chM.isDevMode()&&(this._canIUseBinaryFrame=!1);var n=Jm(),s=((Ve||Ye&&n==="windows"||qe)&&(this._canIUseBinaryFrame=!1),-1),h=(n==="ios"?s=ht||-1:n==="android"&&(s=ft||-1),this._chM.get(12)),l=this._chM.getPlatform(),v=h.getSDKAppID(),h=h.getInstanceID(),v="sdkappid=".concat(v,"&instanceid=").concat(h,"&random=").concat(this._getRandom(),"&platform=").concat(l,"&host=").concat(n)+"&version=".concat(s,"&sdkversion=").concat("3.3.5");return Oe&&(v+="&isminigame=1"),this._chM.canIUseInflate()&&(v+="&compress=gzip"),(this._canIUseBinaryFrame?"".concat(this._url,"/binfo?"):"".concat(this._url,"/info?")).concat(v)}},{key:"_closeConnection",value:function(n){q.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(n),this._socketID=-1,this._socket=null,this._readyState=Vl)}},{key:"_resend",value:function(){var n=this;if(q.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),0<this._promiseMap.size&&this._promiseMap.forEach(function(te,P){var G=te.uplinkData,Y=te.resolve,te=te.reject;P.indexOf(fe.AV_POLLING)!==-1?n._promiseMap.delete(P):(n._promiseMap.set(P,{resolve:Y,reject:te,timestamp:Date.now(),uplinkData:G}),n._execute(P,G))}),0<this._simpleRequestMap.size){var s,l=Z(this._simpleRequestMap);try{for(l.s();!(s=l.n()).done;){var h=x(s.value,2),v=h[0],I=h[1];this._execute(v,I)}}catch(k){l.e(k)}finally{l.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(n){var s=this,l=(n.head.seq=this._getSequence(),n.head.reqtime=Math.floor(Date.now()/1e3),n.keyMap,E(n,pb)),h=this._getRequestIDFromHead(n.head),v=JSON.stringify(l);return new Promise(function(I,k){s._promiseMap.set(h,{resolve:I,reject:k,timestamp:Date.now(),uplinkData:v}),q.d("".concat(s._n,".send uplinkData:").concat(JSON.stringify(l)," requestID:").concat(h," readyState:").concat(s._readyState)),s._readyState!==Fl?s._reConnect():(s._execute(h,v),s._chM.get(26).addRequestCount())})}},{key:"simplySend",value:function(s){s.head.seq=this._getSequence(),s.head.reqtime=Math.floor(Date.now()/1e3),s.keyMap;var l=E(s,gb),s=this._getRequestIDFromHead(s.head),l=JSON.stringify(l);this._readyState!==Fl?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(s,l):q.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(s,l)}},{key:"_execute",value:function(n,s){this._socket.send({data:s,fail:Ie?this._onSendFail.bind(this):void 0,requestID:n})}},{key:"_onSendFail",value:function(n){q.l("".concat(this._n,"._onSendFail requestID:").concat(n)),this._chM.onSendFail()}},{key:"_getSequence",value:function(){var n;if(this._startSequence<2415919103)return n=this._startSequence,this._startSequence+=1,this._startSequence===2415919103&&(this._startSequence=dn()),n}},{key:"_getRequestIDFromHead",value:function(n){return n.servcmd+n.seq}},{key:"_getResponseKeyMap",value:function(n){return n=this._chM.getKeyMap(n),i(i({},Mp.response),n.response)}},{key:"_reConnect",value:function(){this._readyState!==Fl&&this._readyState!==Yv&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var n="".concat(this._n,".forcedReconnect");q.l("".concat(n," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._chM.get(15).isOnline()?(q.w("".concat(n," disconnected from wsserver but network is ok, continue...")),this._closeConnection(4001),this._initConnection()):this._chM.onReconnectFailed())}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=qe?Date.now()+5e3:Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===Fl}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"inflate",value:function(n){if(this._chM.canIUseInflate())return this._chM.get(37).inflate(n)}},{key:"setIsWorkerEnabled",value:function(n){q.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(n)),this._isWorkerEnabled=n}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&sn}},{key:"_getRandom",value:function(){return this._random===0&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"close",value:function(){q.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=dn(),this._readyState=Vl,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),Zv),Ap=function(n,s,l){return new Promise(function(h,v){var I,k,P="application/x-www-form-urlencoded;charset=UTF-8";Ie?xe.request({url:s,data:l,method:n,timeout:3e3,header:{"content-type":P},success:function(G){G&&G.data&&G.data.NetCheckInfo&&q.l("".concat("getconninfo ok in"," miniapp. ret:"),G.data),h()},fail:function(){v(new so({code:Be.NETWORK_ERROR}))}}):(I=new XMLHttpRequest,k=setTimeout(function(){I.abort(),v(new so({code:Be.NETWORK_TIMEOUT}))},3e3),I.onreadystatechange=function(){I.readyState===4&&(clearTimeout(k),I.status===200||I.status===304?(I.responseText&&-1<I.responseText.indexOf("NetCheckInfo")&&q.l("".concat("getconninfo ok in"," web. ret:"),JSON.parse(I.responseText)),h()):v(new so({code:Be.NETWORK_ERROR})))},I.open(n,s,!0),I.setRequestHeader("Content-type",P),l?I.send(l):I.send())})},iM=(_(vh,Uo),fb=D(vh),p(vh,[{key:"onCheckTimer",value:function(n){this._socketHandler&&(this.isLoggedIn()?(0<this._timerForNotLoggedIn&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(n)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(n){this.get(20).onErrorCodeNotZero(n)}},{key:"onMessage",value:function(n){this.get(20).onMessage(n)}},{key:"send",value:function(n){return this._socketHandler?this._previousState!==O.NET_STATE_CONNECTED&&n.head.servcmd.includes(fe.SSO_STAT)?(this.reConnect(),this.isPrivateNetWork()?Promise.resolve():this._sendLogViaHTTP(n)):this._socketHandler.send(n):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(l){var s=Q.HOST.CURRENT.STAT,s="".concat(s,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(l.head.sdkappid,"&reqtime=").concat(Date.now()),l=JSON.stringify(l.body);return Ap("POST",s,l)}},{key:"simplySend",value:function(n){return this._socketHandler?this._socketHandler.simplySend(n):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){Ie&&!qe&&this.outputWarning("DomainNameInMP"),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(n){return this.get(20).getKeyMap(n)}},{key:"_onAppHide",value:function(){this._isAppShowing=!1}},{key:"_onAppShow",value:function(){this._isAppShowing=!0}},{key:"onRequestTimeout",value:function(){3e4<=Date.now()-this._lastDiagnoseTS&&this.diagnose()}},{key:"onSendFail",value:function(){this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"onReconnected",value:function(){q.l("".concat(this._n,".onReconnected cost:").concat(ar(this._disconnectedTS,!0,!0))),this._m.restartTimer(),this.get(20).onReconnected(ar(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(O.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){q.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(n){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var n=0<arguments.length&&arguments[0]!==void 0&&arguments[0],s=!1,l=(this._socketHandler&&(s=this._socketHandler.getReconnectFlag()),"forcedFlag:".concat(n," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(s));if(q.l("".concat(this._n,".reConnect ").concat(l)),!this._fatalErrorFlag&&this._socketHandler){if(n===!0)this._socketHandler.forcedReconnect();else{if(this._previousState===O.NET_STATE_CONNECTING&&s)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(O.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(n){this._previousState!==n&&(q.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(n)),n===O.NET_STATE_DISCONNECTED&&this._disconnectedTS===0&&(this._disconnectedTS=Date.now(),this.diagnose()),this._previousState=n,this.emitOuterEvent($.NET_STATE_CHANGE,{state:n}))}},{key:"_ping",value:function(){var n,s=this;this._probing!==!0&&(this._probing=!0,n=this.get(20).getProtocolData({proto:fe.PING}),this.send(n).then(function(){s._probing=!1}).catch(function(l){s._probing=!1;var h=s.get(15).isOnline();if(q.w("".concat(s._n,"._ping failed. bOnline:").concat(h," error:"),l),l&&l.code===60002)return new it("error").setMessage("code:".concat(l.code," message:").concat(l.message)).end(),s._fatalErrorFlag=!0,void s._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED);h?s.reConnect():s._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}))}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),-1<this._timerForNotLoggedIn&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"canIUseInflate",value:function(){return this._m.canIUseInflate()}},{key:"diagnose",value:function(){this.isPrivateNetWork()||(this._lastDiagnoseTS=Date.now(),this._diagnoseBySSO(),this._diagnoseByCDN())}},{key:"_diagnoseBySSO",value:function(){var n=this,s=this._socketHandler.getURL(),l=s.split("/")[2];l.startsWith("ws")&&(s=s.slice(s.indexOf("info?")+5),l="https://".concat(l,"/v3/netcheck/getconninfo?").concat(s,"&reqtime=").concat(Date.now()),Ap("GET",l).catch(function(h){q.w("".concat(n._n,"._diagnoseBySSO failed. error:"),h)}))}},{key:"_diagnoseByCDN",value:function(){var n=this,s=this._socketHandler.getURL(),s=s.slice(s.indexOf("info?")+5),s="https://boce-cdn.my-imcloud.com/v3/netcheck/getconninfo?".concat(s,"&reqtime=").concat(Date.now());Ap("GET",s).catch(function(l){q.w("".concat(n._n,"._diagnoseByCDN failed. error:"),l)})}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._previousState=O.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0,this._lastDiagnoseTS=0}}]),vh),mh=["a2","tinyid"],Jv=["a2","tinyid"],vb=(p(pa,[{key:"_fillConfigMap",value:function(){this._configMap.clear();var n=this._sessionM.genCommonHead(),s=this._sessionM.genCosSpecifiedHead(),l=this._sessionM.genSSOReportHead();this._configMap.set(fe.LOGIN,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0},keyMap:{request:{deviceBrand:"InstType"},response:{InstId:"instanceID",HelloInterval:"helloInterval"}}}),this._configMap.set(fe.LOGOUT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.LOGOUT)}),body:{type:0},keyMap:{request:{type:"wslogout_type"}}}),this._configMap.set(fe.HELLO,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.HELLO)}),body:{isWebUniapp:0},keyMap:{response:{NewInstInfo:"newInstanceInfo"}}}),this._configMap.set(fe.KICK_OTHER,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.STAT_SERVICE,".").concat(fe.KICK_OTHER)}),body:{}}),this._configMap.set(fe.COS_SIGN,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.IM_COS_SIGN,".").concat(fe.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{request:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},response:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}),this._configMap.set(fe.COS_PRE_SIG,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.CUSTOM_UPLOAD,".").concat(fe.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{request:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},response:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}),this._configMap.set(fe.SIMPLE_COS_PRE_SIG,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.CUSTOM_UPLOAD,".").concat(fe.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{request:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},response:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}),this._configMap.set(fe.GET_IMAGE_INFO,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.CUSTOM_UPLOAD,".").concat(fe.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{request:{imageUrl:"str_image_url"},response:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}),this._configMap.set(fe.GET_IP,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.CUSTOM_UPLOAD,".").concat(fe.GET_IP)}),body:{domainName:""},keyMap:{request:{domainName:"str_domain"},response:{str_final_ip:"ip"}}}),this._configMap.set(fe.VIDEO_COVER,{head:i(i({},s),{},{servcmd:"".concat(Q.NAME.CUSTOM_UPLOAD,".").concat(fe.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{request:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},response:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}),this._configMap.set(fe.FETCH_COMMERCIAL_CONFIG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_CONFIG_MANAGER,".").concat(fe.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{request:{SDKAppID:"uint32_sdkappid"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._configMap.set(fe.PUSHED_COMMERCIAL_CONFIG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_CONFIG_MANAGER,".").concat(fe.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._configMap.set(fe.FETCH_CLOUD_CTRL_CONFIG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_CONFIG_MANAGER,".").concat(fe.FETCH_CLOUD_CTRL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{request:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._configMap.set(fe.PUSHED_CLOUD_CTRL_CONFIG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_CONFIG_MANAGER,".").concat(fe.PUSHED_CLOUD_CTRL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._configMap.set(fe.OVERLOAD_NOTIFY,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OVERLOAD_PUSH,".").concat(fe.OVERLOAD_NOTIFY)}),body:{},keyMap:{response:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}),this._configMap.set(fe.SYNC_UNREAD_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SYNC_UNREAD_MSG)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},response:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}),this._configMap.set(fe.GET_PROFANITY_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_MSG_AUDIT_MGR,".").concat(fe.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{request:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},response:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}),this._configMap.set(fe.SEND_C2C_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SEND_C2C_MSG)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID"}}}),this._configMap.set(fe.SEND_GRP_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.SEND_GRP_MSG)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0},keyMap:{request:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID"},response:{MsgTime:"time",MsgSeq:"sequence"}}}),this._configMap.set(fe.REVOKE_C2C_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.REVOKE_C2C_MSG)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{request:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}),this._configMap.set(fe.REVOKE_GRP_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.REVOKE_GRP_MSG)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{request:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}),this._configMap.set(fe.GET_C2C_ROAMING_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.GET_C2C_ROAMING_MSG)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{request:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},response:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}),this._configMap.set(fe.MODIFY_C2C_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.MODIFY_C2C_MSG)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._configMap.set(fe.GET_GRP_ROAMING_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_ROAMING_MSG)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{request:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},response:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}),this._configMap.set(fe.SET_C2C_MSG_READ,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SET_C2C_MSG_READ)}),body:{C2CMsgReaded:void 0},keyMap:{request:{lastMessageTime:"LastedMsgTime"}}}),this._configMap.set(fe.SET_C2C_PEER_MUTE_NOTIFICATIONS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{request:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}),this._configMap.set(fe.GET_C2C_PEER_MUTE_NOTIFICATIONS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Peer_Account"},response:{MuteNotificationsList:"muteFlagList"}}}),this._configMap.set(fe.SET_GRP_MSG_READ,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.SET_GRP_MSG_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{request:{messageReadSeq:"MsgReadedSeq"}}}),this._configMap.set(fe.SET_ALL_MSG_READ,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SET_ALL_MSG_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{request:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},response:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}),this._configMap.set(fe.DEL_C2C_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.DEL_C2C_MSG)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{request:{keyList:"MsgKeyList"}}}),this._configMap.set(fe.DEL_GRP_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.DEL_GRP_MSG)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{request:{deleter:"Deleter_Account",keyList:"Seqs"}}}),this._configMap.set(fe.TRANSLATE_TEXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_TRANSLATE,".").concat(fe.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{request:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},response:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._configMap.set(fe.VOICE_TO_TEXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_SPEECH,".").concat(fe.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{request:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},response:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._configMap.set(fe.MODIFY_GRP_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.MODIFY_GRP_MSG)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._configMap.set(fe.GET_READ_RECEIPT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequence:"MsgSeq"}}}),this._configMap.set(fe.SEND_C2C_READ_RECEIPT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{request:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}),this._configMap.set(fe.SEND_READ_RECEIPT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}),this._configMap.set(fe.GET_READ_RECEIPT_DETAIL,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{request:{sequence:"MsgSeq",count:"Num"},response:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}),this._configMap.set(fe.MODIFY_C2C_MSG_EXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.MODIFY_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}),this._configMap.set(fe.GET_C2C_MSG_EXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}),this._configMap.set(fe.MODIFY_GRP_MSG_EXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.MODIFY_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}),this._configMap.set(fe.GET_GRP_MSG_EXT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}),this._configMap.set(fe.MSG_CLOUD_SEARCH,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.MSG_SEARCH,".").concat(fe.MSG_CLOUD_SEARCH)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{request:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList"},response:{GroupID:"groupID",UserID:"userID",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",ErrorCode:"code",ErrorInfo:"message"}}}),this._configMap.set(fe.ADD_C2C_MSG_REACTION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Add_Account"}}}),this._configMap.set(fe.RM_C2C_MSG_REACTION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.RM_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Del_Account"}}}),this._configMap.set(fe.GET_C2C_MSG_REACTIONS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}),this._configMap.set(fe.GET_C2C_MSG_REACTION_USER_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}),this._configMap.set(fe.ADD_GRP_MSG_REACTION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Add_Account"}}}),this._configMap.set(fe.RM_GRP_MSG_REACTION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.RM_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Del_Account"}}}),this._configMap.set(fe.GET_GRP_MSG_REACTIONS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{response:{MsgSeq:"messageSequence"}}}),this._configMap.set(fe.GET_GRP_MSG_REACTION_USER_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM_MSG_EXT,".").concat(fe.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}),this._configMap.set(fe.GET_C2C_PEER_READ_TIME,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{request:{userIDList:"To_Account"},response:{ReadTime:"peerReadTimeList"}}}),this._configMap.set(fe.PAGING_GET_CONV_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.PAGING_GET_CONV_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{request:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}),this._configMap.set(fe.DEL_CONV,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.DEL_CONV)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{request:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},response:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}),this._configMap.set(fe.CLEAR_HISTORY_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.CLEAR_HISTORY_MSG)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{request:{toGroupID:"ToGroupid"}}}),this._configMap.set(fe.PIN_CONV,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.PIN_CONV)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{request:{itemList:"RecentContactItem"}}}),this._configMap.set(fe.DEL_GROUP_AT_TIPS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.DEL_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._configMap.set(fe.SET_CONV_CUSTOM_DATA,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}),this._configMap.set(fe.MARK_CONV,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}),this._configMap.set(fe.CREATE_CONV_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.CREATE_CONV_GRP)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"GroupContactItem",groupID:"ToGroupId"},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}),this._configMap.set(fe.DEL_CONV_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.DEL_CONV_GRP)}),body:{fromAccount:"",groupName:void 0},keyMap:{request:{},response:{GroupId:"convGroupID"}}}),this._configMap.set(fe.RENAME_CONV_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},response:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}),this._configMap.set(fe.ADD_CONV_TO_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}},keyMap:{request:{},response:{}}}),this._configMap.set(fe.DEL_CONV_FROM_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{},response:{}}}),this._configMap.set(fe.GET_CONV_GRP_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.GET_CONV_GRP_LIST)}),body:{fromAccount:"",startIndex:void 0},keyMap:{request:{},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}),this._configMap.set(fe.SEARCH_CONV_GRP_MARK,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.RECENT_CONTACT,".").concat(fe.SEARCH_CONV_GRP_MARK)}),body:{fromAccount:"",contactItem:void 0},keyMap:{request:{groupID:"ToGroupId"},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList",ContactResultItem:"contactItem"}}}),this._configMap.set(fe.GET_USER_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.PROFILE,".").concat(fe.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._configMap.set(fe.UPDATE_MY_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.PROFILE,".").concat(fe.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:_n.NICK,value:""},{tag:_n.GENDER,value:""},{tag:_n.ALLOWTYPE,value:""},{tag:_n.AVATAR,value:""}]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._configMap.set(fe.GET_BL,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.GET_BL)}),body:{fromAccount:"",startIndex:0,maxLimited:30,lastSequence:0},keyMap:{response:{CurruentSequence:"currentSequence"}}}),this._configMap.set(fe.ADD_TO_BL,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.ADD_TO_BL)}),body:{fromAccount:"",toAccount:[]}}),this._configMap.set(fe.RM_FROM_BL,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.RM_FROM_BL)}),body:{fromAccount:"",toAccount:[]}}),this._configMap.set(fe.SET_SELF_STATUS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.SET_SELF_STATUS)}),body:{customStatus:""},keyMap:{}}),this._configMap.set(fe.GET_USER_STATUS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}),this._configMap.set(fe.SUB_USER_STATUS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.SUB_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._configMap.set(fe.UNSUB_USER_STATUS,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.UNSUB_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._configMap.set(fe.GET_FD_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.GET_FD_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{response:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}),this._configMap.set(fe.ADD_FD,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.ADD_FD)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{request:{source:"AddSource",wording:"AddWording",type:"AddType"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.UPDATE_FD,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.UPDATE_FD)}),body:{fromAccount:"",updateItem:void 0},keyMap:{request:{snsItem:"SnsItem"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.DEL_FD,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.DEL_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"DeleteType"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.GET_FD_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.GET_FD_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{response:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}),this._configMap.set(fe.CHECK_FD,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.CHECK_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"CheckType"},response:{InfoItem:"resultList"}}}),this._configMap.set(fe.GET_FD_APPLICATION_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.GET_FD_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{response:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}),this._configMap.set(fe.RESPOND_FD_APPLICATION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.RESPOND_FD_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{request:{tag:"TagName",action:"ResponseAction"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.DEL_FD_APPLICATION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.DEL_FD_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{request:{type:"PendencyType",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.REPORT_FD_APPLICATION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.REPORT_FD_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{request:{latestTimeStamp:"LatestPendencyTimeStamp"}}}),this._configMap.set(fe.CREATE_FD_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.CREATE_FD_GRP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{request:{groupName:"GroupName",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}),this._configMap.set(fe.DEL_FD_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.DEL_FD_GRP)}),body:{fromAccount:"",nameList:void 0},keyMap:{request:{nameList:"GroupName"}}}),this._configMap.set(fe.GET_FD_GRP_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.GET_FD_GRP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{response:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}),this._configMap.set(fe.UPDATE_FD_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FD,".").concat(fe.UPDATE_FD_GRP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{request:{oldName:"GroupOldName",newName:"GroupNewName"},response:{UpdateType:"type",ResultItem:"resultList"}}}),this._configMap.set(fe.GET_GRP_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0},keyMap:{request:{memberAccount:"Member_Account"},response:{GroupIdList:"groups",NoUnreadSeqList:"excludedUnreadSequenceList",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime"}}}),this._configMap.set(fe.GET_GRP_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{request:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}),this._configMap.set(fe.CREATE_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.CREATE_GRP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{request:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},response:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}),this._configMap.set(fe.DISMISS_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.DISMISS_GRP)}),body:{groupID:void 0}}),this._configMap.set(fe.UPDATE_GRP_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.UPDATE_GRP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{request:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},response:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}),this._configMap.set(fe.APPLY_JOIN_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{request:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},response:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}),this._configMap.set(fe.APPLY_JOIN_GRP_NOAUTH,(n.a2,n.tinyid,{head:i(i({},E(n,mh)),{},{servcmd:"".concat(Q.NAME.BIG_GRP_NO_AUTH,".").concat(fe.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{request:{applyMessage:"ApplyMsg"},response:{HugeGroupFlag:"avChatRoomFlag"}}})),this._configMap.set(fe.QUIT_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.QUIT_GRP)}),body:{groupID:void 0}}),this._configMap.set(fe.SEARCH_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.SEARCH_GRP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}},keyMap:{response:{}}}),this._configMap.set(fe.CHANGE_GRP_OWNER,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.CHANGE_GRP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{request:{newOwnerID:"NewOwner_Account"}}}),this._configMap.set(fe.HANDLE_GRP_APPLICATION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.HANDLE_GRP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._configMap.set(fe.HANDLE_INVITE_JOIN_GRP,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.HANDLE_INVITE_JOIN_GRP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}),this._configMap.set(fe.HANDLE_GRP_INVITATION,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.HANDLE_GRP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._configMap.set(fe.GET_GRP_PENDENCY,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{request:{handleAccount:"Handle_Account"},response:{To_Account:"userID",ApplyInviteMsg:"note"}}}),this._configMap.set(fe.DEL_GRP_SYSTEM_NOTICE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.DEL_GRP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._configMap.set(fe.AV_POLLING,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.BIG_GRP_POLLING,".").concat(fe.AV_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}),this._configMap.set(fe.AV_NOAUTH_POLLING,(n.a2,n.tinyid,{head:i(i({},E(n,Jv)),{},{servcmd:"".concat(Q.NAME.BIG_GRP_POLLING_NO_AUTH,".").concat(fe.AV_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}})),this._configMap.set(fe.GET_ONLINE_MBR_NUM,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_ONLINE_MBR_NUM)}),body:{groupID:void 0},keyMap:{response:{OnlineMemberNum:"memberCount"}}}),this._configMap.set(fe.SET_GRP_ATTR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.SET_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}),this._configMap.set(fe.MODIFY_GRP_ATTR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.MODIFY_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}),this._configMap.set(fe.DEL_GRP_ATTR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.DEL_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key"}}}),this._configMap.set(fe.CLEAR_GRP_ATTR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.CLEAR_GRP_ATTR)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}),this._configMap.set(fe.GET_GRP_ATTR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_ATTR,".").concat(fe.GET_GRP_ATTR)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{request:{avChatRoomKey:"Key",groupType:"GroupType"}}}),this._configMap.set(fe.GET_GRP_NOTIFY,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{request:{notifyReqList:"NotifyReqList"},response:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}),this._configMap.set(fe.UPDATE_GRP_COUNTER,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.UPDATE_GRP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{request:{counterList:"GroupCounter"}}}),this._configMap.set(fe.GET_GRP_COUNTER,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{request:{keyList:"GroupCounterKeys"}}}),this._configMap.set(fe.CREATE_TOPIC,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_COMMUNITY,".").concat(fe.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{request:{avatar:"FaceUrl"}}}),this._configMap.set(fe.DEL_TOPIC,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_COMMUNITY,".").concat(fe.DEL_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{request:{topicIDList:"TopicIdList"},response:{DestroyResultItem:"resultList"}}}),this._configMap.set(fe.UPDATE_TOPIC_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_COMMUNITY,".").concat(fe.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{request:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}),this._configMap.set(fe.GET_TOPIC_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_COMMUNITY,".").concat(fe.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{request:{topicIDList:"TopicIdList"},response:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence",NoUnreadSeqList:"excludedUnreadSequenceList"}}}),this._configMap.set(fe.GET_GRP_MBR_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_MBR_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}),this._configMap.set(fe.GET_AV_MBR_LIST,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_AV,".").concat(fe.GET_AV_MBR_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{request:{offset:"Timestamp",filter:"Mark"},response:{NextTimestamp:"offset"}}}),this._configMap.set(fe.GET_GRP_MBR_PROFILE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.GET_GRP_MBR_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}),this._configMap.set(fe.ADD_GRP_MBR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.ADD_GRP_MBR)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{request:{userID:"Member_Account",userIDList:"MemberList"},response:{MemberList:"members"}}}),this._configMap.set(fe.DEL_GRP_MBR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.DEL_GRP_MBR)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{request:{userIDList:"MemberToDel_Account"}}}),this._configMap.set(fe.BAN_AV_MBR,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.BAN_AV_MBR)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{request:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}),this._configMap.set(fe.MODIFY_GRP_MBR_INFO,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP,".").concat(fe.MODIFY_GRP_MBR_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{request:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}),this._configMap.set(fe.MARK_AV_MBR_INFO,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.GRP_AV,".").concat(fe.MARK_AV_MBR_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{request:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},response:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}),this._configMap.set(fe.SSO_STAT,{head:i(i({},l),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STAT,".").concat(fe.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{request:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}),this._configMap.set(fe.PING,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.HEARTBEAT,".").concat(fe.PING)}),body:{}}),this._configMap.set(fe.MSG_PUSH,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_PUSH,".").concat(fe.MSG_PUSH)}),body:{},keyMap:{response:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType",CurrFollowType:"followType",Follow_Account:"userID"}}}),this._configMap.set(fe.MULTI_MSG_PUSH,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_PUSH,".").concat(fe.MULTI_MSG_PUSH)}),body:{},keyMap:{response:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}),this._configMap.set(fe.MSG_PUSH_ACK,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OPEN_IM,".").concat(fe.MSG_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{request:{sessionData:"SessionData"}}}),this._configMap.set(fe.STATUS_FORCE_OFFLINE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{response:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}),this._configMap.set(fe.DOWNLOAD_MERGER_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_LONG_MSG,".").concat(fe.DOWNLOAD_MERGER_MSG)}),body:{downloadKey:""},keyMap:{response:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}),this._configMap.set(fe.UPLOAD_MERGER_MSG,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_LONG_MSG,".").concat(fe.UPLOAD_MERGER_MSG)}),body:{messageList:[]},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}),this._configMap.set(fe.FOLLOW,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FOLLOW,".").concat(fe.FOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{request:{userIDList:"FollowItem"},response:{ResultItem:"resultList",To_Account:"userID"}}}),this._configMap.set(fe.UNFOLLOW,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FOLLOW,".").concat(fe.UNFOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{request:{userIDList:"To_Account"},response:{ResultItem:"resultList",To_Account:"userID"}}}),this._configMap.set(fe.GET_FOLLOW_INFO,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FOLLOW,".").concat(fe.GET_FOLLOW_INFO)}),body:{fromAccount:"",userIDList:[]},keyMap:{request:{userIDList:"To_Account"},response:{FollowInfo:"followInfoList",To_Account:"userID",FollowerCount:"followersCount",FollowingCount:"followingCount",MutualFollowingCount:"mutualFollowersCount"}}}),this._configMap.set(fe.GET_FOLLOW,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FOLLOW,".").concat(fe.GET_FOLLOW)}),body:{fromAccount:"",type:1,nextCursor:"",count:500},keyMap:{request:{type:"FollowType",nextCursor:"StartCursor",count:"WantNum"},response:{FollowItem:"resultList",To_Account:"userID",ProfileItem:"profileList"}}}),this._configMap.set(fe.CHECK_FOLLOW_TYPE,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.FOLLOW,".").concat(fe.CHECK_FOLLOW_TYPE)}),body:{fromAccount:"",userIDList:[]},keyMap:{request:{userIDList:"To_Account"},response:{ResultItem:"resultList",To_Account:"userID"}}}),this._configMap.set(fe.SET_TOKEN,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0,notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:""},keyMap:{request:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns",notificationStatus:"NotificationStatus",deviceModel:"DeviceModel",systemVersion:"SystemVersion",pushVersion:"PushPluginVersion"}}}),this._configMap.set(fe.STAT_FOREGROUND,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.STAT_FOREGROUND)}),body:{isWebUniapp:0}}),this._configMap.set(fe.STAT_BACKGROUND,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_OPEN_STATUS,".").concat(fe.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{request:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}),this._configMap.set(fe.PUSH_REPORT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.OFFLINE_PUSH_REPORT,".").concat(fe.PUSH_REPORT)}),body:{eventList:[]},keyMap:{request:{eventList:"UinappPushEvents",type:"EventType",time:"EventTime",pushId:"ClickExt"}}}),this._configMap.set(fe.SET_ALL_RECEIVE_MSG_OPT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_MSG_LOGIC,".").concat(fe.SET_ALL_RECEIVE_MSG_OPT)}),body:{startTime:0,endTime:0,isRepeated:0,messageRemindType:0},keyMap:{request:{messageRemindType:"Level"}}}),this._configMap.set(fe.GET_ALL_RECEIVE_MSG_OPT,{head:i(i({},n),{},{servcmd:"".concat(Q.NAME.IM_MSG_LOGIC,".").concat(fe.GET_ALL_RECEIVE_MSG_OPT)}),body:{toAccount:void 0}})}},{key:"has",value:function(n){return this._configMap.has(n)}},{key:"get",value:function(n){return this._configMap.get(n)}},{key:"update",value:function(){this._fillConfigMap()}},{key:"getKeyMap",value:function(n){return this.has(n)?this.get(n).keyMap||{}:(q.w("".concat(this._n,".getKeyMap unknown proto:").concat(n)),{})}},{key:"getProtocolData",value:function(l){var h=l.proto,s=l.data,l=this.get(h),h=null;if(s){var v,I=this._simpleDeepCopy(l),I=this._updateService(s,I),k=I.body,P=Object.create(null);for(v in k)if(Object.prototype.hasOwnProperty.call(k,v)){if(P[v]=k[v],s[v]===void 0)continue;P[v]=s[v]}I.body=P,h=this._getUplinkData(I)}else h=this._getUplinkData(l);return h}},{key:"_getUplinkData",value:function(s){var s=this._dataCleaner(s),l=xd(s.head),l=hb(s.body,this._getRequestKeyMap(l));return s.body=l,s}},{key:"_updateService",value:function(n,s){var l,h,v=xd(s.head);return this._isFromGroupRequest(s)&&(l=n.type,h=n.groupID,n=(n=n.groupIDList)===void 0?[]:n,Qe(h=h===void 0?void 0:h)&&(h=n[0]||""),Dr({type:l,groupID:h})&&(s.head.servcmd="".concat(Q.NAME.GRP_COMMUNITY,".").concat(v))),s}},{key:"_isFromGroupRequest",value:function(n){return n.head.servcmd.includes(Q.NAME.GRP)||n.head.servcmd.includes(Q.NAME.GRP_ATTR)}},{key:"_getRequestKeyMap",value:function(n){return n=this.getKeyMap(n),i(i({},Mp.request),n.request)}},{key:"_dataCleaner",value:function(n){var s,l=Array.isArray(n)?[]:Object.create(null);for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&wl(s)&&n[s]!==null&&n[s]!==void 0&&(c(n[s])!=="object"?l[s]=n[s]:l[s]=this._dataCleaner.bind(this)(n[s]));return l}},{key:"_simpleDeepCopy",value:function(n){for(var s,l=Object.keys(n),h={},v=0,I=l.length;v<I;v++)s=l[v],Rt(n[s])?h[s]=Array.from(n[s]):hr(n[s])?h[s]=this._simpleDeepCopy(n[s]):h[s]=n[s];return h}}]),pa),Xv=[fe.MSG_PUSH_ACK],_b=(p(Qv,[{key:"_c2cMessageArrayHandler",value:function(n){var s=this._sessionM.get(6);s&&(n.dataList.forEach(function(l){var h;l.isSyncMessage===1&&(h=l.from,l.from=l.to,l.to=h)}),n.needSync===1&&this._sessionM.get(19).startOnlineSync(),s.onNewC2CMessage({dataList:n.dataList,isInstantMessage:!0}))}},{key:"_c2cMessageModifiedHandler",value:function(n){var s=this._sessionM.get(6);s&&s.onC2CMessageModified(n)}},{key:"_groupMessageArrayHandler",value:function(n){var s=this._sessionM.get(7);s&&s.onNewGroupMessage({event:n.event,dataList:n.dataList,isInstantMessage:!0})}},{key:"_groupMessageModifiedHandler",value:function(n){var s=this._sessionM.get(7);s&&s.onGroupMessageModified(n)}},{key:"_groupTipsHandler",value:function(n){var s=this._sessionM.get(7);if(s){var l=n.event,h=n.dataList,v=n.isInstantMessage,I=v===void 0||v,k=n.isSyncingEnded;switch(l){case 4:case 6:s.onNewGroupTips({event:l,dataList:h});break;case 5:for(var P=0;P<h.length;P++)if(Rt(h[P].elements.revokedInfos))s.onGroupMessageRevoked({dataList:h});else if(Rt(h[P].elements.groupMessageReadNotice))s.onGroupMessageReadNotice({dataList:h});else{if(!Rt(h[P].elements.readReceiptList)){s.onNewGroupSystemNotice({dataList:h,isInstantMessage:I,isSyncingEnded:k});break}s.onReadReceiptList({dataList:h})}break;case 12:this._sessionM.get(11).onNewGroupAtTips({dataList:h});break;default:q.l("".concat(this._n,"._groupTipsHandler unknown event:").concat(l," dataList:"),h)}}}},{key:"_C2CNotifyMessageArrayHandler",value:function(n){var s,l=this,h=n.dataList;Rt(h)&&(s=this._sessionM.get(6),h.forEach(function(v){var I,k;xn(v)&&(v.hasOwnProperty("kickoutMsgNotify")?(I=(k=v.kickoutMsgNotify).kickType,k=(k=k.newInstanceInfo)===void 0?{}:k,I===1?l._sessionM.onMultipleAccountKickedOut(k):I===2?l._sessionM.onMultipleDeviceKickedOut(k):I===3&&l._sessionM.onRestApiKickedOut(k)):v.hasOwnProperty("c2cMessageRevokedNotify")?s&&s.onC2CMessageRevoked({dataList:h}):v.hasOwnProperty("c2cMessageReadReceipt")?s&&s.onC2CMessageReadReceipt({dataList:h}):v.hasOwnProperty("c2cMessageReadNotice")?s&&s.onC2CMessageReadNotice({dataList:h}):v.hasOwnProperty("muteNotificationsSync")&&l._sessionM.get(11).onC2CMessageRemindTypeSynced({dataList:h}))}))}},{key:"_C2CReadReceiptArrayHandler",value:function(n){this._sessionM.get(6).onReadReceiptList(n)}},{key:"_profileHandler",value:function(n){this._sessionM.get(4).onProfileModified({dataList:n.dataList});var s=this._sessionM.get(8);s&&s.onFriendProfileModified({dataList:n.dataList})}},{key:"_relationChainHandler",value:function(n){this._sessionM.get(4).onRelationChainModified({dataList:n.dataList});var s=this._sessionM.get(8);s&&s.onRelationChainModified({dataList:n.dataList})}},{key:"_recentContactHandler",value:function(l){var s,l=l.dataList;!Rt(l)||(s=this._sessionM.get(11))&&l.forEach(function(h){var v,I,k=h.pushType;k===1?(v=h.recentContactDeleteItem,s.onConversationDeleted(v.recentContactList)):k===2?(v=h.recentContactTopItem,s.onConversationPinned(v.recentContactList)):k===3?(v=h.recentContactTopItem,s.onConversationUnpinned(v.recentContactList)):k===4?(v=h.recentContactMarkContact,s.onConversationMarkUpdated(v.recentContactMarkContactItem)):k===5?(v=h.recentContactCreateContactGroup,s.onConversationGroupCreated(v.msgContactGroupContactItem)):k===6?(v=h.recentContactDelContactGroup,s.onConversationGroupDeleted(v.msgGroupItem)):k===7&&(k=(v=h.recentContactUpdateContactGroup).updateType,h=v.msgUpdateGroup,v=v.msgUpdateContact,k===1?(I=h.updateGroupType)===1?s.onConversationGroupNameUpdated(h):I===2&&s.onConversationInGroupUpdated(h):k===2&&s.onConversationAddedToOrDeletedFromGroup(v))})}},{key:"_allMessageReadHandler",value:function(s){var s=s.dataList,l=this._sessionM.get(11);l&&l.onPushedAllMessageRead(s)}},{key:"_userStatusListHandler",value:function(n){this._sessionM.get(4).onUserStatusUpdated(n)}},{key:"_messageExtensionNotifyHandler",value:function(n){this._sessionM.get(3).onMessageExtensionNotify(n)}},{key:"_messageReactionNotifyListHandler",value:function(n){this._sessionM.get(34).onMessageReactionNotifyList(n)}},{key:"_messageReactionNotifyHandler",value:function(n){this._sessionM.get(34).onMessageReactionNotify(n)}},{key:"_followInfoHandler",value:function(n){this._sessionM.get(35).onFollowInfoNotify(n)}},{key:"onMessage",value:function(n){var s=this,l=n.body;if(this._filterMessageFromIMOpenPush(n)){var h,v=l.eventArray,I=l.isInstantMessage,k=l.isSyncingEnded,P=l.needSync;if(Rt(v))for(var G,Y,te,pe=0,ye=v.length;pe<ye;pe++)(te=(G=v[pe]).event)!==100?te!==24?(h=Object.keys(G).find(function(ve){return s._keys.indexOf(ve)!==-1}))?(Y=te===14?{readAllC2CMessage:G[h],groupMessageReadInfoList:G.groupMessageReadNotice||[]}:te===16?{userID:G.userID,readReceiptList:G[h]}:G[h],this._eventHandlerMap.get(h)({event:te,dataList:Y,isInstantMessage:I,isSyncingEnded:k,needSync:P})):q.l("".concat(this._n,".onMessage unknown eventItem:").concat(G)):this._onAllReceiveMessageOptNotify(G):this._onRoomCustomData(G.content)}}},{key:"_onRoomCustomData",value:function(n){this._sessionM.get(30).onRoomCustomDataReceived(n),q.l("".concat(this._n,"._onRoomCustomData data:").concat(n))}},{key:"_onAllReceiveMessageOptNotify",value:function(n){this._sessionM.get(11).onAllReceiveMessageOptNotify(n)}},{key:"_filterMessageFromIMOpenPush",value:function(s){var l=s.head,s=s.body,l=l.servcmd,h=!1;return!(h=Qe(l)?h:l.includes(Q.NAME.IM_CONFIG_MANAGER)||l.includes(Q.NAME.OVERLOAD_PUSH)||l.includes(Q.NAME.STAT_SERVICE))||(l.includes(fe.PUSHED_CLOUD_CTRL_CONFIG)?this._sessionM.get(23).onPushedCloudControlConfig(s):l.includes(fe.PUSHED_COMMERCIAL_CONFIG)?this._sessionM.get(27).onPushedConfig(s):l.includes(fe.OVERLOAD_NOTIFY)?this._sessionM.onPushedServerOverload(s):l.includes(fe.KICK_OTHER)&&(h=Date.now(),this._sessionM.reLoginOnKickOther(),s=new it("kickOther"),h=h-(l=this._sessionM.get(1).getLastWsHelloTs()),s.setMessage("last wshello time:".concat(l," diff:").concat(h,"ms")).end()),!1)}}]),Qv),Rp=[{cmd:fe.GET_GRP_PROFILE,interval:1,count:8},{cmd:fe.UPDATE_GRP_PROFILE,interval:1,count:8},{cmd:fe.GET_AVCHATROOM_MBR_LIST,interval:3,count:1},{cmd:fe.GET_GRP_PENDENCY,interval:1,count:15},{cmd:fe.GET_TOPIC_LIST,interval:1,count:10},{cmd:fe.SET_GRP_ATTR,interval:5,count:10},{cmd:fe.MODIFY_GRP_ATTR,interval:5,count:10},{cmd:fe.DEL_GRP_ATTR,interval:5,count:10},{cmd:fe.CLEAR_GRP_ATTR,interval:5,count:10},{cmd:fe.GET_GRP_ATTR,interval:5,count:20},{cmd:fe.UPDATE_GRP_COUNTER,interval:5,count:20},{cmd:fe.GET_GRP_COUNTER,interval:5,count:20},{cmd:fe.SET_ALL_MSG_READ,interval:1,count:1},{cmd:fe.GET_USER_STATUS,interval:5,count:20},{cmd:fe.SUB_USER_STATUS,interval:5,count:20},{cmd:fe.UNSUB_USER_STATUS,interval:5,count:20},{cmd:fe.MSG_CLOUD_SEARCH,interval:1,count:2},{cmd:fe.CHECK_FOLLOW_TYPE,interval:5,count:20}],wp=new Map,Dp=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],ja=0,yb=Dp.length;ja<yb;ja++)wp.set(ja,Dp[ja]);function Qv(n){u(this,Qv),this._sessionM=n,this._n="DownlinkHandler",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._c2cMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._groupMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupTips",this._groupTipsHandler.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._C2CNotifyMessageArrayHandler.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._C2CReadReceiptArrayHandler.bind(this)),this._eventHandlerMap.set("profileModify",this._profileHandler.bind(this)),this._eventHandlerMap.set("friendListMod",this._relationChainHandler.bind(this)),this._eventHandlerMap.set("recentContactMod",this._recentContactHandler.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._allMessageReadHandler.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._c2cMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._groupMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("userStatusList",this._userStatusListHandler.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._messageExtensionNotifyHandler.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._messageReactionNotifyListHandler.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._messageReactionNotifyHandler.bind(this)),this._eventHandlerMap.set("follow",this._followInfoHandler.bind(this)),this._keys=L(this._eventHandlerMap.keys())}function pa(n){u(this,pa),this._n="ProtocolHandler",this._sessionM=n,this._configMap=new Map,this._fillConfigMap()}function vh(n){var s,l;return u(this,vh),(n=fb.call(this,n))._n="ChannelModule",n._socketHandler=new mb(N(n)),n._probing=!1,n._isAppShowing=!0,n._previousState=O.NET_STATE_CONNECTED,Ie&&typeof xe.onAppShow=="function"&&typeof xe.onAppHide=="function"&&(s=n._onAppHide.bind(N(n)),l=n._onAppShow.bind(N(n)),typeof xe.offAppHide=="function"&&xe.offAppHide(s),typeof xe.offAppShow=="function"&&xe.offAppShow(l),xe.onAppHide(s),xe.onAppShow(l)),n._timerForNotLoggedIn=-1,n._timerForNotLoggedIn=setInterval(n.onCheckTimer.bind(N(n)),1e3),n._fatalErrorFlag=!1,n._disconnectedTS=0,n._lastDiagnoseTS=0,n}function Zv(n){u(this,Zv),this._chM=n,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=Vl,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=dn(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._currentSite=ee,this._setWebsocketHost(),this._initConnection()}function e_(n){u(this,e_);var s,l,h=(this._handler=n).getURL();this._socket=null,this._workerSocket=null,this._id=dn(),this._handler.getIsWorkerEnabled()?(s=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"})),this._workerSocket=new Worker(s),(l=this)._workerSocket.onmessage=function(v){var P=v.data,I=P.callback,k=P.e,P=P.extensions;I==="onOpen"?l._onOpen(P):I==="onClose"?l._onClose(k):I==="onError"?l._onError(k):I==="onMessage"&&l._onMessage(v.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:h})):Ie?Ve?(xe.connectSocket({url:h,header:{"content-type":"application/json"}}),xe.onSocketClose(this._onClose.bind(this)),xe.onSocketOpen(this._onOpen.bind(this)),xe.onSocketMessage(this._onMessage.bind(this)),xe.onSocketError(this._onError.bind(this))):(this._socket=xe.connectSocket({url:h,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):Ae&&(this._socket=new WebSocket(h),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this)),this._canIUseBinaryFrame=n.canIUseBinaryFrame()}function Op(n){for(var s,l,h=n,v="",I=0,k=(h=n.length%8!=0?"0".repeat(8-n.length%8)+n:h).length;I<k;I+=8)s=parseInt(h.slice(I,I+4),2),l=parseInt(h.slice(I+4,I+8),2),v+=wp.get(s)+wp.get(l);return v}function Np(n){if(n<0||53<n)return NaN;var s=0|1073741824*Math.random();return 30<n?s+1073741824*(0|Math.random()*(1<<n-30)):s>>>30-n}function sM(n,s){for(var l=n.toString(16),h=s-l.length,v="0";0<h;h>>>=1,v+=v)1&h&&(l=v+l);return l}_(su,Uo),Mb=D(su),p(su,[{key:"_init",value:function(){this._updateCommandFrequencyLimitMap(Rp)}},{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("cmd_frequency_limit");Qe(n)||(n=JSON.parse(n),this._updateCommandFrequencyLimitMap(n))}},{key:"_updateCommandFrequencyLimitMap",value:function(n){var s=this;n.forEach(function(l){s._commandFrequencyLimitMap.set(l.cmd,{interval:l.interval,count:l.count})})}},{key:"updateProtocolConfig",value:function(){this._protocolHandler.update()}},{key:"req",value:function(h){q.d("".concat(this._n,".req options:"),h);var s=h.proto,l=h.tjgID;if(!this._protocolHandler.has(s))return q.w("".concat(this._n,".req unknown proto:").concat(s)),Re({code:Be.CANNOT_FIND_PROTOCOL});var h=this.getProtocolData(h),v=h.head.servcmd;if(this._isFrequencyOverLimit(v))return Re({code:I=Be.OVER_FREQUENCY_LIMIT,message:this.getErrorMessage(I,this._getCmd(v))});if(this._isServerOverload(v))return Re({code:I=Be.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrorMessage(I,this._getCmd(v))});Ct(l)||(h.head.tjgID=l);var I=this.get(21);return Xv.includes(s)?I.simplySend(h):I.send(h)}},{key:"getKeyMap",value:function(n){return this._protocolHandler.getKeyMap(n)}},{key:"genCommonHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:oe,websdkversion:ie,a2:n.getA2Key()||void 0,tinyid:n.getTinyID()||void 0,status_instid:n.getStatusInstanceID(),sdkappid:n.getSDKAppID(),contenttype:n.getContentType(),reqtime:0,identifier:n.getA2Key()?void 0:n.getUserID(),usersig:n.getA2Key()?void 0:n.getUserSig(),sdkability:192371,sdkability_ext:Op(""),cappid:n.getApplicationID(),tjgID:""}}},{key:"genCosSpecifiedHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:oe,websdkversion:ie,sdkappid:n.getSDKAppID(),contenttype:n.getContentType(),reqtime:0,identifier:n.getUserID(),usersig:n.getUserSig(),status_instid:n.getStatusInstanceID(),sdkability:192371,sdkability_ext:Op(""),cappid:n.getApplicationID()}}},{key:"genSSOReportHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:oe,websdkversion:ie,sdkappid:n.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:n.getStatusInstanceID(),sdkability:192371,sdkability_ext:Op(""),cappid:n.getApplicationID()}}},{key:"getProtocolData",value:function(n){return this._protocolHandler.getProtocolData(n)}},{key:"trans",value:function(s){var l=s.servcmd,s=s.data,l={head:i(i({},this.genCommonHead()),{},{servcmd:l}),body:s};return this.get(21).send(l)}},{key:"sendComboMessage",value:function(s){var l=s.servcmd,s=s.data,l={head:i(i({},this.genCommonHead()),{},{servcmd:l}),body:s};return this.get(21).send(l)}},{key:"onErrorCodeNotZero",value:function(n){var s,l=n.errorCode;l===Be.HELLO_ANSWER_KICKED_OUT&&(s=n.kickType,n=(n=n.newInstanceInfo)===void 0?{}:n,s===1?this.onMultipleAccountKickedOut(n):s===2?this.onMultipleDeviceKickedOut(n):s===3&&this.onRestApiKickedOut(n)),l!==Be.MSG_A2KEY_EXPIRED&&l!==Be.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.get(21).reConnect())}},{key:"onMessage",value:function(n){var l=n.body,s=l.needAck,l=l.sessionData;(s===void 0?0:s)===1&&this._sendACK(l),this._messageDispatcher.onMessage(n)}},{key:"onReconnected",value:function(n){this._incrementalPullContactFlag=n<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){q.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){q.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var n,s,l,h=this,v="".concat(this._n,"._reLogin");this.isLoggedIn()&&(n=0,(s=this.get(1).getPushModule())&&(n=s.getUniAppPlatform()),l=new it("reLogin"),this.req({proto:fe.LOGIN,data:{isWebUniapp:n}}).then(function(k){var k=k.data,P=k.instanceID,k=k.customStatus,G=h.get(12),Y=Ul(k),P=(G.setStatusInstanceID(P),"instanceID:".concat(P," customStatus:").concat(Y)),P=(l.setMessage(P).end(!0),q.l("".concat(v," ok. ").concat(P)),G.getCustomStatus()!==Y&&h.get(4).onUserStatusUpdated({dataList:[{to:h.getMyUserID(),statusType:O.USER_STATUS_ONLINE,customStatus:k}]}),h.get(21).diagnose(),h.get(11).syncConversationList(h._incrementalPullContactFlag).then(function(){q.l("".concat(v,", sync conversation list ok.")),h.get(25).start()}),h.get(7)),G=(P&&P.updateLocalMainSequenceOnReconnected(),h.get(10)),Y=(G.resetGetTopicTime(),G.getTopicListOnReconnected(),h.get(35));Y&&Y.clearCacheOnReconnected()}))}},{key:"onMultipleAccountKickedOut",value:function(n){this.get(1).onMultipleAccountKickedOut(n)}},{key:"onMultipleDeviceKickedOut",value:function(n){this.get(1).onMultipleDeviceKickedOut(n)}},{key:"_onUserSigExpired",value:function(){this.get(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(n){this.get(1).onRestApiKickedOut(n)}},{key:"_sendACK",value:function(n){this.req({proto:fe.MSG_PUSH_ACK,data:{sessionData:n}})}},{key:"_isFrequencyOverLimit",value:function(n){if(n=n.split(".")[1],!this._commandFrequencyLimitMap.has(n))return!1;if(!this._commandRequestInfoMap.has(n))return this._commandRequestInfoMap.set(n,{startTime:Date.now(),requestCount:1}),!1;var l=this._commandFrequencyLimitMap.get(n),s=l.count,l=l.interval,v=this._commandRequestInfoMap.get(n),h=v.startTime,v=v.requestCount;return Date.now()-h>1e3*l?(this._commandRequestInfoMap.set(n,{startTime:Date.now(),requestCount:1}),!1):(this._commandRequestInfoMap.set(n,{startTime:h,requestCount:v+=1}),s<v)}},{key:"_isServerOverload",value:function(n){if(!this._serverOverloadInfoMap.has(n))return!1;var l=this._serverOverloadInfoMap.get(n),s=l.overloadTime,l=l.waitingTime;return Date.now()-s<=1e3*l||(this._serverOverloadInfoMap.delete(n),!1)}},{key:"_getCmd",value:function(n){var s="";if(!n.includes("."))return s;var l,h=n.split(".")[1];for(l in fe)if(fe[l]===h){s=l;break}return s}},{key:"onPushedServerOverload",value:function(l){var s=l.overloadCommand,l=l.waitingTime;this._serverOverloadInfoMap.set(s,{overloadTime:Date.now(),waitingTime:l}),q.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(l,"s cmd:").concat(this._getCmd(s)))}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._updateCommandFrequencyLimitMap(Rp),this._commandRequestInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]);var Ib,Zc,t_,bb,Cb,_h,Sb,Tb,Eb,ga,Mb,aM=su,kb=(_(ql,Uo),ga=D(ql),p(ql,[{key:"getCloudConfig",value:function(n){return Qe(n)?this._cloudConfig:this._cloudConfig.has(n)?this._cloudConfig.get(n):void 0}},{key:"getServerConfig",value:function(n){var s={code:0,data:""};return!Qe(n)&&this._cloudConfig.has(n)&&(s.data=this._cloudConfig.get(n)),Promise.resolve(s)}},{key:"_canFetchConfig",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var n,s=this,l=this._canFetchConfig();q.l("".concat(this._n,".fetchConfig canFetchConfig:").concat(l)),l&&(n=new it("fetchCloudControlConfig"),l=this.get(12).getSDKAppID(),this._isFetching=!0,this.req({proto:fe.FETCH_CLOUD_CTRL_CONFIG,data:{SDKAppID:l,version:this._version}}).then(function(h){s._isFetching=!1,n.setMessage("version:".concat(s._version," newVersion:").concat(h.data.version," config:").concat(h.data.cloudControlConfig)).end(),q.l("".concat(s._n,".fetchConfig ok")),s._parseCloudControlConfig(h.data)}).catch(function(h){s._isFetching=!1,n.setError(h).end(),q.l("".concat(s._n,".fetchConfig failed. error:"),h),s._setExpiredTimeOnResponseError(12e4)}))}},{key:"onPushedCloudControlConfig",value:function(n){q.l("".concat(this._n,".onPushedCloudControlConfig")),new it("pushedCloudControlConfig").setMessage("newVersion:".concat(n.version," config:").concat(n.cloudControlConfig)).end(),this._parseCloudControlConfig(n)}},{key:"onCheckTimer",value:function(n){this._canFetchConfig()&&this.fetchConfig()}},{key:"_parseCloudControlConfig",value:function(n){var s=this,l="".concat(this._n,"._parseCloudControlConfig"),h=n.errorCode,v=n.errorMessage,I=n.cloudControlConfig,k=n.version,P=n.expiredTime;if(h===0){if(this._version!==k){var G=null;try{G=JSON.parse(I)}catch{this.isPrivateNetWork()||q.e("".concat(l," JSON parse error. cloudControlConfig:"),I)}G&&(this._cloudConfig.clear(),Object.keys(G).forEach(function(Y){s._cloudConfig.set(Y,G[Y])}),this._version=k,this.emitInnerEvent(So.CLOUD_CONFIG_UPDATED))}this._expiredTime=Date.now()+1e3*P}else Qe(h)?(q.l("".concat(l," failed. Invalid message format:"),n),this._setExpiredTimeOnResponseError(36e5)):(q.e("".concat(l," errorCode:").concat(h," errorMessage:").concat(v)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(n){this._expiredTime=Date.now()+n}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),ql),lM=(_(Hl,Uo),Eb=D(Hl),p(Hl,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var n,s,l,h,v=this,I=this._getLocalConversationList().filter(function(G){return G.type===O.CONV_GROUP&&G.groupProfile.type!==O.GRP_AVCHATROOM}),k=this.get(11),P=[];I.forEach(function(te){var Y=te.conversationID,te=te.lastMessage;n=Y.replace(O.CONV_GROUP,""),s=k.getLocalLastMessage(Y),te&&te.lastSequence!==0&&s?(l=te.lastSequence,s=s.sequence,h=l-s,0<s&&1<=h&&h<300?v._recoverGroupMessage({groupID:n,localLastMessageSequence:s,remoteLastMessageSequence:l}):P.push(n)):P.push(n)}),this._getGroupNotify(P)}},{key:"_recoverC2CChat",value:function(){var n,s,l,h=this,v=this._getLocalConversationList().filter(function(P){return P.type===O.CONV_C2C}),I=this.get(11),k=[Promise.resolve()];v.forEach(function(Y){var G=Y.conversationID,Y=Y.lastMessage;n=I.getLocalLastMessage(G),Y&&Y.lastTime!==0&&n&&(s=Y.lastTime,n=n.time,l=s-n,0<n&&1<=l&&l<=600&&k.push(h._recoverC2CMessage({conversationID:G,localLastMessageTime:n,remoteLastMessageTime:s})))}),Promise.all(k).then(function(){q.l("".concat(h._n,"._recoverC2CChat all promise fulfilled, start to sync unread messages")),h.get(19).startSyncOnReconnected()})}},{key:"_getLocalConversationList",value:function(){return this.get(11).getLocalConversationList()}},{key:"_recoverGroupMessage",value:function(n){var s=this,l="".concat(this._n,"._recoverGroupMessage"),h=(q.l("".concat(l," options:"),n),n.groupID),v=n.localLastMessageSequence,I=n.remoteLastMessageSequence;this._getGroupRoamingMessage({groupID:h,sequence:v}).then(function(P){var P=P.data,G=P.complete,Y=P.messageList;if(!Qe(Y)){var P=Y[0].sequence,te=Y.map(function(ut){return ut.sequence}),te="groupID:".concat(h," pkgLastSequence:").concat(P," remoteLastSequence:").concat(I," complete:").concat(G," sequenceList:").concat(te),pe=(q.l("".concat(l," ").concat(te)),P<I&&G!==2&&s._recoverGroupMessage({groupID:h,localLastMessageSequence:P,remoteLastMessageSequence:I}),new it("recoverMessage").setMessage(te).end(),s.get(7));1<Y.length&&Y.sort(function(ut,mt){return ut.sequence-mt.sequence});for(var ye=0;ye<Y.length;ye++){var ve=Y[ye];ve.from!==O.CONV_SYSTEM?pe.onNewGroupMessage({dataList:[ve],isInstantMessage:!1,updateUnreadCount:!1}):pe.onNewGroupTips({event:ve.event,dataList:[ve]})}s._getGroupNotify([h])}})}},{key:"_genMultiGroupIDList",value:function(n,s){var l=s&&1<s?s:1,h=n.length,v=[];if(0<h)for(var I=0;I<h;I+=l)v.push(n.slice(I,I+l));return v}},{key:"_getGroupNotify",value:function(n){var s=this._genMultiGroupIDList(n,10);if(0<s.length)for(var l=this.get(7),h=0,v=s.length;h<v;h++)l.getGroupNotify(s[h])}},{key:"_getGroupRoamingMessage",value:function(l){var s=l.groupID,l=l.sequence;return this.req({proto:fe.GET_GRP_ROAMING_MSG,data:{groupID:s,count:this.PULL_LIMIT_COUNT,sequence:l+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMessage",value:function(n){var s=this,l="".concat(this._n,"._recoverC2CMessage"),h=(q.l("".concat(l," options:"),n),n.conversationID),v=n.localLastMessageTime,I=n.remoteLastMessageTime;return this._getC2CRoamingMessage({conversationID:h,time:v}).then(function(G){var G=G.data,P=G.complete,G=G.messageList;if(!Qe(G)){var Y=G.length,Y=(s.get(6).onNewC2CMessage({dataList:G,isInstantMessage:!0}),G[Y-1].time),G=G.map(function(ye){return ye.random}),te=h.replace(O.CONV_C2C,""),te="peerAccount:".concat(te," pkgLastTime:").concat(Y," remoteLastTime:").concat(I," complete:").concat(P," randomList:").concat(G);if(q.l("".concat(l," ").concat(te)),new it("recoverMessage").setMessage(te).end(),Y<I&&P!==1)return s._recoverC2CMessage({conversationID:h,localLastMessageTime:Y,remoteLastMessageTime:I})}})}},{key:"_getC2CRoamingMessage",value:function(l){var s=l.conversationID,l=l.time;return this.req({proto:fe.GET_C2C_ROAMING_MSG,data:{peerAccount:s.replace(O.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:l,direction:1}})}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),Hl),cM=(p(Up,[{key:"addMessageDelay",value:function(n){n=xt()-n,0<=n&&this._e2eDelayArray.push(n)}},{key:"_calcAvg",value:function(n,s){if(s===0)return 0;var l=0;return n.forEach(function(h){l+=h}),Li(l/s,1)}},{key:"_calcCountWithLimit",value:function(n){var s=n.e2eDelayArray,l=n.min,h=n.max;return s.filter(function(v){return l<=v&&v<h}).length}},{key:"_calcPercent",value:function(n,s){return n=Li(n/s*100,2),n=100<n?100:n}},{key:"_checkE2EDelayException",value:function(n,s){var l,h,v,I=n.filter(function(k){return s<k});0<I.length&&(l=I.length,h=Math.min.apply(Math,L(I)),v=Math.max.apply(Math,L(I)),I=this._calcAvg(I,l),50<(n=Li(l/n.length*100,2))&&new it("messageE2EDelayException").setMessage("count:".concat(l," min:").concat(h," max:").concat(v," avg:").concat(I," percent:").concat(n)).setLevel("warning").end())}},{key:"getStatResult",value:function(){var n=this._e2eDelayArray.length;if(n===0)return null;var s=L(this._e2eDelayArray),l=this._calcCountWithLimit({e2eDelayArray:s,min:0,max:1}),h=this._calcCountWithLimit({e2eDelayArray:s,min:1,max:3}),v=this._calcPercent(l,n),I=this._calcPercent(h,n),k=this._calcAvg(s,n);return this._checkE2EDelayException(s,3),s.length=0,this.reset(),{totalCount:n,countLessThan1Second:l,percentOfCountLessThan1Second:v,countLessThan3Second:h,percentOfCountLessThan3Second:I,avgDelay:k}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),Up),Ab=(p($l,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(n){this._rttArray.push(n)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(n){return n.length}},{key:"_calcSuccessRateOfRequest",value:function(n,s){return s===0?0:(n=Li(n/s*100,2),n=100<n?100:n)}},{key:"_calcAvg",value:function(n,s){if(s===0)return 0;var l=0;return n.forEach(function(h){l+=h}),parseInt(l/s)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,L(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,L(this._rttArray))}},{key:"getStatResult",value:function(){var n=this._calcTotalCount(),h=L(this._rttArray);if(n===0)return null;var s=this._calcRTTCount(h),l=this._calcSuccessRateOfRequest(s,n),h=this._calcAvg(h,s);return q.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(h)),this.reset(),{totalCount:n,rttCount:s,successRateOfRequest:l,avgRTT:h}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),$l),uM=(p(Mh,[{key:"initMap",value:function(n){var s=this;n.forEach(function(l){s._map.set(l,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})})}},{key:"addTotalCount",value:function(n){return!(Qe(n)||!this._map.has(n)||(this._map.get(n).totalCount+=1,0))}},{key:"addSuccessCount",value:function(n){return!(Qe(n)||!this._map.has(n)||(this._map.get(n).successCount+=1,0))}},{key:"addFailedCountOfUserSide",value:function(n){return!(Qe(n)||!this._map.has(n)||(this._map.get(n).failedCountOfUserSide+=1,0))}},{key:"addCost",value:function(n,s){return!(Qe(n)||!this._map.has(n)||(this._map.get(n).costArray.push(s),0))}},{key:"addFileSize",value:function(n,s){return!(Qe(n)||!this._map.has(n)||(this._map.get(n).fileSizeArray.push(s),0))}},{key:"_calcSuccessRateOfBusiness",value:function(n){return Qe(n)||!this._map.has(n)?-1:(n=this._map.get(n),n=Li(n.successCount/n.totalCount*100,2),n=100<n?100:n)}},{key:"_calcSuccessRateOfPlatform",value:function(l){if(Qe(l)||!this._map.has(l))return-1;var s=this._map.get(l),l=this._calcSuccessCountOfPlatform(l)/s.totalCount*100;return l=100<(l=Li(l,2))?100:l}},{key:"_calcTotalCount",value:function(n){return Qe(n)||!this._map.has(n)?-1:this._map.get(n).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(n){return Qe(n)||!this._map.has(n)?-1:this._map.get(n).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(n){return Qe(n)||!this._map.has(n)?-1:(n=this._map.get(n),n.successCount+n.failedCountOfUserSide)}},{key:"_calcAvg",value:function(n){return Qe(n)||!this._map.has(n)?-1:n===kr?this._calcAvgSpeed(n):this._calcAvgCost(n)}},{key:"_calcAvgCost",value:function(n){var s=this._map.get(n).costArray.length;if(s===0)return 0;var l=0;return this._map.get(n).costArray.forEach(function(h){l+=h}),parseInt(l/s)}},{key:"_calcAvgSpeed",value:function(n){var s=0,l=0;return this._map.get(n).costArray.forEach(function(h){s+=h}),this._map.get(n).fileSizeArray.forEach(function(h){l+=h}),parseInt(1e3*l/s)}},{key:"getStatResult",value:function(n){var s=this._calcTotalCount(n);if(s===0)return null;var l=this._calcSuccessCountOfBusiness(n),h=this._calcSuccessRateOfBusiness(n),v=this._calcSuccessCountOfPlatform(n),I=this._calcSuccessRateOfPlatform(n),k=this._calcAvg(n);return this.reset(n),{totalCount:s,successCountOfBusiness:l,successRateOfBusiness:h,successCountOfPlatform:v,successRateOfPlatform:I,avgValue:k}}},{key:"reset",value:function(n){Qe(n)?this._map.clear():this._map.set(n,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),Mh),Rb=(p(p_,[{key:"initMap",value:function(n){var s=this;n.forEach(function(l){s._lastMap.set(l,new Map),s._currentMap.set(l,new Map)})}},{key:"addMessageSequence",value:function(n){var s=n.key,v=n.message;if(Qe(s)||!this._lastMap.has(s)||!this._currentMap.has(s))return!1;var l,h,I=v.conversationID,v=v.sequence,I=I.replace(O.CONV_GROUP,"");return this._lastMap.get(s).size!==0&&this._lastMap.get(s).has(I)?(h=(l=this._lastMap.get(s).get(I)).length-1,v>l[0]&&v<l[h]?(l.push(v),l.sort(),this._lastMap.get(s).set(I,l)):this._addCurrentMap(n)):this._addCurrentMap(n),!0}},{key:"_addCurrentMap",value:function(l){var s=l.key,l=l.message,h=l.conversationID,l=l.sequence,h=h.replace(O.CONV_GROUP,"");this._currentMap.get(s).has(h)||this._currentMap.get(s).set(h,[]),this._currentMap.get(s).get(h).push(l)}},{key:"_copyData",value:function(n){if(!Qe(n)){this._lastMap.set(n,new Map);var s,l=this._lastMap.get(n),h=Z(this._currentMap.get(n));try{for(h.s();!(s=h.n()).done;){var v=x(s.value,2),I=v[0],k=v[1];l.set(I,k)}}catch(P){h.e(P)}finally{h.f()}l=null,this._currentMap.set(n,new Map)}}},{key:"getStatResult",value:function(n){if(Qe(this._currentMap.get(n))||Qe(this._lastMap.get(n)))return null;if(this._lastMap.get(n).size===0)return this._copyData(n),null;var s=0,l=0;if(this._lastMap.get(n).forEach(function(P,I){var P=L(P.values()),k=P.length,P=P[k-1]-P[0]+1;s+=P,l+=k}),s===0)return null;var h=Li(l/s*100,2);return 100<h&&(h=100),this._copyData(n),{totalCount:s,successCountOfMessageReceived:l,successRateOfMessageReceived:h}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),p_),n_=(_(iu,Uo),Tb=D(iu),p(iu,[{key:"_onLoginSuccess",value:function(){var n=this,s=(this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems),this.get(13)),l=s.getItem(this.TAG,!1);!Ct(l)&&ko(l.forEach)&&(q.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(l.length)),l.forEach(function(h){n._statInfoArr.push(h)}),s.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("q_rpt_interval"),s=this.getCloudConfig("q_rpt_sdkappid_bl"),l=this.getCloudConfig("q_rpt_tinyid_wl");Qe(n)||(this.REPORT_INTERVAL=Number(n)),Qe(s)||(this.REPORT_SDKAPPID_BLACKLIST=s.split(",").map(function(h){return Number(h)})),Qe(l)||(this.REPORT_TINYID_WHITELIST=l.split(","))}},{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&n%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(n){this._avgRTT.addRTT(n)}},{key:"addMessageDelay",value:function(n){this._avgE2EDelay.addMessageDelay(n)}},{key:"addTotalCount",value:function(n){this._rateMessageSent.addTotalCount(n)||q.w("".concat(this._n,".addTotalCount invalid key:"),n)}},{key:"addSuccessCount",value:function(n){this._rateMessageSent.addSuccessCount(n)||q.w("".concat(this._n,".addSuccessCount invalid key:"),n)}},{key:"addFailedCountOfUserSide",value:function(n){this._rateMessageSent.addFailedCountOfUserSide(n)||q.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),n)}},{key:"addCost",value:function(n,s){this._rateMessageSent.addCost(n,s)||q.w("".concat(this._n,".addCost invalid key or cost:"),n,s)}},{key:"addFileSize",value:function(n,s){this._rateMessageSent.addFileSize(n,s)||q.w("".concat(this._n,".addFileSize invalid key or size:"),n,s)}},{key:"addMessageSequence",value:function(n){this._rateMessageReceived.addMessageSequence(n)||q.w("".concat(this._n,".addMessageSequence invalid key:"),n.key)}},{key:"_getQualityItem",value:function(n){var s={},l=FI[this.get(15).getNetworkType()],l=(Qe(l)&&(l=8),{qualityType:Kc[n],timestamp:oo(),networkType:l,extension:""});switch(n){case qd:s=this._avgRTT.getStatResult();break;case Kd:s=this._avgE2EDelay.getStatResult();break;case ua:case Ds:case da:case Ha:case kr:s=this._rateMessageSent.getStatResult(n);break;case Hc:case qc:case zd:s=this._rateMessageReceived.getStatResult(n)}return s===null?null:i(i({},l),s)}},{key:"_report",value:function(I){var s=this,l=[],h=null,I=(Qe(I)?this._qualityItems.forEach(function(k){(h=s._getQualityItem(k))!==null&&(h.reportIndex=s.reportIndex,h.wholePeriod=s.wholePeriod,l.push(h))}):(h=this._getQualityItem(I))!==null&&(h.reportIndex=this.reportIndex,h.wholePeriod=this.wholePeriod,l.push(h)),q.d("".concat(this._n,"._report"),l),0<this._statInfoArr.length&&(l=l.concat(this._statInfoArr),this._statInfoArr=[]),this.get(12)),v=I.getSDKAppID(),I=I.getTinyID();0<(l=lp(this.REPORT_SDKAPPID_BLACKLIST,v)&&!DI(this.REPORT_TINYID_WHITELIST,I)?[]:l).length&&this._doReport(l)}},{key:"_doReport",value:function(n){var s=this,l={header:ZI(this),quality:n};this.req({proto:fe.SSO_STAT,data:i({},l)}).then(function(){s.reportIndex++,s.wholePeriod=!1}).catch(function(h){q.w("".concat(s._n,"._doReport failed. error:"),h),s._statInfoArr=s._statInfoArr.concat(n),s._flushAtOnce()})}},{key:"_flushAtOnce",value:function(){var n=this.get(13),s=n.getItem(this.TAG,!1),l=this._statInfoArr,h="".concat(this._n,"._flushAtOnce");Ct(s)?(q.l("".concat(h," count:").concat(l.length)),n.setItem(this.TAG,l,!0,!1)):(10<(l=l.concat(s)).length&&(l=l.slice(0,10)),q.l("".concat(h," count:").concat(l.length)),n.setItem(this.TAG,l,!0,!1)),this._statInfoArr=[]}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),iu),wb=p(function n(s){u(this,n),Ct(s)||(this.userID=s.userID||"",this.nick=s.nick||"",this.avatar=s.avatar||"",this.time=s.time||0,this.source=s.source||"",this.wording=s.wording||"",this.type=s.type||"")}),dM=(p(f_,[{key:"getLocalFriendApplicationList",value:function(){return{friendApplicationList:L(this._friendApplicationMap.values()),unreadCount:this._unreadCount}}},{key:"_onFriendApplicationListUpdated",value:function(){this._snsM.emitOuterEvent($.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:L(this._friendApplicationMap.values()),unreadCount:this._unreadCount})}},{key:"onFriendApplicationRead",value:function(){this._unreadCount=0,this._onFriendApplicationListUpdated()}},{key:"onFriendApplicationAdded",value:function(n,s){var l,h,v=this;Ct(n)||(l="",l=s===this._snsM.getMyUserID()?O.SNS_APPLICATION_SENT_BY_ME:O.SNS_APPLICATION_SENT_TO_ME,h=!1,n.forEach(function(I){var k="".concat(I.userID,"_").concat(l);l!==O.SNS_APPLICATION_SENT_TO_ME||v._friendApplicationMap.has(k)||(v._unreadCount+=1),v._friendApplicationMap.set(k,new wb(i(i({},I),{},{type:l}))),h=!0}),h&&this._onFriendApplicationListUpdated())}},{key:"onFriendApplicationDeleted",value:function(n){Ct(n)||(this._startTime=0,this._currentSequence=0,this.getFriendApplicationList())}},{key:"getFriendApplicationList",value:function(){var n=this,s="".concat(this._n,".").concat("getFriendApplicationList"),l=new it("getFriendApplicationList");return this._snsM.req({proto:fe.GET_FD_APPLICATION_LIST,data:{applicationType:O.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsM.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSequence}}).then(function(P){var P=P.data,v=P.resultList,I=P.unreadCount,k=P.startTime,P=P.currentSequence,G=(n._startTime=k,n._currentSequence=P,n._unreadCount=I,Rt(v)?v.length:0),G="applicationCount:".concat(G," unreadCount:").concat(I," startTime:").concat(k," currentSequence:").concat(P);l.setMessage(G).end(),q.i("".concat(s," ok. ").concat(G)),n._friendApplicationMap.clear(),Rt(v)&&v.forEach(function(ye){var te=ye.userID,pe=ye.type,ye=new wb(ye);n._friendApplicationMap.set("".concat(te,"_").concat(pe),ye)}),n._onFriendApplicationListUpdated()}).catch(function(h){return l.setError(h).end(),q.w("".concat(s," failed. error:"),h),Re(h)})}},{key:"deleteFriendApplication",value:function(n){var s="".concat(this._n,".").concat("deleteFriendApplication"),l=n.userID,h=n.type;if(h&&(h===O.SNS_APPLICATION_SENT_BY_ME||h===O.SNS_APPLICATION_SENT_TO_ME)||(h=O.SNS_APPLICATION_SENT_TO_ME),!this._friendApplicationMap.has("".concat(l,"_").concat(h)))return Re({code:Be.FRIEND_APPLICATION_NOT_EXIST});var v=new it("deleteFriendApplication");return v.setMessage("userID:".concat(l," type:").concat(h)),this._snsM.req({proto:fe.DEL_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),userIDList:[l],type:h}}).then(function(k){var k=k.data.resultList,Y=k[0],P=Y.to,G=Y.resultCode,Y=Y.resultInfo;return v.setMoreMessage("resultList:".concat(JSON.stringify(k))).end(),q.i("".concat(s," ok. userID:").concat(l," type:").concat(h)),G===0?Ut():Re({userID:P,code:G,message:Y})}).catch(function(I){return v.setError(I).end(),q.w("".concat(s," failed. error:"),I),Re(I)})}},{key:"acceptFriendApplication",value:function(n){var s="".concat(this._n,".").concat("acceptFriendApplication"),l=n.userID,h=n.remark,v=n.tag,I=n.type,k=(I&&(I===O.SNS_APPLICATION_AGREE||I===O.SNS_APPLICATION_AGREE_AND_ADD)||(I=O.SNS_APPLICATION_AGREE_AND_ADD),new it("acceptFriendApplication"));return k.setMessage("userID:".concat(l," type:").concat(I)),this._snsM.req({proto:fe.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:l,remark:h,tag:v,action:I}]}}).then(function(Y){k.end();var Y=Y.data.resultList[0],G=Y.resultCode,Y=Y.resultInfo;if(G!==0)return Re({code:G,message:Y});q.i("".concat(s," ok. userID:").concat(l," type:").concat(I))}).catch(function(P){return k.setError(P).end(),q.w("".concat(s," failed. error:"),P),Re(P)})}},{key:"refuseFriendApplication",value:function(n){var s="".concat(this._n,".").concat("refuseFriendApplication"),l=n.userID,h=new it("refuseFriendApplication");return h.setMessage("userID:".concat(l)),this._snsM.req({proto:fe.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:l,action:"Response_Action_Reject"}]}}).then(function(k){h.end();var k=k.data.resultList[0],I=k.resultCode,k=k.resultInfo;if(I!==0)return Re({code:I,message:k});q.i("".concat(s," ok. userID:").concat(l))}).catch(function(v){return h.setError(v).end(),q.w("".concat(s," failed. error:"),v),Re(v)})}},{key:"_onFriendApplicationProcessed",value:function(n){var s,l=this;n.length!==0&&(s=!1,n.forEach(function(h){h="".concat(h.to,"_").concat(O.SNS_APPLICATION_SENT_TO_ME),l._friendApplicationMap.has(h)&&(l._friendApplicationMap.delete(h),--l._unreadCount,s=!0)}),this._unreadCount<0&&(this._unreadCount=0),s&&this._onFriendApplicationListUpdated())}},{key:"setFriendApplicationRead",value:function(){var n=this,s="".concat(this._n,".").concat("setFriendApplicationRead"),l=new it("setFriendApplicationRead");return this._snsM.req({proto:fe.REPORT_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),latestTimeStamp:Li(oo()/1e3,0)}}).then(function(h){l.end(),q.i("".concat(s," ok")),n._unreadCount=0}).catch(function(h){return l.setError(h).end(),q.w("".concat(s," failed. error:"),h),Re(h)})}},{key:"reset",value:function(){this._startIndex=0,this._maxLimited=100,this._currentSequence=0,this._unreadCount=0,this._friendApplicationMap.clear()}}]),f_),Gl=(p(Eh,[{key:"validate",value:function(n){var s,l=!0,h="";if(Ct(n))return{valid:!1,tips:"empty options"};if(n.profileCustomField)for(var v=n.profileCustomField.length,I=null,k=0;k<v;k++){if(I=n.profileCustomField[k],!Sn(I.key)||I.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!Sn(I.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(s in n)if(Object.prototype.hasOwnProperty.call(n,s)){if(s==="profileCustomField")continue;if(Ct(n[s])&&!Sn(n[s])&&!un(n[s])){h="key:"+s+", invalid value:"+n[s],l=!1;continue}switch(s){case"nick":Sn(n[s])||(l=!(h="nick must be a string")),500<an(n[s])&&(h="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(an(n[s])," bytes"),l=!1);break;case"gender":Er(ls,n.gender)||(h="key:gender, invalid value:"+n.gender,l=!1);break;case"birthday":un(n.birthday)||(l=!(h="birthday must be a number"));break;case"location":Sn(n.location)||(l=!(h="location must be a string"));break;case"selfSignature":Sn(n.selfSignature)||(l=!(h="selfSignature must be a string"));break;case"allowType":Er(ks,n.allowType)||(h="key:allowType, invalid value:"+n.allowType,l=!1);break;case"language":un(n.language)||(l=!(h="language must be a number"));break;case"avatar":Sn(n.avatar)||(l=!(h="avatar must be a string"));break;case"messageSettings":n.messageSettings!==0&&n.messageSettings!==1&&(l=!(h="messageSettings must be 0 or 1"));break;case"adminForbidType":Er(Ir,n.adminForbidType)||(h="key:adminForbidType, invalid value:"+n.adminForbidType,l=!1);break;case"level":un(n.level)||(l=!(h="level must be a number"));break;case"role":un(n.role)||(l=!(h="role must be a number"));break;default:h="unknown key:"+s+"  "+n[s],l=!1}}return{valid:l,tips:h}}},{key:"update",value:function(n){var s,l="",h=[];this.friendCustomField.forEach(function(P){h.push(P.key)});for(var v=0,I=n.length;v<I;v++)if(l=n[v].tag,s=n[v].value,-1<l.indexOf("Tag_SNS_Custom"))-1<h.indexOf(l)?this.friendCustomField.forEach(function(P){P.key===l&&(P.value=s)}):this.friendCustomField.push({key:l,value:s});else if(-1<l.indexOf("Tag_Profile_Custom")){var k=!1;this.profile.profileCustomField.forEach(function(P){P.key===l&&(P.value=s,k=!0)}),k||this.profile.profileCustomField.push({key:l,value:s})}else switch(l){case _n.NICK:this.profile.nick=s;break;case _n.GENDER:this.profile.gender=s;break;case _n.BIRTHDAY:this.profile.birthday=s;break;case _n.LOCATION:this.profile.location=s;break;case _n.SELFSIGNATURE:this.profile.selfSignature=s;break;case _n.ALLOWTYPE:this.profile.allowType=s;break;case _n.LANGUAGE:this.profile.language=s;break;case _n.AVATAR:this.profile.avatar=s;break;case _n.MESSAGESETTINGS:this.profile.messageSettings=s;break;case _n.ADMINFORBIDTYPE:this.profile.adminForbidType=s;break;case _n.LEVEL:this.profile.level=s;break;case _n.ROLE:this.profile.role=s;break;case eo.REMARK:this.remark=s;break;case eo.ADDTIME:this.addTime=s;break;case eo.GROUP:this.groupList=JSON.parse(JSON.stringify(s));break;case eo.ADDSOURCE:this.source=s;break;case eo.ADDWORDING:break;default:q.d("snsProfileItem unkown tag->",n[v].tag)}this.timestamp=Date.now(),h.length=0}},{key:"updateProfile",value:function(n){this.profile=JSON.parse(JSON.stringify(n)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(n){this.groupList.indexOf(n)===-1&&(this.groupList.push(n),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(n){n=this.groupList.indexOf(n),-1<n&&(this.groupList.splice(n,1),this.count=this.groupList.length)}}]),Eh),Db=(p(h_,[{key:"getLocalFriendList",value:function(){return L(this._friendMap.values())}},{key:"getFriendRemark",value:function(n){return this._friendMap.has(n)?this._friendMap.get(n).remark:""}},{key:"onFriendProfileModified",value:function(h){var s,l=this,h=h.dataList;Ct(h)||(s=this._snsM.get(11),h.forEach(function(P){var I,k=P.userID,P=P.profileList;l.isMyFriend(k)&&(q.l("".concat(l._n,".onFriendProfileModified. friend account:").concat(k,", profileList:").concat(JSON.stringify(P))),(I=l._friendMap.get(k)).update(P),s.modifyMessageSentByPeer({conversationID:"".concat(O.CONV_C2C).concat(k),latestNick:I.profile.nick,latestAvatar:I.profile.avatar}))}),this._onFriendListUpdated())}},{key:"onFriendAdded",value:function(n){var s=this;n.length!==0&&(q.l("".concat(this._n,".onFriendAdded userIDList:").concat(n)),n.forEach(function(l){s._friendMap.set(l,new Gl(l))}),this.getFriendProfile({userIDList:n}).then(function(l){n.forEach(function(h){var v=s._friendMap.get(h);0<v.groupList.length&&s._snsM.updateWhenFriendAdded({nameList:v.groupList,userID:h})}),s._onFriendListUpdated()}))}},{key:"onFriendDeleted",value:function(n){var s=this;n.length!==0&&(q.l("".concat(this._n,".onFriendDeleted userIDList:").concat(n)),n.forEach(function(l){var h=s._friendMap.get(l);0<h.groupList.length&&s._snsM.updateWhenFriendDeleted({nameList:h.groupList,userID:l}),s._friendMap.delete(l)}),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsM.emitOuterEvent($.FRIEND_LIST_UPDATED),this._snsM.get(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(h){var s=this,l="".concat(this._n,".").concat("getFriendProfile"),h=h.userIDList,v=[],I=[],k=[];if(h.forEach(function(G){var Y;s._friendMap.has(G)?(Y=s._friendMap.get(G),Date.now()-Y.timestamp<s._expirationTime?I.push(Y):k.push(G)):v.push({userID:G,code:Be.NOT_MY_FRIEND,message:s._snsM.getErrorMessage(Be.NOT_MY_FRIEND)})}),k.length===0)return q.i("".concat(l," newUserIDList is empty")),ln({friendList:I,failureUserIDList:v});var P=new it("getFriendProfile");return P.setMessage("userIDList:".concat(k)),q.i("".concat(l," userIDList:").concat(k)),this._snsM.req({proto:fe.GET_FD_PROFILE,data:{fromAccount:this._snsM.getMyUserID(),userIDList:k}}).then(function(G){return P.end(),q.i("".concat(l," ok")),G.data.resultList.forEach(function(Ue){var te,pe=Ue.to,ye=Ue.resultCode,ve=Ue.resultInfo,Ue=Ue.tagValueList;Qe(ye)||ye===0?(s._friendMap.has(pe)?(te=s._friendMap.get(pe)).update(Ue):(te=new Gl(pe,Ue),s._friendMap.set(pe,te)),I.push(te)):v.push({userID:pe,code:ye,message:ve})}),Ut({friendList:I,failureUserIDList:v})}).catch(function(G){return P.setError(G).end(),q.w("".concat(l," failed. error:"),G),Re(G)})}},{key:"isMyFriend",value:function(n){return this._friendMap.has(n)}},{key:"pagingGetFriendList",value:function(){var n=this,s="".concat(this._n,".").concat("getFriendList"),l=new it("getFriendList"),h=Date.now();this._snsM.req({proto:fe.GET_FD_LIST,data:{fromAccount:this._snsM.getMyUserID(),startIndex:this._startIndex,standardSequence:this._standardSequence,customSequence:this._customSequence}}).then(function(Y){var Y=Y.data,te=Y.friendCount,I=Y.resultList,k=Y.nextStartIndex,P=Y.standardSequence,G=Y.customSequence,Y=Y.completeFlag,te=(n._startIndex=k,n._standardSequence=P,n._customSequence=G,"friendCount:".concat(te," nextStartIndex:").concat(k," standardSequence:").concat(P," ")+"customSequence:".concat(G," completeFlag:").concat(Y," cost:").concat(ar(h)));l.setMessage(te).end(),q.i("".concat(s," ok."),te),Ct(I)||I.forEach(function(ve){var ye=ve.to,ve=ve.tagValueList;n._friendMap.set(ye,new Gl(ye,ve))}),Y===0?n.pagingGetFriendList():(n._snsM.emitOuterEvent($.FRIEND_LIST_UPDATED),n._pagingGetFriendProfile())}).catch(function(v){return l.setError(v).end(),q.w("".concat(s," failed. error:"),v),Re(v)})}},{key:"_pagingGetFriendProfile",value:function(){var n=this,s=L(this._friendMap.keys()),l=this._snsM.get(4),h=s.length,v=h<=100?1:Math.ceil(h/100);q.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(h," pageCount:").concat(v));for(var I=0;I<v;I++)l.getUserProfile({userIDList:s.slice(100*I,100*(I+1))}).then(function(k){k.data.forEach(function(P){var G=n._friendMap.get(P.userID);G&&G.updateProfile(P)}),n._onFriendListUpdated()})}},{key:"addFriend",value:function(G){var s=this,l="".concat(this._n,".").concat("addFriend");if(this._friendMap.has(G.to))return Re({code:Be.ALREADY_MY_FRIEND});if(G.wording&&this._snsM.filterProfanity("wording",G)===!1)return Re({code:Be.PROFANITY_FOUND});var h=G.to,v=G.source,I=G.type,k=G.wording,P=G.remark,G=G.groupName,Y=I,te=(Y&&(Y===O.SNS_ADD_TYPE_SINGLE||Y===O.SNS_ADD_TYPE_BOTH)||(Y=O.SNS_ADD_TYPE_BOTH),new it("addFriend"));return te.setMessage("to:".concat(h," source:").concat(v," type:").concat(Y)),this._snsM.req({proto:fe.ADD_FD,data:{fromAccount:this._snsM.getMyUserID(),addFriendItem:[{to:h,source:v,wording:k,remark:P,groupName:G}],type:Y}}).then(function(Ue){var Ue=Ue.data.resultList,Ue=(te.setMoreMessage("resultList:".concat(JSON.stringify(Ue))).end(),Ue[0]),ye=Ue.to,ve=Ue.resultCode,Ue=Ue.resultInfo;return q.i("".concat(l," ok. to:").concat(ye," type:").concat(Y," code:").concat(ve)),Qe(ve)||ve===0?Ut({userID:ye,code:0}):ve===30539?Ut({userID:ye,code:ve,message:s._snsM.getErrorMessage(ve)}):Re({userID:ye,code:ve,message:s._snsM.getErrorMessage(ve)||Ue})}).catch(function(pe){return te.setError(pe).end(),q.w("".concat(l," failed. error:"),pe),Re(pe)})}},{key:"deleteFriend",value:function(h){var s=this,l="".concat(this._n,".").concat("deleteFriend"),P=h.userIDList,h=h.type,v=(1e3<P.length&&(q.w("".concat(l," ").concat(Ol(1e3))),P.length=1e3),[]),I=[],k=[];if(P.forEach(function(Y){s._friendMap.has(Y)?k.push(Y):v.push({userID:Y,code:Be.NOT_MY_FRIEND,message:s._snsM.getErrorMessage(Be.NOT_MY_FRIEND)})}),k.length===0)return ln({successUserIDList:I,failureUserIDList:v});var P=h,G=(P&&(P===O.SNS_DELETE_TYPE_SINGLE||P===O.SNS_DELETE_TYPE_BOTH)||(P=O.SNS_DELETE_TYPE_BOTH),new it("deleteFriend"));return G.setMessage("userIDList:".concat(k," type:").concat(P)),this._snsM.req({proto:fe.DEL_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:k,type:P}}).then(function(Y){return G.end(),q.i("".concat(l," ok")),Y=Y.data.resultList,Ct(Y)||Y.forEach(function(ve){var pe=ve.to,ye=ve.resultCode,ve=ve.resultInfo;Qe(ye)||ye===0?I.push({userID:pe}):v.push({userID:pe,code:ye,message:ve})}),Ut({successUserIDList:I,failureUserIDList:v})}).catch(function(Y){return G.setError(Y).end(),q.w("".concat(l," error:"),Y),Re(Y)})}},{key:"updateFriend",value:function(n){var s=this,l=n.userID,h=n.remark,v=n.friendCustomField;if(!this._friendMap.has(l))return Re({code:Be.NOT_MY_FRIEND});var I="".concat(this._n,".").concat("updateFriend"),k=new it("updateFriend"),P=(k.setMessage("userID:".concat(l," remark:").concat(h," friendCustomField:").concat(v)),[]);return Qe(h)||P.push({tag:eo.REMARK,value:h}),Rt(v)&&0<v.length&&v.forEach(function(G){P.push({tag:G.key,value:G.value})}),this._snsM.req({proto:fe.UPDATE_FD,data:{fromAccount:this._snsM.getMyUserID(),updateItem:[{to:l,snsItem:P}]}}).then(function(pe){k.end(),q.i("".concat(I," ok"));var pe=pe.data.resultList[0],Y=pe.to,te=pe.resultCode,pe=pe.resultInfo;return Qe(te)||te===0?((Y=s._friendMap.get(Y))&&(Qe(h)||(Y.remark=h),Rt(v)&&0<v.length&&Nd(Y.friendCustomField,v),s._onFriendListUpdated()),Ut(Y)):Re({code:te,message:pe})}).catch(function(G){return k.setError(G).end(),q.w("".concat(I," failed. error:"),G),Re(G)})}},{key:"checkFriend",value:function(n){var s="".concat(this._n,".").concat("checkFriend"),l=n.userIDList,h=n.type,v=(h&&(h===O.SNS_CHECK_TYPE_SINGLE||h===O.SNS_CHECK_TYPE_BOTH)||(h=O.SNS_CHECK_TYPE_BOTH),new it("checkFriend"));return v.setMessage("userIDList:".concat(l," type:").concat(h)),this._snsM.req({proto:fe.CHECK_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:l,type:h}}).then(function(G){v.end(),q.i("".concat(s," ok. userIDList:").concat(l," type:").concat(h));var k=[],P=[],G=G.data.resultList;return Rt(G)&&G.forEach(function(ve){var te=ve.to,pe=ve.relation,ye=ve.resultCode,ve=ve.resultInfo;Qe(ye)||ye===0?k.push({userID:te,code:0,relation:pe}):P.push({userID:te,code:ye,message:ve})}),Ut({successUserIDList:k,failureUserIDList:P})}).catch(function(I){return v.setError(I).end(),q.w("".concat(s," failed. error:"),I),Re(I)})}},{key:"updateWhenAddedToFriendGroup",value:function(h){var s=this,l=h.name,h=h.userIDList;q.l("".concat(this._n,".updateWhenAddedToFriendGroup groupName:").concat(l," userIDList:").concat(h)),l&&!Ct(h)&&h.forEach(function(v){s._friendMap.has(v)&&s._friendMap.get(v).addToGroupList(l)})}},{key:"updateWhenRemovedFromFriendGroup",value:function(h){var s=this,l=h.name,h=h.userIDList;q.l("".concat(this._n,".updateWhenRemovedFromFriendGroup groupName:").concat(l," userIDList:").concat(h)),l&&!Ct(h)&&h.forEach(function(v){s._friendMap.has(v)&&s._friendMap.get(v).removeFromGroupList(l)})}},{key:"reset",value:function(){this._friendMap.clear(),this._startIndex=0,this._standardSequence=0,this._customSequence=0}}]),h_),eu=(p(Th,[{key:"addToUserIDList",value:function(n){this.userIDList.indexOf(n)===-1&&(this.userIDList.push(n),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(n){n=this.userIDList.indexOf(n),-1<n&&(this.userIDList.splice(n,1),this.count=this.userIDList.length)}}]),Th),tu=(p(Sh,[{key:"getLocalFriendGroupList",value:function(){return L(this._friendGroupMap.values())}},{key:"_emitFriendGroupListUpdated",value:function(){var n=L(this._friendGroupMap.values());this._snsM.emitOuterEvent($.FRIEND_GROUP_LIST_UPDATED,n)}},{key:"getFriendGroupList",value:function(){var n=this,s="".concat(this._n,".").concat("getFriendGroupList"),l=new it("getFriendGroupList");return this._snsM.req({proto:fe.GET_FD_GRP_LIST,data:{fromAccount:this._snsM.getMyUserID()}}).then(function(h){l.end(),h=h.data.resultList,Ct(h)?q.i("".concat(s," ok. friend group count:0")):(q.i("".concat(s," ok. friend group count:").concat(h.length)),n._friendGroupMap.clear(),h.forEach(function(v){var I=new eu(v);n._friendGroupMap.set(v.name,I)}),n._emitFriendGroupListUpdated())}).catch(function(h){return l.setError(h).end(),q.w("".concat(s," error:"),h),Re(h)})}},{key:"createFriendGroup",value:function(n){var s=this,l="".concat(this._n,".").concat("createFriendGroup"),h=n.name,v=n.userIDList;if(this._friendGroupMap.has(h))return Re({code:Be.FRIEND_GRP_EXISTED});var I=new it("createFriendGroup");return I.setMessage("name:".concat(h," userIDList:").concat(v)),this._snsM.req({proto:fe.CREATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),groupName:[h],userIDList:Rt(v)?v:void 0}}).then(function(Y){I.end(),q.l("".concat(l," ok. name:").concat(h," userIDList:").concat(v));var Y=Y.data.resultList,P=[],G=[],Y=(Y&&Y.forEach(function(te){var pe=te.to,ye=te.resultCode,ve=te.resultInfo;Qe(ye)||ye===0?P.push(pe):(pe={userID:te.to,code:ye,message:ve},G.push(pe))}),new eu({name:h,userIDList:P}));return s._friendGroupMap.set(h,Y),s._snsM.updateWhenAddedToFriendGroup({name:h,userIDList:P}),s._emitFriendGroupListUpdated(),Ut({friendGroup:Y,failureUserIDList:G})}).catch(function(k){return I.setError(k).end(),q.w("".concat(l," failed. error:"),k),Re(k)})}},{key:"deleteFriendGroup",value:function(n){var s=this,l="".concat(this._n,".").concat("deleteFriendGroup"),h=n.name;if(!this._friendGroupMap.has(h))return Re({code:Be.FRIEND_GRP_NOT_EXIST});var v=new it("deleteFriendGroup");return v.setMessage("name:".concat(h)),this._snsM.req({proto:fe.DEL_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),nameList:[h]}}).then(function(I){v.end(),q.l("".concat(l," ok. name:").concat(h));var k=s._friendGroupMap.get(h);return k&&(s._snsM.updateWhenRemovedFromFriendGroup({name:h,userIDList:k.userIDList}),s._friendGroupMap.delete(h),k.userIDList.length=0),s._emitFriendGroupListUpdated(),Ut(k)}).catch(function(I){return v.setError(I).end(),q.w("".concat(l," failed. error:"),I),Re(I)})}},{key:"renameFriendGroup",value:function(n){var s=this,l="".concat(this._n,".").concat("renameFriendGroup"),h=n.oldName,v=n.newName;if(!this._friendGroupMap.has(h))return Re({code:Be.FRIEND_GRP_NOT_EXIST});var I=new it("renameFriendGroup");return I.setMessage("oldName:".concat(h," newName:").concat(v)),this._snsM.req({proto:fe.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:h,newName:v}}).then(function(){var k;return I.end(),q.l("".concat(l," ok. oldName:").concat(h," newName:").concat(v)),s._friendGroupMap.has(h)?((k=s._friendGroupMap.get(h)).name=v,s._friendGroupMap.delete(h),s._friendGroupMap.set(v,k),s._snsM.updateWhenRemovedFromFriendGroup({name:h,userIDList:k.userIDList}),s._snsM.updateWhenAddedToFriendGroup({name:v,userIDList:k.userIDList}),s._emitFriendGroupListUpdated(),Ut(k)):Ut()}).catch(function(k){return I.setError(k).end(),q.w("".concat(l," failed. error:"),k),Re(k)})}},{key:"addToFriendGroup",value:function(v){var s=this,l="".concat(this._n,".").concat("addToFriendGroup"),h=v.name,v=v.userIDList;if(!this._friendGroupMap.has(h))return this._onFriendGroupNotExist(h);var I=new it("addToFriendGroup");return I.setMessage("name:".concat(h," userIDList:").concat(v)),q.l("".concat(l," name:").concat(h," userIDList:").concat(v)),this._snsM.req({proto:fe.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:h,updateGroupItem:v.filter(function(k){return s._snsM.isMyFriend(k)}).map(function(k){return{to:k,updateType:"Update_Type_Add"}})}}).then(function(k){return I.end(),s._onFriendGroupUpdated(h,k)}).catch(function(k){return I.setError(k).end(),q.w("".concat(l," failed. error:"),k),Re(k)})}},{key:"removeFromFriendGroup",value:function(v){var s=this,l="".concat(this._n,".").concat("removeFromFriendGroup"),h=v.name,v=v.userIDList;if(!this._friendGroupMap.has(h))return this._onFriendGroupNotExist(h);var I=new it("removeFromFriendGroup");return I.setMessage("name:".concat(h," userIDList:").concat(v)),q.l("".concat(l," name:").concat(h," userIDList:").concat(v)),this._snsM.req({proto:fe.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:h,updateGroupItem:v.filter(function(k){return s._snsM.isMyFriend(k)}).map(function(k){return{to:k,updateType:"Update_Type_Delete"}})}}).then(function(k){return I.end(),s._onFriendGroupUpdated(h,k)}).catch(function(k){return I.setError(k).end(),q.w("".concat(l," failed. error:"),k),Re(k)})}},{key:"_onFriendGroupUpdated",value:function(n,l){var l=l.data.resultList,h=this._friendGroupMap.get(n),v=[],I=[],k=[];return Rt(l)&&l.forEach(function(P){var G=P.to,Y=P.resultCode,te=P.resultInfo,pe=P.type;Y===0?pe==="Update_Type_Add"?h&&(h.addToUserIDList(G),I.push(G)):pe==="Update_Type_Delete"&&h&&(h.removeFromUserIDList(G),k.push(G)):v.push({to:P.to,code:Y,message:te})}),q.l("".concat(this._n,"._onFriendGroupUpdated name:").concat(n," userIDList:").concat(h.userIDList)),0<I.length&&this._snsM.updateWhenAddedToFriendGroup({name:n,userIDList:I}),0<k.length&&this._snsM.updateWhenRemovedFromFriendGroup({name:n,userIDList:k}),Ut({friendGroup:h,failureUserIDList:v})}},{key:"updateWhenFriendAdded",value:function(n){var s=this,l=n.nameList,h=n.userID;q.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(h," nameList:").concat(l)),Ct(l)||l.forEach(function(v){s._friendGroupMap.has(v)&&s._friendGroupMap.get(v).addToUserIDList(h)})}},{key:"updateWhenFriendDeleted",value:function(n){var s=this,l=n.nameList,h=n.userID;q.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(h," nameList:").concat(l)),Ct(l)||l.forEach(function(v){s._friendGroupMap.has(v)&&s._friendGroupMap.get(v).removeFromUserIDList(h)})}},{key:"reset",value:function(){this._friendGroupMap.clear()}}]),Sh),Ob=(_(Ch,Uo),Sb=D(Ch),p(Ch,[{key:"onContextUpdated",value:function(n){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getFriendGroupList(),this._friendApplicationHandler.getFriendApplicationList()}},{key:"onRelationChainModified",value:function(G){var s,l,h,v,I,k,P=this,G=G.dataList;Ct(G)||(s=[],l=[],h=[],I=!(v=[]),k="",G.forEach(function(Y){var te;Y.pushType!==3&&Y.pushType!==4||!Y.from||(k=Y.from),Y.friendAddAccount&&(s.push.apply(s,L(Y.friendAddAccount)),v.push.apply(v,L(Y.friendAddAccount))),Y.friendDelAccount&&l.push.apply(l,L(Y.friendDelAccount)),Y.friendApplicationAdded&&h.push.apply(h,L(Y.friendApplicationAdded)),Y.friendApplicationDeletedUserIDList&&v.push.apply(v,L(Y.friendApplicationDeletedUserIDList)),Y.reportTime&&Y.pushType===7&&(I=!0),Y.friendUpInfo&&(te={dataList:[]},Y.friendUpInfo.forEach(function(pe){te.dataList.push({userID:pe.friendAccount,profileList:L(pe.sns)})}),P.onFriendProfileModified(te))}),I&&this._friendApplicationHandler.onFriendApplicationRead(),this._friendApplicationHandler.onFriendApplicationAdded(h,k),this._friendApplicationHandler.onFriendApplicationDeleted(v),this._friendHandler.onFriendAdded(s),this._friendHandler.onFriendDeleted(l))}},{key:"isMyFriend",value:function(n){return this._friendHandler.isMyFriend(n)}},{key:"filterProfanity",value:function(n,s){var h=this.get(29);if(!h)return!0;var h=h.filterText(s[n],"sns"),l=h.isAllowedToSend,h=h.modifiedText;return l===!0&&(s[n]=h,!0)}},{key:"onFriendProfileModified",value:function(n){this._friendHandler.onFriendProfileModified(n)}},{key:"getLocalFriendList",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s=this._friendHandler.getLocalFriendList();return n?ln(s):s}},{key:"getFriendRemark",value:function(n){return this._friendHandler.getFriendRemark(n)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(n){return this._friendHandler.addFriend(n)}},{key:"deleteFriend",value:function(n){return this._friendHandler.deleteFriend(n)}},{key:"checkFriend",value:function(n){return this._friendHandler.checkFriend(n)}},{key:"getFriendProfile",value:function(n){return this._friendHandler.getFriendProfile(n)}},{key:"updateFriend",value:function(n){return this._friendHandler.updateFriend(n)}},{key:"updateWhenAddedToFriendGroup",value:function(n){this._friendHandler.updateWhenAddedToFriendGroup(n)}},{key:"updateWhenRemovedFromFriendGroup",value:function(n){this._friendHandler.updateWhenRemovedFromFriendGroup(n)}},{key:"getLocalFriendApplicationList",value:function(){var n=this._friendApplicationHandler.getLocalFriendApplicationList();return ln(n)}},{key:"deleteFriendApplication",value:function(n){return this._friendApplicationHandler.deleteFriendApplication(n)}},{key:"refuseFriendApplication",value:function(n){return this._friendApplicationHandler.refuseFriendApplication(n)}},{key:"acceptFriendApplication",value:function(n){return this._friendApplicationHandler.acceptFriendApplication(n)}},{key:"setFriendApplicationRead",value:function(n){return this._friendApplicationHandler.setFriendApplicationRead(n)}},{key:"getLocalFriendGroupList",value:function(){var n=this._friendGroupHandler.getLocalFriendGroupList();return ln(n)}},{key:"createFriendGroup",value:function(n){return this._friendGroupHandler.createFriendGroup(n)}},{key:"deleteFriendGroup",value:function(n){return this._friendGroupHandler.deleteFriendGroup(n)}},{key:"addToFriendGroup",value:function(n){return this._friendGroupHandler.addToFriendGroup(n)}},{key:"removeFromFriendGroup",value:function(n){return this._friendGroupHandler.removeFromFriendGroup(n)}},{key:"renameFriendGroup",value:function(n){return this._friendGroupHandler.renameFriendGroup(n)}},{key:"onAddToFriendGroup",value:function(n){return this._friendGroupHandler.onAddToFriendGroup(n)}},{key:"updateWhenFriendAdded",value:function(n){this._friendGroupHandler.updateWhenFriendAdded(n)}},{key:"updateWhenFriendDeleted",value:function(n){this._friendGroupHandler.updateWhenFriendDeleted(n)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}]),Ch),o_=(_(bh,Uo),_h=D(bh),p(bh,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&sn}},{key:"startWorkerTimer",value:function(){q.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){q.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){var n,s;sn&&(n=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"})),this._workerTimer=new Worker(n),(s=this)._workerTimer.onmessage=function(l){l.data?(s._timerID=l.data,q.l("".concat(s._n,"._init seed:").concat(s._timerID))):s._m.onCheckTimer()})}},{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("enable_worker");q.l("".concat(this._n,"._onCloudConfigUpdated enableWorker:").concat(n)),Qe(n)||n==="1"?!this._isWorkerEnabled&&sn&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&sn&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){q.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),bh),r_=(p(d_,[{key:"isValidPurchaseBits",value:function(n){return n&&typeof n=="string"&&1<=n.length&&n.length<=64&&/[01]{1,64}/.test(n)}},{key:"parsePurchaseBits",value:function(n){if(this.isValidPurchaseBits(n)){this._featureMap.clear();for(var s,l=n.length-1,h=0;0<=l;l--,h++)s=(h<32?new de(0,Math.pow(2,h)):new de(Math.pow(2,h-32),0)).toString(),n[l]==="1"?this._featureMap.set(s,!0):this._featureMap.set(s,!1)}else q.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(n))}},{key:"hasPurchasedFeature",value:function(n){return!!this._featureMap.get(n)}},{key:"isFeatureEnabled",value:function(n){for(var s=parseInt(n).toString(2),l=void 0,h=!0,v=s.length-1,I=0;0<=v;v--,I++)if(s.charAt(v)==="1"&&(l=(I<32?new de(0,Math.pow(2,I)):new de(Math.pow(2,I-32),0)).toString(),!this._featureMap.get(l))){h=!1;break}return q.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(n," key:").concat(l," ret:").concat(h)),ln({enabled:h})}},{key:"isFeatureEnabledForStat",value:function(n){for(var s=parseInt(n).toString(2),l=s.length-1,h=0;0<=l;l--,h++)if(s.charAt(l)==="1"){if(v=(h<32?new de(0,Math.pow(2,h)):new de(Math.pow(2,h-32),0)).toString(),!this._featureMap.get(v))break;var v,I="",k=0;v===ue.PLUGIN_TRANSLATE?(I="plugin_translate",k=16):v===ue.PLUGIN_VOICE_TO_TEXT?(I="plugin_voice_to_text",k=17):v===ue.PLUGIN_CS?(I="plugin_cs",k=14):v===ue.PLUGIN_PUSH?(I="plugin_push",k=13):v===ue.PLUGIN_BOT?(I="plugin_bot",k=15):v===ue.MSG_REACTION&&(I="plugin_emoji_reaction",k=18),I!==""&&(v=this._commercialConfigM.get(12).getUIPlatform(),new it(I).setCode(k).setUIPlatform(v).end(),q.l("".concat(this._n,".isFeatureEnabledForStat ").concat(I," code:").concat(k," uiPlatform:").concat(v)))}}},{key:"isSearchCloudMessagesEnabled",value:function(){var n;this._isSCMReported||(n=this._commercialConfigM.get(12).getUIPlatform(),new it("plugin_search").setCode(6).setUIPlatform(n).end(),this._isSCMReported=!0)}},{key:"clear",value:function(){this._featureMap.clear(),this._isSCMReported=!1}}]),d_),hM=(p(Pp,[{key:"_canFetch",value:function(){return this.get(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(n){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var n,s,l=this,h=this._canFetch(),v="".concat(this._n,".fetchConfig");q.l("".concat(v," canFetch:").concat(h)),h&&(n=new it("fetchCommercialConfig"),h=this.get(12).getSDKAppID(),s=this.get(20),this._isFetching=!0,s.req({proto:fe.FETCH_COMMERCIAL_CONFIG,data:{SDKAppID:h}}).then(function(I){n.setMessage("purchaseBits:".concat(I.data.purchaseBits)).end(),q.l("".concat(v," ok.")),l._parseConfig(I.data),l._isFetching=!1}).catch(function(I){n.setError(I).end(),l._isFetching=!1}))}},{key:"onPushedConfig",value:function(n){var s="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(n));q.l("".concat(s)),new it("pushedCommercialConfig").setMessage("purchaseBits:".concat(n.purchaseBits)).end(),this._parseConfig(n)}},{key:"_parseConfig",value:function(n){var s="".concat(this._n,"._parseConfig"),l=n.errorCode,h=n.errorMessage,v=n.purchaseBits,I=n.expiredTime;l===0?(this._purchasedFeatureHandler.parsePurchaseBits(v),this._expiredTime=Date.now()+1e3*I):Qe(l)?(q.l("".concat(s," failed. Invalid message format:"),n),this._setExpiredTimeOnResponseError(36e5)):(q.e("".concat(s," errorCode:").concat(l," errorMessage:").concat(h)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(n){this._expiredTime=Date.now()+n}},{key:"canIUse",value:function(n){return this._purchasedFeatureHandler.hasPurchasedFeature(n)}},{key:"isFeatureEnabled",value:function(n){return this._purchasedFeatureHandler.isFeatureEnabled(n)}},{key:"isFeatureEnabledForStat",value:function(n){this._purchasedFeatureHandler.isFeatureEnabledForStat(n)}},{key:"isSearchCloudMessagesEnabled",value:function(){this._purchasedFeatureHandler.isSearchCloudMessagesEnabled()}},{key:"get",value:function(n){return this._m.get(n)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),Pp),fM=(_(Ih,Uo),Cb=D(Ih),p(Ih,[{key:"registerPlugin",value:function(n){var s,l,h,v,I,k,P,G,Y,te,pe,ye,ve;qe?(this._offlinePushPlugin=n["tim-offline-push-plugin"],s=(ve=n.offlinePushConfig||{}).huaweiBusinessID,l=ve.xiaomiBusinessID,h=ve.xiaomiAppID,v=ve.xiaomiAppKey,I=ve.meizuBusinessID,k=ve.meizuAppID,P=ve.meizuAppKey,G=ve.vivoBusinessID,Y=ve.oppoBusinessID,te=ve.oppoAppKey,pe=ve.oppoAppSecret,ye=ve.honorBusinessID,ve=ve.iosBusinessID,this._androidPushConfig.huaweiPushBussinessId=s,this._androidPushConfig.xiaomiPushBussinessId=l,this._androidPushConfig.xiaomiPushAppId=h,this._androidPushConfig.xiaomiPushAppKey=v,this._androidPushConfig.meizuPushBussinessId=I,this._androidPushConfig.meizuPushAppId=k,this._androidPushConfig.meizuPushAppKey=P,this._androidPushConfig.vivoPushBussinessId=G,this._androidPushConfig.oppoPushBussinessId=Y,this._androidPushConfig.oppoPushAppKey=te,this._androidPushConfig.oppoPushAppSecret=pe,this._androidPushConfig.honorPushBussinessId=ye,new it("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!Qe(this._offlinePushPlugin))).end(!0),q.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(n.offlinePushConfig))),this._iosBusinessID=ve,this._setAppShowListener()):this.outputWarning("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var n,s=this,l="".concat(this._n,".").concat("_getDeviceToken");ko(this._offlinePushPlugin.getDeviceToken)?(n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID),q.l("".concat(l," start. ").concat(n)),new it("_getDeviceToken").setMessage("".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,function(h){var v,I,k,P,G=new it("getDeviceTokenRes"),Y=h.code,te=h.msg;Y===0?(v=(P=h.data).deviceToken,I=P.deviceBrand,k=P.deviceType,P=P.bussinessId,s._deviceToken=v,s._businessID=P||s._iosBusinessID,n="deviceToken:".concat(v,", deviceBrand:").concat(I||k,", businessID:").concat(s._businessID),q.l("".concat(l," ok. ").concat(n)),G.setMessage(n).end(!0),s._setToken()):(G.setMessage("code:".concat(Y,", msg:").concat(te)).end(!0),q.e("".concat(l," failed. error:"),h))})):q.e("".concat(l," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return qe&&!Qe(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var n=this,s="".concat(this._n,".").concat("_setAppShowListener");Qe(this._offlinePushPlugin)?q.e("".concat(s," offlinePushPlugin is undefined")):ko(this._offlinePushPlugin.setAppShowListener)?(new it("_setAppShowListener").end(!0),q.l("".concat(s," start")),this._offlinePushPlugin.setAppShowListener(function(l){l=(l||{}).appShow,new it("setAppShowListenerRes").setMessage("appShow:".concat(l)).end(!0),q.l("".concat(s," ok. appShow:").concat(l)),n._m.isReady()&&(l===0?(n._getConvUnreadCount(),n._onBackground()):l===1&&n._onForeground())})):q.e("".concat(s," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){var n;if(!Qe(this._offlinePushPlugin)&&ko(this._offlinePushPlugin.getDeviceType))return n=(this._offlinePushPlugin.getDeviceType()||{}).deviceType,q.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(n)),n}},{key:"_setToken",value:function(){var n="".concat(this._n,"._setToken"),s=this.get(12),l=1,h="",v="",P=(Ct(this._deviceToken)&&(l=0),this.getUniAppPlatform()),I=this.getDeviceBrand(),k=(P===se.IOS||P===se.IPAD||P===se.MAC?v=this._deviceToken:P===se.ANDROID&&(h=this._deviceToken),new it("offlinePushSetToken")),P="deviceToken:".concat(v||h,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(I,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(l,", platform:").concat(P);return k.setMessage("".concat(P)),q.l("".concat(n," ").concat(P)),this.req({proto:fe.SET_TOKEN,data:{tokenID:h,pushMsg:l,sdkAppID:s.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:I,deviceToken:v,isWebUniapp:this._isWebUniapp}}).then(function(G){return k.end(),q.l("".concat(n," ok")),G}).catch(function(G){return k.setError(G).end(),q.e("".concat(n," failed. error:"),G),Re(G)})}},{key:"_getConvUnreadCount",value:function(){var n=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConversationList().forEach(function(s){s.type===O.CONV_C2C&&(n._c2cUnreadCount+=s.unreadCount),s.type===O.CONV_GROUP&&(n._groupUnreadCount+=s.unreadCount)})}},{key:"_onBackground",value:function(){var n=this,s="".concat(this._n,".").concat("_onBackground"),l=new it("_onBackground");this.req({proto:fe.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(h){return l.setMessage("c2cUnreadCount: ".concat(n._c2cUnreadCount,", groupUnreadCount: ").concat(n._groupUnreadCount)).end(),q.l("".concat(s," ok")),h}).catch(function(h){l.setError(h).end(),q.e("".concat(s," failed. error:"),h)})}},{key:"_onForeground",value:function(){var n="".concat(this._n,".").concat("_onForeground"),s=new it("_onForeground");this.req({proto:fe.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(l){return s.end(),q.l("".concat(n," ok")),l}).catch(function(l){s.setError(l).end(),q.e("".concat(n," failed. error:"),l)})}},{key:"getUniAppPlatform",value:function(){var n=uni.getSystemInfoSync().platform,s=this.getDeviceBrand();return n==="ios"?se.IOS:n==="android"?se.ANDROID:s===1002?se.IPAD:s===1001?se.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,q.l("".concat(this._n,".reset"))}}]),Ih),pM=(_(ru,Uo),bb=D(ru),p(ru,[{key:"registerPlugin",value:function(n){var s,l,h;qe?(s="".concat(this._n,".").concat("registerPlugin"),this._pushPlugin=n["tim-push"],this._getDeviceInfo(),l=(h=n.pushConfig||{}).androidConfig,h=h.iOSConfig,hr(l)&&(this._androidPushConfig=l[this._deviceInfo.packageName]),l=(h||{}).iOSBusinessID,this._iOSBusinessID=l,h=!Qe(this._pushPlugin),new it("registerPlugin").setMessage(this._pluginName).setMoreMessage("isExisted:".concat(h)).end(!0),q.l("".concat(s," ok. pushConfig:").concat(JSON.stringify(n.pushConfig))),h?(this._setAppShowListener(),this._setPushEventReportListener()):q.e("".concat(s," ").concat(this._pluginName," is undefined"))):this.outputWarning("TIMPushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._reportEventCacheList(),this._getDeviceToken(),this.get(27).isFeatureEnabledForStat(Math.pow(2,41))}},{key:"_reportEventCacheList",value:function(){var n=this,s="".concat(this._n,".").concat("_reportEventCacheList");ko(this._pushPlugin.getPushEventCacheList)?(new it("_reportEventCacheList").end(!0),this._pushPlugin.getPushEventCacheList(function(l){var h=l.code,v=l.data.eventList,I=new it("getPushEventCacheListRes");if(I.setCode(h),h!==0)I.setMessage("res:".concat(JSON.stringify(l))).end(!0),q.e("".concat(s," failed. error:").concat(JSON.stringify(l)));else{h=v.length<10?"eventList:".concat(JSON.stringify(v)):"eventList.length:".concat(v.length),q.l("".concat(s," ok. ").concat(h)),I.setMessage(h).end(!0);for(var k=i(i({},l.data),{},{eventList:[]});0<v.length;)k.eventList=v.splice(0,40),n._pushReport(k)}})):q.e("".concat(this._pluginName,".getPushEventCacheList is not a function"))}},{key:"_getDeviceToken",value:function(){var n,s=this,l="".concat(this._n,".").concat("_getDeviceToken");ko(this._pushPlugin.getDeviceToken)?(n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig)," iOSBusinessID:").concat(this._iOSBusinessID),q.l("".concat(l," start. ").concat(n)),new it("_getDeviceToken").setMessage("".concat(n)).end(!0),this._pushPlugin.getDeviceToken(this._androidPushConfig,function(h){var v,I,k,P=h.code,G=h.msg,Y=new it("getDeviceTokenRes");if(Y.setCode(P),P===0)return v=(P=h.data).deviceToken,I=P.deviceBrand,k=P.deviceType,P=P.bussinessId,s._deviceToken=v,s._businessID=P||s._iOSBusinessID,n="deviceToken:".concat(v," deviceBrand:").concat(I||k," businessID:").concat(s._businessID),q.l("".concat(l," ok. ").concat(n)),Y.setMessage(n).end(!0),void s._setToken();Y.setMessage(G).end(!0),q.e("".concat(l," failed. error:").concat(JSON.stringify(h)))})):q.e("".concat(this._pluginName,".getDeviceToken is not a function"))}},{key:"_getDeviceInfo",value:function(){var n="".concat(this._n,".").concat("_getDeviceInfo");if(ko(this._pushPlugin.getDeviceInfo)){var s=this._pushPlugin.getDeviceInfo(),l=s.code,h=s.data,v=new it("_getDeviceInfo");if(v.setCode(l),l===0)return this._deviceInfo=i(i({},this._deviceInfo),h),this._deviceInfo.pushVersion||(this._deviceInfo.pushVersion="1.0.1"),l="deviceInfo:".concat(JSON.stringify(this._deviceInfo)),q.l("".concat(n," ok. ").concat(l)),void v.setMessage(l).end(!0);v.setMessage("deviceInfoRes:".concat(JSON.stringify(s))).end(!0),q.e("".concat(n," failed. error:").concat(JSON.stringify(s)))}else q.e("".concat(this._pluginName,".getDeviceInfo is not a function"))}},{key:"canIUseTIMPush",value:function(){return qe&&!Qe(this._pushPlugin)}},{key:"_setAppShowListener",value:function(){var n=this,s="".concat(this._n,".").concat("_setAppShowListener");ko(this._pushPlugin.setAppShowListener)?(new it("_setAppShowListener").end(!0),q.l("".concat(s," start")),this._pushPlugin.setAppShowListener(function(l){l=(l||{}).appShow,new it("setAppShowListenerRes").setMessage("appShow:".concat(l)).end(!0),q.l("".concat(s," ok. appShow:").concat(l)),n._m.isReady()&&(l===0?(n._getConvUnreadCount(),n._onBackground()):l===1&&n._onForeground())})):q.e("".concat(this._pluginName,".setAppShowListener is not a function"))}},{key:"_setPushEventReportListener",value:function(){var n=this,s="".concat(this._n,".").concat("_setPushEventReportListener");ko(this._pushPlugin.setPushEventReportListener)?(new it("_setPushEventReportListener").end(!0),this._pushPlugin.setPushEventReportListener(function(l){var h=l.code,v=l.data,I=v.eventList,k=new it("setPushEventReportListenerRes");if(k.setCode(h),h===0)return h="eventList:".concat(JSON.stringify(I)),q.l("".concat(s," ok. ").concat(h)),k.setMessage(h).end(!0),void(n._m.isReady()&&Rt(I)&&0<I.length&&n._pushReport(v));k.setMessage("res:".concat(JSON.stringify(l))).end(!0),q.e("".concat(s," failed. error:").concat(JSON.stringify(l)))})):q.e("".concat(this._pluginName,".setPushEventReportListener is not a function"))}},{key:"getDeviceBrand",value:function(){var n;if(!Qe(this._pushPlugin)&&ko(this._pushPlugin.getDeviceType))return n=(this._pushPlugin.getDeviceType()||{}).deviceType,q.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(n)),n}},{key:"_setToken",value:function(){var n="".concat(this._n,".").concat("_setToken"),s=this.get(12),l=1,P="",h="",I=(Ct(this._deviceToken)&&(l=0),this.getUniAppPlatform()),v=this.getDeviceBrand(),I=(I===se.IOS||I===se.IPAD||I===se.MAC?h=this._deviceToken:I===se.ANDROID&&(P=this._deviceToken),i({tokenID:P,pushMsg:l,sdkAppID:s.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:v,deviceToken:h,isWebUniapp:this._isWebUniapp},this._deviceInfo)),k=new it("_setToken"),P="data:".concat(JSON.stringify(I));k.setMessage("".concat(P)),q.l("".concat(n," ").concat(P)),this.req({proto:fe.SET_TOKEN,data:I}).then(function(){k.end(),q.w("".concat(n," ok"))}).catch(function(G){k.setError(G).end(),q.e("".concat(n," failed. error:"),G),Re(G)})}},{key:"_getConvUnreadCount",value:function(){var n=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConversationList().forEach(function(s){s.type===O.CONV_C2C&&(n._c2cUnreadCount+=s.unreadCount),s.type===O.CONV_GROUP&&(n._groupUnreadCount+=s.unreadCount)})}},{key:"_onBackground",value:function(){var n=this,s="".concat(this._n,".").concat("_onBackground"),l=new it("_onBackground");this.req({proto:fe.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(){l.setMessage("c2cUnreadCount:".concat(n._c2cUnreadCount," groupUnreadCount:").concat(n._groupUnreadCount)).end(),q.l("".concat(s," ok"))}).catch(function(h){l.setError(h).end(),q.e("".concat(s," failed. error:"),h)})}},{key:"_onForeground",value:function(){var n="".concat(this._n,".").concat("_onForeground"),s=new it("_onForeground");this.req({proto:fe.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(){s.end(),q.l("".concat(n," ok"))}).catch(function(l){s.setError(l).end(),q.e("".concat(n," failed. error:"),l)})}},{key:"_pushReport",value:function(n){var s=this,l="".concat(this._n,".").concat("_pushReport"),h=new it("_pushReport");this.req({proto:fe.PUSH_REPORT,data:{eventList:n.eventList}}).then(function(){h.end(),s._notifyReportSuccess(n)}).catch(function(v){h.setError(v).end(),q.e("".concat(l," failed. error:"),v)})}},{key:"_notifyReportSuccess",value:function(n){!Qe(this._pushPlugin)&&ko(this._pushPlugin.notifyReportSuccess)&&(this._pushPlugin.notifyReportSuccess(n),q.l("".concat(this._n,"._notifyReportSuccess ok")))}},{key:"getUniAppPlatform",value:function(){var n=uni.getSystemInfoSync().platform,s=this.getDeviceBrand();return n==="ios"?se.IOS:n==="android"?se.ANDROID:s===1002?se.IPAD:s===1001?se.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,q.l("".concat(this._n,".reset"))}}]),ru),Nb=(_(ou,Uo),t_=D(ou),p(ou,[{key:"init",value:function(){var n=this.get(18).getPlugin("tim-profanity-filter-plugin");n&&(this._plugin=new n({logger:q,isArray:Rt,isMap:Tt,isDevMode:this.isDevMode()}),this._getLexicon())}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(n,h){var l=!0;if(!this._plugin||!this._canIUseLexicon||h&&h.messageControlInfo&&h.messageControlInfo.excludedFromContentModeration===!0)return l;var h=n.type,v=n.conversationType;if(h!==O.MSG_TEXT&&h!==O.MSG_CUSTOM)return l;var I,k="".concat(this._n,".filterMessage");if(q.l("".concat(k)),h===O.MSG_TEXT){if(v===O.CONV_C2C?I="c2c_text_message":v===O.CONV_GROUP&&(I="group_text_message"),!this._isConfigOn(I))return l;var G=this._plugin.filter(n.payload.text),P=G.type,G=G.modifiedText;P===1?l=!1:P===2&&(n.payload.text=G)}else if(h===O.MSG_CUSTOM){if(v===O.CONV_C2C?I="c2c_custom_message":v===O.CONV_GROUP&&(I="group_custom_message"),!this._isConfigOn(I))return l;P=this._plugin.filter(n.payload.data),G=this._plugin.filter(n.payload.description),h=this._plugin.filter(n.payload.extension),P.type===1||G.type===1||h.type===1?l=!1:(P.type===2&&(n.payload.data=P.modifiedText),G.type===2&&(n.payload.description=G.modifiedText),h.type===2&&(n.payload.extension=h.modifiedText))}return q.l("".concat(k," done. isAllowedToSend:").concat(l)),l}},{key:"filterText",value:function(n,s){var l="".concat(this._n,".filterText"),h={isAllowedToSend:!0,modifiedText:n};return!this._plugin||!this._canIUseLexicon||!this._isConfigOn(s)?h:(q.l("".concat(l)),s=this._plugin.filter(n),n=s.type,s=s.modifiedText,n===1?h.isAllowedToSend=!1:n===2&&(h.modifiedText=s),q.l("".concat(l," done. ret:"),h),h)}},{key:"_getLexicon",value:function(){var n=this,s=new it("profanityFilter"),l="".concat(this._n,"._getLexicon");this._isFetching=!0,this.req({proto:fe.GET_PROFANITY_LIST,data:{startIndex:this._startIndex,version:this._version}}).then(function(pe){var pe=pe.data,v=pe.errorInfo,I=pe.filterConfig,k=pe.lexicon,P=pe.strToken,G=pe.completeFlag,Y=pe.nextStartIndex,te=pe.version,pe=pe.expiredTime,ye=v.errorCode,ve=v.errorMessage;return ye!==0?(n._isFetching=!1,q.w("".concat(l," failed. error:"),v),void s.setCode(ye).setMessage(ve).end()):(n._onFilterConfig(I),n._getToken(P),G===1?(q.l("".concat(l," done. version:").concat(te," expiredTime:").concat(pe)),n._version=te,n._canIUseLexicon=!0,n._isFetching=!1,n._expiredTime=Date.now()+1e3*pe,void n._plugin.onLexiconCompleted(k)):(n._startIndex=Y,n._plugin.onLexiconSliced(k),void n._getLexicon()))}).catch(function(h){s.setError(h).end(),n._isFetching=!1,q.l("".concat(l," failed. error:"),h)})}},{key:"_onFilterConfig",value:function(n){var s=this;Ct(n)||(this._filterConfigMap.clear(),Object.keys(n).forEach(function(l){s._filterConfigMap.set(l,n[l])}),q.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(n){return this._filterConfigMap.get(n)===1}},{key:"_getToken",value:function(n){if(Sn(n)){var s=n.length,l="";if(s%2==0)for(var h=0;h<=s-1;h+=2)l=(l+=n[h+1])+n[h];else{for(var v=0;v<s-1;v+=2)l=(l+=n[v+1])+n[v];l+=n[s-1]}this._plugin.onToken(l)}}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),ou),Lb=(p(u_,[{key:"_onCloudConfigUpdated",value:function(){var n=this,s=this._m.get(23).getCloudConfig("rtc_cmd");Qe(s)||((s=JSON.parse(s)).forEach(function(l){n._TRTCCommandList.includes(l)||n._TRTCCommandList.push(l)}),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var n,s=0,l=this._TRTCCommandList.length;s<l;s++)n=this._TRTCCommandList[s].split(".")[0],this._TRTCCommandMap.set(n,1)}},{key:"onRoomCustomDataReceived",value:function(n){this._m.getOuterEmitterInstance().emit($.ROOM_CUSTOM_DATA_RECEIVED,n)}},{key:"sendTRTCCustomData",value:function(l){var s=l.serviceCommand,l=l.data,h="".concat(Q.NAME.TUIROOM_SVR,".*");return Qe(s)||(h=s),this._isValidServiceCommand(h)?this._trans({servcmd:h,data:l}):Re({code:Be.INVALID_TRTC_CMD})}},{key:"_trans",value:function(l){q.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(l)));var s=l.servcmd,l=l.data;return this._m.get(20).trans({servcmd:s,data:Sn(l)?JSON.parse(l):l})}},{key:"_isValidServiceCommand",value:function(n){return n.endsWith(".*")?this._TRTCCommandList.includes(n):(n=n.split(".")[0],this._TRTCCommandMap.has(n))}},{key:"isTRTCCommand",value:function(n){return n=n.split(".")[0],this._TRTCCommandMap.has(n)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),u_),gM=(p(Lp,[{key:"_init",value:function(){var n,s=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(s){try{n=JSON.parse(s)}catch(l){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),q.w("".concat(this._n,"._init error:"),l)}n&&(this._needToUpdate(n)?this._fetch():this._fillMap(n.message))}else this._fetch()}},{key:"_needToUpdate",value:function(l){var s=l.localSavedTime,l=l.localSavedVersion,s=s&&new Date().getTime()-s>=this.STORAGE_EXPIRES_TIME,l=!l||l!=="3.3.5";return q.l("".concat(this._n,"._needToUpdate isTimeout:").concat(s," isDifferentVersion:").concat(l)),s||l}},{key:"_fetch",value:function(){var n,s,l,h,v,I;this._m.get(12).isPrivateNetWork()||(n="https://web.sdk.qcloud.com/im/download/error-message/v3/0.0.5/tim-error-message.txt",s="application/x-www-form-urlencoded;charset=UTF-8",l="".concat(this._n,"._fetch ok in"),h=this,Ie?xe.request({url:n,method:"GET",timeout:3e3,header:{"content-type":s},dataType:"text",success:function(k){h._fillAndSave(k.data),q.l("".concat(l," mini program"))},fail:function(){}}):(v=new XMLHttpRequest,I=setTimeout(function(){v.abort()},3e3),v.onreadystatechange=function(){v.readyState===4&&(clearTimeout(I),v.status!==200&&v.status!==304||(q.l("".concat(l," browser")),h._fillAndSave(v.responseText)))},v.open("GET",n,!0),v.setRequestHeader("Content-type",s),v.send()))}},{key:"_fillAndSave",value:function(n){this._fillMap(n),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:n,localSavedTime:new Date().getTime(),localSavedVersion:"3.3.5"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.get(13)}},{key:"_fillMap",value:function(n){this._map.clear();for(var s,l,h=n.split(`;
`),v=h.length,I=new RegExp(/'/g),k=0;k<v;k++)if(l=h[k].indexOf(":"),s=h[k].slice(0,l),l=h[k].slice(l+1,h[k].length),!s.startsWith("//")){if(Qe(l))continue;this._map.set(s,l.replace(I,""))}}},{key:"get",value:function(l){var h=l.isIntl,v=l.key,s=l.replacement1,l=l.replacement2,h="".concat(v,h?"_en":"_cn"),v=(!this._map.has(h)&&this._map.has(v)&&(h=v),"");return this._map.has(h)&&(v=this._map.get(h),Qe(s)||(v=v.replace("$replacement1",s)),Qe(l)||(v=v.replace("$replacement2",l))),v}},{key:"reset",value:function(){q.l("".concat(this._n,".reset"))}}]),Lp),mM=(p(c_,[{key:"onNewMessageList",value:function(l){var s=this,l=this._sigM.filterMessageList(l);0<l.length&&l.forEach(function(h){var v=s.getPayloadData(h);v&&s._handleActionType(v,h)})}},{key:"onMessageModified",value:function(l){var s=this,l=this._sigM.filterMessageList(l);0<l.length&&l.forEach(function(h){var v=s.getPayloadData(h);v&&s._onInvitationModified(v,h)})}},{key:"getPayloadData",value:function(l){var s="".concat(this._n,".getPayloadData"),l=l.payload.data;try{return JSON.parse(l)}catch{return q.e("".concat(s," JSON parse error. signalingData:").concat(l)),null}}},{key:"_handleActionType",value:function(n,s){switch(n.actionType){case X.ACTION_TYPE_INVITE:this._onNewInvitationReceived(n,s);break;case X.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(n);break;case X.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(n);break;case X.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(n);break;case X.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(n)}}},{key:"_createDefaultEmitData",value:function(n){return{inviteID:n.inviteID,inviter:n.inviter,groupID:n.groupID,data:n.data||""}}},{key:"_onNewInvitationReceived",value:function(n,s){var te="".concat(this._n,"._onNewInvitationReceived"),l=n.inviteID,h=n.inviteeList,v=n.groupID,I=n.inviter,k=this._sigM.getMyUserID(),P=h.includes(k),G=n.timeout,Y=(Dt().getTime()-1e3*s.time)/1e3,te=(0<G&&0<Y&&Y<G&&(G-=Y),"".concat(te," myselfIncluded:").concat(P," groupID:").concat(v," signalObj:").concat(JSON.stringify(n)));q.l("".concat(te," timeout:").concat(G,"s delta:").concat(Y,"s")),(v&&P||!v)&&((te=this._sigM.getInviteInfo(l))&&te===n||(te||this._sigM.setInviteInfo(l,i(i({},n),{},{message:s})),this._sigM.emitEvent(X.NEW_INVITATION_RECEIVED,i(i({},this._createDefaultEmitData(n)),{},{inviteeList:h})),I!==k&&this._sigM.startTimer(i(i({},n),{},{timeout:G}))))}},{key:"_onInviteeRejected",value:function(n){var s="".concat(this._n,"._onInviteeRejected"),l=n.inviteID,h=n.inviter,v=n.groupID,I=this._sigM.hasInviteInfo(l);q.l("".concat(s," inviteID:").concat(l," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(v)),I&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(X.INVITEE_REJECTED,i(i({},this._createDefaultEmitData(n)),{},{invitee:n.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(n){var s="".concat(this._n,"._onInviteeAccepted"),l=n.inviteID,h=n.inviter,v=n.groupID,I=this._sigM.hasInviteInfo(l);q.l("".concat(s," inviteID:").concat(l," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(v)),I&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(X.INVITEE_ACCEPTED,i(i({},this._createDefaultEmitData(n)),{},{invitee:n.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(n){var s="".concat(this._n,"._onInvitationCancelled"),l=n.inviteID,h=n.inviter,v=n.groupID,I=this._sigM.hasInviteInfo(l);q.l("".concat(s," inviteID:").concat(l," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(v)),I&&(this._sigM.deleteInviteInfo(l),this._sigM.emitEvent(X.INVITATION_CANCELLED,this._createDefaultEmitData(n)))}},{key:"_onInvitationTimeout",value:function(n){var s="".concat(this._n,"._onInvitationTimeout"),l=n.inviteID,h=n.inviter,v=n.groupID,I=n.inviteeList,k=this._sigM.hasInviteInfo(l);q.l("".concat(s," inviteID:").concat(l," hasInviteID:").concat(k," inviter:").concat(h," groupID:").concat(v,"  data:").concat(n.data)),k&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(X.INVITATION_TIMEOUT,i(i({},this._createDefaultEmitData(n)),{},{inviteeList:I,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(n,s){var l="".concat(this._n,"._onInvitationModified"),h=n.inviteID,v=n.data;q.l("".concat(l," inviteID:").concat(h," data:").concat(v)),this._sigM.setInviteInfo(h,i(i({},n),{},{message:s})),this._sigM.emitEvent(X.INVITATION_MODIFIED,{inviteID:h,data:v})}}]),c_),vM=(p(l_,[{key:"generateInviteID",value:function(){var n,s=(s=sM)((n=Np)(32),8)+"-"+s(n(16),4)+"-"+s(16384|n(12),4)+"-"+s(32768|n(14),4)+"-"+s(n(48),12);return q.l("".concat(this._n,".generateInviteID inviteID:").concat(s)),s}},{key:"createInviteInfo",value:function(l){var s=this.generateInviteID(),l=this.createInviteCustomData(i(i({},l),{},{inviteID:s})),v=l.groupID,h=l.inviteeList,v=v||h[0];return{customData:l,message:this.createSignalingMessage(l,v),inviteID:s}}},{key:"_createDefaultCustomData",value:function(h){var s=h.data,l=h.inviteID,h=h.groupID;return{businessID:1,timeout:0,data:s===void 0?"":s,inviteID:l===void 0?"":l,groupID:h===void 0?"":h}}},{key:"createInviteCustomData",value:function(n){var s=n.userID,l=n.timeout,l=l===void 0?0:l,h=n.groupID,h=h===void 0?"":h,v=this._sigM.getMyUserID(),v=i(i({},this._createDefaultCustomData(n)),{},{actionType:X.ACTION_TYPE_INVITE,inviter:v,inviteeList:h?n.inviteeList:[s],timeout:l});return q.l("".concat(this._n,".createInviteCustomData customData:").concat(JSON.stringify(v))),v}},{key:"createCancelCustomData",value:function(n){var s,l="".concat(this._n,".createCancelCustomData"),k=n.inviteID,h=this._sigM.getMyUserID(),k=this._sigM.getInviteInfo(k),v=k.inviteeList,I=k.groupID,k=k.inviter;return k===h?s=i(i({},this._createDefaultCustomData(n)),{},{actionType:X.ACTION_TYPE_CANCEL_INVITE,groupID:I,inviter:h,inviteeList:v}):q.e("".concat(l," unmatched inviter:").concat(k," and my userID:").concat(h)),q.l("".concat(l," customData:").concat(JSON.stringify(s))),s}},{key:"createAcceptCustomData",value:function(n){var s,l="".concat(this._n,".createAcceptCustomData"),h=n.inviteID,v=this._sigM.getMyUserID(),I=this._sigM.getInviteInfo(h),k=I.inviter,P=I.groupID;return I.inviteeList.includes(v)?s=i(i({},this._createDefaultCustomData(n)),{},{actionType:X.ACTION_TYPE_ACCEPT_INVITE,groupID:P,inviter:k,inviteeList:[v]}):q.e("".concat(l," userID:").concat(v," not in inviteeList. inviteID:").concat(h," groupID:").concat(P)),q.l("".concat(l," customData:").concat(JSON.stringify(s))),s}},{key:"createRejectCustomData",value:function(n){var s,l="".concat(this._n,".createRejectCustomData"),h=n.inviteID,v=this._sigM.getMyUserID(),I=this._sigM.getInviteInfo(h),k=I.inviter,P=I.groupID;return I.inviteeList.includes(v)?s=i(i({},this._createDefaultCustomData(n)),{},{actionType:X.ACTION_TYPE_REJECT_INVITE,groupID:P,inviter:k,inviteeList:[v]}):q.e("".concat(l," userID:").concat(v," not in inviteeList. inviteID:").concat(h," groupID:").concat(P)),q.l("".concat(l," customData:").concat(JSON.stringify(s))),s}},{key:"createTimeoutCustomData",value:function(k){var s="".concat(this._n,".createTimeoutCustomData"),l=k.inviteeList,h=k.inviter,v=k.isInviter,v=v!==void 0&&v,I=this._sigM.getMyUserID(),k=i(i({},this._createDefaultCustomData(k)),{},{actionType:X.ACTION_TYPE_INVITE_TIMEOUT,inviter:h,inviteeList:v?l:[I]});return q.l("".concat(s," customData:").concat(JSON.stringify(k))),k}},{key:"createSignalingMessage",value:function(n,v){var l=n.groupID,I=n.inviter,h=this._sigM.get(2),v={to:v||l||I,conversationType:l?O.CONV_GROUP:O.CONV_C2C,priority:O.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(n)}},I=h.createCustomMessage(v);return q.d("".concat(this._n,".createSignalingMessage. message:").concat(JSON.stringify(I))),I}}]),l_),i_=(p(ii,[{key:"getHistorySignaling",value:function(){var n=this,s=this._sigM.get(11).getLocalConversationList();Ct(s)||(this._getC2CSignalingList(),s=this._getValidConversationList(s),this._getGroupSignalingList(s).then(function(l){n._handleSignalingList(l)}))}},{key:"_getC2CSignalingList",value:function(){var n=this._sigM.get(6).getMessageListFromUnreadDB(),n=this._filterMessageList(n);this._getSignalingRelatedToMeMap(n)}},{key:"_getGroupSignalingList",value:function(l){var s=this,l=this._createPromiseList(l);return Ct(l)?Promise.resolve(this._sortSignaling(this._signalingRelatedToMeMap)):this._concurrentGetMessageList(l).then(function(h){var v=new Map;return h.forEach(function(I){I=I.signalingList,I=s._getSignalingRelatedToMeMap(I),v=new Map([].concat(L(v),L(I)))}),s._sortSignaling(v)})}},{key:"_handleSignalingList",value:function(n){Ct(n)||(q.d("".concat(this._n,"._handleSignalingList signalingList:").concat(JSON.stringify(n))),this._sigM.onNewMessageList(n))}},{key:"_filterMessageList",value:function(n){return this._sigM.filterMessageList(n)}},{key:"_getValidConversationList",value:function(n){for(var s=[],l=0;l<n.length;l++){var v=n[l],h=v.type,v=v.unreadCount;h===O.CONV_GROUP&&v&&s.push(n[l])}return s}},{key:"_createPromiseList",value:function(n){for(var s=[],l=0;l<n.length;l++){var v=n[l],h=v.conversationID,I=v.unreadCount,v=v.type===O.CONV_C2C?I:this.COUNT,I=(this._signalingMap.set(h,{needMessageCount:v,signalingList:[]}),this._sigM.get(11).getMessageList({conversationID:h}));s.push(I)}return s}},{key:"_concurrentGetMessageList",value:function(n){var s=this,l=[];return Promise.all(n).then(function(h){for(var v=0;v<h.length;v++){var k=h[v],I=k.code,k=k.data;I===0&&k.messageList.length!==0&&(s._handleMessageList(k.messageList),(I=s._relayGetMessageList(k))&&l.push(I))}return 0<l.length?s._concurrentGetMessageList(l):s._signalingMap})}},{key:"_relayGetMessageList",value:function(l){var v=l.messageList,s=l.nextReqMessageID,l=l.isCompleted;if(v.length===0)return null;var v=v[0],h=v.conversationID,v=v.conversationType,I=this._signalingMap.get(h).needMessageCount;return v===O.CONV_GROUP||I===0||l?null:this._sigM.get(11).getMessageList({conversationID:h,nextReqMessageID:s,count:I})}},{key:"_handleMessageList",value:function(n){var s=n.length,l=n[0].conversationID,v=this._signalingMap.get(l),h=v.needMessageCount,v=v.signalingList;this._signalingMap.set(l,{needMessageCount:0<h-s?h-s:0,signalingList:v.concat(this._filterMessageList(n))})}},{key:"_getSignalingRelatedToMeMap",value:function(n){for(var s=0;s<n.length;s++){var l=n[s];this._saveSignalingRelatedToMe(l)}return this._signalingRelatedToMeMap}},{key:"_saveSignalingRelatedToMe",value:function(n){var l=this._sigM.getRemoteSignalingHandler().getPayloadData(n)||{},s=l.actionType,l=l.inviteID,h=l===void 0?"":l;switch(s===void 0?"":s){case X.ACTION_TYPE_INVITE:this._setHistoryInviteInfo(n);break;case X.ACTION_TYPE_REJECT_INVITE:case X.ACTION_TYPE_ACCEPT_INVITE:this.updateHistoryInviteInfo(n);break;case X.ACTION_TYPE_CANCEL_INVITE:this.deleteHistoryInviteInfo(h);break;case X.ACTION_TYPE_INVITE_TIMEOUT:this.updateHistoryInviteInfo(n)}}},{key:"_setHistoryInviteInfo",value:function(n){var s=this._sigM.getRemoteSignalingHandler().getPayloadData(n)||{},l=s.inviteID,l=l===void 0?"":l,h=s.inviteeList,h=h===void 0?[]:h,v=s.timeout,v=v===void 0?0:v,I=this._sigM.getMyUserID();h.includes(I)&&(h=xt()-n.time,0<v&&v<h&&v!==0||this._signalingRelatedToMeMap.set(l,i(i({},s),{},{messageList:[n]})))}},{key:"deleteHistoryInviteInfo",value:function(n){this._signalingRelatedToMeMap.has(n)&&this._signalingRelatedToMeMap.delete(n)}},{key:"updateHistoryInviteInfo",value:function(n){var l=this._sigM.getRemoteSignalingHandler().getPayloadData(n)||{},s=l.inviteID,s=s===void 0?"":s,l=l.inviteeList,h=l===void 0?[]:l;if(this._signalingRelatedToMeMap.has(s)){for(var l=this._signalingRelatedToMeMap.get(s),v=l.inviteeList,l=l.messageList,I=0;I<h.length;I++){var k=h[I];v.includes(k)&&v.splice(v.indexOf(k),1)}v.length===0?this.deleteHistoryInviteInfo(s):l.push(n)}else this.deleteHistoryInviteInfo(s)}},{key:"_sortSignaling",value:function(n){var s=[];return n.forEach(function(l){s=[].concat(L(s),L(l.messageList))}),s.sort(function(l,h){return(l.time||0)-(h.time||0)})}},{key:"reset",value:function(){this._signalingMap.clear(),this._signalingRelatedToMeMap.clear()}}]),ii),_M=p(function n(s,l){u(this,n),this.businessID=s.businessID||1,this.inviteID=s.inviteID,this.groupID=s.groupID||"",this.inviter=s.inviter||"",this.inviteeList=s.inviteeList||[],this.data=s.data||"",this.actionType=s.actionType||X.ACTION_TYPE_INVITE,this.timeout=s.timeout||0}),Pb=["message"],Ub=["message"],xb=(_(nu,Uo),Zc=D(nu),p(nu,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onReady",value:function(){q.l("".concat(this._n,".onReady")),this._isSyncCompleted=!0,this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(n){return this._remoteSignalingHandler.onNewMessageList(n)}},{key:"onMessageModified",value:function(n){return this._remoteSignalingHandler.onMessageModified(n)}},{key:"hasInviteInfo",value:function(n){return this._inviteInfoMap.has(n)}},{key:"getInviteInfo",value:function(n){return this._inviteInfoMap.get(n)}},{key:"setInviteInfo",value:function(n,h){var l=h.message,h=E(h,Pb);q.l("".concat(this._n,".setInviteInfo inviteID:").concat(n," data:").concat(JSON.stringify(h))),this._inviteInfoMap.set(n,i(i({},h),{},{message:l}))}},{key:"deleteInviteInfo",value:function(n){this.hasInviteInfo(n)&&(q.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(n,".")),this._inviteInfoMap.delete(n))}},{key:"updateInviteInfo",value:function(I){var s="".concat(this._n,".updateInviteInfo"),l=I.inviteID,h=I.inviter,v=I.inviteeList,I=I.groupID;q.l("".concat(s," inviteID:").concat(l," inviter:").concat(h," groupID:").concat(I)),I&&this.hasInviteInfo(l)?(h=v[0],(I=this.getInviteInfo(l).inviteeList).includes(h)&&(I.splice(I.indexOf(h),1),q.l("".concat(s," remove ").concat(h,". localInviteeList.length:").concat(I.length))),I.length===0&&this.deleteInviteInfo(l)):this.deleteInviteInfo(l)}},{key:"getLocalSignalingHandler",value:function(){return this._localSignalingHandler}},{key:"getRemoteSignalingHandler",value:function(){return this._remoteSignalingHandler}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(n,s){this._outerEmitter.emit(n,s)}},{key:"addSignalingListener",value:function(n,s,l){this._canIUseSignaling||(this._canIUseSignaling=!0),this._outerEmitter.on(n,s,l)}},{key:"removeSignalingListener",value:function(n,s,l){this._outerEmitter.off(n,s,l),this._outerEmitter.eventNames().length===0&&(this._canIUseSignaling=!1)}},{key:"invite",value:function(n){var s=this,l="".concat(this._n,".").concat("invite"),h=this._localSignalingHandler.createInviteInfo(n),v=h.message,I=h.customData,k=h.inviteID;return q.l("".concat(l," options:").concat(JSON.stringify(n)," inviteID:").concat(k)),this.sendSignaling(v,n).then(function(P){return P&&P.code===0?(s.setInviteInfo(k,i(i({},I),{},{message:v})),s.startTimer(i(i({},I),{},{inviteID:k})),i(i({},P),{},{inviteID:k})):P}).catch(function(P){return Re(P)})}},{key:"inviteSync",value:function(n,s,l){var h=this,v="".concat(this._n,".").concat("inviteSync"),I=this._localSignalingHandler.createInviteInfo(n),k=I.message,P=I.customData,G=I.inviteID;return q.l("".concat(v," options:").concat(JSON.stringify(n)," inviteID:").concat(G)),this.sendSignaling(k,n).then(function(Y){if(Y&&Y.code===0)return h.setInviteInfo(G,i(i({},P),{},{message:k})),h.startTimer(i(i({},P),{},{inviteID:G})),s&&s({inviteID:G}),{inviteID:G};l&&l(Y.code===0,Y.message||"")}).catch(function(Y){return l&&l(Y.code,Y.message),Re(Y)}),G}},{key:"_handleImResponse",value:function(n,s,l){s&&s.code===0&&(this._isHandling=!1,l?this.deleteInviteInfo(n.inviteID):this.updateInviteInfo(n))}},{key:"cancel",value:function(n){var s=this,h="".concat(this._n,".").concat("cancel");if(q.l("".concat(h," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return Re({code:Be.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var l=this._localSignalingHandler.createCancelCustomData(n);if(!l)return this._isHandling=!1,Re({code:Be.SIGNALING_NO_PERMISSION});var h=l.groupID,v=l.inviteeList,h=h||v[0],v=this._localSignalingHandler.createSignalingMessage(l,h);return this.sendSignaling(v,n).then(function(I){return s._handleImResponse(l,I,!0),I.code===0?i(i({},I),{},{inviteID:n.inviteID}):I}).catch(function(I){return Re(I)})}},{key:"accept",value:function(n){var s=this,l="".concat(this._n,".").concat("accept");if(q.l("".concat(l," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return Re({code:Be.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var h=this._localSignalingHandler.createAcceptCustomData(n);return h?(l=this._localSignalingHandler.createSignalingMessage(h),this.sendSignaling(l,n).then(function(v){return s._handleImResponse(h,v),v.code===0?i(i({},v),{},{inviteID:n.inviteID}):v}).catch(function(v){return Re(v)})):(this._isHandling=!1,Re({code:Be.SIGNALING_NO_PERMISSION}))}},{key:"reject",value:function(n){var s=this,l="".concat(this._n,".").concat("reject");if(q.l("".concat(l," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return Re({code:Be.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var h=this._localSignalingHandler.createRejectCustomData(n);return h?(l=this._localSignalingHandler.createSignalingMessage(h),this.sendSignaling(l,n).then(function(v){return s._handleImResponse(h,v,!0),v.code===0?i(i({},v),{},{inviteID:n.inviteID}):v}).catch(function(v){return Re(v)})):(this._isHandling=!1,Re({code:Be.SIGNALING_NO_PERMISSION}))}},{key:"getSignalingInfo",value:function(P){var s="".concat(this._n,".getSignalingInfo"),l=P.ID,h=P.from,v=P.to,I=this._filterSignalingMessage(P),k=null,P=(I&&(P=this._remoteSignalingHandler.getPayloadData(P),k=new _M(P)),I?"actionType:".concat(k.actionType):"");return q.l("".concat(s," messageID:").concat(l," from:").concat(h," to:").concat(v," ")+"".concat(P," isSignaling:").concat(I)),k}},{key:"modifyInvitation",value:function(v){var s=this,l=v.inviteID,h=v.data;if(!this.hasInviteInfo(v.inviteID)||this._isHandling)return Re({code:Be.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var v=this.getInviteInfo(l),I=v.message,k=E(v,Ub),P=I.payload.data;return k.data=h,I.payload.data=JSON.stringify(k),this.get(2).modifyRemoteMessage(I).then(function(G){return s.setInviteInfo(l,i(i({},k),{},{message:I})),s._isHandling=!1,G}).catch(function(G){return s._isHandling=!1,I.payload.data=P,Re(G)})}},{key:"_genMessageControlInfo",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},n=h.data,n=n===void 0?"":n,s=h.onlineUserOnly,I=h.inviteID,I=I===void 0?"":I,l=h.offlinePushInfo,h=h.actionType,v={_onlineOnlyFlag:!1},I={onlineUserOnly:(v=I&&this.getInviteInfo(I)?this.getInviteInfo(I).message:v)._onlineOnlyFlag||s||!1,offlinePushInfo:l,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}};return h===X.ACTION_TYPE_INVITE_TIMEOUT?(v=!!n.match(/excludeTimeoutSignalingFromHistoryMessage/),I.messageControlInfo.excludedFromUnreadCount=v,I.messageControlInfo.excludedFromLastMessage=v,I):(s=!!n.match(/excludeFromHistoryMessage/),l=!!n.match(/excludeOriginalSignalingFromHistoryMessage/),I.messageControlInfo.excludedFromUnreadCount=s||l,I.messageControlInfo.excludedFromLastMessage=s||l,I)}},{key:"sendSignaling",value:function(n,s){var l=this;return this.get(2).sendMessageInstance(n,this._genMessageControlInfo(s)).catch(function(h){return l._isHandling=!1,Re(h)})}},{key:"filterMessageList",value:function(n){var s=this;return n.filter(function(l){return s._filterSignalingMessage(l)})}},{key:"_filterSignalingMessage",value:function(n){var s,l,h=!1;return n.type&&n.type===O.MSG_CUSTOM&&(s=n.cloudCustomData,n=(n=n.payload.data)===void 0?"":n,s=(s===void 0?"":s).match(/"type":"tsignaling"/),l=n.match(/inviteID/),n=n.match(/actionType/),h=s||l&&n),!!h}},{key:"startTimer",value:function(n){var s,l,h,v=this,I="".concat(this._n,".startTimer"),k=n.timeout,P=n.inviteID,G=n.inviter,Y=n.groupID,te=G===this.getMyUserID();q.l("".concat(I," timeout:").concat(k," isInviter:").concat(te," groupID:").concat(Y)),k<=0||(s=te?k+5:k,l=1,h=setInterval(function(){var pe=v._hasLocalInviteInfo(n,te);l<s&&pe?++l:(pe&&v._sendTimeoutNotice(P,te),q.l("".concat(I," end.")),clearInterval(h))},1e3))}},{key:"_hasLocalInviteInfo",value:function(h,s){var l=h.inviteID,h=h.groupID;if(!this.hasInviteInfo(l))return!1;var v="".concat(this._n,"._hasLocalInviteInfo"),I=this.getInviteInfo(l).inviteeList;return q.l("".concat(v," inviteID:").concat(l," inviteeList:").concat(I," groupID:").concat(h)),!h||(s?0<I.length:0<I.length&&I.includes(this.getMyUserID()))}},{key:"_getReceiver",value:function(n,v){var l=v.groupID,h=v.inviteeList,v=v.inviter;return n?l||h[0]:l||v}},{key:"_sendTimeoutNotice",value:function(n,s){var l=this,h=this.getInviteInfo(n),v=this._getReceiver(s,h),I=(q.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(n," to:").concat(v," isInviter:").concat(s)),this._localSignalingHandler.createTimeoutCustomData(i(i({},h),{},{isInviter:s}))),k=this._localSignalingHandler.createSignalingMessage(I,v);return this.sendSignaling(k,I).then(function(P){var G,Y,te;P&&P.code===0&&(P=I.data,G=I.groupID,Y=I.inviteeList,te=I.inviter,l.emitEvent(X.INVITATION_TIMEOUT,{data:P,groupID:G,inviteID:n,inviteeList:Y,inviter:te,isSelfTimeout:!0,message:k}),s?l.deleteInviteInfo(n):l.updateInviteInfo(I))})}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1}}]),nu),Fb=["followTypeList"],mi={NONE:0,FOLLOWERS:1,FOLLOWING:2,MUTUAL:3},yM=(_(Bl,Uo),Ib=D(Bl),p(Bl,[{key:"_onCloudConfigUpdated",value:function(){var n=this.getCloudConfig("follow_req_count");Qe(n)||(n=Number(n),this.DEFAULT_COUNT=n>this.MAX_COUNT?this.MAX_COUNT:n,this._clearFollowList())}},{key:"clearCacheOnReconnected",value:function(){this._clearFollowList(),this._followType.clear()}},{key:"onFollowInfoNotify",value:function(h){var h=h.dataList||{},s=h.followAddList,s=s===void 0?[]:s,l=h.followDeleteList,l=l===void 0?[]:l,h=h.pushType,v=this._initFollowInfo();h===1?this._handleFollowAddList({followAddList:s,followInfo:v}):this._handleFollowDeleteList({followDeleteList:l,followInfo:v}),this._emitEvent(v),q.l("".concat(this._n,".onFollowInfoNotify pushType:").concat(h," followAddList:").concat(s.length," followDeleteList:").concat(l.length))}},{key:"_initFollowInfo",value:function(){var n={};return Object.values(mi).forEach(function(s){s!==mi.NONE&&(n[s]={userInfoList:[],isAdd:!1})}),n}},{key:"_handleFollowAddList",value:function(n){var s=this,l=n.followAddList,h=n.followInfo;l.forEach(function(v){var I=v.followTypeList,I=I===void 0?[]:I,k=E(v,Fb);I.forEach(function(P){h[P].userInfoList.push(k),h[P].isAdd=!0}),s._setFollowType(v.userID,v.followType)})}},{key:"_handleFollowDeleteList",value:function(n){var s=this,l=n.followDeleteList,h=n.followInfo;l.forEach(function(v){var I=v.followTypeList,I=I===void 0?[]:I,k=v.userID;I.forEach(function(P){h[P].userInfoList.push(k),h[P].isAdd=!1}),s._setFollowType(v.userID,v.followType)})}},{key:"_emitEvent",value:function(n){var s=this;Object.keys(n).forEach(function(h){var h=Number(h),v=n[h];0<v.userInfoList.length&&(h===mi.FOLLOWERS&&(s._clearFollowList(mi.FOLLOWERS),s.emitOuterEvent($.MY_FOLLOWERS_LIST_UPDATED,v)),h===mi.FOLLOWING&&(s._clearFollowList(mi.FOLLOWING),s.emitOuterEvent($.MY_FOLLOWING_LIST_UPDATED,v)),h===mi.MUTUAL&&(s._clearFollowList(mi.MUTUAL),s.emitOuterEvent($.MUTUAL_FOLLOWERS_LIST_UPDATED,v)))})}},{key:"followUser",value:function(n){if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility("followUser");var s="".concat(this._n,".").concat("followUser"),l="userIDList:".concat(n.length),h=new it("followUser");return h.setMessage(l),q.l("".concat(s," ").concat(l)),this.req({proto:fe.FOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:n.map(function(v){return{userID:v}})}}).then(function(v){return h.end(),q.l("".concat(s," ok.")),Ut(v.data.resultList)}).catch(function(v){return h.setError(v).end(),q.e("".concat(s," failed. error:"),v),Re(v)})}},{key:"unfollowUser",value:function(n){if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility("unfollowUser");var s="".concat(this._n,".").concat("unfollowUser"),l="userIDList:".concat(n.length),h=new it("unfollowUser");return h.setMessage(l),q.l("".concat(s," ").concat(l)),this.req({proto:fe.UNFOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:n}}).then(function(v){return h.end(),q.l("".concat(s," ok.")),Ut(v.data.resultList)}).catch(function(v){return h.setError(v).end(),q.e("".concat(s," failed. error:"),v),Re(v)})}},{key:"getMyFollowersList",value:function(){var n=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",l="getMyFollowersList";if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility(l);var h=s||this.FIRST_PAGE_INDEX;if(this._myFollowersList.has(h)){var k=this._myFollowersList.get(h),v=k.resultList,I=k.nextCursor,k=k.lastUpdateTime;if(Date.now()-k<this.MAX_CATCH_TIME&&0<v.length)return q.l("".concat(this._n,".").concat(l," nextCursor:").concat(s," from local.")),ln({resultList:v,nextCursor:I})}return this._getFollowList(s,mi.FOLLOWERS).then(function(P){return n._myFollowersList.set(h,i(i({},P),{},{lastUpdateTime:Date.now()})),q.l("".concat(n._n,".").concat(l," nextCursor:").concat(s," from remote.")),Ut(P)})}},{key:"getMyFollowingList",value:function(){var n=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",l="getMyFollowingList";if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility(l);var h=s||this.FIRST_PAGE_INDEX;if(this._myFollowingList.has(h)){var k=this._myFollowingList.get(h),v=k.resultList,I=k.nextCursor,k=k.lastUpdateTime;if(Date.now()-k<this.MAX_CATCH_TIME&&0<v.length)return q.l("".concat(this._n,".").concat(l," nextCursor:").concat(s," from local.")),ln({resultList:v,nextCursor:I})}return this._getFollowList(s,mi.FOLLOWING).then(function(P){return n._myFollowingList.set(h,i(i({},P),{},{lastUpdateTime:Date.now()})),q.l("".concat(n._n,".").concat(l," nextCursor:").concat(s," from remote.")),Ut(P)})}},{key:"getMutualFollowersList",value:function(){var n=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",l="getMutualFollowersList";if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility(l);var h=s||this.FIRST_PAGE_INDEX;if(this._myMutualFollowersList.has(h)){var k=this._myMutualFollowersList.get(h),v=k.resultList,I=k.nextCursor,k=k.lastUpdateTime;if(Date.now()-k<this.MAX_CATCH_TIME&&0<v.length)return q.l("".concat(this._n,".").concat(l," nextCursor:").concat(s," from local.")),ln({resultList:v,nextCursor:I})}return this._getFollowList(s,mi.MUTUAL).then(function(P){return n._myMutualFollowersList.set(h,i(i({},P),{},{lastUpdateTime:Date.now()})),q.l("".concat(n._n,".").concat(l," nextCursor:").concat(s," from remote.")),Ut(P)})}},{key:"_getFollowList",value:function(n,s){var l=this,h=new it("_getFollowList");return h.setMessage("nextCursor:".concat(n," type:").concat(s)),this.req({proto:fe.GET_FOLLOW,data:{fromAccount:this.getMyUserID(),count:this.DEFAULT_COUNT,nextCursor:n,type:s}}).then(function(k){h.end();var k=k.data,I=k.resultList,I=I===void 0?[]:I,k=k.nextCursor,k=k===void 0?"":k,P=[];return I.forEach(function(pe){var Y=pe.userID,te=pe.followTime,pe=pe.profileList;P.push(i({userID:Y,followTime:te},l._handleProfileItem(pe===void 0?[]:pe)))}),{resultList:P,nextCursor:k}}).catch(function(v){return h.setError(v).end(),q.e("".concat(l._n,"._getFollowList failed. error:"),v),Re(v)})}},{key:"_handleProfileItem",value:function(n){var s={};return n.forEach(function(l){switch(l.tag){case _n.NICK:s.nick=l.value;break;case _n.GENDER:s.gender=l.value;break;case _n.BIRTHDAY:s.birthday=l.value;break;case _n.LOCATION:s.location=l.value;break;case _n.SELFSIGNATURE:s.selfSignature=l.value;break;case _n.ALLOWTYPE:s.allowType=l.value;break;case _n.LANGUAGE:s.language=l.value;break;case _n.AVATAR:s.avatar=l.value;break;case _n.MESSAGESETTINGS:s.messageSettings=l.value;break;case _n.ADMINFORBIDTYPE:s.adminForbidType=l.value;break;case _n.LEVEL:s.level=l.value;break;case _n.ROLE:s.role=l.value;break;default:s[l.tag]=l.value}}),s}},{key:"getUserFollowInfo",value:function(v){if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility("getUserFollowInfo");var s=v,l=!1,h=(Qe(v)&&(s=[this.getMyUserID()],l=!0),"".concat(this._n,".").concat("getUserFollowInfo")),v="userIDList:".concat(s.length," isGetMyFollowInfo:").concat(l),I=new it("getUserFollowInfo");return I.setMessage(v),q.l("".concat(h," ").concat(v)),this.req({proto:fe.GET_FOLLOW_INFO,data:{fromAccount:this.getMyUserID(),userIDList:s}}).then(function(P){I.end(),q.l("".concat(h," ok."));var P=P.data.followInfoList,G=[];return(P===void 0?[]:P).forEach(function(ye){var te=ye.followersCount,pe=ye.followingCount,ye=ye.mutualFollowersCount;G.push({followersCount:te,followingCount:pe,mutualFollowersCount:ye})}),Ut(G)}).catch(function(k){return I.setError(k).end(),q.e("".concat(h," failed. error:"),k),Re(k)})}},{key:"checkFollowType",value:function(n){var s=this;if(!this.canIUse(ue.FOLLOW))return this.cannotUseCommercialAbility("checkFollowType");100<n.length&&(n=n.slice(0,100),q.w("".concat(l," ").concat(Ol(100))));var l="".concat(this._n,".").concat("checkFollowType"),h="userIDList length:".concat(n.length," "),v=new it("checkFollowType"),I=(v.setMessage(h),q.l("".concat(l," ").concat(h)),[]),k=[];return n.forEach(function(P){var G;s._followType.has(P)?(G=s._followType.get(P),I.push({userID:P,followType:G})):k.push(P)}),q.l("".concat(l," from local count:").concat(I.length,", from remote count:").concat(k.length,".")),k.length===0?ln(I):this.req({proto:fe.CHECK_FOLLOW_TYPE,data:{fromAccount:this.getMyUserID(),userIDList:k}}).then(function(P){return v.end(),q.l("".concat(l," ok.")),P=P.data.resultList,(P===void 0?[]:P).forEach(function(te){var Y=te.userID,te=te.followType;s._setFollowType(Y,te),I.push({userID:Y,followType:te})}),Ut(I)}).catch(function(P){return v.setError(P).end(),q.e("".concat(l," failed. error:"),P),Re(P)})}},{key:"_setFollowType",value:function(n,s){this._followType.set(n,s)}},{key:"_clearFollowList",value:function(n){if(Qe(n))return this._myFollowersList.clear(),this._myFollowingList.clear(),void this._myMutualFollowersList.clear();n!==mi.FOLLOWERS?n!==mi.FOLLOWING?n!==mi.MUTUAL||this._myMutualFollowersList.clear():this._myFollowingList.clear():this._myFollowersList.clear()}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._clearFollowList(),this._followType.clear()}}]),Bl),yh=(p(a_,[{key:"_startTimer",value:function(){var n=this._moduleMap.get(24),s=n.isWorkerEnabled();q.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(s," seed:").concat(this._checkTimer)),s?n.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),q.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var n=this._moduleMap.get(24),s=n.isWorkerEnabled();q.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(s," seed:").concat(this._checkTimer)),s?n.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){q.l("".concat(this._n,"._stopMainThreadTimer")),0<this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){q.l("".concat(this._n,"._stopMainThreadSocket"));var n=this._moduleMap.get(21);n.setIsWorkerEnabled(!0),n.reConnect()}},{key:"_startMainThreadSocket",value:function(){q.l("".concat(this._n,"._startMainThreadSocket"));var n=this._moduleMap.get(21);n.setIsWorkerEnabled(!1),n.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){q.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){q.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var n,s=Z(this._moduleMap);try{for(s.s();!(n=s.n()).done;){var l=x(n.value,2)[1];l.onCheckTimer&&l.onCheckTimer(this._checkCount)}}catch(h){s.e(h)}finally{s.f()}}},{key:"_initReadyList",value:function(){var n=this;this._readyList=[this._moduleMap.get(1)],this._readyList.forEach(function(s){s.ready(function(){return n._onModuleReady()})})}},{key:"_onModuleReady",value:function(){var n,s,l=!0;this._readyList.forEach(function(h){h.isReady()||(l=!1)}),l&&!this._isReady&&(this._isReady=!0,this._outerEmitter.emit($.SDK_READY),n=Date.now()-this._startLoginTs,q.w("SDK is ready. cost ".concat(n," ms")),this._startLoginTs=Date.now(),s=this._ssoLogForReady.getStartTs()+Fn,this._ssoLogForReady.setMessage(n).start(s).end())}},{key:"login",value:function(){this._startLoginTs===0&&($e(),this._startLoginTs=Date.now(),this._startTimer(),this._moduleMap.get(15).start(),this._ssoLogForReady=new it("sdkReady"),this._reason=Be.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOuterEmitterInstance",value:function(){return this._outerEmitter===null&&(this._outerEmitter=new Cp,n=this._outerEmitter,Nl=n,this._outerEmitter._emit=this._outerEmitter.emit,this._outerEmitter.emit=(function(s,l){var h,v,I=this;this._canIUseSignaling()&&(s===$.MESSAGE_RECEIVED&&this.get(33).onNewMessageList(l),s===$.MESSAGE_MODIFIED&&this.get(33).onMessageModified(l)),s===$.CONVERSATION_LIST_UPDATED||s===$.FRIEND_LIST_UPDATED||s===$.GROUP_LIST_UPDATED||s===$.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._eventThrottling!==!1?this._eventThrottleMap.has(s)?(h=Date.now())-(v=this._eventThrottleMap.get(s)).last<=1e3?(v.timeoutID&&clearTimeout(v.timeoutID),v.timeoutID=setTimeout(function(){v.last=Date.now(),I._outerEmitter._emit.apply(I._outerEmitter,[s,{name:s,data:I._getEventData(s)}])},1e3)):(v.last=h,this._outerEmitter._emit.apply(this._outerEmitter,[s,{name:s,data:this._getEventData(s)}])):(this._eventThrottleMap.set(s,{last:Date.now(),timeoutID:-1}),this._outerEmitter._emit.apply(this._outerEmitter,[s,{name:s,data:this._getEventData(s)}])):this._outerEmitter._emit.apply(this._outerEmitter,[s,{name:s,data:this._getEventData(s)}]):this._outerEmitter._emit.apply(this._outerEmitter,[s,{name:s,data:l}])}).bind(this)),this._outerEmitter;var n}},{key:"_canIUseSignaling",value:function(){var n=this.get(33);return!!n&&n.canIUseSignaling()}},{key:"_getEventData",value:function(n){return n===$.CONVERSATION_LIST_UPDATED?this._moduleMap.get(12).isPartialUpdatedConvs()?this._moduleMap.get(11).getPartialUpdatedConvs():this._moduleMap.get(11).getLocalConversationList():n===$.FRIEND_LIST_UPDATED?this._moduleMap.get(8).getLocalFriendList(!1):n===$.GROUP_LIST_UPDATED?this._moduleMap.get(7).getLocalGroupList():n===$.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._moduleMap.get(11).getTotalUnreadMessageCount():n===$.CONVERSATION_ID_LIST_UPDATED?this._moduleMap.get(11).getUpdatedConvIDList():void 0}},{key:"getInnerEmitterInstance",value:function(){return this._innerEmitter===null&&(this._innerEmitter=new Cp,this._innerEmitter._emit=this._innerEmitter.emit,this._innerEmitter.emit=(function(n,s){n=xn(s)&&s.data?[n,{name:n,data:s.data}]:[n,{name:n,data:s}],this._innerEmitter._emit.apply(this._innerEmitter,n)}).bind(this)),this._innerEmitter}},{key:"hasModule",value:function(n){return this._moduleMap.has(n)}},{key:"get",value:function(n){return this._moduleMap.get(n)}},{key:"canIUseModule",value:function(n){return!this._moduleMap.get(12).isUsingChatCore()||this._optionalModuleMap.has(n)}},{key:"canIUseInflate",value:function(){return!!this._moduleMap.get(37)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.get(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(n){this._reason=n}},{key:"getErrorMessage",value:function(n,s,l){return this._moduleMap.get(32).get({key:n,replacement1:s,replacement2:l,isIntl:this.isIntl()})}},{key:"outputWarning",value:function(n,s,l){n=this.getErrorMessage(n,s,l),n&&q.w(n)}},{key:"onError",value:function(n){var s="code:".concat(n.code," message:").concat(n.message);q.w("Oops! ".concat(s)),new it("error").setMessage(s).setLevel("error").end(),this.getOuterEmitterInstance().emit($.ERROR,n)}},{key:"restartTimer",value:function(){q.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var n=this.get(7);n&&n.restartPolling()}},{key:"getTimerID",value:function(){var n=this._moduleMap.get(24);return n.isWorkerEnabled()?n.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(n){return this._moduleMap.get(7).getPollingTimerID(n)}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),$e();var n,s=Z(this._moduleMap);try{for(s.s();!(n=s.n()).done;){var l=x(n.value,2)[1];l.reset&&l.reset()}}catch(k){s.e(k)}finally{s.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._outerEmitter.emit($.SDK_NOT_READY);var h,v=Z(this._eventThrottleMap);try{for(v.s();!(h=v.n()).done;){var I=x(h.value,2)[1];I.timeoutID&&clearTimeout(I.timeoutID)}}catch(k){v.e(k)}finally{v.f()}this._eventThrottleMap.clear()}}]),a_),IM=(p(s_,[{key:"defense",value:function(n,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0;if(typeof n!="string"||n.length===0||typeof s!="function")return null;if(this._funcMap.has(n)&&this._funcMap.get(n).has(s))return this._funcMap.get(n).get(s);this._funcMap.has(n)||this._funcMap.set(n,new Map);var h=null;return this._funcMap.get(n).has(s)?h=this._funcMap.get(n).get(s):(h=this._pack(n,s,l),this._funcMap.get(n).set(s,h)),h}},{key:"defenseOnce",value:function(n,s){return typeof s!="function"?null:this._pack(n,s,2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0)}},{key:"find",value:function(n,s){return typeof n!="string"||n.length===0||typeof s!="function"?null:this._funcMap.has(n)&&this._funcMap.get(n).has(s)?this._funcMap.get(n).get(s):(this._m.outputWarning("ListenerFnNotFound",n),null)}},{key:"delete",value:function(n,s){return typeof s=="function"&&!!this._funcMap.has(n)&&!!this._funcMap.get(n).has(s)&&(this._funcMap.get(n).delete(s),this._funcMap.get(n).size===0&&this._funcMap.delete(n),!0)}},{key:"_pack",value:function(n,s,l){var h=this;return function(){try{s.apply(l,Array.from(arguments))}catch(k){var v=Object.values($).indexOf(n),I="CallbackError";v!==-1&&(v=Object.keys($)[v],h._m.outputWarning(I,v,k)),h._reportCount<5&&(new it(I).setMessage("eventName:".concat(n)).setMoreMessage(k.message).end(),h._reportCount+=1)}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){q.l("".concat(this._n,".reset")),this._reportCount=0}}]),s_),bM=(p(Ns,[{key:"onError",value:function(n){this._m.onError(n)}},{key:"login",value:function(n){return this._m.login(),this._get(1).login(n)}},{key:"logout",value:function(){var n=this;return this._get(1).logout().then(function(s){return n._safetyCallbackFactory.reset(),n._m.reset(),s})}},{key:"getLoginUser",value:function(){return this._get(1).getLoginUser()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrorMessage",value:function(n,s,l){return this._m.getErrorMessage(n,s,l)}},{key:"_get",value:function(n){return this._m.get(n)}},{key:"destroy",value:function(){var n=this;return this.logout().finally(function(){n._safetyCallbackFactory.destroy(),n._m.stopTimer(),n._get(24).terminate(),n._get(21).dealloc();var s=n._m.getOuterEmitterInstance(),l=n._get(12);s.emit($.SDK_DESTROY,{SDKAppID:l.getSDKAppID()})})}},{key:"on",value:function(n,s,l){q.d("on","eventName:".concat(n)),this._m.getOuterEmitterInstance().on(n,this._safetyCallbackFactory.defense(n,s,l),l)}},{key:"once",value:function(n,s,l){q.d("once","eventName:".concat(n)),this._m.getOuterEmitterInstance().once(n,this._safetyCallbackFactory.defenseOnce(n,s,l),l||this)}},{key:"off",value:function(n,s,l,h){q.d("off","eventName:".concat(n));var v=this._safetyCallbackFactory.find(n,s);v!==null&&(this._m.getOuterEmitterInstance().off(n,v,l,h),this._safetyCallbackFactory.delete(n,s))}},{key:"registerPlugin",value:function(n){(Qe(n["tim-push"])?Qe(n["tim-offline-push-plugin"])?this._get(18):this._get(28):this._get(36)).registerPlugin(n)}},{key:"setLogLevel",value:function(n){var s;n<=0&&((s=this.getErrorMessage("TIM_ASCII_ART"))&&console.log(s),(s=this.getErrorMessage("API_REFER"))&&(Xm()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",s):console.log("IM SDK API ->",s)),(s=this.getErrorMessage("DOCS_GUIDE"))&&console.log(s),s=this.getErrorMessage("IOS_WEBVIEW_WARNING"),nt&&s&&console.warn(s)),q.setLevel(n)}},{key:"createTextMessage",value:function(n){return this._get(2).createTextMessage(n)}},{key:"createTextAtMessage",value:function(n){return this._get(2).createTextMessage(n)}},{key:"createImageMessage",value:function(n){return this._get(2).createImageMessage(n)}},{key:"createAudioMessage",value:function(n){return this._get(2).createAudioMessage(n)}},{key:"createVideoMessage",value:function(n){return this._get(2).createVideoMessage(n)}},{key:"createCustomMessage",value:function(n){return this._get(2).createCustomMessage(n)}},{key:"createFaceMessage",value:function(n){return this._get(2).createFaceMessage(n)}},{key:"createFileMessage",value:function(n){return this._get(2).createFileMessage(n)}},{key:"createLocationMessage",value:function(n){return this._get(2).createLocationMessage(n)}},{key:"createMergerMessage",value:function(n){return this._get(2).createMergerMessage(n)}},{key:"downloadMergerMessage",value:function(n){return n.type!==O.MSG_MERGER?Re({code:Be.MSG_MERGER_TYPE_INVALID}):Ct(n.payload.downloadKey)?Re({code:Be.MSG_MERGER_KEY_INVALID}):this._get(2).downloadMergerMessage(n).catch(function(s){return Re({code:Be.MSG_MERGER_DOWNLOAD_FAIL})})}},{key:"createForwardMessage",value:function(n){return this._get(2).createForwardMessage(n)}},{key:"sendMessage",value:function(n,s){return n instanceof er?this._get(2).sendMessageInstance(n,s):Re({code:Be.MSG_INSTANCE_REQUIRED})}},{key:"searchCloudMessages",value:function(n){return this._get(2).searchCloudMessages(n)}},{key:"callExperimentalAPI",value:function(n,s){return n==="sendComboMessage"?this._get(31).sendMessage(s):n==="handleGroupInvitation"?this._get(7).handleGroupInvitation(s):n==="isCommercialAbilityEnabled"?this._get(27).isFeatureEnabled(s):n==="isFeatureEnabledForStat"?this._get(27).isFeatureEnabledForStat(s):n==="isIntl"?this.isIntl():n==="sendTRTCCustomData"||n==="sendRoomCustomData"?this._get(30).sendTRTCCustomData(s):n==="getTimerID"?this._m.getTimerID():n==="getPollingTimerID"?this._m.getPollingTimerID(s):n==="setApplicationID"?(this._get(12).setApplicationID(s),void this._get(20).updateProtocolConfig()):n==="getServerConfig"?this._get(23).getServerConfig(s):n==="canIUseModule"?this._m.canIUseModule(s):n==="startMessageLongPolling"?this._get(7).startMessageLongPolling(s):n==="stopMessageLongPolling"?this._get(7).stopMessageLongPolling(s):Re({code:Be.INVALID_OPERATION})}},{key:"revokeMessage",value:function(n){return this._get(2).revokeMessage(n)}},{key:"resendMessage",value:function(n,s){return n instanceof er?this._get(2).resendMessage(n,s):Re({code:Be.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(n){return this._get(2).deleteMessage(n)}},{key:"translateText",value:function(n){return this._get(2).translateText(n)}},{key:"convertVoiceToText",value:function(n){return this._get(2).convertVoiceToText(n)}},{key:"setMessageExtensions",value:function(n,s){return this._get(3).setMessageExtensions(n,s)}},{key:"getMessageExtensions",value:function(n){return this._get(3).getMessageExtensions(n)}},{key:"deleteMessageExtensions",value:function(n,s){return this._get(3).deleteMessageExtensions(n,s)}},{key:"addMessageReaction",value:function(n,s){return this._get(34).addMessageReaction(n,s)}},{key:"removeMessageReaction",value:function(n,s){return this._get(34).removeMessageReaction(n,s)}},{key:"getMessageReactions",value:function(n){return this._get(34).getMessageReactions(n)}},{key:"getAllUserListOfMessageReaction",value:function(n){return this._get(34).getAllUserListOfMessageReaction(n)}},{key:"modifyMessage",value:function(n){return this._get(2).modifyRemoteMessage(n)}},{key:"getMessageList",value:function(n){return this._get(11).getMessageList(n)}},{key:"getMessageListHopping",value:function(n){return this._get(11).getMessageListHopping(n)}},{key:"sendMessageReadReceipt",value:function(n){return this._get(11).sendReadReceipt(n)}},{key:"getMessageReadReceiptList",value:function(n){return this._get(11).getReadReceiptList(n)}},{key:"getGroupMessageReadMemberList",value:function(n){var s=this._get(7);return s?s.getReadReceiptDetail(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"findMessage",value:function(n){return this._get(11).findMessage(n)}},{key:"setMessageRead",value:function(n){return this._get(11).setMessageRead(n)}},{key:"getConversationList",value:function(n){return this._get(11).getConversationList(n)}},{key:"getConversationProfile",value:function(n){return this._get(11).getConversationProfile(n)}},{key:"deleteConversation",value:function(n){return this._get(11).deleteConversation(n)}},{key:"setConversationDraft",value:function(n){return this._get(11).setConversationDraft(n)}},{key:"clearHistoryMessage",value:function(n){return this._get(11).clearHistoryMessage(n)}},{key:"pinConversation",value:function(n){return this._get(11).pinConversation(n)}},{key:"setAllMessageRead",value:function(n){return this._get(11).setAllMessageRead(n)}},{key:"setMessageRemindType",value:function(n){return this._get(11).setMessageRemindType(n)}},{key:"setAllReceiveMessageOpt",value:function(n){return this._get(11).setAllReceiveMessageOpt(n)}},{key:"getAllReceiveMessageOpt",value:function(){return this._get(11).getAllReceiveMessageOpt()}},{key:"getTotalUnreadMessageCount",value:function(){return this._get(11).getTotalUnreadMessageCount()}},{key:"setConversationCustomData",value:function(n){return this._get(11).setConversationCustomData(n)}},{key:"markConversation",value:function(n){return this._get(11).markConversation(n)}},{key:"getConversationGroupList",value:function(){return this._get(11).getConversationGroupList()}},{key:"createConversationGroup",value:function(n){return this._get(11).createConversationGroup(n)}},{key:"deleteConversationGroup",value:function(n){return this._get(11).deleteConversationGroup(n)}},{key:"renameConversationGroup",value:function(n){return this._get(11).renameConversationGroup(n)}},{key:"addConversationsToGroup",value:function(n){return this._get(11).addConversationsToGroup(n)}},{key:"deleteConversationsFromGroup",value:function(n){return this._get(11).deleteConversationsFromGroup(n)}},{key:"getMyProfile",value:function(){return this._get(4).getMyProfile()}},{key:"getUserProfile",value:function(n){return this._get(4).getUserProfile(n)}},{key:"updateMyProfile",value:function(n){return this._get(4).updateMyProfile(n)}},{key:"getBlacklist",value:function(){return this._get(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(n){return this._get(4).addBlacklist(n)}},{key:"removeFromBlacklist",value:function(n){return this._get(4).deleteBlacklist(n)}},{key:"setSelfStatus",value:function(n){return this._get(4).setSelfStatus(n)}},{key:"getUserStatus",value:function(n){return this._get(4).getUserStatus(n)}},{key:"subscribeUserStatus",value:function(n){return this._get(4).subscribeUserStatus(n)}},{key:"unsubscribeUserStatus",value:function(n){return this._get(4).unsubscribeUserStatus(n)}},{key:"getFriendList",value:function(){var n=this._get(8);return n?n.getLocalFriendList():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"addFriend",value:function(n){var s=this._get(8);return s?s.addFriend(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"deleteFriend",value:function(n){var s=this._get(8);return s?s.deleteFriend(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"checkFriend",value:function(n){var s=this._get(8);return s?s.checkFriend(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getFriendProfile",value:function(n){var s=this._get(8);return s?s.getFriendProfile(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"updateFriend",value:function(n){var s=this._get(8);return s?s.updateFriend(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getFriendApplicationList",value:function(){var n=this._get(8);return n?n.getLocalFriendApplicationList():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"acceptFriendApplication",value:function(n){var s=this._get(8);return s?s.acceptFriendApplication(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"refuseFriendApplication",value:function(n){var s=this._get(8);return s?s.refuseFriendApplication(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"deleteFriendApplication",value:function(n){var s=this._get(8);return s?s.deleteFriendApplication(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setFriendApplicationRead",value:function(){var n=this._get(8);return n?n.setFriendApplicationRead():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getFriendGroupList",value:function(){var n=this._get(8);return n?n.getLocalFriendGroupList():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"createFriendGroup",value:function(n){var s=this._get(8);return s?s.createFriendGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"deleteFriendGroup",value:function(n){var s=this._get(8);return s?s.deleteFriendGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"addToFriendGroup",value:function(n){var s=this._get(8);return s?s.addToFriendGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"removeFromFriendGroup",value:function(n){var s=this._get(8);return s?s.removeFromFriendGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"renameFriendGroup",value:function(n){var s=this._get(8);return s?s.renameFriendGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"followUser",value:function(n){var s=this._get(35);return s?s.followUser(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"unfollowUser",value:function(n){var s=this._get(35);return s?s.unfollowUser(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getMyFollowersList",value:function(n){var s=this._get(35);return s?s.getMyFollowersList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getMyFollowingList",value:function(n){var s=this._get(35);return s?s.getMyFollowingList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getMutualFollowersList",value:function(n){var s=this._get(35);return s?s.getMutualFollowersList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getUserFollowInfo",value:function(n){var s=this._get(35);return s?s.getUserFollowInfo(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"checkFollowType",value:function(n){var s=this._get(35);return s?s.checkFollowType(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupList",value:function(){var n=this._get(7);return n?n.getGroupList():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupProfile",value:function(n){var s=this._get(7);return s?s.getGroupProfile(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"createGroup",value:function(n){var s=this._get(7);return s?s.createGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"dismissGroup",value:function(n){var s=this._get(7);return s?s.dismissGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"updateGroupProfile",value:function(n){var s=this._get(7);return s?s.updateGroupProfile(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"joinGroup",value:function(n){var s=this._get(7);return s?s.joinGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"quitGroup",value:function(n){var s=this._get(7);return s?s.quitGroup(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"searchGroupByID",value:function(n){var s=this._get(7);return s?s.searchGroupByID(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(n){var s=this._get(7);return s?s.getGroupOnlineMemberCount(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"changeGroupOwner",value:function(n){var s=this._get(7);return s?s.changeGroupOwner(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupApplicationList",value:function(){var n=this._get(7);return n?n.getGroupApplicationList():Re({code:Be.CANNOT_FIND_MODULE})}},{key:"handleGroupApplication",value:function(n){var s=this._get(7);return s?s.handleGroupApplication(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"initGroupAttributes",value:function(n){var s=this._get(7);return s?s.initGroupAttributes(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupAttributes",value:function(n){var s=this._get(7);return s?s.setGroupAttributes(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"deleteGroupAttributes",value:function(n){var s=this._get(7);return s?s.deleteGroupAttributes(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupAttributes",value:function(n){var s=this._get(7);return s?s.getGroupAttributes(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupCounters",value:function(n){var s=this._get(7);return s?s.setGroupCounters(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"increaseGroupCounter",value:function(n){var s=this._get(7);return s?s.increaseGroupCounter(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"decreaseGroupCounter",value:function(n){var s=this._get(7);return s?s.decreaseGroupCounter(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupCounters",value:function(n){var s=this._get(7);return s?s.getGroupCounters(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupMemberList",value:function(n){var s=this._get(7);return s?s.getGroupMemberList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getGroupMemberProfile",value:function(n){var s=this._get(7);return s?s.getGroupMemberProfile(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"addGroupMember",value:function(n){var s=this._get(7);return s?s.addGroupMember(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"deleteGroupMember",value:function(n){var s=this._get(7);return s?s.deleteGroupMember(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupMemberMuteTime",value:function(n){var s=this._get(7);return s?s.setGroupMemberMuteTime(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupMemberRole",value:function(n){var s=this._get(7);return s?s.setGroupMemberRole(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupMemberNameCard",value:function(n){var s=this._get(7);return s?s.setGroupMemberNameCard(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"setGroupMemberCustomField",value:function(n){var s=this._get(7);return s?s.setGroupMemberCustomField(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"markGroupMemberList",value:function(n){var s=this._get(7);return s?s.markGroupMemberList(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._get(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(n){return this._get(10).createTopicInCommunity(n)}},{key:"deleteTopicFromCommunity",value:function(n){return this._get(10).deleteTopicFromCommunity(n)}},{key:"updateTopicProfile",value:function(n){return this._get(10).updateTopicProfile(n)}},{key:"getTopicList",value:function(n){return this._get(10).getTopicList(n)}},{key:"addSignalingListener",value:function(n,s,l){var h=this._get(33);h&&h.addSignalingListener(n,this._safetyCallbackFactory.defense(n,s,l),l)}},{key:"removeSignalingListener",value:function(n,s,l){var h,v=this._safetyCallbackFactory.find(n,s);v===null||(h=this._get(33))&&(h.removeSignalingListener(n,v,l),this._safetyCallbackFactory.delete(n,s))}},{key:"invite",value:function(n){var s=this._get(33);return s?s.invite(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"inviteSync",value:function(n,s,l){var h=this._get(33);return h?h.inviteSync(n,s,l):""}},{key:"inviteInGroup",value:function(n){var s=this._get(33);return s?s.invite(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"inviteInGroupSync",value:function(n,s,l){var h=this._get(33);return h?h.inviteSync(n,s,l):""}},{key:"cancel",value:function(n){var s=this._get(33);return s?s.cancel(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"accept",value:function(n){var s=this._get(33);return s?s.accept(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"reject",value:function(n){var s=this._get(33);return s?s.reject(n):Re({code:Be.CANNOT_FIND_MODULE})}},{key:"getSignalingInfo",value:function(n){var s=this._get(33);return s?s.getSignalingInfo(n):null}},{key:"modifyInvitation",value:function(n){var s=this._get(33);return s?s.modifyInvitation(n):Re({code:Be.CANNOT_FIND_MODULE})}}]),Ns),CM={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function Ns(n){u(this,Ns),n={SDKAppID:n.SDKAppID,unlimitedAVChatRoom:n.unlimitedAVChatRoom||!1,scene:n.scene||"",oversea:n.oversea||!1,instanceID:Pd(),devMode:n.devMode||!1,testEnv:n.testEnv||!1,proxyServer:n.proxyServer||void 0,fileUploadProxy:n.fileUploadProxy||void 0,fileDownloadProxy:n.fileDownloadProxy||n.fileUploadProxy||void 0,eventThrottling:n.eventThrottling!==!1,partialUpdatedConversations:n.partialUpdatedConversations===!0,modules:n.modules||void 0},this._m=new yh(n),this._vendorMap=new Map,this._safetyCallbackFactory=new IM(this._m)}function s_(n){u(this,s_),this._funcMap=new Map,this._m=n,this._n="SafetyCallback",this._reportCount=0}function a_(n){var s=this;u(this,a_);var l,h=new it("sdkConstruct"),P=(this._n="ModuleManager",this._isReady=!1,this._reason=Be.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._moduleMap=new Map,this._optionalModuleMap=new Map,this._innerEmitter=null,this._outerEmitter=null,this._checkCount=0,this._checkTimer=-1,this._moduleMap.set(12,new K1(this,n)),this._moduleMap.set(15,new tb(this)),this._moduleMap.set(27,new hM(this)),this._moduleMap.set(23,new kb(this)),this._moduleMap.set(24,new o_(this)),this._moduleMap.set(26,new n_(this)),this._moduleMap.set(21,new iM(this)),this._moduleMap.set(20,new aM(this)),this._moduleMap.set(1,new nh(this)),this._moduleMap.set(2,new cb(this)),this._moduleMap.set(3,new Ep(this)),this._moduleMap.set(34,new fh(this)),this._moduleMap.set(31,new ub(this)),this._moduleMap.set(4,new q1(this)),this._moduleMap.set(6,new Qd(this)),this._moduleMap.set(11,new N1(this)),this._moduleMap.set(7,new V1(this)),this._moduleMap.set(10,new JI(this)),this._moduleMap.set(13,new eb(this)),this._moduleMap.set(32,new gM(this)),this._moduleMap.set(14,new Vv(this)),this._moduleMap.set(17,new Y1(this)),this._moduleMap.set(18,new ph(this)),this._moduleMap.set(19,new db(this)),this._moduleMap.set(25,new lM(this)),this._moduleMap.set(8,new Ob(this)),this._moduleMap.set(28,new fM(this)),this._moduleMap.set(36,new pM(this)),this._moduleMap.set(29,new Nb(this)),this._moduleMap.set(30,new Lb(this)),this._moduleMap.set(33,new xb(this)),this._moduleMap.set(35,new yM(this)),this._eventThrottleMap=new Map,this._eventThrottling=n.eventThrottling,xn(n.modules)?(Object.keys(n.modules).forEach(function(G){l=n.modules[G],G==="group-module"?s._moduleMap.set(7,new l(s)):G==="relationship-module"?s._moduleMap.set(8,new l(s)):G==="signaling-module"?s._moduleMap.set(33,new l(s)):G==="follow-module"&&s._moduleMap.set(35,new l(s)),s._optionalModuleMap.set(G,1)}),this._moduleMap.get(12).setUsingChatCore(!0)):this._moduleMap.has(7)||this._moduleMap.get(12).setUsingChatCore(!0),n.instanceID),v=n.SDKAppID,I=this._moduleMap.get(12).isIntl(),k=this._moduleMap.get(12).isUsingChatCore(),P="instanceID:".concat(P," SDKAppID:").concat(v," isIntl:").concat(I," isUsingChatCore:").concat(k," host:").concat(Jm()," isIOSWebView:").concat(nt)+" inBrowser:".concat(Ae," inMiniApp:").concat(Ie)+" canIUseInflate:".concat(this.canIUseInflate())+" workerAvailable:".concat(sn," UserAgent:").concat(ot);it.bindEventStatModule(this._moduleMap.get(14)),it.bindNetMonitorModule(this._moduleMap.get(15)),h.setMessage("".concat(P," ").concat(function(){var G="";if(Ie)try{var Y=xe.getSystemInfoSync(),te=Y.model,pe=Y.version,ye=Y.system,ve=Y.platform,Ue=Y.SDKVersion,G="model:".concat(te," version:").concat(pe," system:").concat(ye," platform:").concat(ve," SDKVersion:").concat(Ue)}catch{G=""}return G}())).end(),q.i("SDK ".concat(P)),so.prototype._getErrorMessage=this.getErrorMessage.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}function Bl(n){return u(this,Bl),(n=Ib.call(this,n))._n="FollowModule",n._myFollowersList=new Map,n._myFollowingList=new Map,n._myMutualFollowersList=new Map,n._followType=new Map,n.MAX_CATCH_TIME=6e5,n.FIRST_PAGE_INDEX=ro(),n.DEFAULT_COUNT=500,n.MAX_COUNT=1e3,n.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function nu(n){return u(this,nu),(n=Zc.call(this,n))._n="SignalingModule",n._inviteInfoMap=new Map,n._outerEmitter=new Cp,n._outerEmitter._emit=n._outerEmitter.emit,n._outerEmitter.emit=(function(){this._outerEmitter._emit.apply(this._outerEmitter,[].concat([arguments.length<=0?void 0:arguments[0],{name:arguments.length<=0?void 0:arguments[0],data:arguments.length<=1?void 0:arguments[1]}]))}).bind(N(n)),n._canIUseSignaling=!1,n._isHandling=!1,n._remoteSignalingHandler=new mM(N(n)),n._localSignalingHandler=new vM(N(n)),n._historySignalingHandler=new i_(N(n)),n._isC2CUnreadHandleCompleted=!1,n._isConvSyncCompleted=!1,n._isSyncCompleted=!1,n.getInnerEmitterInstance().on(So.C2C_UNREAD_HANDLE_COMPLETED,n.onC2CUnreadHandleCompleted,N(n)),n.getInnerEmitterInstance().on(So.CONV_SYNC_COMPLETED,n.onConvSyncCompleted,N(n)),n}function ii(n){u(this,ii),this._n="HistorySignalingHandler",this._sigM=n,this.COUNT=20,this._signalingMap=new Map,this._signalingRelatedToMeMap=new Map}function l_(n){u(this,l_),this._n="LocalSignalingHandler",this._sigM=n}function c_(n){u(this,c_),this._n="RemoteSignalingHandler",this._sigM=n}function Lp(n){u(this,Lp),this._m=n,this._n="ErrorMessageModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}function u_(n){u(this,u_),this._m=n,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*","live_engine_srv.*","live_engine_http_srv.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}function ou(n){return u(this,ou),(n=t_.call(this,n))._n="ProfanityFilterModule",n._plugin=null,n._filterConfigMap=new Map,n._startIndex=0,n._version=0,n._canIUseLexicon=!1,n._isFetching=!1,n._expiredTime=0,n}function ru(n){var s;return u(this,ru),(s=bb.call(this,n))._m=n,s._n="TIMPushModule",s._pluginName="TIMPush",s._pushPlugin=void 0,s._androidPushConfig={},s._deviceToken="",s._businessID=0,s._iOSBusinessID=0,s._c2cUnreadCount=0,s._groupUnreadCount=0,s._isWebUniapp=0,s._deviceInfo={notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:"1.0.1",packageName:""},s}function Ih(n){var s;return u(this,Ih),(s=Cb.call(this,n))._m=n,s._n="OfflinePushModule",s._offlinePushPlugin=void 0,s._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},s._deviceToken="",s._businessID=0,s._iosBusinessID=0,s._c2cUnreadCount=0,s._groupUnreadCount=0,s._isWebUniapp=0,s}function Pp(n){u(this,Pp),this._m=n,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new r_(this)}function d_(n){u(this,d_),this._commercialConfigM=n,this._n="PurchasedFeatureHandler",this._isSCMReported=!1,this._featureMap=new Map}function bh(n){return u(this,bh),(n=_h.call(this,n))._n="WorkerTimerModule",n._isWorkerEnabled=!0,n._workerTimer=null,n._timerID=-1,n._init(),n.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function Ch(n){return u(this,Ch),(n=Sb.call(this,n))._n="SnsModule",n._friendHandler=new Db(N(n)),n._friendApplicationHandler=new dM(N(n)),n._friendGroupHandler=new tu(N(n)),n.getInnerEmitterInstance().on(So.A2KEY_AND_TINYID_UPDATED,n.onContextUpdated,N(n)),n}function Sh(n){u(this,Sh),this._snsM=n,this._n="FriendGroupHandler",this._friendGroupMap=new Map}function Th(n){u(this,Th),Ct(n)||(this.name=n.name||"",this.userIDList=n.userIDList||[],this.count=this.userIDList.length||0)}function h_(n){u(this,h_),this._snsM=n,this._n="FriendHandler",this._friendMap=new Map,this._startIndex=0,this._standardSequence=0,this._customSequence=0,this._expirationTime=18e4}function Eh(n,s){u(this,Eh),this.userID=n,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var l={},h=[];if(l.userID=n,!Ct(s))for(var v,I="",k=0,P=s.length;k<P;k++)if(I=s[k].tag,v=s[k].value,-1<I.indexOf("Tag_SNS_Custom"))this.friendCustomField.push({key:I,value:v});else if(-1<I.indexOf("Tag_Profile_Custom"))h.push({key:I,value:v});else switch(I){case _n.NICK:l.nick=v;break;case _n.GENDER:l.gender=v;break;case _n.BIRTHDAY:l.birthday=v;break;case _n.LOCATION:l.location=v;break;case _n.SELFSIGNATURE:l.selfSignature=v;break;case _n.ALLOWTYPE:l.allowType=v;break;case _n.LANGUAGE:l.language=v;break;case _n.AVATAR:l.avatar=v;break;case _n.MESSAGESETTINGS:l.messageSettings=v;break;case _n.ADMINFORBIDTYPE:l.adminForbidType=v;break;case _n.LEVEL:l.level=v;break;case _n.ROLE:l.role=v;break;case eo.REMARK:this.remark=v;break;case eo.ADDTIME:this.addTime=v;break;case eo.GROUP:this.groupList=JSON.parse(JSON.stringify(v));break;case eo.ADDSOURCE:this.source=v;break;case eo.ADDWORDING:break;default:q.l("snsProfileItem unknown tag->",s[k].tag)}this.profile=new eh(i(i({},l),{},{profileCustomField:h}))}function f_(n){u(this,f_),this._snsM=n,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSequence=0,this._friendApplicationMap=new Map,this._unreadCount=0}function iu(n){u(this,iu),(n=Tb.call(this,n))._n="QualityStatModule",n.TAG="im-ssolog-quality-stat",n.reportIndex=0,n.wholePeriod=!1,n._qualityItems=[qd,Kd,ua,Ds,da,Ha,kr,Hc,qc,zd],n._messageSentItems=[ua,Ds,da,Ha,kr],n._messageReceivedItems=[Hc,qc,zd],n.REPORT_INTERVAL=120,n.REPORT_SDKAPPID_BLACKLIST=[],n.REPORT_TINYID_WHITELIST=[],n._statInfoArr=[],n._avgRTT=new Ab,n._avgE2EDelay=new cM,n._rateMessageSent=new uM,n._rateMessageReceived=new Rb;var s=n.getInnerEmitterInstance();return s.on(So.A2KEY_AND_TINYID_UPDATED,n._onLoginSuccess,N(n)),s.on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}function p_(){u(this,p_),this._lastMap=new Map,this._currentMap=new Map}function Mh(){u(this,Mh),this._map=new Map}function $l(){u(this,$l),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}function Up(){u(this,Up),this._n="AvgE2EDelay",this._e2eDelayArray=[]}function Hl(n){return u(this,Hl),(n=Eb.call(this,n))._n="RecoverMessageModule",n.PULL_LIMIT_COUNT=15,n}function ql(n){return u(this,ql),(n=ga.call(this,n))._n="CloudControlModule",n._cloudConfig=new Map,n._expiredTime=0,n._version=0,n._isFetching=!1,n}function su(n){return u(this,su),(n=Mb.call(this,n))._n="SessionModule",n._platform=n.getPlatform(),n._protocolHandler=new vb(N(n)),n._messageDispatcher=new _b(N(n)),n._commandFrequencyLimitMap=new Map,n._commandRequestInfoMap=new Map,n._serverOverloadInfoMap=new Map,n._incrementalPullContactFlag=!0,n._init(),n.getInnerEmitterInstance().on(So.CLOUD_CONFIG_UPDATED,n._onCloudConfigUpdated,N(n)),n}var au={},tr={};return tr.create=function(k){var s="TencentCloudChat.create",l=0,I=k.SDKAppID;if(un(I))l=I;else if(l=parseInt(I),isNaN(I))return q.e("".concat(s," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(l&&au[l])return au[l];q.l("".concat(s));var h,v,I=new bM(i(i({},k),{},{SDKAppID:l})),k=(I.on($.SDK_DESTROY,function(P){au[P.data.SDKAppID]=null,delete au[P.data.SDKAppID]}),h=I,v=Object.create(null),Object.keys(xI).forEach(function(P){var G;h[P]&&(G=new le,v[P]=function(){var Y=Array.from(arguments);return G.use(function(te,pe){var ye=function(ve,Ue){if(ve.isReady()||CM[Ue]===1)return!0;var ut={code:ut=ve.getNotReadyReason(),message:"".concat(ve.getErrorMessage(ut)," | ").concat(Ue," | ").concat(ve.getErrorMessage(Be.SDK_IS_NOT_READY))};return ve.onError(ut),ut}(h,P);return ye===!0?pe():Re(ye)}).use(function(te,pe){if(function(ye,ve,Ue){if(ve===void 0)return!0;var ut=!0;if(xn(ve))Object.keys(ve).forEach(function(Kt){var en=ye.length===1?ye[0][Kt]:void 0;ut=!!LI(en,ve[Kt],Ue,Kt)&&ut});else if(Rt(ve))for(var mt=0;mt<ve.length;mt++)ut=!!LI(ye[mt],ve[mt],Ue,ve[mt].name)&&ut;if(ut)return ut;throw new Error("Params validate failed.")}(te,rv[P],P)===!0)return pe()}).use(function(te,pe){return h[P].apply(h,te)}),G.run(Y)})}),v);return au[l]=k,rv.hookGetAPITips(I.getErrorMessage.bind(I)),q.l("".concat(s," ok")),k},tr.TYPES=O,tr.EVENT=$,tr.TSignaling=X,tr.VERSION="3.3.5",q.l("TencentCloudChat.VERSION:".concat(tr.VERSION)),tr})})(V7);var ade=V7.exports;const Pg=la(ade);var G7={exports:{}};(function(e,t){var o;o=function(){function i($,O){var X=Object.keys($);if(Object.getOwnPropertySymbols){var le=Object.getOwnPropertySymbols($);O&&(le=le.filter(function(de){return Object.getOwnPropertyDescriptor($,de).enumerable})),X.push.apply(X,le)}return X}function c($){for(var O=1;O<arguments.length;O++){var X=arguments[O]!=null?arguments[O]:{};O%2?i(Object(X),!0).forEach(function(le){_($,le,X[le])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(X)):i(Object(X)).forEach(function(le){Object.defineProperty($,le,Object.getOwnPropertyDescriptor(X,le))})}return $}function u($){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})($)}function f($,O){if(!($ instanceof O))throw new TypeError("Cannot call a class as a function")}function p($,O){for(var X=0;X<O.length;X++){var le=O[X];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty($,le.key,le)}}function m($,O,X){return O&&p($.prototype,O),Object.defineProperty($,"prototype",{writable:!1}),$}function _($,O,X){return O in $?Object.defineProperty($,O,{value:X,enumerable:!0,configurable:!0,writable:!0}):$[O]=X,$}function b($,O){if($==null)return{};var X,le,de=function(se,ie){if(se==null)return{};var oe,ee,Q={},ue=Object.keys(se);for(ee=0;ee<ue.length;ee++)oe=ue[ee],ie.indexOf(oe)>=0||(Q[oe]=se[oe]);return Q}($,O);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols($);for(le=0;le<he.length;le++)X=he[le],O.indexOf(X)>=0||Object.prototype.propertyIsEnumerable.call($,X)&&(de[X]=$[X])}return de}var S=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,T=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,M=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,R=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,E=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,N=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",D=N&&uni.getDeviceInfo().platform.toLocaleLowerCase()==="ios",x=(N&&uni.getDeviceInfo().platform.toLocaleLowerCase(),S||T||M||R||E||N),L=T?qq:M?tt:R?swan:E?my:S?wx:N?uni:{},F=function($){if(u($)!=="object"||$===null)return!1;var O=Object.getPrototypeOf($);if(O===null)return!0;for(var X=O;Object.getPrototypeOf(X)!==null;)X=Object.getPrototypeOf(X);return O===X};function H($){if($==null)return!0;if(typeof $=="boolean")return!1;if(typeof $=="number")return $===0;if(typeof $=="string"||typeof $=="function"||Array.isArray($))return $.length===0;if($ instanceof Error)return $.message==="";if(F($)){for(var O in $)if(Object.prototype.hasOwnProperty.call($,O))return!1;return!0}return!1}var B=function(){function $(){f(this,$)}return m($,[{key:"request",value:function(O,X){var le=this,de=O.downloadUrl||"",he=(O.method||"PUT").toUpperCase(),se=O.url;if(O.qs){var ie=function(ue){var me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",be=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"=";return H(ue)?"":F(ue)?Object.keys(ue).map(function(ke){var Ye=encodeURIComponent(ke)+be;return Array.isArray(ue[ke])?ue[ke].map(function(Oe){return Ye+encodeURIComponent(Oe)}).join(me):Ye+encodeURIComponent(ue[ke])}).filter(Boolean).join(me):void 0}(O.qs);ie&&(se+="".concat(se.indexOf("?")===-1?"?":"&").concat(ie))}var oe=new XMLHttpRequest;oe.open(he,se,!0),oe.responseType=O.dataType||"text";var ee=O.headers||{};if(!H(ee))for(var Q in ee)ee.hasOwnProperty(Q)&&Q.toLowerCase()!=="content-length"&&Q.toLowerCase()!=="user-agent"&&Q.toLowerCase()!=="origin"&&Q.toLowerCase()!=="host"&&oe.setRequestHeader(Q,ee[Q]);return oe.onload=function(){if(oe.status===200)X(null,le._xhrRes(oe,le._xhrBody(oe,de)));else{var ue={code:oe.status,message:JSON.stringify(oe.responseText)};X(ue,le._xhrRes(oe,le._xhrBody(oe)))}},oe.onerror=function(ue){var me=le._xhrBody(oe),be={code:oe.status,message:JSON.stringify(oe.responseText)};me||oe.statusText||oe.status!==0||(ue.message="CORS blocked or network error"),X(be,le._xhrRes(oe,me)),be=null},O.onProgress&&oe.upload&&(oe.upload.onprogress=function(ue){var me=ue.total,be=ue.loaded,ke=Math.floor(100*be/me);O.onProgress({total:me,loaded:be,percent:(ke>=100?100:ke)/100})}),oe.send(O.resources),oe}},{key:"_xhrRes",value:function(O,X){var le={};return O.getAllResponseHeaders().trim().split(`
`).forEach(function(de){if(de){var he=de.indexOf(":"),se=de.substr(0,he).trim().toLowerCase(),ie=de.substr(he+1).trim();le[se]=ie}}),{statusCode:O.status,statusMessage:O.statusText,headers:le,data:X}}},{key:"_xhrBody",value:function(O,X){return O.status===200&&X?{location:X}:{response:O.responseText}}}]),$}(),z=["unknown","image","video","audio","log"],W=["name"],Z=function(){function $(){f(this,$)}return m($,[{key:"request",value:function(O,X){var le=this,de=O.resources,he=de===void 0?"":de,se=O.headers,ie=se===void 0?{}:se,oe=O.url,ee=O.downloadUrl,Q=ee===void 0?"":ee,ue=oe,me=null,be=Q.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),ke=decodeURIComponent(be[3]),Ye=ke.indexOf("?")>-1?ke.split("?")[0]:ke,Oe={key:O.fileKey?O.fileKey:Ye,success_action_status:200,"Content-Type":""},Ee={};if(D){var we=oe.split("?sign=");if(we.length>1){var Ge=we[1];ue="".concat(we[0],"?sign=").concat(encodeURIComponent("".concat(Ge))),Ee.sign=decodeURIComponent(Ge),Ee.signature=decodeURIComponent(Ge)}}var Ve={url:ue,header:ie,name:"file",filePath:he,formData:c(c({},Oe),Ee),timeout:O.timeout||3e5};if(E){var qe=Ve;qe.name,Ve=c(c({},b(qe,W)),{},{fileName:"file",fileType:z[O.fileType]})}return(me=L.uploadFile(c(c({},Ve),{},{success:function(st){le._handleResponse({response:st,downloadUrl:Q,callback:X})},fail:function(st){le._handleResponse({response:st,downloadUrl:Q,callback:X})}}))).onProgressUpdate&&me.onProgressUpdate(function(st){O.onProgress&&O.onProgress({total:st.totalBytesExpectedToSend,loaded:st.totalBytesSent,percent:Math.floor(st.progress)/100})}),me}},{key:"_handleResponse",value:function(O){var X=O.downloadUrl,le=O.response,de=O.callback,he=le.header,se={};if(he)for(var ie in he)he.hasOwnProperty(ie)&&(se[ie.toLowerCase()]=he[ie]);var oe=+le.statusCode;oe===200?de(null,{statusCode:oe,headers:se,data:c(c({},le.data),{},{location:X})}):de({code:oe,message:JSON.stringify(le.data)},{statusCode:oe,headers:se,data:void 0})}}]),$}();return function(){function $(){f(this,$),console.log("TIMUploadPlugin.VERSION: ".concat("1.3.0")),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=x?new Z:new B}return m($,[{key:"uploadFile",value:function(O,X){var le=this;return this.httpRequest.request(O,function(de,he){de&&le.tryCount<le.retry&&le.allowRetry(de)?(le.tryCount++,le.uploadFile(O,X)):(le.tryCount=0,X(de,he))})}},{key:"allowRetry",value:function(O){var X=!1,le=!1;if(O){var de=O.headers&&(O.headers.date||O.headers.Date)||O.error&&O.error.ServerTime;try{var he=O.error&&O.error.Code,se=O.error&&O.error.Message;(he==="RequestTimeTooSkewed"||he==="AccessDenied"&&se==="Request has expired")&&(le=!0)}catch{}if(le&&de){var ie=Date.now(),oe=Date.parse(de);Math.abs(ie+this.systemClockOffset-oe)>=3e4&&(this.systemClockOffset=oe-ie,X=!0)}else Math.floor(O.statusCode/100)===5&&(X=!0)}return X}}]),$}()},e.exports=o()})(G7);var lde=G7.exports;const cde=la(lde),ude='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',dde=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,N5=e=>Array.from(e.querySelectorAll(ude)).filter(t=>hde(t)&&dde(t)),hde=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},DT=function(e,t,...o){let i;t.includes("mouse")||t.includes("click")?i="MouseEvents":t.includes("key")?i="KeyboardEvent":i="HTMLEvents";const c=document.createEvent(i);return c.initEvent(t,...o),e.dispatchEvent(c),e},B7=e=>!e.getAttribute("aria-owns"),$7=(e,t,o)=>{const{parentNode:i}=e;if(!i)return null;const c=i.querySelectorAll(o),u=Array.prototype.indexOf.call(c,e);return c[u+t]||null},OT=e=>{e&&(e.focus(),!B7(e)&&e.click())},Jo=(e,t,{checkForDefaultPrevented:o=!0}={})=>c=>{const u=e==null?void 0:e(c);if(o===!1||!u)return t==null?void 0:t(c)},L5=e=>t=>t.pointerType==="mouse"?e(t):void 0;var fde=Object.defineProperty,pde=Object.defineProperties,gde=Object.getOwnPropertyDescriptors,P5=Object.getOwnPropertySymbols,mde=Object.prototype.hasOwnProperty,vde=Object.prototype.propertyIsEnumerable,U5=(e,t,o)=>t in e?fde(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,_de=(e,t)=>{for(var o in t||(t={}))mde.call(t,o)&&U5(e,o,t[o]);if(P5)for(var o of P5(t))vde.call(t,o)&&U5(e,o,t[o]);return e},yde=(e,t)=>pde(e,gde(t));function x5(e,t){var o;const i=Do();return hi(()=>{i.value=e()},yde(_de({},t),{flush:(o=void 0)!=null?o:"sync"})),Nm(i)}var F5;const $n=typeof window<"u",Ide=e=>typeof e<"u",$D=e=>typeof e=="function",bde=e=>typeof e=="string",vm=()=>{},Cde=$n&&((F5=window==null?void 0:window.navigator)==null?void 0:F5.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function md(e){return typeof e=="function"?e():y(e)}function H7(e,t){function o(...i){return new Promise((c,u)=>{Promise.resolve(e(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(c).catch(u)})}return o}function Sde(e,t={}){let o,i,c=vm;const u=p=>{clearTimeout(p),c(),c=vm};return p=>{const m=md(e),_=md(t.maxWait);return o&&u(o),m<=0||_!==void 0&&_<=0?(i&&(u(i),i=null),Promise.resolve(p())):new Promise((b,S)=>{c=t.rejectOnCancel?S:b,_&&!i&&(i=setTimeout(()=>{o&&u(o),i=null,b(p())},_)),o=setTimeout(()=>{i&&u(i),i=null,b(p())},m)})}}function Tde(e,t=!0,o=!0,i=!1){let c=0,u,f=!0,p=vm,m;const _=()=>{u&&(clearTimeout(u),u=void 0,p(),p=vm)};return S=>{const T=md(e),M=Date.now()-c,R=()=>m=S();return _(),T<=0?(c=Date.now(),R()):(M>T&&(o||!f)?(c=Date.now(),R()):t&&(m=new Promise((E,N)=>{p=i?N:E,u=setTimeout(()=>{c=Date.now(),f=!0,E(R()),_()},Math.max(0,T-M))})),!o&&!u&&(u=setTimeout(()=>f=!0,T)),f=!1,m)}}function Ede(e){return e}function Mde(e,t){let o,i,c;const u=ae(!0),f=()=>{u.value=!0,c()};rt(e,f,{flush:"sync"});const p=$D(t)?t:t.get,m=$D(t)?void 0:t.set,_=Tse((b,S)=>(i=b,c=S,{get(){return u.value&&(o=p(),u.value=!1),i(),o},set(T){m==null||m(T)}}));return Object.isExtensible(_)&&(_.trigger=f),_}function cI(e){return A$()?(R$(e),!0):!1}function kde(e,t=200,o={}){return H7(Sde(t,o),e)}function Ade(e,t=200,o={}){const i=ae(e.value),c=kde(()=>{i.value=e.value},t,o);return rt(e,()=>c()),i}function q7(e,t=200,o=!1,i=!0,c=!1){return H7(Tde(t,o,i,c),e)}function PN(e,t=!0){In()?fn(e):t?e():zt(e)}function Wf(e,t,o={}){const{immediate:i=!0}=o,c=ae(!1);let u=null;function f(){u&&(clearTimeout(u),u=null)}function p(){c.value=!1,f()}function m(..._){f(),c.value=!0,u=setTimeout(()=>{c.value=!1,u=null,e(..._)},md(t))}return i&&(c.value=!0,$n&&m()),cI(p),{isPending:Nm(c),start:m,stop:p}}function os(e){var t;const o=md(e);return(t=o==null?void 0:o.$el)!=null?t:o}const kd=$n?window:void 0,Rde=$n?window.document:void 0;function Oo(...e){let t,o,i,c;if(bde(e[0])||Array.isArray(e[0])?([o,i,c]=e,t=kd):[t,o,i,c]=e,!t)return vm;Array.isArray(o)||(o=[o]),Array.isArray(i)||(i=[i]);const u=[],f=()=>{u.forEach(b=>b()),u.length=0},p=(b,S,T,M)=>(b.addEventListener(S,T,M),()=>b.removeEventListener(S,T,M)),m=rt(()=>[os(t),md(c)],([b,S])=>{f(),b&&u.push(...o.flatMap(T=>i.map(M=>p(b,T,M,S))))},{immediate:!0,flush:"post"}),_=()=>{m(),f()};return cI(_),_}let V5=!1;function UN(e,t,o={}){const{window:i=kd,ignore:c=[],capture:u=!0,detectIframe:f=!1}=o;if(!i)return;Cde&&!V5&&(V5=!0,Array.from(i.document.body.children).forEach(T=>T.addEventListener("click",vm)));let p=!0;const m=T=>c.some(M=>{if(typeof M=="string")return Array.from(i.document.querySelectorAll(M)).some(R=>R===T.target||T.composedPath().includes(R));{const R=os(M);return R&&(T.target===R||T.composedPath().includes(R))}}),b=[Oo(i,"click",T=>{const M=os(e);if(!(!M||M===T.target||T.composedPath().includes(M))){if(T.detail===0&&(p=!m(T)),!p){p=!0;return}t(T)}},{passive:!0,capture:u}),Oo(i,"pointerdown",T=>{const M=os(e);M&&(p=!T.composedPath().includes(M)&&!m(T))},{passive:!0}),f&&Oo(i,"blur",T=>{var M;const R=os(e);((M=i.document.activeElement)==null?void 0:M.tagName)==="IFRAME"&&!(R!=null&&R.contains(i.document.activeElement))&&t(T)})].filter(Boolean);return()=>b.forEach(T=>T())}function wde(e={}){var t;const{window:o=kd}=e,i=(t=e.document)!=null?t:o==null?void 0:o.document,c=Mde(()=>null,()=>i==null?void 0:i.activeElement);return o&&(Oo(o,"blur",u=>{u.relatedTarget===null&&c.trigger()},!0),Oo(o,"focus",c.trigger,!0)),c}function K7(e,t=!1){const o=ae(),i=()=>o.value=!!e();return i(),PN(i,t),o}function Dde(e){return JSON.parse(JSON.stringify(e))}const G5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B5="__vueuse_ssr_handlers__";G5[B5]=G5[B5]||{};function Ode(e,t,{window:o=kd,initialValue:i=""}={}){const c=ae(i),u=K(()=>{var f;return os(t)||((f=o==null?void 0:o.document)==null?void 0:f.documentElement)});return rt([u,()=>md(e)],([f,p])=>{var m;if(f&&o){const _=(m=o.getComputedStyle(f).getPropertyValue(p))==null?void 0:m.trim();c.value=_||i}},{immediate:!0}),rt(c,f=>{var p;(p=u.value)!=null&&p.style&&u.value.style.setProperty(md(e),f)}),c}function Nde({document:e=Rde}={}){if(!e)return ae("visible");const t=ae(e.visibilityState);return Oo(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var $5=Object.getOwnPropertySymbols,Lde=Object.prototype.hasOwnProperty,Pde=Object.prototype.propertyIsEnumerable,Ude=(e,t)=>{var o={};for(var i in e)Lde.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(e!=null&&$5)for(var i of $5(e))t.indexOf(i)<0&&Pde.call(e,i)&&(o[i]=e[i]);return o};function Ko(e,t,o={}){const i=o,{window:c=kd}=i,u=Ude(i,["window"]);let f;const p=K7(()=>c&&"ResizeObserver"in c),m=()=>{f&&(f.disconnect(),f=void 0)},_=rt(()=>os(e),S=>{m(),p.value&&c&&S&&(f=new ResizeObserver(t),f.observe(S,u))},{immediate:!0,flush:"post"}),b=()=>{m(),_()};return cI(b),{isSupported:p,stop:b}}function H5(e,t={}){const{reset:o=!0,windowResize:i=!0,windowScroll:c=!0,immediate:u=!0}=t,f=ae(0),p=ae(0),m=ae(0),_=ae(0),b=ae(0),S=ae(0),T=ae(0),M=ae(0);function R(){const E=os(e);if(!E){o&&(f.value=0,p.value=0,m.value=0,_.value=0,b.value=0,S.value=0,T.value=0,M.value=0);return}const N=E.getBoundingClientRect();f.value=N.height,p.value=N.bottom,m.value=N.left,_.value=N.right,b.value=N.top,S.value=N.width,T.value=N.x,M.value=N.y}return Ko(e,R),rt(()=>os(e),E=>!E&&R()),c&&Oo("scroll",R,{capture:!0,passive:!0}),i&&Oo("resize",R,{passive:!0}),PN(()=>{u&&R()}),{height:f,bottom:p,left:m,right:_,top:b,width:S,x:T,y:M,update:R}}var q5=Object.getOwnPropertySymbols,xde=Object.prototype.hasOwnProperty,Fde=Object.prototype.propertyIsEnumerable,Vde=(e,t)=>{var o={};for(var i in e)xde.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(e!=null&&q5)for(var i of q5(e))t.indexOf(i)<0&&Fde.call(e,i)&&(o[i]=e[i]);return o};function z7(e,t,o={}){const i=o,{window:c=kd}=i,u=Vde(i,["window"]);let f;const p=K7(()=>c&&"MutationObserver"in c),m=()=>{f&&(f.disconnect(),f=void 0)},_=rt(()=>os(e),S=>{m(),p.value&&c&&S&&(f=new MutationObserver(t),f.observe(S,u))},{immediate:!0}),b=()=>{m(),_()};return cI(b),{isSupported:p,stop:b}}var K5;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(K5||(K5={}));var Gde=Object.defineProperty,z5=Object.getOwnPropertySymbols,Bde=Object.prototype.hasOwnProperty,$de=Object.prototype.propertyIsEnumerable,W5=(e,t,o)=>t in e?Gde(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Hde=(e,t)=>{for(var o in t||(t={}))Bde.call(t,o)&&W5(e,o,t[o]);if(z5)for(var o of z5(t))$de.call(t,o)&&W5(e,o,t[o]);return e};const qde={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};Hde({linear:Ede},qde);function W7(e,t,o,i={}){var c,u,f;const{clone:p=!1,passive:m=!1,eventName:_,deep:b=!1,defaultValue:S}=i,T=In(),M=o||(T==null?void 0:T.emit)||((c=T==null?void 0:T.$emit)==null?void 0:c.bind(T))||((f=(u=T==null?void 0:T.proxy)==null?void 0:u.$emit)==null?void 0:f.bind(T==null?void 0:T.proxy));let R=_;t||(t="modelValue"),R=_||R||`update:${t.toString()}`;const E=D=>p?$D(p)?p(D):Dde(D):D,N=()=>Ide(e[t])?E(e[t]):S;if(m){const D=N(),x=ae(D);return rt(()=>e[t],L=>x.value=E(L)),rt(x,L=>{(L!==e[t]||b)&&M(R,L)},{deep:b}),x}else return K({get(){return N()},set(D){M(R,D)}})}function Kde({window:e=kd}={}){if(!e)return ae(!1);const t=ae(e.document.hasFocus());return Oo(e,"blur",()=>{t.value=!1}),Oo(e,"focus",()=>{t.value=!0}),t}function zde(e={}){const{window:t=kd,initialWidth:o=1/0,initialHeight:i=1/0,listenOrientation:c=!0,includeScrollbar:u=!0}=e,f=ae(o),p=ae(i),m=()=>{t&&(u?(f.value=t.innerWidth,p.value=t.innerHeight):(f.value=t.document.documentElement.clientWidth,p.value=t.document.documentElement.clientHeight))};return m(),PN(m),Oo("resize",m,{passive:!0}),c&&Oo("orientationchange",m,{passive:!0}),{width:f,height:p}}const j7=()=>$n&&/firefox/i.test(window.navigator.userAgent),Wde=(e,t)=>{if(!$n||!e||!t)return!1;const o=e.getBoundingClientRect();let i;return t instanceof Element?i=t.getBoundingClientRect():i={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},o.top<i.bottom&&o.bottom>i.top&&o.right>i.left&&o.left<i.right},j5=e=>{let t=0,o=e;for(;o;)t+=o.offsetTop,o=o.offsetParent;return t},HD=(e,t)=>Math.abs(j5(e)-j5(t)),xN=e=>{let t,o;return e.type==="touchend"?(o=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(o=e.touches[0].clientY,t=e.touches[0].clientX):(o=e.clientY,t=e.clientX),{clientX:t,clientY:o}};function jde(e,t,o,i){const c=o-t;return e/=i/2,e<1?c/2*e*e*e+t:c/2*((e-=2)*e*e+2)+t}var Y7=typeof global=="object"&&global&&global.Object===Object&&global,Yde=typeof self=="object"&&self&&self.Object===Object&&self,Ua=Y7||Yde||Function("return this")(),oa=Ua.Symbol,J7=Object.prototype,Jde=J7.hasOwnProperty,Xde=J7.toString,Gy=oa?oa.toStringTag:void 0;function Qde(e){var t=Jde.call(e,Gy),o=e[Gy];try{e[Gy]=void 0;var i=!0}catch{}var c=Xde.call(e);return i&&(t?e[Gy]=o:delete e[Gy]),c}var Zde=Object.prototype,ehe=Zde.toString;function the(e){return ehe.call(e)}var nhe="[object Null]",ohe="[object Undefined]",Y5=oa?oa.toStringTag:void 0;function np(e){return e==null?e===void 0?ohe:nhe:Y5&&Y5 in Object(e)?Qde(e):the(e)}function Sl(e){return e!=null&&typeof e=="object"}var rhe="[object Symbol]";function ZE(e){return typeof e=="symbol"||Sl(e)&&np(e)==rhe}function FN(e,t){for(var o=-1,i=e==null?0:e.length,c=Array(i);++o<i;)c[o]=t(e[o],o,e);return c}var qi=Array.isArray,ihe=1/0,J5=oa?oa.prototype:void 0,X5=J5?J5.toString:void 0;function X7(e){if(typeof e=="string")return e;if(qi(e))return FN(e,X7)+"";if(ZE(e))return X5?X5.call(e):"";var t=e+"";return t=="0"&&1/e==-ihe?"-0":t}var she=/\s/;function ahe(e){for(var t=e.length;t--&&she.test(e.charAt(t)););return t}var lhe=/^\s+/;function che(e){return e&&e.slice(0,ahe(e)+1).replace(lhe,"")}function Ki(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Q5=NaN,uhe=/^[-+]0x[0-9a-f]+$/i,dhe=/^0b[01]+$/i,hhe=/^0o[0-7]+$/i,fhe=parseInt;function Z5(e){if(typeof e=="number")return e;if(ZE(e))return Q5;if(Ki(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ki(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=che(e);var o=dhe.test(e);return o||hhe.test(e)?fhe(e.slice(2),o?2:8):uhe.test(e)?Q5:+e}function VN(e){return e}var phe="[object AsyncFunction]",ghe="[object Function]",mhe="[object GeneratorFunction]",vhe="[object Proxy]";function GN(e){if(!Ki(e))return!1;var t=np(e);return t==ghe||t==mhe||t==phe||t==vhe}var Bw=Ua["__core-js_shared__"],e8=function(){var e=/[^.]+$/.exec(Bw&&Bw.keys&&Bw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function _he(e){return!!e8&&e8 in e}var yhe=Function.prototype,Ihe=yhe.toString;function op(e){if(e!=null){try{return Ihe.call(e)}catch{}try{return e+""}catch{}}return""}var bhe=/[\\^$.*+?()[\]{}|]/g,Che=/^\[object .+?Constructor\]$/,She=Function.prototype,The=Object.prototype,Ehe=She.toString,Mhe=The.hasOwnProperty,khe=RegExp("^"+Ehe.call(Mhe).replace(bhe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ahe(e){if(!Ki(e)||_he(e))return!1;var t=GN(e)?khe:Che;return t.test(op(e))}function Rhe(e,t){return e==null?void 0:e[t]}function rp(e,t){var o=Rhe(e,t);return Ahe(o)?o:void 0}var qD=rp(Ua,"WeakMap"),t8=Object.create,whe=function(){function e(){}return function(t){if(!Ki(t))return{};if(t8)return t8(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();function Dhe(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function Ohe(){}function Q7(e,t){var o=-1,i=e.length;for(t||(t=Array(i));++o<i;)t[o]=e[o];return t}var Nhe=800,Lhe=16,Phe=Date.now;function Uhe(e){var t=0,o=0;return function(){var i=Phe(),c=Lhe-(i-o);if(o=i,c>0){if(++t>=Nhe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function xhe(e){return function(){return e}}var _E=function(){try{var e=rp(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Fhe=_E?function(e,t){return _E(e,"toString",{configurable:!0,enumerable:!1,value:xhe(t),writable:!0})}:VN,Z7=Uhe(Fhe);function Vhe(e,t){for(var o=-1,i=e==null?0:e.length;++o<i&&t(e[o],o,e)!==!1;);return e}function eq(e,t,o,i){for(var c=e.length,u=o+(i?1:-1);i?u--:++u<c;)if(t(e[u],u,e))return u;return-1}function Ghe(e){return e!==e}function Bhe(e,t,o){for(var i=o-1,c=e.length;++i<c;)if(e[i]===t)return i;return-1}function $he(e,t,o){return t===t?Bhe(e,t,o):eq(e,Ghe,o)}function Hhe(e,t){var o=e==null?0:e.length;return!!o&&$he(e,t,0)>-1}var qhe=9007199254740991,Khe=/^(?:0|[1-9]\d*)$/;function e1(e,t){var o=typeof e;return t=t??qhe,!!t&&(o=="number"||o!="symbol"&&Khe.test(e))&&e>-1&&e%1==0&&e<t}function BN(e,t,o){t=="__proto__"&&_E?_E(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function uI(e,t){return e===t||e!==e&&t!==t}var zhe=Object.prototype,Whe=zhe.hasOwnProperty;function $N(e,t,o){var i=e[t];(!(Whe.call(e,t)&&uI(i,o))||o===void 0&&!(t in e))&&BN(e,t,o)}function xm(e,t,o,i){var c=!o;o||(o={});for(var u=-1,f=t.length;++u<f;){var p=t[u],m=void 0;m===void 0&&(m=e[p]),c?BN(o,p,m):$N(o,p,m)}return o}var n8=Math.max;function tq(e,t,o){return t=n8(t===void 0?e.length-1:t,0),function(){for(var i=arguments,c=-1,u=n8(i.length-t,0),f=Array(u);++c<u;)f[c]=i[t+c];c=-1;for(var p=Array(t+1);++c<t;)p[c]=i[c];return p[t]=o(f),Dhe(e,this,p)}}function nq(e,t){return Z7(tq(e,t,VN),e+"")}var jhe=9007199254740991;function HN(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jhe}function Fm(e){return e!=null&&HN(e.length)&&!GN(e)}function Yhe(e,t,o){if(!Ki(o))return!1;var i=typeof t;return(i=="number"?Fm(o)&&e1(t,o.length):i=="string"&&t in o)?uI(o[t],e):!1}function Jhe(e){return nq(function(t,o){var i=-1,c=o.length,u=c>1?o[c-1]:void 0,f=c>2?o[2]:void 0;for(u=e.length>3&&typeof u=="function"?(c--,u):void 0,f&&Yhe(o[0],o[1],f)&&(u=c<3?void 0:u,c=1),t=Object(t);++i<c;){var p=o[i];p&&e(t,p,i,u)}return t})}var Xhe=Object.prototype;function qN(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||Xhe;return e===o}function Qhe(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}var Zhe="[object Arguments]";function o8(e){return Sl(e)&&np(e)==Zhe}var oq=Object.prototype,efe=oq.hasOwnProperty,tfe=oq.propertyIsEnumerable,U0=o8(function(){return arguments}())?o8:function(e){return Sl(e)&&efe.call(e,"callee")&&!tfe.call(e,"callee")};function nfe(){return!1}var rq=typeof Ts=="object"&&Ts&&!Ts.nodeType&&Ts,r8=rq&&typeof Es=="object"&&Es&&!Es.nodeType&&Es,ofe=r8&&r8.exports===rq,i8=ofe?Ua.Buffer:void 0,rfe=i8?i8.isBuffer:void 0,x0=rfe||nfe,ife="[object Arguments]",sfe="[object Array]",afe="[object Boolean]",lfe="[object Date]",cfe="[object Error]",ufe="[object Function]",dfe="[object Map]",hfe="[object Number]",ffe="[object Object]",pfe="[object RegExp]",gfe="[object Set]",mfe="[object String]",vfe="[object WeakMap]",_fe="[object ArrayBuffer]",yfe="[object DataView]",Ife="[object Float32Array]",bfe="[object Float64Array]",Cfe="[object Int8Array]",Sfe="[object Int16Array]",Tfe="[object Int32Array]",Efe="[object Uint8Array]",Mfe="[object Uint8ClampedArray]",kfe="[object Uint16Array]",Afe="[object Uint32Array]",or={};or[Ife]=or[bfe]=or[Cfe]=or[Sfe]=or[Tfe]=or[Efe]=or[Mfe]=or[kfe]=or[Afe]=!0;or[ife]=or[sfe]=or[_fe]=or[afe]=or[yfe]=or[lfe]=or[cfe]=or[ufe]=or[dfe]=or[hfe]=or[ffe]=or[pfe]=or[gfe]=or[mfe]=or[vfe]=!1;function Rfe(e){return Sl(e)&&HN(e.length)&&!!or[np(e)]}function KN(e){return function(t){return e(t)}}var iq=typeof Ts=="object"&&Ts&&!Ts.nodeType&&Ts,f0=iq&&typeof Es=="object"&&Es&&!Es.nodeType&&Es,wfe=f0&&f0.exports===iq,$w=wfe&&Y7.process,_m=function(){try{var e=f0&&f0.require&&f0.require("util").types;return e||$w&&$w.binding&&$w.binding("util")}catch{}}(),s8=_m&&_m.isTypedArray,zN=s8?KN(s8):Rfe,Dfe=Object.prototype,Ofe=Dfe.hasOwnProperty;function sq(e,t){var o=qi(e),i=!o&&U0(e),c=!o&&!i&&x0(e),u=!o&&!i&&!c&&zN(e),f=o||i||c||u,p=f?Qhe(e.length,String):[],m=p.length;for(var _ in e)(t||Ofe.call(e,_))&&!(f&&(_=="length"||c&&(_=="offset"||_=="parent")||u&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||e1(_,m)))&&p.push(_);return p}function aq(e,t){return function(o){return e(t(o))}}var Nfe=aq(Object.keys,Object),Lfe=Object.prototype,Pfe=Lfe.hasOwnProperty;function Ufe(e){if(!qN(e))return Nfe(e);var t=[];for(var o in Object(e))Pfe.call(e,o)&&o!="constructor"&&t.push(o);return t}function dI(e){return Fm(e)?sq(e):Ufe(e)}function xfe(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var Ffe=Object.prototype,Vfe=Ffe.hasOwnProperty;function Gfe(e){if(!Ki(e))return xfe(e);var t=qN(e),o=[];for(var i in e)i=="constructor"&&(t||!Vfe.call(e,i))||o.push(i);return o}function hI(e){return Fm(e)?sq(e,!0):Gfe(e)}var Bfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$fe=/^\w*$/;function WN(e,t){if(qi(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||ZE(e)?!0:$fe.test(e)||!Bfe.test(e)||t!=null&&e in Object(t)}var F0=rp(Object,"create");function Hfe(){this.__data__=F0?F0(null):{},this.size=0}function qfe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Kfe="__lodash_hash_undefined__",zfe=Object.prototype,Wfe=zfe.hasOwnProperty;function jfe(e){var t=this.__data__;if(F0){var o=t[e];return o===Kfe?void 0:o}return Wfe.call(t,e)?t[e]:void 0}var Yfe=Object.prototype,Jfe=Yfe.hasOwnProperty;function Xfe(e){var t=this.__data__;return F0?t[e]!==void 0:Jfe.call(t,e)}var Qfe="__lodash_hash_undefined__";function Zfe(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=F0&&t===void 0?Qfe:t,this}function jf(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}jf.prototype.clear=Hfe;jf.prototype.delete=qfe;jf.prototype.get=jfe;jf.prototype.has=Xfe;jf.prototype.set=Zfe;function epe(){this.__data__=[],this.size=0}function t1(e,t){for(var o=e.length;o--;)if(uI(e[o][0],t))return o;return-1}var tpe=Array.prototype,npe=tpe.splice;function ope(e){var t=this.__data__,o=t1(t,e);if(o<0)return!1;var i=t.length-1;return o==i?t.pop():npe.call(t,o,1),--this.size,!0}function rpe(e){var t=this.__data__,o=t1(t,e);return o<0?void 0:t[o][1]}function ipe(e){return t1(this.__data__,e)>-1}function spe(e,t){var o=this.__data__,i=t1(o,e);return i<0?(++this.size,o.push([e,t])):o[i][1]=t,this}function Nc(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}Nc.prototype.clear=epe;Nc.prototype.delete=ope;Nc.prototype.get=rpe;Nc.prototype.has=ipe;Nc.prototype.set=spe;var V0=rp(Ua,"Map");function ape(){this.size=0,this.__data__={hash:new jf,map:new(V0||Nc),string:new jf}}function lpe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function n1(e,t){var o=e.__data__;return lpe(t)?o[typeof t=="string"?"string":"hash"]:o.map}function cpe(e){var t=n1(this,e).delete(e);return this.size-=t?1:0,t}function upe(e){return n1(this,e).get(e)}function dpe(e){return n1(this,e).has(e)}function hpe(e,t){var o=n1(this,e),i=o.size;return o.set(e,t),this.size+=o.size==i?0:1,this}function Lc(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}Lc.prototype.clear=ape;Lc.prototype.delete=cpe;Lc.prototype.get=upe;Lc.prototype.has=dpe;Lc.prototype.set=hpe;var fpe="Expected a function";function o1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(fpe);var o=function(){var i=arguments,c=t?t.apply(this,i):i[0],u=o.cache;if(u.has(c))return u.get(c);var f=e.apply(this,i);return o.cache=u.set(c,f)||u,f};return o.cache=new(o1.Cache||Lc),o}o1.Cache=Lc;var ppe=500;function gpe(e){var t=o1(e,function(i){return o.size===ppe&&o.clear(),i}),o=t.cache;return t}var mpe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vpe=/\\(\\)?/g,_pe=gpe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(mpe,function(o,i,c,u){t.push(c?u.replace(vpe,"$1"):i||o)}),t});function ype(e){return e==null?"":X7(e)}function Vm(e,t){return qi(e)?e:WN(e,t)?[e]:_pe(ype(e))}var Ipe=1/0;function Gm(e){if(typeof e=="string"||ZE(e))return e;var t=e+"";return t=="0"&&1/e==-Ipe?"-0":t}function r1(e,t){t=Vm(t,e);for(var o=0,i=t.length;e!=null&&o<i;)e=e[Gm(t[o++])];return o&&o==i?e:void 0}function ir(e,t,o){var i=e==null?void 0:r1(e,t);return i===void 0?o:i}function jN(e,t){for(var o=-1,i=t.length,c=e.length;++o<i;)e[c+o]=t[o];return e}var a8=oa?oa.isConcatSpreadable:void 0;function bpe(e){return qi(e)||U0(e)||!!(a8&&e&&e[a8])}function fI(e,t,o,i,c){var u=-1,f=e.length;for(o||(o=bpe),c||(c=[]);++u<f;){var p=e[u];t>0&&o(p)?t>1?fI(p,t-1,o,i,c):jN(c,p):i||(c[c.length]=p)}return c}function lq(e){var t=e==null?0:e.length;return t?fI(e,1):[]}function cq(e){return Z7(tq(e,void 0,lq),e+"")}var YN=aq(Object.getPrototypeOf,Object),Cpe="[object Object]",Spe=Function.prototype,Tpe=Object.prototype,uq=Spe.toString,Epe=Tpe.hasOwnProperty,Mpe=uq.call(Object);function dq(e){if(!Sl(e)||np(e)!=Cpe)return!1;var t=YN(e);if(t===null)return!0;var o=Epe.call(t,"constructor")&&t.constructor;return typeof o=="function"&&o instanceof o&&uq.call(o)==Mpe}function kpe(e,t,o){var i=-1,c=e.length;t<0&&(t=-t>c?0:c+t),o=o>c?c:o,o<0&&(o+=c),c=t>o?0:o-t>>>0,t>>>=0;for(var u=Array(c);++i<c;)u[i]=e[i+t];return u}function vd(){if(!arguments.length)return[];var e=arguments[0];return qi(e)?e:[e]}function Ape(){this.__data__=new Nc,this.size=0}function Rpe(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function wpe(e){return this.__data__.get(e)}function Dpe(e){return this.__data__.has(e)}var Ope=200;function Npe(e,t){var o=this.__data__;if(o instanceof Nc){var i=o.__data__;if(!V0||i.length<Ope-1)return i.push([e,t]),this.size=++o.size,this;o=this.__data__=new Lc(i)}return o.set(e,t),this.size=o.size,this}function Oa(e){var t=this.__data__=new Nc(e);this.size=t.size}Oa.prototype.clear=Ape;Oa.prototype.delete=Rpe;Oa.prototype.get=wpe;Oa.prototype.has=Dpe;Oa.prototype.set=Npe;function Lpe(e,t){return e&&xm(t,dI(t),e)}function Ppe(e,t){return e&&xm(t,hI(t),e)}var hq=typeof Ts=="object"&&Ts&&!Ts.nodeType&&Ts,l8=hq&&typeof Es=="object"&&Es&&!Es.nodeType&&Es,Upe=l8&&l8.exports===hq,c8=Upe?Ua.Buffer:void 0,u8=c8?c8.allocUnsafe:void 0;function fq(e,t){if(t)return e.slice();var o=e.length,i=u8?u8(o):new e.constructor(o);return e.copy(i),i}function xpe(e,t){for(var o=-1,i=e==null?0:e.length,c=0,u=[];++o<i;){var f=e[o];t(f,o,e)&&(u[c++]=f)}return u}function pq(){return[]}var Fpe=Object.prototype,Vpe=Fpe.propertyIsEnumerable,d8=Object.getOwnPropertySymbols,JN=d8?function(e){return e==null?[]:(e=Object(e),xpe(d8(e),function(t){return Vpe.call(e,t)}))}:pq;function Gpe(e,t){return xm(e,JN(e),t)}var Bpe=Object.getOwnPropertySymbols,gq=Bpe?function(e){for(var t=[];e;)jN(t,JN(e)),e=YN(e);return t}:pq;function $pe(e,t){return xm(e,gq(e),t)}function mq(e,t,o){var i=t(e);return qi(e)?i:jN(i,o(e))}function KD(e){return mq(e,dI,JN)}function vq(e){return mq(e,hI,gq)}var zD=rp(Ua,"DataView"),WD=rp(Ua,"Promise"),rm=rp(Ua,"Set"),h8="[object Map]",Hpe="[object Object]",f8="[object Promise]",p8="[object Set]",g8="[object WeakMap]",m8="[object DataView]",qpe=op(zD),Kpe=op(V0),zpe=op(WD),Wpe=op(rm),jpe=op(qD),Aa=np;(zD&&Aa(new zD(new ArrayBuffer(1)))!=m8||V0&&Aa(new V0)!=h8||WD&&Aa(WD.resolve())!=f8||rm&&Aa(new rm)!=p8||qD&&Aa(new qD)!=g8)&&(Aa=function(e){var t=np(e),o=t==Hpe?e.constructor:void 0,i=o?op(o):"";if(i)switch(i){case qpe:return m8;case Kpe:return h8;case zpe:return f8;case Wpe:return p8;case jpe:return g8}return t});var Ype=Object.prototype,Jpe=Ype.hasOwnProperty;function Xpe(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&Jpe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var yE=Ua.Uint8Array;function XN(e){var t=new e.constructor(e.byteLength);return new yE(t).set(new yE(e)),t}function Qpe(e,t){var o=t?XN(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var Zpe=/\w*$/;function ege(e){var t=new e.constructor(e.source,Zpe.exec(e));return t.lastIndex=e.lastIndex,t}var v8=oa?oa.prototype:void 0,_8=v8?v8.valueOf:void 0;function tge(e){return _8?Object(_8.call(e)):{}}function _q(e,t){var o=t?XN(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var nge="[object Boolean]",oge="[object Date]",rge="[object Map]",ige="[object Number]",sge="[object RegExp]",age="[object Set]",lge="[object String]",cge="[object Symbol]",uge="[object ArrayBuffer]",dge="[object DataView]",hge="[object Float32Array]",fge="[object Float64Array]",pge="[object Int8Array]",gge="[object Int16Array]",mge="[object Int32Array]",vge="[object Uint8Array]",_ge="[object Uint8ClampedArray]",yge="[object Uint16Array]",Ige="[object Uint32Array]";function bge(e,t,o){var i=e.constructor;switch(t){case uge:return XN(e);case nge:case oge:return new i(+e);case dge:return Qpe(e,o);case hge:case fge:case pge:case gge:case mge:case vge:case _ge:case yge:case Ige:return _q(e,o);case rge:return new i;case ige:case lge:return new i(e);case sge:return ege(e);case age:return new i;case cge:return tge(e)}}function yq(e){return typeof e.constructor=="function"&&!qN(e)?whe(YN(e)):{}}var Cge="[object Map]";function Sge(e){return Sl(e)&&Aa(e)==Cge}var y8=_m&&_m.isMap,Tge=y8?KN(y8):Sge,Ege="[object Set]";function Mge(e){return Sl(e)&&Aa(e)==Ege}var I8=_m&&_m.isSet,kge=I8?KN(I8):Mge,Age=1,Rge=2,wge=4,Iq="[object Arguments]",Dge="[object Array]",Oge="[object Boolean]",Nge="[object Date]",Lge="[object Error]",bq="[object Function]",Pge="[object GeneratorFunction]",Uge="[object Map]",xge="[object Number]",Cq="[object Object]",Fge="[object RegExp]",Vge="[object Set]",Gge="[object String]",Bge="[object Symbol]",$ge="[object WeakMap]",Hge="[object ArrayBuffer]",qge="[object DataView]",Kge="[object Float32Array]",zge="[object Float64Array]",Wge="[object Int8Array]",jge="[object Int16Array]",Yge="[object Int32Array]",Jge="[object Uint8Array]",Xge="[object Uint8ClampedArray]",Qge="[object Uint16Array]",Zge="[object Uint32Array]",Yo={};Yo[Iq]=Yo[Dge]=Yo[Hge]=Yo[qge]=Yo[Oge]=Yo[Nge]=Yo[Kge]=Yo[zge]=Yo[Wge]=Yo[jge]=Yo[Yge]=Yo[Uge]=Yo[xge]=Yo[Cq]=Yo[Fge]=Yo[Vge]=Yo[Gge]=Yo[Bge]=Yo[Jge]=Yo[Xge]=Yo[Qge]=Yo[Zge]=!0;Yo[Lge]=Yo[bq]=Yo[$ge]=!1;function im(e,t,o,i,c,u){var f,p=t&Age,m=t&Rge,_=t&wge;if(o&&(f=c?o(e,i,c,u):o(e)),f!==void 0)return f;if(!Ki(e))return e;var b=qi(e);if(b){if(f=Xpe(e),!p)return Q7(e,f)}else{var S=Aa(e),T=S==bq||S==Pge;if(x0(e))return fq(e,p);if(S==Cq||S==Iq||T&&!c){if(f=m||T?{}:yq(e),!p)return m?$pe(e,Ppe(f,e)):Gpe(e,Lpe(f,e))}else{if(!Yo[S])return c?e:{};f=bge(e,S,p)}}u||(u=new Oa);var M=u.get(e);if(M)return M;u.set(e,f),kge(e)?e.forEach(function(N){f.add(im(N,t,o,N,e,u))}):Tge(e)&&e.forEach(function(N,D){f.set(D,im(N,t,o,D,e,u))});var R=_?m?vq:KD:m?hI:dI,E=b?void 0:R(e);return Vhe(E||e,function(N,D){E&&(D=N,N=e[D]),$N(f,D,im(N,t,o,D,e,u))}),f}var eme=4;function b8(e){return im(e,eme)}var tme=1,nme=4;function IE(e){return im(e,tme|nme)}var ome="__lodash_hash_undefined__";function rme(e){return this.__data__.set(e,ome),this}function ime(e){return this.__data__.has(e)}function G0(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new Lc;++t<o;)this.add(e[t])}G0.prototype.add=G0.prototype.push=rme;G0.prototype.has=ime;function sme(e,t){for(var o=-1,i=e==null?0:e.length;++o<i;)if(t(e[o],o,e))return!0;return!1}function Sq(e,t){return e.has(t)}var ame=1,lme=2;function Tq(e,t,o,i,c,u){var f=o&ame,p=e.length,m=t.length;if(p!=m&&!(f&&m>p))return!1;var _=u.get(e),b=u.get(t);if(_&&b)return _==t&&b==e;var S=-1,T=!0,M=o&lme?new G0:void 0;for(u.set(e,t),u.set(t,e);++S<p;){var R=e[S],E=t[S];if(i)var N=f?i(E,R,S,t,e,u):i(R,E,S,e,t,u);if(N!==void 0){if(N)continue;T=!1;break}if(M){if(!sme(t,function(D,x){if(!Sq(M,x)&&(R===D||c(R,D,o,i,u)))return M.push(x)})){T=!1;break}}else if(!(R===E||c(R,E,o,i,u))){T=!1;break}}return u.delete(e),u.delete(t),T}function cme(e){var t=-1,o=Array(e.size);return e.forEach(function(i,c){o[++t]=[c,i]}),o}function QN(e){var t=-1,o=Array(e.size);return e.forEach(function(i){o[++t]=i}),o}var ume=1,dme=2,hme="[object Boolean]",fme="[object Date]",pme="[object Error]",gme="[object Map]",mme="[object Number]",vme="[object RegExp]",_me="[object Set]",yme="[object String]",Ime="[object Symbol]",bme="[object ArrayBuffer]",Cme="[object DataView]",C8=oa?oa.prototype:void 0,Hw=C8?C8.valueOf:void 0;function Sme(e,t,o,i,c,u,f){switch(o){case Cme:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case bme:return!(e.byteLength!=t.byteLength||!u(new yE(e),new yE(t)));case hme:case fme:case mme:return uI(+e,+t);case pme:return e.name==t.name&&e.message==t.message;case vme:case yme:return e==t+"";case gme:var p=cme;case _me:var m=i&ume;if(p||(p=QN),e.size!=t.size&&!m)return!1;var _=f.get(e);if(_)return _==t;i|=dme,f.set(e,t);var b=Tq(p(e),p(t),i,c,u,f);return f.delete(e),b;case Ime:if(Hw)return Hw.call(e)==Hw.call(t)}return!1}var Tme=1,Eme=Object.prototype,Mme=Eme.hasOwnProperty;function kme(e,t,o,i,c,u){var f=o&Tme,p=KD(e),m=p.length,_=KD(t),b=_.length;if(m!=b&&!f)return!1;for(var S=m;S--;){var T=p[S];if(!(f?T in t:Mme.call(t,T)))return!1}var M=u.get(e),R=u.get(t);if(M&&R)return M==t&&R==e;var E=!0;u.set(e,t),u.set(t,e);for(var N=f;++S<m;){T=p[S];var D=e[T],x=t[T];if(i)var L=f?i(x,D,T,t,e,u):i(D,x,T,e,t,u);if(!(L===void 0?D===x||c(D,x,o,i,u):L)){E=!1;break}N||(N=T=="constructor")}if(E&&!N){var F=e.constructor,H=t.constructor;F!=H&&"constructor"in e&&"constructor"in t&&!(typeof F=="function"&&F instanceof F&&typeof H=="function"&&H instanceof H)&&(E=!1)}return u.delete(e),u.delete(t),E}var Ame=1,S8="[object Arguments]",T8="[object Array]",nT="[object Object]",Rme=Object.prototype,E8=Rme.hasOwnProperty;function wme(e,t,o,i,c,u){var f=qi(e),p=qi(t),m=f?T8:Aa(e),_=p?T8:Aa(t);m=m==S8?nT:m,_=_==S8?nT:_;var b=m==nT,S=_==nT,T=m==_;if(T&&x0(e)){if(!x0(t))return!1;f=!0,b=!1}if(T&&!b)return u||(u=new Oa),f||zN(e)?Tq(e,t,o,i,c,u):Sme(e,t,m,o,i,c,u);if(!(o&Ame)){var M=b&&E8.call(e,"__wrapped__"),R=S&&E8.call(t,"__wrapped__");if(M||R){var E=M?e.value():e,N=R?t.value():t;return u||(u=new Oa),c(E,N,o,i,u)}}return T?(u||(u=new Oa),kme(e,t,o,i,c,u)):!1}function i1(e,t,o,i,c){return e===t?!0:e==null||t==null||!Sl(e)&&!Sl(t)?e!==e&&t!==t:wme(e,t,o,i,i1,c)}var Dme=1,Ome=2;function Nme(e,t,o,i){var c=o.length,u=c;if(e==null)return!u;for(e=Object(e);c--;){var f=o[c];if(f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++c<u;){f=o[c];var p=f[0],m=e[p],_=f[1];if(f[2]){if(m===void 0&&!(p in e))return!1}else{var b=new Oa,S;if(!(S===void 0?i1(_,m,Dme|Ome,i,b):S))return!1}}return!0}function Eq(e){return e===e&&!Ki(e)}function Lme(e){for(var t=dI(e),o=t.length;o--;){var i=t[o],c=e[i];t[o]=[i,c,Eq(c)]}return t}function Mq(e,t){return function(o){return o==null?!1:o[e]===t&&(t!==void 0||e in Object(o))}}function Pme(e){var t=Lme(e);return t.length==1&&t[0][2]?Mq(t[0][0],t[0][1]):function(o){return o===e||Nme(o,e,t)}}function Ume(e,t){return e!=null&&t in Object(e)}function xme(e,t,o){t=Vm(t,e);for(var i=-1,c=t.length,u=!1;++i<c;){var f=Gm(t[i]);if(!(u=e!=null&&o(e,f)))break;e=e[f]}return u||++i!=c?u:(c=e==null?0:e.length,!!c&&HN(c)&&e1(f,c)&&(qi(e)||U0(e)))}function kq(e,t){return e!=null&&xme(e,t,Ume)}var Fme=1,Vme=2;function Gme(e,t){return WN(e)&&Eq(t)?Mq(Gm(e),t):function(o){var i=ir(o,e);return i===void 0&&i===t?kq(o,e):i1(t,i,Fme|Vme)}}function Bme(e){return function(t){return t==null?void 0:t[e]}}function $me(e){return function(t){return r1(t,e)}}function Hme(e){return WN(e)?Bme(Gm(e)):$me(e)}function Aq(e){return typeof e=="function"?e:e==null?VN:typeof e=="object"?qi(e)?Gme(e[0],e[1]):Pme(e):Hme(e)}function qme(e){return function(t,o,i){for(var c=-1,u=Object(t),f=i(t),p=f.length;p--;){var m=f[++c];if(o(u[m],m,u)===!1)break}return t}}var Rq=qme();function Kme(e,t){return e&&Rq(e,t,dI)}function zme(e,t){return function(o,i){if(o==null)return o;if(!Fm(o))return e(o,i);for(var c=o.length,u=-1,f=Object(o);++u<c&&i(f[u],u,f)!==!1;);return o}}var Wme=zme(Kme),qw=function(){return Ua.Date.now()},jme="Expected a function",Yme=Math.max,Jme=Math.min;function as(e,t,o){var i,c,u,f,p,m,_=0,b=!1,S=!1,T=!0;if(typeof e!="function")throw new TypeError(jme);t=Z5(t)||0,Ki(o)&&(b=!!o.leading,S="maxWait"in o,u=S?Yme(Z5(o.maxWait)||0,t):u,T="trailing"in o?!!o.trailing:T);function M(B){var z=i,W=c;return i=c=void 0,_=B,f=e.apply(W,z),f}function R(B){return _=B,p=setTimeout(D,t),b?M(B):f}function E(B){var z=B-m,W=B-_,Z=t-z;return S?Jme(Z,u-W):Z}function N(B){var z=B-m,W=B-_;return m===void 0||z>=t||z<0||S&&W>=u}function D(){var B=qw();if(N(B))return x(B);p=setTimeout(D,E(B))}function x(B){return p=void 0,T&&i?M(B):(i=c=void 0,f)}function L(){p!==void 0&&clearTimeout(p),_=0,i=m=c=p=void 0}function F(){return p===void 0?f:x(qw())}function H(){var B=qw(),z=N(B);if(i=arguments,c=this,m=B,z){if(p===void 0)return R(m);if(S)return clearTimeout(p),p=setTimeout(D,t),M(m)}return p===void 0&&(p=setTimeout(D,t)),f}return H.cancel=L,H.flush=F,H}function jD(e,t,o){(o!==void 0&&!uI(e[t],o)||o===void 0&&!(t in e))&&BN(e,t,o)}function wq(e){return Sl(e)&&Fm(e)}function YD(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function Xme(e){return xm(e,hI(e))}function Qme(e,t,o,i,c,u,f){var p=YD(e,o),m=YD(t,o),_=f.get(m);if(_){jD(e,o,_);return}var b=u?u(p,m,o+"",e,t,f):void 0,S=b===void 0;if(S){var T=qi(m),M=!T&&x0(m),R=!T&&!M&&zN(m);b=m,T||M||R?qi(p)?b=p:wq(p)?b=Q7(p):M?(S=!1,b=fq(m,!0)):R?(S=!1,b=_q(m,!0)):b=[]:dq(m)||U0(m)?(b=p,U0(p)?b=Xme(p):(!Ki(p)||GN(p))&&(b=yq(m))):S=!1}S&&(f.set(m,b),c(b,m,i,u,f),f.delete(m)),jD(e,o,b)}function Dq(e,t,o,i,c){e!==t&&Rq(t,function(u,f){if(c||(c=new Oa),Ki(u))Qme(e,t,f,o,Dq,i,c);else{var p=i?i(YD(e,f),u,f+"",e,t,c):void 0;p===void 0&&(p=u),jD(e,f,p)}},hI)}function Zme(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function Oq(e,t,o){var i=e==null?0:e.length;if(!i)return-1;var c=i-1;return eq(e,Aq(t),c,!0)}function eve(e,t){var o=-1,i=Fm(e)?Array(e.length):[];return Wme(e,function(c,u,f){i[++o]=t(c,u,f)}),i}function tve(e,t){var o=qi(e)?FN:eve;return o(e,Aq(t))}function nve(e,t){return fI(tve(e,t),1)}var ove=1/0;function rve(e){var t=e==null?0:e.length;return t?fI(e,ove):[]}function bE(e){for(var t=-1,o=e==null?0:e.length,i={};++t<o;){var c=e[t];i[c[0]]=c[1]}return i}function ive(e,t){return t.length<2?e:r1(e,kpe(t,0,-1))}function Ri(e,t){return i1(e,t)}function Hr(e){return e==null}function Nq(e){return e===void 0}var sve=Jhe(function(e,t,o){Dq(e,t,o)});function ave(e,t){return t=Vm(t,e),e=ive(e,t),e==null||delete e[Gm(Zme(t))]}function lve(e){return dq(e)?void 0:e}var cve=1,uve=2,dve=4,hve=cq(function(e,t){var o={};if(e==null)return o;var i=!1;t=FN(t,function(u){return u=Vm(u,e),i||(i=u.length>1),u}),xm(e,vq(e),o),i&&(o=im(o,cve|uve|dve,lve));for(var c=t.length;c--;)ave(o,t[c]);return o});function Lq(e,t,o,i){if(!Ki(e))return e;t=Vm(t,e);for(var c=-1,u=t.length,f=u-1,p=e;p!=null&&++c<u;){var m=Gm(t[c]),_=o;if(m==="__proto__"||m==="constructor"||m==="prototype")return e;if(c!=f){var b=p[m];_=void 0,_===void 0&&(_=Ki(b)?b:e1(t[c+1])?[]:{})}$N(p,m,_),p=p[m]}return e}function fve(e,t,o){for(var i=-1,c=t.length,u={};++i<c;){var f=t[i],p=r1(e,f);o(p,f)&&Lq(u,Vm(f,e),p)}return u}function pve(e,t){return fve(e,t,function(o,i){return kq(e,i)})}var Il=cq(function(e,t){return e==null?{}:pve(e,t)});function gve(e,t,o){return e==null?e:Lq(e,t,o)}var mve="Expected a function";function $f(e,t,o){var i=!0,c=!0;if(typeof e!="function")throw new TypeError(mve);return Ki(o)&&(i="leading"in o?!!o.leading:i,c="trailing"in o?!!o.trailing:c),as(e,t,{leading:i,maxWait:t,trailing:c})}var vve=1/0,_ve=rm&&1/QN(new rm([,-0]))[1]==vve?function(e){return new rm(e)}:Ohe,yve=200;function Ive(e,t,o){var i=-1,c=Hhe,u=e.length,f=!0,p=[],m=p;if(u>=yve){var _=_ve(e);if(_)return QN(_);f=!1,c=Sq,m=new G0}else m=p;e:for(;++i<u;){var b=e[i],S=b;if(b=b!==0?b:0,f&&S===S){for(var T=m.length;T--;)if(m[T]===S)continue e;p.push(b)}else c(m,S,o)||(m!==p&&m.push(S),p.push(b))}return p}var Kw=nq(function(e){return Ive(fI(e,1,wq,!0))});const _r=e=>e===void 0,yr=e=>typeof e=="boolean",Zt=e=>typeof e=="number",Ys=e=>!e&&e!==0||At(e)&&e.length===0||En(e)&&!Object.keys(e).length,ra=e=>typeof Element>"u"?!1:e instanceof Element,Yf=e=>Hr(e),bve=e=>on(e)?!Number.isNaN(Number(e)):!1,s1=e=>e===window,_d=e=>$n?window.requestAnimationFrame(e):setTimeout(e,16),Jf=e=>$n?window.cancelAnimationFrame(e):clearTimeout(e),ZN=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),yl=e=>oI(e),ym=e=>Object.keys(e),Cve=e=>Object.entries(e),NT=(e,t,o)=>({get value(){return ir(e,t,o)},set value(i){gve(e,t,i)}});class Sve extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function wr(e,t){throw new Sve(`[${e}] ${t}`)}const Pq=(e="")=>e.split(" ").filter(t=>!!t.trim()),ea=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Js=(e,t)=>{!e||!t.trim()||e.classList.add(...Pq(t))},wi=(e,t)=>{!e||!t.trim()||e.classList.remove(...Pq(t))},td=(e,t)=>{var o;if(!$n||!e||!t)return"";let i=na(t);i==="float"&&(i="cssFloat");try{const c=e.style[i];if(c)return c;const u=(o=document.defaultView)==null?void 0:o.getComputedStyle(e,"");return u?u[i]:""}catch{return e.style[i]}};function Xo(e,t="px"){if(!e)return"";if(Zt(e)||bve(e))return`${e}${t}`;if(on(e))return e}const Tve=(e,t)=>{if(!$n)return!1;const o={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],i=td(e,o);return["scroll","auto","overlay"].some(c=>i.includes(c))},eL=(e,t)=>{if(!$n)return;let o=e;for(;o;){if([window,document,document.documentElement].includes(o))return window;if(Tve(o,t))return o;o=o.parentNode}return o};let oT;const Uq=e=>{var t;if(!$n)return 0;if(oT!==void 0)return oT;const o=document.createElement("div");o.className=`${e}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const i=o.offsetWidth;o.style.overflow="scroll";const c=document.createElement("div");c.style.width="100%",o.appendChild(c);const u=c.offsetWidth;return(t=o.parentNode)==null||t.removeChild(o),oT=i-u,oT};function xq(e,t){if(!$n)return;if(!t){e.scrollTop=0;return}const o=[];let i=t.offsetParent;for(;i!==null&&e!==i&&e.contains(i);)o.push(i),i=i.offsetParent;const c=t.offsetTop+o.reduce((m,_)=>m+_.offsetTop,0),u=c+t.offsetHeight,f=e.scrollTop,p=f+e.clientHeight;c<f?e.scrollTop=c:u>p&&(e.scrollTop=u-e.clientHeight)}function Eve(e,t,o,i,c){const u=Date.now();let f;const p=()=>{const _=Date.now()-u,b=jde(_>i?i:_,t,o,i);s1(e)?e.scrollTo(window.pageXOffset,b):e.scrollTop=b,_<i?f=_d(p):typeof c=="function"&&c()};return p(),()=>{f&&Jf(f)}}const M8=(e,t)=>s1(t)?e.ownerDocument.documentElement:t,k8=e=>s1(e)?window.scrollY:e.scrollTop,rT=e=>{if(!$n||e==="")return null;if(on(e))try{return document.querySelector(e)}catch{return null}return e};/*! Element Plus Icons Vue v2.3.1 */var Mve=Se({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),Pc=Mve,kve=Se({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),yd=kve,Ave=Se({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),$i=Ave,Rve=Se({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),tL=Rve,wve=Se({name:"Back",__name:"back",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ce("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),Dve=wve,Ove=Se({name:"Calendar",__name:"calendar",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),Nve=Ove,Lve=Se({name:"CaretRight",__name:"caret-right",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),Fq=Lve,Pve=Se({name:"CaretTop",__name:"caret-top",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),Uve=Pve,xve=Se({name:"Check",__name:"check",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),pI=xve,Fve=Se({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),Vve=Fve,Gve=Se({name:"CircleCheck",__name:"circle-check",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ce("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),nL=Gve,Bve=Se({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),oL=Bve,$ve=Se({name:"CircleClose",__name:"circle-close",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ce("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),Ad=$ve,Hve=Se({name:"Clock",__name:"clock",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ce("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ce("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),Vq=Hve,qve=Se({name:"Close",__name:"close",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),La=qve,Kve=Se({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Im=Kve,zve=Se({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),bm=zve,Wve=Se({name:"Delete",__name:"delete",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),jve=Wve,Yve=Se({name:"Document",__name:"document",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),Jve=Yve,Xve=Se({name:"FullScreen",__name:"full-screen",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),Qve=Xve,Zve=Se({name:"Hide",__name:"hide",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ce("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),e_e=Zve,t_e=Se({name:"InfoFilled",__name:"info-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),rL=t_e,n_e=Se({name:"Loading",__name:"loading",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Rd=n_e,o_e=Se({name:"Minus",__name:"minus",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),r_e=o_e,i_e=Se({name:"MoreFilled",__name:"more-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),A8=i_e,s_e=Se({name:"More",__name:"more",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),a_e=s_e,l_e=Se({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),c_e=l_e,u_e=Se({name:"Plus",__name:"plus",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),Gq=u_e,d_e=Se({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),h_e=d_e,f_e=Se({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),p_e=f_e,g_e=Se({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),m_e=g_e,v_e=Se({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),__e=v_e,y_e=Se({name:"Search",__name:"search",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),I_e=y_e,b_e=Se({name:"SortDown",__name:"sort-down",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),C_e=b_e,S_e=Se({name:"SortUp",__name:"sort-up",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),T_e=S_e,E_e=Se({name:"StarFilled",__name:"star-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),iT=E_e,M_e=Se({name:"Star",__name:"star",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),k_e=M_e,A_e=Se({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),Bq=A_e,R_e=Se({name:"View",__name:"view",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),w_e=R_e,D_e=Se({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),a1=D_e,O_e=Se({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),$q=O_e,N_e=Se({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,o)=>(J(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ce("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),L_e=N_e;const Hq="__epPropKey",Le=e=>e,P_e=e=>En(e)&&!!e[Hq],xa=(e,t)=>{if(!En(e)||P_e(e))return e;const{values:o,required:i,default:c,type:u,validator:f}=e,m={type:u,required:!!i,validator:o||f?_=>{let b=!1,S=[];if(o&&(S=Array.from(o),qn(e,"default")&&S.push(c),b||(b=S.includes(_))),f&&(b||(b=f(_))),!b&&S.length>0){const T=[...new Set(S)].map(M=>JSON.stringify(M)).join(", ");Rae(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${T}], got value ${JSON.stringify(_)}.`)}return b}:void 0,[Hq]:!0};return qn(e,"default")&&(m.default=c),m},gt=e=>bE(Object.entries(e).map(([t,o])=>[t,xa(o,t)])),mo=Le([String,Object,Function]),iL={Close:La},sL={Close:La,SuccessFilled:Bq,InfoFilled:rL,WarningFilled:a1,CircleCloseFilled:oL},Id={success:Bq,warning:a1,error:oL,info:rL},aL={validating:Rd,success:nL,error:Ad},bn=(e,t)=>{if(e.install=o=>{for(const i of[e,...Object.values(t??{})])o.component(i.name,i)},t)for(const[o,i]of Object.entries(t))e[o]=i;return e},Kq=(e,t)=>(e.install=o=>{e._context=o._context,o.config.globalProperties[t]=e},e),U_e=(e,t)=>(e.install=o=>{o.directive(t,e)},e),Wo=e=>(e.install=co,e),l1=(...e)=>t=>{e.forEach(o=>{tn(o)?o(t):o.value=t})},Yt={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},x_e=["year","years","month","date","dates","week","datetime","datetimerange","daterange","monthrange"],zw=["sun","mon","tue","wed","thu","fri","sat"],Mn="update:modelValue",Lo="change",Hi="input",R8=Symbol("INSTALLED_KEY"),Al=["","default","small","large"],zq=e=>["",...Al].includes(e);var Ks=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Ks||{});function JD(e){return $o(e)&&e.type===qt}function F_e(e){return $o(e)&&e.type===Mi}function V_e(e){return $o(e)&&!JD(e)&&!F_e(e)}const G_e=e=>{if(!$o(e))return{};const t=e.props||{},o=($o(e.type)?e.type.props:void 0)||{},i={};return Object.keys(o).forEach(c=>{qn(o[c],"default")&&(i[c]=o[c].default)}),Object.keys(t).forEach(c=>{i[na(c)]=t[c]}),i},B_e=e=>{if(!At(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},hd=e=>{const t=At(e)?e:[e],o=[];return t.forEach(i=>{var c;At(i)?o.push(...hd(i)):$o(i)&&At(i.children)?o.push(...hd(i.children)):(o.push(i),$o(i)&&((c=i.component)!=null&&c.subTree)&&o.push(...hd(i.component.subTree)))}),o},w8=e=>[...new Set(e)],Cs=e=>!e&&e!==0?[]:Array.isArray(e)?e:[e],lL=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e),zo=e=>e;function $_e(e){let t=0;const o=(...i)=>{t&&Jf(t),t=_d(()=>{e(...i),t=0})};return o.cancel=()=>{Jf(t),t=0},o}const H_e=["class","style"],q_e=/^on[A-Z]/,cL=(e={})=>{const{excludeListeners:t=!1,excludeKeys:o}=e,i=K(()=>((o==null?void 0:o.value)||[]).concat(H_e)),c=In();return K(c?()=>{var u;return bE(Object.entries((u=c.proxy)==null?void 0:u.$attrs).filter(([f])=>!i.value.includes(f)&&!(t&&q_e.test(f))))}:()=>({}))},$r=({from:e,replacement:t,scope:o,version:i,ref:c,type:u="API"},f)=>{rt(()=>y(f),p=>{},{immediate:!0})},Wq=(e,t,o,i)=>{let c={offsetX:0,offsetY:0};const u=m=>{const _=m.clientX,b=m.clientY,{offsetX:S,offsetY:T}=c,M=e.value.getBoundingClientRect(),R=M.left,E=M.top,N=M.width,D=M.height,x=document.documentElement.clientWidth,L=document.documentElement.clientHeight,F=-R+S,H=-E+T,B=x-R-N+S,z=L-E-D+T,W=$=>{let O=S+$.clientX-_,X=T+$.clientY-b;i!=null&&i.value||(O=Math.min(Math.max(O,F),B),X=Math.min(Math.max(X,H),z)),c={offsetX:O,offsetY:X},e.value&&(e.value.style.transform=`translate(${Xo(O)}, ${Xo(X)})`)},Z=()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",Z)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",Z)},f=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",u)},p=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",u)};fn(()=>{hi(()=>{o.value?f():p()})}),Ro(()=>{p()})};var K_e={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const z_e=e=>(t,o)=>W_e(t,o,y(e)),W_e=(e,t,o)=>ir(o,e,e).replace(/\{(\w+)\}/g,(i,c)=>{var u;return`${(u=t==null?void 0:t[c])!=null?u:`{${c}}`}`}),j_e=e=>{const t=K(()=>y(e).name),o=No(e)?e:ae(e);return{lang:t,locale:o,t:z_e(e)}},jq=Symbol("localeContextKey"),Kn=e=>{const t=e||wt(jq,ae());return j_e(K(()=>t.value||K_e))},p0="el",Y_e="is-",df=(e,t,o,i,c)=>{let u=`${e}-${t}`;return o&&(u+=`-${o}`),i&&(u+=`__${i}`),c&&(u+=`--${c}`),u},Yq=Symbol("namespaceContextKey"),uL=e=>{const t=e||(In()?wt(Yq,ae(p0)):ae(p0));return K(()=>y(t)||p0)},lt=(e,t)=>{const o=uL(t);return{namespace:o,b:(E="")=>df(o.value,e,E,"",""),e:E=>E?df(o.value,e,"",E,""):"",m:E=>E?df(o.value,e,"","",E):"",be:(E,N)=>E&&N?df(o.value,e,E,N,""):"",em:(E,N)=>E&&N?df(o.value,e,"",E,N):"",bm:(E,N)=>E&&N?df(o.value,e,E,"",N):"",bem:(E,N,D)=>E&&N&&D?df(o.value,e,E,N,D):"",is:(E,...N)=>{const D=N.length>=1?N[0]:!0;return E&&D?`${Y_e}${E}`:""},cssVar:E=>{const N={};for(const D in E)E[D]&&(N[`--${o.value}-${D}`]=E[D]);return N},cssVarName:E=>`--${o.value}-${E}`,cssVarBlock:E=>{const N={};for(const D in E)E[D]&&(N[`--${o.value}-${e}-${D}`]=E[D]);return N},cssVarBlockName:E=>`--${o.value}-${e}-${E}`}},dL=(e,t={})=>{No(e)||wr("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||lt("popup"),i=K(()=>o.bm("parent","hidden"));if(!$n||ea(document.body,i.value))return;let c=0,u=!1,f="0";const p=()=>{setTimeout(()=>{wi(document==null?void 0:document.body,i.value),u&&document&&(document.body.style.width=f)},200)};rt(e,m=>{if(!m){p();return}u=!ea(document.body,i.value),u&&(f=document.body.style.width),c=Uq(o.namespace.value);const _=document.documentElement.clientHeight<document.body.scrollHeight,b=td(document.body,"overflowY");c>0&&(_||b==="scroll")&&u&&(document.body.style.width=`calc(100% - ${c}px)`),Js(document.body,i.value)}),R$(()=>p())},J_e=xa({type:Le(Boolean),default:null}),X_e=xa({type:Le(Function)}),Jq=e=>{const t=`update:${e}`,o=`onUpdate:${e}`,i=[t],c={[e]:J_e,[o]:X_e};return{useModelToggle:({indicator:f,toggleReason:p,shouldHideWhenRouteChanges:m,shouldProceed:_,onShow:b,onHide:S})=>{const T=In(),{emit:M}=T,R=T.props,E=K(()=>tn(R[o])),N=K(()=>R[e]===null),D=z=>{f.value!==!0&&(f.value=!0,p&&(p.value=z),tn(b)&&b(z))},x=z=>{f.value!==!1&&(f.value=!1,p&&(p.value=z),tn(S)&&S(z))},L=z=>{if(R.disabled===!0||tn(_)&&!_())return;const W=E.value&&$n;W&&M(t,!0),(N.value||!W)&&D(z)},F=z=>{if(R.disabled===!0||!$n)return;const W=E.value&&$n;W&&M(t,!1),(N.value||!W)&&x(z)},H=z=>{yr(z)&&(R.disabled&&z?E.value&&M(t,!1):f.value!==z&&(z?D():x()))},B=()=>{f.value?F():L()};return rt(()=>R[e],H),m&&T.appContext.config.globalProperties.$route!==void 0&&rt(()=>({...T.proxy.$route}),()=>{m.value&&f.value&&F()}),fn(()=>{H(R[e])}),{hide:F,show:L,toggle:B,hasUpdateHandler:E}},useModelToggleProps:c,useModelToggleEmits:i}};Jq("modelValue");const Xq=e=>{const t=In();return K(()=>{var o,i;return(i=(o=t==null?void 0:t.proxy)==null?void 0:o.$props)==null?void 0:i[e]})};var rs="top",ia="bottom",sa="right",is="left",hL="auto",gI=[rs,ia,sa,is],Cm="start",B0="end",Q_e="clippingParents",Qq="viewport",By="popper",Z_e="reference",D8=gI.reduce(function(e,t){return e.concat([t+"-"+Cm,t+"-"+B0])},[]),ip=[].concat(gI,[hL]).reduce(function(e,t){return e.concat([t,t+"-"+Cm,t+"-"+B0])},[]),eye="beforeRead",tye="read",nye="afterRead",oye="beforeMain",rye="main",iye="afterMain",sye="beforeWrite",aye="write",lye="afterWrite",cye=[eye,tye,nye,oye,rye,iye,sye,aye,lye];function Tl(e){return e?(e.nodeName||"").toLowerCase():null}function Fa(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Sm(e){var t=Fa(e).Element;return e instanceof t||e instanceof Element}function ta(e){var t=Fa(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function fL(e){if(typeof ShadowRoot>"u")return!1;var t=Fa(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function uye(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var i=t.styles[o]||{},c=t.attributes[o]||{},u=t.elements[o];!ta(u)||!Tl(u)||(Object.assign(u.style,i),Object.keys(c).forEach(function(f){var p=c[f];p===!1?u.removeAttribute(f):u.setAttribute(f,p===!0?"":p)}))})}function dye(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(i){var c=t.elements[i],u=t.attributes[i]||{},f=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:o[i]),p=f.reduce(function(m,_){return m[_]="",m},{});!ta(c)||!Tl(c)||(Object.assign(c.style,p),Object.keys(u).forEach(function(m){c.removeAttribute(m)}))})}}var Zq={name:"applyStyles",enabled:!0,phase:"write",fn:uye,effect:dye,requires:["computeStyles"]};function Cl(e){return e.split("-")[0]}var Hf=Math.max,CE=Math.min,Tm=Math.round;function Em(e,t){t===void 0&&(t=!1);var o=e.getBoundingClientRect(),i=1,c=1;if(ta(e)&&t){var u=e.offsetHeight,f=e.offsetWidth;f>0&&(i=Tm(o.width)/f||1),u>0&&(c=Tm(o.height)/u||1)}return{width:o.width/i,height:o.height/c,top:o.top/c,right:o.right/i,bottom:o.bottom/c,left:o.left/i,x:o.left/i,y:o.top/c}}function pL(e){var t=Em(e),o=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:i}}function e9(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&fL(o)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Rc(e){return Fa(e).getComputedStyle(e)}function hye(e){return["table","td","th"].indexOf(Tl(e))>=0}function wd(e){return((Sm(e)?e.ownerDocument:e.document)||window.document).documentElement}function c1(e){return Tl(e)==="html"?e:e.assignedSlot||e.parentNode||(fL(e)?e.host:null)||wd(e)}function O8(e){return!ta(e)||Rc(e).position==="fixed"?null:e.offsetParent}function fye(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,o=navigator.userAgent.indexOf("Trident")!==-1;if(o&&ta(e)){var i=Rc(e);if(i.position==="fixed")return null}var c=c1(e);for(fL(c)&&(c=c.host);ta(c)&&["html","body"].indexOf(Tl(c))<0;){var u=Rc(c);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||t&&u.willChange==="filter"||t&&u.filter&&u.filter!=="none")return c;c=c.parentNode}return null}function mI(e){for(var t=Fa(e),o=O8(e);o&&hye(o)&&Rc(o).position==="static";)o=O8(o);return o&&(Tl(o)==="html"||Tl(o)==="body"&&Rc(o).position==="static")?t:o||fye(e)||t}function gL(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function g0(e,t,o){return Hf(e,CE(t,o))}function pye(e,t,o){var i=g0(e,t,o);return i>o?o:i}function t9(){return{top:0,right:0,bottom:0,left:0}}function n9(e){return Object.assign({},t9(),e)}function o9(e,t){return t.reduce(function(o,i){return o[i]=e,o},{})}var gye=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,n9(typeof e!="number"?e:o9(e,gI))};function mye(e){var t,o=e.state,i=e.name,c=e.options,u=o.elements.arrow,f=o.modifiersData.popperOffsets,p=Cl(o.placement),m=gL(p),_=[is,sa].indexOf(p)>=0,b=_?"height":"width";if(!(!u||!f)){var S=gye(c.padding,o),T=pL(u),M=m==="y"?rs:is,R=m==="y"?ia:sa,E=o.rects.reference[b]+o.rects.reference[m]-f[m]-o.rects.popper[b],N=f[m]-o.rects.reference[m],D=mI(u),x=D?m==="y"?D.clientHeight||0:D.clientWidth||0:0,L=E/2-N/2,F=S[M],H=x-T[b]-S[R],B=x/2-T[b]/2+L,z=g0(F,B,H),W=m;o.modifiersData[i]=(t={},t[W]=z,t.centerOffset=z-B,t)}}function vye(e){var t=e.state,o=e.options,i=o.element,c=i===void 0?"[data-popper-arrow]":i;c!=null&&(typeof c=="string"&&(c=t.elements.popper.querySelector(c),!c)||!e9(t.elements.popper,c)||(t.elements.arrow=c))}var _ye={name:"arrow",enabled:!0,phase:"main",fn:mye,effect:vye,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Mm(e){return e.split("-")[1]}var yye={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Iye(e){var t=e.x,o=e.y,i=window,c=i.devicePixelRatio||1;return{x:Tm(t*c)/c||0,y:Tm(o*c)/c||0}}function N8(e){var t,o=e.popper,i=e.popperRect,c=e.placement,u=e.variation,f=e.offsets,p=e.position,m=e.gpuAcceleration,_=e.adaptive,b=e.roundOffsets,S=e.isFixed,T=f.x,M=T===void 0?0:T,R=f.y,E=R===void 0?0:R,N=typeof b=="function"?b({x:M,y:E}):{x:M,y:E};M=N.x,E=N.y;var D=f.hasOwnProperty("x"),x=f.hasOwnProperty("y"),L=is,F=rs,H=window;if(_){var B=mI(o),z="clientHeight",W="clientWidth";if(B===Fa(o)&&(B=wd(o),Rc(B).position!=="static"&&p==="absolute"&&(z="scrollHeight",W="scrollWidth")),B=B,c===rs||(c===is||c===sa)&&u===B0){F=ia;var Z=S&&B===H&&H.visualViewport?H.visualViewport.height:B[z];E-=Z-i.height,E*=m?1:-1}if(c===is||(c===rs||c===ia)&&u===B0){L=sa;var $=S&&B===H&&H.visualViewport?H.visualViewport.width:B[W];M-=$-i.width,M*=m?1:-1}}var O=Object.assign({position:p},_&&yye),X=b===!0?Iye({x:M,y:E}):{x:M,y:E};if(M=X.x,E=X.y,m){var le;return Object.assign({},O,(le={},le[F]=x?"0":"",le[L]=D?"0":"",le.transform=(H.devicePixelRatio||1)<=1?"translate("+M+"px, "+E+"px)":"translate3d("+M+"px, "+E+"px, 0)",le))}return Object.assign({},O,(t={},t[F]=x?E+"px":"",t[L]=D?M+"px":"",t.transform="",t))}function bye(e){var t=e.state,o=e.options,i=o.gpuAcceleration,c=i===void 0?!0:i,u=o.adaptive,f=u===void 0?!0:u,p=o.roundOffsets,m=p===void 0?!0:p,_={placement:Cl(t.placement),variation:Mm(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:c,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,N8(Object.assign({},_,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:f,roundOffsets:m})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,N8(Object.assign({},_,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var r9={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:bye,data:{}},sT={passive:!0};function Cye(e){var t=e.state,o=e.instance,i=e.options,c=i.scroll,u=c===void 0?!0:c,f=i.resize,p=f===void 0?!0:f,m=Fa(t.elements.popper),_=[].concat(t.scrollParents.reference,t.scrollParents.popper);return u&&_.forEach(function(b){b.addEventListener("scroll",o.update,sT)}),p&&m.addEventListener("resize",o.update,sT),function(){u&&_.forEach(function(b){b.removeEventListener("scroll",o.update,sT)}),p&&m.removeEventListener("resize",o.update,sT)}}var i9={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Cye,data:{}},Sye={left:"right",right:"left",bottom:"top",top:"bottom"};function LT(e){return e.replace(/left|right|bottom|top/g,function(t){return Sye[t]})}var Tye={start:"end",end:"start"};function L8(e){return e.replace(/start|end/g,function(t){return Tye[t]})}function mL(e){var t=Fa(e),o=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:o,scrollTop:i}}function vL(e){return Em(wd(e)).left+mL(e).scrollLeft}function Eye(e){var t=Fa(e),o=wd(e),i=t.visualViewport,c=o.clientWidth,u=o.clientHeight,f=0,p=0;return i&&(c=i.width,u=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(f=i.offsetLeft,p=i.offsetTop)),{width:c,height:u,x:f+vL(e),y:p}}function Mye(e){var t,o=wd(e),i=mL(e),c=(t=e.ownerDocument)==null?void 0:t.body,u=Hf(o.scrollWidth,o.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),f=Hf(o.scrollHeight,o.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),p=-i.scrollLeft+vL(e),m=-i.scrollTop;return Rc(c||o).direction==="rtl"&&(p+=Hf(o.clientWidth,c?c.clientWidth:0)-u),{width:u,height:f,x:p,y:m}}function _L(e){var t=Rc(e),o=t.overflow,i=t.overflowX,c=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+c+i)}function s9(e){return["html","body","#document"].indexOf(Tl(e))>=0?e.ownerDocument.body:ta(e)&&_L(e)?e:s9(c1(e))}function m0(e,t){var o;t===void 0&&(t=[]);var i=s9(e),c=i===((o=e.ownerDocument)==null?void 0:o.body),u=Fa(i),f=c?[u].concat(u.visualViewport||[],_L(i)?i:[]):i,p=t.concat(f);return c?p:p.concat(m0(c1(f)))}function XD(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function kye(e){var t=Em(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function P8(e,t){return t===Qq?XD(Eye(e)):Sm(t)?kye(t):XD(Mye(wd(e)))}function Aye(e){var t=m0(c1(e)),o=["absolute","fixed"].indexOf(Rc(e).position)>=0,i=o&&ta(e)?mI(e):e;return Sm(i)?t.filter(function(c){return Sm(c)&&e9(c,i)&&Tl(c)!=="body"}):[]}function Rye(e,t,o){var i=t==="clippingParents"?Aye(e):[].concat(t),c=[].concat(i,[o]),u=c[0],f=c.reduce(function(p,m){var _=P8(e,m);return p.top=Hf(_.top,p.top),p.right=CE(_.right,p.right),p.bottom=CE(_.bottom,p.bottom),p.left=Hf(_.left,p.left),p},P8(e,u));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function a9(e){var t=e.reference,o=e.element,i=e.placement,c=i?Cl(i):null,u=i?Mm(i):null,f=t.x+t.width/2-o.width/2,p=t.y+t.height/2-o.height/2,m;switch(c){case rs:m={x:f,y:t.y-o.height};break;case ia:m={x:f,y:t.y+t.height};break;case sa:m={x:t.x+t.width,y:p};break;case is:m={x:t.x-o.width,y:p};break;default:m={x:t.x,y:t.y}}var _=c?gL(c):null;if(_!=null){var b=_==="y"?"height":"width";switch(u){case Cm:m[_]=m[_]-(t[b]/2-o[b]/2);break;case B0:m[_]=m[_]+(t[b]/2-o[b]/2);break}}return m}function $0(e,t){t===void 0&&(t={});var o=t,i=o.placement,c=i===void 0?e.placement:i,u=o.boundary,f=u===void 0?Q_e:u,p=o.rootBoundary,m=p===void 0?Qq:p,_=o.elementContext,b=_===void 0?By:_,S=o.altBoundary,T=S===void 0?!1:S,M=o.padding,R=M===void 0?0:M,E=n9(typeof R!="number"?R:o9(R,gI)),N=b===By?Z_e:By,D=e.rects.popper,x=e.elements[T?N:b],L=Rye(Sm(x)?x:x.contextElement||wd(e.elements.popper),f,m),F=Em(e.elements.reference),H=a9({reference:F,element:D,strategy:"absolute",placement:c}),B=XD(Object.assign({},D,H)),z=b===By?B:F,W={top:L.top-z.top+E.top,bottom:z.bottom-L.bottom+E.bottom,left:L.left-z.left+E.left,right:z.right-L.right+E.right},Z=e.modifiersData.offset;if(b===By&&Z){var $=Z[c];Object.keys(W).forEach(function(O){var X=[sa,ia].indexOf(O)>=0?1:-1,le=[rs,ia].indexOf(O)>=0?"y":"x";W[O]+=$[le]*X})}return W}function wye(e,t){t===void 0&&(t={});var o=t,i=o.placement,c=o.boundary,u=o.rootBoundary,f=o.padding,p=o.flipVariations,m=o.allowedAutoPlacements,_=m===void 0?ip:m,b=Mm(i),S=b?p?D8:D8.filter(function(R){return Mm(R)===b}):gI,T=S.filter(function(R){return _.indexOf(R)>=0});T.length===0&&(T=S);var M=T.reduce(function(R,E){return R[E]=$0(e,{placement:E,boundary:c,rootBoundary:u,padding:f})[Cl(E)],R},{});return Object.keys(M).sort(function(R,E){return M[R]-M[E]})}function Dye(e){if(Cl(e)===hL)return[];var t=LT(e);return[L8(e),t,L8(t)]}function Oye(e){var t=e.state,o=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var c=o.mainAxis,u=c===void 0?!0:c,f=o.altAxis,p=f===void 0?!0:f,m=o.fallbackPlacements,_=o.padding,b=o.boundary,S=o.rootBoundary,T=o.altBoundary,M=o.flipVariations,R=M===void 0?!0:M,E=o.allowedAutoPlacements,N=t.options.placement,D=Cl(N),x=D===N,L=m||(x||!R?[LT(N)]:Dye(N)),F=[N].concat(L).reduce(function(ke,Ye){return ke.concat(Cl(Ye)===hL?wye(t,{placement:Ye,boundary:b,rootBoundary:S,padding:_,flipVariations:R,allowedAutoPlacements:E}):Ye)},[]),H=t.rects.reference,B=t.rects.popper,z=new Map,W=!0,Z=F[0],$=0;$<F.length;$++){var O=F[$],X=Cl(O),le=Mm(O)===Cm,de=[rs,ia].indexOf(X)>=0,he=de?"width":"height",se=$0(t,{placement:O,boundary:b,rootBoundary:S,altBoundary:T,padding:_}),ie=de?le?sa:is:le?ia:rs;H[he]>B[he]&&(ie=LT(ie));var oe=LT(ie),ee=[];if(u&&ee.push(se[X]<=0),p&&ee.push(se[ie]<=0,se[oe]<=0),ee.every(function(ke){return ke})){Z=O,W=!1;break}z.set(O,ee)}if(W)for(var Q=R?3:1,ue=function(ke){var Ye=F.find(function(Oe){var Ee=z.get(Oe);if(Ee)return Ee.slice(0,ke).every(function(we){return we})});if(Ye)return Z=Ye,"break"},me=Q;me>0;me--){var be=ue(me);if(be==="break")break}t.placement!==Z&&(t.modifiersData[i]._skip=!0,t.placement=Z,t.reset=!0)}}var Nye={name:"flip",enabled:!0,phase:"main",fn:Oye,requiresIfExists:["offset"],data:{_skip:!1}};function U8(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function x8(e){return[rs,sa,ia,is].some(function(t){return e[t]>=0})}function Lye(e){var t=e.state,o=e.name,i=t.rects.reference,c=t.rects.popper,u=t.modifiersData.preventOverflow,f=$0(t,{elementContext:"reference"}),p=$0(t,{altBoundary:!0}),m=U8(f,i),_=U8(p,c,u),b=x8(m),S=x8(_);t.modifiersData[o]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:b,hasPopperEscaped:S},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":S})}var Pye={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Lye};function Uye(e,t,o){var i=Cl(e),c=[is,rs].indexOf(i)>=0?-1:1,u=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,f=u[0],p=u[1];return f=f||0,p=(p||0)*c,[is,sa].indexOf(i)>=0?{x:p,y:f}:{x:f,y:p}}function xye(e){var t=e.state,o=e.options,i=e.name,c=o.offset,u=c===void 0?[0,0]:c,f=ip.reduce(function(b,S){return b[S]=Uye(S,t.rects,u),b},{}),p=f[t.placement],m=p.x,_=p.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=m,t.modifiersData.popperOffsets.y+=_),t.modifiersData[i]=f}var Fye={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xye};function Vye(e){var t=e.state,o=e.name;t.modifiersData[o]=a9({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var l9={name:"popperOffsets",enabled:!0,phase:"read",fn:Vye,data:{}};function Gye(e){return e==="x"?"y":"x"}function Bye(e){var t=e.state,o=e.options,i=e.name,c=o.mainAxis,u=c===void 0?!0:c,f=o.altAxis,p=f===void 0?!1:f,m=o.boundary,_=o.rootBoundary,b=o.altBoundary,S=o.padding,T=o.tether,M=T===void 0?!0:T,R=o.tetherOffset,E=R===void 0?0:R,N=$0(t,{boundary:m,rootBoundary:_,padding:S,altBoundary:b}),D=Cl(t.placement),x=Mm(t.placement),L=!x,F=gL(D),H=Gye(F),B=t.modifiersData.popperOffsets,z=t.rects.reference,W=t.rects.popper,Z=typeof E=="function"?E(Object.assign({},t.rects,{placement:t.placement})):E,$=typeof Z=="number"?{mainAxis:Z,altAxis:Z}:Object.assign({mainAxis:0,altAxis:0},Z),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,X={x:0,y:0};if(B){if(u){var le,de=F==="y"?rs:is,he=F==="y"?ia:sa,se=F==="y"?"height":"width",ie=B[F],oe=ie+N[de],ee=ie-N[he],Q=M?-W[se]/2:0,ue=x===Cm?z[se]:W[se],me=x===Cm?-W[se]:-z[se],be=t.elements.arrow,ke=M&&be?pL(be):{width:0,height:0},Ye=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:t9(),Oe=Ye[de],Ee=Ye[he],we=g0(0,z[se],ke[se]),Ge=L?z[se]/2-Q-we-Oe-$.mainAxis:ue-we-Oe-$.mainAxis,Ve=L?-z[se]/2+Q+we+Ee+$.mainAxis:me+we+Ee+$.mainAxis,qe=t.elements.arrow&&mI(t.elements.arrow),st=qe?F==="y"?qe.clientTop||0:qe.clientLeft||0:0,Ie=(le=O==null?void 0:O[F])!=null?le:0,Ae=ie+Ge-Ie-st,xe=ie+Ve-Ie,ot=g0(M?CE(oe,Ae):oe,ie,M?Hf(ee,xe):ee);B[F]=ot,X[F]=ot-ie}if(p){var je,at=F==="x"?rs:is,ht=F==="x"?ia:sa,dt=B[H],ft=H==="y"?"height":"width",Je=dt+N[at],Et=dt-N[ht],Nt=[rs,is].indexOf(D)!==-1,et=(je=O==null?void 0:O[H])!=null?je:0,Mt=Nt?Je:dt-z[ft]-W[ft]-et+$.altAxis,Jt=Nt?dt+z[ft]+W[ft]-et-$.altAxis:Et,sn=M&&Nt?pye(Mt,dt,Jt):g0(M?Mt:Je,dt,M?Jt:Et);B[H]=sn,X[H]=sn-dt}t.modifiersData[i]=X}}var $ye={name:"preventOverflow",enabled:!0,phase:"main",fn:Bye,requiresIfExists:["offset"]};function Hye(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function qye(e){return e===Fa(e)||!ta(e)?mL(e):Hye(e)}function Kye(e){var t=e.getBoundingClientRect(),o=Tm(t.width)/e.offsetWidth||1,i=Tm(t.height)/e.offsetHeight||1;return o!==1||i!==1}function zye(e,t,o){o===void 0&&(o=!1);var i=ta(t),c=ta(t)&&Kye(t),u=wd(t),f=Em(e,c),p={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(i||!i&&!o)&&((Tl(t)!=="body"||_L(u))&&(p=qye(t)),ta(t)?(m=Em(t,!0),m.x+=t.clientLeft,m.y+=t.clientTop):u&&(m.x=vL(u))),{x:f.left+p.scrollLeft-m.x,y:f.top+p.scrollTop-m.y,width:f.width,height:f.height}}function Wye(e){var t=new Map,o=new Set,i=[];e.forEach(function(u){t.set(u.name,u)});function c(u){o.add(u.name);var f=[].concat(u.requires||[],u.requiresIfExists||[]);f.forEach(function(p){if(!o.has(p)){var m=t.get(p);m&&c(m)}}),i.push(u)}return e.forEach(function(u){o.has(u.name)||c(u)}),i}function jye(e){var t=Wye(e);return cye.reduce(function(o,i){return o.concat(t.filter(function(c){return c.phase===i}))},[])}function Yye(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function Jye(e){var t=e.reduce(function(o,i){var c=o[i.name];return o[i.name]=c?Object.assign({},c,i,{options:Object.assign({},c.options,i.options),data:Object.assign({},c.data,i.data)}):i,o},{});return Object.keys(t).map(function(o){return t[o]})}var F8={placement:"bottom",modifiers:[],strategy:"absolute"};function V8(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function yL(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,i=o===void 0?[]:o,c=t.defaultOptions,u=c===void 0?F8:c;return function(f,p,m){m===void 0&&(m=u);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},F8,u),modifiersData:{},elements:{reference:f,popper:p},attributes:{},styles:{}},b=[],S=!1,T={state:_,setOptions:function(E){var N=typeof E=="function"?E(_.options):E;R(),_.options=Object.assign({},u,_.options,N),_.scrollParents={reference:Sm(f)?m0(f):f.contextElement?m0(f.contextElement):[],popper:m0(p)};var D=jye(Jye([].concat(i,_.options.modifiers)));return _.orderedModifiers=D.filter(function(x){return x.enabled}),M(),T.update()},forceUpdate:function(){if(!S){var E=_.elements,N=E.reference,D=E.popper;if(V8(N,D)){_.rects={reference:zye(N,mI(D),_.options.strategy==="fixed"),popper:pL(D)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(W){return _.modifiersData[W.name]=Object.assign({},W.data)});for(var x=0;x<_.orderedModifiers.length;x++){if(_.reset===!0){_.reset=!1,x=-1;continue}var L=_.orderedModifiers[x],F=L.fn,H=L.options,B=H===void 0?{}:H,z=L.name;typeof F=="function"&&(_=F({state:_,options:B,name:z,instance:T})||_)}}}},update:Yye(function(){return new Promise(function(E){T.forceUpdate(),E(_)})}),destroy:function(){R(),S=!0}};if(!V8(f,p))return T;T.setOptions(m).then(function(E){!S&&m.onFirstUpdate&&m.onFirstUpdate(E)});function M(){_.orderedModifiers.forEach(function(E){var N=E.name,D=E.options,x=D===void 0?{}:D,L=E.effect;if(typeof L=="function"){var F=L({state:_,name:N,instance:T,options:x}),H=function(){};b.push(F||H)}})}function R(){b.forEach(function(E){return E()}),b=[]}return T}}yL();var Xye=[i9,l9,r9,Zq];yL({defaultModifiers:Xye});var Qye=[i9,l9,r9,Zq,Fye,Nye,$ye,_ye,Pye],Zye=yL({defaultModifiers:Qye});const e0e=(e,t,o={})=>{const i={name:"updateState",enabled:!0,phase:"write",fn:({state:m})=>{const _=t0e(m);Object.assign(f.value,_)},requires:["computeStyles"]},c=K(()=>{const{onFirstUpdate:m,placement:_,strategy:b,modifiers:S}=y(o);return{onFirstUpdate:m,placement:_||"bottom",strategy:b||"absolute",modifiers:[...S||[],i,{name:"applyStyles",enabled:!1}]}}),u=Do(),f=ae({styles:{popper:{position:y(c).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),p=()=>{u.value&&(u.value.destroy(),u.value=void 0)};return rt(c,m=>{const _=y(u);_&&_.setOptions(m)},{deep:!0}),rt([e,t],([m,_])=>{p(),!(!m||!_)&&(u.value=Zye(m,_,y(c)))}),Ro(()=>{p()}),{state:K(()=>{var m;return{...((m=y(u))==null?void 0:m.state)||{}}}),styles:K(()=>y(f).styles),attributes:K(()=>y(f).attributes),update:()=>{var m;return(m=y(u))==null?void 0:m.update()},forceUpdate:()=>{var m;return(m=y(u))==null?void 0:m.forceUpdate()},instanceRef:K(()=>y(u))}};function t0e(e){const t=Object.keys(e.elements),o=bE(t.map(c=>[c,e.styles[c]||{}])),i=bE(t.map(c=>[c,e.attributes[c]]));return{styles:o,attributes:i}}const IL=e=>{if(!e)return{onClick:co,onMousedown:co,onMouseup:co};let t=!1,o=!1;return{onClick:f=>{t&&o&&e(f),t=o=!1},onMousedown:f=>{t=f.target===f.currentTarget},onMouseup:f=>{o=f.target===f.currentTarget}}},n0e=(e,t=0)=>{if(t===0)return e;const o=ae(!1);let i=0;const c=()=>{i&&clearTimeout(i),i=window.setTimeout(()=>{o.value=e.value},t)};return fn(c),rt(()=>e.value,u=>{u?c():o.value=u}),o};function G8(){let e;const t=(i,c)=>{o(),e=window.setTimeout(i,c)},o=()=>window.clearTimeout(e);return cI(()=>o()),{registerTimeout:t,cancelTimeout:o}}const B8={prefix:Math.floor(Math.random()*1e4),current:0},o0e=Symbol("elIdInjection"),bL=()=>In()?wt(o0e,B8):B8,pi=e=>{const t=bL(),o=uL();return K(()=>y(e)||`${o.value}-id-${t.prefix}-${t.current++}`)};let $g=[];const $8=e=>{const t=e;t.key===Yt.esc&&$g.forEach(o=>o(t))},r0e=e=>{fn(()=>{$g.length===0&&document.addEventListener("keydown",$8),$n&&$g.push(e)}),Ro(()=>{$g=$g.filter(t=>t!==e),$g.length===0&&$n&&document.removeEventListener("keydown",$8)})};let H8;const c9=()=>{const e=uL(),t=bL(),o=K(()=>`${e.value}-popper-container-${t.prefix}`),i=K(()=>`#${o.value}`);return{id:o,selector:i}},i0e=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},s0e=()=>{const{id:e,selector:t}=c9();return jE(()=>{$n&&!H8&&!document.body.querySelector(t.value)&&(H8=i0e(e.value))}),{id:e,selector:t}},a0e=gt({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),l0e=({showAfter:e,hideAfter:t,autoClose:o,open:i,close:c})=>{const{registerTimeout:u}=G8(),{registerTimeout:f,cancelTimeout:p}=G8();return{onOpen:b=>{u(()=>{i(b);const S=y(o);Zt(S)&&S>0&&f(()=>{c(b)},S)},y(e))},onClose:b=>{p(),u(()=>{c(b)},y(t))}}},u9=Symbol("elForwardRef"),c0e=e=>{Ln(u9,{setForwardRef:o=>{e.value=o}})},u0e=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),q8={current:0},K8=ae(0),d9=2e3,z8=Symbol("elZIndexContextKey"),h9=Symbol("zIndexContextKey"),Bm=e=>{const t=In()?wt(z8,q8):q8,o=e||(In()?wt(h9,void 0):void 0),i=K(()=>{const f=y(o);return Zt(f)?f:d9}),c=K(()=>i.value+K8.value),u=()=>(t.current++,K8.value=t.current,c.value);return!$n&&wt(z8),{initialZIndex:i,currentZIndex:c,nextZIndex:u}},km=Math.min,qf=Math.max,SE=Math.round,aT=Math.floor,bd=e=>({x:e,y:e}),d0e={left:"right",right:"left",bottom:"top",top:"bottom"},h0e={start:"end",end:"start"};function QD(e,t,o){return qf(e,km(t,o))}function vI(e,t){return typeof e=="function"?e(t):e}function Xf(e){return e.split("-")[0]}function _I(e){return e.split("-")[1]}function f9(e){return e==="x"?"y":"x"}function CL(e){return e==="y"?"height":"width"}function u1(e){return["top","bottom"].includes(Xf(e))?"y":"x"}function SL(e){return f9(u1(e))}function f0e(e,t,o){o===void 0&&(o=!1);const i=_I(e),c=SL(e),u=CL(c);let f=c==="x"?i===(o?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(f=TE(f)),[f,TE(f)]}function p0e(e){const t=TE(e);return[ZD(e),t,ZD(t)]}function ZD(e){return e.replace(/start|end/g,t=>h0e[t])}function g0e(e,t,o){const i=["left","right"],c=["right","left"],u=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return o?t?c:i:t?i:c;case"left":case"right":return t?u:f;default:return[]}}function m0e(e,t,o,i){const c=_I(e);let u=g0e(Xf(e),o==="start",i);return c&&(u=u.map(f=>f+"-"+c),t&&(u=u.concat(u.map(ZD)))),u}function TE(e){return e.replace(/left|right|bottom|top/g,t=>d0e[t])}function v0e(e){return{top:0,right:0,bottom:0,left:0,...e}}function p9(e){return typeof e!="number"?v0e(e):{top:e,right:e,bottom:e,left:e}}function EE(e){const{x:t,y:o,width:i,height:c}=e;return{width:i,height:c,top:o,left:t,right:t+i,bottom:o+c,x:t,y:o}}function W8(e,t,o){let{reference:i,floating:c}=e;const u=u1(t),f=SL(t),p=CL(f),m=Xf(t),_=u==="y",b=i.x+i.width/2-c.width/2,S=i.y+i.height/2-c.height/2,T=i[p]/2-c[p]/2;let M;switch(m){case"top":M={x:b,y:i.y-c.height};break;case"bottom":M={x:b,y:i.y+i.height};break;case"right":M={x:i.x+i.width,y:S};break;case"left":M={x:i.x-c.width,y:S};break;default:M={x:i.x,y:i.y}}switch(_I(t)){case"start":M[f]-=T*(o&&_?-1:1);break;case"end":M[f]+=T*(o&&_?-1:1);break}return M}const _0e=async(e,t,o)=>{const{placement:i="bottom",strategy:c="absolute",middleware:u=[],platform:f}=o,p=u.filter(Boolean),m=await(f.isRTL==null?void 0:f.isRTL(t));let _=await f.getElementRects({reference:e,floating:t,strategy:c}),{x:b,y:S}=W8(_,i,m),T=i,M={},R=0;for(let E=0;E<p.length;E++){const{name:N,fn:D}=p[E],{x,y:L,data:F,reset:H}=await D({x:b,y:S,initialPlacement:i,placement:T,strategy:c,middlewareData:M,rects:_,platform:f,elements:{reference:e,floating:t}});b=x??b,S=L??S,M={...M,[N]:{...M[N],...F}},H&&R<=50&&(R++,typeof H=="object"&&(H.placement&&(T=H.placement),H.rects&&(_=H.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:c}):H.rects),{x:b,y:S}=W8(_,T,m)),E=-1)}return{x:b,y:S,placement:T,strategy:c,middlewareData:M}};async function TL(e,t){var o;t===void 0&&(t={});const{x:i,y:c,platform:u,rects:f,elements:p,strategy:m}=e,{boundary:_="clippingAncestors",rootBoundary:b="viewport",elementContext:S="floating",altBoundary:T=!1,padding:M=0}=vI(t,e),R=p9(M),N=p[T?S==="floating"?"reference":"floating":S],D=EE(await u.getClippingRect({element:(o=await(u.isElement==null?void 0:u.isElement(N)))==null||o?N:N.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(p.floating)),boundary:_,rootBoundary:b,strategy:m})),x=S==="floating"?{x:i,y:c,width:f.floating.width,height:f.floating.height}:f.reference,L=await(u.getOffsetParent==null?void 0:u.getOffsetParent(p.floating)),F=await(u.isElement==null?void 0:u.isElement(L))?await(u.getScale==null?void 0:u.getScale(L))||{x:1,y:1}:{x:1,y:1},H=EE(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:p,rect:x,offsetParent:L,strategy:m}):x);return{top:(D.top-H.top+R.top)/F.y,bottom:(H.bottom-D.bottom+R.bottom)/F.y,left:(D.left-H.left+R.left)/F.x,right:(H.right-D.right+R.right)/F.x}}const y0e=e=>({name:"arrow",options:e,async fn(t){const{x:o,y:i,placement:c,rects:u,platform:f,elements:p,middlewareData:m}=t,{element:_,padding:b=0}=vI(e,t)||{};if(_==null)return{};const S=p9(b),T={x:o,y:i},M=SL(c),R=CL(M),E=await f.getDimensions(_),N=M==="y",D=N?"top":"left",x=N?"bottom":"right",L=N?"clientHeight":"clientWidth",F=u.reference[R]+u.reference[M]-T[M]-u.floating[R],H=T[M]-u.reference[M],B=await(f.getOffsetParent==null?void 0:f.getOffsetParent(_));let z=B?B[L]:0;(!z||!await(f.isElement==null?void 0:f.isElement(B)))&&(z=p.floating[L]||u.floating[R]);const W=F/2-H/2,Z=z/2-E[R]/2-1,$=km(S[D],Z),O=km(S[x],Z),X=$,le=z-E[R]-O,de=z/2-E[R]/2+W,he=QD(X,de,le),se=!m.arrow&&_I(c)!=null&&de!==he&&u.reference[R]/2-(de<X?$:O)-E[R]/2<0,ie=se?de<X?de-X:de-le:0;return{[M]:T[M]+ie,data:{[M]:he,centerOffset:de-he-ie,...se&&{alignmentOffset:ie}},reset:se}}}),I0e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var o,i;const{placement:c,middlewareData:u,rects:f,initialPlacement:p,platform:m,elements:_}=t,{mainAxis:b=!0,crossAxis:S=!0,fallbackPlacements:T,fallbackStrategy:M="bestFit",fallbackAxisSideDirection:R="none",flipAlignment:E=!0,...N}=vI(e,t);if((o=u.arrow)!=null&&o.alignmentOffset)return{};const D=Xf(c),x=Xf(p)===p,L=await(m.isRTL==null?void 0:m.isRTL(_.floating)),F=T||(x||!E?[TE(p)]:p0e(p));!T&&R!=="none"&&F.push(...m0e(p,E,R,L));const H=[p,...F],B=await TL(t,N),z=[];let W=((i=u.flip)==null?void 0:i.overflows)||[];if(b&&z.push(B[D]),S){const X=f0e(c,f,L);z.push(B[X[0]],B[X[1]])}if(W=[...W,{placement:c,overflows:z}],!z.every(X=>X<=0)){var Z,$;const X=(((Z=u.flip)==null?void 0:Z.index)||0)+1,le=H[X];if(le)return{data:{index:X,overflows:W},reset:{placement:le}};let de=($=W.filter(he=>he.overflows[0]<=0).sort((he,se)=>he.overflows[1]-se.overflows[1])[0])==null?void 0:$.placement;if(!de)switch(M){case"bestFit":{var O;const he=(O=W.map(se=>[se.placement,se.overflows.filter(ie=>ie>0).reduce((ie,oe)=>ie+oe,0)]).sort((se,ie)=>se[1]-ie[1])[0])==null?void 0:O[0];he&&(de=he);break}case"initialPlacement":de=p;break}if(c!==de)return{reset:{placement:de}}}return{}}}};async function b0e(e,t){const{placement:o,platform:i,elements:c}=e,u=await(i.isRTL==null?void 0:i.isRTL(c.floating)),f=Xf(o),p=_I(o),m=u1(o)==="y",_=["left","top"].includes(f)?-1:1,b=u&&m?-1:1,S=vI(t,e);let{mainAxis:T,crossAxis:M,alignmentAxis:R}=typeof S=="number"?{mainAxis:S,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...S};return p&&typeof R=="number"&&(M=p==="end"?R*-1:R),m?{x:M*b,y:T*_}:{x:T*_,y:M*b}}const C0e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var o,i;const{x:c,y:u,placement:f,middlewareData:p}=t,m=await b0e(t,e);return f===((o=p.offset)==null?void 0:o.placement)&&(i=p.arrow)!=null&&i.alignmentOffset?{}:{x:c+m.x,y:u+m.y,data:{...m,placement:f}}}}},S0e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:o,y:i,placement:c}=t,{mainAxis:u=!0,crossAxis:f=!1,limiter:p={fn:N=>{let{x:D,y:x}=N;return{x:D,y:x}}},...m}=vI(e,t),_={x:o,y:i},b=await TL(t,m),S=u1(Xf(c)),T=f9(S);let M=_[T],R=_[S];if(u){const N=T==="y"?"top":"left",D=T==="y"?"bottom":"right",x=M+b[N],L=M-b[D];M=QD(x,M,L)}if(f){const N=S==="y"?"top":"left",D=S==="y"?"bottom":"right",x=R+b[N],L=R-b[D];R=QD(x,R,L)}const E=p.fn({...t,[T]:M,[S]:R});return{...E,data:{x:E.x-o,y:E.y-i}}}}};function $m(e){return g9(e)?(e.nodeName||"").toLowerCase():"#document"}function Ms(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Uc(e){var t;return(t=(g9(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function g9(e){return e instanceof Node||e instanceof Ms(e).Node}function El(e){return e instanceof Element||e instanceof Ms(e).Element}function Ml(e){return e instanceof HTMLElement||e instanceof Ms(e).HTMLElement}function j8(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ms(e).ShadowRoot}function yI(e){const{overflow:t,overflowX:o,overflowY:i,display:c}=Pa(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+o)&&!["inline","contents"].includes(c)}function T0e(e){return["table","td","th"].includes($m(e))}function EL(e){const t=ML(),o=Pa(e);return o.transform!=="none"||o.perspective!=="none"||(o.containerType?o.containerType!=="normal":!1)||!t&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!t&&(o.filter?o.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(o.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(o.contain||"").includes(i))}function E0e(e){let t=Cd(e);for(;Ml(t)&&!Am(t);){if(EL(t))return t;t=Cd(t)}return null}function ML(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Am(e){return["html","body","#document"].includes($m(e))}function Pa(e){return Ms(e).getComputedStyle(e)}function d1(e){return El(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Cd(e){if($m(e)==="html")return e;const t=e.assignedSlot||e.parentNode||j8(e)&&e.host||Uc(e);return j8(t)?t.host:t}function m9(e){const t=Cd(e);return Am(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ml(t)&&yI(t)?t:m9(t)}function H0(e,t,o){var i;t===void 0&&(t=[]),o===void 0&&(o=!0);const c=m9(e),u=c===((i=e.ownerDocument)==null?void 0:i.body),f=Ms(c);return u?t.concat(f,f.visualViewport||[],yI(c)?c:[],f.frameElement&&o?H0(f.frameElement):[]):t.concat(c,H0(c,[],o))}function v9(e){const t=Pa(e);let o=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const c=Ml(e),u=c?e.offsetWidth:o,f=c?e.offsetHeight:i,p=SE(o)!==u||SE(i)!==f;return p&&(o=u,i=f),{width:o,height:i,$:p}}function kL(e){return El(e)?e:e.contextElement}function sm(e){const t=kL(e);if(!Ml(t))return bd(1);const o=t.getBoundingClientRect(),{width:i,height:c,$:u}=v9(t);let f=(u?SE(o.width):o.width)/i,p=(u?SE(o.height):o.height)/c;return(!f||!Number.isFinite(f))&&(f=1),(!p||!Number.isFinite(p))&&(p=1),{x:f,y:p}}const M0e=bd(0);function _9(e){const t=Ms(e);return!ML()||!t.visualViewport?M0e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function k0e(e,t,o){return t===void 0&&(t=!1),!o||t&&o!==Ms(e)?!1:t}function Qf(e,t,o,i){t===void 0&&(t=!1),o===void 0&&(o=!1);const c=e.getBoundingClientRect(),u=kL(e);let f=bd(1);t&&(i?El(i)&&(f=sm(i)):f=sm(e));const p=k0e(u,o,i)?_9(u):bd(0);let m=(c.left+p.x)/f.x,_=(c.top+p.y)/f.y,b=c.width/f.x,S=c.height/f.y;if(u){const T=Ms(u),M=i&&El(i)?Ms(i):i;let R=T,E=R.frameElement;for(;E&&i&&M!==R;){const N=sm(E),D=E.getBoundingClientRect(),x=Pa(E),L=D.left+(E.clientLeft+parseFloat(x.paddingLeft))*N.x,F=D.top+(E.clientTop+parseFloat(x.paddingTop))*N.y;m*=N.x,_*=N.y,b*=N.x,S*=N.y,m+=L,_+=F,R=Ms(E),E=R.frameElement}}return EE({width:b,height:S,x:m,y:_})}const A0e=[":popover-open",":modal"];function AL(e){return A0e.some(t=>{try{return e.matches(t)}catch{return!1}})}function R0e(e){let{elements:t,rect:o,offsetParent:i,strategy:c}=e;const u=c==="fixed",f=Uc(i),p=t?AL(t.floating):!1;if(i===f||p&&u)return o;let m={scrollLeft:0,scrollTop:0},_=bd(1);const b=bd(0),S=Ml(i);if((S||!S&&!u)&&(($m(i)!=="body"||yI(f))&&(m=d1(i)),Ml(i))){const T=Qf(i);_=sm(i),b.x=T.x+i.clientLeft,b.y=T.y+i.clientTop}return{width:o.width*_.x,height:o.height*_.y,x:o.x*_.x-m.scrollLeft*_.x+b.x,y:o.y*_.y-m.scrollTop*_.y+b.y}}function w0e(e){return Array.from(e.getClientRects())}function y9(e){return Qf(Uc(e)).left+d1(e).scrollLeft}function D0e(e){const t=Uc(e),o=d1(e),i=e.ownerDocument.body,c=qf(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),u=qf(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let f=-o.scrollLeft+y9(e);const p=-o.scrollTop;return Pa(i).direction==="rtl"&&(f+=qf(t.clientWidth,i.clientWidth)-c),{width:c,height:u,x:f,y:p}}function O0e(e,t){const o=Ms(e),i=Uc(e),c=o.visualViewport;let u=i.clientWidth,f=i.clientHeight,p=0,m=0;if(c){u=c.width,f=c.height;const _=ML();(!_||_&&t==="fixed")&&(p=c.offsetLeft,m=c.offsetTop)}return{width:u,height:f,x:p,y:m}}function N0e(e,t){const o=Qf(e,!0,t==="fixed"),i=o.top+e.clientTop,c=o.left+e.clientLeft,u=Ml(e)?sm(e):bd(1),f=e.clientWidth*u.x,p=e.clientHeight*u.y,m=c*u.x,_=i*u.y;return{width:f,height:p,x:m,y:_}}function Y8(e,t,o){let i;if(t==="viewport")i=O0e(e,o);else if(t==="document")i=D0e(Uc(e));else if(El(t))i=N0e(t,o);else{const c=_9(e);i={...t,x:t.x-c.x,y:t.y-c.y}}return EE(i)}function I9(e,t){const o=Cd(e);return o===t||!El(o)||Am(o)?!1:Pa(o).position==="fixed"||I9(o,t)}function L0e(e,t){const o=t.get(e);if(o)return o;let i=H0(e,[],!1).filter(p=>El(p)&&$m(p)!=="body"),c=null;const u=Pa(e).position==="fixed";let f=u?Cd(e):e;for(;El(f)&&!Am(f);){const p=Pa(f),m=EL(f);!m&&p.position==="fixed"&&(c=null),(u?!m&&!c:!m&&p.position==="static"&&!!c&&["absolute","fixed"].includes(c.position)||yI(f)&&!m&&I9(e,f))?i=i.filter(b=>b!==f):c=p,f=Cd(f)}return t.set(e,i),i}function P0e(e){let{element:t,boundary:o,rootBoundary:i,strategy:c}=e;const f=[...o==="clippingAncestors"?AL(t)?[]:L0e(t,this._c):[].concat(o),i],p=f[0],m=f.reduce((_,b)=>{const S=Y8(t,b,c);return _.top=qf(S.top,_.top),_.right=km(S.right,_.right),_.bottom=km(S.bottom,_.bottom),_.left=qf(S.left,_.left),_},Y8(t,p,c));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function U0e(e){const{width:t,height:o}=v9(e);return{width:t,height:o}}function x0e(e,t,o){const i=Ml(t),c=Uc(t),u=o==="fixed",f=Qf(e,!0,u,t);let p={scrollLeft:0,scrollTop:0};const m=bd(0);if(i||!i&&!u)if(($m(t)!=="body"||yI(c))&&(p=d1(t)),i){const S=Qf(t,!0,u,t);m.x=S.x+t.clientLeft,m.y=S.y+t.clientTop}else c&&(m.x=y9(c));const _=f.left+p.scrollLeft-m.x,b=f.top+p.scrollTop-m.y;return{x:_,y:b,width:f.width,height:f.height}}function Ww(e){return Pa(e).position==="static"}function J8(e,t){return!Ml(e)||Pa(e).position==="fixed"?null:t?t(e):e.offsetParent}function b9(e,t){const o=Ms(e);if(AL(e))return o;if(!Ml(e)){let c=Cd(e);for(;c&&!Am(c);){if(El(c)&&!Ww(c))return c;c=Cd(c)}return o}let i=J8(e,t);for(;i&&T0e(i)&&Ww(i);)i=J8(i,t);return i&&Am(i)&&Ww(i)&&!EL(i)?o:i||E0e(e)||o}const F0e=async function(e){const t=this.getOffsetParent||b9,o=this.getDimensions,i=await o(e.floating);return{reference:x0e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function V0e(e){return Pa(e).direction==="rtl"}const G0e={convertOffsetParentRelativeRectToViewportRelativeRect:R0e,getDocumentElement:Uc,getClippingRect:P0e,getOffsetParent:b9,getElementRects:F0e,getClientRects:w0e,getDimensions:U0e,getScale:sm,isElement:El,isRTL:V0e};function B0e(e,t){let o=null,i;const c=Uc(e);function u(){var p;clearTimeout(i),(p=o)==null||p.disconnect(),o=null}function f(p,m){p===void 0&&(p=!1),m===void 0&&(m=1),u();const{left:_,top:b,width:S,height:T}=e.getBoundingClientRect();if(p||t(),!S||!T)return;const M=aT(b),R=aT(c.clientWidth-(_+S)),E=aT(c.clientHeight-(b+T)),N=aT(_),x={rootMargin:-M+"px "+-R+"px "+-E+"px "+-N+"px",threshold:qf(0,km(1,m))||1};let L=!0;function F(H){const B=H[0].intersectionRatio;if(B!==m){if(!L)return f();B?f(!1,B):i=setTimeout(()=>{f(!1,1e-7)},1e3)}L=!1}try{o=new IntersectionObserver(F,{...x,root:c.ownerDocument})}catch{o=new IntersectionObserver(F,x)}o.observe(e)}return f(!0),u}function $0e(e,t,o,i){i===void 0&&(i={});const{ancestorScroll:c=!0,ancestorResize:u=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:p=typeof IntersectionObserver=="function",animationFrame:m=!1}=i,_=kL(e),b=c||u?[..._?H0(_):[],...H0(t)]:[];b.forEach(D=>{c&&D.addEventListener("scroll",o,{passive:!0}),u&&D.addEventListener("resize",o)});const S=_&&p?B0e(_,o):null;let T=-1,M=null;f&&(M=new ResizeObserver(D=>{let[x]=D;x&&x.target===_&&M&&(M.unobserve(t),cancelAnimationFrame(T),T=requestAnimationFrame(()=>{var L;(L=M)==null||L.observe(t)})),o()}),_&&!m&&M.observe(_),M.observe(t));let R,E=m?Qf(e):null;m&&N();function N(){const D=Qf(e);E&&(D.x!==E.x||D.y!==E.y||D.width!==E.width||D.height!==E.height)&&o(),E=D,R=requestAnimationFrame(N)}return o(),()=>{var D;b.forEach(x=>{c&&x.removeEventListener("scroll",o),u&&x.removeEventListener("resize",o)}),S==null||S(),(D=M)==null||D.disconnect(),M=null,m&&cancelAnimationFrame(R)}}const H0e=TL,C9=C0e,q0e=S0e,K0e=I0e,S9=y0e,T9=(e,t,o)=>{const i=new Map,c={platform:G0e,...o},u={...c.platform,_c:i};return _0e(e,t,{...c,platform:u})};gt({});const z0e=e=>{if(!$n)return;if(!e)return e;const t=os(e);return t||(No(e)?t:e)},W0e=({middleware:e,placement:t,strategy:o})=>{const i=ae(),c=ae(),u=ae(),f=ae(),p=ae({}),m={x:u,y:f,placement:t,strategy:o,middlewareData:p},_=async()=>{if(!$n)return;const b=z0e(i),S=os(c);if(!b||!S)return;const T=await T9(b,S,{placement:y(t),strategy:y(o),middleware:y(e)});ym(m).forEach(M=>{m[M].value=T[M]})};return fn(()=>{hi(()=>{_()})}),{...m,update:_,referenceRef:i,contentRef:c}},j0e=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(o){const i=y(e);return i?S9({element:i,padding:t}).fn(o):{}}});function Y0e(e){const t=ae();function o(){if(e.value==null)return;const{selectionStart:c,selectionEnd:u,value:f}=e.value;if(c==null||u==null)return;const p=f.slice(0,Math.max(0,c)),m=f.slice(Math.max(0,u));t.value={selectionStart:c,selectionEnd:u,value:f,beforeTxt:p,afterTxt:m}}function i(){if(e.value==null||t.value==null)return;const{value:c}=e.value,{beforeTxt:u,afterTxt:f,selectionStart:p}=t.value;if(u==null||f==null||p==null)return;let m=c.length;if(c.endsWith(f))m=c.length-f.length;else if(c.startsWith(u))m=u.length;else{const _=u[p-1],b=c.indexOf(_,p-1);b!==-1&&(m=b+1)}e.value.setSelectionRange(m,m)}return[o,i]}const J0e=(e,t,o)=>hd(e.subTree).filter(u=>{var f;return $o(u)&&((f=u.type)==null?void 0:f.name)===t&&!!u.component}).map(u=>u.component.uid).map(u=>o[u]).filter(u=>!!u),RL=(e,t)=>{const o={},i=Do([]);return{children:i,addChild:f=>{o[f.uid]=f,i.value=J0e(e,t,o)},removeChild:f=>{delete o[f],i.value=i.value.filter(p=>p.uid!==f)}}},Nr=xa({type:String,values:Al,required:!1}),E9=Symbol("size"),X0e=()=>{const e=wt(E9,{});return K(()=>y(e.size)||"")};function h1(e,{afterFocus:t,beforeBlur:o,afterBlur:i}={}){const c=In(),{emit:u}=c,f=Do(),p=ae(!1),m=S=>{p.value||(p.value=!0,u("focus",S),t==null||t())},_=S=>{var T;tn(o)&&o(S)||S.relatedTarget&&((T=f.value)!=null&&T.contains(S.relatedTarget))||(p.value=!1,u("blur",S),i==null||i())},b=()=>{var S;(S=e.value)==null||S.focus()};return rt(f,S=>{S&&S.setAttribute("tabindex","-1")}),Oo(f,"click",b),{wrapperRef:f,isFocused:p,handleFocus:m,handleBlur:_}}const Q0e=["",void 0,null],Z0e=void 0,Hm=gt({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>tn(e)?!e():!e}}),f1=(e,t)=>{let o=II();o.value||(o=ae({}));const i=K(()=>e.emptyValues||o.value.emptyValues||Q0e),c=K(()=>tn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:tn(o.value.valueOnClear)?o.value.valueOnClear():o.value.valueOnClear!==void 0?o.value.valueOnClear:t!==void 0?t:Z0e),u=f=>i.value.includes(f);return i.value.includes(c.value),{emptyValues:i,valueOnClear:c,isEmptyValue:u}},eIe=gt({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),ti=e=>Il(eIe,e),M9=Symbol(),ME=ae();function II(e,t=void 0){const o=In()?wt(M9,ME):ME;return e?K(()=>{var i,c;return(c=(i=o.value)==null?void 0:i[e])!=null?c:t}):o}function p1(e,t){const o=II(),i=lt(e,K(()=>{var p;return((p=o.value)==null?void 0:p.namespace)||p0})),c=Kn(K(()=>{var p;return(p=o.value)==null?void 0:p.locale})),u=Bm(K(()=>{var p;return((p=o.value)==null?void 0:p.zIndex)||d9})),f=K(()=>{var p;return y(t)||((p=o.value)==null?void 0:p.size)||""});return wL(K(()=>y(o)||{})),{ns:i,locale:c,zIndex:u,size:f}}const wL=(e,t,o=!1)=>{var i;const c=!!In(),u=c?II():void 0,f=(i=t==null?void 0:t.provide)!=null?i:c?Ln:void 0;if(!f)return;const p=K(()=>{const m=y(e);return u!=null&&u.value?tIe(u.value,m):m});return f(M9,p),f(jq,K(()=>p.value.locale)),f(Yq,K(()=>p.value.namespace)),f(h9,K(()=>p.value.zIndex)),f(E9,{size:K(()=>p.value.size||"")}),(o||!ME.value)&&(ME.value=p.value),p},tIe=(e,t)=>{const o=[...new Set([...ym(e),...ym(t)])],i={};for(const c of o)i[c]=t[c]!==void 0?t[c]:e[c];return i},nIe=gt({a11y:{type:Boolean,default:!0},locale:{type:Le(Object)},size:Nr,button:{type:Le(Object)},experimentalFeatures:{type:Le(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:Le(Object)},zIndex:Number,namespace:{type:String,default:"el"},...Hm}),eO={},oIe=Se({name:"ElConfigProvider",props:nIe,setup(e,{slots:t}){rt(()=>e.message,i=>{Object.assign(eO,i??{})},{immediate:!0,deep:!0});const o=wL(e);return()=>We(t,"default",{config:o==null?void 0:o.value})}}),rIe=bn(oIe),iIe="2.7.4",sIe=(e=[])=>({version:iIe,install:(o,i)=>{o[R8]||(o[R8]=!0,e.forEach(c=>o.use(c)),i&&wL(i,o,!0))}}),aIe=gt({zIndex:{type:Le([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),lIe={scroll:({scrollTop:e,fixed:t})=>Zt(e)&&yr(t),[Lo]:e=>yr(e)};var vt=(e,t)=>{const o=e.__vccOpts||e;for(const[i,c]of t)o[i]=c;return o};const k9="ElAffix",cIe=Se({name:k9}),uIe=Se({...cIe,props:aIe,emits:lIe,setup(e,{expose:t,emit:o}){const i=e,c=lt("affix"),u=Do(),f=Do(),p=Do(),{height:m}=zde(),{height:_,width:b,top:S,bottom:T,update:M}=H5(f,{windowScroll:!1}),R=H5(u),E=ae(!1),N=ae(0),D=ae(0),x=K(()=>({height:E.value?`${_.value}px`:"",width:E.value?`${b.value}px`:""})),L=K(()=>{if(!E.value)return{};const B=i.offset?Xo(i.offset):0;return{height:`${_.value}px`,width:`${b.value}px`,top:i.position==="top"?B:"",bottom:i.position==="bottom"?B:"",transform:D.value?`translateY(${D.value}px)`:"",zIndex:i.zIndex}}),F=()=>{if(p.value)if(N.value=p.value instanceof Window?document.documentElement.scrollTop:p.value.scrollTop||0,i.position==="top")if(i.target){const B=R.bottom.value-i.offset-_.value;E.value=i.offset>S.value&&R.bottom.value>0,D.value=B<0?B:0}else E.value=i.offset>S.value;else if(i.target){const B=m.value-R.top.value-i.offset-_.value;E.value=m.value-i.offset<T.value&&m.value>R.top.value,D.value=B<0?-B:0}else E.value=m.value-i.offset<T.value},H=()=>{M(),o("scroll",{scrollTop:N.value,fixed:E.value})};return rt(E,B=>o("change",B)),fn(()=>{var B;i.target?(u.value=(B=document.querySelector(i.target))!=null?B:void 0,u.value||wr(k9,`Target does not exist: ${i.target}`)):u.value=document.documentElement,p.value=eL(f.value,!0),M()}),Oo(p,"scroll",H),hi(F),t({update:F,updateRoot:M}),(B,z)=>(J(),ge("div",{ref_key:"root",ref:f,class:ne(y(c).b()),style:Ht(y(x))},[Ce("div",{class:ne({[y(c).m("fixed")]:E.value}),style:Ht(y(L))},[We(B.$slots,"default")],6)],6))}});var dIe=vt(uIe,[["__file","affix.vue"]]);const hIe=bn(dIe),fIe=gt({size:{type:Le([Number,String])},color:{type:String}}),pIe=Se({name:"ElIcon",inheritAttrs:!1}),gIe=Se({...pIe,props:fIe,setup(e){const t=e,o=lt("icon"),i=K(()=>{const{size:c,color:u}=t;return!c&&!u?{}:{fontSize:_r(c)?void 0:Xo(c),"--color":u}});return(c,u)=>(J(),ge("i",Nn({class:y(o).b(),style:y(i)},c.$attrs),[We(c.$slots,"default")],16))}});var mIe=vt(gIe,[["__file","icon.vue"]]);const Gt=bn(mIe),vIe=["light","dark"],_Ie=gt({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:ym(Id),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:vIe,default:"light"}}),yIe={close:e=>e instanceof MouseEvent},IIe=Se({name:"ElAlert"}),bIe=Se({...IIe,props:_Ie,emits:yIe,setup(e,{emit:t}){const o=e,{Close:i}=sL,c=zr(),u=lt("alert"),f=ae(!0),p=K(()=>Id[o.type]),m=K(()=>[u.e("icon"),{[u.is("big")]:!!o.description||!!c.default}]),_=K(()=>({"with-description":o.description||c.default})),b=S=>{f.value=!1,t("close",S)};return(S,T)=>(J(),He(Rr,{name:y(u).b("fade"),persisted:""},{default:Ne(()=>[hn(Ce("div",{class:ne([y(u).b(),y(u).m(S.type),y(u).is("center",S.center),y(u).is(S.effect)]),role:"alert"},[S.showIcon&&y(p)?(J(),He(y(Gt),{key:0,class:ne(y(m))},{default:Ne(()=>[(J(),He(wn(y(p))))]),_:1},8,["class"])):Fe("v-if",!0),Ce("div",{class:ne(y(u).e("content"))},[S.title||S.$slots.title?(J(),ge("span",{key:0,class:ne([y(u).e("title"),y(_)])},[We(S.$slots,"title",{},()=>[On(pt(S.title),1)])],2)):Fe("v-if",!0),S.$slots.default||S.description?(J(),ge("p",{key:1,class:ne(y(u).e("description"))},[We(S.$slots,"default",{},()=>[On(pt(S.description),1)])],2)):Fe("v-if",!0),S.closable?(J(),ge(qt,{key:2},[S.closeText?(J(),ge("div",{key:0,class:ne([y(u).e("close-btn"),y(u).is("customed")]),onClick:b},pt(S.closeText),3)):(J(),He(y(Gt),{key:1,class:ne(y(u).e("close-btn")),onClick:b},{default:Ne(()=>[Me(y(i))]),_:1},8,["class"]))],64)):Fe("v-if",!0)],2)],2),[[Jn,f.value]])]),_:3},8,["name"]))}});var CIe=vt(bIe,[["__file","alert.vue"]]);const SIe=bn(CIe),sp=Symbol("formContextKey"),kl=Symbol("formItemContextKey"),Tr=(e,t={})=>{const o=ae(void 0),i=t.prop?o:Xq("size"),c=t.global?o:X0e(),u=t.form?{size:void 0}:wt(sp,void 0),f=t.formItem?{size:void 0}:wt(kl,void 0);return K(()=>i.value||y(e)||(f==null?void 0:f.size)||(u==null?void 0:u.size)||c.value||"")},zi=e=>{const t=Xq("disabled"),o=wt(sp,void 0);return K(()=>t.value||y(e)||(o==null?void 0:o.disabled)||!1)},Oi=()=>{const e=wt(sp,void 0),t=wt(kl,void 0);return{form:e,formItem:t}},Va=(e,{formItemContext:t,disableIdGeneration:o,disableIdManagement:i})=>{o||(o=ae(!1)),i||(i=ae(!1));const c=ae();let u;const f=K(()=>{var p;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((p=t.inputIds)==null?void 0:p.length)<=1)});return fn(()=>{u=rt([Io(e,"id"),o],([p,m])=>{const _=p??(m?void 0:pi().value);_!==c.value&&(t!=null&&t.removeInputId&&(c.value&&t.removeInputId(c.value),!(i!=null&&i.value)&&!m&&_&&t.addInputId(_)),c.value=_)},{immediate:!0})}),Md(()=>{u&&u(),t!=null&&t.removeInputId&&c.value&&t.removeInputId(c.value)}),{isLabeledByFormItem:f,inputId:c}},TIe=gt({size:{type:String,values:Al},disabled:Boolean}),EIe=gt({...TIe,model:Object,rules:{type:Le(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),MIe={validate:(e,t,o)=>(At(e)||on(e))&&yr(t)&&on(o)};function kIe(){const e=ae([]),t=K(()=>{if(!e.value.length)return"0";const u=Math.max(...e.value);return u?`${u}px`:""});function o(u){const f=e.value.indexOf(u);return f===-1&&t.value,f}function i(u,f){if(u&&f){const p=o(f);e.value.splice(p,1,u)}else u&&e.value.push(u)}function c(u){const f=o(u);f>-1&&e.value.splice(f,1)}return{autoLabelWidth:t,registerLabelWidth:i,deregisterLabelWidth:c}}const lT=(e,t)=>{const o=vd(t);return o.length>0?e.filter(i=>i.prop&&o.includes(i.prop)):e},AIe="ElForm",RIe=Se({name:AIe}),wIe=Se({...RIe,props:EIe,emits:MIe,setup(e,{expose:t,emit:o}){const i=e,c=[],u=Tr(),f=lt("form"),p=K(()=>{const{labelPosition:L,inline:F}=i;return[f.b(),f.m(u.value||"default"),{[f.m(`label-${L}`)]:L,[f.m("inline")]:F}]}),m=L=>c.find(F=>F.prop===L),_=L=>{c.push(L)},b=L=>{L.prop&&c.splice(c.indexOf(L),1)},S=(L=[])=>{i.model&&lT(c,L).forEach(F=>F.resetField())},T=(L=[])=>{lT(c,L).forEach(F=>F.clearValidate())},M=K(()=>!!i.model),R=L=>{if(c.length===0)return[];const F=lT(c,L);return F.length?F:[]},E=async L=>D(void 0,L),N=async(L=[])=>{if(!M.value)return!1;const F=R(L);if(F.length===0)return!0;let H={};for(const B of F)try{await B.validate("")}catch(z){H={...H,...z}}return Object.keys(H).length===0?!0:Promise.reject(H)},D=async(L=[],F)=>{const H=!tn(F);try{const B=await N(L);return B===!0&&await(F==null?void 0:F(B)),B}catch(B){if(B instanceof Error)throw B;const z=B;return i.scrollToError&&x(Object.keys(z)[0]),await(F==null?void 0:F(!1,z)),H&&Promise.reject(z)}},x=L=>{var F;const H=lT(c,L)[0];H&&((F=H.$el)==null||F.scrollIntoView(i.scrollIntoViewOptions))};return rt(()=>i.rules,()=>{i.validateOnRuleChange&&E().catch(L=>void 0)},{deep:!0}),Ln(sp,Zn({...ei(i),emit:o,resetFields:S,clearValidate:T,validateField:D,getField:m,addField:_,removeField:b,...kIe()})),t({validate:E,validateField:D,resetFields:S,clearValidate:T,scrollToField:x,fields:c}),(L,F)=>(J(),ge("form",{class:ne(y(p))},[We(L.$slots,"default")],2))}});var DIe=vt(wIe,[["__file","form.vue"]]);function Of(){return Of=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},Of.apply(this,arguments)}function OIe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,q0(e,t)}function tO(e){return tO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},tO(e)}function q0(e,t){return q0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},q0(e,t)}function NIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function PT(e,t,o){return NIe()?PT=Reflect.construct.bind():PT=function(c,u,f){var p=[null];p.push.apply(p,u);var m=Function.bind.apply(c,p),_=new m;return f&&q0(_,f.prototype),_},PT.apply(null,arguments)}function LIe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function nO(e){var t=typeof Map=="function"?new Map:void 0;return nO=function(i){if(i===null||!LIe(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,c)}function c(){return PT(i,arguments,tO(this).constructor)}return c.prototype=Object.create(i.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),q0(c,i)},nO(e)}var PIe=/%[sdj%]/g,UIe=function(){};function oO(e){if(!e||!e.length)return null;var t={};return e.forEach(function(o){var i=o.field;t[i]=t[i]||[],t[i].push(o)}),t}function Ss(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var c=0,u=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var f=e.replace(PIe,function(p){if(p==="%%")return"%";if(c>=u)return p;switch(p){case"%s":return String(o[c++]);case"%d":return Number(o[c++]);case"%j":try{return JSON.stringify(o[c++])}catch{return"[Circular]"}break;default:return p}});return f}return e}function xIe(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Kr(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||xIe(t)&&typeof e=="string"&&!e)}function FIe(e,t,o){var i=[],c=0,u=e.length;function f(p){i.push.apply(i,p||[]),c++,c===u&&o(i)}e.forEach(function(p){t(p,f)})}function X8(e,t,o){var i=0,c=e.length;function u(f){if(f&&f.length){o(f);return}var p=i;i=i+1,p<c?t(e[p],u):o([])}u([])}function VIe(e){var t=[];return Object.keys(e).forEach(function(o){t.push.apply(t,e[o]||[])}),t}var Q8=function(e){OIe(t,e);function t(o,i){var c;return c=e.call(this,"Async Validation Error")||this,c.errors=o,c.fields=i,c}return t}(nO(Error));function GIe(e,t,o,i,c){if(t.first){var u=new Promise(function(T,M){var R=function(D){return i(D),D.length?M(new Q8(D,oO(D))):T(c)},E=VIe(e);X8(E,o,R)});return u.catch(function(T){return T}),u}var f=t.firstFields===!0?Object.keys(e):t.firstFields||[],p=Object.keys(e),m=p.length,_=0,b=[],S=new Promise(function(T,M){var R=function(N){if(b.push.apply(b,N),_++,_===m)return i(b),b.length?M(new Q8(b,oO(b))):T(c)};p.length||(i(b),T(c)),p.forEach(function(E){var N=e[E];f.indexOf(E)!==-1?X8(N,o,R):FIe(N,o,R)})});return S.catch(function(T){return T}),S}function BIe(e){return!!(e&&e.message!==void 0)}function $Ie(e,t){for(var o=e,i=0;i<t.length;i++){if(o==null)return o;o=o[t[i]]}return o}function Z8(e,t){return function(o){var i;return e.fullFields?i=$Ie(t,e.fullFields):i=t[o.field||e.fullField],BIe(o)?(o.field=o.field||e.fullField,o.fieldValue=i,o):{message:typeof o=="function"?o():o,fieldValue:i,field:o.field||e.fullField}}}function eB(e,t){if(t){for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];typeof i=="object"&&typeof e[o]=="object"?e[o]=Of({},e[o],i):e[o]=i}}return e}var A9=function(t,o,i,c,u,f){t.required&&(!i.hasOwnProperty(t.field)||Kr(o,f||t.type))&&c.push(Ss(u.messages.required,t.fullField))},HIe=function(t,o,i,c,u){(/^\s+$/.test(o)||o==="")&&c.push(Ss(u.messages.whitespace,t.fullField))},cT,qIe=function(){if(cT)return cT;var e="[a-fA-F\\d:]",t=function(F){return F&&F.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",c=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+o+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+o+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+o+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+o+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+o+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+o+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+o+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),u=new RegExp("(?:^"+o+"$)|(?:^"+c+"$)"),f=new RegExp("^"+o+"$"),p=new RegExp("^"+c+"$"),m=function(F){return F&&F.exact?u:new RegExp("(?:"+t(F)+o+t(F)+")|(?:"+t(F)+c+t(F)+")","g")};m.v4=function(L){return L&&L.exact?f:new RegExp(""+t(L)+o+t(L),"g")},m.v6=function(L){return L&&L.exact?p:new RegExp(""+t(L)+c+t(L),"g")};var _="(?:(?:[a-z]+:)?//)",b="(?:\\S+(?::\\S*)?@)?",S=m.v4().source,T=m.v6().source,M="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",R="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",E="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",N="(?::\\d{2,5})?",D='(?:[/?#][^\\s"]*)?',x="(?:"+_+"|www\\.)"+b+"(?:localhost|"+S+"|"+T+"|"+M+R+E+")"+N+D;return cT=new RegExp("(?:^"+x+"$)","i"),cT},tB={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},jy={integer:function(t){return jy.number(t)&&parseInt(t,10)===t},float:function(t){return jy.number(t)&&!jy.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!jy.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(tB.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(qIe())},hex:function(t){return typeof t=="string"&&!!t.match(tB.hex)}},KIe=function(t,o,i,c,u){if(t.required&&o===void 0){A9(t,o,i,c,u);return}var f=["integer","float","array","regexp","object","method","email","number","date","url","hex"],p=t.type;f.indexOf(p)>-1?jy[p](o)||c.push(Ss(u.messages.types[p],t.fullField,t.type)):p&&typeof o!==t.type&&c.push(Ss(u.messages.types[p],t.fullField,t.type))},zIe=function(t,o,i,c,u){var f=typeof t.len=="number",p=typeof t.min=="number",m=typeof t.max=="number",_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b=o,S=null,T=typeof o=="number",M=typeof o=="string",R=Array.isArray(o);if(T?S="number":M?S="string":R&&(S="array"),!S)return!1;R&&(b=o.length),M&&(b=o.replace(_,"_").length),f?b!==t.len&&c.push(Ss(u.messages[S].len,t.fullField,t.len)):p&&!m&&b<t.min?c.push(Ss(u.messages[S].min,t.fullField,t.min)):m&&!p&&b>t.max?c.push(Ss(u.messages[S].max,t.fullField,t.max)):p&&m&&(b<t.min||b>t.max)&&c.push(Ss(u.messages[S].range,t.fullField,t.min,t.max))},Ug="enum",WIe=function(t,o,i,c,u){t[Ug]=Array.isArray(t[Ug])?t[Ug]:[],t[Ug].indexOf(o)===-1&&c.push(Ss(u.messages[Ug],t.fullField,t[Ug].join(", ")))},jIe=function(t,o,i,c,u){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(o)||c.push(Ss(u.messages.pattern.mismatch,t.fullField,o,t.pattern));else if(typeof t.pattern=="string"){var f=new RegExp(t.pattern);f.test(o)||c.push(Ss(u.messages.pattern.mismatch,t.fullField,o,t.pattern))}}},yo={required:A9,whitespace:HIe,type:KIe,range:zIe,enum:WIe,pattern:jIe},YIe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o,"string")&&!t.required)return i();yo.required(t,o,c,f,u,"string"),Kr(o,"string")||(yo.type(t,o,c,f,u),yo.range(t,o,c,f,u),yo.pattern(t,o,c,f,u),t.whitespace===!0&&yo.whitespace(t,o,c,f,u))}i(f)},JIe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&yo.type(t,o,c,f,u)}i(f)},XIe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(o===""&&(o=void 0),Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&(yo.type(t,o,c,f,u),yo.range(t,o,c,f,u))}i(f)},QIe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&yo.type(t,o,c,f,u)}i(f)},ZIe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),Kr(o)||yo.type(t,o,c,f,u)}i(f)},ebe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&(yo.type(t,o,c,f,u),yo.range(t,o,c,f,u))}i(f)},tbe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&(yo.type(t,o,c,f,u),yo.range(t,o,c,f,u))}i(f)},nbe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(o==null&&!t.required)return i();yo.required(t,o,c,f,u,"array"),o!=null&&(yo.type(t,o,c,f,u),yo.range(t,o,c,f,u))}i(f)},obe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&yo.type(t,o,c,f,u)}i(f)},rbe="enum",ibe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u),o!==void 0&&yo[rbe](t,o,c,f,u)}i(f)},sbe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o,"string")&&!t.required)return i();yo.required(t,o,c,f,u),Kr(o,"string")||yo.pattern(t,o,c,f,u)}i(f)},abe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o,"date")&&!t.required)return i();if(yo.required(t,o,c,f,u),!Kr(o,"date")){var m;o instanceof Date?m=o:m=new Date(o),yo.type(t,m,c,f,u),m&&yo.range(t,m.getTime(),c,f,u)}}i(f)},lbe=function(t,o,i,c,u){var f=[],p=Array.isArray(o)?"array":typeof o;yo.required(t,o,c,f,u,p),i(f)},jw=function(t,o,i,c,u){var f=t.type,p=[],m=t.required||!t.required&&c.hasOwnProperty(t.field);if(m){if(Kr(o,f)&&!t.required)return i();yo.required(t,o,c,p,u,f),Kr(o,f)||yo.type(t,o,c,p,u)}i(p)},cbe=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(Kr(o)&&!t.required)return i();yo.required(t,o,c,f,u)}i(f)},v0={string:YIe,method:JIe,number:XIe,boolean:QIe,regexp:ZIe,integer:ebe,float:tbe,array:nbe,object:obe,enum:ibe,pattern:sbe,date:abe,url:jw,hex:jw,email:jw,required:lbe,any:cbe};function rO(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var iO=rO(),bI=function(){function e(o){this.rules=null,this._messages=iO,this.define(o)}var t=e.prototype;return t.define=function(i){var c=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(u){var f=i[u];c.rules[u]=Array.isArray(f)?f:[f]})},t.messages=function(i){return i&&(this._messages=eB(rO(),i)),this._messages},t.validate=function(i,c,u){var f=this;c===void 0&&(c={}),u===void 0&&(u=function(){});var p=i,m=c,_=u;if(typeof m=="function"&&(_=m,m={}),!this.rules||Object.keys(this.rules).length===0)return _&&_(null,p),Promise.resolve(p);function b(E){var N=[],D={};function x(F){if(Array.isArray(F)){var H;N=(H=N).concat.apply(H,F)}else N.push(F)}for(var L=0;L<E.length;L++)x(E[L]);N.length?(D=oO(N),_(N,D)):_(null,p)}if(m.messages){var S=this.messages();S===iO&&(S=rO()),eB(S,m.messages),m.messages=S}else m.messages=this.messages();var T={},M=m.keys||Object.keys(this.rules);M.forEach(function(E){var N=f.rules[E],D=p[E];N.forEach(function(x){var L=x;typeof L.transform=="function"&&(p===i&&(p=Of({},p)),D=p[E]=L.transform(D)),typeof L=="function"?L={validator:L}:L=Of({},L),L.validator=f.getValidationMethod(L),L.validator&&(L.field=E,L.fullField=L.fullField||E,L.type=f.getType(L),T[E]=T[E]||[],T[E].push({rule:L,value:D,source:p,field:E}))})});var R={};return GIe(T,m,function(E,N){var D=E.rule,x=(D.type==="object"||D.type==="array")&&(typeof D.fields=="object"||typeof D.defaultField=="object");x=x&&(D.required||!D.required&&E.value),D.field=E.field;function L(B,z){return Of({},z,{fullField:D.fullField+"."+B,fullFields:D.fullFields?[].concat(D.fullFields,[B]):[B]})}function F(B){B===void 0&&(B=[]);var z=Array.isArray(B)?B:[B];!m.suppressWarning&&z.length&&e.warning("async-validator:",z),z.length&&D.message!==void 0&&(z=[].concat(D.message));var W=z.map(Z8(D,p));if(m.first&&W.length)return R[D.field]=1,N(W);if(!x)N(W);else{if(D.required&&!E.value)return D.message!==void 0?W=[].concat(D.message).map(Z8(D,p)):m.error&&(W=[m.error(D,Ss(m.messages.required,D.field))]),N(W);var Z={};D.defaultField&&Object.keys(E.value).map(function(X){Z[X]=D.defaultField}),Z=Of({},Z,E.rule.fields);var $={};Object.keys(Z).forEach(function(X){var le=Z[X],de=Array.isArray(le)?le:[le];$[X]=de.map(L.bind(null,X))});var O=new e($);O.messages(m.messages),E.rule.options&&(E.rule.options.messages=m.messages,E.rule.options.error=m.error),O.validate(E.value,E.rule.options||m,function(X){var le=[];W&&W.length&&le.push.apply(le,W),X&&X.length&&le.push.apply(le,X),N(le.length?le:null)})}}var H;if(D.asyncValidator)H=D.asyncValidator(D,E.value,F,E.source,m);else if(D.validator){try{H=D.validator(D,E.value,F,E.source,m)}catch(B){console.error==null||console.error(B),m.suppressValidatorError||setTimeout(function(){throw B},0),F(B.message)}H===!0?F():H===!1?F(typeof D.message=="function"?D.message(D.fullField||D.field):D.message||(D.fullField||D.field)+" fails"):H instanceof Array?F(H):H instanceof Error&&F(H.message)}H&&H.then&&H.then(function(){return F()},function(B){return F(B)})},function(E){b(E)},p)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!v0.hasOwnProperty(i.type))throw new Error(Ss("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var c=Object.keys(i),u=c.indexOf("message");return u!==-1&&c.splice(u,1),c.length===1&&c[0]==="required"?v0.required:v0[this.getType(i)]||void 0},e}();bI.register=function(t,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");v0[t]=o};bI.warning=UIe;bI.messages=iO;bI.validators=v0;const ube=["","error","validating","success"],dbe=gt({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:Le([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Le([Object,Array])},error:String,validateStatus:{type:String,values:ube},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Al}}),nB="ElLabelWrap";var hbe=Se({name:nB,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const o=wt(sp,void 0),i=wt(kl);i||wr(nB,"usage: <el-form-item><label-wrap /></el-form-item>");const c=lt("form"),u=ae(),f=ae(0),p=()=>{var b;if((b=u.value)!=null&&b.firstElementChild){const S=window.getComputedStyle(u.value.firstElementChild).width;return Math.ceil(Number.parseFloat(S))}else return 0},m=(b="update")=>{zt(()=>{t.default&&e.isAutoWidth&&(b==="update"?f.value=p():b==="remove"&&(o==null||o.deregisterLabelWidth(f.value)))})},_=()=>m("update");return fn(()=>{_()}),Ro(()=>{m("remove")}),Oc(()=>_()),rt(f,(b,S)=>{e.updateAll&&(o==null||o.registerLabelWidth(b,S))}),Ko(K(()=>{var b,S;return(S=(b=u.value)==null?void 0:b.firstElementChild)!=null?S:null}),_),()=>{var b,S;if(!t)return null;const{isAutoWidth:T}=e;if(T){const M=o==null?void 0:o.autoLabelWidth,R=i==null?void 0:i.hasLabel,E={};if(R&&M&&M!=="auto"){const N=Math.max(0,Number.parseInt(M,10)-f.value),D=o.labelPosition==="left"?"marginRight":"marginLeft";N&&(E[D]=`${N}px`)}return Me("div",{ref:u,class:[c.be("item","label-wrap")],style:E},[(b=t.default)==null?void 0:b.call(t)])}else return Me(qt,{ref:u},[(S=t.default)==null?void 0:S.call(t)])}}});const fbe=["role","aria-labelledby"],pbe=Se({name:"ElFormItem"}),gbe=Se({...pbe,props:dbe,setup(e,{expose:t}){const o=e,i=zr(),c=wt(sp,void 0),u=wt(kl,void 0),f=Tr(void 0,{formItem:!1}),p=lt("form-item"),m=pi().value,_=ae([]),b=ae(""),S=Ade(b,100),T=ae(""),M=ae();let R,E=!1;const N=K(()=>{if((c==null?void 0:c.labelPosition)==="top")return{};const Ee=Xo(o.labelWidth||(c==null?void 0:c.labelWidth)||"");return Ee?{width:Ee}:{}}),D=K(()=>{if((c==null?void 0:c.labelPosition)==="top"||c!=null&&c.inline)return{};if(!o.label&&!o.labelWidth&&Z)return{};const Ee=Xo(o.labelWidth||(c==null?void 0:c.labelWidth)||"");return!o.label&&!i.label?{marginLeft:Ee}:{}}),x=K(()=>[p.b(),p.m(f.value),p.is("error",b.value==="error"),p.is("validating",b.value==="validating"),p.is("success",b.value==="success"),p.is("required",de.value||o.required),p.is("no-asterisk",c==null?void 0:c.hideRequiredAsterisk),(c==null?void 0:c.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[p.m("feedback")]:c==null?void 0:c.statusIcon}]),L=K(()=>yr(o.inlineMessage)?o.inlineMessage:(c==null?void 0:c.inlineMessage)||!1),F=K(()=>[p.e("error"),{[p.em("error","inline")]:L.value}]),H=K(()=>o.prop?on(o.prop)?o.prop:o.prop.join("."):""),B=K(()=>!!(o.label||i.label)),z=K(()=>o.for||(_.value.length===1?_.value[0]:void 0)),W=K(()=>!z.value&&B.value),Z=!!u,$=K(()=>{const Ee=c==null?void 0:c.model;if(!(!Ee||!o.prop))return NT(Ee,o.prop).value}),O=K(()=>{const{required:Ee}=o,we=[];o.rules&&we.push(...vd(o.rules));const Ge=c==null?void 0:c.rules;if(Ge&&o.prop){const Ve=NT(Ge,o.prop).value;Ve&&we.push(...vd(Ve))}if(Ee!==void 0){const Ve=we.map((qe,st)=>[qe,st]).filter(([qe])=>Object.keys(qe).includes("required"));if(Ve.length>0)for(const[qe,st]of Ve)qe.required!==Ee&&(we[st]={...qe,required:Ee});else we.push({required:Ee})}return we}),X=K(()=>O.value.length>0),le=Ee=>O.value.filter(Ge=>!Ge.trigger||!Ee?!0:Array.isArray(Ge.trigger)?Ge.trigger.includes(Ee):Ge.trigger===Ee).map(({trigger:Ge,...Ve})=>Ve),de=K(()=>O.value.some(Ee=>Ee.required)),he=K(()=>{var Ee;return S.value==="error"&&o.showMessage&&((Ee=c==null?void 0:c.showMessage)!=null?Ee:!0)}),se=K(()=>`${o.label||""}${(c==null?void 0:c.labelSuffix)||""}`),ie=Ee=>{b.value=Ee},oe=Ee=>{var we,Ge;const{errors:Ve,fields:qe}=Ee;(!Ve||!qe)&&console.error(Ee),ie("error"),T.value=Ve?(Ge=(we=Ve==null?void 0:Ve[0])==null?void 0:we.message)!=null?Ge:`${o.prop} is required`:"",c==null||c.emit("validate",o.prop,!1,T.value)},ee=()=>{ie("success"),c==null||c.emit("validate",o.prop,!0,"")},Q=async Ee=>{const we=H.value;return new bI({[we]:Ee}).validate({[we]:$.value},{firstFields:!0}).then(()=>(ee(),!0)).catch(Ve=>(oe(Ve),Promise.reject(Ve)))},ue=async(Ee,we)=>{if(E||!o.prop)return!1;const Ge=tn(we);if(!X.value)return we==null||we(!1),!1;const Ve=le(Ee);return Ve.length===0?(we==null||we(!0),!0):(ie("validating"),Q(Ve).then(()=>(we==null||we(!0),!0)).catch(qe=>{const{fields:st}=qe;return we==null||we(!1,st),Ge?!1:Promise.reject(st)}))},me=()=>{ie(""),T.value="",E=!1},be=async()=>{const Ee=c==null?void 0:c.model;if(!Ee||!o.prop)return;const we=NT(Ee,o.prop);E=!0,we.value=b8(R),await zt(),me(),E=!1},ke=Ee=>{_.value.includes(Ee)||_.value.push(Ee)},Ye=Ee=>{_.value=_.value.filter(we=>we!==Ee)};rt(()=>o.error,Ee=>{T.value=Ee||"",ie(Ee?"error":"")},{immediate:!0}),rt(()=>o.validateStatus,Ee=>ie(Ee||""));const Oe=Zn({...ei(o),$el:M,size:f,validateState:b,labelId:m,inputIds:_,isGroup:W,hasLabel:B,fieldValue:$,addInputId:ke,removeInputId:Ye,resetField:be,clearValidate:me,validate:ue});return Ln(kl,Oe),fn(()=>{o.prop&&(c==null||c.addField(Oe),R=b8($.value))}),Ro(()=>{c==null||c.removeField(Oe)}),t({size:f,validateMessage:T,validateState:b,validate:ue,clearValidate:me,resetField:be}),(Ee,we)=>{var Ge;return J(),ge("div",{ref_key:"formItemRef",ref:M,class:ne(y(x)),role:y(W)?"group":void 0,"aria-labelledby":y(W)?y(m):void 0},[Me(y(hbe),{"is-auto-width":y(N).width==="auto","update-all":((Ge=y(c))==null?void 0:Ge.labelWidth)==="auto"},{default:Ne(()=>[y(B)?(J(),He(wn(y(z)?"label":"div"),{key:0,id:y(m),for:y(z),class:ne(y(p).e("label")),style:Ht(y(N))},{default:Ne(()=>[We(Ee.$slots,"label",{label:y(se)},()=>[On(pt(y(se)),1)])]),_:3},8,["id","for","class","style"])):Fe("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ce("div",{class:ne(y(p).e("content")),style:Ht(y(D))},[We(Ee.$slots,"default"),Me(NH,{name:`${y(p).namespace.value}-zoom-in-top`},{default:Ne(()=>[y(he)?We(Ee.$slots,"error",{key:0,error:T.value},()=>[Ce("div",{class:ne(y(F))},pt(T.value),3)]):Fe("v-if",!0)]),_:3},8,["name"])],6)],10,fbe)}}});var R9=vt(gbe,[["__file","form-item.vue"]]);const mbe=bn(DIe,{FormItem:R9}),vbe=Wo(R9);let Ma;const _be=`
  height:0 !important;
  visibility:hidden !important;
  ${j7()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,ybe=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Ibe(e){const t=window.getComputedStyle(e),o=t.getPropertyValue("box-sizing"),i=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),c=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:ybe.map(f=>`${f}:${t.getPropertyValue(f)}`).join(";"),paddingSize:i,borderSize:c,boxSizing:o}}function oB(e,t=1,o){var i;Ma||(Ma=document.createElement("textarea"),document.body.appendChild(Ma));const{paddingSize:c,borderSize:u,boxSizing:f,contextStyle:p}=Ibe(e);Ma.setAttribute("style",`${p};${_be}`),Ma.value=e.value||e.placeholder||"";let m=Ma.scrollHeight;const _={};f==="border-box"?m=m+u:f==="content-box"&&(m=m-c),Ma.value="";const b=Ma.scrollHeight-c;if(Zt(t)){let S=b*t;f==="border-box"&&(S=S+c+u),m=Math.max(S,m),_.minHeight=`${S}px`}if(Zt(o)){let S=b*o;f==="border-box"&&(S=S+c+u),m=Math.min(S,m)}return _.height=`${m}px`,(i=Ma.parentNode)==null||i.removeChild(Ma),Ma=void 0,_}const bbe=gt({id:{type:String,default:void 0},size:Nr,disabled:Boolean,modelValue:{type:Le([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Le([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:mo},prefixIcon:{type:mo},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:Le([Object,Array,String]),default:()=>zo({})},autofocus:{type:Boolean,default:!1},...ti(["ariaLabel"])}),Cbe={[Mn]:e=>on(e),input:e=>on(e),change:e=>on(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},Sbe=["role"],Tbe=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],Ebe=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],Mbe=Se({name:"ElInput",inheritAttrs:!1}),kbe=Se({...Mbe,props:bbe,emits:Cbe,setup(e,{expose:t,emit:o}){const i=e,c=tp(),u=zr(),f=K(()=>{const et={};return i.containerRole==="combobox"&&(et["aria-haspopup"]=c["aria-haspopup"],et["aria-owns"]=c["aria-owns"],et["aria-expanded"]=c["aria-expanded"]),et}),p=K(()=>[i.type==="textarea"?N.b():E.b(),E.m(M.value),E.is("disabled",R.value),E.is("exceed",ke.value),{[E.b("group")]:u.prepend||u.append,[E.bm("group","append")]:u.append,[E.bm("group","prepend")]:u.prepend,[E.m("prefix")]:u.prefix||i.prefixIcon,[E.m("suffix")]:u.suffix||i.suffixIcon||i.clearable||i.showPassword,[E.bm("suffix","password-clear")]:Q.value&&ue.value,[E.b("hidden")]:i.type==="hidden"},c.class]),m=K(()=>[E.e("wrapper"),E.is("focus",$.value)]),_=cL({excludeKeys:K(()=>Object.keys(f.value))}),{form:b,formItem:S}=Oi(),{inputId:T}=Va(i,{formItemContext:S}),M=Tr(),R=zi(),E=lt("input"),N=lt("textarea"),D=Do(),x=Do(),L=ae(!1),F=ae(!1),H=ae(!1),B=ae(),z=Do(i.inputStyle),W=K(()=>D.value||x.value),{wrapperRef:Z,isFocused:$,handleFocus:O,handleBlur:X}=h1(W,{afterBlur(){var et;i.validateEvent&&((et=S==null?void 0:S.validate)==null||et.call(S,"blur").catch(Mt=>void 0))}}),le=K(()=>{var et;return(et=b==null?void 0:b.statusIcon)!=null?et:!1}),de=K(()=>(S==null?void 0:S.validateState)||""),he=K(()=>de.value&&aL[de.value]),se=K(()=>H.value?w_e:e_e),ie=K(()=>[c.style]),oe=K(()=>[i.inputStyle,z.value,{resize:i.resize}]),ee=K(()=>Hr(i.modelValue)?"":String(i.modelValue)),Q=K(()=>i.clearable&&!R.value&&!i.readonly&&!!ee.value&&($.value||L.value)),ue=K(()=>i.showPassword&&!R.value&&!i.readonly&&!!ee.value&&(!!ee.value||$.value)),me=K(()=>i.showWordLimit&&!!i.maxlength&&(i.type==="text"||i.type==="textarea")&&!R.value&&!i.readonly&&!i.showPassword),be=K(()=>ee.value.length),ke=K(()=>!!me.value&&be.value>Number(i.maxlength)),Ye=K(()=>!!u.suffix||!!i.suffixIcon||Q.value||i.showPassword||me.value||!!de.value&&le.value),[Oe,Ee]=Y0e(D);Ko(x,et=>{if(Ve(),!me.value||i.resize!=="both")return;const Mt=et[0],{width:Jt}=Mt.contentRect;B.value={right:`calc(100% - ${Jt+15+6}px)`}});const we=()=>{const{type:et,autosize:Mt}=i;if(!(!$n||et!=="textarea"||!x.value))if(Mt){const Jt=En(Mt)?Mt.minRows:void 0,sn=En(Mt)?Mt.maxRows:void 0,gn=oB(x.value,Jt,sn);z.value={overflowY:"hidden",...gn},zt(()=>{x.value.offsetHeight,z.value=gn})}else z.value={minHeight:oB(x.value).minHeight}},Ve=(et=>{let Mt=!1;return()=>{var Jt;if(Mt||!i.autosize)return;((Jt=x.value)==null?void 0:Jt.offsetParent)===null||(et(),Mt=!0)}})(we),qe=()=>{const et=W.value,Mt=i.formatter?i.formatter(ee.value):ee.value;!et||et.value===Mt||(et.value=Mt)},st=async et=>{Oe();let{value:Mt}=et.target;if(i.formatter&&(Mt=i.parser?i.parser(Mt):Mt),!F.value){if(Mt===ee.value){qe();return}o(Mn,Mt),o("input",Mt),await zt(),qe(),Ee()}},Ie=et=>{o("change",et.target.value)},Ae=et=>{o("compositionstart",et),F.value=!0},xe=et=>{var Mt;o("compositionupdate",et);const Jt=(Mt=et.target)==null?void 0:Mt.value,sn=Jt[Jt.length-1]||"";F.value=!lL(sn)},ot=et=>{o("compositionend",et),F.value&&(F.value=!1,st(et))},je=()=>{H.value=!H.value,at()},at=async()=>{var et;await zt(),(et=W.value)==null||et.focus()},ht=()=>{var et;return(et=W.value)==null?void 0:et.blur()},dt=et=>{L.value=!1,o("mouseleave",et)},ft=et=>{L.value=!0,o("mouseenter",et)},Je=et=>{o("keydown",et)},Et=()=>{var et;(et=W.value)==null||et.select()},Nt=()=>{o(Mn,""),o("change",""),o("clear"),o("input","")};return rt(()=>i.modelValue,()=>{var et;zt(()=>we()),i.validateEvent&&((et=S==null?void 0:S.validate)==null||et.call(S,"change").catch(Mt=>void 0))}),rt(ee,()=>qe()),rt(()=>i.type,async()=>{await zt(),qe(),we()}),fn(()=>{!i.formatter&&i.parser,qe(),zt(we)}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-input",ref:"https://element-plus.org/en-US/component/input.html"},K(()=>!!i.label)),t({input:D,textarea:x,ref:W,textareaStyle:oe,autosize:Io(i,"autosize"),focus:at,blur:ht,select:Et,clear:Nt,resizeTextarea:we}),(et,Mt)=>(J(),ge("div",Nn(y(f),{class:y(p),style:y(ie),role:et.containerRole,onMouseenter:ft,onMouseleave:dt}),[Fe(" input "),et.type!=="textarea"?(J(),ge(qt,{key:0},[Fe(" prepend slot "),et.$slots.prepend?(J(),ge("div",{key:0,class:ne(y(E).be("group","prepend"))},[We(et.$slots,"prepend")],2)):Fe("v-if",!0),Ce("div",{ref_key:"wrapperRef",ref:Z,class:ne(y(m))},[Fe(" prefix slot "),et.$slots.prefix||et.prefixIcon?(J(),ge("span",{key:0,class:ne(y(E).e("prefix"))},[Ce("span",{class:ne(y(E).e("prefix-inner"))},[We(et.$slots,"prefix"),et.prefixIcon?(J(),He(y(Gt),{key:0,class:ne(y(E).e("icon"))},{default:Ne(()=>[(J(),He(wn(et.prefixIcon)))]),_:1},8,["class"])):Fe("v-if",!0)],2)],2)):Fe("v-if",!0),Ce("input",Nn({id:y(T),ref_key:"input",ref:D,class:y(E).e("inner")},y(_),{minlength:et.minlength,maxlength:et.maxlength,type:et.showPassword?H.value?"text":"password":et.type,disabled:y(R),readonly:et.readonly,autocomplete:et.autocomplete,tabindex:et.tabindex,"aria-label":et.label||et.ariaLabel,placeholder:et.placeholder,style:et.inputStyle,form:et.form,autofocus:et.autofocus,onCompositionstart:Ae,onCompositionupdate:xe,onCompositionend:ot,onInput:st,onFocus:Mt[0]||(Mt[0]=(...Jt)=>y(O)&&y(O)(...Jt)),onBlur:Mt[1]||(Mt[1]=(...Jt)=>y(X)&&y(X)(...Jt)),onChange:Ie,onKeydown:Je}),null,16,Tbe),Fe(" suffix slot "),y(Ye)?(J(),ge("span",{key:1,class:ne(y(E).e("suffix"))},[Ce("span",{class:ne(y(E).e("suffix-inner"))},[!y(Q)||!y(ue)||!y(me)?(J(),ge(qt,{key:0},[We(et.$slots,"suffix"),et.suffixIcon?(J(),He(y(Gt),{key:0,class:ne(y(E).e("icon"))},{default:Ne(()=>[(J(),He(wn(et.suffixIcon)))]),_:1},8,["class"])):Fe("v-if",!0)],64)):Fe("v-if",!0),y(Q)?(J(),He(y(Gt),{key:1,class:ne([y(E).e("icon"),y(E).e("clear")]),onMousedown:nn(y(co),["prevent"]),onClick:Nt},{default:Ne(()=>[Me(y(Ad))]),_:1},8,["class","onMousedown"])):Fe("v-if",!0),y(ue)?(J(),He(y(Gt),{key:2,class:ne([y(E).e("icon"),y(E).e("password")]),onClick:je},{default:Ne(()=>[(J(),He(wn(y(se))))]),_:1},8,["class"])):Fe("v-if",!0),y(me)?(J(),ge("span",{key:3,class:ne(y(E).e("count"))},[Ce("span",{class:ne(y(E).e("count-inner"))},pt(y(be))+" / "+pt(et.maxlength),3)],2)):Fe("v-if",!0),y(de)&&y(he)&&y(le)?(J(),He(y(Gt),{key:4,class:ne([y(E).e("icon"),y(E).e("validateIcon"),y(E).is("loading",y(de)==="validating")])},{default:Ne(()=>[(J(),He(wn(y(he))))]),_:1},8,["class"])):Fe("v-if",!0)],2)],2)):Fe("v-if",!0)],2),Fe(" append slot "),et.$slots.append?(J(),ge("div",{key:1,class:ne(y(E).be("group","append"))},[We(et.$slots,"append")],2)):Fe("v-if",!0)],64)):(J(),ge(qt,{key:1},[Fe(" textarea "),Ce("textarea",Nn({id:y(T),ref_key:"textarea",ref:x,class:y(N).e("inner")},y(_),{minlength:et.minlength,maxlength:et.maxlength,tabindex:et.tabindex,disabled:y(R),readonly:et.readonly,autocomplete:et.autocomplete,style:y(oe),"aria-label":et.label||et.ariaLabel,placeholder:et.placeholder,form:et.form,autofocus:et.autofocus,onCompositionstart:Ae,onCompositionupdate:xe,onCompositionend:ot,onInput:st,onFocus:Mt[2]||(Mt[2]=(...Jt)=>y(O)&&y(O)(...Jt)),onBlur:Mt[3]||(Mt[3]=(...Jt)=>y(X)&&y(X)(...Jt)),onChange:Ie,onKeydown:Je}),null,16,Ebe),y(me)?(J(),ge("span",{key:0,style:Ht(B.value),class:ne(y(E).e("count"))},pt(y(be))+" / "+pt(et.maxlength),7)):Fe("v-if",!0)],64))],16,Sbe))}});var Abe=vt(kbe,[["__file","input.vue"]]);const Ai=bn(Abe),xg=4,w9={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},Rbe=({move:e,size:t,bar:o})=>({[o.size]:t,transform:`translate${o.axis}(${e}%)`}),DL=Symbol("scrollbarContextKey"),wbe=gt({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),Dbe="Thumb",Obe=Se({__name:"thumb",props:wbe,setup(e){const t=e,o=wt(DL),i=lt("scrollbar");o||wr(Dbe,"can not inject scrollbar context");const c=ae(),u=ae(),f=ae({}),p=ae(!1);let m=!1,_=!1,b=$n?document.onselectstart:null;const S=K(()=>w9[t.vertical?"vertical":"horizontal"]),T=K(()=>Rbe({size:t.size,move:t.move,bar:S.value})),M=K(()=>c.value[S.value.offset]**2/o.wrapElement[S.value.scrollSize]/t.ratio/u.value[S.value.offset]),R=B=>{var z;if(B.stopPropagation(),B.ctrlKey||[1,2].includes(B.button))return;(z=window.getSelection())==null||z.removeAllRanges(),N(B);const W=B.currentTarget;W&&(f.value[S.value.axis]=W[S.value.offset]-(B[S.value.client]-W.getBoundingClientRect()[S.value.direction]))},E=B=>{if(!u.value||!c.value||!o.wrapElement)return;const z=Math.abs(B.target.getBoundingClientRect()[S.value.direction]-B[S.value.client]),W=u.value[S.value.offset]/2,Z=(z-W)*100*M.value/c.value[S.value.offset];o.wrapElement[S.value.scroll]=Z*o.wrapElement[S.value.scrollSize]/100},N=B=>{B.stopImmediatePropagation(),m=!0,document.addEventListener("mousemove",D),document.addEventListener("mouseup",x),b=document.onselectstart,document.onselectstart=()=>!1},D=B=>{if(!c.value||!u.value||m===!1)return;const z=f.value[S.value.axis];if(!z)return;const W=(c.value.getBoundingClientRect()[S.value.direction]-B[S.value.client])*-1,Z=u.value[S.value.offset]-z,$=(W-Z)*100*M.value/c.value[S.value.offset];o.wrapElement[S.value.scroll]=$*o.wrapElement[S.value.scrollSize]/100},x=()=>{m=!1,f.value[S.value.axis]=0,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",x),H(),_&&(p.value=!1)},L=()=>{_=!1,p.value=!!t.size},F=()=>{_=!0,p.value=m};Ro(()=>{H(),document.removeEventListener("mouseup",x)});const H=()=>{document.onselectstart!==b&&(document.onselectstart=b)};return Oo(Io(o,"scrollbarElement"),"mousemove",L),Oo(Io(o,"scrollbarElement"),"mouseleave",F),(B,z)=>(J(),He(Rr,{name:y(i).b("fade"),persisted:""},{default:Ne(()=>[hn(Ce("div",{ref_key:"instance",ref:c,class:ne([y(i).e("bar"),y(i).is(y(S).key)]),onMousedown:E},[Ce("div",{ref_key:"thumb",ref:u,class:ne(y(i).e("thumb")),style:Ht(y(T)),onMousedown:R},null,38)],34),[[Jn,B.always||p.value]])]),_:1},8,["name"]))}});var rB=vt(Obe,[["__file","thumb.vue"]]);const Nbe=gt({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),Lbe=Se({__name:"bar",props:Nbe,setup(e,{expose:t}){const o=e,i=wt(DL),c=ae(0),u=ae(0),f=ae(""),p=ae(""),m=ae(1),_=ae(1);return t({handleScroll:T=>{if(T){const M=T.offsetHeight-xg,R=T.offsetWidth-xg;u.value=T.scrollTop*100/M*m.value,c.value=T.scrollLeft*100/R*_.value}},update:()=>{const T=i==null?void 0:i.wrapElement;if(!T)return;const M=T.offsetHeight-xg,R=T.offsetWidth-xg,E=M**2/T.scrollHeight,N=R**2/T.scrollWidth,D=Math.max(E,o.minSize),x=Math.max(N,o.minSize);m.value=E/(M-E)/(D/(M-D)),_.value=N/(R-N)/(x/(R-x)),p.value=D+xg<M?`${D}px`:"",f.value=x+xg<R?`${x}px`:""}}),(T,M)=>(J(),ge(qt,null,[Me(rB,{move:c.value,ratio:_.value,size:f.value,always:T.always},null,8,["move","ratio","size","always"]),Me(rB,{move:u.value,ratio:m.value,size:p.value,vertical:"",always:T.always},null,8,["move","ratio","size","always"])],64))}});var Pbe=vt(Lbe,[["__file","bar.vue"]]);const Ube=gt({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Le([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,...ti(["ariaLabel","ariaOrientation"])}),xbe={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Zt)},Fbe="ElScrollbar",Vbe=Se({name:Fbe}),Gbe=Se({...Vbe,props:Ube,emits:xbe,setup(e,{expose:t,emit:o}){const i=e,c=lt("scrollbar");let u,f;const p=ae(),m=ae(),_=ae(),b=ae(),S=K(()=>{const L={};return i.height&&(L.height=Xo(i.height)),i.maxHeight&&(L.maxHeight=Xo(i.maxHeight)),[i.wrapStyle,L]}),T=K(()=>[i.wrapClass,c.e("wrap"),{[c.em("wrap","hidden-default")]:!i.native}]),M=K(()=>[c.e("view"),i.viewClass]),R=()=>{var L;m.value&&((L=b.value)==null||L.handleScroll(m.value),o("scroll",{scrollTop:m.value.scrollTop,scrollLeft:m.value.scrollLeft}))};function E(L,F){En(L)?m.value.scrollTo(L):Zt(L)&&Zt(F)&&m.value.scrollTo(L,F)}const N=L=>{Zt(L)&&(m.value.scrollTop=L)},D=L=>{Zt(L)&&(m.value.scrollLeft=L)},x=()=>{var L;(L=b.value)==null||L.update()};return rt(()=>i.noresize,L=>{L?(u==null||u(),f==null||f()):({stop:u}=Ko(_,x),f=Oo("resize",x))},{immediate:!0}),rt(()=>[i.maxHeight,i.height],()=>{i.native||zt(()=>{var L;x(),m.value&&((L=b.value)==null||L.handleScroll(m.value))})}),Ln(DL,Zn({scrollbarElement:p,wrapElement:m})),fn(()=>{i.native||zt(()=>{x()})}),Oc(()=>x()),t({wrapRef:m,update:x,scrollTo:E,setScrollTop:N,setScrollLeft:D,handleScroll:R}),(L,F)=>(J(),ge("div",{ref_key:"scrollbarRef",ref:p,class:ne(y(c).b())},[Ce("div",{ref_key:"wrapRef",ref:m,class:ne(y(T)),style:Ht(y(S)),onScroll:R},[(J(),He(wn(L.tag),{id:L.id,ref_key:"resizeRef",ref:_,class:ne(y(M)),style:Ht(L.viewStyle),role:L.role,"aria-label":L.ariaLabel,"aria-orientation":L.ariaOrientation},{default:Ne(()=>[We(L.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),L.native?Fe("v-if",!0):(J(),He(Pbe,{key:0,ref_key:"barRef",ref:b,always:L.always,"min-size":L.minSize},null,8,["always","min-size"]))],2))}});var Bbe=vt(Gbe,[["__file","scrollbar.vue"]]);const xc=bn(Bbe),OL=Symbol("popper"),D9=Symbol("popperContent"),$be=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],O9=gt({role:{type:String,values:$be,default:"tooltip"}}),Hbe=Se({name:"ElPopper",inheritAttrs:!1}),qbe=Se({...Hbe,props:O9,setup(e,{expose:t}){const o=e,i=ae(),c=ae(),u=ae(),f=ae(),p=K(()=>o.role),m={triggerRef:i,popperInstanceRef:c,contentRef:u,referenceRef:f,role:p};return t(m),Ln(OL,m),(_,b)=>We(_.$slots,"default")}});var Kbe=vt(qbe,[["__file","popper.vue"]]);const N9=gt({arrowOffset:{type:Number,default:5}}),zbe=Se({name:"ElPopperArrow",inheritAttrs:!1}),Wbe=Se({...zbe,props:N9,setup(e,{expose:t}){const o=e,i=lt("popper"),{arrowOffset:c,arrowRef:u,arrowStyle:f}=wt(D9,void 0);return rt(()=>o.arrowOffset,p=>{c.value=p}),Ro(()=>{u.value=void 0}),t({arrowRef:u}),(p,m)=>(J(),ge("span",{ref_key:"arrowRef",ref:u,class:ne(y(i).e("arrow")),style:Ht(y(f)),"data-popper-arrow":""},null,6))}});var jbe=vt(Wbe,[["__file","arrow.vue"]]);const Ybe="ElOnlyChild",L9=Se({name:Ybe,setup(e,{slots:t,attrs:o}){var i;const c=wt(u9),u=u0e((i=c==null?void 0:c.setForwardRef)!=null?i:co);return()=>{var f;const p=(f=t.default)==null?void 0:f.call(t,o);if(!p||p.length>1)return null;const m=P9(p);return m?hn(Ac(m,o),[[u]]):null}}});function P9(e){if(!e)return null;const t=e;for(const o of t){if(En(o))switch(o.type){case Mi:continue;case Pm:case"svg":return iB(o);case qt:return P9(o.children);default:return o}return iB(o)}return null}function iB(e){const t=lt("only-child");return Me("span",{class:t.e("content")},[e])}const U9=gt({virtualRef:{type:Le(Object)},virtualTriggering:Boolean,onMouseenter:{type:Le(Function)},onMouseleave:{type:Le(Function)},onClick:{type:Le(Function)},onKeydown:{type:Le(Function)},onFocus:{type:Le(Function)},onBlur:{type:Le(Function)},onContextmenu:{type:Le(Function)},id:String,open:Boolean}),Jbe=Se({name:"ElPopperTrigger",inheritAttrs:!1}),Xbe=Se({...Jbe,props:U9,setup(e,{expose:t}){const o=e,{role:i,triggerRef:c}=wt(OL,void 0);c0e(c);const u=K(()=>p.value?o.id:void 0),f=K(()=>{if(i&&i.value==="tooltip")return o.open&&o.id?o.id:void 0}),p=K(()=>{if(i&&i.value!=="tooltip")return i.value}),m=K(()=>p.value?`${o.open}`:void 0);let _;return fn(()=>{rt(()=>o.virtualRef,b=>{b&&(c.value=os(b))},{immediate:!0}),rt(c,(b,S)=>{_==null||_(),_=void 0,ra(b)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(T=>{var M;const R=o[T];R&&(b.addEventListener(T.slice(2).toLowerCase(),R),(M=S==null?void 0:S.removeEventListener)==null||M.call(S,T.slice(2).toLowerCase(),R))}),_=rt([u,f,p,m],T=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((M,R)=>{Hr(T[R])?b.removeAttribute(M):b.setAttribute(M,T[R])})},{immediate:!0})),ra(S)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(T=>S.removeAttribute(T))},{immediate:!0})}),Ro(()=>{_==null||_(),_=void 0}),t({triggerRef:c}),(b,S)=>b.virtualTriggering?Fe("v-if",!0):(J(),He(y(L9),Nn({key:0},b.$attrs,{"aria-controls":y(u),"aria-describedby":y(f),"aria-expanded":y(m),"aria-haspopup":y(p)}),{default:Ne(()=>[We(b.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var Qbe=vt(Xbe,[["__file","trigger.vue"]]);const Yw="focus-trap.focus-after-trapped",Jw="focus-trap.focus-after-released",Zbe="focus-trap.focusout-prevented",sB={cancelable:!0,bubbles:!1},eCe={cancelable:!0,bubbles:!1},aB="focusAfterTrapped",lB="focusAfterReleased",NL=Symbol("elFocusTrap"),LL=ae(),g1=ae(0),PL=ae(0);let uT=0;const x9=e=>{const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const c=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||c?NodeFilter.FILTER_SKIP:i.tabIndex>=0||i===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t},cB=(e,t)=>{for(const o of e)if(!tCe(o,t))return o},tCe=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},nCe=e=>{const t=x9(e),o=cB(t,e),i=cB(t.reverse(),e);return[o,i]},oCe=e=>e instanceof HTMLInputElement&&"select"in e,Ku=(e,t)=>{if(e&&e.focus){const o=document.activeElement;e.focus({preventScroll:!0}),PL.value=window.performance.now(),e!==o&&oCe(e)&&t&&e.select()}};function uB(e,t){const o=[...e],i=e.indexOf(t);return i!==-1&&o.splice(i,1),o}const rCe=()=>{let e=[];return{push:i=>{const c=e[0];c&&i!==c&&c.pause(),e=uB(e,i),e.unshift(i)},remove:i=>{var c,u;e=uB(e,i),(u=(c=e[0])==null?void 0:c.resume)==null||u.call(c)}}},iCe=(e,t=!1)=>{const o=document.activeElement;for(const i of e)if(Ku(i,t),document.activeElement!==o)return},dB=rCe(),sCe=()=>g1.value>PL.value,dT=()=>{LL.value="pointer",g1.value=window.performance.now()},hB=()=>{LL.value="keyboard",g1.value=window.performance.now()},aCe=()=>(fn(()=>{uT===0&&(document.addEventListener("mousedown",dT),document.addEventListener("touchstart",dT),document.addEventListener("keydown",hB)),uT++}),Ro(()=>{uT--,uT<=0&&(document.removeEventListener("mousedown",dT),document.removeEventListener("touchstart",dT),document.removeEventListener("keydown",hB))}),{focusReason:LL,lastUserFocusTimestamp:g1,lastAutomatedFocusTimestamp:PL}),hT=e=>new CustomEvent(Zbe,{...eCe,detail:e}),lCe=Se({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[aB,lB,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const o=ae();let i,c;const{focusReason:u}=aCe();r0e(R=>{e.trapped&&!f.paused&&t("release-requested",R)});const f={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=R=>{if(!e.loop&&!e.trapped||f.paused)return;const{key:E,altKey:N,ctrlKey:D,metaKey:x,currentTarget:L,shiftKey:F}=R,{loop:H}=e,B=E===Yt.tab&&!N&&!D&&!x,z=document.activeElement;if(B&&z){const W=L,[Z,$]=nCe(W);if(Z&&$){if(!F&&z===$){const X=hT({focusReason:u.value});t("focusout-prevented",X),X.defaultPrevented||(R.preventDefault(),H&&Ku(Z,!0))}else if(F&&[Z,W].includes(z)){const X=hT({focusReason:u.value});t("focusout-prevented",X),X.defaultPrevented||(R.preventDefault(),H&&Ku($,!0))}}else if(z===W){const X=hT({focusReason:u.value});t("focusout-prevented",X),X.defaultPrevented||R.preventDefault()}}};Ln(NL,{focusTrapRef:o,onKeydown:p}),rt(()=>e.focusTrapEl,R=>{R&&(o.value=R)},{immediate:!0}),rt([o],([R],[E])=>{R&&(R.addEventListener("keydown",p),R.addEventListener("focusin",b),R.addEventListener("focusout",S)),E&&(E.removeEventListener("keydown",p),E.removeEventListener("focusin",b),E.removeEventListener("focusout",S))});const m=R=>{t(aB,R)},_=R=>t(lB,R),b=R=>{const E=y(o);if(!E)return;const N=R.target,D=R.relatedTarget,x=N&&E.contains(N);e.trapped||D&&E.contains(D)||(i=D),x&&t("focusin",R),!f.paused&&e.trapped&&(x?c=N:Ku(c,!0))},S=R=>{const E=y(o);if(!(f.paused||!E))if(e.trapped){const N=R.relatedTarget;!Hr(N)&&!E.contains(N)&&setTimeout(()=>{if(!f.paused&&e.trapped){const D=hT({focusReason:u.value});t("focusout-prevented",D),D.defaultPrevented||Ku(c,!0)}},0)}else{const N=R.target;N&&E.contains(N)||t("focusout",R)}};async function T(){await zt();const R=y(o);if(R){dB.push(f);const E=R.contains(document.activeElement)?i:document.activeElement;if(i=E,!R.contains(E)){const D=new Event(Yw,sB);R.addEventListener(Yw,m),R.dispatchEvent(D),D.defaultPrevented||zt(()=>{let x=e.focusStartEl;on(x)||(Ku(x),document.activeElement!==x&&(x="first")),x==="first"&&iCe(x9(R),!0),(document.activeElement===E||x==="container")&&Ku(R)})}}}function M(){const R=y(o);if(R){R.removeEventListener(Yw,m);const E=new CustomEvent(Jw,{...sB,detail:{focusReason:u.value}});R.addEventListener(Jw,_),R.dispatchEvent(E),!E.defaultPrevented&&(u.value=="keyboard"||!sCe()||R.contains(document.activeElement))&&Ku(i??document.body),R.removeEventListener(Jw,_),dB.remove(f)}}return fn(()=>{e.trapped&&T(),rt(()=>e.trapped,R=>{R?T():M()})}),Ro(()=>{e.trapped&&M()}),{onKeydown:p}}});function cCe(e,t,o,i,c,u){return We(e.$slots,"default",{handleKeydown:e.onKeydown})}var CI=vt(lCe,[["render",cCe],["__file","focus-trap.vue"]]);const uCe=["fixed","absolute"],dCe=gt({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Le(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:ip,default:"bottom"},popperOptions:{type:Le(Object),default:()=>({})},strategy:{type:String,values:uCe,default:"absolute"}}),F9=gt({...dCe,id:String,style:{type:Le([String,Array,Object])},className:{type:Le([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:Le([String,Array,Object])},popperStyle:{type:Le([String,Array,Object])},referenceEl:{type:Le(Object)},triggerTargetEl:{type:Le(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...ti(["ariaLabel"])}),hCe={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},fCe=(e,t=[])=>{const{placement:o,strategy:i,popperOptions:c}=e,u={placement:o,strategy:i,...c,modifiers:[...gCe(e),...t]};return mCe(u,c==null?void 0:c.modifiers),u},pCe=e=>{if($n)return os(e)};function gCe(e){const{offset:t,gpuAcceleration:o,fallbackPlacements:i}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:i}},{name:"computeStyles",options:{gpuAcceleration:o}}]}function mCe(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const vCe=0,_Ce=e=>{const{popperInstanceRef:t,contentRef:o,triggerRef:i,role:c}=wt(OL,void 0),u=ae(),f=ae(),p=K(()=>({name:"eventListeners",enabled:!!e.visible})),m=K(()=>{var D;const x=y(u),L=(D=y(f))!=null?D:vCe;return{name:"arrow",enabled:!Nq(x),options:{element:x,padding:L}}}),_=K(()=>({onFirstUpdate:()=>{R()},...fCe(e,[y(m),y(p)])})),b=K(()=>pCe(e.referenceEl)||y(i)),{attributes:S,state:T,styles:M,update:R,forceUpdate:E,instanceRef:N}=e0e(b,o,_);return rt(N,D=>t.value=D),fn(()=>{rt(()=>{var D;return(D=y(b))==null?void 0:D.getBoundingClientRect()},()=>{R()})}),{attributes:S,arrowRef:u,contentRef:o,instanceRef:N,state:T,styles:M,role:c,forceUpdate:E,update:R}},yCe=(e,{attributes:t,styles:o,role:i})=>{const{nextZIndex:c}=Bm(),u=lt("popper"),f=K(()=>y(t).popper),p=ae(Zt(e.zIndex)?e.zIndex:c()),m=K(()=>[u.b(),u.is("pure",e.pure),u.is(e.effect),e.popperClass]),_=K(()=>[{zIndex:y(p)},y(o).popper,e.popperStyle||{}]),b=K(()=>i.value==="dialog"?"false":void 0),S=K(()=>y(o).arrow||{});return{ariaModal:b,arrowStyle:S,contentAttrs:f,contentClass:m,contentStyle:_,contentZIndex:p,updateZIndex:()=>{p.value=Zt(e.zIndex)?e.zIndex:c()}}},ICe=(e,t)=>{const o=ae(!1),i=ae();return{focusStartRef:i,trapped:o,onFocusAfterReleased:_=>{var b;((b=_.detail)==null?void 0:b.focusReason)!=="pointer"&&(i.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:_=>{e.visible&&!o.value&&(_.target&&(i.value=_.target),o.value=!0)},onFocusoutPrevented:_=>{e.trapping||(_.detail.focusReason==="pointer"&&_.preventDefault(),o.value=!1)},onReleaseRequested:()=>{o.value=!1,t("close")}}},bCe=Se({name:"ElPopperContent"}),CCe=Se({...bCe,props:F9,emits:hCe,setup(e,{expose:t,emit:o}){const i=e,{focusStartRef:c,trapped:u,onFocusAfterReleased:f,onFocusAfterTrapped:p,onFocusInTrap:m,onFocusoutPrevented:_,onReleaseRequested:b}=ICe(i,o),{attributes:S,arrowRef:T,contentRef:M,styles:R,instanceRef:E,role:N,update:D}=_Ce(i),{ariaModal:x,arrowStyle:L,contentAttrs:F,contentClass:H,contentStyle:B,updateZIndex:z}=yCe(i,{styles:R,attributes:S,role:N}),W=wt(kl,void 0),Z=ae();Ln(D9,{arrowStyle:L,arrowRef:T,arrowOffset:Z}),W&&Ln(kl,{...W,addInputId:co,removeInputId:co});let $;const O=(le=!0)=>{D(),le&&z()},X=()=>{O(!1),i.visible&&i.focusOnShow?u.value=!0:i.visible===!1&&(u.value=!1)};return fn(()=>{rt(()=>i.triggerTargetEl,(le,de)=>{$==null||$(),$=void 0;const he=y(le||M.value),se=y(de||M.value);ra(he)&&($=rt([N,()=>i.ariaLabel,x,()=>i.id],ie=>{["role","aria-label","aria-modal","id"].forEach((oe,ee)=>{Hr(ie[ee])?he.removeAttribute(oe):he.setAttribute(oe,ie[ee])})},{immediate:!0})),se!==he&&ra(se)&&["role","aria-label","aria-modal","id"].forEach(ie=>{se.removeAttribute(ie)})},{immediate:!0}),rt(()=>i.visible,X,{immediate:!0})}),Ro(()=>{$==null||$(),$=void 0}),t({popperContentRef:M,popperInstanceRef:E,updatePopper:O,contentStyle:B}),(le,de)=>(J(),ge("div",Nn({ref_key:"contentRef",ref:M},y(F),{style:y(B),class:y(H),tabindex:"-1",onMouseenter:de[0]||(de[0]=he=>le.$emit("mouseenter",he)),onMouseleave:de[1]||(de[1]=he=>le.$emit("mouseleave",he))}),[Me(y(CI),{trapped:y(u),"trap-on-focus-in":!0,"focus-trap-el":y(M),"focus-start-el":y(c),onFocusAfterTrapped:y(p),onFocusAfterReleased:y(f),onFocusin:y(m),onFocusoutPrevented:y(_),onReleaseRequested:y(b)},{default:Ne(()=>[We(le.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var SCe=vt(CCe,[["__file","content.vue"]]);const V9=bn(Kbe),m1=Symbol("elTooltip"),Gr=gt({...a0e,...F9,appendTo:{type:Le([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,visible:{type:Le(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...ti(["ariaLabel"])}),K0=gt({...U9,disabled:Boolean,trigger:{type:Le([String,Array]),default:"hover"},triggerKeys:{type:Le(Array),default:()=>[Yt.enter,Yt.space]}}),{useModelToggleProps:TCe,useModelToggleEmits:ECe,useModelToggle:MCe}=Jq("visible"),kCe=gt({...O9,...TCe,...Gr,...K0,...N9,showArrow:{type:Boolean,default:!0}}),ACe=[...ECe,"before-show","before-hide","show","hide","open","close"],RCe=(e,t)=>At(e)?e.includes(t):e===t,Fg=(e,t,o)=>i=>{RCe(y(e),t)&&o(i)},wCe=Se({name:"ElTooltipTrigger"}),DCe=Se({...wCe,props:K0,setup(e,{expose:t}){const o=e,i=lt("tooltip"),{controlled:c,id:u,open:f,onOpen:p,onClose:m,onToggle:_}=wt(m1,void 0),b=ae(null),S=()=>{if(y(c)||o.disabled)return!0},T=Io(o,"trigger"),M=Jo(S,Fg(T,"hover",p)),R=Jo(S,Fg(T,"hover",m)),E=Jo(S,Fg(T,"click",F=>{F.button===0&&_(F)})),N=Jo(S,Fg(T,"focus",p)),D=Jo(S,Fg(T,"focus",m)),x=Jo(S,Fg(T,"contextmenu",F=>{F.preventDefault(),_(F)})),L=Jo(S,F=>{const{code:H}=F;o.triggerKeys.includes(H)&&(F.preventDefault(),_(F))});return t({triggerRef:b}),(F,H)=>(J(),He(y(Qbe),{id:y(u),"virtual-ref":F.virtualRef,open:y(f),"virtual-triggering":F.virtualTriggering,class:ne(y(i).e("trigger")),onBlur:y(D),onClick:y(E),onContextmenu:y(x),onFocus:y(N),onMouseenter:y(M),onMouseleave:y(R),onKeydown:y(L)},{default:Ne(()=>[We(F.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var OCe=vt(DCe,[["__file","trigger.vue"]]);const NCe=Se({name:"ElTooltipContent",inheritAttrs:!1}),LCe=Se({...NCe,props:Gr,setup(e,{expose:t}){const o=e,{selector:i}=c9(),c=lt("tooltip"),u=ae(null),f=ae(!1),{controlled:p,id:m,open:_,trigger:b,onClose:S,onOpen:T,onShow:M,onHide:R,onBeforeShow:E,onBeforeHide:N}=wt(m1,void 0),D=K(()=>o.transition||`${c.namespace.value}-fade-in-linear`),x=K(()=>o.persistent);Ro(()=>{f.value=!0});const L=K(()=>y(x)?!0:y(_)),F=K(()=>o.disabled?!1:y(_)),H=K(()=>o.appendTo||i.value),B=K(()=>{var ie;return(ie=o.style)!=null?ie:{}}),z=K(()=>!y(_)),W=()=>{R()},Z=()=>{if(y(p))return!0},$=Jo(Z,()=>{o.enterable&&y(b)==="hover"&&T()}),O=Jo(Z,()=>{y(b)==="hover"&&S()}),X=()=>{var ie,oe;(oe=(ie=u.value)==null?void 0:ie.updatePopper)==null||oe.call(ie),E==null||E()},le=()=>{N==null||N()},de=()=>{M(),se=UN(K(()=>{var ie;return(ie=u.value)==null?void 0:ie.popperContentRef}),()=>{if(y(p))return;y(b)!=="hover"&&S()})},he=()=>{o.virtualTriggering||S()};let se;return rt(()=>y(_),ie=>{ie||se==null||se()},{flush:"post"}),rt(()=>o.content,()=>{var ie,oe;(oe=(ie=u.value)==null?void 0:ie.updatePopper)==null||oe.call(ie)}),t({contentRef:u}),(ie,oe)=>(J(),He(Lm,{disabled:!ie.teleported,to:y(H)},[Me(Rr,{name:y(D),onAfterLeave:W,onBeforeEnter:X,onAfterEnter:de,onBeforeLeave:le},{default:Ne(()=>[y(L)?hn((J(),He(y(SCe),Nn({key:0,id:y(m),ref_key:"contentRef",ref:u},ie.$attrs,{"aria-label":ie.ariaLabel,"aria-hidden":y(z),"boundaries-padding":ie.boundariesPadding,"fallback-placements":ie.fallbackPlacements,"gpu-acceleration":ie.gpuAcceleration,offset:ie.offset,placement:ie.placement,"popper-options":ie.popperOptions,strategy:ie.strategy,effect:ie.effect,enterable:ie.enterable,pure:ie.pure,"popper-class":ie.popperClass,"popper-style":[ie.popperStyle,y(B)],"reference-el":ie.referenceEl,"trigger-target-el":ie.triggerTargetEl,visible:y(F),"z-index":ie.zIndex,onMouseenter:y($),onMouseleave:y(O),onBlur:he,onClose:y(S)}),{default:Ne(()=>[f.value?Fe("v-if",!0):We(ie.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Jn,y(F)]]):Fe("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var PCe=vt(LCe,[["__file","content.vue"]]);const UCe=["innerHTML"],xCe={key:1},FCe=Se({name:"ElTooltip"}),VCe=Se({...FCe,props:kCe,emits:ACe,setup(e,{expose:t,emit:o}){const i=e;s0e();const c=pi(),u=ae(),f=ae(),p=()=>{var D;const x=y(u);x&&((D=x.popperInstanceRef)==null||D.update())},m=ae(!1),_=ae(),{show:b,hide:S,hasUpdateHandler:T}=MCe({indicator:m,toggleReason:_}),{onOpen:M,onClose:R}=l0e({showAfter:Io(i,"showAfter"),hideAfter:Io(i,"hideAfter"),autoClose:Io(i,"autoClose"),open:b,close:S}),E=K(()=>yr(i.visible)&&!T.value);Ln(m1,{controlled:E,id:c,open:Nm(m),trigger:Io(i,"trigger"),onOpen:D=>{M(D)},onClose:D=>{R(D)},onToggle:D=>{y(m)?R(D):M(D)},onShow:()=>{o("show",_.value)},onHide:()=>{o("hide",_.value)},onBeforeShow:()=>{o("before-show",_.value)},onBeforeHide:()=>{o("before-hide",_.value)},updatePopper:p}),rt(()=>i.disabled,D=>{D&&m.value&&(m.value=!1)});const N=D=>{var x,L;const F=(L=(x=f.value)==null?void 0:x.contentRef)==null?void 0:L.popperContentRef,H=(D==null?void 0:D.relatedTarget)||document.activeElement;return F&&F.contains(H)};return oH(()=>m.value&&S()),t({popperRef:u,contentRef:f,isFocusInsideContent:N,updatePopper:p,onOpen:M,onClose:R,hide:S}),(D,x)=>(J(),He(y(V9),{ref_key:"popperRef",ref:u,role:D.role},{default:Ne(()=>[Me(OCe,{disabled:D.disabled,trigger:D.trigger,"trigger-keys":D.triggerKeys,"virtual-ref":D.virtualRef,"virtual-triggering":D.virtualTriggering},{default:Ne(()=>[D.$slots.default?We(D.$slots,"default",{key:0}):Fe("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Me(PCe,{ref_key:"contentRef",ref:f,"aria-label":D.ariaLabel,"boundaries-padding":D.boundariesPadding,content:D.content,disabled:D.disabled,effect:D.effect,enterable:D.enterable,"fallback-placements":D.fallbackPlacements,"hide-after":D.hideAfter,"gpu-acceleration":D.gpuAcceleration,offset:D.offset,persistent:D.persistent,"popper-class":D.popperClass,"popper-style":D.popperStyle,placement:D.placement,"popper-options":D.popperOptions,pure:D.pure,"raw-content":D.rawContent,"reference-el":D.referenceEl,"trigger-target-el":D.triggerTargetEl,"show-after":D.showAfter,strategy:D.strategy,teleported:D.teleported,transition:D.transition,"virtual-triggering":D.virtualTriggering,"z-index":D.zIndex,"append-to":D.appendTo},{default:Ne(()=>[We(D.$slots,"content",{},()=>[D.rawContent?(J(),ge("span",{key:0,innerHTML:D.content},null,8,UCe)):(J(),ge("span",xCe,pt(D.content),1))]),D.showArrow?(J(),He(y(jbe),{key:0,"arrow-offset":D.arrowOffset},null,8,["arrow-offset"])):Fe("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var GCe=vt(VCe,[["__file","tooltip.vue"]]);const Di=bn(GCe),BCe=gt({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:Le(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:Le([Function,Array]),default:co},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Gr.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...ti(["ariaLabel"])}),$Ce={[Mn]:e=>on(e),[Hi]:e=>on(e),[Lo]:e=>on(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>En(e)},HCe=["aria-expanded","aria-owns"],qCe={key:0},KCe=["id","aria-selected","onClick"],G9="ElAutocomplete",zCe=Se({name:G9,inheritAttrs:!1}),WCe=Se({...zCe,props:BCe,emits:$Ce,setup(e,{expose:t,emit:o}){const i=e,c=cL(),u=tp(),f=zi(),p=lt("autocomplete"),m=ae(),_=ae(),b=ae(),S=ae();let T=!1,M=!1;const R=ae([]),E=ae(-1),N=ae(""),D=ae(!1),x=ae(!1),L=ae(!1),F=pi(),H=K(()=>u.style),B=K(()=>(R.value.length>0||L.value)&&D.value),z=K(()=>!i.hideLoading&&L.value),W=K(()=>m.value?Array.from(m.value.$el.querySelectorAll("input")):[]),Z=()=>{B.value&&(N.value=`${m.value.$el.offsetWidth}px`)},$=()=>{E.value=-1},X=as(async Oe=>{if(x.value)return;const Ee=we=>{L.value=!1,!x.value&&(At(we)?(R.value=we,E.value=i.highlightFirstItem?0:-1):wr(G9,"autocomplete suggestions must be an array"))};if(L.value=!0,At(i.fetchSuggestions))Ee(i.fetchSuggestions);else{const we=await i.fetchSuggestions(Oe,Ee);At(we)&&Ee(we)}},i.debounce),le=Oe=>{const Ee=!!Oe;if(o(Hi,Oe),o(Mn,Oe),x.value=!1,D.value||(D.value=Ee),!i.triggerOnFocus&&!Oe){x.value=!0,R.value=[];return}X(Oe)},de=Oe=>{var Ee;f.value||(((Ee=Oe.target)==null?void 0:Ee.tagName)!=="INPUT"||W.value.includes(document.activeElement))&&(D.value=!0)},he=Oe=>{o(Lo,Oe)},se=Oe=>{M?M=!1:(D.value=!0,o("focus",Oe),i.triggerOnFocus&&!T&&X(String(i.modelValue)))},ie=Oe=>{setTimeout(()=>{var Ee;if((Ee=b.value)!=null&&Ee.isFocusInsideContent()){M=!0;return}D.value&&ue(),o("blur",Oe)})},oe=()=>{D.value=!1,o(Mn,""),o("clear")},ee=async()=>{B.value&&E.value>=0&&E.value<R.value.length?ke(R.value[E.value]):i.selectWhenUnmatched&&(o("select",{value:i.modelValue}),R.value=[],E.value=-1)},Q=Oe=>{B.value&&(Oe.preventDefault(),Oe.stopPropagation(),ue())},ue=()=>{D.value=!1},me=()=>{var Oe;(Oe=m.value)==null||Oe.focus()},be=()=>{var Oe;(Oe=m.value)==null||Oe.blur()},ke=async Oe=>{o(Hi,Oe[i.valueKey]),o(Mn,Oe[i.valueKey]),o("select",Oe),R.value=[],E.value=-1},Ye=Oe=>{if(!B.value||L.value)return;if(Oe<0){E.value=-1;return}Oe>=R.value.length&&(Oe=R.value.length-1);const Ee=_.value.querySelector(`.${p.be("suggestion","wrap")}`),Ge=Ee.querySelectorAll(`.${p.be("suggestion","list")} li`)[Oe],Ve=Ee.scrollTop,{offsetTop:qe,scrollHeight:st}=Ge;qe+st>Ve+Ee.clientHeight&&(Ee.scrollTop+=st),qe<Ve&&(Ee.scrollTop-=st),E.value=Oe,m.value.ref.setAttribute("aria-activedescendant",`${F.value}-item-${E.value}`)};return UN(S,()=>{B.value&&ue()}),fn(()=>{m.value.ref.setAttribute("role","textbox"),m.value.ref.setAttribute("aria-autocomplete","list"),m.value.ref.setAttribute("aria-controls","id"),m.value.ref.setAttribute("aria-activedescendant",`${F.value}-item-${E.value}`),T=m.value.ref.hasAttribute("readonly")}),t({highlightedIndex:E,activated:D,loading:L,inputRef:m,popperRef:b,suggestions:R,handleSelect:ke,handleKeyEnter:ee,focus:me,blur:be,close:ue,highlight:Ye}),(Oe,Ee)=>(J(),He(y(Di),{ref_key:"popperRef",ref:b,visible:y(B),placement:Oe.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(p).e("popper"),Oe.popperClass],teleported:Oe.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(p).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:Z,onHide:$},{content:Ne(()=>[Ce("div",{ref_key:"regionRef",ref:_,class:ne([y(p).b("suggestion"),y(p).is("loading",y(z))]),style:Ht({[Oe.fitInputWidth?"width":"minWidth"]:N.value,outline:"none"}),role:"region"},[Me(y(xc),{id:y(F),tag:"ul","wrap-class":y(p).be("suggestion","wrap"),"view-class":y(p).be("suggestion","list"),role:"listbox"},{default:Ne(()=>[y(z)?(J(),ge("li",qCe,[We(Oe.$slots,"loading",{},()=>[Me(y(Gt),{class:ne(y(p).is("loading"))},{default:Ne(()=>[Me(y(Rd))]),_:1},8,["class"])])])):(J(!0),ge(qt,{key:1},Vn(R.value,(we,Ge)=>(J(),ge("li",{id:`${y(F)}-item-${Ge}`,key:Ge,class:ne({highlighted:E.value===Ge}),role:"option","aria-selected":E.value===Ge,onClick:Ve=>ke(we)},[We(Oe.$slots,"default",{item:we},()=>[On(pt(we[Oe.valueKey]),1)])],10,KCe))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:Ne(()=>[Ce("div",{ref_key:"listboxRef",ref:S,class:ne([y(p).b(),Oe.$attrs.class]),style:Ht(y(H)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(B),"aria-owns":y(F)},[Me(y(Ai),Nn({ref_key:"inputRef",ref:m},y(c),{clearable:Oe.clearable,disabled:y(f),name:Oe.name,"model-value":Oe.modelValue,"aria-label":Oe.ariaLabel,onInput:le,onChange:he,onFocus:se,onBlur:ie,onClear:oe,onKeydown:[Ee[0]||(Ee[0]=go(nn(we=>Ye(E.value-1),["prevent"]),["up"])),Ee[1]||(Ee[1]=go(nn(we=>Ye(E.value+1),["prevent"]),["down"])),go(ee,["enter"]),go(ue,["tab"]),go(Q,["esc"])],onMousedown:de}),kc({_:2},[Oe.$slots.prepend?{name:"prepend",fn:Ne(()=>[We(Oe.$slots,"prepend")])}:void 0,Oe.$slots.append?{name:"append",fn:Ne(()=>[We(Oe.$slots,"append")])}:void 0,Oe.$slots.prefix?{name:"prefix",fn:Ne(()=>[We(Oe.$slots,"prefix")])}:void 0,Oe.$slots.suffix?{name:"suffix",fn:Ne(()=>[We(Oe.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,HCe)]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var jCe=vt(WCe,[["__file","autocomplete.vue"]]);const YCe=bn(jCe),JCe=gt({size:{type:[Number,String],values:Al,default:"",validator:e=>Zt(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:mo},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:Le(String),default:"cover"}}),XCe={error:e=>e instanceof Event},QCe=["src","alt","srcset"],ZCe=Se({name:"ElAvatar"}),eSe=Se({...ZCe,props:JCe,emits:XCe,setup(e,{emit:t}){const o=e,i=lt("avatar"),c=ae(!1),u=K(()=>{const{size:_,icon:b,shape:S}=o,T=[i.b()];return on(_)&&T.push(i.m(_)),b&&T.push(i.m("icon")),S&&T.push(i.m(S)),T}),f=K(()=>{const{size:_}=o;return Zt(_)?i.cssVarBlock({size:Xo(_)||""}):void 0}),p=K(()=>({objectFit:o.fit}));rt(()=>o.src,()=>c.value=!1);function m(_){c.value=!0,t("error",_)}return(_,b)=>(J(),ge("span",{class:ne(y(u)),style:Ht(y(f))},[(_.src||_.srcSet)&&!c.value?(J(),ge("img",{key:0,src:_.src,alt:_.alt,srcset:_.srcSet,style:Ht(y(p)),onError:m},null,44,QCe)):_.icon?(J(),He(y(Gt),{key:1},{default:Ne(()=>[(J(),He(wn(_.icon)))]),_:1})):We(_.$slots,"default",{key:2})],6))}});var tSe=vt(eSe,[["__file","avatar.vue"]]);const nSe=bn(tSe),oSe={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},rSe={click:e=>e instanceof MouseEvent},iSe=(e,t,o)=>{const i=Do(),c=Do(),u=ae(!1),f=()=>{i.value&&(u.value=i.value.scrollTop>=e.visibilityHeight)},p=_=>{var b;(b=i.value)==null||b.scrollTo({top:0,behavior:"smooth"}),t("click",_)},m=q7(f,300,!0);return Oo(c,"scroll",m),fn(()=>{var _;c.value=document,i.value=document.documentElement,e.target&&(i.value=(_=document.querySelector(e.target))!=null?_:void 0,i.value||wr(o,`target does not exist: ${e.target}`),c.value=i.value),f()}),{visible:u,handleClick:p}},B9="ElBacktop",sSe=Se({name:B9}),aSe=Se({...sSe,props:oSe,emits:rSe,setup(e,{emit:t}){const o=e,i=lt("backtop"),{handleClick:c,visible:u}=iSe(o,t,B9),f=K(()=>({right:`${o.right}px`,bottom:`${o.bottom}px`}));return(p,m)=>(J(),He(Rr,{name:`${y(i).namespace.value}-fade-in`},{default:Ne(()=>[y(u)?(J(),ge("div",{key:0,style:Ht(y(f)),class:ne(y(i).b()),onClick:m[0]||(m[0]=nn((..._)=>y(c)&&y(c)(..._),["stop"]))},[We(p.$slots,"default",{},()=>[Me(y(Gt),{class:ne(y(i).e("icon"))},{default:Ne(()=>[Me(y(Uve))]),_:1},8,["class"])])],6)):Fe("v-if",!0)]),_:3},8,["name"]))}});var lSe=vt(aSe,[["__file","backtop.vue"]]);const cSe=bn(lSe),uSe=gt({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,dotStyle:{type:Le([String,Object,Array])},badgeStyle:{type:Le([String,Object,Array])},offset:{type:Le(Array),default:[0,0]},dotClass:{type:String},badgeClass:{type:String}}),dSe=["textContent"],hSe=Se({name:"ElBadge"}),fSe=Se({...hSe,props:uSe,setup(e,{expose:t}){const o=e,i=lt("badge"),c=K(()=>o.isDot?"":Zt(o.value)&&Zt(o.max)?o.max<o.value?`${o.max}+`:o.value===0&&!o.showZero?"":`${o.value}`:`${o.value}`),u=K(()=>{var f,p,m,_,b,S;return[{backgroundColor:o.color,marginRight:Xo(-((p=(f=o.offset)==null?void 0:f[0])!=null?p:0)),marginTop:Xo((_=(m=o.offset)==null?void 0:m[1])!=null?_:0)},(b=o.dotStyle)!=null?b:{},(S=o.badgeStyle)!=null?S:{}]});return $r({from:"dot-style",replacement:"badge-style",version:"2.8.0",scope:"el-badge",ref:"https://element-plus.org/en-US/component/badge.html"},K(()=>!!o.dotStyle)),$r({from:"dot-class",replacement:"badge-class",version:"2.8.0",scope:"el-badge",ref:"https://element-plus.org/en-US/component/badge.html"},K(()=>!!o.dotClass)),t({content:c}),(f,p)=>(J(),ge("div",{class:ne(y(i).b())},[We(f.$slots,"default"),Me(Rr,{name:`${y(i).namespace.value}-zoom-in-center`,persisted:""},{default:Ne(()=>[hn(Ce("sup",{class:ne([y(i).e("content"),y(i).em("content",f.type),y(i).is("fixed",!!f.$slots.default),y(i).is("dot",f.isDot),f.dotClass,f.badgeClass]),style:Ht(y(u)),textContent:pt(y(c))},null,14,dSe),[[Jn,!f.hidden&&(y(c)||f.isDot)]])]),_:1},8,["name"])],2))}});var pSe=vt(fSe,[["__file","badge.vue"]]);const $9=bn(pSe),H9=Symbol("breadcrumbKey"),gSe=gt({separator:{type:String,default:"/"},separatorIcon:{type:mo}}),mSe=["aria-label"],vSe=Se({name:"ElBreadcrumb"}),_Se=Se({...vSe,props:gSe,setup(e){const t=e,{t:o}=Kn(),i=lt("breadcrumb"),c=ae();return Ln(H9,t),fn(()=>{const u=c.value.querySelectorAll(`.${i.e("item")}`);u.length&&u[u.length-1].setAttribute("aria-current","page")}),(u,f)=>(J(),ge("div",{ref_key:"breadcrumb",ref:c,class:ne(y(i).b()),"aria-label":y(o)("el.breadcrumb.label"),role:"navigation"},[We(u.$slots,"default")],10,mSe))}});var ySe=vt(_Se,[["__file","breadcrumb.vue"]]);const ISe=gt({to:{type:Le([String,Object]),default:""},replace:{type:Boolean,default:!1}}),bSe=Se({name:"ElBreadcrumbItem"}),CSe=Se({...bSe,props:ISe,setup(e){const t=e,o=In(),i=wt(H9,void 0),c=lt("breadcrumb"),u=o.appContext.config.globalProperties.$router,f=ae(),p=()=>{!t.to||!u||(t.replace?u.replace(t.to):u.push(t.to))};return(m,_)=>{var b,S;return J(),ge("span",{class:ne(y(c).e("item"))},[Ce("span",{ref_key:"link",ref:f,class:ne([y(c).e("inner"),y(c).is("link",!!m.to)]),role:"link",onClick:p},[We(m.$slots,"default")],2),(b=y(i))!=null&&b.separatorIcon?(J(),He(y(Gt),{key:0,class:ne(y(c).e("separator"))},{default:Ne(()=>[(J(),He(wn(y(i).separatorIcon)))]),_:1},8,["class"])):(J(),ge("span",{key:1,class:ne(y(c).e("separator")),role:"presentation"},pt((S=y(i))==null?void 0:S.separator),3))],2)}}});var q9=vt(CSe,[["__file","breadcrumb-item.vue"]]);const SSe=bn(ySe,{BreadcrumbItem:q9}),TSe=Wo(q9),K9=Symbol("buttonGroupContextKey"),ESe=(e,t)=>{$r({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},K(()=>e.type==="text"));const o=wt(K9,void 0),i=II("button"),{form:c}=Oi(),u=Tr(K(()=>o==null?void 0:o.size)),f=zi(),p=ae(),m=zr(),_=K(()=>e.type||(o==null?void 0:o.type)||""),b=K(()=>{var R,E,N;return(N=(E=e.autoInsertSpace)!=null?E:(R=i.value)==null?void 0:R.autoInsertSpace)!=null?N:!1}),S=K(()=>e.tag==="button"?{ariaDisabled:f.value||e.loading,disabled:f.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),T=K(()=>{var R;const E=(R=m.default)==null?void 0:R.call(m);if(b.value&&(E==null?void 0:E.length)===1){const N=E[0];if((N==null?void 0:N.type)===Pm){const D=N.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(D.trim())}}return!1});return{_disabled:f,_size:u,_type:_,_ref:p,_props:S,shouldAddSpace:T,handleClick:R=>{e.nativeType==="reset"&&(c==null||c.resetFields()),t("click",R)}}},sO=["default","primary","success","warning","info","danger","text",""],MSe=["button","submit","reset"],aO=gt({size:Nr,disabled:Boolean,type:{type:String,values:sO,default:""},icon:{type:mo},nativeType:{type:String,values:MSe,default:"button"},loading:Boolean,loadingIcon:{type:mo,default:()=>Rd},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Le([String,Object]),default:"button"}}),kSe={click:e=>e instanceof MouseEvent};function fi(e,t){ASe(e)&&(e="100%");var o=RSe(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function fT(e){return Math.min(1,Math.max(0,e))}function ASe(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function RSe(e){return typeof e=="string"&&e.indexOf("%")!==-1}function z9(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function pT(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Nf(e){return e.length===1?"0"+e:String(e)}function wSe(e,t,o){return{r:fi(e,255)*255,g:fi(t,255)*255,b:fi(o,255)*255}}function fB(e,t,o){e=fi(e,255),t=fi(t,255),o=fi(o,255);var i=Math.max(e,t,o),c=Math.min(e,t,o),u=0,f=0,p=(i+c)/2;if(i===c)f=0,u=0;else{var m=i-c;switch(f=p>.5?m/(2-i-c):m/(i+c),i){case e:u=(t-o)/m+(t<o?6:0);break;case t:u=(o-e)/m+2;break;case o:u=(e-t)/m+4;break}u/=6}return{h:u,s:f,l:p}}function Xw(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(t-e)*(6*o):o<1/2?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function DSe(e,t,o){var i,c,u;if(e=fi(e,360),t=fi(t,100),o=fi(o,100),t===0)c=o,u=o,i=o;else{var f=o<.5?o*(1+t):o+t-o*t,p=2*o-f;i=Xw(p,f,e+1/3),c=Xw(p,f,e),u=Xw(p,f,e-1/3)}return{r:i*255,g:c*255,b:u*255}}function pB(e,t,o){e=fi(e,255),t=fi(t,255),o=fi(o,255);var i=Math.max(e,t,o),c=Math.min(e,t,o),u=0,f=i,p=i-c,m=i===0?0:p/i;if(i===c)u=0;else{switch(i){case e:u=(t-o)/p+(t<o?6:0);break;case t:u=(o-e)/p+2;break;case o:u=(e-t)/p+4;break}u/=6}return{h:u,s:m,v:f}}function OSe(e,t,o){e=fi(e,360)*6,t=fi(t,100),o=fi(o,100);var i=Math.floor(e),c=e-i,u=o*(1-t),f=o*(1-c*t),p=o*(1-(1-c)*t),m=i%6,_=[o,f,u,u,p,o][m],b=[p,o,o,f,u,u][m],S=[u,u,p,o,o,f][m];return{r:_*255,g:b*255,b:S*255}}function gB(e,t,o,i){var c=[Nf(Math.round(e).toString(16)),Nf(Math.round(t).toString(16)),Nf(Math.round(o).toString(16))];return i&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function NSe(e,t,o,i,c){var u=[Nf(Math.round(e).toString(16)),Nf(Math.round(t).toString(16)),Nf(Math.round(o).toString(16)),Nf(LSe(i))];return c&&u[0].startsWith(u[0].charAt(1))&&u[1].startsWith(u[1].charAt(1))&&u[2].startsWith(u[2].charAt(1))&&u[3].startsWith(u[3].charAt(1))?u[0].charAt(0)+u[1].charAt(0)+u[2].charAt(0)+u[3].charAt(0):u.join("")}function LSe(e){return Math.round(parseFloat(e)*255).toString(16)}function mB(e){return Is(e)/255}function Is(e){return parseInt(e,16)}function PSe(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var lO={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function USe(e){var t={r:0,g:0,b:0},o=1,i=null,c=null,u=null,f=!1,p=!1;return typeof e=="string"&&(e=VSe(e)),typeof e=="object"&&(gc(e.r)&&gc(e.g)&&gc(e.b)?(t=wSe(e.r,e.g,e.b),f=!0,p=String(e.r).substr(-1)==="%"?"prgb":"rgb"):gc(e.h)&&gc(e.s)&&gc(e.v)?(i=pT(e.s),c=pT(e.v),t=OSe(e.h,i,c),f=!0,p="hsv"):gc(e.h)&&gc(e.s)&&gc(e.l)&&(i=pT(e.s),u=pT(e.l),t=DSe(e.h,i,u),f=!0,p="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=z9(o),{ok:f,format:e.format||p,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:o}}var xSe="[-\\+]?\\d+%?",FSe="[-\\+]?\\d*\\.\\d+%?",id="(?:".concat(FSe,")|(?:").concat(xSe,")"),Qw="[\\s|\\(]+(".concat(id,")[,|\\s]+(").concat(id,")[,|\\s]+(").concat(id,")\\s*\\)?"),Zw="[\\s|\\(]+(".concat(id,")[,|\\s]+(").concat(id,")[,|\\s]+(").concat(id,")[,|\\s]+(").concat(id,")\\s*\\)?"),ka={CSS_UNIT:new RegExp(id),rgb:new RegExp("rgb"+Qw),rgba:new RegExp("rgba"+Zw),hsl:new RegExp("hsl"+Qw),hsla:new RegExp("hsla"+Zw),hsv:new RegExp("hsv"+Qw),hsva:new RegExp("hsva"+Zw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function VSe(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(lO[e])e=lO[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=ka.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=ka.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=ka.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=ka.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=ka.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=ka.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=ka.hex8.exec(e),o?{r:Is(o[1]),g:Is(o[2]),b:Is(o[3]),a:mB(o[4]),format:t?"name":"hex8"}:(o=ka.hex6.exec(e),o?{r:Is(o[1]),g:Is(o[2]),b:Is(o[3]),format:t?"name":"hex"}:(o=ka.hex4.exec(e),o?{r:Is(o[1]+o[1]),g:Is(o[2]+o[2]),b:Is(o[3]+o[3]),a:mB(o[4]+o[4]),format:t?"name":"hex8"}:(o=ka.hex3.exec(e),o?{r:Is(o[1]+o[1]),g:Is(o[2]+o[2]),b:Is(o[3]+o[3]),format:t?"name":"hex"}:!1)))))))))}function gc(e){return!!ka.CSS_UNIT.exec(String(e))}var W9=function(){function e(t,o){t===void 0&&(t=""),o===void 0&&(o={});var i;if(t instanceof e)return t;typeof t=="number"&&(t=PSe(t)),this.originalInput=t;var c=USe(t);this.originalInput=t,this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=o.format)!==null&&i!==void 0?i:c.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=c.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),o,i,c,u=t.r/255,f=t.g/255,p=t.b/255;return u<=.03928?o=u/12.92:o=Math.pow((u+.055)/1.055,2.4),f<=.03928?i=f/12.92:i=Math.pow((f+.055)/1.055,2.4),p<=.03928?c=p/12.92:c=Math.pow((p+.055)/1.055,2.4),.2126*o+.7152*i+.0722*c},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=z9(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=pB(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=pB(this.r,this.g,this.b),o=Math.round(t.h*360),i=Math.round(t.s*100),c=Math.round(t.v*100);return this.a===1?"hsv(".concat(o,", ").concat(i,"%, ").concat(c,"%)"):"hsva(".concat(o,", ").concat(i,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=fB(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=fB(this.r,this.g,this.b),o=Math.round(t.h*360),i=Math.round(t.s*100),c=Math.round(t.l*100);return this.a===1?"hsl(".concat(o,", ").concat(i,"%, ").concat(c,"%)"):"hsla(".concat(o,", ").concat(i,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),gB(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),NSe(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),o=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(o,", ").concat(i,")"):"rgba(".concat(t,", ").concat(o,", ").concat(i,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(o){return"".concat(Math.round(fi(o,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(o){return Math.round(fi(o,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+gB(this.r,this.g,this.b,!1),o=0,i=Object.entries(lO);o<i.length;o++){var c=i[o],u=c[0],f=c[1];if(t===f)return u}return!1},e.prototype.toString=function(t){var o=!!t;t=t??this.format;var i=!1,c=this.a<1&&this.a>=0,u=!o&&c&&(t.startsWith("hex")||t==="name");return u?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l+=t/100,o.l=fT(o.l),new e(o)},e.prototype.brighten=function(t){t===void 0&&(t=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(t/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(t/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(t/100)))),new e(o)},e.prototype.darken=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l-=t/100,o.l=fT(o.l),new e(o)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s-=t/100,o.s=fT(o.s),new e(o)},e.prototype.saturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s+=t/100,o.s=fT(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var o=this.toHsl(),i=(o.h+t)%360;return o.h=i<0?360+i:i,new e(o)},e.prototype.mix=function(t,o){o===void 0&&(o=50);var i=this.toRgb(),c=new e(t).toRgb(),u=o/100,f={r:(c.r-i.r)*u+i.r,g:(c.g-i.g)*u+i.g,b:(c.b-i.b)*u+i.b,a:(c.a-i.a)*u+i.a};return new e(f)},e.prototype.analogous=function(t,o){t===void 0&&(t=6),o===void 0&&(o=30);var i=this.toHsl(),c=360/o,u=[this];for(i.h=(i.h-(c*t>>1)+720)%360;--t;)i.h=(i.h+c)%360,u.push(new e(i));return u},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var o=this.toHsv(),i=o.h,c=o.s,u=o.v,f=[],p=1/t;t--;)f.push(new e({h:i,s:c,v:u})),u=(u+p)%1;return f},e.prototype.splitcomplement=function(){var t=this.toHsl(),o=t.h;return[this,new e({h:(o+72)%360,s:t.s,l:t.l}),new e({h:(o+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var o=this.toRgb(),i=new e(t).toRgb(),c=o.a+i.a*(1-o.a);return new e({r:(o.r*o.a+i.r*i.a*(1-o.a))/c,g:(o.g*o.a+i.g*i.a*(1-o.a))/c,b:(o.b*o.a+i.b*i.a*(1-o.a))/c,a:c})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var o=this.toHsl(),i=o.h,c=[this],u=360/t,f=1;f<t;f++)c.push(new e({h:(i+f*u)%360,s:o.s,l:o.l}));return c},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Vu(e,t=20){return e.mix("#141414",t).toString()}function GSe(e){const t=zi(),o=lt("button");return K(()=>{let i={};const c=e.color;if(c){const u=new W9(c),f=e.dark?u.tint(20).toString():Vu(u,20);if(e.plain)i=o.cssVarBlock({"bg-color":e.dark?Vu(u,90):u.tint(90).toString(),"text-color":c,"border-color":e.dark?Vu(u,50):u.tint(50).toString(),"hover-text-color":`var(${o.cssVarName("color-white")})`,"hover-bg-color":c,"hover-border-color":c,"active-bg-color":f,"active-text-color":`var(${o.cssVarName("color-white")})`,"active-border-color":f}),t.value&&(i[o.cssVarBlockName("disabled-bg-color")]=e.dark?Vu(u,90):u.tint(90).toString(),i[o.cssVarBlockName("disabled-text-color")]=e.dark?Vu(u,50):u.tint(50).toString(),i[o.cssVarBlockName("disabled-border-color")]=e.dark?Vu(u,80):u.tint(80).toString());else{const p=e.dark?Vu(u,30):u.tint(30).toString(),m=u.isDark()?`var(${o.cssVarName("color-white")})`:`var(${o.cssVarName("color-black")})`;if(i=o.cssVarBlock({"bg-color":c,"text-color":m,"border-color":c,"hover-bg-color":p,"hover-text-color":m,"hover-border-color":p,"active-bg-color":f,"active-border-color":f}),t.value){const _=e.dark?Vu(u,50):u.tint(50).toString();i[o.cssVarBlockName("disabled-bg-color")]=_,i[o.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${o.cssVarName("color-white")})`,i[o.cssVarBlockName("disabled-border-color")]=_}}}return i})}const BSe=Se({name:"ElButton"}),$Se=Se({...BSe,props:aO,emits:kSe,setup(e,{expose:t,emit:o}){const i=e,c=GSe(i),u=lt("button"),{_ref:f,_size:p,_type:m,_disabled:_,_props:b,shouldAddSpace:S,handleClick:T}=ESe(i,o),M=K(()=>[u.b(),u.m(m.value),u.m(p.value),u.is("disabled",_.value),u.is("loading",i.loading),u.is("plain",i.plain),u.is("round",i.round),u.is("circle",i.circle),u.is("text",i.text),u.is("link",i.link),u.is("has-bg",i.bg)]);return t({ref:f,size:p,type:m,disabled:_,shouldAddSpace:S}),(R,E)=>(J(),He(wn(R.tag),Nn({ref_key:"_ref",ref:f},y(b),{class:y(M),style:y(c),onClick:y(T)}),{default:Ne(()=>[R.loading?(J(),ge(qt,{key:0},[R.$slots.loading?We(R.$slots,"loading",{key:0}):(J(),He(y(Gt),{key:1,class:ne(y(u).is("loading"))},{default:Ne(()=>[(J(),He(wn(R.loadingIcon)))]),_:1},8,["class"]))],64)):R.icon||R.$slots.icon?(J(),He(y(Gt),{key:1},{default:Ne(()=>[R.icon?(J(),He(wn(R.icon),{key:0})):We(R.$slots,"icon",{key:1})]),_:3})):Fe("v-if",!0),R.$slots.default?(J(),ge("span",{key:2,class:ne({[y(u).em("text","expand")]:y(S)})},[We(R.$slots,"default")],2)):Fe("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var HSe=vt($Se,[["__file","button.vue"]]);const qSe={size:aO.size,type:aO.type},KSe=Se({name:"ElButtonGroup"}),zSe=Se({...KSe,props:qSe,setup(e){const t=e;Ln(K9,Zn({size:Io(t,"size"),type:Io(t,"type")}));const o=lt("button");return(i,c)=>(J(),ge("div",{class:ne(`${y(o).b("group")}`)},[We(i.$slots,"default")],2))}});var j9=vt(zSe,[["__file","button-group.vue"]]);const qr=bn(HSe,{ButtonGroup:j9}),Y9=Wo(j9);var J9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){var o=1e3,i=6e4,c=36e5,u="millisecond",f="second",p="minute",m="hour",_="day",b="week",S="month",T="quarter",M="year",R="date",E="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,D=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,x={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(de){var he=["th","st","nd","rd"],se=de%100;return"["+de+(he[(se-20)%10]||he[se]||he[0])+"]"}},L=function(de,he,se){var ie=String(de);return!ie||ie.length>=he?de:""+Array(he+1-ie.length).join(se)+de},F={s:L,z:function(de){var he=-de.utcOffset(),se=Math.abs(he),ie=Math.floor(se/60),oe=se%60;return(he<=0?"+":"-")+L(ie,2,"0")+":"+L(oe,2,"0")},m:function de(he,se){if(he.date()<se.date())return-de(se,he);var ie=12*(se.year()-he.year())+(se.month()-he.month()),oe=he.clone().add(ie,S),ee=se-oe<0,Q=he.clone().add(ie+(ee?-1:1),S);return+(-(ie+(se-oe)/(ee?oe-Q:Q-oe))||0)},a:function(de){return de<0?Math.ceil(de)||0:Math.floor(de)},p:function(de){return{M:S,y:M,w:b,d:_,D:R,h:m,m:p,s:f,ms:u,Q:T}[de]||String(de||"").toLowerCase().replace(/s$/,"")},u:function(de){return de===void 0}},H="en",B={};B[H]=x;var z="$isDayjsObject",W=function(de){return de instanceof X||!(!de||!de[z])},Z=function de(he,se,ie){var oe;if(!he)return H;if(typeof he=="string"){var ee=he.toLowerCase();B[ee]&&(oe=ee),se&&(B[ee]=se,oe=ee);var Q=he.split("-");if(!oe&&Q.length>1)return de(Q[0])}else{var ue=he.name;B[ue]=he,oe=ue}return!ie&&oe&&(H=oe),oe||!ie&&H},$=function(de,he){if(W(de))return de.clone();var se=typeof he=="object"?he:{};return se.date=de,se.args=arguments,new X(se)},O=F;O.l=Z,O.i=W,O.w=function(de,he){return $(de,{locale:he.$L,utc:he.$u,x:he.$x,$offset:he.$offset})};var X=function(){function de(se){this.$L=Z(se.locale,null,!0),this.parse(se),this.$x=this.$x||se.x||{},this[z]=!0}var he=de.prototype;return he.parse=function(se){this.$d=function(ie){var oe=ie.date,ee=ie.utc;if(oe===null)return new Date(NaN);if(O.u(oe))return new Date;if(oe instanceof Date)return new Date(oe);if(typeof oe=="string"&&!/Z$/i.test(oe)){var Q=oe.match(N);if(Q){var ue=Q[2]-1||0,me=(Q[7]||"0").substring(0,3);return ee?new Date(Date.UTC(Q[1],ue,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,me)):new Date(Q[1],ue,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,me)}}return new Date(oe)}(se),this.init()},he.init=function(){var se=this.$d;this.$y=se.getFullYear(),this.$M=se.getMonth(),this.$D=se.getDate(),this.$W=se.getDay(),this.$H=se.getHours(),this.$m=se.getMinutes(),this.$s=se.getSeconds(),this.$ms=se.getMilliseconds()},he.$utils=function(){return O},he.isValid=function(){return this.$d.toString()!==E},he.isSame=function(se,ie){var oe=$(se);return this.startOf(ie)<=oe&&oe<=this.endOf(ie)},he.isAfter=function(se,ie){return $(se)<this.startOf(ie)},he.isBefore=function(se,ie){return this.endOf(ie)<$(se)},he.$g=function(se,ie,oe){return O.u(se)?this[ie]:this.set(oe,se)},he.unix=function(){return Math.floor(this.valueOf()/1e3)},he.valueOf=function(){return this.$d.getTime()},he.startOf=function(se,ie){var oe=this,ee=!!O.u(ie)||ie,Q=O.p(se),ue=function(Ge,Ve){var qe=O.w(oe.$u?Date.UTC(oe.$y,Ve,Ge):new Date(oe.$y,Ve,Ge),oe);return ee?qe:qe.endOf(_)},me=function(Ge,Ve){return O.w(oe.toDate()[Ge].apply(oe.toDate("s"),(ee?[0,0,0,0]:[23,59,59,999]).slice(Ve)),oe)},be=this.$W,ke=this.$M,Ye=this.$D,Oe="set"+(this.$u?"UTC":"");switch(Q){case M:return ee?ue(1,0):ue(31,11);case S:return ee?ue(1,ke):ue(0,ke+1);case b:var Ee=this.$locale().weekStart||0,we=(be<Ee?be+7:be)-Ee;return ue(ee?Ye-we:Ye+(6-we),ke);case _:case R:return me(Oe+"Hours",0);case m:return me(Oe+"Minutes",1);case p:return me(Oe+"Seconds",2);case f:return me(Oe+"Milliseconds",3);default:return this.clone()}},he.endOf=function(se){return this.startOf(se,!1)},he.$set=function(se,ie){var oe,ee=O.p(se),Q="set"+(this.$u?"UTC":""),ue=(oe={},oe[_]=Q+"Date",oe[R]=Q+"Date",oe[S]=Q+"Month",oe[M]=Q+"FullYear",oe[m]=Q+"Hours",oe[p]=Q+"Minutes",oe[f]=Q+"Seconds",oe[u]=Q+"Milliseconds",oe)[ee],me=ee===_?this.$D+(ie-this.$W):ie;if(ee===S||ee===M){var be=this.clone().set(R,1);be.$d[ue](me),be.init(),this.$d=be.set(R,Math.min(this.$D,be.daysInMonth())).$d}else ue&&this.$d[ue](me);return this.init(),this},he.set=function(se,ie){return this.clone().$set(se,ie)},he.get=function(se){return this[O.p(se)]()},he.add=function(se,ie){var oe,ee=this;se=Number(se);var Q=O.p(ie),ue=function(ke){var Ye=$(ee);return O.w(Ye.date(Ye.date()+Math.round(ke*se)),ee)};if(Q===S)return this.set(S,this.$M+se);if(Q===M)return this.set(M,this.$y+se);if(Q===_)return ue(1);if(Q===b)return ue(7);var me=(oe={},oe[p]=i,oe[m]=c,oe[f]=o,oe)[Q]||1,be=this.$d.getTime()+se*me;return O.w(be,this)},he.subtract=function(se,ie){return this.add(-1*se,ie)},he.format=function(se){var ie=this,oe=this.$locale();if(!this.isValid())return oe.invalidDate||E;var ee=se||"YYYY-MM-DDTHH:mm:ssZ",Q=O.z(this),ue=this.$H,me=this.$m,be=this.$M,ke=oe.weekdays,Ye=oe.months,Oe=oe.meridiem,Ee=function(Ve,qe,st,Ie){return Ve&&(Ve[qe]||Ve(ie,ee))||st[qe].slice(0,Ie)},we=function(Ve){return O.s(ue%12||12,Ve,"0")},Ge=Oe||function(Ve,qe,st){var Ie=Ve<12?"AM":"PM";return st?Ie.toLowerCase():Ie};return ee.replace(D,function(Ve,qe){return qe||function(st){switch(st){case"YY":return String(ie.$y).slice(-2);case"YYYY":return O.s(ie.$y,4,"0");case"M":return be+1;case"MM":return O.s(be+1,2,"0");case"MMM":return Ee(oe.monthsShort,be,Ye,3);case"MMMM":return Ee(Ye,be);case"D":return ie.$D;case"DD":return O.s(ie.$D,2,"0");case"d":return String(ie.$W);case"dd":return Ee(oe.weekdaysMin,ie.$W,ke,2);case"ddd":return Ee(oe.weekdaysShort,ie.$W,ke,3);case"dddd":return ke[ie.$W];case"H":return String(ue);case"HH":return O.s(ue,2,"0");case"h":return we(1);case"hh":return we(2);case"a":return Ge(ue,me,!0);case"A":return Ge(ue,me,!1);case"m":return String(me);case"mm":return O.s(me,2,"0");case"s":return String(ie.$s);case"ss":return O.s(ie.$s,2,"0");case"SSS":return O.s(ie.$ms,3,"0");case"Z":return Q}return null}(Ve)||Q.replace(":","")})},he.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},he.diff=function(se,ie,oe){var ee,Q=this,ue=O.p(ie),me=$(se),be=(me.utcOffset()-this.utcOffset())*i,ke=this-me,Ye=function(){return O.m(Q,me)};switch(ue){case M:ee=Ye()/12;break;case S:ee=Ye();break;case T:ee=Ye()/3;break;case b:ee=(ke-be)/6048e5;break;case _:ee=(ke-be)/864e5;break;case m:ee=ke/c;break;case p:ee=ke/i;break;case f:ee=ke/o;break;default:ee=ke}return oe?ee:O.a(ee)},he.daysInMonth=function(){return this.endOf(S).$D},he.$locale=function(){return B[this.$L]},he.locale=function(se,ie){if(!se)return this.$L;var oe=this.clone(),ee=Z(se,ie,!0);return ee&&(oe.$L=ee),oe},he.clone=function(){return O.w(this.$d,this)},he.toDate=function(){return new Date(this.valueOf())},he.toJSON=function(){return this.isValid()?this.toISOString():null},he.toISOString=function(){return this.$d.toISOString()},he.toString=function(){return this.$d.toUTCString()},de}(),le=X.prototype;return $.prototype=le,[["$ms",u],["$s",f],["$m",p],["$H",m],["$W",_],["$M",S],["$y",M],["$D",R]].forEach(function(de){le[de[1]]=function(he){return this.$g(he,de[0],de[1])}}),$.extend=function(de,he){return de.$i||(de(he,X,$),de.$i=!0),$},$.locale=Z,$.isDayjs=W,$.unix=function(de){return $(1e3*de)},$.en=B[H],$.Ls=B,$.p={},$})})(J9);var WSe=J9.exports;const Tn=la(WSe);var X9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},i=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,c=/\d\d/,u=/\d\d?/,f=/\d*[^-_:/,()\s\d]+/,p={},m=function(E){return(E=+E)+(E>68?1900:2e3)},_=function(E){return function(N){this[E]=+N}},b=[/[+-]\d\d:?(\d\d)?|Z/,function(E){(this.zone||(this.zone={})).offset=function(N){if(!N||N==="Z")return 0;var D=N.match(/([+-]|\d\d)/g),x=60*D[1]+(+D[2]||0);return x===0?0:D[0]==="+"?-x:x}(E)}],S=function(E){var N=p[E];return N&&(N.indexOf?N:N.s.concat(N.f))},T=function(E,N){var D,x=p.meridiem;if(x){for(var L=1;L<=24;L+=1)if(E.indexOf(x(L,0,N))>-1){D=L>12;break}}else D=E===(N?"pm":"PM");return D},M={A:[f,function(E){this.afternoon=T(E,!1)}],a:[f,function(E){this.afternoon=T(E,!0)}],S:[/\d/,function(E){this.milliseconds=100*+E}],SS:[c,function(E){this.milliseconds=10*+E}],SSS:[/\d{3}/,function(E){this.milliseconds=+E}],s:[u,_("seconds")],ss:[u,_("seconds")],m:[u,_("minutes")],mm:[u,_("minutes")],H:[u,_("hours")],h:[u,_("hours")],HH:[u,_("hours")],hh:[u,_("hours")],D:[u,_("day")],DD:[c,_("day")],Do:[f,function(E){var N=p.ordinal,D=E.match(/\d+/);if(this.day=D[0],N)for(var x=1;x<=31;x+=1)N(x).replace(/\[|\]/g,"")===E&&(this.day=x)}],M:[u,_("month")],MM:[c,_("month")],MMM:[f,function(E){var N=S("months"),D=(S("monthsShort")||N.map(function(x){return x.slice(0,3)})).indexOf(E)+1;if(D<1)throw new Error;this.month=D%12||D}],MMMM:[f,function(E){var N=S("months").indexOf(E)+1;if(N<1)throw new Error;this.month=N%12||N}],Y:[/[+-]?\d+/,_("year")],YY:[c,function(E){this.year=m(E)}],YYYY:[/\d{4}/,_("year")],Z:b,ZZ:b};function R(E){var N,D;N=E,D=p&&p.formats;for(var x=(E=N.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(Z,$,O){var X=O&&O.toUpperCase();return $||D[O]||o[O]||D[X].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(le,de,he){return de||he.slice(1)})})).match(i),L=x.length,F=0;F<L;F+=1){var H=x[F],B=M[H],z=B&&B[0],W=B&&B[1];x[F]=W?{regex:z,parser:W}:H.replace(/^\[|\]$/g,"")}return function(Z){for(var $={},O=0,X=0;O<L;O+=1){var le=x[O];if(typeof le=="string")X+=le.length;else{var de=le.regex,he=le.parser,se=Z.slice(X),ie=de.exec(se)[0];he.call($,ie),Z=Z.replace(ie,"")}}return function(oe){var ee=oe.afternoon;if(ee!==void 0){var Q=oe.hours;ee?Q<12&&(oe.hours+=12):Q===12&&(oe.hours=0),delete oe.afternoon}}($),$}}return function(E,N,D){D.p.customParseFormat=!0,E&&E.parseTwoDigitYear&&(m=E.parseTwoDigitYear);var x=N.prototype,L=x.parse;x.parse=function(F){var H=F.date,B=F.utc,z=F.args;this.$u=B;var W=z[1];if(typeof W=="string"){var Z=z[2]===!0,$=z[3]===!0,O=Z||$,X=z[2];$&&(X=z[2]),p=this.$locale(),!Z&&X&&(p=D.Ls[X]),this.$d=function(se,ie,oe){try{if(["x","X"].indexOf(ie)>-1)return new Date((ie==="X"?1e3:1)*se);var ee=R(ie)(se),Q=ee.year,ue=ee.month,me=ee.day,be=ee.hours,ke=ee.minutes,Ye=ee.seconds,Oe=ee.milliseconds,Ee=ee.zone,we=new Date,Ge=me||(Q||ue?1:we.getDate()),Ve=Q||we.getFullYear(),qe=0;Q&&!ue||(qe=ue>0?ue-1:we.getMonth());var st=be||0,Ie=ke||0,Ae=Ye||0,xe=Oe||0;return Ee?new Date(Date.UTC(Ve,qe,Ge,st,Ie,Ae,xe+60*Ee.offset*1e3)):oe?new Date(Date.UTC(Ve,qe,Ge,st,Ie,Ae,xe)):new Date(Ve,qe,Ge,st,Ie,Ae,xe)}catch{return new Date("")}}(H,W,B),this.init(),X&&X!==!0&&(this.$L=this.locale(X).$L),O&&H!=this.format(W)&&(this.$d=new Date("")),p={}}else if(W instanceof Array)for(var le=W.length,de=1;de<=le;de+=1){z[1]=W[de-1];var he=D.apply(this,z);if(he.isValid()){this.$d=he.$d,this.$L=he.$L,this.init();break}de===le&&(this.$d=new Date(""))}else L.call(this,F)}}})})(X9);var jSe=X9.exports;const UL=la(jSe),vB=["hours","minutes","seconds"],cO="HH:mm:ss",Hg="YYYY-MM-DD",YSe={date:Hg,dates:Hg,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",datetime:`${Hg} ${cO}`,monthrange:"YYYY-MM",daterange:Hg,datetimerange:`${Hg} ${cO}`},eD=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],fd=e=>Array.from(Array.from({length:e}).keys()),Q9=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),Z9=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),_B=function(e,t){const o=zf(e),i=zf(t);return o&&i?e.getTime()===t.getTime():!o&&!i?e===t:!1},yB=function(e,t){const o=At(e),i=At(t);return o&&i?e.length!==t.length?!1:e.every((c,u)=>_B(c,t[u])):!o&&!i?_B(e,t):!1},IB=function(e,t,o){const i=Ys(t)||t==="x"?Tn(e).locale(o):Tn(e,t).locale(o);return i.isValid()?i:void 0},bB=function(e,t,o){return Ys(t)?e:t==="x"?+e:Tn(e).locale(o).format(t)},tD=(e,t)=>{var o;const i=[],c=t==null?void 0:t();for(let u=0;u<e;u++)i.push((o=c==null?void 0:c.includes(u))!=null?o:!1);return i},eK=gt({disabledHours:{type:Le(Function)},disabledMinutes:{type:Le(Function)},disabledSeconds:{type:Le(Function)}}),tK=gt({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),xL=gt({id:{type:Le([Array,String])},name:{type:Le([Array,String]),default:""},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:Le([String,Object]),default:Ad},editable:{type:Boolean,default:!0},prefixIcon:{type:Le([String,Object]),default:""},size:Nr,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:Le(Object),default:()=>({})},modelValue:{type:Le([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:Le([Date,Array])},defaultTime:{type:Le([Date,Array])},isRange:Boolean,...eK,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,label:{type:String,default:void 0},tabindex:{type:Le([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,...Hm,...ti(["ariaLabel"])}),JSe=["id","name","placeholder","value","disabled","readonly"],XSe=["id","name","placeholder","value","disabled","readonly"],QSe=Se({name:"Picker"}),ZSe=Se({...QSe,props:xL,emits:["update:modelValue","change","focus","blur","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:o}){const i=e,c=tp(),{lang:u}=Kn(),f=lt("date"),p=lt("input"),m=lt("range"),{form:_,formItem:b}=Oi(),S=wt("ElPopperOptions",{}),{valueOnClear:T}=f1(i,null),M=ae(),R=ae(),E=ae(!1),N=ae(!1),D=ae(null);let x=!1,L=!1;const F=K(()=>[f.b("editor"),f.bm("editor",i.type),p.e("wrapper"),f.is("disabled",be.value),f.is("active",E.value),m.b("editor"),ht?m.bm("editor",ht.value):"",c.class]),H=K(()=>[p.e("icon"),m.e("close-icon"),qe.value?"":m.e("close-icon--hidden")]);rt(E,$e=>{$e?zt(()=>{$e&&(D.value=i.modelValue)}):(Je.value=null,zt(()=>{B(i.modelValue)}))});const B=($e,xt)=>{(xt||!yB($e,D.value))&&(o("change",$e),i.validateEvent&&(b==null||b.validate("change").catch(jt=>void 0)))},z=$e=>{if(!yB(i.modelValue,$e)){let xt;At($e)?xt=$e.map(jt=>bB(jt,i.valueFormat,u.value)):$e&&(xt=bB($e,i.valueFormat,u.value)),o("update:modelValue",$e&&xt,u.value)}},W=$e=>{o("keydown",$e)},Z=K(()=>{if(R.value){const $e=at.value?R.value:R.value.$el;return Array.from($e.querySelectorAll("input"))}return[]}),$=($e,xt,jt)=>{const Fn=Z.value;Fn.length&&(!jt||jt==="min"?(Fn[0].setSelectionRange($e,xt),Fn[0].focus()):jt==="max"&&(Fn[1].setSelectionRange($e,xt),Fn[1].focus()))},O=()=>{ee(!0,!0),zt(()=>{L=!1})},X=($e="",xt=!1)=>{xt||(L=!0),E.value=xt;let jt;At($e)?jt=$e.map(Fn=>Fn.toDate()):jt=$e&&$e.toDate(),Je.value=null,z(jt)},le=()=>{N.value=!0},de=()=>{o("visible-change",!0)},he=$e=>{($e==null?void 0:$e.key)===Yt.esc&&ee(!0,!0)},se=()=>{N.value=!1,E.value=!1,L=!1,o("visible-change",!1)},ie=()=>{E.value=!0},oe=()=>{E.value=!1},ee=($e=!0,xt=!1)=>{L=xt;const[jt,Fn]=y(Z);let oo=jt;!$e&&at.value&&(oo=Fn),oo&&oo.focus()},Q=$e=>{i.readonly||be.value||E.value||L||(E.value=!0,o("focus",$e))};let ue;const me=$e=>{const xt=async()=>{setTimeout(()=>{var jt;ue===xt&&(!((jt=M.value)!=null&&jt.isFocusInsideContent()&&!x)&&Z.value.filter(Fn=>Fn.contains(document.activeElement)).length===0&&(Et(),E.value=!1,o("blur",$e),i.validateEvent&&(b==null||b.validate("blur").catch(Fn=>void 0))),x=!1)},0)};ue=xt,xt()},be=K(()=>i.disabled||(_==null?void 0:_.disabled)),ke=K(()=>{let $e;if(Ie.value?ct.value.getDefaultValue&&($e=ct.value.getDefaultValue()):At(i.modelValue)?$e=i.modelValue.map(xt=>IB(xt,i.valueFormat,u.value)):$e=IB(i.modelValue,i.valueFormat,u.value),ct.value.getRangeAvailableTime){const xt=ct.value.getRangeAvailableTime($e);Ri(xt,$e)||($e=xt,z(At($e)?$e.map(jt=>jt.toDate()):$e.toDate()))}return At($e)&&$e.some(xt=>!xt)&&($e=[]),$e}),Ye=K(()=>{if(!ct.value.panelReady)return"";const $e=et(ke.value);return At(Je.value)?[Je.value[0]||$e&&$e[0]||"",Je.value[1]||$e&&$e[1]||""]:Je.value!==null?Je.value:!Ee.value&&Ie.value||!E.value&&Ie.value?"":$e?we.value||Ge.value?$e.join(", "):$e:""}),Oe=K(()=>i.type.includes("time")),Ee=K(()=>i.type.startsWith("time")),we=K(()=>i.type==="dates"),Ge=K(()=>i.type==="years"),Ve=K(()=>i.prefixIcon||(Oe.value?Vq:Nve)),qe=ae(!1),st=$e=>{i.readonly||be.value||qe.value&&($e.stopPropagation(),O(),z(T.value),B(T.value,!0),qe.value=!1,E.value=!1,ct.value.handleClear&&ct.value.handleClear())},Ie=K(()=>{const{modelValue:$e}=i;return!$e||At($e)&&!$e.filter(Boolean).length}),Ae=async $e=>{var xt;i.readonly||be.value||(((xt=$e.target)==null?void 0:xt.tagName)!=="INPUT"||Z.value.includes(document.activeElement))&&(E.value=!0)},xe=()=>{i.readonly||be.value||!Ie.value&&i.clearable&&(qe.value=!0)},ot=()=>{qe.value=!1},je=$e=>{var xt;i.readonly||be.value||(((xt=$e.touches[0].target)==null?void 0:xt.tagName)!=="INPUT"||Z.value.includes(document.activeElement))&&(E.value=!0)},at=K(()=>i.type.includes("range")),ht=Tr(),dt=K(()=>{var $e,xt;return(xt=($e=y(M))==null?void 0:$e.popperRef)==null?void 0:xt.contentRef}),ft=K(()=>{var $e;return y(at)?y(R):($e=y(R))==null?void 0:$e.$el});UN(ft,$e=>{const xt=y(dt),jt=y(ft);xt&&($e.target===xt||$e.composedPath().includes(xt))||$e.target===jt||$e.composedPath().includes(jt)||(E.value=!1)});const Je=ae(null),Et=()=>{if(Je.value){const $e=Nt(Ye.value);$e&&Mt($e)&&(z(At($e)?$e.map(xt=>xt.toDate()):$e.toDate()),Je.value=null)}Je.value===""&&(z(T.value),B(T.value),Je.value=null)},Nt=$e=>$e?ct.value.parseUserInput($e):null,et=$e=>$e?ct.value.formatToString($e):null,Mt=$e=>ct.value.isValidValue($e),Jt=async $e=>{if(i.readonly||be.value)return;const{code:xt}=$e;if(W($e),xt===Yt.esc){E.value===!0&&(E.value=!1,$e.preventDefault(),$e.stopPropagation());return}if(xt===Yt.down&&(ct.value.handleFocusPicker&&($e.preventDefault(),$e.stopPropagation()),E.value===!1&&(E.value=!0,await zt()),ct.value.handleFocusPicker)){ct.value.handleFocusPicker();return}if(xt===Yt.tab){x=!0;return}if(xt===Yt.enter||xt===Yt.numpadEnter){(Je.value===null||Je.value===""||Mt(Nt(Ye.value)))&&(Et(),E.value=!1),$e.stopPropagation();return}if(Je.value){$e.stopPropagation();return}ct.value.handleKeydownInput&&ct.value.handleKeydownInput($e)},sn=$e=>{Je.value=$e,E.value||(E.value=!0)},gn=$e=>{const xt=$e.target;Je.value?Je.value=[xt.value,Je.value[1]]:Je.value=[xt.value,null]},Bt=$e=>{const xt=$e.target;Je.value?Je.value=[Je.value[0],xt.value]:Je.value=[null,xt.value]},nt=()=>{var $e;const xt=Je.value,jt=Nt(xt&&xt[0]),Fn=y(ke);if(jt&&jt.isValid()){Je.value=[et(jt),(($e=Ye.value)==null?void 0:$e[1])||null];const oo=[jt,Fn&&(Fn[1]||null)];Mt(oo)&&(z(oo),Je.value=null)}},It=()=>{var $e;const xt=y(Je),jt=Nt(xt&&xt[1]),Fn=y(ke);if(jt&&jt.isValid()){Je.value=[(($e=y(Ye))==null?void 0:$e[0])||null,et(jt)];const oo=[Fn&&Fn[0],jt];Mt(oo)&&(z(oo),Je.value=null)}},ct=ae({}),Ke=$e=>{ct.value[$e[0]]=$e[1],ct.value.panelReady=!0},Xe=$e=>{o("calendar-change",$e)},Dt=($e,xt,jt)=>{o("panel-change",$e,xt,jt)};return Ln("EP_PICKER_BASE",{props:i}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-time-picker",ref:"https://element-plus.org/en-US/component/time-picker.html"},K(()=>!!i.label)),t({focus:ee,handleFocusInput:Q,handleBlurInput:me,handleOpen:ie,handleClose:oe,onPick:X}),($e,xt)=>(J(),He(y(Di),Nn({ref_key:"refPopper",ref:M,visible:E.value,effect:"light",pure:"",trigger:"click"},$e.$attrs,{role:"dialog",teleported:"",transition:`${y(f).namespace.value}-zoom-in-top`,"popper-class":[`${y(f).namespace.value}-picker__popper`,$e.popperClass],"popper-options":y(S),"fallback-placements":["bottom","top","right","left"],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:le,onShow:de,onHide:se}),{default:Ne(()=>[y(at)?(J(),ge("div",{key:1,ref_key:"inputRef",ref:R,class:ne(y(F)),style:Ht($e.$attrs.style),onClick:Q,onMouseenter:xe,onMouseleave:ot,onTouchstartPassive:je,onKeydown:Jt},[y(Ve)?(J(),He(y(Gt),{key:0,class:ne([y(p).e("icon"),y(m).e("icon")]),onMousedown:nn(Ae,["prevent"]),onTouchstartPassive:je},{default:Ne(()=>[(J(),He(wn(y(Ve))))]),_:1},8,["class","onMousedown"])):Fe("v-if",!0),Ce("input",{id:$e.id&&$e.id[0],autocomplete:"off",name:$e.name&&$e.name[0],placeholder:$e.startPlaceholder,value:y(Ye)&&y(Ye)[0],disabled:y(be),readonly:!$e.editable||$e.readonly,class:ne(y(m).b("input")),onMousedown:Ae,onInput:gn,onChange:nt,onFocus:Q,onBlur:me},null,42,JSe),We($e.$slots,"range-separator",{},()=>[Ce("span",{class:ne(y(m).b("separator"))},pt($e.rangeSeparator),3)]),Ce("input",{id:$e.id&&$e.id[1],autocomplete:"off",name:$e.name&&$e.name[1],placeholder:$e.endPlaceholder,value:y(Ye)&&y(Ye)[1],disabled:y(be),readonly:!$e.editable||$e.readonly,class:ne(y(m).b("input")),onMousedown:Ae,onFocus:Q,onBlur:me,onInput:Bt,onChange:It},null,42,XSe),$e.clearIcon?(J(),He(y(Gt),{key:1,class:ne(y(H)),onClick:st},{default:Ne(()=>[(J(),He(wn($e.clearIcon)))]),_:1},8,["class"])):Fe("v-if",!0)],38)):(J(),He(y(Ai),{key:0,id:$e.id,ref_key:"inputRef",ref:R,"container-role":"combobox","model-value":y(Ye),name:$e.name,size:y(ht),disabled:y(be),placeholder:$e.placeholder,class:ne([y(f).b("editor"),y(f).bm("editor",$e.type),$e.$attrs.class]),style:Ht($e.$attrs.style),readonly:!$e.editable||$e.readonly||y(we)||y(Ge)||$e.type==="week","aria-label":$e.label||$e.ariaLabel,tabindex:$e.tabindex,"validate-event":!1,onInput:sn,onFocus:Q,onBlur:me,onKeydown:Jt,onChange:Et,onMousedown:Ae,onMouseenter:xe,onMouseleave:ot,onTouchstartPassive:je,onClick:xt[0]||(xt[0]=nn(()=>{},["stop"]))},{prefix:Ne(()=>[y(Ve)?(J(),He(y(Gt),{key:0,class:ne(y(p).e("icon")),onMousedown:nn(Ae,["prevent"]),onTouchstartPassive:je},{default:Ne(()=>[(J(),He(wn(y(Ve))))]),_:1},8,["class","onMousedown"])):Fe("v-if",!0)]),suffix:Ne(()=>[qe.value&&$e.clearIcon?(J(),He(y(Gt),{key:0,class:ne(`${y(p).e("icon")} clear-icon`),onClick:nn(st,["stop"])},{default:Ne(()=>[(J(),He(wn($e.clearIcon)))]),_:1},8,["class","onClick"])):Fe("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onKeydown"]))]),content:Ne(()=>[We($e.$slots,"default",{visible:E.value,actualVisible:N.value,parsedValue:y(ke),format:$e.format,dateFormat:$e.dateFormat,timeFormat:$e.timeFormat,unlinkPanels:$e.unlinkPanels,type:$e.type,defaultValue:$e.defaultValue,onPick:X,onSelectRange:$,onSetPickerOption:Ke,onCalendarChange:Xe,onPanelChange:Dt,onKeydown:he,onMousedown:xt[1]||(xt[1]=nn(()=>{},["stop"]))})]),_:3},16,["visible","transition","popper-class","popper-options"]))}});var nK=vt(ZSe,[["__file","picker.vue"]]);const eTe=gt({...tK,datetimeRole:String,parsedValue:{type:Le(Object)}}),oK=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:o})=>{const i=(f,p,m,_)=>{const b={hour:e,minute:t,second:o};let S=f;return["hour","minute","second"].forEach(T=>{if(b[T]){let M;const R=b[T];switch(T){case"minute":{M=R(S.hour(),p,_);break}case"second":{M=R(S.hour(),S.minute(),p,_);break}default:{M=R(p,_);break}}if(M!=null&&M.length&&!M.includes(S[T]())){const E=m?0:M.length-1;S=S[T](M[E])}}}),S},c={};return{timePickerOptions:c,getAvailableTime:i,onSetOption:([f,p])=>{c[f]=p}}},nD=e=>{const t=(i,c)=>i||c,o=i=>i!==!0;return e.map(t).filter(o)},rK=(e,t,o)=>({getHoursList:(f,p)=>tD(24,e&&(()=>e==null?void 0:e(f,p))),getMinutesList:(f,p,m)=>tD(60,t&&(()=>t==null?void 0:t(f,p,m))),getSecondsList:(f,p,m,_)=>tD(60,o&&(()=>o==null?void 0:o(f,p,m,_)))}),iK=(e,t,o)=>{const{getHoursList:i,getMinutesList:c,getSecondsList:u}=rK(e,t,o);return{getAvailableHours:(_,b)=>nD(i(_,b)),getAvailableMinutes:(_,b,S)=>nD(c(_,b,S)),getAvailableSeconds:(_,b,S,T)=>nD(u(_,b,S,T))}},sK=e=>{const t=ae(e.parsedValue);return rt(()=>e.visible,o=>{o||(t.value=e.parsedValue)}),t},zu=new Map;let CB;$n&&(document.addEventListener("mousedown",e=>CB=e),document.addEventListener("mouseup",e=>{for(const t of zu.values())for(const{documentHandler:o}of t)o(e,CB)}));function SB(e,t){let o=[];return Array.isArray(t.arg)?o=t.arg:ra(t.arg)&&o.push(t.arg),function(i,c){const u=t.instance.popperRef,f=i.target,p=c==null?void 0:c.target,m=!t||!t.instance,_=!f||!p,b=e.contains(f)||e.contains(p),S=e===f,T=o.length&&o.some(R=>R==null?void 0:R.contains(f))||o.length&&o.includes(p),M=u&&(u.contains(f)||u.contains(p));m||_||b||S||T||M||t.value(i,c)}}const wc={beforeMount(e,t){zu.has(e)||zu.set(e,[]),zu.get(e).push({documentHandler:SB(e,t),bindingFn:t.value})},updated(e,t){zu.has(e)||zu.set(e,[]);const o=zu.get(e),i=o.findIndex(u=>u.bindingFn===t.oldValue),c={documentHandler:SB(e,t),bindingFn:t.value};i>=0?o.splice(i,1,c):o.push(c)},unmounted(e){zu.delete(e)}},tTe=100,nTe=600,kE={beforeMount(e,t){const o=t.value,{interval:i=tTe,delay:c=nTe}=tn(o)?{}:o;let u,f;const p=()=>tn(o)?o():o.handler(),m=()=>{f&&(clearTimeout(f),f=void 0),u&&(clearInterval(u),u=void 0)};e.addEventListener("mousedown",_=>{_.button===0&&(m(),p(),document.addEventListener("mouseup",()=>m(),{once:!0}),f=setTimeout(()=>{u=setInterval(()=>{p()},i)},c))})}},uO="_trap-focus-children",Lf=[],TB=e=>{if(Lf.length===0)return;const t=Lf[Lf.length-1][uO];if(t.length>0&&e.code===Yt.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const o=e.shiftKey,i=e.target===t[0],c=e.target===t[t.length-1];i&&o&&(e.preventDefault(),t[t.length-1].focus()),c&&!o&&(e.preventDefault(),t[0].focus())}},oTe={beforeMount(e){e[uO]=N5(e),Lf.push(e),Lf.length<=1&&document.addEventListener("keydown",TB)},updated(e){zt(()=>{e[uO]=N5(e)})},unmounted(){Lf.shift(),Lf.length===0&&document.removeEventListener("keydown",TB)}};var EB=!1,_f,dO,hO,UT,xT,aK,FT,fO,pO,gO,lK,mO,vO,cK,uK;function Zi(){if(!EB){EB=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),o=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(mO=/\b(iPhone|iP[ao]d)/.exec(e),vO=/\b(iP[ao]d)/.exec(e),gO=/Android/i.exec(e),cK=/FBAN\/\w+;/i.exec(e),uK=/Mobile/i.exec(e),lK=!!/Win64/.exec(e),t){_f=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,_f&&document&&document.documentMode&&(_f=document.documentMode);var i=/(?:Trident\/(\d+.\d+))/.exec(e);aK=i?parseFloat(i[1])+4:_f,dO=t[2]?parseFloat(t[2]):NaN,hO=t[3]?parseFloat(t[3]):NaN,UT=t[4]?parseFloat(t[4]):NaN,UT?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),xT=t&&t[1]?parseFloat(t[1]):NaN):xT=NaN}else _f=dO=hO=xT=UT=NaN;if(o){if(o[1]){var c=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);FT=c?parseFloat(c[1].replace("_",".")):!0}else FT=!1;fO=!!o[2],pO=!!o[3]}else FT=fO=pO=!1}}var _O={ie:function(){return Zi()||_f},ieCompatibilityMode:function(){return Zi()||aK>_f},ie64:function(){return _O.ie()&&lK},firefox:function(){return Zi()||dO},opera:function(){return Zi()||hO},webkit:function(){return Zi()||UT},safari:function(){return _O.webkit()},chrome:function(){return Zi()||xT},windows:function(){return Zi()||fO},osx:function(){return Zi()||FT},linux:function(){return Zi()||pO},iphone:function(){return Zi()||mO},mobile:function(){return Zi()||mO||vO||gO||uK},nativeApp:function(){return Zi()||cK},android:function(){return Zi()||gO},ipad:function(){return Zi()||vO}},rTe=_O,gT=!!(typeof window<"u"&&window.document&&window.document.createElement),iTe={canUseDOM:gT,canUseWorkers:typeof Worker<"u",canUseEventListeners:gT&&!!(window.addEventListener||window.attachEvent),canUseViewport:gT&&!!window.screen,isInWorker:!gT},dK=iTe,hK;dK.canUseDOM&&(hK=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function sTe(e,t){if(!dK.canUseDOM||t&&!("addEventListener"in document))return!1;var o="on"+e,i=o in document;if(!i){var c=document.createElement("div");c.setAttribute(o,"return;"),i=typeof c[o]=="function"}return!i&&hK&&e==="wheel"&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var aTe=sTe,MB=10,kB=40,AB=800;function fK(e){var t=0,o=0,i=0,c=0;return"detail"in e&&(o=e.detail),"wheelDelta"in e&&(o=-e.wheelDelta/120),"wheelDeltaY"in e&&(o=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=o,o=0),i=t*MB,c=o*MB,"deltaY"in e&&(c=e.deltaY),"deltaX"in e&&(i=e.deltaX),(i||c)&&e.deltaMode&&(e.deltaMode==1?(i*=kB,c*=kB):(i*=AB,c*=AB)),i&&!t&&(t=i<1?-1:1),c&&!o&&(o=c<1?-1:1),{spinX:t,spinY:o,pixelX:i,pixelY:c}}fK.getEventType=function(){return rTe.firefox()?"DOMMouseScroll":aTe("wheel")?"wheel":"mousewheel"};var lTe=fK;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const cTe=function(e,t){if(e&&e.addEventListener){const o=function(i){const c=lTe(i);t&&Reflect.apply(t,this,[i,c])};e.addEventListener("wheel",o,{passive:!0})}},uTe={beforeMount(e,t){cTe(e,t.value)}},dTe=gt({role:{type:String,required:!0},spinnerDate:{type:Le(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:Le(String),default:""},...eK}),hTe=["onClick"],fTe=["onMouseenter"],pTe=Se({__name:"basic-time-spinner",props:dTe,emits:["change","select-range","set-option"],setup(e,{emit:t}){const o=e,i=lt("time"),{getHoursList:c,getMinutesList:u,getSecondsList:f}=rK(o.disabledHours,o.disabledMinutes,o.disabledSeconds);let p=!1;const m=ae(),_=ae(),b=ae(),S=ae(),T={hours:_,minutes:b,seconds:S},M=K(()=>o.showSeconds?vB:vB.slice(0,2)),R=K(()=>{const{spinnerDate:ee}=o,Q=ee.hour(),ue=ee.minute(),me=ee.second();return{hours:Q,minutes:ue,seconds:me}}),E=K(()=>{const{hours:ee,minutes:Q}=y(R);return{hours:c(o.role),minutes:u(ee,o.role),seconds:f(ee,Q,o.role)}}),N=K(()=>{const{hours:ee,minutes:Q,seconds:ue}=y(R);return{hours:eD(ee,23),minutes:eD(Q,59),seconds:eD(ue,59)}}),D=as(ee=>{p=!1,F(ee)},200),x=ee=>{if(!!!o.amPmMode)return"";const ue=o.amPmMode==="A";let me=ee<12?" am":" pm";return ue&&(me=me.toUpperCase()),me},L=ee=>{let Q;switch(ee){case"hours":Q=[0,2];break;case"minutes":Q=[3,5];break;case"seconds":Q=[6,8];break}const[ue,me]=Q;t("select-range",ue,me),m.value=ee},F=ee=>{z(ee,y(R)[ee])},H=()=>{F("hours"),F("minutes"),F("seconds")},B=ee=>ee.querySelector(`.${i.namespace.value}-scrollbar__wrap`),z=(ee,Q)=>{if(o.arrowControl)return;const ue=y(T[ee]);ue&&ue.$el&&(B(ue.$el).scrollTop=Math.max(0,Q*W(ee)))},W=ee=>{const Q=y(T[ee]),ue=Q==null?void 0:Q.$el.querySelector("li");return ue&&Number.parseFloat(td(ue,"height"))||0},Z=()=>{O(1)},$=()=>{O(-1)},O=ee=>{m.value||L("hours");const Q=m.value,ue=y(R)[Q],me=m.value==="hours"?24:60,be=X(Q,ue,ee,me);le(Q,be),z(Q,be),zt(()=>L(Q))},X=(ee,Q,ue,me)=>{let be=(Q+ue+me)%me;const ke=y(E)[ee];for(;ke[be]&&be!==Q;)be=(be+ue+me)%me;return be},le=(ee,Q)=>{if(y(E)[ee][Q])return;const{hours:be,minutes:ke,seconds:Ye}=y(R);let Oe;switch(ee){case"hours":Oe=o.spinnerDate.hour(Q).minute(ke).second(Ye);break;case"minutes":Oe=o.spinnerDate.hour(be).minute(Q).second(Ye);break;case"seconds":Oe=o.spinnerDate.hour(be).minute(ke).second(Q);break}t("change",Oe)},de=(ee,{value:Q,disabled:ue})=>{ue||(le(ee,Q),L(ee),z(ee,Q))},he=ee=>{p=!0,D(ee);const Q=Math.min(Math.round((B(y(T[ee]).$el).scrollTop-(se(ee)*.5-10)/W(ee)+3)/W(ee)),ee==="hours"?23:59);le(ee,Q)},se=ee=>y(T[ee]).$el.offsetHeight,ie=()=>{const ee=Q=>{const ue=y(T[Q]);ue&&ue.$el&&(B(ue.$el).onscroll=()=>{he(Q)})};ee("hours"),ee("minutes"),ee("seconds")};fn(()=>{zt(()=>{!o.arrowControl&&ie(),H(),o.role==="start"&&L("hours")})});const oe=(ee,Q)=>{T[Q].value=ee};return t("set-option",[`${o.role}_scrollDown`,O]),t("set-option",[`${o.role}_emitSelectRange`,L]),rt(()=>o.spinnerDate,()=>{p||H()}),(ee,Q)=>(J(),ge("div",{class:ne([y(i).b("spinner"),{"has-seconds":ee.showSeconds}])},[ee.arrowControl?Fe("v-if",!0):(J(!0),ge(qt,{key:0},Vn(y(M),ue=>(J(),He(y(xc),{key:ue,ref_for:!0,ref:me=>oe(me,ue),class:ne(y(i).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(i).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:me=>L(ue),onMousemove:me=>F(ue)},{default:Ne(()=>[(J(!0),ge(qt,null,Vn(y(E)[ue],(me,be)=>(J(),ge("li",{key:be,class:ne([y(i).be("spinner","item"),y(i).is("active",be===y(R)[ue]),y(i).is("disabled",me)]),onClick:ke=>de(ue,{value:be,disabled:me})},[ue==="hours"?(J(),ge(qt,{key:0},[On(pt(("0"+(ee.amPmMode?be%12||12:be)).slice(-2))+pt(x(be)),1)],64)):(J(),ge(qt,{key:1},[On(pt(("0"+be).slice(-2)),1)],64))],10,hTe))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),ee.arrowControl?(J(!0),ge(qt,{key:1},Vn(y(M),ue=>(J(),ge("div",{key:ue,class:ne([y(i).be("spinner","wrapper"),y(i).is("arrow")]),onMouseenter:me=>L(ue)},[hn((J(),He(y(Gt),{class:ne(["arrow-up",y(i).be("spinner","arrow")])},{default:Ne(()=>[Me(y(tL))]),_:1},8,["class"])),[[y(kE),$]]),hn((J(),He(y(Gt),{class:ne(["arrow-down",y(i).be("spinner","arrow")])},{default:Ne(()=>[Me(y(Pc))]),_:1},8,["class"])),[[y(kE),Z]]),Ce("ul",{class:ne(y(i).be("spinner","list"))},[(J(!0),ge(qt,null,Vn(y(N)[ue],(me,be)=>(J(),ge("li",{key:be,class:ne([y(i).be("spinner","item"),y(i).is("active",me===y(R)[ue]),y(i).is("disabled",y(E)[ue][me])])},[typeof me=="number"?(J(),ge(qt,{key:0},[ue==="hours"?(J(),ge(qt,{key:0},[On(pt(("0"+(ee.amPmMode?me%12||12:me)).slice(-2))+pt(x(me)),1)],64)):(J(),ge(qt,{key:1},[On(pt(("0"+me).slice(-2)),1)],64))],64)):Fe("v-if",!0)],2))),128))],2)],42,fTe))),128)):Fe("v-if",!0)],2))}});var yO=vt(pTe,[["__file","basic-time-spinner.vue"]]);const gTe=Se({__name:"panel-time-pick",props:eTe,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,i=wt("EP_PICKER_BASE"),{arrowControl:c,disabledHours:u,disabledMinutes:f,disabledSeconds:p,defaultValue:m}=i.props,{getAvailableHours:_,getAvailableMinutes:b,getAvailableSeconds:S}=iK(u,f,p),T=lt("time"),{t:M,lang:R}=Kn(),E=ae([0,2]),N=sK(o),D=K(()=>_r(o.actualVisible)?`${T.namespace.value}-zoom-in-top`:""),x=K(()=>o.format.includes("ss")),L=K(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),F=oe=>{const ee=Tn(oe).locale(R.value),Q=de(ee);return ee.isSame(Q)},H=()=>{t("pick",N.value,!1)},B=(oe=!1,ee=!1)=>{ee||t("pick",o.parsedValue,oe)},z=oe=>{if(!o.visible)return;const ee=de(oe).millisecond(0);t("pick",ee,!0)},W=(oe,ee)=>{t("select-range",oe,ee),E.value=[oe,ee]},Z=oe=>{const ee=[0,3].concat(x.value?[6]:[]),Q=["hours","minutes"].concat(x.value?["seconds"]:[]),me=(ee.indexOf(E.value[0])+oe+ee.length)%ee.length;O.start_emitSelectRange(Q[me])},$=oe=>{const ee=oe.code,{left:Q,right:ue,up:me,down:be}=Yt;if([Q,ue].includes(ee)){Z(ee===Q?-1:1),oe.preventDefault();return}if([me,be].includes(ee)){const ke=ee===me?-1:1;O.start_scrollDown(ke),oe.preventDefault();return}},{timePickerOptions:O,onSetOption:X,getAvailableTime:le}=oK({getAvailableHours:_,getAvailableMinutes:b,getAvailableSeconds:S}),de=oe=>le(oe,o.datetimeRole||"",!0),he=oe=>oe?Tn(oe,o.format).locale(R.value):null,se=oe=>oe?oe.format(o.format):null,ie=()=>Tn(m).locale(R.value);return t("set-picker-option",["isValidValue",F]),t("set-picker-option",["formatToString",se]),t("set-picker-option",["parseUserInput",he]),t("set-picker-option",["handleKeydownInput",$]),t("set-picker-option",["getRangeAvailableTime",de]),t("set-picker-option",["getDefaultValue",ie]),(oe,ee)=>(J(),He(Rr,{name:y(D)},{default:Ne(()=>[oe.actualVisible||oe.visible?(J(),ge("div",{key:0,class:ne(y(T).b("panel"))},[Ce("div",{class:ne([y(T).be("panel","content"),{"has-seconds":y(x)}])},[Me(yO,{ref:"spinner",role:oe.datetimeRole||"start","arrow-control":y(c),"show-seconds":y(x),"am-pm-mode":y(L),"spinner-date":oe.parsedValue,"disabled-hours":y(u),"disabled-minutes":y(f),"disabled-seconds":y(p),onChange:z,onSetOption:y(X),onSelectRange:W},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ce("div",{class:ne(y(T).be("panel","footer"))},[Ce("button",{type:"button",class:ne([y(T).be("panel","btn"),"cancel"]),onClick:H},pt(y(M)("el.datepicker.cancel")),3),Ce("button",{type:"button",class:ne([y(T).be("panel","btn"),"confirm"]),onClick:ee[0]||(ee[0]=Q=>B())},pt(y(M)("el.datepicker.confirm")),3)],2)],2)):Fe("v-if",!0)]),_:1},8,["name"]))}});var AE=vt(gTe,[["__file","panel-time-pick.vue"]]);const mTe=gt({...tK,parsedValue:{type:Le(Array)}}),vTe=["disabled"],_Te=Se({__name:"panel-time-range",props:mTe,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,i=(qe,st)=>{const Ie=[];for(let Ae=qe;Ae<=st;Ae++)Ie.push(Ae);return Ie},{t:c,lang:u}=Kn(),f=lt("time"),p=lt("picker"),m=wt("EP_PICKER_BASE"),{arrowControl:_,disabledHours:b,disabledMinutes:S,disabledSeconds:T,defaultValue:M}=m.props,R=K(()=>[f.be("range-picker","body"),f.be("panel","content"),f.is("arrow",_),F.value?"has-seconds":""]),E=K(()=>[f.be("range-picker","body"),f.be("panel","content"),f.is("arrow",_),F.value?"has-seconds":""]),N=K(()=>o.parsedValue[0]),D=K(()=>o.parsedValue[1]),x=sK(o),L=()=>{t("pick",x.value,!1)},F=K(()=>o.format.includes("ss")),H=K(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),B=(qe=!1)=>{t("pick",[N.value,D.value],qe)},z=qe=>{$(qe.millisecond(0),D.value)},W=qe=>{$(N.value,qe.millisecond(0))},Z=qe=>{const st=qe.map(Ae=>Tn(Ae).locale(u.value)),Ie=ue(st);return st[0].isSame(Ie[0])&&st[1].isSame(Ie[1])},$=(qe,st)=>{t("pick",[qe,st],!0)},O=K(()=>N.value>D.value),X=ae([0,2]),le=(qe,st)=>{t("select-range",qe,st,"min"),X.value=[qe,st]},de=K(()=>F.value?11:8),he=(qe,st)=>{t("select-range",qe,st,"max");const Ie=y(de);X.value=[qe+Ie,st+Ie]},se=qe=>{const st=F.value?[0,3,6,11,14,17]:[0,3,8,11],Ie=["hours","minutes"].concat(F.value?["seconds"]:[]),xe=(st.indexOf(X.value[0])+qe+st.length)%st.length,ot=st.length/2;xe<ot?Ye.start_emitSelectRange(Ie[xe]):Ye.end_emitSelectRange(Ie[xe-ot])},ie=qe=>{const st=qe.code,{left:Ie,right:Ae,up:xe,down:ot}=Yt;if([Ie,Ae].includes(st)){se(st===Ie?-1:1),qe.preventDefault();return}if([xe,ot].includes(st)){const je=st===xe?-1:1,at=X.value[0]<de.value?"start":"end";Ye[`${at}_scrollDown`](je),qe.preventDefault();return}},oe=(qe,st)=>{const Ie=b?b(qe):[],Ae=qe==="start",ot=(st||(Ae?D.value:N.value)).hour(),je=Ae?i(ot+1,23):i(0,ot-1);return Kw(Ie,je)},ee=(qe,st,Ie)=>{const Ae=S?S(qe,st):[],xe=st==="start",ot=Ie||(xe?D.value:N.value),je=ot.hour();if(qe!==je)return Ae;const at=ot.minute(),ht=xe?i(at+1,59):i(0,at-1);return Kw(Ae,ht)},Q=(qe,st,Ie,Ae)=>{const xe=T?T(qe,st,Ie):[],ot=Ie==="start",je=Ae||(ot?D.value:N.value),at=je.hour(),ht=je.minute();if(qe!==at||st!==ht)return xe;const dt=je.second(),ft=ot?i(dt+1,59):i(0,dt-1);return Kw(xe,ft)},ue=([qe,st])=>[Oe(qe,"start",!0,st),Oe(st,"end",!1,qe)],{getAvailableHours:me,getAvailableMinutes:be,getAvailableSeconds:ke}=iK(oe,ee,Q),{timePickerOptions:Ye,getAvailableTime:Oe,onSetOption:Ee}=oK({getAvailableHours:me,getAvailableMinutes:be,getAvailableSeconds:ke}),we=qe=>qe?At(qe)?qe.map(st=>Tn(st,o.format).locale(u.value)):Tn(qe,o.format).locale(u.value):null,Ge=qe=>qe?At(qe)?qe.map(st=>st.format(o.format)):qe.format(o.format):null,Ve=()=>{if(At(M))return M.map(st=>Tn(st).locale(u.value));const qe=Tn(M).locale(u.value);return[qe,qe.add(60,"m")]};return t("set-picker-option",["formatToString",Ge]),t("set-picker-option",["parseUserInput",we]),t("set-picker-option",["isValidValue",Z]),t("set-picker-option",["handleKeydownInput",ie]),t("set-picker-option",["getDefaultValue",Ve]),t("set-picker-option",["getRangeAvailableTime",ue]),(qe,st)=>qe.actualVisible?(J(),ge("div",{key:0,class:ne([y(f).b("range-picker"),y(p).b("panel")])},[Ce("div",{class:ne(y(f).be("range-picker","content"))},[Ce("div",{class:ne(y(f).be("range-picker","cell"))},[Ce("div",{class:ne(y(f).be("range-picker","header"))},pt(y(c)("el.datepicker.startTime")),3),Ce("div",{class:ne(y(R))},[Me(yO,{ref:"minSpinner",role:"start","show-seconds":y(F),"am-pm-mode":y(H),"arrow-control":y(_),"spinner-date":y(N),"disabled-hours":oe,"disabled-minutes":ee,"disabled-seconds":Q,onChange:z,onSetOption:y(Ee),onSelectRange:le},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ce("div",{class:ne(y(f).be("range-picker","cell"))},[Ce("div",{class:ne(y(f).be("range-picker","header"))},pt(y(c)("el.datepicker.endTime")),3),Ce("div",{class:ne(y(E))},[Me(yO,{ref:"maxSpinner",role:"end","show-seconds":y(F),"am-pm-mode":y(H),"arrow-control":y(_),"spinner-date":y(D),"disabled-hours":oe,"disabled-minutes":ee,"disabled-seconds":Q,onChange:W,onSetOption:y(Ee),onSelectRange:he},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ce("div",{class:ne(y(f).be("panel","footer"))},[Ce("button",{type:"button",class:ne([y(f).be("panel","btn"),"cancel"]),onClick:st[0]||(st[0]=Ie=>L())},pt(y(c)("el.datepicker.cancel")),3),Ce("button",{type:"button",class:ne([y(f).be("panel","btn"),"confirm"]),disabled:y(O),onClick:st[1]||(st[1]=Ie=>B())},pt(y(c)("el.datepicker.confirm")),11,vTe)],2)],2)):Fe("v-if",!0)}});var yTe=vt(_Te,[["__file","panel-time-range.vue"]]);Tn.extend(UL);var ITe=Se({name:"ElTimePicker",install:null,props:{...xL,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const o=ae(),[i,c]=e.isRange?["timerange",yTe]:["time",AE],u=f=>t.emit("update:modelValue",f);return Ln("ElPopperOptions",e.popperOptions),t.expose({focus:f=>{var p;(p=o.value)==null||p.handleFocusInput(f)},blur:f=>{var p;(p=o.value)==null||p.handleBlurInput(f)},handleOpen:()=>{var f;(f=o.value)==null||f.handleOpen()},handleClose:()=>{var f;(f=o.value)==null||f.handleClose()}}),()=>{var f;const p=(f=e.format)!=null?f:cO;return Me(nK,Nn(e,{ref:o,type:i,format:p,"onUpdate:modelValue":u}),{default:m=>Me(c,m,null)})}}});const VT=ITe;VT.install=e=>{e.component(VT.name,VT)};const bTe=VT,CTe=(e,t)=>{const o=e.subtract(1,"month").endOf("month").date();return fd(t).map((i,c)=>o-(t-c-1))},STe=e=>{const t=e.daysInMonth();return fd(t).map((o,i)=>i+1)},TTe=e=>fd(e.length/7).map(t=>{const o=t*7;return e.slice(o,o+7)}),ETe=gt({selectedDay:{type:Le(Object)},range:{type:Le(Array)},date:{type:Le(Object),required:!0},hideHeader:{type:Boolean}}),MTe={pick:e=>En(e)};var pK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i,c){var u=i.prototype,f=function(S){return S&&(S.indexOf?S:S.s)},p=function(S,T,M,R,E){var N=S.name?S:S.$locale(),D=f(N[T]),x=f(N[M]),L=D||x.map(function(H){return H.slice(0,R)});if(!E)return L;var F=N.weekStart;return L.map(function(H,B){return L[(B+(F||0))%7]})},m=function(){return c.Ls[c.locale()]},_=function(S,T){return S.formats[T]||function(M){return M.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(R,E,N){return E||N.slice(1)})}(S.formats[T.toUpperCase()])},b=function(){var S=this;return{months:function(T){return T?T.format("MMMM"):p(S,"months")},monthsShort:function(T){return T?T.format("MMM"):p(S,"monthsShort","months",3)},firstDayOfWeek:function(){return S.$locale().weekStart||0},weekdays:function(T){return T?T.format("dddd"):p(S,"weekdays")},weekdaysMin:function(T){return T?T.format("dd"):p(S,"weekdaysMin","weekdays",2)},weekdaysShort:function(T){return T?T.format("ddd"):p(S,"weekdaysShort","weekdays",3)},longDateFormat:function(T){return _(S.$locale(),T)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};u.localeData=function(){return b.bind(this)()},c.localeData=function(){var S=m();return{firstDayOfWeek:function(){return S.weekStart||0},weekdays:function(){return c.weekdays()},weekdaysShort:function(){return c.weekdaysShort()},weekdaysMin:function(){return c.weekdaysMin()},months:function(){return c.months()},monthsShort:function(){return c.monthsShort()},longDateFormat:function(T){return _(S,T)},meridiem:S.meridiem,ordinal:S.ordinal}},c.months=function(){return p(m(),"months")},c.monthsShort=function(){return p(m(),"monthsShort","months",3)},c.weekdays=function(S){return p(m(),"weekdays",null,null,S)},c.weekdaysShort=function(S){return p(m(),"weekdaysShort","weekdays",3,S)},c.weekdaysMin=function(S){return p(m(),"weekdaysMin","weekdays",2,S)}}})})(pK);var kTe=pK.exports;const gK=la(kTe),ATe=(e,t)=>{Tn.extend(gK);const o=Tn.localeData().firstDayOfWeek(),{t:i,lang:c}=Kn(),u=Tn().locale(c.value),f=K(()=>!!e.range&&!!e.range.length),p=K(()=>{let T=[];if(f.value){const[M,R]=e.range,E=fd(R.date()-M.date()+1).map(x=>({text:M.date()+x,type:"current"}));let N=E.length%7;N=N===0?0:7-N;const D=fd(N).map((x,L)=>({text:L+1,type:"next"}));T=E.concat(D)}else{const M=e.date.startOf("month").day(),R=CTe(e.date,(M-o+7)%7).map(x=>({text:x,type:"prev"})),E=STe(e.date).map(x=>({text:x,type:"current"}));T=[...R,...E];const N=7-(T.length%7||7),D=fd(N).map((x,L)=>({text:L+1,type:"next"}));T=T.concat(D)}return TTe(T)}),m=K(()=>{const T=o;return T===0?zw.map(M=>i(`el.datepicker.weeks.${M}`)):zw.slice(T).concat(zw.slice(0,T)).map(M=>i(`el.datepicker.weeks.${M}`))}),_=(T,M)=>{switch(M){case"prev":return e.date.startOf("month").subtract(1,"month").date(T);case"next":return e.date.startOf("month").add(1,"month").date(T);case"current":return e.date.date(T)}};return{now:u,isInRange:f,rows:p,weekDays:m,getFormattedDate:_,handlePickDay:({text:T,type:M})=>{const R=_(T,M);t("pick",R)},getSlotData:({text:T,type:M})=>{const R=_(T,M);return{isSelected:R.isSame(e.selectedDay),type:`${M}-month`,day:R.format("YYYY-MM-DD"),date:R.toDate()}}}},RTe={key:0},wTe=["onClick"],DTe=Se({name:"DateTable"}),OTe=Se({...DTe,props:ETe,emits:MTe,setup(e,{expose:t,emit:o}){const i=e,{isInRange:c,now:u,rows:f,weekDays:p,getFormattedDate:m,handlePickDay:_,getSlotData:b}=ATe(i,o),S=lt("calendar-table"),T=lt("calendar-day"),M=({text:R,type:E})=>{const N=[E];if(E==="current"){const D=m(R,E);D.isSame(i.selectedDay,"day")&&N.push(T.is("selected")),D.isSame(u,"day")&&N.push(T.is("today"))}return N};return t({getFormattedDate:m}),(R,E)=>(J(),ge("table",{class:ne([y(S).b(),y(S).is("range",y(c))]),cellspacing:"0",cellpadding:"0"},[R.hideHeader?Fe("v-if",!0):(J(),ge("thead",RTe,[(J(!0),ge(qt,null,Vn(y(p),N=>(J(),ge("th",{key:N},pt(N),1))),128))])),Ce("tbody",null,[(J(!0),ge(qt,null,Vn(y(f),(N,D)=>(J(),ge("tr",{key:D,class:ne({[y(S).e("row")]:!0,[y(S).em("row","hide-border")]:D===0&&R.hideHeader})},[(J(!0),ge(qt,null,Vn(N,(x,L)=>(J(),ge("td",{key:L,class:ne(M(x)),onClick:F=>y(_)(x)},[Ce("div",{class:ne(y(T).b())},[We(R.$slots,"date-cell",{data:y(b)(x)},()=>[Ce("span",null,pt(x.text),1)])],2)],10,wTe))),128))],2))),128))])],2))}});var RB=vt(OTe,[["__file","date-table.vue"]]);const NTe=(e,t)=>{const o=e.endOf("month"),i=t.startOf("month"),u=o.isSame(i,"week")?i.add(1,"week"):i;return[[e,o],[u.startOf("week"),t]]},LTe=(e,t)=>{const o=e.endOf("month"),i=e.add(1,"month").startOf("month"),c=o.isSame(i,"week")?i.add(1,"week"):i,u=c.endOf("month"),f=t.startOf("month"),p=u.isSame(f,"week")?f.add(1,"week"):f;return[[e,o],[c.startOf("week"),u],[p.startOf("week"),t]]},PTe=(e,t,o)=>{const{lang:i}=Kn(),c=ae(),u=Tn().locale(i.value),f=K({get(){return e.modelValue?m.value:c.value},set(N){if(!N)return;c.value=N;const D=N.toDate();t(Hi,D),t(Mn,D)}}),p=K(()=>{if(!e.range)return[];const N=e.range.map(L=>Tn(L).locale(i.value)),[D,x]=N;return D.isAfter(x)?[]:D.isSame(x,"month")?M(D,x):D.add(1,"month").month()!==x.month()?[]:M(D,x)}),m=K(()=>e.modelValue?Tn(e.modelValue).locale(i.value):f.value||(p.value.length?p.value[0][0]:u)),_=K(()=>m.value.subtract(1,"month").date(1)),b=K(()=>m.value.add(1,"month").date(1)),S=K(()=>m.value.subtract(1,"year").date(1)),T=K(()=>m.value.add(1,"year").date(1)),M=(N,D)=>{const x=N.startOf("week"),L=D.endOf("week"),F=x.get("month"),H=L.get("month");return F===H?[[x,L]]:(F+1)%12===H?NTe(x,L):F+2===H||(F+1)%11===H?LTe(x,L):[]},R=N=>{f.value=N};return{calculateValidatedDateRange:M,date:m,realSelectedDay:f,pickDay:R,selectDate:N=>{const x={"prev-month":_.value,"next-month":b.value,"prev-year":S.value,"next-year":T.value,today:u}[N];x.isSame(m.value,"day")||R(x)},validatedRange:p}},UTe=e=>At(e)&&e.length===2&&e.every(t=>zf(t)),xTe=gt({modelValue:{type:Date},range:{type:Le(Array),validator:UTe}}),FTe={[Mn]:e=>zf(e),[Hi]:e=>zf(e)},VTe="ElCalendar",GTe=Se({name:VTe}),BTe=Se({...GTe,props:xTe,emits:FTe,setup(e,{expose:t,emit:o}){const i=e,c=lt("calendar"),{calculateValidatedDateRange:u,date:f,pickDay:p,realSelectedDay:m,selectDate:_,validatedRange:b}=PTe(i,o),{t:S}=Kn(),T=K(()=>{const M=`el.datepicker.month${f.value.format("M")}`;return`${f.value.year()} ${S("el.datepicker.year")} ${S(M)}`});return t({selectedDay:m,pickDay:p,selectDate:_,calculateValidatedDateRange:u}),(M,R)=>(J(),ge("div",{class:ne(y(c).b())},[Ce("div",{class:ne(y(c).e("header"))},[We(M.$slots,"header",{date:y(T)},()=>[Ce("div",{class:ne(y(c).e("title"))},pt(y(T)),3),y(b).length===0?(J(),ge("div",{key:0,class:ne(y(c).e("button-group"))},[Me(y(Y9),null,{default:Ne(()=>[Me(y(qr),{size:"small",onClick:R[0]||(R[0]=E=>y(_)("prev-month"))},{default:Ne(()=>[On(pt(y(S)("el.datepicker.prevMonth")),1)]),_:1}),Me(y(qr),{size:"small",onClick:R[1]||(R[1]=E=>y(_)("today"))},{default:Ne(()=>[On(pt(y(S)("el.datepicker.today")),1)]),_:1}),Me(y(qr),{size:"small",onClick:R[2]||(R[2]=E=>y(_)("next-month"))},{default:Ne(()=>[On(pt(y(S)("el.datepicker.nextMonth")),1)]),_:1})]),_:1})],2)):Fe("v-if",!0)])],2),y(b).length===0?(J(),ge("div",{key:0,class:ne(y(c).e("body"))},[Me(RB,{date:y(f),"selected-day":y(m),onPick:y(p)},kc({_:2},[M.$slots["date-cell"]?{name:"date-cell",fn:Ne(E=>[We(M.$slots,"date-cell",bc(dm(E)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(J(),ge("div",{key:1,class:ne(y(c).e("body"))},[(J(!0),ge(qt,null,Vn(y(b),(E,N)=>(J(),He(RB,{key:N,date:E[0],"selected-day":y(m),range:E,"hide-header":N!==0,onPick:y(p)},kc({_:2},[M.$slots["date-cell"]?{name:"date-cell",fn:Ne(D=>[We(M.$slots,"date-cell",bc(dm(D)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var $Te=vt(BTe,[["__file","calendar.vue"]]);const HTe=bn($Te),qTe=gt({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Le([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),KTe=Se({name:"ElCard"}),zTe=Se({...KTe,props:qTe,setup(e){const t=lt("card");return(o,i)=>(J(),ge("div",{class:ne([y(t).b(),y(t).is(`${o.shadow}-shadow`)])},[o.$slots.header||o.header?(J(),ge("div",{key:0,class:ne(y(t).e("header"))},[We(o.$slots,"header",{},()=>[On(pt(o.header),1)])],2)):Fe("v-if",!0),Ce("div",{class:ne([y(t).e("body"),o.bodyClass]),style:Ht(o.bodyStyle)},[We(o.$slots,"default")],6),o.$slots.footer||o.footer?(J(),ge("div",{key:1,class:ne(y(t).e("footer"))},[We(o.$slots,"footer",{},()=>[On(pt(o.footer),1)])],2)):Fe("v-if",!0)],2))}});var WTe=vt(zTe,[["__file","card.vue"]]);const jTe=bn(WTe),YTe=gt({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:{type:Boolean,default:!1}}),JTe={change:(e,t)=>[e,t].every(Zt)},mK=Symbol("carouselContextKey"),wB=300,XTe=(e,t,o)=>{const{children:i,addChild:c,removeChild:u}=RL(In(),"ElCarouselItem"),f=zr(),p=ae(-1),m=ae(null),_=ae(!1),b=ae(),S=ae(0),T=ae(!0),M=ae(!0),R=ae(!1),E=K(()=>e.arrow!=="never"&&!y(x)),N=K(()=>i.value.some(Oe=>Oe.props.label.toString().length>0)),D=K(()=>e.type==="card"),x=K(()=>e.direction==="vertical"),L=K(()=>e.height!=="auto"?{height:e.height}:{height:`${S.value}px`,overflow:"hidden"}),F=$f(Oe=>{$(Oe)},wB,{trailing:!0}),H=$f(Oe=>{ee(Oe)},wB),B=Oe=>T.value?p.value<=1?Oe<=1:Oe>1:!0;function z(){m.value&&(clearInterval(m.value),m.value=null)}function W(){e.interval<=0||!e.autoplay||m.value||(m.value=setInterval(()=>Z(),e.interval))}const Z=()=>{M.value||(R.value=!0),M.value=!1,p.value<i.value.length-1?p.value=p.value+1:e.loop&&(p.value=0)};function $(Oe){if(M.value||(R.value=!0),M.value=!1,on(Oe)){const Ge=i.value.filter(Ve=>Ve.props.name===Oe);Ge.length>0&&(Oe=i.value.indexOf(Ge[0]))}if(Oe=Number(Oe),Number.isNaN(Oe)||Oe!==Math.floor(Oe))return;const Ee=i.value.length,we=p.value;Oe<0?p.value=e.loop?Ee-1:0:Oe>=Ee?p.value=e.loop?0:Ee-1:p.value=Oe,we===p.value&&O(we),me()}function O(Oe){i.value.forEach((Ee,we)=>{Ee.translateItem(we,p.value,Oe)})}function X(Oe,Ee){var we,Ge,Ve,qe;const st=y(i),Ie=st.length;if(Ie===0||!Oe.states.inStage)return!1;const Ae=Ee+1,xe=Ee-1,ot=Ie-1,je=st[ot].states.active,at=st[0].states.active,ht=(Ge=(we=st[Ae])==null?void 0:we.states)==null?void 0:Ge.active,dt=(qe=(Ve=st[xe])==null?void 0:Ve.states)==null?void 0:qe.active;return Ee===ot&&at||ht?"left":Ee===0&&je||dt?"right":!1}function le(){_.value=!0,e.pauseOnHover&&z()}function de(){_.value=!1,W()}function he(){R.value=!1}function se(Oe){y(x)||i.value.forEach((Ee,we)=>{Oe===X(Ee,we)&&(Ee.states.hover=!0)})}function ie(){y(x)||i.value.forEach(Oe=>{Oe.states.hover=!1})}function oe(Oe){Oe!==p.value&&(M.value||(R.value=!0)),p.value=Oe}function ee(Oe){e.trigger==="hover"&&Oe!==p.value&&(p.value=Oe,M.value||(R.value=!0))}function Q(){$(p.value-1)}function ue(){$(p.value+1)}function me(){z(),e.pauseOnHover||W()}function be(Oe){e.height==="auto"&&(S.value=Oe)}function ke(){var Oe;const Ee=(Oe=f.default)==null?void 0:Oe.call(f);if(!Ee)return null;const we=hd(Ee),Ge="ElCarouselItem",Ve=we.filter(qe=>$o(qe)&&qe.type.name===Ge);return(Ve==null?void 0:Ve.length)===2&&e.loop&&!D.value?(T.value=!0,Ve):(T.value=!1,null)}rt(()=>p.value,(Oe,Ee)=>{O(Ee),T.value&&(Oe=Oe%2,Ee=Ee%2),Ee>-1&&t("change",Oe,Ee)}),rt(()=>e.autoplay,Oe=>{Oe?W():z()}),rt(()=>e.loop,()=>{$(p.value)}),rt(()=>e.interval,()=>{me()});const Ye=Do();return fn(()=>{rt(()=>i.value,()=>{i.value.length>0&&$(e.initialIndex)},{immediate:!0}),Ye.value=Ko(b.value,()=>{O()}),W()}),Ro(()=>{z(),b.value&&Ye.value&&Ye.value.stop()}),Ln(mK,{root:b,isCardType:D,isVertical:x,items:i,loop:e.loop,addItem:c,removeItem:u,setActiveItem:$,setContainerHeight:be}),{root:b,activeIndex:p,arrowDisplay:E,hasLabel:N,hover:_,isCardType:D,isTransitioning:R,items:i,isVertical:x,containerStyle:L,isItemsTwoLength:T,handleButtonEnter:se,handleTransitionEnd:he,handleButtonLeave:ie,handleIndicatorClick:oe,handleMouseEnter:le,handleMouseLeave:de,setActiveItem:$,prev:Q,next:ue,PlaceholderItem:ke,isTwoLengthShow:B,throttledArrowClick:F,throttledIndicatorHover:H}},QTe=["aria-label"],ZTe=["aria-label"],eEe=["onMouseenter","onClick"],tEe=["aria-label"],nEe={key:0},oEe={key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},rEe=Ce("defs",null,[Ce("filter",{id:"elCarouselHorizontal"},[Ce("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ce("filter",{id:"elCarouselVertical"},[Ce("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])],-1),iEe=[rEe],sEe="ElCarousel",aEe=Se({name:sEe}),lEe=Se({...aEe,props:YTe,emits:JTe,setup(e,{expose:t,emit:o}){const i=e,{root:c,activeIndex:u,arrowDisplay:f,hasLabel:p,hover:m,isCardType:_,items:b,isVertical:S,containerStyle:T,handleButtonEnter:M,handleButtonLeave:R,isTransitioning:E,handleIndicatorClick:N,handleMouseEnter:D,handleMouseLeave:x,handleTransitionEnd:L,setActiveItem:F,prev:H,next:B,PlaceholderItem:z,isTwoLengthShow:W,throttledArrowClick:Z,throttledIndicatorHover:$}=XTe(i,o),O=lt("carousel"),{t:X}=Kn(),le=K(()=>{const se=[O.b(),O.m(i.direction)];return y(_)&&se.push(O.m("card")),se}),de=K(()=>{const se=[O.e("container")];return i.motionBlur&&y(E)&&se.push(y(S)?`${O.namespace.value}-transitioning-vertical`:`${O.namespace.value}-transitioning`),se}),he=K(()=>{const se=[O.e("indicators"),O.em("indicators",i.direction)];return y(p)&&se.push(O.em("indicators","labels")),i.indicatorPosition==="outside"&&se.push(O.em("indicators","outside")),y(S)&&se.push(O.em("indicators","right")),se});return t({setActiveItem:F,prev:H,next:B}),(se,ie)=>(J(),ge("div",{ref_key:"root",ref:c,class:ne(y(le)),onMouseenter:ie[7]||(ie[7]=nn((...oe)=>y(D)&&y(D)(...oe),["stop"])),onMouseleave:ie[8]||(ie[8]=nn((...oe)=>y(x)&&y(x)(...oe),["stop"]))},[y(f)?(J(),He(Rr,{key:0,name:"carousel-arrow-left",persisted:""},{default:Ne(()=>[hn(Ce("button",{type:"button",class:ne([y(O).e("arrow"),y(O).em("arrow","left")]),"aria-label":y(X)("el.carousel.leftArrow"),onMouseenter:ie[0]||(ie[0]=oe=>y(M)("left")),onMouseleave:ie[1]||(ie[1]=(...oe)=>y(R)&&y(R)(...oe)),onClick:ie[2]||(ie[2]=nn(oe=>y(Z)(y(u)-1),["stop"]))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1})],42,QTe),[[Jn,(se.arrow==="always"||y(m))&&(i.loop||y(u)>0)]])]),_:1})):Fe("v-if",!0),y(f)?(J(),He(Rr,{key:1,name:"carousel-arrow-right",persisted:""},{default:Ne(()=>[hn(Ce("button",{type:"button",class:ne([y(O).e("arrow"),y(O).em("arrow","right")]),"aria-label":y(X)("el.carousel.rightArrow"),onMouseenter:ie[3]||(ie[3]=oe=>y(M)("right")),onMouseleave:ie[4]||(ie[4]=(...oe)=>y(R)&&y(R)(...oe)),onClick:ie[5]||(ie[5]=nn(oe=>y(Z)(y(u)+1),["stop"]))},[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})],42,ZTe),[[Jn,(se.arrow==="always"||y(m))&&(i.loop||y(u)<y(b).length-1)]])]),_:1})):Fe("v-if",!0),Ce("div",{class:ne(y(de)),style:Ht(y(T)),onTransitionend:ie[6]||(ie[6]=(...oe)=>y(L)&&y(L)(...oe))},[Me(y(z)),We(se.$slots,"default")],38),se.indicatorPosition!=="none"?(J(),ge("ul",{key:2,class:ne(y(he))},[(J(!0),ge(qt,null,Vn(y(b),(oe,ee)=>hn((J(),ge("li",{key:ee,class:ne([y(O).e("indicator"),y(O).em("indicator",se.direction),y(O).is("active",ee===y(u))]),onMouseenter:Q=>y($)(ee),onClick:nn(Q=>y(N)(ee),["stop"])},[Ce("button",{class:ne(y(O).e("button")),"aria-label":y(X)("el.carousel.indicator",{index:ee+1})},[y(p)?(J(),ge("span",nEe,pt(oe.props.label),1)):Fe("v-if",!0)],10,tEe)],42,eEe)),[[Jn,y(W)(ee)]])),128))],2)):Fe("v-if",!0),i.motionBlur?(J(),ge("svg",oEe,iEe)):Fe("v-if",!0)],34))}});var cEe=vt(lEe,[["__file","carousel.vue"]]);const uEe=gt({name:{type:String,default:""},label:{type:[String,Number],default:""}}),dEe=(e,t)=>{const o=wt(mK),i=In(),c=.83,u=ae(),f=ae(!1),p=ae(0),m=ae(1),_=ae(!1),b=ae(!1),S=ae(!1),T=ae(!1),{isCardType:M,isVertical:R}=o;function E(F,H,B){const z=B-1,W=H-1,Z=H+1,$=B/2;return H===0&&F===z?-1:H===z&&F===0?B:F<W&&H-F>=$?B+1:F>Z&&F-H>=$?-2:F}function N(F,H){var B,z;const W=y(R)?((B=o.root.value)==null?void 0:B.offsetHeight)||0:((z=o.root.value)==null?void 0:z.offsetWidth)||0;return S.value?W*((2-c)*(F-H)+1)/4:F<H?-(1+c)*W/4:(3+c)*W/4}function D(F,H,B){const z=o.root.value;return z?((B?z.offsetHeight:z.offsetWidth)||0)*(F-H):0}const x=(F,H,B)=>{var z;const W=y(M),Z=(z=o.items.value.length)!=null?z:Number.NaN,$=F===H;!W&&!_r(B)&&(T.value=$||F===B),!$&&Z>2&&o.loop&&(F=E(F,H,Z));const O=y(R);_.value=$,W?(S.value=Math.round(Math.abs(F-H))<=1,p.value=N(F,H),m.value=y(_)?1:c):p.value=D(F,H,O),b.value=!0,$&&u.value&&o.setContainerHeight(u.value.offsetHeight)};function L(){if(o&&y(M)){const F=o.items.value.findIndex(({uid:H})=>H===i.uid);o.setActiveItem(F)}}return fn(()=>{o.addItem({props:e,states:Zn({hover:f,translate:p,scale:m,active:_,ready:b,inStage:S,animating:T}),uid:i.uid,translateItem:x})}),Md(()=>{o.removeItem(i.uid)}),{carouselItemRef:u,active:_,animating:T,hover:f,inStage:S,isVertical:R,translate:p,isCardType:M,scale:m,ready:b,handleItemClick:L}},hEe=Se({name:"ElCarouselItem"}),fEe=Se({...hEe,props:uEe,setup(e){const t=e,o=lt("carousel"),{carouselItemRef:i,active:c,animating:u,hover:f,inStage:p,isVertical:m,translate:_,isCardType:b,scale:S,ready:T,handleItemClick:M}=dEe(t),R=K(()=>[o.e("item"),o.is("active",c.value),o.is("in-stage",p.value),o.is("hover",f.value),o.is("animating",u.value),{[o.em("item","card")]:b.value,[o.em("item","card-vertical")]:b.value&&m.value}]),E=K(()=>{const D=`${`translate${y(m)?"Y":"X"}`}(${y(_)}px)`,x=`scale(${y(S)})`;return{transform:[D,x].join(" ")}});return(N,D)=>hn((J(),ge("div",{ref_key:"carouselItemRef",ref:i,class:ne(y(R)),style:Ht(y(E)),onClick:D[0]||(D[0]=(...x)=>y(M)&&y(M)(...x))},[y(b)?hn((J(),ge("div",{key:0,class:ne(y(o).e("mask"))},null,2)),[[Jn,!y(c)]]):Fe("v-if",!0),We(N.$slots,"default")],6)),[[Jn,y(T)]])}});var vK=vt(fEe,[["__file","carousel-item.vue"]]);const pEe=bn(cEe,{CarouselItem:vK}),gEe=Wo(vK),_K={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:Nr,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...ti(["ariaControls"])},yK={[Mn]:e=>on(e)||Zt(e)||yr(e),change:e=>on(e)||Zt(e)||yr(e)},qm=Symbol("checkboxGroupContextKey"),mEe=({model:e,isChecked:t})=>{const o=wt(qm,void 0),i=K(()=>{var u,f;const p=(u=o==null?void 0:o.max)==null?void 0:u.value,m=(f=o==null?void 0:o.min)==null?void 0:f.value;return!_r(p)&&e.value.length>=p&&!t.value||!_r(m)&&e.value.length<=m&&t.value});return{isDisabled:zi(K(()=>(o==null?void 0:o.disabled.value)||i.value)),isLimitDisabled:i}},vEe=(e,{model:t,isLimitExceeded:o,hasOwnLabel:i,isDisabled:c,isLabeledByFormItem:u})=>{const f=wt(qm,void 0),{formItem:p}=Oi(),{emit:m}=In();function _(R){var E,N,D,x;return[!0,e.trueValue,e.trueLabel].includes(R)?(N=(E=e.trueValue)!=null?E:e.trueLabel)!=null?N:!0:(x=(D=e.falseValue)!=null?D:e.falseLabel)!=null?x:!1}function b(R,E){m("change",_(R),E)}function S(R){if(o.value)return;const E=R.target;m("change",_(E.checked),R)}async function T(R){o.value||!i.value&&!c.value&&u.value&&(R.composedPath().some(D=>D.tagName==="LABEL")||(t.value=_([!1,e.falseValue,e.falseLabel].includes(t.value)),await zt(),b(t.value,R)))}const M=K(()=>(f==null?void 0:f.validateEvent)||e.validateEvent);return rt(()=>e.modelValue,()=>{M.value&&(p==null||p.validate("change").catch(R=>void 0))}),{handleChange:S,onClickRoot:T}},_Ee=e=>{const t=ae(!1),{emit:o}=In(),i=wt(qm,void 0),c=K(()=>_r(i)===!1),u=ae(!1),f=K({get(){var p,m;return c.value?(p=i==null?void 0:i.modelValue)==null?void 0:p.value:(m=e.modelValue)!=null?m:t.value},set(p){var m,_;c.value&&At(p)?(u.value=((m=i==null?void 0:i.max)==null?void 0:m.value)!==void 0&&p.length>(i==null?void 0:i.max.value)&&p.length>f.value.length,u.value===!1&&((_=i==null?void 0:i.changeEvent)==null||_.call(i,p))):(o(Mn,p),t.value=p)}});return{model:f,isGroup:c,isLimitExceeded:u}},yEe=(e,t,{model:o})=>{const i=wt(qm,void 0),c=ae(!1),u=K(()=>Yf(e.value)?e.label:e.value),f=K(()=>{const b=o.value;return yr(b)?b:At(b)?En(u.value)?b.map(fo).some(S=>Ri(S,u.value)):b.map(fo).includes(u.value):b!=null?b===e.trueValue||b===e.trueLabel:!!b}),p=Tr(K(()=>{var b;return(b=i==null?void 0:i.size)==null?void 0:b.value}),{prop:!0}),m=Tr(K(()=>{var b;return(b=i==null?void 0:i.size)==null?void 0:b.value})),_=K(()=>!!t.default||!Yf(u.value));return{checkboxButtonSize:p,isChecked:f,isFocused:c,checkboxSize:m,hasOwnLabel:_,actualValue:u}},IK=(e,t)=>{const{formItem:o}=Oi(),{model:i,isGroup:c,isLimitExceeded:u}=_Ee(e),{isFocused:f,isChecked:p,checkboxButtonSize:m,checkboxSize:_,hasOwnLabel:b,actualValue:S}=yEe(e,t,{model:i}),{isDisabled:T}=mEe({model:i,isChecked:p}),{inputId:M,isLabeledByFormItem:R}=Va(e,{formItemContext:o,disableIdGeneration:b,disableIdManagement:c}),{handleChange:E,onClickRoot:N}=vEe(e,{model:i,isLimitExceeded:u,hasOwnLabel:b,isDisabled:T,isLabeledByFormItem:R});return(()=>{function x(){var L,F;At(i.value)&&!i.value.includes(S.value)?i.value.push(S.value):i.value=(F=(L=e.trueValue)!=null?L:e.trueLabel)!=null?F:!0}e.checked&&x()})(),$r({from:"controls",replacement:"aria-controls",version:"2.8.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},K(()=>!!e.controls)),$r({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},K(()=>c.value&&Yf(e.value))),$r({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},K(()=>!!e.trueLabel)),$r({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},K(()=>!!e.falseLabel)),{inputId:M,isLabeledByFormItem:R,isChecked:p,isDisabled:T,isFocused:f,checkboxButtonSize:m,checkboxSize:_,hasOwnLabel:b,model:i,actualValue:S,handleChange:E,onClickRoot:N}},IEe=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],bEe=["id","indeterminate","disabled","value","name","tabindex"],CEe=Se({name:"ElCheckbox"}),SEe=Se({...CEe,props:_K,emits:yK,setup(e){const t=e,o=zr(),{inputId:i,isLabeledByFormItem:c,isChecked:u,isDisabled:f,isFocused:p,checkboxSize:m,hasOwnLabel:_,model:b,actualValue:S,handleChange:T,onClickRoot:M}=IK(t,o),R=lt("checkbox"),E=K(()=>[R.b(),R.m(m.value),R.is("disabled",f.value),R.is("bordered",t.border),R.is("checked",u.value)]),N=K(()=>[R.e("input"),R.is("disabled",f.value),R.is("checked",u.value),R.is("indeterminate",t.indeterminate),R.is("focus",p.value)]);return(D,x)=>(J(),He(wn(!y(_)&&y(c)?"span":"label"),{class:ne(y(E)),"aria-controls":D.indeterminate?D.controls||D.ariaControls:null,onClick:y(M)},{default:Ne(()=>{var L,F;return[Ce("span",{class:ne(y(N))},[D.trueValue||D.falseValue||D.trueLabel||D.falseLabel?hn((J(),ge("input",{key:0,id:y(i),"onUpdate:modelValue":x[0]||(x[0]=H=>No(b)?b.value=H:null),class:ne(y(R).e("original")),type:"checkbox",indeterminate:D.indeterminate,name:D.name,tabindex:D.tabindex,disabled:y(f),"true-value":(L=D.trueValue)!=null?L:D.trueLabel,"false-value":(F=D.falseValue)!=null?F:D.falseLabel,onChange:x[1]||(x[1]=(...H)=>y(T)&&y(T)(...H)),onFocus:x[2]||(x[2]=H=>p.value=!0),onBlur:x[3]||(x[3]=H=>p.value=!1),onClick:x[4]||(x[4]=nn(()=>{},["stop"]))},null,42,IEe)),[[uE,y(b)]]):hn((J(),ge("input",{key:1,id:y(i),"onUpdate:modelValue":x[5]||(x[5]=H=>No(b)?b.value=H:null),class:ne(y(R).e("original")),type:"checkbox",indeterminate:D.indeterminate,disabled:y(f),value:y(S),name:D.name,tabindex:D.tabindex,onChange:x[6]||(x[6]=(...H)=>y(T)&&y(T)(...H)),onFocus:x[7]||(x[7]=H=>p.value=!0),onBlur:x[8]||(x[8]=H=>p.value=!1),onClick:x[9]||(x[9]=nn(()=>{},["stop"]))},null,42,bEe)),[[uE,y(b)]]),Ce("span",{class:ne(y(R).e("inner"))},null,2)],2),y(_)?(J(),ge("span",{key:0,class:ne(y(R).e("label"))},[We(D.$slots,"default"),D.$slots.default?Fe("v-if",!0):(J(),ge(qt,{key:0},[On(pt(D.label),1)],64))],2)):Fe("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var TEe=vt(SEe,[["__file","checkbox.vue"]]);const EEe=["name","tabindex","disabled","true-value","false-value"],MEe=["name","tabindex","disabled","value"],kEe=Se({name:"ElCheckboxButton"}),AEe=Se({...kEe,props:_K,emits:yK,setup(e){const t=e,o=zr(),{isFocused:i,isChecked:c,isDisabled:u,checkboxButtonSize:f,model:p,actualValue:m,handleChange:_}=IK(t,o),b=wt(qm,void 0),S=lt("checkbox"),T=K(()=>{var R,E,N,D;const x=(E=(R=b==null?void 0:b.fill)==null?void 0:R.value)!=null?E:"";return{backgroundColor:x,borderColor:x,color:(D=(N=b==null?void 0:b.textColor)==null?void 0:N.value)!=null?D:"",boxShadow:x?`-1px 0 0 0 ${x}`:void 0}}),M=K(()=>[S.b("button"),S.bm("button",f.value),S.is("disabled",u.value),S.is("checked",c.value),S.is("focus",i.value)]);return(R,E)=>{var N,D;return J(),ge("label",{class:ne(y(M))},[R.trueValue||R.falseValue||R.trueLabel||R.falseLabel?hn((J(),ge("input",{key:0,"onUpdate:modelValue":E[0]||(E[0]=x=>No(p)?p.value=x:null),class:ne(y(S).be("button","original")),type:"checkbox",name:R.name,tabindex:R.tabindex,disabled:y(u),"true-value":(N=R.trueValue)!=null?N:R.trueLabel,"false-value":(D=R.falseValue)!=null?D:R.falseLabel,onChange:E[1]||(E[1]=(...x)=>y(_)&&y(_)(...x)),onFocus:E[2]||(E[2]=x=>i.value=!0),onBlur:E[3]||(E[3]=x=>i.value=!1),onClick:E[4]||(E[4]=nn(()=>{},["stop"]))},null,42,EEe)),[[uE,y(p)]]):hn((J(),ge("input",{key:1,"onUpdate:modelValue":E[5]||(E[5]=x=>No(p)?p.value=x:null),class:ne(y(S).be("button","original")),type:"checkbox",name:R.name,tabindex:R.tabindex,disabled:y(u),value:y(m),onChange:E[6]||(E[6]=(...x)=>y(_)&&y(_)(...x)),onFocus:E[7]||(E[7]=x=>i.value=!0),onBlur:E[8]||(E[8]=x=>i.value=!1),onClick:E[9]||(E[9]=nn(()=>{},["stop"]))},null,42,MEe)),[[uE,y(p)]]),R.$slots.default||R.label?(J(),ge("span",{key:2,class:ne(y(S).be("button","inner")),style:Ht(y(c)?y(T):void 0)},[We(R.$slots,"default",{},()=>[On(pt(R.label),1)])],6)):Fe("v-if",!0)],2)}}});var bK=vt(AEe,[["__file","checkbox-button.vue"]]);const REe=gt({modelValue:{type:Le(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Nr,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...ti(["ariaLabel"])}),wEe={[Mn]:e=>At(e),change:e=>At(e)},DEe=Se({name:"ElCheckboxGroup"}),OEe=Se({...DEe,props:REe,emits:wEe,setup(e,{emit:t}){const o=e,i=lt("checkbox"),{formItem:c}=Oi(),{inputId:u,isLabeledByFormItem:f}=Va(o,{formItemContext:c}),p=async _=>{t(Mn,_),await zt(),t("change",_)},m=K({get(){return o.modelValue},set(_){p(_)}});return Ln(qm,{...Il(ei(o),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:m,changeEvent:p}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-checkbox-group",ref:"https://element-plus.org/en-US/component/checkbox.html"},K(()=>!!o.label)),rt(()=>o.modelValue,()=>{o.validateEvent&&(c==null||c.validate("change").catch(_=>void 0))}),(_,b)=>{var S;return J(),He(wn(_.tag),{id:y(u),class:ne(y(i).b("group")),role:"group","aria-label":y(f)?void 0:_.label||_.ariaLabel||"checkbox-group","aria-labelledby":y(f)?(S=y(c))==null?void 0:S.labelId:void 0},{default:Ne(()=>[We(_.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CK=vt(OEe,[["__file","checkbox-group.vue"]]);const aa=bn(TEe,{CheckboxButton:bK,CheckboxGroup:CK}),NEe=Wo(bK),SK=Wo(CK),TK=gt({modelValue:{type:[String,Number,Boolean],default:void 0},size:Nr,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),LEe=gt({...TK,border:Boolean}),EK={[Mn]:e=>on(e)||Zt(e)||yr(e),[Lo]:e=>on(e)||Zt(e)||yr(e)},MK=Symbol("radioGroupKey"),kK=(e,t)=>{const o=ae(),i=wt(MK,void 0),c=K(()=>!!i),u=K(()=>Yf(e.value)?e.label:e.value),f=K({get(){return c.value?i.modelValue:e.modelValue},set(S){c.value?i.changeEvent(S):t&&t(Mn,S),o.value.checked=e.modelValue===u.value}}),p=Tr(K(()=>i==null?void 0:i.size)),m=zi(K(()=>i==null?void 0:i.disabled)),_=ae(!1),b=K(()=>m.value||c.value&&f.value!==u.value?-1:0);return $r({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},K(()=>c.value&&Yf(e.value))),{radioRef:o,isGroup:c,radioGroup:i,focus:_,size:p,disabled:m,tabIndex:b,modelValue:f,actualValue:u}},PEe=["value","name","disabled"],UEe=Se({name:"ElRadio"}),xEe=Se({...UEe,props:LEe,emits:EK,setup(e,{emit:t}){const o=e,i=lt("radio"),{radioRef:c,radioGroup:u,focus:f,size:p,disabled:m,modelValue:_,actualValue:b}=kK(o,t);function S(){zt(()=>t("change",_.value))}return(T,M)=>{var R;return J(),ge("label",{class:ne([y(i).b(),y(i).is("disabled",y(m)),y(i).is("focus",y(f)),y(i).is("bordered",T.border),y(i).is("checked",y(_)===y(b)),y(i).m(y(p))])},[Ce("span",{class:ne([y(i).e("input"),y(i).is("disabled",y(m)),y(i).is("checked",y(_)===y(b))])},[hn(Ce("input",{ref_key:"radioRef",ref:c,"onUpdate:modelValue":M[0]||(M[0]=E=>No(_)?_.value=E:null),class:ne(y(i).e("original")),value:y(b),name:T.name||((R=y(u))==null?void 0:R.name),disabled:y(m),type:"radio",onFocus:M[1]||(M[1]=E=>f.value=!0),onBlur:M[2]||(M[2]=E=>f.value=!1),onChange:S,onClick:M[3]||(M[3]=nn(()=>{},["stop"]))},null,42,PEe),[[LH,y(_)]]),Ce("span",{class:ne(y(i).e("inner"))},null,2)],2),Ce("span",{class:ne(y(i).e("label")),onKeydown:M[4]||(M[4]=nn(()=>{},["stop"]))},[We(T.$slots,"default",{},()=>[On(pt(T.label),1)])],34)],2)}}});var FEe=vt(xEe,[["__file","radio.vue"]]);const VEe=gt({...TK}),GEe=["value","name","disabled"],BEe=Se({name:"ElRadioButton"}),$Ee=Se({...BEe,props:VEe,setup(e){const t=e,o=lt("radio"),{radioRef:i,focus:c,size:u,disabled:f,modelValue:p,radioGroup:m,actualValue:_}=kK(t),b=K(()=>({backgroundColor:(m==null?void 0:m.fill)||"",borderColor:(m==null?void 0:m.fill)||"",boxShadow:m!=null&&m.fill?`-1px 0 0 0 ${m.fill}`:"",color:(m==null?void 0:m.textColor)||""}));return(S,T)=>{var M;return J(),ge("label",{class:ne([y(o).b("button"),y(o).is("active",y(p)===y(_)),y(o).is("disabled",y(f)),y(o).is("focus",y(c)),y(o).bm("button",y(u))])},[hn(Ce("input",{ref_key:"radioRef",ref:i,"onUpdate:modelValue":T[0]||(T[0]=R=>No(p)?p.value=R:null),class:ne(y(o).be("button","original-radio")),value:y(_),type:"radio",name:S.name||((M=y(m))==null?void 0:M.name),disabled:y(f),onFocus:T[1]||(T[1]=R=>c.value=!0),onBlur:T[2]||(T[2]=R=>c.value=!1),onClick:T[3]||(T[3]=nn(()=>{},["stop"]))},null,42,GEe),[[LH,y(p)]]),Ce("span",{class:ne(y(o).be("button","inner")),style:Ht(y(p)===y(_)?y(b):{}),onKeydown:T[4]||(T[4]=nn(()=>{},["stop"]))},[We(S.$slots,"default",{},()=>[On(pt(S.label),1)])],38)],2)}}});var AK=vt($Ee,[["__file","radio-button.vue"]]);const HEe=gt({id:{type:String,default:void 0},size:Nr,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...ti(["ariaLabel"])}),qEe=EK,KEe=["id","aria-label","aria-labelledby"],zEe=Se({name:"ElRadioGroup"}),WEe=Se({...zEe,props:HEe,emits:qEe,setup(e,{emit:t}){const o=e,i=lt("radio"),c=pi(),u=ae(),{formItem:f}=Oi(),{inputId:p,isLabeledByFormItem:m}=Va(o,{formItemContext:f}),_=S=>{t(Mn,S),zt(()=>t("change",S))};fn(()=>{const S=u.value.querySelectorAll("[type=radio]"),T=S[0];!Array.from(S).some(M=>M.checked)&&T&&(T.tabIndex=0)});const b=K(()=>o.name||c.value);return Ln(MK,Zn({...ei(o),changeEvent:_,name:b})),rt(()=>o.modelValue,()=>{o.validateEvent&&(f==null||f.validate("change").catch(S=>void 0))}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-radio-group",ref:"https://element-plus.org/en-US/component/radio.html"},K(()=>!!o.label)),(S,T)=>(J(),ge("div",{id:y(p),ref_key:"radioGroupRef",ref:u,class:ne(y(i).b("group")),role:"radiogroup","aria-label":y(m)?void 0:S.label||S.ariaLabel||"radio-group","aria-labelledby":y(m)?y(f).labelId:void 0},[We(S.$slots,"default")],10,KEe))}});var RK=vt(WEe,[["__file","radio-group.vue"]]);const wK=bn(FEe,{RadioButton:AK,RadioGroup:RK}),jEe=Wo(RK),YEe=Wo(AK);var JEe=Se({name:"NodeContent",setup(){return{ns:lt("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:o}=this.$parent,{data:i,label:c}=t,{renderLabelFn:u}=o;return Wt("span",{class:e.e("label")},u?u({node:t,data:i}):c)}});const FL=Symbol(),XEe=Se({name:"ElCascaderNode",components:{ElCheckbox:aa,ElRadio:wK,NodeContent:JEe,ElIcon:Gt,Check:pI,Loading:Rd,ArrowRight:$i},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const o=wt(FL),i=lt("cascader-node"),c=K(()=>o.isHoverMenu),u=K(()=>o.config.multiple),f=K(()=>o.config.checkStrictly),p=K(()=>{var B;return(B=o.checkedNodes[0])==null?void 0:B.uid}),m=K(()=>e.node.isDisabled),_=K(()=>e.node.isLeaf),b=K(()=>f.value&&!_.value||!m.value),S=K(()=>M(o.expandingNode)),T=K(()=>f.value&&o.checkedNodes.some(M)),M=B=>{var z;const{level:W,uid:Z}=e.node;return((z=B==null?void 0:B.pathNodes[W-1])==null?void 0:z.uid)===Z},R=()=>{S.value||o.expandNode(e.node)},E=B=>{const{node:z}=e;B!==z.checked&&o.handleCheckChange(z,B)},N=()=>{o.lazyLoad(e.node,()=>{_.value||R()})},D=B=>{c.value&&(x(),!_.value&&t("expand",B))},x=()=>{const{node:B}=e;!b.value||B.loading||(B.loaded?R():N())},L=()=>{c.value&&!_.value||(_.value&&!m.value&&!f.value&&!u.value?H(!0):x())},F=B=>{f.value?(E(B),e.node.loaded&&R()):H(B)},H=B=>{e.node.loaded?(E(B),!f.value&&R()):N()};return{panel:o,isHoverMenu:c,multiple:u,checkStrictly:f,checkedNodeId:p,isDisabled:m,isLeaf:_,expandable:b,inExpandingPath:S,inCheckedPath:T,ns:i,handleHoverExpand:D,handleExpand:x,handleClick:L,handleCheck:H,handleSelectCheck:F}}}),QEe=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],ZEe=Ce("span",null,null,-1);function e1e(e,t,o,i,c,u){const f=pn("el-checkbox"),p=pn("el-radio"),m=pn("check"),_=pn("el-icon"),b=pn("node-content"),S=pn("loading"),T=pn("arrow-right");return J(),ge("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:ne([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:t[2]||(t[2]=(...M)=>e.handleHoverExpand&&e.handleHoverExpand(...M)),onFocus:t[3]||(t[3]=(...M)=>e.handleHoverExpand&&e.handleHoverExpand(...M)),onClick:t[4]||(t[4]=(...M)=>e.handleClick&&e.handleClick(...M))},[Fe(" prefix "),e.multiple?(J(),He(f,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:t[0]||(t[0]=nn(()=>{},["stop"])),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):e.checkStrictly?(J(),He(p,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:t[1]||(t[1]=nn(()=>{},["stop"]))},{default:Ne(()=>[Fe(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),ZEe]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):e.isLeaf&&e.node.checked?(J(),He(_,{key:2,class:ne(e.ns.e("prefix"))},{default:Ne(()=>[Me(m)]),_:1},8,["class"])):Fe("v-if",!0),Fe(" content "),Me(b),Fe(" postfix "),e.isLeaf?Fe("v-if",!0):(J(),ge(qt,{key:3},[e.node.loading?(J(),He(_,{key:0,class:ne([e.ns.is("loading"),e.ns.e("postfix")])},{default:Ne(()=>[Me(S)]),_:1},8,["class"])):(J(),He(_,{key:1,class:ne(["arrow-right",e.ns.e("postfix")])},{default:Ne(()=>[Me(T)]),_:1},8,["class"]))],64))],42,QEe)}var t1e=vt(XEe,[["render",e1e],["__file","node.vue"]]);const n1e=Se({name:"ElCascaderMenu",components:{Loading:Rd,ElIcon:Gt,ElScrollbar:xc,ElCascaderNode:t1e},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=In(),o=lt("cascader-menu"),{t:i}=Kn(),c=pi();let u=null,f=null;const p=wt(FL),m=ae(null),_=K(()=>!e.nodes.length),b=K(()=>!p.initialLoaded),S=K(()=>`${c.value}-${e.index}`),T=N=>{u=N.target},M=N=>{if(!(!p.isHoverMenu||!u||!m.value))if(u.contains(N.target)){R();const D=t.vnode.el,{left:x}=D.getBoundingClientRect(),{offsetWidth:L,offsetHeight:F}=D,H=N.clientX-x,B=u.offsetTop,z=B+u.offsetHeight;m.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${H} ${B} L${L} 0 V${B} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${H} ${z} L${L} ${F} V${z} Z" />
        `}else f||(f=window.setTimeout(E,p.config.hoverThreshold))},R=()=>{f&&(clearTimeout(f),f=null)},E=()=>{m.value&&(m.value.innerHTML="",R())};return{ns:o,panel:p,hoverZone:m,isEmpty:_,isLoading:b,menuId:S,t:i,handleExpand:T,handleMouseMove:M,clearHoverZone:E}}});function o1e(e,t,o,i,c,u){const f=pn("el-cascader-node"),p=pn("loading"),m=pn("el-icon"),_=pn("el-scrollbar");return J(),He(_,{key:e.menuId,tag:"ul",role:"menu",class:ne(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:Ne(()=>{var b;return[(J(!0),ge(qt,null,Vn(e.nodes,S=>(J(),He(f,{key:S.uid,node:S,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(J(),ge("div",{key:0,class:ne(e.ns.e("empty-text"))},[Me(m,{size:"14",class:ne(e.ns.is("loading"))},{default:Ne(()=>[Me(p)]),_:1},8,["class"]),On(" "+pt(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(J(),ge("div",{key:1,class:ne(e.ns.e("empty-text"))},pt(e.t("el.cascader.noData")),3)):(b=e.panel)!=null&&b.isHoverMenu?(J(),ge("svg",{key:2,ref:"hoverZone",class:ne(e.ns.e("hover-zone"))},null,2)):Fe("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var r1e=vt(n1e,[["render",o1e],["__file","menu.vue"]]);let i1e=0;const s1e=e=>{const t=[e];let{parent:o}=e;for(;o;)t.unshift(o),o=o.parent;return t};let IO=class bO{constructor(t,o,i,c=!1){this.data=t,this.config=o,this.parent=i,this.root=c,this.uid=i1e++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:u,label:f,children:p}=o,m=t[p],_=s1e(this);this.level=c?0:i?i.level+1:1,this.value=t[u],this.label=t[f],this.pathNodes=_,this.pathValues=_.map(b=>b.value),this.pathLabels=_.map(b=>b.label),this.childrenData=m,this.children=(m||[]).map(b=>new bO(b,o,this)),this.loaded=!o.lazy||this.isLeaf||!Ys(m)}get isDisabled(){const{data:t,parent:o,config:i}=this,{disabled:c,checkStrictly:u}=i;return(tn(c)?c(t,this):!!t[c])||!u&&(o==null?void 0:o.isDisabled)}get isLeaf(){const{data:t,config:o,childrenData:i,loaded:c}=this,{lazy:u,leaf:f}=o,p=tn(f)?f(t,this):t[f];return _r(p)?u&&!c?!1:!(Array.isArray(i)&&i.length):!!p}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:o,children:i}=this,c=new bO(t,this.config,this);return Array.isArray(o)?o.push(t):this.childrenData=[t],i.push(c),c}calcText(t,o){const i=t?this.pathLabels.join(o):this.label;return this.text=i,i}broadcast(t,...o){const i=`onParent${yl(t)}`;this.children.forEach(c=>{c&&(c.broadcast(t,...o),c[i]&&c[i](...o))})}emit(t,...o){const{parent:i}=this,c=`onChild${yl(t)}`;i&&(i[c]&&i[c](...o),i.emit(t,...o))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,o=t.filter(c=>!c.isDisabled),i=o.length?o.every(c=>c.checked):!1;this.setCheckState(i)}setCheckState(t){const o=this.children.length,i=this.children.reduce((c,u)=>{const f=u.checked?1:u.indeterminate?.5:0;return c+f},0);this.checked=this.loaded&&this.children.filter(c=>!c.isDisabled).every(c=>c.loaded&&c.checked)&&t,this.indeterminate=this.loaded&&i!==o&&i>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:o,multiple:i}=this.config;o||!i?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const CO=(e,t)=>e.reduce((o,i)=>(i.isLeaf?o.push(i):(!t&&o.push(i),o=o.concat(CO(i.children,t))),o),[]);class DB{constructor(t,o){this.config=o;const i=(t||[]).map(c=>new IO(c,this.config));this.nodes=i,this.allNodes=CO(i,!1),this.leafNodes=CO(i,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,o){const i=o?o.appendChild(t):new IO(t,this.config);o||this.nodes.push(i),this.allNodes.push(i),i.isLeaf&&this.leafNodes.push(i)}appendNodes(t,o){t.forEach(i=>this.appendNode(i,o))}getNodeByValue(t,o=!1){return!t&&t!==0?null:this.getFlattedNodes(o).find(c=>Ri(c.value,t)||Ri(c.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:i,level:c})=>Ri(t.value,i)&&t.level===c)||null}}const DK=gt({modelValue:{type:Le([Number,String,Array])},options:{type:Le(Array),default:()=>[]},props:{type:Le(Object),default:()=>({})}}),a1e={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:co,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},l1e=e=>K(()=>({...a1e,...e.props})),OB=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},c1e=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():B7(e)&&e.click()},u1e=(e,t)=>{const o=t.slice(0),i=o.map(u=>u.uid),c=e.reduce((u,f)=>{const p=i.indexOf(f.uid);return p>-1&&(u.push(f),o.splice(p,1),i.splice(p,1)),u},[]);return c.push(...o),c},d1e=Se({name:"ElCascaderPanel",components:{ElCascaderMenu:r1e},props:{...DK,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Mn,Lo,"close","expand-change"],setup(e,{emit:t,slots:o}){let i=!1;const c=lt("cascader"),u=l1e(e);let f=null;const p=ae(!0),m=ae([]),_=ae(null),b=ae([]),S=ae(null),T=ae([]),M=K(()=>u.value.expandTrigger==="hover"),R=K(()=>e.renderLabel||o.default),E=()=>{const{options:X}=e,le=u.value;i=!1,f=new DB(X,le),b.value=[f.getNodes()],le.lazy&&Ys(e.options)?(p.value=!1,N(void 0,de=>{de&&(f=new DB(de,le),b.value=[f.getNodes()]),p.value=!0,W(!1,!0)})):W(!1,!0)},N=(X,le)=>{const de=u.value;X=X||new IO({},de,void 0,!0),X.loading=!0;const he=se=>{const ie=X,oe=ie.root?null:ie;se&&(f==null||f.appendNodes(se,oe)),ie.loading=!1,ie.loaded=!0,ie.childrenData=ie.childrenData||[],le&&le(se)};de.lazyLoad(X,he)},D=(X,le)=>{var de;const{level:he}=X,se=b.value.slice(0,he);let ie;X.isLeaf?ie=X.pathNodes[he-2]:(ie=X,se.push(X.children)),((de=S.value)==null?void 0:de.uid)!==(ie==null?void 0:ie.uid)&&(S.value=X,b.value=se,!le&&t("expand-change",(X==null?void 0:X.pathValues)||[]))},x=(X,le,de=!0)=>{const{checkStrictly:he,multiple:se}=u.value,ie=T.value[0];i=!0,!se&&(ie==null||ie.doCheck(!1)),X.doCheck(le),z(),de&&!se&&!he&&t("close"),!de&&!se&&!he&&L(X)},L=X=>{X&&(X=X.parent,L(X),X&&D(X))},F=X=>f==null?void 0:f.getFlattedNodes(X),H=X=>{var le;return(le=F(X))==null?void 0:le.filter(de=>de.checked!==!1)},B=()=>{T.value.forEach(X=>X.doCheck(!1)),z(),b.value=b.value.slice(0,1),S.value=null,t("expand-change",[])},z=()=>{var X;const{checkStrictly:le,multiple:de}=u.value,he=T.value,se=H(!le),ie=u1e(he,se),oe=ie.map(ee=>ee.valueByOption);T.value=ie,_.value=de?oe:(X=oe[0])!=null?X:null},W=(X=!1,le=!1)=>{const{modelValue:de}=e,{lazy:he,multiple:se,checkStrictly:ie}=u.value,oe=!ie;if(!(!p.value||i||!le&&Ri(de,_.value)))if(he&&!X){const Q=w8(rve(Cs(de))).map(ue=>f==null?void 0:f.getNodeByValue(ue)).filter(ue=>!!ue&&!ue.loaded&&!ue.loading);Q.length?Q.forEach(ue=>{N(ue,()=>W(!1,le))}):W(!0,le)}else{const ee=se?Cs(de):[de],Q=w8(ee.map(ue=>f==null?void 0:f.getNodeByValue(ue,oe)));Z(Q,le),_.value=IE(de)}},Z=(X,le=!0)=>{const{checkStrictly:de}=u.value,he=T.value,se=X.filter(ee=>!!ee&&(de||ee.isLeaf)),ie=f==null?void 0:f.getSameNode(S.value),oe=le&&ie||se[0];oe?oe.pathNodes.forEach(ee=>D(ee,!0)):S.value=null,he.forEach(ee=>ee.doCheck(!1)),Zn(se).forEach(ee=>ee.doCheck(!0)),T.value=se,zt($)},$=()=>{$n&&m.value.forEach(X=>{const le=X==null?void 0:X.$el;if(le){const de=le.querySelector(`.${c.namespace.value}-scrollbar__wrap`),he=le.querySelector(`.${c.b("node")}.${c.is("active")}`)||le.querySelector(`.${c.b("node")}.in-active-path`);xq(de,he)}})},O=X=>{const le=X.target,{code:de}=X;switch(de){case Yt.up:case Yt.down:{X.preventDefault();const he=de===Yt.up?-1:1;OT($7(le,he,`.${c.b("node")}[tabindex="-1"]`));break}case Yt.left:{X.preventDefault();const he=m.value[OB(le)-1],se=he==null?void 0:he.$el.querySelector(`.${c.b("node")}[aria-expanded="true"]`);OT(se);break}case Yt.right:{X.preventDefault();const he=m.value[OB(le)+1],se=he==null?void 0:he.$el.querySelector(`.${c.b("node")}[tabindex="-1"]`);OT(se);break}case Yt.enter:c1e(le);break}};return Ln(FL,Zn({config:u,expandingNode:S,checkedNodes:T,isHoverMenu:M,initialLoaded:p,renderLabelFn:R,lazyLoad:N,expandNode:D,handleCheckChange:x})),rt([u,()=>e.options],E,{deep:!0,immediate:!0}),rt(()=>e.modelValue,()=>{i=!1,W()},{deep:!0}),rt(()=>_.value,X=>{Ri(X,e.modelValue)||(t(Mn,X),t(Lo,X))}),iH(()=>m.value=[]),fn(()=>!Ys(e.modelValue)&&W()),{ns:c,menuList:m,menus:b,checkedNodes:T,handleKeyDown:O,handleCheckChange:x,getFlattedNodes:F,getCheckedNodes:H,clearCheckedNodes:B,calculateCheckedValue:z,scrollToExpandingNode:$}}});function h1e(e,t,o,i,c,u){const f=pn("el-cascader-menu");return J(),ge("div",{class:ne([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:t[0]||(t[0]=(...p)=>e.handleKeyDown&&e.handleKeyDown(...p))},[(J(!0),ge(qt,null,Vn(e.menus,(p,m)=>(J(),He(f,{key:m,ref_for:!0,ref:_=>e.menuList[m]=_,index:m,nodes:[...p]},null,8,["index","nodes"]))),128))],34)}var GT=vt(d1e,[["render",h1e],["__file","index.vue"]]);GT.install=e=>{e.component(GT.name,GT)};const OK=GT,f1e=OK,v1=gt({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Al},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),p1e={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},g1e=Se({name:"ElTag"}),m1e=Se({...g1e,props:v1,emits:p1e,setup(e,{emit:t}){const o=e,i=Tr(),c=lt("tag"),u=K(()=>{const{type:m,hit:_,effect:b,closable:S,round:T}=o;return[c.b(),c.is("closable",S),c.m(m||"primary"),c.m(i.value),c.m(b),c.is("hit",_),c.is("round",T)]}),f=m=>{t("close",m)},p=m=>{t("click",m)};return(m,_)=>m.disableTransitions?(J(),ge("span",{key:0,class:ne(y(u)),style:Ht({backgroundColor:m.color}),onClick:p},[Ce("span",{class:ne(y(c).e("content"))},[We(m.$slots,"default")],2),m.closable?(J(),He(y(Gt),{key:0,class:ne(y(c).e("close")),onClick:nn(f,["stop"])},{default:Ne(()=>[Me(y(La))]),_:1},8,["class","onClick"])):Fe("v-if",!0)],6)):(J(),He(Rr,{key:1,name:`${y(c).namespace.value}-zoom-in-center`,appear:""},{default:Ne(()=>[Ce("span",{class:ne(y(u)),style:Ht({backgroundColor:m.color}),onClick:p},[Ce("span",{class:ne(y(c).e("content"))},[We(m.$slots,"default")],2),m.closable?(J(),He(y(Gt),{key:0,class:ne(y(c).e("close")),onClick:nn(f,["stop"])},{default:Ne(()=>[Me(y(La))]),_:1},8,["class","onClick"])):Fe("v-if",!0)],6)]),_:3},8,["name"]))}});var v1e=vt(m1e,[["__file","tag.vue"]]);const z0=bn(v1e),_1e=gt({...DK,size:Nr,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Le(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Le(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:Gr.teleported,tagType:{...v1.type,default:"info"},validateEvent:{type:Boolean,default:!0},...Hm}),y1e={[Mn]:e=>!0,[Lo]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,visibleChange:e=>yr(e),expandChange:e=>!!e,removeTag:e=>!!e},I1e={key:0},b1e=["placeholder","onKeydown"],C1e=["onClick"],S1e="ElCascader",T1e=Se({name:S1e}),E1e=Se({...T1e,props:_1e,emits:y1e,setup(e,{expose:t,emit:o}){const i=e,c={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:Ke})=>{const{modifiersData:Xe,placement:Dt}=Ke;["right","left","bottom","top"].includes(Dt)||(Xe.arrow.x=35)},requires:["arrow"]}]},u=tp();let f=0,p=0;const m=lt("cascader"),_=lt("input"),{t:b}=Kn(),{form:S,formItem:T}=Oi(),{valueOnClear:M}=f1(i),R=ae(null),E=ae(null),N=ae(null),D=ae(null),x=ae(null),L=ae(!1),F=ae(!1),H=ae(!1),B=ae(!1),z=ae(""),W=ae(""),Z=ae([]),$=ae([]),O=ae([]),X=ae(!1),le=K(()=>u.style),de=K(()=>i.disabled||(S==null?void 0:S.disabled)),he=K(()=>i.placeholder||b("el.cascader.placeholder")),se=K(()=>W.value||Z.value.length>0||X.value?"":he.value),ie=Tr(),oe=K(()=>["small"].includes(ie.value)?"small":"default"),ee=K(()=>!!i.props.multiple),Q=K(()=>!i.filterable||ee.value),ue=K(()=>ee.value?W.value:z.value),me=K(()=>{var Ke;return((Ke=D.value)==null?void 0:Ke.checkedNodes)||[]}),be=K(()=>!i.clearable||de.value||H.value||!F.value?!1:!!me.value.length),ke=K(()=>{const{showAllLevels:Ke,separator:Xe}=i,Dt=me.value;return Dt.length?ee.value?"":Dt[0].calcText(Ke,Xe):""}),Ye=K(()=>(T==null?void 0:T.validateState)||""),Oe=K({get(){return IE(i.modelValue)},set(Ke){const Xe=Ke||M.value;o(Mn,Xe),o(Lo,Xe),i.validateEvent&&(T==null||T.validate("change").catch(Dt=>void 0))}}),Ee=K(()=>[m.b(),m.m(ie.value),m.is("disabled",de.value),u.class]),we=K(()=>[_.e("icon"),"icon-arrow-down",m.is("reverse",L.value)]),Ge=K(()=>m.is("focus",L.value||B.value)),Ve=K(()=>{var Ke,Xe;return(Xe=(Ke=R.value)==null?void 0:Ke.popperRef)==null?void 0:Xe.contentRef}),qe=Ke=>{var Xe,Dt,$e;de.value||(Ke=Ke??!L.value,Ke!==L.value&&(L.value=Ke,(Dt=(Xe=E.value)==null?void 0:Xe.input)==null||Dt.setAttribute("aria-expanded",`${Ke}`),Ke?(st(),zt(($e=D.value)==null?void 0:$e.scrollToExpandingNode)):i.filterable&&et(),o("visibleChange",Ke)))},st=()=>{zt(()=>{var Ke;(Ke=R.value)==null||Ke.updatePopper()})},Ie=()=>{H.value=!1},Ae=Ke=>{const{showAllLevels:Xe,separator:Dt}=i;return{node:Ke,key:Ke.uid,text:Ke.calcText(Xe,Dt),hitState:!1,closable:!de.value&&!Ke.isDisabled,isCollapseTag:!1}},xe=Ke=>{var Xe;const Dt=Ke.node;Dt.doCheck(!1),(Xe=D.value)==null||Xe.calculateCheckedValue(),o("removeTag",Dt.valueByOption)},ot=()=>{if(!ee.value)return;const Ke=me.value,Xe=[],Dt=[];if(Ke.forEach($e=>Dt.push(Ae($e))),$.value=Dt,Ke.length){Ke.slice(0,i.maxCollapseTags).forEach(jt=>Xe.push(Ae(jt)));const $e=Ke.slice(i.maxCollapseTags),xt=$e.length;xt&&(i.collapseTags?Xe.push({key:-1,text:`+ ${xt}`,closable:!1,isCollapseTag:!0}):$e.forEach(jt=>Xe.push(Ae(jt))))}Z.value=Xe},je=()=>{var Ke,Xe;const{filterMethod:Dt,showAllLevels:$e,separator:xt}=i,jt=(Xe=(Ke=D.value)==null?void 0:Ke.getFlattedNodes(!i.props.checkStrictly))==null?void 0:Xe.filter(Fn=>Fn.isDisabled?!1:(Fn.calcText($e,xt),Dt(Fn,ue.value)));ee.value&&(Z.value.forEach(Fn=>{Fn.hitState=!1}),$.value.forEach(Fn=>{Fn.hitState=!1})),H.value=!0,O.value=jt,st()},at=()=>{var Ke;let Xe;H.value&&x.value?Xe=x.value.$el.querySelector(`.${m.e("suggestion-item")}`):Xe=(Ke=D.value)==null?void 0:Ke.$el.querySelector(`.${m.b("node")}[tabindex="-1"]`),Xe&&(Xe.focus(),!H.value&&Xe.click())},ht=()=>{var Ke,Xe;const Dt=(Ke=E.value)==null?void 0:Ke.input,$e=N.value,xt=(Xe=x.value)==null?void 0:Xe.$el;if(!(!$n||!Dt)){if(xt){const jt=xt.querySelector(`.${m.e("suggestion-list")}`);jt.style.minWidth=`${Dt.offsetWidth}px`}if($e){const{offsetHeight:jt}=$e,Fn=Z.value.length>0?`${Math.max(jt+6,f)}px`:`${f}px`;Dt.style.height=Fn,st()}}},dt=Ke=>{var Xe;return(Xe=D.value)==null?void 0:Xe.getCheckedNodes(Ke)},ft=Ke=>{st(),o("expandChange",Ke)},Je=Ke=>{var Xe;const Dt=(Xe=Ke.target)==null?void 0:Xe.value;if(Ke.type==="compositionend")X.value=!1,zt(()=>It(Dt));else{const $e=Dt[Dt.length-1]||"";X.value=!lL($e)}},Et=Ke=>{if(!X.value)switch(Ke.code){case Yt.enter:qe();break;case Yt.down:qe(!0),zt(at),Ke.preventDefault();break;case Yt.esc:L.value===!0&&(Ke.preventDefault(),Ke.stopPropagation(),qe(!1));break;case Yt.tab:qe(!1);break}},Nt=()=>{var Ke;(Ke=D.value)==null||Ke.clearCheckedNodes(),!L.value&&i.filterable&&et(),qe(!1)},et=()=>{const{value:Ke}=ke;z.value=Ke,W.value=Ke},Mt=Ke=>{var Xe,Dt;const{checked:$e}=Ke;ee.value?(Xe=D.value)==null||Xe.handleCheckChange(Ke,!$e,!1):(!$e&&((Dt=D.value)==null||Dt.handleCheckChange(Ke,!0,!1)),qe(!1))},Jt=Ke=>{const Xe=Ke.target,{code:Dt}=Ke;switch(Dt){case Yt.up:case Yt.down:{const $e=Dt===Yt.up?-1:1;OT($7(Xe,$e,`.${m.e("suggestion-item")}[tabindex="-1"]`));break}case Yt.enter:Xe.click();break}},sn=()=>{const Ke=Z.value,Xe=Ke[Ke.length-1];p=W.value?0:p+1,!(!Xe||!p||i.collapseTags&&Ke.length>1)&&(Xe.hitState?xe(Xe):Xe.hitState=!0)},gn=Ke=>{const Xe=Ke.target,Dt=m.e("search-input");Xe.className===Dt&&(B.value=!0),o("focus",Ke)},Bt=Ke=>{B.value=!1,o("blur",Ke)},nt=as(()=>{const{value:Ke}=ue;if(!Ke)return;const Xe=i.beforeFilter(Ke);b0(Xe)?Xe.then(je).catch(()=>{}):Xe!==!1?je():Ie()},i.debounce),It=(Ke,Xe)=>{!L.value&&qe(!0),!(Xe!=null&&Xe.isComposing)&&(Ke?nt():Ie())},ct=Ke=>Number.parseFloat(Ode(_.cssVarName("input-height"),Ke).value)-2;return rt(H,st),rt([me,de],ot),rt(Z,()=>{zt(()=>ht())}),rt(ie,async()=>{await zt();const Ke=E.value.input;f=ct(Ke)||f,ht()}),rt(ke,et,{immediate:!0}),fn(()=>{const Ke=E.value.input,Xe=ct(Ke);f=Ke.offsetHeight||Xe,Ko(Ke,ht)}),t({getCheckedNodes:dt,cascaderPanelRef:D,togglePopperVisible:qe,contentRef:Ve}),(Ke,Xe)=>(J(),He(y(Di),{ref_key:"tooltipRef",ref:R,visible:L.value,teleported:Ke.teleported,"popper-class":[y(m).e("dropdown"),Ke.popperClass],"popper-options":c,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${y(m).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Ie},{default:Ne(()=>[hn((J(),ge("div",{class:ne(y(Ee)),style:Ht(y(le)),onClick:Xe[5]||(Xe[5]=()=>qe(y(Q)?void 0:!0)),onKeydown:Et,onMouseenter:Xe[6]||(Xe[6]=Dt=>F.value=!0),onMouseleave:Xe[7]||(Xe[7]=Dt=>F.value=!1)},[Me(y(Ai),{ref_key:"input",ref:E,modelValue:z.value,"onUpdate:modelValue":Xe[1]||(Xe[1]=Dt=>z.value=Dt),placeholder:y(se),readonly:y(Q),disabled:y(de),"validate-event":!1,size:y(ie),class:ne(y(Ge)),tabindex:y(ee)&&Ke.filterable&&!y(de)?-1:void 0,onCompositionstart:Je,onCompositionupdate:Je,onCompositionend:Je,onFocus:gn,onBlur:Bt,onInput:It},{suffix:Ne(()=>[y(be)?(J(),He(y(Gt),{key:"clear",class:ne([y(_).e("icon"),"icon-circle-close"]),onClick:nn(Nt,["stop"])},{default:Ne(()=>[Me(y(Ad))]),_:1},8,["class","onClick"])):(J(),He(y(Gt),{key:"arrow-down",class:ne(y(we)),onClick:Xe[0]||(Xe[0]=nn(Dt=>qe(),["stop"]))},{default:Ne(()=>[Me(y(Pc))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),y(ee)?(J(),ge("div",{key:0,ref_key:"tagWrapper",ref:N,class:ne([y(m).e("tags"),y(m).is("validate",!!y(Ye))])},[(J(!0),ge(qt,null,Vn(Z.value,Dt=>(J(),He(y(z0),{key:Dt.key,type:Ke.tagType,size:y(oe),hit:Dt.hitState,closable:Dt.closable,"disable-transitions":"",onClose:$e=>xe(Dt)},{default:Ne(()=>[Dt.isCollapseTag===!1?(J(),ge("span",I1e,pt(Dt.text),1)):(J(),He(y(Di),{key:1,disabled:L.value||!Ke.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:Ne(()=>[Ce("span",null,pt(Dt.text),1)]),content:Ne(()=>[Ce("div",{class:ne(y(m).e("collapse-tags"))},[(J(!0),ge(qt,null,Vn($.value.slice(Ke.maxCollapseTags),($e,xt)=>(J(),ge("div",{key:xt,class:ne(y(m).e("collapse-tag"))},[(J(),He(y(z0),{key:$e.key,class:"in-tooltip",type:Ke.tagType,size:y(oe),hit:$e.hitState,closable:$e.closable,"disable-transitions":"",onClose:jt=>xe($e)},{default:Ne(()=>[Ce("span",null,pt($e.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),Ke.filterable&&!y(de)?hn((J(),ge("input",{key:0,"onUpdate:modelValue":Xe[2]||(Xe[2]=Dt=>W.value=Dt),type:"text",class:ne(y(m).e("search-input")),placeholder:y(ke)?"":y(he),onInput:Xe[3]||(Xe[3]=Dt=>It(W.value,Dt)),onClick:Xe[4]||(Xe[4]=nn(Dt=>qe(!0),["stop"])),onKeydown:go(sn,["delete"]),onCompositionstart:Je,onCompositionupdate:Je,onCompositionend:Je,onFocus:gn,onBlur:Bt},null,42,b1e)),[[IN,W.value]]):Fe("v-if",!0)],2)):Fe("v-if",!0)],38)),[[y(wc),()=>qe(!1),y(Ve)]])]),content:Ne(()=>[hn(Me(y(OK),{ref_key:"cascaderPanelRef",ref:D,modelValue:y(Oe),"onUpdate:modelValue":Xe[8]||(Xe[8]=Dt=>No(Oe)?Oe.value=Dt:null),options:Ke.options,props:i.props,border:!1,"render-label":Ke.$slots.default,onExpandChange:ft,onClose:Xe[9]||(Xe[9]=Dt=>Ke.$nextTick(()=>qe(!1)))},null,8,["modelValue","options","props","render-label"]),[[Jn,!H.value]]),Ke.filterable?hn((J(),He(y(xc),{key:0,ref_key:"suggestionPanel",ref:x,tag:"ul",class:ne(y(m).e("suggestion-panel")),"view-class":y(m).e("suggestion-list"),onKeydown:Jt},{default:Ne(()=>[O.value.length?(J(!0),ge(qt,{key:0},Vn(O.value,Dt=>(J(),ge("li",{key:Dt.uid,class:ne([y(m).e("suggestion-item"),y(m).is("checked",Dt.checked)]),tabindex:-1,onClick:$e=>Mt(Dt)},[Ce("span",null,pt(Dt.text),1),Dt.checked?(J(),He(y(Gt),{key:0},{default:Ne(()=>[Me(y(pI))]),_:1})):Fe("v-if",!0)],10,C1e))),128)):We(Ke.$slots,"empty",{key:1},()=>[Ce("li",{class:ne(y(m).e("empty-text"))},pt(y(b)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Jn,H.value]]):Fe("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var BT=vt(E1e,[["__file","cascader.vue"]]);BT.install=e=>{e.component(BT.name,BT)};const M1e=BT,k1e=M1e,A1e=gt({checked:{type:Boolean,default:!1},type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),R1e={"update:checked":e=>yr(e),[Lo]:e=>yr(e)},w1e=Se({name:"ElCheckTag"}),D1e=Se({...w1e,props:A1e,emits:R1e,setup(e,{emit:t}){const o=e,i=lt("check-tag"),c=K(()=>[i.b(),i.is("checked",o.checked),i.m(o.type||"primary")]),u=()=>{const f=!o.checked;t(Lo,f),t("update:checked",f)};return(f,p)=>(J(),ge("span",{class:ne(y(c)),onClick:u},[We(f.$slots,"default")],2))}});var O1e=vt(D1e,[["__file","check-tag.vue"]]);const N1e=bn(O1e),NK=Symbol("rowContextKey"),L1e=["start","center","end","space-around","space-between","space-evenly"],P1e=["top","middle","bottom"],U1e=gt({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:L1e,default:"start"},align:{type:String,values:P1e}}),x1e=Se({name:"ElRow"}),F1e=Se({...x1e,props:U1e,setup(e){const t=e,o=lt("row"),i=K(()=>t.gutter);Ln(NK,{gutter:i});const c=K(()=>{const f={};return t.gutter&&(f.marginRight=f.marginLeft=`-${t.gutter/2}px`),f}),u=K(()=>[o.b(),o.is(`justify-${t.justify}`,t.justify!=="start"),o.is(`align-${t.align}`,!!t.align)]);return(f,p)=>(J(),He(wn(f.tag),{class:ne(y(u)),style:Ht(y(c))},{default:Ne(()=>[We(f.$slots,"default")]),_:3},8,["class","style"]))}});var V1e=vt(F1e,[["__file","row.vue"]]);const G1e=bn(V1e),B1e=gt({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Le([Number,Object]),default:()=>zo({})},sm:{type:Le([Number,Object]),default:()=>zo({})},md:{type:Le([Number,Object]),default:()=>zo({})},lg:{type:Le([Number,Object]),default:()=>zo({})},xl:{type:Le([Number,Object]),default:()=>zo({})}}),$1e=Se({name:"ElCol"}),H1e=Se({...$1e,props:B1e,setup(e){const t=e,{gutter:o}=wt(NK,{gutter:K(()=>0)}),i=lt("col"),c=K(()=>{const f={};return o.value&&(f.paddingLeft=f.paddingRight=`${o.value/2}px`),f}),u=K(()=>{const f=[];return["span","offset","pull","push"].forEach(_=>{const b=t[_];Zt(b)&&(_==="span"?f.push(i.b(`${t[_]}`)):b>0&&f.push(i.b(`${_}-${t[_]}`)))}),["xs","sm","md","lg","xl"].forEach(_=>{Zt(t[_])?f.push(i.b(`${_}-${t[_]}`)):En(t[_])&&Object.entries(t[_]).forEach(([b,S])=>{f.push(b!=="span"?i.b(`${_}-${b}-${S}`):i.b(`${_}-${S}`))})}),o.value&&f.push(i.is("guttered")),[i.b(),f]});return(f,p)=>(J(),He(wn(f.tag),{class:ne(y(u)),style:Ht(y(c))},{default:Ne(()=>[We(f.$slots,"default")]),_:3},8,["class","style"]))}});var q1e=vt(H1e,[["__file","col.vue"]]);const K1e=bn(q1e),NB=e=>Zt(e)||on(e)||At(e),z1e=gt({accordion:Boolean,modelValue:{type:Le([Array,String,Number]),default:()=>zo([])}}),W1e={[Mn]:NB,[Lo]:NB},LK=Symbol("collapseContextKey"),j1e=(e,t)=>{const o=ae(vd(e.modelValue)),i=u=>{o.value=u;const f=e.accordion?o.value[0]:o.value;t(Mn,f),t(Lo,f)},c=u=>{if(e.accordion)i([o.value[0]===u?"":u]);else{const f=[...o.value],p=f.indexOf(u);p>-1?f.splice(p,1):f.push(u),i(f)}};return rt(()=>e.modelValue,()=>o.value=vd(e.modelValue),{deep:!0}),Ln(LK,{activeNames:o,handleItemClick:c}),{activeNames:o,setActiveNames:i}},Y1e=()=>{const e=lt("collapse");return{rootKls:K(()=>e.b())}},J1e=Se({name:"ElCollapse"}),X1e=Se({...J1e,props:z1e,emits:W1e,setup(e,{expose:t,emit:o}){const i=e,{activeNames:c,setActiveNames:u}=j1e(i,o),{rootKls:f}=Y1e();return t({activeNames:c,setActiveNames:u}),(p,m)=>(J(),ge("div",{class:ne(y(f))},[We(p.$slots,"default")],2))}});var Q1e=vt(X1e,[["__file","collapse.vue"]]);const Z1e=Se({name:"ElCollapseTransition"}),eMe=Se({...Z1e,setup(e){const t=lt("collapse-transition"),o=c=>{c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom},i={beforeEnter(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.style.height&&(c.dataset.elExistsHeight=c.style.height),c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0},enter(c){requestAnimationFrame(()=>{c.dataset.oldOverflow=c.style.overflow,c.dataset.elExistsHeight?c.style.maxHeight=c.dataset.elExistsHeight:c.scrollHeight!==0?c.style.maxHeight=`${c.scrollHeight}px`:c.style.maxHeight=0,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom,c.style.overflow="hidden"})},afterEnter(c){c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow},enterCancelled(c){o(c)},beforeLeave(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.dataset.oldOverflow=c.style.overflow,c.style.maxHeight=`${c.scrollHeight}px`,c.style.overflow="hidden"},leave(c){c.scrollHeight!==0&&(c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0)},afterLeave(c){o(c)},leaveCancelled(c){o(c)}};return(c,u)=>(J(),He(Rr,Nn({name:y(t).b()},Xse(i)),{default:Ne(()=>[We(c.$slots,"default")]),_:3},16,["name"]))}});var $T=vt(eMe,[["__file","collapse-transition.vue"]]);$T.install=e=>{e.component($T.name,$T)};const _1=$T,tMe=_1,nMe=gt({title:{type:String,default:""},name:{type:Le([String,Number]),default:void 0},disabled:Boolean}),oMe=e=>{const t=wt(LK),{namespace:o}=lt("collapse"),i=ae(!1),c=ae(!1),u=bL(),f=K(()=>u.current++),p=K(()=>{var T;return(T=e.name)!=null?T:`${o.value}-id-${u.prefix}-${y(f)}`}),m=K(()=>t==null?void 0:t.activeNames.value.includes(y(p)));return{focusing:i,id:f,isActive:m,handleFocus:()=>{setTimeout(()=>{c.value?c.value=!1:i.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(p)),i.value=!1,c.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(p))}}},rMe=(e,{focusing:t,isActive:o,id:i})=>{const c=lt("collapse"),u=K(()=>[c.b("item"),c.is("active",y(o)),c.is("disabled",e.disabled)]),f=K(()=>[c.be("item","header"),c.is("active",y(o)),{focusing:y(t)&&!e.disabled}]),p=K(()=>[c.be("item","arrow"),c.is("active",y(o))]),m=K(()=>c.be("item","wrap")),_=K(()=>c.be("item","content")),b=K(()=>c.b(`content-${y(i)}`)),S=K(()=>c.b(`head-${y(i)}`));return{arrowKls:p,headKls:f,rootKls:u,itemWrapperKls:m,itemContentKls:_,scopedContentId:b,scopedHeadId:S}},iMe=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],sMe=["id","aria-hidden","aria-labelledby"],aMe=Se({name:"ElCollapseItem"}),lMe=Se({...aMe,props:nMe,setup(e,{expose:t}){const o=e,{focusing:i,id:c,isActive:u,handleFocus:f,handleHeaderClick:p,handleEnterClick:m}=oMe(o),{arrowKls:_,headKls:b,rootKls:S,itemWrapperKls:T,itemContentKls:M,scopedContentId:R,scopedHeadId:E}=rMe(o,{focusing:i,isActive:u,id:c});return t({isActive:u}),(N,D)=>(J(),ge("div",{class:ne(y(S))},[Ce("button",{id:y(E),class:ne(y(b)),"aria-expanded":y(u),"aria-controls":y(R),"aria-describedby":y(R),tabindex:N.disabled?-1:0,type:"button",onClick:D[0]||(D[0]=(...x)=>y(p)&&y(p)(...x)),onKeydown:D[1]||(D[1]=go(nn((...x)=>y(m)&&y(m)(...x),["stop","prevent"]),["space","enter"])),onFocus:D[2]||(D[2]=(...x)=>y(f)&&y(f)(...x)),onBlur:D[3]||(D[3]=x=>i.value=!1)},[We(N.$slots,"title",{},()=>[On(pt(N.title),1)]),Me(y(Gt),{class:ne(y(_))},{default:Ne(()=>[Me(y($i))]),_:1},8,["class"])],42,iMe),Me(y(_1),null,{default:Ne(()=>[hn(Ce("div",{id:y(R),role:"region",class:ne(y(T)),"aria-hidden":!y(u),"aria-labelledby":y(E)},[Ce("div",{class:ne(y(M))},[We(N.$slots,"default")],2)],10,sMe),[[Jn,y(u)]])]),_:3})],2))}});var PK=vt(lMe,[["__file","collapse-item.vue"]]);const cMe=bn(Q1e,{CollapseItem:PK}),uMe=Wo(PK),dMe=gt({color:{type:Le(Object),required:!0},vertical:{type:Boolean,default:!1}});let oD=!1;function W0(e,t){if(!$n)return;const o=function(u){var f;(f=t.drag)==null||f.call(t,u)},i=function(u){var f;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",i),document.onselectstart=null,document.ondragstart=null,oD=!1,(f=t.end)==null||f.call(t,u)},c=function(u){var f;oD||(u.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",i),document.addEventListener("touchmove",o),document.addEventListener("touchend",i),oD=!0,(f=t.start)==null||f.call(t,u))};e.addEventListener("mousedown",c),e.addEventListener("touchstart",c)}const hMe=e=>{const t=In(),o=Do(),i=Do();function c(f){f.target!==o.value&&u(f)}function u(f){if(!i.value||!o.value)return;const m=t.vnode.el.getBoundingClientRect(),{clientX:_,clientY:b}=xN(f);if(e.vertical){let S=b-m.top;S=Math.max(o.value.offsetHeight/2,S),S=Math.min(S,m.height-o.value.offsetHeight/2),e.color.set("alpha",Math.round((S-o.value.offsetHeight/2)/(m.height-o.value.offsetHeight)*100))}else{let S=_-m.left;S=Math.max(o.value.offsetWidth/2,S),S=Math.min(S,m.width-o.value.offsetWidth/2),e.color.set("alpha",Math.round((S-o.value.offsetWidth/2)/(m.width-o.value.offsetWidth)*100))}}return{thumb:o,bar:i,handleDrag:u,handleClick:c}},fMe=(e,{bar:t,thumb:o,handleDrag:i})=>{const c=In(),u=lt("color-alpha-slider"),f=ae(0),p=ae(0),m=ae();function _(){if(!o.value||e.vertical)return 0;const x=c.vnode.el,L=e.color.get("alpha");return x?Math.round(L*(x.offsetWidth-o.value.offsetWidth/2)/100):0}function b(){if(!o.value)return 0;const x=c.vnode.el;if(!e.vertical)return 0;const L=e.color.get("alpha");return x?Math.round(L*(x.offsetHeight-o.value.offsetHeight/2)/100):0}function S(){if(e.color&&e.color.value){const{r:x,g:L,b:F}=e.color.toRgb();return`linear-gradient(to right, rgba(${x}, ${L}, ${F}, 0) 0%, rgba(${x}, ${L}, ${F}, 1) 100%)`}return""}function T(){f.value=_(),p.value=b(),m.value=S()}fn(()=>{if(!t.value||!o.value)return;const x={drag:L=>{i(L)},end:L=>{i(L)}};W0(t.value,x),W0(o.value,x),T()}),rt(()=>e.color.get("alpha"),()=>T()),rt(()=>e.color.value,()=>T());const M=K(()=>[u.b(),u.is("vertical",e.vertical)]),R=K(()=>u.e("bar")),E=K(()=>u.e("thumb")),N=K(()=>({background:m.value})),D=K(()=>({left:Xo(f.value),top:Xo(p.value)}));return{rootKls:M,barKls:R,barStyle:N,thumbKls:E,thumbStyle:D,update:T}},pMe="ElColorAlphaSlider",gMe=Se({name:pMe}),mMe=Se({...gMe,props:dMe,setup(e,{expose:t}){const o=e,{bar:i,thumb:c,handleDrag:u,handleClick:f}=hMe(o),{rootKls:p,barKls:m,barStyle:_,thumbKls:b,thumbStyle:S,update:T}=fMe(o,{bar:i,thumb:c,handleDrag:u});return t({update:T,bar:i,thumb:c}),(M,R)=>(J(),ge("div",{class:ne(y(p))},[Ce("div",{ref_key:"bar",ref:i,class:ne(y(m)),style:Ht(y(_)),onClick:R[0]||(R[0]=(...E)=>y(f)&&y(f)(...E))},null,6),Ce("div",{ref_key:"thumb",ref:c,class:ne(y(b)),style:Ht(y(S))},null,6)],2))}});var vMe=vt(mMe,[["__file","alpha-slider.vue"]]);const _Me=Se({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=lt("color-hue-slider"),o=In(),i=ae(),c=ae(),u=ae(0),f=ae(0),p=K(()=>e.color.get("hue"));rt(()=>p.value,()=>{T()});function m(M){M.target!==i.value&&_(M)}function _(M){if(!c.value||!i.value)return;const E=o.vnode.el.getBoundingClientRect(),{clientX:N,clientY:D}=xN(M);let x;if(e.vertical){let L=D-E.top;L=Math.min(L,E.height-i.value.offsetHeight/2),L=Math.max(i.value.offsetHeight/2,L),x=Math.round((L-i.value.offsetHeight/2)/(E.height-i.value.offsetHeight)*360)}else{let L=N-E.left;L=Math.min(L,E.width-i.value.offsetWidth/2),L=Math.max(i.value.offsetWidth/2,L),x=Math.round((L-i.value.offsetWidth/2)/(E.width-i.value.offsetWidth)*360)}e.color.set("hue",x)}function b(){if(!i.value)return 0;const M=o.vnode.el;if(e.vertical)return 0;const R=e.color.get("hue");return M?Math.round(R*(M.offsetWidth-i.value.offsetWidth/2)/360):0}function S(){if(!i.value)return 0;const M=o.vnode.el;if(!e.vertical)return 0;const R=e.color.get("hue");return M?Math.round(R*(M.offsetHeight-i.value.offsetHeight/2)/360):0}function T(){u.value=b(),f.value=S()}return fn(()=>{if(!c.value||!i.value)return;const M={drag:R=>{_(R)},end:R=>{_(R)}};W0(c.value,M),W0(i.value,M),T()}),{bar:c,thumb:i,thumbLeft:u,thumbTop:f,hueValue:p,handleClick:m,update:T,ns:t}}});function yMe(e,t,o,i,c,u){return J(),ge("div",{class:ne([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ce("div",{ref:"bar",class:ne(e.ns.e("bar")),onClick:t[0]||(t[0]=(...f)=>e.handleClick&&e.handleClick(...f))},null,2),Ce("div",{ref:"thumb",class:ne(e.ns.e("thumb")),style:Ht({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var IMe=vt(_Me,[["render",yMe],["__file","hue-slider.vue"]]);const bMe=gt({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Nr,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},teleported:Gr.teleported,predefine:{type:Le(Array)},validateEvent:{type:Boolean,default:!0},...ti(["ariaLabel"])}),CMe={[Mn]:e=>on(e)||Hr(e),[Lo]:e=>on(e)||Hr(e),activeChange:e=>on(e)||Hr(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},UK=Symbol("colorPickerContextKey"),LB=function(e,t,o){return[e,t*o/((e=(2-t)*o)<1?e:2-e)||0,e/2]},SMe=function(e){return typeof e=="string"&&e.includes(".")&&Number.parseFloat(e)===1},TMe=function(e){return typeof e=="string"&&e.includes("%")},am=function(e,t){SMe(e)&&(e="100%");const o=TMe(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),o&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},PB={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},HT=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),o=e%16;return`${PB[t]||t}${PB[o]||o}`},UB=function({r:e,g:t,b:o}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+o)?"":`#${HT(e)}${HT(t)}${HT(o)}`},rD={A:10,B:11,C:12,D:13,E:14,F:15},hf=function(e){return e.length===2?(rD[e[0].toUpperCase()]||+e[0])*16+(rD[e[1].toUpperCase()]||+e[1]):rD[e[1].toUpperCase()]||+e[1]},EMe=function(e,t,o){t=t/100,o=o/100;let i=t;const c=Math.max(o,.01);o*=2,t*=o<=1?o:2-o,i*=c<=1?c:2-c;const u=(o+t)/2,f=o===0?2*i/(c+i):2*t/(o+t);return{h:e,s:f*100,v:u*100}},xB=(e,t,o)=>{e=am(e,255),t=am(t,255),o=am(o,255);const i=Math.max(e,t,o),c=Math.min(e,t,o);let u;const f=i,p=i-c,m=i===0?0:p/i;if(i===c)u=0;else{switch(i){case e:{u=(t-o)/p+(t<o?6:0);break}case t:{u=(o-e)/p+2;break}case o:{u=(e-t)/p+4;break}}u/=6}return{h:u*360,s:m*100,v:f*100}},$y=function(e,t,o){e=am(e,360)*6,t=am(t,100),o=am(o,100);const i=Math.floor(e),c=e-i,u=o*(1-t),f=o*(1-c*t),p=o*(1-(1-c)*t),m=i%6,_=[o,f,u,u,p,o][m],b=[p,o,o,f,u,u][m],S=[u,u,p,o,o,f][m];return{r:Math.round(_*255),g:Math.round(b*255),b:Math.round(S*255)}};class _0{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in t)qn(t,o)&&(this[o]=t[o]);t.value?this.fromString(t.value):this.doOnChange()}set(t,o){if(arguments.length===1&&typeof t=="object"){for(const i in t)qn(t,i)&&this.set(i,t[i]);return}this[`_${t}`]=o,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return $y(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(i,c,u)=>{this._hue=Math.max(0,Math.min(360,i)),this._saturation=Math.max(0,Math.min(100,c)),this._value=Math.max(0,Math.min(100,u)),this.doOnChange()};if(t.includes("hsl")){const i=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));if(i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3){const{h:c,s:u,v:f}=EMe(i[0],i[1],i[2]);o(c,u,f)}}else if(t.includes("hsv")){const i=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3&&o(i[0],i[1],i[2])}else if(t.includes("rgb")){const i=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));if(i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3){const{h:c,s:u,v:f}=xB(i[0],i[1],i[2]);o(c,u,f)}}else if(t.includes("#")){const i=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(i))return;let c,u,f;i.length===3?(c=hf(i[0]+i[0]),u=hf(i[1]+i[1]),f=hf(i[2]+i[2])):(i.length===6||i.length===8)&&(c=hf(i.slice(0,2)),u=hf(i.slice(2,4)),f=hf(i.slice(4,6))),i.length===8?this._alpha=hf(i.slice(6))/255*100:(i.length===3||i.length===6)&&(this._alpha=100);const{h:p,s:m,v:_}=xB(c,u,f);o(p,m,_)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:o,_value:i,_alpha:c,format:u}=this;if(this.enableAlpha)switch(u){case"hsl":{const f=LB(t,o/100,i/100);this.value=`hsla(${t}, ${Math.round(f[1]*100)}%, ${Math.round(f[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(o)}%, ${Math.round(i)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${UB($y(t,o,i))}${HT(c*255/100)}`;break}default:{const{r:f,g:p,b:m}=$y(t,o,i);this.value=`rgba(${f}, ${p}, ${m}, ${this.get("alpha")/100})`}}else switch(u){case"hsl":{const f=LB(t,o/100,i/100);this.value=`hsl(${t}, ${Math.round(f[1]*100)}%, ${Math.round(f[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(o)}%, ${Math.round(i)}%)`;break}case"rgb":{const{r:f,g:p,b:m}=$y(t,o,i);this.value=`rgb(${f}, ${p}, ${m})`;break}default:this.value=UB($y(t,o,i))}}}const MMe=Se({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(e){const t=lt("color-predefine"),{currentColor:o}=wt(UK),i=ae(u(e.colors,e.color));rt(()=>o.value,f=>{const p=new _0;p.fromString(f),i.value.forEach(m=>{m.selected=p.compare(m)})}),hi(()=>{i.value=u(e.colors,e.color)});function c(f){e.color.fromString(e.colors[f])}function u(f,p){return f.map(m=>{const _=new _0;return _.enableAlpha=!0,_.format="rgba",_.fromString(m),_.selected=_.value===p.value,_})}return{rgbaColors:i,handleSelect:c,ns:t}}}),kMe=["onClick"];function AMe(e,t,o,i,c,u){return J(),ge("div",{class:ne(e.ns.b())},[Ce("div",{class:ne(e.ns.e("colors"))},[(J(!0),ge(qt,null,Vn(e.rgbaColors,(f,p)=>(J(),ge("div",{key:e.colors[p],class:ne([e.ns.e("color-selector"),e.ns.is("alpha",f._alpha<100),{selected:f.selected}]),onClick:m=>e.handleSelect(p)},[Ce("div",{style:Ht({backgroundColor:f.value})},null,4)],10,kMe))),128))],2)],2)}var RMe=vt(MMe,[["render",AMe],["__file","predefine.vue"]]);const wMe=Se({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=lt("color-svpanel"),o=In(),i=ae(0),c=ae(0),u=ae("hsl(0, 100%, 50%)"),f=K(()=>{const _=e.color.get("hue"),b=e.color.get("value");return{hue:_,value:b}});function p(){const _=e.color.get("saturation"),b=e.color.get("value"),S=o.vnode.el,{clientWidth:T,clientHeight:M}=S;c.value=_*T/100,i.value=(100-b)*M/100,u.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function m(_){const S=o.vnode.el.getBoundingClientRect(),{clientX:T,clientY:M}=xN(_);let R=T-S.left,E=M-S.top;R=Math.max(0,R),R=Math.min(R,S.width),E=Math.max(0,E),E=Math.min(E,S.height),c.value=R,i.value=E,e.color.set({saturation:R/S.width*100,value:100-E/S.height*100})}return rt(()=>f.value,()=>{p()}),fn(()=>{W0(o.vnode.el,{drag:_=>{m(_)},end:_=>{m(_)}}),p()}),{cursorTop:i,cursorLeft:c,background:u,colorValue:f,handleDrag:m,update:p,ns:t}}}),DMe=Ce("div",null,null,-1),OMe=[DMe];function NMe(e,t,o,i,c,u){return J(),ge("div",{class:ne(e.ns.b()),style:Ht({backgroundColor:e.background})},[Ce("div",{class:ne(e.ns.e("white"))},null,2),Ce("div",{class:ne(e.ns.e("black"))},null,2),Ce("div",{class:ne(e.ns.e("cursor")),style:Ht({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},OMe,6)],6)}var LMe=vt(wMe,[["render",NMe],["__file","sv-panel.vue"]]);const PMe=["onKeydown"],UMe=["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex"],xMe=Se({name:"ElColorPicker"}),FMe=Se({...xMe,props:bMe,emits:CMe,setup(e,{expose:t,emit:o}){const i=e,{t:c}=Kn(),u=lt("color"),{formItem:f}=Oi(),p=Tr(),m=zi(),{inputId:_,isLabeledByFormItem:b}=Va(i,{formItemContext:f}),S=ae(),T=ae(),M=ae(),R=ae(),E=ae(),N=ae(),{isFocused:D,handleFocus:x,handleBlur:L}=h1(E,{beforeBlur(Ve){var qe;return(qe=R.value)==null?void 0:qe.isFocusInsideContent(Ve)},afterBlur(){se(!1),Q()}}),F=Ve=>{if(m.value)return Ge();x(Ve)};let H=!0;const B=Zn(new _0({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue})),z=ae(!1),W=ae(!1),Z=ae(""),$=K(()=>!i.modelValue&&!W.value?"transparent":he(B,i.showAlpha)),O=K(()=>!i.modelValue&&!W.value?"":B.value),X=K(()=>b.value?void 0:i.label||i.ariaLabel||c("el.colorpicker.defaultLabel"));$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-color-picker",ref:"https://element-plus.org/en-US/component/color-picker.html"},K(()=>!!i.label));const le=K(()=>b.value?f==null?void 0:f.labelId:void 0),de=K(()=>[u.b("picker"),u.is("disabled",m.value),u.bm("picker",p.value),u.is("focused",D.value)]);function he(Ve,qe){if(!(Ve instanceof _0))throw new TypeError("color should be instance of _color Class");const{r:st,g:Ie,b:Ae}=Ve.toRgb();return qe?`rgba(${st}, ${Ie}, ${Ae}, ${Ve.get("alpha")/100})`:`rgb(${st}, ${Ie}, ${Ae})`}function se(Ve){z.value=Ve}const ie=as(se,100,{leading:!0});function oe(){m.value||se(!0)}function ee(){ie(!1),Q()}function Q(){zt(()=>{i.modelValue?B.fromString(i.modelValue):(B.value="",zt(()=>{W.value=!1}))})}function ue(){m.value||ie(!z.value)}function me(){B.fromString(Z.value)}function be(){const Ve=B.value;o(Mn,Ve),o("change",Ve),i.validateEvent&&(f==null||f.validate("change").catch(qe=>void 0)),ie(!1),zt(()=>{const qe=new _0({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue});B.compare(qe)||Q()})}function ke(){ie(!1),o(Mn,null),o("change",null),i.modelValue!==null&&i.validateEvent&&(f==null||f.validate("change").catch(Ve=>void 0)),Q()}function Ye(Ve){if(z.value&&(ee(),D.value)){const qe=new FocusEvent("focus",Ve);L(qe)}}function Oe(Ve){Ve.preventDefault(),Ve.stopPropagation(),se(!1),Q()}function Ee(Ve){switch(Ve.code){case Yt.enter:case Yt.space:Ve.preventDefault(),Ve.stopPropagation(),oe(),N.value.focus();break;case Yt.esc:Oe(Ve);break}}function we(){E.value.focus()}function Ge(){E.value.blur()}return fn(()=>{i.modelValue&&(Z.value=O.value)}),rt(()=>i.modelValue,Ve=>{Ve?Ve&&Ve!==B.value&&(H=!1,B.fromString(Ve)):W.value=!1}),rt(()=>O.value,Ve=>{Z.value=Ve,H&&o("activeChange",Ve),H=!0}),rt(()=>B.value,()=>{!i.modelValue&&!W.value&&(W.value=!0)}),rt(()=>z.value,()=>{zt(()=>{var Ve,qe,st;(Ve=S.value)==null||Ve.update(),(qe=T.value)==null||qe.update(),(st=M.value)==null||st.update()})}),Ln(UK,{currentColor:O}),t({color:B,show:oe,hide:ee,focus:we,blur:Ge}),(Ve,qe)=>(J(),He(y(Di),{ref_key:"popper",ref:R,visible:z.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(u).be("picker","panel"),y(u).b("dropdown"),Ve.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Ve.teleported,transition:`${y(u).namespace.value}-zoom-in-top`,persistent:"",onHide:qe[2]||(qe[2]=st=>se(!1))},{content:Ne(()=>[hn((J(),ge("div",{onKeydown:go(Oe,["esc"])},[Ce("div",{class:ne(y(u).be("dropdown","main-wrapper"))},[Me(IMe,{ref_key:"hue",ref:S,class:"hue-slider",color:y(B),vertical:""},null,8,["color"]),Me(LMe,{ref_key:"sv",ref:T,color:y(B)},null,8,["color"])],2),Ve.showAlpha?(J(),He(vMe,{key:0,ref_key:"alpha",ref:M,color:y(B)},null,8,["color"])):Fe("v-if",!0),Ve.predefine?(J(),He(RMe,{key:1,ref:"predefine",color:y(B),colors:Ve.predefine},null,8,["color","colors"])):Fe("v-if",!0),Ce("div",{class:ne(y(u).be("dropdown","btns"))},[Ce("span",{class:ne(y(u).be("dropdown","value"))},[Me(y(Ai),{ref_key:"inputRef",ref:N,modelValue:Z.value,"onUpdate:modelValue":qe[0]||(qe[0]=st=>Z.value=st),"validate-event":!1,size:"small",onKeyup:go(me,["enter"]),onBlur:me},null,8,["modelValue","onKeyup"])],2),Me(y(qr),{class:ne(y(u).be("dropdown","link-btn")),text:"",size:"small",onClick:ke},{default:Ne(()=>[On(pt(y(c)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Me(y(qr),{plain:"",size:"small",class:ne(y(u).be("dropdown","btn")),onClick:be},{default:Ne(()=>[On(pt(y(c)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,PMe)),[[y(wc),Ye]])]),default:Ne(()=>[Ce("div",Nn({id:y(_),ref_key:"triggerRef",ref:E},Ve.$attrs,{class:y(de),role:"button","aria-label":y(X),"aria-labelledby":y(le),"aria-description":y(c)("el.colorpicker.description",{color:Ve.modelValue||""}),"aria-disabled":y(m),tabindex:y(m)?-1:Ve.tabindex,onKeydown:Ee,onFocus:F,onBlur:qe[1]||(qe[1]=(...st)=>y(L)&&y(L)(...st))}),[y(m)?(J(),ge("div",{key:0,class:ne(y(u).be("picker","mask"))},null,2)):Fe("v-if",!0),Ce("div",{class:ne(y(u).be("picker","trigger")),onClick:ue},[Ce("span",{class:ne([y(u).be("picker","color"),y(u).is("alpha",Ve.showAlpha)])},[Ce("span",{class:ne(y(u).be("picker","color-inner")),style:Ht({backgroundColor:y($)})},[hn(Me(y(Gt),{class:ne([y(u).be("picker","icon"),y(u).is("icon-arrow-down")])},{default:Ne(()=>[Me(y(Pc))]),_:1},8,["class"]),[[Jn,Ve.modelValue||W.value]]),hn(Me(y(Gt),{class:ne([y(u).be("picker","empty"),y(u).is("icon-close")])},{default:Ne(()=>[Me(y(La))]),_:1},8,["class"]),[[Jn,!Ve.modelValue&&!W.value]])],6)],2)],2)],16,UMe)]),_:1},8,["visible","popper-class","teleported","transition"]))}});var VMe=vt(FMe,[["__file","color-picker.vue"]]);const GMe=bn(VMe),BMe=Se({name:"ElContainer"}),$Me=Se({...BMe,props:{direction:{type:String}},setup(e){const t=e,o=zr(),i=lt("container"),c=K(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:o&&o.default?o.default().some(f=>{const p=f.type.name;return p==="ElHeader"||p==="ElFooter"}):!1);return(u,f)=>(J(),ge("section",{class:ne([y(i).b(),y(i).is("vertical",y(c))])},[We(u.$slots,"default")],2))}});var HMe=vt($Me,[["__file","container.vue"]]);const qMe=Se({name:"ElAside"}),KMe=Se({...qMe,props:{width:{type:String,default:null}},setup(e){const t=e,o=lt("aside"),i=K(()=>t.width?o.cssVarBlock({width:t.width}):{});return(c,u)=>(J(),ge("aside",{class:ne(y(o).b()),style:Ht(y(i))},[We(c.$slots,"default")],6))}});var xK=vt(KMe,[["__file","aside.vue"]]);const zMe=Se({name:"ElFooter"}),WMe=Se({...zMe,props:{height:{type:String,default:null}},setup(e){const t=e,o=lt("footer"),i=K(()=>t.height?o.cssVarBlock({height:t.height}):{});return(c,u)=>(J(),ge("footer",{class:ne(y(o).b()),style:Ht(y(i))},[We(c.$slots,"default")],6))}});var FK=vt(WMe,[["__file","footer.vue"]]);const jMe=Se({name:"ElHeader"}),YMe=Se({...jMe,props:{height:{type:String,default:null}},setup(e){const t=e,o=lt("header"),i=K(()=>t.height?o.cssVarBlock({height:t.height}):{});return(c,u)=>(J(),ge("header",{class:ne(y(o).b()),style:Ht(y(i))},[We(c.$slots,"default")],6))}});var VK=vt(YMe,[["__file","header.vue"]]);const JMe=Se({name:"ElMain"}),XMe=Se({...JMe,setup(e){const t=lt("main");return(o,i)=>(J(),ge("main",{class:ne(y(t).b())},[We(o.$slots,"default")],2))}});var GK=vt(XMe,[["__file","main.vue"]]);const QMe=bn(HMe,{Aside:xK,Footer:FK,Header:VK,Main:GK}),ZMe=Wo(xK),eke=Wo(FK),tke=Wo(VK),nke=Wo(GK);var BK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i){var c=i.prototype,u=c.format;c.format=function(f){var p=this,m=this.$locale();if(!this.isValid())return u.bind(this)(f);var _=this.$utils(),b=(f||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(S){switch(S){case"Q":return Math.ceil((p.$M+1)/3);case"Do":return m.ordinal(p.$D);case"gggg":return p.weekYear();case"GGGG":return p.isoWeekYear();case"wo":return m.ordinal(p.week(),"W");case"w":case"ww":return _.s(p.week(),S==="w"?1:2,"0");case"W":case"WW":return _.s(p.isoWeek(),S==="W"?1:2,"0");case"k":case"kk":return _.s(String(p.$H===0?24:p.$H),S==="k"?1:2,"0");case"X":return Math.floor(p.$d.getTime()/1e3);case"x":return p.$d.getTime();case"z":return"["+p.offsetName()+"]";case"zzz":return"["+p.offsetName("long")+"]";default:return S}});return u.bind(this)(b)}}})})(BK);var oke=BK.exports;const rke=la(oke);var $K={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){var o="week",i="year";return function(c,u,f){var p=u.prototype;p.week=function(m){if(m===void 0&&(m=null),m!==null)return this.add(7*(m-this.week()),"day");var _=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var b=f(this).startOf(i).add(1,i).date(_),S=f(this).endOf(o);if(b.isBefore(S))return 1}var T=f(this).startOf(i).date(_).startOf(o).subtract(1,"millisecond"),M=this.diff(T,o,!0);return M<0?f(this).startOf("week").week():Math.ceil(M)},p.weeks=function(m){return m===void 0&&(m=null),this.week(m)}}})})($K);var ike=$K.exports;const ske=la(ike);var HK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i){i.prototype.weekYear=function(){var c=this.month(),u=this.week(),f=this.year();return u===1&&c===11?f+1:c===0&&u>=52?f-1:f}}})})(HK);var ake=HK.exports;const lke=la(ake);var qK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i,c){i.prototype.dayOfYear=function(u){var f=Math.round((c(this).startOf("day")-c(this).startOf("year"))/864e5)+1;return u==null?f:this.add(u-f,"day")}}})})(qK);var cke=qK.exports;const uke=la(cke);var KK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i){i.prototype.isSameOrAfter=function(c,u){return this.isSame(c,u)||this.isAfter(c,u)}}})})(KK);var dke=KK.exports;const hke=la(dke);var zK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(ki,function(){return function(o,i){i.prototype.isSameOrBefore=function(c,u){return this.isSame(c,u)||this.isBefore(c,u)}}})})(zK);var fke=zK.exports;const pke=la(fke),VL=Symbol(),gke=gt({...xL,type:{type:Le(String),default:"date"}}),mke=["date","dates","year","years","month","week","range"],GL=gt({disabledDate:{type:Le(Function)},date:{type:Le(Object),required:!0},minDate:{type:Le(Object)},maxDate:{type:Le(Object)},parsedValue:{type:Le([Object,Array])},rangeState:{type:Le(Object),default:()=>({endDate:null,selecting:!1})}}),WK=gt({type:{type:Le(String),required:!0,values:x_e},dateFormat:String,timeFormat:String}),jK=gt({unlinkPanels:Boolean,parsedValue:{type:Le(Array)}}),BL=e=>({type:String,values:mke,default:e}),vke=gt({...WK,parsedValue:{type:Le([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),_ke=gt({...GL,cellClassName:{type:Le(Function)},showWeekNumber:Boolean,selectionMode:BL("date")}),yke=["changerange","pick","select"],SO=e=>{if(!At(e))return!1;const[t,o]=e;return Tn.isDayjs(t)&&Tn.isDayjs(o)&&t.isSameOrBefore(o)},YK=(e,{lang:t,unit:o,unlinkPanels:i})=>{let c;if(At(e)){let[u,f]=e.map(p=>Tn(p).locale(t));return i||(f=u.add(1,o)),[u,f]}else e?c=Tn(e):c=Tn();return c=c.locale(t),[c,c.add(1,o)]},Ike=(e,t,{columnIndexOffset:o,startDate:i,nextEndDate:c,now:u,unit:f,relativeDateGetter:p,setCellMetadata:m,setRowMetadata:_})=>{for(let b=0;b<e.row;b++){const S=t[b];for(let T=0;T<e.column;T++){let M=S[T+o];M||(M={row:b,column:T,type:"normal",inRange:!1,start:!1,end:!1});const R=b*e.column+T,E=p(R);M.dayjs=E,M.date=E.toDate(),M.timestamp=E.valueOf(),M.type="normal",M.inRange=!!(i&&E.isSameOrAfter(i,f)&&c&&E.isSameOrBefore(c,f))||!!(i&&E.isSameOrBefore(i,f)&&c&&E.isSameOrAfter(c,f)),i!=null&&i.isSameOrAfter(c)?(M.start=!!c&&E.isSame(c,f),M.end=i&&E.isSame(i,f)):(M.start=!!i&&E.isSame(i,f),M.end=!!c&&E.isSame(c,f)),E.isSame(u,f)&&(M.type="today"),m==null||m(M,{rowIndex:b,columnIndex:T}),S[T+o]=M}_==null||_(S)}},TO=(e="")=>["normal","today"].includes(e),bke=(e,t)=>{const{lang:o}=Kn(),i=ae(),c=ae(),u=ae(),f=ae(),p=ae([[],[],[],[],[],[]]);let m=!1;const _=e.date.$locale().weekStart||7,b=e.date.locale("en").localeData().weekdaysShort().map(ee=>ee.toLowerCase()),S=K(()=>_>3?7-_:-_),T=K(()=>{const ee=e.date.startOf("month");return ee.subtract(ee.day()||7,"day")}),M=K(()=>b.concat(b).slice(_,_+7)),R=K(()=>lq(y(F)).some(ee=>ee.isCurrent)),E=K(()=>{const ee=e.date.startOf("month"),Q=ee.day()||7,ue=ee.daysInMonth(),me=ee.subtract(1,"month").daysInMonth();return{startOfMonthDay:Q,dateCountOfMonth:ue,dateCountOfLastMonth:me}}),N=K(()=>e.selectionMode==="dates"?Cs(e.parsedValue):[]),D=(ee,{count:Q,rowIndex:ue,columnIndex:me})=>{const{startOfMonthDay:be,dateCountOfMonth:ke,dateCountOfLastMonth:Ye}=y(E),Oe=y(S);if(ue>=0&&ue<=1){const Ee=be+Oe<0?7+be+Oe:be+Oe;if(me+ue*7>=Ee)return ee.text=Q,!0;ee.text=Ye-(Ee-me%7)+1+ue*7,ee.type="prev-month"}else return Q<=ke?ee.text=Q:(ee.text=Q-ke,ee.type="next-month"),!0;return!1},x=(ee,{columnIndex:Q,rowIndex:ue},me)=>{const{disabledDate:be,cellClassName:ke}=e,Ye=y(N),Oe=D(ee,{count:me,rowIndex:ue,columnIndex:Q}),Ee=ee.dayjs.toDate();return ee.selected=Ye.find(we=>we.isSame(ee.dayjs,"day")),ee.isSelected=!!ee.selected,ee.isCurrent=B(ee),ee.disabled=be==null?void 0:be(Ee),ee.customClass=ke==null?void 0:ke(Ee),Oe},L=ee=>{if(e.selectionMode==="week"){const[Q,ue]=e.showWeekNumber?[1,7]:[0,6],me=oe(ee[Q+1]);ee[Q].inRange=me,ee[Q].start=me,ee[ue].inRange=me,ee[ue].end=me}},F=K(()=>{const{minDate:ee,maxDate:Q,rangeState:ue,showWeekNumber:me}=e,be=y(S),ke=y(p),Ye="day";let Oe=1;if(me)for(let Ee=0;Ee<6;Ee++)ke[Ee][0]||(ke[Ee][0]={type:"week",text:y(T).add(Ee*7+1,Ye).week()});return Ike({row:6,column:7},ke,{startDate:ee,columnIndexOffset:me?1:0,nextEndDate:ue.endDate||Q||ue.selecting&&ee||null,now:Tn().locale(y(o)).startOf(Ye),unit:Ye,relativeDateGetter:Ee=>y(T).add(Ee-be,Ye),setCellMetadata:(...Ee)=>{x(...Ee,Oe)&&(Oe+=1)},setRowMetadata:L}),ke});rt(()=>e.date,async()=>{var ee;(ee=y(i))!=null&&ee.contains(document.activeElement)&&(await zt(),await H())});const H=async()=>{var ee;return(ee=y(c))==null?void 0:ee.focus()},B=ee=>e.selectionMode==="date"&&TO(ee.type)&&z(ee,e.parsedValue),z=(ee,Q)=>Q?Tn(Q).locale(y(o)).isSame(e.date.date(Number(ee.text)),"day"):!1,W=(ee,Q)=>{const ue=ee*7+(Q-(e.showWeekNumber?1:0))-y(S);return y(T).add(ue,"day")},Z=ee=>{var Q;if(!e.rangeState.selecting)return;let ue=ee.target;if(ue.tagName==="SPAN"&&(ue=(Q=ue.parentNode)==null?void 0:Q.parentNode),ue.tagName==="DIV"&&(ue=ue.parentNode),ue.tagName!=="TD")return;const me=ue.parentNode.rowIndex-1,be=ue.cellIndex;y(F)[me][be].disabled||(me!==y(u)||be!==y(f))&&(u.value=me,f.value=be,t("changerange",{selecting:!0,endDate:W(me,be)}))},$=ee=>!y(R)&&(ee==null?void 0:ee.text)===1&&ee.type==="normal"||ee.isCurrent,O=ee=>{m||y(R)||e.selectionMode!=="date"||ie(ee,!0)},X=ee=>{ee.target.closest("td")&&(m=!0)},le=ee=>{ee.target.closest("td")&&(m=!1)},de=ee=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:ee,maxDate:null}),t("select",!0)):(ee>=e.minDate?t("pick",{minDate:e.minDate,maxDate:ee}):t("pick",{minDate:ee,maxDate:e.minDate}),t("select",!1))},he=ee=>{const Q=ee.week(),ue=`${ee.year()}w${Q}`;t("pick",{year:ee.year(),week:Q,value:ue,date:ee.startOf("week")})},se=(ee,Q)=>{const ue=Q?Cs(e.parsedValue).filter(me=>(me==null?void 0:me.valueOf())!==ee.valueOf()):Cs(e.parsedValue).concat([ee]);t("pick",ue)},ie=(ee,Q=!1)=>{const ue=ee.target.closest("td");if(!ue)return;const me=ue.parentNode.rowIndex-1,be=ue.cellIndex,ke=y(F)[me][be];if(ke.disabled||ke.type==="week")return;const Ye=W(me,be);switch(e.selectionMode){case"range":{de(Ye);break}case"date":{t("pick",Ye,Q);break}case"week":{he(Ye);break}case"dates":{se(Ye,!!ke.selected);break}}},oe=ee=>{if(e.selectionMode!=="week")return!1;let Q=e.date.startOf("day");if(ee.type==="prev-month"&&(Q=Q.subtract(1,"month")),ee.type==="next-month"&&(Q=Q.add(1,"month")),Q=Q.date(Number.parseInt(ee.text,10)),e.parsedValue&&!Array.isArray(e.parsedValue)){const ue=(e.parsedValue.day()-_+7)%7-1;return e.parsedValue.subtract(ue,"day").isSame(Q,"day")}return!1};return{WEEKS:M,rows:F,tbodyRef:i,currentCellRef:c,focus:H,isCurrent:B,isWeekActive:oe,isSelectedCell:$,handlePickDate:ie,handleMouseUp:le,handleMouseDown:X,handleMouseMove:Z,handleFocus:O}},Cke=(e,{isCurrent:t,isWeekActive:o})=>{const i=lt("date-table"),{t:c}=Kn(),u=K(()=>[i.b(),{"is-week-mode":e.selectionMode==="week"}]),f=K(()=>c("el.datepicker.dateTablePrompt")),p=K(()=>c("el.datepicker.week"));return{tableKls:u,tableLabel:f,weekLabel:p,getCellClasses:b=>{const S=[];return TO(b.type)&&!b.disabled?(S.push("available"),b.type==="today"&&S.push("today")):S.push(b.type),t(b)&&S.push("current"),b.inRange&&(TO(b.type)||e.selectionMode==="week")&&(S.push("in-range"),b.start&&S.push("start-date"),b.end&&S.push("end-date")),b.disabled&&S.push("disabled"),b.selected&&S.push("selected"),b.customClass&&S.push(b.customClass),S.join(" ")},getRowKls:b=>[i.e("row"),{current:o(b)}],t:c}},Ske=gt({cell:{type:Le(Object)}});var Tke=Se({name:"ElDatePickerCell",props:Ske,setup(e){const t=lt("date-table-cell"),{slots:o}=wt(VL);return()=>{const{cell:i}=e;return We(o,"default",{...i},()=>[Me("div",{class:t.b()},[Me("span",{class:t.e("text")},[i==null?void 0:i.text])])])}}});const Eke=["aria-label"],Mke={key:0,scope:"col"},kke=["aria-label"],Ake=["aria-current","aria-selected","tabindex"],Rke=Se({__name:"basic-date-table",props:_ke,emits:yke,setup(e,{expose:t,emit:o}){const i=e,{WEEKS:c,rows:u,tbodyRef:f,currentCellRef:p,focus:m,isCurrent:_,isWeekActive:b,isSelectedCell:S,handlePickDate:T,handleMouseUp:M,handleMouseDown:R,handleMouseMove:E,handleFocus:N}=bke(i,o),{tableLabel:D,tableKls:x,weekLabel:L,getCellClasses:F,getRowKls:H,t:B}=Cke(i,{isCurrent:_,isWeekActive:b});return t({focus:m}),(z,W)=>(J(),ge("table",{"aria-label":y(D),class:ne(y(x)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:W[1]||(W[1]=(...Z)=>y(T)&&y(T)(...Z)),onMousemove:W[2]||(W[2]=(...Z)=>y(E)&&y(E)(...Z)),onMousedown:W[3]||(W[3]=nn((...Z)=>y(R)&&y(R)(...Z),["prevent"])),onMouseup:W[4]||(W[4]=(...Z)=>y(M)&&y(M)(...Z))},[Ce("tbody",{ref_key:"tbodyRef",ref:f},[Ce("tr",null,[z.showWeekNumber?(J(),ge("th",Mke,pt(y(L)),1)):Fe("v-if",!0),(J(!0),ge(qt,null,Vn(y(c),(Z,$)=>(J(),ge("th",{key:$,"aria-label":y(B)("el.datepicker.weeksFull."+Z),scope:"col"},pt(y(B)("el.datepicker.weeks."+Z)),9,kke))),128))]),(J(!0),ge(qt,null,Vn(y(u),(Z,$)=>(J(),ge("tr",{key:$,class:ne(y(H)(Z[1]))},[(J(!0),ge(qt,null,Vn(Z,(O,X)=>(J(),ge("td",{key:`${$}.${X}`,ref_for:!0,ref:le=>y(S)(O)&&(p.value=le),class:ne(y(F)(O)),"aria-current":O.isCurrent?"date":void 0,"aria-selected":O.isCurrent,tabindex:y(S)(O)?0:-1,onFocus:W[0]||(W[0]=(...le)=>y(N)&&y(N)(...le))},[Me(y(Tke),{cell:O},null,8,["cell"])],42,Ake))),128))],2))),128))],512)],42,Eke))}});var EO=vt(Rke,[["__file","basic-date-table.vue"]]);const wke=gt({...GL,selectionMode:BL("month")}),Dke=["aria-label"],Oke=["aria-selected","aria-label","tabindex","onKeydown"],Nke={class:"cell"},Lke=Se({__name:"basic-month-table",props:wke,emits:["changerange","pick","select"],setup(e,{expose:t,emit:o}){const i=e,c=(F,H,B)=>{const z=Tn().locale(B).startOf("month").month(H).year(F),W=z.daysInMonth();return fd(W).map(Z=>z.add(Z,"day").toDate())},u=lt("month-table"),{t:f,lang:p}=Kn(),m=ae(),_=ae(),b=ae(i.date.locale("en").localeData().monthsShort().map(F=>F.toLowerCase())),S=ae([[],[],[]]),T=ae(),M=ae(),R=K(()=>{var F,H;const B=S.value,z=Tn().locale(p.value).startOf("month");for(let W=0;W<3;W++){const Z=B[W];for(let $=0;$<4;$++){const O=Z[$]||(Z[$]={row:W,column:$,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});O.type="normal";const X=W*4+$,le=i.date.startOf("year").month(X),de=i.rangeState.endDate||i.maxDate||i.rangeState.selecting&&i.minDate||null;O.inRange=!!(i.minDate&&le.isSameOrAfter(i.minDate,"month")&&de&&le.isSameOrBefore(de,"month"))||!!(i.minDate&&le.isSameOrBefore(i.minDate,"month")&&de&&le.isSameOrAfter(de,"month")),(F=i.minDate)!=null&&F.isSameOrAfter(de)?(O.start=!!(de&&le.isSame(de,"month")),O.end=i.minDate&&le.isSame(i.minDate,"month")):(O.start=!!(i.minDate&&le.isSame(i.minDate,"month")),O.end=!!(de&&le.isSame(de,"month"))),z.isSame(le)&&(O.type="today"),O.text=X,O.disabled=((H=i.disabledDate)==null?void 0:H.call(i,le.toDate()))||!1}}return B}),E=()=>{var F;(F=_.value)==null||F.focus()},N=F=>{const H={},B=i.date.year(),z=new Date,W=F.text;return H.disabled=i.disabledDate?c(B,W,p.value).every(i.disabledDate):!1,H.current=Cs(i.parsedValue).findIndex(Z=>Tn.isDayjs(Z)&&Z.year()===B&&Z.month()===W)>=0,H.today=z.getFullYear()===B&&z.getMonth()===W,F.inRange&&(H["in-range"]=!0,F.start&&(H["start-date"]=!0),F.end&&(H["end-date"]=!0)),H},D=F=>{const H=i.date.year(),B=F.text;return Cs(i.date).findIndex(z=>z.year()===H&&z.month()===B)>=0},x=F=>{var H;if(!i.rangeState.selecting)return;let B=F.target;if(B.tagName==="SPAN"&&(B=(H=B.parentNode)==null?void 0:H.parentNode),B.tagName==="DIV"&&(B=B.parentNode),B.tagName!=="TD")return;const z=B.parentNode.rowIndex,W=B.cellIndex;R.value[z][W].disabled||(z!==T.value||W!==M.value)&&(T.value=z,M.value=W,o("changerange",{selecting:!0,endDate:i.date.startOf("year").month(z*4+W)}))},L=F=>{var H;const B=(H=F.target)==null?void 0:H.closest("td");if((B==null?void 0:B.tagName)!=="TD"||ea(B,"disabled"))return;const z=B.cellIndex,Z=B.parentNode.rowIndex*4+z,$=i.date.startOf("year").month(Z);i.selectionMode==="range"?i.rangeState.selecting?(i.minDate&&$>=i.minDate?o("pick",{minDate:i.minDate,maxDate:$}):o("pick",{minDate:$,maxDate:i.minDate}),o("select",!1)):(o("pick",{minDate:$,maxDate:null}),o("select",!0)):o("pick",Z)};return rt(()=>i.date,async()=>{var F,H;(F=m.value)!=null&&F.contains(document.activeElement)&&(await zt(),(H=_.value)==null||H.focus())}),t({focus:E}),(F,H)=>(J(),ge("table",{role:"grid","aria-label":y(f)("el.datepicker.monthTablePrompt"),class:ne(y(u).b()),onClick:L,onMousemove:x},[Ce("tbody",{ref_key:"tbodyRef",ref:m},[(J(!0),ge(qt,null,Vn(y(R),(B,z)=>(J(),ge("tr",{key:z},[(J(!0),ge(qt,null,Vn(B,(W,Z)=>(J(),ge("td",{key:Z,ref_for:!0,ref:$=>D(W)&&(_.value=$),class:ne(N(W)),"aria-selected":`${D(W)}`,"aria-label":y(f)(`el.datepicker.month${+W.text+1}`),tabindex:D(W)?0:-1,onKeydown:[go(nn(L,["prevent","stop"]),["space"]),go(nn(L,["prevent","stop"]),["enter"])]},[Ce("div",null,[Ce("span",Nke,pt(y(f)("el.datepicker.months."+b.value[W.text])),1)])],42,Oke))),128))]))),128))],512)],42,Dke))}});var MO=vt(Lke,[["__file","basic-month-table.vue"]]);const{date:Pke,disabledDate:Uke,parsedValue:xke}=GL,Fke=gt({date:Pke,disabledDate:Uke,parsedValue:xke,selectionMode:BL("year")}),Vke=["aria-label"],Gke=["aria-selected","tabindex","onKeydown"],Bke={class:"cell"},$ke={key:1},Hke=Se({__name:"basic-year-table",props:Fke,emits:["pick"],setup(e,{expose:t,emit:o}){const i=e,c=(E,N)=>{const D=Tn(String(E)).locale(N).startOf("year"),L=D.endOf("year").dayOfYear();return fd(L).map(F=>D.add(F,"day").toDate())},u=lt("year-table"),{t:f,lang:p}=Kn(),m=ae(),_=ae(),b=K(()=>Math.floor(i.date.year()/10)*10),S=()=>{var E;(E=_.value)==null||E.focus()},T=E=>{const N={},D=Tn().locale(p.value);return N.disabled=i.disabledDate?c(E,p.value).every(i.disabledDate):!1,N.current=Cs(i.parsedValue).findIndex(x=>x.year()===E)>=0,N.today=D.year()===E,N},M=E=>E===b.value&&i.date.year()<b.value&&i.date.year()>b.value+9||Cs(i.date).findIndex(N=>N.year()===E)>=0||Cs(i.parsedValue).findIndex(N=>(N==null?void 0:N.year())===E)>=0,R=E=>{const D=E.target.closest("td");if(D&&D.textContent){if(ea(D,"disabled"))return;const x=D.textContent||D.innerText;if(i.selectionMode==="years"){if(E.type==="keydown"){o("pick",Cs(i.parsedValue),!1);return}const L=ea(D,"current")?Cs(i.parsedValue).filter(F=>(F==null?void 0:F.year())!==Number(x)):Cs(i.parsedValue).concat([Tn(x)]);o("pick",L)}else o("pick",Number(x))}};return rt(()=>i.date,async()=>{var E,N;(E=m.value)!=null&&E.contains(document.activeElement)&&(await zt(),(N=_.value)==null||N.focus())}),t({focus:S}),(E,N)=>(J(),ge("table",{role:"grid","aria-label":y(f)("el.datepicker.yearTablePrompt"),class:ne(y(u).b()),onClick:R},[Ce("tbody",{ref_key:"tbodyRef",ref:m},[(J(),ge(qt,null,Vn(3,(D,x)=>Ce("tr",{key:x},[(J(),ge(qt,null,Vn(4,(L,F)=>(J(),ge(qt,{key:x+"_"+F},[x*4+F<10?(J(),ge("td",{key:0,ref_for:!0,ref:H=>M(y(b)+x*4+F)&&(_.value=H),class:ne(["available",T(y(b)+x*4+F)]),"aria-selected":`${M(y(b)+x*4+F)}`,tabindex:M(y(b)+x*4+F)?0:-1,onKeydown:[go(nn(R,["prevent","stop"]),["space"]),go(nn(R,["prevent","stop"]),["enter"])]},[Ce("div",null,[Ce("span",Bke,pt(y(b)+x*4+F),1)])],42,Gke)):(J(),ge("td",$ke))],64))),64))])),64))],512)],10,Vke))}});var qke=vt(Hke,[["__file","basic-year-table.vue"]]);const Kke=["onClick"],zke=["aria-label"],Wke=["aria-label"],jke=["aria-label"],Yke=["aria-label"],Jke=Se({__name:"panel-date-pick",props:vke,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const o=e,i=(nt,It,ct)=>!0,c=lt("picker-panel"),u=lt("date-picker"),f=tp(),p=zr(),{t:m,lang:_}=Kn(),b=wt("EP_PICKER_BASE"),S=wt(m1),{shortcuts:T,disabledDate:M,cellClassName:R,defaultTime:E}=b.props,N=Io(b.props,"defaultValue"),D=ae(),x=ae(Tn().locale(_.value)),L=ae(!1);let F=!1;const H=K(()=>Tn(E).locale(_.value)),B=K(()=>x.value.month()),z=K(()=>x.value.year()),W=ae([]),Z=ae(null),$=ae(null),O=nt=>W.value.length>0?i(nt,W.value,o.format||"HH:mm:ss"):!0,X=nt=>E&&!Ae.value&&!L.value&&!F?H.value.year(nt.year()).month(nt.month()).date(nt.date()):Oe.value?nt.millisecond(0):nt.startOf("day"),le=(nt,...It)=>{if(!nt)t("pick",nt,...It);else if(At(nt)){const ct=nt.map(X);t("pick",ct,...It)}else t("pick",X(nt),...It);Z.value=null,$.value=null,L.value=!1,F=!1},de=async(nt,It)=>{if(Q.value==="date"){nt=nt;let ct=o.parsedValue?o.parsedValue.year(nt.year()).month(nt.month()).date(nt.date()):nt;O(ct)||(ct=W.value[0][0].year(nt.year()).month(nt.month()).date(nt.date())),x.value=ct,le(ct,Oe.value||It),o.type==="datetime"&&(await zt(),Jt())}else Q.value==="week"?le(nt.date):Q.value==="dates"&&le(nt,!0)},he=nt=>{const It=nt?"add":"subtract";x.value=x.value[It](1,"month"),Bt("month")},se=nt=>{const It=x.value,ct=nt?"add":"subtract";x.value=ie.value==="year"?It[ct](10,"year"):It[ct](1,"year"),Bt("year")},ie=ae("date"),oe=K(()=>{const nt=m("el.datepicker.year");if(ie.value==="year"){const It=Math.floor(z.value/10)*10;return nt?`${It} ${nt} - ${It+9} ${nt}`:`${It} - ${It+9}`}return`${z.value} ${nt}`}),ee=nt=>{const It=tn(nt.value)?nt.value():nt.value;if(It){F=!0,le(Tn(It).locale(_.value));return}nt.onClick&&nt.onClick({attrs:f,slots:p,emit:t})},Q=K(()=>{const{type:nt}=o;return["week","month","year","years","dates"].includes(nt)?nt:"date"}),ue=K(()=>Q.value==="date"?ie.value:Q.value),me=K(()=>!!T.length),be=async nt=>{x.value=x.value.startOf("month").month(nt),Q.value==="month"?le(x.value,!1):(ie.value="date",["month","year","date","week"].includes(Q.value)&&(le(x.value,!0),await zt(),Jt())),Bt("month")},ke=async(nt,It)=>{Q.value==="year"?(x.value=x.value.startOf("year").year(nt),le(x.value,!1)):Q.value==="years"?le(nt,It??!0):(x.value=x.value.year(nt),ie.value="month",["month","year","date","week"].includes(Q.value)&&(le(x.value,!0),await zt(),Jt())),Bt("year")},Ye=async nt=>{ie.value=nt,await zt(),Jt()},Oe=K(()=>o.type==="datetime"||o.type==="datetimerange"),Ee=K(()=>{const nt=Oe.value||Q.value==="dates",It=Q.value==="years",ct=ie.value==="date",Ke=ie.value==="year";return nt&&ct||It&&Ke}),we=K(()=>M?o.parsedValue?At(o.parsedValue)?M(o.parsedValue[0].toDate()):M(o.parsedValue.toDate()):!0:!1),Ge=()=>{if(Q.value==="dates"||Q.value==="years")le(o.parsedValue);else{let nt=o.parsedValue;if(!nt){const It=Tn(E).locale(_.value),ct=Mt();nt=It.year(ct.year()).month(ct.month()).date(ct.date())}x.value=nt,le(nt)}},Ve=K(()=>M?M(Tn().locale(_.value).toDate()):!1),qe=()=>{const It=Tn().locale(_.value).toDate();L.value=!0,(!M||!M(It))&&O(It)&&(x.value=Tn().locale(_.value),le(x.value))},st=K(()=>o.timeFormat||Z9(o.format)),Ie=K(()=>o.dateFormat||Q9(o.format)),Ae=K(()=>{if($.value)return $.value;if(!(!o.parsedValue&&!N.value))return(o.parsedValue||x.value).format(st.value)}),xe=K(()=>{if(Z.value)return Z.value;if(!(!o.parsedValue&&!N.value))return(o.parsedValue||x.value).format(Ie.value)}),ot=ae(!1),je=()=>{ot.value=!0},at=()=>{ot.value=!1},ht=nt=>({hour:nt.hour(),minute:nt.minute(),second:nt.second(),year:nt.year(),month:nt.month(),date:nt.date()}),dt=(nt,It,ct)=>{const{hour:Ke,minute:Xe,second:Dt}=ht(nt),$e=o.parsedValue?o.parsedValue.hour(Ke).minute(Xe).second(Dt):nt;x.value=$e,le(x.value,!0),ct||(ot.value=It)},ft=nt=>{const It=Tn(nt,st.value).locale(_.value);if(It.isValid()&&O(It)){const{year:ct,month:Ke,date:Xe}=ht(x.value);x.value=It.year(ct).month(Ke).date(Xe),$.value=null,ot.value=!1,le(x.value,!0)}},Je=nt=>{const It=Tn(nt,Ie.value).locale(_.value);if(It.isValid()){if(M&&M(It.toDate()))return;const{hour:ct,minute:Ke,second:Xe}=ht(x.value);x.value=It.hour(ct).minute(Ke).second(Xe),Z.value=null,le(x.value,!0)}},Et=nt=>Tn.isDayjs(nt)&&nt.isValid()&&(M?!M(nt.toDate()):!0),Nt=nt=>At(nt)?nt.map(It=>It.format(o.format)):nt.format(o.format),et=nt=>Tn(nt,o.format).locale(_.value),Mt=()=>{const nt=Tn(N.value).locale(_.value);if(!N.value){const It=H.value;return Tn().hour(It.hour()).minute(It.minute()).second(It.second()).locale(_.value)}return nt},Jt=async()=>{var nt;["week","month","year","date"].includes(Q.value)&&((nt=D.value)==null||nt.focus(),Q.value==="week"&&gn(Yt.down))},sn=nt=>{const{code:It}=nt;[Yt.up,Yt.down,Yt.left,Yt.right,Yt.home,Yt.end,Yt.pageUp,Yt.pageDown].includes(It)&&(gn(It),nt.stopPropagation(),nt.preventDefault()),[Yt.enter,Yt.space,Yt.numpadEnter].includes(It)&&Z.value===null&&$.value===null&&(nt.preventDefault(),le(x.value,!1))},gn=nt=>{var It;const{up:ct,down:Ke,left:Xe,right:Dt,home:$e,end:xt,pageUp:jt,pageDown:Fn}=Yt,oo={year:{[ct]:-4,[Ke]:4,[Xe]:-1,[Dt]:1,offset:(kn,Po)=>kn.setFullYear(kn.getFullYear()+Po)},month:{[ct]:-4,[Ke]:4,[Xe]:-1,[Dt]:1,offset:(kn,Po)=>kn.setMonth(kn.getMonth()+Po)},week:{[ct]:-1,[Ke]:1,[Xe]:-1,[Dt]:1,offset:(kn,Po)=>kn.setDate(kn.getDate()+Po*7)},date:{[ct]:-7,[Ke]:7,[Xe]:-1,[Dt]:1,[$e]:kn=>-kn.getDay(),[xt]:kn=>-kn.getDay()+6,[jt]:kn=>-new Date(kn.getFullYear(),kn.getMonth(),0).getDate(),[Fn]:kn=>new Date(kn.getFullYear(),kn.getMonth()+1,0).getDate(),offset:(kn,Po)=>kn.setDate(kn.getDate()+Po)}},zn=x.value.toDate();for(;Math.abs(x.value.diff(zn,"year",!0))<1;){const kn=oo[ue.value];if(!kn)return;if(kn.offset(zn,tn(kn[nt])?kn[nt](zn):(It=kn[nt])!=null?It:0),M&&M(zn))break;const Po=Tn(zn).locale(_.value);x.value=Po,t("pick",Po,!0);break}},Bt=nt=>{t("panel-change",x.value.toDate(),nt,ie.value)};return rt(()=>Q.value,nt=>{if(["month","year"].includes(nt)){ie.value=nt;return}else if(nt==="years"){ie.value="year";return}ie.value="date"},{immediate:!0}),rt(()=>ie.value,()=>{S==null||S.updatePopper()}),rt(()=>N.value,nt=>{nt&&(x.value=Mt())},{immediate:!0}),rt(()=>o.parsedValue,nt=>{if(nt){if(Q.value==="dates"||Q.value==="years"||Array.isArray(nt))return;x.value=nt}else x.value=Mt()},{immediate:!0}),t("set-picker-option",["isValidValue",Et]),t("set-picker-option",["formatToString",Nt]),t("set-picker-option",["parseUserInput",et]),t("set-picker-option",["handleFocusPicker",Jt]),(nt,It)=>(J(),ge("div",{class:ne([y(c).b(),y(u).b(),{"has-sidebar":nt.$slots.sidebar||y(me),"has-time":y(Oe)}])},[Ce("div",{class:ne(y(c).e("body-wrapper"))},[We(nt.$slots,"sidebar",{class:ne(y(c).e("sidebar"))}),y(me)?(J(),ge("div",{key:0,class:ne(y(c).e("sidebar"))},[(J(!0),ge(qt,null,Vn(y(T),(ct,Ke)=>(J(),ge("button",{key:Ke,type:"button",class:ne(y(c).e("shortcut")),onClick:Xe=>ee(ct)},pt(ct.text),11,Kke))),128))],2)):Fe("v-if",!0),Ce("div",{class:ne(y(c).e("body"))},[y(Oe)?(J(),ge("div",{key:0,class:ne(y(u).e("time-header"))},[Ce("span",{class:ne(y(u).e("editor-wrap"))},[Me(y(Ai),{placeholder:y(m)("el.datepicker.selectDate"),"model-value":y(xe),size:"small","validate-event":!1,onInput:It[0]||(It[0]=ct=>Z.value=ct),onChange:Je},null,8,["placeholder","model-value"])],2),hn((J(),ge("span",{class:ne(y(u).e("editor-wrap"))},[Me(y(Ai),{placeholder:y(m)("el.datepicker.selectTime"),"model-value":y(Ae),size:"small","validate-event":!1,onFocus:je,onInput:It[1]||(It[1]=ct=>$.value=ct),onChange:ft},null,8,["placeholder","model-value"]),Me(y(AE),{visible:ot.value,format:y(st),"parsed-value":x.value,onPick:dt},null,8,["visible","format","parsed-value"])],2)),[[y(wc),at]])],2)):Fe("v-if",!0),hn(Ce("div",{class:ne([y(u).e("header"),(ie.value==="year"||ie.value==="month")&&y(u).e("header--bordered")])},[Ce("span",{class:ne(y(u).e("prev-btn"))},[Ce("button",{type:"button","aria-label":y(m)("el.datepicker.prevYear"),class:ne(["d-arrow-left",y(c).e("icon-btn")]),onClick:It[2]||(It[2]=ct=>se(!1))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(Im))]),_:1})],10,zke),hn(Ce("button",{type:"button","aria-label":y(m)("el.datepicker.prevMonth"),class:ne([y(c).e("icon-btn"),"arrow-left"]),onClick:It[3]||(It[3]=ct=>he(!1))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1})],10,Wke),[[Jn,ie.value==="date"]])],2),Ce("span",{role:"button",class:ne(y(u).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:It[4]||(It[4]=go(ct=>Ye("year"),["enter"])),onClick:It[5]||(It[5]=ct=>Ye("year"))},pt(y(oe)),35),hn(Ce("span",{role:"button","aria-live":"polite",tabindex:"0",class:ne([y(u).e("header-label"),{active:ie.value==="month"}]),onKeydown:It[6]||(It[6]=go(ct=>Ye("month"),["enter"])),onClick:It[7]||(It[7]=ct=>Ye("month"))},pt(y(m)(`el.datepicker.month${y(B)+1}`)),35),[[Jn,ie.value==="date"]]),Ce("span",{class:ne(y(u).e("next-btn"))},[hn(Ce("button",{type:"button","aria-label":y(m)("el.datepicker.nextMonth"),class:ne([y(c).e("icon-btn"),"arrow-right"]),onClick:It[8]||(It[8]=ct=>he(!0))},[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})],10,jke),[[Jn,ie.value==="date"]]),Ce("button",{type:"button","aria-label":y(m)("el.datepicker.nextYear"),class:ne([y(c).e("icon-btn"),"d-arrow-right"]),onClick:It[9]||(It[9]=ct=>se(!0))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(bm))]),_:1})],10,Yke)],2)],2),[[Jn,ie.value!=="time"]]),Ce("div",{class:ne(y(c).e("content")),onKeydown:sn},[ie.value==="date"?(J(),He(EO,{key:0,ref_key:"currentViewRef",ref:D,"selection-mode":y(Q),date:x.value,"parsed-value":nt.parsedValue,"disabled-date":y(M),"cell-class-name":y(R),onPick:de},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):Fe("v-if",!0),ie.value==="year"?(J(),He(qke,{key:1,ref_key:"currentViewRef",ref:D,"selection-mode":y(Q),date:x.value,"disabled-date":y(M),"parsed-value":nt.parsedValue,onPick:ke},null,8,["selection-mode","date","disabled-date","parsed-value"])):Fe("v-if",!0),ie.value==="month"?(J(),He(MO,{key:2,ref_key:"currentViewRef",ref:D,date:x.value,"parsed-value":nt.parsedValue,"disabled-date":y(M),onPick:be},null,8,["date","parsed-value","disabled-date"])):Fe("v-if",!0)],34)],2)],2),hn(Ce("div",{class:ne(y(c).e("footer"))},[hn(Me(y(qr),{text:"",size:"small",class:ne(y(c).e("link-btn")),disabled:y(Ve),onClick:qe},{default:Ne(()=>[On(pt(y(m)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[Jn,y(Q)!=="dates"&&y(Q)!=="years"]]),Me(y(qr),{plain:"",size:"small",class:ne(y(c).e("link-btn")),disabled:y(we),onClick:Ge},{default:Ne(()=>[On(pt(y(m)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[Jn,y(Ee)]])],2))}});var Xke=vt(Jke,[["__file","panel-date-pick.vue"]]);const Qke=gt({...WK,...jK}),Zke=e=>{const{emit:t}=In(),o=tp(),i=zr();return u=>{const f=tn(u.value)?u.value():u.value;if(f){t("pick",[Tn(f[0]).locale(e.value),Tn(f[1]).locale(e.value)]);return}u.onClick&&u.onClick({attrs:o,slots:i,emit:t})}},JK=(e,{defaultValue:t,leftDate:o,rightDate:i,unit:c,onParsedValueChanged:u})=>{const{emit:f}=In(),{pickerNs:p}=wt(VL),m=lt("date-range-picker"),{t:_,lang:b}=Kn(),S=Zke(b),T=ae(),M=ae(),R=ae({endDate:null,selecting:!1}),E=L=>{R.value=L},N=(L=!1)=>{const F=y(T),H=y(M);SO([F,H])&&f("pick",[F,H],L)},D=L=>{R.value.selecting=L,L||(R.value.endDate=null)},x=()=>{const[L,F]=YK(y(t),{lang:y(b),unit:c,unlinkPanels:e.unlinkPanels});T.value=void 0,M.value=void 0,o.value=L,i.value=F};return rt(t,L=>{L&&x()},{immediate:!0}),rt(()=>e.parsedValue,L=>{if(At(L)&&L.length===2){const[F,H]=L;T.value=F,o.value=F,M.value=H,u(y(T),y(M))}else x()},{immediate:!0}),{minDate:T,maxDate:M,rangeState:R,lang:b,ppNs:p,drpNs:m,handleChangeRange:E,handleRangeConfirm:N,handleShortcutClick:S,onSelect:D,t:_}},eAe=["onClick"],tAe=["aria-label"],nAe=["aria-label"],oAe=["disabled","aria-label"],rAe=["disabled","aria-label"],iAe=["disabled","aria-label"],sAe=["disabled","aria-label"],aAe=["aria-label"],lAe=["aria-label"],mT="month",cAe=Se({__name:"panel-date-range",props:Qke,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const o=e,i=wt("EP_PICKER_BASE"),{disabledDate:c,cellClassName:u,format:f,defaultTime:p,clearable:m}=i.props,_=Io(i.props,"shortcuts"),b=Io(i.props,"defaultValue"),{lang:S}=Kn(),T=ae(Tn().locale(S.value)),M=ae(Tn().locale(S.value).add(1,mT)),{minDate:R,maxDate:E,rangeState:N,ppNs:D,drpNs:x,handleChangeRange:L,handleRangeConfirm:F,handleShortcutClick:H,onSelect:B,t:z}=JK(o,{defaultValue:b,leftDate:T,rightDate:M,unit:mT,onParsedValueChanged:It}),W=ae({min:null,max:null}),Z=ae({min:null,max:null}),$=K(()=>`${T.value.year()} ${z("el.datepicker.year")} ${z(`el.datepicker.month${T.value.month()+1}`)}`),O=K(()=>`${M.value.year()} ${z("el.datepicker.year")} ${z(`el.datepicker.month${M.value.month()+1}`)}`),X=K(()=>T.value.year()),le=K(()=>T.value.month()),de=K(()=>M.value.year()),he=K(()=>M.value.month()),se=K(()=>!!_.value.length),ie=K(()=>W.value.min!==null?W.value.min:R.value?R.value.format(me.value):""),oe=K(()=>W.value.max!==null?W.value.max:E.value||R.value?(E.value||R.value).format(me.value):""),ee=K(()=>Z.value.min!==null?Z.value.min:R.value?R.value.format(ue.value):""),Q=K(()=>Z.value.max!==null?Z.value.max:E.value||R.value?(E.value||R.value).format(ue.value):""),ue=K(()=>o.timeFormat||Z9(f)),me=K(()=>o.dateFormat||Q9(f)),be=ct=>SO(ct)&&(c?!c(ct[0].toDate())&&!c(ct[1].toDate()):!0),ke=()=>{T.value=T.value.subtract(1,"year"),o.unlinkPanels||(M.value=T.value.add(1,"month")),st("year")},Ye=()=>{T.value=T.value.subtract(1,"month"),o.unlinkPanels||(M.value=T.value.add(1,"month")),st("month")},Oe=()=>{o.unlinkPanels?M.value=M.value.add(1,"year"):(T.value=T.value.add(1,"year"),M.value=T.value.add(1,"month")),st("year")},Ee=()=>{o.unlinkPanels?M.value=M.value.add(1,"month"):(T.value=T.value.add(1,"month"),M.value=T.value.add(1,"month")),st("month")},we=()=>{T.value=T.value.add(1,"year"),st("year")},Ge=()=>{T.value=T.value.add(1,"month"),st("month")},Ve=()=>{M.value=M.value.subtract(1,"year"),st("year")},qe=()=>{M.value=M.value.subtract(1,"month"),st("month")},st=ct=>{t("panel-change",[T.value.toDate(),M.value.toDate()],ct)},Ie=K(()=>{const ct=(le.value+1)%12,Ke=le.value+1>=12?1:0;return o.unlinkPanels&&new Date(X.value+Ke,ct)<new Date(de.value,he.value)}),Ae=K(()=>o.unlinkPanels&&de.value*12+he.value-(X.value*12+le.value+1)>=12),xe=K(()=>!(R.value&&E.value&&!N.value.selecting&&SO([R.value,E.value]))),ot=K(()=>o.type==="datetime"||o.type==="datetimerange"),je=(ct,Ke)=>{if(ct)return p?Tn(p[Ke]||p).locale(S.value).year(ct.year()).month(ct.month()).date(ct.date()):ct},at=(ct,Ke=!0)=>{const Xe=ct.minDate,Dt=ct.maxDate,$e=je(Xe,0),xt=je(Dt,1);E.value===xt&&R.value===$e||(t("calendar-change",[Xe.toDate(),Dt&&Dt.toDate()]),E.value=xt,R.value=$e,!(!Ke||ot.value)&&F())},ht=ae(!1),dt=ae(!1),ft=()=>{ht.value=!1},Je=()=>{dt.value=!1},Et=(ct,Ke)=>{W.value[Ke]=ct;const Xe=Tn(ct,me.value).locale(S.value);if(Xe.isValid()){if(c&&c(Xe.toDate()))return;Ke==="min"?(T.value=Xe,R.value=(R.value||T.value).year(Xe.year()).month(Xe.month()).date(Xe.date()),!o.unlinkPanels&&(!E.value||E.value.isBefore(R.value))&&(M.value=Xe.add(1,"month"),E.value=R.value.add(1,"month"))):(M.value=Xe,E.value=(E.value||M.value).year(Xe.year()).month(Xe.month()).date(Xe.date()),!o.unlinkPanels&&(!R.value||R.value.isAfter(E.value))&&(T.value=Xe.subtract(1,"month"),R.value=E.value.subtract(1,"month")))}},Nt=(ct,Ke)=>{W.value[Ke]=null},et=(ct,Ke)=>{Z.value[Ke]=ct;const Xe=Tn(ct,ue.value).locale(S.value);Xe.isValid()&&(Ke==="min"?(ht.value=!0,R.value=(R.value||T.value).hour(Xe.hour()).minute(Xe.minute()).second(Xe.second()),(!E.value||E.value.isBefore(R.value))&&(E.value=R.value)):(dt.value=!0,E.value=(E.value||M.value).hour(Xe.hour()).minute(Xe.minute()).second(Xe.second()),M.value=E.value,E.value&&E.value.isBefore(R.value)&&(R.value=E.value)))},Mt=(ct,Ke)=>{Z.value[Ke]=null,Ke==="min"?(T.value=R.value,ht.value=!1):(M.value=E.value,dt.value=!1)},Jt=(ct,Ke,Xe)=>{Z.value.min||(ct&&(T.value=ct,R.value=(R.value||T.value).hour(ct.hour()).minute(ct.minute()).second(ct.second())),Xe||(ht.value=Ke),(!E.value||E.value.isBefore(R.value))&&(E.value=R.value,M.value=ct))},sn=(ct,Ke,Xe)=>{Z.value.max||(ct&&(M.value=ct,E.value=(E.value||M.value).hour(ct.hour()).minute(ct.minute()).second(ct.second())),Xe||(dt.value=Ke),E.value&&E.value.isBefore(R.value)&&(R.value=E.value))},gn=()=>{T.value=YK(y(b),{lang:y(S),unit:"month",unlinkPanels:o.unlinkPanels})[0],M.value=T.value.add(1,"month"),E.value=void 0,R.value=void 0,t("pick",null)},Bt=ct=>At(ct)?ct.map(Ke=>Ke.format(f)):ct.format(f),nt=ct=>At(ct)?ct.map(Ke=>Tn(Ke,f).locale(S.value)):Tn(ct,f).locale(S.value);function It(ct,Ke){if(o.unlinkPanels&&Ke){const Xe=(ct==null?void 0:ct.year())||0,Dt=(ct==null?void 0:ct.month())||0,$e=Ke.year(),xt=Ke.month();M.value=Xe===$e&&Dt===xt?Ke.add(1,mT):Ke}else M.value=T.value.add(1,mT),Ke&&(M.value=M.value.hour(Ke.hour()).minute(Ke.minute()).second(Ke.second()))}return t("set-picker-option",["isValidValue",be]),t("set-picker-option",["parseUserInput",nt]),t("set-picker-option",["formatToString",Bt]),t("set-picker-option",["handleClear",gn]),(ct,Ke)=>(J(),ge("div",{class:ne([y(D).b(),y(x).b(),{"has-sidebar":ct.$slots.sidebar||y(se),"has-time":y(ot)}])},[Ce("div",{class:ne(y(D).e("body-wrapper"))},[We(ct.$slots,"sidebar",{class:ne(y(D).e("sidebar"))}),y(se)?(J(),ge("div",{key:0,class:ne(y(D).e("sidebar"))},[(J(!0),ge(qt,null,Vn(y(_),(Xe,Dt)=>(J(),ge("button",{key:Dt,type:"button",class:ne(y(D).e("shortcut")),onClick:$e=>y(H)(Xe)},pt(Xe.text),11,eAe))),128))],2)):Fe("v-if",!0),Ce("div",{class:ne(y(D).e("body"))},[y(ot)?(J(),ge("div",{key:0,class:ne(y(x).e("time-header"))},[Ce("span",{class:ne(y(x).e("editors-wrap"))},[Ce("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Ai),{size:"small",disabled:y(N).selecting,placeholder:y(z)("el.datepicker.startDate"),class:ne(y(x).e("editor")),"model-value":y(ie),"validate-event":!1,onInput:Ke[0]||(Ke[0]=Xe=>Et(Xe,"min")),onChange:Ke[1]||(Ke[1]=Xe=>Nt(Xe,"min"))},null,8,["disabled","placeholder","class","model-value"])],2),hn((J(),ge("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Ai),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(z)("el.datepicker.startTime"),"model-value":y(ee),"validate-event":!1,onFocus:Ke[2]||(Ke[2]=Xe=>ht.value=!0),onInput:Ke[3]||(Ke[3]=Xe=>et(Xe,"min")),onChange:Ke[4]||(Ke[4]=Xe=>Mt(Xe,"min"))},null,8,["class","disabled","placeholder","model-value"]),Me(y(AE),{visible:ht.value,format:y(ue),"datetime-role":"start","parsed-value":T.value,onPick:Jt},null,8,["visible","format","parsed-value"])],2)),[[y(wc),ft]])],2),Ce("span",null,[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})]),Ce("span",{class:ne([y(x).e("editors-wrap"),"is-right"])},[Ce("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Ai),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(z)("el.datepicker.endDate"),"model-value":y(oe),readonly:!y(R),"validate-event":!1,onInput:Ke[5]||(Ke[5]=Xe=>Et(Xe,"max")),onChange:Ke[6]||(Ke[6]=Xe=>Nt(Xe,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"])],2),hn((J(),ge("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Ai),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(z)("el.datepicker.endTime"),"model-value":y(Q),readonly:!y(R),"validate-event":!1,onFocus:Ke[7]||(Ke[7]=Xe=>y(R)&&(dt.value=!0)),onInput:Ke[8]||(Ke[8]=Xe=>et(Xe,"max")),onChange:Ke[9]||(Ke[9]=Xe=>Mt(Xe,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"]),Me(y(AE),{"datetime-role":"end",visible:dt.value,format:y(ue),"parsed-value":M.value,onPick:sn},null,8,["visible","format","parsed-value"])],2)),[[y(wc),Je]])],2)],2)):Fe("v-if",!0),Ce("div",{class:ne([[y(D).e("content"),y(x).e("content")],"is-left"])},[Ce("div",{class:ne(y(x).e("header"))},[Ce("button",{type:"button",class:ne([y(D).e("icon-btn"),"d-arrow-left"]),"aria-label":y(z)("el.datepicker.prevYear"),onClick:ke},[Me(y(Gt),null,{default:Ne(()=>[Me(y(Im))]),_:1})],10,tAe),Ce("button",{type:"button",class:ne([y(D).e("icon-btn"),"arrow-left"]),"aria-label":y(z)("el.datepicker.prevMonth"),onClick:Ye},[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1})],10,nAe),ct.unlinkPanels?(J(),ge("button",{key:0,type:"button",disabled:!y(Ae),class:ne([[y(D).e("icon-btn"),{"is-disabled":!y(Ae)}],"d-arrow-right"]),"aria-label":y(z)("el.datepicker.nextYear"),onClick:we},[Me(y(Gt),null,{default:Ne(()=>[Me(y(bm))]),_:1})],10,oAe)):Fe("v-if",!0),ct.unlinkPanels?(J(),ge("button",{key:1,type:"button",disabled:!y(Ie),class:ne([[y(D).e("icon-btn"),{"is-disabled":!y(Ie)}],"arrow-right"]),"aria-label":y(z)("el.datepicker.nextMonth"),onClick:Ge},[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})],10,rAe)):Fe("v-if",!0),Ce("div",null,pt(y($)),1)],2),Me(EO,{"selection-mode":"range",date:T.value,"min-date":y(R),"max-date":y(E),"range-state":y(N),"disabled-date":y(c),"cell-class-name":y(u),onChangerange:y(L),onPick:at,onSelect:y(B)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ce("div",{class:ne([[y(D).e("content"),y(x).e("content")],"is-right"])},[Ce("div",{class:ne(y(x).e("header"))},[ct.unlinkPanels?(J(),ge("button",{key:0,type:"button",disabled:!y(Ae),class:ne([[y(D).e("icon-btn"),{"is-disabled":!y(Ae)}],"d-arrow-left"]),"aria-label":y(z)("el.datepicker.prevYear"),onClick:Ve},[Me(y(Gt),null,{default:Ne(()=>[Me(y(Im))]),_:1})],10,iAe)):Fe("v-if",!0),ct.unlinkPanels?(J(),ge("button",{key:1,type:"button",disabled:!y(Ie),class:ne([[y(D).e("icon-btn"),{"is-disabled":!y(Ie)}],"arrow-left"]),"aria-label":y(z)("el.datepicker.prevMonth"),onClick:qe},[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1})],10,sAe)):Fe("v-if",!0),Ce("button",{type:"button","aria-label":y(z)("el.datepicker.nextYear"),class:ne([y(D).e("icon-btn"),"d-arrow-right"]),onClick:Oe},[Me(y(Gt),null,{default:Ne(()=>[Me(y(bm))]),_:1})],10,aAe),Ce("button",{type:"button",class:ne([y(D).e("icon-btn"),"arrow-right"]),"aria-label":y(z)("el.datepicker.nextMonth"),onClick:Ee},[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})],10,lAe),Ce("div",null,pt(y(O)),1)],2),Me(EO,{"selection-mode":"range",date:M.value,"min-date":y(R),"max-date":y(E),"range-state":y(N),"disabled-date":y(c),"cell-class-name":y(u),onChangerange:y(L),onPick:at,onSelect:y(B)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(ot)?(J(),ge("div",{key:0,class:ne(y(D).e("footer"))},[y(m)?(J(),He(y(qr),{key:0,text:"",size:"small",class:ne(y(D).e("link-btn")),onClick:gn},{default:Ne(()=>[On(pt(y(z)("el.datepicker.clear")),1)]),_:1},8,["class"])):Fe("v-if",!0),Me(y(qr),{plain:"",size:"small",class:ne(y(D).e("link-btn")),disabled:y(xe),onClick:Ke[10]||(Ke[10]=Xe=>y(F)(!1))},{default:Ne(()=>[On(pt(y(z)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2)):Fe("v-if",!0)],2))}});var uAe=vt(cAe,[["__file","panel-date-range.vue"]]);const dAe=gt({...jK}),hAe=["pick","set-picker-option","calendar-change"],fAe=({unlinkPanels:e,leftDate:t,rightDate:o})=>{const{t:i}=Kn(),c=()=>{t.value=t.value.subtract(1,"year"),e.value||(o.value=o.value.subtract(1,"year"))},u=()=>{e.value||(t.value=t.value.add(1,"year")),o.value=o.value.add(1,"year")},f=()=>{t.value=t.value.add(1,"year")},p=()=>{o.value=o.value.subtract(1,"year")},m=K(()=>`${t.value.year()} ${i("el.datepicker.year")}`),_=K(()=>`${o.value.year()} ${i("el.datepicker.year")}`),b=K(()=>t.value.year()),S=K(()=>o.value.year()===t.value.year()?t.value.year()+1:o.value.year());return{leftPrevYear:c,rightNextYear:u,leftNextYear:f,rightPrevYear:p,leftLabel:m,rightLabel:_,leftYear:b,rightYear:S}},pAe=["onClick"],gAe=["disabled"],mAe=["disabled"],vT="year",vAe=Se({name:"DatePickerMonthRange"}),_Ae=Se({...vAe,props:dAe,emits:hAe,setup(e,{emit:t}){const o=e,{lang:i}=Kn(),c=wt("EP_PICKER_BASE"),{shortcuts:u,disabledDate:f,format:p}=c.props,m=Io(c.props,"defaultValue"),_=ae(Tn().locale(i.value)),b=ae(Tn().locale(i.value).add(1,vT)),{minDate:S,maxDate:T,rangeState:M,ppNs:R,drpNs:E,handleChangeRange:N,handleRangeConfirm:D,handleShortcutClick:x,onSelect:L}=JK(o,{defaultValue:m,leftDate:_,rightDate:b,unit:vT,onParsedValueChanged:se}),F=K(()=>!!u.length),{leftPrevYear:H,rightNextYear:B,leftNextYear:z,rightPrevYear:W,leftLabel:Z,rightLabel:$,leftYear:O,rightYear:X}=fAe({unlinkPanels:Io(o,"unlinkPanels"),leftDate:_,rightDate:b}),le=K(()=>o.unlinkPanels&&X.value>O.value+1),de=(ie,oe=!0)=>{const ee=ie.minDate,Q=ie.maxDate;T.value===Q&&S.value===ee||(t("calendar-change",[ee.toDate(),Q&&Q.toDate()]),T.value=Q,S.value=ee,oe&&D())},he=ie=>ie.map(oe=>oe.format(p));function se(ie,oe){if(o.unlinkPanels&&oe){const ee=(ie==null?void 0:ie.year())||0,Q=oe.year();b.value=ee===Q?oe.add(1,vT):oe}else b.value=_.value.add(1,vT)}return t("set-picker-option",["formatToString",he]),(ie,oe)=>(J(),ge("div",{class:ne([y(R).b(),y(E).b(),{"has-sidebar":!!ie.$slots.sidebar||y(F)}])},[Ce("div",{class:ne(y(R).e("body-wrapper"))},[We(ie.$slots,"sidebar",{class:ne(y(R).e("sidebar"))}),y(F)?(J(),ge("div",{key:0,class:ne(y(R).e("sidebar"))},[(J(!0),ge(qt,null,Vn(y(u),(ee,Q)=>(J(),ge("button",{key:Q,type:"button",class:ne(y(R).e("shortcut")),onClick:ue=>y(x)(ee)},pt(ee.text),11,pAe))),128))],2)):Fe("v-if",!0),Ce("div",{class:ne(y(R).e("body"))},[Ce("div",{class:ne([[y(R).e("content"),y(E).e("content")],"is-left"])},[Ce("div",{class:ne(y(E).e("header"))},[Ce("button",{type:"button",class:ne([y(R).e("icon-btn"),"d-arrow-left"]),onClick:oe[0]||(oe[0]=(...ee)=>y(H)&&y(H)(...ee))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(Im))]),_:1})],2),ie.unlinkPanels?(J(),ge("button",{key:0,type:"button",disabled:!y(le),class:ne([[y(R).e("icon-btn"),{[y(R).is("disabled")]:!y(le)}],"d-arrow-right"]),onClick:oe[1]||(oe[1]=(...ee)=>y(z)&&y(z)(...ee))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(bm))]),_:1})],10,gAe)):Fe("v-if",!0),Ce("div",null,pt(y(Z)),1)],2),Me(MO,{"selection-mode":"range",date:_.value,"min-date":y(S),"max-date":y(T),"range-state":y(M),"disabled-date":y(f),onChangerange:y(N),onPick:de,onSelect:y(L)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ce("div",{class:ne([[y(R).e("content"),y(E).e("content")],"is-right"])},[Ce("div",{class:ne(y(E).e("header"))},[ie.unlinkPanels?(J(),ge("button",{key:0,type:"button",disabled:!y(le),class:ne([[y(R).e("icon-btn"),{"is-disabled":!y(le)}],"d-arrow-left"]),onClick:oe[2]||(oe[2]=(...ee)=>y(W)&&y(W)(...ee))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(Im))]),_:1})],10,mAe)):Fe("v-if",!0),Ce("button",{type:"button",class:ne([y(R).e("icon-btn"),"d-arrow-right"]),onClick:oe[3]||(oe[3]=(...ee)=>y(B)&&y(B)(...ee))},[Me(y(Gt),null,{default:Ne(()=>[Me(y(bm))]),_:1})],2),Ce("div",null,pt(y($)),1)],2),Me(MO,{"selection-mode":"range",date:b.value,"min-date":y(S),"max-date":y(T),"range-state":y(M),"disabled-date":y(f),onChangerange:y(N),onPick:de,onSelect:y(L)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var yAe=vt(_Ae,[["__file","panel-month-range.vue"]]);const IAe=function(e){switch(e){case"daterange":case"datetimerange":return uAe;case"monthrange":return yAe;default:return Xke}};Tn.extend(gK);Tn.extend(rke);Tn.extend(UL);Tn.extend(ske);Tn.extend(lke);Tn.extend(uke);Tn.extend(hke);Tn.extend(pke);var bAe=Se({name:"ElDatePicker",install:null,props:gke,emits:["update:modelValue"],setup(e,{expose:t,emit:o,slots:i}){const c=lt("picker-panel");Ln("ElPopperOptions",Zn(Io(e,"popperOptions"))),Ln(VL,{slots:i,pickerNs:c});const u=ae();t({focus:(m=!0)=>{var _;(_=u.value)==null||_.focus(m)},handleOpen:()=>{var m;(m=u.value)==null||m.handleOpen()},handleClose:()=>{var m;(m=u.value)==null||m.handleClose()}});const p=m=>{o("update:modelValue",m)};return()=>{var m;const _=(m=e.format)!=null?m:YSe[e.type]||Hg,b=IAe(e.type);return Me(nK,Nn(e,{format:_,type:e.type,ref:u,"onUpdate:modelValue":p}),{default:S=>Me(b,S,null),"range-separator":i["range-separator"]})}}});const qT=bAe;qT.install=e=>{e.component(qT.name,qT)};const CAe=qT,$L=Symbol("elDescriptions");var Hy=Se({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:wt($L,{})}},render(){var e,t,o,i,c,u,f;const p=G_e(this.cell),m=(((e=this.cell)==null?void 0:e.dirs)||[]).map(H=>{const{dir:B,arg:z,modifiers:W,value:Z}=H;return[B,Z,z,W]}),{border:_,direction:b}=this.descriptions,S=b==="vertical",T=((i=(o=(t=this.cell)==null?void 0:t.children)==null?void 0:o.label)==null?void 0:i.call(o))||p.label,M=(f=(u=(c=this.cell)==null?void 0:c.children)==null?void 0:u.default)==null?void 0:f.call(u),R=p.span,E=p.align?`is-${p.align}`:"",N=p.labelAlign?`is-${p.labelAlign}`:E,D=p.className,x=p.labelClassName,L={width:Xo(p.width),minWidth:Xo(p.minWidth)},F=lt("descriptions");switch(this.type){case"label":return hn(Wt(this.tag,{style:L,class:[F.e("cell"),F.e("label"),F.is("bordered-label",_),F.is("vertical-label",S),N,x],colSpan:S?R:1},T),m);case"content":return hn(Wt(this.tag,{style:L,class:[F.e("cell"),F.e("content"),F.is("bordered-content",_),F.is("vertical-content",S),E,D],colSpan:S?R:R*2-1},M),m);default:return hn(Wt("td",{style:L,class:[F.e("cell"),E],colSpan:R},[Hr(T)?void 0:Wt("span",{class:[F.e("label"),x]},T),Wt("span",{class:[F.e("content"),D]},M)]),m)}}});const SAe=gt({row:{type:Le(Array),default:()=>[]}}),TAe={key:1},EAe=Se({name:"ElDescriptionsRow"}),MAe=Se({...EAe,props:SAe,setup(e){const t=wt($L,{});return(o,i)=>y(t).direction==="vertical"?(J(),ge(qt,{key:0},[Ce("tr",null,[(J(!0),ge(qt,null,Vn(o.row,(c,u)=>(J(),He(y(Hy),{key:`tr1-${u}`,cell:c,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ce("tr",null,[(J(!0),ge(qt,null,Vn(o.row,(c,u)=>(J(),He(y(Hy),{key:`tr2-${u}`,cell:c,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(J(),ge("tr",TAe,[(J(!0),ge(qt,null,Vn(o.row,(c,u)=>(J(),ge(qt,{key:`tr3-${u}`},[y(t).border?(J(),ge(qt,{key:0},[Me(y(Hy),{cell:c,tag:"td",type:"label"},null,8,["cell"]),Me(y(Hy),{cell:c,tag:"td",type:"content"},null,8,["cell"])],64)):(J(),He(y(Hy),{key:1,cell:c,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var kAe=vt(MAe,[["__file","descriptions-row.vue"]]);const AAe=gt({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Nr,title:{type:String,default:""},extra:{type:String,default:""}}),RAe=Se({name:"ElDescriptions"}),wAe=Se({...RAe,props:AAe,setup(e){const t=e,o=lt("descriptions"),i=Tr(),c=zr();Ln($L,t);const u=K(()=>[o.b(),o.m(i.value)]),f=(m,_,b,S=!1)=>(m.props||(m.props={}),_>b&&(m.props.span=b),S&&(m.props.span=_),m),p=()=>{if(!c.default)return[];const m=hd(c.default()).filter(M=>{var R;return((R=M==null?void 0:M.type)==null?void 0:R.name)==="ElDescriptionsItem"}),_=[];let b=[],S=t.column,T=0;return m.forEach((M,R)=>{var E;const N=((E=M.props)==null?void 0:E.span)||1;if(R<m.length-1&&(T+=N>S?S:N),R===m.length-1){const D=t.column-T%t.column;b.push(f(M,D,S,!0)),_.push(b);return}N<S?(S-=N,b.push(M)):(b.push(f(M,N,S)),_.push(b),S=t.column,b=[])}),_};return(m,_)=>(J(),ge("div",{class:ne(y(u))},[m.title||m.extra||m.$slots.title||m.$slots.extra?(J(),ge("div",{key:0,class:ne(y(o).e("header"))},[Ce("div",{class:ne(y(o).e("title"))},[We(m.$slots,"title",{},()=>[On(pt(m.title),1)])],2),Ce("div",{class:ne(y(o).e("extra"))},[We(m.$slots,"extra",{},()=>[On(pt(m.extra),1)])],2)],2)):Fe("v-if",!0),Ce("div",{class:ne(y(o).e("body"))},[Ce("table",{class:ne([y(o).e("table"),y(o).is("bordered",m.border)])},[Ce("tbody",null,[(J(!0),ge(qt,null,Vn(p(),(b,S)=>(J(),He(kAe,{key:S,row:b},null,8,["row"]))),128))])],2)],2)],2))}});var DAe=vt(wAe,[["__file","description.vue"]]);const OAe=gt({label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),XK=Se({name:"ElDescriptionsItem",props:OAe}),NAe=bn(DAe,{DescriptionsItem:XK}),LAe=Wo(XK),PAe=gt({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:Le([String,Array,Object])},zIndex:{type:Le([String,Number])}}),UAe={click:e=>e instanceof MouseEvent},xAe="overlay";var FAe=Se({name:"ElOverlay",props:PAe,emits:UAe,setup(e,{slots:t,emit:o}){const i=lt(xAe),c=m=>{o("click",m)},{onClick:u,onMousedown:f,onMouseup:p}=IL(e.customMaskEvent?void 0:c);return()=>e.mask?Me("div",{class:[i.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:u,onMousedown:f,onMouseup:p},[We(t,"default")],Ks.STYLE|Ks.CLASS|Ks.PROPS,["onClick","onMouseup","onMousedown"]):Wt("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[We(t,"default")])}});const HL=FAe,QK=Symbol("dialogInjectionKey"),ZK=gt({center:Boolean,alignCenter:Boolean,closeIcon:{type:mo},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),VAe={close:()=>!0},GAe=["aria-level"],BAe=["aria-label"],$Ae=["id"],HAe=Se({name:"ElDialogContent"}),qAe=Se({...HAe,props:ZK,emits:VAe,setup(e){const t=e,{t:o}=Kn(),{Close:i}=iL,{dialogRef:c,headerRef:u,bodyId:f,ns:p,style:m}=wt(QK),{focusTrapRef:_}=wt(NL),b=K(()=>[p.b(),p.is("fullscreen",t.fullscreen),p.is("draggable",t.draggable),p.is("align-center",t.alignCenter),{[p.m("center")]:t.center}]),S=l1(_,c),T=K(()=>t.draggable),M=K(()=>t.overflow);return Wq(c,u,T,M),(R,E)=>(J(),ge("div",{ref:y(S),class:ne(y(b)),style:Ht(y(m)),tabindex:"-1"},[Ce("header",{ref_key:"headerRef",ref:u,class:ne([y(p).e("header"),{"show-close":R.showClose}])},[We(R.$slots,"header",{},()=>[Ce("span",{role:"heading","aria-level":R.ariaLevel,class:ne(y(p).e("title"))},pt(R.title),11,GAe)]),R.showClose?(J(),ge("button",{key:0,"aria-label":y(o)("el.dialog.close"),class:ne(y(p).e("headerbtn")),type:"button",onClick:E[0]||(E[0]=N=>R.$emit("close"))},[Me(y(Gt),{class:ne(y(p).e("close"))},{default:Ne(()=>[(J(),He(wn(R.closeIcon||y(i))))]),_:1},8,["class"])],10,BAe)):Fe("v-if",!0)],2),Ce("div",{id:y(f),class:ne(y(p).e("body"))},[We(R.$slots,"default")],10,$Ae),R.$slots.footer?(J(),ge("footer",{key:0,class:ne(y(p).e("footer"))},[We(R.$slots,"footer")],2)):Fe("v-if",!0)],6))}});var KAe=vt(qAe,[["__file","dialog-content.vue"]]);const ez=gt({...ZK,appendToBody:Boolean,appendTo:{type:Le(String),default:"body"},beforeClose:{type:Le(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),tz={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Mn]:e=>yr(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},nz=(e,t)=>{var o;const c=In().emit,{nextZIndex:u}=Bm();let f="";const p=pi(),m=pi(),_=ae(!1),b=ae(!1),S=ae(!1),T=ae((o=e.zIndex)!=null?o:u());let M,R;const E=II("namespace",p0),N=K(()=>{const he={},se=`--${E.value}-dialog`;return e.fullscreen||(e.top&&(he[`${se}-margin-top`]=e.top),e.width&&(he[`${se}-width`]=Xo(e.width))),he}),D=K(()=>e.alignCenter?{display:"flex"}:{});function x(){c("opened")}function L(){c("closed"),c(Mn,!1),e.destroyOnClose&&(S.value=!1)}function F(){c("close")}function H(){R==null||R(),M==null||M(),e.openDelay&&e.openDelay>0?{stop:M}=Wf(()=>Z(),e.openDelay):Z()}function B(){M==null||M(),R==null||R(),e.closeDelay&&e.closeDelay>0?{stop:R}=Wf(()=>$(),e.closeDelay):$()}function z(){function he(se){se||(b.value=!0,_.value=!1)}e.beforeClose?e.beforeClose(he):B()}function W(){e.closeOnClickModal&&z()}function Z(){$n&&(_.value=!0)}function $(){_.value=!1}function O(){c("openAutoFocus")}function X(){c("closeAutoFocus")}function le(he){var se;((se=he.detail)==null?void 0:se.focusReason)==="pointer"&&he.preventDefault()}e.lockScroll&&dL(_);function de(){e.closeOnPressEscape&&z()}return rt(()=>e.modelValue,he=>{he?(b.value=!1,H(),S.value=!0,T.value=Nq(e.zIndex)?u():T.value++,zt(()=>{c("open"),t.value&&(t.value.scrollTop=0)})):_.value&&B()}),rt(()=>e.fullscreen,he=>{t.value&&(he?(f=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=f)}),fn(()=>{e.modelValue&&(_.value=!0,S.value=!0,H())}),{afterEnter:x,afterLeave:L,beforeLeave:F,handleClose:z,onModalClick:W,close:B,doClose:$,onOpenAutoFocus:O,onCloseAutoFocus:X,onCloseRequested:de,onFocusoutPrevented:le,titleId:p,bodyId:m,closed:b,style:N,overlayDialogStyle:D,rendered:S,visible:_,zIndex:T}},zAe=["aria-label","aria-labelledby","aria-describedby"],WAe=Se({name:"ElDialog",inheritAttrs:!1}),jAe=Se({...WAe,props:ez,emits:tz,setup(e,{expose:t}){const o=e,i=zr();$r({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},K(()=>!!i.title));const c=lt("dialog"),u=ae(),f=ae(),p=ae(),{visible:m,titleId:_,bodyId:b,style:S,overlayDialogStyle:T,rendered:M,zIndex:R,afterEnter:E,afterLeave:N,beforeLeave:D,handleClose:x,onModalClick:L,onOpenAutoFocus:F,onCloseAutoFocus:H,onCloseRequested:B,onFocusoutPrevented:z}=nz(o,u);Ln(QK,{dialogRef:u,headerRef:f,bodyId:b,ns:c,rendered:M,style:S});const W=IL(L),Z=K(()=>o.draggable&&!o.fullscreen);return t({visible:m,dialogContentRef:p}),($,O)=>(J(),He(Lm,{to:$.appendTo,disabled:$.appendTo!=="body"?!1:!$.appendToBody},[Me(Rr,{name:"dialog-fade",onAfterEnter:y(E),onAfterLeave:y(N),onBeforeLeave:y(D),persisted:""},{default:Ne(()=>[hn(Me(y(HL),{"custom-mask-event":"",mask:$.modal,"overlay-class":$.modalClass,"z-index":y(R)},{default:Ne(()=>[Ce("div",{role:"dialog","aria-modal":"true","aria-label":$.title||void 0,"aria-labelledby":$.title?void 0:y(_),"aria-describedby":y(b),class:ne(`${y(c).namespace.value}-overlay-dialog`),style:Ht(y(T)),onClick:O[0]||(O[0]=(...X)=>y(W).onClick&&y(W).onClick(...X)),onMousedown:O[1]||(O[1]=(...X)=>y(W).onMousedown&&y(W).onMousedown(...X)),onMouseup:O[2]||(O[2]=(...X)=>y(W).onMouseup&&y(W).onMouseup(...X))},[Me(y(CI),{loop:"",trapped:y(m),"focus-start-el":"container",onFocusAfterTrapped:y(F),onFocusAfterReleased:y(H),onFocusoutPrevented:y(z),onReleaseRequested:y(B)},{default:Ne(()=>[y(M)?(J(),He(KAe,Nn({key:0,ref_key:"dialogContentRef",ref:p},$.$attrs,{center:$.center,"align-center":$.alignCenter,"close-icon":$.closeIcon,draggable:y(Z),overflow:$.overflow,fullscreen:$.fullscreen,"show-close":$.showClose,title:$.title,"aria-level":$.headerAriaLevel,onClose:y(x)}),kc({header:Ne(()=>[$.$slots.title?We($.$slots,"title",{key:1}):We($.$slots,"header",{key:0,close:y(x),titleId:y(_),titleClass:y(c).e("title")})]),default:Ne(()=>[We($.$slots,"default")]),_:2},[$.$slots.footer?{name:"footer",fn:Ne(()=>[We($.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):Fe("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,zAe)]),_:3},8,["mask","overlay-class","z-index"]),[[Jn,y(m)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}});var YAe=vt(jAe,[["__file","dialog.vue"]]);const JAe=bn(YAe),XAe=gt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Le(String),default:"solid"}}),QAe=Se({name:"ElDivider"}),ZAe=Se({...QAe,props:XAe,setup(e){const t=e,o=lt("divider"),i=K(()=>o.cssVar({"border-style":t.borderStyle}));return(c,u)=>(J(),ge("div",{class:ne([y(o).b(),y(o).m(c.direction)]),style:Ht(y(i)),role:"separator"},[c.$slots.default&&c.direction!=="vertical"?(J(),ge("div",{key:0,class:ne([y(o).e("text"),y(o).is(c.contentPosition)])},[We(c.$slots,"default")],2)):Fe("v-if",!0)],6))}});var eRe=vt(ZAe,[["__file","divider.vue"]]);const oz=bn(eRe),tRe=gt({...ez,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),nRe=tz,oRe=["aria-label","aria-labelledby","aria-describedby"],rRe=["id","aria-level"],iRe=["aria-label"],sRe=["id"],aRe=Se({name:"ElDrawer",inheritAttrs:!1}),lRe=Se({...aRe,props:tRe,emits:nRe,setup(e,{expose:t}){const o=e,i=zr();$r({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},K(()=>!!i.title));const c=ae(),u=ae(),f=lt("drawer"),{t:p}=Kn(),{afterEnter:m,afterLeave:_,beforeLeave:b,visible:S,rendered:T,titleId:M,bodyId:R,zIndex:E,onModalClick:N,onOpenAutoFocus:D,onCloseAutoFocus:x,onFocusoutPrevented:L,onCloseRequested:F,handleClose:H}=nz(o,c),B=K(()=>o.direction==="rtl"||o.direction==="ltr"),z=K(()=>Xo(o.size));return t({handleClose:H,afterEnter:m,afterLeave:_}),(W,Z)=>(J(),He(Lm,{to:"body",disabled:!W.appendToBody},[Me(Rr,{name:y(f).b("fade"),onAfterEnter:y(m),onAfterLeave:y(_),onBeforeLeave:y(b),persisted:""},{default:Ne(()=>[hn(Me(y(HL),{mask:W.modal,"overlay-class":W.modalClass,"z-index":y(E),onClick:y(N)},{default:Ne(()=>[Me(y(CI),{loop:"",trapped:y(S),"focus-trap-el":c.value,"focus-start-el":u.value,onFocusAfterTrapped:y(D),onFocusAfterReleased:y(x),onFocusoutPrevented:y(L),onReleaseRequested:y(F)},{default:Ne(()=>[Ce("div",Nn({ref_key:"drawerRef",ref:c,"aria-modal":"true","aria-label":W.title||void 0,"aria-labelledby":W.title?void 0:y(M),"aria-describedby":y(R)},W.$attrs,{class:[y(f).b(),W.direction,y(S)&&"open"],style:y(B)?"width: "+y(z):"height: "+y(z),role:"dialog",onClick:Z[1]||(Z[1]=nn(()=>{},["stop"]))}),[Ce("span",{ref_key:"focusStartRef",ref:u,class:ne(y(f).e("sr-focus")),tabindex:"-1"},null,2),W.withHeader?(J(),ge("header",{key:0,class:ne(y(f).e("header"))},[W.$slots.title?We(W.$slots,"title",{key:1},()=>[Fe(" DEPRECATED SLOT ")]):We(W.$slots,"header",{key:0,close:y(H),titleId:y(M),titleClass:y(f).e("title")},()=>[W.$slots.title?Fe("v-if",!0):(J(),ge("span",{key:0,id:y(M),role:"heading","aria-level":W.headerAriaLevel,class:ne(y(f).e("title"))},pt(W.title),11,rRe))]),W.showClose?(J(),ge("button",{key:2,"aria-label":y(p)("el.drawer.close"),class:ne(y(f).e("close-btn")),type:"button",onClick:Z[0]||(Z[0]=(...$)=>y(H)&&y(H)(...$))},[Me(y(Gt),{class:ne(y(f).e("close"))},{default:Ne(()=>[Me(y(La))]),_:1},8,["class"])],10,iRe)):Fe("v-if",!0)],2)):Fe("v-if",!0),y(T)?(J(),ge("div",{key:1,id:y(R),class:ne(y(f).e("body"))},[We(W.$slots,"default")],10,sRe)):Fe("v-if",!0),W.$slots.footer?(J(),ge("div",{key:2,class:ne(y(f).e("footer"))},[We(W.$slots,"footer")],2)):Fe("v-if",!0)],16,oRe)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Jn,y(S)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var cRe=vt(lRe,[["__file","drawer.vue"]]);const uRe=bn(cRe),dRe=Se({inheritAttrs:!1});function hRe(e,t,o,i,c,u){return We(e.$slots,"default")}var fRe=vt(dRe,[["render",hRe],["__file","collection.vue"]]);const pRe=Se({name:"ElCollectionItem",inheritAttrs:!1});function gRe(e,t,o,i,c,u){return We(e.$slots,"default")}var mRe=vt(pRe,[["render",gRe],["__file","collection-item.vue"]]);const rz="data-el-collection-item",iz=e=>{const t=`El${e}Collection`,o=`${t}Item`,i=Symbol(t),c=Symbol(o),u={...fRe,name:t,setup(){const p=ae(null),m=new Map;Ln(i,{itemMap:m,getItems:()=>{const b=y(p);if(!b)return[];const S=Array.from(b.querySelectorAll(`[${rz}]`));return[...m.values()].sort((M,R)=>S.indexOf(M.ref)-S.indexOf(R.ref))},collectionRef:p})}},f={...mRe,name:o,setup(p,{attrs:m}){const _=ae(null),b=wt(i,void 0);Ln(c,{collectionItemRef:_}),fn(()=>{const S=y(_);S&&b.itemMap.set(S,{ref:S,...m})}),Ro(()=>{const S=y(_);b.itemMap.delete(S)})}};return{COLLECTION_INJECTION_KEY:i,COLLECTION_ITEM_INJECTION_KEY:c,ElCollection:u,ElCollectionItem:f}},vRe=gt({style:{type:Le([String,Array,Object])},currentTabId:{type:Le(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:Le(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:_Re,ElCollectionItem:yRe,COLLECTION_INJECTION_KEY:qL,COLLECTION_ITEM_INJECTION_KEY:IRe}=iz("RovingFocusGroup"),KL=Symbol("elRovingFocusGroup"),sz=Symbol("elRovingFocusGroupItem"),bRe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},CRe=(e,t)=>e,SRe=(e,t,o)=>{const i=CRe(e.key);return bRe[i]},TRe=(e,t)=>e.map((o,i)=>e[(i+t)%e.length]),zL=e=>{const{activeElement:t}=document;for(const o of e)if(o===t||(o.focus(),t!==document.activeElement))return},FB="currentTabIdChange",VB="rovingFocusGroup.entryFocus",ERe={bubbles:!1,cancelable:!0},MRe=Se({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:vRe,emits:[FB,"entryFocus"],setup(e,{emit:t}){var o;const i=ae((o=e.currentTabId||e.defaultCurrentTabId)!=null?o:null),c=ae(!1),u=ae(!1),f=ae(null),{getItems:p}=wt(qL,void 0),m=K(()=>[{outline:"none"},e.style]),_=E=>{t(FB,E)},b=()=>{c.value=!0},S=Jo(E=>{var N;(N=e.onMousedown)==null||N.call(e,E)},()=>{u.value=!0}),T=Jo(E=>{var N;(N=e.onFocus)==null||N.call(e,E)},E=>{const N=!y(u),{target:D,currentTarget:x}=E;if(D===x&&N&&!y(c)){const L=new Event(VB,ERe);if(x==null||x.dispatchEvent(L),!L.defaultPrevented){const F=p().filter(Z=>Z.focusable),H=F.find(Z=>Z.active),B=F.find(Z=>Z.id===y(i)),W=[H,B,...F].filter(Boolean).map(Z=>Z.ref);zL(W)}}u.value=!1}),M=Jo(E=>{var N;(N=e.onBlur)==null||N.call(e,E)},()=>{c.value=!1}),R=(...E)=>{t("entryFocus",...E)};Ln(KL,{currentTabbedId:Nm(i),loop:Io(e,"loop"),tabIndex:K(()=>y(c)?-1:0),rovingFocusGroupRef:f,rovingFocusGroupRootStyle:m,orientation:Io(e,"orientation"),dir:Io(e,"dir"),onItemFocus:_,onItemShiftTab:b,onBlur:M,onFocus:T,onMousedown:S}),rt(()=>e.currentTabId,E=>{i.value=E??null}),Oo(f,VB,R)}});function kRe(e,t,o,i,c,u){return We(e.$slots,"default")}var ARe=vt(MRe,[["render",kRe],["__file","roving-focus-group-impl.vue"]]);const RRe=Se({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:_Re,ElRovingFocusGroupImpl:ARe}});function wRe(e,t,o,i,c,u){const f=pn("el-roving-focus-group-impl"),p=pn("el-focus-group-collection");return J(),He(p,null,{default:Ne(()=>[Me(f,bc(dm(e.$attrs)),{default:Ne(()=>[We(e.$slots,"default")]),_:3},16)]),_:3})}var DRe=vt(RRe,[["render",wRe],["__file","roving-focus-group.vue"]]);const ORe=Se({components:{ElRovingFocusCollectionItem:yRe},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:o,loop:i,onItemFocus:c,onItemShiftTab:u}=wt(KL,void 0),{getItems:f}=wt(qL,void 0),p=pi(),m=ae(null),_=Jo(M=>{t("mousedown",M)},M=>{e.focusable?c(y(p)):M.preventDefault()}),b=Jo(M=>{t("focus",M)},()=>{c(y(p))}),S=Jo(M=>{t("keydown",M)},M=>{const{key:R,shiftKey:E,target:N,currentTarget:D}=M;if(R===Yt.tab&&E){u();return}if(N!==D)return;const x=SRe(M);if(x){M.preventDefault();let F=f().filter(H=>H.focusable).map(H=>H.ref);switch(x){case"last":{F.reverse();break}case"prev":case"next":{x==="prev"&&F.reverse();const H=F.indexOf(D);F=i.value?TRe(F,H+1):F.slice(H+1);break}}zt(()=>{zL(F)})}}),T=K(()=>o.value===y(p));return Ln(sz,{rovingFocusGroupItemRef:m,tabIndex:K(()=>y(T)?0:-1),handleMousedown:_,handleFocus:b,handleKeydown:S}),{id:p,handleKeydown:S,handleFocus:b,handleMousedown:_}}});function NRe(e,t,o,i,c,u){const f=pn("el-roving-focus-collection-item");return J(),He(f,{id:e.id,focusable:e.focusable,active:e.active},{default:Ne(()=>[We(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var LRe=vt(ORe,[["render",NRe],["__file","roving-focus-item.vue"]]);const KT=gt({trigger:K0.trigger,effect:{...Gr.effect,default:"light"},type:{type:Le(String)},placement:{type:Le(String),default:"bottom"},popperOptions:{type:Le(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:Le([Number,String]),default:0},maxHeight:{type:Le([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:Le(Object)},teleported:Gr.teleported}),az=gt({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:mo}}),PRe=gt({onKeydown:{type:Le(Function)}}),URe=[Yt.down,Yt.pageDown,Yt.home],lz=[Yt.up,Yt.pageUp,Yt.end],xRe=[...URe,...lz],{ElCollection:FRe,ElCollectionItem:VRe,COLLECTION_INJECTION_KEY:GRe,COLLECTION_ITEM_INJECTION_KEY:BRe}=iz("Dropdown"),y1=Symbol("elDropdown"),{ButtonGroup:$Re}=qr,HRe=Se({name:"ElDropdown",components:{ElButton:qr,ElButtonGroup:$Re,ElScrollbar:xc,ElDropdownCollection:FRe,ElTooltip:Di,ElRovingFocusGroup:DRe,ElOnlyChild:L9,ElIcon:Gt,ArrowDown:Pc},props:KT,emits:["visible-change","click","command"],setup(e,{emit:t}){const o=In(),i=lt("dropdown"),{t:c}=Kn(),u=ae(),f=ae(),p=ae(null),m=ae(null),_=ae(null),b=ae(null),S=ae(!1),T=[Yt.enter,Yt.space,Yt.down],M=K(()=>({maxHeight:Xo(e.maxHeight)})),R=K(()=>[i.m(H.value)]),E=K(()=>vd(e.trigger)),N=pi().value,D=K(()=>e.id||N);rt([u,E],([ie,oe],[ee])=>{var Q,ue,me;(Q=ee==null?void 0:ee.$el)!=null&&Q.removeEventListener&&ee.$el.removeEventListener("pointerenter",z),(ue=ie==null?void 0:ie.$el)!=null&&ue.removeEventListener&&ie.$el.removeEventListener("pointerenter",z),(me=ie==null?void 0:ie.$el)!=null&&me.addEventListener&&oe.includes("hover")&&ie.$el.addEventListener("pointerenter",z)},{immediate:!0}),Ro(()=>{var ie,oe;(oe=(ie=u.value)==null?void 0:ie.$el)!=null&&oe.removeEventListener&&u.value.$el.removeEventListener("pointerenter",z)});function x(){L()}function L(){var ie;(ie=p.value)==null||ie.onClose()}function F(){var ie;(ie=p.value)==null||ie.onOpen()}const H=Tr();function B(...ie){t("command",...ie)}function z(){var ie,oe;(oe=(ie=u.value)==null?void 0:ie.$el)==null||oe.focus()}function W(){}function Z(){const ie=y(m);E.value.includes("hover")&&(ie==null||ie.focus()),b.value=null}function $(ie){b.value=ie}function O(ie){S.value||(ie.preventDefault(),ie.stopImmediatePropagation())}function X(){t("visible-change",!0)}function le(ie){(ie==null?void 0:ie.type)==="keydown"&&m.value.focus()}function de(){t("visible-change",!1)}return Ln(y1,{contentRef:m,role:K(()=>e.role),triggerId:D,isUsingKeyboard:S,onItemEnter:W,onItemLeave:Z}),Ln("elDropdown",{instance:o,dropdownSize:H,handleClick:x,commandHandler:B,trigger:Io(e,"trigger"),hideOnClick:Io(e,"hideOnClick")}),{t:c,ns:i,scrollbar:_,wrapStyle:M,dropdownTriggerKls:R,dropdownSize:H,triggerId:D,triggerKeys:T,currentTabId:b,handleCurrentTabIdChange:$,handlerMainButtonClick:ie=>{t("click",ie)},handleEntryFocus:O,handleClose:L,handleOpen:F,handleBeforeShowTooltip:X,handleShowTooltip:le,handleBeforeHideTooltip:de,onFocusAfterTrapped:ie=>{var oe,ee;ie.preventDefault(),(ee=(oe=m.value)==null?void 0:oe.focus)==null||ee.call(oe,{preventScroll:!0})},popperRef:p,contentRef:m,triggeringElementRef:u,referenceElementRef:f}}});function qRe(e,t,o,i,c,u){var f;const p=pn("el-dropdown-collection"),m=pn("el-roving-focus-group"),_=pn("el-scrollbar"),b=pn("el-only-child"),S=pn("el-tooltip"),T=pn("el-button"),M=pn("arrow-down"),R=pn("el-icon"),E=pn("el-button-group");return J(),ge("div",{class:ne([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Me(S,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(f=e.referenceElementRef)==null?void 0:f.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},kc({content:Ne(()=>[Me(_,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:Ne(()=>[Me(m,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:Ne(()=>[Me(p,null,{default:Ne(()=>[We(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:Ne(()=>[Me(b,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:Ne(()=>[We(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(J(),He(E,{key:0},{default:Ne(()=>[Me(T,Nn({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:Ne(()=>[We(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Me(T,Nn({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:Ne(()=>[Me(R,{class:ne(e.ns.e("icon"))},{default:Ne(()=>[Me(M)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):Fe("v-if",!0)],2)}var KRe=vt(HRe,[["render",qRe],["__file","dropdown.vue"]]);const zRe=Se({name:"DropdownItemImpl",components:{ElIcon:Gt},props:az,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const o=lt("dropdown"),{role:i}=wt(y1,void 0),{collectionItemRef:c}=wt(BRe,void 0),{collectionItemRef:u}=wt(IRe,void 0),{rovingFocusGroupItemRef:f,tabIndex:p,handleFocus:m,handleKeydown:_,handleMousedown:b}=wt(sz,void 0),S=l1(c,u,f),T=K(()=>i.value==="menu"?"menuitem":i.value==="navigation"?"link":"button"),M=Jo(R=>{const{code:E}=R;if(E===Yt.enter||E===Yt.space)return R.preventDefault(),R.stopImmediatePropagation(),t("clickimpl",R),!0},_);return{ns:o,itemRef:S,dataset:{[rz]:""},role:T,tabIndex:p,handleFocus:m,handleKeydown:M,handleMousedown:b}}}),WRe=["aria-disabled","tabindex","role"];function jRe(e,t,o,i,c,u){const f=pn("el-icon");return J(),ge(qt,null,[e.divided?(J(),ge("li",Nn({key:0,role:"separator",class:e.ns.bem("menu","item","divided")},e.$attrs),null,16)):Fe("v-if",!0),Ce("li",Nn({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:t[0]||(t[0]=p=>e.$emit("clickimpl",p)),onFocus:t[1]||(t[1]=(...p)=>e.handleFocus&&e.handleFocus(...p)),onKeydown:t[2]||(t[2]=nn((...p)=>e.handleKeydown&&e.handleKeydown(...p),["self"])),onMousedown:t[3]||(t[3]=(...p)=>e.handleMousedown&&e.handleMousedown(...p)),onPointermove:t[4]||(t[4]=p=>e.$emit("pointermove",p)),onPointerleave:t[5]||(t[5]=p=>e.$emit("pointerleave",p))}),[e.icon?(J(),He(f,{key:0},{default:Ne(()=>[(J(),He(wn(e.icon)))]),_:1})):Fe("v-if",!0),We(e.$slots,"default")],16,WRe)],64)}var YRe=vt(zRe,[["render",jRe],["__file","dropdown-item-impl.vue"]]);const cz=()=>{const e=wt("elDropdown",{}),t=K(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},JRe=Se({name:"ElDropdownItem",components:{ElDropdownCollectionItem:VRe,ElRovingFocusItem:LRe,ElDropdownItemImpl:YRe},inheritAttrs:!1,props:az,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:o}){const{elDropdown:i}=cz(),c=In(),u=ae(null),f=K(()=>{var M,R;return(R=(M=y(u))==null?void 0:M.textContent)!=null?R:""}),{onItemEnter:p,onItemLeave:m}=wt(y1,void 0),_=Jo(M=>(t("pointermove",M),M.defaultPrevented),L5(M=>{if(e.disabled){m(M);return}const R=M.currentTarget;R===document.activeElement||R.contains(document.activeElement)||(p(M),M.defaultPrevented||R==null||R.focus())})),b=Jo(M=>(t("pointerleave",M),M.defaultPrevented),L5(M=>{m(M)})),S=Jo(M=>{if(!e.disabled)return t("click",M),M.type!=="keydown"&&M.defaultPrevented},M=>{var R,E,N;if(e.disabled){M.stopImmediatePropagation();return}(R=i==null?void 0:i.hideOnClick)!=null&&R.value&&((E=i.handleClick)==null||E.call(i)),(N=i.commandHandler)==null||N.call(i,e.command,c,M)}),T=K(()=>({...e,...o}));return{handleClick:S,handlePointerMove:_,handlePointerLeave:b,textContent:f,propsAndAttrs:T}}});function XRe(e,t,o,i,c,u){var f;const p=pn("el-dropdown-item-impl"),m=pn("el-roving-focus-item"),_=pn("el-dropdown-collection-item");return J(),He(_,{disabled:e.disabled,"text-value":(f=e.textValue)!=null?f:e.textContent},{default:Ne(()=>[Me(m,{focusable:!e.disabled},{default:Ne(()=>[Me(p,Nn(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:Ne(()=>[We(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var uz=vt(JRe,[["render",XRe],["__file","dropdown-item.vue"]]);const QRe=Se({name:"ElDropdownMenu",props:PRe,setup(e){const t=lt("dropdown"),{_elDropdownSize:o}=cz(),i=o.value,{focusTrapRef:c,onKeydown:u}=wt(NL,void 0),{contentRef:f,role:p,triggerId:m}=wt(y1,void 0),{collectionRef:_,getItems:b}=wt(GRe,void 0),{rovingFocusGroupRef:S,rovingFocusGroupRootStyle:T,tabIndex:M,onBlur:R,onFocus:E,onMousedown:N}=wt(KL,void 0),{collectionRef:D}=wt(qL,void 0),x=K(()=>[t.b("menu"),t.bm("menu",i==null?void 0:i.value)]),L=l1(f,_,c,S,D),F=Jo(B=>{var z;(z=e.onKeydown)==null||z.call(e,B)},B=>{const{currentTarget:z,code:W,target:Z}=B;if(z.contains(Z),Yt.tab===W&&B.stopImmediatePropagation(),B.preventDefault(),Z!==y(f)||!xRe.includes(W))return;const O=b().filter(X=>!X.disabled).map(X=>X.ref);lz.includes(W)&&O.reverse(),zL(O)});return{size:i,rovingFocusGroupRootStyle:T,tabIndex:M,dropdownKls:x,role:p,triggerId:m,dropdownListWrapperRef:L,handleKeydown:B=>{F(B),u(B)},onBlur:R,onFocus:E,onMousedown:N}}}),ZRe=["role","aria-labelledby"];function ewe(e,t,o,i,c,u){return J(),ge("ul",{ref:e.dropdownListWrapperRef,class:ne(e.dropdownKls),style:Ht(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:t[0]||(t[0]=(...f)=>e.onBlur&&e.onBlur(...f)),onFocus:t[1]||(t[1]=(...f)=>e.onFocus&&e.onFocus(...f)),onKeydown:t[2]||(t[2]=nn((...f)=>e.handleKeydown&&e.handleKeydown(...f),["self"])),onMousedown:t[3]||(t[3]=nn((...f)=>e.onMousedown&&e.onMousedown(...f),["self"]))},[We(e.$slots,"default")],46,ZRe)}var dz=vt(QRe,[["render",ewe],["__file","dropdown-menu.vue"]]);const twe=bn(KRe,{DropdownItem:uz,DropdownMenu:dz}),nwe=Wo(uz),owe=Wo(dz),rwe={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},iwe=["id"],swe=["stop-color"],awe=["stop-color"],lwe=["id"],cwe=["stop-color"],uwe=["stop-color"],dwe=["id"],hwe={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},fwe={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},pwe={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},gwe=["fill"],mwe=["fill"],vwe={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},_we=["fill"],ywe=["fill"],Iwe=["fill"],bwe=["fill"],Cwe=["fill"],Swe={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},Twe=["fill","xlink:href"],Ewe=["fill","mask"],Mwe=["fill"],kwe=Se({name:"ImgEmpty"}),Awe=Se({...kwe,setup(e){const t=lt("empty"),o=pi();return(i,c)=>(J(),ge("svg",rwe,[Ce("defs",null,[Ce("linearGradient",{id:`linearGradient-1-${y(o)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ce("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,swe),Ce("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,awe)],8,iwe),Ce("linearGradient",{id:`linearGradient-2-${y(o)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ce("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,cwe),Ce("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,uwe)],8,lwe),Ce("rect",{id:`path-3-${y(o)}`,x:"0",y:"0",width:"17",height:"36"},null,8,dwe)]),Ce("g",hwe,[Ce("g",fwe,[Ce("g",pwe,[Ce("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,gwe),Ce("polygon",{id:"Rectangle-Copy-14",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,mwe),Ce("g",vwe,[Ce("polygon",{id:"Rectangle-Copy-10",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,_we),Ce("polygon",{id:"Rectangle-Copy-11",fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,ywe),Ce("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${y(o)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,Iwe),Ce("polygon",{id:"Rectangle-Copy-13",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,bwe)]),Ce("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${y(o)})`,x:"13",y:"45",width:"40",height:"36"},null,8,Cwe),Ce("g",Swe,[Ce("use",{id:"Mask",fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(o)}`},null,8,Twe),Ce("polygon",{id:"Rectangle-Copy",fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(o)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,Ewe)]),Ce("polygon",{id:"Rectangle-Copy-18",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,Mwe)])])])]))}});var Rwe=vt(Awe,[["__file","img-empty.vue"]]);const wwe=gt({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Dwe=["src"],Owe={key:1},Nwe=Se({name:"ElEmpty"}),Lwe=Se({...Nwe,props:wwe,setup(e){const t=e,{t:o}=Kn(),i=lt("empty"),c=K(()=>t.description||o("el.table.emptyText")),u=K(()=>({width:Xo(t.imageSize)}));return(f,p)=>(J(),ge("div",{class:ne(y(i).b())},[Ce("div",{class:ne(y(i).e("image")),style:Ht(y(u))},[f.image?(J(),ge("img",{key:0,src:f.image,ondragstart:"return false"},null,8,Dwe)):We(f.$slots,"image",{key:1},()=>[Me(Rwe)])],6),Ce("div",{class:ne(y(i).e("description"))},[f.$slots.description?We(f.$slots,"description",{key:0}):(J(),ge("p",Owe,pt(y(c)),1))],2),f.$slots.default?(J(),ge("div",{key:0,class:ne(y(i).e("bottom"))},[We(f.$slots,"default")],2)):Fe("v-if",!0)],2))}});var Pwe=vt(Lwe,[["__file","empty.vue"]]);const hz=bn(Pwe),Uwe=gt({urlList:{type:Le(Array),default:()=>zo([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Le(String)}}),xwe={close:()=>!0,switch:e=>Zt(e),rotate:e=>Zt(e)},Fwe=["src","crossorigin"],Vwe=Se({name:"ElImageViewer"}),Gwe=Se({...Vwe,props:Uwe,emits:xwe,setup(e,{expose:t,emit:o}){var i;const c=e,u={CONTAIN:{name:"contain",icon:Zg(Qve)},ORIGINAL:{name:"original",icon:Zg(__e)}},{t:f}=Kn(),p=lt("image-viewer"),{nextZIndex:m}=Bm(),_=ae(),b=ae([]),S=Qie(),T=ae(!0),M=ae(c.initialIndex),R=Do(u.CONTAIN),E=ae({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),N=ae((i=c.zIndex)!=null?i:m()),D=K(()=>{const{urlList:Q}=c;return Q.length<=1}),x=K(()=>M.value===0),L=K(()=>M.value===c.urlList.length-1),F=K(()=>c.urlList[M.value]),H=K(()=>[p.e("btn"),p.e("prev"),p.is("disabled",!c.infinite&&x.value)]),B=K(()=>[p.e("btn"),p.e("next"),p.is("disabled",!c.infinite&&L.value)]),z=K(()=>{const{scale:Q,deg:ue,offsetX:me,offsetY:be,enableTransition:ke}=E.value;let Ye=me/Q,Oe=be/Q;switch(ue%360){case 90:case-270:[Ye,Oe]=[Oe,-Ye];break;case 180:case-180:[Ye,Oe]=[-Ye,-Oe];break;case 270:case-90:[Ye,Oe]=[-Oe,Ye];break}const Ee={transform:`scale(${Q}) rotate(${ue}deg) translate(${Ye}px, ${Oe}px)`,transition:ke?"transform .3s":""};return R.value.name===u.CONTAIN.name&&(Ee.maxWidth=Ee.maxHeight="100%"),Ee});function W(){$(),o("close")}function Z(){const Q=$f(me=>{switch(me.code){case Yt.esc:c.closeOnPressEscape&&W();break;case Yt.space:he();break;case Yt.left:ie();break;case Yt.up:ee("zoomIn");break;case Yt.right:oe();break;case Yt.down:ee("zoomOut");break}}),ue=$f(me=>{const be=me.deltaY||me.deltaX;ee(be<0?"zoomIn":"zoomOut",{zoomRate:c.zoomRate,enableTransition:!1})});S.run(()=>{Oo(document,"keydown",Q),Oo(document,"wheel",ue)})}function $(){S.stop()}function O(){T.value=!1}function X(Q){T.value=!1,Q.target.alt=f("el.image.error")}function le(Q){if(T.value||Q.button!==0||!_.value)return;E.value.enableTransition=!1;const{offsetX:ue,offsetY:me}=E.value,be=Q.pageX,ke=Q.pageY,Ye=$f(Ee=>{E.value={...E.value,offsetX:ue+Ee.pageX-be,offsetY:me+Ee.pageY-ke}}),Oe=Oo(document,"mousemove",Ye);Oo(document,"mouseup",()=>{Oe()}),Q.preventDefault()}function de(){E.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function he(){if(T.value)return;const Q=ym(u),ue=Object.values(u),me=R.value.name,ke=(ue.findIndex(Ye=>Ye.name===me)+1)%Q.length;R.value=u[Q[ke]],de()}function se(Q){const ue=c.urlList.length;M.value=(Q+ue)%ue}function ie(){x.value&&!c.infinite||se(M.value-1)}function oe(){L.value&&!c.infinite||se(M.value+1)}function ee(Q,ue={}){if(T.value)return;const{minScale:me,maxScale:be}=c,{zoomRate:ke,rotateDeg:Ye,enableTransition:Oe}={zoomRate:c.zoomRate,rotateDeg:90,enableTransition:!0,...ue};switch(Q){case"zoomOut":E.value.scale>me&&(E.value.scale=Number.parseFloat((E.value.scale/ke).toFixed(3)));break;case"zoomIn":E.value.scale<be&&(E.value.scale=Number.parseFloat((E.value.scale*ke).toFixed(3)));break;case"clockwise":E.value.deg+=Ye,o("rotate",E.value.deg);break;case"anticlockwise":E.value.deg-=Ye,o("rotate",E.value.deg);break}E.value.enableTransition=Oe}return rt(F,()=>{zt(()=>{const Q=b.value[0];Q!=null&&Q.complete||(T.value=!0)})}),rt(M,Q=>{de(),o("switch",Q)}),fn(()=>{var Q,ue;Z(),(ue=(Q=_.value)==null?void 0:Q.focus)==null||ue.call(Q)}),t({setActiveItem:se}),(Q,ue)=>(J(),He(Lm,{to:"body",disabled:!Q.teleported},[Me(Rr,{name:"viewer-fade",appear:""},{default:Ne(()=>[Ce("div",{ref_key:"wrapper",ref:_,tabindex:-1,class:ne(y(p).e("wrapper")),style:Ht({zIndex:N.value})},[Ce("div",{class:ne(y(p).e("mask")),onClick:ue[0]||(ue[0]=nn(me=>Q.hideOnClickModal&&W(),["self"]))},null,2),Fe(" CLOSE "),Ce("span",{class:ne([y(p).e("btn"),y(p).e("close")]),onClick:W},[Me(y(Gt),null,{default:Ne(()=>[Me(y(La))]),_:1})],2),Fe(" ARROW "),y(D)?Fe("v-if",!0):(J(),ge(qt,{key:0},[Ce("span",{class:ne(y(H)),onClick:ie},[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1})],2),Ce("span",{class:ne(y(B)),onClick:oe},[Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})],2)],64)),Fe(" ACTIONS "),Ce("div",{class:ne([y(p).e("btn"),y(p).e("actions")])},[Ce("div",{class:ne(y(p).e("actions__inner"))},[Me(y(Gt),{onClick:ue[1]||(ue[1]=me=>ee("zoomOut"))},{default:Ne(()=>[Me(y(L_e))]),_:1}),Me(y(Gt),{onClick:ue[2]||(ue[2]=me=>ee("zoomIn"))},{default:Ne(()=>[Me(y($q))]),_:1}),Ce("i",{class:ne(y(p).e("actions__divider"))},null,2),Me(y(Gt),{onClick:he},{default:Ne(()=>[(J(),He(wn(y(R).icon)))]),_:1}),Ce("i",{class:ne(y(p).e("actions__divider"))},null,2),Me(y(Gt),{onClick:ue[3]||(ue[3]=me=>ee("anticlockwise"))},{default:Ne(()=>[Me(y(p_e))]),_:1}),Me(y(Gt),{onClick:ue[4]||(ue[4]=me=>ee("clockwise"))},{default:Ne(()=>[Me(y(m_e))]),_:1})],2)],2),Fe(" CANVAS "),Ce("div",{class:ne(y(p).e("canvas"))},[(J(!0),ge(qt,null,Vn(Q.urlList,(me,be)=>hn((J(),ge("img",{ref_for:!0,ref:ke=>b.value[be]=ke,key:me,src:me,style:Ht(y(z)),class:ne(y(p).e("img")),crossorigin:Q.crossorigin,onLoad:O,onError:X,onMousedown:le},null,46,Fwe)),[[Jn,be===M.value]])),128))],2),We(Q.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Bwe=vt(Gwe,[["__file","image-viewer.vue"]]);const fz=bn(Bwe),$we=gt({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Le([String,Object])},previewSrcList:{type:Le(Array),default:()=>zo([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Le(String)}}),Hwe={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Zt(e),close:()=>!0,show:()=>!0},qwe=["src","loading","crossorigin"],Kwe={key:0},zwe=Se({name:"ElImage",inheritAttrs:!1}),Wwe=Se({...zwe,props:$we,emits:Hwe,setup(e,{emit:t}){const o=e;let i="";const{t:c}=Kn(),u=lt("image"),f=tp(),p=cL(),m=ae(),_=ae(!1),b=ae(!0),S=ae(!1),T=ae(),M=ae(),R=$n&&"loading"in HTMLImageElement.prototype;let E,N;const D=K(()=>[u.e("inner"),F.value&&u.e("preview"),b.value&&u.is("loading")]),x=K(()=>f.style),L=K(()=>{const{fit:oe}=o;return $n&&oe?{objectFit:oe}:{}}),F=K(()=>{const{previewSrcList:oe}=o;return Array.isArray(oe)&&oe.length>0}),H=K(()=>{const{previewSrcList:oe,initialIndex:ee}=o;let Q=ee;return ee>oe.length-1&&(Q=0),Q}),B=K(()=>o.loading==="eager"?!1:!R&&o.loading==="lazy"||o.lazy),z=()=>{$n&&(b.value=!0,_.value=!1,m.value=o.src)};function W(oe){b.value=!1,_.value=!1,t("load",oe)}function Z(oe){b.value=!1,_.value=!0,t("error",oe)}function $(){Wde(T.value,M.value)&&(z(),le())}const O=q7($,200,!0);async function X(){var oe;if(!$n)return;await zt();const{scrollContainer:ee}=o;ra(ee)?M.value=ee:on(ee)&&ee!==""?M.value=(oe=document.querySelector(ee))!=null?oe:void 0:T.value&&(M.value=eL(T.value)),M.value&&(E=Oo(M,"scroll",O),setTimeout(()=>$(),100))}function le(){!$n||!M.value||!O||(E==null||E(),M.value=void 0)}function de(oe){if(oe.ctrlKey){if(oe.deltaY<0)return oe.preventDefault(),!1;if(oe.deltaY>0)return oe.preventDefault(),!1}}function he(){F.value&&(N=Oo("wheel",de,{passive:!1}),i=document.body.style.overflow,document.body.style.overflow="hidden",S.value=!0,t("show"))}function se(){N==null||N(),document.body.style.overflow=i,S.value=!1,t("close")}function ie(oe){t("switch",oe)}return rt(()=>o.src,()=>{B.value?(b.value=!0,_.value=!1,le(),X()):z()}),fn(()=>{B.value?X():z()}),(oe,ee)=>(J(),ge("div",{ref_key:"container",ref:T,class:ne([y(u).b(),oe.$attrs.class]),style:Ht(y(x))},[_.value?We(oe.$slots,"error",{key:0},()=>[Ce("div",{class:ne(y(u).e("error"))},pt(y(c)("el.image.error")),3)]):(J(),ge(qt,{key:1},[m.value!==void 0?(J(),ge("img",Nn({key:0},y(p),{src:m.value,loading:oe.loading,style:y(L),class:y(D),crossorigin:oe.crossorigin,onClick:he,onLoad:W,onError:Z}),null,16,qwe)):Fe("v-if",!0),b.value?(J(),ge("div",{key:1,class:ne(y(u).e("wrapper"))},[We(oe.$slots,"placeholder",{},()=>[Ce("div",{class:ne(y(u).e("placeholder"))},null,2)])],2)):Fe("v-if",!0)],64)),y(F)?(J(),ge(qt,{key:2},[S.value?(J(),He(y(fz),{key:0,"z-index":oe.zIndex,"initial-index":y(H),infinite:oe.infinite,"zoom-rate":oe.zoomRate,"min-scale":oe.minScale,"max-scale":oe.maxScale,"url-list":oe.previewSrcList,"hide-on-click-modal":oe.hideOnClickModal,teleported:oe.previewTeleported,"close-on-press-escape":oe.closeOnPressEscape,onClose:se,onSwitch:ie},{default:Ne(()=>[oe.$slots.viewer?(J(),ge("div",Kwe,[We(oe.$slots,"viewer")])):Fe("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):Fe("v-if",!0)],64)):Fe("v-if",!0)],6))}});var jwe=vt(Wwe,[["__file","image.vue"]]);const Ywe=bn(jwe),Jwe=gt({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Nr,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||Zt(e)||["min","max"].includes(e),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...ti(["ariaLabel"])}),Xwe={[Lo]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Hi]:e=>Zt(e)||Hr(e),[Mn]:e=>Zt(e)||Hr(e)},Qwe=["aria-label","onKeydown"],Zwe=["aria-label","onKeydown"],eDe=Se({name:"ElInputNumber"}),tDe=Se({...eDe,props:Jwe,emits:Xwe,setup(e,{expose:t,emit:o}){const i=e,{t:c}=Kn(),u=lt("input-number"),f=ae(),p=Zn({currentValue:i.modelValue,userInput:null}),{formItem:m}=Oi(),_=K(()=>Zt(i.modelValue)&&i.modelValue<=i.min),b=K(()=>Zt(i.modelValue)&&i.modelValue>=i.max),S=K(()=>{const he=D(i.step);return _r(i.precision)?Math.max(D(i.modelValue),he):(he>i.precision,i.precision)}),T=K(()=>i.controls&&i.controlsPosition==="right"),M=Tr(),R=zi(),E=K(()=>{if(p.userInput!==null)return p.userInput;let he=p.currentValue;if(Hr(he))return"";if(Zt(he)){if(Number.isNaN(he))return"";_r(i.precision)||(he=he.toFixed(i.precision))}return he}),N=(he,se)=>{if(_r(se)&&(se=S.value),se===0)return Math.round(he);let ie=String(he);const oe=ie.indexOf(".");if(oe===-1||!ie.replace(".","").split("")[oe+se])return he;const ue=ie.length;return ie.charAt(ue-1)==="5"&&(ie=`${ie.slice(0,Math.max(0,ue-1))}6`),Number.parseFloat(Number(ie).toFixed(se))},D=he=>{if(Hr(he))return 0;const se=he.toString(),ie=se.indexOf(".");let oe=0;return ie!==-1&&(oe=se.length-ie-1),oe},x=(he,se=1)=>Zt(he)?N(he+i.step*se):p.currentValue,L=()=>{if(i.readonly||R.value||b.value)return;const he=Number(E.value)||0,se=x(he);B(se),o(Hi,p.currentValue),le()},F=()=>{if(i.readonly||R.value||_.value)return;const he=Number(E.value)||0,se=x(he,-1);B(se),o(Hi,p.currentValue),le()},H=(he,se)=>{const{max:ie,min:oe,step:ee,precision:Q,stepStrictly:ue,valueOnClear:me}=i;ie<oe&&wr("InputNumber","min should not be greater than max.");let be=Number(he);if(Hr(he)||Number.isNaN(be))return null;if(he===""){if(me===null)return null;be=on(me)?{min:oe,max:ie}[me]:me}return ue&&(be=N(Math.round(be/ee)*ee,Q)),_r(Q)||(be=N(be,Q)),(be>ie||be<oe)&&(be=be>ie?ie:oe,se&&o(Mn,be)),be},B=(he,se=!0)=>{var ie;const oe=p.currentValue,ee=H(he);if(!se){o(Mn,ee);return}oe===ee&&he||(p.userInput=null,o(Mn,ee),oe!==ee&&o(Lo,ee,oe),i.validateEvent&&((ie=m==null?void 0:m.validate)==null||ie.call(m,"change").catch(Q=>void 0)),p.currentValue=ee)},z=he=>{p.userInput=he;const se=he===""?null:Number(he);o(Hi,se),B(se,!1)},W=he=>{const se=he!==""?Number(he):"";(Zt(se)&&!Number.isNaN(se)||he==="")&&B(se),le(),p.userInput=null},Z=()=>{var he,se;(se=(he=f.value)==null?void 0:he.focus)==null||se.call(he)},$=()=>{var he,se;(se=(he=f.value)==null?void 0:he.blur)==null||se.call(he)},O=he=>{o("focus",he)},X=he=>{var se;p.userInput=null,o("blur",he),i.validateEvent&&((se=m==null?void 0:m.validate)==null||se.call(m,"blur").catch(ie=>void 0))},le=()=>{p.currentValue!==i.modelValue&&(p.currentValue=i.modelValue)},de=he=>{document.activeElement===he.target&&he.preventDefault()};return rt(()=>i.modelValue,(he,se)=>{const ie=H(he,!0);p.userInput===null&&ie!==se&&(p.currentValue=ie)},{immediate:!0}),fn(()=>{var he;const{min:se,max:ie,modelValue:oe}=i,ee=(he=f.value)==null?void 0:he.input;if(ee.setAttribute("role","spinbutton"),Number.isFinite(ie)?ee.setAttribute("aria-valuemax",String(ie)):ee.removeAttribute("aria-valuemax"),Number.isFinite(se)?ee.setAttribute("aria-valuemin",String(se)):ee.removeAttribute("aria-valuemin"),ee.setAttribute("aria-valuenow",p.currentValue||p.currentValue===0?String(p.currentValue):""),ee.setAttribute("aria-disabled",String(R.value)),!Zt(oe)&&oe!=null){let Q=Number(oe);Number.isNaN(Q)&&(Q=null),o(Mn,Q)}ee.addEventListener("wheel",de,{passive:!1})}),Oc(()=>{var he,se;const ie=(he=f.value)==null?void 0:he.input;ie==null||ie.setAttribute("aria-valuenow",`${(se=p.currentValue)!=null?se:""}`)}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-input-number",ref:"https://element-plus.org/en-US/component/input-number.html"},K(()=>!!i.label)),t({focus:Z,blur:$}),(he,se)=>(J(),ge("div",{class:ne([y(u).b(),y(u).m(y(M)),y(u).is("disabled",y(R)),y(u).is("without-controls",!he.controls),y(u).is("controls-right",y(T))]),onDragstart:se[0]||(se[0]=nn(()=>{},["prevent"]))},[he.controls?hn((J(),ge("span",{key:0,role:"button","aria-label":y(c)("el.inputNumber.decrease"),class:ne([y(u).e("decrease"),y(u).is("disabled",y(_))]),onKeydown:go(F,["enter"])},[We(he.$slots,"decrease-icon",{},()=>[Me(y(Gt),null,{default:Ne(()=>[y(T)?(J(),He(y(Pc),{key:0})):(J(),He(y(r_e),{key:1}))]),_:1})])],42,Qwe)),[[y(kE),F]]):Fe("v-if",!0),he.controls?hn((J(),ge("span",{key:1,role:"button","aria-label":y(c)("el.inputNumber.increase"),class:ne([y(u).e("increase"),y(u).is("disabled",y(b))]),onKeydown:go(L,["enter"])},[We(he.$slots,"increase-icon",{},()=>[Me(y(Gt),null,{default:Ne(()=>[y(T)?(J(),He(y(tL),{key:0})):(J(),He(y(Gq),{key:1}))]),_:1})])],42,Zwe)),[[y(kE),L]]):Fe("v-if",!0),Me(y(Ai),{id:he.id,ref_key:"input",ref:f,type:"number",step:he.step,"model-value":y(E),placeholder:he.placeholder,readonly:he.readonly,disabled:y(R),size:y(M),max:he.max,min:he.min,name:he.name,"aria-label":he.label||he.ariaLabel,"validate-event":!1,onKeydown:[go(nn(L,["prevent"]),["up"]),go(nn(F,["prevent"]),["down"])],onBlur:X,onFocus:O,onInput:z,onChange:W},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],34))}});var nDe=vt(tDe,[["__file","input-number.vue"]]);const pz=bn(nDe),oDe=gt({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:mo}}),rDe={click:e=>e instanceof MouseEvent},iDe=["href","target"],sDe=Se({name:"ElLink"}),aDe=Se({...sDe,props:oDe,emits:rDe,setup(e,{emit:t}){const o=e,i=lt("link"),c=K(()=>[i.b(),i.m(o.type),i.is("disabled",o.disabled),i.is("underline",o.underline&&!o.disabled)]);function u(f){o.disabled||t("click",f)}return(f,p)=>(J(),ge("a",{class:ne(y(c)),href:f.disabled||!f.href?void 0:f.href,target:f.disabled||!f.href?void 0:f.target,onClick:u},[f.icon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(f.icon)))]),_:1})):Fe("v-if",!0),f.$slots.default?(J(),ge("span",{key:1,class:ne(y(i).e("inner"))},[We(f.$slots,"default")],2)):Fe("v-if",!0),f.$slots.icon?We(f.$slots,"icon",{key:2}):Fe("v-if",!0)],10,iDe))}});var lDe=vt(aDe,[["__file","link.vue"]]);const cDe=bn(lDe);let uDe=class{constructor(t,o){this.parent=t,this.domNode=o,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,o=>{o.addEventListener("keydown",i=>{let c=!1;switch(i.code){case Yt.down:{this.gotoSubIndex(this.subIndex+1),c=!0;break}case Yt.up:{this.gotoSubIndex(this.subIndex-1),c=!0;break}case Yt.tab:{DT(t,"mouseleave");break}case Yt.enter:case Yt.space:{c=!0,i.currentTarget.click();break}}return c&&(i.preventDefault(),i.stopPropagation()),!1})})}},dDe=class{constructor(t,o){this.domNode=t,this.submenu=null,this.submenu=null,this.init(o)}init(t){this.domNode.setAttribute("tabindex","0");const o=this.domNode.querySelector(`.${t}-menu`);o&&(this.submenu=new uDe(this,o)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let o=!1;switch(t.code){case Yt.down:{DT(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),o=!0;break}case Yt.up:{DT(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),o=!0;break}case Yt.tab:{DT(t.currentTarget,"mouseleave");break}case Yt.enter:case Yt.space:{o=!0,t.currentTarget.click();break}}o&&t.preventDefault()})}},hDe=class{constructor(t,o){this.domNode=t,this.init(o)}init(t){const o=this.domNode.childNodes;Array.from(o).forEach(i=>{i.nodeType===1&&new dDe(i,t)})}};const fDe=Se({name:"ElMenuCollapseTransition",setup(){const e=lt("menu");return{listeners:{onBeforeEnter:o=>o.style.opacity="0.2",onEnter(o,i){Js(o,`${e.namespace.value}-opacity-transition`),o.style.opacity="1",i()},onAfterEnter(o){wi(o,`${e.namespace.value}-opacity-transition`),o.style.opacity=""},onBeforeLeave(o){o.dataset||(o.dataset={}),ea(o,e.m("collapse"))?(wi(o,e.m("collapse")),o.dataset.oldOverflow=o.style.overflow,o.dataset.scrollWidth=o.clientWidth.toString(),Js(o,e.m("collapse"))):(Js(o,e.m("collapse")),o.dataset.oldOverflow=o.style.overflow,o.dataset.scrollWidth=o.clientWidth.toString(),wi(o,e.m("collapse"))),o.style.width=`${o.scrollWidth}px`,o.style.overflow="hidden"},onLeave(o){Js(o,"horizontal-collapse-transition"),o.style.width=`${o.dataset.scrollWidth}px`}}}}});function pDe(e,t,o,i,c,u){return J(),He(Rr,Nn({mode:"out-in"},e.listeners),{default:Ne(()=>[We(e.$slots,"default")]),_:3},16)}var gDe=vt(fDe,[["render",pDe],["__file","menu-collapse-transition.vue"]]);function gz(e,t){const o=K(()=>{let c=e.parent;const u=[t.value];for(;c.type.name!=="ElMenu";)c.props.index&&u.unshift(c.props.index),c=c.parent;return u});return{parentMenu:K(()=>{let c=e.parent;for(;c&&!["ElMenu","ElSubMenu"].includes(c.type.name);)c=c.parent;return c}),indexPath:o}}function mDe(e){return K(()=>{const o=e.backgroundColor;return o?new W9(o).shade(20).toString():""})}const mz=(e,t)=>{const o=lt("menu");return K(()=>o.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":mDe(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},vDe=gt({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:mo},expandOpenIcon:{type:mo},collapseCloseIcon:{type:mo},collapseOpenIcon:{type:mo}}),iD="ElSubMenu";var WL=Se({name:iD,props:vDe,setup(e,{slots:t,expose:o}){const i=In(),{indexPath:c,parentMenu:u}=gz(i,K(()=>e.index)),f=lt("menu"),p=lt("sub-menu"),m=wt("rootMenu");m||wr(iD,"can not inject root menu");const _=wt(`subMenu:${u.value.uid}`);_||wr(iD,"can not inject sub menu");const b=ae({}),S=ae({});let T;const M=ae(!1),R=ae(),E=ae(null),N=K(()=>W.value==="horizontal"&&x.value?"bottom-start":"right-start"),D=K(()=>W.value==="horizontal"&&x.value||W.value==="vertical"&&!m.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?B.value?e.expandOpenIcon:e.expandCloseIcon:Pc:e.collapseCloseIcon&&e.collapseOpenIcon?B.value?e.collapseOpenIcon:e.collapseCloseIcon:$i),x=K(()=>_.level===0),L=K(()=>{const Q=e.teleported;return Q===void 0?x.value:Q}),F=K(()=>m.props.collapse?`${f.namespace.value}-zoom-in-left`:`${f.namespace.value}-zoom-in-top`),H=K(()=>W.value==="horizontal"&&x.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),B=K(()=>m.openedMenus.includes(e.index)),z=K(()=>{let Q=!1;return Object.values(b.value).forEach(ue=>{ue.active&&(Q=!0)}),Object.values(S.value).forEach(ue=>{ue.active&&(Q=!0)}),Q}),W=K(()=>m.props.mode),Z=Zn({index:e.index,indexPath:c,active:z}),$=mz(m.props,_.level+1),O=K(()=>{var Q;return(Q=e.popperOffset)!=null?Q:m.props.popperOffset}),X=K(()=>{var Q;return(Q=e.popperClass)!=null?Q:m.props.popperClass}),le=K(()=>{var Q;return(Q=e.showTimeout)!=null?Q:m.props.showTimeout}),de=K(()=>{var Q;return(Q=e.hideTimeout)!=null?Q:m.props.hideTimeout}),he=()=>{var Q,ue,me;return(me=(ue=(Q=E.value)==null?void 0:Q.popperRef)==null?void 0:ue.popperInstanceRef)==null?void 0:me.destroy()},se=Q=>{Q||he()},ie=()=>{m.props.menuTrigger==="hover"&&m.props.mode==="horizontal"||m.props.collapse&&m.props.mode==="vertical"||e.disabled||m.handleSubMenuClick({index:e.index,indexPath:c.value,active:z.value})},oe=(Q,ue=le.value)=>{var me;if(Q.type!=="focus"){if(m.props.menuTrigger==="click"&&m.props.mode==="horizontal"||!m.props.collapse&&m.props.mode==="vertical"||e.disabled){_.mouseInChild.value=!0;return}_.mouseInChild.value=!0,T==null||T(),{stop:T}=Wf(()=>{m.openMenu(e.index,c.value)},ue),L.value&&((me=u.value.vnode.el)==null||me.dispatchEvent(new MouseEvent("mouseenter")))}},ee=(Q=!1)=>{var ue;if(m.props.menuTrigger==="click"&&m.props.mode==="horizontal"||!m.props.collapse&&m.props.mode==="vertical"){_.mouseInChild.value=!1;return}T==null||T(),_.mouseInChild.value=!1,{stop:T}=Wf(()=>!M.value&&m.closeMenu(e.index,c.value),de.value),L.value&&Q&&((ue=_.handleMouseleave)==null||ue.call(_,!0))};rt(()=>m.props.collapse,Q=>se(!!Q));{const Q=me=>{S.value[me.index]=me},ue=me=>{delete S.value[me.index]};Ln(`subMenu:${i.uid}`,{addSubMenu:Q,removeSubMenu:ue,handleMouseleave:ee,mouseInChild:M,level:_.level+1})}return o({opened:B}),fn(()=>{m.addSubMenu(Z),_.addSubMenu(Z)}),Ro(()=>{_.removeSubMenu(Z),m.removeSubMenu(Z)}),()=>{var Q;const ue=[(Q=t.title)==null?void 0:Q.call(t),Wt(Gt,{class:p.e("icon-arrow"),style:{transform:B.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&m.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>on(D.value)?Wt(i.appContext.components[D.value]):Wt(D.value)})],me=m.isMenuPopup?Wt(Di,{ref:E,visible:B.value,effect:"light",pure:!0,offset:O.value,showArrow:!1,persistent:!0,popperClass:X.value,placement:N.value,teleported:L.value,fallbackPlacements:H.value,transition:F.value,gpuAcceleration:!1},{content:()=>{var be;return Wt("div",{class:[f.m(W.value),f.m("popup-container"),X.value],onMouseenter:ke=>oe(ke,100),onMouseleave:()=>ee(!0),onFocus:ke=>oe(ke,100)},[Wt("ul",{class:[f.b(),f.m("popup"),f.m(`popup-${N.value}`)],style:$.value},[(be=t.default)==null?void 0:be.call(t)])])},default:()=>Wt("div",{class:p.e("title"),onClick:ie},ue)}):Wt(qt,{},[Wt("div",{class:p.e("title"),ref:R,onClick:ie},ue),Wt(_1,{},{default:()=>{var be;return hn(Wt("ul",{role:"menu",class:[f.b(),f.m("inline")],style:$.value},[(be=t.default)==null?void 0:be.call(t)]),[[Jn,B.value]])}})]);return Wt("li",{class:[p.b(),p.is("active",z.value),p.is("opened",B.value),p.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:B.value,onMouseenter:oe,onMouseleave:()=>ee(),onFocus:oe},[me])}}});const _De=gt({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:Le(Array),default:()=>zo([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:mo,default:()=>a_e},popperEffect:{type:String,values:["dark","light"],default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),sD=e=>Array.isArray(e)&&e.every(t=>on(t)),yDe={close:(e,t)=>on(e)&&sD(t),open:(e,t)=>on(e)&&sD(t),select:(e,t,o,i)=>on(e)&&sD(t)&&En(o)&&(i===void 0||i instanceof Promise)};var IDe=Se({name:"ElMenu",props:_De,emits:yDe,setup(e,{emit:t,slots:o,expose:i}){const c=In(),u=c.appContext.config.globalProperties.$router,f=ae(),p=lt("menu"),m=lt("sub-menu"),_=ae(-1),b=ae(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),S=ae(e.defaultActive),T=ae({}),M=ae({}),R=K(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),E=()=>{const de=S.value&&T.value[S.value];if(!de||e.mode==="horizontal"||e.collapse)return;de.indexPath.forEach(se=>{const ie=M.value[se];ie&&N(se,ie.indexPath)})},N=(de,he)=>{b.value.includes(de)||(e.uniqueOpened&&(b.value=b.value.filter(se=>he.includes(se))),b.value.push(de),t("open",de,he))},D=de=>{const he=b.value.indexOf(de);he!==-1&&b.value.splice(he,1)},x=(de,he)=>{D(de),t("close",de,he)},L=({index:de,indexPath:he})=>{b.value.includes(de)?x(de,he):N(de,he)},F=de=>{(e.mode==="horizontal"||e.collapse)&&(b.value=[]);const{index:he,indexPath:se}=de;if(!(Hr(he)||Hr(se)))if(e.router&&u){const ie=de.route||he,oe=u.push(ie).then(ee=>(ee||(S.value=he),ee));t("select",he,se,{index:he,indexPath:se,route:ie},oe)}else S.value=he,t("select",he,se,{index:he,indexPath:se})},H=de=>{const he=T.value,se=he[de]||S.value&&he[S.value]||he[e.defaultActive];se?S.value=se.index:S.value=de},B=de=>{const he=getComputedStyle(de),se=Number.parseInt(he.marginLeft,10),ie=Number.parseInt(he.marginRight,10);return de.offsetWidth+se+ie||0},z=()=>{var de,he;if(!f.value)return-1;const se=Array.from((he=(de=f.value)==null?void 0:de.childNodes)!=null?he:[]).filter(ke=>ke.nodeName!=="#comment"&&(ke.nodeName!=="#text"||ke.nodeValue)),ie=64,oe=getComputedStyle(f.value),ee=Number.parseInt(oe.paddingLeft,10),Q=Number.parseInt(oe.paddingRight,10),ue=f.value.clientWidth-ee-Q;let me=0,be=0;return se.forEach((ke,Ye)=>{me+=B(ke),me<=ue-ie&&(be=Ye+1)}),be===se.length?-1:be},W=de=>M.value[de].indexPath,Z=(de,he=33.34)=>{let se;return()=>{se&&clearTimeout(se),se=setTimeout(()=>{de()},he)}};let $=!0;const O=()=>{if(_.value===z())return;const de=()=>{_.value=-1,zt(()=>{_.value=z()})};$?de():Z(de)(),$=!1};rt(()=>e.defaultActive,de=>{T.value[de]||(S.value=""),H(de)}),rt(()=>e.collapse,de=>{de&&(b.value=[])}),rt(T.value,E);let X;hi(()=>{e.mode==="horizontal"&&e.ellipsis?X=Ko(f,O).stop:X==null||X()});const le=ae(!1);{const de=oe=>{M.value[oe.index]=oe},he=oe=>{delete M.value[oe.index]};Ln("rootMenu",Zn({props:e,openedMenus:b,items:T,subMenus:M,activeIndex:S,isMenuPopup:R,addMenuItem:oe=>{T.value[oe.index]=oe},removeMenuItem:oe=>{delete T.value[oe.index]},addSubMenu:de,removeSubMenu:he,openMenu:N,closeMenu:x,handleMenuItemClick:F,handleSubMenuClick:L})),Ln(`subMenu:${c.uid}`,{addSubMenu:de,removeSubMenu:he,mouseInChild:le,level:0})}return fn(()=>{e.mode==="horizontal"&&new hDe(c.vnode.el,p.namespace.value)}),i({open:he=>{const{indexPath:se}=M.value[he];se.forEach(ie=>N(ie,se))},close:D,handleResize:O}),()=>{var de,he;let se=(he=(de=o.default)==null?void 0:de.call(o))!=null?he:[];const ie=[];if(e.mode==="horizontal"&&f.value){const ue=hd(se),me=_.value===-1?ue:ue.slice(0,_.value),be=_.value===-1?[]:ue.slice(_.value);be!=null&&be.length&&e.ellipsis&&(se=me,ie.push(Wt(WL,{index:"sub-menu-more",class:m.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Wt(Gt,{class:m.e("icon-more")},{default:()=>Wt(e.ellipsisIcon)}),default:()=>be})))}const oe=mz(e,0),ee=e.closeOnClickOutside?[[wc,()=>{b.value.length&&(le.value||(b.value.forEach(ue=>t("close",ue,W(ue))),b.value=[]))}]]:[],Q=hn(Wt("ul",{key:String(e.collapse),role:"menubar",ref:f,style:oe.value,class:{[p.b()]:!0,[p.m(e.mode)]:!0,[p.m("collapse")]:e.collapse}},[...se,...ie]),ee);return e.collapseTransition&&e.mode==="vertical"?Wt(gDe,()=>Q):Q}}});const bDe=gt({index:{type:Le([String,null]),default:null},route:{type:Le([String,Object])},disabled:Boolean}),CDe={click:e=>on(e.index)&&Array.isArray(e.indexPath)},aD="ElMenuItem",SDe=Se({name:aD,components:{ElTooltip:Di},props:bDe,emits:CDe,setup(e,{emit:t}){const o=In(),i=wt("rootMenu"),c=lt("menu"),u=lt("menu-item");i||wr(aD,"can not inject root menu");const{parentMenu:f,indexPath:p}=gz(o,Io(e,"index")),m=wt(`subMenu:${f.value.uid}`);m||wr(aD,"can not inject sub menu");const _=K(()=>e.index===i.activeIndex),b=Zn({index:e.index,indexPath:p,active:_}),S=()=>{e.disabled||(i.handleMenuItemClick({index:e.index,indexPath:p.value,route:e.route}),t("click",b))};return fn(()=>{m.addSubMenu(b),i.addMenuItem(b)}),Ro(()=>{m.removeSubMenu(b),i.removeMenuItem(b)}),{parentMenu:f,rootMenu:i,active:_,nsMenu:c,nsMenuItem:u,handleClick:S}}});function TDe(e,t,o,i,c,u){const f=pn("el-tooltip");return J(),ge("li",{class:ne([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:t[0]||(t[0]=(...p)=>e.handleClick&&e.handleClick(...p))},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(J(),He(f,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:Ne(()=>[We(e.$slots,"title")]),default:Ne(()=>[Ce("div",{class:ne(e.nsMenu.be("tooltip","trigger"))},[We(e.$slots,"default")],2)]),_:3},8,["effect"])):(J(),ge(qt,{key:1},[We(e.$slots,"default"),We(e.$slots,"title")],64))],2)}var vz=vt(SDe,[["render",TDe],["__file","menu-item.vue"]]);const EDe={title:String},MDe="ElMenuItemGroup",kDe=Se({name:MDe,props:EDe,setup(){return{ns:lt("menu-item-group")}}});function ADe(e,t,o,i,c,u){return J(),ge("li",{class:ne(e.ns.b())},[Ce("div",{class:ne(e.ns.e("title"))},[e.$slots.title?We(e.$slots,"title",{key:1}):(J(),ge(qt,{key:0},[On(pt(e.title),1)],64))],2),Ce("ul",null,[We(e.$slots,"default")])],2)}var _z=vt(kDe,[["render",ADe],["__file","menu-item-group.vue"]]);const RDe=bn(IDe,{MenuItem:vz,MenuItemGroup:_z,SubMenu:WL}),wDe=Wo(vz),DDe=Wo(_z),ODe=Wo(WL),NDe=gt({icon:{type:mo,default:()=>Dve},title:String,content:{type:String,default:""}}),LDe={back:()=>!0},PDe=["aria-label"],UDe=Se({name:"ElPageHeader"}),xDe=Se({...UDe,props:NDe,emits:LDe,setup(e,{emit:t}){const o=zr(),{t:i}=Kn(),c=lt("page-header"),u=K(()=>[c.b(),{[c.m("has-breadcrumb")]:!!o.breadcrumb,[c.m("has-extra")]:!!o.extra,[c.is("contentful")]:!!o.default}]);function f(){t("back")}return(p,m)=>(J(),ge("div",{class:ne(y(u))},[p.$slots.breadcrumb?(J(),ge("div",{key:0,class:ne(y(c).e("breadcrumb"))},[We(p.$slots,"breadcrumb")],2)):Fe("v-if",!0),Ce("div",{class:ne(y(c).e("header"))},[Ce("div",{class:ne(y(c).e("left"))},[Ce("div",{class:ne(y(c).e("back")),role:"button",tabindex:"0",onClick:f},[p.icon||p.$slots.icon?(J(),ge("div",{key:0,"aria-label":p.title||y(i)("el.pageHeader.title"),class:ne(y(c).e("icon"))},[We(p.$slots,"icon",{},()=>[p.icon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(p.icon)))]),_:1})):Fe("v-if",!0)])],10,PDe)):Fe("v-if",!0),Ce("div",{class:ne(y(c).e("title"))},[We(p.$slots,"title",{},()=>[On(pt(p.title||y(i)("el.pageHeader.title")),1)])],2)],2),Me(y(oz),{direction:"vertical"}),Ce("div",{class:ne(y(c).e("content"))},[We(p.$slots,"content",{},()=>[On(pt(p.content),1)])],2)],2),p.$slots.extra?(J(),ge("div",{key:0,class:ne(y(c).e("extra"))},[We(p.$slots,"extra")],2)):Fe("v-if",!0)],2),p.$slots.default?(J(),ge("div",{key:1,class:ne(y(c).e("main"))},[We(p.$slots,"default")],2)):Fe("v-if",!0)],2))}});var FDe=vt(xDe,[["__file","page-header.vue"]]);const VDe=bn(FDe),yz=Symbol("elPaginationKey"),GDe=gt({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:mo}}),BDe={click:e=>e instanceof MouseEvent},$De=["disabled","aria-label","aria-disabled"],HDe={key:0},qDe=Se({name:"ElPaginationPrev"}),KDe=Se({...qDe,props:GDe,emits:BDe,setup(e){const t=e,{t:o}=Kn(),i=K(()=>t.disabled||t.currentPage<=1);return(c,u)=>(J(),ge("button",{type:"button",class:"btn-prev",disabled:y(i),"aria-label":c.prevText||y(o)("el.pagination.prev"),"aria-disabled":y(i),onClick:u[0]||(u[0]=f=>c.$emit("click",f))},[c.prevText?(J(),ge("span",HDe,pt(c.prevText),1)):(J(),He(y(Gt),{key:1},{default:Ne(()=>[(J(),He(wn(c.prevIcon)))]),_:1}))],8,$De))}});var zDe=vt(KDe,[["__file","prev.vue"]]);const WDe=gt({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:mo}}),jDe=["disabled","aria-label","aria-disabled"],YDe={key:0},JDe=Se({name:"ElPaginationNext"}),XDe=Se({...JDe,props:WDe,emits:["click"],setup(e){const t=e,{t:o}=Kn(),i=K(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(c,u)=>(J(),ge("button",{type:"button",class:"btn-next",disabled:y(i),"aria-label":c.nextText||y(o)("el.pagination.next"),"aria-disabled":y(i),onClick:u[0]||(u[0]=f=>c.$emit("click",f))},[c.nextText?(J(),ge("span",YDe,pt(c.nextText),1)):(J(),He(y(Gt),{key:1},{default:Ne(()=>[(J(),He(wn(c.nextIcon)))]),_:1}))],8,jDe))}});var QDe=vt(XDe,[["__file","next.vue"]]);const Iz=Symbol("ElSelectGroup"),Km=Symbol("ElSelect");function ZDe(e,t){const o=wt(Km),i=wt(Iz,{disabled:!1}),c=K(()=>o.props.multiple?b(o.props.modelValue,e.value):b([o.props.modelValue],e.value)),u=K(()=>{if(o.props.multiple){const M=o.props.modelValue||[];return!c.value&&M.length>=o.props.multipleLimit&&o.props.multipleLimit>0}else return!1}),f=K(()=>e.label||(En(e.value)?"":e.value)),p=K(()=>e.value||e.label||""),m=K(()=>e.disabled||t.groupDisabled||u.value),_=In(),b=(M=[],R)=>{if(En(e.value)){const E=o.props.valueKey;return M&&M.some(N=>fo(ir(N,E))===ir(R,E))}else return M&&M.includes(R)},S=()=>{!e.disabled&&!i.disabled&&(o.states.hoveringIndex=o.optionsArray.indexOf(_.proxy))},T=M=>{const R=new RegExp(ZN(M),"i");t.visible=R.test(f.value)||e.created};return rt(()=>f.value,()=>{!e.created&&!o.props.remote&&o.setSelected()}),rt(()=>e.value,(M,R)=>{const{remote:E,valueKey:N}=o.props;if(Ri(M,R)||(o.onOptionDestroy(R,_.proxy),o.onOptionCreate(_.proxy)),!e.created&&!E){if(N&&En(M)&&En(R)&&M[N]===R[N])return;o.setSelected()}}),rt(()=>i.disabled,()=>{t.groupDisabled=i.disabled},{immediate:!0}),{select:o,currentLabel:f,currentValue:p,itemSelected:c,isDisabled:m,hoverItem:S,updateOption:T}}const eOe=Se({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=lt("select"),o=pi(),i=K(()=>[t.be("dropdown","item"),t.is("disabled",y(p)),t.is("selected",y(f)),t.is("hovering",y(T))]),c=Zn({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:u,itemSelected:f,isDisabled:p,select:m,hoverItem:_,updateOption:b}=ZDe(e,c),{visible:S,hover:T}=ei(c),M=In().proxy;m.onOptionCreate(M),Ro(()=>{const E=M.value,{selected:N}=m.states,x=(m.props.multiple?N:[N]).some(L=>L.value===M.value);zt(()=>{m.states.cachedOptions.get(E)===M&&!x&&m.states.cachedOptions.delete(E)}),m.onOptionDestroy(E,M)});function R(){e.disabled!==!0&&c.groupDisabled!==!0&&m.handleOptionSelect(M)}return{ns:t,id:o,containerKls:i,currentLabel:u,itemSelected:f,isDisabled:p,select:m,hoverItem:_,updateOption:b,visible:S,hover:T,selectOptionClick:R,states:c}}}),tOe=["id","aria-disabled","aria-selected"];function nOe(e,t,o,i,c,u){return hn((J(),ge("li",{id:e.id,class:ne(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMouseenter:t[0]||(t[0]=(...f)=>e.hoverItem&&e.hoverItem(...f)),onClick:t[1]||(t[1]=nn((...f)=>e.selectOptionClick&&e.selectOptionClick(...f),["stop"]))},[We(e.$slots,"default",{},()=>[Ce("span",null,pt(e.currentLabel),1)])],42,tOe)),[[Jn,e.visible]])}var jL=vt(eOe,[["render",nOe],["__file","option.vue"]]);const oOe=Se({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=wt(Km),t=lt("select"),o=K(()=>e.props.popperClass),i=K(()=>e.props.multiple),c=K(()=>e.props.fitInputWidth),u=ae("");function f(){var p;u.value=`${(p=e.selectRef)==null?void 0:p.offsetWidth}px`}return fn(()=>{f(),Ko(e.selectRef,f)}),{ns:t,minWidth:u,popperClass:o,isMultiple:i,isFitInputWidth:c}}});function rOe(e,t,o,i,c,u){return J(),ge("div",{class:ne([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Ht({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(J(),ge("div",{key:0,class:ne(e.ns.be("dropdown","header"))},[We(e.$slots,"header")],2)):Fe("v-if",!0),We(e.$slots,"default"),e.$slots.footer?(J(),ge("div",{key:1,class:ne(e.ns.be("dropdown","footer"))},[We(e.$slots,"footer")],2)):Fe("v-if",!0)],6)}var iOe=vt(oOe,[["render",rOe],["__file","select-dropdown.vue"]]);function bz(e){const t=ae(!1);return{handleCompositionStart:()=>{t.value=!0},handleCompositionUpdate:u=>{const f=u.target.value,p=f[f.length-1]||"";t.value=!lL(p)},handleCompositionEnd:u=>{t.value&&(t.value=!1,tn(e)&&e(u))}}}const sOe=11,aOe=(e,t)=>{const{t:o}=Kn(),i=pi(),c=lt("select"),u=lt("input"),f=Zn({inputValue:"",options:new Map,cachedOptions:new Map,disabledOptions:new Map,optionValues:[],selected:e.multiple?[]:{},selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),p=ae(null),m=ae(null),_=ae(null),b=ae(null),S=ae(null),T=ae(null),M=ae(null),R=ae(null),E=ae(null),N=ae(null),D=ae(null),x=ae(null),{wrapperRef:L,isFocused:F,handleFocus:H,handleBlur:B}=h1(S,{afterFocus(){e.automaticDropdown&&!z.value&&(z.value=!0,f.menuVisibleOnFocus=!0)},beforeBlur(Tt){var Xt,Cn;return((Xt=_.value)==null?void 0:Xt.isFocusInsideContent(Tt))||((Cn=b.value)==null?void 0:Cn.isFocusInsideContent(Tt))},afterBlur(){z.value=!1,f.menuVisibleOnFocus=!1}}),z=ae(!1),W=ae(),{form:Z,formItem:$}=Oi(),{inputId:O}=Va(e,{formItemContext:$}),{valueOnClear:X,isEmptyValue:le}=f1(e),de=K(()=>e.disabled||(Z==null?void 0:Z.disabled)),he=K(()=>e.multiple?At(e.modelValue)&&e.modelValue.length>0:!le(e.modelValue)),se=K(()=>e.clearable&&!de.value&&f.inputHovering&&he.value),ie=K(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),oe=K(()=>c.is("reverse",ie.value&&z.value)),ee=K(()=>($==null?void 0:$.validateState)||""),Q=K(()=>aL[ee.value]),ue=K(()=>e.remote?300:0),me=K(()=>e.loading?e.loadingText||o("el.select.loading"):e.remote&&!f.inputValue&&f.options.size===0?!1:e.filterable&&f.inputValue&&f.options.size>0&&be.value===0?e.noMatchText||o("el.select.noMatch"):f.options.size===0?e.noDataText||o("el.select.noData"):null),be=K(()=>ke.value.filter(Tt=>Tt.visible).length),ke=K(()=>{const Tt=Array.from(f.options.values()),Xt=[];return f.optionValues.forEach(Cn=>{const un=Tt.findIndex(hr=>hr.value===Cn);un>-1&&Xt.push(Tt[un])}),Xt.length>=Tt.length?Xt:Tt}),Ye=K(()=>Array.from(f.cachedOptions.values())),Oe=K(()=>{const Tt=ke.value.filter(Xt=>!Xt.created).some(Xt=>Xt.currentLabel===f.inputValue);return e.filterable&&e.allowCreate&&f.inputValue!==""&&!Tt}),Ee=()=>{e.filterable&&tn(e.filterMethod)||e.filterable&&e.remote&&tn(e.remoteMethod)||ke.value.forEach(Tt=>{var Xt;(Xt=Tt.updateOption)==null||Xt.call(Tt,f.inputValue)})},we=Tr(),Ge=K(()=>["small"].includes(we.value)?"small":"default"),Ve=K({get(){return z.value&&me.value!==!1},set(Tt){z.value=Tt}}),qe=K(()=>At(e.modelValue)?e.modelValue.length===0&&!f.inputValue:e.filterable?!f.inputValue:!0),st=K(()=>{var Tt;const Xt=(Tt=e.placeholder)!=null?Tt:o("el.select.placeholder");return e.multiple||!he.value?Xt:f.selectedLabel});rt(()=>e.modelValue,(Tt,Xt)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(f.inputValue="",Ie("")),xe(),!Ri(Tt,Xt)&&e.validateEvent&&($==null||$.validate("change").catch(Cn=>void 0))},{flush:"post",deep:!0}),rt(()=>z.value,Tt=>{Tt?Ie(f.inputValue):(f.inputValue="",f.previousQuery=null,f.isBeforeHide=!0),t("visible-change",Tt)}),rt(()=>f.options.entries(),()=>{var Tt;if(!$n)return;const Xt=((Tt=p.value)==null?void 0:Tt.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!_r(e.modelValue)||!Array.from(Xt).includes(document.activeElement))&&xe(),e.defaultFirstOption&&(e.filterable||e.remote)&&be.value&&Ae()},{flush:"post"}),rt(()=>f.hoveringIndex,Tt=>{Zt(Tt)&&Tt>-1?W.value=ke.value[Tt]||{}:W.value={},ke.value.forEach(Xt=>{Xt.hover=W.value===Xt})}),hi(()=>{f.isBeforeHide||Ee()});const Ie=Tt=>{f.previousQuery!==Tt&&(f.previousQuery=Tt,e.filterable&&tn(e.filterMethod)?e.filterMethod(Tt):e.filterable&&e.remote&&tn(e.remoteMethod)&&e.remoteMethod(Tt),e.defaultFirstOption&&(e.filterable||e.remote)&&be.value?zt(Ae):zt(je))},Ae=()=>{const Tt=ke.value.filter(un=>un.visible&&!un.disabled&&!un.states.groupDisabled),Xt=Tt.find(un=>un.created),Cn=Tt[0];f.hoveringIndex=It(ke.value,Xt||Cn)},xe=()=>{if(e.multiple)f.selectedLabel="";else{const Xt=ot(e.modelValue);f.selectedLabel=Xt.currentLabel,f.selected=Xt;return}const Tt=[];At(e.modelValue)&&e.modelValue.forEach(Xt=>{Tt.push(ot(Xt))}),f.selected=Tt},ot=Tt=>{let Xt;const Cn=IT(Tt).toLowerCase()==="object",un=IT(Tt).toLowerCase()==="null",hr=IT(Tt).toLowerCase()==="undefined";for(let ko=f.cachedOptions.size-1;ko>=0;ko--){const Lr=Ye.value[ko];if(Cn?ir(Lr.value,e.valueKey)===ir(Tt,e.valueKey):Lr.value===Tt){Xt={value:Tt,currentLabel:Lr.currentLabel,get isDisabled(){return Lr.isDisabled}};break}}if(Xt)return Xt;const xn=Cn?Tt.label:!un&&!hr?Tt:"";return{value:Tt,currentLabel:xn}},je=()=>{e.multiple?f.hoveringIndex=ke.value.findIndex(Tt=>f.selected.some(Xt=>eo(Xt)===eo(Tt))):f.hoveringIndex=ke.value.findIndex(Tt=>eo(Tt)===eo(f.selected))},at=()=>{f.selectionWidth=m.value.getBoundingClientRect().width},ht=()=>{f.calculatorWidth=T.value.getBoundingClientRect().width},dt=()=>{f.collapseItemWidth=D.value.getBoundingClientRect().width},ft=()=>{var Tt,Xt;(Xt=(Tt=_.value)==null?void 0:Tt.updatePopper)==null||Xt.call(Tt)},Je=()=>{var Tt,Xt;(Xt=(Tt=b.value)==null?void 0:Tt.updatePopper)==null||Xt.call(Tt)},Et=()=>{f.inputValue.length>0&&!z.value&&(z.value=!0),Ie(f.inputValue)},Nt=Tt=>{if(f.inputValue=Tt.target.value,e.remote)et();else return Et()},et=as(()=>{Et()},ue.value),Mt=Tt=>{Ri(e.modelValue,Tt)||t(Lo,Tt)},Jt=Tt=>Oq(Tt,Xt=>!f.disabledOptions.has(Xt)),sn=Tt=>{if(e.multiple&&Tt.code!==Yt.delete&&Tt.target.value.length<=0){const Xt=e.modelValue.slice(),Cn=Jt(Xt);if(Cn<0)return;const un=Xt[Cn];Xt.splice(Cn,1),t(Mn,Xt),Mt(Xt),t("remove-tag",un)}},gn=(Tt,Xt)=>{const Cn=f.selected.indexOf(Xt);if(Cn>-1&&!de.value){const un=e.modelValue.slice();un.splice(Cn,1),t(Mn,un),Mt(un),t("remove-tag",Xt.value)}Tt.stopPropagation(),oo()},Bt=Tt=>{Tt.stopPropagation();const Xt=e.multiple?[]:X.value;if(e.multiple)for(const Cn of f.selected)Cn.isDisabled&&Xt.push(Cn.value);t(Mn,Xt),Mt(Xt),f.hoveringIndex=-1,z.value=!1,t("clear"),oo()},nt=Tt=>{if(e.multiple){const Xt=(e.modelValue||[]).slice(),Cn=It(Xt,Tt.value);Cn>-1?Xt.splice(Cn,1):(e.multipleLimit<=0||Xt.length<e.multipleLimit)&&Xt.push(Tt.value),t(Mn,Xt),Mt(Xt),Tt.created&&Ie(""),e.filterable&&!e.reserveKeyword&&(f.inputValue="")}else t(Mn,Tt.value),Mt(Tt.value),z.value=!1;oo(),!z.value&&zt(()=>{ct(Tt)})},It=(Tt=[],Xt)=>{if(!En(Xt))return Tt.indexOf(Xt);const Cn=e.valueKey;let un=-1;return Tt.some((hr,xn)=>fo(ir(hr,Cn))===ir(Xt,Cn)?(un=xn,!0):!1),un},ct=Tt=>{var Xt,Cn,un,hr,xn;const Rt=At(Tt)?Tt[0]:Tt;let ko=null;if(Rt!=null&&Rt.value){const Lr=ke.value.filter(wl=>wl.value===Rt.value);Lr.length>0&&(ko=Lr[0].$el)}if(_.value&&ko){const Lr=(hr=(un=(Cn=(Xt=_.value)==null?void 0:Xt.popperRef)==null?void 0:Cn.contentRef)==null?void 0:un.querySelector)==null?void 0:hr.call(un,`.${c.be("dropdown","wrap")}`);Lr&&xq(Lr,ko)}(xn=x.value)==null||xn.handleScroll()},Ke=Tt=>{f.options.set(Tt.value,Tt),f.cachedOptions.set(Tt.value,Tt),Tt.disabled&&f.disabledOptions.set(Tt.value,Tt)},Xe=(Tt,Xt)=>{f.options.get(Tt)===Xt&&f.options.delete(Tt)},{handleCompositionStart:Dt,handleCompositionUpdate:$e,handleCompositionEnd:xt}=bz(Tt=>Nt(Tt)),jt=K(()=>{var Tt,Xt;return(Xt=(Tt=_.value)==null?void 0:Tt.popperRef)==null?void 0:Xt.contentRef}),Fn=()=>{f.isBeforeHide=!1,zt(()=>ct(f.selected))},oo=()=>{var Tt;(Tt=S.value)==null||Tt.focus()},zn=()=>{Po()},kn=Tt=>{Bt(Tt)},Po=Tt=>{if(z.value=!1,F.value){const Xt=new FocusEvent("focus",Tt);zt(()=>B(Xt))}},q=()=>{f.inputValue.length>0?f.inputValue="":z.value=!1},xo=()=>{de.value||(f.menuVisibleOnFocus?f.menuVisibleOnFocus=!1:z.value=!z.value)},_n=()=>{z.value?ke.value[f.hoveringIndex]&&nt(ke.value[f.hoveringIndex]):xo()},eo=Tt=>En(Tt.value)?ir(Tt.value,e.valueKey):Tt.value,ls=K(()=>ke.value.filter(Tt=>Tt.visible).every(Tt=>Tt.disabled)),Ir=K(()=>e.multiple?e.collapseTags?f.selected.slice(0,e.maxCollapseTags):f.selected:[]),ks=K(()=>e.multiple?e.collapseTags?f.selected.slice(e.maxCollapseTags):[]:[]),sr=Tt=>{if(!z.value){z.value=!0;return}if(!(f.options.size===0||be.value===0)&&!ls.value){Tt==="next"?(f.hoveringIndex++,f.hoveringIndex===f.options.size&&(f.hoveringIndex=0)):Tt==="prev"&&(f.hoveringIndex--,f.hoveringIndex<0&&(f.hoveringIndex=f.options.size-1));const Xt=ke.value[f.hoveringIndex];(Xt.disabled===!0||Xt.states.groupDisabled===!0||!Xt.visible)&&sr(Tt),zt(()=>ct(W.value))}},ca=()=>{if(!m.value)return 0;const Tt=window.getComputedStyle(m.value);return Number.parseFloat(Tt.gap||"6px")},As=K(()=>{const Tt=ca();return{maxWidth:`${D.value&&e.maxCollapseTags===1?f.selectionWidth-f.collapseItemWidth-Tt:f.selectionWidth}px`}}),Dd=K(()=>({maxWidth:`${f.selectionWidth}px`})),Ct=K(()=>({width:`${Math.max(f.calculatorWidth,sOe)}px`}));return e.multiple&&!At(e.modelValue)&&t(Mn,[]),!e.multiple&&At(e.modelValue)&&t(Mn,""),Ko(m,at),Ko(T,ht),Ko(E,ft),Ko(L,ft),Ko(N,Je),Ko(D,dt),fn(()=>{xe()}),{inputId:O,contentId:i,nsSelect:c,nsInput:u,states:f,isFocused:F,expanded:z,optionsArray:ke,hoverOption:W,selectSize:we,filteredOptionsCount:be,resetCalculatorWidth:ht,updateTooltip:ft,updateTagTooltip:Je,debouncedOnInputChange:et,onInput:Nt,deletePrevTag:sn,deleteTag:gn,deleteSelected:Bt,handleOptionSelect:nt,scrollToOption:ct,hasModelValue:he,shouldShowPlaceholder:qe,currentPlaceholder:st,showClose:se,iconComponent:ie,iconReverse:oe,validateState:ee,validateIcon:Q,showNewOption:Oe,updateOptions:Ee,collapseTagSize:Ge,setSelected:xe,selectDisabled:de,emptyText:me,handleCompositionStart:Dt,handleCompositionUpdate:$e,handleCompositionEnd:xt,onOptionCreate:Ke,onOptionDestroy:Xe,handleMenuEnter:Fn,handleFocus:H,focus:oo,blur:zn,handleBlur:B,handleClearClick:kn,handleClickOutside:Po,handleEsc:q,toggleMenu:xo,selectOption:_n,getValueKey:eo,navigateOptions:sr,dropdownMenuVisible:Ve,showTagList:Ir,collapseTagList:ks,tagStyle:As,collapseTagStyle:Dd,inputStyle:Ct,popperRef:jt,inputRef:S,tooltipRef:_,tagTooltipRef:b,calculatorRef:T,prefixRef:M,suffixRef:R,selectRef:p,wrapperRef:L,selectionRef:m,scrollbarRef:x,menuRef:E,tagMenuRef:N,collapseItemRef:D}};var lOe=Se({name:"ElOptions",setup(e,{slots:t}){const o=wt(Km);let i=[];return()=>{var c,u;const f=(c=t.default)==null?void 0:c.call(t),p=[];function m(_){At(_)&&_.forEach(b=>{var S,T,M,R;const E=(S=(b==null?void 0:b.type)||{})==null?void 0:S.name;E==="ElOptionGroup"?m(!on(b.children)&&!At(b.children)&&tn((T=b.children)==null?void 0:T.default)?(M=b.children)==null?void 0:M.default():b.children):E==="ElOption"?p.push((R=b.props)==null?void 0:R.value):At(b.children)&&m(b.children)})}return f.length&&m((u=f[0])==null?void 0:u.children),Ri(p,i)||(i=p,o&&(o.states.optionValues=p)),f}}});const cOe=gt({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Nr,effect:{type:Le(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Le(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Gr.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:mo,default:Ad},fitInputWidth:Boolean,suffixIcon:{type:mo,default:Pc},tagType:{...v1.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,placement:{type:Le(String),values:ip,default:"bottom-start"},fallbackPlacements:{type:Le(Array),default:["bottom-start","top-start","right","left"]},...Hm,...ti(["ariaLabel"])}),GB="ElSelect",uOe=Se({name:GB,componentName:GB,components:{ElInput:Ai,ElSelectMenu:iOe,ElOption:jL,ElOptions:lOe,ElTag:z0,ElScrollbar:xc,ElTooltip:Di,ElIcon:Gt},directives:{ClickOutside:wc},props:cOe,emits:[Mn,Lo,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const o=aOe(e,t);return Ln(Km,Zn({props:e,states:o.states,optionsArray:o.optionsArray,handleOptionSelect:o.handleOptionSelect,onOptionCreate:o.onOptionCreate,onOptionDestroy:o.onOptionDestroy,selectRef:o.selectRef,setSelected:o.setSelected})),{...o}}}),dOe=["id","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label"],hOe=["textContent"],fOe={key:1};function pOe(e,t,o,i,c,u){const f=pn("el-tag"),p=pn("el-tooltip"),m=pn("el-icon"),_=pn("el-option"),b=pn("el-options"),S=pn("el-scrollbar"),T=pn("el-select-menu"),M=KE("click-outside");return hn((J(),ge("div",{ref:"selectRef",class:ne([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:t[16]||(t[16]=R=>e.states.inputHovering=!0),onMouseleave:t[17]||(t[17]=R=>e.states.inputHovering=!1),onClick:t[18]||(t[18]=nn((...R)=>e.toggleMenu&&e.toggleMenu(...R),["prevent","stop"]))},[Me(p,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[15]||(t[15]=R=>e.states.isBeforeHide=!1)},{default:Ne(()=>{var R;return[Ce("div",{ref:"wrapperRef",class:ne([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(J(),ge("div",{key:0,ref:"prefixRef",class:ne(e.nsSelect.e("prefix"))},[We(e.$slots,"prefix")],2)):Fe("v-if",!0),Ce("div",{ref:"selectionRef",class:ne([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?We(e.$slots,"tag",{key:0},()=>[(J(!0),ge(qt,null,Vn(e.showTagList,E=>(J(),ge("div",{key:e.getValueKey(E),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!e.selectDisabled&&!E.isDisabled,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",style:Ht(e.tagStyle),onClose:N=>e.deleteTag(N,E)},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))},[We(e.$slots,"label",{label:E.currentLabel,value:E.value},()=>[On(pt(E.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(J(),He(p,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:Ne(()=>[Ce("div",{ref:"collapseItemRef",class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!1,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",style:Ht(e.collapseTagStyle)},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))}," + "+pt(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","style"])],2)]),content:Ne(()=>[Ce("div",{ref:"tagMenuRef",class:ne(e.nsSelect.e("selection"))},[(J(!0),ge(qt,null,Vn(e.collapseTagList,E=>(J(),ge("div",{key:e.getValueKey(E),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{class:"in-tooltip",closable:!e.selectDisabled&&!E.isDisabled,size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",onClose:N=>e.deleteTag(N,E)},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))},[We(e.$slots,"label",{label:E.currentLabel,value:E.value},()=>[On(pt(E.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):Fe("v-if",!0)]):Fe("v-if",!0),e.selectDisabled?Fe("v-if",!0):(J(),ge("div",{key:1,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hn(Ce("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":t[0]||(t[0]=E=>e.states.inputValue=E),type:"text",class:ne([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Ht(e.inputStyle),role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((R=e.hoverOption)==null?void 0:R.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:t[1]||(t[1]=(...E)=>e.handleFocus&&e.handleFocus(...E)),onBlur:t[2]||(t[2]=(...E)=>e.handleBlur&&e.handleBlur(...E)),onKeydown:[t[3]||(t[3]=go(nn(E=>e.navigateOptions("next"),["stop","prevent"]),["down"])),t[4]||(t[4]=go(nn(E=>e.navigateOptions("prev"),["stop","prevent"]),["up"])),t[5]||(t[5]=go(nn((...E)=>e.handleEsc&&e.handleEsc(...E),["stop","prevent"]),["esc"])),t[6]||(t[6]=go(nn((...E)=>e.selectOption&&e.selectOption(...E),["stop","prevent"]),["enter"])),t[7]||(t[7]=go(nn((...E)=>e.deletePrevTag&&e.deletePrevTag(...E),["stop"]),["delete"]))],onCompositionstart:t[8]||(t[8]=(...E)=>e.handleCompositionStart&&e.handleCompositionStart(...E)),onCompositionupdate:t[9]||(t[9]=(...E)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...E)),onCompositionend:t[10]||(t[10]=(...E)=>e.handleCompositionEnd&&e.handleCompositionEnd(...E)),onInput:t[11]||(t[11]=(...E)=>e.onInput&&e.onInput(...E)),onClick:t[12]||(t[12]=nn((...E)=>e.toggleMenu&&e.toggleMenu(...E),["stop"]))},null,46,dOe),[[IN,e.states.inputValue]]),e.filterable?(J(),ge("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ne(e.nsSelect.e("input-calculator")),textContent:pt(e.states.inputValue)},null,10,hOe)):Fe("v-if",!0)],2)),e.shouldShowPlaceholder?(J(),ge("div",{key:2,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?We(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ce("span",null,pt(e.currentPlaceholder),1)]):(J(),ge("span",fOe,pt(e.currentPlaceholder),1))],2)):Fe("v-if",!0)],2),Ce("div",{ref:"suffixRef",class:ne(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(J(),He(m,{key:0,class:ne([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:Ne(()=>[(J(),He(wn(e.iconComponent)))]),_:1},8,["class"])):Fe("v-if",!0),e.showClose&&e.clearIcon?(J(),He(m,{key:1,class:ne([e.nsSelect.e("caret"),e.nsSelect.e("icon")]),onClick:e.handleClearClick},{default:Ne(()=>[(J(),He(wn(e.clearIcon)))]),_:1},8,["class","onClick"])):Fe("v-if",!0),e.validateState&&e.validateIcon?(J(),He(m,{key:2,class:ne([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:Ne(()=>[(J(),He(wn(e.validateIcon)))]),_:1},8,["class"])):Fe("v-if",!0)],2)],2)]}),content:Ne(()=>[Me(T,{ref:"menuRef"},{default:Ne(()=>[e.$slots.header?(J(),ge("div",{key:0,class:ne(e.nsSelect.be("dropdown","header")),onClick:t[13]||(t[13]=nn(()=>{},["stop"]))},[We(e.$slots,"header")],2)):Fe("v-if",!0),hn(Me(S,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:ne([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:Ne(()=>[e.showNewOption?(J(),He(_,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):Fe("v-if",!0),Me(b,null,{default:Ne(()=>[We(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[Jn,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(J(),ge("div",{key:1,class:ne(e.nsSelect.be("dropdown","loading"))},[We(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(J(),ge("div",{key:2,class:ne(e.nsSelect.be("dropdown","empty"))},[We(e.$slots,"empty",{},()=>[Ce("span",null,pt(e.emptyText),1)])],2)):Fe("v-if",!0),e.$slots.footer?(J(),ge("div",{key:3,class:ne(e.nsSelect.be("dropdown","footer")),onClick:t[14]||(t[14]=nn(()=>{},["stop"]))},[We(e.$slots,"footer")],2)):Fe("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","onBeforeShow"])],34)),[[M,e.handleClickOutside,e.popperRef]])}var gOe=vt(uOe,[["render",pOe],["__file","select.vue"]]);const mOe=Se({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=lt("select"),o=ae(null),i=In(),c=ae([]);Ln(Iz,Zn({...ei(e)}));const u=K(()=>c.value.some(_=>_.visible===!0)),f=_=>{var b,S;return((b=_.type)==null?void 0:b.name)==="ElOption"&&!!((S=_.component)!=null&&S.proxy)},p=_=>{const b=vd(_),S=[];return b.forEach(T=>{var M,R;f(T)?S.push(T.component.proxy):(M=T.children)!=null&&M.length?S.push(...p(T.children)):(R=T.component)!=null&&R.subTree&&S.push(...p(T.component.subTree))}),S},m=()=>{c.value=p(i.subTree)};return fn(()=>{m()}),z7(o,m,{attributes:!0,subtree:!0,childList:!0}),{groupRef:o,visible:u,ns:t}}});function vOe(e,t,o,i,c,u){return hn((J(),ge("ul",{ref:"groupRef",class:ne(e.ns.be("group","wrap"))},[Ce("li",{class:ne(e.ns.be("group","title"))},pt(e.label),3),Ce("li",null,[Ce("ul",{class:ne(e.ns.b("group"))},[We(e.$slots,"default")],2)])],2)),[[Jn,e.visible]])}var Cz=vt(mOe,[["render",vOe],["__file","option-group.vue"]]);const Zf=bn(gOe,{Option:jL,OptionGroup:Cz}),RE=Wo(jL),_Oe=Wo(Cz),YL=()=>wt(yz,{}),yOe=gt({pageSize:{type:Number,required:!0},pageSizes:{type:Le(Array),default:()=>zo([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:Al}}),IOe=Se({name:"ElPaginationSizes"}),bOe=Se({...IOe,props:yOe,emits:["page-size-change"],setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=lt("pagination"),u=YL(),f=ae(o.pageSize);rt(()=>o.pageSizes,(_,b)=>{if(!Ri(_,b)&&Array.isArray(_)){const S=_.includes(o.pageSize)?o.pageSize:o.pageSizes[0];t("page-size-change",S)}}),rt(()=>o.pageSize,_=>{f.value=_});const p=K(()=>o.pageSizes);function m(_){var b;_!==f.value&&(f.value=_,(b=u.handleSizeChange)==null||b.call(u,Number(_)))}return(_,b)=>(J(),ge("span",{class:ne(y(c).e("sizes"))},[Me(y(Zf),{"model-value":f.value,disabled:_.disabled,"popper-class":_.popperClass,size:_.size,teleported:_.teleported,"validate-event":!1,onChange:m},{default:Ne(()=>[(J(!0),ge(qt,null,Vn(y(p),S=>(J(),He(y(RE),{key:S,value:S,label:S+y(i)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported"])],2))}});var COe=vt(bOe,[["__file","sizes.vue"]]);const SOe=gt({size:{type:String,values:Al}}),TOe=["disabled"],EOe=Se({name:"ElPaginationJumper"}),MOe=Se({...EOe,props:SOe,setup(e){const{t}=Kn(),o=lt("pagination"),{pageCount:i,disabled:c,currentPage:u,changeEvent:f}=YL(),p=ae(),m=K(()=>{var S;return(S=p.value)!=null?S:u==null?void 0:u.value});function _(S){p.value=S?+S:""}function b(S){S=Math.trunc(+S),f==null||f(S),p.value=void 0}return(S,T)=>(J(),ge("span",{class:ne(y(o).e("jump")),disabled:y(c)},[Ce("span",{class:ne([y(o).e("goto")])},pt(y(t)("el.pagination.goto")),3),Me(y(Ai),{size:S.size,class:ne([y(o).e("editor"),y(o).is("in-pagination")]),min:1,max:y(i),disabled:y(c),"model-value":y(m),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":_,onChange:b},null,8,["size","class","max","disabled","model-value","aria-label"]),Ce("span",{class:ne([y(o).e("classifier")])},pt(y(t)("el.pagination.pageClassifier")),3)],10,TOe))}});var kOe=vt(MOe,[["__file","jumper.vue"]]);const AOe=gt({total:{type:Number,default:1e3}}),ROe=["disabled"],wOe=Se({name:"ElPaginationTotal"}),DOe=Se({...wOe,props:AOe,setup(e){const{t}=Kn(),o=lt("pagination"),{disabled:i}=YL();return(c,u)=>(J(),ge("span",{class:ne(y(o).e("total")),disabled:y(i)},pt(y(t)("el.pagination.total",{total:c.total})),11,ROe))}});var OOe=vt(DOe,[["__file","total.vue"]]);const NOe=gt({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),LOe=["onKeyup"],POe=["aria-current","aria-label","tabindex"],UOe=["tabindex","aria-label"],xOe=["aria-current","aria-label","tabindex"],FOe=["tabindex","aria-label"],VOe=["aria-current","aria-label","tabindex"],GOe=Se({name:"ElPaginationPager"}),BOe=Se({...GOe,props:NOe,emits:["change"],setup(e,{emit:t}){const o=e,i=lt("pager"),c=lt("icon"),{t:u}=Kn(),f=ae(!1),p=ae(!1),m=ae(!1),_=ae(!1),b=ae(!1),S=ae(!1),T=K(()=>{const F=o.pagerCount,H=(F-1)/2,B=Number(o.currentPage),z=Number(o.pageCount);let W=!1,Z=!1;z>F&&(B>F-H&&(W=!0),B<z-H&&(Z=!0));const $=[];if(W&&!Z){const O=z-(F-2);for(let X=O;X<z;X++)$.push(X)}else if(!W&&Z)for(let O=2;O<F;O++)$.push(O);else if(W&&Z){const O=Math.floor(F/2)-1;for(let X=B-O;X<=B+O;X++)$.push(X)}else for(let O=2;O<z;O++)$.push(O);return $}),M=K(()=>["more","btn-quickprev",c.b(),i.is("disabled",o.disabled)]),R=K(()=>["more","btn-quicknext",c.b(),i.is("disabled",o.disabled)]),E=K(()=>o.disabled?-1:0);hi(()=>{const F=(o.pagerCount-1)/2;f.value=!1,p.value=!1,o.pageCount>o.pagerCount&&(o.currentPage>o.pagerCount-F&&(f.value=!0),o.currentPage<o.pageCount-F&&(p.value=!0))});function N(F=!1){o.disabled||(F?m.value=!0:_.value=!0)}function D(F=!1){F?b.value=!0:S.value=!0}function x(F){const H=F.target;if(H.tagName.toLowerCase()==="li"&&Array.from(H.classList).includes("number")){const B=Number(H.textContent);B!==o.currentPage&&t("change",B)}else H.tagName.toLowerCase()==="li"&&Array.from(H.classList).includes("more")&&L(F)}function L(F){const H=F.target;if(H.tagName.toLowerCase()==="ul"||o.disabled)return;let B=Number(H.textContent);const z=o.pageCount,W=o.currentPage,Z=o.pagerCount-2;H.className.includes("more")&&(H.className.includes("quickprev")?B=W-Z:H.className.includes("quicknext")&&(B=W+Z)),Number.isNaN(+B)||(B<1&&(B=1),B>z&&(B=z)),B!==W&&t("change",B)}return(F,H)=>(J(),ge("ul",{class:ne(y(i).b()),onClick:L,onKeyup:go(x,["enter"])},[F.pageCount>0?(J(),ge("li",{key:0,class:ne([[y(i).is("active",F.currentPage===1),y(i).is("disabled",F.disabled)],"number"]),"aria-current":F.currentPage===1,"aria-label":y(u)("el.pagination.currentPage",{pager:1}),tabindex:y(E)}," 1 ",10,POe)):Fe("v-if",!0),f.value?(J(),ge("li",{key:1,class:ne(y(M)),tabindex:y(E),"aria-label":y(u)("el.pagination.prevPages",{pager:F.pagerCount-2}),onMouseenter:H[0]||(H[0]=B=>N(!0)),onMouseleave:H[1]||(H[1]=B=>m.value=!1),onFocus:H[2]||(H[2]=B=>D(!0)),onBlur:H[3]||(H[3]=B=>b.value=!1)},[(m.value||b.value)&&!F.disabled?(J(),He(y(Im),{key:0})):(J(),He(y(A8),{key:1}))],42,UOe)):Fe("v-if",!0),(J(!0),ge(qt,null,Vn(y(T),B=>(J(),ge("li",{key:B,class:ne([[y(i).is("active",F.currentPage===B),y(i).is("disabled",F.disabled)],"number"]),"aria-current":F.currentPage===B,"aria-label":y(u)("el.pagination.currentPage",{pager:B}),tabindex:y(E)},pt(B),11,xOe))),128)),p.value?(J(),ge("li",{key:2,class:ne(y(R)),tabindex:y(E),"aria-label":y(u)("el.pagination.nextPages",{pager:F.pagerCount-2}),onMouseenter:H[4]||(H[4]=B=>N()),onMouseleave:H[5]||(H[5]=B=>_.value=!1),onFocus:H[6]||(H[6]=B=>D()),onBlur:H[7]||(H[7]=B=>S.value=!1)},[(_.value||S.value)&&!F.disabled?(J(),He(y(bm),{key:0})):(J(),He(y(A8),{key:1}))],42,FOe)):Fe("v-if",!0),F.pageCount>1?(J(),ge("li",{key:3,class:ne([[y(i).is("active",F.currentPage===F.pageCount),y(i).is("disabled",F.disabled)],"number"]),"aria-current":F.currentPage===F.pageCount,"aria-label":y(u)("el.pagination.currentPage",{pager:F.pageCount}),tabindex:y(E)},pt(F.pageCount),11,VOe)):Fe("v-if",!0)],42,LOe))}});var $Oe=vt(BOe,[["__file","pager.vue"]]);const Gi=e=>typeof e!="number",HOe=gt({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Zt(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:Le(Array),default:()=>zo([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:mo,default:()=>yd},nextText:{type:String,default:""},nextIcon:{type:mo,default:()=>$i},teleported:{type:Boolean,default:!0},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),qOe={"update:current-page":e=>Zt(e),"update:page-size":e=>Zt(e),"size-change":e=>Zt(e),change:(e,t)=>Zt(e)&&Zt(t),"current-change":e=>Zt(e),"prev-click":e=>Zt(e),"next-click":e=>Zt(e)},BB="ElPagination";var KOe=Se({name:BB,props:HOe,emits:qOe,setup(e,{emit:t,slots:o}){const{t:i}=Kn(),c=lt("pagination"),u=In().vnode.props||{},f="onUpdate:currentPage"in u||"onUpdate:current-page"in u||"onCurrentChange"in u,p="onUpdate:pageSize"in u||"onUpdate:page-size"in u||"onSizeChange"in u,m=K(()=>{if(Gi(e.total)&&Gi(e.pageCount)||!Gi(e.currentPage)&&!f)return!1;if(e.layout.includes("sizes")){if(Gi(e.pageCount)){if(!Gi(e.total)&&!Gi(e.pageSize)&&!p)return!1}else if(!p)return!1}return!0}),_=ae(Gi(e.defaultPageSize)?10:e.defaultPageSize),b=ae(Gi(e.defaultCurrentPage)?1:e.defaultCurrentPage),S=K({get(){return Gi(e.pageSize)?_.value:e.pageSize},set(L){Gi(e.pageSize)&&(_.value=L),p&&(t("update:page-size",L),t("size-change",L))}}),T=K(()=>{let L=0;return Gi(e.pageCount)?Gi(e.total)||(L=Math.max(1,Math.ceil(e.total/S.value))):L=e.pageCount,L}),M=K({get(){return Gi(e.currentPage)?b.value:e.currentPage},set(L){let F=L;L<1?F=1:L>T.value&&(F=T.value),Gi(e.currentPage)&&(b.value=F),f&&(t("update:current-page",F),t("current-change",F))}});rt(T,L=>{M.value>L&&(M.value=L)}),rt([M,S],L=>{t("change",...L)},{flush:"post"});function R(L){M.value=L}function E(L){S.value=L;const F=T.value;M.value>F&&(M.value=F)}function N(){e.disabled||(M.value-=1,t("prev-click",M.value))}function D(){e.disabled||(M.value+=1,t("next-click",M.value))}function x(L,F){L&&(L.props||(L.props={}),L.props.class=[L.props.class,F].join(" "))}return Ln(yz,{pageCount:T,disabled:K(()=>e.disabled),currentPage:M,changeEvent:R,handleSizeChange:E}),()=>{var L,F;if(!m.value)return i("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&T.value<=1)return null;const H=[],B=[],z=Wt("div",{class:c.e("rightwrapper")},B),W={prev:Wt(zDe,{disabled:e.disabled,currentPage:M.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:N}),jumper:Wt(kOe,{size:e.small?"small":"default"}),pager:Wt($Oe,{currentPage:M.value,pageCount:T.value,pagerCount:e.pagerCount,onChange:R,disabled:e.disabled}),next:Wt(QDe,{disabled:e.disabled,currentPage:M.value,pageCount:T.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:D}),sizes:Wt(COe,{pageSize:S.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:e.small?"small":"default"}),slot:(F=(L=o==null?void 0:o.default)==null?void 0:L.call(o))!=null?F:null,total:Wt(OOe,{total:Gi(e.total)?0:e.total})},Z=e.layout.split(",").map(O=>O.trim());let $=!1;return Z.forEach(O=>{if(O==="->"){$=!0;return}$?B.push(W[O]):H.push(W[O])}),x(H[0],c.is("first")),x(H[H.length-1],c.is("last")),$&&B.length>0&&(x(B[0],c.is("first")),x(B[B.length-1],c.is("last")),H.push(z)),Wt("div",{class:[c.b(),c.is("background",e.background),{[c.m("small")]:e.small}]},H)}}});const zOe=bn(KOe),WOe=gt({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:sO,default:"primary"},cancelButtonType:{type:String,values:sO,default:"text"},icon:{type:mo,default:()=>h_e},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Gr.teleported,persistent:Gr.persistent,width:{type:[String,Number],default:150}}),jOe={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},YOe=Se({name:"ElPopconfirm"}),JOe=Se({...YOe,props:WOe,emits:jOe,setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=lt("popconfirm"),u=ae(),f=()=>{var T,M;(M=(T=u.value)==null?void 0:T.onClose)==null||M.call(T)},p=K(()=>({width:Xo(o.width)})),m=T=>{t("confirm",T),f()},_=T=>{t("cancel",T),f()},b=K(()=>o.confirmButtonText||i("el.popconfirm.confirmButtonText")),S=K(()=>o.cancelButtonText||i("el.popconfirm.cancelButtonText"));return(T,M)=>(J(),He(y(Di),Nn({ref_key:"tooltipRef",ref:u,trigger:"click",effect:"light"},T.$attrs,{"popper-class":`${y(c).namespace.value}-popover`,"popper-style":y(p),teleported:T.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":T.hideAfter,persistent:T.persistent}),{content:Ne(()=>[Ce("div",{class:ne(y(c).b())},[Ce("div",{class:ne(y(c).e("main"))},[!T.hideIcon&&T.icon?(J(),He(y(Gt),{key:0,class:ne(y(c).e("icon")),style:Ht({color:T.iconColor})},{default:Ne(()=>[(J(),He(wn(T.icon)))]),_:1},8,["class","style"])):Fe("v-if",!0),On(" "+pt(T.title),1)],2),Ce("div",{class:ne(y(c).e("action"))},[Me(y(qr),{size:"small",type:T.cancelButtonType==="text"?"":T.cancelButtonType,text:T.cancelButtonType==="text",onClick:_},{default:Ne(()=>[On(pt(y(S)),1)]),_:1},8,["type","text"]),Me(y(qr),{size:"small",type:T.confirmButtonType==="text"?"":T.confirmButtonType,text:T.confirmButtonType==="text",onClick:m},{default:Ne(()=>[On(pt(y(b)),1)]),_:1},8,["type","text"])],2)],2)]),default:Ne(()=>[T.$slots.reference?We(T.$slots,"reference",{key:0}):Fe("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var XOe=vt(JOe,[["__file","popconfirm.vue"]]);const QOe=bn(XOe),ZOe=gt({trigger:K0.trigger,placement:KT.placement,disabled:K0.disabled,visible:Gr.visible,transition:Gr.transition,popperOptions:KT.popperOptions,tabindex:KT.tabindex,content:Gr.content,popperStyle:Gr.popperStyle,popperClass:Gr.popperClass,enterable:{...Gr.enterable,default:!0},effect:{...Gr.effect,default:"light"},teleported:Gr.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),eNe={"update:visible":e=>yr(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},tNe="onUpdate:visible",nNe=Se({name:"ElPopover"}),oNe=Se({...nNe,props:ZOe,emits:eNe,setup(e,{expose:t,emit:o}){const i=e,c=K(()=>i[tNe]),u=lt("popover"),f=ae(),p=K(()=>{var N;return(N=y(f))==null?void 0:N.popperRef}),m=K(()=>[{width:Xo(i.width)},i.popperStyle]),_=K(()=>[u.b(),i.popperClass,{[u.m("plain")]:!!i.content}]),b=K(()=>i.transition===`${u.namespace.value}-fade-in-linear`),S=()=>{var N;(N=f.value)==null||N.hide()},T=()=>{o("before-enter")},M=()=>{o("before-leave")},R=()=>{o("after-enter")},E=()=>{o("update:visible",!1),o("after-leave")};return t({popperRef:p,hide:S}),(N,D)=>(J(),He(y(Di),Nn({ref_key:"tooltipRef",ref:f},N.$attrs,{trigger:N.trigger,placement:N.placement,disabled:N.disabled,visible:N.visible,transition:N.transition,"popper-options":N.popperOptions,tabindex:N.tabindex,content:N.content,offset:N.offset,"show-after":N.showAfter,"hide-after":N.hideAfter,"auto-close":N.autoClose,"show-arrow":N.showArrow,"aria-label":N.title,effect:N.effect,enterable:N.enterable,"popper-class":y(_),"popper-style":y(m),teleported:N.teleported,persistent:N.persistent,"gpu-acceleration":y(b),"onUpdate:visible":y(c),onBeforeShow:T,onBeforeHide:M,onShow:R,onHide:E}),{content:Ne(()=>[N.title?(J(),ge("div",{key:0,class:ne(y(u).e("title")),role:"title"},pt(N.title),3)):Fe("v-if",!0),We(N.$slots,"default",{},()=>[On(pt(N.content),1)])]),default:Ne(()=>[N.$slots.reference?We(N.$slots,"reference",{key:0}):Fe("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var rNe=vt(oNe,[["__file","popover.vue"]]);const $B=(e,t)=>{const o=t.arg||t.value,i=o==null?void 0:o.popperRef;i&&(i.triggerRef=e)};var iNe={mounted(e,t){$B(e,t)},updated(e,t){$B(e,t)}};const sNe="popover",Sz=U_e(iNe,sNe),aNe=bn(rNe,{directive:Sz}),lNe=gt({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Le(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Le([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Le(Function),default:e=>`${e}%`}}),cNe=["aria-valuenow"],uNe={viewBox:"0 0 100 100"},dNe=["d","stroke","stroke-linecap","stroke-width"],hNe=["d","stroke","opacity","stroke-linecap","stroke-width"],fNe={key:0},pNe=Se({name:"ElProgress"}),gNe=Se({...pNe,props:lNe,setup(e){const t=e,o={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},i=lt("progress"),c=K(()=>({width:`${t.percentage}%`,animationDuration:`${t.duration}s`,background:x(t.percentage)})),u=K(()=>(t.strokeWidth/t.width*100).toFixed(1)),f=K(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(u.value)/2}`,10):0),p=K(()=>{const L=f.value,F=t.type==="dashboard";return`
          M 50 50
          m 0 ${F?"":"-"}${L}
          a ${L} ${L} 0 1 1 0 ${F?"-":""}${L*2}
          a ${L} ${L} 0 1 1 0 ${F?"":"-"}${L*2}
          `}),m=K(()=>2*Math.PI*f.value),_=K(()=>t.type==="dashboard"?.75:1),b=K(()=>`${-1*m.value*(1-_.value)/2}px`),S=K(()=>({strokeDasharray:`${m.value*_.value}px, ${m.value}px`,strokeDashoffset:b.value})),T=K(()=>({strokeDasharray:`${m.value*_.value*(t.percentage/100)}px, ${m.value}px`,strokeDashoffset:b.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),M=K(()=>{let L;return t.color?L=x(t.percentage):L=o[t.status]||o.default,L}),R=K(()=>t.status==="warning"?a1:t.type==="line"?t.status==="success"?nL:Ad:t.status==="success"?pI:La),E=K(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),N=K(()=>t.format(t.percentage));function D(L){const F=100/L.length;return L.map((B,z)=>on(B)?{color:B,percentage:(z+1)*F}:B).sort((B,z)=>B.percentage-z.percentage)}const x=L=>{var F;const{color:H}=t;if(tn(H))return H(L);if(on(H))return H;{const B=D(H);for(const z of B)if(z.percentage>L)return z.color;return(F=B[B.length-1])==null?void 0:F.color}};return(L,F)=>(J(),ge("div",{class:ne([y(i).b(),y(i).m(L.type),y(i).is(L.status),{[y(i).m("without-text")]:!L.showText,[y(i).m("text-inside")]:L.textInside}]),role:"progressbar","aria-valuenow":L.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[L.type==="line"?(J(),ge("div",{key:0,class:ne(y(i).b("bar"))},[Ce("div",{class:ne(y(i).be("bar","outer")),style:Ht({height:`${L.strokeWidth}px`})},[Ce("div",{class:ne([y(i).be("bar","inner"),{[y(i).bem("bar","inner","indeterminate")]:L.indeterminate},{[y(i).bem("bar","inner","striped")]:L.striped},{[y(i).bem("bar","inner","striped-flow")]:L.stripedFlow}]),style:Ht(y(c))},[(L.showText||L.$slots.default)&&L.textInside?(J(),ge("div",{key:0,class:ne(y(i).be("bar","innerText"))},[We(L.$slots,"default",{percentage:L.percentage},()=>[Ce("span",null,pt(y(N)),1)])],2)):Fe("v-if",!0)],6)],6)],2)):(J(),ge("div",{key:1,class:ne(y(i).b("circle")),style:Ht({height:`${L.width}px`,width:`${L.width}px`})},[(J(),ge("svg",uNe,[Ce("path",{class:ne(y(i).be("circle","track")),d:y(p),stroke:`var(${y(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":L.strokeLinecap,"stroke-width":y(u),fill:"none",style:Ht(y(S))},null,14,dNe),Ce("path",{class:ne(y(i).be("circle","path")),d:y(p),stroke:y(M),fill:"none",opacity:L.percentage?1:0,"stroke-linecap":L.strokeLinecap,"stroke-width":y(u),style:Ht(y(T))},null,14,hNe)]))],6)),(L.showText||L.$slots.default)&&!L.textInside?(J(),ge("div",{key:2,class:ne(y(i).e("text")),style:Ht({fontSize:`${y(E)}px`})},[We(L.$slots,"default",{percentage:L.percentage},()=>[L.status?(J(),He(y(Gt),{key:1},{default:Ne(()=>[(J(),He(wn(y(R))))]),_:1})):(J(),ge("span",fNe,pt(y(N)),1))])],6)):Fe("v-if",!0)],10,cNe))}});var mNe=vt(gNe,[["__file","progress.vue"]]);const Tz=bn(mNe),vNe=gt({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:Le([Array,Object]),default:()=>zo(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:Le([Array,Object]),default:()=>[iT,iT,iT]},voidIcon:{type:mo,default:()=>k_e},disabledVoidIcon:{type:mo,default:()=>iT},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:Le(Array),default:()=>zo(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Nr,label:{type:String,default:void 0},clearable:{type:Boolean,default:!1},...ti(["ariaLabel"])}),_Ne={[Lo]:e=>Zt(e),[Mn]:e=>Zt(e)},yNe=["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"],INe=["onMousemove","onClick"],bNe=Se({name:"ElRate"}),CNe=Se({...bNe,props:vNe,emits:_Ne,setup(e,{expose:t,emit:o}){const i=e;function c(se,ie){const oe=ue=>En(ue),ee=Object.keys(ie).map(ue=>+ue).filter(ue=>{const me=ie[ue];return(oe(me)?me.excluded:!1)?se<ue:se<=ue}).sort((ue,me)=>ue-me),Q=ie[ee[0]];return oe(Q)&&Q.value||Q}const u=wt(sp,void 0),f=wt(kl,void 0),p=Tr(),m=lt("rate"),{inputId:_,isLabeledByFormItem:b}=Va(i,{formItemContext:f}),S=ae(i.modelValue),T=ae(-1),M=ae(!0),R=K(()=>[m.b(),m.m(p.value)]),E=K(()=>i.disabled||(u==null?void 0:u.disabled)),N=K(()=>m.cssVarBlock({"void-color":i.voidColor,"disabled-void-color":i.disabledVoidColor,"fill-color":F.value})),D=K(()=>{let se="";return i.showScore?se=i.scoreTemplate.replace(/\{\s*value\s*\}/,E.value?`${i.modelValue}`:`${S.value}`):i.showText&&(se=i.texts[Math.ceil(S.value)-1]),se}),x=K(()=>i.modelValue*100-Math.floor(i.modelValue)*100),L=K(()=>At(i.colors)?{[i.lowThreshold]:i.colors[0],[i.highThreshold]:{value:i.colors[1],excluded:!0},[i.max]:i.colors[2]}:i.colors),F=K(()=>{const se=c(S.value,L.value);return En(se)?"":se}),H=K(()=>{let se="";return E.value?se=`${x.value}%`:i.allowHalf&&(se="50%"),{color:F.value,width:se}}),B=K(()=>{let se=At(i.icons)?[...i.icons]:{...i.icons};return se=Zg(se),At(se)?{[i.lowThreshold]:se[0],[i.highThreshold]:{value:se[1],excluded:!0},[i.max]:se[2]}:se}),z=K(()=>c(i.modelValue,B.value)),W=K(()=>E.value?on(i.disabledVoidIcon)?i.disabledVoidIcon:Zg(i.disabledVoidIcon):on(i.voidIcon)?i.voidIcon:Zg(i.voidIcon)),Z=K(()=>c(S.value,B.value));function $(se){const ie=E.value&&x.value>0&&se-1<i.modelValue&&se>i.modelValue,oe=i.allowHalf&&M.value&&se-.5<=S.value&&se>S.value;return ie||oe}function O(se){i.clearable&&se===i.modelValue&&(se=0),o(Mn,se),i.modelValue!==se&&o("change",se)}function X(se){E.value||(i.allowHalf&&M.value?O(S.value):O(se))}function le(se){if(E.value)return;let ie=S.value;const oe=se.code;return oe===Yt.up||oe===Yt.right?(i.allowHalf?ie+=.5:ie+=1,se.stopPropagation(),se.preventDefault()):(oe===Yt.left||oe===Yt.down)&&(i.allowHalf?ie-=.5:ie-=1,se.stopPropagation(),se.preventDefault()),ie=ie<0?0:ie,ie=ie>i.max?i.max:ie,o(Mn,ie),o("change",ie),ie}function de(se,ie){if(!E.value){if(i.allowHalf&&ie){let oe=ie.target;ea(oe,m.e("item"))&&(oe=oe.querySelector(`.${m.e("icon")}`)),(oe.clientWidth===0||ea(oe,m.e("decimal")))&&(oe=oe.parentNode),M.value=ie.offsetX*2<=oe.clientWidth,S.value=M.value?se-.5:se}else S.value=se;T.value=se}}function he(){E.value||(i.allowHalf&&(M.value=i.modelValue!==Math.floor(i.modelValue)),S.value=i.modelValue,T.value=-1)}return rt(()=>i.modelValue,se=>{S.value=se,M.value=i.modelValue!==Math.floor(i.modelValue)}),i.modelValue||o(Mn,0),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-rate",ref:"https://element-plus.org/en-US/component/rate.html"},K(()=>!!i.label)),t({setCurrentValue:de,resetCurrentValue:he}),(se,ie)=>{var oe;return J(),ge("div",{id:y(_),class:ne([y(R),y(m).is("disabled",y(E))]),role:"slider","aria-label":y(b)?void 0:se.label||se.ariaLabel||"rating","aria-labelledby":y(b)?(oe=y(f))==null?void 0:oe.labelId:void 0,"aria-valuenow":S.value,"aria-valuetext":y(D)||void 0,"aria-valuemin":"0","aria-valuemax":se.max,tabindex:"0",style:Ht(y(N)),onKeydown:le},[(J(!0),ge(qt,null,Vn(se.max,(ee,Q)=>(J(),ge("span",{key:Q,class:ne(y(m).e("item")),onMousemove:ue=>de(ee,ue),onMouseleave:he,onClick:ue=>X(ee)},[Me(y(Gt),{class:ne([y(m).e("icon"),{hover:T.value===ee},y(m).is("active",ee<=S.value)])},{default:Ne(()=>[$(ee)?Fe("v-if",!0):(J(),ge(qt,{key:0},[hn((J(),He(wn(y(Z)),null,null,512)),[[Jn,ee<=S.value]]),hn((J(),He(wn(y(W)),null,null,512)),[[Jn,!(ee<=S.value)]])],64)),$(ee)?(J(),ge(qt,{key:1},[(J(),He(wn(y(W)),{class:ne([y(m).em("decimal","box")])},null,8,["class"])),Me(y(Gt),{style:Ht(y(H)),class:ne([y(m).e("icon"),y(m).e("decimal")])},{default:Ne(()=>[(J(),He(wn(y(z))))]),_:1},8,["style","class"])],64)):Fe("v-if",!0)]),_:2},1032,["class"])],42,INe))),128)),se.showText||se.showScore?(J(),ge("span",{key:0,class:ne(y(m).e("text")),style:Ht({color:se.textColor})},pt(y(D)),7)):Fe("v-if",!0)],46,yNe)}}});var SNe=vt(CNe,[["__file","rate.vue"]]);const TNe=bn(SNe),jg={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},HB={[jg.success]:Vve,[jg.warning]:a1,[jg.error]:oL,[jg.info]:rL},ENe=gt({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),MNe=Se({name:"ElResult"}),kNe=Se({...MNe,props:ENe,setup(e){const t=e,o=lt("result"),i=K(()=>{const c=t.icon,u=c&&jg[c]?jg[c]:"icon-info",f=HB[u]||HB["icon-info"];return{class:u,component:f}});return(c,u)=>(J(),ge("div",{class:ne(y(o).b())},[Ce("div",{class:ne(y(o).e("icon"))},[We(c.$slots,"icon",{},()=>[y(i).component?(J(),He(wn(y(i).component),{key:0,class:ne(y(i).class)},null,8,["class"])):Fe("v-if",!0)])],2),c.title||c.$slots.title?(J(),ge("div",{key:0,class:ne(y(o).e("title"))},[We(c.$slots,"title",{},()=>[Ce("p",null,pt(c.title),1)])],2)):Fe("v-if",!0),c.subTitle||c.$slots["sub-title"]?(J(),ge("div",{key:1,class:ne(y(o).e("subtitle"))},[We(c.$slots,"sub-title",{},()=>[Ce("p",null,pt(c.subTitle),1)])],2)):Fe("v-if",!0),c.$slots.extra?(J(),ge("div",{key:2,class:ne(y(o).e("extra"))},[We(c.$slots,"extra")],2)):Fe("v-if",!0)],2))}});var ANe=vt(kNe,[["__file","result.vue"]]);const RNe=bn(ANe);var qB=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function wNe(e,t){return!!(e===t||qB(e)&&qB(t))}function DNe(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!wNe(e[o],t[o]))return!1;return!0}function ONe(e,t){t===void 0&&(t=DNe);var o=null;function i(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];if(o&&o.lastThis===this&&t(c,o.lastArgs))return o.lastResult;var f=e.apply(this,c);return o={lastResult:f,lastArgs:c,lastThis:this},f}return i.clear=function(){o=null},i}const Ez=()=>{const t=In().proxy.$props;return K(()=>{const o=(i,c,u)=>({});return t.perfMode?o1(o):ONe(o)})},kO=50,wE="itemRendered",DE="scroll",Yg="forward",OE="backward",Xs="auto",I1="smart",j0="start",bl="center",Y0="end",Rm="horizontal",JL="vertical",NNe="ltr",lm="rtl",J0="negative",XL="positive-ascending",QL="positive-descending",LNe={[Rm]:"left",[JL]:"top"},PNe=20,UNe={[Rm]:"deltaX",[JL]:"deltaY"},xNe=({atEndEdge:e,atStartEdge:t,layout:o},i)=>{let c,u=0;const f=m=>m<0&&t.value||m>0&&e.value;return{hasReachedEdge:f,onWheel:m=>{Jf(c);const _=m[UNe[o.value]];f(u)&&f(u+_)||(u+=_,j7()||m.preventDefault(),c=_d(()=>{i(u),u=0}))}}},AO=xa({type:Le([Number,Function]),required:!0}),RO=xa({type:Number}),wO=xa({type:Number,default:2}),FNe=xa({type:String,values:["ltr","rtl"],default:"ltr"}),DO=xa({type:Number,default:0}),NE=xa({type:Number,required:!0}),Mz=xa({type:String,values:["horizontal","vertical"],default:JL}),kz=gt({className:{type:String,default:""},containerElement:{type:Le([String,Object]),default:"div"},data:{type:Le(Array),default:()=>zo([])},direction:FNe,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:Le([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),Az=gt({cache:wO,estimatedItemSize:RO,layout:Mz,initScrollOffset:DO,total:NE,itemSize:AO,...kz}),OO={type:Number,default:6},Rz={type:Number,default:0},wz={type:Number,default:2},Kf=gt({columnCache:wO,columnWidth:AO,estimatedColumnWidth:RO,estimatedRowHeight:RO,initScrollLeft:DO,initScrollTop:DO,itemKey:{type:Le(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:wO,rowHeight:AO,totalColumn:NE,totalRow:NE,hScrollbarSize:OO,vScrollbarSize:OO,scrollbarStartGap:Rz,scrollbarEndGap:wz,role:String,...kz}),Dz=gt({alwaysOn:Boolean,class:String,layout:Mz,total:NE,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:OO,startGap:Rz,endGap:wz,visible:Boolean}),Pf=(e,t)=>e<t?Yg:OE,X0=e=>e===NNe||e===lm||e===Rm,KB=e=>e===lm;let Vg=null;function LE(e=!1){if(Vg===null||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";const i=document.createElement("div"),c=i.style;return c.width="100px",c.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?Vg=QL:(t.scrollLeft=1,t.scrollLeft===0?Vg=J0:Vg=XL),document.body.removeChild(t),Vg}return Vg}function VNe({move:e,size:t,bar:o},i){const c={},u=`translate${o.axis}(${e}px)`;return c[o.size]=t,c.transform=u,c.msTransform=u,c.webkitTransform=u,i==="horizontal"?c.height="100%":c.width="100%",c}const NO=Se({name:"ElVirtualScrollBar",props:Dz,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const o=K(()=>e.startGap+e.endGap),i=lt("virtual-scrollbar"),c=lt("scrollbar"),u=ae(),f=ae();let p=null,m=null;const _=Zn({isDragging:!1,traveled:0}),b=K(()=>w9[e.layout]),S=K(()=>e.clientSize-y(o)),T=K(()=>({position:"absolute",width:`${Rm===e.layout?S.value:e.scrollbarSize}px`,height:`${Rm===e.layout?e.scrollbarSize:S.value}px`,[LNe[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),M=K(()=>{const B=e.ratio,z=e.clientSize;if(B>=100)return Number.POSITIVE_INFINITY;if(B>=50)return B*z/100;const W=z/3;return Math.floor(Math.min(Math.max(B*z,PNe),W))}),R=K(()=>{if(!Number.isFinite(M.value))return{display:"none"};const B=`${M.value}px`;return VNe({bar:b.value,size:B,move:_.traveled},e.layout)}),E=K(()=>Math.floor(e.clientSize-M.value-y(o))),N=()=>{window.addEventListener("mousemove",F),window.addEventListener("mouseup",L);const B=y(f);B&&(m=document.onselectstart,document.onselectstart=()=>!1,B.addEventListener("touchmove",F),B.addEventListener("touchend",L))},D=()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",L),document.onselectstart=m,m=null;const B=y(f);B&&(B.removeEventListener("touchmove",F),B.removeEventListener("touchend",L))},x=B=>{B.stopImmediatePropagation(),!(B.ctrlKey||[1,2].includes(B.button))&&(_.isDragging=!0,_[b.value.axis]=B.currentTarget[b.value.offset]-(B[b.value.client]-B.currentTarget.getBoundingClientRect()[b.value.direction]),t("start-move"),N())},L=()=>{_.isDragging=!1,_[b.value.axis]=0,t("stop-move"),D()},F=B=>{const{isDragging:z}=_;if(!z||!f.value||!u.value)return;const W=_[b.value.axis];if(!W)return;Jf(p);const Z=(u.value.getBoundingClientRect()[b.value.direction]-B[b.value.client])*-1,$=f.value[b.value.offset]-W,O=Z-$;p=_d(()=>{_.traveled=Math.max(e.startGap,Math.min(O,E.value)),t("scroll",O,E.value)})},H=B=>{const z=Math.abs(B.target.getBoundingClientRect()[b.value.direction]-B[b.value.client]),W=f.value[b.value.offset]/2,Z=z-W;_.traveled=Math.max(0,Math.min(Z,E.value)),t("scroll",Z,E.value)};return rt(()=>e.scrollFrom,B=>{_.isDragging||(_.traveled=Math.ceil(B*E.value))}),Ro(()=>{D()}),()=>Wt("div",{role:"presentation",ref:u,class:[i.b(),e.class,(e.alwaysOn||_.isDragging)&&"always-on"],style:T.value,onMousedown:nn(H,["stop","prevent"]),onTouchstartPrevent:x},Wt("div",{ref:f,class:c.e("thumb"),style:R.value,onMousedown:x},[]))}}),Oz=({name:e,getOffset:t,getItemSize:o,getItemOffset:i,getEstimatedTotalSize:c,getStartIndexForOffset:u,getStopIndexForStartIndex:f,initCache:p,clearCache:m,validateProps:_})=>Se({name:e??"ElVirtualList",props:Az,emits:[wE,DE],setup(b,{emit:S,expose:T}){_(b);const M=In(),R=lt("vl"),E=ae(p(b,M)),N=Ez(),D=ae(),x=ae(),L=ae(),F=ae({isScrolling:!1,scrollDir:"forward",scrollOffset:Zt(b.initScrollOffset)?b.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:b.scrollbarAlwaysOn}),H=K(()=>{const{total:be,cache:ke}=b,{isScrolling:Ye,scrollDir:Oe,scrollOffset:Ee}=y(F);if(be===0)return[0,0,0,0];const we=u(b,Ee,y(E)),Ge=f(b,we,Ee,y(E)),Ve=!Ye||Oe===OE?Math.max(1,ke):1,qe=!Ye||Oe===Yg?Math.max(1,ke):1;return[Math.max(0,we-Ve),Math.max(0,Math.min(be-1,Ge+qe)),we,Ge]}),B=K(()=>c(b,y(E))),z=K(()=>X0(b.layout)),W=K(()=>[{position:"relative",[`overflow-${z.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:b.direction,height:Zt(b.height)?`${b.height}px`:b.height,width:Zt(b.width)?`${b.width}px`:b.width},b.style]),Z=K(()=>{const be=y(B),ke=y(z);return{height:ke?"100%":`${be}px`,pointerEvents:y(F).isScrolling?"none":void 0,width:ke?`${be}px`:"100%"}}),$=K(()=>z.value?b.width:b.height),{onWheel:O}=xNe({atStartEdge:K(()=>F.value.scrollOffset<=0),atEndEdge:K(()=>F.value.scrollOffset>=B.value),layout:K(()=>b.layout)},be=>{var ke,Ye;(Ye=(ke=L.value).onMouseUp)==null||Ye.call(ke),ie(Math.min(F.value.scrollOffset+be,B.value-$.value))}),X=()=>{const{total:be}=b;if(be>0){const[Ee,we,Ge,Ve]=y(H);S(wE,Ee,we,Ge,Ve)}const{scrollDir:ke,scrollOffset:Ye,updateRequested:Oe}=y(F);S(DE,ke,Ye,Oe)},le=be=>{const{clientHeight:ke,scrollHeight:Ye,scrollTop:Oe}=be.currentTarget,Ee=y(F);if(Ee.scrollOffset===Oe)return;const we=Math.max(0,Math.min(Oe,Ye-ke));F.value={...Ee,isScrolling:!0,scrollDir:Pf(Ee.scrollOffset,we),scrollOffset:we,updateRequested:!1},zt(Q)},de=be=>{const{clientWidth:ke,scrollLeft:Ye,scrollWidth:Oe}=be.currentTarget,Ee=y(F);if(Ee.scrollOffset===Ye)return;const{direction:we}=b;let Ge=Ye;if(we===lm)switch(LE()){case J0:{Ge=-Ye;break}case QL:{Ge=Oe-ke-Ye;break}}Ge=Math.max(0,Math.min(Ge,Oe-ke)),F.value={...Ee,isScrolling:!0,scrollDir:Pf(Ee.scrollOffset,Ge),scrollOffset:Ge,updateRequested:!1},zt(Q)},he=be=>{y(z)?de(be):le(be),X()},se=(be,ke)=>{const Ye=(B.value-$.value)/ke*be;ie(Math.min(B.value-$.value,Ye))},ie=be=>{be=Math.max(be,0),be!==y(F).scrollOffset&&(F.value={...y(F),scrollOffset:be,scrollDir:Pf(y(F).scrollOffset,be),updateRequested:!0},zt(Q))},oe=(be,ke=Xs)=>{const{scrollOffset:Ye}=y(F);be=Math.max(0,Math.min(be,b.total-1)),ie(t(b,be,ke,Ye,y(E)))},ee=be=>{const{direction:ke,itemSize:Ye,layout:Oe}=b,Ee=N.value(m&&Ye,m&&Oe,m&&ke);let we;if(qn(Ee,String(be)))we=Ee[be];else{const Ge=i(b,be,y(E)),Ve=o(b,be,y(E)),qe=y(z),st=ke===lm,Ie=qe?Ge:0;Ee[be]=we={position:"absolute",left:st?void 0:`${Ie}px`,right:st?`${Ie}px`:void 0,top:qe?0:`${Ge}px`,height:qe?"100%":`${Ve}px`,width:qe?`${Ve}px`:"100%"}}return we},Q=()=>{F.value.isScrolling=!1,zt(()=>{N.value(-1,null,null)})},ue=()=>{const be=D.value;be&&(be.scrollTop=0)};fn(()=>{if(!$n)return;const{initScrollOffset:be}=b,ke=y(D);Zt(be)&&ke&&(y(z)?ke.scrollLeft=be:ke.scrollTop=be),X()}),Oc(()=>{const{direction:be,layout:ke}=b,{scrollOffset:Ye,updateRequested:Oe}=y(F),Ee=y(D);if(Oe&&Ee)if(ke===Rm)if(be===lm)switch(LE()){case J0:{Ee.scrollLeft=-Ye;break}case XL:{Ee.scrollLeft=Ye;break}default:{const{clientWidth:we,scrollWidth:Ge}=Ee;Ee.scrollLeft=Ge-we-Ye;break}}else Ee.scrollLeft=Ye;else Ee.scrollTop=Ye});const me={ns:R,clientSize:$,estimatedTotalSize:B,windowStyle:W,windowRef:D,innerRef:x,innerStyle:Z,itemsToRender:H,scrollbarRef:L,states:F,getItemStyle:ee,onScroll:he,onScrollbarScroll:se,onWheel:O,scrollTo:ie,scrollToItem:oe,resetScrollTop:ue};return T({windowRef:D,innerRef:x,getItemStyleCache:N,scrollTo:ie,scrollToItem:oe,resetScrollTop:ue,states:F}),me},render(b){var S;const{$slots:T,className:M,clientSize:R,containerElement:E,data:N,getItemStyle:D,innerElement:x,itemsToRender:L,innerStyle:F,layout:H,total:B,onScroll:z,onScrollbarScroll:W,onWheel:Z,states:$,useIsScrolling:O,windowStyle:X,ns:le}=b,[de,he]=L,se=wn(E),ie=wn(x),oe=[];if(B>0)for(let me=de;me<=he;me++)oe.push((S=T.default)==null?void 0:S.call(T,{data:N,key:me,index:me,isScrolling:O?$.isScrolling:void 0,style:D(me)}));const ee=[Wt(ie,{style:F,ref:"innerRef"},on(ie)?oe:{default:()=>oe})],Q=Wt(NO,{ref:"scrollbarRef",clientSize:R,layout:H,onScroll:W,ratio:R*100/this.estimatedTotalSize,scrollFrom:$.scrollOffset/(this.estimatedTotalSize-R),total:B}),ue=Wt(se,{class:[le.e("window"),M],style:X,onScroll:z,onWheel:Z,ref:"windowRef",key:0},on(se)?[ee]:{default:()=>[ee]});return Wt("div",{key:0,class:[le.e("wrapper"),$.scrollbarAlwaysOn?"always-on":""]},[ue,Q])}}),Nz=Oz({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:o,layout:i,width:c},u,f,p)=>{const m=X0(i)?c:e,_=Math.max(0,t*o-m),b=Math.min(_,u*o),S=Math.max(0,(u+1)*o-m);switch(f===I1&&(p>=S-m&&p<=b+m?f=Xs:f=bl),f){case j0:return b;case Y0:return S;case bl:{const T=Math.round(S+(b-S)/2);return T<Math.ceil(m/2)?0:T>_+Math.floor(m/2)?_:T}case Xs:default:return p>=S&&p<=b?p:p<S?S:b}},getStartIndexForOffset:({total:e,itemSize:t},o)=>Math.max(0,Math.min(e-1,Math.floor(o/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:o,layout:i,width:c},u,f)=>{const p=u*o,m=X0(i)?c:e,_=Math.ceil((m+f-p)/o);return Math.max(0,Math.min(t-1,u+_-1))},initCache(){},clearCache:!0,validateProps(){}}),Jg=(e,t,o)=>{const{itemSize:i}=e,{items:c,lastVisitedIndex:u}=o;if(t>u){let f=0;if(u>=0){const p=c[u];f=p.offset+p.size}for(let p=u+1;p<=t;p++){const m=i(p);c[p]={offset:f,size:m},f+=m}o.lastVisitedIndex=t}return c[t]},GNe=(e,t,o)=>{const{items:i,lastVisitedIndex:c}=t;return(c>0?i[c].offset:0)>=o?Lz(e,t,0,c,o):BNe(e,t,Math.max(0,c),o)},Lz=(e,t,o,i,c)=>{for(;o<=i;){const u=o+Math.floor((i-o)/2),f=Jg(e,u,t).offset;if(f===c)return u;f<c?o=u+1:f>c&&(i=u-1)}return Math.max(0,o-1)},BNe=(e,t,o,i)=>{const{total:c}=e;let u=1;for(;o<c&&Jg(e,o,t).offset<i;)o+=u,u*=2;return Lz(e,t,Math.floor(o/2),Math.min(o,c-1),i)},zB=({total:e},{items:t,estimatedItemSize:o,lastVisitedIndex:i})=>{let c=0;if(i>=e&&(i=e-1),i>=0){const p=t[i];c=p.offset+p.size}const f=(e-i-1)*o;return c+f},$Ne=Oz({name:"ElDynamicSizeList",getItemOffset:(e,t,o)=>Jg(e,t,o).offset,getItemSize:(e,t,{items:o})=>o[t].size,getEstimatedTotalSize:zB,getOffset:(e,t,o,i,c)=>{const{height:u,layout:f,width:p}=e,m=X0(f)?p:u,_=Jg(e,t,c),b=zB(e,c),S=Math.max(0,Math.min(b-m,_.offset)),T=Math.max(0,_.offset-m+_.size);switch(o===I1&&(i>=T-m&&i<=S+m?o=Xs:o=bl),o){case j0:return S;case Y0:return T;case bl:return Math.round(T+(S-T)/2);case Xs:default:return i>=T&&i<=S?i:i<T?T:S}},getStartIndexForOffset:(e,t,o)=>GNe(e,o,t),getStopIndexForStartIndex:(e,t,o,i)=>{const{height:c,total:u,layout:f,width:p}=e,m=X0(f)?p:c,_=Jg(e,t,i),b=o+m;let S=_.offset+_.size,T=t;for(;T<u-1&&S<b;)T++,S+=Jg(e,T,i).size;return T},initCache({estimatedItemSize:e=kO},t){const o={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return o.clearCacheAfterIndex=(i,c=!0)=>{var u,f;o.lastVisitedIndex=Math.min(o.lastVisitedIndex,i-1),(u=t.exposed)==null||u.getItemStyleCache(-1),c&&((f=t.proxy)==null||f.$forceUpdate())},o},clearCache:!1,validateProps:({itemSize:e})=>{}}),HNe=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:o,atYStartEdge:i},c)=>{let u=null,f=0,p=0;const m=(b,S)=>{const T=b<=0&&t.value||b>=0&&e.value,M=S<=0&&i.value||S>=0&&o.value;return T&&M};return{hasReachedEdge:m,onWheel:b=>{Jf(u);let S=b.deltaX,T=b.deltaY;Math.abs(S)>Math.abs(T)?T=0:S=0,b.shiftKey&&T!==0&&(S=T,T=0),!(m(f,p)&&m(f+S,p+T))&&(f+=S,p+=T,b.preventDefault(),u=_d(()=>{c(f,p),f=0,p=0}))}}},Pz=({name:e,clearCache:t,getColumnPosition:o,getColumnStartIndexForOffset:i,getColumnStopIndexForStartIndex:c,getEstimatedTotalHeight:u,getEstimatedTotalWidth:f,getColumnOffset:p,getRowOffset:m,getRowPosition:_,getRowStartIndexForOffset:b,getRowStopIndexForStartIndex:S,initCache:T,injectToInstance:M,validateProps:R})=>Se({name:e??"ElVirtualList",props:Kf,emits:[wE,DE],setup(E,{emit:N,expose:D,slots:x}){const L=lt("vl");R(E);const F=In(),H=ae(T(E,F));M==null||M(F,H);const B=ae(),z=ae(),W=ae(),Z=ae(null),$=ae({isScrolling:!1,scrollLeft:Zt(E.initScrollLeft)?E.initScrollLeft:0,scrollTop:Zt(E.initScrollTop)?E.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Yg,yAxisScrollDir:Yg}),O=Ez(),X=K(()=>Number.parseInt(`${E.height}`,10)),le=K(()=>Number.parseInt(`${E.width}`,10)),de=K(()=>{const{totalColumn:je,totalRow:at,columnCache:ht}=E,{isScrolling:dt,xAxisScrollDir:ft,scrollLeft:Je}=y($);if(je===0||at===0)return[0,0,0,0];const Et=i(E,Je,y(H)),Nt=c(E,Et,Je,y(H)),et=!dt||ft===OE?Math.max(1,ht):1,Mt=!dt||ft===Yg?Math.max(1,ht):1;return[Math.max(0,Et-et),Math.max(0,Math.min(je-1,Nt+Mt)),Et,Nt]}),he=K(()=>{const{totalColumn:je,totalRow:at,rowCache:ht}=E,{isScrolling:dt,yAxisScrollDir:ft,scrollTop:Je}=y($);if(je===0||at===0)return[0,0,0,0];const Et=b(E,Je,y(H)),Nt=S(E,Et,Je,y(H)),et=!dt||ft===OE?Math.max(1,ht):1,Mt=!dt||ft===Yg?Math.max(1,ht):1;return[Math.max(0,Et-et),Math.max(0,Math.min(at-1,Nt+Mt)),Et,Nt]}),se=K(()=>u(E,y(H))),ie=K(()=>f(E,y(H))),oe=K(()=>{var je;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:E.direction,height:Zt(E.height)?`${E.height}px`:E.height,width:Zt(E.width)?`${E.width}px`:E.width},(je=E.style)!=null?je:{}]}),ee=K(()=>{const je=`${y(ie)}px`;return{height:`${y(se)}px`,pointerEvents:y($).isScrolling?"none":void 0,width:je}}),Q=()=>{const{totalColumn:je,totalRow:at}=E;if(je>0&&at>0){const[Nt,et,Mt,Jt]=y(de),[sn,gn,Bt,nt]=y(he);N(wE,{columnCacheStart:Nt,columnCacheEnd:et,rowCacheStart:sn,rowCacheEnd:gn,columnVisibleStart:Mt,columnVisibleEnd:Jt,rowVisibleStart:Bt,rowVisibleEnd:nt})}const{scrollLeft:ht,scrollTop:dt,updateRequested:ft,xAxisScrollDir:Je,yAxisScrollDir:Et}=y($);N(DE,{xAxisScrollDir:Je,scrollLeft:ht,yAxisScrollDir:Et,scrollTop:dt,updateRequested:ft})},ue=je=>{const{clientHeight:at,clientWidth:ht,scrollHeight:dt,scrollLeft:ft,scrollTop:Je,scrollWidth:Et}=je.currentTarget,Nt=y($);if(Nt.scrollTop===Je&&Nt.scrollLeft===ft)return;let et=ft;if(KB(E.direction))switch(LE()){case J0:et=-ft;break;case QL:et=Et-ht-ft;break}$.value={...Nt,isScrolling:!0,scrollLeft:et,scrollTop:Math.max(0,Math.min(Je,dt-at)),updateRequested:!0,xAxisScrollDir:Pf(Nt.scrollLeft,et),yAxisScrollDir:Pf(Nt.scrollTop,Je)},zt(()=>we()),Ge(),Q()},me=(je,at)=>{const ht=y(X),dt=(se.value-ht)/at*je;Ye({scrollTop:Math.min(se.value-ht,dt)})},be=(je,at)=>{const ht=y(le),dt=(ie.value-ht)/at*je;Ye({scrollLeft:Math.min(ie.value-ht,dt)})},{onWheel:ke}=HNe({atXStartEdge:K(()=>$.value.scrollLeft<=0),atXEndEdge:K(()=>$.value.scrollLeft>=ie.value-y(le)),atYStartEdge:K(()=>$.value.scrollTop<=0),atYEndEdge:K(()=>$.value.scrollTop>=se.value-y(X))},(je,at)=>{var ht,dt,ft,Je;(dt=(ht=z.value)==null?void 0:ht.onMouseUp)==null||dt.call(ht),(Je=(ft=W.value)==null?void 0:ft.onMouseUp)==null||Je.call(ft);const Et=y(le),Nt=y(X);Ye({scrollLeft:Math.min($.value.scrollLeft+je,ie.value-Et),scrollTop:Math.min($.value.scrollTop+at,se.value-Nt)})}),Ye=({scrollLeft:je=$.value.scrollLeft,scrollTop:at=$.value.scrollTop})=>{je=Math.max(je,0),at=Math.max(at,0);const ht=y($);at===ht.scrollTop&&je===ht.scrollLeft||($.value={...ht,xAxisScrollDir:Pf(ht.scrollLeft,je),yAxisScrollDir:Pf(ht.scrollTop,at),scrollLeft:je,scrollTop:at,updateRequested:!0},zt(()=>we()),Ge(),Q())},Oe=(je=0,at=0,ht=Xs)=>{const dt=y($);at=Math.max(0,Math.min(at,E.totalColumn-1)),je=Math.max(0,Math.min(je,E.totalRow-1));const ft=Uq(L.namespace.value),Je=y(H),Et=u(E,Je),Nt=f(E,Je);Ye({scrollLeft:p(E,at,ht,dt.scrollLeft,Je,Nt>E.width?ft:0),scrollTop:m(E,je,ht,dt.scrollTop,Je,Et>E.height?ft:0)})},Ee=(je,at)=>{const{columnWidth:ht,direction:dt,rowHeight:ft}=E,Je=O.value(t&&ht,t&&ft,t&&dt),Et=`${je},${at}`;if(qn(Je,Et))return Je[Et];{const[,Nt]=o(E,at,y(H)),et=y(H),Mt=KB(dt),[Jt,sn]=_(E,je,et),[gn]=o(E,at,et);return Je[Et]={position:"absolute",left:Mt?void 0:`${Nt}px`,right:Mt?`${Nt}px`:void 0,top:`${sn}px`,height:`${Jt}px`,width:`${gn}px`},Je[Et]}},we=()=>{$.value.isScrolling=!1,zt(()=>{O.value(-1,null,null)})};fn(()=>{if(!$n)return;const{initScrollLeft:je,initScrollTop:at}=E,ht=y(B);ht&&(Zt(je)&&(ht.scrollLeft=je),Zt(at)&&(ht.scrollTop=at)),Q()});const Ge=()=>{const{direction:je}=E,{scrollLeft:at,scrollTop:ht,updateRequested:dt}=y($),ft=y(B);if(dt&&ft){if(je===lm)switch(LE()){case J0:{ft.scrollLeft=-at;break}case XL:{ft.scrollLeft=at;break}default:{const{clientWidth:Je,scrollWidth:Et}=ft;ft.scrollLeft=Et-Je-at;break}}else ft.scrollLeft=Math.max(0,at);ft.scrollTop=Math.max(0,ht)}},{resetAfterColumnIndex:Ve,resetAfterRowIndex:qe,resetAfter:st}=F.proxy;D({windowRef:B,innerRef:Z,getItemStyleCache:O,scrollTo:Ye,scrollToItem:Oe,states:$,resetAfterColumnIndex:Ve,resetAfterRowIndex:qe,resetAfter:st});const Ie=()=>{const{scrollbarAlwaysOn:je,scrollbarStartGap:at,scrollbarEndGap:ht,totalColumn:dt,totalRow:ft}=E,Je=y(le),Et=y(X),Nt=y(ie),et=y(se),{scrollLeft:Mt,scrollTop:Jt}=y($),sn=Wt(NO,{ref:z,alwaysOn:je,startGap:at,endGap:ht,class:L.e("horizontal"),clientSize:Je,layout:"horizontal",onScroll:be,ratio:Je*100/Nt,scrollFrom:Mt/(Nt-Je),total:ft,visible:!0}),gn=Wt(NO,{ref:W,alwaysOn:je,startGap:at,endGap:ht,class:L.e("vertical"),clientSize:Et,layout:"vertical",onScroll:me,ratio:Et*100/et,scrollFrom:Jt/(et-Et),total:dt,visible:!0});return{horizontalScrollbar:sn,verticalScrollbar:gn}},Ae=()=>{var je;const[at,ht]=y(de),[dt,ft]=y(he),{data:Je,totalColumn:Et,totalRow:Nt,useIsScrolling:et,itemKey:Mt}=E,Jt=[];if(Nt>0&&Et>0)for(let sn=dt;sn<=ft;sn++)for(let gn=at;gn<=ht;gn++)Jt.push((je=x.default)==null?void 0:je.call(x,{columnIndex:gn,data:Je,key:Mt({columnIndex:gn,data:Je,rowIndex:sn}),isScrolling:et?y($).isScrolling:void 0,style:Ee(sn,gn),rowIndex:sn}));return Jt},xe=()=>{const je=wn(E.innerElement),at=Ae();return[Wt(je,{style:y(ee),ref:Z},on(je)?at:{default:()=>at})]};return()=>{const je=wn(E.containerElement),{horizontalScrollbar:at,verticalScrollbar:ht}=Ie(),dt=xe();return Wt("div",{key:0,class:L.e("wrapper"),role:E.role},[Wt(je,{class:E.className,style:y(oe),onScroll:ue,onWheel:ke,ref:B},on(je)?dt:{default:()=>dt}),at,ht])}}}),qNe=Pz({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:o},i,c,u,f,p)=>{o=Number(o);const m=Math.max(0,e*t-o),_=Math.min(m,i*t),b=Math.max(0,i*t-o+p+t);switch(c==="smart"&&(u>=b-o&&u<=_+o?c=Xs:c=bl),c){case j0:return _;case Y0:return b;case bl:{const S=Math.round(b+(_-b)/2);return S<Math.ceil(o/2)?0:S>m+Math.floor(o/2)?m:S}case Xs:default:return u>=b&&u<=_?u:b>_||u<b?b:_}},getRowOffset:({rowHeight:e,height:t,totalRow:o},i,c,u,f,p)=>{t=Number(t);const m=Math.max(0,o*e-t),_=Math.min(m,i*e),b=Math.max(0,i*e-t+p+e);switch(c===I1&&(u>=b-t&&u<=_+t?c=Xs:c=bl),c){case j0:return _;case Y0:return b;case bl:{const S=Math.round(b+(_-b)/2);return S<Math.ceil(t/2)?0:S>m+Math.floor(t/2)?m:S}case Xs:default:return u>=b&&u<=_?u:b>_||u<b?b:_}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:o},i,c)=>{const u=i*e,f=Math.ceil((o+c-u)/e);return Math.max(0,Math.min(t-1,i+f-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:o},i,c)=>{const u=i*e,f=Math.ceil((o+c-u)/e);return Math.max(0,Math.min(t-1,i+f-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),{max:PE,min:Uz,floor:xz}=Math,KNe={column:"columnWidth",row:"rowHeight"},LO={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},_c=(e,t,o,i)=>{const[c,u,f]=[o[i],e[KNe[i]],o[LO[i]]];if(t>f){let p=0;if(f>=0){const m=c[f];p=m.offset+m.size}for(let m=f+1;m<=t;m++){const _=u(m);c[m]={offset:p,size:_},p+=_}o[LO[i]]=t}return c[t]},Fz=(e,t,o,i,c,u)=>{for(;o<=i;){const f=o+xz((i-o)/2),p=_c(e,f,t,u).offset;if(p===c)return f;p<c?o=f+1:i=f-1}return PE(0,o-1)},zNe=(e,t,o,i,c)=>{const u=c==="column"?e.totalColumn:e.totalRow;let f=1;for(;o<u&&_c(e,o,t,c).offset<i;)o+=f,f*=2;return Fz(e,t,xz(o/2),Uz(o,u-1),i,c)},WB=(e,t,o,i)=>{const[c,u]=[t[i],t[LO[i]]];return(u>0?c[u].offset:0)>=o?Fz(e,t,0,u,o,i):zNe(e,t,PE(0,u),o,i)},Vz=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:o,row:i})=>{let c=0;if(o>=e&&(o=e-1),o>=0){const p=i[o];c=p.offset+p.size}const f=(e-o-1)*t;return c+f},Gz=({totalColumn:e},{column:t,estimatedColumnWidth:o,lastVisitedColumnIndex:i})=>{let c=0;if(i>e&&(i=e-1),i>=0){const p=t[i];c=p.offset+p.size}const f=(e-i-1)*o;return c+f},WNe={column:Gz,row:Vz},jB=(e,t,o,i,c,u,f)=>{const[p,m]=[u==="row"?e.height:e.width,WNe[u]],_=_c(e,t,c,u),b=m(e,c),S=PE(0,Uz(b-p,_.offset)),T=PE(0,_.offset-p+f+_.size);switch(o===I1&&(i>=T-p&&i<=S+p?o=Xs:o=bl),o){case j0:return S;case Y0:return T;case bl:return Math.round(T+(S-T)/2);case Xs:default:return i>=T&&i<=S?i:T>S||i<T?T:S}},jNe=Pz({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,o)=>{const i=_c(e,t,o,"column");return[i.size,i.offset]},getRowPosition:(e,t,o)=>{const i=_c(e,t,o,"row");return[i.size,i.offset]},getColumnOffset:(e,t,o,i,c,u)=>jB(e,t,o,i,c,"column",u),getRowOffset:(e,t,o,i,c,u)=>jB(e,t,o,i,c,"row",u),getColumnStartIndexForOffset:(e,t,o)=>WB(e,o,t,"column"),getColumnStopIndexForStartIndex:(e,t,o,i)=>{const c=_c(e,t,i,"column"),u=o+e.width;let f=c.offset+c.size,p=t;for(;p<e.totalColumn-1&&f<u;)p++,f+=_c(e,t,i,"column").size;return p},getEstimatedTotalHeight:Vz,getEstimatedTotalWidth:Gz,getRowStartIndexForOffset:(e,t,o)=>WB(e,o,t,"row"),getRowStopIndexForStartIndex:(e,t,o,i)=>{const{totalRow:c,height:u}=e,f=_c(e,t,i,"row"),p=o+u;let m=f.size+f.offset,_=t;for(;_<c-1&&m<p;)_++,m+=_c(e,_,i,"row").size;return _},injectToInstance:(e,t)=>{const o=({columnIndex:u,rowIndex:f},p)=>{var m,_;p=_r(p)?!0:p,Zt(u)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,u-1)),Zt(f)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,f-1)),(m=e.exposed)==null||m.getItemStyleCache.value(-1,null,null),p&&((_=e.proxy)==null||_.$forceUpdate())},i=(u,f)=>{o({columnIndex:u},f)},c=(u,f)=>{o({rowIndex:u},f)};Object.assign(e.proxy,{resetAfterColumnIndex:i,resetAfterRowIndex:c,resetAfter:o})},initCache:({estimatedColumnWidth:e=kO,estimatedRowHeight:t=kO})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),YNe=Se({props:{item:{type:Object,required:!0},style:Object,height:Number},setup(){return{ns:lt("select")}}});function JNe(e,t,o,i,c,u){return J(),ge("div",{class:ne(e.ns.be("group","title")),style:Ht([e.style,{lineHeight:`${e.height}px`}])},pt(e.item.label),7)}var XNe=vt(YNe,[["render",JNe],["__file","group-item.vue"]]);function QNe(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const Bz={label:"label",value:"value",disabled:"disabled",options:"options"};function b1(e){const t=K(()=>({...Bz,...e.props}));return{aliasProps:t,getLabel:f=>ir(f,t.value.label),getValue:f=>ir(f,t.value.value),getDisabled:f=>ir(f,t.value.disabled),getOptions:f=>ir(f,t.value.options)}}const ZNe=gt({allowCreate:Boolean,autocomplete:{type:Le(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:mo,default:Ad},effect:{type:Le(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:Le([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Le(Array),required:!0},placeholder:{type:String},teleported:Gr.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Le(Object),default:()=>({})},remote:Boolean,size:Nr,props:{type:Le(Object),default:()=>Bz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},placement:{type:Le(String),values:ip,default:"bottom-start"},fallbackPlacements:{type:Le(Array),default:["bottom-start","top-start","right","left"]},tagType:{...v1.type,default:"info"},...Hm,...ti(["ariaLabel"])}),eLe=gt({data:Array,disabled:Boolean,hovering:Boolean,item:{type:Le(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),ZL=Symbol("ElSelectV2Injection"),tLe=Se({props:eLe,emits:["select","hover"],setup(e,{emit:t}){const o=wt(ZL),i=lt("select"),{hoverItem:c,selectOptionClick:u}=QNe(e,{emit:t}),{getLabel:f}=b1(o.props);return{ns:i,hoverItem:c,selectOptionClick:u,getLabel:f}}}),nLe=["aria-selected"];function oLe(e,t,o,i,c,u){return J(),ge("li",{"aria-selected":e.selected,style:Ht(e.style),class:ne([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMouseenter:t[0]||(t[0]=(...f)=>e.hoverItem&&e.hoverItem(...f)),onClick:t[1]||(t[1]=nn((...f)=>e.selectOptionClick&&e.selectOptionClick(...f),["stop"]))},[We(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ce("span",null,pt(e.getLabel(e.item)),1)])],46,nLe)}var rLe=vt(tLe,[["render",oLe],["__file","option-item.vue"]]),iLe=Se({name:"ElSelectDropdown",props:{loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number},setup(e,{slots:t,expose:o}){const i=wt(ZL),c=lt("select"),{getLabel:u,getValue:f,getDisabled:p}=b1(i.props),m=ae([]),_=ae(),b=K(()=>e.data.length);rt(()=>b.value,()=>{var O,X;(X=(O=i.tooltipRef.value).updatePopper)==null||X.call(O)});const S=K(()=>_r(i.props.estimatedOptionHeight)),T=K(()=>S.value?{itemSize:i.props.itemHeight}:{estimatedSize:i.props.estimatedOptionHeight,itemSize:O=>m.value[O]}),M=(O=[],X)=>{const{props:{valueKey:le}}=i;return En(X)?O&&O.some(de=>fo(ir(de,le))===ir(X,le)):O.includes(X)},R=(O,X)=>{if(En(X)){const{valueKey:le}=i.props;return ir(O,le)===ir(X,le)}else return O===X},E=(O,X)=>i.props.multiple?M(O,f(X)):R(O,f(X)),N=(O,X)=>{const{disabled:le,multiple:de,multipleLimit:he}=i.props;return le||!X&&(de?he>0&&O.length>=he:!1)},D=O=>e.hoveringIndex===O;o({listRef:_,isSized:S,isItemDisabled:N,isItemHovering:D,isItemSelected:E,scrollToItem:O=>{const X=_.value;X&&X.scrollToItem(O)},resetScrollTop:()=>{const O=_.value;O&&O.resetScrollTop()}});const F=O=>{const{index:X,data:le,style:de}=O,he=y(S),{itemSize:se,estimatedSize:ie}=y(T),{modelValue:oe}=i.props,{onSelect:ee,onHover:Q}=i,ue=le[X];if(ue.type==="Group")return Me(XNe,{item:ue,style:de,height:he?se:ie},null);const me=E(oe,ue),be=N(oe,me),ke=D(X);return Me(rLe,Nn(O,{selected:me,disabled:p(ue)||be,created:!!ue.created,hovering:ke,item:ue,onSelect:ee,onHover:Q}),{default:Ye=>{var Oe;return((Oe=t.default)==null?void 0:Oe.call(t,Ye))||Me("span",null,[u(ue)])}})},{onKeyboardNavigate:H,onKeyboardSelect:B}=i,z=()=>{H("forward")},W=()=>{H("backward")},Z=()=>{i.expanded=!1},$=O=>{const{code:X}=O,{tab:le,esc:de,down:he,up:se,enter:ie}=Yt;switch(X!==le&&(O.preventDefault(),O.stopPropagation()),X){case le:case de:{Z();break}case he:{z();break}case se:{W();break}case ie:{B();break}}};return()=>{var O,X,le,de;const{data:he,width:se}=e,{height:ie,multiple:oe,scrollbarAlwaysOn:ee}=i.props,Q=y(S)?Nz:$Ne;return Me("div",{class:[c.b("dropdown"),c.is("multiple",oe)],style:{width:`${se}px`}},[(O=t.header)==null?void 0:O.call(t),((X=t.loading)==null?void 0:X.call(t))||((le=t.empty)==null?void 0:le.call(t))||Me(Q,Nn({ref:_},y(T),{className:c.be("dropdown","list"),scrollbarAlwaysOn:ee,data:he,height:ie,width:se,total:he.length,onKeydown:$}),{default:ue=>Me(F,ue,null)}),(de=t.footer)==null?void 0:de.call(t)])}}});function sLe(e,t){const{aliasProps:o,getLabel:i,getValue:c}=b1(e),u=ae(0),f=ae(null),p=K(()=>e.allowCreate&&e.filterable);function m(M){const R=E=>i(E)===M;return e.options&&e.options.some(R)||t.createdOptions.some(R)}function _(M){p.value&&(e.multiple&&M.created?u.value++:f.value=M)}function b(M){if(p.value)if(M&&M.length>0){if(m(M))return;const R={[o.value.value]:M,[o.value.label]:M,created:!0,[o.value.disabled]:!1};t.createdOptions.length>=u.value?t.createdOptions[u.value]=R:t.createdOptions.push(R)}else if(e.multiple)t.createdOptions.length=u.value;else{const R=f.value;t.createdOptions.length=0,R&&R.created&&t.createdOptions.push(R)}}function S(M){if(!p.value||!M||!M.created||M.created&&e.reserveKeyword&&t.inputValue===i(M))return;const R=t.createdOptions.findIndex(E=>c(E)===c(M));~R&&(t.createdOptions.splice(R,1),u.value--)}function T(){p.value&&(t.createdOptions.length=0,u.value=0)}return{createNewOption:b,removeNewOption:S,selectNewOption:_,clearAllNewOption:T}}const aLe=11,lLe=(e,t)=>{const{t:o}=Kn(),i=lt("select"),c=lt("input"),{form:u,formItem:f}=Oi(),{inputId:p}=Va(e,{formItemContext:f}),{aliasProps:m,getLabel:_,getValue:b,getDisabled:S,getOptions:T}=b1(e),{valueOnClear:M,isEmptyValue:R}=f1(e),E=Zn({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),N=ae(-1),D=ae(null),x=ae(null),L=ae(null),F=ae(null),H=ae(null),B=ae(null),z=ae(null),W=ae(null),Z=ae(null),$=ae(null),O=ae(null),{wrapperRef:X,isFocused:le,handleFocus:de,handleBlur:he}=h1(H,{afterFocus(){e.automaticDropdown&&!oe.value&&(oe.value=!0,E.menuVisibleOnFocus=!0)},beforeBlur(yt){var an,dn;return((an=L.value)==null?void 0:an.isFocusInsideContent(yt))||((dn=F.value)==null?void 0:dn.isFocusInsideContent(yt))},afterBlur(){oe.value=!1,E.menuVisibleOnFocus=!1}}),se=ae([]),ie=ae([]),oe=ae(!1),ee=K(()=>e.disabled||(u==null?void 0:u.disabled)),Q=K(()=>{const yt=ie.value.length*e.itemHeight;return yt>e.height?e.height:yt}),ue=K(()=>e.multiple?At(e.modelValue)&&e.modelValue.length>0:!R(e.modelValue)),me=K(()=>e.clearable&&!ee.value&&E.inputHovering&&ue.value),be=K(()=>e.remote&&e.filterable?"":Pc),ke=K(()=>be.value&&i.is("reverse",oe.value)),Ye=K(()=>(f==null?void 0:f.validateState)||""),Oe=K(()=>aL[Ye.value]),Ee=K(()=>e.remote?300:0),we=K(()=>e.loading?e.loadingText||o("el.select.loading"):e.remote&&!E.inputValue&&se.value.length===0?!1:e.filterable&&E.inputValue&&se.value.length>0&&ie.value.length===0?e.noMatchText||o("el.select.noMatch"):se.value.length===0?e.noDataText||o("el.select.noData"):null),Ge=yt=>{const an=dn=>{if(e.filterable&&tn(e.filterMethod)||e.filterable&&e.remote&&tn(e.remoteMethod))return!0;const ro=new RegExp(ZN(yt),"i");return yt?ro.test(_(dn)||""):!0};return e.loading?[]:[...E.createdOptions,...e.options].reduce((dn,ro)=>{const Er=T(ro);if(At(Er)){const gi=Er.filter(an);gi.length>0&&dn.push({label:_(ro),type:"Group"},...gi)}else(e.remote||an(ro))&&dn.push(ro);return dn},[])},Ve=()=>{se.value=Ge(""),ie.value=Ge(E.inputValue)},qe=K(()=>{const yt=new Map;return se.value.forEach((an,dn)=>{yt.set(kn(b(an)),{option:an,index:dn})}),yt}),st=K(()=>{const yt=new Map;return ie.value.forEach((an,dn)=>{yt.set(kn(b(an)),{option:an,index:dn})}),yt}),Ie=K(()=>ie.value.every(yt=>S(yt))),Ae=Tr(),xe=K(()=>Ae.value==="small"?"small":"default"),ot=()=>{var yt;N.value=((yt=D.value)==null?void 0:yt.offsetWidth)||200},je=()=>{if(!x.value)return 0;const yt=window.getComputedStyle(x.value);return Number.parseFloat(yt.gap||"6px")},at=K(()=>{const yt=je();return{maxWidth:`${O.value&&e.maxCollapseTags===1?E.selectionWidth-E.collapseItemWidth-yt:E.selectionWidth}px`}}),ht=K(()=>({maxWidth:`${E.selectionWidth}px`})),dt=K(()=>({width:`${Math.max(E.calculatorWidth,aLe)}px`})),ft=K(()=>At(e.modelValue)?e.modelValue.length===0&&!E.inputValue:e.filterable?!E.inputValue:!0),Je=K(()=>{var yt;const an=(yt=e.placeholder)!=null?yt:o("el.select.placeholder");return e.multiple||!ue.value?an:E.selectedLabel}),Et=K(()=>{var yt,an;return(an=(yt=L.value)==null?void 0:yt.popperRef)==null?void 0:an.contentRef}),Nt=K(()=>{if(e.multiple){const yt=e.modelValue.length;if(e.modelValue.length>0&&st.value.has(e.modelValue[yt-1])){const{index:an}=st.value.get(e.modelValue[yt-1]);return an}}else if(e.modelValue&&st.value.has(e.modelValue)){const{index:yt}=st.value.get(e.modelValue);return yt}return-1}),et=K({get(){return oe.value&&we.value!==!1},set(yt){oe.value=yt}}),Mt=K(()=>e.multiple?e.collapseTags?E.cachedOptions.slice(0,e.maxCollapseTags):E.cachedOptions:[]),Jt=K(()=>e.multiple?e.collapseTags?E.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:sn,removeNewOption:gn,selectNewOption:Bt,clearAllNewOption:nt}=sLe(e,E),{handleCompositionStart:It,handleCompositionUpdate:ct,handleCompositionEnd:Ke}=bz(yt=>xn(yt)),Xe=()=>{ee.value||(E.menuVisibleOnFocus?E.menuVisibleOnFocus=!1:oe.value=!oe.value)},Dt=()=>{E.inputValue.length>0&&!oe.value&&(oe.value=!0),sn(E.inputValue),xt(E.inputValue)},$e=as(Dt,Ee.value),xt=yt=>{E.previousQuery!==yt&&(E.previousQuery=yt,e.filterable&&tn(e.filterMethod)?e.filterMethod(yt):e.filterable&&e.remote&&tn(e.remoteMethod)&&e.remoteMethod(yt),e.defaultFirstOption&&(e.filterable||e.remote)&&ie.value.length?zt(jt):zt(hr))},jt=()=>{const yt=ie.value.filter(ro=>!ro.disabled&&ro.type!=="Group"),an=yt.find(ro=>ro.created),dn=yt[0];E.hoveringIndex=zn(ie.value,an||dn)},Fn=yt=>{Ri(e.modelValue,yt)||t(Lo,yt)},oo=yt=>{t(Mn,yt),Fn(yt),E.previousValue=e.multiple?String(yt):yt},zn=(yt=[],an)=>{if(!En(an))return yt.indexOf(an);const dn=e.valueKey;let ro=-1;return yt.some((Er,gi)=>ir(Er,dn)===ir(an,dn)?(ro=gi,!0):!1),ro},kn=yt=>En(yt)?ir(yt,e.valueKey):yt,Po=()=>{ot()},q=()=>{E.selectionWidth=x.value.getBoundingClientRect().width},xo=()=>{E.calculatorWidth=B.value.getBoundingClientRect().width},_n=()=>{E.collapseItemWidth=O.value.getBoundingClientRect().width},eo=()=>{var yt,an;(an=(yt=L.value)==null?void 0:yt.updatePopper)==null||an.call(yt)},ls=()=>{var yt,an;(an=(yt=F.value)==null?void 0:yt.updatePopper)==null||an.call(yt)},Ir=yt=>{if(e.multiple){let an=e.modelValue.slice();const dn=zn(an,b(yt));dn>-1?(an=[...an.slice(0,dn),...an.slice(dn+1)],E.cachedOptions.splice(dn,1),gn(yt)):(e.multipleLimit<=0||an.length<e.multipleLimit)&&(an=[...an,b(yt)],E.cachedOptions.push(yt),Bt(yt)),oo(an),yt.created&&xt(""),e.filterable&&!e.reserveKeyword&&(E.inputValue="")}else E.selectedLabel=_(yt),oo(b(yt)),oe.value=!1,Bt(yt),yt.created||nt();sr()},ks=(yt,an)=>{let dn=e.modelValue.slice();const ro=zn(dn,b(an));ro>-1&&!ee.value&&(dn=[...e.modelValue.slice(0,ro),...e.modelValue.slice(ro+1)],E.cachedOptions.splice(ro,1),oo(dn),t("remove-tag",b(an)),gn(an)),yt.stopPropagation(),sr()},sr=()=>{var yt;(yt=H.value)==null||yt.focus()},ca=()=>{var yt;(yt=H.value)==null||yt.blur()},As=()=>{E.inputValue.length>0?E.inputValue="":oe.value=!1},Dd=yt=>Oq(yt,an=>!E.cachedOptions.some(dn=>b(dn)===an&&S(dn))),Ct=yt=>{if(e.multiple&&yt.code!==Yt.delete&&E.inputValue.length===0){yt.preventDefault();const an=e.modelValue.slice(),dn=Dd(an);if(dn<0)return;const ro=an[dn];an.splice(dn,1);const Er=E.cachedOptions[dn];E.cachedOptions.splice(dn,1),gn(Er),oo(an),t("remove-tag",ro)}},Tt=()=>{let yt;At(e.modelValue)?yt=[]:yt=M.value,e.multiple?E.cachedOptions=[]:E.selectedLabel="",oe.value=!1,oo(yt),t("clear"),nt(),sr()},Xt=(yt,an=void 0)=>{const dn=ie.value;if(!["forward","backward"].includes(yt)||ee.value||dn.length<=0||Ie.value)return;if(!oe.value)return Xe();an===void 0&&(an=E.hoveringIndex);let ro=-1;yt==="forward"?(ro=an+1,ro>=dn.length&&(ro=0)):yt==="backward"&&(ro=an-1,(ro<0||ro>=dn.length)&&(ro=dn.length-1));const Er=dn[ro];if(S(Er)||Er.type==="Group")return Xt(yt,ro);E.hoveringIndex=ro,Lr(ro)},Cn=()=>{if(oe.value)~E.hoveringIndex&&ie.value[E.hoveringIndex]&&Ir(ie.value[E.hoveringIndex]);else return Xe()},un=yt=>{E.hoveringIndex=yt},hr=()=>{e.multiple?E.hoveringIndex=ie.value.findIndex(yt=>e.modelValue.some(an=>kn(an)===kn(yt))):E.hoveringIndex=ie.value.findIndex(yt=>kn(yt)===kn(e.modelValue))},xn=yt=>{if(E.inputValue=yt.target.value,e.remote)$e();else return Dt()},Rt=yt=>{if(oe.value=!1,le.value){const an=new FocusEvent("focus",yt);he(an)}},ko=()=>(E.isBeforeHide=!1,zt(()=>{~Nt.value&&Lr(E.hoveringIndex)})),Lr=yt=>{Z.value.scrollToItem(yt)},wl=yt=>{const an=kn(yt);if(qe.value.has(an)){const{option:dn}=qe.value.get(an);return dn}return{[m.value.value]:yt,[m.value.label]:yt}},ni=()=>{if(e.multiple)if(e.modelValue.length>0){E.cachedOptions.length=0,E.previousValue=e.modelValue.toString();for(const yt of e.modelValue){const an=wl(yt);E.cachedOptions.push(an)}}else E.cachedOptions=[],E.previousValue=void 0;else if(ue.value){E.previousValue=e.modelValue;const yt=ie.value,an=yt.findIndex(dn=>kn(b(dn))===kn(e.modelValue));~an?E.selectedLabel=_(yt[an]):E.selectedLabel=kn(e.modelValue)}else E.selectedLabel="",E.previousValue=void 0;nt(),ot()};return rt(oe,yt=>{yt?xt(""):(E.inputValue="",E.previousQuery=null,E.isBeforeHide=!0,sn("")),t("visible-change",yt)}),rt(()=>e.modelValue,(yt,an)=>{var dn;(!yt||e.multiple&&yt.toString()!==E.previousValue||!e.multiple&&kn(yt)!==kn(E.previousValue))&&ni(),!Ri(yt,an)&&e.validateEvent&&((dn=f==null?void 0:f.validate)==null||dn.call(f,"change").catch(ro=>void 0))},{deep:!0}),rt(()=>e.options,()=>{const yt=H.value;(!yt||yt&&document.activeElement!==yt)&&ni()},{deep:!0,flush:"post"}),rt(()=>ie.value,()=>Z.value&&zt(Z.value.resetScrollTop)),hi(()=>{E.isBeforeHide||Ve()}),hi(()=>{const{valueKey:yt,options:an}=e,dn=new Map;for(const ro of an){const Er=b(ro);let gi=Er;if(En(gi)&&(gi=ir(Er,yt)),dn.get(gi))break;dn.set(gi,!0)}}),fn(()=>{ni()}),Ko(D,Po),Ko(x,q),Ko(B,xo),Ko(Z,eo),Ko(X,eo),Ko($,ls),Ko(O,_n),{inputId:p,collapseTagSize:xe,currentPlaceholder:Je,expanded:oe,emptyText:we,popupHeight:Q,debounce:Ee,allOptions:se,filteredOptions:ie,iconComponent:be,iconReverse:ke,tagStyle:at,collapseTagStyle:ht,inputStyle:dt,popperSize:N,dropdownMenuVisible:et,hasModelValue:ue,shouldShowPlaceholder:ft,selectDisabled:ee,selectSize:Ae,showClearBtn:me,states:E,isFocused:le,nsSelect:i,nsInput:c,calculatorRef:B,inputRef:H,menuRef:Z,tagMenuRef:$,tooltipRef:L,tagTooltipRef:F,selectRef:D,wrapperRef:X,selectionRef:x,prefixRef:z,suffixRef:W,collapseItemRef:O,popperRef:Et,validateState:Ye,validateIcon:Oe,showTagList:Mt,collapseTagList:Jt,debouncedOnInputChange:$e,deleteTag:ks,getLabel:_,getValue:b,getDisabled:S,getValueKey:kn,handleBlur:he,handleClear:Tt,handleClickOutside:Rt,handleDel:Ct,handleEsc:As,handleFocus:de,focus:sr,blur:ca,handleMenuEnter:ko,handleResize:Po,resetSelectionWidth:q,resetCalculatorWidth:xo,updateTooltip:eo,updateTagTooltip:ls,updateOptions:Ve,toggleMenu:Xe,scrollTo:Lr,onInput:xn,onKeyboardNavigate:Xt,onKeyboardSelect:Cn,onSelect:Ir,onHover:un,handleCompositionStart:It,handleCompositionEnd:Ke,handleCompositionUpdate:ct}},cLe=Se({name:"ElSelectV2",components:{ElSelectMenu:iLe,ElTag:z0,ElTooltip:Di,ElIcon:Gt},directives:{ClickOutside:wc},props:ZNe,emits:[Mn,Lo,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const o=K(()=>{const{modelValue:c,multiple:u}=e,f=u?[]:void 0;return At(c)?u?c:f:u?f:c}),i=lLe(Zn({...ei(e),modelValue:o}),t);return Ln(ZL,{props:Zn({...ei(e),height:i.popupHeight,modelValue:o}),tooltipRef:i.tooltipRef,onSelect:i.onSelect,onHover:i.onHover,onKeyboardNavigate:i.onKeyboardNavigate,onKeyboardSelect:i.onKeyboardSelect}),{...i,modelValue:o}}}),uLe=["id","autocomplete","aria-expanded","aria-label","disabled","readonly","name"],dLe=["textContent"],hLe={key:1};function fLe(e,t,o,i,c,u){const f=pn("el-tag"),p=pn("el-tooltip"),m=pn("el-icon"),_=pn("el-select-menu"),b=KE("click-outside");return hn((J(),ge("div",{ref:"selectRef",class:ne([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:t[14]||(t[14]=S=>e.states.inputHovering=!0),onMouseleave:t[15]||(t[15]=S=>e.states.inputHovering=!1),onClick:t[16]||(t[16]=nn((...S)=>e.toggleMenu&&e.toggleMenu(...S),["prevent","stop"]))},[Me(p,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[13]||(t[13]=S=>e.states.isBeforeHide=!1)},{default:Ne(()=>[Ce("div",{ref:"wrapperRef",class:ne([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(J(),ge("div",{key:0,ref:"prefixRef",class:ne(e.nsSelect.e("prefix"))},[We(e.$slots,"prefix")],2)):Fe("v-if",!0),Ce("div",{ref:"selectionRef",class:ne([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?We(e.$slots,"tag",{key:0},()=>[(J(!0),ge(qt,null,Vn(e.showTagList,S=>(J(),ge("div",{key:e.getValueKey(e.getValue(S)),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!e.selectDisabled&&!e.getDisabled(S),size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",style:Ht(e.tagStyle),onClose:T=>e.deleteTag(T,S)},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))},[We(e.$slots,"label",{label:e.getLabel(S),value:e.getValue(S)},()=>[On(pt(e.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(J(),He(p,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:Ne(()=>[Ce("div",{ref:"collapseItemRef",class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!1,size:e.collapseTagSize,type:e.tagType,style:Ht(e.collapseTagStyle),"disable-transitions":""},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))}," + "+pt(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","style"])],2)]),content:Ne(()=>[Ce("div",{ref:"tagMenuRef",class:ne(e.nsSelect.e("selection"))},[(J(!0),ge(qt,null,Vn(e.collapseTagList,S=>(J(),ge("div",{key:e.getValueKey(e.getValue(S)),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(S),size:e.collapseTagSize,type:e.tagType,"disable-transitions":"",onClose:T=>e.deleteTag(T,S)},{default:Ne(()=>[Ce("span",{class:ne(e.nsSelect.e("tags-text"))},[We(e.$slots,"label",{label:e.getLabel(S),value:e.getValue(S)},()=>[On(pt(e.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):Fe("v-if",!0)]):Fe("v-if",!0),e.selectDisabled?Fe("v-if",!0):(J(),ge("div",{key:1,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hn(Ce("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":t[0]||(t[0]=S=>e.states.inputValue=S),style:Ht(e.inputStyle),autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:ne([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onFocus:t[1]||(t[1]=(...S)=>e.handleFocus&&e.handleFocus(...S)),onBlur:t[2]||(t[2]=(...S)=>e.handleBlur&&e.handleBlur(...S)),onInput:t[3]||(t[3]=(...S)=>e.onInput&&e.onInput(...S)),onCompositionstart:t[4]||(t[4]=(...S)=>e.handleCompositionStart&&e.handleCompositionStart(...S)),onCompositionupdate:t[5]||(t[5]=(...S)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...S)),onCompositionend:t[6]||(t[6]=(...S)=>e.handleCompositionEnd&&e.handleCompositionEnd(...S)),onKeydown:[t[7]||(t[7]=go(nn(S=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),t[8]||(t[8]=go(nn(S=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),t[9]||(t[9]=go(nn((...S)=>e.onKeyboardSelect&&e.onKeyboardSelect(...S),["stop","prevent"]),["enter"])),t[10]||(t[10]=go(nn((...S)=>e.handleEsc&&e.handleEsc(...S),["stop","prevent"]),["esc"])),t[11]||(t[11]=go(nn((...S)=>e.handleDel&&e.handleDel(...S),["stop"]),["delete"]))],onClick:t[12]||(t[12]=nn((...S)=>e.toggleMenu&&e.toggleMenu(...S),["stop"]))},null,46,uLe),[[IN,e.states.inputValue]]),e.filterable?(J(),ge("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ne(e.nsSelect.e("input-calculator")),textContent:pt(e.states.inputValue)},null,10,dLe)):Fe("v-if",!0)],2)),e.shouldShowPlaceholder?(J(),ge("div",{key:2,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?We(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ce("span",null,pt(e.currentPlaceholder),1)]):(J(),ge("span",hLe,pt(e.currentPlaceholder),1))],2)):Fe("v-if",!0)],2),Ce("div",{ref:"suffixRef",class:ne(e.nsSelect.e("suffix"))},[e.iconComponent?hn((J(),He(m,{key:0,class:ne([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:Ne(()=>[(J(),He(wn(e.iconComponent)))]),_:1},8,["class"])),[[Jn,!e.showClearBtn]]):Fe("v-if",!0),e.showClearBtn&&e.clearIcon?(J(),He(m,{key:1,class:ne([e.nsSelect.e("caret"),e.nsInput.e("icon")]),onClick:nn(e.handleClear,["prevent","stop"])},{default:Ne(()=>[(J(),He(wn(e.clearIcon)))]),_:1},8,["class","onClick"])):Fe("v-if",!0),e.validateState&&e.validateIcon?(J(),He(m,{key:2,class:ne([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:Ne(()=>[(J(),He(wn(e.validateIcon)))]),_:1},8,["class"])):Fe("v-if",!0)],2)],2)]),content:Ne(()=>[Me(_,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},kc({default:Ne(S=>[We(e.$slots,"default",bc(dm(S)))]),_:2},[e.$slots.header?{name:"header",fn:Ne(()=>[Ce("div",{class:ne(e.nsSelect.be("dropdown","header"))},[We(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:Ne(()=>[Ce("div",{class:ne(e.nsSelect.be("dropdown","loading"))},[We(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:Ne(()=>[Ce("div",{class:ne(e.nsSelect.be("dropdown","empty"))},[We(e.$slots,"empty",{},()=>[Ce("span",null,pt(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:Ne(()=>[Ce("div",{class:ne(e.nsSelect.be("dropdown","footer"))},[We(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","onBeforeShow"])],34)),[[b,e.handleClickOutside,e.popperRef]])}var zT=vt(cLe,[["render",fLe],["__file","select.vue"]]);zT.install=e=>{e.component(zT.name,zT)};const pLe=zT,gLe=pLe,mLe=gt({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Number}}),vLe=gt({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),_Le=Se({name:"ElSkeletonItem"}),yLe=Se({..._Le,props:vLe,setup(e){const t=lt("skeleton");return(o,i)=>(J(),ge("div",{class:ne([y(t).e("item"),y(t).e(o.variant)])},[o.variant==="image"?(J(),He(y(c_e),{key:0})):Fe("v-if",!0)],2))}});var UE=vt(yLe,[["__file","skeleton-item.vue"]]);const ILe=Se({name:"ElSkeleton"}),bLe=Se({...ILe,props:mLe,setup(e,{expose:t}){const o=e,i=lt("skeleton"),c=n0e(Io(o,"loading"),o.throttle);return t({uiLoading:c}),(u,f)=>y(c)?(J(),ge("div",Nn({key:0,class:[y(i).b(),y(i).is("animated",u.animated)]},u.$attrs),[(J(!0),ge(qt,null,Vn(u.count,p=>(J(),ge(qt,{key:p},[u.loading?We(u.$slots,"template",{key:p},()=>[Me(UE,{class:ne(y(i).is("first")),variant:"p"},null,8,["class"]),(J(!0),ge(qt,null,Vn(u.rows,m=>(J(),He(UE,{key:m,class:ne([y(i).e("paragraph"),y(i).is("last",m===u.rows&&u.rows>1)]),variant:"p"},null,8,["class"]))),128))]):Fe("v-if",!0)],64))),128))],16)):We(u.$slots,"default",bc(Nn({key:1},u.$attrs)))}});var CLe=vt(bLe,[["__file","skeleton.vue"]]);const SLe=bn(CLe,{SkeletonItem:UE}),TLe=Wo(UE),$z=Symbol("sliderContextKey"),ELe=gt({modelValue:{type:Le([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Nr,inputSize:Nr,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:Le(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:Le(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:ip,default:"top"},marks:{type:Le(Object)},validateEvent:{type:Boolean,default:!0},...ti(["ariaLabel"])}),lD=e=>Zt(e)||At(e)&&e.every(Zt),MLe={[Mn]:lD,[Hi]:lD,[Lo]:lD},kLe=(e,t,o)=>{const i=ae();return fn(async()=>{e.range?(Array.isArray(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(typeof e.modelValue!="number"||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),Oo(window,"resize",o),await zt(),o()}),{sliderWrapper:i}},ALe=e=>K(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((o,i)=>o-i).filter(o=>o<=e.max&&o>=e.min).map(o=>({point:o,position:(o-e.min)*100/(e.max-e.min),mark:e.marks[o]})):[]),RLe=(e,t,o)=>{const{form:i,formItem:c}=Oi(),u=Do(),f=ae(),p=ae(),m={firstButton:f,secondButton:p},_=K(()=>e.disabled||(i==null?void 0:i.disabled)||!1),b=K(()=>Math.min(t.firstValue,t.secondValue)),S=K(()=>Math.max(t.firstValue,t.secondValue)),T=K(()=>e.range?`${100*(S.value-b.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),M=K(()=>e.range?`${100*(b.value-e.min)/(e.max-e.min)}%`:"0%"),R=K(()=>e.vertical?{height:e.height}:{}),E=K(()=>e.vertical?{height:T.value,bottom:M.value}:{width:T.value,left:M.value}),N=()=>{u.value&&(t.sliderSize=u.value[`client${e.vertical?"Height":"Width"}`])},D=O=>{const X=e.min+O*(e.max-e.min)/100;if(!e.range)return f;let le;return Math.abs(b.value-X)<Math.abs(S.value-X)?le=t.firstValue<t.secondValue?"firstButton":"secondButton":le=t.firstValue>t.secondValue?"firstButton":"secondButton",m[le]},x=O=>{const X=D(O);return X.value.setPosition(O),X},L=O=>{t.firstValue=O,H(e.range?[b.value,S.value]:O)},F=O=>{t.secondValue=O,e.range&&H([b.value,S.value])},H=O=>{o(Mn,O),o(Hi,O)},B=async()=>{await zt(),o(Lo,e.range?[b.value,S.value]:e.modelValue)},z=O=>{var X,le,de,he,se,ie;if(_.value||t.dragging)return;N();let oe=0;if(e.vertical){const ee=(de=(le=(X=O.touches)==null?void 0:X.item(0))==null?void 0:le.clientY)!=null?de:O.clientY;oe=(u.value.getBoundingClientRect().bottom-ee)/t.sliderSize*100}else{const ee=(ie=(se=(he=O.touches)==null?void 0:he.item(0))==null?void 0:se.clientX)!=null?ie:O.clientX,Q=u.value.getBoundingClientRect().left;oe=(ee-Q)/t.sliderSize*100}if(!(oe<0||oe>100))return x(oe)};return{elFormItem:c,slider:u,firstButton:f,secondButton:p,sliderDisabled:_,minValue:b,maxValue:S,runwayStyle:R,barStyle:E,resetSize:N,setPosition:x,emitChange:B,onSliderWrapperPrevent:O=>{var X,le;((X=m.firstButton.value)!=null&&X.dragging||(le=m.secondButton.value)!=null&&le.dragging)&&O.preventDefault()},onSliderClick:O=>{z(O)&&B()},onSliderDown:async O=>{const X=z(O);X&&(await zt(),X.value.onButtonDown(O))},setFirstValue:L,setSecondValue:F}},{left:wLe,down:DLe,right:OLe,up:NLe,home:LLe,end:PLe,pageUp:ULe,pageDown:xLe}=Yt,FLe=(e,t,o)=>{const i=ae(),c=ae(!1),u=K(()=>t.value instanceof Function),f=K(()=>u.value&&t.value(e.modelValue)||e.modelValue),p=as(()=>{o.value&&(c.value=!0)},50),m=as(()=>{o.value&&(c.value=!1)},50);return{tooltip:i,tooltipVisible:c,formatValue:f,displayTooltip:p,hideTooltip:m}},VLe=(e,t,o)=>{const{disabled:i,min:c,max:u,step:f,showTooltip:p,precision:m,sliderSize:_,formatTooltip:b,emitChange:S,resetSize:T,updateDragging:M}=wt($z),{tooltip:R,tooltipVisible:E,formatValue:N,displayTooltip:D,hideTooltip:x}=FLe(e,b,p),L=ae(),F=K(()=>`${(e.modelValue-c.value)/(u.value-c.value)*100}%`),H=K(()=>e.vertical?{bottom:F.value}:{left:F.value}),B=()=>{t.hovering=!0,D()},z=()=>{t.hovering=!1,t.dragging||x()},W=me=>{i.value||(me.preventDefault(),oe(me),window.addEventListener("mousemove",ee),window.addEventListener("touchmove",ee),window.addEventListener("mouseup",Q),window.addEventListener("touchend",Q),window.addEventListener("contextmenu",Q),L.value.focus())},Z=me=>{i.value||(t.newPosition=Number.parseFloat(F.value)+me/(u.value-c.value)*100,ue(t.newPosition),S())},$=()=>{Z(-f.value)},O=()=>{Z(f.value)},X=()=>{Z(-f.value*4)},le=()=>{Z(f.value*4)},de=()=>{i.value||(ue(0),S())},he=()=>{i.value||(ue(100),S())},se=me=>{let be=!0;[wLe,DLe].includes(me.key)?$():[OLe,NLe].includes(me.key)?O():me.key===LLe?de():me.key===PLe?he():me.key===xLe?X():me.key===ULe?le():be=!1,be&&me.preventDefault()},ie=me=>{let be,ke;return me.type.startsWith("touch")?(ke=me.touches[0].clientY,be=me.touches[0].clientX):(ke=me.clientY,be=me.clientX),{clientX:be,clientY:ke}},oe=me=>{t.dragging=!0,t.isClick=!0;const{clientX:be,clientY:ke}=ie(me);e.vertical?t.startY=ke:t.startX=be,t.startPosition=Number.parseFloat(F.value),t.newPosition=t.startPosition},ee=me=>{if(t.dragging){t.isClick=!1,D(),T();let be;const{clientX:ke,clientY:Ye}=ie(me);e.vertical?(t.currentY=Ye,be=(t.startY-t.currentY)/_.value*100):(t.currentX=ke,be=(t.currentX-t.startX)/_.value*100),t.newPosition=t.startPosition+be,ue(t.newPosition)}},Q=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||x(),t.isClick||ue(t.newPosition),S()},0),window.removeEventListener("mousemove",ee),window.removeEventListener("touchmove",ee),window.removeEventListener("mouseup",Q),window.removeEventListener("touchend",Q),window.removeEventListener("contextmenu",Q))},ue=async me=>{if(me===null||Number.isNaN(+me))return;me<0?me=0:me>100&&(me=100);const be=100/((u.value-c.value)/f.value);let Ye=Math.round(me/be)*be*(u.value-c.value)*.01+c.value;Ye=Number.parseFloat(Ye.toFixed(m.value)),Ye!==e.modelValue&&o(Mn,Ye),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await zt(),t.dragging&&D(),R.value.updatePopper()};return rt(()=>t.dragging,me=>{M(me)}),{disabled:i,button:L,tooltip:R,tooltipVisible:E,showTooltip:p,wrapperStyle:H,formatValue:N,handleMouseEnter:B,handleMouseLeave:z,onButtonDown:W,onKeyDown:se,setPosition:ue}},GLe=(e,t,o,i)=>({stops:K(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const f=(e.max-e.min)/e.step,p=100*e.step/(e.max-e.min),m=Array.from({length:f-1}).map((_,b)=>(b+1)*p);return e.range?m.filter(_=>_<100*(o.value-e.min)/(e.max-e.min)||_>100*(i.value-e.min)/(e.max-e.min)):m.filter(_=>_>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:f=>e.vertical?{bottom:`${f}%`}:{left:`${f}%`}}),BLe=(e,t,o,i,c,u)=>{const f=_=>{c(Mn,_),c(Hi,_)},p=()=>e.range?![o.value,i.value].every((_,b)=>_===t.oldValue[b]):e.modelValue!==t.oldValue,m=()=>{var _,b;e.min>e.max&&wr("Slider","min should not be greater than max.");const S=e.modelValue;e.range&&Array.isArray(S)?S[1]<e.min?f([e.min,e.min]):S[0]>e.max?f([e.max,e.max]):S[0]<e.min?f([e.min,S[1]]):S[1]>e.max?f([S[0],e.max]):(t.firstValue=S[0],t.secondValue=S[1],p()&&(e.validateEvent&&((_=u==null?void 0:u.validate)==null||_.call(u,"change").catch(T=>void 0)),t.oldValue=S.slice())):!e.range&&typeof S=="number"&&!Number.isNaN(S)&&(S<e.min?f(e.min):S>e.max?f(e.max):(t.firstValue=S,p()&&(e.validateEvent&&((b=u==null?void 0:u.validate)==null||b.call(u,"change").catch(T=>void 0)),t.oldValue=S)))};m(),rt(()=>t.dragging,_=>{_||m()}),rt(()=>e.modelValue,(_,b)=>{t.dragging||Array.isArray(_)&&Array.isArray(b)&&_.every((S,T)=>S===b[T])&&t.firstValue===_[0]&&t.secondValue===_[1]||m()},{deep:!0}),rt(()=>[e.min,e.max],()=>{m()})},$Le=gt({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:ip,default:"top"}}),HLe={[Mn]:e=>Zt(e)},qLe=["tabindex"],KLe=Se({name:"ElSliderButton"}),zLe=Se({...KLe,props:$Le,emits:HLe,setup(e,{expose:t,emit:o}){const i=e,c=lt("slider"),u=Zn({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:i.modelValue}),{disabled:f,button:p,tooltip:m,showTooltip:_,tooltipVisible:b,wrapperStyle:S,formatValue:T,handleMouseEnter:M,handleMouseLeave:R,onButtonDown:E,onKeyDown:N,setPosition:D}=VLe(i,u,o),{hovering:x,dragging:L}=ei(u);return t({onButtonDown:E,onKeyDown:N,setPosition:D,hovering:x,dragging:L}),(F,H)=>(J(),ge("div",{ref_key:"button",ref:p,class:ne([y(c).e("button-wrapper"),{hover:y(x),dragging:y(L)}]),style:Ht(y(S)),tabindex:y(f)?-1:0,onMouseenter:H[0]||(H[0]=(...B)=>y(M)&&y(M)(...B)),onMouseleave:H[1]||(H[1]=(...B)=>y(R)&&y(R)(...B)),onMousedown:H[2]||(H[2]=(...B)=>y(E)&&y(E)(...B)),onTouchstart:H[3]||(H[3]=(...B)=>y(E)&&y(E)(...B)),onFocus:H[4]||(H[4]=(...B)=>y(M)&&y(M)(...B)),onBlur:H[5]||(H[5]=(...B)=>y(R)&&y(R)(...B)),onKeydown:H[6]||(H[6]=(...B)=>y(N)&&y(N)(...B))},[Me(y(Di),{ref_key:"tooltip",ref:m,visible:y(b),placement:F.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":F.tooltipClass,disabled:!y(_),persistent:""},{content:Ne(()=>[Ce("span",null,pt(y(T)),1)]),default:Ne(()=>[Ce("div",{class:ne([y(c).e("button"),{hover:y(x),dragging:y(L)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,qLe))}});var YB=vt(zLe,[["__file","button.vue"]]);const WLe=gt({mark:{type:Le([String,Object]),default:void 0}});var jLe=Se({name:"ElSliderMarker",props:WLe,setup(e){const t=lt("slider"),o=K(()=>on(e.mark)?e.mark:e.mark.label),i=K(()=>on(e.mark)?void 0:e.mark.style);return()=>Wt("div",{class:t.e("marks-text"),style:i.value},o.value)}});const YLe=["id","role","aria-label","aria-labelledby"],JLe={key:1},XLe=Se({name:"ElSlider"}),QLe=Se({...XLe,props:ELe,emits:MLe,setup(e,{expose:t,emit:o}){const i=e,c=lt("slider"),{t:u}=Kn(),f=Zn({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:p,slider:m,firstButton:_,secondButton:b,sliderDisabled:S,minValue:T,maxValue:M,runwayStyle:R,barStyle:E,resetSize:N,emitChange:D,onSliderWrapperPrevent:x,onSliderClick:L,onSliderDown:F,setFirstValue:H,setSecondValue:B}=RLe(i,f,o),{stops:z,getStopStyle:W}=GLe(i,f,T,M),{inputId:Z,isLabeledByFormItem:$}=Va(i,{formItemContext:p}),O=Tr(),X=K(()=>i.inputSize||O.value),le=K(()=>i.label||i.ariaLabel||u("el.slider.defaultLabel",{min:i.min,max:i.max})),de=K(()=>i.range?i.rangeStartLabel||u("el.slider.defaultRangeStartLabel"):le.value),he=K(()=>i.formatValueText?i.formatValueText(me.value):`${me.value}`),se=K(()=>i.rangeEndLabel||u("el.slider.defaultRangeEndLabel")),ie=K(()=>i.formatValueText?i.formatValueText(be.value):`${be.value}`),oe=K(()=>[c.b(),c.m(O.value),c.is("vertical",i.vertical),{[c.m("with-input")]:i.showInput}]),ee=ALe(i);BLe(i,f,T,M,o,p);const Q=K(()=>{const Oe=[i.min,i.max,i.step].map(Ee=>{const we=`${Ee}`.split(".")[1];return we?we.length:0});return Math.max.apply(null,Oe)}),{sliderWrapper:ue}=kLe(i,f,N),{firstValue:me,secondValue:be,sliderSize:ke}=ei(f),Ye=Oe=>{f.dragging=Oe};return Ln($z,{...ei(i),sliderSize:ke,disabled:S,precision:Q,emitChange:D,resetSize:N,updateDragging:Ye}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-slider",ref:"https://element-plus.org/en-US/component/slider.html"},K(()=>!!i.label)),t({onSliderClick:L}),(Oe,Ee)=>{var we,Ge;return J(),ge("div",{id:Oe.range?y(Z):void 0,ref_key:"sliderWrapper",ref:ue,class:ne(y(oe)),role:Oe.range?"group":void 0,"aria-label":Oe.range&&!y($)?y(le):void 0,"aria-labelledby":Oe.range&&y($)?(we=y(p))==null?void 0:we.labelId:void 0,onTouchstart:Ee[2]||(Ee[2]=(...Ve)=>y(x)&&y(x)(...Ve)),onTouchmove:Ee[3]||(Ee[3]=(...Ve)=>y(x)&&y(x)(...Ve))},[Ce("div",{ref_key:"slider",ref:m,class:ne([y(c).e("runway"),{"show-input":Oe.showInput&&!Oe.range},y(c).is("disabled",y(S))]),style:Ht(y(R)),onMousedown:Ee[0]||(Ee[0]=(...Ve)=>y(F)&&y(F)(...Ve)),onTouchstart:Ee[1]||(Ee[1]=(...Ve)=>y(F)&&y(F)(...Ve))},[Ce("div",{class:ne(y(c).e("bar")),style:Ht(y(E))},null,6),Me(YB,{id:Oe.range?void 0:y(Z),ref_key:"firstButton",ref:_,"model-value":y(me),vertical:Oe.vertical,"tooltip-class":Oe.tooltipClass,placement:Oe.placement,role:"slider","aria-label":Oe.range||!y($)?y(de):void 0,"aria-labelledby":!Oe.range&&y($)?(Ge=y(p))==null?void 0:Ge.labelId:void 0,"aria-valuemin":Oe.min,"aria-valuemax":Oe.range?y(be):Oe.max,"aria-valuenow":y(me),"aria-valuetext":y(he),"aria-orientation":Oe.vertical?"vertical":"horizontal","aria-disabled":y(S),"onUpdate:modelValue":y(H)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),Oe.range?(J(),He(YB,{key:0,ref_key:"secondButton",ref:b,"model-value":y(be),vertical:Oe.vertical,"tooltip-class":Oe.tooltipClass,placement:Oe.placement,role:"slider","aria-label":y(se),"aria-valuemin":y(me),"aria-valuemax":Oe.max,"aria-valuenow":y(be),"aria-valuetext":y(ie),"aria-orientation":Oe.vertical?"vertical":"horizontal","aria-disabled":y(S),"onUpdate:modelValue":y(B)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):Fe("v-if",!0),Oe.showStops?(J(),ge("div",JLe,[(J(!0),ge(qt,null,Vn(y(z),(Ve,qe)=>(J(),ge("div",{key:qe,class:ne(y(c).e("stop")),style:Ht(y(W)(Ve))},null,6))),128))])):Fe("v-if",!0),y(ee).length>0?(J(),ge(qt,{key:2},[Ce("div",null,[(J(!0),ge(qt,null,Vn(y(ee),(Ve,qe)=>(J(),ge("div",{key:qe,style:Ht(y(W)(Ve.position)),class:ne([y(c).e("stop"),y(c).e("marks-stop")])},null,6))),128))]),Ce("div",{class:ne(y(c).e("marks"))},[(J(!0),ge(qt,null,Vn(y(ee),(Ve,qe)=>(J(),He(y(jLe),{key:qe,mark:Ve.mark,style:Ht(y(W)(Ve.position))},null,8,["mark","style"]))),128))],2)],64)):Fe("v-if",!0)],38),Oe.showInput&&!Oe.range?(J(),He(y(pz),{key:0,ref:"input","model-value":y(me),class:ne(y(c).e("input")),step:Oe.step,disabled:y(S),controls:Oe.showInputControls,min:Oe.min,max:Oe.max,debounce:Oe.debounce,size:y(X),"onUpdate:modelValue":y(H),onChange:y(D)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):Fe("v-if",!0)],42,YLe)}}});var ZLe=vt(QLe,[["__file","slider.vue"]]);const e2e=bn(ZLe),t2e=gt({prefixCls:{type:String}}),JB=Se({name:"ElSpaceItem",props:t2e,setup(e,{slots:t}){const o=lt("space"),i=K(()=>`${e.prefixCls||o.b()}__item`);return()=>Wt("div",{class:i.value},We(t,"default"))}}),XB={small:8,default:12,large:16};function n2e(e){const t=lt("space"),o=K(()=>[t.b(),t.m(e.direction),e.class]),i=ae(0),c=ae(0),u=K(()=>{const p=e.wrap||e.fill?{flexWrap:"wrap"}:{},m={alignItems:e.alignment},_={rowGap:`${c.value}px`,columnGap:`${i.value}px`};return[p,m,_,e.style]}),f=K(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return hi(()=>{const{size:p="small",wrap:m,direction:_,fill:b}=e;if(At(p)){const[S=0,T=0]=p;i.value=S,c.value=T}else{let S;Zt(p)?S=p:S=XB[p||"small"]||XB.small,(m||b)&&_==="horizontal"?i.value=c.value=S:_==="horizontal"?(i.value=S,c.value=0):(c.value=S,i.value=0)}}),{classes:o,containerStyle:u,itemStyle:f}}const o2e=gt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:Le([String,Object,Array]),default:""},style:{type:Le([String,Array,Object]),default:""},alignment:{type:Le(String),default:"center"},prefixCls:{type:String},spacer:{type:Le([Object,String,Number,Array]),default:null,validator:e=>$o(e)||Zt(e)||on(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:Al,validator:e=>Zt(e)||At(e)&&e.length===2&&e.every(Zt)}}),r2e=Se({name:"ElSpace",props:o2e,setup(e,{slots:t}){const{classes:o,containerStyle:i,itemStyle:c}=n2e(e);function u(f,p="",m=[]){const{prefixCls:_}=e;return f.forEach((b,S)=>{JD(b)?At(b.children)&&b.children.forEach((T,M)=>{JD(T)&&At(T.children)?u(T.children,`${p+M}-`,m):m.push(Me(JB,{style:c.value,prefixCls:_,key:`nested-${p+M}`},{default:()=>[T]},Ks.PROPS|Ks.STYLE,["style","prefixCls"]))}):V_e(b)&&m.push(Me(JB,{style:c.value,prefixCls:_,key:`LoopKey${p+S}`},{default:()=>[b]},Ks.PROPS|Ks.STYLE,["style","prefixCls"]))}),m}return()=>{var f;const{spacer:p,direction:m}=e,_=We(t,"default",{key:0},()=>[]);if(((f=_.children)!=null?f:[]).length===0)return null;if(At(_.children)){let b=u(_.children);if(p){const S=b.length-1;b=b.reduce((T,M,R)=>{const E=[...T,M];return R!==S&&E.push(Me("span",{style:[c.value,m==="vertical"?"width: 100%":null],key:R},[$o(p)?p:On(p,Ks.TEXT)],Ks.STYLE)),E},[])}return Me("div",{class:o.value,style:i.value},b,Ks.STYLE|Ks.CLASS)}return _.children}}}),i2e=bn(r2e),s2e=gt({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:Le([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:Le([String,Object,Array])}}),a2e=Se({name:"ElStatistic"}),l2e=Se({...a2e,props:s2e,setup(e,{expose:t}){const o=e,i=lt("statistic"),c=K(()=>{const{value:u,formatter:f,precision:p,decimalSeparator:m,groupSeparator:_}=o;if(tn(f))return f(u);if(!Zt(u))return u;let[b,S=""]=String(u).split(".");return S=S.padEnd(p,"0").slice(0,p>0?p:0),b=b.replace(/\B(?=(\d{3})+(?!\d))/g,_),[b,S].join(S?m:"")});return t({displayValue:c}),(u,f)=>(J(),ge("div",{class:ne(y(i).b())},[u.$slots.title||u.title?(J(),ge("div",{key:0,class:ne(y(i).e("head"))},[We(u.$slots,"title",{},()=>[On(pt(u.title),1)])],2)):Fe("v-if",!0),Ce("div",{class:ne(y(i).e("content"))},[u.$slots.prefix||u.prefix?(J(),ge("div",{key:0,class:ne(y(i).e("prefix"))},[We(u.$slots,"prefix",{},()=>[Ce("span",null,pt(u.prefix),1)])],2)):Fe("v-if",!0),Ce("span",{class:ne(y(i).e("number")),style:Ht(u.valueStyle)},pt(y(c)),7),u.$slots.suffix||u.suffix?(J(),ge("div",{key:1,class:ne(y(i).e("suffix"))},[We(u.$slots,"suffix",{},()=>[Ce("span",null,pt(u.suffix),1)])],2)):Fe("v-if",!0)],2)],2))}});var c2e=vt(l2e,[["__file","statistic.vue"]]);const Hz=bn(c2e),u2e=gt({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:Le([Number,Object]),default:0},valueStyle:{type:Le([String,Object,Array])}}),d2e={finish:()=>!0,[Lo]:e=>Zt(e)},h2e=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],QB=e=>Zt(e)?new Date(e).getTime():e.valueOf(),ZB=(e,t)=>{let o=e;const i=/\[([^\]]*)]/g;return h2e.reduce((u,[f,p])=>{const m=new RegExp(`${f}+(?![^\\[\\]]*\\])`,"g");if(m.test(u)){const _=Math.floor(o/p);return o-=_*p,u.replace(m,b=>String(_).padStart(b.length,"0"))}return u},t).replace(i,"$1")},f2e=Se({name:"ElCountdown"}),p2e=Se({...f2e,props:u2e,emits:d2e,setup(e,{expose:t,emit:o}){const i=e;let c;const u=ae(QB(i.value)-Date.now()),f=K(()=>ZB(u.value,i.format)),p=b=>ZB(b,i.format),m=()=>{c&&(Jf(c),c=void 0)},_=()=>{const b=QB(i.value),S=()=>{let T=b-Date.now();o("change",T),T<=0?(T=0,m(),o("finish")):c=_d(S),u.value=T};c=_d(S)};return rt(()=>[i.value,i.format],()=>{m(),_()},{immediate:!0}),Ro(()=>{m()}),t({displayValue:f}),(b,S)=>(J(),He(y(Hz),{value:u.value,title:b.title,prefix:b.prefix,suffix:b.suffix,"value-style":b.valueStyle,formatter:p},kc({_:2},[Vn(b.$slots,(T,M)=>({name:M,fn:Ne(()=>[We(b.$slots,M)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var g2e=vt(p2e,[["__file","countdown.vue"]]);const m2e=bn(g2e),v2e=gt({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),_2e={[Lo]:(e,t)=>[e,t].every(Zt)},y2e=Se({name:"ElSteps"}),I2e=Se({...y2e,props:v2e,emits:_2e,setup(e,{emit:t}){const o=e,i=lt("steps"),{children:c,addChild:u,removeChild:f}=RL(In(),"ElStep");return rt(c,()=>{c.value.forEach((p,m)=>{p.setIndex(m)})}),Ln("ElSteps",{props:o,steps:c,addStep:u,removeStep:f}),rt(()=>o.active,(p,m)=>{t(Lo,p,m)}),(p,m)=>(J(),ge("div",{class:ne([y(i).b(),y(i).m(p.simple?"simple":p.direction)])},[We(p.$slots,"default")],2))}});var b2e=vt(I2e,[["__file","steps.vue"]]);const C2e=gt({title:{type:String,default:""},icon:{type:mo},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),S2e=Se({name:"ElStep"}),T2e=Se({...S2e,props:C2e,setup(e){const t=e,o=lt("step"),i=ae(-1),c=ae({}),u=ae(""),f=wt("ElSteps"),p=In();fn(()=>{rt([()=>f.props.active,()=>f.props.processStatus,()=>f.props.finishStatus],([B])=>{F(B)},{immediate:!0})}),Ro(()=>{f.removeStep(H.uid)});const m=K(()=>t.status||u.value),_=K(()=>{const B=f.steps.value[i.value-1];return B?B.currentStatus:"wait"}),b=K(()=>f.props.alignCenter),S=K(()=>f.props.direction==="vertical"),T=K(()=>f.props.simple),M=K(()=>f.steps.value.length),R=K(()=>{var B;return((B=f.steps.value[M.value-1])==null?void 0:B.uid)===(p==null?void 0:p.uid)}),E=K(()=>T.value?"":f.props.space),N=K(()=>[o.b(),o.is(T.value?"simple":f.props.direction),o.is("flex",R.value&&!E.value&&!b.value),o.is("center",b.value&&!S.value&&!T.value)]),D=K(()=>{const B={flexBasis:Zt(E.value)?`${E.value}px`:E.value?E.value:`${100/(M.value-(b.value?0:1))}%`};return S.value||R.value&&(B.maxWidth=`${100/M.value}%`),B}),x=B=>{i.value=B},L=B=>{const z=B==="wait",W={transitionDelay:`${z?"-":""}${150*i.value}ms`},Z=B===f.props.processStatus||z?0:100;W.borderWidth=Z&&!T.value?"1px":0,W[f.props.direction==="vertical"?"height":"width"]=`${Z}%`,c.value=W},F=B=>{B>i.value?u.value=f.props.finishStatus:B===i.value&&_.value!=="error"?u.value=f.props.processStatus:u.value="wait";const z=f.steps.value[i.value-1];z&&z.calcProgress(u.value)},H=Zn({uid:p.uid,currentStatus:m,setIndex:x,calcProgress:L});return f.addStep(H),(B,z)=>(J(),ge("div",{style:Ht(y(D)),class:ne(y(N))},[Fe(" icon & line "),Ce("div",{class:ne([y(o).e("head"),y(o).is(y(m))])},[y(T)?Fe("v-if",!0):(J(),ge("div",{key:0,class:ne(y(o).e("line"))},[Ce("i",{class:ne(y(o).e("line-inner")),style:Ht(c.value)},null,6)],2)),Ce("div",{class:ne([y(o).e("icon"),y(o).is(B.icon||B.$slots.icon?"icon":"text")])},[We(B.$slots,"icon",{},()=>[B.icon?(J(),He(y(Gt),{key:0,class:ne(y(o).e("icon-inner"))},{default:Ne(()=>[(J(),He(wn(B.icon)))]),_:1},8,["class"])):y(m)==="success"?(J(),He(y(Gt),{key:1,class:ne([y(o).e("icon-inner"),y(o).is("status")])},{default:Ne(()=>[Me(y(pI))]),_:1},8,["class"])):y(m)==="error"?(J(),He(y(Gt),{key:2,class:ne([y(o).e("icon-inner"),y(o).is("status")])},{default:Ne(()=>[Me(y(La))]),_:1},8,["class"])):y(T)?Fe("v-if",!0):(J(),ge("div",{key:3,class:ne(y(o).e("icon-inner"))},pt(i.value+1),3))])],2)],2),Fe(" title & description "),Ce("div",{class:ne(y(o).e("main"))},[Ce("div",{class:ne([y(o).e("title"),y(o).is(y(m))])},[We(B.$slots,"title",{},()=>[On(pt(B.title),1)])],2),y(T)?(J(),ge("div",{key:0,class:ne(y(o).e("arrow"))},null,2)):(J(),ge("div",{key:1,class:ne([y(o).e("description"),y(o).is(y(m))])},[We(B.$slots,"description",{},()=>[On(pt(B.description),1)])],2))],2)],6))}});var qz=vt(T2e,[["__file","item.vue"]]);const E2e=bn(b2e,{Step:qz}),M2e=Wo(qz),k2e=gt({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:zq},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:mo},activeActionIcon:{type:mo},activeIcon:{type:mo},inactiveIcon:{type:mo},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Le(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0},...ti(["ariaLabel"])}),A2e={[Mn]:e=>yr(e)||on(e)||Zt(e),[Lo]:e=>yr(e)||on(e)||Zt(e),[Hi]:e=>yr(e)||on(e)||Zt(e)},R2e=["onClick"],w2e=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],D2e=["aria-hidden"],O2e=["aria-hidden"],N2e=["aria-hidden"],Kz="ElSwitch",L2e=Se({name:Kz}),P2e=Se({...L2e,props:k2e,emits:A2e,setup(e,{expose:t,emit:o}){const i=e,{formItem:c}=Oi(),u=Tr(),f=lt("switch"),{inputId:p}=Va(i,{formItemContext:c}),m=zi(K(()=>i.loading)),_=ae(i.modelValue!==!1),b=ae(),S=ae(),T=K(()=>[f.b(),f.m(u.value),f.is("disabled",m.value),f.is("checked",D.value)]),M=K(()=>[f.e("label"),f.em("label","left"),f.is("active",!D.value)]),R=K(()=>[f.e("label"),f.em("label","right"),f.is("active",D.value)]),E=K(()=>({width:Xo(i.width)}));rt(()=>i.modelValue,()=>{_.value=!0});const N=K(()=>_.value?i.modelValue:!1),D=K(()=>N.value===i.activeValue);[i.activeValue,i.inactiveValue].includes(N.value)||(o(Mn,i.inactiveValue),o(Lo,i.inactiveValue),o(Hi,i.inactiveValue)),rt(D,H=>{var B;b.value.checked=H,i.validateEvent&&((B=c==null?void 0:c.validate)==null||B.call(c,"change").catch(z=>void 0))});const x=()=>{const H=D.value?i.inactiveValue:i.activeValue;o(Mn,H),o(Lo,H),o(Hi,H),zt(()=>{b.value.checked=D.value})},L=()=>{if(m.value)return;const{beforeChange:H}=i;if(!H){x();return}const B=H();[b0(B),yr(B)].includes(!0)||wr(Kz,"beforeChange must return type `Promise<boolean>` or `boolean`"),b0(B)?B.then(W=>{W&&x()}).catch(W=>{}):B&&x()},F=()=>{var H,B;(B=(H=b.value)==null?void 0:H.focus)==null||B.call(H)};return fn(()=>{b.value.checked=D.value}),$r({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-switch",ref:"https://element-plus.org/en-US/component/switch.html"},K(()=>!!i.label)),t({focus:F,checked:D}),(H,B)=>(J(),ge("div",{class:ne(y(T)),onClick:nn(L,["prevent"])},[Ce("input",{id:y(p),ref_key:"input",ref:b,class:ne(y(f).e("input")),type:"checkbox",role:"switch","aria-checked":y(D),"aria-disabled":y(m),"aria-label":H.label||H.ariaLabel,name:H.name,"true-value":H.activeValue,"false-value":H.inactiveValue,disabled:y(m),tabindex:H.tabindex,onChange:x,onKeydown:go(L,["enter"])},null,42,w2e),!H.inlinePrompt&&(H.inactiveIcon||H.inactiveText)?(J(),ge("span",{key:0,class:ne(y(M))},[H.inactiveIcon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(H.inactiveIcon)))]),_:1})):Fe("v-if",!0),!H.inactiveIcon&&H.inactiveText?(J(),ge("span",{key:1,"aria-hidden":y(D)},pt(H.inactiveText),9,D2e)):Fe("v-if",!0)],2)):Fe("v-if",!0),Ce("span",{ref_key:"core",ref:S,class:ne(y(f).e("core")),style:Ht(y(E))},[H.inlinePrompt?(J(),ge("div",{key:0,class:ne(y(f).e("inner"))},[H.activeIcon||H.inactiveIcon?(J(),He(y(Gt),{key:0,class:ne(y(f).is("icon"))},{default:Ne(()=>[(J(),He(wn(y(D)?H.activeIcon:H.inactiveIcon)))]),_:1},8,["class"])):H.activeText||H.inactiveText?(J(),ge("span",{key:1,class:ne(y(f).is("text")),"aria-hidden":!y(D)},pt(y(D)?H.activeText:H.inactiveText),11,O2e)):Fe("v-if",!0)],2)):Fe("v-if",!0),Ce("div",{class:ne(y(f).e("action"))},[H.loading?(J(),He(y(Gt),{key:0,class:ne(y(f).is("loading"))},{default:Ne(()=>[Me(y(Rd))]),_:1},8,["class"])):y(D)?We(H.$slots,"active-action",{key:1},()=>[H.activeActionIcon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(H.activeActionIcon)))]),_:1})):Fe("v-if",!0)]):y(D)?Fe("v-if",!0):We(H.$slots,"inactive-action",{key:2},()=>[H.inactiveActionIcon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(H.inactiveActionIcon)))]),_:1})):Fe("v-if",!0)])],2)],6),!H.inlinePrompt&&(H.activeIcon||H.activeText)?(J(),ge("span",{key:1,class:ne(y(R))},[H.activeIcon?(J(),He(y(Gt),{key:0},{default:Ne(()=>[(J(),He(wn(H.activeIcon)))]),_:1})):Fe("v-if",!0),!H.activeIcon&&H.activeText?(J(),ge("span",{key:1,"aria-hidden":!y(D)},pt(H.activeText),9,N2e)):Fe("v-if",!0)],2)):Fe("v-if",!0)],10,R2e))}});var U2e=vt(P2e,[["__file","switch.vue"]]);const x2e=bn(U2e),cD=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},F2e=function(e,t,o,i,c){if(!t&&!i&&(!c||Array.isArray(c)&&!c.length))return e;typeof o=="string"?o=o==="descending"?-1:1:o=o&&o<0?-1:1;const u=i?null:function(p,m){return c?(Array.isArray(c)||(c=[c]),c.map(_=>typeof _=="string"?ir(p,_):_(p,m,e))):(t!=="$key"&&En(p)&&"$value"in p&&(p=p.$value),[En(p)?ir(p,t):p])},f=function(p,m){if(i)return i(p.value,m.value);for(let _=0,b=p.key.length;_<b;_++){if(p.key[_]<m.key[_])return-1;if(p.key[_]>m.key[_])return 1}return 0};return e.map((p,m)=>({value:p,index:m,key:u?u(p,m):null})).sort((p,m)=>{let _=f(p,m);return _||(_=p.index-m.index),_*+o}).map(p=>p.value)},zz=function(e,t){let o=null;return e.columns.forEach(i=>{i.id===t&&(o=i)}),o},V2e=function(e,t){let o=null;for(let i=0;i<e.columns.length;i++){const c=e.columns[i];if(c.columnKey===t){o=c;break}}return o||wr("ElTable",`No column matching with column-key: ${t}`),o},e$=function(e,t,o){const i=(t.className||"").match(new RegExp(`${o}-table_[^\\s]+`,"gm"));return i?zz(e,i[0]):null},di=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(typeof t=="string"){if(!t.includes("."))return`${e[t]}`;const o=t.split(".");let i=e;for(const c of o)i=i[c];return`${i}`}else if(typeof t=="function")return t.call(null,e)},Uf=function(e,t){const o={};return(e||[]).forEach((i,c)=>{o[di(i,t)]={row:i,index:c}}),o};function G2e(e,t){const o={};let i;for(i in e)o[i]=e[i];for(i in t)if(qn(t,i)){const c=t[i];typeof c<"u"&&(o[i]=c)}return o}function e2(e){return e===""||e!==void 0&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function Wz(e){return e===""||e!==void 0&&(e=e2(e),Number.isNaN(e)&&(e=80)),e}function B2e(e){return typeof e=="number"?e:typeof e=="string"?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function $2e(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,o)=>(...i)=>t(o(...i)))}function y0(e,t,o){let i=!1;const c=e.indexOf(t),u=c!==-1,f=p=>{p==="add"?e.push(t):e.splice(c,1),i=!0,At(t.children)&&t.children.forEach(m=>{y0(e,m,o??!u)})};return yr(o)?o&&!u?f("add"):!o&&u&&f("remove"):f(u?"remove":"add"),i}function H2e(e,t,o="children",i="hasChildren"){const c=f=>!(Array.isArray(f)&&f.length);function u(f,p,m){t(f,p,m),p.forEach(_=>{if(_[i]){t(_,null,m+1);return}const b=_[o];c(b)||u(_,b,m+1)})}e.forEach(f=>{if(f[i]){t(f,null,0);return}const p=f[o];c(p)||u(f,p,0)})}let Hs=null;function q2e(e,t,o,i){if((Hs==null?void 0:Hs.trigger)===o)return;Hs==null||Hs();const c=i==null?void 0:i.refs.tableWrapper,u=c==null?void 0:c.dataset.prefix,f={strategy:"fixed",...e.popperOptions},p=Me(Di,{content:t,virtualTriggering:!0,virtualRef:o,appendTo:c,placement:"top",transition:"none",offset:0,hideAfter:0,...e,popperOptions:f,onHide:()=>{Hs==null||Hs()}});p.appContext={...i.appContext,...i};const m=document.createElement("div");gd(p,m),p.component.exposed.onOpen();const _=c==null?void 0:c.querySelector(`.${u}-scrollbar__wrap`);Hs=()=>{gd(null,m),_==null||_.removeEventListener("scroll",Hs),Hs=null},Hs.trigger=o,_==null||_.addEventListener("scroll",Hs)}function jz(e){return e.children?nve(e.children,jz):[e]}function t$(e,t){return e+t.colSpan}const Yz=(e,t,o,i)=>{let c=0,u=e;const f=o.states.columns.value;if(i){const m=jz(i[e]);c=f.slice(0,f.indexOf(m[0])).reduce(t$,0),u=c+m.reduce(t$,0)-1}else c=e;let p;switch(t){case"left":u<o.states.fixedLeafColumnsLength.value&&(p="left");break;case"right":c>=f.length-o.states.rightFixedLeafColumnsLength.value&&(p="right");break;default:u<o.states.fixedLeafColumnsLength.value?p="left":c>=f.length-o.states.rightFixedLeafColumnsLength.value&&(p="right")}return p?{direction:p,start:c,after:u}:{}},t2=(e,t,o,i,c,u=0)=>{const f=[],{direction:p,start:m,after:_}=Yz(t,o,i,c);if(p){const b=p==="left";f.push(`${e}-fixed-column--${p}`),b&&_+u===i.states.fixedLeafColumnsLength.value-1?f.push("is-last-column"):!b&&m-u===i.states.columns.value.length-i.states.rightFixedLeafColumnsLength.value&&f.push("is-first-column")}return f};function n$(e,t){return e+(t.realWidth===null||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const n2=(e,t,o,i)=>{const{direction:c,start:u=0,after:f=0}=Yz(e,t,o,i);if(!c)return;const p={},m=c==="left",_=o.states.columns.value;return m?p.left=_.slice(0,u).reduce(n$,0):p.right=_.slice(f+1).reverse().reduce(n$,0),p},wm=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function K2e(e){const t=In(),o=ae(!1),i=ae([]);return{updateExpandRows:()=>{const m=e.data.value||[],_=e.rowKey.value;if(o.value)i.value=m.slice();else if(_){const b=Uf(i.value,_);i.value=m.reduce((S,T)=>{const M=di(T,_);return b[M]&&S.push(T),S},[])}else i.value=[]},toggleRowExpansion:(m,_)=>{y0(i.value,m,_)&&t.emit("expand-change",m,i.value.slice())},setExpandRowKeys:m=>{t.store.assertRowKey();const _=e.data.value||[],b=e.rowKey.value,S=Uf(_,b);i.value=m.reduce((T,M)=>{const R=S[M];return R&&T.push(R.row),T},[])},isRowExpanded:m=>{const _=e.rowKey.value;return _?!!Uf(i.value,_)[di(m,_)]:i.value.includes(m)},states:{expandRows:i,defaultExpandAll:o}}}function z2e(e){const t=In(),o=ae(null),i=ae(null),c=_=>{t.store.assertRowKey(),o.value=_,f(_)},u=()=>{o.value=null},f=_=>{const{data:b,rowKey:S}=e;let T=null;S.value&&(T=(y(b)||[]).find(M=>di(M,S.value)===_)),i.value=T,t.emit("current-change",i.value,null)};return{setCurrentRowKey:c,restoreCurrentRowKey:u,setCurrentRowByKey:f,updateCurrentRow:_=>{const b=i.value;if(_&&_!==b){i.value=_,t.emit("current-change",i.value,b);return}!_&&b&&(i.value=null,t.emit("current-change",null,b))},updateCurrentRowData:()=>{const _=e.rowKey.value,b=e.data.value||[],S=i.value;if(!b.includes(S)&&S){if(_){const T=di(S,_);f(T)}else i.value=null;i.value===null&&t.emit("current-change",null,S)}else o.value&&(f(o.value),u())},states:{_currentRowKey:o,currentRow:i}}}function W2e(e){const t=ae([]),o=ae({}),i=ae(16),c=ae(!1),u=ae({}),f=ae("hasChildren"),p=ae("children"),m=In(),_=K(()=>{if(!e.rowKey.value)return{};const D=e.data.value||[];return S(D)}),b=K(()=>{const D=e.rowKey.value,x=Object.keys(u.value),L={};return x.length&&x.forEach(F=>{if(u.value[F].length){const H={children:[]};u.value[F].forEach(B=>{const z=di(B,D);H.children.push(z),B[f.value]&&!L[z]&&(L[z]={children:[]})}),L[F]=H}}),L}),S=D=>{const x=e.rowKey.value,L={};return H2e(D,(F,H,B)=>{const z=di(F,x);Array.isArray(H)?L[z]={children:H.map(W=>di(W,x)),level:B}:c.value&&(L[z]={children:[],lazy:!0,level:B})},p.value,f.value),L},T=(D=!1,x=(L=>(L=m.store)==null?void 0:L.states.defaultExpandAll.value)())=>{var L;const F=_.value,H=b.value,B=Object.keys(F),z={};if(B.length){const W=y(o),Z=[],$=(X,le)=>{if(D)return t.value?x||t.value.includes(le):!!(x||X!=null&&X.expanded);{const de=x||t.value&&t.value.includes(le);return!!(X!=null&&X.expanded||de)}};B.forEach(X=>{const le=W[X],de={...F[X]};if(de.expanded=$(le,X),de.lazy){const{loaded:he=!1,loading:se=!1}=le||{};de.loaded=!!he,de.loading=!!se,Z.push(X)}z[X]=de});const O=Object.keys(H);c.value&&O.length&&Z.length&&O.forEach(X=>{const le=W[X],de=H[X].children;if(Z.includes(X)){if(z[X].children.length!==0)throw new Error("[ElTable]children must be an empty array.");z[X].children=de}else{const{loaded:he=!1,loading:se=!1}=le||{};z[X]={lazy:!0,loaded:!!he,loading:!!se,expanded:$(le,X),children:de,level:""}}})}o.value=z,(L=m.store)==null||L.updateTableScrollY()};rt(()=>t.value,()=>{T(!0)}),rt(()=>_.value,()=>{T()}),rt(()=>b.value,()=>{T()});const M=D=>{t.value=D,T()},R=(D,x)=>{m.store.assertRowKey();const L=e.rowKey.value,F=di(D,L),H=F&&o.value[F];if(F&&H&&"expanded"in H){const B=H.expanded;x=typeof x>"u"?!H.expanded:x,o.value[F].expanded=x,B!==x&&m.emit("expand-change",D,x),m.store.updateTableScrollY()}},E=D=>{m.store.assertRowKey();const x=e.rowKey.value,L=di(D,x),F=o.value[L];c.value&&F&&"loaded"in F&&!F.loaded?N(D,L,F):R(D,void 0)},N=(D,x,L)=>{const{load:F}=m.props;F&&!o.value[x].loaded&&(o.value[x].loading=!0,F(D,L,H=>{if(!Array.isArray(H))throw new TypeError("[ElTable] data must be an array");o.value[x].loading=!1,o.value[x].loaded=!0,o.value[x].expanded=!0,H.length&&(u.value[x]=H),m.emit("expand-change",D,!0)}))};return{loadData:N,loadOrToggle:E,toggleTreeExpansion:R,updateTreeExpandKeys:M,updateTreeData:T,normalize:S,states:{expandRowKeys:t,treeData:o,indent:i,lazy:c,lazyTreeNodeMap:u,lazyColumnIdentifier:f,childrenColumnName:p}}}const j2e=(e,t)=>{const o=t.sortingColumn;return!o||typeof o.sortable=="string"?e:F2e(e,t.sortProp,t.sortOrder,o.sortMethod,o.sortBy)},WT=e=>{const t=[];return e.forEach(o=>{o.children&&o.children.length>0?t.push.apply(t,WT(o.children)):t.push(o)}),t};function Y2e(){var e;const t=In(),{size:o}=ei((e=t.proxy)==null?void 0:e.$props),i=ae(null),c=ae([]),u=ae([]),f=ae(!1),p=ae([]),m=ae([]),_=ae([]),b=ae([]),S=ae([]),T=ae([]),M=ae([]),R=ae([]),E=[],N=ae(0),D=ae(0),x=ae(0),L=ae(!1),F=ae([]),H=ae(!1),B=ae(!1),z=ae(null),W=ae({}),Z=ae(null),$=ae(null),O=ae(null),X=ae(null),le=ae(null);rt(c,()=>t.state&&ie(!1),{deep:!0});const de=()=>{if(!i.value)throw new Error("[ElTable] prop row-key is required")},he=Bt=>{var nt;(nt=Bt.children)==null||nt.forEach(It=>{It.fixed=Bt.fixed,he(It)})},se=()=>{p.value.forEach(Ke=>{he(Ke)}),b.value=p.value.filter(Ke=>Ke.fixed===!0||Ke.fixed==="left"),S.value=p.value.filter(Ke=>Ke.fixed==="right"),b.value.length>0&&p.value[0]&&p.value[0].type==="selection"&&!p.value[0].fixed&&(p.value[0].fixed=!0,b.value.unshift(p.value[0]));const Bt=p.value.filter(Ke=>!Ke.fixed);m.value=[].concat(b.value).concat(Bt).concat(S.value);const nt=WT(Bt),It=WT(b.value),ct=WT(S.value);N.value=nt.length,D.value=It.length,x.value=ct.length,_.value=[].concat(It).concat(nt).concat(ct),f.value=b.value.length>0||S.value.length>0},ie=(Bt,nt=!1)=>{Bt&&se(),nt?t.state.doLayout():t.state.debouncedUpdateLayout()},oe=Bt=>F.value.includes(Bt),ee=()=>{L.value=!1;const Bt=F.value;F.value=[],Bt.length&&t.emit("selection-change",[])},Q=()=>{let Bt;if(i.value){Bt=[];const nt=Uf(F.value,i.value),It=Uf(c.value,i.value);for(const ct in nt)qn(nt,ct)&&!It[ct]&&Bt.push(nt[ct].row)}else Bt=F.value.filter(nt=>!c.value.includes(nt));if(Bt.length){const nt=F.value.filter(It=>!Bt.includes(It));F.value=nt,t.emit("selection-change",nt.slice())}},ue=()=>(F.value||[]).slice(),me=(Bt,nt=void 0,It=!0)=>{if(y0(F.value,Bt,nt)){const Ke=(F.value||[]).slice();It&&t.emit("select",Ke,Bt),t.emit("selection-change",Ke)}},be=()=>{var Bt,nt;const It=B.value?!L.value:!(L.value||F.value.length);L.value=It;let ct=!1,Ke=0;const Xe=(nt=(Bt=t==null?void 0:t.store)==null?void 0:Bt.states)==null?void 0:nt.rowKey.value;c.value.forEach((Dt,$e)=>{const xt=$e+Ke;z.value?z.value.call(null,Dt,xt)&&y0(F.value,Dt,It)&&(ct=!0):y0(F.value,Dt,It)&&(ct=!0),Ke+=Oe(di(Dt,Xe))}),ct&&t.emit("selection-change",F.value?F.value.slice():[]),t.emit("select-all",(F.value||[]).slice())},ke=()=>{const Bt=Uf(F.value,i.value);c.value.forEach(nt=>{const It=di(nt,i.value),ct=Bt[It];ct&&(F.value[ct.index]=nt)})},Ye=()=>{var Bt,nt,It;if(((Bt=c.value)==null?void 0:Bt.length)===0){L.value=!1;return}let ct;i.value&&(ct=Uf(F.value,i.value));const Ke=function(xt){return ct?!!ct[di(xt,i.value)]:F.value.includes(xt)};let Xe=!0,Dt=0,$e=0;for(let xt=0,jt=(c.value||[]).length;xt<jt;xt++){const Fn=(It=(nt=t==null?void 0:t.store)==null?void 0:nt.states)==null?void 0:It.rowKey.value,oo=xt+$e,zn=c.value[xt],kn=z.value&&z.value.call(null,zn,oo);if(Ke(zn))Dt++;else if(!z.value||kn){Xe=!1;break}$e+=Oe(di(zn,Fn))}Dt===0&&(Xe=!1),L.value=Xe},Oe=Bt=>{var nt;if(!t||!t.store)return 0;const{treeData:It}=t.store.states;let ct=0;const Ke=(nt=It.value[Bt])==null?void 0:nt.children;return Ke&&(ct+=Ke.length,Ke.forEach(Xe=>{ct+=Oe(Xe)})),ct},Ee=(Bt,nt)=>{Array.isArray(Bt)||(Bt=[Bt]);const It={};return Bt.forEach(ct=>{W.value[ct.id]=nt,It[ct.columnKey||ct.id]=nt}),It},we=(Bt,nt,It)=>{$.value&&$.value!==Bt&&($.value.order=null),$.value=Bt,O.value=nt,X.value=It},Ge=()=>{let Bt=y(u);Object.keys(W.value).forEach(nt=>{const It=W.value[nt];if(!It||It.length===0)return;const ct=zz({columns:_.value},nt);ct&&ct.filterMethod&&(Bt=Bt.filter(Ke=>It.some(Xe=>ct.filterMethod.call(null,Xe,Ke,ct))))}),Z.value=Bt},Ve=()=>{c.value=j2e(Z.value,{sortingColumn:$.value,sortProp:O.value,sortOrder:X.value})},qe=(Bt=void 0)=>{Bt&&Bt.filter||Ge(),Ve()},st=Bt=>{const{tableHeaderRef:nt}=t.refs;if(!nt)return;const It=Object.assign({},nt.filterPanels),ct=Object.keys(It);if(ct.length)if(typeof Bt=="string"&&(Bt=[Bt]),Array.isArray(Bt)){const Ke=Bt.map(Xe=>V2e({columns:_.value},Xe));ct.forEach(Xe=>{const Dt=Ke.find($e=>$e.id===Xe);Dt&&(Dt.filteredValue=[])}),t.store.commit("filterChange",{column:Ke,values:[],silent:!0,multi:!0})}else ct.forEach(Ke=>{const Xe=_.value.find(Dt=>Dt.id===Ke);Xe&&(Xe.filteredValue=[])}),W.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Ie=()=>{$.value&&(we(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Ae,toggleRowExpansion:xe,updateExpandRows:ot,states:je,isRowExpanded:at}=K2e({data:c,rowKey:i}),{updateTreeExpandKeys:ht,toggleTreeExpansion:dt,updateTreeData:ft,loadOrToggle:Je,states:Et}=W2e({data:c,rowKey:i}),{updateCurrentRowData:Nt,updateCurrentRow:et,setCurrentRowKey:Mt,states:Jt}=z2e({data:c,rowKey:i});return{assertRowKey:de,updateColumns:se,scheduleLayout:ie,isSelected:oe,clearSelection:ee,cleanSelection:Q,getSelectionRows:ue,toggleRowSelection:me,_toggleAllSelection:be,toggleAllSelection:null,updateSelectionByRowKey:ke,updateAllSelected:Ye,updateFilters:Ee,updateCurrentRow:et,updateSort:we,execFilter:Ge,execSort:Ve,execQuery:qe,clearFilter:st,clearSort:Ie,toggleRowExpansion:xe,setExpandRowKeysAdapter:Bt=>{Ae(Bt),ht(Bt)},setCurrentRowKey:Mt,toggleRowExpansionAdapter:(Bt,nt)=>{_.value.some(({type:ct})=>ct==="expand")?xe(Bt,nt):dt(Bt,nt)},isRowExpanded:at,updateExpandRows:ot,updateCurrentRowData:Nt,loadOrToggle:Je,updateTreeData:ft,states:{tableSize:o,rowKey:i,data:c,_data:u,isComplex:f,_columns:p,originColumns:m,columns:_,fixedColumns:b,rightFixedColumns:S,leafColumns:T,fixedLeafColumns:M,rightFixedLeafColumns:R,updateOrderFns:E,leafColumnsLength:N,fixedLeafColumnsLength:D,rightFixedLeafColumnsLength:x,isAllSelected:L,selection:F,reserveSelection:H,selectOnIndeterminate:B,selectable:z,filters:W,filteredData:Z,sortingColumn:$,sortProp:O,sortOrder:X,hoverRow:le,...je,...Et,...Jt}}}function PO(e,t){return e.map(o=>{var i;return o.id===t.id?t:((i=o.children)!=null&&i.length&&(o.children=PO(o.children,t)),o)})}function UO(e){e.forEach(t=>{var o,i;t.no=(o=t.getColumnIndex)==null?void 0:o.call(t),(i=t.children)!=null&&i.length&&UO(t.children)}),e.sort((t,o)=>t.no-o.no)}function J2e(){const e=In(),t=Y2e();return{ns:lt("table"),...t,mutations:{setData(f,p){const m=y(f._data)!==p;f.data.value=p,f._data.value=p,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(f.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):m?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(f,p,m,_){const b=y(f._columns);let S=[];m?(m&&!m.children&&(m.children=[]),m.children.push(p),S=PO(b,m)):(b.push(p),S=b),UO(S),f._columns.value=S,f.updateOrderFns.push(_),p.type==="selection"&&(f.selectable.value=p.selectable,f.reserveSelection.value=p.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(f,p){var m;((m=p.getColumnIndex)==null?void 0:m.call(p))!==p.no&&(UO(f._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(f,p,m,_){const b=y(f._columns)||[];if(m)m.children.splice(m.children.findIndex(T=>T.id===p.id),1),zt(()=>{var T;((T=m.children)==null?void 0:T.length)===0&&delete m.children}),f._columns.value=PO(b,m);else{const T=b.indexOf(p);T>-1&&(b.splice(T,1),f._columns.value=b)}const S=f.updateOrderFns.indexOf(_);S>-1&&f.updateOrderFns.splice(S,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(f,p){const{prop:m,order:_,init:b}=p;if(m){const S=y(f.columns).find(T=>T.property===m);S&&(S.order=_,e.store.updateSort(S,m,_),e.store.commit("changeSortCondition",{init:b}))}},changeSortCondition(f,p){const{sortingColumn:m,sortProp:_,sortOrder:b}=f,S=y(m),T=y(_),M=y(b);M===null&&(f.sortingColumn.value=null,f.sortProp.value=null);const R={filter:!0};e.store.execQuery(R),(!p||!(p.silent||p.init))&&e.emit("sort-change",{column:S,prop:T,order:M}),e.store.updateTableScrollY()},filterChange(f,p){const{column:m,values:_,silent:b}=p,S=e.store.updateFilters(m,_);e.store.execQuery(),b||e.emit("filter-change",S),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(f,p){e.store.toggleRowSelection(p),e.store.updateAllSelected()},setHoverRow(f,p){f.hoverRow.value=p},setCurrentRow(f,p){e.store.updateCurrentRow(p)}},commit:function(f,...p){const m=e.store.mutations;if(m[f])m[f].apply(e,[e.store.states].concat(p));else throw new Error(`Action not found: ${f}`)},updateTableScrollY:function(){zt(()=>e.layout.updateScrollY.apply(e.layout))}}}const I0={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function X2e(e,t){if(!e)throw new Error("Table is required.");const o=J2e();return o.toggleAllSelection=as(o._toggleAllSelection,10),Object.keys(I0).forEach(i=>{Jz(Xz(t,i),i,o)}),Q2e(o,t),o}function Q2e(e,t){Object.keys(I0).forEach(o=>{rt(()=>Xz(t,o),i=>{Jz(i,o,e)})})}function Jz(e,t,o){let i=e,c=I0[t];typeof I0[t]=="object"&&(c=c.key,i=i||I0[t].default),o.states[c].value=i}function Xz(e,t){if(t.includes(".")){const o=t.split(".");let i=e;return o.forEach(c=>{i=i[c]}),i}else return e[t]}class Z2e{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=ae(null),this.scrollX=ae(!1),this.scrollY=ae(!1),this.bodyWidth=ae(null),this.fixedWidth=ae(null),this.rightFixedWidth=ae(null),this.gutterWidth=0;for(const o in t)qn(t,o)&&(No(this[o])?this[o].value=t[o]:this[o]=t[o]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const o=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(o!=null&&o.wrapRef)){let i=!0;const c=this.scrollY.value;return i=o.wrapRef.scrollHeight>o.wrapRef.clientHeight,this.scrollY.value=i,c!==i}return!1}setHeight(t,o="height"){if(!$n)return;const i=this.table.vnode.el;if(t=B2e(t),this.height.value=Number(t),!i&&(t||t===0))return zt(()=>this.setHeight(t,o));typeof t=="number"?(i.style[o]=`${t}px`,this.updateElsHeight()):typeof t=="string"&&(i.style[o]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(i=>{i.isColumnGroup?t.push.apply(t,i.columns):t.push(i)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let o=t;for(;o.tagName!=="DIV";){if(getComputedStyle(o).display==="none")return!0;o=o.parentElement}return!1}updateColumnsWidth(){if(!$n)return;const t=this.fit,o=this.table.vnode.el.clientWidth;let i=0;const c=this.getFlattenColumns(),u=c.filter(m=>typeof m.width!="number");if(c.forEach(m=>{typeof m.width=="number"&&m.realWidth&&(m.realWidth=null)}),u.length>0&&t){if(c.forEach(m=>{i+=Number(m.width||m.minWidth||80)}),i<=o){this.scrollX.value=!1;const m=o-i;if(u.length===1)u[0].realWidth=Number(u[0].minWidth||80)+m;else{const _=u.reduce((T,M)=>T+Number(M.minWidth||80),0),b=m/_;let S=0;u.forEach((T,M)=>{if(M===0)return;const R=Math.floor(Number(T.minWidth||80)*b);S+=R,T.realWidth=Number(T.minWidth||80)+R}),u[0].realWidth=Number(u[0].minWidth||80)+m-S}}else this.scrollX.value=!0,u.forEach(m=>{m.realWidth=Number(m.minWidth)});this.bodyWidth.value=Math.max(i,o),this.table.state.resizeState.value.width=this.bodyWidth.value}else c.forEach(m=>{!m.width&&!m.minWidth?m.realWidth=80:m.realWidth=Number(m.width||m.minWidth),i+=m.realWidth}),this.scrollX.value=i>o,this.bodyWidth.value=i;const f=this.store.states.fixedColumns.value;if(f.length>0){let m=0;f.forEach(_=>{m+=Number(_.realWidth||_.width)}),this.fixedWidth.value=m}const p=this.store.states.rightFixedColumns.value;if(p.length>0){let m=0;p.forEach(_=>{m+=Number(_.realWidth||_.width)}),this.rightFixedWidth.value=m}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const o=this.observers.indexOf(t);o!==-1&&this.observers.splice(o,1)}notifyObservers(t){this.observers.forEach(i=>{var c,u;switch(t){case"columns":(c=i.state)==null||c.onColumnsChange(this);break;case"scrollable":(u=i.state)==null||u.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:ePe}=aa,tPe=Se({name:"ElTableFilterPanel",components:{ElCheckbox:aa,ElCheckboxGroup:ePe,ElScrollbar:xc,ElTooltip:Di,ElIcon:Gt,ArrowDown:Pc,ArrowUp:tL},directives:{ClickOutside:wc},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(e){const t=In(),{t:o}=Kn(),i=lt("table-filter"),c=t==null?void 0:t.parent;c.filterPanels.value[e.column.id]||(c.filterPanels.value[e.column.id]=t);const u=ae(!1),f=ae(null),p=K(()=>e.column&&e.column.filters),m=K(()=>e.column.filterClassName?`${i.b()} ${e.column.filterClassName}`:i.b()),_=K({get:()=>{var H;return(((H=e.column)==null?void 0:H.filteredValue)||[])[0]},set:H=>{b.value&&(typeof H<"u"&&H!==null?b.value.splice(0,1,H):b.value.splice(0,1))}}),b=K({get(){return e.column?e.column.filteredValue||[]:[]},set(H){e.column&&e.upDataColumn("filteredValue",H)}}),S=K(()=>e.column?e.column.filterMultiple:!0),T=H=>H.value===_.value,M=()=>{u.value=!1},R=H=>{H.stopPropagation(),u.value=!u.value},E=()=>{u.value=!1},N=()=>{L(b.value),M()},D=()=>{b.value=[],L(b.value),M()},x=H=>{_.value=H,L(typeof H<"u"&&H!==null?b.value:[]),M()},L=H=>{e.store.commit("filterChange",{column:e.column,values:H}),e.store.updateAllSelected()};rt(u,H=>{e.column&&e.upDataColumn("filterOpened",H)},{immediate:!0});const F=K(()=>{var H,B;return(B=(H=f.value)==null?void 0:H.popperRef)==null?void 0:B.contentRef});return{tooltipVisible:u,multiple:S,filterClassName:m,filteredValue:b,filterValue:_,filters:p,handleConfirm:N,handleReset:D,handleSelect:x,isActive:T,t:o,ns:i,showFilterPanel:R,hideFilterPanel:E,popperPaneRef:F,tooltip:f}}}),nPe={key:0},oPe=["disabled"],rPe=["label","onClick"];function iPe(e,t,o,i,c,u){const f=pn("el-checkbox"),p=pn("el-checkbox-group"),m=pn("el-scrollbar"),_=pn("arrow-up"),b=pn("arrow-down"),S=pn("el-icon"),T=pn("el-tooltip"),M=KE("click-outside");return J(),He(T,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:""},{content:Ne(()=>[e.multiple?(J(),ge("div",nPe,[Ce("div",{class:ne(e.ns.e("content"))},[Me(m,{"wrap-class":e.ns.e("wrap")},{default:Ne(()=>[Me(p,{modelValue:e.filteredValue,"onUpdate:modelValue":t[0]||(t[0]=R=>e.filteredValue=R),class:ne(e.ns.e("checkbox-group"))},{default:Ne(()=>[(J(!0),ge(qt,null,Vn(e.filters,R=>(J(),He(f,{key:R.value,value:R.value},{default:Ne(()=>[On(pt(R.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),Ce("div",{class:ne(e.ns.e("bottom"))},[Ce("button",{class:ne({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:t[1]||(t[1]=(...R)=>e.handleConfirm&&e.handleConfirm(...R))},pt(e.t("el.table.confirmFilter")),11,oPe),Ce("button",{type:"button",onClick:t[2]||(t[2]=(...R)=>e.handleReset&&e.handleReset(...R))},pt(e.t("el.table.resetFilter")),1)],2)])):(J(),ge("ul",{key:1,class:ne(e.ns.e("list"))},[Ce("li",{class:ne([e.ns.e("list-item"),{[e.ns.is("active")]:e.filterValue===void 0||e.filterValue===null}]),onClick:t[3]||(t[3]=R=>e.handleSelect(null))},pt(e.t("el.table.clearFilter")),3),(J(!0),ge(qt,null,Vn(e.filters,R=>(J(),ge("li",{key:R.value,class:ne([e.ns.e("list-item"),e.ns.is("active",e.isActive(R))]),label:R.value,onClick:E=>e.handleSelect(R.value)},pt(R.text),11,rPe))),128))],2))]),default:Ne(()=>[hn((J(),ge("span",{class:ne([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:t[4]||(t[4]=(...R)=>e.showFilterPanel&&e.showFilterPanel(...R))},[Me(S,null,{default:Ne(()=>[e.column.filterOpened?(J(),He(_,{key:0})):(J(),He(b,{key:1}))]),_:1})],2)),[[M,e.hideFilterPanel,e.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var sPe=vt(tPe,[["render",iPe],["__file","filter-panel.vue"]]);function Qz(e){const t=In();jE(()=>{o.value.addObserver(t)}),fn(()=>{i(o.value),c(o.value)}),Oc(()=>{i(o.value),c(o.value)}),Md(()=>{o.value.removeObserver(t)});const o=K(()=>{const u=e.layout;if(!u)throw new Error("Can not find table layout.");return u}),i=u=>{var f;const p=((f=e.vnode.el)==null?void 0:f.querySelectorAll("colgroup > col"))||[];if(!p.length)return;const m=u.getFlattenColumns(),_={};m.forEach(b=>{_[b.id]=b});for(let b=0,S=p.length;b<S;b++){const T=p[b],M=T.getAttribute("name"),R=_[M];R&&T.setAttribute("width",R.realWidth||R.width)}},c=u=>{var f,p;const m=((f=e.vnode.el)==null?void 0:f.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let b=0,S=m.length;b<S;b++)m[b].setAttribute("width",u.scrollY.value?u.gutterWidth:"0");const _=((p=e.vnode.el)==null?void 0:p.querySelectorAll("th.gutter"))||[];for(let b=0,S=_.length;b<S;b++){const T=_[b];T.style.width=u.scrollY.value?`${u.gutterWidth}px`:"0",T.style.display=u.scrollY.value?"":"none"}};return{tableLayout:o.value,onColumnsChange:i,onScrollableChange:c}}const Rl=Symbol("ElTable");function aPe(e,t){const o=In(),i=wt(Rl),c=E=>{E.stopPropagation()},u=(E,N)=>{!N.filters&&N.sortable?R(E,N,!1):N.filterable&&!N.sortable&&c(E),i==null||i.emit("header-click",N,E)},f=(E,N)=>{i==null||i.emit("header-contextmenu",N,E)},p=ae(null),m=ae(!1),_=ae({}),b=(E,N)=>{if($n&&!(N.children&&N.children.length>0)&&p.value&&e.border){m.value=!0;const D=i;t("set-drag-visible",!0);const L=(D==null?void 0:D.vnode.el).getBoundingClientRect().left,F=o.vnode.el.querySelector(`th.${N.id}`),H=F.getBoundingClientRect(),B=H.left-L+30;Js(F,"noclick"),_.value={startMouseLeft:E.clientX,startLeft:H.right-L,startColumnLeft:H.left-L,tableLeft:L};const z=D==null?void 0:D.refs.resizeProxy;z.style.left=`${_.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const W=$=>{const O=$.clientX-_.value.startMouseLeft,X=_.value.startLeft+O;z.style.left=`${Math.max(B,X)}px`},Z=()=>{if(m.value){const{startColumnLeft:$,startLeft:O}=_.value,le=Number.parseInt(z.style.left,10)-$;N.width=N.realWidth=le,D==null||D.emit("header-dragend",N.width,O-$,N,E),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",m.value=!1,p.value=null,_.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",Z),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{wi(F,"noclick")},0)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",Z)}},S=(E,N)=>{if(N.children&&N.children.length>0)return;const D=E.target;if(!ra(D))return;const x=D==null?void 0:D.closest("th");if(!(!N||!N.resizable)&&!m.value&&e.border){const L=x.getBoundingClientRect(),F=document.body.style;L.width>12&&L.right-E.pageX<8?(F.cursor="col-resize",ea(x,"is-sortable")&&(x.style.cursor="col-resize"),p.value=N):m.value||(F.cursor="",ea(x,"is-sortable")&&(x.style.cursor="pointer"),p.value=null)}},T=()=>{$n&&(document.body.style.cursor="")},M=({order:E,sortOrders:N})=>{if(E==="")return N[0];const D=N.indexOf(E||null);return N[D>N.length-2?0:D+1]},R=(E,N,D)=>{var x;E.stopPropagation();const L=N.order===D?null:D||M(N),F=(x=E.target)==null?void 0:x.closest("th");if(F&&ea(F,"noclick")){wi(F,"noclick");return}if(!N.sortable)return;const H=e.store.states;let B=H.sortProp.value,z;const W=H.sortingColumn.value;(W!==N||W===N&&W.order===null)&&(W&&(W.order=null),H.sortingColumn.value=N,B=N.property),L?z=N.order=L:z=N.order=null,H.sortProp.value=B,H.sortOrder.value=z,i==null||i.store.commit("changeSortCondition")};return{handleHeaderClick:u,handleHeaderContextMenu:f,handleMouseDown:b,handleMouseMove:S,handleMouseOut:T,handleSortClick:R,handleFilterClick:c}}function lPe(e){const t=wt(Rl),o=lt("table");return{getHeaderRowStyle:p=>{const m=t==null?void 0:t.props.headerRowStyle;return typeof m=="function"?m.call(null,{rowIndex:p}):m},getHeaderRowClass:p=>{const m=[],_=t==null?void 0:t.props.headerRowClassName;return typeof _=="string"?m.push(_):typeof _=="function"&&m.push(_.call(null,{rowIndex:p})),m.join(" ")},getHeaderCellStyle:(p,m,_,b)=>{var S;let T=(S=t==null?void 0:t.props.headerCellStyle)!=null?S:{};typeof T=="function"&&(T=T.call(null,{rowIndex:p,columnIndex:m,row:_,column:b}));const M=n2(m,b.fixed,e.store,_);return wm(M,"left"),wm(M,"right"),Object.assign({},T,M)},getHeaderCellClass:(p,m,_,b)=>{const S=t2(o.b(),m,b.fixed,e.store,_),T=[b.id,b.order,b.headerAlign,b.className,b.labelClassName,...S];b.children||T.push("is-leaf"),b.sortable&&T.push("is-sortable");const M=t==null?void 0:t.props.headerCellClassName;return typeof M=="string"?T.push(M):typeof M=="function"&&T.push(M.call(null,{rowIndex:p,columnIndex:m,row:_,column:b})),T.push(o.e("cell")),T.filter(R=>!!R).join(" ")}}}const Zz=e=>{const t=[];return e.forEach(o=>{o.children?(t.push(o),t.push.apply(t,Zz(o.children))):t.push(o)}),t},cPe=e=>{let t=1;const o=(u,f)=>{if(f&&(u.level=f.level+1,t<u.level&&(t=u.level)),u.children){let p=0;u.children.forEach(m=>{o(m,u),p+=m.colSpan}),u.colSpan=p}else u.colSpan=1};e.forEach(u=>{u.level=1,o(u,void 0)});const i=[];for(let u=0;u<t;u++)i.push([]);return Zz(e).forEach(u=>{u.children?(u.rowSpan=1,u.children.forEach(f=>f.isSubColumn=!0)):u.rowSpan=t-u.level+1,i[u.level-1].push(u)}),i};function uPe(e){const t=wt(Rl),o=K(()=>cPe(e.store.states.originColumns.value));return{isGroup:K(()=>{const u=o.value.length>1;return u&&t&&(t.state.isGroup.value=!0),u}),toggleAllSelection:u=>{u.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:o}}var dPe=Se({name:"ElTableHeader",components:{ElCheckbox:aa},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e,{emit:t}){const o=In(),i=wt(Rl),c=lt("table"),u=ae({}),{onColumnsChange:f,onScrollableChange:p}=Qz(i);fn(async()=>{await zt(),await zt();const{prop:B,order:z}=e.defaultSort;i==null||i.store.commit("sort",{prop:B,order:z,init:!0})});const{handleHeaderClick:m,handleHeaderContextMenu:_,handleMouseDown:b,handleMouseMove:S,handleMouseOut:T,handleSortClick:M,handleFilterClick:R}=aPe(e,t),{getHeaderRowStyle:E,getHeaderRowClass:N,getHeaderCellStyle:D,getHeaderCellClass:x}=lPe(e),{isGroup:L,toggleAllSelection:F,columnRows:H}=uPe(e);return o.state={onColumnsChange:f,onScrollableChange:p},o.filterPanels=u,{ns:c,filterPanels:u,onColumnsChange:f,onScrollableChange:p,columnRows:H,getHeaderRowClass:N,getHeaderRowStyle:E,getHeaderCellClass:x,getHeaderCellStyle:D,handleHeaderClick:m,handleHeaderContextMenu:_,handleMouseDown:b,handleMouseMove:S,handleMouseOut:T,handleSortClick:M,handleFilterClick:R,isGroup:L,toggleAllSelection:F}},render(){const{ns:e,isGroup:t,columnRows:o,getHeaderCellStyle:i,getHeaderCellClass:c,getHeaderRowClass:u,getHeaderRowStyle:f,handleHeaderClick:p,handleHeaderContextMenu:m,handleMouseDown:_,handleMouseMove:b,handleSortClick:S,handleMouseOut:T,store:M,$parent:R}=this;let E=1;return Wt("thead",{class:{[e.is("group")]:t}},o.map((N,D)=>Wt("tr",{class:u(D),key:D,style:f(D)},N.map((x,L)=>(x.rowSpan>E&&(E=x.rowSpan),Wt("th",{class:c(D,L,N,x),colspan:x.colSpan,key:`${x.id}-thead`,rowspan:x.rowSpan,style:i(D,L,N,x),onClick:F=>p(F,x),onContextmenu:F=>m(F,x),onMousedown:F=>_(F,x),onMousemove:F=>b(F,x),onMouseout:T},[Wt("div",{class:["cell",x.filteredValue&&x.filteredValue.length>0?"highlight":""]},[x.renderHeader?x.renderHeader({column:x,$index:L,store:M,_self:R}):x.label,x.sortable&&Wt("span",{onClick:F=>S(F,x),class:"caret-wrapper"},[Wt("i",{onClick:F=>S(F,x,"ascending"),class:"sort-caret ascending"}),Wt("i",{onClick:F=>S(F,x,"descending"),class:"sort-caret descending"})]),x.filterable&&Wt(sPe,{store:M,placement:x.filterPlacement||"bottom-start",column:x,upDataColumn:(F,H)=>{x[F]=H}})])]))))))}});function uD(e,t,o=.01){return e-t>o}function hPe(e){const t=wt(Rl),o=ae(""),i=ae(Wt("div")),c=(R,E,N)=>{var D;const x=t,L=cD(R);let F;const H=(D=x==null?void 0:x.vnode.el)==null?void 0:D.dataset.prefix;L&&(F=e$({columns:e.store.states.columns.value},L,H),F&&(x==null||x.emit(`cell-${N}`,E,F,L,R))),x==null||x.emit(`row-${N}`,E,F,R)},u=(R,E)=>{c(R,E,"dblclick")},f=(R,E)=>{e.store.commit("setCurrentRow",E),c(R,E,"click")},p=(R,E)=>{c(R,E,"contextmenu")},m=as(R=>{e.store.commit("setHoverRow",R)},30),_=as(()=>{e.store.commit("setHoverRow",null)},30),b=R=>{const E=window.getComputedStyle(R,null),N=Number.parseInt(E.paddingLeft,10)||0,D=Number.parseInt(E.paddingRight,10)||0,x=Number.parseInt(E.paddingTop,10)||0,L=Number.parseInt(E.paddingBottom,10)||0;return{left:N,right:D,top:x,bottom:L}},S=(R,E,N)=>{let D=E.target.parentNode;for(;R>1&&(D=D==null?void 0:D.nextSibling,!(!D||D.nodeName!=="TR"));)N(D,"hover-row hover-fixed-row"),R--};return{handleDoubleClick:u,handleClick:f,handleContextMenu:p,handleMouseEnter:m,handleMouseLeave:_,handleCellMouseEnter:(R,E,N)=>{var D;const x=t,L=cD(R),F=(D=x==null?void 0:x.vnode.el)==null?void 0:D.dataset.prefix;if(L){const ee=e$({columns:e.store.states.columns.value},L,F);L.rowSpan>1&&S(L.rowSpan,R,Js);const Q=x.hoverState={cell:L,column:ee,row:E};x==null||x.emit("cell-mouse-enter",Q.row,Q.column,Q.cell,R)}if(!N)return;const H=R.target.querySelector(".cell");if(!(ea(H,`${F}-tooltip`)&&H.childNodes.length))return;const B=document.createRange();B.setStart(H,0),B.setEnd(H,H.childNodes.length);let{width:z,height:W}=B.getBoundingClientRect();const Z=z-Math.floor(z),{width:$,height:O}=H.getBoundingClientRect();Z<.001&&(z=Math.floor(z)),W-Math.floor(W)<.001&&(W=Math.floor(W));const{top:le,left:de,right:he,bottom:se}=b(H),ie=de+he,oe=le+se;(uD(z+ie,$)||uD(W+oe,O)||uD(H.scrollWidth,$))&&q2e(N,L.innerText||L.textContent,L,x)},handleCellMouseLeave:R=>{const E=cD(R);if(!E)return;E.rowSpan>1&&S(E.rowSpan,R,wi);const N=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",N==null?void 0:N.row,N==null?void 0:N.column,N==null?void 0:N.cell,R)},tooltipContent:o,tooltipTrigger:i}}function fPe(e){const t=wt(Rl),o=lt("table");return{getRowStyle:(_,b)=>{const S=t==null?void 0:t.props.rowStyle;return typeof S=="function"?S.call(null,{row:_,rowIndex:b}):S||null},getRowClass:(_,b)=>{const S=[o.e("row")];t!=null&&t.props.highlightCurrentRow&&_===e.store.states.currentRow.value&&S.push("current-row"),e.stripe&&b%2===1&&S.push(o.em("row","striped"));const T=t==null?void 0:t.props.rowClassName;return typeof T=="string"?S.push(T):typeof T=="function"&&S.push(T.call(null,{row:_,rowIndex:b})),S},getCellStyle:(_,b,S,T)=>{const M=t==null?void 0:t.props.cellStyle;let R=M??{};typeof M=="function"&&(R=M.call(null,{rowIndex:_,columnIndex:b,row:S,column:T}));const E=n2(b,e==null?void 0:e.fixed,e.store);return wm(E,"left"),wm(E,"right"),Object.assign({},R,E)},getCellClass:(_,b,S,T,M)=>{const R=t2(o.b(),b,e==null?void 0:e.fixed,e.store,void 0,M),E=[T.id,T.align,T.className,...R],N=t==null?void 0:t.props.cellClassName;return typeof N=="string"?E.push(N):typeof N=="function"&&E.push(N.call(null,{rowIndex:_,columnIndex:b,row:S,column:T})),E.push(o.e("cell")),E.filter(D=>!!D).join(" ")},getSpan:(_,b,S,T)=>{let M=1,R=1;const E=t==null?void 0:t.props.spanMethod;if(typeof E=="function"){const N=E({row:_,column:b,rowIndex:S,columnIndex:T});Array.isArray(N)?(M=N[0],R=N[1]):typeof N=="object"&&(M=N.rowspan,R=N.colspan)}return{rowspan:M,colspan:R}},getColspanRealWidth:(_,b,S)=>{if(b<1)return _[S].realWidth;const T=_.map(({realWidth:M,width:R})=>M||R).slice(S,S+b);return Number(T.reduce((M,R)=>Number(M)+Number(R),-1))}}}function pPe(e){const t=wt(Rl),o=lt("table"),{handleDoubleClick:i,handleClick:c,handleContextMenu:u,handleMouseEnter:f,handleMouseLeave:p,handleCellMouseEnter:m,handleCellMouseLeave:_,tooltipContent:b,tooltipTrigger:S}=hPe(e),{getRowStyle:T,getRowClass:M,getCellStyle:R,getCellClass:E,getSpan:N,getColspanRealWidth:D}=fPe(e),x=K(()=>e.store.states.columns.value.findIndex(({type:z})=>z==="default")),L=(z,W)=>{const Z=t.props.rowKey;return Z?di(z,Z):W},F=(z,W,Z,$=!1)=>{const{tooltipEffect:O,tooltipOptions:X,store:le}=e,{indent:de,columns:he}=le.states,se=M(z,W);let ie=!0;return Z&&(se.push(o.em("row",`level-${Z.level}`)),ie=Z.display),Wt("tr",{style:[ie?null:{display:"none"},T(z,W)],class:se,key:L(z,W),onDblclick:ee=>i(ee,z),onClick:ee=>c(ee,z),onContextmenu:ee=>u(ee,z),onMouseenter:()=>f(W),onMouseleave:p},he.value.map((ee,Q)=>{const{rowspan:ue,colspan:me}=N(z,ee,W,Q);if(!ue||!me)return null;const be=Object.assign({},ee);be.realWidth=D(he.value,me,Q);const ke={store:e.store,_self:e.context||t,column:be,row:z,$index:W,cellIndex:Q,expanded:$};Q===x.value&&Z&&(ke.treeNode={indent:Z.level*de.value,level:Z.level},typeof Z.expanded=="boolean"&&(ke.treeNode.expanded=Z.expanded,"loading"in Z&&(ke.treeNode.loading=Z.loading),"noLazyChildren"in Z&&(ke.treeNode.noLazyChildren=Z.noLazyChildren)));const Ye=`${L(z,W)},${Q}`,Oe=be.columnKey||be.rawColumnKey||"",Ee=H(Q,ee,ke),we=ee.showOverflowTooltip&&sve({effect:O},X,ee.showOverflowTooltip);return Wt("td",{style:R(W,Q,z,ee),class:E(W,Q,z,ee,me-1),key:`${Oe}${Ye}`,rowspan:ue,colspan:me,onMouseenter:Ge=>m(Ge,z,we),onMouseleave:_},[Ee])}))},H=(z,W,Z)=>W.renderCell(Z);return{wrappedRowRender:(z,W)=>{const Z=e.store,{isRowExpanded:$,assertRowKey:O}=Z,{treeData:X,lazyTreeNodeMap:le,childrenColumnName:de,rowKey:he}=Z.states,se=Z.states.columns.value;if(se.some(({type:oe})=>oe==="expand")){const oe=$(z),ee=F(z,W,void 0,oe),Q=t.renderExpanded;return oe?Q?[[ee,Wt("tr",{key:`expanded-row__${ee.key}`},[Wt("td",{colspan:se.length,class:`${o.e("cell")} ${o.e("expanded-cell")}`},[Q({row:z,$index:W,store:Z,expanded:oe})])])]]:(console.error("[Element Error]renderExpanded is required."),ee):[[ee]]}else if(Object.keys(X.value).length){O();const oe=di(z,he.value);let ee=X.value[oe],Q=null;ee&&(Q={expanded:ee.expanded,level:ee.level,display:!0},typeof ee.lazy=="boolean"&&(typeof ee.loaded=="boolean"&&ee.loaded&&(Q.noLazyChildren=!(ee.children&&ee.children.length)),Q.loading=ee.loading));const ue=[F(z,W,Q)];if(ee){let me=0;const be=(Ye,Oe)=>{Ye&&Ye.length&&Oe&&Ye.forEach(Ee=>{const we={display:Oe.display&&Oe.expanded,level:Oe.level+1,expanded:!1,noLazyChildren:!1,loading:!1},Ge=di(Ee,he.value);if(Ge==null)throw new Error("For nested data item, row-key is required.");if(ee={...X.value[Ge]},ee&&(we.expanded=ee.expanded,ee.level=ee.level||we.level,ee.display=!!(ee.expanded&&we.display),typeof ee.lazy=="boolean"&&(typeof ee.loaded=="boolean"&&ee.loaded&&(we.noLazyChildren=!(ee.children&&ee.children.length)),we.loading=ee.loading)),me++,ue.push(F(Ee,W+me,we)),ee){const Ve=le.value[Ge]||Ee[de.value];be(Ve,ee)}})};ee.display=!0;const ke=le.value[oe]||z[de.value];be(ke,ee)}return ue}else return F(z,W,void 0)},tooltipContent:b,tooltipTrigger:S}}const gPe={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var mPe=Se({name:"ElTableBody",props:gPe,setup(e){const t=In(),o=wt(Rl),i=lt("table"),{wrappedRowRender:c,tooltipContent:u,tooltipTrigger:f}=pPe(e),{onColumnsChange:p,onScrollableChange:m}=Qz(o),_=[];return rt(e.store.states.hoverRow,(b,S)=>{var T;const M=t==null?void 0:t.vnode.el,R=Array.from((M==null?void 0:M.children)||[]).filter(D=>D==null?void 0:D.classList.contains(`${i.e("row")}`));let E=b;const N=(T=R[E])==null?void 0:T.childNodes;if(N!=null&&N.length){let D=0;Array.from(N).reduce((L,F,H)=>{var B,z;return((B=N[H])==null?void 0:B.colSpan)>1&&(D=(z=N[H])==null?void 0:z.colSpan),F.nodeName!=="TD"&&D===0&&L.push(H),D>0&&D--,L},[]).forEach(L=>{var F;for(E=b;E>0;){const H=(F=R[E-1])==null?void 0:F.childNodes;if(H[L]&&H[L].nodeName==="TD"&&H[L].rowSpan>1){Js(H[L],"hover-cell"),_.push(H[L]);break}E--}})}else _.forEach(D=>wi(D,"hover-cell")),_.length=0;!e.store.states.isComplex.value||!$n||_d(()=>{const D=R[S],x=R[b];D&&!D.classList.contains("hover-fixed-row")&&wi(D,"hover-row"),x&&Js(x,"hover-row")})}),Md(()=>{var b;(b=Hs)==null||b()}),{ns:i,onColumnsChange:p,onScrollableChange:m,wrappedRowRender:c,tooltipContent:u,tooltipTrigger:f}},render(){const{wrappedRowRender:e,store:t}=this,o=t.states.data.value||[];return Wt("tbody",{tabIndex:-1},[o.reduce((i,c)=>i.concat(e(c,i.length)),[])])}});function vPe(){const e=wt(Rl),t=e==null?void 0:e.store,o=K(()=>t.states.fixedLeafColumnsLength.value),i=K(()=>t.states.rightFixedColumns.value.length),c=K(()=>t.states.columns.value.length),u=K(()=>t.states.fixedColumns.value.length),f=K(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:o,rightFixedLeafCount:i,columnsCount:c,leftFixedCount:u,rightFixedCount:f,columns:t.states.columns}}function _Pe(e){const{columns:t}=vPe(),o=lt("table");return{getCellClasses:(u,f)=>{const p=u[f],m=[o.e("cell"),p.id,p.align,p.labelClassName,...t2(o.b(),f,p.fixed,e.store)];return p.className&&m.push(p.className),p.children||m.push(o.is("leaf")),m},getCellStyles:(u,f)=>{const p=n2(f,u.fixed,e.store);return wm(p,"left"),wm(p,"right"),p},columns:t}}var yPe=Se({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:o,columns:i}=_Pe(e);return{ns:lt("table"),getCellClasses:t,getCellStyles:o,columns:i}},render(){const{columns:e,getCellStyles:t,getCellClasses:o,summaryMethod:i,sumText:c}=this,u=this.store.states.data.value;let f=[];return i?f=i({columns:e,data:u}):e.forEach((p,m)=>{if(m===0){f[m]=c;return}const _=u.map(M=>Number(M[p.property])),b=[];let S=!0;_.forEach(M=>{if(!Number.isNaN(+M)){S=!1;const R=`${M}`.split(".")[1];b.push(R?R.length:0)}});const T=Math.max.apply(null,b);S?f[m]="":f[m]=_.reduce((M,R)=>{const E=Number(R);return Number.isNaN(+E)?M:Number.parseFloat((M+R).toFixed(Math.min(T,20)))},0)}),Wt(Wt("tfoot",[Wt("tr",{},[...e.map((p,m)=>Wt("td",{key:m,colspan:p.colSpan,rowspan:p.rowSpan,class:o(e,m),style:t(p,m)},[Wt("div",{class:["cell",p.labelClassName]},[f[m]])]))])]))}});function IPe(e){return{setCurrentRow:b=>{e.commit("setCurrentRow",b)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(b,S)=>{e.toggleRowSelection(b,S,!1),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:b=>{e.clearFilter(b)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(b,S)=>{e.toggleRowExpansionAdapter(b,S)},clearSort:()=>{e.clearSort()},sort:(b,S)=>{e.commit("sort",{prop:b,order:S})}}}function bPe(e,t,o,i){const c=ae(!1),u=ae(null),f=ae(!1),p=ee=>{f.value=ee},m=ae({width:null,height:null,headerHeight:null}),_=ae(!1),b={display:"inline-block",verticalAlign:"middle"},S=ae(),T=ae(0),M=ae(0),R=ae(0),E=ae(0),N=ae(0);hi(()=>{t.setHeight(e.height)}),hi(()=>{t.setMaxHeight(e.maxHeight)}),rt(()=>[e.currentRowKey,o.states.rowKey],([ee,Q])=>{!y(Q)||!y(ee)||o.setCurrentRowKey(`${ee}`)},{immediate:!0}),rt(()=>e.data,ee=>{i.store.commit("setData",ee)},{immediate:!0,deep:!0}),hi(()=>{e.expandRowKeys&&o.setExpandRowKeysAdapter(e.expandRowKeys)});const D=()=>{i.store.commit("setHoverRow",null),i.hoverState&&(i.hoverState=null)},x=(ee,Q)=>{const{pixelX:ue,pixelY:me}=Q;Math.abs(ue)>=Math.abs(me)&&(i.refs.bodyWrapper.scrollLeft+=Q.pixelX/5)},L=K(()=>e.height||e.maxHeight||o.states.fixedColumns.value.length>0||o.states.rightFixedColumns.value.length>0),F=K(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),H=()=>{L.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(Z)};fn(async()=>{await zt(),o.updateColumns(),$(),requestAnimationFrame(H);const ee=i.vnode.el,Q=i.refs.headerWrapper;e.flexible&&ee&&ee.parentElement&&(ee.parentElement.style.minWidth="0"),m.value={width:S.value=ee.offsetWidth,height:ee.offsetHeight,headerHeight:e.showHeader&&Q?Q.offsetHeight:null},o.states.columns.value.forEach(ue=>{ue.filteredValue&&ue.filteredValue.length&&i.store.commit("filterChange",{column:ue,values:ue.filteredValue,silent:!0})}),i.$ready=!0});const B=(ee,Q)=>{if(!ee)return;const ue=Array.from(ee.classList).filter(me=>!me.startsWith("is-scrolling-"));ue.push(t.scrollX.value?Q:"is-scrolling-none"),ee.className=ue.join(" ")},z=ee=>{const{tableWrapper:Q}=i.refs;B(Q,ee)},W=ee=>{const{tableWrapper:Q}=i.refs;return!!(Q&&Q.classList.contains(ee))},Z=function(){if(!i.refs.scrollBarRef)return;if(!t.scrollX.value){const Oe="is-scrolling-none";W(Oe)||z(Oe);return}const ee=i.refs.scrollBarRef.wrapRef;if(!ee)return;const{scrollLeft:Q,offsetWidth:ue,scrollWidth:me}=ee,{headerWrapper:be,footerWrapper:ke}=i.refs;be&&(be.scrollLeft=Q),ke&&(ke.scrollLeft=Q);const Ye=me-ue-1;Q>=Ye?z("is-scrolling-right"):z(Q===0?"is-scrolling-left":"is-scrolling-middle")},$=()=>{i.refs.scrollBarRef&&(i.refs.scrollBarRef.wrapRef&&Oo(i.refs.scrollBarRef.wrapRef,"scroll",Z,{passive:!0}),e.fit?Ko(i.vnode.el,O):Oo(window,"resize",O),Ko(i.refs.bodyWrapper,()=>{var ee,Q;O(),(Q=(ee=i.refs)==null?void 0:ee.scrollBarRef)==null||Q.update()}))},O=()=>{var ee,Q,ue,me;const be=i.vnode.el;if(!i.$ready||!be)return;let ke=!1;const{width:Ye,height:Oe,headerHeight:Ee}=m.value,we=S.value=be.offsetWidth;Ye!==we&&(ke=!0);const Ge=be.offsetHeight;(e.height||L.value)&&Oe!==Ge&&(ke=!0);const Ve=e.tableLayout==="fixed"?i.refs.headerWrapper:(ee=i.refs.tableHeaderRef)==null?void 0:ee.$el;e.showHeader&&(Ve==null?void 0:Ve.offsetHeight)!==Ee&&(ke=!0),T.value=((Q=i.refs.tableWrapper)==null?void 0:Q.scrollHeight)||0,R.value=(Ve==null?void 0:Ve.scrollHeight)||0,E.value=((ue=i.refs.footerWrapper)==null?void 0:ue.offsetHeight)||0,N.value=((me=i.refs.appendWrapper)==null?void 0:me.offsetHeight)||0,M.value=T.value-R.value-E.value-N.value,ke&&(m.value={width:we,height:Ge,headerHeight:e.showHeader&&(Ve==null?void 0:Ve.offsetHeight)||0},H())},X=Tr(),le=K(()=>{const{bodyWidth:ee,scrollY:Q,gutterWidth:ue}=t;return ee.value?`${ee.value-(Q.value?ue:0)}px`:""}),de=K(()=>e.maxHeight?"fixed":e.tableLayout),he=K(()=>{if(e.data&&e.data.length)return null;let ee="100%";e.height&&M.value&&(ee=`${M.value}px`);const Q=S.value;return{width:Q?`${Q}px`:"",height:ee}}),se=K(()=>e.height?{height:Number.isNaN(Number(e.height))?e.height:`${e.height}px`}:e.maxHeight?{maxHeight:Number.isNaN(Number(e.maxHeight))?e.maxHeight:`${e.maxHeight}px`}:{}),ie=K(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${R.value+E.value}px)`}:{maxHeight:`${e.maxHeight-R.value-E.value}px`}:{});return{isHidden:c,renderExpanded:u,setDragVisible:p,isGroup:_,handleMouseLeave:D,handleHeaderFooterMousewheel:x,tableSize:X,emptyBlockStyle:he,handleFixedMousewheel:(ee,Q)=>{const ue=i.refs.bodyWrapper;if(Math.abs(Q.spinY)>0){const me=ue.scrollTop;Q.pixelY<0&&me!==0&&ee.preventDefault(),Q.pixelY>0&&ue.scrollHeight-ue.clientHeight>me&&ee.preventDefault(),ue.scrollTop+=Math.ceil(Q.pixelY/5)}else ue.scrollLeft+=Math.ceil(Q.pixelX/5)},resizeProxyVisible:f,bodyWidth:le,resizeState:m,doLayout:H,tableBodyStyles:F,tableLayout:de,scrollbarViewStyle:b,tableInnerStyle:se,scrollbarStyle:ie}}function CPe(e){const t=ae(),o=()=>{const c=e.vnode.el.querySelector(".hidden-columns"),u={childList:!0,subtree:!0},f=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{f.forEach(p=>p())}),t.value.observe(c,u)};fn(()=>{o()}),Md(()=>{var i;(i=t.value)==null||i.disconnect()})}var SPe={data:{type:Array,default:()=>[]},size:Nr,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object]};function eW(e){const t=e.tableLayout==="auto";let o=e.columns||[];t&&o.every(c=>c.width===void 0)&&(o=[]);const i=c=>{const u={key:`${e.tableLayout}_${c.id}`,style:{},name:void 0};return t?u.style={width:`${c.width}px`}:u.name=c.id,u};return Wt("colgroup",{},o.map(c=>Wt("col",i(c))))}eW.props=["columns","tableLayout"];const TPe=()=>{const e=ae(),t=(u,f)=>{const p=e.value;p&&p.scrollTo(u,f)},o=(u,f)=>{const p=e.value;p&&Zt(f)&&["Top","Left"].includes(u)&&p[`setScroll${u}`](f)};return{scrollBarRef:e,scrollTo:t,setScrollTop:u=>o("Top",u),setScrollLeft:u=>o("Left",u)}};let EPe=1;const MPe=Se({name:"ElTable",directives:{Mousewheel:uTe},components:{TableHeader:dPe,TableBody:mPe,TableFooter:yPe,ElScrollbar:xc,hColgroup:eW},props:SPe,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(e){const{t}=Kn(),o=lt("table"),i=In();Ln(Rl,i);const c=X2e(i,e);i.store=c;const u=new Z2e({store:i.store,table:i,fit:e.fit,showHeader:e.showHeader});i.layout=u;const f=K(()=>(c.states.data.value||[]).length===0),{setCurrentRow:p,getSelectionRows:m,toggleRowSelection:_,clearSelection:b,clearFilter:S,toggleAllSelection:T,toggleRowExpansion:M,clearSort:R,sort:E}=IPe(c),{isHidden:N,renderExpanded:D,setDragVisible:x,isGroup:L,handleMouseLeave:F,handleHeaderFooterMousewheel:H,tableSize:B,emptyBlockStyle:z,handleFixedMousewheel:W,resizeProxyVisible:Z,bodyWidth:$,resizeState:O,doLayout:X,tableBodyStyles:le,tableLayout:de,scrollbarViewStyle:he,tableInnerStyle:se,scrollbarStyle:ie}=bPe(e,u,c,i),{scrollBarRef:oe,scrollTo:ee,setScrollLeft:Q,setScrollTop:ue}=TPe(),me=as(X,50),be=`${o.namespace.value}-table_${EPe++}`;i.tableId=be,i.state={isGroup:L,resizeState:O,doLayout:X,debouncedUpdateLayout:me};const ke=K(()=>e.sumText||t("el.table.sumText")),Ye=K(()=>e.emptyText||t("el.table.emptyText"));return CPe(i),{ns:o,layout:u,store:c,handleHeaderFooterMousewheel:H,handleMouseLeave:F,tableId:be,tableSize:B,isHidden:N,isEmpty:f,renderExpanded:D,resizeProxyVisible:Z,resizeState:O,isGroup:L,bodyWidth:$,tableBodyStyles:le,emptyBlockStyle:z,debouncedUpdateLayout:me,handleFixedMousewheel:W,setCurrentRow:p,getSelectionRows:m,toggleRowSelection:_,clearSelection:b,clearFilter:S,toggleAllSelection:T,toggleRowExpansion:M,clearSort:R,doLayout:X,sort:E,t,setDragVisible:x,context:i,computedSumText:ke,computedEmptyText:Ye,tableLayout:de,scrollbarViewStyle:he,tableInnerStyle:se,scrollbarStyle:ie,scrollBarRef:oe,scrollTo:ee,setScrollLeft:Q,setScrollTop:ue}}}),kPe=["data-prefix"],APe={ref:"hiddenColumns",class:"hidden-columns"};function RPe(e,t,o,i,c,u){const f=pn("hColgroup"),p=pn("table-header"),m=pn("table-body"),_=pn("table-footer"),b=pn("el-scrollbar"),S=KE("mousewheel");return J(),ge("div",{ref:"tableWrapper",class:ne([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:Ht(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:t[0]||(t[0]=(...T)=>e.handleMouseLeave&&e.handleMouseLeave(...T))},[Ce("div",{class:ne(e.ns.e("inner-wrapper")),style:Ht(e.tableInnerStyle)},[Ce("div",APe,[We(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?hn((J(),ge("div",{key:0,ref:"headerWrapper",class:ne(e.ns.e("header-wrapper"))},[Ce("table",{ref:"tableHeader",class:ne(e.ns.e("header")),style:Ht(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Me(p,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[S,e.handleHeaderFooterMousewheel]]):Fe("v-if",!0),Ce("div",{ref:"bodyWrapper",class:ne(e.ns.e("body-wrapper"))},[Me(b,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn},{default:Ne(()=>[Ce("table",{ref:"tableBody",class:ne(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:Ht({width:e.bodyWidth,tableLayout:e.tableLayout})},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(J(),He(p,{key:0,ref:"tableHeaderRef",class:ne(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","onSetDragVisible"])):Fe("v-if",!0),Me(m,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(J(),He(_,{key:1,class:ne(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):Fe("v-if",!0)],6),e.isEmpty?(J(),ge("div",{key:0,ref:"emptyBlock",style:Ht(e.emptyBlockStyle),class:ne(e.ns.e("empty-block"))},[Ce("span",{class:ne(e.ns.e("empty-text"))},[We(e.$slots,"empty",{},()=>[On(pt(e.computedEmptyText),1)])],2)],6)):Fe("v-if",!0),e.$slots.append?(J(),ge("div",{key:1,ref:"appendWrapper",class:ne(e.ns.e("append-wrapper"))},[We(e.$slots,"append")],2)):Fe("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),e.showSummary&&e.tableLayout==="fixed"?hn((J(),ge("div",{key:1,ref:"footerWrapper",class:ne(e.ns.e("footer-wrapper"))},[Ce("table",{class:ne(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:Ht(e.tableBodyStyles)},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Me(_,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[Jn,!e.isEmpty],[S,e.handleHeaderFooterMousewheel]]):Fe("v-if",!0),e.border||e.isGroup?(J(),ge("div",{key:2,class:ne(e.ns.e("border-left-patch"))},null,2)):Fe("v-if",!0)],6),hn(Ce("div",{ref:"resizeProxy",class:ne(e.ns.e("column-resize-proxy"))},null,2),[[Jn,e.resizeProxyVisible]])],46,kPe)}var wPe=vt(MPe,[["render",RPe],["__file","table.vue"]]);const DPe={selection:"table-column--selection",expand:"table__expand-column"},OPe={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},NPe=e=>DPe[e]||"",LPe={selection:{renderHeader({store:e,column:t}){function o(){return e.states.data.value&&e.states.data.value.length===0}return Wt(aa,{disabled:o(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:o,$index:i}){return Wt(aa,{disabled:t.selectable?!t.selectable.call(null,e,i):!1,size:o.states.tableSize.value,onChange:()=>{o.commit("rowSelectedChanged",e)},onClick:c=>c.stopPropagation(),modelValue:o.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let o=t+1;const i=e.index;return typeof i=="number"?o=t+i:typeof i=="function"&&(o=i(t)),Wt("div",{},[o])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:o}){const{ns:i}=t,c=[i.e("expand-icon")];return o&&c.push(i.em("expand-icon","expanded")),Wt("div",{class:c,onClick:function(f){f.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Wt(Gt,null,{default:()=>[Wt($i)]})]})},sortable:!1,resizable:!1}};function PPe({row:e,column:t,$index:o}){var i;const c=t.property,u=c&&NT(e,c).value;return t&&t.formatter?t.formatter(e,t,u,o):((i=u==null?void 0:u.toString)==null?void 0:i.call(u))||""}function UPe({row:e,treeNode:t,store:o},i=!1){const{ns:c}=o;if(!t)return i?[Wt("span",{class:c.e("placeholder")})]:null;const u=[],f=function(p){p.stopPropagation(),!t.loading&&o.loadOrToggle(e)};if(t.indent&&u.push(Wt("span",{class:c.e("indent"),style:{"padding-left":`${t.indent}px`}})),typeof t.expanded=="boolean"&&!t.noLazyChildren){const p=[c.e("expand-icon"),t.expanded?c.em("expand-icon","expanded"):""];let m=$i;t.loading&&(m=Rd),u.push(Wt("div",{class:p,onClick:f},{default:()=>[Wt(Gt,{class:{[c.is("loading")]:t.loading}},{default:()=>[Wt(m)]})]}))}else u.push(Wt("span",{class:c.e("placeholder")}));return u}function o$(e,t){return e.reduce((o,i)=>(o[i]=i,o),t)}function xPe(e,t){const o=In();return{registerComplexWatchers:()=>{const u=["fixed"],f={realWidth:"width",realMinWidth:"minWidth"},p=o$(u,f);Object.keys(p).forEach(m=>{const _=f[m];qn(t,_)&&rt(()=>t[_],b=>{let S=b;_==="width"&&m==="realWidth"&&(S=e2(b)),_==="minWidth"&&m==="realMinWidth"&&(S=Wz(b)),o.columnConfig.value[_]=S,o.columnConfig.value[m]=S;const T=_==="fixed";e.value.store.scheduleLayout(T)})})},registerNormalWatchers:()=>{const u=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],f={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},p=o$(u,f);Object.keys(p).forEach(m=>{const _=f[m];qn(t,_)&&rt(()=>t[_],b=>{o.columnConfig.value[m]=b})})}}}function FPe(e,t,o){const i=In(),c=ae(""),u=ae(!1),f=ae(),p=ae(),m=lt("table");hi(()=>{f.value=e.align?`is-${e.align}`:null,f.value}),hi(()=>{p.value=e.headerAlign?`is-${e.headerAlign}`:f.value,p.value});const _=K(()=>{let F=i.vnode.vParent||i.parent;for(;F&&!F.tableId&&!F.columnId;)F=F.vnode.vParent||F.parent;return F}),b=K(()=>{const{store:F}=i.parent;if(!F)return!1;const{treeData:H}=F.states,B=H.value;return B&&Object.keys(B).length>0}),S=ae(e2(e.width)),T=ae(Wz(e.minWidth)),M=F=>(S.value&&(F.width=S.value),T.value&&(F.minWidth=T.value),!S.value&&T.value&&(F.width=void 0),F.minWidth||(F.minWidth=80),F.realWidth=Number(F.width===void 0?F.minWidth:F.width),F),R=F=>{const H=F.type,B=LPe[H]||{};Object.keys(B).forEach(W=>{const Z=B[W];W!=="className"&&Z!==void 0&&(F[W]=Z)});const z=NPe(H);if(z){const W=`${y(m.namespace)}-${z}`;F.className=F.className?`${F.className} ${W}`:W}return F},E=F=>{Array.isArray(F)?F.forEach(B=>H(B)):H(F);function H(B){var z;((z=B==null?void 0:B.type)==null?void 0:z.name)==="ElTableColumn"&&(B.vParent=i)}};return{columnId:c,realAlign:f,isSubColumn:u,realHeaderAlign:p,columnOrTableParent:_,setColumnWidth:M,setColumnForcedProps:R,setColumnRenders:F=>{e.renderHeader||F.type!=="selection"&&(F.renderHeader=B=>(i.columnConfig.value.label,We(t,"header",B,()=>[F.label])));let H=F.renderCell;return F.type==="expand"?(F.renderCell=B=>Wt("div",{class:"cell"},[H(B)]),o.value.renderExpanded=B=>t.default?t.default(B):t.default):(H=H||PPe,F.renderCell=B=>{let z=null;if(t.default){const le=t.default(B);z=le.some(de=>de.type!==Mi)?le:H(B)}else z=H(B);const{columns:W}=o.value.store.states,Z=W.value.findIndex(le=>le.type==="default"),$=b.value&&B.cellIndex===Z,O=UPe(B,$),X={class:"cell",style:{}};return F.showOverflowTooltip&&(X.class=`${X.class} ${y(m.namespace)}-tooltip`,X.style={width:`${(B.column.realWidth||Number(B.column.width))-1}px`}),E(z),Wt("div",X,[O,z])}),F},getPropsData:(...F)=>F.reduce((H,B)=>(Array.isArray(B)&&B.forEach(z=>{H[z]=e[z]}),H),{}),getColumnElIndex:(F,H)=>Array.prototype.indexOf.call(F,H),updateColumnOrder:()=>{o.value.store.commit("updateColumnOrder",i.columnConfig.value)}}}var VPe={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let GPe=1;var tW=Se({name:"ElTableColumn",components:{ElCheckbox:aa},props:VPe,setup(e,{slots:t}){const o=In(),i=ae({}),c=K(()=>{let L=o.parent;for(;L&&!L.tableId;)L=L.parent;return L}),{registerNormalWatchers:u,registerComplexWatchers:f}=xPe(c,e),{columnId:p,isSubColumn:m,realHeaderAlign:_,columnOrTableParent:b,setColumnWidth:S,setColumnForcedProps:T,setColumnRenders:M,getPropsData:R,getColumnElIndex:E,realAlign:N,updateColumnOrder:D}=FPe(e,t,c),x=b.value;p.value=`${x.tableId||x.columnId}_column_${GPe++}`,jE(()=>{m.value=c.value!==x;const L=e.type||"default",F=e.sortable===""?!0:e.sortable,H=_r(e.showOverflowTooltip)?x.props.showOverflowTooltip:e.showOverflowTooltip,B={...OPe[L],id:p.value,type:L,property:e.prop||e.property,align:N,headerAlign:_,showOverflowTooltip:H,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:F,index:e.index,rawColumnKey:o.vnode.key};let O=R(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);O=G2e(B,O),O=$2e(M,S,T)(O),i.value=O,u(),f()}),fn(()=>{var L;const F=b.value,H=m.value?F.vnode.el.children:(L=F.refs.hiddenColumns)==null?void 0:L.children,B=()=>E(H||[],o.vnode.el);i.value.getColumnIndex=B,B()>-1&&c.value.store.commit("insertColumn",i.value,m.value?F.columnConfig.value:null,D)}),Ro(()=>{i.value.getColumnIndex()>-1&&c.value.store.commit("removeColumn",i.value,m.value?x.columnConfig.value:null,D)}),o.columnId=p.value,o.columnConfig=i},render(){var e,t,o;try{const i=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),c=[];if(Array.isArray(i))for(const f of i)((o=f.type)==null?void 0:o.name)==="ElTableColumn"||f.shapeFlag&2?c.push(f):f.type===qt&&Array.isArray(f.children)&&f.children.forEach(p=>{(p==null?void 0:p.patchFlag)!==1024&&!on(p==null?void 0:p.children)&&c.push(p)});return Wt("div",c)}catch{return Wt("div",[])}}});const BPe=bn(wPe,{TableColumn:tW}),$Pe=Wo(tW);var Q0=(e=>(e.ASC="asc",e.DESC="desc",e))(Q0||{}),Z0=(e=>(e.CENTER="center",e.RIGHT="right",e))(Z0||{}),nW=(e=>(e.LEFT="left",e.RIGHT="right",e))(nW||{});const xO={asc:"desc",desc:"asc"},eI=Symbol("placeholder"),HPe=(e,t,o)=>{var i;const c={flexGrow:0,flexShrink:0,...o?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};o||(c.flexShrink=1);const u={...(i=e.style)!=null?i:{},...c,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(u.maxWidth=e.maxWidth),e.minWidth&&(u.minWidth=e.minWidth)),u};function qPe(e,t,o){const i=K(()=>y(t).filter(E=>!E.hidden)),c=K(()=>y(i).filter(E=>E.fixed==="left"||E.fixed===!0)),u=K(()=>y(i).filter(E=>E.fixed==="right")),f=K(()=>y(i).filter(E=>!E.fixed)),p=K(()=>{const E=[];return y(c).forEach(N=>{E.push({...N,placeholderSign:eI})}),y(f).forEach(N=>{E.push(N)}),y(u).forEach(N=>{E.push({...N,placeholderSign:eI})}),E}),m=K(()=>y(c).length||y(u).length),_=K(()=>y(t).reduce((N,D)=>(N[D.key]=HPe(D,y(o),e.fixed),N),{})),b=K(()=>y(i).reduce((E,N)=>E+N.width,0)),S=E=>y(t).find(N=>N.key===E),T=E=>y(_)[E],M=(E,N)=>{E.width=N};function R(E){var N;const{key:D}=E.currentTarget.dataset;if(!D)return;const{sortState:x,sortBy:L}=e;let F=Q0.ASC;En(x)?F=xO[x[D]]:F=xO[L.order],(N=e.onColumnSort)==null||N.call(e,{column:S(D),key:D,order:F})}return{columns:t,columnsStyles:_,columnsTotalWidth:b,fixedColumnsOnLeft:c,fixedColumnsOnRight:u,hasFixedColumns:m,mainColumns:p,normalColumns:f,visibleColumns:i,getColumn:S,getColumnStyle:T,updateColumnWidth:M,onColumnSorted:R}}const KPe=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,onMaybeEndReached:c})=>{const u=ae({scrollLeft:0,scrollTop:0});function f(M){var R,E,N;const{scrollTop:D}=M;(R=t.value)==null||R.scrollTo(M),(E=o.value)==null||E.scrollToTop(D),(N=i.value)==null||N.scrollToTop(D)}function p(M){u.value=M,f(M)}function m(M){u.value.scrollTop=M,f(y(u))}function _(M){var R,E;u.value.scrollLeft=M,(E=(R=t.value)==null?void 0:R.scrollTo)==null||E.call(R,y(u))}function b(M){var R;p(M),(R=e.onScroll)==null||R.call(e,M)}function S({scrollTop:M}){const{scrollTop:R}=y(u);M!==R&&m(M)}function T(M,R="auto"){var E;(E=t.value)==null||E.scrollToRow(M,R)}return rt(()=>y(u).scrollTop,(M,R)=>{M>R&&c()}),{scrollPos:u,scrollTo:p,scrollToLeft:_,scrollToTop:m,scrollToRow:T,onScroll:b,onVerticalScroll:S}},zPe=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,tableInstance:c,ns:u,isScrolling:f})=>{const p=In(),{emit:m}=p,_=Do(!1),b=ae(e.defaultExpandedRowKeys||[]),S=ae(-1),T=Do(null),M=ae({}),R=ae({}),E=Do({}),N=Do({}),D=Do({}),x=K(()=>Zt(e.estimatedRowHeight));function L($){var O;(O=e.onRowsRendered)==null||O.call(e,$),$.rowCacheEnd>y(S)&&(S.value=$.rowCacheEnd)}function F({hovered:$,rowKey:O}){if(f.value)return;c.vnode.el.querySelectorAll(`[rowkey=${O}]`).forEach(de=>{$?de.classList.add(u.is("hovered")):de.classList.remove(u.is("hovered"))})}function H({expanded:$,rowData:O,rowIndex:X,rowKey:le}){var de,he;const se=[...y(b)],ie=se.indexOf(le);$?ie===-1&&se.push(le):ie>-1&&se.splice(ie,1),b.value=se,m("update:expandedRowKeys",se),(de=e.onRowExpand)==null||de.call(e,{expanded:$,rowData:O,rowIndex:X,rowKey:le}),(he=e.onExpandedRowsChange)==null||he.call(e,se)}const B=as(()=>{var $,O,X,le;_.value=!0,M.value={...y(M),...y(R)},z(y(T),!1),R.value={},T.value=null,($=t.value)==null||$.forceUpdate(),(O=o.value)==null||O.forceUpdate(),(X=i.value)==null||X.forceUpdate(),(le=p.proxy)==null||le.$forceUpdate(),_.value=!1},0);function z($,O=!1){y(x)&&[t,o,i].forEach(X=>{const le=y(X);le&&le.resetAfterRowIndex($,O)})}function W($,O,X){const le=y(T);(le===null||le>X)&&(T.value=X),R.value[$]=O}function Z({rowKey:$,height:O,rowIndex:X},le){le?le===nW.RIGHT?D.value[$]=O:E.value[$]=O:N.value[$]=O;const de=Math.max(...[E,D,N].map(he=>he.value[$]||0));y(M)[$]!==de&&(W($,de,X),B())}return{expandedRowKeys:b,lastRenderedRowIndex:S,isDynamic:x,isResetting:_,rowHeights:M,resetAfterIndex:z,onRowExpanded:H,onRowHovered:F,onRowsRendered:L,onRowHeightChange:Z}},WPe=(e,{expandedRowKeys:t,lastRenderedRowIndex:o,resetAfterIndex:i})=>{const c=ae({}),u=K(()=>{const p={},{data:m,rowKey:_}=e,b=y(t);if(!b||!b.length)return m;const S=[],T=new Set;b.forEach(R=>T.add(R));let M=m.slice();for(M.forEach(R=>p[R[_]]=0);M.length>0;){const R=M.shift();S.push(R),T.has(R[_])&&Array.isArray(R.children)&&R.children.length>0&&(M=[...R.children,...M],R.children.forEach(E=>p[E[_]]=p[R[_]]+1))}return c.value=p,S}),f=K(()=>{const{data:p,expandColumnKey:m}=e;return m?y(u):p});return rt(f,(p,m)=>{p!==m&&(o.value=-1,i(0,!0))}),{data:f,depthMap:c}},jPe=(e,t)=>e+t,jT=e=>At(e)?e.reduce(jPe,0):e,ep=(e,t,o={})=>tn(e)?e(t):e??o,sd=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=Xo(e[t])}),e),oW=e=>$o(e)?t=>Wt(e,t):e,YPe=(e,{columnsTotalWidth:t,data:o,fixedColumnsOnLeft:i,fixedColumnsOnRight:c})=>{const u=K(()=>{const{fixed:L,width:F,vScrollbarSize:H}=e,B=F-H;return L?Math.max(Math.round(y(t)),B):B}),f=K(()=>y(u)+e.vScrollbarSize),p=K(()=>{const{height:L=0,maxHeight:F=0,footerHeight:H,hScrollbarSize:B}=e;if(F>0){const z=y(R),W=y(m),$=y(M)+z+W+B;return Math.min($,F-H)}return L-H}),m=K(()=>{const{rowHeight:L,estimatedRowHeight:F}=e,H=y(o);return Zt(F)?H.length*F:H.length*L}),_=K(()=>{const{maxHeight:L}=e,F=y(p);if(Zt(L)&&L>0)return F;const H=y(m)+y(M)+y(R);return Math.min(F,H)}),b=L=>L.width,S=K(()=>jT(y(i).map(b))),T=K(()=>jT(y(c).map(b))),M=K(()=>jT(e.headerHeight)),R=K(()=>{var L;return(((L=e.fixedData)==null?void 0:L.length)||0)*e.rowHeight}),E=K(()=>y(p)-y(M)-y(R)),N=K(()=>{const{style:L={},height:F,width:H}=e;return sd({...L,height:F,width:H})}),D=K(()=>sd({height:e.footerHeight})),x=K(()=>({top:Xo(y(M)),bottom:Xo(e.footerHeight),width:Xo(e.width)}));return{bodyWidth:u,fixedTableHeight:_,mainTableHeight:p,leftTableWidth:S,rightTableWidth:T,headerWidth:f,rowsHeight:m,windowHeight:E,footerHeight:D,emptyStyle:x,rootStyle:N,headerHeight:M}},JPe=e=>{const t=ae(),o=ae(0),i=ae(0);let c;return fn(()=>{c=Ko(t,([u])=>{const{width:f,height:p}=u.contentRect,{paddingLeft:m,paddingRight:_,paddingTop:b,paddingBottom:S}=getComputedStyle(u.target),T=Number.parseInt(m)||0,M=Number.parseInt(_)||0,R=Number.parseInt(b)||0,E=Number.parseInt(S)||0;o.value=f-T-M,i.value=p-R-E}).stop}),Ro(()=>{c==null||c()}),rt([o,i],([u,f])=>{var p;(p=e.onResize)==null||p.call(e,{width:u,height:f})}),{sizer:t,width:o,height:i}};function XPe(e){const t=ae(),o=ae(),i=ae(),{columns:c,columnsStyles:u,columnsTotalWidth:f,fixedColumnsOnLeft:p,fixedColumnsOnRight:m,hasFixedColumns:_,mainColumns:b,onColumnSorted:S}=qPe(e,Io(e,"columns"),Io(e,"fixed")),{scrollTo:T,scrollToLeft:M,scrollToTop:R,scrollToRow:E,onScroll:N,onVerticalScroll:D,scrollPos:x}=KPe(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,onMaybeEndReached:Ie}),L=lt("table-v2"),F=In(),H=Do(!1),{expandedRowKeys:B,lastRenderedRowIndex:z,isDynamic:W,isResetting:Z,rowHeights:$,resetAfterIndex:O,onRowExpanded:X,onRowHeightChange:le,onRowHovered:de,onRowsRendered:he}=zPe(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,tableInstance:F,ns:L,isScrolling:H}),{data:se,depthMap:ie}=WPe(e,{expandedRowKeys:B,lastRenderedRowIndex:z,resetAfterIndex:O}),{bodyWidth:oe,fixedTableHeight:ee,mainTableHeight:Q,leftTableWidth:ue,rightTableWidth:me,headerWidth:be,rowsHeight:ke,windowHeight:Ye,footerHeight:Oe,emptyStyle:Ee,rootStyle:we,headerHeight:Ge}=YPe(e,{columnsTotalWidth:f,data:se,fixedColumnsOnLeft:p,fixedColumnsOnRight:m}),Ve=ae(),qe=K(()=>{const Ae=y(se).length===0;return At(e.fixedData)?e.fixedData.length===0&&Ae:Ae});function st(Ae){const{estimatedRowHeight:xe,rowHeight:ot,rowKey:je}=e;return xe?y($)[y(se)[Ae][je]]||xe:ot}function Ie(){const{onEndReached:Ae}=e;if(!Ae)return;const{scrollTop:xe}=y(x),ot=y(ke),je=y(Ye),at=ot-(xe+je)+e.hScrollbarSize;y(z)>=0&&ot===xe+y(Q)-y(Ge)&&Ae(at)}return rt(()=>e.expandedRowKeys,Ae=>B.value=Ae,{deep:!0}),{columns:c,containerRef:Ve,mainTableRef:t,leftTableRef:o,rightTableRef:i,isDynamic:W,isResetting:Z,isScrolling:H,hasFixedColumns:_,columnsStyles:u,columnsTotalWidth:f,data:se,expandedRowKeys:B,depthMap:ie,fixedColumnsOnLeft:p,fixedColumnsOnRight:m,mainColumns:b,bodyWidth:oe,emptyStyle:Ee,rootStyle:we,headerWidth:be,footerHeight:Oe,mainTableHeight:Q,fixedTableHeight:ee,leftTableWidth:ue,rightTableWidth:me,showEmpty:qe,getRowHeight:st,onColumnSorted:S,onRowHovered:de,onRowExpanded:X,onRowsRendered:he,onRowHeightChange:le,scrollTo:T,scrollToLeft:M,scrollToTop:R,scrollToRow:E,onScroll:N,onVerticalScroll:D}}const o2=Symbol("tableV2"),rW=String,SI={type:Le(Array),required:!0},r2={type:Le(Array)},iW={...r2,required:!0},QPe=String,r$={type:Le(Array),default:()=>zo([])},yf={type:Number,required:!0},sW={type:Le([String,Number,Symbol]),default:"id"},i$={type:Le(Object)},xf=gt({class:String,columns:SI,columnsStyles:{type:Le(Object),required:!0},depth:Number,expandColumnKey:QPe,estimatedRowHeight:{...Kf.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:Le(Function)},onRowHover:{type:Le(Function)},onRowHeightChange:{type:Le(Function)},rowData:{type:Le(Object),required:!0},rowEventHandlers:{type:Le(Object)},rowIndex:{type:Number,required:!0},rowKey:sW,style:{type:Le(Object)}}),dD={type:Number,required:!0},i2=gt({class:String,columns:SI,fixedHeaderData:{type:Le(Array)},headerData:{type:Le(Array),required:!0},headerHeight:{type:Le([Number,Array]),default:50},rowWidth:dD,rowHeight:{type:Number,default:50},height:dD,width:dD}),YT=gt({columns:SI,data:iW,fixedData:r2,estimatedRowHeight:xf.estimatedRowHeight,width:yf,height:yf,headerWidth:yf,headerHeight:i2.headerHeight,bodyWidth:yf,rowHeight:yf,cache:Az.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Kf.scrollbarAlwaysOn,scrollbarStartGap:Kf.scrollbarStartGap,scrollbarEndGap:Kf.scrollbarEndGap,class:rW,style:i$,containerStyle:i$,getRowHeight:{type:Le(Function),required:!0},rowKey:xf.rowKey,onRowsRendered:{type:Le(Function)},onScroll:{type:Le(Function)}}),ZPe=gt({cache:YT.cache,estimatedRowHeight:xf.estimatedRowHeight,rowKey:sW,headerClass:{type:Le([String,Function])},headerProps:{type:Le([Object,Function])},headerCellProps:{type:Le([Object,Function])},headerHeight:i2.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:Le([String,Function])},rowProps:{type:Le([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:Le([Object,Function])},columns:SI,data:iW,dataGetter:{type:Le(Function)},fixedData:r2,expandColumnKey:xf.expandColumnKey,expandedRowKeys:r$,defaultExpandedRowKeys:r$,class:rW,fixed:Boolean,style:{type:Le(Object)},width:yf,height:yf,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Kf.hScrollbarSize,vScrollbarSize:Kf.vScrollbarSize,scrollbarAlwaysOn:Dz.alwaysOn,sortBy:{type:Le(Object),default:()=>({})},sortState:{type:Le(Object),default:void 0},onColumnSort:{type:Le(Function)},onExpandedRowsChange:{type:Le(Function)},onEndReached:{type:Le(Function)},onRowExpand:xf.onRowExpand,onScroll:YT.onScroll,onRowsRendered:YT.onRowsRendered,rowEventHandlers:xf.rowEventHandlers}),s2=(e,{slots:t})=>{var o;const{cellData:i,style:c}=e,u=((o=i==null?void 0:i.toString)==null?void 0:o.call(i))||"",f=We(t,"default",e,()=>[u]);return Me("div",{class:e.class,title:u,style:c},[f])};s2.displayName="ElTableV2Cell";s2.inheritAttrs=!1;const a2=(e,{slots:t})=>We(t,"default",e,()=>{var o,i;return[Me("div",{class:e.class,title:(o=e.column)==null?void 0:o.title},[(i=e.column)==null?void 0:i.title])]});a2.displayName="ElTableV2HeaderCell";a2.inheritAttrs=!1;const eUe=gt({class:String,columns:SI,columnsStyles:{type:Le(Object),required:!0},headerIndex:Number,style:{type:Le(Object)}}),tUe=Se({name:"ElTableV2HeaderRow",props:eUe,setup(e,{slots:t}){return()=>{const{columns:o,columnsStyles:i,headerIndex:c,style:u}=e;let f=o.map((p,m)=>t.cell({columns:o,column:p,columnIndex:m,headerIndex:c,style:i[p.key]}));return t.header&&(f=t.header({cells:f.map(p=>At(p)&&p.length===1?p[0]:p),columns:o,headerIndex:c})),Me("div",{class:e.class,style:u,role:"row"},[f])}}}),nUe="ElTableV2Header",oUe=Se({name:nUe,props:i2,setup(e,{slots:t,expose:o}){const i=lt("table-v2"),c=ae(),u=K(()=>sd({width:e.width,height:e.height})),f=K(()=>sd({width:e.rowWidth,height:e.height})),p=K(()=>vd(y(e.headerHeight))),m=S=>{const T=y(c);zt(()=>{T!=null&&T.scroll&&T.scroll({left:S})})},_=()=>{const S=i.e("fixed-header-row"),{columns:T,fixedHeaderData:M,rowHeight:R}=e;return M==null?void 0:M.map((E,N)=>{var D;const x=sd({height:R,width:"100%"});return(D=t.fixed)==null?void 0:D.call(t,{class:S,columns:T,rowData:E,rowIndex:-(N+1),style:x})})},b=()=>{const S=i.e("dynamic-header-row"),{columns:T}=e;return y(p).map((M,R)=>{var E;const N=sd({width:"100%",height:M});return(E=t.dynamic)==null?void 0:E.call(t,{class:S,columns:T,headerIndex:R,style:N})})};return o({scrollToLeft:m}),()=>{if(!(e.height<=0))return Me("div",{ref:c,class:e.class,style:y(u),role:"rowgroup"},[Me("div",{style:y(f),class:i.e("header")},[b(),_()])])}}}),rUe=e=>{const{isScrolling:t}=wt(o2),o=ae(!1),i=ae(),c=K(()=>Zt(e.estimatedRowHeight)&&e.rowIndex>=0),u=(m=!1)=>{const _=y(i);if(!_)return;const{columns:b,onRowHeightChange:S,rowKey:T,rowIndex:M,style:R}=e,{height:E}=_.getBoundingClientRect();o.value=!0,zt(()=>{if(m||E!==Number.parseInt(R.height)){const N=b[0],D=(N==null?void 0:N.placeholderSign)===eI;S==null||S({rowKey:T,height:E,rowIndex:M},N&&!D&&N.fixed)}})},f=K(()=>{const{rowData:m,rowIndex:_,rowKey:b,onRowHover:S}=e,T=e.rowEventHandlers||{},M={};return Object.entries(T).forEach(([R,E])=>{tn(E)&&(M[R]=N=>{E({event:N,rowData:m,rowIndex:_,rowKey:b})})}),S&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:R,hovered:E})=>{const N=M[R];M[R]=D=>{S({event:D,hovered:E,rowData:m,rowIndex:_,rowKey:b}),N==null||N(D)}}),M}),p=m=>{const{onRowExpand:_,rowData:b,rowIndex:S,rowKey:T}=e;_==null||_({expanded:m,rowData:b,rowIndex:S,rowKey:T})};return fn(()=>{y(c)&&u(!0)}),{isScrolling:t,measurable:c,measured:o,rowRef:i,eventHandlers:f,onExpand:p}},iUe="ElTableV2TableRow",sUe=Se({name:iUe,props:xf,setup(e,{expose:t,slots:o,attrs:i}){const{eventHandlers:c,isScrolling:u,measurable:f,measured:p,rowRef:m,onExpand:_}=rUe(e);return t({onExpand:_}),()=>{const{columns:b,columnsStyles:S,expandColumnKey:T,depth:M,rowData:R,rowIndex:E,style:N}=e;let D=b.map((x,L)=>{const F=At(R.children)&&R.children.length>0&&x.key===T;return o.cell({column:x,columns:b,columnIndex:L,depth:M,style:S[x.key],rowData:R,rowIndex:E,isScrolling:y(u),expandIconProps:F?{rowData:R,rowIndex:E,onExpand:_}:void 0})});if(o.row&&(D=o.row({cells:D.map(x=>At(x)&&x.length===1?x[0]:x),style:N,columns:b,depth:M,rowData:R,rowIndex:E,isScrolling:y(u)})),y(f)){const{height:x,...L}=N||{},F=y(p);return Me("div",Nn({ref:m,class:e.class,style:F?N:L,role:"row"},i,y(c)),[D])}return Me("div",Nn(i,{ref:m,class:e.class,style:N,role:"row"},y(c)),[D])}}}),aUe=e=>{const{sortOrder:t}=e;return Me(Gt,{size:14,class:e.class},{default:()=>[t===Q0.ASC?Me(T_e,null,null):Me(C_e,null,null)]})},lUe=e=>{const{expanded:t,expandable:o,onExpand:i,style:c,size:u}=e,f={onClick:o?()=>i(!t):void 0,class:e.class};return Me(Gt,Nn(f,{size:u,style:c}),{default:()=>[Me($i,null,null)]})},cUe="ElTableV2Grid",uUe=e=>{const t=ae(),o=ae(),i=K(()=>{const{data:E,rowHeight:N,estimatedRowHeight:D}=e;if(!D)return E.length*N}),c=K(()=>{const{fixedData:E,rowHeight:N}=e;return((E==null?void 0:E.length)||0)*N}),u=K(()=>jT(e.headerHeight)),f=K(()=>{const{height:E}=e;return Math.max(0,E-y(u)-y(c))}),p=K(()=>y(u)+y(c)>0),m=({data:E,rowIndex:N})=>E[N][e.rowKey];function _({rowCacheStart:E,rowCacheEnd:N,rowVisibleStart:D,rowVisibleEnd:x}){var L;(L=e.onRowsRendered)==null||L.call(e,{rowCacheStart:E,rowCacheEnd:N,rowVisibleStart:D,rowVisibleEnd:x})}function b(E,N){var D;(D=o.value)==null||D.resetAfterRowIndex(E,N)}function S(E,N){const D=y(t),x=y(o);En(E)?(D==null||D.scrollToLeft(E.scrollLeft),x==null||x.scrollTo(E)):(D==null||D.scrollToLeft(E),x==null||x.scrollTo({scrollLeft:E,scrollTop:N}))}function T(E){var N;(N=y(o))==null||N.scrollTo({scrollTop:E})}function M(E,N){var D;(D=y(o))==null||D.scrollToItem(E,1,N)}function R(){var E,N;(E=y(o))==null||E.$forceUpdate(),(N=y(t))==null||N.$forceUpdate()}return{bodyRef:o,forceUpdate:R,fixedRowHeight:c,gridHeight:f,hasHeader:p,headerHeight:u,headerRef:t,totalHeight:i,itemKey:m,onItemRendered:_,resetAfterRowIndex:b,scrollTo:S,scrollToTop:T,scrollToRow:M}},l2=Se({name:cUe,props:YT,setup(e,{slots:t,expose:o}){const{ns:i}=wt(o2),{bodyRef:c,fixedRowHeight:u,gridHeight:f,hasHeader:p,headerRef:m,headerHeight:_,totalHeight:b,forceUpdate:S,itemKey:T,onItemRendered:M,resetAfterRowIndex:R,scrollTo:E,scrollToTop:N,scrollToRow:D}=uUe(e);o({forceUpdate:S,totalHeight:b,scrollTo:E,scrollToTop:N,scrollToRow:D,resetAfterRowIndex:R});const x=()=>e.bodyWidth;return()=>{const{cache:L,columns:F,data:H,fixedData:B,useIsScrolling:z,scrollbarAlwaysOn:W,scrollbarEndGap:Z,scrollbarStartGap:$,style:O,rowHeight:X,bodyWidth:le,estimatedRowHeight:de,headerWidth:he,height:se,width:ie,getRowHeight:oe,onScroll:ee}=e,Q=Zt(de),ue=Q?jNe:qNe,me=y(_);return Me("div",{role:"table",class:[i.e("table"),e.class],style:O},[Me(ue,{ref:c,data:H,useIsScrolling:z,itemKey:T,columnCache:0,columnWidth:Q?x:le,totalColumn:1,totalRow:H.length,rowCache:L,rowHeight:Q?oe:X,width:ie,height:y(f),class:i.e("body"),role:"rowgroup",scrollbarStartGap:$,scrollbarEndGap:Z,scrollbarAlwaysOn:W,onScroll:ee,onItemRendered:M,perfMode:!1},{default:be=>{var ke;const Ye=H[be.rowIndex];return(ke=t.row)==null?void 0:ke.call(t,{...be,columns:F,rowData:Ye})}}),y(p)&&Me(oUe,{ref:m,class:i.e("header-wrapper"),columns:F,headerData:H,headerHeight:e.headerHeight,fixedHeaderData:B,rowWidth:he,rowHeight:X,width:ie,height:Math.min(me+y(u),se)},{dynamic:t.header,fixed:t.row})])}}});function dUe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const hUe=(e,{slots:t})=>{const{mainTableRef:o,...i}=e;return Me(l2,Nn({ref:o},i),dUe(t)?t:{default:()=>[t]})};function fUe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const pUe=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:o,...i}=e;return Me(l2,Nn({ref:o},i),fUe(t)?t:{default:()=>[t]})};function gUe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const mUe=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:o,...i}=e;return Me(l2,Nn({ref:o},i),gUe(t)?t:{default:()=>[t]})};function vUe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const _Ue=(e,{slots:t})=>{const{columns:o,columnsStyles:i,depthMap:c,expandColumnKey:u,expandedRowKeys:f,estimatedRowHeight:p,hasFixedColumns:m,rowData:_,rowIndex:b,style:S,isScrolling:T,rowProps:M,rowClass:R,rowKey:E,rowEventHandlers:N,ns:D,onRowHovered:x,onRowExpanded:L}=e,F=ep(R,{columns:o,rowData:_,rowIndex:b},""),H=ep(M,{columns:o,rowData:_,rowIndex:b}),B=_[E],z=c[B]||0,W=!!u,Z=b<0,$=[D.e("row"),F,{[D.e(`row-depth-${z}`)]:W&&b>=0,[D.is("expanded")]:W&&f.includes(B),[D.is("fixed")]:!z&&Z,[D.is("customized")]:!!t.row}],O=m?x:void 0,X={...H,columns:o,columnsStyles:i,class:$,depth:z,expandColumnKey:u,estimatedRowHeight:Z?void 0:p,isScrolling:T,rowIndex:b,rowData:_,rowKey:B,rowEventHandlers:N,style:S};return Me(sUe,Nn(X,{onRowExpand:L,onMouseenter:he=>{O==null||O({hovered:!0,rowKey:B,event:he,rowData:_,rowIndex:b})},onMouseleave:he=>{O==null||O({hovered:!1,rowKey:B,event:he,rowData:_,rowIndex:b})},rowkey:B}),vUe(t)?t:{default:()=>[t]})},FO=({columns:e,column:t,columnIndex:o,depth:i,expandIconProps:c,isScrolling:u,rowData:f,rowIndex:p,style:m,expandedRowKeys:_,ns:b,cellProps:S,expandColumnKey:T,indentSize:M,iconSize:R,rowKey:E},{slots:N})=>{const D=sd(m);if(t.placeholderSign===eI)return Me("div",{class:b.em("row-cell","placeholder"),style:D},null);const{cellRenderer:x,dataKey:L,dataGetter:F}=t,H=tn(F)?F({columns:e,column:t,columnIndex:o,rowData:f,rowIndex:p}):ir(f,L??""),B=ep(S,{cellData:H,columns:e,column:t,columnIndex:o,rowIndex:p,rowData:f}),z={class:b.e("cell-text"),columns:e,column:t,columnIndex:o,cellData:H,isScrolling:u,rowData:f,rowIndex:p},W=oW(x),Z=W?W(z):We(N,"default",z,()=>[Me(s2,z,null)]),$=[b.e("row-cell"),t.class,t.align===Z0.CENTER&&b.is("align-center"),t.align===Z0.RIGHT&&b.is("align-right")],O=p>=0&&T&&t.key===T,X=p>=0&&_.includes(f[E]);let le;const de=`margin-inline-start: ${i*M}px;`;return O&&(En(c)?le=Me(lUe,Nn(c,{class:[b.e("expand-icon"),b.is("expanded",X)],size:R,expanded:X,style:de,expandable:!0}),null):le=Me("div",{style:[de,`width: ${R}px; height: ${R}px;`].join(" ")},null)),Me("div",Nn({class:$,style:D},B,{role:"cell"}),[le,Z])};FO.inheritAttrs=!1;function yUe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const IUe=({columns:e,columnsStyles:t,headerIndex:o,style:i,headerClass:c,headerProps:u,ns:f},{slots:p})=>{const m={columns:e,headerIndex:o},_=[f.e("header-row"),ep(c,m,""),{[f.is("customized")]:!!p.header}],b={...ep(u,m),columnsStyles:t,class:_,columns:e,headerIndex:o,style:i};return Me(tUe,b,yUe(p)?p:{default:()=>[p]})},s$=(e,{slots:t})=>{const{column:o,ns:i,style:c,onColumnSorted:u}=e,f=sd(c);if(o.placeholderSign===eI)return Me("div",{class:i.em("header-row-cell","placeholder"),style:f},null);const{headerCellRenderer:p,headerClass:m,sortable:_}=o,b={...e,class:i.e("header-cell-text")},S=oW(p),T=S?S(b):We(t,"default",b,()=>[Me(a2,b,null)]),{sortBy:M,sortState:R,headerCellProps:E}=e;let N,D;if(R){const F=R[o.key];N=!!xO[F],D=N?F:Q0.ASC}else N=o.key===M.key,D=N?M.order:Q0.ASC;const x=[i.e("header-cell"),ep(m,e,""),o.align===Z0.CENTER&&i.is("align-center"),o.align===Z0.RIGHT&&i.is("align-right"),_&&i.is("sortable")],L={...ep(E,e),onClick:o.sortable?u:void 0,class:x,style:f,"data-key":o.key};return Me("div",Nn(L,{role:"columnheader"}),[T,_&&Me(aUe,{class:[i.e("sort-icon"),N&&i.is("sorting")],sortOrder:D},null)])},aW=(e,{slots:t})=>{var o;return Me("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};aW.displayName="ElTableV2Footer";const lW=(e,{slots:t})=>{const o=We(t,"default",{},()=>[Me(hz,null,null)]);return Me("div",{class:e.class,style:e.style},[o])};lW.displayName="ElTableV2Empty";const cW=(e,{slots:t})=>{var o;return Me("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};cW.displayName="ElTableV2Overlay";function qy(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$o(e)}const bUe="ElTableV2",CUe=Se({name:bUe,props:ZPe,setup(e,{slots:t,expose:o}){const i=lt("table-v2"),{columnsStyles:c,fixedColumnsOnLeft:u,fixedColumnsOnRight:f,mainColumns:p,mainTableHeight:m,fixedTableHeight:_,leftTableWidth:b,rightTableWidth:S,data:T,depthMap:M,expandedRowKeys:R,hasFixedColumns:E,mainTableRef:N,leftTableRef:D,rightTableRef:x,isDynamic:L,isResetting:F,isScrolling:H,bodyWidth:B,emptyStyle:z,rootStyle:W,headerWidth:Z,footerHeight:$,showEmpty:O,scrollTo:X,scrollToLeft:le,scrollToTop:de,scrollToRow:he,getRowHeight:se,onColumnSorted:ie,onRowHeightChange:oe,onRowHovered:ee,onRowExpanded:Q,onRowsRendered:ue,onScroll:me,onVerticalScroll:be}=XPe(e);return o({scrollTo:X,scrollToLeft:le,scrollToTop:de,scrollToRow:he}),Ln(o2,{ns:i,isResetting:F,isScrolling:H}),()=>{const{cache:ke,cellProps:Ye,estimatedRowHeight:Oe,expandColumnKey:Ee,fixedData:we,headerHeight:Ge,headerClass:Ve,headerProps:qe,headerCellProps:st,sortBy:Ie,sortState:Ae,rowHeight:xe,rowClass:ot,rowEventHandlers:je,rowKey:at,rowProps:ht,scrollbarAlwaysOn:dt,indentSize:ft,iconSize:Je,useIsScrolling:Et,vScrollbarSize:Nt,width:et}=e,Mt=y(T),Jt={cache:ke,class:i.e("main"),columns:y(p),data:Mt,fixedData:we,estimatedRowHeight:Oe,bodyWidth:y(B)+Nt,headerHeight:Ge,headerWidth:y(Z),height:y(m),mainTableRef:N,rowKey:at,rowHeight:xe,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:Nt,useIsScrolling:Et,width:et,getRowHeight:se,onRowsRendered:ue,onScroll:me},sn=y(b),gn=y(_),Bt={cache:ke,class:i.e("left"),columns:y(u),data:Mt,estimatedRowHeight:Oe,leftTableRef:D,rowHeight:xe,bodyWidth:sn,headerWidth:sn,headerHeight:Ge,height:gn,rowKey:at,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:Nt,useIsScrolling:Et,width:sn,getRowHeight:se,onScroll:be},It=y(S)+Nt,ct={cache:ke,class:i.e("right"),columns:y(f),data:Mt,estimatedRowHeight:Oe,rightTableRef:x,rowHeight:xe,bodyWidth:It,headerWidth:It,headerHeight:Ge,height:gn,rowKey:at,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:Nt,width:It,style:`--${y(i.namespace)}-table-scrollbar-size: ${Nt}px`,useIsScrolling:Et,getRowHeight:se,onScroll:be},Ke=y(c),Xe={ns:i,depthMap:y(M),columnsStyles:Ke,expandColumnKey:Ee,expandedRowKeys:y(R),estimatedRowHeight:Oe,hasFixedColumns:y(E),rowProps:ht,rowClass:ot,rowKey:at,rowEventHandlers:je,onRowHovered:ee,onRowExpanded:Q,onRowHeightChange:oe},Dt={cellProps:Ye,expandColumnKey:Ee,indentSize:ft,iconSize:Je,rowKey:at,expandedRowKeys:y(R),ns:i},$e={ns:i,headerClass:Ve,headerProps:qe,columnsStyles:Ke},xt={ns:i,sortBy:Ie,sortState:Ae,headerCellProps:st,onColumnSorted:ie},jt={row:zn=>Me(_Ue,Nn(zn,Xe),{row:t.row,cell:kn=>{let Po;return t.cell?Me(FO,Nn(kn,Dt,{style:Ke[kn.column.key]}),qy(Po=t.cell(kn))?Po:{default:()=>[Po]}):Me(FO,Nn(kn,Dt,{style:Ke[kn.column.key]}),null)}}),header:zn=>Me(IUe,Nn(zn,$e),{header:t.header,cell:kn=>{let Po;return t["header-cell"]?Me(s$,Nn(kn,xt,{style:Ke[kn.column.key]}),qy(Po=t["header-cell"](kn))?Po:{default:()=>[Po]}):Me(s$,Nn(kn,xt,{style:Ke[kn.column.key]}),null)}})},Fn=[e.class,i.b(),i.e("root"),{[i.is("dynamic")]:y(L)}],oo={class:i.e("footer"),style:y($)};return Me("div",{class:Fn,style:y(W)},[Me(hUe,Jt,qy(jt)?jt:{default:()=>[jt]}),Me(pUe,Bt,qy(jt)?jt:{default:()=>[jt]}),Me(mUe,ct,qy(jt)?jt:{default:()=>[jt]}),t.footer&&Me(aW,oo,{default:t.footer}),y(O)&&Me(lW,{class:i.e("empty"),style:y(z)},{default:t.empty}),t.overlay&&Me(cW,{class:i.e("overlay")},{default:t.overlay})])}}}),SUe=gt({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:Le(Function)}}),TUe=Se({name:"ElAutoResizer",props:SUe,setup(e,{slots:t}){const o=lt("auto-resizer"),{height:i,width:c,sizer:u}=JPe(e),f={width:"100%",height:"100%"};return()=>{var p;return Me("div",{ref:u,class:o.b(),style:f},[(p=t.default)==null?void 0:p.call(t,{height:i.value,width:c.value})])}}}),EUe=bn(CUe),MUe=bn(TUe),C1=Symbol("tabsRootContextKey"),kUe=gt({tabs:{type:Le(Array),default:()=>zo([])}}),uW="ElTabBar",AUe=Se({name:uW}),RUe=Se({...AUe,props:kUe,setup(e,{expose:t}){const o=e,i=In(),c=wt(C1);c||wr(uW,"<el-tabs><el-tab-bar /></el-tabs>");const u=lt("tabs"),f=ae(),p=ae(),m=()=>{let b=0,S=0;const T=["top","bottom"].includes(c.props.tabPosition)?"width":"height",M=T==="width"?"x":"y",R=M==="x"?"left":"top";return o.tabs.every(E=>{var N,D;const x=(D=(N=i.parent)==null?void 0:N.refs)==null?void 0:D[`tab-${E.uid}`];if(!x)return!1;if(!E.active)return!0;b=x[`offset${yl(R)}`],S=x[`client${yl(T)}`];const L=window.getComputedStyle(x);return T==="width"&&(o.tabs.length>1&&(S-=Number.parseFloat(L.paddingLeft)+Number.parseFloat(L.paddingRight)),b+=Number.parseFloat(L.paddingLeft)),!1}),{[T]:`${S}px`,transform:`translate${yl(M)}(${b}px)`}},_=()=>p.value=m();return rt(()=>o.tabs,async()=>{await zt(),_()},{immediate:!0}),Ko(f,()=>_()),t({ref:f,update:_}),(b,S)=>(J(),ge("div",{ref_key:"barRef",ref:f,class:ne([y(u).e("active-bar"),y(u).is(y(c).props.tabPosition)]),style:Ht(p.value)},null,6))}});var wUe=vt(RUe,[["__file","tab-bar.vue"]]);const DUe=gt({panes:{type:Le(Array),default:()=>zo([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),OUe={tabClick:(e,t,o)=>o instanceof Event,tabRemove:(e,t)=>t instanceof Event},a$="ElTabNav",NUe=Se({name:a$,props:DUe,emits:OUe,setup(e,{expose:t,emit:o}){const i=In(),c=wt(C1);c||wr(a$,"<el-tabs><tab-nav /></el-tabs>");const u=lt("tabs"),f=Nde(),p=Kde(),m=ae(),_=ae(),b=ae(),S=ae(),T=ae(!1),M=ae(0),R=ae(!1),E=ae(!0),N=K(()=>["top","bottom"].includes(c.props.tabPosition)?"width":"height"),D=K(()=>({transform:`translate${N.value==="width"?"X":"Y"}(-${M.value}px)`})),x=()=>{if(!m.value)return;const Z=m.value[`offset${yl(N.value)}`],$=M.value;if(!$)return;const O=$>Z?$-Z:0;M.value=O},L=()=>{if(!m.value||!_.value)return;const Z=_.value[`offset${yl(N.value)}`],$=m.value[`offset${yl(N.value)}`],O=M.value;if(Z-O<=$)return;const X=Z-O>$*2?O+$:Z-$;M.value=X},F=async()=>{const Z=_.value;if(!T.value||!b.value||!m.value||!Z)return;await zt();const $=b.value.querySelector(".is-active");if(!$)return;const O=m.value,X=["top","bottom"].includes(c.props.tabPosition),le=$.getBoundingClientRect(),de=O.getBoundingClientRect(),he=X?Z.offsetWidth-de.width:Z.offsetHeight-de.height,se=M.value;let ie=se;X?(le.left<de.left&&(ie=se-(de.left-le.left)),le.right>de.right&&(ie=se+le.right-de.right)):(le.top<de.top&&(ie=se-(de.top-le.top)),le.bottom>de.bottom&&(ie=se+(le.bottom-de.bottom))),ie=Math.max(ie,0),M.value=Math.min(ie,he)},H=()=>{var Z;if(!_.value||!m.value)return;e.stretch&&((Z=S.value)==null||Z.update());const $=_.value[`offset${yl(N.value)}`],O=m.value[`offset${yl(N.value)}`],X=M.value;O<$?(T.value=T.value||{},T.value.prev=X,T.value.next=X+O<$,$-X<O&&(M.value=$-O)):(T.value=!1,X>0&&(M.value=0))},B=Z=>{const $=Z.code,{up:O,down:X,left:le,right:de}=Yt;if(![O,X,le,de].includes($))return;const he=Array.from(Z.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),se=he.indexOf(Z.target);let ie;$===le||$===O?se===0?ie=he.length-1:ie=se-1:se<he.length-1?ie=se+1:ie=0,he[ie].focus({preventScroll:!0}),he[ie].click(),z()},z=()=>{E.value&&(R.value=!0)},W=()=>R.value=!1;return rt(f,Z=>{Z==="hidden"?E.value=!1:Z==="visible"&&setTimeout(()=>E.value=!0,50)}),rt(p,Z=>{Z?setTimeout(()=>E.value=!0,50):E.value=!1}),Ko(b,H),fn(()=>setTimeout(()=>F(),0)),Oc(()=>H()),t({scrollToActiveTab:F,removeFocus:W}),rt(()=>e.panes,()=>i.update(),{flush:"post",deep:!0}),()=>{const Z=T.value?[Me("span",{class:[u.e("nav-prev"),u.is("disabled",!T.value.prev)],onClick:x},[Me(Gt,null,{default:()=>[Me(yd,null,null)]})]),Me("span",{class:[u.e("nav-next"),u.is("disabled",!T.value.next)],onClick:L},[Me(Gt,null,{default:()=>[Me($i,null,null)]})])]:null,$=e.panes.map((O,X)=>{var le,de,he,se;const ie=O.uid,oe=O.props.disabled,ee=(de=(le=O.props.name)!=null?le:O.index)!=null?de:`${X}`,Q=!oe&&(O.isClosable||e.editable);O.index=`${X}`;const ue=Q?Me(Gt,{class:"is-icon-close",onClick:ke=>o("tabRemove",O,ke)},{default:()=>[Me(La,null,null)]}):null,me=((se=(he=O.slots).label)==null?void 0:se.call(he))||O.props.label,be=!oe&&O.active?0:-1;return Me("div",{ref:`tab-${ie}`,class:[u.e("item"),u.is(c.props.tabPosition),u.is("active",O.active),u.is("disabled",oe),u.is("closable",Q),u.is("focus",R.value)],id:`tab-${ee}`,key:`tab-${ie}`,"aria-controls":`pane-${ee}`,role:"tab","aria-selected":O.active,tabindex:be,onFocus:()=>z(),onBlur:()=>W(),onClick:ke=>{W(),o("tabClick",O,ee,ke)},onKeydown:ke=>{Q&&(ke.code===Yt.delete||ke.code===Yt.backspace)&&o("tabRemove",O,ke)}},[me,ue])});return Me("div",{ref:b,class:[u.e("nav-wrap"),u.is("scrollable",!!T.value),u.is(c.props.tabPosition)]},[Z,Me("div",{class:u.e("nav-scroll"),ref:m},[Me("div",{class:[u.e("nav"),u.is(c.props.tabPosition),u.is("stretch",e.stretch&&["top","bottom"].includes(c.props.tabPosition))],ref:_,style:D.value,role:"tablist",onKeydown:B},[e.type?null:Me(wUe,{ref:S,tabs:[...e.panes]},null),$])])])}}}),LUe=gt({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Le(Function),default:()=>!0},stretch:Boolean}),hD=e=>on(e)||Zt(e),PUe={[Mn]:e=>hD(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>hD(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>hD(e),tabAdd:()=>!0},UUe=Se({name:"ElTabs",props:LUe,emits:PUe,setup(e,{emit:t,slots:o,expose:i}){var c;const u=lt("tabs"),{children:f,addChild:p,removeChild:m}=RL(In(),"ElTabPane"),_=ae(),b=ae((c=e.modelValue)!=null?c:"0"),S=async(E,N=!1)=>{var D,x,L;if(!(b.value===E||_r(E)))try{await((D=e.beforeLeave)==null?void 0:D.call(e,E,b.value))!==!1&&(b.value=E,N&&(t(Mn,E),t("tabChange",E)),(L=(x=_.value)==null?void 0:x.removeFocus)==null||L.call(x))}catch{}},T=(E,N,D)=>{E.props.disabled||(S(N,!0),t("tabClick",E,D))},M=(E,N)=>{E.props.disabled||_r(E.props.name)||(N.stopPropagation(),t("edit",E.props.name,"remove"),t("tabRemove",E.props.name))},R=()=>{t("edit",void 0,"add"),t("tabAdd")};return rt(()=>e.modelValue,E=>S(E)),rt(b,async()=>{var E;await zt(),(E=_.value)==null||E.scrollToActiveTab()}),Ln(C1,{props:e,currentName:b,registerPane:p,unregisterPane:m}),i({currentName:b}),()=>{const E=o["add-icon"],N=e.editable||e.addable?Me("span",{class:u.e("new-tab"),tabindex:"0",onClick:R,onKeydown:L=>{L.code===Yt.enter&&R()}},[E?We(o,"add-icon"):Me(Gt,{class:u.is("icon-plus")},{default:()=>[Me(Gq,null,null)]})]):null,D=Me("div",{class:[u.e("header"),u.is(e.tabPosition)]},[N,Me(NUe,{ref:_,currentName:b.value,editable:e.editable,type:e.type,panes:f.value,stretch:e.stretch,onTabClick:T,onTabRemove:M},null)]),x=Me("div",{class:u.e("content")},[We(o,"default")]);return Me("div",{class:[u.b(),u.m(e.tabPosition),{[u.m("card")]:e.type==="card",[u.m("border-card")]:e.type==="border-card"}]},[...e.tabPosition!=="bottom"?[D,x]:[x,D]])}}}),xUe=gt({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),FUe=["id","aria-hidden","aria-labelledby"],dW="ElTabPane",VUe=Se({name:dW}),GUe=Se({...VUe,props:xUe,setup(e){const t=e,o=In(),i=zr(),c=wt(C1);c||wr(dW,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const u=lt("tab-pane"),f=ae(),p=K(()=>t.closable||c.props.closable),m=x5(()=>{var M;return c.currentName.value===((M=t.name)!=null?M:f.value)}),_=ae(m.value),b=K(()=>{var M;return(M=t.name)!=null?M:f.value}),S=x5(()=>!t.lazy||_.value||m.value);rt(m,M=>{M&&(_.value=!0)});const T=Zn({uid:o.uid,slots:i,props:t,paneName:b,active:m,index:f,isClosable:p});return fn(()=>{c.registerPane(T)}),Md(()=>{c.unregisterPane(T.uid)}),(M,R)=>y(S)?hn((J(),ge("div",{key:0,id:`pane-${y(b)}`,class:ne(y(u).b()),role:"tabpanel","aria-hidden":!y(m),"aria-labelledby":`tab-${y(b)}`},[We(M.$slots,"default")],10,FUe)),[[Jn,y(m)]]):Fe("v-if",!0)}});var hW=vt(GUe,[["__file","tab-pane.vue"]]);const BUe=bn(UUe,{TabPane:hW}),$Ue=Wo(hW),HUe=gt({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Al,default:""},truncated:{type:Boolean},lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),qUe=Se({name:"ElText"}),KUe=Se({...qUe,props:HUe,setup(e){const t=e,o=Tr(),i=lt("text"),c=K(()=>[i.b(),i.m(t.type),i.m(o.value),i.is("truncated",t.truncated),i.is("line-clamp",!_r(t.lineClamp))]);return(u,f)=>(J(),He(wn(u.tag),{class:ne(y(c)),style:Ht({"-webkit-line-clamp":u.lineClamp})},{default:Ne(()=>[We(u.$slots,"default")]),_:3},8,["class","style"]))}});var zUe=vt(KUe,[["__file","text.vue"]]);const WUe=bn(zUe),jUe=gt({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:String,default:"light"},clearable:{type:Boolean,default:!0},size:Nr,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:Le([String,Object]),default:()=>Vq},clearIcon:{type:Le([String,Object]),default:()=>Ad},...Hm}),Ic=e=>{const t=(e||"").split(":");if(t.length>=2){let o=Number.parseInt(t[0],10);const i=Number.parseInt(t[1],10),c=e.toUpperCase();return c.includes("AM")&&o===12?o=0:c.includes("PM")&&o!==12&&(o+=12),{hours:o,minutes:i}}return null},fD=(e,t)=>{const o=Ic(e);if(!o)return-1;const i=Ic(t);if(!i)return-1;const c=o.minutes+o.hours*60,u=i.minutes+i.hours*60;return c===u?0:c>u?1:-1},l$=e=>`${e}`.padStart(2,"0"),qg=e=>`${l$(e.hours)}:${l$(e.minutes)}`,YUe=(e,t)=>{const o=Ic(e);if(!o)return"";const i=Ic(t);if(!i)return"";const c={hours:o.hours,minutes:o.minutes};return c.minutes+=i.minutes,c.hours+=i.hours,c.hours+=Math.floor(c.minutes/60),c.minutes=c.minutes%60,qg(c)},JUe=Se({name:"ElTimeSelect"}),XUe=Se({...JUe,props:jUe,emits:["change","blur","focus","update:modelValue"],setup(e,{expose:t}){const o=e;Tn.extend(UL);const{Option:i}=Zf,c=lt("input"),u=ae(),f=zi(),{lang:p}=Kn(),m=K(()=>o.modelValue),_=K(()=>{const D=Ic(o.start);return D?qg(D):null}),b=K(()=>{const D=Ic(o.end);return D?qg(D):null}),S=K(()=>{const D=Ic(o.step);return D?qg(D):null}),T=K(()=>{const D=Ic(o.minTime||"");return D?qg(D):null}),M=K(()=>{const D=Ic(o.maxTime||"");return D?qg(D):null}),R=K(()=>{const D=[];if(o.start&&o.end&&o.step){let x=_.value,L;for(;x&&b.value&&fD(x,b.value)<=0;)L=Tn(x,"HH:mm").locale(p.value).format(o.format),D.push({value:L,disabled:fD(x,T.value||"-1:-1")<=0||fD(x,M.value||"100:100")>=0}),x=YUe(x,S.value)}return D});return t({blur:()=>{var D,x;(x=(D=u.value)==null?void 0:D.blur)==null||x.call(D)},focus:()=>{var D,x;(x=(D=u.value)==null?void 0:D.focus)==null||x.call(D)}}),(D,x)=>(J(),He(y(Zf),{ref_key:"select",ref:u,"model-value":y(m),disabled:y(f),clearable:D.clearable,"clear-icon":D.clearIcon,size:D.size,effect:D.effect,placeholder:D.placeholder,"default-first-option":"",filterable:D.editable,"empty-values":D.emptyValues,"value-on-clear":D.valueOnClear,"onUpdate:modelValue":x[0]||(x[0]=L=>D.$emit("update:modelValue",L)),onChange:x[1]||(x[1]=L=>D.$emit("change",L)),onBlur:x[2]||(x[2]=L=>D.$emit("blur",L)),onFocus:x[3]||(x[3]=L=>D.$emit("focus",L))},{prefix:Ne(()=>[D.prefixIcon?(J(),He(y(Gt),{key:0,class:ne(y(c).e("prefix-icon"))},{default:Ne(()=>[(J(),He(wn(D.prefixIcon)))]),_:1},8,["class"])):Fe("v-if",!0)]),default:Ne(()=>[(J(!0),ge(qt,null,Vn(y(R),L=>(J(),He(y(i),{key:L.value,label:L.value,value:L.value,disabled:L.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear"]))}});var JT=vt(XUe,[["__file","time-select.vue"]]);JT.install=e=>{e.component(JT.name,JT)};const QUe=JT,ZUe=QUe,exe=Se({name:"ElTimeline",setup(e,{slots:t}){const o=lt("timeline");return Ln("timeline",t),()=>Wt("ul",{class:[o.b()]},[We(t,"default")])}}),txe=gt({timestamp:{type:String,default:""},hideTimestamp:{type:Boolean,default:!1},center:{type:Boolean,default:!1},placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:mo},hollow:{type:Boolean,default:!1}}),nxe=Se({name:"ElTimelineItem"}),oxe=Se({...nxe,props:txe,setup(e){const t=e,o=lt("timeline-item"),i=K(()=>[o.e("node"),o.em("node",t.size||""),o.em("node",t.type||""),o.is("hollow",t.hollow)]);return(c,u)=>(J(),ge("li",{class:ne([y(o).b(),{[y(o).e("center")]:c.center}])},[Ce("div",{class:ne(y(o).e("tail"))},null,2),c.$slots.dot?Fe("v-if",!0):(J(),ge("div",{key:0,class:ne(y(i)),style:Ht({backgroundColor:c.color})},[c.icon?(J(),He(y(Gt),{key:0,class:ne(y(o).e("icon"))},{default:Ne(()=>[(J(),He(wn(c.icon)))]),_:1},8,["class"])):Fe("v-if",!0)],6)),c.$slots.dot?(J(),ge("div",{key:1,class:ne(y(o).e("dot"))},[We(c.$slots,"dot")],2)):Fe("v-if",!0),Ce("div",{class:ne(y(o).e("wrapper"))},[!c.hideTimestamp&&c.placement==="top"?(J(),ge("div",{key:0,class:ne([y(o).e("timestamp"),y(o).is("top")])},pt(c.timestamp),3)):Fe("v-if",!0),Ce("div",{class:ne(y(o).e("content"))},[We(c.$slots,"default")],2),!c.hideTimestamp&&c.placement==="bottom"?(J(),ge("div",{key:1,class:ne([y(o).e("timestamp"),y(o).is("bottom")])},pt(c.timestamp),3)):Fe("v-if",!0)],2)],2))}});var fW=vt(oxe,[["__file","timeline-item.vue"]]);const rxe=bn(exe,{TimelineItem:fW}),ixe=Wo(fW),pW=gt({nowrap:Boolean});var gW=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(gW||{});const sxe=Object.values(gW),c2=gt({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:Le(Object),default:null}}),axe=gt({side:{type:Le(String),values:sxe,required:!0}}),lxe=["absolute","fixed"],cxe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],u2=gt({arrowPadding:{type:Le(Number),default:5},effect:{type:String,default:""},contentClass:String,placement:{type:Le(String),values:cxe,default:"bottom"},reference:{type:Le(Object),default:null},offset:{type:Number,default:8},strategy:{type:Le(String),values:lxe,default:"absolute"},showArrow:{type:Boolean,default:!1},...ti(["ariaLabel"])}),d2=gt({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:Le(Function)},"onUpdate:open":{type:Le(Function)}}),Gg={type:Le(Function)},h2=gt({onBlur:Gg,onClick:Gg,onFocus:Gg,onMouseDown:Gg,onMouseEnter:Gg,onMouseLeave:Gg}),uxe=gt({...d2,...c2,...h2,...u2,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:Le(Object),default:null},teleported:Boolean,to:{type:Le(String),default:"body"}}),S1=Symbol("tooltipV2"),mW=Symbol("tooltipV2Content"),pD="tooltip_v2.open",dxe=Se({name:"ElTooltipV2Root"}),hxe=Se({...dxe,props:d2,setup(e,{expose:t}){const o=e,i=ae(o.defaultOpen),c=ae(null),u=K({get:()=>Yf(o.open)?i.value:o.open,set:N=>{var D;i.value=N,(D=o["onUpdate:open"])==null||D.call(o,N)}}),f=K(()=>Zt(o.delayDuration)&&o.delayDuration>0),{start:p,stop:m}=Wf(()=>{u.value=!0},K(()=>o.delayDuration),{immediate:!1}),_=lt("tooltip-v2"),b=pi(),S=()=>{m(),u.value=!0},T=()=>{y(f)?p():S()},M=S,R=()=>{m(),u.value=!1};return rt(u,N=>{var D;N&&(document.dispatchEvent(new CustomEvent(pD)),M()),(D=o.onOpenChange)==null||D.call(o,N)}),fn(()=>{document.addEventListener(pD,R)}),Ro(()=>{m(),document.removeEventListener(pD,R)}),Ln(S1,{contentId:b,triggerRef:c,ns:_,onClose:R,onDelayOpen:T,onOpen:M}),t({onOpen:M,onClose:R}),(N,D)=>We(N.$slots,"default",{open:y(u)})}});var fxe=vt(hxe,[["__file","root.vue"]]);const pxe=Se({name:"ElTooltipV2Arrow"}),gxe=Se({...pxe,props:{...c2,...axe},setup(e){const t=e,{ns:o}=wt(S1),{arrowRef:i}=wt(mW),c=K(()=>{const{style:u,width:f,height:p}=t,m=o.namespace.value;return{[`--${m}-tooltip-v2-arrow-width`]:`${f}px`,[`--${m}-tooltip-v2-arrow-height`]:`${p}px`,[`--${m}-tooltip-v2-arrow-border-width`]:`${f/2}px`,[`--${m}-tooltip-v2-arrow-cover-width`]:f/2-1,...u||{}}});return(u,f)=>(J(),ge("span",{ref_key:"arrowRef",ref:i,style:Ht(y(c)),class:ne(y(o).e("arrow"))},null,6))}});var c$=vt(gxe,[["__file","arrow.vue"]]);const mxe=gt({style:{type:Le([String,Object,Array]),default:()=>({})}}),vxe=Se({name:"ElVisuallyHidden"}),_xe=Se({...vxe,props:mxe,setup(e){const t=e,o=K(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(i,c)=>(J(),ge("span",Nn(i.$attrs,{style:y(o)}),[We(i.$slots,"default")],16))}});var yxe=vt(_xe,[["__file","visual-hidden.vue"]]);const Ixe=["data-side"],bxe=Se({name:"ElTooltipV2Content"}),Cxe=Se({...bxe,props:{...u2,...pW},setup(e){const t=e,{triggerRef:o,contentId:i}=wt(S1),c=ae(t.placement),u=ae(t.strategy),f=ae(null),{referenceRef:p,contentRef:m,middlewareData:_,x:b,y:S,update:T}=W0e({placement:c,strategy:u,middleware:K(()=>{const L=[C9(t.offset)];return t.showArrow&&L.push(j0e({arrowRef:f})),L})}),M=Bm().nextZIndex(),R=lt("tooltip-v2"),E=K(()=>c.value.split("-")[0]),N=K(()=>({position:y(u),top:`${y(S)||0}px`,left:`${y(b)||0}px`,zIndex:M})),D=K(()=>{if(!t.showArrow)return{};const{arrow:L}=y(_);return{[`--${R.namespace.value}-tooltip-v2-arrow-x`]:`${L==null?void 0:L.x}px`||"",[`--${R.namespace.value}-tooltip-v2-arrow-y`]:`${L==null?void 0:L.y}px`||""}}),x=K(()=>[R.e("content"),R.is("dark",t.effect==="dark"),R.is(y(u)),t.contentClass]);return rt(f,()=>T()),rt(()=>t.placement,L=>c.value=L),fn(()=>{rt(()=>t.reference||o.value,L=>{p.value=L||void 0},{immediate:!0})}),Ln(mW,{arrowRef:f}),(L,F)=>(J(),ge("div",{ref_key:"contentRef",ref:m,style:Ht(y(N)),"data-tooltip-v2-root":""},[L.nowrap?Fe("v-if",!0):(J(),ge("div",{key:0,"data-side":y(E),class:ne(y(x))},[We(L.$slots,"default",{contentStyle:y(N),contentClass:y(x)}),Me(y(yxe),{id:y(i),role:"tooltip"},{default:Ne(()=>[L.ariaLabel?(J(),ge(qt,{key:0},[On(pt(L.ariaLabel),1)],64)):We(L.$slots,"default",{key:1})]),_:3},8,["id"]),We(L.$slots,"arrow",{style:Ht(y(D)),side:y(E)})],10,Ixe))],4))}});var u$=vt(Cxe,[["__file","content.vue"]]);const Sxe=gt({setRef:{type:Le(Function),required:!0},onlyChild:Boolean});var Txe=Se({props:Sxe,setup(e,{slots:t}){const o=ae(),i=l1(o,c=>{c?e.setRef(c.nextElementSibling):e.setRef(null)});return()=>{var c;const[u]=((c=t.default)==null?void 0:c.call(t))||[],f=e.onlyChild?B_e(u.children):u.children;return Me(qt,{ref:i},[f])}}});const Exe=Se({name:"ElTooltipV2Trigger"}),Mxe=Se({...Exe,props:{...pW,...h2},setup(e){const t=e,{onClose:o,onOpen:i,onDelayOpen:c,triggerRef:u,contentId:f}=wt(S1);let p=!1;const m=x=>{u.value=x},_=()=>{p=!1},b=Jo(t.onMouseEnter,c),S=Jo(t.onMouseLeave,o),T=Jo(t.onMouseDown,()=>{o(),p=!0,document.addEventListener("mouseup",_,{once:!0})}),M=Jo(t.onFocus,()=>{p||i()}),R=Jo(t.onBlur,o),E=Jo(t.onClick,x=>{x.detail===0&&o()}),N={blur:R,click:E,focus:M,mousedown:T,mouseenter:b,mouseleave:S},D=(x,L,F)=>{x&&Object.entries(L).forEach(([H,B])=>{x[F](H,B)})};return rt(u,(x,L)=>{D(x,N,"addEventListener"),D(L,N,"removeEventListener"),x&&x.setAttribute("aria-describedby",f.value)}),Ro(()=>{D(u.value,N,"removeEventListener"),document.removeEventListener("mouseup",_)}),(x,L)=>x.nowrap?(J(),He(y(Txe),{key:0,"set-ref":m,"only-child":""},{default:Ne(()=>[We(x.$slots,"default")]),_:3})):(J(),ge("button",Nn({key:1,ref_key:"triggerRef",ref:u},x.$attrs),[We(x.$slots,"default")],16))}});var kxe=vt(Mxe,[["__file","trigger.vue"]]);const Axe=Se({name:"ElTooltipV2"}),Rxe=Se({...Axe,props:uxe,setup(e){const o=ei(e),i=Zn(Il(o,Object.keys(c2))),c=Zn(Il(o,Object.keys(u2))),u=Zn(Il(o,Object.keys(d2))),f=Zn(Il(o,Object.keys(h2)));return(p,m)=>(J(),He(fxe,bc(dm(u)),{default:Ne(({open:_})=>[Me(kxe,Nn(f,{nowrap:""}),{default:Ne(()=>[We(p.$slots,"trigger")]),_:3},16),(J(),He(Lm,{to:p.to,disabled:!p.teleported},[p.fullTransition?(J(),He(Rr,bc(Nn({key:0},p.transitionProps)),{default:Ne(()=>[p.alwaysOn||_?(J(),He(u$,bc(Nn({key:0},c)),{arrow:Ne(({style:b,side:S})=>[p.showArrow?(J(),He(c$,Nn({key:0},i,{style:b,side:S}),null,16,["style","side"])):Fe("v-if",!0)]),default:Ne(()=>[We(p.$slots,"default")]),_:3},16)):Fe("v-if",!0)]),_:2},1040)):(J(),ge(qt,{key:1},[p.alwaysOn||_?(J(),He(u$,bc(Nn({key:0},c)),{arrow:Ne(({style:b,side:S})=>[p.showArrow?(J(),He(c$,Nn({key:0},i,{style:b,side:S}),null,16,["style","side"])):Fe("v-if",!0)]),default:Ne(()=>[We(p.$slots,"default")]),_:3},16)):Fe("v-if",!0)],64))],8,["to","disabled"]))]),_:3},16))}});var wxe=vt(Rxe,[["__file","tooltip.vue"]]);const Dxe=bn(wxe),vW="left-check-change",_W="right-check-change",Kg=gt({data:{type:Le(Array),default:()=>[]},titles:{type:Le(Array),default:()=>[]},buttonTexts:{type:Le(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:Le(Function)},leftDefaultChecked:{type:Le(Array),default:()=>[]},rightDefaultChecked:{type:Le(Array),default:()=>[]},renderContent:{type:Le(Function)},modelValue:{type:Le(Array),default:()=>[]},format:{type:Le(Object),default:()=>({})},filterable:Boolean,props:{type:Le(Object),default:()=>zo({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),VO=(e,t)=>[e,t].every(At)||At(e)&&Hr(t),Oxe={[Lo]:(e,t,o)=>[e,o].every(At)&&["left","right"].includes(t),[Mn]:e=>At(e),[vW]:VO,[_W]:VO},GO="checked-change",Nxe=gt({data:Kg.data,optionRender:{type:Le(Function)},placeholder:String,title:String,filterable:Boolean,format:Kg.format,filterMethod:Kg.filterMethod,defaultChecked:Kg.leftDefaultChecked,props:Kg.props}),Lxe={[GO]:VO},TI=e=>{const t={label:"label",key:"key",disabled:"disabled"};return K(()=>({...t,...e.props}))},Pxe=(e,t,o)=>{const i=TI(e),c=K(()=>e.data.filter(b=>tn(e.filterMethod)?e.filterMethod(t.query,b):String(b[i.value.label]||b[i.value.key]).toLowerCase().includes(t.query.toLowerCase()))),u=K(()=>c.value.filter(b=>!b[i.value.disabled])),f=K(()=>{const b=t.checked.length,S=e.data.length,{noChecked:T,hasChecked:M}=e.format;return T&&M?b>0?M.replace(/\${checked}/g,b.toString()).replace(/\${total}/g,S.toString()):T.replace(/\${total}/g,S.toString()):`${b}/${S}`}),p=K(()=>{const b=t.checked.length;return b>0&&b<u.value.length}),m=()=>{const b=u.value.map(S=>S[i.value.key]);t.allChecked=b.length>0&&b.every(S=>t.checked.includes(S))},_=b=>{t.checked=b?u.value.map(S=>S[i.value.key]):[]};return rt(()=>t.checked,(b,S)=>{if(m(),t.checkChangeByUser){const T=b.concat(S).filter(M=>!b.includes(M)||!S.includes(M));o(GO,b,T)}else o(GO,b),t.checkChangeByUser=!0}),rt(u,()=>{m()}),rt(()=>e.data,()=>{const b=[],S=c.value.map(T=>T[i.value.key]);t.checked.forEach(T=>{S.includes(T)&&b.push(T)}),t.checkChangeByUser=!1,t.checked=b}),rt(()=>e.defaultChecked,(b,S)=>{if(S&&b.length===S.length&&b.every(R=>S.includes(R)))return;const T=[],M=u.value.map(R=>R[i.value.key]);b.forEach(R=>{M.includes(R)&&T.push(R)}),t.checkChangeByUser=!1,t.checked=T},{immediate:!0}),{filteredData:c,checkableData:u,checkedSummary:f,isIndeterminate:p,updateAllChecked:m,handleAllCheckedChange:_}},Uxe=(e,t)=>({onSourceCheckedChange:(c,u)=>{e.leftChecked=c,u&&t(vW,c,u)},onTargetCheckedChange:(c,u)=>{e.rightChecked=c,u&&t(_W,c,u)}}),xxe=e=>{const t=TI(e),o=K(()=>e.data.reduce((u,f)=>(u[f[t.value.key]]=f)&&u,{})),i=K(()=>e.data.filter(u=>!e.modelValue.includes(u[t.value.key]))),c=K(()=>e.targetOrder==="original"?e.data.filter(u=>e.modelValue.includes(u[t.value.key])):e.modelValue.reduce((u,f)=>{const p=o.value[f];return p&&u.push(p),u},[]));return{sourceData:i,targetData:c}},Fxe=(e,t,o)=>{const i=TI(e),c=(p,m,_)=>{o(Mn,p),o(Lo,p,m,_)};return{addToLeft:()=>{const p=e.modelValue.slice();t.rightChecked.forEach(m=>{const _=p.indexOf(m);_>-1&&p.splice(_,1)}),c(p,"left",t.rightChecked)},addToRight:()=>{let p=e.modelValue.slice();const m=e.data.filter(_=>{const b=_[i.value.key];return t.leftChecked.includes(b)&&!e.modelValue.includes(b)}).map(_=>_[i.value.key]);p=e.targetOrder==="unshift"?m.concat(p):p.concat(m),e.targetOrder==="original"&&(p=e.data.filter(_=>p.includes(_[i.value.key])).map(_=>_[i.value.key])),c(p,"right",t.leftChecked)}}},Vxe=Se({name:"ElTransferPanel"}),Gxe=Se({...Vxe,props:Nxe,emits:Lxe,setup(e,{expose:t,emit:o}){const i=e,c=zr(),u=({option:L})=>L,{t:f}=Kn(),p=lt("transfer"),m=Zn({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),_=TI(i),{filteredData:b,checkedSummary:S,isIndeterminate:T,handleAllCheckedChange:M}=Pxe(i,m,o),R=K(()=>!Ys(m.query)&&Ys(b.value)),E=K(()=>!Ys(c.default()[0].children)),{checked:N,allChecked:D,query:x}=ei(m);return t({query:x}),(L,F)=>(J(),ge("div",{class:ne(y(p).b("panel"))},[Ce("p",{class:ne(y(p).be("panel","header"))},[Me(y(aa),{modelValue:y(D),"onUpdate:modelValue":F[0]||(F[0]=H=>No(D)?D.value=H:null),indeterminate:y(T),"validate-event":!1,onChange:y(M)},{default:Ne(()=>[On(pt(L.title)+" ",1),Ce("span",null,pt(y(S)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),Ce("div",{class:ne([y(p).be("panel","body"),y(p).is("with-footer",y(E))])},[L.filterable?(J(),He(y(Ai),{key:0,modelValue:y(x),"onUpdate:modelValue":F[1]||(F[1]=H=>No(x)?x.value=H:null),class:ne(y(p).be("panel","filter")),size:"default",placeholder:L.placeholder,"prefix-icon":y(I_e),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):Fe("v-if",!0),hn(Me(y(SK),{modelValue:y(N),"onUpdate:modelValue":F[2]||(F[2]=H=>No(N)?N.value=H:null),"validate-event":!1,class:ne([y(p).is("filterable",L.filterable),y(p).be("panel","list")])},{default:Ne(()=>[(J(!0),ge(qt,null,Vn(y(b),H=>(J(),He(y(aa),{key:H[y(_).key],class:ne(y(p).be("panel","item")),value:H[y(_).key],disabled:H[y(_).disabled],"validate-event":!1},{default:Ne(()=>{var B;return[Me(u,{option:(B=L.optionRender)==null?void 0:B.call(L,H)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[Jn,!y(R)&&!y(Ys)(L.data)]]),hn(Ce("p",{class:ne(y(p).be("panel","empty"))},pt(y(R)?y(f)("el.transfer.noMatch"):y(f)("el.transfer.noData")),3),[[Jn,y(R)||y(Ys)(L.data)]])],2),y(E)?(J(),ge("p",{key:0,class:ne(y(p).be("panel","footer"))},[We(L.$slots,"default")],2)):Fe("v-if",!0)],2))}});var d$=vt(Gxe,[["__file","transfer-panel.vue"]]);const Bxe={key:0},$xe={key:0},Hxe=Se({name:"ElTransfer"}),qxe=Se({...Hxe,props:Kg,emits:Oxe,setup(e,{expose:t,emit:o}){const i=e,c=zr(),{t:u}=Kn(),f=lt("transfer"),{formItem:p}=Oi(),m=Zn({leftChecked:[],rightChecked:[]}),_=TI(i),{sourceData:b,targetData:S}=xxe(i),{onSourceCheckedChange:T,onTargetCheckedChange:M}=Uxe(m,o),{addToLeft:R,addToRight:E}=Fxe(i,m,o),N=ae(),D=ae(),x=W=>{switch(W){case"left":N.value.query="";break;case"right":D.value.query="";break}},L=K(()=>i.buttonTexts.length===2),F=K(()=>i.titles[0]||u("el.transfer.titles.0")),H=K(()=>i.titles[1]||u("el.transfer.titles.1")),B=K(()=>i.filterPlaceholder||u("el.transfer.filterPlaceholder"));rt(()=>i.modelValue,()=>{var W;i.validateEvent&&((W=p==null?void 0:p.validate)==null||W.call(p,"change").catch(Z=>void 0))});const z=K(()=>W=>i.renderContent?i.renderContent(Wt,W):c.default?c.default({option:W}):Wt("span",W[_.value.label]||W[_.value.key]));return t({clearQuery:x,leftPanel:N,rightPanel:D}),(W,Z)=>(J(),ge("div",{class:ne(y(f).b())},[Me(d$,{ref_key:"leftPanel",ref:N,data:y(b),"option-render":y(z),placeholder:y(B),title:y(F),filterable:W.filterable,format:W.format,"filter-method":W.filterMethod,"default-checked":W.leftDefaultChecked,props:i.props,onCheckedChange:y(T)},{default:Ne(()=>[We(W.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ce("div",{class:ne(y(f).e("buttons"))},[Me(y(qr),{type:"primary",class:ne([y(f).e("button"),y(f).is("with-texts",y(L))]),disabled:y(Ys)(m.rightChecked),onClick:y(R)},{default:Ne(()=>[Me(y(Gt),null,{default:Ne(()=>[Me(y(yd))]),_:1}),y(_r)(W.buttonTexts[0])?Fe("v-if",!0):(J(),ge("span",Bxe,pt(W.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Me(y(qr),{type:"primary",class:ne([y(f).e("button"),y(f).is("with-texts",y(L))]),disabled:y(Ys)(m.leftChecked),onClick:y(E)},{default:Ne(()=>[y(_r)(W.buttonTexts[1])?Fe("v-if",!0):(J(),ge("span",$xe,pt(W.buttonTexts[1]),1)),Me(y(Gt),null,{default:Ne(()=>[Me(y($i))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Me(d$,{ref_key:"rightPanel",ref:D,data:y(S),"option-render":y(z),placeholder:y(B),filterable:W.filterable,format:W.format,"filter-method":W.filterMethod,title:y(H),"default-checked":W.rightDefaultChecked,props:i.props,onCheckedChange:y(M)},{default:Ne(()=>[We(W.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Kxe=vt(qxe,[["__file","transfer.vue"]]);const zxe=bn(Kxe),cm="$treeNodeId",h$=function(e,t){!t||t[cm]||Object.defineProperty(t,cm,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},f2=function(e,t){return e?t[e]:t[cm]},BO=(e,t,o)=>{const i=e.value.currentNode;o();const c=e.value.currentNode;i!==c&&t("current-change",c?c.data:null,c)},$O=e=>{let t=!0,o=!0,i=!0;for(let c=0,u=e.length;c<u;c++){const f=e[c];(f.checked!==!0||f.indeterminate)&&(t=!1,f.disabled||(i=!1)),(f.checked!==!1||f.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:i,half:!t&&!o}},Yy=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:o,half:i}=$O(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):i?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const c=e.parent;!c||c.level===0||e.store.checkStrictly||Yy(c)},_T=function(e,t){const o=e.store.props,i=e.data||{},c=o[t];if(typeof c=="function")return c(i,e);if(typeof c=="string")return i[c];if(typeof c>"u"){const u=i[t];return u===void 0?"":u}};let Wxe=0,HO=class XT{constructor(t){this.id=Wxe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)qn(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf<"u"){const u=_T(this,"isLeaf");typeof u=="boolean"&&(this.isLeafByUser=u)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||h$(this,this.data),!this.data)return;const i=t.defaultExpandedKeys,c=t.key;c&&i&&i.includes(this.key)&&this.expand(null,t.autoExpandParent),c&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||h$(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&Array.isArray(this.data)?o=this.data:o=_T(this,"children")||[];for(let i=0,c=o.length;i<c;i++)this.insertChild({data:o[i]})}get label(){return _T(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return _T(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(i=>i===t||o&&i.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,i){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof XT)){if(!i){const c=this.getChildren(!0);c.includes(t.data)||(typeof o>"u"||o<0?c.push(t.data):c.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Zn(new XT(t)),t instanceof XT&&t.initialize()}t.level=this.level+1,typeof o>"u"||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let i;o&&(i=this.childNodes.indexOf(o)),this.insertChild(t,i)}insertAfter(t,o){let i;o&&(i=this.childNodes.indexOf(o),i!==-1&&(i+=1)),this.insertChild(t,i)}removeChild(t){const o=this.getChildren()||[],i=o.indexOf(t.data);i>-1&&o.splice(i,1);const c=this.childNodes.indexOf(t);c>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(c,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let i=0;i<this.childNodes.length;i++)if(this.childNodes[i].data===t){o=this.childNodes[i];break}o&&this.removeChild(o)}expand(t,o){const i=()=>{if(o){let c=this.parent;for(;c.level>0;)c.expanded=!0,c=c.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(c=>{c.canFocus=!0})};this.shouldLoadData()?this.loadData(c=>{Array.isArray(c)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Yy(this),i())}):i()}doCreateChildren(t,o={}){t.forEach(i=>{this.insertChild(Object.assign({data:i},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,o,i,c){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:f,allWithoutDisable:p}=$O(this.childNodes);!this.isLeaf&&!f&&p&&(this.checked=!1,t=!1);const m=()=>{if(o){const _=this.childNodes;for(let T=0,M=_.length;T<M;T++){const R=_[T];c=c||t!==!1;const E=R.disabled?R.checked:c;R.setChecked(E,o,!0,c)}const{half:b,all:S}=$O(_);S||(this.checked=S,this.indeterminate=b)}};if(this.shouldLoadData()){this.loadData(()=>{m(),Yy(this)},{checked:t!==!1});return}else m()}const u=this.parent;!u||u.level===0||i||Yy(u)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const i=this.store.props;let c="children";return i&&(c=i.children||"children"),o[c]===void 0&&(o[c]=null),t&&!o[c]&&(o[c]=[]),o[c]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(u=>u.data),i={},c=[];t.forEach((u,f)=>{const p=u[cm];!!p&&o.findIndex(_=>_[cm]===p)>=0?i[p]={index:f,data:u}:c.push({index:f,data:u})}),this.store.lazy||o.forEach(u=>{i[u[cm]]||this.removeChildByData(u)}),c.forEach(({index:u,data:f})=>{this.insertChild({data:f},u)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const i=u=>{this.childNodes=[],this.doCreateChildren(u,o),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,u)},c=()=>{this.loading=!1};this.store.load(this,i,c)}else t&&t.call(this)}eachNode(t){const o=[this];for(;o.length;){const i=o.shift();o.unshift(...i.childNodes),t(i)}}reInitChecked(){this.store.checkStrictly||Yy(this)}};class jxe{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const o in t)qn(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){if(this.root=new HO({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,i=this.lazy,c=function(u){const f=u.root?u.root.childNodes:u.childNodes;if(f.forEach(p=>{p.visible=o.call(p,t,p.data,p),c(p)}),!u.visible&&f.length){let p=!0;p=!f.some(m=>m.visible),u.root?u.root.visible=p===!1:u.visible=p===!1}t&&u.visible&&!u.isLeaf&&(!i||u.loaded)&&u.expand()};c(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof HO)return t;const o=En(t)?f2(this.key,t):t;return this.nodesMap[o]||null}insertBefore(t,o){const i=this.getNode(o);i.parent.insertBefore({data:t},i)}insertAfter(t,o){const i=this.getNode(o);i.parent.insertAfter({data:t},i)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const i=Yf(o)?this.root:this.getNode(o);i&&i.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(i=>{const c=o[i];c&&c.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(i=>{this.deregisterNode(i)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const i=[],c=function(u){(u.root?u.root.childNodes:u.childNodes).forEach(p=>{(p.checked||o&&p.indeterminate)&&(!t||t&&p.isLeaf)&&i.push(p.data),c(p)})};return c(this),i}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(i){(i.root?i.root.childNodes:i.childNodes).forEach(u=>{u.indeterminate&&t.push(u.data),o(u)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const i in o)qn(o,i)&&t.push(o[i]);return t}updateChildren(t,o){const i=this.nodesMap[t];if(!i)return;const c=i.childNodes;for(let u=c.length-1;u>=0;u--){const f=c[u];this.remove(f.data)}for(let u=0,f=o.length;u<f;u++){const p=o[u];this.append(p,i.data)}}_setCheckedKeys(t,o=!1,i){const c=this._getAllNodes().sort((m,_)=>m.level-_.level),u=Object.create(null),f=Object.keys(i);c.forEach(m=>m.setChecked(!1,!1));const p=m=>{m.childNodes.forEach(_=>{var b;u[_.data[t]]=!0,(b=_.childNodes)!=null&&b.length&&p(_)})};for(let m=0,_=c.length;m<_;m++){const b=c[m],S=b.data[t].toString();if(!f.includes(S)){b.checked&&!u[S]&&b.setChecked(!1,!1);continue}if(b.childNodes.length&&p(b),b.isLeaf||this.checkStrictly){b.setChecked(!0,!1);continue}if(b.setChecked(!0,!0),o){b.setChecked(!1,!1);const M=function(R){R.childNodes.forEach(N=>{N.isLeaf||N.setChecked(!1,!1),M(N)})};M(b)}}}setCheckedNodes(t,o=!1){const i=this.key,c={};t.forEach(u=>{c[(u||{})[i]]=!0}),this._setCheckedKeys(i,o,c)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const i=this.key,c={};t.forEach(u=>{c[u]=!0}),this._setCheckedKeys(i,o,c)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const i=this.getNode(o);i&&i.expand(null,this.autoExpandParent)})}setChecked(t,o,i){const c=this.getNode(t);c&&c.setChecked(!!o,i)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const i=t[this.key],c=this.nodesMap[i];this.setCurrentNode(c),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const i=this.getNode(t);i&&(this.setCurrentNode(i),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Yxe=Se({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=lt("tree"),o=wt("NodeInstance"),i=wt("RootTree");return()=>{const c=e.node,{data:u,store:f}=c;return e.renderContent?e.renderContent(Wt,{_self:o,node:c,data:u,store:f}):We(i.ctx.slots,"default",{node:c,data:u},()=>[Wt("span",{class:t.be("node","label")},[c.label])])}}});var Jxe=vt(Yxe,[["__file","tree-node-content.vue"]]);function yW(e){const t=wt("TreeNodeMap",null),o={treeNodeExpand:i=>{e.node!==i&&e.node.collapse()},children:[]};return t&&t.children.push(o),Ln("TreeNodeMap",o),{broadcastExpanded:i=>{if(e.accordion)for(const c of o.children)c.treeNodeExpand(i)}}}const IW=Symbol("dragEvents");function Xxe({props:e,ctx:t,el$:o,dropIndicator$:i,store:c}){const u=lt("tree"),f=ae({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Ln(IW,{treeNodeDragStart:({event:b,treeNode:S})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(S.node))return b.preventDefault(),!1;b.dataTransfer.effectAllowed="move";try{b.dataTransfer.setData("text/plain","")}catch{}f.value.draggingNode=S,t.emit("node-drag-start",S.node,b)},treeNodeDragOver:({event:b,treeNode:S})=>{const T=S,M=f.value.dropNode;M&&M.node.id!==T.node.id&&wi(M.$el,u.is("drop-inner"));const R=f.value.draggingNode;if(!R||!T)return;let E=!0,N=!0,D=!0,x=!0;typeof e.allowDrop=="function"&&(E=e.allowDrop(R.node,T.node,"prev"),x=N=e.allowDrop(R.node,T.node,"inner"),D=e.allowDrop(R.node,T.node,"next")),b.dataTransfer.dropEffect=N||E||D?"move":"none",(E||N||D)&&(M==null?void 0:M.node.id)!==T.node.id&&(M&&t.emit("node-drag-leave",R.node,M.node,b),t.emit("node-drag-enter",R.node,T.node,b)),E||N||D?f.value.dropNode=T:f.value.dropNode=null,T.node.nextSibling===R.node&&(D=!1),T.node.previousSibling===R.node&&(E=!1),T.node.contains(R.node,!1)&&(N=!1),(R.node===T.node||R.node.contains(T.node))&&(E=!1,N=!1,D=!1);const L=T.$el.querySelector(`.${u.be("node","content")}`).getBoundingClientRect(),F=o.value.getBoundingClientRect();let H;const B=E?N?.25:D?.45:1:-1,z=D?N?.75:E?.55:0:1;let W=-9999;const Z=b.clientY-L.top;Z<L.height*B?H="before":Z>L.height*z?H="after":N?H="inner":H="none";const $=T.$el.querySelector(`.${u.be("node","expand-icon")}`).getBoundingClientRect(),O=i.value;H==="before"?W=$.top-F.top:H==="after"&&(W=$.bottom-F.top),O.style.top=`${W}px`,O.style.left=`${$.right-F.left}px`,H==="inner"?Js(T.$el,u.is("drop-inner")):wi(T.$el,u.is("drop-inner")),f.value.showDropIndicator=H==="before"||H==="after",f.value.allowDrop=f.value.showDropIndicator||x,f.value.dropType=H,t.emit("node-drag-over",R.node,T.node,b)},treeNodeDragEnd:b=>{const{draggingNode:S,dropType:T,dropNode:M}=f.value;if(b.preventDefault(),b.dataTransfer.dropEffect="move",S&&M){const R={data:S.node.data};T!=="none"&&S.node.remove(),T==="before"?M.node.parent.insertBefore(R,M.node):T==="after"?M.node.parent.insertAfter(R,M.node):T==="inner"&&M.node.insertChild(R),T!=="none"&&(c.value.registerNode(R),c.value.key&&S.node.eachNode(E=>{var N;(N=c.value.nodesMap[E.data[c.value.key]])==null||N.setChecked(E.checked,!c.value.checkStrictly)})),wi(M.$el,u.is("drop-inner")),t.emit("node-drag-end",S.node,M.node,T,b),T!=="none"&&t.emit("node-drop",S.node,M.node,T,b)}S&&!M&&t.emit("node-drag-end",S.node,null,T,b),f.value.showDropIndicator=!1,f.value.draggingNode=null,f.value.dropNode=null,f.value.allowDrop=!0}}),{dragState:f}}const Qxe=Se({name:"ElTreeNode",components:{ElCollapseTransition:_1,ElCheckbox:aa,NodeContent:Jxe,ElIcon:Gt,Loading:Rd},props:{node:{type:HO,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=lt("tree"),{broadcastExpanded:i}=yW(e),c=wt("RootTree"),u=ae(!1),f=ae(!1),p=ae(null),m=ae(null),_=ae(null),b=wt(IW),S=In();Ln("NodeInstance",S),e.node.expanded&&(u.value=!0,f.value=!0);const T=c.props.props.children||"children";rt(()=>{const Z=e.node.data[T];return Z&&[...Z]},()=>{e.node.updateChildren()}),rt(()=>e.node.indeterminate,Z=>{E(e.node.checked,Z)}),rt(()=>e.node.checked,Z=>{E(Z,e.node.indeterminate)}),rt(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),rt(()=>e.node.expanded,Z=>{zt(()=>u.value=Z),Z&&(f.value=!0)});const M=Z=>f2(c.props.nodeKey,Z.data),R=Z=>{const $=e.props.class;if(!$)return{};let O;if(tn($)){const{data:X}=Z;O=$(X,Z)}else O=$;return on(O)?{[O]:!0}:O},E=(Z,$)=>{(p.value!==Z||m.value!==$)&&c.ctx.emit("check-change",e.node.data,Z,$),p.value=Z,m.value=$},N=Z=>{BO(c.store,c.ctx.emit,()=>c.store.value.setCurrentNode(e.node)),c.currentNode.value=e.node,c.props.expandOnClickNode&&x(),c.props.checkOnClickNode&&!e.node.disabled&&L(null,{target:{checked:!e.node.checked}}),c.ctx.emit("node-click",e.node.data,e.node,S,Z)},D=Z=>{c.instance.vnode.props.onNodeContextmenu&&(Z.stopPropagation(),Z.preventDefault()),c.ctx.emit("node-contextmenu",Z,e.node.data,e.node,S)},x=()=>{e.node.isLeaf||(u.value?(c.ctx.emit("node-collapse",e.node.data,e.node,S),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,S)))},L=(Z,$)=>{e.node.setChecked($.target.checked,!c.props.checkStrictly),zt(()=>{const O=c.store.value;c.ctx.emit("check",e.node.data,{checkedNodes:O.getCheckedNodes(),checkedKeys:O.getCheckedKeys(),halfCheckedNodes:O.getHalfCheckedNodes(),halfCheckedKeys:O.getHalfCheckedKeys()})})};return{ns:o,node$:_,tree:c,expanded:u,childNodeRendered:f,oldChecked:p,oldIndeterminate:m,getNodeKey:M,getNodeClass:R,handleSelectChange:E,handleClick:N,handleContextMenu:D,handleExpandIconClick:x,handleCheckChange:L,handleChildNodeExpand:(Z,$,O)=>{i($),c.ctx.emit("node-expand",Z,$,O)},handleDragStart:Z=>{c.props.draggable&&b.treeNodeDragStart({event:Z,treeNode:e})},handleDragOver:Z=>{Z.preventDefault(),c.props.draggable&&b.treeNodeDragOver({event:Z,treeNode:{$el:_.value,node:e.node}})},handleDrop:Z=>{Z.preventDefault()},handleDragEnd:Z=>{c.props.draggable&&b.treeNodeDragEnd(Z)},CaretRight:Fq}}}),Zxe=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],e3e=["aria-expanded"];function t3e(e,t,o,i,c,u){const f=pn("el-icon"),p=pn("el-checkbox"),m=pn("loading"),_=pn("node-content"),b=pn("el-tree-node"),S=pn("el-collapse-transition");return hn((J(),ge("div",{ref:"node$",class:ne([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=nn((...T)=>e.handleClick&&e.handleClick(...T),["stop"])),onContextmenu:t[2]||(t[2]=(...T)=>e.handleContextMenu&&e.handleContextMenu(...T)),onDragstart:t[3]||(t[3]=nn((...T)=>e.handleDragStart&&e.handleDragStart(...T),["stop"])),onDragover:t[4]||(t[4]=nn((...T)=>e.handleDragOver&&e.handleDragOver(...T),["stop"])),onDragend:t[5]||(t[5]=nn((...T)=>e.handleDragEnd&&e.handleDragEnd(...T),["stop"])),onDrop:t[6]||(t[6]=nn((...T)=>e.handleDrop&&e.handleDrop(...T),["stop"]))},[Ce("div",{class:ne(e.ns.be("node","content")),style:Ht({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(J(),He(f,{key:0,class:ne([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:nn(e.handleExpandIconClick,["stop"])},{default:Ne(()=>[(J(),He(wn(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):Fe("v-if",!0),e.showCheckbox?(J(),He(p,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=nn(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):Fe("v-if",!0),e.node.loading?(J(),He(f,{key:2,class:ne([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:Ne(()=>[Me(m)]),_:1},8,["class"])):Fe("v-if",!0),Me(_,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Me(S,null,{default:Ne(()=>[!e.renderAfterExpand||e.childNodeRendered?hn((J(),ge("div",{key:0,class:ne(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(J(!0),ge(qt,null,Vn(e.node.childNodes,T=>(J(),He(b,{key:e.getNodeKey(T),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:T,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,e3e)),[[Jn,e.expanded]]):Fe("v-if",!0)]),_:1})],42,Zxe)),[[Jn,e.node.visible]])}var n3e=vt(Qxe,[["render",t3e],["__file","tree-node.vue"]]);function o3e({el$:e},t){const o=lt("tree"),i=Do([]),c=Do([]);fn(()=>{f()}),Oc(()=>{i.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),c.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),rt(c,p=>{p.forEach(m=>{m.setAttribute("tabindex","-1")})}),Oo(e,"keydown",p=>{const m=p.target;if(!m.className.includes(o.b("node")))return;const _=p.code;i.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));const b=i.value.indexOf(m);let S;if([Yt.up,Yt.down].includes(_)){if(p.preventDefault(),_===Yt.up){S=b===-1?0:b!==0?b-1:i.value.length-1;const M=S;for(;!t.value.getNode(i.value[S].dataset.key).canFocus;){if(S--,S===M){S=-1;break}S<0&&(S=i.value.length-1)}}else{S=b===-1?0:b<i.value.length-1?b+1:0;const M=S;for(;!t.value.getNode(i.value[S].dataset.key).canFocus;){if(S++,S===M){S=-1;break}S>=i.value.length&&(S=0)}}S!==-1&&i.value[S].focus()}[Yt.left,Yt.right].includes(_)&&(p.preventDefault(),m.click());const T=m.querySelector('[type="checkbox"]');[Yt.enter,Yt.space].includes(_)&&T&&(p.preventDefault(),T.click())});const f=()=>{var p;i.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),c.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const m=e.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(m.length){m[0].setAttribute("tabindex","0");return}(p=i.value[0])==null||p.setAttribute("tabindex","0")}}const r3e=Se({name:"ElTree",components:{ElTreeNode:n3e},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:mo}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=Kn(),i=lt("tree"),c=wt(Km,null),u=ae(new jxe({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));u.value.initialize();const f=ae(u.value.root),p=ae(null),m=ae(null),_=ae(null),{broadcastExpanded:b}=yW(e),{dragState:S}=Xxe({props:e,ctx:t,el$:m,dropIndicator$:_,store:u});o3e({el$:m},u);const T=K(()=>{const{childNodes:oe}=f.value,ee=c?c.hasFilteredOptions!==0:!1;return(!oe||oe.length===0||oe.every(({visible:Q})=>!Q))&&!ee});rt(()=>e.currentNodeKey,oe=>{u.value.setCurrentNodeKey(oe)}),rt(()=>e.defaultCheckedKeys,oe=>{u.value.setDefaultCheckedKey(oe)}),rt(()=>e.defaultExpandedKeys,oe=>{u.value.setDefaultExpandedKeys(oe)}),rt(()=>e.data,oe=>{u.value.setData(oe)},{deep:!0}),rt(()=>e.checkStrictly,oe=>{u.value.checkStrictly=oe});const M=oe=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");u.value.filter(oe)},R=oe=>f2(e.nodeKey,oe.data),E=oe=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const ee=u.value.getNode(oe);if(!ee)return[];const Q=[ee.data];let ue=ee.parent;for(;ue&&ue!==f.value;)Q.push(ue.data),ue=ue.parent;return Q.reverse()},N=(oe,ee)=>u.value.getCheckedNodes(oe,ee),D=oe=>u.value.getCheckedKeys(oe),x=()=>{const oe=u.value.getCurrentNode();return oe?oe.data:null},L=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const oe=x();return oe?oe[e.nodeKey]:null},F=(oe,ee)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");u.value.setCheckedNodes(oe,ee)},H=(oe,ee)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");u.value.setCheckedKeys(oe,ee)},B=(oe,ee,Q)=>{u.value.setChecked(oe,ee,Q)},z=()=>u.value.getHalfCheckedNodes(),W=()=>u.value.getHalfCheckedKeys(),Z=(oe,ee=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");BO(u,t.emit,()=>u.value.setUserCurrentNode(oe,ee))},$=(oe,ee=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");BO(u,t.emit,()=>u.value.setCurrentNodeKey(oe,ee))},O=oe=>u.value.getNode(oe),X=oe=>{u.value.remove(oe)},le=(oe,ee)=>{u.value.append(oe,ee)},de=(oe,ee)=>{u.value.insertBefore(oe,ee)},he=(oe,ee)=>{u.value.insertAfter(oe,ee)},se=(oe,ee,Q)=>{b(ee),t.emit("node-expand",oe,ee,Q)},ie=(oe,ee)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");u.value.updateChildren(oe,ee)};return Ln("RootTree",{ctx:t,props:e,store:u,root:f,currentNode:p,instance:In()}),Ln(kl,void 0),{ns:i,store:u,root:f,currentNode:p,dragState:S,el$:m,dropIndicator$:_,isEmpty:T,filter:M,getNodeKey:R,getNodePath:E,getCheckedNodes:N,getCheckedKeys:D,getCurrentNode:x,getCurrentKey:L,setCheckedNodes:F,setCheckedKeys:H,setChecked:B,getHalfCheckedNodes:z,getHalfCheckedKeys:W,setCurrentNode:Z,setCurrentKey:$,t:o,getNode:O,remove:X,append:le,insertBefore:de,insertAfter:he,handleNodeExpand:se,updateKeyChildren:ie}}});function i3e(e,t,o,i,c,u){const f=pn("el-tree-node");return J(),ge("div",{ref:"el$",class:ne([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(J(!0),ge(qt,null,Vn(e.root.childNodes,p=>(J(),He(f,{key:e.getNodeKey(p),node:p,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(J(),ge("div",{key:0,class:ne(e.ns.e("empty-block"))},[We(e.$slots,"empty",{},()=>{var p;return[Ce("span",{class:ne(e.ns.e("empty-text"))},pt((p=e.emptyText)!=null?p:e.t("el.tree.emptyText")),3)]})],2)):Fe("v-if",!0),hn(Ce("div",{ref:"dropIndicator$",class:ne(e.ns.e("drop-indicator"))},null,2),[[Jn,e.dragState.showDropIndicator]])],2)}var QT=vt(r3e,[["render",i3e],["__file","tree.vue"]]);QT.install=e=>{e.component(QT.name,QT)};const xE=QT,s3e=xE,a3e=(e,{attrs:t,emit:o},{select:i,tree:c,key:u})=>{const f=lt("tree-select");return rt(()=>e.data,()=>{e.filterable&&zt(()=>{var m,_;(_=c.value)==null||_.filter((m=i.value)==null?void 0:m.states.inputValue)})},{flush:"post"}),{...Il(ei(e),Object.keys(Zf.props)),...t,"onUpdate:modelValue":m=>o(Mn,m),valueKey:u,popperClass:K(()=>{const m=[f.e("popper")];return e.popperClass&&m.push(e.popperClass),m.join(" ")}),filterMethod:(m="")=>{var _;e.filterMethod?e.filterMethod(m):e.remoteMethod?e.remoteMethod(m):(_=c.value)==null||_.filter(m)}}},l3e=Se({extends:RE,setup(e,t){const o=RE.setup(e,t);delete o.selectOptionClick;const i=In().proxy;return zt(()=>{o.select.states.cachedOptions.get(i.value)||o.select.onOptionCreate(i)}),o},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function qO(e){return e||e===0}function p2(e){return Array.isArray(e)&&e.length}function Ky(e){return Array.isArray(e)?e:qO(e)?[e]:[]}function ZT(e,t,o,i,c){for(let u=0;u<e.length;u++){const f=e[u];if(t(f,u,e,c))return i?i(f,u,e,c):f;{const p=o(f);if(p2(p)){const m=ZT(p,t,o,i,f);if(m)return m}}}}function KO(e,t,o,i){for(let c=0;c<e.length;c++){const u=e[c];t(u,c,e,i);const f=o(u);p2(f)&&KO(f,t,o,u)}}const c3e=(e,{attrs:t,slots:o,emit:i},{select:c,tree:u,key:f})=>{rt(()=>e.modelValue,()=>{e.showCheckbox&&zt(()=>{const S=u.value;S&&!Ri(S.getCheckedKeys(),Ky(e.modelValue))&&S.setCheckedKeys(Ky(e.modelValue))})},{immediate:!0,deep:!0});const p=K(()=>({value:f.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),m=(S,T)=>{var M;const R=p.value[S];return tn(R)?R(T,(M=u.value)==null?void 0:M.getNode(m("value",T))):T[R]},_=Ky(e.modelValue).map(S=>ZT(e.data||[],T=>m("value",T)===S,T=>m("children",T),(T,M,R,E)=>E&&m("value",E))).filter(S=>qO(S)),b=K(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const S=[];return KO(e.data.concat(e.cacheData),T=>{const M=m("value",T);S.push({value:M,currentLabel:m("label",T),isDisabled:m("disabled",T)})},T=>m("children",T)),S});return{...Il(ei(e),Object.keys(xE.props)),...t,nodeKey:f,expandOnClickNode:K(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:K(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(_):_),renderContent:(S,{node:T,data:M,store:R})=>S(l3e,{value:m("value",M),label:m("label",M),disabled:m("disabled",M)},e.renderContent?()=>e.renderContent(S,{node:T,data:M,store:R}):o.default?()=>o.default({node:T,data:M,store:R}):void 0),filterNodeMethod:(S,T,M)=>e.filterNodeMethod?e.filterNodeMethod(S,T,M):S?new RegExp(ZN(S),"i").test(m("label",T)||""):!0,onNodeClick:(S,T,M)=>{var R,E,N,D;if((R=t.onNodeClick)==null||R.call(t,S,T,M),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||T.isLeaf)){if(!m("disabled",S)){const x=(E=c.value)==null?void 0:E.states.options.get(m("value",S));(N=c.value)==null||N.handleOptionSelect(x)}}else e.expandOnClickNode&&M.proxy.handleExpandIconClick();(D=c.value)==null||D.focus()}},onCheck:(S,T)=>{var M;if(!e.showCheckbox)return;const R=m("value",S),E={};KO([u.value.store.root],L=>E[L.key]=L,L=>L.childNodes);const N=T.checkedKeys,D=e.multiple?Ky(e.modelValue).filter(L=>!(L in E)&&!N.includes(L)):[],x=D.concat(N);if(e.checkStrictly)i(Mn,e.multiple?x:x.includes(R)?R:void 0);else if(e.multiple)i(Mn,D.concat(u.value.getCheckedKeys(!0)));else{const L=ZT([S],B=>!p2(m("children",B))&&!m("disabled",B),B=>m("children",B)),F=L?m("value",L):void 0,H=qO(e.modelValue)&&!!ZT([S],B=>m("value",B)===e.modelValue,B=>m("children",B));i(Mn,F===e.modelValue||H?void 0:F)}zt(()=>{var L;const F=Ky(e.modelValue);u.value.setCheckedKeys(F),(L=t.onCheck)==null||L.call(t,S,{checkedKeys:u.value.getCheckedKeys(),checkedNodes:u.value.getCheckedNodes(),halfCheckedKeys:u.value.getHalfCheckedKeys(),halfCheckedNodes:u.value.getHalfCheckedNodes()})}),(M=c.value)==null||M.focus()},cacheOptions:b}};var u3e=Se({props:{data:{type:Array,default:()=>[]}},setup(e){const t=wt(Km);return rt(()=>e.data,()=>{var o;e.data.forEach(c=>{t.states.cachedOptions.has(c.value)||t.states.cachedOptions.set(c.value,c)});const i=((o=t.selectRef)==null?void 0:o.querySelectorAll("input"))||[];Array.from(i).includes(document.activeElement)||t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const d3e=Se({name:"ElTreeSelect",inheritAttrs:!1,props:{...Zf.props,...xE.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:o,expose:i}=t,c=ae(),u=ae(),f=K(()=>e.nodeKey||e.valueKey||"value"),p=a3e(e,t,{select:c,tree:u,key:f}),{cacheOptions:m,..._}=c3e(e,t,{select:c,tree:u,key:f}),b=Zn({});return i(b),fn(()=>{Object.assign(b,{...Il(u.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Il(c.value,["focus","blur"])})}),()=>Wt(Zf,Zn({...p,ref:S=>c.value=S}),{...o,default:()=>[Wt(u3e,{data:m.value}),Wt(xE,Zn({..._,ref:S=>u.value=S}))]})}});var eE=vt(d3e,[["__file","tree-select.vue"]]);eE.install=e=>{e.component(eE.name,eE)};const h3e=eE,f3e=h3e,g2=Symbol(),p3e={key:-1,level:-1,data:{}};var Jy=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e))(Jy||{}),zO=(e=>(e.ADD="add",e.DELETE="delete",e))(zO||{});const bW={type:Number,default:26},g3e=gt({data:{type:Le(Array),default:()=>zo([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:Le(Object),default:()=>zo({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Le(Array),default:()=>zo([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:Le(Array),default:()=>zo([])},indent:{type:Number,default:16},itemSize:bW,icon:{type:mo},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:Le([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:Le(Function)},perfMode:{type:Boolean,default:!0}}),m3e=gt({node:{type:Le(Object),default:()=>zo(p3e)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:bW}),v3e=gt({node:{type:Le(Object),required:!0}}),CW="node-click",SW="node-expand",TW="node-collapse",EW="current-change",MW="check",kW="check-change",AW="node-contextmenu",_3e={[CW]:(e,t,o)=>e&&t&&o,[SW]:(e,t)=>e&&t,[TW]:(e,t)=>e&&t,[EW]:(e,t)=>e&&t,[MW]:(e,t)=>e&&t,[kW]:(e,t)=>e&&typeof t=="boolean",[AW]:(e,t,o)=>e&&t&&o},y3e={click:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&typeof t=="boolean"};function I3e(e,t){const o=ae(new Set),i=ae(new Set),{emit:c}=In();rt([()=>t.value,()=>e.defaultCheckedKeys],()=>zt(()=>{x(e.defaultCheckedKeys)}),{immediate:!0});const u=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:L,maxLevel:F}=t.value,H=o.value,B=new Set;for(let z=F-1;z>=1;--z){const W=L.get(z);W&&W.forEach(Z=>{const $=Z.children;if($){let O=!0,X=!1;for(const le of $){const de=le.key;if(H.has(de))X=!0;else if(B.has(de)){O=!1,X=!0;break}else O=!1}O?H.add(Z.key):X?(B.add(Z.key),H.delete(Z.key)):(H.delete(Z.key),B.delete(Z.key))}})}i.value=B},f=L=>o.value.has(L.key),p=L=>i.value.has(L.key),m=(L,F,H=!0)=>{const B=o.value,z=(W,Z)=>{B[Z?zO.ADD:zO.DELETE](W.key);const $=W.children;!e.checkStrictly&&$&&$.forEach(O=>{O.disabled||z(O,Z)})};z(L,F),u(),H&&_(L,F)},_=(L,F)=>{const{checkedNodes:H,checkedKeys:B}=R(),{halfCheckedNodes:z,halfCheckedKeys:W}=E();c(MW,L.data,{checkedKeys:B,checkedNodes:H,halfCheckedKeys:W,halfCheckedNodes:z}),c(kW,L.data,F)};function b(L=!1){return R(L).checkedKeys}function S(L=!1){return R(L).checkedNodes}function T(){return E().halfCheckedKeys}function M(){return E().halfCheckedNodes}function R(L=!1){const F=[],H=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:B}=t.value;o.value.forEach(z=>{const W=B.get(z);W&&(!L||L&&W.isLeaf)&&(H.push(z),F.push(W.data))})}return{checkedKeys:H,checkedNodes:F}}function E(){const L=[],F=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:H}=t.value;i.value.forEach(B=>{const z=H.get(B);z&&(F.push(B),L.push(z.data))})}return{halfCheckedNodes:L,halfCheckedKeys:F}}function N(L){o.value.clear(),i.value.clear(),zt(()=>{x(L)})}function D(L,F){if(t!=null&&t.value&&e.showCheckbox){const H=t.value.treeNodeMap.get(L);H&&m(H,F,!1)}}function x(L){if(t!=null&&t.value){const{treeNodeMap:F}=t.value;if(e.showCheckbox&&F&&L)for(const H of L){const B=F.get(H);B&&!f(B)&&m(B,!0,!1)}}}return{updateCheckedKeys:u,toggleCheckbox:m,isChecked:f,isIndeterminate:p,getCheckedKeys:b,getCheckedNodes:S,getHalfCheckedKeys:T,getHalfCheckedNodes:M,setChecked:D,setCheckedKeys:N}}function b3e(e,t){const o=ae(new Set([])),i=ae(new Set([])),c=K(()=>tn(e.filterMethod));function u(p){var m;if(!c.value)return;const _=new Set,b=i.value,S=o.value,T=[],M=((m=t.value)==null?void 0:m.treeNodes)||[],R=e.filterMethod;S.clear();function E(N){N.forEach(D=>{T.push(D),R!=null&&R(p,D.data)?T.forEach(L=>{_.add(L.key)}):D.isLeaf&&S.add(D.key);const x=D.children;if(x&&E(x),!D.isLeaf){if(!_.has(D.key))S.add(D.key);else if(x){let L=!0;for(const F of x)if(!S.has(F.key)){L=!1;break}L?b.add(D.key):b.delete(D.key)}}T.pop()})}return E(M),_}function f(p){return i.value.has(p.key)}return{hiddenExpandIconKeySet:i,hiddenNodeKeySet:o,doFilter:u,isForceHiddenExpandIcon:f}}function C3e(e,t){const o=ae(new Set(e.defaultExpandedKeys)),i=ae(),c=Do();rt(()=>e.currentNodeKey,we=>{i.value=we},{immediate:!0}),rt(()=>e.data,we=>{Oe(we)},{immediate:!0});const{isIndeterminate:u,isChecked:f,toggleCheckbox:p,getCheckedKeys:m,getCheckedNodes:_,getHalfCheckedKeys:b,getHalfCheckedNodes:S,setChecked:T,setCheckedKeys:M}=I3e(e,c),{doFilter:R,hiddenNodeKeySet:E,isForceHiddenExpandIcon:N}=b3e(e,c),D=K(()=>{var we;return((we=e.props)==null?void 0:we.value)||Jy.KEY}),x=K(()=>{var we;return((we=e.props)==null?void 0:we.children)||Jy.CHILDREN}),L=K(()=>{var we;return((we=e.props)==null?void 0:we.disabled)||Jy.DISABLED}),F=K(()=>{var we;return((we=e.props)==null?void 0:we.label)||Jy.LABEL}),H=K(()=>{const we=o.value,Ge=E.value,Ve=[],qe=c.value&&c.value.treeNodes||[];function st(){const Ie=[];for(let Ae=qe.length-1;Ae>=0;--Ae)Ie.push(qe[Ae]);for(;Ie.length;){const Ae=Ie.pop();if(Ae&&(Ge.has(Ae.key)||Ve.push(Ae),we.has(Ae.key))){const xe=Ae.children;if(xe){const ot=xe.length;for(let je=ot-1;je>=0;--je)Ie.push(xe[je])}}}}return st(),Ve}),B=K(()=>H.value.length>0);function z(we){const Ge=new Map,Ve=new Map;let qe=1;function st(Ae,xe=1,ot=void 0){var je;const at=[];for(const ht of Ae){const dt=$(ht),ft={level:xe,key:dt,data:ht};ft.label=X(ht),ft.parent=ot;const Je=Z(ht);ft.disabled=O(ht),ft.isLeaf=!Je||Je.length===0,Je&&Je.length&&(ft.children=st(Je,xe+1,ft)),at.push(ft),Ge.set(dt,ft),Ve.has(xe)||Ve.set(xe,[]),(je=Ve.get(xe))==null||je.push(ft)}return xe>qe&&(qe=xe),at}const Ie=st(we);return{treeNodeMap:Ge,levelTreeNodeMap:Ve,maxLevel:qe,treeNodes:Ie}}function W(we){const Ge=R(we);Ge&&(o.value=Ge)}function Z(we){return we[x.value]}function $(we){return we?we[D.value]:""}function O(we){return we[L.value]}function X(we){return we[F.value]}function le(we){o.value.has(we.key)?ee(we):oe(we)}function de(we){o.value=new Set(we)}function he(we,Ge){t(CW,we.data,we,Ge),se(we),e.expandOnClickNode&&le(we),e.showCheckbox&&e.checkOnClickNode&&!we.disabled&&p(we,!f(we),!0)}function se(we){me(we)||(i.value=we.key,t(EW,we.data,we))}function ie(we,Ge){p(we,Ge)}function oe(we){const Ge=o.value;if(c.value&&e.accordion){const{treeNodeMap:Ve}=c.value;Ge.forEach(qe=>{const st=Ve.get(qe);we&&we.level===(st==null?void 0:st.level)&&Ge.delete(qe)})}Ge.add(we.key),t(SW,we.data,we)}function ee(we){o.value.delete(we.key),t(TW,we.data,we)}function Q(we){return o.value.has(we.key)}function ue(we){return!!we.disabled}function me(we){const Ge=i.value;return Ge!==void 0&&Ge===we.key}function be(){var we,Ge;if(i.value)return(Ge=(we=c.value)==null?void 0:we.treeNodeMap.get(i.value))==null?void 0:Ge.data}function ke(){return i.value}function Ye(we){i.value=we}function Oe(we){zt(()=>c.value=z(we))}function Ee(we){var Ge;const Ve=En(we)?$(we):we;return(Ge=c.value)==null?void 0:Ge.treeNodeMap.get(Ve)}return{tree:c,flattenTree:H,isNotEmpty:B,getKey:$,getChildren:Z,toggleExpand:le,toggleCheckbox:p,isExpanded:Q,isChecked:f,isIndeterminate:u,isDisabled:ue,isCurrent:me,isForceHiddenExpandIcon:N,handleNodeClick:he,handleNodeCheck:ie,getCurrentNode:be,getCurrentKey:ke,setCurrentKey:Ye,getCheckedKeys:m,getCheckedNodes:_,getHalfCheckedKeys:b,getHalfCheckedNodes:S,setChecked:T,setCheckedKeys:M,filter:W,setData:Oe,getNode:Ee,expandNode:oe,collapseNode:ee,setExpandedKeys:de}}var S3e=Se({name:"ElTreeNodeContent",props:v3e,setup(e){const t=wt(g2),o=lt("tree");return()=>{const i=e.node,{data:c}=i;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:i,data:c}):Wt("span",{class:o.be("node","label")},[i==null?void 0:i.label])}}});const T3e=["aria-expanded","aria-disabled","aria-checked","data-key","onClick"],E3e=Se({name:"ElTreeNode"}),M3e=Se({...E3e,props:m3e,emits:y3e,setup(e,{emit:t}){const o=e,i=wt(g2),c=lt("tree"),u=K(()=>{var S;return(S=i==null?void 0:i.props.indent)!=null?S:16}),f=K(()=>{var S;return(S=i==null?void 0:i.props.icon)!=null?S:Fq}),p=S=>{t("click",o.node,S)},m=()=>{t("toggle",o.node)},_=S=>{t("check",o.node,S)},b=S=>{var T,M,R,E;(R=(M=(T=i==null?void 0:i.instance)==null?void 0:T.vnode)==null?void 0:M.props)!=null&&R.onNodeContextmenu&&(S.stopPropagation(),S.preventDefault()),i==null||i.ctx.emit(AW,S,(E=o.node)==null?void 0:E.data,o.node)};return(S,T)=>{var M,R,E;return J(),ge("div",{ref:"node$",class:ne([y(c).b("node"),y(c).is("expanded",S.expanded),y(c).is("current",S.current),y(c).is("focusable",!S.disabled),y(c).is("checked",!S.disabled&&S.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":S.expanded,"aria-disabled":S.disabled,"aria-checked":S.checked,"data-key":(M=S.node)==null?void 0:M.key,onClick:nn(p,["stop"]),onContextmenu:b},[Ce("div",{class:ne(y(c).be("node","content")),style:Ht({paddingLeft:`${(S.node.level-1)*y(u)}px`,height:S.itemSize+"px"})},[y(f)?(J(),He(y(Gt),{key:0,class:ne([y(c).is("leaf",!!((R=S.node)!=null&&R.isLeaf)),y(c).is("hidden",S.hiddenExpandIcon),{expanded:!((E=S.node)!=null&&E.isLeaf)&&S.expanded},y(c).be("node","expand-icon")]),onClick:nn(m,["stop"])},{default:Ne(()=>[(J(),He(wn(y(f))))]),_:1},8,["class","onClick"])):Fe("v-if",!0),S.showCheckbox?(J(),He(y(aa),{key:1,"model-value":S.checked,indeterminate:S.indeterminate,disabled:S.disabled,onChange:_,onClick:T[0]||(T[0]=nn(()=>{},["stop"]))},null,8,["model-value","indeterminate","disabled"])):Fe("v-if",!0),Me(y(S3e),{node:S.node},null,8,["node"])],6)],42,T3e)}}});var k3e=vt(M3e,[["__file","tree-node.vue"]]);const A3e=Se({name:"ElTreeV2"}),R3e=Se({...A3e,props:g3e,emits:_3e,setup(e,{expose:t,emit:o}){const i=e,c=zr(),u=K(()=>i.itemSize);Ln(g2,{ctx:{emit:o,slots:c},props:i,instance:In()}),Ln(kl,void 0);const{t:f}=Kn(),p=lt("tree"),{flattenTree:m,isNotEmpty:_,toggleExpand:b,isExpanded:S,isIndeterminate:T,isChecked:M,isDisabled:R,isCurrent:E,isForceHiddenExpandIcon:N,handleNodeClick:D,handleNodeCheck:x,toggleCheckbox:L,getCurrentNode:F,getCurrentKey:H,setCurrentKey:B,getCheckedKeys:z,getCheckedNodes:W,getHalfCheckedKeys:Z,getHalfCheckedNodes:$,setChecked:O,setCheckedKeys:X,filter:le,setData:de,getNode:he,expandNode:se,collapseNode:ie,setExpandedKeys:oe}=C3e(i,o);return t({toggleCheckbox:L,getCurrentNode:F,getCurrentKey:H,setCurrentKey:B,getCheckedKeys:z,getCheckedNodes:W,getHalfCheckedKeys:Z,getHalfCheckedNodes:$,setChecked:O,setCheckedKeys:X,filter:le,setData:de,getNode:he,expandNode:se,collapseNode:ie,setExpandedKeys:oe}),(ee,Q)=>{var ue;return J(),ge("div",{class:ne([y(p).b(),{[y(p).m("highlight-current")]:ee.highlightCurrent}]),role:"tree"},[y(_)?(J(),He(y(Nz),{key:0,"class-name":y(p).b("virtual-list"),data:y(m),total:y(m).length,height:ee.height,"item-size":y(u),"perf-mode":ee.perfMode},{default:Ne(({data:me,index:be,style:ke})=>[(J(),He(k3e,{key:me[be].key,style:Ht(ke),node:me[be],expanded:y(S)(me[be]),"show-checkbox":ee.showCheckbox,checked:y(M)(me[be]),indeterminate:y(T)(me[be]),"item-size":y(u),disabled:y(R)(me[be]),current:y(E)(me[be]),"hidden-expand-icon":y(N)(me[be]),onClick:y(D),onToggle:y(b),onCheck:y(x)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(J(),ge("div",{key:1,class:ne(y(p).e("empty-block"))},[Ce("span",{class:ne(y(p).e("empty-text"))},pt((ue=ee.emptyText)!=null?ue:y(f)("el.tree.emptyText")),3)],2))],2)}}});var w3e=vt(R3e,[["__file","tree.vue"]]);const D3e=bn(w3e),RW=Symbol("uploadContextKey"),O3e="ElUpload";class N3e extends Error{constructor(t,o,i,c){super(t),this.name="UploadAjaxError",this.status=o,this.method=i,this.url=c}}function f$(e,t,o){let i;return o.response?i=`${o.response.error||o.response}`:o.responseText?i=`${o.responseText}`:i=`fail to ${t.method} ${e} ${o.status}`,new N3e(i,o.status,t.method,e)}function L3e(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const P3e=e=>{typeof XMLHttpRequest>"u"&&wr(O3e,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,o=e.action;t.upload&&t.upload.addEventListener("progress",u=>{const f=u;f.percent=u.total>0?u.loaded/u.total*100:0,e.onProgress(f)});const i=new FormData;if(e.data)for(const[u,f]of Object.entries(e.data))At(f)&&f.length?i.append(u,...f):i.append(u,f);i.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(f$(o,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(f$(o,e,t));e.onSuccess(L3e(t))}),t.open(e.method,o,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const c=e.headers||{};if(c instanceof Headers)c.forEach((u,f)=>t.setRequestHeader(f,u));else for(const[u,f]of Object.entries(c))Hr(f)||t.setRequestHeader(u,String(f));return t.send(i),t},wW=["text","picture","picture-card"];let U3e=1;const WO=()=>Date.now()+U3e++,DW=gt({action:{type:String,default:"#"},headers:{type:Le(Object)},method:{type:String,default:"post"},data:{type:Le([Object,Function,Promise]),default:()=>zo({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Le(Array),default:()=>zo([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:wW,default:"text"},httpRequest:{type:Le(Function),default:P3e},disabled:Boolean,limit:Number}),x3e=gt({...DW,beforeUpload:{type:Le(Function),default:co},beforeRemove:{type:Le(Function)},onRemove:{type:Le(Function),default:co},onChange:{type:Le(Function),default:co},onPreview:{type:Le(Function),default:co},onSuccess:{type:Le(Function),default:co},onProgress:{type:Le(Function),default:co},onError:{type:Le(Function),default:co},onExceed:{type:Le(Function),default:co},crossorigin:{type:Le(String)}}),F3e=gt({files:{type:Le(Array),default:()=>zo([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Le(Function),default:co},listType:{type:String,values:wW,default:"text"},crossorigin:{type:Le(String)}}),V3e={remove:e=>!!e},G3e=["onKeydown"],B3e=["src","crossorigin"],$3e=["onClick"],H3e=["title"],q3e=["onClick"],K3e=["onClick"],z3e=Se({name:"ElUploadList"}),W3e=Se({...z3e,props:F3e,emits:V3e,setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=lt("upload"),u=lt("icon"),f=lt("list"),p=zi(),m=ae(!1),_=K(()=>[c.b("list"),c.bm("list",o.listType),c.is("disabled",o.disabled)]),b=S=>{t("remove",S)};return(S,T)=>(J(),He(NH,{tag:"ul",class:ne(y(_)),name:y(f).b()},{default:Ne(()=>[(J(!0),ge(qt,null,Vn(S.files,M=>(J(),ge("li",{key:M.uid||M.name,class:ne([y(c).be("list","item"),y(c).is(M.status),{focusing:m.value}]),tabindex:"0",onKeydown:go(R=>!y(p)&&b(M),["delete"]),onFocus:T[0]||(T[0]=R=>m.value=!0),onBlur:T[1]||(T[1]=R=>m.value=!1),onClick:T[2]||(T[2]=R=>m.value=!1)},[We(S.$slots,"default",{file:M},()=>[S.listType==="picture"||M.status!=="uploading"&&S.listType==="picture-card"?(J(),ge("img",{key:0,class:ne(y(c).be("list","item-thumbnail")),src:M.url,crossorigin:S.crossorigin,alt:""},null,10,B3e)):Fe("v-if",!0),M.status==="uploading"||S.listType!=="picture-card"?(J(),ge("div",{key:1,class:ne(y(c).be("list","item-info"))},[Ce("a",{class:ne(y(c).be("list","item-name")),onClick:nn(R=>S.handlePreview(M),["prevent"])},[Me(y(Gt),{class:ne(y(u).m("document"))},{default:Ne(()=>[Me(y(Jve))]),_:1},8,["class"]),Ce("span",{class:ne(y(c).be("list","item-file-name")),title:M.name},pt(M.name),11,H3e)],10,$3e),M.status==="uploading"?(J(),He(y(Tz),{key:0,type:S.listType==="picture-card"?"circle":"line","stroke-width":S.listType==="picture-card"?6:2,percentage:Number(M.percentage),style:Ht(S.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):Fe("v-if",!0)],2)):Fe("v-if",!0),Ce("label",{class:ne(y(c).be("list","item-status-label"))},[S.listType==="text"?(J(),He(y(Gt),{key:0,class:ne([y(u).m("upload-success"),y(u).m("circle-check")])},{default:Ne(()=>[Me(y(nL))]),_:1},8,["class"])):["picture-card","picture"].includes(S.listType)?(J(),He(y(Gt),{key:1,class:ne([y(u).m("upload-success"),y(u).m("check")])},{default:Ne(()=>[Me(y(pI))]),_:1},8,["class"])):Fe("v-if",!0)],2),y(p)?Fe("v-if",!0):(J(),He(y(Gt),{key:2,class:ne(y(u).m("close")),onClick:R=>b(M)},{default:Ne(()=>[Me(y(La))]),_:2},1032,["class","onClick"])),Fe(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),Fe(" This is a bug which needs to be fixed "),Fe(" TODO: Fix the incorrect navigation interaction "),y(p)?Fe("v-if",!0):(J(),ge("i",{key:3,class:ne(y(u).m("close-tip"))},pt(y(i)("el.upload.deleteTip")),3)),S.listType==="picture-card"?(J(),ge("span",{key:4,class:ne(y(c).be("list","item-actions"))},[Ce("span",{class:ne(y(c).be("list","item-preview")),onClick:R=>S.handlePreview(M)},[Me(y(Gt),{class:ne(y(u).m("zoom-in"))},{default:Ne(()=>[Me(y($q))]),_:1},8,["class"])],10,q3e),y(p)?Fe("v-if",!0):(J(),ge("span",{key:0,class:ne(y(c).be("list","item-delete")),onClick:R=>b(M)},[Me(y(Gt),{class:ne(y(u).m("delete"))},{default:Ne(()=>[Me(y(jve))]),_:1},8,["class"])],10,K3e))],2)):Fe("v-if",!0)])],42,G3e))),128)),We(S.$slots,"append")]),_:3},8,["class","name"]))}});var p$=vt(W3e,[["__file","upload-list.vue"]]);const j3e=gt({disabled:{type:Boolean,default:!1}}),Y3e={file:e=>At(e)},J3e=["onDrop","onDragover"],OW="ElUploadDrag",X3e=Se({name:OW}),Q3e=Se({...X3e,props:j3e,emits:Y3e,setup(e,{emit:t}){wt(RW)||wr(OW,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=lt("upload"),c=ae(!1),u=zi(),f=m=>{if(u.value)return;c.value=!1,m.stopPropagation();const _=Array.from(m.dataTransfer.files);t("file",_)},p=()=>{u.value||(c.value=!0)};return(m,_)=>(J(),ge("div",{class:ne([y(i).b("dragger"),y(i).is("dragover",c.value)]),onDrop:nn(f,["prevent"]),onDragover:nn(p,["prevent"]),onDragleave:_[0]||(_[0]=nn(b=>c.value=!1,["prevent"]))},[We(m.$slots,"default")],42,J3e))}});var Z3e=vt(Q3e,[["__file","upload-dragger.vue"]]);const eFe=gt({...DW,beforeUpload:{type:Le(Function),default:co},onRemove:{type:Le(Function),default:co},onStart:{type:Le(Function),default:co},onSuccess:{type:Le(Function),default:co},onProgress:{type:Le(Function),default:co},onError:{type:Le(Function),default:co},onExceed:{type:Le(Function),default:co}}),tFe=["onKeydown"],nFe=["name","multiple","accept"],oFe=Se({name:"ElUploadContent",inheritAttrs:!1}),rFe=Se({...oFe,props:eFe,setup(e,{expose:t}){const o=e,i=lt("upload"),c=zi(),u=Do({}),f=Do(),p=E=>{if(E.length===0)return;const{autoUpload:N,limit:D,fileList:x,multiple:L,onStart:F,onExceed:H}=o;if(D&&x.length+E.length>D){H(E,x);return}L||(E=E.slice(0,1));for(const B of E){const z=B;z.uid=WO(),F(z),N&&m(z)}},m=async E=>{if(f.value.value="",!o.beforeUpload)return b(E);let N,D={};try{const L=o.data,F=o.beforeUpload(E);D=nE(o.data)?IE(o.data):o.data,N=await F,nE(o.data)&&Ri(L,D)&&(D=IE(o.data))}catch{N=!1}if(N===!1){o.onRemove(E);return}let x=E;N instanceof Blob&&(N instanceof File?x=N:x=new File([N],E.name,{type:E.type})),b(Object.assign(x,{uid:E.uid}),D)},_=async(E,N)=>tn(E)?E(N):E,b=async(E,N)=>{const{headers:D,data:x,method:L,withCredentials:F,name:H,action:B,onProgress:z,onSuccess:W,onError:Z,httpRequest:$}=o;try{N=await _(N??x,E)}catch{o.onRemove(E);return}const{uid:O}=E,X={headers:D||{},withCredentials:F,file:E,data:N,method:L,filename:H,action:B,onProgress:de=>{z(de,E)},onSuccess:de=>{W(de,E),delete u.value[O]},onError:de=>{Z(de,E),delete u.value[O]}},le=$(X);u.value[O]=le,le instanceof Promise&&le.then(X.onSuccess,X.onError)},S=E=>{const N=E.target.files;N&&p(Array.from(N))},T=()=>{c.value||(f.value.value="",f.value.click())},M=()=>{T()};return t({abort:E=>{Cve(u.value).filter(E?([D])=>String(E.uid)===D:()=>!0).forEach(([D,x])=>{x instanceof XMLHttpRequest&&x.abort(),delete u.value[D]})},upload:m}),(E,N)=>(J(),ge("div",{class:ne([y(i).b(),y(i).m(E.listType),y(i).is("drag",E.drag)]),tabindex:"0",onClick:T,onKeydown:go(nn(M,["self"]),["enter","space"])},[E.drag?(J(),He(Z3e,{key:0,disabled:y(c),onFile:p},{default:Ne(()=>[We(E.$slots,"default")]),_:3},8,["disabled"])):We(E.$slots,"default",{key:1}),Ce("input",{ref_key:"inputRef",ref:f,class:ne(y(i).e("input")),name:E.name,multiple:E.multiple,accept:E.accept,type:"file",onChange:S,onClick:N[0]||(N[0]=nn(()=>{},["stop"]))},null,42,nFe)],42,tFe))}});var g$=vt(rFe,[["__file","upload-content.vue"]]);const m$="ElUpload",v$=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},iFe=(e,t)=>{const o=W7(e,"fileList",void 0,{passive:!0}),i=T=>o.value.find(M=>M.uid===T.uid);function c(T){var M;(M=t.value)==null||M.abort(T)}function u(T=["ready","uploading","success","fail"]){o.value=o.value.filter(M=>!T.includes(M.status))}const f=(T,M)=>{const R=i(M);R&&(console.error(T),R.status="fail",o.value.splice(o.value.indexOf(R),1),e.onError(T,R,o.value),e.onChange(R,o.value))},p=(T,M)=>{const R=i(M);R&&(e.onProgress(T,R,o.value),R.status="uploading",R.percentage=Math.round(T.percent))},m=(T,M)=>{const R=i(M);R&&(R.status="success",R.response=T,e.onSuccess(T,R,o.value),e.onChange(R,o.value))},_=T=>{Hr(T.uid)&&(T.uid=WO());const M={name:T.name,percentage:0,status:"ready",size:T.size,raw:T,uid:T.uid};if(e.listType==="picture-card"||e.listType==="picture")try{M.url=URL.createObjectURL(T)}catch(R){R.message,e.onError(R,M,o.value)}o.value=[...o.value,M],e.onChange(M,o.value)},b=async T=>{const M=T instanceof File?i(T):T;M||wr(m$,"file to be removed not found");const R=E=>{c(E);const N=o.value;N.splice(N.indexOf(E),1),e.onRemove(E,N),v$(E)};e.beforeRemove?await e.beforeRemove(M,o.value)!==!1&&R(M):R(M)};function S(){o.value.filter(({status:T})=>T==="ready").forEach(({raw:T})=>{var M;return T&&((M=t.value)==null?void 0:M.upload(T))})}return rt(()=>e.listType,T=>{T!=="picture-card"&&T!=="picture"||(o.value=o.value.map(M=>{const{raw:R,url:E}=M;if(!E&&R)try{M.url=URL.createObjectURL(R)}catch(N){e.onError(N,M,o.value)}return M}))}),rt(o,T=>{for(const M of T)M.uid||(M.uid=WO()),M.status||(M.status="success")},{immediate:!0,deep:!0}),{uploadFiles:o,abort:c,clearFiles:u,handleError:f,handleProgress:p,handleStart:_,handleSuccess:m,handleRemove:b,submit:S,revokeFileObjectURL:v$}},sFe=Se({name:"ElUpload"}),aFe=Se({...sFe,props:x3e,setup(e,{expose:t}){const o=e,i=zi(),c=Do(),{abort:u,submit:f,clearFiles:p,uploadFiles:m,handleStart:_,handleError:b,handleRemove:S,handleSuccess:T,handleProgress:M,revokeFileObjectURL:R}=iFe(o,c),E=K(()=>o.listType==="picture-card"),N=K(()=>({...o,fileList:m.value,onStart:_,onProgress:M,onSuccess:T,onError:b,onRemove:S}));return Ro(()=>{m.value.forEach(R)}),Ln(RW,{accept:Io(o,"accept")}),t({abort:u,submit:f,clearFiles:p,handleStart:_,handleRemove:S}),(D,x)=>(J(),ge("div",null,[y(E)&&D.showFileList?(J(),He(p$,{key:0,disabled:y(i),"list-type":D.listType,files:y(m),crossorigin:D.crossorigin,"handle-preview":D.onPreview,onRemove:y(S)},kc({append:Ne(()=>[Me(g$,Nn({ref_key:"uploadRef",ref:c},y(N)),{default:Ne(()=>[D.$slots.trigger?We(D.$slots,"trigger",{key:0}):Fe("v-if",!0),!D.$slots.trigger&&D.$slots.default?We(D.$slots,"default",{key:1}):Fe("v-if",!0)]),_:3},16)]),_:2},[D.$slots.file?{name:"default",fn:Ne(({file:L})=>[We(D.$slots,"file",{file:L})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):Fe("v-if",!0),!y(E)||y(E)&&!D.showFileList?(J(),He(g$,Nn({key:1,ref_key:"uploadRef",ref:c},y(N)),{default:Ne(()=>[D.$slots.trigger?We(D.$slots,"trigger",{key:0}):Fe("v-if",!0),!D.$slots.trigger&&D.$slots.default?We(D.$slots,"default",{key:1}):Fe("v-if",!0)]),_:3},16)):Fe("v-if",!0),D.$slots.trigger?We(D.$slots,"default",{key:2}):Fe("v-if",!0),We(D.$slots,"tip"),!y(E)&&D.showFileList?(J(),He(p$,{key:3,disabled:y(i),"list-type":D.listType,files:y(m),crossorigin:D.crossorigin,"handle-preview":D.onPreview,onRemove:y(S)},kc({_:2},[D.$slots.file?{name:"default",fn:Ne(({file:L})=>[We(D.$slots,"file",{file:L})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):Fe("v-if",!0)]))}});var lFe=vt(aFe,[["__file","upload.vue"]]);const cFe=bn(lFe),uFe=gt({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:Le([String,Array]),default:"Element Plus"},font:{type:Le(Object)},gap:{type:Le(Array),default:()=>[100,100]},offset:{type:Le(Array)}});function dFe(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function hFe(e){return Object.keys(e).map(t=>`${dFe(t)}: ${e[t]};`).join(" ")}function fFe(){return window.devicePixelRatio||1}const pFe=(e,t)=>{let o=!1;return e.removedNodes.length&&t&&(o=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(o=!0),o},NW=3;function gD(e,t,o=1){const i=document.createElement("canvas"),c=i.getContext("2d"),u=e*o,f=t*o;return i.setAttribute("width",`${u}px`),i.setAttribute("height",`${f}px`),c.save(),[c,i,u,f]}function gFe(){function e(t,o,i,c,u,f,p,m){const[_,b,S,T]=gD(c,u,i);if(t instanceof HTMLImageElement)_.drawImage(t,0,0,S,T);else{const{color:ue,fontSize:me,fontStyle:be,fontWeight:ke,fontFamily:Ye,textAlign:Oe,textBaseline:Ee}=f,we=Number(me)*i;_.font=`${be} normal ${ke} ${we}px/${u}px ${Ye}`,_.fillStyle=ue,_.textAlign=Oe,_.textBaseline=Ee;const Ge=Array.isArray(t)?t:[t];Ge==null||Ge.forEach((Ve,qe)=>{_.fillText(Ve??"",S/2,qe*(we+NW*i))})}const M=Math.PI/180*Number(o),R=Math.max(c,u),[E,N,D]=gD(R,R,i);E.translate(D/2,D/2),E.rotate(M),S>0&&T>0&&E.drawImage(b,-S/2,-T/2);function x(ue,me){const be=ue*Math.cos(M)-me*Math.sin(M),ke=ue*Math.sin(M)+me*Math.cos(M);return[be,ke]}let L=0,F=0,H=0,B=0;const z=S/2,W=T/2;[[0-z,0-W],[0+z,0-W],[0+z,0+W],[0-z,0+W]].forEach(([ue,me])=>{const[be,ke]=x(ue,me);L=Math.min(L,be),F=Math.max(F,be),H=Math.min(H,ke),B=Math.max(B,ke)});const $=L+D/2,O=H+D/2,X=F-L,le=B-H,de=p*i,he=m*i,se=(X+de)*2,ie=le+he,[oe,ee]=gD(se,ie);function Q(ue=0,me=0){oe.drawImage(N,$,O,X,le,ue,me,X,le)}return Q(),Q(X+de,-le/2-he/2),Q(X+de,+le/2+he/2),[ee.toDataURL(),se/i,ie/i]}return e}const mFe=Se({name:"ElWatermark"}),vFe=Se({...mFe,props:uFe,setup(e){const t=e,o={position:"relative"},i=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.color)!=null?O:"rgba(0,0,0,.15)"}),c=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.fontSize)!=null?O:16}),u=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.fontWeight)!=null?O:"normal"}),f=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.fontStyle)!=null?O:"normal"}),p=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.fontFamily)!=null?O:"sans-serif"}),m=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.textAlign)!=null?O:"center"}),_=K(()=>{var $,O;return(O=($=t.font)==null?void 0:$.textBaseline)!=null?O:"top"}),b=K(()=>t.gap[0]),S=K(()=>t.gap[1]),T=K(()=>b.value/2),M=K(()=>S.value/2),R=K(()=>{var $,O;return(O=($=t.offset)==null?void 0:$[0])!=null?O:T.value}),E=K(()=>{var $,O;return(O=($=t.offset)==null?void 0:$[1])!=null?O:M.value}),N=()=>{const $={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let O=R.value-T.value,X=E.value-M.value;return O>0&&($.left=`${O}px`,$.width=`calc(100% - ${O}px)`,O=0),X>0&&($.top=`${X}px`,$.height=`calc(100% - ${X}px)`,X=0),$.backgroundPosition=`${O}px ${X}px`,$},D=Do(null),x=Do(),L=ae(!1),F=()=>{x.value&&(x.value.remove(),x.value=void 0)},H=($,O)=>{var X;D.value&&x.value&&(L.value=!0,x.value.setAttribute("style",hFe({...N(),backgroundImage:`url('${$}')`,backgroundSize:`${Math.floor(O)}px`})),(X=D.value)==null||X.append(x.value),setTimeout(()=>{L.value=!1}))},B=$=>{let O=120,X=64;const le=t.image,de=t.content,he=t.width,se=t.height;if(!le&&$.measureText){$.font=`${Number(c.value)}px ${p.value}`;const ie=Array.isArray(de)?de:[de],oe=ie.map(ee=>{const Q=$.measureText(ee);return[Q.width,Q.fontBoundingBoxAscent!==void 0?Q.fontBoundingBoxAscent+Q.fontBoundingBoxDescent:Q.actualBoundingBoxAscent+Q.actualBoundingBoxDescent]});O=Math.ceil(Math.max(...oe.map(ee=>ee[0]))),X=Math.ceil(Math.max(...oe.map(ee=>ee[1])))*ie.length+(ie.length-1)*NW}return[he??O,se??X]},z=gFe(),W=()=>{const O=document.createElement("canvas").getContext("2d"),X=t.image,le=t.content,de=t.rotate;if(O){x.value||(x.value=document.createElement("div"));const he=fFe(),[se,ie]=B(O),oe=ee=>{const[Q,ue]=z(ee||"",de,he,se,ie,{color:i.value,fontSize:c.value,fontStyle:f.value,fontWeight:u.value,fontFamily:p.value,textAlign:m.value,textBaseline:_.value},b.value,S.value);H(Q,ue)};if(X){const ee=new Image;ee.onload=()=>{oe(ee)},ee.onerror=()=>{oe(le)},ee.crossOrigin="anonymous",ee.referrerPolicy="no-referrer",ee.src=X}else oe(le)}};return fn(()=>{W()}),rt(()=>t,()=>{W()},{deep:!0,flush:"post"}),Ro(()=>{F()}),z7(D,$=>{L.value||$.forEach(O=>{pFe(O,x.value)&&(F(),W())})},{attributes:!0,subtree:!0,childList:!0}),($,O)=>(J(),ge("div",{ref_key:"containerRef",ref:D,style:Ht([o])},[We($.$slots,"default")],4))}});var _Fe=vt(vFe,[["__file","watermark.vue"]]);const yFe=bn(_Fe),IFe=gt({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:Le(Object)},targetAreaClickable:{type:Boolean,default:!0}}),bFe=(e,t,o,i,c)=>{const u=ae(null),f=()=>{let S;return on(e.value)?S=document.querySelector(e.value):tn(e.value)?S=e.value():S=e.value,S},p=()=>{const S=f();if(!S||!t.value){u.value=null;return}!CFe(S)&&t.value&&S.scrollIntoView(c.value);const{left:T,top:M,width:R,height:E}=S.getBoundingClientRect();u.value={left:T,top:M,width:R,height:E,radius:0}};fn(()=>{rt([t,e],()=>{p()},{immediate:!0}),window.addEventListener("resize",p)}),Ro(()=>{window.removeEventListener("resize",p)});const m=S=>{var T;return(T=At(o.value.offset)?o.value.offset[S]:o.value.offset)!=null?T:6},_=K(()=>{var S;if(!u.value)return u.value;const T=m(0),M=m(1),R=((S=o.value)==null?void 0:S.radius)||2;return{left:u.value.left-T,top:u.value.top-M,width:u.value.width+T*2,height:u.value.height+M*2,radius:R}}),b=K(()=>{const S=f();return!i.value||!S||!window.DOMRect?S||void 0:{getBoundingClientRect(){var T,M,R,E;return window.DOMRect.fromRect({width:((T=_.value)==null?void 0:T.width)||0,height:((M=_.value)==null?void 0:M.height)||0,x:((R=_.value)==null?void 0:R.left)||0,y:((E=_.value)==null?void 0:E.top)||0})}}});return{mergedPosInfo:_,triggerTarget:b}},T1=Symbol("ElTour");function CFe(e){const t=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,{top:i,right:c,bottom:u,left:f}=e.getBoundingClientRect();return i>=0&&f>=0&&c<=t&&u<=o}const SFe=(e,t,o,i,c,u,f,p)=>{const m=ae(),_=ae(),b=ae({}),S={x:m,y:_,placement:i,strategy:c,middlewareData:b},T=K(()=>{const D=[C9(y(u)),K0e(),q0e(),TFe()];return y(p)&&y(o)&&D.push(S9({element:y(o)})),D}),M=async()=>{if(!$n)return;const D=y(e),x=y(t);if(!D||!x)return;const L=await T9(D,x,{placement:y(i),strategy:y(c),middleware:y(T)});ym(S).forEach(F=>{S[F].value=L[F]})},R=K(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(f)};const{overflow:D}=y(b);return{position:y(c),zIndex:y(f),top:y(_)!=null?`${y(_)}px`:"",left:y(m)!=null?`${y(m)}px`:"",maxWidth:D!=null&&D.maxWidth?`${D==null?void 0:D.maxWidth}px`:""}}),E=K(()=>{if(!y(p))return{};const{arrow:D}=y(b);return{left:(D==null?void 0:D.x)!=null?`${D==null?void 0:D.x}px`:"",top:(D==null?void 0:D.y)!=null?`${D==null?void 0:D.y}px`:""}});let N;return fn(()=>{const D=y(e),x=y(t);D&&x&&(N=$0e(D,x,M)),hi(()=>{M()})}),Ro(()=>{N&&N()}),{update:M,contentStyle:R,arrowStyle:E}},TFe=()=>({name:"overflow",async fn(e){const t=await H0e(e);let o=0;return t.left>0&&(o=t.left),t.right>0&&(o=t.right),{data:{maxWidth:e.rects.floating.width-o}}}}),EFe={style:{width:"100%",height:"100%"}},MFe=["d"],kFe=Se({name:"ElTourMask",inheritAttrs:!1}),AFe=Se({...kFe,props:IFe,setup(e){const t=e,{ns:o}=wt(T1),i=K(()=>{var p,m;return(m=(p=t.pos)==null?void 0:p.radius)!=null?m:2}),c=K(()=>{const p=i.value,m=`a${p},${p} 0 0 1`;return{topRight:`${m} ${p},${p}`,bottomRight:`${m} ${-p},${p}`,bottomLeft:`${m} ${-p},${-p}`,topLeft:`${m} ${p},${-p}`}}),u=K(()=>{const p=window.innerWidth,m=window.innerHeight,_=c.value,b=`M${p},0 L0,0 L0,${m} L${p},${m} L${p},0 Z`,S=i.value;return t.pos?`${b} M${t.pos.left+S},${t.pos.top} h${t.pos.width-S*2} ${_.topRight} v${t.pos.height-S*2} ${_.bottomRight} h${-t.pos.width+S*2} ${_.bottomLeft} v${-t.pos.height+S*2} ${_.topLeft} z`:b}),f=K(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return dL(Io(t,"visible"),{ns:o}),(p,m)=>p.visible?(J(),ge("div",Nn({key:0,class:y(o).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:p.zIndex,pointerEvents:p.pos&&p.targetAreaClickable?"none":"auto"}},p.$attrs),[(J(),ge("svg",EFe,[Ce("path",{class:ne(y(o).e("hollow")),style:Ht(y(f)),d:y(u)},null,14,MFe)]))],16)):Fe("v-if",!0)}});var RFe=vt(AFe,[["__file","mask.vue"]]);const wFe=["absolute","fixed"],DFe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],m2=gt({placement:{type:Le(String),values:DFe,default:"bottom"},reference:{type:Le(Object),default:null},strategy:{type:Le(String),values:wFe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),OFe={close:()=>!0},NFe=["data-side"],LFe=Se({name:"ElTourContent"}),PFe=Se({...LFe,props:m2,emits:OFe,setup(e,{emit:t}){const o=e,i=ae(o.placement),c=ae(o.strategy),u=ae(null),f=ae(null);rt(()=>o.placement,()=>{i.value=o.placement});const{contentStyle:p,arrowStyle:m}=SFe(Io(o,"reference"),u,f,i,c,Io(o,"offset"),Io(o,"zIndex"),Io(o,"showArrow")),_=K(()=>i.value.split("-")[0]),{ns:b}=wt(T1),S=()=>{t("close")},T=M=>{M.detail.focusReason==="pointer"&&M.preventDefault()};return(M,R)=>(J(),ge("div",{ref_key:"contentRef",ref:u,style:Ht(y(p)),class:ne(y(b).e("content")),"data-side":y(_),tabindex:"-1"},[Me(y(CI),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":u.value||void 0,onReleaseRequested:S,onFocusoutPrevented:T},{default:Ne(()=>[We(M.$slots,"default")]),_:3},8,["focus-trap-el"]),M.showArrow?(J(),ge("span",{key:0,ref_key:"arrowRef",ref:f,style:Ht(y(m)),class:ne(y(b).e("arrow"))},null,6)):Fe("v-if",!0)],14,NFe))}});var UFe=vt(PFe,[["__file","content.vue"]]),xFe=Se({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:o}){let i=0;return()=>{var c,u;const f=(c=t.default)==null?void 0:c.call(t),p=[];let m=0;function _(b){At(b)&&b.forEach(S=>{var T;((T=(S==null?void 0:S.type)||{})==null?void 0:T.name)==="ElTourStep"&&(p.push(S),m+=1)})}return f.length&&_(hd((u=f[0])==null?void 0:u.children)),i!==m&&(i=m,o("update-total",m)),p.length?p[e.current]:null}}});const FFe=gt({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:mo},placement:m2.placement,contentStyle:{type:Le([Object])},mask:{type:Le([Boolean,Object]),default:!0},gap:{type:Le(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:Le([Boolean,Object]),default:()=>({block:"center"})},type:{type:Le(String)},appendTo:{type:Le([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),VFe={[Mn]:e=>yr(e),"update:current":e=>Zt(e),close:e=>Zt(e),finish:()=>!0,change:e=>Zt(e)},GFe=Se({name:"ElTour"}),BFe=Se({...GFe,props:FFe,emits:VFe,setup(e,{emit:t}){const o=e,i=lt("tour"),c=ae(0),u=ae(),f=W7(o,"current",t,{passive:!0}),p=K(()=>{var Z;return(Z=u.value)==null?void 0:Z.target}),m=K(()=>[i.b(),N.value==="primary"?i.m("primary"):""]),_=K(()=>{var Z;return((Z=u.value)==null?void 0:Z.placement)||o.placement}),b=K(()=>{var Z,$;return($=(Z=u.value)==null?void 0:Z.contentStyle)!=null?$:o.contentStyle}),S=K(()=>{var Z,$;return($=(Z=u.value)==null?void 0:Z.mask)!=null?$:o.mask}),T=K(()=>!!S.value&&o.modelValue),M=K(()=>yr(S.value)?void 0:S.value),R=K(()=>{var Z,$;return!!p.value&&(($=(Z=u.value)==null?void 0:Z.showArrow)!=null?$:o.showArrow)}),E=K(()=>{var Z,$;return($=(Z=u.value)==null?void 0:Z.scrollIntoViewOptions)!=null?$:o.scrollIntoViewOptions}),N=K(()=>{var Z,$;return($=(Z=u.value)==null?void 0:Z.type)!=null?$:o.type}),{nextZIndex:D}=Bm(),x=D(),L=K(()=>{var Z;return(Z=o.zIndex)!=null?Z:x}),{mergedPosInfo:F,triggerTarget:H}=bFe(p,Io(o,"modelValue"),Io(o,"gap"),S,E);rt(()=>o.modelValue,Z=>{Z||(f.value=0)});const B=()=>{o.closeOnPressEscape&&(t("update:modelValue",!1),t("close",f.value))},z=Z=>{c.value=Z},W=zr();return Ln(T1,{currentStep:u,current:f,total:c,showClose:Io(o,"showClose"),closeIcon:Io(o,"closeIcon"),mergedType:N,ns:i,slots:W,updateModelValue(Z){t("update:modelValue",Z)},onClose(){t("close",f.value)},onFinish(){t("finish")},onChange(){t("change",f.value)}}),(Z,$)=>{var O,X;return J(),ge(qt,null,[(J(),He(Lm,{to:Z.appendTo},[Ce("div",Nn({class:y(m)},Z.$attrs),[Me(RFe,{visible:y(T),fill:(O=y(M))==null?void 0:O.color,style:Ht((X=y(M))==null?void 0:X.style),pos:y(F),"z-index":y(L),"target-area-clickable":Z.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),Z.modelValue?(J(),He(UFe,{key:y(f),reference:y(H),placement:y(_),"show-arrow":y(R),"z-index":y(L),style:Ht(y(b)),onClose:B},{default:Ne(()=>[Me(y(xFe),{current:y(f),onUpdateTotal:z},{default:Ne(()=>[We(Z.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):Fe("v-if",!0)],16)],8,["to"])),Fe(" just for IDE "),Fe("v-if",!0)],64)}}});var $Fe=vt(BFe,[["__file","tour.vue"]]);const HFe=gt({target:{type:Le([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:mo},showArrow:{type:Boolean,default:void 0},placement:m2.placement,mask:{type:Le([Boolean,Object]),default:void 0},contentStyle:{type:Le([Object])},prevButtonProps:{type:Le(Object)},nextButtonProps:{type:Le(Object)},scrollIntoViewOptions:{type:Le([Boolean,Object]),default:void 0},type:{type:Le(String)}}),qFe={close:()=>!0},KFe=Se({name:"ElTourStep"}),zFe=Se({...KFe,props:HFe,emits:qFe,setup(e,{emit:t}){const o=e,{Close:i}=iL,{t:c}=Kn(),{currentStep:u,current:f,total:p,showClose:m,closeIcon:_,mergedType:b,ns:S,slots:T,updateModelValue:M,onClose:R,onFinish:E,onChange:N}=wt(T1);rt(o,W=>{u.value=W},{immediate:!0});const D=K(()=>{var W;return(W=o.showClose)!=null?W:m.value}),x=K(()=>{var W,Z;return(Z=(W=o.closeIcon)!=null?W:_.value)!=null?Z:i}),L=W=>{if(W)return hve(W,["children","onClick"])},F=()=>{var W,Z;f.value-=1,(W=o.prevButtonProps)!=null&&W.onClick&&((Z=o.prevButtonProps)==null||Z.onClick()),N()},H=()=>{var W;f.value>=p.value-1?B():f.value+=1,(W=o.nextButtonProps)!=null&&W.onClick&&o.nextButtonProps.onClick(),N()},B=()=>{z(),E()},z=()=>{M(!1),R(),t("close")};return(W,Z)=>(J(),ge(qt,null,[y(D)?(J(),ge("button",{key:0,"aria-label":"Close",class:ne(y(S).e("closebtn")),type:"button",onClick:z},[Me(y(Gt),{class:ne(y(S).e("close"))},{default:Ne(()=>[(J(),He(wn(y(x))))]),_:1},8,["class"])],2)):Fe("v-if",!0),Ce("header",{class:ne([y(S).e("header"),{"show-close":y(m)}])},[We(W.$slots,"header",{},()=>[Ce("span",{role:"heading",class:ne(y(S).e("title"))},pt(W.title),3)])],2),Ce("div",{class:ne(y(S).e("body"))},[We(W.$slots,"default",{},()=>[Ce("span",null,pt(W.description),1)])],2),Ce("footer",{class:ne(y(S).e("footer"))},[Ce("div",{class:ne(y(S).b("indicators"))},[y(T).indicators?(J(),He(wn(y(T).indicators),{key:0,current:y(f),total:y(p)},null,8,["current","total"])):(J(!0),ge(qt,{key:1},Vn(y(p),($,O)=>(J(),ge("span",{key:$,class:ne([y(S).b("indicator"),O===y(f)?"is-active":""])},null,2))),128))],2),Ce("div",{class:ne(y(S).b("buttons"))},[y(f)>0?(J(),He(y(qr),Nn({key:0,size:"small",type:y(b)},L(W.prevButtonProps),{onClick:F}),{default:Ne(()=>{var $,O;return[On(pt((O=($=W.prevButtonProps)==null?void 0:$.children)!=null?O:y(c)("el.tour.previous")),1)]}),_:1},16,["type"])):Fe("v-if",!0),y(f)<=y(p)-1?(J(),He(y(qr),Nn({key:1,size:"small",type:y(b)==="primary"?"default":"primary"},L(W.nextButtonProps),{onClick:H}),{default:Ne(()=>{var $,O;return[On(pt((O=($=W.nextButtonProps)==null?void 0:$.children)!=null?O:y(f)===y(p)-1?y(c)("el.tour.finish"):y(c)("el.tour.next")),1)]}),_:1},16,["type"])):Fe("v-if",!0)],2)],2)],64))}});var LW=vt(zFe,[["__file","step.vue"]]);const WFe=bn($Fe,{TourStep:LW}),jFe=Wo(LW),YFe=gt({container:{type:Le([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:Le(String),default:"default"},direction:{type:Le(String),default:"vertical"}}),JFe={change:e=>on(e),click:(e,t)=>e instanceof MouseEvent&&(on(t)||_r(t))},PW=Symbol("anchor"),XFe=Se({name:"ElAnchor"}),QFe=Se({...XFe,props:YFe,emits:JFe,setup(e,{expose:t,emit:o}){const i=e,c=ae(""),u=ae(null),f=ae(null),p=ae(),m={};let _=!1,b=0;const S=lt("anchor"),T=K(()=>[S.b(),i.type==="underline"?S.m("underline"):"",S.m(i.direction)]),M=W=>{m[W.href]=W.el},R=W=>{delete m[W]},E=W=>{c.value!==W&&(c.value=W,o("change",W))};let N=null;const D=W=>{if(!p.value)return;const Z=rT(W);if(!Z)return;N&&N(),_=!0;const $=M8(Z,p.value),O=HD(Z,$),X=$.scrollHeight-$.clientHeight,le=Math.min(O-i.offset,X);N=Eve(p.value,b,le,i.duration,()=>{setTimeout(()=>{_=!1},20)})},x=W=>{W&&(E(W),D(W))},L=(W,Z)=>{o("click",W,Z),x(Z)},F=$_e(()=>{p.value&&(b=k8(p.value));const W=H();_||_r(W)||E(W)}),H=()=>{if(!p.value)return;const W=k8(p.value),Z=[];for(const $ of Object.keys(m)){const O=rT($);if(!O)continue;const X=M8(O,p.value),le=HD(O,X);Z.push({top:le-i.offset-i.bound,href:$})}Z.sort(($,O)=>$.top-O.top);for(let $=0;$<Z.length;$++){const O=Z[$],X=Z[$+1];if($===0&&W===0)return"";if(O.top<=W&&(!X||X.top>W))return O.href}},B=()=>{const W=rT(i.container);!W||s1(W)?p.value=window:p.value=W};Oo(p,"scroll",F);const z=K(()=>{if(!u.value||!f.value||!c.value)return{};const W=m[c.value];if(!W)return{};const Z=u.value.getBoundingClientRect(),$=f.value.getBoundingClientRect(),O=W.getBoundingClientRect();return i.direction==="horizontal"?{left:`${O.left-Z.left}px`,width:`${O.width}px`,opacity:1}:{top:`${O.top-Z.top+(O.height-$.height)/2}px`,opacity:1}});return fn(()=>{B();const W=decodeURIComponent(window.location.hash);rT(W)?x(W):F()}),rt(()=>i.container,()=>{B()}),Ln(PW,{ns:S,direction:i.direction,currentAnchor:c,addLink:M,removeLink:R,handleClick:L}),t({scrollTo:x}),(W,Z)=>(J(),ge("div",{ref_key:"anchorRef",ref:u,class:ne(y(T))},[W.marker?(J(),ge("div",{key:0,ref_key:"markerRef",ref:f,class:ne(y(S).e("marker")),style:Ht(y(z))},null,6)):Fe("v-if",!0),Ce("div",{class:ne(y(S).e("list"))},[We(W.$slots,"default")],2)],2))}});var ZFe=vt(QFe,[["__file","anchor.vue"]]);const e4e=gt({title:String,href:String}),t4e=["href"],n4e=Se({name:"ElAnchorLink"}),o4e=Se({...n4e,props:e4e,setup(e){const t=e,o=ae(null),{ns:i,direction:c,currentAnchor:u,addLink:f,removeLink:p,handleClick:m}=wt(PW),_=K(()=>[i.e("link"),i.is("active",u.value===t.href)]),b=S=>{m(S,t.href)};return rt(()=>t.href,(S,T)=>{zt(()=>{T&&p(T),S&&f({href:S,el:o.value})})}),fn(()=>{const{href:S}=t;S&&f({href:S,el:o.value})}),Ro(()=>{const{href:S}=t;S&&p(S)}),(S,T)=>(J(),ge("div",{class:ne(y(i).e("item"))},[Ce("a",{ref_key:"linkRef",ref:o,class:ne(y(_)),href:S.href,onClick:b},[We(S.$slots,"default",{},()=>[On(pt(S.title),1)])],10,t4e),S.$slots["sub-link"]&&y(c)==="vertical"?(J(),ge("div",{key:0,class:ne(y(i).e("list"))},[We(S.$slots,"sub-link")],2)):Fe("v-if",!0)],2))}});var UW=vt(o4e,[["__file","anchor-link.vue"]]);const r4e=bn(ZFe,{AnchorLink:UW}),i4e=Wo(UW),s4e=gt({options:{type:Le(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:Nr,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...ti(["ariaLabel"])}),a4e={[Mn]:e=>on(e)||Zt(e),[Lo]:e=>on(e)||Zt(e)},l4e=["id","aria-label","aria-labelledby"],c4e=["name","disabled","checked","onChange"],u4e=Se({name:"ElSegmented"}),d4e=Se({...u4e,props:s4e,emits:a4e,setup(e,{emit:t}){const o=e,i=lt("segmented"),c=pi(),u=Tr(),f=zi(),{formItem:p}=Oi(),{inputId:m,isLabeledByFormItem:_}=Va(o,{formItemContext:p}),b=ae(null),S=wde(),T=Zn({isInit:!1,width:0,translateX:0,disabled:!1,focusVisible:!1}),M=Z=>{const $=R(Z);t(Mn,$),t(Lo,$)},R=Z=>En(Z)?Z.value:Z,E=Z=>En(Z)?Z.label:Z,N=Z=>!!(f.value||En(Z)&&Z.disabled),D=Z=>o.modelValue===R(Z),x=Z=>o.options.find($=>R($)===Z),L=Z=>[i.e("item"),i.is("selected",D(Z)),i.is("disabled",N(Z))],F=()=>{if(!b.value)return;const Z=b.value.querySelector(".is-selected"),$=b.value.querySelector(".is-selected input");if(!Z||!$){T.width=0,T.translateX=0,T.disabled=!1,T.focusVisible=!1;return}const O=Z.getBoundingClientRect();T.isInit=!0,T.width=O.width,T.translateX=Z.offsetLeft,T.disabled=N(x(o.modelValue));try{T.focusVisible=$.matches(":focus-visible")}catch{}},H=K(()=>[i.b(),i.m(u.value),i.is("block",o.block)]),B=K(()=>({width:`${T.width}px`,transform:`translateX(${T.translateX}px)`,display:T.isInit?"block":"none"})),z=K(()=>[i.e("item-selected"),i.is("disabled",T.disabled),i.is("focus-visible",T.focusVisible)]),W=K(()=>o.name||c.value);return Ko(b,F),rt(S,F),rt(()=>o.modelValue,()=>{var Z;F(),o.validateEvent&&((Z=p==null?void 0:p.validate)==null||Z.call(p,"change").catch($=>void 0))},{flush:"post"}),(Z,$)=>(J(),ge("div",{id:y(m),ref_key:"segmentedRef",ref:b,class:ne(y(H)),role:"radiogroup","aria-label":y(_)?void 0:Z.ariaLabel||"segmented","aria-labelledby":y(_)?y(p).labelId:void 0},[Ce("div",{class:ne(y(i).e("group"))},[Ce("div",{style:Ht(y(B)),class:ne(y(z))},null,6),(J(!0),ge(qt,null,Vn(Z.options,(O,X)=>(J(),ge("label",{key:X,class:ne(L(O))},[Ce("input",{class:ne(y(i).e("item-input")),type:"radio",name:y(W),disabled:N(O),checked:D(O),onChange:le=>M(O)},null,42,c4e),Ce("div",{class:ne(y(i).e("item-label"))},[We(Z.$slots,"default",{item:O},()=>[On(pt(E(O)),1)])],2)],2))),128))],2)],10,l4e))}});var h4e=vt(d4e,[["__file","segmented.vue"]]);const f4e=bn(h4e);var p4e=[hIe,SIe,YCe,MUe,nSe,cSe,$9,SSe,TSe,qr,Y9,HTe,jTe,pEe,gEe,k1e,f1e,N1e,aa,NEe,SK,K1e,cMe,uMe,tMe,GMe,rIe,QMe,ZMe,eke,tke,nke,CAe,NAe,LAe,JAe,oz,uRe,twe,nwe,owe,hz,mbe,vbe,Gt,Ywe,fz,Ai,pz,cDe,RDe,wDe,DDe,ODe,VDe,zOe,QOe,aNe,V9,Tz,wK,YEe,jEe,TNe,RNe,G1e,xc,Zf,RE,_Oe,gLe,SLe,TLe,e2e,i2e,Hz,m2e,E2e,M2e,x2e,BPe,$Pe,EUe,BUe,$Ue,z0,WUe,bTe,ZUe,rxe,ixe,Di,Dxe,zxe,s3e,f3e,D3e,cFe,yFe,WFe,jFe,r4e,i4e,f4e];const Ws="ElInfiniteScroll",g4e=50,m4e=200,v4e=0,_4e={delay:{type:Number,default:m4e},distance:{type:Number,default:v4e},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},v2=(e,t)=>Object.entries(_4e).reduce((o,[i,c])=>{var u,f;const{type:p,default:m}=c,_=e.getAttribute(`infinite-scroll-${i}`);let b=(f=(u=t[_])!=null?u:_)!=null?f:m;return b=b==="false"?!1:b,b=p(b),o[i]=Number.isNaN(b)?m:b,o},{}),xW=e=>{const{observer:t}=e[Ws];t&&(t.disconnect(),delete e[Ws].observer)},y4e=(e,t)=>{const{container:o,containerEl:i,instance:c,observer:u,lastScrollTop:f}=e[Ws],{disabled:p,distance:m}=v2(e,c),{clientHeight:_,scrollHeight:b,scrollTop:S}=i,T=S-f;if(e[Ws].lastScrollTop=S,u||p||T<0)return;let M=!1;if(o===e)M=b-(_+S)<=m;else{const{clientTop:R,scrollHeight:E}=e,N=HD(e,i);M=S+_>=N+R+E-m}M&&t.call(c)};function mD(e,t){const{containerEl:o,instance:i}=e[Ws],{disabled:c}=v2(e,i);c||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?t.call(i):xW(e))}const I4e={async mounted(e,t){const{instance:o,value:i}=t;tn(i)||wr(Ws,"'v-infinite-scroll' binding value must be a function"),await zt();const{delay:c,immediate:u}=v2(e,o),f=eL(e,!0),p=f===window?document.documentElement:f,m=$f(y4e.bind(null,e,i),c);if(f){if(e[Ws]={instance:o,container:f,containerEl:p,delay:c,cb:i,onScroll:m,lastScrollTop:p.scrollTop},u){const _=new MutationObserver($f(mD.bind(null,e,i),g4e));e[Ws].observer=_,_.observe(e,{childList:!0,subtree:!0}),mD(e,i)}f.addEventListener("scroll",m)}},unmounted(e){if(!e[Ws])return;const{container:t,onScroll:o}=e[Ws];t==null||t.removeEventListener("scroll",o),xW(e)},async updated(e){if(!e[Ws])await zt();else{const{containerEl:t,cb:o,observer:i}=e[Ws];t.clientHeight&&i&&mD(e,o)}}},jO=I4e;jO.install=e=>{e.directive("InfiniteScroll",jO)};const b4e=jO;function C4e(e){let t;const o=ae(!1),i=Zn({...e,originalPosition:"",originalOverflow:"",visible:!1});function c(T){i.text=T}function u(){const T=i.parent,M=S.ns;if(!T.vLoadingAddClassList){let R=T.getAttribute("loading-number");R=Number.parseInt(R)-1,R?T.setAttribute("loading-number",R.toString()):(wi(T,M.bm("parent","relative")),T.removeAttribute("loading-number")),wi(T,M.bm("parent","hidden"))}f(),b.unmount()}function f(){var T,M;(M=(T=S.$el)==null?void 0:T.parentNode)==null||M.removeChild(S.$el)}function p(){var T;e.beforeClose&&!e.beforeClose()||(o.value=!0,clearTimeout(t),t=window.setTimeout(m,400),i.visible=!1,(T=e.closed)==null||T.call(e))}function m(){if(!o.value)return;const T=i.parent;o.value=!1,T.vLoadingAddClassList=void 0,u()}const b=FH(Se({name:"ElLoading",setup(T,{expose:M}){const{ns:R,zIndex:E}=p1("loading");return M({ns:R,zIndex:E}),()=>{const N=i.spinner||i.svg,D=Wt("svg",{class:"circular",viewBox:i.svgViewBox?i.svgViewBox:"0 0 50 50",...N?{innerHTML:N}:{}},[Wt("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),x=i.text?Wt("p",{class:R.b("text")},[i.text]):void 0;return Wt(Rr,{name:R.b("fade"),onAfterLeave:m},{default:Ne(()=>[hn(Me("div",{style:{backgroundColor:i.background||""},class:[R.b("mask"),i.customClass,i.fullscreen?"is-fullscreen":""]},[Wt("div",{class:R.b("spinner")},[D,x])]),[[Jn,i.visible]])])})}}})),S=b.mount(document.createElement("div"));return{...ei(i),setText:c,removeElLoadingChild:f,close:p,handleAfterLeave:m,vm:S,get $el(){return S.$el}}}let yT;const YO=function(e={}){if(!$n)return;const t=S4e(e);if(t.fullscreen&&yT)return yT;const o=C4e({...t,closed:()=>{var c;(c=t.closed)==null||c.call(t),t.fullscreen&&(yT=void 0)}});T4e(t,t.parent,o),_$(t,t.parent,o),t.parent.vLoadingAddClassList=()=>_$(t,t.parent,o);let i=t.parent.getAttribute("loading-number");return i?i=`${Number.parseInt(i)+1}`:i="1",t.parent.setAttribute("loading-number",i),t.parent.appendChild(o.$el),zt(()=>o.visible.value=t.visible),t.fullscreen&&(yT=o),o},S4e=e=>{var t,o,i,c;let u;return on(e.target)?u=(t=document.querySelector(e.target))!=null?t:document.body:u=e.target||document.body,{parent:u===document.body||e.body?document.body:u,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:u===document.body&&((o=e.fullscreen)!=null?o:!0),lock:(i=e.lock)!=null?i:!1,customClass:e.customClass||"",visible:(c=e.visible)!=null?c:!0,target:u}},T4e=async(e,t,o)=>{const{nextZIndex:i}=o.vm.zIndex||o.vm._.exposed.zIndex,c={};if(e.fullscreen)o.originalPosition.value=td(document.body,"position"),o.originalOverflow.value=td(document.body,"overflow"),c.zIndex=i();else if(e.parent===document.body){o.originalPosition.value=td(document.body,"position"),await zt();for(const u of["top","left"]){const f=u==="top"?"scrollTop":"scrollLeft";c[u]=`${e.target.getBoundingClientRect()[u]+document.body[f]+document.documentElement[f]-Number.parseInt(td(document.body,`margin-${u}`),10)}px`}for(const u of["height","width"])c[u]=`${e.target.getBoundingClientRect()[u]}px`}else o.originalPosition.value=td(t,"position");for(const[u,f]of Object.entries(c))o.$el.style[u]=f},_$=(e,t,o)=>{const i=o.vm.ns||o.vm._.exposed.ns;["absolute","fixed","sticky"].includes(o.originalPosition.value)?wi(t,i.bm("parent","relative")):Js(t,i.bm("parent","relative")),e.fullscreen&&e.lock?Js(t,i.bm("parent","hidden")):wi(t,i.bm("parent","hidden"))},tE=Symbol("ElLoading"),y$=(e,t)=>{var o,i,c,u;const f=t.instance,p=T=>En(t.value)?t.value[T]:void 0,m=T=>{const M=on(T)&&(f==null?void 0:f[T])||T;return M&&ae(M)},_=T=>m(p(T)||e.getAttribute(`element-loading-${Sd(T)}`)),b=(o=p("fullscreen"))!=null?o:t.modifiers.fullscreen,S={text:_("text"),svg:_("svg"),svgViewBox:_("svgViewBox"),spinner:_("spinner"),background:_("background"),customClass:_("customClass"),fullscreen:b,target:(i=p("target"))!=null?i:b?void 0:e,body:(c=p("body"))!=null?c:t.modifiers.body,lock:(u=p("lock"))!=null?u:t.modifiers.lock};e[tE]={options:S,instance:YO(S)}},E4e=(e,t)=>{for(const o of Object.keys(t))No(t[o])&&(t[o].value=e[o])},I$={mounted(e,t){t.value&&y$(e,t)},updated(e,t){const o=e[tE];t.oldValue!==t.value&&(t.value&&!t.oldValue?y$(e,t):t.value&&t.oldValue?En(t.value)&&E4e(t.value,o.options):o==null||o.instance.close())},unmounted(e){var t;(t=e[tE])==null||t.instance.close(),e[tE]=null}},M4e={install(e){e.directive("loading",I$),e.config.globalProperties.$loading=YO},directive:I$,service:YO},FW=["success","info","warning","error"],Si=zo({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:$n?document.body:void 0}),k4e=gt({customClass:{type:String,default:Si.customClass},center:{type:Boolean,default:Si.center},dangerouslyUseHTMLString:{type:Boolean,default:Si.dangerouslyUseHTMLString},duration:{type:Number,default:Si.duration},icon:{type:mo,default:Si.icon},id:{type:String,default:Si.id},message:{type:Le([String,Object,Function]),default:Si.message},onClose:{type:Le(Function),default:Si.onClose},showClose:{type:Boolean,default:Si.showClose},type:{type:String,values:FW,default:Si.type},plain:{type:Boolean,default:Si.plain},offset:{type:Number,default:Si.offset},zIndex:{type:Number,default:Si.zIndex},grouping:{type:Boolean,default:Si.grouping},repeatNum:{type:Number,default:Si.repeatNum}}),A4e={destroy:()=>!0},wa=sN([]),R4e=e=>{const t=wa.findIndex(c=>c.id===e),o=wa[t];let i;return t>0&&(i=wa[t-1]),{current:o,prev:i}},w4e=e=>{const{prev:t}=R4e(e);return t?t.vm.exposed.bottom.value:0},D4e=(e,t)=>wa.findIndex(i=>i.id===e)>0?16:t,O4e=["id"],N4e=["innerHTML"],L4e=Se({name:"ElMessage"}),P4e=Se({...L4e,props:k4e,emits:A4e,setup(e,{expose:t}){const o=e,{Close:i}=sL,{ns:c,zIndex:u}=p1("message"),{currentZIndex:f,nextZIndex:p}=u,m=ae(),_=ae(!1),b=ae(0);let S;const T=K(()=>o.type?o.type==="error"?"danger":o.type:"info"),M=K(()=>{const z=o.type;return{[c.bm("icon",z)]:z&&Id[z]}}),R=K(()=>o.icon||Id[o.type]||""),E=K(()=>w4e(o.id)),N=K(()=>D4e(o.id,o.offset)+E.value),D=K(()=>b.value+N.value),x=K(()=>({top:`${N.value}px`,zIndex:f.value}));function L(){o.duration!==0&&({stop:S}=Wf(()=>{H()},o.duration))}function F(){S==null||S()}function H(){_.value=!1}function B({code:z}){z===Yt.esc&&H()}return fn(()=>{L(),p(),_.value=!0}),rt(()=>o.repeatNum,()=>{F(),L()}),Oo(document,"keydown",B),Ko(m,()=>{b.value=m.value.getBoundingClientRect().height}),t({visible:_,bottom:D,close:H}),(z,W)=>(J(),He(Rr,{name:y(c).b("fade"),onBeforeLeave:z.onClose,onAfterLeave:W[0]||(W[0]=Z=>z.$emit("destroy")),persisted:""},{default:Ne(()=>[hn(Ce("div",{id:z.id,ref_key:"messageRef",ref:m,class:ne([y(c).b(),{[y(c).m(z.type)]:z.type},y(c).is("center",z.center),y(c).is("closable",z.showClose),y(c).is("plain",z.plain),z.customClass]),style:Ht(y(x)),role:"alert",onMouseenter:F,onMouseleave:L},[z.repeatNum>1?(J(),He(y($9),{key:0,value:z.repeatNum,type:y(T),class:ne(y(c).e("badge"))},null,8,["value","type","class"])):Fe("v-if",!0),y(R)?(J(),He(y(Gt),{key:1,class:ne([y(c).e("icon"),y(M)])},{default:Ne(()=>[(J(),He(wn(y(R))))]),_:1},8,["class"])):Fe("v-if",!0),We(z.$slots,"default",{},()=>[z.dangerouslyUseHTMLString?(J(),ge(qt,{key:1},[Fe(" Caution here, message could've been compromised, never use user's input as message "),Ce("p",{class:ne(y(c).e("content")),innerHTML:z.message},null,10,N4e)],2112)):(J(),ge("p",{key:0,class:ne(y(c).e("content"))},pt(z.message),3))]),z.showClose?(J(),He(y(Gt),{key:2,class:ne(y(c).e("closeBtn")),onClick:nn(H,["stop"])},{default:Ne(()=>[Me(y(i))]),_:1},8,["class","onClick"])):Fe("v-if",!0)],46,O4e),[[Jn,_.value]])]),_:3},8,["name","onBeforeLeave"]))}});var U4e=vt(P4e,[["__file","message.vue"]]);let x4e=1;const VW=e=>{const t=!e||on(e)||$o(e)||tn(e)?{message:e}:e,o={...Si,...t};if(!o.appendTo)o.appendTo=document.body;else if(on(o.appendTo)){let i=document.querySelector(o.appendTo);ra(i)||(i=document.body),o.appendTo=i}return o},F4e=e=>{const t=wa.indexOf(e);if(t===-1)return;wa.splice(t,1);const{handler:o}=e;o.close()},V4e=({appendTo:e,...t},o)=>{const i=`message_${x4e++}`,c=t.onClose,u=document.createElement("div"),f={...t,id:i,onClose:()=>{c==null||c(),F4e(b)},onDestroy:()=>{gd(null,u)}},p=Me(U4e,f,tn(f.message)||$o(f.message)?{default:tn(f.message)?f.message:()=>f.message}:null);p.appContext=o||Dm._context,gd(p,u),e.appendChild(u.firstElementChild);const m=p.component,b={id:i,vnode:p,vm:m,handler:{close:()=>{m.exposed.visible.value=!1}},props:p.component.props};return b},Dm=(e={},t)=>{if(!$n)return{close:()=>{}};if(Zt(eO.max)&&wa.length>=eO.max)return{close:()=>{}};const o=VW(e);if(o.grouping&&wa.length){const c=wa.find(({vnode:u})=>{var f;return((f=u.props)==null?void 0:f.message)===o.message});if(c)return c.props.repeatNum+=1,c.props.type=o.type,c.handler}const i=V4e(o,t);return wa.push(i),i.handler};FW.forEach(e=>{Dm[e]=(t={},o)=>{const i=VW(t);return Dm({...i,type:e},o)}});function G4e(e){for(const t of wa)(!e||e===t.props.type)&&t.handler.close()}Dm.closeAll=G4e;Dm._context=null;const GW=Kq(Dm,"$message"),B4e=Se({name:"ElMessageBox",directives:{TrapFocus:oTe},components:{ElButton:qr,ElFocusTrap:CI,ElInput:Ai,ElOverlay:HL,ElIcon:Gt,...sL},inheritAttrs:!1,props:{buttonSize:{type:String,validator:zq},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:o,zIndex:i,ns:c,size:u}=p1("message-box",K(()=>e.buttonSize)),{t:f}=o,{nextZIndex:p}=i,m=ae(!1),_=Zn({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:p()}),b=K(()=>{const se=_.type;return{[c.bm("icon",se)]:se&&Id[se]}}),S=pi(),T=pi(),M=K(()=>_.icon||Id[_.type]||""),R=K(()=>!!_.message),E=ae(),N=ae(),D=ae(),x=ae(),L=ae(),F=K(()=>_.confirmButtonClass);rt(()=>_.inputValue,async se=>{await zt(),e.boxType==="prompt"&&se!==null&&X()},{immediate:!0}),rt(()=>m.value,se=>{var ie,oe;se&&(e.boxType!=="prompt"&&(_.autofocus?D.value=(oe=(ie=L.value)==null?void 0:ie.$el)!=null?oe:E.value:D.value=E.value),_.zIndex=p()),e.boxType==="prompt"&&(se?zt().then(()=>{var ee;x.value&&x.value.$el&&(_.autofocus?D.value=(ee=le())!=null?ee:E.value:D.value=E.value)}):(_.editorErrorMessage="",_.validateError=!1))});const H=K(()=>e.draggable),B=K(()=>e.overflow);Wq(E,N,H,B),fn(async()=>{await zt(),e.closeOnHashChange&&window.addEventListener("hashchange",z)}),Ro(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",z)});function z(){m.value&&(m.value=!1,zt(()=>{_.action&&t("action",_.action)}))}const W=()=>{e.closeOnClickModal&&O(_.distinguishCancelAndClose?"close":"cancel")},Z=IL(W),$=se=>{if(_.inputType!=="textarea")return se.preventDefault(),O("confirm")},O=se=>{var ie;e.boxType==="prompt"&&se==="confirm"&&!X()||(_.action=se,_.beforeClose?(ie=_.beforeClose)==null||ie.call(_,se,_,z):z())},X=()=>{if(e.boxType==="prompt"){const se=_.inputPattern;if(se&&!se.test(_.inputValue||""))return _.editorErrorMessage=_.inputErrorMessage||f("el.messagebox.error"),_.validateError=!0,!1;const ie=_.inputValidator;if(typeof ie=="function"){const oe=ie(_.inputValue);if(oe===!1)return _.editorErrorMessage=_.inputErrorMessage||f("el.messagebox.error"),_.validateError=!0,!1;if(typeof oe=="string")return _.editorErrorMessage=oe,_.validateError=!0,!1}}return _.editorErrorMessage="",_.validateError=!1,!0},le=()=>{const se=x.value.$refs;return se.input||se.textarea},de=()=>{O("close")},he=()=>{e.closeOnPressEscape&&de()};return e.lockScroll&&dL(m),{...ei(_),ns:c,overlayEvent:Z,visible:m,hasMessage:R,typeClass:b,contentId:S,inputId:T,btnSize:u,iconComponent:M,confirmButtonClasses:F,rootRef:E,focusStartRef:D,headerRef:N,inputRef:x,confirmRef:L,doClose:z,handleClose:de,onCloseRequested:he,handleWrapperClick:W,handleInputEnter:$,handleAction:O,t:f}}}),$4e=["aria-label","aria-describedby"],H4e=["aria-label"],q4e=["id"];function K4e(e,t,o,i,c,u){const f=pn("el-icon"),p=pn("close"),m=pn("el-input"),_=pn("el-button"),b=pn("el-focus-trap"),S=pn("el-overlay");return J(),He(Rr,{name:"fade-in-linear",onAfterLeave:t[11]||(t[11]=T=>e.$emit("vanish")),persisted:""},{default:Ne(()=>[hn(Me(S,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:Ne(()=>[Ce("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:ne(`${e.ns.namespace.value}-overlay-message-box`),onClick:t[8]||(t[8]=(...T)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...T)),onMousedown:t[9]||(t[9]=(...T)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...T)),onMouseup:t[10]||(t[10]=(...T)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...T))},[Me(b,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:Ne(()=>[Ce("div",{ref:"rootRef",class:ne([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:Ht(e.customStyle),tabindex:"-1",onClick:t[7]||(t[7]=nn(()=>{},["stop"]))},[e.title!==null&&e.title!==void 0?(J(),ge("div",{key:0,ref:"headerRef",class:ne([e.ns.e("header"),{"show-close":e.showClose}])},[Ce("div",{class:ne(e.ns.e("title"))},[e.iconComponent&&e.center?(J(),He(f,{key:0,class:ne([e.ns.e("status"),e.typeClass])},{default:Ne(()=>[(J(),He(wn(e.iconComponent)))]),_:1},8,["class"])):Fe("v-if",!0),Ce("span",null,pt(e.title),1)],2),e.showClose?(J(),ge("button",{key:0,type:"button",class:ne(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:t[0]||(t[0]=T=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:t[1]||(t[1]=go(nn(T=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[Me(f,{class:ne(e.ns.e("close"))},{default:Ne(()=>[Me(p)]),_:1},8,["class"])],42,H4e)):Fe("v-if",!0)],2)):Fe("v-if",!0),Ce("div",{id:e.contentId,class:ne(e.ns.e("content"))},[Ce("div",{class:ne(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(J(),He(f,{key:0,class:ne([e.ns.e("status"),e.typeClass])},{default:Ne(()=>[(J(),He(wn(e.iconComponent)))]),_:1},8,["class"])):Fe("v-if",!0),e.hasMessage?(J(),ge("div",{key:1,class:ne(e.ns.e("message"))},[We(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(J(),He(wn(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(J(),He(wn(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:Ne(()=>[On(pt(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):Fe("v-if",!0)],2),hn(Ce("div",{class:ne(e.ns.e("input"))},[Me(m,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":t[2]||(t[2]=T=>e.inputValue=T),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:ne({invalid:e.validateError}),onKeydown:go(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ce("div",{class:ne(e.ns.e("errormsg")),style:Ht({visibility:e.editorErrorMessage?"visible":"hidden"})},pt(e.editorErrorMessage),7)],2),[[Jn,e.showInput]])],10,q4e),Ce("div",{class:ne(e.ns.e("btns"))},[e.showCancelButton?(J(),He(_,{key:0,loading:e.cancelButtonLoading,class:ne([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:t[3]||(t[3]=T=>e.handleAction("cancel")),onKeydown:t[4]||(t[4]=go(nn(T=>e.handleAction("cancel"),["prevent"]),["enter"]))},{default:Ne(()=>[On(pt(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):Fe("v-if",!0),hn(Me(_,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:ne([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:t[5]||(t[5]=T=>e.handleAction("confirm")),onKeydown:t[6]||(t[6]=go(nn(T=>e.handleAction("confirm"),["prevent"]),["enter"]))},{default:Ne(()=>[On(pt(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[Jn,e.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,$4e)]),_:3},8,["z-index","overlay-class","mask"]),[[Jn,e.visible]])]),_:3})}var z4e=vt(B4e,[["render",K4e],["__file","index.vue"]]);const tI=new Map,W4e=e=>{let t=document.body;return e.appendTo&&(on(e.appendTo)&&(t=document.querySelector(e.appendTo)),ra(e.appendTo)&&(t=e.appendTo),ra(t)||(t=document.body)),t},j4e=(e,t,o=null)=>{const i=Me(z4e,e,tn(e.message)||$o(e.message)?{default:tn(e.message)?e.message:()=>e.message}:null);return i.appContext=o,gd(i,t),W4e(e).appendChild(t.firstElementChild),i.component},Y4e=()=>document.createElement("div"),J4e=(e,t)=>{const o=Y4e();e.onVanish=()=>{gd(null,o),tI.delete(c)},e.onAction=u=>{const f=tI.get(c);let p;e.showInput?p={value:c.inputValue,action:u}:p=u,e.callback?e.callback(p,i.proxy):u==="cancel"||u==="close"?e.distinguishCancelAndClose&&u!=="cancel"?f.reject("close"):f.reject("cancel"):f.resolve(p)};const i=j4e(e,o,t),c=i.proxy;for(const u in e)qn(e,u)&&!qn(c.$props,u)&&(c[u]=e[u]);return c.visible=!0,c};function zm(e,t=null){if(!$n)return Promise.reject();let o;return on(e)||$o(e)?e={message:e}:o=e.callback,new Promise((i,c)=>{const u=J4e(e,t??zm._context);tI.set(u,{options:e,callback:o,resolve:i,reject:c})})}const X4e=["alert","confirm","prompt"],Q4e={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};X4e.forEach(e=>{zm[e]=Z4e(e)});function Z4e(e){return(t,o,i,c)=>{let u="";return En(o)?(i=o,u=""):_r(o)?u="":u=o,zm(Object.assign({title:u,message:t,type:"",...Q4e[e]},i,{boxType:e}),c)}}zm.close=()=>{tI.forEach((e,t)=>{t.doClose()}),tI.clear()};zm._context=null;const Wu=zm;Wu.install=e=>{Wu._context=e._context,e.config.globalProperties.$msgbox=Wu,e.config.globalProperties.$messageBox=Wu,e.config.globalProperties.$alert=Wu.alert,e.config.globalProperties.$confirm=Wu.confirm,e.config.globalProperties.$prompt=Wu.prompt};const eVe=Wu,BW=["success","info","warning","error"],tVe=gt({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:mo},id:{type:String,default:""},message:{type:Le([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:Le(Function),default:()=>{}},onClose:{type:Le(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...BW,""],default:""},zIndex:Number}),nVe={destroy:()=>!0},oVe=["id"],rVe=["textContent"],iVe={key:0},sVe=["innerHTML"],aVe=Se({name:"ElNotification"}),lVe=Se({...aVe,props:tVe,emits:nVe,setup(e,{expose:t}){const o=e,{ns:i,zIndex:c}=p1("notification"),{nextZIndex:u,currentZIndex:f}=c,{Close:p}=iL,m=ae(!1);let _;const b=K(()=>{const L=o.type;return L&&Id[o.type]?i.m(L):""}),S=K(()=>o.type&&Id[o.type]||o.icon),T=K(()=>o.position.endsWith("right")?"right":"left"),M=K(()=>o.position.startsWith("top")?"top":"bottom"),R=K(()=>{var L;return{[M.value]:`${o.offset}px`,zIndex:(L=o.zIndex)!=null?L:f.value}});function E(){o.duration>0&&({stop:_}=Wf(()=>{m.value&&D()},o.duration))}function N(){_==null||_()}function D(){m.value=!1}function x({code:L}){L===Yt.delete||L===Yt.backspace?N():L===Yt.esc?m.value&&D():E()}return fn(()=>{E(),u(),m.value=!0}),Oo(document,"keydown",x),t({visible:m,close:D}),(L,F)=>(J(),He(Rr,{name:y(i).b("fade"),onBeforeLeave:L.onClose,onAfterLeave:F[1]||(F[1]=H=>L.$emit("destroy")),persisted:""},{default:Ne(()=>[hn(Ce("div",{id:L.id,class:ne([y(i).b(),L.customClass,y(T)]),style:Ht(y(R)),role:"alert",onMouseenter:N,onMouseleave:E,onClick:F[0]||(F[0]=(...H)=>L.onClick&&L.onClick(...H))},[y(S)?(J(),He(y(Gt),{key:0,class:ne([y(i).e("icon"),y(b)])},{default:Ne(()=>[(J(),He(wn(y(S))))]),_:1},8,["class"])):Fe("v-if",!0),Ce("div",{class:ne(y(i).e("group"))},[Ce("h2",{class:ne(y(i).e("title")),textContent:pt(L.title)},null,10,rVe),hn(Ce("div",{class:ne(y(i).e("content")),style:Ht(L.title?void 0:{margin:0})},[We(L.$slots,"default",{},()=>[L.dangerouslyUseHTMLString?(J(),ge(qt,{key:1},[Fe(" Caution here, message could've been compromised, never use user's input as message "),Ce("p",{innerHTML:L.message},null,8,sVe)],2112)):(J(),ge("p",iVe,pt(L.message),1))])],6),[[Jn,L.message]]),L.showClose?(J(),He(y(Gt),{key:0,class:ne(y(i).e("closeBtn")),onClick:nn(D,["stop"])},{default:Ne(()=>[Me(y(p))]),_:1},8,["class","onClick"])):Fe("v-if",!0)],2)],46,oVe),[[Jn,m.value]])]),_:3},8,["name","onBeforeLeave"]))}});var cVe=vt(lVe,[["__file","notification.vue"]]);const FE={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},JO=16;let uVe=1;const Om=function(e={},t=null){if(!$n)return{close:()=>{}};(typeof e=="string"||$o(e))&&(e={message:e});const o=e.position||"top-right";let i=e.offset||0;FE[o].forEach(({vm:b})=>{var S;i+=(((S=b.el)==null?void 0:S.offsetHeight)||0)+JO}),i+=JO;const c=`notification_${uVe++}`,u=e.onClose,f={...e,offset:i,id:c,onClose:()=>{dVe(c,o,u)}};let p=document.body;ra(e.appendTo)?p=e.appendTo:on(e.appendTo)&&(p=document.querySelector(e.appendTo)),ra(p)||(p=document.body);const m=document.createElement("div"),_=Me(cVe,f,$o(f.message)?{default:()=>f.message}:null);return _.appContext=t??Om._context,_.props.onDestroy=()=>{gd(null,m)},gd(_,m),FE[o].push({vm:_}),p.appendChild(m.firstElementChild),{close:()=>{_.component.exposed.visible.value=!1}}};BW.forEach(e=>{Om[e]=(t={})=>((typeof t=="string"||$o(t))&&(t={message:t}),Om({...t,type:e}))});function dVe(e,t,o){const i=FE[t],c=i.findIndex(({vm:_})=>{var b;return((b=_.component)==null?void 0:b.props.id)===e});if(c===-1)return;const{vm:u}=i[c];if(!u)return;o==null||o(u);const f=u.el.offsetHeight,p=t.split("-")[0];i.splice(c,1);const m=i.length;if(!(m<1))for(let _=c;_<m;_++){const{el:b,component:S}=i[_].vm,T=Number.parseInt(b.style[p],10)-f-JO;S.props.offset=T}}function hVe(){for(const e of Object.values(FE))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}Om.closeAll=hVe;Om._context=null;const fVe=Kq(Om,"$notify");var pVe=[b4e,M4e,GW,eVe,fVe,Sz],gVe=sIe([...p4e,...pVe]);const mVe={class:"topClass"},vVe={class:"container"},_Ve={class:"messageList text-center"},yVe={key:0,class:"wholeitem"},IVe={class:"messageitem"},bVe={key:1,class:"wholeitem"},CVe={class:"messageitem"},SVe={class:"inputbox"},TVe=Se({__name:"Chat",setup(e){const t=JH(),o=String(t.query.userId);let i=String(t.query.roomId),c=ae(""),u=Zn([]),f=20009280,p="304be4b653f1d54a6ab7199bb6d8b3ca7ccc4e4f488154492d8bb9934ec7c898",m={SDKAppID:f},_=Pg.create(m);_.setLogLevel(0),_.registerPlugin({"tim-upload-plugin":cde}),_.login({userID:o,userSig:F7({sdkAppId:f,userId:o,sdkSecretKey:p}).userSig}).then(function(M){console.log(M.data),M.data.repeatLogin===!0&&console.log(M.data.errorInfo)}).catch(function(M){console.warn("login error:",M)}),_.on(Pg.EVENT.SDK_READY,()=>{alert("chat准备好了")}),_.on(Pg.EVENT.SDK_NOT_READY,()=>{alert("chat没准备好")}),fn(()=>{});function S(){let M=_.createTextMessage({to:i,conversationType:Pg.TYPES.CONV_C2C,payload:{text:c.value,from:o}});_.sendMessage(M).then(function(E){console.log(E),GW.success(`发送成功，消息为："${c.value}"`),u.push({from:o,value:c.value}),c.value=""}).catch(function(E){console.warn("sendMessage error:",E)})}function T(M){M.data.forEach(R=>{R.type===Pg.TYPES.MSG_TEXT&&u.push({from:R.from,value:R.payload.text})}),console.log(u)}return _.on(Pg.EVENT.MESSAGE_RECEIVED,T),(M,R)=>{const E=pn("el-input"),N=pn("el-button");return J(),ge("div",mVe,[Ce("div",vVe,[Ce("div",_Ve,[(J(!0),ge(qt,null,Vn(y(u),(D,x)=>(J(),ge("div",{key:x,class:ne({mine:D.from==y(o),theirs:D.from!=y(o)})},[D.from==y(o)?(J(),ge("div",yVe,[On(pt(D.from)+" ",1),Ce("div",IVe,pt(D.value),1)])):(J(),ge("div",bVe,[On(pt(D.from)+" ",1),Ce("div",CVe,pt(D.value),1)]))],2))),128))]),Ce("div",SVe,[Me(E,{modelValue:y(c),"onUpdate:modelValue":R[0]||(R[0]=D=>No(c)?c.value=D:c=D),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"]),Me(N,{type:"primary",round:"",onClick:S},{default:Ne(()=>[On("发送")]),_:1})])])])}}}),EVe=cce({history:Gle(),routes:[{path:"/videoChatByTRTC/",component:sde},{path:"/videoChatByTRTC/VideoChat",component:tde},{path:"/videoChatByTRTC/Chat",component:TVe}]}),_2=FH(dce);_2.use(gVe);_2.use(EVe);_2.mount("#app")});export default MVe();
