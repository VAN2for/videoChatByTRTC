var oae=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var r4e=oae((es,ts)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function o(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=o(c);fetch(c.href,u)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ZO(e,t){const o=new Set(e.split(","));return i=>o.has(i)}const Ir={},Eg=[],lo=()=>{},rae=()=>!1,hT=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),QO=e=>e.startsWith("onUpdate:"),Xr=Object.assign,eL=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},iae=Object.prototype.hasOwnProperty,jn=(e,t)=>iae.call(e,t),ht=Array.isArray,Tg=e=>j0(e)==="[object Map]",fT=e=>j0(e)==="[object Set]",$d=e=>j0(e)==="[object Date]",zt=e=>typeof e=="function",Ut=e=>typeof e=="string",ru=e=>typeof e=="symbol",gn=e=>e!==null&&typeof e=="object",h0=e=>(gn(e)||zt(e))&&zt(e.then)&&zt(e.catch),AH=Object.prototype.toString,j0=e=>AH.call(e),aae=e=>j0(e).slice(8,-1),f0=e=>j0(e)==="[object Object]",tL=e=>Ut(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,By=ZO(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),pT=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},sae=/-(\w)/g,os=pT(e=>e.replace(sae,(t,o)=>o?o.toUpperCase():"")),lae=/\B([A-Z])/g,th=pT(e=>e.replace(lae,"-$1").toLowerCase()),Y0=pT(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hy=pT(e=>e?`on${Y0(e)}`:""),qd=(e,t)=>!Object.is(e,t),eE=(e,t)=>{for(let o=0;o<e.length;o++)e[o](t)},DH=(e,t,o,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:o})},_D=e=>{const t=parseFloat(e);return isNaN(t)?e:t},cae=e=>{const t=Ut(e)?Number(e):NaN;return isNaN(t)?e:t};let CG;const OH=()=>CG||(CG=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function qt(e){if(ht(e)){const t={};for(let o=0;o<e.length;o++){const i=e[o],c=Ut(i)?fae(i):qt(i);if(c)for(const u in c)t[u]=c[u]}return t}else if(Ut(e)||gn(e))return e}const uae=/;(?![^(]*\))/g,dae=/:([^]+)/,hae=/\/\*[^]*?\*\//g;function fae(e){const t={};return e.replace(hae,"").split(uae).forEach(o=>{if(o){const i=o.split(dae);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function ne(e){let t="";if(Ut(e))t=e;else if(ht(e))for(let o=0;o<e.length;o++){const i=ne(e[o]);i&&(t+=i+" ")}else if(gn(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}function Za(e){if(!e)return null;let{class:t,style:o}=e;return t&&!Ut(t)&&(e.class=ne(t)),o&&(e.style=qt(o)),e}const pae="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",mae=ZO(pae);function LH(e){return!!e||e===""}function gae(e,t){if(e.length!==t.length)return!1;let o=!0;for(let i=0;o&&i<e.length;i++)o=Fg(e[i],t[i]);return o}function Fg(e,t){if(e===t)return!0;let o=$d(e),i=$d(t);if(o||i)return o&&i?e.getTime()===t.getTime():!1;if(o=ru(e),i=ru(t),o||i)return e===t;if(o=ht(e),i=ht(t),o||i)return o&&i?gae(e,t):!1;if(o=gn(e),i=gn(t),o||i){if(!o||!i)return!1;const c=Object.keys(e).length,u=Object.keys(t).length;if(c!==u)return!1;for(const f in e){const p=e.hasOwnProperty(f),v=t.hasOwnProperty(f);if(p&&!v||!p&&v||!Fg(e[f],t[f]))return!1}}return String(e)===String(t)}function NH(e,t){return e.findIndex(o=>Fg(o,t))}const mt=e=>Ut(e)?e:e==null?"":ht(e)||gn(e)&&(e.toString===AH||!zt(e.toString))?JSON.stringify(e,PH,2):String(e),PH=(e,t)=>t&&t.__v_isRef?PH(e,t.value):Tg(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[i,c],u)=>(o[lA(i,u)+" =>"]=c,o),{})}:fT(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>lA(o))}:ru(t)?lA(t):gn(t)&&!ht(t)&&!f0(t)?String(t):t,lA=(e,t="")=>{var o;return ru(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ja;class xH{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ja,!t&&Ja&&(this.index=(Ja.scopes||(Ja.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const o=Ja;try{return Ja=this,t()}finally{Ja=o}}}on(){Ja=this}off(){Ja=this.parent}stop(t){if(this._active){let o,i;for(o=0,i=this.effects.length;o<i;o++)this.effects[o].stop();for(o=0,i=this.cleanups.length;o<i;o++)this.cleanups[o]();if(this.scopes)for(o=0,i=this.scopes.length;o<i;o++)this.scopes[o].stop(!0);if(!this.detached&&this.parent&&!t){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0,this._active=!1}}}function vae(e){return new xH(e)}function _ae(e,t=Ja){t&&t.active&&t.effects.push(e)}function UH(){return Ja}function FH(e){Ja&&Ja.cleanups.push(e)}let ep;class nL{constructor(t,o,i,c){this.fn=t,this.trigger=o,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,_ae(this,c)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,nh();for(let t=0;t<this._depsLength;t++){const o=this.deps[t];if(o.computed&&(yae(o.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),oh()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=Ud,o=ep;try{return Ud=!0,ep=this,this._runnings++,SG(this),this.fn()}finally{EG(this),this._runnings--,ep=o,Ud=t}}stop(){this.active&&(SG(this),EG(this),this.onStop&&this.onStop(),this.active=!1)}}function yae(e){return e.value}function SG(e){e._trackId++,e._depsLength=0}function EG(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)VH(e.deps[t],e);e.deps.length=e._depsLength}}function VH(e,t){const o=e.get(t);o!==void 0&&t._trackId!==o&&(e.delete(t),e.size===0&&e.cleanup())}let Ud=!0,yD=0;const GH=[];function nh(){GH.push(Ud),Ud=!1}function oh(){const e=GH.pop();Ud=e===void 0?!0:e}function oL(){yD++}function rL(){for(yD--;!yD&&ID.length;)ID.shift()()}function BH(e,t,o){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&VH(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const ID=[];function HH(e,t,o){oL();for(const i of e.keys()){let c;i._dirtyLevel<t&&(c??(c=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(c??(c=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&ID.push(i.scheduler)))}rL()}const $H=(e,t)=>{const o=new Map;return o.cleanup=e,o.computed=t,o},TE=new WeakMap,tp=Symbol(""),bD=Symbol("");function Da(e,t,o){if(Ud&&ep){let i=TE.get(e);i||TE.set(e,i=new Map);let c=i.get(o);c||i.set(o,c=$H(()=>i.delete(o))),BH(ep,c)}}function eu(e,t,o,i,c,u){const f=TE.get(e);if(!f)return;let p=[];if(t==="clear")p=[...f.values()];else if(o==="length"&&ht(e)){const v=Number(i);f.forEach((_,b)=>{(b==="length"||!ru(b)&&b>=v)&&p.push(_)})}else switch(o!==void 0&&p.push(f.get(o)),t){case"add":ht(e)?tL(o)&&p.push(f.get("length")):(p.push(f.get(tp)),Tg(e)&&p.push(f.get(bD)));break;case"delete":ht(e)||(p.push(f.get(tp)),Tg(e)&&p.push(f.get(bD)));break;case"set":Tg(e)&&p.push(f.get(tp));break}oL();for(const v of p)v&&HH(v,4);rL()}function Iae(e,t){const o=TE.get(e);return o&&o.get(t)}const bae=ZO("__proto__,__v_isRef,__isVue"),qH=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ru)),TG=Cae();function Cae(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...o){const i=Mo(this);for(let u=0,f=this.length;u<f;u++)Da(i,"get",u+"");const c=i[t](...o);return c===-1||c===!1?i[t](...o.map(Mo)):c}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...o){nh(),oL();const i=Mo(this)[t].apply(this,o);return rL(),oh(),i}}),e}function Sae(e){ru(e)||(e=String(e));const t=Mo(this);return Da(t,"has",e),t.hasOwnProperty(e)}class KH{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,i){const c=this._isReadonly,u=this._isShallow;if(o==="__v_isReactive")return!c;if(o==="__v_isReadonly")return c;if(o==="__v_isShallow")return u;if(o==="__v_raw")return i===(c?u?xae:YH:u?jH:WH).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const f=ht(t);if(!c){if(f&&jn(TG,o))return Reflect.get(TG,o,i);if(o==="hasOwnProperty")return Sae}const p=Reflect.get(t,o,i);return(ru(o)?qH.has(o):bae(o))||(c||Da(t,"get",o),u)?p:Bo(p)?f&&tL(o)?p:p.value:gn(p)?c?sv(p):eo(p):p}}class zH extends KH{constructor(t=!1){super(!1,t)}set(t,o,i,c){let u=t[o];if(!this._isShallow){const v=p0(u);if(!ME(i)&&!p0(i)&&(u=Mo(u),i=Mo(i)),!ht(t)&&Bo(u)&&!Bo(i))return v?!1:(u.value=i,!0)}const f=ht(t)&&tL(o)?Number(o)<t.length:jn(t,o),p=Reflect.set(t,o,i,c);return t===Mo(c)&&(f?qd(i,u)&&eu(t,"set",o,i):eu(t,"add",o,i)),p}deleteProperty(t,o){const i=jn(t,o);t[o];const c=Reflect.deleteProperty(t,o);return c&&i&&eu(t,"delete",o,void 0),c}has(t,o){const i=Reflect.has(t,o);return(!ru(o)||!qH.has(o))&&Da(t,"has",o),i}ownKeys(t){return Da(t,"iterate",ht(t)?"length":tp),Reflect.ownKeys(t)}}class Eae extends KH{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Tae=new zH,Mae=new Eae,kae=new zH(!0),iL=e=>e,mT=e=>Reflect.getPrototypeOf(e);function vS(e,t,o=!1,i=!1){e=e.__v_raw;const c=Mo(e),u=Mo(t);o||(qd(t,u)&&Da(c,"get",t),Da(c,"get",u));const{has:f}=mT(c),p=i?iL:o?cL:m0;if(f.call(c,t))return p(e.get(t));if(f.call(c,u))return p(e.get(u));e!==c&&e.get(t)}function _S(e,t=!1){const o=this.__v_raw,i=Mo(o),c=Mo(e);return t||(qd(e,c)&&Da(i,"has",e),Da(i,"has",c)),e===c?o.has(e):o.has(e)||o.has(c)}function yS(e,t=!1){return e=e.__v_raw,!t&&Da(Mo(e),"iterate",tp),Reflect.get(e,"size",e)}function MG(e){e=Mo(e);const t=Mo(this);return mT(t).has.call(t,e)||(t.add(e),eu(t,"add",e,e)),this}function kG(e,t){t=Mo(t);const o=Mo(this),{has:i,get:c}=mT(o);let u=i.call(o,e);u||(e=Mo(e),u=i.call(o,e));const f=c.call(o,e);return o.set(e,t),u?qd(t,f)&&eu(o,"set",e,t):eu(o,"add",e,t),this}function wG(e){const t=Mo(this),{has:o,get:i}=mT(t);let c=o.call(t,e);c||(e=Mo(e),c=o.call(t,e)),i&&i.call(t,e);const u=t.delete(e);return c&&eu(t,"delete",e,void 0),u}function RG(){const e=Mo(this),t=e.size!==0,o=e.clear();return t&&eu(e,"clear",void 0,void 0),o}function IS(e,t){return function(i,c){const u=this,f=u.__v_raw,p=Mo(f),v=t?iL:e?cL:m0;return!e&&Da(p,"iterate",tp),f.forEach((_,b)=>i.call(c,v(_),v(b),u))}}function bS(e,t,o){return function(...i){const c=this.__v_raw,u=Mo(c),f=Tg(u),p=e==="entries"||e===Symbol.iterator&&f,v=e==="keys"&&f,_=c[e](...i),b=o?iL:t?cL:m0;return!t&&Da(u,"iterate",v?bD:tp),{next(){const{value:S,done:k}=_.next();return k?{value:S,done:k}:{value:p?[b(S[0]),b(S[1])]:b(S),done:k}},[Symbol.iterator](){return this}}}}function pd(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function wae(){const e={get(u){return vS(this,u)},get size(){return yS(this)},has:_S,add:MG,set:kG,delete:wG,clear:RG,forEach:IS(!1,!1)},t={get(u){return vS(this,u,!1,!0)},get size(){return yS(this)},has:_S,add:MG,set:kG,delete:wG,clear:RG,forEach:IS(!1,!0)},o={get(u){return vS(this,u,!0)},get size(){return yS(this,!0)},has(u){return _S.call(this,u,!0)},add:pd("add"),set:pd("set"),delete:pd("delete"),clear:pd("clear"),forEach:IS(!0,!1)},i={get(u){return vS(this,u,!0,!0)},get size(){return yS(this,!0)},has(u){return _S.call(this,u,!0)},add:pd("add"),set:pd("set"),delete:pd("delete"),clear:pd("clear"),forEach:IS(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{e[u]=bS(u,!1,!1),o[u]=bS(u,!0,!1),t[u]=bS(u,!1,!0),i[u]=bS(u,!0,!0)}),[e,o,t,i]}const[Rae,Aae,Dae,Oae]=wae();function aL(e,t){const o=t?e?Oae:Dae:e?Aae:Rae;return(i,c,u)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?i:Reflect.get(jn(o,c)&&c in i?o:i,c,u)}const Lae={get:aL(!1,!1)},Nae={get:aL(!1,!0)},Pae={get:aL(!0,!1)},WH=new WeakMap,jH=new WeakMap,YH=new WeakMap,xae=new WeakMap;function Uae(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fae(e){return e.__v_skip||!Object.isExtensible(e)?0:Uae(aae(e))}function eo(e){return p0(e)?e:lL(e,!1,Tae,Lae,WH)}function sL(e){return lL(e,!1,kae,Nae,jH)}function sv(e){return lL(e,!0,Mae,Pae,YH)}function lL(e,t,o,i,c){if(!gn(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const u=c.get(e);if(u)return u;const f=Fae(e);if(f===0)return e;const p=new Proxy(e,f===2?i:o);return c.set(e,p),p}function $y(e){return p0(e)?$y(e.__v_raw):!!(e&&e.__v_isReactive)}function p0(e){return!!(e&&e.__v_isReadonly)}function ME(e){return!!(e&&e.__v_isShallow)}function JH(e){return e?!!e.__v_raw:!1}function Mo(e){const t=e&&e.__v_raw;return t?Mo(t):e}function tu(e){return Object.isExtensible(e)&&DH(e,"__v_skip",!0),e}const m0=e=>gn(e)?eo(e):e,cL=e=>gn(e)?sv(e):e;class XH{constructor(t,o,i,c){this.getter=t,this._setter=o,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new nL(()=>t(this._value),()=>qy(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=i}get value(){const t=Mo(this);return(!t._cacheable||t.effect.dirty)&&qd(t._value,t._value=t.effect.run())&&qy(t,4),uL(t),t.effect._dirtyLevel>=2&&qy(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function Vae(e,t,o=!1){let i,c;const u=zt(e);return u?(i=e,c=lo):(i=e.get,c=e.set),new XH(i,c,u||!c,o)}function uL(e){var t;Ud&&ep&&(e=Mo(e),BH(ep,(t=e.dep)!=null?t:e.dep=$H(()=>e.dep=void 0,e instanceof XH?e:void 0)))}function qy(e,t=4,o){e=Mo(e);const i=e.dep;i&&HH(i,t)}function Bo(e){return!!(e&&e.__v_isRef===!0)}function le(e){return ZH(e,!1)}function Go(e){return ZH(e,!0)}function ZH(e,t){return Bo(e)?e:new Gae(e,t)}class Gae{constructor(t,o){this.__v_isShallow=o,this.dep=void 0,this.__v_isRef=!0,this._rawValue=o?t:Mo(t),this._value=o?t:m0(t)}get value(){return uL(this),this._value}set value(t){const o=this.__v_isShallow||ME(t)||p0(t);t=o?t:Mo(t),qd(t,this._rawValue)&&(this._rawValue=t,this._value=o?t:m0(t),qy(this,4))}}function y(e){return Bo(e)?e.value:e}const Bae={get:(e,t,o)=>y(Reflect.get(e,t,o)),set:(e,t,o,i)=>{const c=e[t];return Bo(c)&&!Bo(o)?(c.value=o,!0):Reflect.set(e,t,o,i)}};function QH(e){return $y(e)?e:new Proxy(e,Bae)}class Hae{constructor(t){this.dep=void 0,this.__v_isRef=!0;const{get:o,set:i}=t(()=>uL(this),()=>qy(this));this._get=o,this._set=i}get value(){return this._get()}set value(t){this._set(t)}}function $ae(e){return new Hae(e)}function hi(e){const t=ht(e)?new Array(e.length):{};for(const o in e)t[o]=e$(e,o);return t}class qae{constructor(t,o,i){this._object=t,this._key=o,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Iae(Mo(this._object),this._key)}}class Kae{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function uo(e,t,o){return Bo(e)?e:zt(e)?new Kae(e):gn(e)&&arguments.length>1?e$(e,t,o):le(e)}function e$(e,t,o){const i=e[t];return Bo(i)?i:new qae(e,t,o)}/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fd(e,t,o,i){try{return i?e(...i):e()}catch(c){gT(c,t,o)}}function Ts(e,t,o,i){if(zt(e)){const c=Fd(e,t,o,i);return c&&h0(c)&&c.catch(u=>{gT(u,t,o)}),c}if(ht(e)){const c=[];for(let u=0;u<e.length;u++)c.push(Ts(e[u],t,o,i));return c}}function gT(e,t,o,i=!0){const c=t?t.vnode:null;if(t){let u=t.parent;const f=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${o}`;for(;u;){const _=u.ec;if(_){for(let b=0;b<_.length;b++)if(_[b](e,f,p)===!1)return}u=u.parent}const v=t.appContext.config.errorHandler;if(v){nh(),Fd(v,null,10,[e,f,p]),oh();return}}zae(e,o,c,i)}function zae(e,t,o,i=!0){console.error(e)}let g0=!1,CD=!1;const zi=[];let Kl=0;const Mg=[];let Td=null,Df=0;const t$=Promise.resolve();let dL=null;function Vt(e){const t=dL||t$;return e?t.then(this?e.bind(this):e):t}function Wae(e){let t=Kl+1,o=zi.length;for(;t<o;){const i=t+o>>>1,c=zi[i],u=v0(c);u<e||u===e&&c.pre?t=i+1:o=i}return t}function hL(e){(!zi.length||!zi.includes(e,g0&&e.allowRecurse?Kl+1:Kl))&&(e.id==null?zi.push(e):zi.splice(Wae(e.id),0,e),n$())}function n$(){!g0&&!CD&&(CD=!0,dL=t$.then(r$))}function jae(e){const t=zi.indexOf(e);t>Kl&&zi.splice(t,1)}function Yae(e){ht(e)?Mg.push(...e):(!Td||!Td.includes(e,e.allowRecurse?Df+1:Df))&&Mg.push(e),n$()}function AG(e,t,o=g0?Kl+1:0){for(;o<zi.length;o++){const i=zi[o];if(i&&i.pre){if(e&&i.id!==e.uid)continue;zi.splice(o,1),o--,i()}}}function o$(e){if(Mg.length){const t=[...new Set(Mg)].sort((o,i)=>v0(o)-v0(i));if(Mg.length=0,Td){Td.push(...t);return}for(Td=t,Df=0;Df<Td.length;Df++)Td[Df]();Td=null,Df=0}}const v0=e=>e.id==null?1/0:e.id,Jae=(e,t)=>{const o=v0(e)-v0(t);if(o===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return o};function r$(e){CD=!1,g0=!0,zi.sort(Jae);try{for(Kl=0;Kl<zi.length;Kl++){const t=zi[Kl];t&&t.active!==!1&&Fd(t,null,14)}}finally{Kl=0,zi.length=0,o$(),g0=!1,dL=null,(zi.length||Mg.length)&&r$()}}function Xae(e,t,...o){if(e.isUnmounted)return;const i=e.vnode.props||Ir;let c=o;const u=t.startsWith("update:"),f=u&&t.slice(7);if(f&&f in i){const b=`${f==="modelValue"?"model":f}Modifiers`,{number:S,trim:k}=i[b]||Ir;k&&(c=o.map(M=>Ut(M)?M.trim():M)),S&&(c=o.map(_D))}let p,v=i[p=Hy(t)]||i[p=Hy(os(t))];!v&&u&&(v=i[p=Hy(th(t))]),v&&Ts(v,e,6,c);const _=i[p+"Once"];if(_){if(!e.emitted)e.emitted={};else if(e.emitted[p])return;e.emitted[p]=!0,Ts(_,e,6,c)}}function i$(e,t,o=!1){const i=t.emitsCache,c=i.get(e);if(c!==void 0)return c;const u=e.emits;let f={},p=!1;if(!zt(e)){const v=_=>{const b=i$(_,t,!0);b&&(p=!0,Xr(f,b))};!o&&t.mixins.length&&t.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}return!u&&!p?(gn(e)&&i.set(e,null),null):(ht(u)?u.forEach(v=>f[v]=null):Xr(f,u),gn(e)&&i.set(e,f),f)}function vT(e,t){return!e||!hT(t)?!1:(t=t.slice(2).replace(/Once$/,""),jn(e,t[0].toLowerCase()+t.slice(1))||jn(e,th(t))||jn(e,t))}let ci=null,a$=null;function kE(e){const t=ci;return ci=e,a$=e&&e.type.__scopeId||null,t}function Ae(e,t=ci,o){if(!t||e._n)return e;const i=(...c)=>{i._d&&qG(-1);const u=kE(t);let f;try{f=e(...c)}finally{kE(u),i._d&&qG(1)}return f};return i._n=!0,i._c=!0,i._d=!0,i}function cA(e){const{type:t,vnode:o,proxy:i,withProxy:c,propsOptions:[u],slots:f,attrs:p,emit:v,render:_,renderCache:b,props:S,data:k,setupState:M,ctx:R,inheritAttrs:w}=e,E=kE(e);let N,F;try{if(o.shapeFlag&4){const P=c||i,G=P;N=ql(_.call(G,P,b,S,M,k,R)),F=p}else{const P=t;N=ql(P.length>1?P(S,{attrs:p,slots:f,emit:v}):P(S,null)),F=t.props?p:Zae(p)}}catch(P){Yy.length=0,gT(P,e,1),N=Me(Ai)}let x=N;if(F&&w!==!1){const P=Object.keys(F),{shapeFlag:G}=x;P.length&&G&7&&(u&&P.some(QO)&&(F=Qae(F,u)),x=iu(x,F,!1,!0))}return o.dirs&&(x=iu(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(o.dirs):o.dirs),o.transition&&(x.transition=o.transition),N=x,kE(E),N}const Zae=e=>{let t;for(const o in e)(o==="class"||o==="style"||hT(o))&&((t||(t={}))[o]=e[o]);return t},Qae=(e,t)=>{const o={};for(const i in e)(!QO(i)||!(i.slice(9)in t))&&(o[i]=e[i]);return o};function ese(e,t,o){const{props:i,children:c,component:u}=e,{props:f,children:p,patchFlag:v}=t,_=u.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&v>=0){if(v&1024)return!0;if(v&16)return i?DG(i,f,_):!!f;if(v&8){const b=t.dynamicProps;for(let S=0;S<b.length;S++){const k=b[S];if(f[k]!==i[k]&&!vT(_,k))return!0}}}else return(c||p)&&(!p||!p.$stable)?!0:i===f?!1:i?f?DG(i,f,_):!0:!!f;return!1}function DG(e,t,o){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let c=0;c<i.length;c++){const u=i[c];if(t[u]!==e[u]&&!vT(o,u))return!0}return!1}function tse({vnode:e,parent:t},o){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=o,t=t.parent;else break}}const fL="components",nse="directives";function Cn(e,t){return pL(fL,e,!0,t)||e}const s$=Symbol.for("v-ndc");function Tn(e){return Ut(e)?pL(fL,e,!1)||e:e||s$}function _T(e){return pL(nse,e)}function pL(e,t,o=!0,i=!1){const c=ci||Ri;if(c){const u=c.type;if(e===fL){const p=Kse(u,!1);if(p&&(p===t||p===os(t)||p===Y0(os(t))))return u}const f=OG(c[e]||u[e],t)||OG(c.appContext[e],t);return!f&&i?u:f}}function OG(e,t){return e&&(e[t]||e[os(t)]||e[Y0(os(t))])}const ose=e=>e.__isSuspense;function rse(e,t){t&&t.pendingBranch?ht(e)?t.effects.push(...e):t.effects.push(e):Yae(e)}const ise=Symbol.for("v-scx"),ase=()=>Rt(ise);function Di(e,t){return mL(e,null,t)}const CS={};function st(e,t,o){return mL(e,t,o)}function mL(e,t,{immediate:o,deep:i,flush:c,once:u,onTrack:f,onTrigger:p}=Ir){if(t&&u){const H=t;t=(...Y)=>{H(...Y),G()}}const v=Ri,_=H=>i===!0?H:Uf(H,i===!1?1:void 0);let b,S=!1,k=!1;if(Bo(e)?(b=()=>e.value,S=ME(e)):$y(e)?(b=()=>_(e),S=!0):ht(e)?(k=!0,S=e.some(H=>$y(H)||ME(H)),b=()=>e.map(H=>{if(Bo(H))return H.value;if($y(H))return _(H);if(zt(H))return Fd(H,v,2)})):zt(e)?t?b=()=>Fd(e,v,2):b=()=>(M&&M(),Ts(e,v,3,[R])):b=lo,t&&i){const H=b;b=()=>Uf(H())}let M,R=H=>{M=x.onStop=()=>{Fd(H,v,4),M=x.onStop=void 0}},w;if(CT)if(R=lo,t?o&&Ts(t,v,3,[b(),k?[]:void 0,R]):b(),c==="sync"){const H=ase();w=H.__watcherHandles||(H.__watcherHandles=[])}else return lo;let E=k?new Array(e.length).fill(CS):CS;const N=()=>{if(!(!x.active||!x.dirty))if(t){const H=x.run();(i||S||(k?H.some((Y,j)=>qd(Y,E[j])):qd(H,E)))&&(M&&M(),Ts(t,v,3,[H,E===CS?void 0:k&&E[0]===CS?[]:E,R]),E=H)}else x.run()};N.allowRecurse=!!t;let F;c==="sync"?F=N:c==="post"?F=()=>Ea(N,v&&v.suspense):(N.pre=!0,v&&(N.id=v.uid),F=()=>hL(N));const x=new nL(b,lo,F),P=UH(),G=()=>{x.stop(),P&&eL(P.effects,x)};return t?o?N():E=x.run():c==="post"?Ea(x.run.bind(x),v&&v.suspense):x.run(),w&&w.push(G),G}function sse(e,t,o){const i=this.proxy,c=Ut(e)?e.includes(".")?l$(i,e):()=>i[e]:e.bind(i,i);let u;zt(t)?u=t:(u=t.handler,o=t);const f=J0(this),p=mL(c,u.bind(i),o);return f(),p}function l$(e,t){const o=t.split(".");return()=>{let i=e;for(let c=0;c<o.length&&i;c++)i=i[o[c]];return i}}function Uf(e,t=1/0,o){if(t<=0||!gn(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),t--,Bo(e))Uf(e.value,t,o);else if(ht(e))for(let i=0;i<e.length;i++)Uf(e[i],t,o);else if(fT(e)||Tg(e))e.forEach(i=>{Uf(i,t,o)});else if(f0(e))for(const i in e)Uf(e[i],t,o);return e}function fn(e,t){if(ci===null)return e;const o=ST(ci)||ci.proxy,i=e.dirs||(e.dirs=[]);for(let c=0;c<t.length;c++){let[u,f,p,v=Ir]=t[c];u&&(zt(u)&&(u={mounted:u,updated:u}),u.deep&&Uf(f),i.push({dir:u,instance:o,value:f,oldValue:void 0,arg:p,modifiers:v}))}return e}function Cf(e,t,o,i){const c=e.dirs,u=t&&t.dirs;for(let f=0;f<c.length;f++){const p=c[f];u&&(p.oldValue=u[f].value);let v=p.dir[i];v&&(nh(),Ts(v,o,8,[e.el,p,e,t]),oh())}}const Md=Symbol("_leaveCb"),SS=Symbol("_enterCb");function c$(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mn(()=>{e.isMounted=!0}),Co(()=>{e.isUnmounting=!0}),e}const vs=[Function,Array],u$={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:vs,onEnter:vs,onAfterEnter:vs,onEnterCancelled:vs,onBeforeLeave:vs,onLeave:vs,onAfterLeave:vs,onLeaveCancelled:vs,onBeforeAppear:vs,onAppear:vs,onAfterAppear:vs,onAppearCancelled:vs},lse={name:"BaseTransition",props:u$,setup(e,{slots:t}){const o=kn(),i=c$();return()=>{const c=t.default&&gL(t.default(),!0);if(!c||!c.length)return;let u=c[0];if(c.length>1){for(const k of c)if(k.type!==Ai){u=k;break}}const f=Mo(e),{mode:p}=f;if(i.isLeaving)return uA(u);const v=LG(u);if(!v)return uA(u);const _=_0(v,f,i,o);y0(v,_);const b=o.subTree,S=b&&LG(b);if(S&&S.type!==Ai&&!Of(v,S)){const k=_0(S,f,i,o);if(y0(S,k),p==="out-in"&&v.type!==Ai)return i.isLeaving=!0,k.afterLeave=()=>{i.isLeaving=!1,o.update.active!==!1&&(o.effect.dirty=!0,o.update())},uA(u);p==="in-out"&&v.type!==Ai&&(k.delayLeave=(M,R,w)=>{const E=d$(i,S);E[String(S.key)]=S,M[Md]=()=>{R(),M[Md]=void 0,delete _.delayedLeave},_.delayedLeave=w})}return u}}},cse=lse;function d$(e,t){const{leavingVNodes:o}=e;let i=o.get(t.type);return i||(i=Object.create(null),o.set(t.type,i)),i}function _0(e,t,o,i){const{appear:c,mode:u,persisted:f=!1,onBeforeEnter:p,onEnter:v,onAfterEnter:_,onEnterCancelled:b,onBeforeLeave:S,onLeave:k,onAfterLeave:M,onLeaveCancelled:R,onBeforeAppear:w,onAppear:E,onAfterAppear:N,onAppearCancelled:F}=t,x=String(e.key),P=d$(o,e),G=(j,W)=>{j&&Ts(j,i,9,W)},H=(j,W)=>{const O=W[1];G(j,W),ht(j)?j.every(Q=>Q.length<=1)&&O():j.length<=1&&O()},Y={mode:u,persisted:f,beforeEnter(j){let W=p;if(!o.isMounted)if(c)W=w||p;else return;j[Md]&&j[Md](!0);const O=P[x];O&&Of(e,O)&&O.el[Md]&&O.el[Md](),G(W,[j])},enter(j){let W=v,O=_,Q=b;if(!o.isMounted)if(c)W=E||v,O=N||_,Q=F||b;else return;let J=!1;const oe=j[SS]=pe=>{J||(J=!0,pe?G(Q,[j]):G(O,[j]),Y.delayedLeave&&Y.delayedLeave(),j[SS]=void 0)};W?H(W,[j,oe]):oe()},leave(j,W){const O=String(e.key);if(j[SS]&&j[SS](!0),o.isUnmounting)return W();G(S,[j]);let Q=!1;const J=j[Md]=oe=>{Q||(Q=!0,W(),oe?G(R,[j]):G(M,[j]),j[Md]=void 0,P[O]===e&&delete P[O])};P[O]=e,k?H(k,[j,J]):J()},clone(j){return _0(j,t,o,i)}};return Y}function uA(e){if(yT(e))return e=iu(e),e.children=null,e}function LG(e){if(!yT(e))return e;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&zt(o.default))return o.default()}}function y0(e,t){e.shapeFlag&6&&e.component?y0(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function gL(e,t=!1,o){let i=[],c=0;for(let u=0;u<e.length;u++){let f=e[u];const p=o==null?f.key:String(o)+String(f.key!=null?f.key:u);f.type===Ht?(f.patchFlag&128&&c++,i=i.concat(gL(f.children,t,p))):(t||f.type!==Ai)&&i.push(p!=null?iu(f,{key:p}):f)}if(c>1)for(let u=0;u<i.length;u++)i[u].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Te(e,t){return zt(e)?Xr({name:e.name},t,{setup:e}):e}const Ky=e=>!!e.type.__asyncLoader,yT=e=>e.type.__isKeepAlive;function vL(e,t){f$(e,"a",t)}function h$(e,t){f$(e,"da",t)}function f$(e,t,o=Ri){const i=e.__wdc||(e.__wdc=()=>{let c=o;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(IT(t,i,o),o){let c=o.parent;for(;c&&c.parent;)yT(c.parent.vnode)&&use(i,t,o,c),c=c.parent}}function use(e,t,o,i){const c=IT(t,e,i,!0);rh(()=>{eL(i[t],c)},o)}function IT(e,t,o=Ri,i=!1){if(o){const c=o[e]||(o[e]=[]),u=t.__weh||(t.__weh=(...f)=>{if(o.isUnmounted)return;nh();const p=J0(o),v=Ts(t,o,e,f);return p(),oh(),v});return i?c.unshift(u):c.push(u),u}}const cu=e=>(t,o=Ri)=>(!CT||e==="sp")&&IT(e,(...i)=>t(...i),o),bT=cu("bm"),mn=cu("m"),p$=cu("bu"),dl=cu("u"),Co=cu("bum"),rh=cu("um"),dse=cu("sp"),hse=cu("rtg"),fse=cu("rtc");function pse(e,t=Ri){IT("ec",e,t)}function Un(e,t,o,i){let c;const u=o;if(ht(e)||Ut(e)){c=new Array(e.length);for(let f=0,p=e.length;f<p;f++)c[f]=t(e[f],f,void 0,u)}else if(typeof e=="number"){c=new Array(e);for(let f=0;f<e;f++)c[f]=t(f+1,f,void 0,u)}else if(gn(e))if(e[Symbol.iterator])c=Array.from(e,(f,p)=>t(f,p,void 0,u));else{const f=Object.keys(e);c=new Array(f.length);for(let p=0,v=f.length;p<v;p++){const _=f[p];c[p]=t(e[_],_,p,u)}}else c=[];return c}function rs(e,t){for(let o=0;o<t.length;o++){const i=t[o];if(ht(i))for(let c=0;c<i.length;c++)e[i[c].name]=i[c].fn;else i&&(e[i.name]=i.key?(...c)=>{const u=i.fn(...c);return u&&(u.key=i.key),u}:i.fn)}return e}function Ve(e,t,o={},i,c){if(ci.isCE||ci.parent&&Ky(ci.parent)&&ci.parent.isCE)return t!=="default"&&(o.name=t),Me("slot",o,i&&i());let u=e[t];u&&u._c&&(u._d=!1),ee();const f=u&&m$(u(o)),p=We(Ht,{key:o.key||f&&f.key||`_${t}`},f||(i?i():[]),f&&e._===1?64:-2);return p.scopeId&&(p.slotScopeIds=[p.scopeId+"-s"]),u&&u._c&&(u._d=!0),p}function m$(e){return e.some(t=>Wo(t)?!(t.type===Ai||t.type===Ht&&!m$(t.children)):!0)?e:null}function mse(e,t){const o={};for(const i in e)o[Hy(i)]=e[i];return o}const SD=e=>e?D$(e)?ST(e)||e.proxy:SD(e.parent):null,zy=Xr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>SD(e.parent),$root:e=>SD(e.root),$emit:e=>e.emit,$options:e=>_L(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,hL(e.update)}),$nextTick:e=>e.n||(e.n=Vt.bind(e.proxy)),$watch:e=>sse.bind(e)}),dA=(e,t)=>e!==Ir&&!e.__isScriptSetup&&jn(e,t),gse={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:i,data:c,props:u,accessCache:f,type:p,appContext:v}=e;let _;if(t[0]!=="$"){const M=f[t];if(M!==void 0)switch(M){case 1:return i[t];case 2:return c[t];case 4:return o[t];case 3:return u[t]}else{if(dA(i,t))return f[t]=1,i[t];if(c!==Ir&&jn(c,t))return f[t]=2,c[t];if((_=e.propsOptions[0])&&jn(_,t))return f[t]=3,u[t];if(o!==Ir&&jn(o,t))return f[t]=4,o[t];ED&&(f[t]=0)}}const b=zy[t];let S,k;if(b)return t==="$attrs"&&Da(e.attrs,"get",""),b(e);if((S=p.__cssModules)&&(S=S[t]))return S;if(o!==Ir&&jn(o,t))return f[t]=4,o[t];if(k=v.config.globalProperties,jn(k,t))return k[t]},set({_:e},t,o){const{data:i,setupState:c,ctx:u}=e;return dA(c,t)?(c[t]=o,!0):i!==Ir&&jn(i,t)?(i[t]=o,!0):jn(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(u[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:i,appContext:c,propsOptions:u}},f){let p;return!!o[f]||e!==Ir&&jn(e,f)||dA(t,f)||(p=u[0])&&jn(p,f)||jn(i,f)||jn(zy,f)||jn(c.config.globalProperties,f)},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:jn(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Qr(){return g$().slots}function uu(){return g$().attrs}function g$(){const e=kn();return e.setupContext||(e.setupContext=L$(e))}function NG(e){return ht(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let ED=!0;function vse(e){const t=_L(e),o=e.proxy,i=e.ctx;ED=!1,t.beforeCreate&&PG(t.beforeCreate,e,"bc");const{data:c,computed:u,methods:f,watch:p,provide:v,inject:_,created:b,beforeMount:S,mounted:k,beforeUpdate:M,updated:R,activated:w,deactivated:E,beforeDestroy:N,beforeUnmount:F,destroyed:x,unmounted:P,render:G,renderTracked:H,renderTriggered:Y,errorCaptured:j,serverPrefetch:W,expose:O,inheritAttrs:Q,components:J,directives:oe,filters:pe}=t;if(_&&_se(_,i,null),f)for(const he in f){const re=f[he];zt(re)&&(i[he]=re.bind(o))}if(c){const he=c.call(o,o);gn(he)&&(e.data=eo(he))}if(ED=!0,u)for(const he in u){const re=u[he],X=zt(re)?re.bind(o,o):zt(re.get)?re.get.bind(o,o):lo,ye=!zt(re)&&zt(re.set)?re.set.bind(o):lo,ue=z({get:X,set:ye});Object.defineProperty(i,he,{enumerable:!0,configurable:!0,get:()=>ue.value,set:Ie=>ue.value=Ie})}if(p)for(const he in p)v$(p[he],i,o,he);if(v){const he=zt(v)?v.call(o):v;Reflect.ownKeys(he).forEach(re=>{Nn(re,he[re])})}b&&PG(b,e,"c");function te(he,re){ht(re)?re.forEach(X=>he(X.bind(o))):re&&he(re.bind(o))}if(te(bT,S),te(mn,k),te(p$,M),te(dl,R),te(vL,w),te(h$,E),te(pse,j),te(fse,H),te(hse,Y),te(Co,F),te(rh,P),te(dse,W),ht(O))if(O.length){const he=e.exposed||(e.exposed={});O.forEach(re=>{Object.defineProperty(he,re,{get:()=>o[re],set:X=>o[re]=X})})}else e.exposed||(e.exposed={});G&&e.render===lo&&(e.render=G),Q!=null&&(e.inheritAttrs=Q),J&&(e.components=J),oe&&(e.directives=oe)}function _se(e,t,o=lo){ht(e)&&(e=TD(e));for(const i in e){const c=e[i];let u;gn(c)?"default"in c?u=Rt(c.from||i,c.default,!0):u=Rt(c.from||i):u=Rt(c),Bo(u)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>u.value,set:f=>u.value=f}):t[i]=u}}function PG(e,t,o){Ts(ht(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,o)}function v$(e,t,o,i){const c=i.includes(".")?l$(o,i):()=>o[i];if(Ut(e)){const u=t[e];zt(u)&&st(c,u)}else if(zt(e))st(c,e.bind(o));else if(gn(e))if(ht(e))e.forEach(u=>v$(u,t,o,i));else{const u=zt(e.handler)?e.handler.bind(o):t[e.handler];zt(u)&&st(c,u,e)}}function _L(e){const t=e.type,{mixins:o,extends:i}=t,{mixins:c,optionsCache:u,config:{optionMergeStrategies:f}}=e.appContext,p=u.get(t);let v;return p?v=p:!c.length&&!o&&!i?v=t:(v={},c.length&&c.forEach(_=>wE(v,_,f,!0)),wE(v,t,f)),gn(t)&&u.set(t,v),v}function wE(e,t,o,i=!1){const{mixins:c,extends:u}=t;u&&wE(e,u,o,!0),c&&c.forEach(f=>wE(e,f,o,!0));for(const f in t)if(!(i&&f==="expose")){const p=yse[f]||o&&o[f];e[f]=p?p(e[f],t[f]):t[f]}return e}const yse={data:xG,props:UG,emits:UG,methods:xy,computed:xy,beforeCreate:ra,created:ra,beforeMount:ra,mounted:ra,beforeUpdate:ra,updated:ra,beforeDestroy:ra,beforeUnmount:ra,destroyed:ra,unmounted:ra,activated:ra,deactivated:ra,errorCaptured:ra,serverPrefetch:ra,components:xy,directives:xy,watch:bse,provide:xG,inject:Ise};function xG(e,t){return t?e?function(){return Xr(zt(e)?e.call(this,this):e,zt(t)?t.call(this,this):t)}:t:e}function Ise(e,t){return xy(TD(e),TD(t))}function TD(e){if(ht(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function ra(e,t){return e?[...new Set([].concat(e,t))]:t}function xy(e,t){return e?Xr(Object.create(null),e,t):t}function UG(e,t){return e?ht(e)&&ht(t)?[...new Set([...e,...t])]:Xr(Object.create(null),NG(e),NG(t??{})):t}function bse(e,t){if(!e)return t;if(!t)return e;const o=Xr(Object.create(null),e);for(const i in t)o[i]=ra(e[i],t[i]);return o}function _$(){return{app:null,config:{isNativeTag:rae,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Cse=0;function Sse(e,t){return function(i,c=null){zt(i)||(i=Xr({},i)),c!=null&&!gn(c)&&(c=null);const u=_$(),f=new WeakSet;let p=!1;const v=u.app={_uid:Cse++,_component:i,_props:c,_container:null,_context:u,_instance:null,version:Wse,get config(){return u.config},set config(_){},use(_,...b){return f.has(_)||(_&&zt(_.install)?(f.add(_),_.install(v,...b)):zt(_)&&(f.add(_),_(v,...b))),v},mixin(_){return u.mixins.includes(_)||u.mixins.push(_),v},component(_,b){return b?(u.components[_]=b,v):u.components[_]},directive(_,b){return b?(u.directives[_]=b,v):u.directives[_]},mount(_,b,S){if(!p){const k=Me(i,c);return k.appContext=u,S===!0?S="svg":S===!1&&(S=void 0),b&&t?t(k,_):e(k,_,S),p=!0,v._container=_,_.__vue_app__=v,ST(k.component)||k.component.proxy}},unmount(){p&&(e(null,v._container),delete v._container.__vue_app__)},provide(_,b){return u.provides[_]=b,v},runWithContext(_){const b=Wy;Wy=v;try{return _()}finally{Wy=b}}};return v}}let Wy=null;function Nn(e,t){if(Ri){let o=Ri.provides;const i=Ri.parent&&Ri.parent.provides;i===o&&(o=Ri.provides=Object.create(i)),o[e]=t}}function Rt(e,t,o=!1){const i=Ri||ci;if(i||Wy){const c=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Wy._context.provides;if(c&&e in c)return c[e];if(arguments.length>1)return o&&zt(t)?t.call(i&&i.proxy):t}}const y$={},I$=()=>Object.create(y$),b$=e=>Object.getPrototypeOf(e)===y$;function Ese(e,t,o,i=!1){const c={},u=I$();e.propsDefaults=Object.create(null),C$(e,t,c,u);for(const f in e.propsOptions[0])f in c||(c[f]=void 0);o?e.props=i?c:sL(c):e.type.props?e.props=c:e.props=u,e.attrs=u}function Tse(e,t,o,i){const{props:c,attrs:u,vnode:{patchFlag:f}}=e,p=Mo(c),[v]=e.propsOptions;let _=!1;if((i||f>0)&&!(f&16)){if(f&8){const b=e.vnode.dynamicProps;for(let S=0;S<b.length;S++){let k=b[S];if(vT(e.emitsOptions,k))continue;const M=t[k];if(v)if(jn(u,k))M!==u[k]&&(u[k]=M,_=!0);else{const R=os(k);c[R]=MD(v,p,R,M,e,!1)}else M!==u[k]&&(u[k]=M,_=!0)}}}else{C$(e,t,c,u)&&(_=!0);let b;for(const S in p)(!t||!jn(t,S)&&((b=th(S))===S||!jn(t,b)))&&(v?o&&(o[S]!==void 0||o[b]!==void 0)&&(c[S]=MD(v,p,S,void 0,e,!0)):delete c[S]);if(u!==p)for(const S in u)(!t||!jn(t,S))&&(delete u[S],_=!0)}_&&eu(e.attrs,"set","")}function C$(e,t,o,i){const[c,u]=e.propsOptions;let f=!1,p;if(t)for(let v in t){if(By(v))continue;const _=t[v];let b;c&&jn(c,b=os(v))?!u||!u.includes(b)?o[b]=_:(p||(p={}))[b]=_:vT(e.emitsOptions,v)||(!(v in i)||_!==i[v])&&(i[v]=_,f=!0)}if(u){const v=Mo(o),_=p||Ir;for(let b=0;b<u.length;b++){const S=u[b];o[S]=MD(c,v,S,_[S],e,!jn(_,S))}}return f}function MD(e,t,o,i,c,u){const f=e[o];if(f!=null){const p=jn(f,"default");if(p&&i===void 0){const v=f.default;if(f.type!==Function&&!f.skipFactory&&zt(v)){const{propsDefaults:_}=c;if(o in _)i=_[o];else{const b=J0(c);i=_[o]=v.call(null,t),b()}}else i=v}f[0]&&(u&&!p?i=!1:f[1]&&(i===""||i===th(o))&&(i=!0))}return i}function S$(e,t,o=!1){const i=t.propsCache,c=i.get(e);if(c)return c;const u=e.props,f={},p=[];let v=!1;if(!zt(e)){const b=S=>{v=!0;const[k,M]=S$(S,t,!0);Xr(f,k),M&&p.push(...M)};!o&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}if(!u&&!v)return gn(e)&&i.set(e,Eg),Eg;if(ht(u))for(let b=0;b<u.length;b++){const S=os(u[b]);FG(S)&&(f[S]=Ir)}else if(u)for(const b in u){const S=os(b);if(FG(S)){const k=u[b],M=f[S]=ht(k)||zt(k)?{type:k}:Xr({},k);if(M){const R=BG(Boolean,M.type),w=BG(String,M.type);M[0]=R>-1,M[1]=w<0||R<w,(R>-1||jn(M,"default"))&&p.push(S)}}}const _=[f,p];return gn(e)&&i.set(e,_),_}function FG(e){return e[0]!=="$"&&!By(e)}function VG(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function GG(e,t){return VG(e)===VG(t)}function BG(e,t){return ht(t)?t.findIndex(o=>GG(o,e)):zt(t)&&GG(t,e)?0:-1}const E$=e=>e[0]==="_"||e==="$stable",yL=e=>ht(e)?e.map(ql):[ql(e)],Mse=(e,t,o)=>{if(t._n)return t;const i=Ae((...c)=>yL(t(...c)),o);return i._c=!1,i},T$=(e,t,o)=>{const i=e._ctx;for(const c in e){if(E$(c))continue;const u=e[c];if(zt(u))t[c]=Mse(c,u,i);else if(u!=null){const f=yL(u);t[c]=()=>f}}},M$=(e,t)=>{const o=yL(t);e.slots.default=()=>o},kse=(e,t)=>{const o=e.slots=I$();if(e.vnode.shapeFlag&32){const i=t._;i?(Xr(o,t),DH(o,"_",i,!0)):T$(t,o)}else t&&M$(e,t)},wse=(e,t,o)=>{const{vnode:i,slots:c}=e;let u=!0,f=Ir;if(i.shapeFlag&32){const p=t._;p?o&&p===1?u=!1:(Xr(c,t),!o&&p===1&&delete c._):(u=!t.$stable,T$(t,c)),f=t}else t&&(M$(e,t),f={default:1});if(u)for(const p in c)!E$(p)&&f[p]==null&&delete c[p]};function kD(e,t,o,i,c=!1){if(ht(e)){e.forEach((k,M)=>kD(k,t&&(ht(t)?t[M]:t),o,i,c));return}if(Ky(i)&&!c)return;const u=i.shapeFlag&4?ST(i.component)||i.component.proxy:i.el,f=c?null:u,{i:p,r:v}=e,_=t&&t.r,b=p.refs===Ir?p.refs={}:p.refs,S=p.setupState;if(_!=null&&_!==v&&(Ut(_)?(b[_]=null,jn(S,_)&&(S[_]=null)):Bo(_)&&(_.value=null)),zt(v))Fd(v,p,12,[f,b]);else{const k=Ut(v),M=Bo(v);if(k||M){const R=()=>{if(e.f){const w=k?jn(S,v)?S[v]:b[v]:v.value;c?ht(w)&&eL(w,u):ht(w)?w.includes(u)||w.push(u):k?(b[v]=[u],jn(S,v)&&(S[v]=b[v])):(v.value=[u],e.k&&(b[e.k]=v.value))}else k?(b[v]=f,jn(S,v)&&(S[v]=f)):M&&(v.value=f,e.k&&(b[e.k]=f))};f?(R.id=-1,Ea(R,o)):R()}}}const Ea=rse;function Rse(e){return Ase(e)}function Ase(e,t){const o=OH();o.__VUE__=!0;const{insert:i,remove:c,patchProp:u,createElement:f,createText:p,createComment:v,setText:_,setElementText:b,parentNode:S,nextSibling:k,setScopeId:M=lo,insertStaticContent:R}=e,w=(_e,Re,Ke,je=null,ze=null,nt=null,it=void 0,dt=null,gt=!!Re.dynamicChildren)=>{if(_e===Re)return;_e&&!Of(_e,Re)&&(je=be(_e),Ie(_e,ze,nt,!0),_e=null),Re.patchFlag===-2&&(gt=!1,Re.dynamicChildren=null);const{type:ft,ref:Mt,shapeFlag:lt}=Re;switch(ft){case lv:E(_e,Re,Ke,je);break;case Ai:N(_e,Re,Ke,je);break;case fA:_e==null&&F(Re,Ke,je,it);break;case Ht:J(_e,Re,Ke,je,ze,nt,it,dt,gt);break;default:lt&1?G(_e,Re,Ke,je,ze,nt,it,dt,gt):lt&6?oe(_e,Re,Ke,je,ze,nt,it,dt,gt):(lt&64||lt&128)&&ft.process(_e,Re,Ke,je,ze,nt,it,dt,gt,rt)}Mt!=null&&ze&&kD(Mt,_e&&_e.ref,nt,Re||_e,!Re)},E=(_e,Re,Ke,je)=>{if(_e==null)i(Re.el=p(Re.children),Ke,je);else{const ze=Re.el=_e.el;Re.children!==_e.children&&_(ze,Re.children)}},N=(_e,Re,Ke,je)=>{_e==null?i(Re.el=v(Re.children||""),Ke,je):Re.el=_e.el},F=(_e,Re,Ke,je)=>{[_e.el,_e.anchor]=R(_e.children,Re,Ke,je,_e.el,_e.anchor)},x=({el:_e,anchor:Re},Ke,je)=>{let ze;for(;_e&&_e!==Re;)ze=k(_e),i(_e,Ke,je),_e=ze;i(Re,Ke,je)},P=({el:_e,anchor:Re})=>{let Ke;for(;_e&&_e!==Re;)Ke=k(_e),c(_e),_e=Ke;c(Re)},G=(_e,Re,Ke,je,ze,nt,it,dt,gt)=>{Re.type==="svg"?it="svg":Re.type==="math"&&(it="mathml"),_e==null?H(Re,Ke,je,ze,nt,it,dt,gt):W(_e,Re,ze,nt,it,dt,gt)},H=(_e,Re,Ke,je,ze,nt,it,dt)=>{let gt,ft;const{props:Mt,shapeFlag:lt,transition:Et,dirs:Yt}=_e;if(gt=_e.el=f(_e.type,nt,Mt&&Mt.is,Mt),lt&8?b(gt,_e.children):lt&16&&j(_e.children,gt,null,je,ze,hA(_e,nt),it,dt),Yt&&Cf(_e,null,je,"created"),Y(gt,_e,_e.scopeId,it,je),Mt){for(const dn in Mt)dn!=="value"&&!By(dn)&&u(gt,dn,null,Mt[dn],nt,_e.children,je,ze,Oe);"value"in Mt&&u(gt,"value",null,Mt.value,nt),(ft=Mt.onVnodeBeforeMount)&&Bl(ft,je,_e)}Yt&&Cf(_e,null,je,"beforeMount");const sn=Dse(ze,Et);sn&&Et.beforeEnter(gt),i(gt,Re,Ke),((ft=Mt&&Mt.onVnodeMounted)||sn||Yt)&&Ea(()=>{ft&&Bl(ft,je,_e),sn&&Et.enter(gt),Yt&&Cf(_e,null,je,"mounted")},ze)},Y=(_e,Re,Ke,je,ze)=>{if(Ke&&M(_e,Ke),je)for(let nt=0;nt<je.length;nt++)M(_e,je[nt]);if(ze){let nt=ze.subTree;if(Re===nt){const it=ze.vnode;Y(_e,it,it.scopeId,it.slotScopeIds,ze.parent)}}},j=(_e,Re,Ke,je,ze,nt,it,dt,gt=0)=>{for(let ft=gt;ft<_e.length;ft++){const Mt=_e[ft]=dt?kd(_e[ft]):ql(_e[ft]);w(null,Mt,Re,Ke,je,ze,nt,it,dt)}},W=(_e,Re,Ke,je,ze,nt,it)=>{const dt=Re.el=_e.el;let{patchFlag:gt,dynamicChildren:ft,dirs:Mt}=Re;gt|=_e.patchFlag&16;const lt=_e.props||Ir,Et=Re.props||Ir;let Yt;if(Ke&&Sf(Ke,!1),(Yt=Et.onVnodeBeforeUpdate)&&Bl(Yt,Ke,Re,_e),Mt&&Cf(Re,_e,Ke,"beforeUpdate"),Ke&&Sf(Ke,!0),ft?O(_e.dynamicChildren,ft,dt,Ke,je,hA(Re,ze),nt):it||re(_e,Re,dt,null,Ke,je,hA(Re,ze),nt,!1),gt>0){if(gt&16)Q(dt,Re,lt,Et,Ke,je,ze);else if(gt&2&&lt.class!==Et.class&&u(dt,"class",null,Et.class,ze),gt&4&&u(dt,"style",lt.style,Et.style,ze),gt&8){const sn=Re.dynamicProps;for(let dn=0;dn<sn.length;dn++){const Sn=sn[dn],yn=lt[Sn],fo=Et[Sn];(fo!==yn||Sn==="value")&&u(dt,Sn,yn,fo,ze,_e.children,Ke,je,Oe)}}gt&1&&_e.children!==Re.children&&b(dt,Re.children)}else!it&&ft==null&&Q(dt,Re,lt,Et,Ke,je,ze);((Yt=Et.onVnodeUpdated)||Mt)&&Ea(()=>{Yt&&Bl(Yt,Ke,Re,_e),Mt&&Cf(Re,_e,Ke,"updated")},je)},O=(_e,Re,Ke,je,ze,nt,it)=>{for(let dt=0;dt<Re.length;dt++){const gt=_e[dt],ft=Re[dt],Mt=gt.el&&(gt.type===Ht||!Of(gt,ft)||gt.shapeFlag&70)?S(gt.el):Ke;w(gt,ft,Mt,null,je,ze,nt,it,!0)}},Q=(_e,Re,Ke,je,ze,nt,it)=>{if(Ke!==je){if(Ke!==Ir)for(const dt in Ke)!By(dt)&&!(dt in je)&&u(_e,dt,Ke[dt],null,it,Re.children,ze,nt,Oe);for(const dt in je){if(By(dt))continue;const gt=je[dt],ft=Ke[dt];gt!==ft&&dt!=="value"&&u(_e,dt,ft,gt,it,Re.children,ze,nt,Oe)}"value"in je&&u(_e,"value",Ke.value,je.value,it)}},J=(_e,Re,Ke,je,ze,nt,it,dt,gt)=>{const ft=Re.el=_e?_e.el:p(""),Mt=Re.anchor=_e?_e.anchor:p("");let{patchFlag:lt,dynamicChildren:Et,slotScopeIds:Yt}=Re;Yt&&(dt=dt?dt.concat(Yt):Yt),_e==null?(i(ft,Ke,je),i(Mt,Ke,je),j(Re.children||[],Ke,Mt,ze,nt,it,dt,gt)):lt>0&&lt&64&&Et&&_e.dynamicChildren?(O(_e.dynamicChildren,Et,Ke,ze,nt,it,dt),(Re.key!=null||ze&&Re===ze.subTree)&&IL(_e,Re,!0)):re(_e,Re,Ke,Mt,ze,nt,it,dt,gt)},oe=(_e,Re,Ke,je,ze,nt,it,dt,gt)=>{Re.slotScopeIds=dt,_e==null?Re.shapeFlag&512?ze.ctx.activate(Re,Ke,je,it,gt):pe(Re,Ke,je,ze,nt,it,gt):ie(_e,Re,gt)},pe=(_e,Re,Ke,je,ze,nt,it)=>{const dt=_e.component=Bse(_e,je,ze);if(yT(_e)&&(dt.ctx.renderer=rt),Hse(dt),dt.asyncDep){if(ze&&ze.registerDep(dt,te),!_e.el){const gt=dt.subTree=Me(Ai);N(null,gt,Re,Ke)}}else te(dt,_e,Re,Ke,ze,nt,it)},ie=(_e,Re,Ke)=>{const je=Re.component=_e.component;if(ese(_e,Re,Ke))if(je.asyncDep&&!je.asyncResolved){he(je,Re,Ke);return}else je.next=Re,jae(je.update),je.effect.dirty=!0,je.update();else Re.el=_e.el,je.vnode=Re},te=(_e,Re,Ke,je,ze,nt,it)=>{const dt=()=>{if(_e.isMounted){let{next:Mt,bu:lt,u:Et,parent:Yt,vnode:sn}=_e;{const Xt=k$(_e);if(Xt){Mt&&(Mt.el=sn.el,he(_e,Mt,it)),Xt.asyncDep.then(()=>{_e.isUnmounted||dt()});return}}let dn=Mt,Sn;Sf(_e,!1),Mt?(Mt.el=sn.el,he(_e,Mt,it)):Mt=sn,lt&&eE(lt),(Sn=Mt.props&&Mt.props.onVnodeBeforeUpdate)&&Bl(Sn,Yt,Mt,sn),Sf(_e,!0);const yn=cA(_e),fo=_e.subTree;_e.subTree=yn,w(fo,yn,S(fo.el),be(fo),_e,ze,nt),Mt.el=yn.el,dn===null&&tse(_e,yn.el),Et&&Ea(Et,ze),(Sn=Mt.props&&Mt.props.onVnodeUpdated)&&Ea(()=>Bl(Sn,Yt,Mt,sn),ze)}else{let Mt;const{el:lt,props:Et}=Re,{bm:Yt,m:sn,parent:dn}=_e,Sn=Ky(Re);if(Sf(_e,!1),Yt&&eE(Yt),!Sn&&(Mt=Et&&Et.onVnodeBeforeMount)&&Bl(Mt,dn,Re),Sf(_e,!0),lt&&Ge){const yn=()=>{_e.subTree=cA(_e),Ge(lt,_e.subTree,_e,ze,null)};Sn?Re.type.__asyncLoader().then(()=>!_e.isUnmounted&&yn()):yn()}else{const yn=_e.subTree=cA(_e);w(null,yn,Ke,je,_e,ze,nt),Re.el=yn.el}if(sn&&Ea(sn,ze),!Sn&&(Mt=Et&&Et.onVnodeMounted)){const yn=Re;Ea(()=>Bl(Mt,dn,yn),ze)}(Re.shapeFlag&256||dn&&Ky(dn.vnode)&&dn.vnode.shapeFlag&256)&&_e.a&&Ea(_e.a,ze),_e.isMounted=!0,Re=Ke=je=null}},gt=_e.effect=new nL(dt,lo,()=>hL(ft),_e.scope),ft=_e.update=()=>{gt.dirty&&gt.run()};ft.id=_e.uid,Sf(_e,!0),ft()},he=(_e,Re,Ke)=>{Re.component=_e;const je=_e.vnode.props;_e.vnode=Re,_e.next=null,Tse(_e,Re.props,je,Ke),wse(_e,Re.children,Ke),nh(),AG(_e),oh()},re=(_e,Re,Ke,je,ze,nt,it,dt,gt=!1)=>{const ft=_e&&_e.children,Mt=_e?_e.shapeFlag:0,lt=Re.children,{patchFlag:Et,shapeFlag:Yt}=Re;if(Et>0){if(Et&128){ye(ft,lt,Ke,je,ze,nt,it,dt,gt);return}else if(Et&256){X(ft,lt,Ke,je,ze,nt,it,dt,gt);return}}Yt&8?(Mt&16&&Oe(ft,ze,nt),lt!==ft&&b(Ke,lt)):Mt&16?Yt&16?ye(ft,lt,Ke,je,ze,nt,it,dt,gt):Oe(ft,ze,nt,!0):(Mt&8&&b(Ke,""),Yt&16&&j(lt,Ke,je,ze,nt,it,dt,gt))},X=(_e,Re,Ke,je,ze,nt,it,dt,gt)=>{_e=_e||Eg,Re=Re||Eg;const ft=_e.length,Mt=Re.length,lt=Math.min(ft,Mt);let Et;for(Et=0;Et<lt;Et++){const Yt=Re[Et]=gt?kd(Re[Et]):ql(Re[Et]);w(_e[Et],Yt,Ke,null,ze,nt,it,dt,gt)}ft>Mt?Oe(_e,ze,nt,!0,!1,lt):j(Re,Ke,je,ze,nt,it,dt,gt,lt)},ye=(_e,Re,Ke,je,ze,nt,it,dt,gt)=>{let ft=0;const Mt=Re.length;let lt=_e.length-1,Et=Mt-1;for(;ft<=lt&&ft<=Et;){const Yt=_e[ft],sn=Re[ft]=gt?kd(Re[ft]):ql(Re[ft]);if(Of(Yt,sn))w(Yt,sn,Ke,null,ze,nt,it,dt,gt);else break;ft++}for(;ft<=lt&&ft<=Et;){const Yt=_e[lt],sn=Re[Et]=gt?kd(Re[Et]):ql(Re[Et]);if(Of(Yt,sn))w(Yt,sn,Ke,null,ze,nt,it,dt,gt);else break;lt--,Et--}if(ft>lt){if(ft<=Et){const Yt=Et+1,sn=Yt<Mt?Re[Yt].el:je;for(;ft<=Et;)w(null,Re[ft]=gt?kd(Re[ft]):ql(Re[ft]),Ke,sn,ze,nt,it,dt,gt),ft++}}else if(ft>Et)for(;ft<=lt;)Ie(_e[ft],ze,nt,!0),ft++;else{const Yt=ft,sn=ft,dn=new Map;for(ft=sn;ft<=Et;ft++){const ke=Re[ft]=gt?kd(Re[ft]):ql(Re[ft]);ke.key!=null&&dn.set(ke.key,ft)}let Sn,yn=0;const fo=Et-sn+1;let Xt=!1,vn=0;const Ne=new Array(fo);for(ft=0;ft<fo;ft++)Ne[ft]=0;for(ft=Yt;ft<=lt;ft++){const ke=_e[ft];if(yn>=fo){Ie(ke,ze,nt,!0);continue}let ot;if(ke.key!=null)ot=dn.get(ke.key);else for(Sn=sn;Sn<=Et;Sn++)if(Ne[Sn-sn]===0&&Of(ke,Re[Sn])){ot=Sn;break}ot===void 0?Ie(ke,ze,nt,!0):(Ne[ot-sn]=ft+1,ot>=vn?vn=ot:Xt=!0,w(ke,Re[ot],Ke,null,ze,nt,it,dt,gt),yn++)}const qe=Xt?Ose(Ne):Eg;for(Sn=qe.length-1,ft=fo-1;ft>=0;ft--){const ke=sn+ft,ot=Re[ke],tn=ke+1<Mt?Re[ke+1].el:je;Ne[ft]===0?w(null,ot,Ke,tn,ze,nt,it,dt,gt):Xt&&(Sn<0||ft!==qe[Sn]?ue(ot,Ke,tn,2):Sn--)}}},ue=(_e,Re,Ke,je,ze=null)=>{const{el:nt,type:it,transition:dt,children:gt,shapeFlag:ft}=_e;if(ft&6){ue(_e.component.subTree,Re,Ke,je);return}if(ft&128){_e.suspense.move(Re,Ke,je);return}if(ft&64){it.move(_e,Re,Ke,rt);return}if(it===Ht){i(nt,Re,Ke);for(let lt=0;lt<gt.length;lt++)ue(gt[lt],Re,Ke,je);i(_e.anchor,Re,Ke);return}if(it===fA){x(_e,Re,Ke);return}if(je!==2&&ft&1&&dt)if(je===0)dt.beforeEnter(nt),i(nt,Re,Ke),Ea(()=>dt.enter(nt),ze);else{const{leave:lt,delayLeave:Et,afterLeave:Yt}=dt,sn=()=>i(nt,Re,Ke),dn=()=>{lt(nt,()=>{sn(),Yt&&Yt()})};Et?Et(nt,sn,dn):dn()}else i(nt,Re,Ke)},Ie=(_e,Re,Ke,je=!1,ze=!1)=>{const{type:nt,props:it,ref:dt,children:gt,dynamicChildren:ft,shapeFlag:Mt,patchFlag:lt,dirs:Et}=_e;if(dt!=null&&kD(dt,null,Ke,_e,!0),Mt&256){Re.ctx.deactivate(_e);return}const Yt=Mt&1&&Et,sn=!Ky(_e);let dn;if(sn&&(dn=it&&it.onVnodeBeforeUnmount)&&Bl(dn,Re,_e),Mt&6)Fe(_e.component,Ke,je);else{if(Mt&128){_e.suspense.unmount(Ke,je);return}Yt&&Cf(_e,null,Re,"beforeUnmount"),Mt&64?_e.type.remove(_e,Re,Ke,ze,rt,je):ft&&(nt!==Ht||lt>0&&lt&64)?Oe(ft,Re,Ke,!1,!0):(nt===Ht&&lt&384||!ze&&Mt&16)&&Oe(gt,Re,Ke),je&&ve(_e)}(sn&&(dn=it&&it.onVnodeUnmounted)||Yt)&&Ea(()=>{dn&&Bl(dn,Re,_e),Yt&&Cf(_e,null,Re,"unmounted")},Ke)},ve=_e=>{const{type:Re,el:Ke,anchor:je,transition:ze}=_e;if(Re===Ht){Ce(Ke,je);return}if(Re===fA){P(_e);return}const nt=()=>{c(Ke),ze&&!ze.persisted&&ze.afterLeave&&ze.afterLeave()};if(_e.shapeFlag&1&&ze&&!ze.persisted){const{leave:it,delayLeave:dt}=ze,gt=()=>it(Ke,nt);dt?dt(_e.el,nt,gt):gt()}else nt()},Ce=(_e,Re)=>{let Ke;for(;_e!==Re;)Ke=k(_e),c(_e),_e=Ke;c(Re)},Fe=(_e,Re,Ke)=>{const{bum:je,scope:ze,update:nt,subTree:it,um:dt}=_e;je&&eE(je),ze.stop(),nt&&(nt.active=!1,Ie(it,_e,Re,Ke)),dt&&Ea(dt,Re),Ea(()=>{_e.isUnmounted=!0},Re),Re&&Re.pendingBranch&&!Re.isUnmounted&&_e.asyncDep&&!_e.asyncResolved&&_e.suspenseId===Re.pendingId&&(Re.deps--,Re.deps===0&&Re.resolve())},Oe=(_e,Re,Ke,je=!1,ze=!1,nt=0)=>{for(let it=nt;it<_e.length;it++)Ie(_e[it],Re,Ke,je,ze)},be=_e=>_e.shapeFlag&6?be(_e.component.subTree):_e.shapeFlag&128?_e.suspense.next():k(_e.anchor||_e.el);let xe=!1;const Le=(_e,Re,Ke)=>{_e==null?Re._vnode&&Ie(Re._vnode,null,null,!0):w(Re._vnode||null,_e,Re,null,null,null,Ke),xe||(xe=!0,AG(),o$(),xe=!1),Re._vnode=_e},rt={p:w,um:Ie,m:ue,r:ve,mt:pe,mc:j,pc:re,pbc:O,n:be,o:e};let Qe,Ge;return{render:Le,hydrate:Qe,createApp:Sse(Le,Qe)}}function hA({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function Sf({effect:e,update:t},o){e.allowRecurse=t.allowRecurse=o}function Dse(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function IL(e,t,o=!1){const i=e.children,c=t.children;if(ht(i)&&ht(c))for(let u=0;u<i.length;u++){const f=i[u];let p=c[u];p.shapeFlag&1&&!p.dynamicChildren&&((p.patchFlag<=0||p.patchFlag===32)&&(p=c[u]=kd(c[u]),p.el=f.el),o||IL(f,p)),p.type===lv&&(p.el=f.el)}}function Ose(e){const t=e.slice(),o=[0];let i,c,u,f,p;const v=e.length;for(i=0;i<v;i++){const _=e[i];if(_!==0){if(c=o[o.length-1],e[c]<_){t[i]=c,o.push(i);continue}for(u=0,f=o.length-1;u<f;)p=u+f>>1,e[o[p]]<_?u=p+1:f=p;_<e[o[u]]&&(u>0&&(t[i]=o[u-1]),o[u]=i)}}for(u=o.length,f=o[u-1];u-- >0;)o[u]=f,f=t[f];return o}function k$(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:k$(t)}const Lse=e=>e.__isTeleport,jy=e=>e&&(e.disabled||e.disabled===""),HG=e=>typeof SVGElement<"u"&&e instanceof SVGElement,$G=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,wD=(e,t)=>{const o=e&&e.to;return Ut(o)?t?t(o):null:o},Nse={name:"Teleport",__isTeleport:!0,process(e,t,o,i,c,u,f,p,v,_){const{mc:b,pc:S,pbc:k,o:{insert:M,querySelector:R,createText:w,createComment:E}}=_,N=jy(t.props);let{shapeFlag:F,children:x,dynamicChildren:P}=t;if(e==null){const G=t.el=w(""),H=t.anchor=w("");M(G,o,i),M(H,o,i);const Y=t.target=wD(t.props,R),j=t.targetAnchor=w("");Y&&(M(j,Y),f==="svg"||HG(Y)?f="svg":(f==="mathml"||$G(Y))&&(f="mathml"));const W=(O,Q)=>{F&16&&b(x,O,Q,c,u,f,p,v)};N?W(o,H):Y&&W(Y,j)}else{t.el=e.el;const G=t.anchor=e.anchor,H=t.target=e.target,Y=t.targetAnchor=e.targetAnchor,j=jy(e.props),W=j?o:H,O=j?G:Y;if(f==="svg"||HG(H)?f="svg":(f==="mathml"||$G(H))&&(f="mathml"),P?(k(e.dynamicChildren,P,W,c,u,f,p),IL(e,t,!0)):v||S(e,t,W,O,c,u,f,p,!1),N)j?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):ES(t,o,G,_,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const Q=t.target=wD(t.props,R);Q&&ES(t,Q,null,_,0)}else j&&ES(t,H,Y,_,1)}w$(t)},remove(e,t,o,i,{um:c,o:{remove:u}},f){const{shapeFlag:p,children:v,anchor:_,targetAnchor:b,target:S,props:k}=e;if(S&&u(b),f&&u(_),p&16){const M=f||!jy(k);for(let R=0;R<v.length;R++){const w=v[R];c(w,t,o,M,!!w.dynamicChildren)}}},move:ES,hydrate:Pse};function ES(e,t,o,{o:{insert:i},m:c},u=2){u===0&&i(e.targetAnchor,t,o);const{el:f,anchor:p,shapeFlag:v,children:_,props:b}=e,S=u===2;if(S&&i(f,t,o),(!S||jy(b))&&v&16)for(let k=0;k<_.length;k++)c(_[k],t,o,2);S&&i(p,t,o)}function Pse(e,t,o,i,c,u,{o:{nextSibling:f,parentNode:p,querySelector:v}},_){const b=t.target=wD(t.props,v);if(b){const S=b._lpa||b.firstChild;if(t.shapeFlag&16)if(jy(t.props))t.anchor=_(f(e),t,p(e),o,i,c,u),t.targetAnchor=S;else{t.anchor=f(e);let k=S;for(;k;)if(k=f(k),k&&k.nodeType===8&&k.data==="teleport anchor"){t.targetAnchor=k,b._lpa=t.targetAnchor&&f(t.targetAnchor);break}_(S,t,b,o,i,c,u)}w$(t)}return t.anchor&&f(t.anchor)}const xse=Nse;function w$(e){const t=e.ctx;if(t&&t.ut){let o=e.children[0].el;for(;o&&o!==e.targetAnchor;)o.nodeType===1&&o.setAttribute("data-v-owner",t.uid),o=o.nextSibling;t.ut()}}const Ht=Symbol.for("v-fgt"),lv=Symbol.for("v-txt"),Ai=Symbol.for("v-cmt"),fA=Symbol.for("v-stc"),Yy=[];let rl=null;function ee(e=!1){Yy.push(rl=e?null:[])}function Use(){Yy.pop(),rl=Yy[Yy.length-1]||null}let I0=1;function qG(e){I0+=e}function R$(e){return e.dynamicChildren=I0>0?rl||Eg:null,Use(),I0>0&&rl&&rl.push(e),e}function ge(e,t,o,i,c,u){return R$(Ee(e,t,o,i,c,u,!0))}function We(e,t,o,i,c){return R$(Me(e,t,o,i,c,!0))}function Wo(e){return e?e.__v_isVNode===!0:!1}function Of(e,t){return e.type===t.type&&e.key===t.key}const A$=({key:e})=>e??null,tE=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Ut(e)||Bo(e)||zt(e)?{i:ci,r:e,k:t,f:!!o}:e:null);function Ee(e,t=null,o=null,i=0,c=null,u=e===Ht?0:1,f=!1,p=!1){const v={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&A$(t),ref:t&&tE(t),scopeId:a$,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:i,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:ci};return p?(bL(v,o),u&128&&e.normalize(v)):o&&(v.shapeFlag|=Ut(o)?8:16),I0>0&&!f&&rl&&(v.patchFlag>0||u&6)&&v.patchFlag!==32&&rl.push(v),v}const Me=Fse;function Fse(e,t=null,o=null,i=0,c=null,u=!1){if((!e||e===s$)&&(e=Ai),Wo(e)){const p=iu(e,t,!0);return o&&bL(p,o),I0>0&&!u&&rl&&(p.shapeFlag&6?rl[rl.indexOf(e)]=p:rl.push(p)),p.patchFlag|=-2,p}if(zse(e)&&(e=e.__vccOpts),t){t=Zl(t);let{class:p,style:v}=t;p&&!Ut(p)&&(t.class=ne(p)),gn(v)&&(JH(v)&&!ht(v)&&(v=Xr({},v)),t.style=qt(v))}const f=Ut(e)?1:ose(e)?128:Lse(e)?64:gn(e)?4:zt(e)?2:0;return Ee(e,t,o,i,c,f,u,!0)}function Zl(e){return e?JH(e)||b$(e)?Xr({},e):e:null}function iu(e,t,o=!1,i=!1){const{props:c,ref:u,patchFlag:f,children:p,transition:v}=e,_=t?An(c||{},t):c,b={__v_isVNode:!0,__v_skip:!0,type:e.type,props:_,key:_&&A$(_),ref:t&&t.ref?o&&u?ht(u)?u.concat(tE(t)):[u,tE(t)]:tE(t):u,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:p,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ht?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:v,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&iu(e.ssContent),ssFallback:e.ssFallback&&iu(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return v&&i&&(b.transition=v.clone(b)),b}function Mn(e=" ",t=0){return Me(lv,null,e,t)}function $e(e="",t=!1){return t?(ee(),We(Ai,null,e)):Me(Ai,null,e)}function ql(e){return e==null||typeof e=="boolean"?Me(Ai):ht(e)?Me(Ht,null,e.slice()):typeof e=="object"?kd(e):Me(lv,null,String(e))}function kd(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:iu(e)}function bL(e,t){let o=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(ht(t))o=16;else if(typeof t=="object")if(i&65){const c=t.default;c&&(c._c&&(c._d=!1),bL(e,c()),c._c&&(c._d=!0));return}else{o=32;const c=t._;!c&&!b$(t)?t._ctx=ci:c===3&&ci&&(ci.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else zt(t)?(t={default:t,_ctx:ci},o=32):(t=String(t),i&64?(o=16,t=[Mn(t)]):o=8);e.children=t,e.shapeFlag|=o}function An(...e){const t={};for(let o=0;o<e.length;o++){const i=e[o];for(const c in i)if(c==="class")t.class!==i.class&&(t.class=ne([t.class,i.class]));else if(c==="style")t.style=qt([t.style,i.style]);else if(hT(c)){const u=t[c],f=i[c];f&&u!==f&&!(ht(u)&&u.includes(f))&&(t[c]=u?[].concat(u,f):f)}else c!==""&&(t[c]=i[c])}return t}function Bl(e,t,o,i=null){Ts(e,t,7,[o,i])}const Vse=_$();let Gse=0;function Bse(e,t,o){const i=e.type,c=(t?t.appContext:e.appContext)||Vse,u={uid:Gse++,vnode:e,type:i,parent:t,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new xH(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:S$(i,c),emitsOptions:i$(i,c),emit:null,emitted:null,propsDefaults:Ir,inheritAttrs:i.inheritAttrs,ctx:Ir,data:Ir,props:Ir,attrs:Ir,slots:Ir,refs:Ir,setupState:Ir,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=t?t.root:u,u.emit=Xae.bind(null,u),e.ce&&e.ce(u),u}let Ri=null;const kn=()=>Ri||ci;let RE,RD;{const e=OH(),t=(o,i)=>{let c;return(c=e[o])||(c=e[o]=[]),c.push(i),u=>{c.length>1?c.forEach(f=>f(u)):c[0](u)}};RE=t("__VUE_INSTANCE_SETTERS__",o=>Ri=o),RD=t("__VUE_SSR_SETTERS__",o=>CT=o)}const J0=e=>{const t=Ri;return RE(e),e.scope.on(),()=>{e.scope.off(),RE(t)}},KG=()=>{Ri&&Ri.scope.off(),RE(null)};function D$(e){return e.vnode.shapeFlag&4}let CT=!1;function Hse(e,t=!1){t&&RD(t);const{props:o,children:i}=e.vnode,c=D$(e);Ese(e,o,c,t),kse(e,i);const u=c?$se(e,t):void 0;return t&&RD(!1),u}function $se(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,gse);const{setup:i}=o;if(i){const c=e.setupContext=i.length>1?L$(e):null,u=J0(e);nh();const f=Fd(i,e,0,[e.props,c]);if(oh(),u(),h0(f)){if(f.then(KG,KG),t)return f.then(p=>{zG(e,p,t)}).catch(p=>{gT(p,e,0)});e.asyncDep=f}else zG(e,f,t)}else O$(e,t)}function zG(e,t,o){zt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:gn(t)&&(e.setupState=QH(t)),O$(e,o)}let WG;function O$(e,t,o){const i=e.type;if(!e.render){if(!t&&WG&&!i.render){const c=i.template||_L(e).template;if(c){const{isCustomElement:u,compilerOptions:f}=e.appContext.config,{delimiters:p,compilerOptions:v}=i,_=Xr(Xr({isCustomElement:u,delimiters:p},f),v);i.render=WG(c,_)}}e.render=i.render||lo}{const c=J0(e);nh();try{vse(e)}finally{oh(),c()}}}const qse={get(e,t){return Da(e,"get",""),e[t]}};function L$(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,qse),slots:e.slots,emit:e.emit,expose:t}}function ST(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(QH(tu(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in zy)return zy[o](e)},has(t,o){return o in t||o in zy}}))}function Kse(e,t=!0){return zt(e)?e.displayName||e.name:e.name||t&&e.__name}function zse(e){return zt(e)&&"__vccOpts"in e}const z=(e,t)=>Vae(e,t,CT);function Jt(e,t,o){const i=arguments.length;return i===2?gn(t)&&!ht(t)?Wo(t)?Me(e,null,[t]):Me(e,t):Me(e,null,t):(i>3?o=Array.prototype.slice.call(arguments,2):i===3&&Wo(o)&&(o=[o]),Me(e,t,o))}const Wse="3.4.27",jse=lo;/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Yse="http://www.w3.org/2000/svg",Jse="http://www.w3.org/1998/Math/MathML",wd=typeof document<"u"?document:null,jG=wd&&wd.createElement("template"),Xse={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,i)=>{const c=t==="svg"?wd.createElementNS(Yse,e):t==="mathml"?wd.createElementNS(Jse,e):wd.createElement(e,o?{is:o}:void 0);return e==="select"&&i&&i.multiple!=null&&c.setAttribute("multiple",i.multiple),c},createText:e=>wd.createTextNode(e),createComment:e=>wd.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>wd.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,i,c,u){const f=o?o.previousSibling:t.lastChild;if(c&&(c===u||c.nextSibling))for(;t.insertBefore(c.cloneNode(!0),o),!(c===u||!(c=c.nextSibling)););else{jG.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const p=jG.content;if(i==="svg"||i==="mathml"){const v=p.firstChild;for(;v.firstChild;)p.appendChild(v.firstChild);p.removeChild(v)}t.insertBefore(p,o)}return[f?f.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},md="transition",Ty="animation",Vg=Symbol("_vtc"),Zr=(e,{slots:t})=>Jt(cse,P$(e),t);Zr.displayName="Transition";const N$={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Zse=Zr.props=Xr({},u$,N$),Ef=(e,t=[])=>{ht(e)?e.forEach(o=>o(...t)):e&&e(...t)},YG=e=>e?ht(e)?e.some(t=>t.length>1):e.length>1:!1;function P$(e){const t={};for(const J in e)J in N$||(t[J]=e[J]);if(e.css===!1)return t;const{name:o="v",type:i,duration:c,enterFromClass:u=`${o}-enter-from`,enterActiveClass:f=`${o}-enter-active`,enterToClass:p=`${o}-enter-to`,appearFromClass:v=u,appearActiveClass:_=f,appearToClass:b=p,leaveFromClass:S=`${o}-leave-from`,leaveActiveClass:k=`${o}-leave-active`,leaveToClass:M=`${o}-leave-to`}=e,R=Qse(c),w=R&&R[0],E=R&&R[1],{onBeforeEnter:N,onEnter:F,onEnterCancelled:x,onLeave:P,onLeaveCancelled:G,onBeforeAppear:H=N,onAppear:Y=F,onAppearCancelled:j=x}=t,W=(J,oe,pe)=>{_d(J,oe?b:p),_d(J,oe?_:f),pe&&pe()},O=(J,oe)=>{J._isLeaving=!1,_d(J,S),_d(J,M),_d(J,k),oe&&oe()},Q=J=>(oe,pe)=>{const ie=J?Y:F,te=()=>W(oe,J,pe);Ef(ie,[oe,te]),JG(()=>{_d(oe,J?v:u),qc(oe,J?b:p),YG(ie)||XG(oe,i,w,te)})};return Xr(t,{onBeforeEnter(J){Ef(N,[J]),qc(J,u),qc(J,f)},onBeforeAppear(J){Ef(H,[J]),qc(J,v),qc(J,_)},onEnter:Q(!1),onAppear:Q(!0),onLeave(J,oe){J._isLeaving=!0;const pe=()=>O(J,oe);qc(J,S),qc(J,k),U$(),JG(()=>{J._isLeaving&&(_d(J,S),qc(J,M),YG(P)||XG(J,i,E,pe))}),Ef(P,[J,pe])},onEnterCancelled(J){W(J,!1),Ef(x,[J])},onAppearCancelled(J){W(J,!0),Ef(j,[J])},onLeaveCancelled(J){O(J),Ef(G,[J])}})}function Qse(e){if(e==null)return null;if(gn(e))return[pA(e.enter),pA(e.leave)];{const t=pA(e);return[t,t]}}function pA(e){return cae(e)}function qc(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Vg]||(e[Vg]=new Set)).add(t)}function _d(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const o=e[Vg];o&&(o.delete(t),o.size||(e[Vg]=void 0))}function JG(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let ele=0;function XG(e,t,o,i){const c=e._endId=++ele,u=()=>{c===e._endId&&i()};if(o)return setTimeout(u,o);const{type:f,timeout:p,propCount:v}=x$(e,t);if(!f)return i();const _=f+"end";let b=0;const S=()=>{e.removeEventListener(_,k),u()},k=M=>{M.target===e&&++b>=v&&S()};setTimeout(()=>{b<v&&S()},p+1),e.addEventListener(_,k)}function x$(e,t){const o=window.getComputedStyle(e),i=R=>(o[R]||"").split(", "),c=i(`${md}Delay`),u=i(`${md}Duration`),f=ZG(c,u),p=i(`${Ty}Delay`),v=i(`${Ty}Duration`),_=ZG(p,v);let b=null,S=0,k=0;t===md?f>0&&(b=md,S=f,k=u.length):t===Ty?_>0&&(b=Ty,S=_,k=v.length):(S=Math.max(f,_),b=S>0?f>_?md:Ty:null,k=b?b===md?u.length:v.length:0);const M=b===md&&/\b(transform|all)(,|$)/.test(i(`${md}Property`).toString());return{type:b,timeout:S,propCount:k,hasTransform:M}}function ZG(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,i)=>QG(o)+QG(e[i])))}function QG(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function U$(){return document.body.offsetHeight}function tle(e,t,o){const i=e[Vg];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const AE=Symbol("_vod"),F$=Symbol("_vsh"),Zn={beforeMount(e,{value:t},{transition:o}){e[AE]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):My(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:i}){!t!=!o&&(i?t?(i.beforeEnter(e),My(e,!0),i.enter(e)):i.leave(e,()=>{My(e,!1)}):My(e,t))},beforeUnmount(e,{value:t}){My(e,t)}};function My(e,t){e.style.display=t?e[AE]:"none",e[F$]=!t}const nle=Symbol(""),ole=/(^|;)\s*display\s*:/;function rle(e,t,o){const i=e.style,c=Ut(o);let u=!1;if(o&&!c){if(t)if(Ut(t))for(const f of t.split(";")){const p=f.slice(0,f.indexOf(":")).trim();o[p]==null&&nE(i,p,"")}else for(const f in t)o[f]==null&&nE(i,f,"");for(const f in o)f==="display"&&(u=!0),nE(i,f,o[f])}else if(c){if(t!==o){const f=i[nle];f&&(o+=";"+f),i.cssText=o,u=ole.test(o)}}else t&&e.removeAttribute("style");AE in e&&(e[AE]=u?i.display:"",e[F$]&&(i.display="none"))}const e6=/\s*!important$/;function nE(e,t,o){if(ht(o))o.forEach(i=>nE(e,t,i));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const i=ile(e,t);e6.test(o)?e.setProperty(th(i),o.replace(e6,""),"important"):e[i]=o}}const t6=["Webkit","Moz","ms"],mA={};function ile(e,t){const o=mA[t];if(o)return o;let i=os(t);if(i!=="filter"&&i in e)return mA[t]=i;i=Y0(i);for(let c=0;c<t6.length;c++){const u=t6[c]+i;if(u in e)return mA[t]=u}return t}const n6="http://www.w3.org/1999/xlink";function ale(e,t,o,i,c){if(i&&t.startsWith("xlink:"))o==null?e.removeAttributeNS(n6,t.slice(6,t.length)):e.setAttributeNS(n6,t,o);else{const u=mae(t);o==null||u&&!LH(o)?e.removeAttribute(t):e.setAttribute(t,u?"":o)}}function sle(e,t,o,i,c,u,f){if(t==="innerHTML"||t==="textContent"){i&&f(i,c,u),e[t]=o??"";return}const p=e.tagName;if(t==="value"&&p!=="PROGRESS"&&!p.includes("-")){const _=p==="OPTION"?e.getAttribute("value")||"":e.value,b=o??"";(_!==b||!("_value"in e))&&(e.value=b),o==null&&e.removeAttribute(t),e._value=o;return}let v=!1;if(o===""||o==null){const _=typeof e[t];_==="boolean"?o=LH(o):o==null&&_==="string"?(o="",v=!0):_==="number"&&(o=0,v=!0)}try{e[t]=o}catch{}v&&e.removeAttribute(t)}function Ad(e,t,o,i){e.addEventListener(t,o,i)}function lle(e,t,o,i){e.removeEventListener(t,o,i)}const o6=Symbol("_vei");function cle(e,t,o,i,c=null){const u=e[o6]||(e[o6]={}),f=u[t];if(i&&f)f.value=i;else{const[p,v]=ule(t);if(i){const _=u[t]=fle(i,c);Ad(e,p,_,v)}else f&&(lle(e,p,f,v),u[t]=void 0)}}const r6=/(?:Once|Passive|Capture)$/;function ule(e){let t;if(r6.test(e)){t={};let i;for(;i=e.match(r6);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):th(e.slice(2)),t]}let gA=0;const dle=Promise.resolve(),hle=()=>gA||(dle.then(()=>gA=0),gA=Date.now());function fle(e,t){const o=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=o.attached)return;Ts(ple(i,o.value),t,5,[i])};return o.value=e,o.attached=hle(),o}function ple(e,t){if(ht(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(i=>c=>!c._stopped&&i&&i(c))}else return t}const i6=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,mle=(e,t,o,i,c,u,f,p,v)=>{const _=c==="svg";t==="class"?tle(e,i,_):t==="style"?rle(e,o,i):hT(t)?QO(t)||cle(e,t,o,i,f):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):gle(e,t,i,_))?sle(e,t,i,u,f,p,v):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),ale(e,t,i,_))};function gle(e,t,o,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&i6(t)&&zt(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const c=e.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return i6(t)&&Ut(o)?!1:t in e}const V$=new WeakMap,G$=new WeakMap,DE=Symbol("_moveCb"),a6=Symbol("_enterCb"),B$={name:"TransitionGroup",props:Xr({},Zse,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=kn(),i=c$();let c,u;return dl(()=>{if(!c.length)return;const f=e.moveClass||`${e.name||"v"}-move`;if(!ble(c[0].el,o.vnode.el,f))return;c.forEach(_le),c.forEach(yle);const p=c.filter(Ile);U$(),p.forEach(v=>{const _=v.el,b=_.style;qc(_,f),b.transform=b.webkitTransform=b.transitionDuration="";const S=_[DE]=k=>{k&&k.target!==_||(!k||/transform$/.test(k.propertyName))&&(_.removeEventListener("transitionend",S),_[DE]=null,_d(_,f))};_.addEventListener("transitionend",S)})}),()=>{const f=Mo(e),p=P$(f);let v=f.tag||Ht;if(c=[],u)for(let _=0;_<u.length;_++){const b=u[_];b.el&&b.el instanceof Element&&(c.push(b),y0(b,_0(b,p,i,o)),V$.set(b,b.el.getBoundingClientRect()))}u=t.default?gL(t.default()):[];for(let _=0;_<u.length;_++){const b=u[_];b.key!=null&&y0(b,_0(b,p,i,o))}return Me(v,null,u)}}},vle=e=>delete e.mode;B$.props;const H$=B$;function _le(e){const t=e.el;t[DE]&&t[DE](),t[a6]&&t[a6]()}function yle(e){G$.set(e,e.el.getBoundingClientRect())}function Ile(e){const t=V$.get(e),o=G$.get(e),i=t.left-o.left,c=t.top-o.top;if(i||c){const u=e.el.style;return u.transform=u.webkitTransform=`translate(${i}px,${c}px)`,u.transitionDuration="0s",e}}function ble(e,t,o){const i=e.cloneNode(),c=e[Vg];c&&c.forEach(p=>{p.split(/\s+/).forEach(v=>v&&i.classList.remove(v))}),o.split(/\s+/).forEach(p=>p&&i.classList.add(p)),i.style.display="none";const u=t.nodeType===1?t:t.parentNode;u.appendChild(i);const{hasTransform:f}=x$(i);return u.removeChild(i),f}const Gg=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ht(t)?o=>eE(t,o):t};function Cle(e){e.target.composing=!0}function s6(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const nu=Symbol("_assign"),ET={created(e,{modifiers:{lazy:t,trim:o,number:i}},c){e[nu]=Gg(c);const u=i||c.props&&c.props.type==="number";Ad(e,t?"change":"input",f=>{if(f.target.composing)return;let p=e.value;o&&(p=p.trim()),u&&(p=_D(p)),e[nu](p)}),o&&Ad(e,"change",()=>{e.value=e.value.trim()}),t||(Ad(e,"compositionstart",Cle),Ad(e,"compositionend",s6),Ad(e,"change",s6))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:o,trim:i,number:c}},u){if(e[nu]=Gg(u),e.composing)return;const f=(c||e.type==="number")&&!/^0\d/.test(e.value)?_D(e.value):e.value,p=t??"";f!==p&&(document.activeElement===e&&e.type!=="range"&&(o||i&&e.value.trim()===p)||(e.value=p))}},OE={deep:!0,created(e,t,o){e[nu]=Gg(o),Ad(e,"change",()=>{const i=e._modelValue,c=q$(e),u=e.checked,f=e[nu];if(ht(i)){const p=NH(i,c),v=p!==-1;if(u&&!v)f(i.concat(c));else if(!u&&v){const _=[...i];_.splice(p,1),f(_)}}else if(fT(i)){const p=new Set(i);u?p.add(c):p.delete(c),f(p)}else f(K$(e,u))})},mounted:l6,beforeUpdate(e,t,o){e[nu]=Gg(o),l6(e,t,o)}};function l6(e,{value:t,oldValue:o},i){e._modelValue=t,ht(t)?e.checked=NH(t,i.props.value)>-1:fT(t)?e.checked=t.has(i.props.value):t!==o&&(e.checked=Fg(t,K$(e,!0)))}const $$={created(e,{value:t},o){e.checked=Fg(t,o.props.value),e[nu]=Gg(o),Ad(e,"change",()=>{e[nu](q$(e))})},beforeUpdate(e,{value:t,oldValue:o},i){e[nu]=Gg(i),t!==o&&(e.checked=Fg(t,i.props.value))}};function q$(e){return"_value"in e?e._value:e.value}function K$(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Sle=["ctrl","shift","alt","meta"],Ele={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Sle.some(o=>e[`${o}Key`]&&!t.includes(o))},Zt=(e,t)=>{const o=e._withMods||(e._withMods={}),i=t.join(".");return o[i]||(o[i]=(c,...u)=>{for(let f=0;f<t.length;f++){const p=Ele[t[f]];if(p&&p(c,t))return}return e(c,...u)})},Tle={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},To=(e,t)=>{const o=e._withKeys||(e._withKeys={}),i=t.join(".");return o[i]||(o[i]=c=>{if(!("key"in c))return;const u=th(c.key);if(t.some(f=>f===u||Tle[f]===u))return e(c)})},Mle=Xr({patchProp:mle},Xse);let c6;function z$(){return c6||(c6=Rse(Mle))}const Kd=(...e)=>{z$().render(...e)},W$=(...e)=>{const t=z$().createApp(...e),{mount:o}=t;return t.mount=i=>{const c=wle(i);if(!c)return;const u=t._component;!zt(u)&&!u.render&&!u.template&&(u.template=c.innerHTML),c.innerHTML="";const f=o(c,!1,kle(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),f},t};function kle(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function wle(e){return Ut(e)?document.querySelector(e):e}/*!
  * vue-router v4.3.2
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const pg=typeof document<"u";function Rle(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const er=Object.assign;function vA(e,t){const o={};for(const i in t){const c=t[i];o[i]=cl(c)?c.map(e):e(c)}return o}const Jy=()=>{},cl=Array.isArray,j$=/#/g,Ale=/&/g,Dle=/\//g,Ole=/=/g,Lle=/\?/g,Y$=/\+/g,Nle=/%5B/g,Ple=/%5D/g,J$=/%5E/g,xle=/%60/g,X$=/%7B/g,Ule=/%7C/g,Z$=/%7D/g,Fle=/%20/g;function CL(e){return encodeURI(""+e).replace(Ule,"|").replace(Nle,"[").replace(Ple,"]")}function Vle(e){return CL(e).replace(X$,"{").replace(Z$,"}").replace(J$,"^")}function AD(e){return CL(e).replace(Y$,"%2B").replace(Fle,"+").replace(j$,"%23").replace(Ale,"%26").replace(xle,"`").replace(X$,"{").replace(Z$,"}").replace(J$,"^")}function Gle(e){return AD(e).replace(Ole,"%3D")}function Ble(e){return CL(e).replace(j$,"%23").replace(Lle,"%3F")}function Hle(e){return e==null?"":Ble(e).replace(Dle,"%2F")}function b0(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const $le=/\/$/,qle=e=>e.replace($le,"");function _A(e,t,o="/"){let i,c={},u="",f="";const p=t.indexOf("#");let v=t.indexOf("?");return p<v&&p>=0&&(v=-1),v>-1&&(i=t.slice(0,v),u=t.slice(v+1,p>-1?p:t.length),c=e(u)),p>-1&&(i=i||t.slice(0,p),f=t.slice(p,t.length)),i=jle(i??t,o),{fullPath:i+(u&&"?")+u+f,path:i,query:c,hash:b0(f)}}function Kle(e,t){const o=t.query?e(t.query):"";return t.path+(o&&"?")+o+(t.hash||"")}function u6(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function zle(e,t,o){const i=t.matched.length-1,c=o.matched.length-1;return i>-1&&i===c&&Bg(t.matched[i],o.matched[c])&&Q$(t.params,o.params)&&e(t.query)===e(o.query)&&t.hash===o.hash}function Bg(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Q$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const o in e)if(!Wle(e[o],t[o]))return!1;return!0}function Wle(e,t){return cl(e)?d6(e,t):cl(t)?d6(t,e):e===t}function d6(e,t){return cl(t)?e.length===t.length&&e.every((o,i)=>o===t[i]):e.length===1&&e[0]===t}function jle(e,t){if(e.startsWith("/"))return e;if(!e)return t;const o=t.split("/"),i=e.split("/"),c=i[i.length-1];(c===".."||c===".")&&i.push("");let u=o.length-1,f,p;for(f=0;f<i.length;f++)if(p=i[f],p!==".")if(p==="..")u>1&&u--;else break;return o.slice(0,u).join("/")+"/"+i.slice(f).join("/")}var C0;(function(e){e.pop="pop",e.push="push"})(C0||(C0={}));var Xy;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Xy||(Xy={}));function Yle(e){if(!e)if(pg){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),qle(e)}const Jle=/^[^#]+#/;function Xle(e,t){return e.replace(Jle,"#")+t}function Zle(e,t){const o=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-o.left-(t.left||0),top:i.top-o.top-(t.top||0)}}const TT=()=>({left:window.scrollX,top:window.scrollY});function Qle(e){let t;if("el"in e){const o=e.el,i=typeof o=="string"&&o.startsWith("#"),c=typeof o=="string"?i?document.getElementById(o.slice(1)):document.querySelector(o):o;if(!c)return;t=Zle(c,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function h6(e,t){return(history.state?history.state.position-t:-1)+e}const DD=new Map;function ece(e,t){DD.set(e,t)}function tce(e){const t=DD.get(e);return DD.delete(e),t}let nce=()=>location.protocol+"//"+location.host;function e7(e,t){const{pathname:o,search:i,hash:c}=t,u=e.indexOf("#");if(u>-1){let p=c.includes(e.slice(u))?e.slice(u).length:1,v=c.slice(p);return v[0]!=="/"&&(v="/"+v),u6(v,"")}return u6(o,e)+i+c}function oce(e,t,o,i){let c=[],u=[],f=null;const p=({state:k})=>{const M=e7(e,location),R=o.value,w=t.value;let E=0;if(k){if(o.value=M,t.value=k,f&&f===R){f=null;return}E=w?k.position-w.position:0}else i(M);c.forEach(N=>{N(o.value,R,{delta:E,type:C0.pop,direction:E?E>0?Xy.forward:Xy.back:Xy.unknown})})};function v(){f=o.value}function _(k){c.push(k);const M=()=>{const R=c.indexOf(k);R>-1&&c.splice(R,1)};return u.push(M),M}function b(){const{history:k}=window;k.state&&k.replaceState(er({},k.state,{scroll:TT()}),"")}function S(){for(const k of u)k();u=[],window.removeEventListener("popstate",p),window.removeEventListener("beforeunload",b)}return window.addEventListener("popstate",p),window.addEventListener("beforeunload",b,{passive:!0}),{pauseListeners:v,listen:_,destroy:S}}function f6(e,t,o,i=!1,c=!1){return{back:e,current:t,forward:o,replaced:i,position:window.history.length,scroll:c?TT():null}}function rce(e){const{history:t,location:o}=window,i={value:e7(e,o)},c={value:t.state};c.value||u(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function u(v,_,b){const S=e.indexOf("#"),k=S>-1?(o.host&&document.querySelector("base")?e:e.slice(S))+v:nce()+e+v;try{t[b?"replaceState":"pushState"](_,"",k),c.value=_}catch(M){console.error(M),o[b?"replace":"assign"](k)}}function f(v,_){const b=er({},t.state,f6(c.value.back,v,c.value.forward,!0),_,{position:c.value.position});u(v,b,!0),i.value=v}function p(v,_){const b=er({},c.value,t.state,{forward:v,scroll:TT()});u(b.current,b,!0);const S=er({},f6(i.value,v,null),{position:b.position+1},_);u(v,S,!1),i.value=v}return{location:i,state:c,push:p,replace:f}}function ice(e){e=Yle(e);const t=rce(e),o=oce(e,t.state,t.location,t.replace);function i(u,f=!0){f||o.pauseListeners(),history.go(u)}const c=er({location:"",base:e,go:i,createHref:Xle.bind(null,e)},t,o);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>t.state.value}),c}function ace(e){return typeof e=="string"||e&&typeof e=="object"}function t7(e){return typeof e=="string"||typeof e=="symbol"}const gd={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},n7=Symbol("");var p6;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(p6||(p6={}));function Hg(e,t){return er(new Error,{type:e,[n7]:!0},t)}function Gc(e,t){return e instanceof Error&&n7 in e&&(t==null||!!(e.type&t))}const m6="[^/]+?",sce={sensitive:!1,strict:!1,start:!0,end:!0},lce=/[.+*?^${}()[\]/\\]/g;function cce(e,t){const o=er({},sce,t),i=[];let c=o.start?"^":"";const u=[];for(const _ of e){const b=_.length?[]:[90];o.strict&&!_.length&&(c+="/");for(let S=0;S<_.length;S++){const k=_[S];let M=40+(o.sensitive?.25:0);if(k.type===0)S||(c+="/"),c+=k.value.replace(lce,"\\$&"),M+=40;else if(k.type===1){const{value:R,repeatable:w,optional:E,regexp:N}=k;u.push({name:R,repeatable:w,optional:E});const F=N||m6;if(F!==m6){M+=10;try{new RegExp(`(${F})`)}catch(P){throw new Error(`Invalid custom RegExp for param "${R}" (${F}): `+P.message)}}let x=w?`((?:${F})(?:/(?:${F}))*)`:`(${F})`;S||(x=E&&_.length<2?`(?:/${x})`:"/"+x),E&&(x+="?"),c+=x,M+=20,E&&(M+=-8),w&&(M+=-20),F===".*"&&(M+=-50)}b.push(M)}i.push(b)}if(o.strict&&o.end){const _=i.length-1;i[_][i[_].length-1]+=.7000000000000001}o.strict||(c+="/?"),o.end?c+="$":o.strict&&(c+="(?:/|$)");const f=new RegExp(c,o.sensitive?"":"i");function p(_){const b=_.match(f),S={};if(!b)return null;for(let k=1;k<b.length;k++){const M=b[k]||"",R=u[k-1];S[R.name]=M&&R.repeatable?M.split("/"):M}return S}function v(_){let b="",S=!1;for(const k of e){(!S||!b.endsWith("/"))&&(b+="/"),S=!1;for(const M of k)if(M.type===0)b+=M.value;else if(M.type===1){const{value:R,repeatable:w,optional:E}=M,N=R in _?_[R]:"";if(cl(N)&&!w)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const F=cl(N)?N.join("/"):N;if(!F)if(E)k.length<2&&(b.endsWith("/")?b=b.slice(0,-1):S=!0);else throw new Error(`Missing required param "${R}"`);b+=F}}return b||"/"}return{re:f,score:i,keys:u,parse:p,stringify:v}}function uce(e,t){let o=0;for(;o<e.length&&o<t.length;){const i=t[o]-e[o];if(i)return i;o++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function dce(e,t){let o=0;const i=e.score,c=t.score;for(;o<i.length&&o<c.length;){const u=uce(i[o],c[o]);if(u)return u;o++}if(Math.abs(c.length-i.length)===1){if(g6(i))return 1;if(g6(c))return-1}return c.length-i.length}function g6(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const hce={type:0,value:""},fce=/[a-zA-Z0-9_]/;function pce(e){if(!e)return[[]];if(e==="/")return[[hce]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(M){throw new Error(`ERR (${o})/"${_}": ${M}`)}let o=0,i=o;const c=[];let u;function f(){u&&c.push(u),u=[]}let p=0,v,_="",b="";function S(){_&&(o===0?u.push({type:0,value:_}):o===1||o===2||o===3?(u.length>1&&(v==="*"||v==="+")&&t(`A repeatable param (${_}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:_,regexp:b,repeatable:v==="*"||v==="+",optional:v==="*"||v==="?"})):t("Invalid state to consume buffer"),_="")}function k(){_+=v}for(;p<e.length;){if(v=e[p++],v==="\\"&&o!==2){i=o,o=4;continue}switch(o){case 0:v==="/"?(_&&S(),f()):v===":"?(S(),o=1):k();break;case 4:k(),o=i;break;case 1:v==="("?o=2:fce.test(v)?k():(S(),o=0,v!=="*"&&v!=="?"&&v!=="+"&&p--);break;case 2:v===")"?b[b.length-1]=="\\"?b=b.slice(0,-1)+v:o=3:b+=v;break;case 3:S(),o=0,v!=="*"&&v!=="?"&&v!=="+"&&p--,b="";break;default:t("Unknown state");break}}return o===2&&t(`Unfinished custom RegExp for param "${_}"`),S(),f(),c}function mce(e,t,o){const i=cce(pce(e.path),o),c=er(i,{record:e,parent:t,children:[],alias:[]});return t&&!c.record.aliasOf==!t.record.aliasOf&&t.children.push(c),c}function gce(e,t){const o=[],i=new Map;t=y6({strict:!1,end:!0,sensitive:!1},t);function c(b){return i.get(b)}function u(b,S,k){const M=!k,R=vce(b);R.aliasOf=k&&k.record;const w=y6(t,b),E=[R];if("alias"in b){const x=typeof b.alias=="string"?[b.alias]:b.alias;for(const P of x)E.push(er({},R,{components:k?k.record.components:R.components,path:P,aliasOf:k?k.record:R}))}let N,F;for(const x of E){const{path:P}=x;if(S&&P[0]!=="/"){const G=S.record.path,H=G[G.length-1]==="/"?"":"/";x.path=S.record.path+(P&&H+P)}if(N=mce(x,S,w),k?k.alias.push(N):(F=F||N,F!==N&&F.alias.push(N),M&&b.name&&!_6(N)&&f(b.name)),R.children){const G=R.children;for(let H=0;H<G.length;H++)u(G[H],N,k&&k.children[H])}k=k||N,(N.record.components&&Object.keys(N.record.components).length||N.record.name||N.record.redirect)&&v(N)}return F?()=>{f(F)}:Jy}function f(b){if(t7(b)){const S=i.get(b);S&&(i.delete(b),o.splice(o.indexOf(S),1),S.children.forEach(f),S.alias.forEach(f))}else{const S=o.indexOf(b);S>-1&&(o.splice(S,1),b.record.name&&i.delete(b.record.name),b.children.forEach(f),b.alias.forEach(f))}}function p(){return o}function v(b){let S=0;for(;S<o.length&&dce(b,o[S])>=0&&(b.record.path!==o[S].record.path||!o7(b,o[S]));)S++;o.splice(S,0,b),b.record.name&&!_6(b)&&i.set(b.record.name,b)}function _(b,S){let k,M={},R,w;if("name"in b&&b.name){if(k=i.get(b.name),!k)throw Hg(1,{location:b});w=k.record.name,M=er(v6(S.params,k.keys.filter(F=>!F.optional).concat(k.parent?k.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),b.params&&v6(b.params,k.keys.map(F=>F.name))),R=k.stringify(M)}else if(b.path!=null)R=b.path,k=o.find(F=>F.re.test(R)),k&&(M=k.parse(R),w=k.record.name);else{if(k=S.name?i.get(S.name):o.find(F=>F.re.test(S.path)),!k)throw Hg(1,{location:b,currentLocation:S});w=k.record.name,M=er({},S.params,b.params),R=k.stringify(M)}const E=[];let N=k;for(;N;)E.unshift(N.record),N=N.parent;return{name:w,path:R,params:M,matched:E,meta:yce(E)}}return e.forEach(b=>u(b)),{addRoute:u,resolve:_,removeRoute:f,getRoutes:p,getRecordMatcher:c}}function v6(e,t){const o={};for(const i of t)i in e&&(o[i]=e[i]);return o}function vce(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:_ce(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function _ce(e){const t={},o=e.props||!1;if("component"in e)t.default=o;else for(const i in e.components)t[i]=typeof o=="object"?o[i]:o;return t}function _6(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function yce(e){return e.reduce((t,o)=>er(t,o.meta),{})}function y6(e,t){const o={};for(const i in e)o[i]=i in t?t[i]:e[i];return o}function o7(e,t){return t.children.some(o=>o===e||o7(e,o))}function Ice(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<i.length;++c){const u=i[c].replace(Y$," "),f=u.indexOf("="),p=b0(f<0?u:u.slice(0,f)),v=f<0?null:b0(u.slice(f+1));if(p in t){let _=t[p];cl(_)||(_=t[p]=[_]),_.push(v)}else t[p]=v}return t}function I6(e){let t="";for(let o in e){const i=e[o];if(o=Gle(o),i==null){i!==void 0&&(t+=(t.length?"&":"")+o);continue}(cl(i)?i.map(u=>u&&AD(u)):[i&&AD(i)]).forEach(u=>{u!==void 0&&(t+=(t.length?"&":"")+o,u!=null&&(t+="="+u))})}return t}function bce(e){const t={};for(const o in e){const i=e[o];i!==void 0&&(t[o]=cl(i)?i.map(c=>c==null?null:""+c):i==null?i:""+i)}return t}const Cce=Symbol(""),b6=Symbol(""),SL=Symbol(""),EL=Symbol(""),OD=Symbol("");function ky(){let e=[];function t(i){return e.push(i),()=>{const c=e.indexOf(i);c>-1&&e.splice(c,1)}}function o(){e=[]}return{add:t,list:()=>e.slice(),reset:o}}function Rd(e,t,o,i,c,u=f=>f()){const f=i&&(i.enterCallbacks[c]=i.enterCallbacks[c]||[]);return()=>new Promise((p,v)=>{const _=k=>{k===!1?v(Hg(4,{from:o,to:t})):k instanceof Error?v(k):ace(k)?v(Hg(2,{from:t,to:k})):(f&&i.enterCallbacks[c]===f&&typeof k=="function"&&f.push(k),p())},b=u(()=>e.call(i&&i.instances[c],t,o,_));let S=Promise.resolve(b);e.length<3&&(S=S.then(_)),S.catch(k=>v(k))})}function yA(e,t,o,i,c=u=>u()){const u=[];for(const f of e)for(const p in f.components){let v=f.components[p];if(!(t!=="beforeRouteEnter"&&!f.instances[p]))if(Sce(v)){const b=(v.__vccOpts||v)[t];b&&u.push(Rd(b,o,i,f,p,c))}else{let _=v();u.push(()=>_.then(b=>{if(!b)return Promise.reject(new Error(`Couldn't resolve component "${p}" at "${f.path}"`));const S=Rle(b)?b.default:b;f.components[p]=S;const M=(S.__vccOpts||S)[t];return M&&Rd(M,o,i,f,p,c)()}))}}return u}function Sce(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function C6(e){const t=Rt(SL),o=Rt(EL),i=z(()=>{const v=y(e.to);return t.resolve(v)}),c=z(()=>{const{matched:v}=i.value,{length:_}=v,b=v[_-1],S=o.matched;if(!b||!S.length)return-1;const k=S.findIndex(Bg.bind(null,b));if(k>-1)return k;const M=S6(v[_-2]);return _>1&&S6(b)===M&&S[S.length-1].path!==M?S.findIndex(Bg.bind(null,v[_-2])):k}),u=z(()=>c.value>-1&&Mce(o.params,i.value.params)),f=z(()=>c.value>-1&&c.value===o.matched.length-1&&Q$(o.params,i.value.params));function p(v={}){return Tce(v)?t[y(e.replace)?"replace":"push"](y(e.to)).catch(Jy):Promise.resolve()}return{route:i,href:z(()=>i.value.href),isActive:u,isExactActive:f,navigate:p}}const Ece=Te({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:C6,setup(e,{slots:t}){const o=eo(C6(e)),{options:i}=Rt(SL),c=z(()=>({[E6(e.activeClass,i.linkActiveClass,"router-link-active")]:o.isActive,[E6(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive}));return()=>{const u=t.default&&t.default(o);return e.custom?u:Jt("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:c.value},u)}}}),LD=Ece;function Tce(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Mce(e,t){for(const o in t){const i=t[o],c=e[o];if(typeof i=="string"){if(i!==c)return!1}else if(!cl(c)||c.length!==i.length||i.some((u,f)=>u!==c[f]))return!1}return!0}function S6(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const E6=(e,t,o)=>e??t??o,kce=Te({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:o}){const i=Rt(OD),c=z(()=>e.route||i.value),u=Rt(b6,0),f=z(()=>{let _=y(u);const{matched:b}=c.value;let S;for(;(S=b[_])&&!S.components;)_++;return _}),p=z(()=>c.value.matched[f.value]);Nn(b6,z(()=>f.value+1)),Nn(Cce,p),Nn(OD,c);const v=le();return st(()=>[v.value,p.value,e.name],([_,b,S],[k,M,R])=>{b&&(b.instances[S]=_,M&&M!==b&&_&&_===k&&(b.leaveGuards.size||(b.leaveGuards=M.leaveGuards),b.updateGuards.size||(b.updateGuards=M.updateGuards))),_&&b&&(!M||!Bg(b,M)||!k)&&(b.enterCallbacks[S]||[]).forEach(w=>w(_))},{flush:"post"}),()=>{const _=c.value,b=e.name,S=p.value,k=S&&S.components[b];if(!k)return T6(o.default,{Component:k,route:_});const M=S.props[b],R=M?M===!0?_.params:typeof M=="function"?M(_):M:null,E=Jt(k,er({},R,t,{onVnodeUnmounted:N=>{N.component.isUnmounted&&(S.instances[b]=null)},ref:v}));return T6(o.default,{Component:E,route:_})||E}}});function T6(e,t){if(!e)return null;const o=e(t);return o.length===1?o[0]:o}const r7=kce;function wce(e){const t=gce(e.routes,e),o=e.parseQuery||Ice,i=e.stringifyQuery||I6,c=e.history,u=ky(),f=ky(),p=ky(),v=Go(gd);let _=gd;pg&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const b=vA.bind(null,be=>""+be),S=vA.bind(null,Hle),k=vA.bind(null,b0);function M(be,xe){let Le,rt;return t7(be)?(Le=t.getRecordMatcher(be),rt=xe):rt=be,t.addRoute(rt,Le)}function R(be){const xe=t.getRecordMatcher(be);xe&&t.removeRoute(xe)}function w(){return t.getRoutes().map(be=>be.record)}function E(be){return!!t.getRecordMatcher(be)}function N(be,xe){if(xe=er({},xe||v.value),typeof be=="string"){const Re=_A(o,be,xe.path),Ke=t.resolve({path:Re.path},xe),je=c.createHref(Re.fullPath);return er(Re,Ke,{params:k(Ke.params),hash:b0(Re.hash),redirectedFrom:void 0,href:je})}let Le;if(be.path!=null)Le=er({},be,{path:_A(o,be.path,xe.path).path});else{const Re=er({},be.params);for(const Ke in Re)Re[Ke]==null&&delete Re[Ke];Le=er({},be,{params:S(Re)}),xe.params=S(xe.params)}const rt=t.resolve(Le,xe),Qe=be.hash||"";rt.params=b(k(rt.params));const Ge=Kle(i,er({},be,{hash:Vle(Qe),path:rt.path})),_e=c.createHref(Ge);return er({fullPath:Ge,hash:Qe,query:i===I6?bce(be.query):be.query||{}},rt,{redirectedFrom:void 0,href:_e})}function F(be){return typeof be=="string"?_A(o,be,v.value.path):er({},be)}function x(be,xe){if(_!==be)return Hg(8,{from:xe,to:be})}function P(be){return Y(be)}function G(be){return P(er(F(be),{replace:!0}))}function H(be){const xe=be.matched[be.matched.length-1];if(xe&&xe.redirect){const{redirect:Le}=xe;let rt=typeof Le=="function"?Le(be):Le;return typeof rt=="string"&&(rt=rt.includes("?")||rt.includes("#")?rt=F(rt):{path:rt},rt.params={}),er({query:be.query,hash:be.hash,params:rt.path!=null?{}:be.params},rt)}}function Y(be,xe){const Le=_=N(be),rt=v.value,Qe=be.state,Ge=be.force,_e=be.replace===!0,Re=H(Le);if(Re)return Y(er(F(Re),{state:typeof Re=="object"?er({},Qe,Re.state):Qe,force:Ge,replace:_e}),xe||Le);const Ke=Le;Ke.redirectedFrom=xe;let je;return!Ge&&zle(i,rt,Le)&&(je=Hg(16,{to:Ke,from:rt}),ue(rt,rt,!0,!1)),(je?Promise.resolve(je):O(Ke,rt)).catch(ze=>Gc(ze)?Gc(ze,2)?ze:ye(ze):re(ze,Ke,rt)).then(ze=>{if(ze){if(Gc(ze,2))return Y(er({replace:_e},F(ze.to),{state:typeof ze.to=="object"?er({},Qe,ze.to.state):Qe,force:Ge}),xe||Ke)}else ze=J(Ke,rt,!0,_e,Qe);return Q(Ke,rt,ze),ze})}function j(be,xe){const Le=x(be,xe);return Le?Promise.reject(Le):Promise.resolve()}function W(be){const xe=Ce.values().next().value;return xe&&typeof xe.runWithContext=="function"?xe.runWithContext(be):be()}function O(be,xe){let Le;const[rt,Qe,Ge]=Rce(be,xe);Le=yA(rt.reverse(),"beforeRouteLeave",be,xe);for(const Re of rt)Re.leaveGuards.forEach(Ke=>{Le.push(Rd(Ke,be,xe))});const _e=j.bind(null,be,xe);return Le.push(_e),Oe(Le).then(()=>{Le=[];for(const Re of u.list())Le.push(Rd(Re,be,xe));return Le.push(_e),Oe(Le)}).then(()=>{Le=yA(Qe,"beforeRouteUpdate",be,xe);for(const Re of Qe)Re.updateGuards.forEach(Ke=>{Le.push(Rd(Ke,be,xe))});return Le.push(_e),Oe(Le)}).then(()=>{Le=[];for(const Re of Ge)if(Re.beforeEnter)if(cl(Re.beforeEnter))for(const Ke of Re.beforeEnter)Le.push(Rd(Ke,be,xe));else Le.push(Rd(Re.beforeEnter,be,xe));return Le.push(_e),Oe(Le)}).then(()=>(be.matched.forEach(Re=>Re.enterCallbacks={}),Le=yA(Ge,"beforeRouteEnter",be,xe,W),Le.push(_e),Oe(Le))).then(()=>{Le=[];for(const Re of f.list())Le.push(Rd(Re,be,xe));return Le.push(_e),Oe(Le)}).catch(Re=>Gc(Re,8)?Re:Promise.reject(Re))}function Q(be,xe,Le){p.list().forEach(rt=>W(()=>rt(be,xe,Le)))}function J(be,xe,Le,rt,Qe){const Ge=x(be,xe);if(Ge)return Ge;const _e=xe===gd,Re=pg?history.state:{};Le&&(rt||_e?c.replace(be.fullPath,er({scroll:_e&&Re&&Re.scroll},Qe)):c.push(be.fullPath,Qe)),v.value=be,ue(be,xe,Le,_e),ye()}let oe;function pe(){oe||(oe=c.listen((be,xe,Le)=>{if(!Fe.listening)return;const rt=N(be),Qe=H(rt);if(Qe){Y(er(Qe,{replace:!0}),rt).catch(Jy);return}_=rt;const Ge=v.value;pg&&ece(h6(Ge.fullPath,Le.delta),TT()),O(rt,Ge).catch(_e=>Gc(_e,12)?_e:Gc(_e,2)?(Y(_e.to,rt).then(Re=>{Gc(Re,20)&&!Le.delta&&Le.type===C0.pop&&c.go(-1,!1)}).catch(Jy),Promise.reject()):(Le.delta&&c.go(-Le.delta,!1),re(_e,rt,Ge))).then(_e=>{_e=_e||J(rt,Ge,!1),_e&&(Le.delta&&!Gc(_e,8)?c.go(-Le.delta,!1):Le.type===C0.pop&&Gc(_e,20)&&c.go(-1,!1)),Q(rt,Ge,_e)}).catch(Jy)}))}let ie=ky(),te=ky(),he;function re(be,xe,Le){ye(be);const rt=te.list();return rt.length?rt.forEach(Qe=>Qe(be,xe,Le)):console.error(be),Promise.reject(be)}function X(){return he&&v.value!==gd?Promise.resolve():new Promise((be,xe)=>{ie.add([be,xe])})}function ye(be){return he||(he=!be,pe(),ie.list().forEach(([xe,Le])=>be?Le(be):xe()),ie.reset()),be}function ue(be,xe,Le,rt){const{scrollBehavior:Qe}=e;if(!pg||!Qe)return Promise.resolve();const Ge=!Le&&tce(h6(be.fullPath,0))||(rt||!Le)&&history.state&&history.state.scroll||null;return Vt().then(()=>Qe(be,xe,Ge)).then(_e=>_e&&Qle(_e)).catch(_e=>re(_e,be,xe))}const Ie=be=>c.go(be);let ve;const Ce=new Set,Fe={currentRoute:v,listening:!0,addRoute:M,removeRoute:R,hasRoute:E,getRoutes:w,resolve:N,options:e,push:P,replace:G,go:Ie,back:()=>Ie(-1),forward:()=>Ie(1),beforeEach:u.add,beforeResolve:f.add,afterEach:p.add,onError:te.add,isReady:X,install(be){const xe=this;be.component("RouterLink",LD),be.component("RouterView",r7),be.config.globalProperties.$router=xe,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>y(v)}),pg&&!ve&&v.value===gd&&(ve=!0,P(c.location).catch(Qe=>{}));const Le={};for(const Qe in gd)Object.defineProperty(Le,Qe,{get:()=>v.value[Qe],enumerable:!0});be.provide(SL,xe),be.provide(EL,sL(Le)),be.provide(OD,v);const rt=be.unmount;Ce.add(be),be.unmount=function(){Ce.delete(be),Ce.size<1&&(_=gd,oe&&oe(),oe=null,v.value=gd,ve=!1,he=!1),rt()}}};function Oe(be){return be.reduce((xe,Le)=>xe.then(()=>W(Le)),Promise.resolve())}return Fe}function Rce(e,t){const o=[],i=[],c=[],u=Math.max(t.matched.length,e.matched.length);for(let f=0;f<u;f++){const p=t.matched[f];p&&(e.matched.find(_=>Bg(_,p))?i.push(p):o.push(p));const v=e.matched[f];v&&(t.matched.find(_=>Bg(_,v))||c.push(v))}return[o,i,c]}function i7(){return Rt(EL)}const Ace=Te({__name:"App",setup(e){return(t,o)=>(ee(),We(y(r7)))}});var wr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ns(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a7={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){function o(r,l){return l.forEach(function(d){d&&typeof d!="string"&&!Array.isArray(d)&&Object.keys(d).forEach(function(g){if(g!=="default"&&!(g in r)){var C=Object.getOwnPropertyDescriptor(d,g);Object.defineProperty(r,g,C.get?C:{enumerable:!0,get:function(){return d[g]}})}})}),Object.freeze(r)}var i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof wr<"u"?wr:typeof self<"u"?self:{},c=function(r){try{return!!r()}catch{return!0}},u=!c(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),f=u,p=Function.prototype,v=p.call,_=f&&p.bind.bind(v,v),b=f?_:function(r){return function(){return v.apply(r,arguments)}},S=b,k=S({}.toString),M=S("".slice),R=function(r){return M(k(r),8,-1)},w=c,E=R,N=Object,F=b("".split),x=w(function(){return!N("z").propertyIsEnumerable(0)})?function(r){return E(r)=="String"?F(r,""):N(r)}:N,P=function(r){return r==null},G=P,H=TypeError,Y=function(r){if(G(r))throw H("Can't call method on "+r);return r},j=x,W=Y,O=function(r){return j(W(r))},Q=function(r){return r&&r.Math==Math&&r},J=Q(typeof globalThis=="object"&&globalThis)||Q(typeof window=="object"&&window)||Q(typeof self=="object"&&self)||Q(typeof i=="object"&&i)||function(){return this}()||Function("return this")(),oe={},pe={get exports(){return oe},set exports(r){oe=r}},ie=J,te=Object.defineProperty,he=function(r,l){try{te(ie,r,{value:l,configurable:!0,writable:!0})}catch{ie[r]=l}return l},re=he,X="__core-js_shared__",ye=J[X]||re(X,{}),ue=ye;(pe.exports=function(r,l){return ue[r]||(ue[r]=l!==void 0?l:{})})("versions",[]).push({version:"3.30.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ie,ve,Ce=Y,Fe=Object,Oe=function(r){return Fe(Ce(r))},be=Oe,xe=b({}.hasOwnProperty),Le=Object.hasOwn||function(r,l){return xe(be(r),l)},rt=b,Qe=0,Ge=Math.random(),_e=rt(1 .toString),Re=function(r){return"Symbol("+(r===void 0?"":r)+")_"+_e(++Qe+Ge,36)},Ke=typeof navigator<"u"&&String(navigator.userAgent)||"",je=J,ze=Ke,nt=je.process,it=je.Deno,dt=nt&&nt.versions||it&&it.version,gt=dt&&dt.v8;gt&&(ve=(Ie=gt.split("."))[0]>0&&Ie[0]<4?1:+(Ie[0]+Ie[1])),!ve&&ze&&(!(Ie=ze.match(/Edge\/(\d+)/))||Ie[1]>=74)&&(Ie=ze.match(/Chrome\/(\d+)/))&&(ve=+Ie[1]);var ft=ve,Mt=ft,lt=c,Et=!!Object.getOwnPropertySymbols&&!lt(function(){var r=Symbol();return!String(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&Mt&&Mt<41}),Yt=Et&&!Symbol.sham&&typeof Symbol.iterator=="symbol",sn=oe,dn=Le,Sn=Re,yn=Et,fo=Yt,Xt=J.Symbol,vn=sn("wks"),Ne=fo?Xt.for||Xt:Xt&&Xt.withoutSetter||Sn,qe=function(r){return dn(vn,r)||(vn[r]=yn&&dn(Xt,r)?Xt[r]:Ne("Symbol."+r)),vn[r]},ke=typeof document=="object"&&document.all,ot={all:ke,IS_HTMLDDA:ke===void 0&&ke!==void 0},tn=ot.all,Nt=ot.IS_HTMLDDA?function(r){return typeof r=="function"||r===tn}:function(r){return typeof r=="function"},Dn=Nt,dr=ot.all,io=ot.IS_HTMLDDA?function(r){return typeof r=="object"?r!==null:Dn(r)||r===dr}:function(r){return typeof r=="object"?r!==null:Dn(r)},hr=io,K=String,ri=TypeError,Gt=function(r){if(hr(r))return r;throw ri(K(r)+" is not an object")},Ho={},jo=!c(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),xi=jo&&c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Vr={},Ui=io,ii=J.document,ha=Ui(ii)&&Ui(ii.createElement),gl=function(r){return ha?ii.createElement(r):{}},Tt=gl,sc=!jo&&!c(function(){return Object.defineProperty(Tt("div"),"a",{get:function(){return 7}}).a!=7}),lh=u,_t=Function.prototype.call,It=lh?_t.bind(_t):function(){return _t.apply(_t,arguments)},Vn=J,On=Nt,wt=function(r,l){return arguments.length<2?(d=Vn[r],On(d)?d:void 0):Vn[r]&&Vn[r][l];var d},zr=b({}.isPrototypeOf),No=wt,La=Nt,Na=zr,ei=Object,bt=Yt?function(r){return typeof r=="symbol"}:function(r){var l=No("Symbol");return La(l)&&Na(l.prototype,ei(r))},Qt=String,hn=function(r){try{return Qt(r)}catch{return"Object"}},Yn=Nt,fr=hn,Wr=TypeError,Ar=function(r){if(Yn(r))return r;throw Wr(fr(r)+" is not a function")},xs=Ar,_n=P,et=function(r,l){var d=r[l];return _n(d)?void 0:xs(d)},Us=It,ch=Nt,is=io,_I=TypeError,n1=It,uh=io,vu=bt,Cv=et,yI=function(r,l){var d,g;if(l==="string"&&ch(d=r.toString)&&!is(g=Us(d,r))||ch(d=r.valueOf)&&!is(g=Us(d,r))||l!=="string"&&ch(d=r.toString)&&!is(g=Us(d,r)))return g;throw _I("Can't convert object to primitive value")},Sv=TypeError,jr=qe("toPrimitive"),Yr=function(r,l){if(!uh(r)||vu(r))return r;var d,g=Cv(r,jr);if(g){if(l===void 0&&(l="default"),d=n1(g,r,l),!uh(d)||vu(d))return d;throw Sv("Can't convert object to primitive value")}return l===void 0&&(l="number"),yI(r,l)},vr=Yr,Gr=bt,Br=function(r){var l=vr(r,"string");return Gr(l)?l:l+""},dh=jo,II=sc,_u=xi,hh=Gt,Ev=Br,bI=TypeError,fh=Object.defineProperty,CI=Object.getOwnPropertyDescriptor,ph="enumerable",Xi="configurable",yp="writable";Vr.f=dh?_u?function(r,l,d){if(hh(r),l=Ev(l),hh(d),typeof r=="function"&&l==="prototype"&&"value"in d&&yp in d&&!d[yp]){var g=CI(r,l);g&&g[yp]&&(r[l]=d.value,d={configurable:Xi in d?d[Xi]:g[Xi],enumerable:ph in d?d[ph]:g[ph],writable:!1})}return fh(r,l,d)}:fh:function(r,l,d){if(hh(r),l=Ev(l),hh(d),II)try{return fh(r,l,d)}catch{}if("get"in d||"set"in d)throw bI("Accessors not supported");return"value"in d&&(r[l]=d.value),r};var SI=Math.ceil,pr=Math.floor,mh=Math.trunc||function(r){var l=+r;return(l>0?pr:SI)(l)},EI=mh,Pa=function(r){var l=+r;return l!=l||l===0?0:EI(l)},Tv=Pa,lc=Math.max,TI=Math.min,gh=function(r,l){var d=Tv(r);return d<0?lc(d+l,0):TI(d,l)},br=Pa,MI=Math.min,vl=function(r){return r>0?MI(br(r),9007199254740991):0},_l=vl,St=function(r){return _l(r.length)},Zi=O,yu=gh,Iu=St,bu=function(r){return function(l,d,g){var C,A=Zi(l),L=Iu(A),B=yu(g,L);if(r&&d!=d){for(;L>B;)if((C=A[B++])!=C)return!0}else for(;L>B;B++)if((r||B in A)&&A[B]===d)return r||B||0;return!r&&-1}},Ip={includes:bu(!0),indexOf:bu(!1)},xa={},ai=Le,yl=O,bp=Ip.indexOf,kI=xa,Il=b([].push),Mv=function(r,l){var d,g=yl(r),C=0,A=[];for(d in g)!ai(kI,d)&&ai(g,d)&&Il(A,d);for(;l.length>C;)ai(g,d=l[C++])&&(~bp(A,d)||Il(A,d));return A},Cp=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Sp=Mv,Ua=Cp,kv=Object.keys||function(r){return Sp(r,Ua)},Cu=jo,Ep=xi,vh=Vr,wv=Gt,Rv=O,wI=kv;Ho.f=Cu&&!Ep?Object.defineProperties:function(r,l){wv(r);for(var d,g=Rv(l),C=wI(l),A=C.length,L=0;A>L;)vh.f(r,d=C[L++],g[d]);return r};var Fs,Su=wt("document","documentElement"),Kt=Re,ln=oe("keys"),De=function(r){return ln[r]||(ln[r]=Kt(r))},Tp=Gt,Fi=Ho,Mp=Cp,Vs=xa,RI=Su,_h=gl,bl="prototype",Dt="script",Bn=De("IE_PROTO"),zn=function(){},ao=function(r){return"<"+Dt+">"+r+"</"+Dt+">"},Av=function(r){r.write(ao("")),r.close();var l=r.parentWindow.Object;return r=null,l},kp=function(){try{Fs=new ActiveXObject("htmlfile")}catch{}var r,l,d;kp=typeof document<"u"?document.domain&&Fs?Av(Fs):(l=_h("iframe"),d="java"+Dt+":",l.style.display="none",RI.appendChild(l),l.src=String(d),(r=l.contentWindow.document).open(),r.write(ao("document.F=Object")),r.close(),r.F):Av(Fs);for(var g=Mp.length;g--;)delete kp[bl][Mp[g]];return kp()};Vs[Bn]=!0;var po=Object.create||function(r,l){var d;return r!==null?(zn[bl]=Tp(r),d=new zn,zn[bl]=null,d[Bn]=r):d=kp(),l===void 0?d:Fi.f(d,l)},Je=qe,cc=po,$o=Vr.f,de=Je("unscopables"),yh=Array.prototype;yh[de]==null&&$o(yh,de,{configurable:!0,value:cc(null)});var Eu,as,Gs,uc=function(r){yh[de][r]=!0},Fa={},Si=Nt,dc=J.WeakMap,Ih=Si(dc)&&/native code/.test(String(dc)),ss=function(r,l){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:l}},o1=Vr,r1=ss,ls=jo?function(r,l,d){return o1.f(r,l,r1(1,d))}:function(r,l,d){return r[l]=d,r},i1=Ih,ct=J,Dv=io,wp=ls,Tu=Le,Xo=ye,Rp=De,Mu=xa,hc="Object already initialized",ku=ct.TypeError,Ov=ct.WeakMap;if(i1||Xo.state){var Qi=Xo.state||(Xo.state=new Ov);Qi.get=Qi.get,Qi.has=Qi.has,Qi.set=Qi.set,Eu=function(r,l){if(Qi.has(r))throw ku(hc);return l.facade=r,Qi.set(r,l),l},as=function(r){return Qi.get(r)||{}},Gs=function(r){return Qi.has(r)}}else{var wu=Rp("state");Mu[wu]=!0,Eu=function(r,l){if(Tu(r,wu))throw ku(hc);return l.facade=r,wp(r,wu,l),l},as=function(r){return Tu(r,wu)?r[wu]:{}},Gs=function(r){return Tu(r,wu)}}var pi={set:Eu,get:as,has:Gs,enforce:function(r){return Gs(r)?as(r):Eu(r,{})},getterFor:function(r){return function(l){var d;if(!Dv(l)||(d=as(l)).type!==r)throw ku("Incompatible receiver, "+r+" required");return d}}},bh={},Ap={},Ch={}.propertyIsEnumerable,Dp=Object.getOwnPropertyDescriptor,Op=Dp&&!Ch.call({1:2},1);Ap.f=Op?function(r){var l=Dp(this,r);return!!l&&l.enumerable}:Ch;var Lv=jo,AI=It,Lp=Ap,Nv=ss,_r=O,a1=Br,Np=Le,s1=sc,So=Object.getOwnPropertyDescriptor;bh.f=Lv?So:function(r,l){if(r=_r(r),l=a1(l),s1)try{return So(r,l)}catch{}if(Np(r,l))return Nv(!AI(Lp.f,r,l),r[l])};var Pp={},xp={get exports(){return Pp},set exports(r){Pp=r}},Sh=jo,DI=Le,Pv=Function.prototype,Up=Sh&&Object.getOwnPropertyDescriptor,xv=DI(Pv,"name"),Eh={EXISTS:xv,PROPER:xv&&(function(){}).name==="something",CONFIGURABLE:xv&&(!Sh||Sh&&Up(Pv,"name").configurable)},Th=Nt,Mh=ye,l1=b(Function.toString);Th(Mh.inspectSource)||(Mh.inspectSource=function(r){return l1(r)});var fa=Mh.inspectSource,fc=b,OI=c,c1=Nt,Fp=Le,Uv=jo,u1=Eh.CONFIGURABLE,d1=fa,h1=pi.enforce,f1=pi.get,LI=String,kh=Object.defineProperty,p1=fc("".slice),m1=fc("".replace),g1=fc([].join),v1=Uv&&!OI(function(){return kh(function(){},"length",{value:8}).length!==8}),_1=String(String).split("String"),y1=xp.exports=function(r,l,d){p1(LI(l),0,7)==="Symbol("&&(l="["+m1(LI(l),/^Symbol\(([^)]*)\)/,"$1")+"]"),d&&d.getter&&(l="get "+l),d&&d.setter&&(l="set "+l),(!Fp(r,"name")||u1&&r.name!==l)&&(Uv?kh(r,"name",{value:l,configurable:!0}):r.name=l),v1&&d&&Fp(d,"arity")&&r.length!==d.arity&&kh(r,"length",{value:d.arity});try{d&&Fp(d,"constructor")&&d.constructor?Uv&&kh(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var g=h1(r);return Fp(g,"source")||(g.source=g1(_1,typeof l=="string"?l:"")),r};Function.prototype.toString=y1(function(){return c1(this)&&f1(this).source||d1(this)},"toString");var I1=Nt,b1=Vr,C1=Pp,S1=he,pa=function(r,l,d,g){g||(g={});var C=g.enumerable,A=g.name!==void 0?g.name:l;if(I1(d)&&C1(d,A,g),g.global)C?r[l]=d:S1(l,d);else{try{g.unsafe?r[l]&&(C=!0):delete r[l]}catch{}C?r[l]=d:b1.f(r,l,{value:d,enumerable:!1,configurable:!g.nonConfigurable,writable:!g.nonWritable})}return r},Ru={},E1=Mv,T1=Cp.concat("length","prototype");Ru.f=Object.getOwnPropertyNames||function(r){return E1(r,T1)};var Fv={};Fv.f=Object.getOwnPropertySymbols;var pc,NI,PI,Vp=wt,Gp=Ru,Bp=Fv,Hp=Gt,$p=b([].concat),qp=Vp("Reflect","ownKeys")||function(r){var l=Gp.f(Hp(r)),d=Bp.f;return d?$p(l,d(r)):l},Vv=Le,M1=qp,k1=bh,w1=Vr,Kp=function(r,l,d){for(var g=M1(l),C=w1.f,A=k1.f,L=0;L<g.length;L++){var B=g[L];Vv(r,B)||d&&Vv(d,B)||C(r,B,A(l,B))}},Gv=c,R1=Nt,zp=/#|\.prototype\./,Au=function(r,l){var d=A1[xI(r)];return d==O1||d!=D1&&(R1(l)?Gv(l):!!l)},xI=Au.normalize=function(r){return String(r).replace(zp,".").toLowerCase()},A1=Au.data={},D1=Au.NATIVE="N",O1=Au.POLYFILL="P",Bv=Au,Hv=J,L1=bh.f,N1=ls,Wp=pa,UI=he,P1=Kp,x1=Bv,Cr=function(r,l){var d,g,C,A,L,B=r.target,U=r.global,Z=r.stat;if(d=U?Hv:Z?Hv[B]||UI(B,{}):(Hv[B]||{}).prototype)for(g in l){if(A=l[g],C=r.dontCallGetSet?(L=L1(d,g))&&L.value:d[g],!x1(U?g:B+(Z?".":"#")+g,r.forced)&&C!==void 0){if(typeof A==typeof C)continue;P1(A,C)}(r.sham||C&&C.sham)&&N1(A,"sham",!0),Wp(d,g,A,r)}},U1=!c(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),F1=Le,V1=Nt,jp=Oe,Yp=U1,wh=De("IE_PROTO"),Du=Object,Jp=Du.prototype,mc=Yp?Du.getPrototypeOf:function(r){var l=jp(r);if(F1(l,wh))return l[wh];var d=l.constructor;return V1(d)&&l instanceof d?d.prototype:l instanceof Du?Jp:null},Xp=c,$v=Nt,G1=io,FI=mc,qv=pa,Kv=qe("iterator"),Rh=!1;[].keys&&("next"in(PI=[].keys())?(NI=FI(FI(PI)))!==Object.prototype&&(pc=NI):Rh=!0);var B1=!G1(pc)||Xp(function(){var r={};return pc[Kv].call(r)!==r});B1&&(pc={}),$v(pc[Kv])||qv(pc,Kv,function(){return this});var zv={IteratorPrototype:pc,BUGGY_SAFARI_ITERATORS:Rh},H1=Vr.f,Ou=Le,Zp=qe("toStringTag"),Va=function(r,l,d){r&&!d&&(r=r.prototype),r&&!Ou(r,Zp)&&H1(r,Zp,{configurable:!0,value:l})},$1=zv.IteratorPrototype,Wv=po,q1=ss,K1=Va,z1=Fa,W1=function(){return this},VI=function(r,l,d,g){var C=l+" Iterator";return r.prototype=Wv($1,{next:q1(+!g,d)}),K1(r,C,!1),z1[C]=W1,r},j1=b,GI=Ar,jv=Nt,BI=String,Qp=TypeError,Y1=function(r,l,d){try{return j1(GI(Object.getOwnPropertyDescriptor(r,l)[d]))}catch{}},em=Gt,Yv=function(r){if(typeof r=="object"||jv(r))return r;throw Qp("Can't set "+BI(r)+" as a prototype")},Lu=Object.setPrototypeOf||("__proto__"in{}?function(){var r,l=!1,d={};try{(r=Y1(Object.prototype,"__proto__","set"))(d,[]),l=d instanceof Array}catch{}return function(g,C){return em(g),Yv(C),l?r(g,C):g.__proto__=C,g}}():void 0),J1=Cr,X1=It,Z1=Nt,Q1=VI,HI=mc,$I=Lu,eM=Va,tM=ls,Jv=pa,qI=Fa,nM=Eh.PROPER,Xv=Eh.CONFIGURABLE,KI=zv.IteratorPrototype,Ah=zv.BUGGY_SAFARI_ITERATORS,Dh=qe("iterator"),zI="keys",Oh="values",WI="entries",oM=function(){return this},jI=function(r,l,d,g,C,A,L){Q1(d,l,g);var B,U,Z,ae=function(Wt){if(Wt===C&&Ct)return Ct;if(!Ah&&Wt in Pe)return Pe[Wt];switch(Wt){case zI:case Oh:case WI:return function(){return new d(this,Wt)}}return function(){return new d(this)}},ce=l+" Iterator",we=!1,Pe=r.prototype,Ze=Pe[Dh]||Pe["@@iterator"]||C&&Pe[C],Ct=!Ah&&Ze||ae(C),Bt=l=="Array"&&Pe.entries||Ze;if(Bt&&(B=HI(Bt.call(new r)))!==Object.prototype&&B.next&&(HI(B)!==KI&&($I?$I(B,KI):Z1(B[Dh])||Jv(B,Dh,oM)),eM(B,ce,!0)),nM&&C==Oh&&Ze&&Ze.name!==Oh&&(Xv?tM(Pe,"name",Oh):(we=!0,Ct=function(){return X1(Ze,this)})),C)if(U={values:ae(Oh),keys:A?Ct:ae(zI),entries:ae(WI)},L)for(Z in U)(Ah||we||!(Z in Pe))&&Jv(Pe,Z,U[Z]);else J1({target:l,proto:!0,forced:Ah||we},U);return Pe[Dh]!==Ct&&Jv(Pe,Dh,Ct,{name:C}),qI[l]=Ct,U},YI=function(r,l){return{value:r,done:l}},rM=O,Zv=uc,JI=Fa,XI=pi,iM=Vr.f,aM=jI,ZI=YI,sM=jo,QI="Array Iterator",lM=XI.set,cM=XI.getterFor(QI),uM=aM(Array,"Array",function(r,l){lM(this,{type:QI,target:rM(r),index:0,kind:l})},function(){var r=cM(this),l=r.target,d=r.kind,g=r.index++;return!l||g>=l.length?(r.target=void 0,ZI(void 0,!0)):ZI(d=="keys"?g:d=="values"?l[g]:[g,l[g]],!1)},"values"),Ei=JI.Arguments=JI.Array;if(Zv("keys"),Zv("values"),Zv("entries"),sM&&Ei.name!=="values")try{iM(Ei,"name",{value:"values"})}catch{}var eb={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ao=gl("span").classList,Lh=Ao&&Ao.constructor&&Ao.constructor.prototype,Nh=Lh===Object.prototype?void 0:Lh,Ph=J,xh=eb,tm=Nh,Cl=uM,Nu=ls,Uh=qe,Pu=Uh("iterator"),Fh=Uh("toStringTag"),xu=Cl.values,nm=function(r,l){if(r){if(r[Pu]!==xu)try{Nu(r,Pu,xu)}catch{r[Pu]=xu}if(r[Fh]||Nu(r,Fh,l),xh[l]){for(var d in Cl)if(r[d]!==Cl[d])try{Nu(r,d,Cl[d])}catch{r[d]=Cl[d]}}}};for(var ma in xh)nm(Ph[ma]&&Ph[ma].prototype,ma);nm(tm,"DOMTokenList");var Bs=typeof process<"u"&&R(process)=="process",tb=Pp,dM=Vr,gc=function(r,l,d){return d.get&&tb(d.get,l,{getter:!0}),d.set&&tb(d.set,l,{setter:!0}),dM.f(r,l,d)},hM=wt,fM=gc,nb=jo,ob=qe("species"),Vh=function(r){var l=hM(r);nb&&l&&!l[ob]&&fM(l,ob,{configurable:!0,get:function(){return this}})},rb=zr,ib=TypeError,Uu=function(r,l){if(rb(l,r))return r;throw ib("Incorrect invocation")},om={};om[qe("toStringTag")]="z";var Qv=String(om)==="[object z]",ab=Nt,Gh=R,Fu=qe("toStringTag"),sb=Object,lb=Gh(function(){return arguments}())=="Arguments",ga=Qv?Gh:function(r){var l,d,g;return r===void 0?"Undefined":r===null?"Null":typeof(d=function(C,A){try{return C[A]}catch{}}(l=sb(r),Fu))=="string"?d:lb?Gh(l):(g=Gh(l))=="Object"&&ab(l.callee)?"Arguments":g},Sl=b,pM=c,cb=Nt,mM=ga,Sr=fa,rm=function(){},ub=[],El=wt("Reflect","construct"),Bh=/^\s*(?:class|function)\b/,Vu=Sl(Bh.exec),gM=!Bh.exec(rm),Hh=function(r){if(!cb(r))return!1;try{return El(rm,ub,r),!0}catch{return!1}},Hs=function(r){if(!cb(r))return!1;switch(mM(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return gM||!!Vu(Bh,Sr(r))}catch{return!0}};Hs.sham=!0;var Tl,Ml,im,e_,t_=!El||pM(function(){var r;return Hh(Hh.call)||!Hh(Object)||!Hh(function(){r=!0})||r})?Hs:Hh,vM=t_,_M=hn,yM=TypeError,db=function(r){if(vM(r))return r;throw yM(_M(r)+" is not a constructor")},hb=Gt,IM=db,bM=P,am=qe("species"),vc=function(r,l){var d,g=hb(r).constructor;return g===void 0||bM(d=hb(g)[am])?l:IM(d)},cr=u,n=Function.prototype,a=n.apply,s=n.call,h=typeof Reflect=="object"&&Reflect.apply||(cr?s.bind(a):function(){return s.apply(a,arguments)}),m=R,I=b,T=function(r){if(m(r)==="Function")return I(r)},D=Ar,V=u,$=T(T.bind),q=function(r,l){return D(r),l===void 0?r:V?$(r,l):function(){return r.apply(l,arguments)}},se=b([].slice),me=TypeError,fe=function(r,l){if(r<l)throw me("Not enough arguments");return r},He=/(?:ipad|iphone|ipod).*applewebkit/i.test(Ke),Xe=J,Ye=h,Lt=q,yt=Nt,rn=Le,on=c,Pn=Su,Gn=se,Jn=gl,qo=fe,ko=He,yo=Bs,Ko=Xe.setImmediate,$s=Xe.clearImmediate,Po=Xe.process,tr=Xe.Dispatch,Dr=Xe.Function,Xn=Xe.MessageChannel,Qn=Xe.String,Ga=0,Yo={},Ba="onreadystatechange";on(function(){Tl=Xe.location});var ti=function(r){if(rn(Yo,r)){var l=Yo[r];delete Yo[r],l()}},n_=function(r){return function(){ti(r)}},Or=function(r){ti(r.data)},mi=function(r){Xe.postMessage(Qn(r),Tl.protocol+"//"+Tl.host)};Ko&&$s||(Ko=function(r){qo(arguments.length,1);var l=yt(r)?r:Dr(r),d=Gn(arguments,1);return Yo[++Ga]=function(){Ye(l,void 0,d)},Ml(Ga),Ga},$s=function(r){delete Yo[r]},yo?Ml=function(r){Po.nextTick(n_(r))}:tr&&tr.now?Ml=function(r){tr.now(n_(r))}:Xn&&!ko?(e_=(im=new Xn).port2,im.port1.onmessage=Or,Ml=Lt(e_.postMessage,e_)):Xe.addEventListener&&yt(Xe.postMessage)&&!Xe.importScripts&&Tl&&Tl.protocol!=="file:"&&!on(mi)?(Ml=mi,Xe.addEventListener("message",Or,!1)):Ml=Ba in Jn("script")?function(r){Pn.appendChild(Jn("script"))[Ba]=function(){Pn.removeChild(this),ti(r)}}:function(r){setTimeout(n_(r),0)});var qs={set:Ko,clear:$s},Gu=function(){this.head=null,this.tail=null};Gu.prototype={add:function(r){var l={item:r,next:null},d=this.tail;d?d.next=l:this.head=l,this.tail=l},get:function(){var r=this.head;if(r)return(this.head=r.next)===null&&(this.tail=null),r.item}};var Do,nr,sm,_c,o_,lm=Gu,fb=/ipad|iphone|ipod/i.test(Ke)&&typeof Pebble<"u",kl=/web0s(?!.*chrome)/i.test(Ke),va=J,Lr=q,or=bh.f,$h=qs.set,r_=lm,pb=He,mb=fb,rj=kl,CM=Bs,E2=va.MutationObserver||va.WebKitMutationObserver,T2=va.document,M2=va.process,gb=va.Promise,k2=or(va,"queueMicrotask"),SM=k2&&k2.value;if(!SM){var vb=new r_,_b=function(){var r,l;for(CM&&(r=M2.domain)&&r.exit();l=vb.get();)try{l()}catch(d){throw vb.head&&Do(),d}r&&r.enter()};pb||CM||rj||!E2||!T2?!mb&&gb&&gb.resolve?((_c=gb.resolve(void 0)).constructor=gb,o_=Lr(_c.then,_c),Do=function(){o_(_b)}):CM?Do=function(){M2.nextTick(_b)}:($h=Lr($h,va),Do=function(){$h(_b)}):(nr=!0,sm=T2.createTextNode(""),new E2(_b).observe(sm,{characterData:!0}),Do=function(){sm.data=nr=!nr}),SM=function(r){vb.head||Do(),vb.add(r)}}var ij=SM,EM=function(r){try{return{error:!1,value:r()}}catch(l){return{error:!0,value:l}}},i_=J.Promise,w2=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",aj=!w2&&!Bs&&typeof window=="object"&&typeof document=="object",sj=J,a_=i_,lj=Nt,cj=Bv,uj=fa,dj=qe,hj=aj,fj=w2,TM=ft;a_&&a_.prototype;var pj=dj("species"),R2=!1,A2=lj(sj.PromiseRejectionEvent),mj=cj("Promise",function(){var r=uj(a_),l=r!==String(a_);if(!l&&TM===66)return!0;if(!TM||TM<51||!/native code/.test(r)){var d=new a_(function(C){C(1)}),g=function(C){C(function(){},function(){})};if((d.constructor={})[pj]=g,!(R2=d.then(function(){})instanceof g))return!0}return!l&&(hj||fj)&&!A2}),qh={CONSTRUCTOR:mj,REJECTION_EVENT:A2,SUBCLASSING:R2},cm={},D2=Ar,gj=TypeError,vj=function(r){var l,d;this.promise=new r(function(g,C){if(l!==void 0||d!==void 0)throw gj("Bad Promise constructor");l=g,d=C}),this.resolve=D2(l),this.reject=D2(d)};cm.f=function(r){return new vj(r)};var MM,O2,L2,_j=Cr,yb=Bs,Bu=J,um=It,N2=pa,P2=Lu,yj=Va,Ij=Vh,bj=Ar,Ib=Nt,Cj=io,Sj=Uu,Ej=vc,x2=qs.set,kM=ij,Tj=function(r,l){try{arguments.length==1?console.error(r):console.error(r,l)}catch{}},Mj=EM,kj=lm,U2=pi,bb=i_,F2=cm,Cb="Promise",V2=qh.CONSTRUCTOR,wj=qh.REJECTION_EVENT,Rj=qh.SUBCLASSING,wM=U2.getterFor(Cb),Aj=U2.set,dm=bb&&bb.prototype,hm=bb,Sb=dm,G2=Bu.TypeError,RM=Bu.document,AM=Bu.process,DM=F2.f,Dj=DM,Oj=!!(RM&&RM.createEvent&&Bu.dispatchEvent),B2="unhandledrejection",H2=function(r){var l;return!(!Cj(r)||!Ib(l=r.then))&&l},$2=function(r,l){var d,g,C,A=l.value,L=l.state==1,B=L?r.ok:r.fail,U=r.resolve,Z=r.reject,ae=r.domain;try{B?(L||(l.rejection===2&&Nj(l),l.rejection=1),B===!0?d=A:(ae&&ae.enter(),d=B(A),ae&&(ae.exit(),C=!0)),d===r.promise?Z(G2("Promise-chain cycle")):(g=H2(d))?um(g,d,U,Z):U(d)):Z(A)}catch(ce){ae&&!C&&ae.exit(),Z(ce)}},q2=function(r,l){r.notified||(r.notified=!0,kM(function(){for(var d,g=r.reactions;d=g.get();)$2(d,r);r.notified=!1,l&&!r.rejection&&Lj(r)}))},K2=function(r,l,d){var g,C;Oj?((g=RM.createEvent("Event")).promise=l,g.reason=d,g.initEvent(r,!1,!0),Bu.dispatchEvent(g)):g={promise:l,reason:d},!wj&&(C=Bu["on"+r])?C(g):r===B2&&Tj("Unhandled promise rejection",d)},Lj=function(r){um(x2,Bu,function(){var l,d=r.facade,g=r.value;if(z2(r)&&(l=Mj(function(){yb?AM.emit("unhandledRejection",g,d):K2(B2,d,g)}),r.rejection=yb||z2(r)?2:1,l.error))throw l.value})},z2=function(r){return r.rejection!==1&&!r.parent},Nj=function(r){um(x2,Bu,function(){var l=r.facade;yb?AM.emit("rejectionHandled",l):K2("rejectionhandled",l,r.value)})},fm=function(r,l,d){return function(g){r(l,g,d)}},pm=function(r,l,d){r.done||(r.done=!0,d&&(r=d),r.value=l,r.state=2,q2(r,!0))},OM=function(r,l,d){if(!r.done){r.done=!0,d&&(r=d);try{if(r.facade===l)throw G2("Promise can't be resolved itself");var g=H2(l);g?kM(function(){var C={done:!1};try{um(g,l,fm(OM,C,r),fm(pm,C,r))}catch(A){pm(C,A,r)}}):(r.value=l,r.state=1,q2(r,!1))}catch(C){pm({done:!1},C,r)}}};if(V2&&(Sb=(hm=function(r){Sj(this,Sb),bj(r),um(MM,this);var l=wM(this);try{r(fm(OM,l),fm(pm,l))}catch(d){pm(l,d)}}).prototype,(MM=function(r){Aj(this,{type:Cb,done:!1,notified:!1,parent:!1,reactions:new kj,rejection:!1,state:0,value:void 0})}).prototype=N2(Sb,"then",function(r,l){var d=wM(this),g=DM(Ej(this,hm));return d.parent=!0,g.ok=!Ib(r)||r,g.fail=Ib(l)&&l,g.domain=yb?AM.domain:void 0,d.state==0?d.reactions.add(g):kM(function(){$2(g,d)}),g.promise}),O2=function(){var r=new MM,l=wM(r);this.promise=r,this.resolve=fm(OM,l),this.reject=fm(pm,l)},F2.f=DM=function(r){return r===hm||r===void 0?new O2(r):Dj(r)},Ib(bb)&&dm!==Object.prototype)){L2=dm.then,Rj||N2(dm,"then",function(r,l){var d=this;return new hm(function(g,C){um(L2,d,g,C)}).then(r,l)},{unsafe:!0});try{delete dm.constructor}catch{}P2&&P2(dm,Sb)}_j({global:!0,constructor:!0,wrap:!0,forced:V2},{Promise:hm}),yj(hm,Cb,!1),Ij(Cb);var Pj=Fa,xj=qe("iterator"),Uj=Array.prototype,LM=function(r){return r!==void 0&&(Pj.Array===r||Uj[xj]===r)},Fj=ga,W2=et,Vj=P,Gj=Fa,Bj=qe("iterator"),s_=function(r){if(!Vj(r))return W2(r,Bj)||W2(r,"@@iterator")||Gj[Fj(r)]},Hj=It,$j=Ar,qj=Gt,Kj=hn,zj=s_,Wj=TypeError,Eb=function(r,l){var d=arguments.length<2?zj(r):l;if($j(d))return qj(Hj(d,r));throw Wj(Kj(r)+" is not iterable")},jj=It,j2=Gt,Yj=et,Y2=function(r,l,d){var g,C;j2(r);try{if(!(g=Yj(r,"return"))){if(l==="throw")throw d;return d}g=jj(g,r)}catch(A){C=!0,g=A}if(l==="throw")throw d;if(C)throw g;return j2(g),d},Jj=q,Xj=It,Zj=Gt,Qj=hn,eY=LM,tY=St,J2=zr,nY=Eb,oY=s_,X2=Y2,rY=TypeError,Tb=function(r,l){this.stopped=r,this.result=l},Z2=Tb.prototype,Q2=function(r,l,d){var g,C,A,L,B,U,Z,ae=d&&d.that,ce=!(!d||!d.AS_ENTRIES),we=!(!d||!d.IS_RECORD),Pe=!(!d||!d.IS_ITERATOR),Ze=!(!d||!d.INTERRUPTED),Ct=Jj(l,ae),Bt=function(kt){return g&&X2(g,"normal",kt),new Tb(!0,kt)},Wt=function(kt){return ce?(Zj(kt),Ze?Ct(kt[0],kt[1],Bt):Ct(kt[0],kt[1])):Ze?Ct(kt,Bt):Ct(kt)};if(we)g=r.iterator;else if(Pe)g=r;else{if(!(C=oY(r)))throw rY(Qj(r)+" is not iterable");if(eY(C)){for(A=0,L=tY(r);L>A;A++)if((B=Wt(r[A]))&&J2(Z2,B))return B;return new Tb(!1)}g=nY(r,C)}for(U=we?r.next:g.next;!(Z=Xj(U,g)).done;){try{B=Wt(Z.value)}catch(kt){X2(g,"throw",kt)}if(typeof B=="object"&&B&&J2(Z2,B))return B}return new Tb(!1)},eP=qe("iterator"),tP=!1;try{var iY=0,nP={next:function(){return{done:!!iY++}},return:function(){tP=!0}};nP[eP]=function(){return this},Array.from(nP,function(){throw 2})}catch{}var oP=function(r,l){if(!l&&!tP)return!1;var d=!1;try{var g={};g[eP]=function(){return{next:function(){return{done:d=!0}}}},r(g)}catch{}return d},aY=i_,rP=qh.CONSTRUCTOR||!oP(function(r){aY.all(r).then(void 0,function(){})}),sY=It,lY=Ar,cY=cm,uY=EM,dY=Q2;Cr({target:"Promise",stat:!0,forced:rP},{all:function(r){var l=this,d=cY.f(l),g=d.resolve,C=d.reject,A=uY(function(){var L=lY(l.resolve),B=[],U=0,Z=1;dY(r,function(ae){var ce=U++,we=!1;Z++,sY(L,l,ae).then(function(Pe){we||(we=!0,B[ce]=Pe,--Z||g(B))},C)}),--Z||g(B)});return A.error&&C(A.value),d.promise}});var hY=Cr,fY=qh.CONSTRUCTOR,NM=i_,pY=wt,mY=Nt,gY=pa,iP=NM&&NM.prototype;if(hY({target:"Promise",proto:!0,forced:fY,real:!0},{catch:function(r){return this.then(void 0,r)}}),mY(NM)){var aP=pY("Promise").prototype.catch;iP.catch!==aP&&gY(iP,"catch",aP,{unsafe:!0})}var vY=It,_Y=Ar,yY=cm,IY=EM,bY=Q2;Cr({target:"Promise",stat:!0,forced:rP},{race:function(r){var l=this,d=yY.f(l),g=d.reject,C=IY(function(){var A=_Y(l.resolve);bY(r,function(L){vY(A,l,L).then(d.resolve,g)})});return C.error&&g(C.value),d.promise}});var CY=It,SY=cm;Cr({target:"Promise",stat:!0,forced:qh.CONSTRUCTOR},{reject:function(r){var l=SY.f(this);return CY(l.reject,void 0,r),l.promise}});var EY=Gt,TY=io,MY=cm,sP=function(r,l){if(EY(r),TY(l)&&l.constructor===r)return l;var d=MY.f(r);return(0,d.resolve)(l),d.promise},kY=Cr,wY=qh.CONSTRUCTOR,RY=sP;wt("Promise"),kY({target:"Promise",stat:!0,forced:wY},{resolve:function(r){return RY(this,r)}});var AY=Nt,DY=io,lP=Lu,cP=function(r,l,d){var g,C;return lP&&AY(g=l.constructor)&&g!==d&&DY(C=g.prototype)&&C!==d.prototype&&lP(r,C),r},OY=io,LY=R,NY=qe("match"),uP=function(r){var l;return OY(r)&&((l=r[NY])!==void 0?!!l:LY(r)=="RegExp")},PY=ga,xY=String,Ha=function(r){if(PY(r)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return xY(r)},UY=Gt,dP=function(){var r=UY(this),l="";return r.hasIndices&&(l+="d"),r.global&&(l+="g"),r.ignoreCase&&(l+="i"),r.multiline&&(l+="m"),r.dotAll&&(l+="s"),r.unicode&&(l+="u"),r.unicodeSets&&(l+="v"),r.sticky&&(l+="y"),l},FY=It,VY=Le,GY=zr,BY=dP,hP=RegExp.prototype,fP=function(r){var l=r.flags;return l!==void 0||"flags"in hP||VY(r,"flags")||!GY(hP,r)?l:FY(BY,r)},PM=c,xM=J.RegExp,UM=PM(function(){var r=xM("a","y");return r.lastIndex=2,r.exec("abcd")!=null}),HY=UM||PM(function(){return!xM("a","y").sticky}),$Y=UM||PM(function(){var r=xM("^r","gy");return r.lastIndex=2,r.exec("str")!=null}),pP={BROKEN_CARET:$Y,MISSED_STICKY:HY,UNSUPPORTED_Y:UM},qY=Vr.f,KY=c,zY=J.RegExp,mP=KY(function(){var r=zY(".","s");return!(r.dotAll&&r.exec(`
`)&&r.flags==="s")}),WY=c,jY=J.RegExp,gP=WY(function(){var r=jY("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),YY=jo,FM=J,l_=b,JY=Bv,XY=cP,ZY=ls,QY=Ru.f,vP=zr,eJ=uP,_P=Ha,tJ=fP,yP=pP,nJ=function(r,l,d){d in r||qY(r,d,{configurable:!0,get:function(){return l[d]},set:function(g){l[d]=g}})},oJ=pa,rJ=c,iJ=Le,aJ=pi.enforce,sJ=Vh,IP=mP,bP=gP,lJ=qe("match"),Hu=FM.RegExp,mm=Hu.prototype,cJ=FM.SyntaxError,uJ=l_(mm.exec),Mb=l_("".charAt),CP=l_("".replace),SP=l_("".indexOf),dJ=l_("".slice),hJ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Kh=/a/g,VM=/a/g,fJ=new Hu(Kh)!==Kh,EP=yP.MISSED_STICKY,pJ=yP.UNSUPPORTED_Y,mJ=YY&&(!fJ||EP||IP||bP||rJ(function(){return VM[lJ]=!1,Hu(Kh)!=Kh||Hu(VM)==VM||Hu(Kh,"i")!="/a/i"}));if(JY("RegExp",mJ)){for(var zh=function(r,l){var d,g,C,A,L,B,U=vP(mm,this),Z=eJ(r),ae=l===void 0,ce=[],we=r;if(!U&&Z&&ae&&r.constructor===zh)return r;if((Z||vP(mm,r))&&(r=r.source,ae&&(l=tJ(we))),r=r===void 0?"":_P(r),l=l===void 0?"":_P(l),we=r,IP&&"dotAll"in Kh&&(g=!!l&&SP(l,"s")>-1)&&(l=CP(l,/s/g,"")),d=l,EP&&"sticky"in Kh&&(C=!!l&&SP(l,"y")>-1)&&pJ&&(l=CP(l,/y/g,"")),bP&&(A=function(Pe){for(var Ze,Ct=Pe.length,Bt=0,Wt="",kt=[],En={},Ln=!1,Hn=!1,Zo=0,ir="";Bt<=Ct;Bt++){if((Ze=Mb(Pe,Bt))==="\\")Ze+=Mb(Pe,++Bt);else if(Ze==="]")Ln=!1;else if(!Ln)switch(!0){case Ze==="[":Ln=!0;break;case Ze==="(":uJ(hJ,dJ(Pe,Bt+1))&&(Bt+=2,Hn=!0),Wt+=Ze,Zo++;continue;case(Ze===">"&&Hn):if(ir===""||iJ(En,ir))throw new cJ("Invalid capture group name");En[ir]=!0,kt[kt.length]=[ir,Zo],Hn=!1,ir="";continue}Hn?ir+=Ze:Wt+=Ze}return[Wt,kt]}(r),r=A[0],ce=A[1]),L=XY(Hu(r,l),U?this:mm,zh),(g||C||ce.length)&&(B=aJ(L),g&&(B.dotAll=!0,B.raw=zh(function(Pe){for(var Ze,Ct=Pe.length,Bt=0,Wt="",kt=!1;Bt<=Ct;Bt++)(Ze=Mb(Pe,Bt))!=="\\"?kt||Ze!=="."?(Ze==="["?kt=!0:Ze==="]"&&(kt=!1),Wt+=Ze):Wt+="[\\s\\S]":Wt+=Ze+Mb(Pe,++Bt);return Wt}(r),d)),C&&(B.sticky=!0),ce.length&&(B.groups=ce)),r!==we)try{ZY(L,"source",we===""?"(?:)":we)}catch{}return L},TP=QY(Hu),MP=0;TP.length>MP;)nJ(zh,Hu,TP[MP++]);mm.constructor=zh,zh.prototype=mm,oJ(FM,"RegExp",zh,{constructor:!0})}sJ("RegExp");var gm=It,kb=b,gJ=Ha,vJ=dP,_J=pP,yJ=po,IJ=pi.get,bJ=mP,CJ=gP,SJ=oe("native-string-replace",String.prototype.replace),wb=RegExp.prototype.exec,GM=wb,EJ=kb("".charAt),TJ=kb("".indexOf),MJ=kb("".replace),BM=kb("".slice),HM=function(){var r=/a/,l=/b*/g;return gm(wb,r,"a"),gm(wb,l,"a"),r.lastIndex!==0||l.lastIndex!==0}(),kP=_J.BROKEN_CARET,$M=/()??/.exec("")[1]!==void 0;(HM||$M||kP||bJ||CJ)&&(GM=function(r){var l,d,g,C,A,L,B,U=this,Z=IJ(U),ae=gJ(r),ce=Z.raw;if(ce)return ce.lastIndex=U.lastIndex,l=gm(GM,ce,ae),U.lastIndex=ce.lastIndex,l;var we=Z.groups,Pe=kP&&U.sticky,Ze=gm(vJ,U),Ct=U.source,Bt=0,Wt=ae;if(Pe&&(Ze=MJ(Ze,"y",""),TJ(Ze,"g")===-1&&(Ze+="g"),Wt=BM(ae,U.lastIndex),U.lastIndex>0&&(!U.multiline||U.multiline&&EJ(ae,U.lastIndex-1)!==`
`)&&(Ct="(?: "+Ct+")",Wt=" "+Wt,Bt++),d=new RegExp("^(?:"+Ct+")",Ze)),$M&&(d=new RegExp("^"+Ct+"$(?!\\s)",Ze)),HM&&(g=U.lastIndex),C=gm(wb,Pe?d:U,Wt),Pe?C?(C.input=BM(C.input,Bt),C[0]=BM(C[0],Bt),C.index=U.lastIndex,U.lastIndex+=C[0].length):U.lastIndex=0:HM&&C&&(U.lastIndex=U.global?C.index+C[0].length:g),$M&&C&&C.length>1&&gm(SJ,C[0],d,function(){for(A=1;A<arguments.length-2;A++)arguments[A]===void 0&&(C[A]=void 0)}),C&&we)for(C.groups=L=yJ(null),A=0;A<we.length;A++)L[(B=we[A])[0]]=C[B[1]];return C});var Rb=GM;Cr({target:"RegExp",proto:!0,forced:/./.exec!==Rb},{exec:Rb});var kJ=R,wP=Array.isArray||function(r){return kJ(r)=="Array"},RP=wP,wJ=t_,RJ=io,AJ=qe("species"),AP=Array,DJ=function(r){var l;return RP(r)&&(l=r.constructor,(wJ(l)&&(l===AP||RP(l.prototype))||RJ(l)&&(l=l[AJ])===null)&&(l=void 0)),l===void 0?AP:l},OJ=q,LJ=x,NJ=Oe,PJ=St,xJ=function(r,l){return new(DJ(r))(l===0?0:l)},DP=b([].push),$u=function(r){var l=r==1,d=r==2,g=r==3,C=r==4,A=r==6,L=r==7,B=r==5||A;return function(U,Z,ae,ce){for(var we,Pe,Ze=NJ(U),Ct=LJ(Ze),Bt=OJ(Z,ae),Wt=PJ(Ct),kt=0,En=ce||xJ,Ln=l?En(U,Wt):d||L?En(U,0):void 0;Wt>kt;kt++)if((B||kt in Ct)&&(Pe=Bt(we=Ct[kt],kt,Ze),r))if(l)Ln[kt]=Pe;else if(Pe)switch(r){case 3:return!0;case 5:return we;case 6:return kt;case 2:DP(Ln,we)}else switch(r){case 4:return!1;case 7:DP(Ln,we)}return A?-1:g||C?C:Ln}},OP={forEach:$u(0),map:$u(1),filter:$u(2),some:$u(3),every:$u(4),find:$u(5),findIndex:$u(6),filterReject:$u(7)},UJ=c,qM=function(r,l){var d=[][r];return!!d&&UJ(function(){d.call(null,l||function(){return 1},1)})},FJ=OP.forEach,VJ=qM("forEach")?[].forEach:function(r){return FJ(this,r,arguments.length>1?arguments[1]:void 0)},LP=J,NP=eb,GJ=Nh,KM=VJ,BJ=ls,PP=function(r){if(r&&r.forEach!==KM)try{BJ(r,"forEach",KM)}catch{r.forEach=KM}};for(var zM in NP)NP[zM]&&PP(LP[zM]&&LP[zM].prototype);PP(GJ);var HJ=Ar,$J=Oe,qJ=x,KJ=St,zJ=TypeError,xP=function(r){return function(l,d,g,C){HJ(d);var A=$J(l),L=qJ(A),B=KJ(A),U=r?B-1:0,Z=r?-1:1;if(g<2)for(;;){if(U in L){C=L[U],U+=Z;break}if(U+=Z,r?U<0:B<=U)throw zJ("Reduce of empty array with no initial value")}for(;r?U>=0:B>U;U+=Z)U in L&&(C=d(C,L[U],U,A));return C}},WJ={left:xP(!1),right:xP(!0)}.left;Cr({target:"Array",proto:!0,forced:!Bs&&ft>79&&ft<83||!qM("reduce")},{reduce:function(r){var l=arguments.length;return WJ(this,r,l,l>1?arguments[1]:void 0)}});var UP=T,FP=pa,jJ=Rb,VP=c,GP=qe,YJ=GP("species"),BP=RegExp.prototype,WM=b,JJ=Pa,XJ=Ha,ZJ=Y,QJ=WM("".charAt),HP=WM("".charCodeAt),eX=WM("".slice),$P=function(r){return function(l,d){var g,C,A=XJ(ZJ(l)),L=JJ(d),B=A.length;return L<0||L>=B?r?"":void 0:(g=HP(A,L))<55296||g>56319||L+1===B||(C=HP(A,L+1))<56320||C>57343?r?QJ(A,L):g:r?eX(A,L,L+2):C-56320+(g-55296<<10)+65536}},jM={codeAt:$P(!1),charAt:$P(!0)},tX=jM.charAt,YM=b,nX=Oe,oX=Math.floor,JM=YM("".charAt),rX=YM("".replace),XM=YM("".slice),iX=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,aX=/\$([$&'`]|\d{1,2})/g,qP=function(r,l,d,g,C,A){var L=d+r.length,B=g.length,U=aX;return C!==void 0&&(C=nX(C),U=iX),rX(A,U,function(Z,ae){var ce;switch(JM(ae,0)){case"$":return"$";case"&":return r;case"`":return XM(l,0,d);case"'":return XM(l,L);case"<":ce=C[XM(ae,1,-1)];break;default:var we=+ae;if(we===0)return Z;if(we>B){var Pe=oX(we/10);return Pe===0?Z:Pe<=B?g[Pe-1]===void 0?JM(ae,1):g[Pe-1]+JM(ae,1):Z}ce=g[we-1]}return ce===void 0?"":ce})},KP=It,sX=Gt,lX=Nt,cX=R,uX=Rb,dX=TypeError,hX=h,zP=It,Ab=b,fX=function(r,l,d,g){var C=GP(r),A=!VP(function(){var Z={};return Z[C]=function(){return 7},""[r](Z)!=7}),L=A&&!VP(function(){var Z=!1,ae=/a/;return r==="split"&&((ae={}).constructor={},ae.constructor[YJ]=function(){return ae},ae.flags="",ae[C]=/./[C]),ae.exec=function(){return Z=!0,null},ae[C](""),!Z});if(!A||!L||d){var B=UP(/./[C]),U=l(C,""[r],function(Z,ae,ce,we,Pe){var Ze=UP(Z),Ct=ae.exec;return Ct===jJ||Ct===BP.exec?A&&!Pe?{done:!0,value:B(ae,ce,we)}:{done:!0,value:Ze(ce,ae,we)}:{done:!1}});FP(String.prototype,r,U[0]),FP(BP,C,U[1])}},pX=c,mX=Gt,gX=Nt,vX=P,_X=Pa,yX=vl,vm=Ha,IX=Y,bX=function(r,l,d){return l+(d?tX(r,l).length:1)},CX=et,SX=qP,EX=function(r,l){var d=r.exec;if(lX(d)){var g=KP(d,r,l);return g!==null&&sX(g),g}if(cX(r)==="RegExp")return KP(uX,r,l);throw dX("RegExp#exec called on incompatible receiver")},ZM=qe("replace"),TX=Math.max,MX=Math.min,kX=Ab([].concat),QM=Ab([].push),WP=Ab("".indexOf),jP=Ab("".slice),wX=function(r){return r===void 0?r:String(r)},RX="a".replace(/./,"$0")==="$0",YP=!!/./[ZM]&&/./[ZM]("a","$0")==="",AX=!pX(function(){var r=/./;return r.exec=function(){var l=[];return l.groups={a:"7"},l},"".replace(r,"$<a>")!=="7"});fX("replace",function(r,l,d){var g=YP?"$":"$0";return[function(C,A){var L=IX(this),B=vX(C)?void 0:CX(C,ZM);return B?zP(B,C,L,A):zP(l,vm(L),C,A)},function(C,A){var L=mX(this),B=vm(C);if(typeof A=="string"&&WP(A,g)===-1&&WP(A,"$<")===-1){var U=d(l,L,B,A);if(U.done)return U.value}var Z=gX(A);Z||(A=vm(A));var ae=L.global;if(ae){var ce=L.unicode;L.lastIndex=0}for(var we=[];;){var Pe=EX(L,B);if(Pe===null||(QM(we,Pe),!ae))break;vm(Pe[0])===""&&(L.lastIndex=bX(B,yX(L.lastIndex),ce))}for(var Ze="",Ct=0,Bt=0;Bt<we.length;Bt++){for(var Wt=vm((Pe=we[Bt])[0]),kt=TX(MX(_X(Pe.index),B.length),0),En=[],Ln=1;Ln<Pe.length;Ln++)QM(En,wX(Pe[Ln]));var Hn=Pe.groups;if(Z){var Zo=kX([Wt],En,kt,B);Hn!==void 0&&QM(Zo,Hn);var ir=vm(hX(A,void 0,Zo))}else ir=SX(Wt,B,kt,En,Hn,A);kt>=Ct&&(Ze+=jP(B,Ct,kt)+ir,Ct=kt+Wt.length)}return Ze+jP(B,Ct)}]},!AX||!RX||YP);var DX=Ip.includes,OX=uc;Cr({target:"Array",proto:!0,forced:c(function(){return!Array(1).includes()})},{includes:function(r){return DX(this,r,arguments.length>1?arguments[1]:void 0)}}),OX("includes");var LX=Pa,NX=Ha,PX=Y,xX=RangeError,JP=b,UX=vl,XP=Ha,FX=function(r){var l=NX(PX(this)),d="",g=LX(r);if(g<0||g==1/0)throw xX("Wrong number of repetitions");for(;g>0;(g>>>=1)&&(l+=l))1&g&&(d+=l);return d},VX=Y,GX=JP(FX),BX=JP("".slice),HX=Math.ceil,ZP=function(r){return function(l,d,g){var C,A,L=XP(VX(l)),B=UX(d),U=L.length,Z=g===void 0?" ":XP(g);return B<=U||Z==""?L:((A=GX(Z,HX((C=B-U)/Z.length))).length>C&&(A=BX(A,0,C)),r?L+A:A+L)}},$X={start:ZP(!1),end:ZP(!0)},qX=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Ke),KX=$X.start;Cr({target:"String",proto:!0,forced:qX},{padStart:function(r){return KX(this,r,arguments.length>1?arguments[1]:void 0)}});var zX=c,WX=jo,jX=qe("iterator"),QP=!zX(function(){var r=new URL("b?a=1&b=2&c=3","http://a"),l=r.searchParams,d="";return r.pathname="c%20d",l.forEach(function(g,C){l.delete("b"),d+=C+g}),!l.size&&!WX||!l.sort||r.href!=="http://a/c%20d?a=1&c=3"||l.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!l[jX]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"}),YX=pa,ex=function(r,l,d){for(var g in l)YX(r,g,l[g],d);return r},JX=Br,XX=Vr,ZX=ss,tx=function(r,l,d){var g=JX(l);g in r?XX.f(r,g,ZX(0,d)):r[g]=d},nx=gh,QX=St,eZ=tx,tZ=Array,nZ=Math.max,ek=function(r,l,d){for(var g=QX(r),C=nx(l,g),A=nx(d===void 0?g:d,g),L=tZ(nZ(A-C,0)),B=0;C<A;C++,B++)eZ(L,B,r[C]);return L.length=B,L},ox=ek,oZ=Math.floor,tk=function(r,l){var d=r.length,g=oZ(d/2);return d<8?rZ(r,l):iZ(r,tk(ox(r,0,g),l),tk(ox(r,g),l),l)},rZ=function(r,l){for(var d,g,C=r.length,A=1;A<C;){for(g=A,d=r[A];g&&l(r[g-1],d)>0;)r[g]=r[--g];g!==A++&&(r[g]=d)}return r},iZ=function(r,l,d,g){for(var C=l.length,A=d.length,L=0,B=0;L<C||B<A;)r[L+B]=L<C&&B<A?g(l[L],d[B])<=0?l[L++]:d[B++]:L<C?l[L++]:d[B++];return r},nk=tk,ok=Cr,_m=J,Db=It,wl=b,ym=jo,rx=QP,ix=pa,aZ=gc,sZ=ex,lZ=Va,cZ=VI,rk=pi,ax=Uu,ik=Nt,uZ=Le,dZ=q,hZ=ga,fZ=Gt,sx=io,$a=Ha,pZ=po,lx=ss,ak=Eb,mZ=s_,Im=fe,gZ=nk,vZ=qe("iterator"),c_="URLSearchParams",cx=c_+"Iterator",ux=rk.set,cs=rk.getterFor(c_),_Z=rk.getterFor(cx),yZ=Object.getOwnPropertyDescriptor,sk=function(r){if(!ym)return _m[r];var l=yZ(_m,r);return l&&l.value},dx=sk("fetch"),Ob=sk("Request"),u_=sk("Headers"),lk=Ob&&Ob.prototype,hx=u_&&u_.prototype,IZ=_m.RegExp,bZ=_m.TypeError,fx=_m.decodeURIComponent,CZ=_m.encodeURIComponent,SZ=wl("".charAt),px=wl([].join),Wh=wl([].push),ck=wl("".replace),EZ=wl([].shift),mx=wl([].splice),gx=wl("".split),TZ=wl("".slice),MZ=/\+/g,vx=Array(4),kZ=function(r){return vx[r-1]||(vx[r-1]=IZ("((?:%[\\da-f]{2}){"+r+"})","gi"))},wZ=function(r){try{return fx(r)}catch{return r}},_x=function(r){var l=ck(r,MZ," "),d=4;try{return fx(l)}catch{for(;d;)l=ck(l,kZ(d--),wZ);return l}},RZ=/[!'()~]|%20/g,AZ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},DZ=function(r){return AZ[r]},yx=function(r){return ck(CZ(r),RZ,DZ)},uk=cZ(function(r,l){ux(this,{type:cx,iterator:ak(cs(r).entries),kind:l})},"Iterator",function(){var r=_Z(this),l=r.kind,d=r.iterator.next(),g=d.value;return d.done||(d.value=l==="keys"?g.key:l==="values"?g.value:[g.key,g.value]),d},!0),Ix=function(r){this.entries=[],this.url=null,r!==void 0&&(sx(r)?this.parseObject(r):this.parseQuery(typeof r=="string"?SZ(r,0)==="?"?TZ(r,1):r:$a(r)))};Ix.prototype={type:c_,bindURL:function(r){this.url=r,this.update()},parseObject:function(r){var l,d,g,C,A,L,B,U=mZ(r);if(U)for(d=(l=ak(r,U)).next;!(g=Db(d,l)).done;){if(A=(C=ak(fZ(g.value))).next,(L=Db(A,C)).done||(B=Db(A,C)).done||!Db(A,C).done)throw bZ("Expected sequence with length 2");Wh(this.entries,{key:$a(L.value),value:$a(B.value)})}else for(var Z in r)uZ(r,Z)&&Wh(this.entries,{key:Z,value:$a(r[Z])})},parseQuery:function(r){if(r)for(var l,d,g=gx(r,"&"),C=0;C<g.length;)(l=g[C++]).length&&(d=gx(l,"="),Wh(this.entries,{key:_x(EZ(d)),value:_x(px(d,"="))}))},serialize:function(){for(var r,l=this.entries,d=[],g=0;g<l.length;)r=l[g++],Wh(d,yx(r.key)+"="+yx(r.value));return px(d,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Lb=function(){ax(this,bm);var r=ux(this,new Ix(arguments.length>0?arguments[0]:void 0));ym||(this.length=r.entries.length)},bm=Lb.prototype;if(sZ(bm,{append:function(r,l){Im(arguments.length,2);var d=cs(this);Wh(d.entries,{key:$a(r),value:$a(l)}),ym||this.length++,d.updateURL()},delete:function(r){Im(arguments.length,1);for(var l=cs(this),d=l.entries,g=$a(r),C=0;C<d.length;)d[C].key===g?mx(d,C,1):C++;ym||(this.length=d.length),l.updateURL()},get:function(r){Im(arguments.length,1);for(var l=cs(this).entries,d=$a(r),g=0;g<l.length;g++)if(l[g].key===d)return l[g].value;return null},getAll:function(r){Im(arguments.length,1);for(var l=cs(this).entries,d=$a(r),g=[],C=0;C<l.length;C++)l[C].key===d&&Wh(g,l[C].value);return g},has:function(r){Im(arguments.length,1);for(var l=cs(this).entries,d=$a(r),g=0;g<l.length;)if(l[g++].key===d)return!0;return!1},set:function(r,l){Im(arguments.length,1);for(var d,g=cs(this),C=g.entries,A=!1,L=$a(r),B=$a(l),U=0;U<C.length;U++)(d=C[U]).key===L&&(A?mx(C,U--,1):(A=!0,d.value=B));A||Wh(C,{key:L,value:B}),ym||(this.length=C.length),g.updateURL()},sort:function(){var r=cs(this);gZ(r.entries,function(l,d){return l.key>d.key?1:-1}),r.updateURL()},forEach:function(r){for(var l,d=cs(this).entries,g=dZ(r,arguments.length>1?arguments[1]:void 0),C=0;C<d.length;)g((l=d[C++]).value,l.key,this)},keys:function(){return new uk(this,"keys")},values:function(){return new uk(this,"values")},entries:function(){return new uk(this,"entries")}},{enumerable:!0}),ix(bm,vZ,bm.entries,{name:"entries"}),ix(bm,"toString",function(){return cs(this).serialize()},{enumerable:!0}),ym&&aZ(bm,"size",{get:function(){return cs(this).entries.length},configurable:!0,enumerable:!0}),lZ(Lb,c_),ok({global:!0,constructor:!0,forced:!rx},{URLSearchParams:Lb}),!rx&&ik(u_)){var OZ=wl(hx.has),LZ=wl(hx.set),bx=function(r){if(sx(r)){var l,d=r.body;if(hZ(d)===c_)return l=r.headers?new u_(r.headers):new u_,OZ(l,"content-type")||LZ(l,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),pZ(r,{body:lx(0,$a(d)),headers:lx(0,l)})}return r};if(ik(dx)&&ok({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return dx(r,arguments.length>1?bx(arguments[1]):{})}}),ik(Ob)){var dk=function(r){return ax(this,lk),new Ob(r,arguments.length>1?bx(arguments[1]):{})};lk.constructor=dk,dk.prototype=lk,ok({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:dk})}}var NZ={URLSearchParams:Lb,getState:cs},Cx=`	
\v\f\r                　\u2028\u2029\uFEFF`,PZ=Y,xZ=Ha,hk=Cx,Sx=b("".replace),UZ=RegExp("^["+hk+"]+"),FZ=RegExp("(^|[^"+hk+"])["+hk+"]+$"),fk=function(r){return function(l){var d=xZ(PZ(l));return 1&r&&(d=Sx(d,UZ,"")),2&r&&(d=Sx(d,FZ,"$1")),d}},VZ={start:fk(1),end:fk(2),trim:fk(3)},GZ=Eh.PROPER,BZ=c,Ex=Cx,HZ=VZ.trim;Cr({target:"String",proto:!0,forced:function(r){return BZ(function(){return!!Ex[r]()||"​᠎"[r]()!=="​᠎"||GZ&&Ex[r].name!==r})}("trim")},{trim:function(){return HZ(this)}});var $Z=Cr,qZ=jo,Nb=b,KZ=Le,zZ=Nt,WZ=zr,jZ=Ha,YZ=gc,JZ=Kp,yc=J.Symbol,jh=yc&&yc.prototype;if(qZ&&zZ(yc)&&(!("description"in jh)||yc().description!==void 0)){var Tx={},Pb=function(){var r=arguments.length<1||arguments[0]===void 0?void 0:jZ(arguments[0]),l=WZ(jh,this)?new yc(r):r===void 0?yc():yc(r);return r===""&&(Tx[l]=!0),l};JZ(Pb,yc),Pb.prototype=jh,jh.constructor=Pb;var XZ=String(yc("test"))=="Symbol(test)",ZZ=Nb(jh.valueOf),QZ=Nb(jh.toString),eQ=/^Symbol\((.*)\)[^)]+$/,tQ=Nb("".replace),nQ=Nb("".slice);YZ(jh,"description",{configurable:!0,get:function(){var r=ZZ(this);if(KZ(Tx,r))return"";var l=QZ(r),d=XZ?nQ(l,7,-1):tQ(l,eQ,"$1");return d===""?void 0:d}}),$Z({global:!0,constructor:!0,forced:!0},{Symbol:Pb})}var oQ=jM.charAt,rQ=Ha,Mx=pi,iQ=jI,kx=YI,Rx="String Iterator",aQ=Mx.set,sQ=Mx.getterFor(Rx);iQ(String,"String",function(r){aQ(this,{type:Rx,string:rQ(r),index:0})},function(){var r,l=sQ(this),d=l.string,g=l.index;return g>=d.length?kx(void 0,!0):(r=oQ(d,g),l.index+=r.length,kx(r,!1))});var us,Ax=jo,lQ=b,cQ=It,uQ=c,pk=kv,dQ=Fv,hQ=Ap,fQ=Oe,pQ=x,Cm=Object.assign,Dx=Object.defineProperty,mQ=lQ([].concat),gQ=!Cm||uQ(function(){if(Ax&&Cm({b:1},Cm(Dx({},"a",{enumerable:!0,get:function(){Dx(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},l={},d=Symbol(),g="abcdefghijklmnopqrst";return r[d]=7,g.split("").forEach(function(C){l[C]=C}),Cm({},r)[d]!=7||pk(Cm({},l)).join("")!=g})?function(r,l){for(var d=fQ(r),g=arguments.length,C=1,A=dQ.f,L=hQ.f;g>C;)for(var B,U=pQ(arguments[C++]),Z=A?mQ(pk(U),A(U)):pk(U),ae=Z.length,ce=0;ae>ce;)B=Z[ce++],Ax&&!cQ(L,U,B)||(d[B]=U[B]);return d}:Cm,vQ=Gt,_Q=Y2,yQ=q,IQ=It,bQ=Oe,CQ=function(r,l,d,g){try{return g?l(vQ(d)[0],d[1]):l(d)}catch(C){_Q(r,"throw",C)}},SQ=LM,EQ=t_,TQ=St,Ox=tx,MQ=Eb,kQ=s_,Lx=Array,Yh=b,mk=2147483647,wQ=/[^\0-\u007E]/,Nx=/[.\u3002\uFF0E\uFF61]/g,Px="Overflow: input needs wider integers to process",xx=RangeError,RQ=Yh(Nx.exec),Sm=Math.floor,gk=String.fromCharCode,Ux=Yh("".charCodeAt),Fx=Yh([].join),qu=Yh([].push),AQ=Yh("".replace),DQ=Yh("".split),OQ=Yh("".toLowerCase),Vx=function(r){return r+22+75*(r<26)},LQ=function(r,l,d){var g=0;for(r=d?Sm(r/700):r>>1,r+=Sm(r/l);r>455;)r=Sm(r/35),g+=36;return Sm(g+36*r/(r+38))},NQ=function(r){var l=[];r=function(Wt){for(var kt=[],En=0,Ln=Wt.length;En<Ln;){var Hn=Ux(Wt,En++);if(Hn>=55296&&Hn<=56319&&En<Ln){var Zo=Ux(Wt,En++);(64512&Zo)==56320?qu(kt,((1023&Hn)<<10)+(1023&Zo)+65536):(qu(kt,Hn),En--)}else qu(kt,Hn)}return kt}(r);var d,g,C=r.length,A=128,L=0,B=72;for(d=0;d<r.length;d++)(g=r[d])<128&&qu(l,gk(g));var U=l.length,Z=U;for(U&&qu(l,"-");Z<C;){var ae=mk;for(d=0;d<r.length;d++)(g=r[d])>=A&&g<ae&&(ae=g);var ce=Z+1;if(ae-A>Sm((mk-L)/ce))throw xx(Px);for(L+=(ae-A)*ce,A=ae,d=0;d<r.length;d++){if((g=r[d])<A&&++L>mk)throw xx(Px);if(g==A){for(var we=L,Pe=36;;){var Ze=Pe<=B?1:Pe>=B+26?26:Pe-B;if(we<Ze)break;var Ct=we-Ze,Bt=36-Ze;qu(l,gk(Vx(Ze+Ct%Bt))),we=Sm(Ct/Bt),Pe+=36}qu(l,gk(Vx(we))),B=LQ(L,ce,Z==U),L=0,Z++}}L++,A++}return Fx(l,"")},PQ=Cr,vk=jo,xQ=QP,_k=J,Gx=q,ds=b,xb=pa,hs=gc,UQ=Uu,yk=Le,Ik=gQ,Em=function(r){var l=bQ(r),d=EQ(this),g=arguments.length,C=g>1?arguments[1]:void 0,A=C!==void 0;A&&(C=yQ(C,g>2?arguments[2]:void 0));var L,B,U,Z,ae,ce,we=kQ(l),Pe=0;if(!we||this===Lx&&SQ(we))for(L=TQ(l),B=d?new this(L):Lx(L);L>Pe;Pe++)ce=A?C(l[Pe],Pe):l[Pe],Ox(B,Pe,ce);else for(ae=(Z=MQ(l,we)).next,B=d?new this:[];!(U=IQ(ae,Z)).done;Pe++)ce=A?CQ(Z,C,[U.value,Pe],!0):U.value,Ox(B,Pe,ce);return B.length=Pe,B},Ks=ek,FQ=jM.codeAt,VQ=function(r){var l,d,g=[],C=DQ(AQ(OQ(r),Nx,"."),".");for(l=0;l<C.length;l++)d=C[l],qu(g,RQ(wQ,d)?"xn--"+NQ(d):d);return Fx(g,".")},Ic=Ha,GQ=Va,BQ=fe,Bx=NZ,Hx=pi,HQ=Hx.set,Ub=Hx.getterFor("URL"),$Q=Bx.URLSearchParams,qQ=Bx.getState,d_=_k.URL,bk=_k.TypeError,Fb=_k.parseInt,KQ=Math.floor,$x=Math.pow,fs=ds("".charAt),zs=ds(/./.exec),h_=ds([].join),zQ=ds(1 .toString),WQ=ds([].pop),Tm=ds([].push),Ck=ds("".replace),jQ=ds([].shift),YQ=ds("".split),f_=ds("".slice),Vb=ds("".toLowerCase),JQ=ds([].unshift),Sk="Invalid scheme",Jh="Invalid host",qx="Invalid port",Kx=/[a-z]/i,XQ=/[\d+-.a-z]/i,Ek=/\d/,ZQ=/^0x/i,QQ=/^[0-7]+$/,eee=/^\d+$/,zx=/^[\da-f]+$/i,tee=/[\0\t\n\r #%/:<>?@[\\\]^|]/,nee=/[\0\t\n\r #/:<>?@[\\\]^|]/,oee=/^[\u0000-\u0020]+/,ree=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,iee=/[\t\n\r]/g,p_=function(r){var l,d,g,C;if(typeof r=="number"){for(l=[],d=0;d<4;d++)JQ(l,r%256),r=KQ(r/256);return h_(l,".")}if(typeof r=="object"){for(l="",g=function(A){for(var L=null,B=1,U=null,Z=0,ae=0;ae<8;ae++)A[ae]!==0?(Z>B&&(L=U,B=Z),U=null,Z=0):(U===null&&(U=ae),++Z);return Z>B&&(L=U,B=Z),L}(r),d=0;d<8;d++)C&&r[d]===0||(C&&(C=!1),g===d?(l+=d?":":"::",C=!0):(l+=zQ(r[d],16),d<7&&(l+=":")));return"["+l+"]"}return r},Gb={},Wx=Ik({},Gb,{" ":1,'"':1,"<":1,">":1,"`":1}),jx=Ik({},Wx,{"#":1,"?":1,"{":1,"}":1}),Tk=Ik({},jx,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ku=function(r,l){var d=FQ(r,0);return d>32&&d<127&&!yk(l,r)?r:encodeURIComponent(r)},Bb={ftp:21,file:null,http:80,https:443,ws:80,wss:443},m_=function(r,l){var d;return r.length==2&&zs(Kx,fs(r,0))&&((d=fs(r,1))==":"||!l&&d=="|")},Yx=function(r){var l;return r.length>1&&m_(f_(r,0,2))&&(r.length==2||(l=fs(r,2))==="/"||l==="\\"||l==="?"||l==="#")},aee=function(r){return r==="."||Vb(r)==="%2e"},Mk={},Jx={},kk={},Xx={},Zx={},wk={},Qx={},eU={},Hb={},$b={},Rk={},Ak={},Dk={},Ok={},tU={},Lk={},Mm={},Rl={},nU={},Xh={},bc={},Nk=function(r,l,d){var g,C,A,L=Ic(r);if(l){if(C=this.parse(L))throw bk(C);this.searchParams=null}else{if(d!==void 0&&(g=new Nk(d,!0)),C=this.parse(L,null,g))throw bk(C);(A=qQ(new $Q)).bindURL(this),this.searchParams=A}};Nk.prototype={type:"URL",parse:function(r,l,d){var g,C,A,L,B,U=this,Z=l||Mk,ae=0,ce="",we=!1,Pe=!1,Ze=!1;for(r=Ic(r),l||(U.scheme="",U.username="",U.password="",U.host=null,U.port=null,U.path=[],U.query=null,U.fragment=null,U.cannotBeABaseURL=!1,r=Ck(r,oee,""),r=Ck(r,ree,"$1")),r=Ck(r,iee,""),g=Em(r);ae<=g.length;){switch(C=g[ae],Z){case Mk:if(!C||!zs(Kx,C)){if(l)return Sk;Z=kk;continue}ce+=Vb(C),Z=Jx;break;case Jx:if(C&&(zs(XQ,C)||C=="+"||C=="-"||C=="."))ce+=Vb(C);else{if(C!=":"){if(l)return Sk;ce="",Z=kk,ae=0;continue}if(l&&(U.isSpecial()!=yk(Bb,ce)||ce=="file"&&(U.includesCredentials()||U.port!==null)||U.scheme=="file"&&!U.host))return;if(U.scheme=ce,l)return void(U.isSpecial()&&Bb[U.scheme]==U.port&&(U.port=null));ce="",U.scheme=="file"?Z=Ok:U.isSpecial()&&d&&d.scheme==U.scheme?Z=Xx:U.isSpecial()?Z=eU:g[ae+1]=="/"?(Z=Zx,ae++):(U.cannotBeABaseURL=!0,Tm(U.path,""),Z=nU)}break;case kk:if(!d||d.cannotBeABaseURL&&C!="#")return Sk;if(d.cannotBeABaseURL&&C=="#"){U.scheme=d.scheme,U.path=Ks(d.path),U.query=d.query,U.fragment="",U.cannotBeABaseURL=!0,Z=bc;break}Z=d.scheme=="file"?Ok:wk;continue;case Xx:if(C!="/"||g[ae+1]!="/"){Z=wk;continue}Z=Hb,ae++;break;case Zx:if(C=="/"){Z=$b;break}Z=Rl;continue;case wk:if(U.scheme=d.scheme,C==us)U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=Ks(d.path),U.query=d.query;else if(C=="/"||C=="\\"&&U.isSpecial())Z=Qx;else if(C=="?")U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=Ks(d.path),U.query="",Z=Xh;else{if(C!="#"){U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=Ks(d.path),U.path.length--,Z=Rl;continue}U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,U.path=Ks(d.path),U.query=d.query,U.fragment="",Z=bc}break;case Qx:if(!U.isSpecial()||C!="/"&&C!="\\"){if(C!="/"){U.username=d.username,U.password=d.password,U.host=d.host,U.port=d.port,Z=Rl;continue}Z=$b}else Z=Hb;break;case eU:if(Z=Hb,C!="/"||fs(ce,ae+1)!="/")continue;ae++;break;case Hb:if(C!="/"&&C!="\\"){Z=$b;continue}break;case $b:if(C=="@"){we&&(ce="%40"+ce),we=!0,A=Em(ce);for(var Ct=0;Ct<A.length;Ct++){var Bt=A[Ct];if(Bt!=":"||Ze){var Wt=Ku(Bt,Tk);Ze?U.password+=Wt:U.username+=Wt}else Ze=!0}ce=""}else if(C==us||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()){if(we&&ce=="")return"Invalid authority";ae-=Em(ce).length+1,ce="",Z=Rk}else ce+=C;break;case Rk:case Ak:if(l&&U.scheme=="file"){Z=Lk;continue}if(C!=":"||Pe){if(C==us||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()){if(U.isSpecial()&&ce=="")return Jh;if(l&&ce==""&&(U.includesCredentials()||U.port!==null))return;if(L=U.parseHost(ce))return L;if(ce="",Z=Mm,l)return;continue}C=="["?Pe=!0:C=="]"&&(Pe=!1),ce+=C}else{if(ce=="")return Jh;if(L=U.parseHost(ce))return L;if(ce="",Z=Dk,l==Ak)return}break;case Dk:if(!zs(Ek,C)){if(C==us||C=="/"||C=="?"||C=="#"||C=="\\"&&U.isSpecial()||l){if(ce!=""){var kt=Fb(ce,10);if(kt>65535)return qx;U.port=U.isSpecial()&&kt===Bb[U.scheme]?null:kt,ce=""}if(l)return;Z=Mm;continue}return qx}ce+=C;break;case Ok:if(U.scheme="file",C=="/"||C=="\\")Z=tU;else{if(!d||d.scheme!="file"){Z=Rl;continue}if(C==us)U.host=d.host,U.path=Ks(d.path),U.query=d.query;else if(C=="?")U.host=d.host,U.path=Ks(d.path),U.query="",Z=Xh;else{if(C!="#"){Yx(h_(Ks(g,ae),""))||(U.host=d.host,U.path=Ks(d.path),U.shortenPath()),Z=Rl;continue}U.host=d.host,U.path=Ks(d.path),U.query=d.query,U.fragment="",Z=bc}}break;case tU:if(C=="/"||C=="\\"){Z=Lk;break}d&&d.scheme=="file"&&!Yx(h_(Ks(g,ae),""))&&(m_(d.path[0],!0)?Tm(U.path,d.path[0]):U.host=d.host),Z=Rl;continue;case Lk:if(C==us||C=="/"||C=="\\"||C=="?"||C=="#"){if(!l&&m_(ce))Z=Rl;else if(ce==""){if(U.host="",l)return;Z=Mm}else{if(L=U.parseHost(ce))return L;if(U.host=="localhost"&&(U.host=""),l)return;ce="",Z=Mm}continue}ce+=C;break;case Mm:if(U.isSpecial()){if(Z=Rl,C!="/"&&C!="\\")continue}else if(l||C!="?")if(l||C!="#"){if(C!=us&&(Z=Rl,C!="/"))continue}else U.fragment="",Z=bc;else U.query="",Z=Xh;break;case Rl:if(C==us||C=="/"||C=="\\"&&U.isSpecial()||!l&&(C=="?"||C=="#")){if((B=Vb(B=ce))===".."||B==="%2e."||B===".%2e"||B==="%2e%2e"?(U.shortenPath(),C=="/"||C=="\\"&&U.isSpecial()||Tm(U.path,"")):aee(ce)?C=="/"||C=="\\"&&U.isSpecial()||Tm(U.path,""):(U.scheme=="file"&&!U.path.length&&m_(ce)&&(U.host&&(U.host=""),ce=fs(ce,0)+":"),Tm(U.path,ce)),ce="",U.scheme=="file"&&(C==us||C=="?"||C=="#"))for(;U.path.length>1&&U.path[0]==="";)jQ(U.path);C=="?"?(U.query="",Z=Xh):C=="#"&&(U.fragment="",Z=bc)}else ce+=Ku(C,jx);break;case nU:C=="?"?(U.query="",Z=Xh):C=="#"?(U.fragment="",Z=bc):C!=us&&(U.path[0]+=Ku(C,Gb));break;case Xh:l||C!="#"?C!=us&&(C=="'"&&U.isSpecial()?U.query+="%27":U.query+=C=="#"?"%23":Ku(C,Gb)):(U.fragment="",Z=bc);break;case bc:C!=us&&(U.fragment+=Ku(C,Wx))}ae++}},parseHost:function(r){var l,d,g;if(fs(r,0)=="["){if(fs(r,r.length-1)!="]"||(l=function(C){var A,L,B,U,Z,ae,ce,we=[0,0,0,0,0,0,0,0],Pe=0,Ze=null,Ct=0,Bt=function(){return fs(C,Ct)};if(Bt()==":"){if(fs(C,1)!=":")return;Ct+=2,Ze=++Pe}for(;Bt();){if(Pe==8)return;if(Bt()!=":"){for(A=L=0;L<4&&zs(zx,Bt());)A=16*A+Fb(Bt(),16),Ct++,L++;if(Bt()=="."){if(L==0||(Ct-=L,Pe>6))return;for(B=0;Bt();){if(U=null,B>0){if(!(Bt()=="."&&B<4))return;Ct++}if(!zs(Ek,Bt()))return;for(;zs(Ek,Bt());){if(Z=Fb(Bt(),10),U===null)U=Z;else{if(U==0)return;U=10*U+Z}if(U>255)return;Ct++}we[Pe]=256*we[Pe]+U,++B!=2&&B!=4||Pe++}if(B!=4)return;break}if(Bt()==":"){if(Ct++,!Bt())return}else if(Bt())return;we[Pe++]=A}else{if(Ze!==null)return;Ct++,Ze=++Pe}}if(Ze!==null)for(ae=Pe-Ze,Pe=7;Pe!=0&&ae>0;)ce=we[Pe],we[Pe--]=we[Ze+ae-1],we[Ze+--ae]=ce;else if(Pe!=8)return;return we}(f_(r,1,-1)),!l))return Jh;this.host=l}else if(this.isSpecial()){if(r=VQ(r),zs(tee,r)||(l=function(C){var A,L,B,U,Z,ae,ce,we=YQ(C,".");if(we.length&&we[we.length-1]==""&&we.length--,(A=we.length)>4)return C;for(L=[],B=0;B<A;B++){if((U=we[B])=="")return C;if(Z=10,U.length>1&&fs(U,0)=="0"&&(Z=zs(ZQ,U)?16:8,U=f_(U,Z==8?1:2)),U==="")ae=0;else{if(!zs(Z==10?eee:Z==8?QQ:zx,U))return C;ae=Fb(U,Z)}Tm(L,ae)}for(B=0;B<A;B++)if(ae=L[B],B==A-1){if(ae>=$x(256,5-A))return null}else if(ae>255)return null;for(ce=WQ(L),B=0;B<L.length;B++)ce+=L[B]*$x(256,3-B);return ce}(r),l===null))return Jh;this.host=l}else{if(zs(nee,r))return Jh;for(l="",d=Em(r),g=0;g<d.length;g++)l+=Ku(d[g],Gb);this.host=l}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return yk(Bb,this.scheme)},shortenPath:function(){var r=this.path,l=r.length;!l||this.scheme=="file"&&l==1&&m_(r[0],!0)||r.length--},serialize:function(){var r=this,l=r.scheme,d=r.username,g=r.password,C=r.host,A=r.port,L=r.path,B=r.query,U=r.fragment,Z=l+":";return C!==null?(Z+="//",r.includesCredentials()&&(Z+=d+(g?":"+g:"")+"@"),Z+=p_(C),A!==null&&(Z+=":"+A)):l=="file"&&(Z+="//"),Z+=r.cannotBeABaseURL?L[0]:L.length?"/"+h_(L,"/"):"",B!==null&&(Z+="?"+B),U!==null&&(Z+="#"+U),Z},setHref:function(r){var l=this.parse(r);if(l)throw bk(l);this.searchParams.update()},getOrigin:function(){var r=this.scheme,l=this.port;if(r=="blob")try{return new km(r.path[0]).origin}catch{return"null"}return r!="file"&&this.isSpecial()?r+"://"+p_(this.host)+(l!==null?":"+l:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(r){this.parse(Ic(r)+":",Mk)},getUsername:function(){return this.username},setUsername:function(r){var l=Em(Ic(r));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var d=0;d<l.length;d++)this.username+=Ku(l[d],Tk)}},getPassword:function(){return this.password},setPassword:function(r){var l=Em(Ic(r));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var d=0;d<l.length;d++)this.password+=Ku(l[d],Tk)}},getHost:function(){var r=this.host,l=this.port;return r===null?"":l===null?p_(r):p_(r)+":"+l},setHost:function(r){this.cannotBeABaseURL||this.parse(r,Rk)},getHostname:function(){var r=this.host;return r===null?"":p_(r)},setHostname:function(r){this.cannotBeABaseURL||this.parse(r,Ak)},getPort:function(){var r=this.port;return r===null?"":Ic(r)},setPort:function(r){this.cannotHaveUsernamePasswordPort()||((r=Ic(r))==""?this.port=null:this.parse(r,Dk))},getPathname:function(){var r=this.path;return this.cannotBeABaseURL?r[0]:r.length?"/"+h_(r,"/"):""},setPathname:function(r){this.cannotBeABaseURL||(this.path=[],this.parse(r,Mm))},getSearch:function(){var r=this.query;return r?"?"+r:""},setSearch:function(r){(r=Ic(r))==""?this.query=null:(fs(r,0)=="?"&&(r=f_(r,1)),this.query="",this.parse(r,Xh)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var r=this.fragment;return r?"#"+r:""},setHash:function(r){(r=Ic(r))!=""?(fs(r,0)=="#"&&(r=f_(r,1)),this.fragment="",this.parse(r,bc)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var km=function(r){var l=UQ(this,ea),d=BQ(arguments.length,1)>1?arguments[1]:void 0,g=HQ(l,new Nk(r,!1,d));vk||(l.href=g.serialize(),l.origin=g.getOrigin(),l.protocol=g.getProtocol(),l.username=g.getUsername(),l.password=g.getPassword(),l.host=g.getHost(),l.hostname=g.getHostname(),l.port=g.getPort(),l.pathname=g.getPathname(),l.search=g.getSearch(),l.searchParams=g.getSearchParams(),l.hash=g.getHash())},ea=km.prototype,ps=function(r,l){return{get:function(){return Ub(this)[r]()},set:l&&function(d){return Ub(this)[l](d)},configurable:!0,enumerable:!0}};if(vk&&(hs(ea,"href",ps("serialize","setHref")),hs(ea,"origin",ps("getOrigin")),hs(ea,"protocol",ps("getProtocol","setProtocol")),hs(ea,"username",ps("getUsername","setUsername")),hs(ea,"password",ps("getPassword","setPassword")),hs(ea,"host",ps("getHost","setHost")),hs(ea,"hostname",ps("getHostname","setHostname")),hs(ea,"port",ps("getPort","setPort")),hs(ea,"pathname",ps("getPathname","setPathname")),hs(ea,"search",ps("getSearch","setSearch")),hs(ea,"searchParams",ps("getSearchParams")),hs(ea,"hash",ps("getHash","setHash"))),xb(ea,"toJSON",function(){return Ub(this).serialize()},{enumerable:!0}),xb(ea,"toString",function(){return Ub(this).serialize()},{enumerable:!0}),d_){var oU=d_.createObjectURL,rU=d_.revokeObjectURL;oU&&xb(km,"createObjectURL",Gx(oU,d_)),rU&&xb(km,"revokeObjectURL",Gx(rU,d_))}GQ(km,"URL"),PQ({global:!0,constructor:!0,forced:!xQ,sham:!vk},{URL:km});var iU=typeof ArrayBuffer<"u"&&typeof DataView<"u",see=Pa,lee=vl,cee=RangeError,aU=function(r){if(r===void 0)return 0;var l=see(r),d=lee(l);if(l!==d)throw cee("Wrong length or index");return d},uee=Array,dee=Math.abs,Cc=Math.pow,hee=Math.floor,fee=Math.log,pee=Math.LN2,mee={pack:function(r,l,d){var g,C,A,L=uee(d),B=8*d-l-1,U=(1<<B)-1,Z=U>>1,ae=l===23?Cc(2,-24)-Cc(2,-77):0,ce=r<0||r===0&&1/r<0?1:0,we=0;for((r=dee(r))!=r||r===1/0?(C=r!=r?1:0,g=U):(g=hee(fee(r)/pee),r*(A=Cc(2,-g))<1&&(g--,A*=2),(r+=g+Z>=1?ae/A:ae*Cc(2,1-Z))*A>=2&&(g++,A/=2),g+Z>=U?(C=0,g=U):g+Z>=1?(C=(r*A-1)*Cc(2,l),g+=Z):(C=r*Cc(2,Z-1)*Cc(2,l),g=0));l>=8;)L[we++]=255&C,C/=256,l-=8;for(g=g<<l|C,B+=l;B>0;)L[we++]=255&g,g/=256,B-=8;return L[--we]|=128*ce,L},unpack:function(r,l){var d,g=r.length,C=8*g-l-1,A=(1<<C)-1,L=A>>1,B=C-7,U=g-1,Z=r[U--],ae=127&Z;for(Z>>=7;B>0;)ae=256*ae+r[U--],B-=8;for(d=ae&(1<<-B)-1,ae>>=-B,B+=l;B>0;)d=256*d+r[U--],B-=8;if(ae===0)ae=1-L;else{if(ae===A)return d?NaN:Z?-1/0:1/0;d+=Cc(2,l),ae-=L}return(Z?-1:1)*d*Cc(2,ae-l)}},gee=Oe,sU=gh,vee=St,lU=function(r){for(var l=gee(this),d=vee(l),g=arguments.length,C=sU(g>1?arguments[1]:void 0,d),A=g>2?arguments[2]:void 0,L=A===void 0?d:sU(A,d);L>C;)l[C++]=r;return l},qb=J,Pk=b,xk=jo,_ee=iU,cU=Eh,uU=ls,yee=gc,dU=ex,Uk=c,Kb=Uu,Iee=Pa,bee=vl,zb=aU,hU=mee,Cee=mc,fU=Lu,See=Ru.f,Eee=lU,Tee=ek,pU=Va,Fk=pi,Mee=cU.PROPER,mU=cU.CONFIGURABLE,wm="ArrayBuffer",Wb="DataView",Rm="prototype",gU="Wrong index",vU=Fk.getterFor(wm),g_=Fk.getterFor(Wb),_U=Fk.set,ms=qb[wm],Ws=ms,Am=Ws&&Ws[Rm],Sc=qb[Wb],Zh=Sc&&Sc[Rm],yU=Object.prototype,kee=qb.Array,jb=qb.RangeError,wee=Pk(Eee),Ree=Pk([].reverse),IU=hU.pack,bU=hU.unpack,CU=function(r){return[255&r]},SU=function(r){return[255&r,r>>8&255]},EU=function(r){return[255&r,r>>8&255,r>>16&255,r>>24&255]},TU=function(r){return r[3]<<24|r[2]<<16|r[1]<<8|r[0]},Aee=function(r){return IU(r,23,4)},Dee=function(r){return IU(r,52,8)},Yb=function(r,l,d){yee(r[Rm],l,{configurable:!0,get:function(){return d(this)[l]}})},zu=function(r,l,d,g){var C=zb(d),A=g_(r);if(C+l>A.byteLength)throw jb(gU);var L=A.bytes,B=C+A.byteOffset,U=Tee(L,B,B+l);return g?U:Ree(U)},Wu=function(r,l,d,g,C,A){var L=zb(d),B=g_(r);if(L+l>B.byteLength)throw jb(gU);for(var U=B.bytes,Z=L+B.byteOffset,ae=g(+C),ce=0;ce<l;ce++)U[Z+ce]=ae[A?ce:l-ce-1]};if(_ee){var MU=Mee&&ms.name!==wm;if(Uk(function(){ms(1)})&&Uk(function(){new ms(-1)})&&!Uk(function(){return new ms,new ms(1.5),new ms(NaN),ms.length!=1||MU&&!mU}))MU&&mU&&uU(ms,"name",wm);else{(Ws=function(r){return Kb(this,Am),new ms(zb(r))})[Rm]=Am;for(var Vk,kU=See(ms),wU=0;kU.length>wU;)(Vk=kU[wU++])in Ws||uU(Ws,Vk,ms[Vk]);Am.constructor=Ws}fU&&Cee(Zh)!==yU&&fU(Zh,yU);var Jb=new Sc(new Ws(2)),RU=Pk(Zh.setInt8);Jb.setInt8(0,2147483648),Jb.setInt8(1,2147483649),!Jb.getInt8(0)&&Jb.getInt8(1)||dU(Zh,{setInt8:function(r,l){RU(this,r,l<<24>>24)},setUint8:function(r,l){RU(this,r,l<<24>>24)}},{unsafe:!0})}else Am=(Ws=function(r){Kb(this,Am);var l=zb(r);_U(this,{type:wm,bytes:wee(kee(l),0),byteLength:l}),xk||(this.byteLength=l,this.detached=!1)})[Rm],Zh=(Sc=function(r,l,d){Kb(this,Zh),Kb(r,Am);var g=vU(r),C=g.byteLength,A=Iee(l);if(A<0||A>C)throw jb("Wrong offset");if(A+(d=d===void 0?C-A:bee(d))>C)throw jb("Wrong length");_U(this,{type:Wb,buffer:r,byteLength:d,byteOffset:A,bytes:g.bytes}),xk||(this.buffer=r,this.byteLength=d,this.byteOffset=A)})[Rm],xk&&(Yb(Ws,"byteLength",vU),Yb(Sc,"buffer",g_),Yb(Sc,"byteLength",g_),Yb(Sc,"byteOffset",g_)),dU(Zh,{getInt8:function(r){return zu(this,1,r)[0]<<24>>24},getUint8:function(r){return zu(this,1,r)[0]},getInt16:function(r){var l=zu(this,2,r,arguments.length>1?arguments[1]:void 0);return(l[1]<<8|l[0])<<16>>16},getUint16:function(r){var l=zu(this,2,r,arguments.length>1?arguments[1]:void 0);return l[1]<<8|l[0]},getInt32:function(r){return TU(zu(this,4,r,arguments.length>1?arguments[1]:void 0))},getUint32:function(r){return TU(zu(this,4,r,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(r){return bU(zu(this,4,r,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(r){return bU(zu(this,8,r,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(r,l){Wu(this,1,r,CU,l)},setUint8:function(r,l){Wu(this,1,r,CU,l)},setInt16:function(r,l){Wu(this,2,r,SU,l,arguments.length>2?arguments[2]:void 0)},setUint16:function(r,l){Wu(this,2,r,SU,l,arguments.length>2?arguments[2]:void 0)},setInt32:function(r,l){Wu(this,4,r,EU,l,arguments.length>2?arguments[2]:void 0)},setUint32:function(r,l){Wu(this,4,r,EU,l,arguments.length>2?arguments[2]:void 0)},setFloat32:function(r,l){Wu(this,4,r,Aee,l,arguments.length>2?arguments[2]:void 0)},setFloat64:function(r,l){Wu(this,8,r,Dee,l,arguments.length>2?arguments[2]:void 0)}});pU(Ws,wm),pU(Sc,Wb);var Xb={ArrayBuffer:Ws,DataView:Sc},Oee=Cr,Gk=T,Lee=c,AU=Gt,DU=gh,Nee=vl,Pee=vc,Bk=Xb.ArrayBuffer,Hk=Xb.DataView,OU=Hk.prototype,LU=Gk(Bk.prototype.slice),xee=Gk(OU.getUint8),Uee=Gk(OU.setUint8);Oee({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Lee(function(){return!new Bk(2).slice(1,void 0).byteLength})},{slice:function(r,l){if(LU&&l===void 0)return LU(AU(this),r);for(var d=AU(this).byteLength,g=DU(r,d),C=DU(l===void 0?d:l,d),A=new(Pee(this,Bk))(Nee(C-g)),L=new Hk(this),B=new Hk(A),U=0;g<C;)Uee(B,U++,xee(L,g++));return A}});var _a,Dm,Zb,Qb={},NU={get exports(){return Qb},set exports(r){Qb=r}},Fee=iU,$k=jo,ta=J,PU=Nt,eC=io,ju=Le,qk=ga,Vee=hn,Gee=ls,Kk=pa,Bee=gc,Hee=zr,tC=mc,Om=Lu,$ee=qe,qee=Re,xU=pi.enforce,Kee=pi.get,nC=ta.Int8Array,zk=nC&&nC.prototype,UU=ta.Uint8ClampedArray,FU=UU&&UU.prototype,Al=nC&&tC(nC),js=zk&&tC(zk),zee=Object.prototype,Wk=ta.TypeError,VU=$ee("toStringTag"),jk=qee("TYPED_ARRAY_TAG"),oC="TypedArrayConstructor",Ec=Fee&&!!Om&&qk(ta.opera)!=="Opera",GU=!1,Tc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Yk={BigInt64Array:8,BigUint64Array:8},BU=function(r){var l=tC(r);if(eC(l)){var d=Kee(l);return d&&ju(d,oC)?d[oC]:BU(l)}},HU=function(r){if(!eC(r))return!1;var l=qk(r);return ju(Tc,l)||ju(Yk,l)};for(_a in Tc)(Zb=(Dm=ta[_a])&&Dm.prototype)?xU(Zb)[oC]=Dm:Ec=!1;for(_a in Yk)(Zb=(Dm=ta[_a])&&Dm.prototype)&&(xU(Zb)[oC]=Dm);if((!Ec||!PU(Al)||Al===Function.prototype)&&(Al=function(){throw Wk("Incorrect invocation")},Ec))for(_a in Tc)ta[_a]&&Om(ta[_a],Al);if((!Ec||!js||js===zee)&&(js=Al.prototype,Ec))for(_a in Tc)ta[_a]&&Om(ta[_a].prototype,js);if(Ec&&tC(FU)!==js&&Om(FU,js),$k&&!ju(js,VU))for(_a in GU=!0,Bee(js,VU,{configurable:!0,get:function(){return eC(this)?this[jk]:void 0}}),Tc)ta[_a]&&Gee(ta[_a],jk,_a);var Mc={NATIVE_ARRAY_BUFFER_VIEWS:Ec,TYPED_ARRAY_TAG:GU&&jk,aTypedArray:function(r){if(HU(r))return r;throw Wk("Target is not a typed array")},aTypedArrayConstructor:function(r){if(PU(r)&&(!Om||Hee(Al,r)))return r;throw Wk(Vee(r)+" is not a typed array constructor")},exportTypedArrayMethod:function(r,l,d,g){if($k){if(d)for(var C in Tc){var A=ta[C];if(A&&ju(A.prototype,r))try{delete A.prototype[r]}catch{try{A.prototype[r]=l}catch{}}}js[r]&&!d||Kk(js,r,d?l:Ec&&zk[r]||l,g)}},exportTypedArrayStaticMethod:function(r,l,d){var g,C;if($k){if(Om){if(d){for(g in Tc)if((C=ta[g])&&ju(C,r))try{delete C[r]}catch{}}if(Al[r]&&!d)return;try{return Kk(Al,r,d?l:Ec&&Al[r]||l)}catch{}}for(g in Tc)!(C=ta[g])||C[r]&&!d||Kk(C,r,l)}},getTypedArrayConstructor:BU,isView:function(r){if(!eC(r))return!1;var l=qk(r);return l==="DataView"||ju(Tc,l)||ju(Yk,l)},isTypedArray:HU,TypedArray:Al,TypedArrayPrototype:js},$U=J,Jk=c,Wee=oP,jee=Mc.NATIVE_ARRAY_BUFFER_VIEWS,Yee=$U.ArrayBuffer,Qh=$U.Int8Array,qU=!jee||!Jk(function(){Qh(1)})||!Jk(function(){new Qh(-1)})||!Wee(function(r){new Qh,new Qh(null),new Qh(1.5),new Qh(r)},!0)||Jk(function(){return new Qh(new Yee(2),1,void 0).length!==1}),Jee=io,Xee=Math.floor,Zee=Number.isInteger||function(r){return!Jee(r)&&isFinite(r)&&Xee(r)===r},Qee=Pa,ete=RangeError,tte=function(r){var l=Qee(r);if(l<0)throw ete("The argument can't be less than 0");return l},nte=RangeError,KU=function(r,l){var d=tte(r);if(d%l)throw nte("Wrong offset");return d},ote=ga,rte=Yr,ite=TypeError,zU=function(r){var l=rte(r,"number");if(typeof l=="number")throw ite("Can't convert number to bigint");return BigInt(l)},ate=q,ste=It,lte=db,cte=Oe,ute=St,dte=Eb,hte=s_,fte=LM,pte=function(r){var l=ote(r);return l=="BigInt64Array"||l=="BigUint64Array"},mte=Mc.aTypedArrayConstructor,gte=zU,WU=function(r){var l,d,g,C,A,L,B,U,Z=lte(this),ae=cte(r),ce=arguments.length,we=ce>1?arguments[1]:void 0,Pe=we!==void 0,Ze=hte(ae);if(Ze&&!fte(Ze))for(U=(B=dte(ae,Ze)).next,ae=[];!(L=ste(U,B)).done;)ae.push(L.value);for(Pe&&ce>2&&(we=ate(we,arguments[2])),d=ute(ae),g=new(mte(Z))(d),C=pte(g),l=0;d>l;l++)A=Pe?we(ae[l],l):ae[l],g[l]=C?gte(A):+A;return g},jU=Cr,YU=J,JU=It,vte=jo,_te=qU,Lm=Mc,XU=Xb,ZU=Uu,yte=ss,v_=ls,Ite=Zee,bte=vl,QU=aU,Xk=KU,e3=Br,__=Le,Cte=ga,Zk=io,Ste=bt,Ete=po,Tte=zr,rC=Lu,Mte=Ru.f,t3=WU,kte=OP.forEach,wte=Vh,Rte=gc,n3=Vr,o3=bh,Ate=cP,Qk=pi.get,Dte=pi.set,Ote=pi.enforce,r3=n3.f,Lte=o3.f,Nte=Math.round,ew=YU.RangeError,i3=XU.ArrayBuffer,Pte=i3.prototype,xte=XU.DataView,iC=Lm.NATIVE_ARRAY_BUFFER_VIEWS,a3=Lm.TYPED_ARRAY_TAG,s3=Lm.TypedArray,y_=Lm.TypedArrayPrototype,Ute=Lm.aTypedArrayConstructor,tw=Lm.isTypedArray,aC="BYTES_PER_ELEMENT",nw="Wrong length",l3=function(r,l){Ute(r);for(var d=0,g=l.length,C=new r(g);g>d;)C[d]=l[d++];return C},sC=function(r,l){Rte(r,l,{configurable:!0,get:function(){return Qk(this)[l]}})},c3=function(r){var l;return Tte(Pte,r)||(l=Cte(r))=="ArrayBuffer"||l=="SharedArrayBuffer"},u3=function(r,l){return tw(r)&&!Ste(l)&&l in r&&Ite(+l)&&l>=0},d3=function(r,l){return l=e3(l),u3(r,l)?yte(2,r[l]):Lte(r,l)},h3=function(r,l,d){return l=e3(l),!(u3(r,l)&&Zk(d)&&__(d,"value"))||__(d,"get")||__(d,"set")||d.configurable||__(d,"writable")&&!d.writable||__(d,"enumerable")&&!d.enumerable?r3(r,l,d):(r[l]=d.value,r)};vte?(iC||(o3.f=d3,n3.f=h3,sC(y_,"buffer"),sC(y_,"byteOffset"),sC(y_,"byteLength"),sC(y_,"length")),jU({target:"Object",stat:!0,forced:!iC},{getOwnPropertyDescriptor:d3,defineProperty:h3}),NU.exports=function(r,l,d){var g=r.match(/\d+/)[0]/8,C=r+(d?"Clamped":"")+"Array",A="get"+r,L="set"+r,B=YU[C],U=B,Z=U&&U.prototype,ae={},ce=function(Pe,Ze){r3(Pe,Ze,{get:function(){return function(Ct,Bt){var Wt=Qk(Ct);return Wt.view[A](Bt*g+Wt.byteOffset,!0)}(this,Ze)},set:function(Ct){return function(Bt,Wt,kt){var En=Qk(Bt);d&&(kt=(kt=Nte(kt))<0?0:kt>255?255:255&kt),En.view[L](Wt*g+En.byteOffset,kt,!0)}(this,Ze,Ct)},enumerable:!0})};iC?_te&&(U=l(function(Pe,Ze,Ct,Bt){return ZU(Pe,Z),Ate(Zk(Ze)?c3(Ze)?Bt!==void 0?new B(Ze,Xk(Ct,g),Bt):Ct!==void 0?new B(Ze,Xk(Ct,g)):new B(Ze):tw(Ze)?l3(U,Ze):JU(t3,U,Ze):new B(QU(Ze)),Pe,U)}),rC&&rC(U,s3),kte(Mte(B),function(Pe){Pe in U||v_(U,Pe,B[Pe])}),U.prototype=Z):(U=l(function(Pe,Ze,Ct,Bt){ZU(Pe,Z);var Wt,kt,En,Ln=0,Hn=0;if(Zk(Ze)){if(!c3(Ze))return tw(Ze)?l3(U,Ze):JU(t3,U,Ze);Wt=Ze,Hn=Xk(Ct,g);var Zo=Ze.byteLength;if(Bt===void 0){if(Zo%g||(kt=Zo-Hn)<0)throw ew(nw)}else if((kt=bte(Bt)*g)+Hn>Zo)throw ew(nw);En=kt/g}else En=QU(Ze),Wt=new i3(kt=En*g);for(Dte(Pe,{buffer:Wt,byteOffset:Hn,byteLength:kt,length:En,view:new xte(Wt)});Ln<En;)ce(Pe,Ln++)}),rC&&rC(U,s3),Z=U.prototype=Ete(y_)),Z.constructor!==U&&v_(Z,"constructor",U),Ote(Z).TypedArrayConstructor=U,a3&&v_(Z,a3,C);var we=U!=B;ae[C]=U,jU({global:!0,constructor:!0,forced:we,sham:!iC},ae),aC in U||v_(U,aC,g),aC in Z||v_(Z,aC,g),wte(C)}):NU.exports=function(){},Qb("Uint8",function(r){return function(l,d,g){return r(this,l,d,g)}});var Fte=lU,Vte=zU,Gte=ga,Bte=It,Hte=c,$te=Mc.aTypedArray,qte=Mc.exportTypedArrayMethod,Kte=b("".slice);qte("fill",function(r){var l=arguments.length;$te(this);var d=Kte(Gte(this),0,3)==="Big"?Vte(r):+r;return Bte(Fte,this,d,l>1?arguments[1]:void 0,l>2?arguments[2]:void 0)},Hte(function(){var r=0;return new Int8Array(2).fill({valueOf:function(){return r++}}),r!==1}));var f3=J,p3=It,ow=Mc,zte=St,Wte=KU,jte=Oe,m3=c,Yte=f3.RangeError,rw=f3.Int8Array,g3=rw&&rw.prototype,v3=g3&&g3.set,Jte=ow.aTypedArray,Xte=ow.exportTypedArrayMethod,iw=!m3(function(){var r=new Uint8ClampedArray(2);return p3(v3,r,{length:1,0:3},1),r[1]!==3}),Zte=iw&&ow.NATIVE_ARRAY_BUFFER_VIEWS&&m3(function(){var r=new rw(2);return r.set(1),r.set("2",1),r[0]!==0||r[1]!==2});Xte("set",function(r){Jte(this);var l=Wte(arguments.length>1?arguments[1]:void 0,1),d=jte(r);if(iw)return p3(v3,this,d,l);var g=this.length,C=zte(d),A=0;if(C+l>g)throw Yte("Wrong length");for(;A<C;)this[l+A]=d[A++]},!iw||Zte);var _3=Ke.match(/firefox\/(\d+)/i),y3=!!_3&&+_3[1],I3=/MSIE|Trident/.test(Ke),b3=Ke.match(/AppleWebKit\/(\d+)\./),C3=!!b3&&+b3[1],Qte=T,aw=c,ene=Ar,tne=nk,S3=y3,nne=I3,E3=ft,T3=C3,one=Mc.aTypedArray,rne=Mc.exportTypedArrayMethod,I_=J.Uint16Array,Nm=I_&&Qte(I_.prototype.sort),ine=!(!Nm||aw(function(){Nm(new I_(2),null)})&&aw(function(){Nm(new I_(2),{})})),M3=!!Nm&&!aw(function(){if(E3)return E3<74;if(S3)return S3<67;if(nne)return!0;if(T3)return T3<602;var r,l,d=new I_(516),g=Array(516);for(r=0;r<516;r++)l=r%4,d[r]=515-r,g[r]=r-2*l+3;for(Nm(d,function(C,A){return(C/4|0)-(A/4|0)}),r=0;r<516;r++)if(d[r]!==g[r])return!0});rne("sort",function(r){return r!==void 0&&ene(r),M3?Nm(this,r):tne(one(this),function(l){return function(d,g){return l!==void 0?+l(d,g)||0:g!=g?-1:d!=d?1:d===0&&g===0?1/d>0&&1/g<0?1:-1:d>g}}(r))},!M3||ine);var ane=Cr,lC=i_,sne=c,k3=wt,w3=Nt,lne=vc,R3=sP,cne=pa,sw=lC&&lC.prototype;if(ane({target:"Promise",proto:!0,real:!0,forced:!!lC&&sne(function(){sw.finally.call({then:function(){}},function(){})})},{finally:function(r){var l=lne(this,k3("Promise")),d=w3(r);return this.then(d?function(g){return R3(l,r()).then(function(){return g})}:r,d?function(g){return R3(l,r()).then(function(){throw g})}:r)}}),w3(lC)){var A3=k3("Promise").prototype.finally;sw.finally!==A3&&cne(sw,"finally",A3,{unsafe:!0})}var une=Vh,lw="ArrayBuffer",D3=Xb[lw];Cr({global:!0,constructor:!0,forced:J[lw]!==D3},{ArrayBuffer:D3}),une(lw);var O3=hn,dne=TypeError,hne=Cr,L3=b,fne=Ar,pne=Oe,N3=St,mne=function(r,l){if(!delete r[l])throw dne("Cannot delete property "+O3(l)+" of "+O3(r))},P3=Ha,cw=c,gne=nk,vne=qM,x3=y3,_ne=I3,U3=ft,F3=C3,Yu=[],V3=L3(Yu.sort),yne=L3(Yu.push),Ine=cw(function(){Yu.sort(void 0)}),bne=cw(function(){Yu.sort(null)}),Cne=vne("sort"),G3=!cw(function(){if(U3)return U3<70;if(!(x3&&x3>3)){if(_ne)return!0;if(F3)return F3<603;var r,l,d,g,C="";for(r=65;r<76;r++){switch(l=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:d=3;break;case 68:case 71:d=4;break;default:d=2}for(g=0;g<47;g++)Yu.push({k:l+g,v:d})}for(Yu.sort(function(A,L){return L.v-A.v}),g=0;g<Yu.length;g++)l=Yu[g].k.charAt(0),C.charAt(C.length-1)!==l&&(C+=l);return C!=="DGBEFHACIJK"}});hne({target:"Array",proto:!0,forced:Ine||!bne||!Cne||!G3},{sort:function(r){r!==void 0&&fne(r);var l=pne(this);if(G3)return r===void 0?V3(l):V3(l,r);var d,g,C=[],A=N3(l);for(g=0;g<A;g++)g in l&&yne(C,l[g]);for(gne(C,function(L){return function(B,U){return U===void 0?-1:B===void 0?1:L!==void 0?+L(B,U)||0:P3(B)>P3(U)?1:-1}}(r)),d=N3(C),g=0;g<d;)l[g]=C[g++];for(;g<A;)mne(l,g++);return l}}),Qb("Float32",function(r){return function(l,d,g){return r(this,l,d,g)}});var Sne=Cr,Ene=wP,Tne=b([].reverse),B3=[1,2];Sne({target:"Array",proto:!0,forced:String(B3)===String(B3.reverse())},{reverse:function(){return Ene(this)&&(this.length=this.length),Tne(this)}});var Mne=Cr,kne=It,uw=b,H3=Y,wne=Nt,Rne=P,Ane=uP,b_=Ha,Dne=et,One=fP,Lne=qP,Nne=qe("replace"),Pne=TypeError,$3=uw("".indexOf);uw("".replace);var q3=uw("".slice),xne=Math.max,K3=function(r,l,d){return d>r.length?-1:l===""?d:$3(r,l,d)};Mne({target:"String",proto:!0},{replaceAll:function(r,l){var d,g,C,A,L,B,U,Z,ae=H3(this),ce=0,we=0,Pe="";if(!Rne(r)){if(Ane(r)&&(d=b_(H3(One(r))),!~$3(d,"g")))throw Pne("`.replaceAll` does not allow non-global regexes");if(g=Dne(r,Nne))return kne(g,r,ae,l)}for(C=b_(ae),A=b_(r),(L=wne(l))||(l=b_(l)),B=A.length,U=xne(1,B),ce=K3(C,A,0);ce!==-1;)Z=L?b_(l(A,ce,C)):Lne(A,C,ce,[],void 0,l),Pe+=q3(C,we,ce)+Z,we=ce+B,ce=K3(C,A,ce+U);return we<C.length&&(Pe+=q3(C,we)),Pe}}),(0,Mc.exportTypedArrayStaticMethod)("from",WU,qU);let z3=!0,W3=!0;function cC(r,l,d){const g=r.match(l);return g&&g.length>=d&&parseInt(g[d],10)}function ef(r,l,d){if(!r.RTCPeerConnection)return;const g=r.RTCPeerConnection.prototype,C=g.addEventListener;g.addEventListener=function(L,B){if(L!==l)return C.apply(this,arguments);const U=Z=>{const ae=d(Z);ae&&(B.handleEvent?B.handleEvent(ae):B(ae))};return this._eventMap=this._eventMap||{},this._eventMap[l]||(this._eventMap[l]=new Map),this._eventMap[l].set(B,U),C.apply(this,[L,U])};const A=g.removeEventListener;g.removeEventListener=function(L,B){if(L!==l||!this._eventMap||!this._eventMap[l])return A.apply(this,arguments);if(!this._eventMap[l].has(B))return A.apply(this,arguments);const U=this._eventMap[l].get(B);return this._eventMap[l].delete(B),this._eventMap[l].size===0&&delete this._eventMap[l],Object.keys(this._eventMap).length===0&&delete this._eventMap,A.apply(this,[L,U])},Object.defineProperty(g,"on"+l,{get(){return this["_on"+l]},set(L){this["_on"+l]&&(this.removeEventListener(l,this["_on"+l]),delete this["_on"+l]),L&&this.addEventListener(l,this["_on"+l]=L)},enumerable:!0,configurable:!0})}function Une(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(z3=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function Fne(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(W3=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function j3(){if(typeof window=="object"){if(z3)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function dw(r,l){W3&&console.warn(r+" is deprecated, please use "+l+" instead.")}function Y3(r){return Object.prototype.toString.call(r)==="[object Object]"}function J3(r){return Y3(r)?Object.keys(r).reduce(function(l,d){const g=Y3(r[d]),C=g?J3(r[d]):r[d],A=g&&!Object.keys(C).length;return C===void 0||A?l:Object.assign(l,{[d]:C})},{}):r}function hw(r,l,d){l&&!d.has(l.id)&&(d.set(l.id,l),Object.keys(l).forEach(g=>{g.endsWith("Id")?hw(r,r.get(l[g]),d):g.endsWith("Ids")&&l[g].forEach(C=>{hw(r,r.get(C),d)})}))}function X3(r,l,d){const g=d?"outbound-rtp":"inbound-rtp",C=new Map;if(l===null)return C;const A=[];return r.forEach(L=>{L.type==="track"&&L.trackIdentifier===l.id&&A.push(L)}),A.forEach(L=>{r.forEach(B=>{B.type===g&&B.trackId===L.id&&hw(r,B,C)})}),C}const Z3=j3;function Q3(r,l){const d=r&&r.navigator;if(!d.mediaDevices)return;const g=function(L){if(typeof L!="object"||L.mandatory||L.optional)return L;const B={};return Object.keys(L).forEach(U=>{if(U==="require"||U==="advanced"||U==="mediaSource")return;const Z=typeof L[U]=="object"?L[U]:{ideal:L[U]};Z.exact!==void 0&&typeof Z.exact=="number"&&(Z.min=Z.max=Z.exact);const ae=function(ce,we){return ce?ce+we.charAt(0).toUpperCase()+we.slice(1):we==="deviceId"?"sourceId":we};if(Z.ideal!==void 0){B.optional=B.optional||[];let ce={};typeof Z.ideal=="number"?(ce[ae("min",U)]=Z.ideal,B.optional.push(ce),ce={},ce[ae("max",U)]=Z.ideal,B.optional.push(ce)):(ce[ae("",U)]=Z.ideal,B.optional.push(ce))}Z.exact!==void 0&&typeof Z.exact!="number"?(B.mandatory=B.mandatory||{},B.mandatory[ae("",U)]=Z.exact):["min","max"].forEach(ce=>{Z[ce]!==void 0&&(B.mandatory=B.mandatory||{},B.mandatory[ae(ce,U)]=Z[ce])})}),L.advanced&&(B.optional=(B.optional||[]).concat(L.advanced)),B},C=function(L,B){if(l.version>=61)return B(L);if((L=JSON.parse(JSON.stringify(L)))&&typeof L.audio=="object"){const U=function(Z,ae,ce){ae in Z&&!(ce in Z)&&(Z[ce]=Z[ae],delete Z[ae])};U((L=JSON.parse(JSON.stringify(L))).audio,"autoGainControl","googAutoGainControl"),U(L.audio,"noiseSuppression","googNoiseSuppression"),L.audio=g(L.audio)}if(L&&typeof L.video=="object"){let U=L.video.facingMode;U=U&&(typeof U=="object"?U:{ideal:U});const Z=l.version<66;if(U&&(U.exact==="user"||U.exact==="environment"||U.ideal==="user"||U.ideal==="environment")&&(!d.mediaDevices.getSupportedConstraints||!d.mediaDevices.getSupportedConstraints().facingMode||Z)){let ae;if(delete L.video.facingMode,U.exact==="environment"||U.ideal==="environment"?ae=["back","rear"]:U.exact!=="user"&&U.ideal!=="user"||(ae=["front"]),ae)return d.mediaDevices.enumerateDevices().then(ce=>{let we=(ce=ce.filter(Pe=>Pe.kind==="videoinput")).find(Pe=>ae.some(Ze=>Pe.label.toLowerCase().includes(Ze)));return!we&&ce.length&&ae.includes("back")&&(we=ce[ce.length-1]),we&&(L.video.deviceId=U.exact?{exact:we.deviceId}:{ideal:we.deviceId}),L.video=g(L.video),Z3("chrome: "+JSON.stringify(L)),B(L)})}L.video=g(L.video)}return Z3("chrome: "+JSON.stringify(L)),B(L)},A=function(L){return l.version>=64?L:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[L.name]||L.name,message:L.message,constraint:L.constraint||L.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(d.getUserMedia=(function(L,B,U){C(L,Z=>{d.webkitGetUserMedia(Z,B,ae=>{U&&U(A(ae))})})}).bind(d),d.mediaDevices.getUserMedia){const L=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(B){return C(B,U=>L(U).then(Z=>{if(U.audio&&!Z.getAudioTracks().length||U.video&&!Z.getVideoTracks().length)throw Z.getTracks().forEach(ae=>{ae.stop()}),new DOMException("","NotFoundError");return Z},Z=>Promise.reject(A(Z))))}}}function e4(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function t4(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(d){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=d)},enumerable:!0,configurable:!0});const l=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=d=>{d.stream.addEventListener("addtrack",g=>{let C;C=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(L=>L.track&&L.track.id===g.track.id):{track:g.track};const A=new Event("track");A.track=g.track,A.receiver=C,A.transceiver={receiver:C},A.streams=[d.stream],this.dispatchEvent(A)}),d.stream.getTracks().forEach(g=>{let C;C=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(L=>L.track&&L.track.id===g.id):{track:g};const A=new Event("track");A.track=g,A.receiver=C,A.transceiver={receiver:C},A.streams=[d.stream],this.dispatchEvent(A)})},this.addEventListener("addstream",this._ontrackpoly)),l.apply(this,arguments)}}else ef(r,"track",l=>(l.transceiver||Object.defineProperty(l,"transceiver",{value:{receiver:l.receiver}}),l))}function n4(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const l=function(C,A){return{track:A,get dtmf(){return this._dtmf===void 0&&(A.kind==="audio"?this._dtmf=C.createDTMFSender(A):this._dtmf=null),this._dtmf},_pc:C}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const C=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(L,B){let U=C.apply(this,arguments);return U||(U=l(this,L),this._senders.push(U)),U};const A=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(L){A.apply(this,arguments);const B=this._senders.indexOf(L);B!==-1&&this._senders.splice(B,1)}}const d=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(C){this._senders=this._senders||[],d.apply(this,[C]),C.getTracks().forEach(A=>{this._senders.push(l(this,A))})};const g=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(C){this._senders=this._senders||[],g.apply(this,[C]),C.getTracks().forEach(A=>{const L=this._senders.find(B=>B.track===A);L&&this._senders.splice(this._senders.indexOf(L),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const l=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const d=l.apply(this,[]);return d.forEach(g=>g._pc=this),d},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function o4(r){if(!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[d,g,C]=arguments;if(arguments.length>0&&typeof d=="function")return l.apply(this,arguments);if(l.length===0&&(arguments.length===0||typeof d!="function"))return l.apply(this,[]);const A=function(B){const U={};return B.result().forEach(Z=>{const ae={id:Z.id,timestamp:Z.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[Z.type]||Z.type};Z.names().forEach(ce=>{ae[ce]=Z.stat(ce)}),U[ae.id]=ae}),U},L=function(B){return new Map(Object.keys(B).map(U=>[U,B[U]]))};if(arguments.length>=2){const B=function(U){g(L(A(U)))};return l.apply(this,[B,d])}return new Promise((B,U)=>{l.apply(this,[function(Z){B(L(A(Z)))},U])}).then(g,C)}}function r4(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const d=r.RTCPeerConnection.prototype.getSenders;d&&(r.RTCPeerConnection.prototype.getSenders=function(){const C=d.apply(this,[]);return C.forEach(A=>A._pc=this),C});const g=r.RTCPeerConnection.prototype.addTrack;g&&(r.RTCPeerConnection.prototype.addTrack=function(){const C=g.apply(this,arguments);return C._pc=this,C}),r.RTCRtpSender.prototype.getStats=function(){const C=this;return this._pc.getStats().then(A=>X3(A,C.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const d=r.RTCPeerConnection.prototype.getReceivers;d&&(r.RTCPeerConnection.prototype.getReceivers=function(){const g=d.apply(this,[]);return g.forEach(C=>C._pc=this),g}),ef(r,"track",g=>(g.receiver._pc=g.srcElement,g)),r.RTCRtpReceiver.prototype.getStats=function(){const g=this;return this._pc.getStats().then(C=>X3(C,g.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype)||!("getStats"in r.RTCRtpReceiver.prototype))return;const l=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const d=arguments[0];let g,C,A;return this.getSenders().forEach(L=>{L.track===d&&(g?A=!0:g=L)}),this.getReceivers().forEach(L=>(L.track===d&&(C?A=!0:C=L),L.track===d)),A||g&&C?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):g?g.getStats():C?C.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return l.apply(this,arguments)}}function i4(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(A=>this._shimmedLocalStreams[A][0])};const l=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(A,L){if(!L)return l.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const B=l.apply(this,arguments);return this._shimmedLocalStreams[L.id]?this._shimmedLocalStreams[L.id].indexOf(B)===-1&&this._shimmedLocalStreams[L.id].push(B):this._shimmedLocalStreams[L.id]=[L,B],B};const d=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(A){this._shimmedLocalStreams=this._shimmedLocalStreams||{},A.getTracks().forEach(U=>{if(this.getSenders().find(Z=>Z.track===U))throw new DOMException("Track already exists.","InvalidAccessError")});const L=this.getSenders();d.apply(this,arguments);const B=this.getSenders().filter(U=>L.indexOf(U)===-1);this._shimmedLocalStreams[A.id]=[A].concat(B)};const g=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(A){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[A.id],g.apply(this,arguments)};const C=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(A){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},A&&Object.keys(this._shimmedLocalStreams).forEach(L=>{const B=this._shimmedLocalStreams[L].indexOf(A);B!==-1&&this._shimmedLocalStreams[L].splice(B,1),this._shimmedLocalStreams[L].length===1&&delete this._shimmedLocalStreams[L]}),C.apply(this,arguments)}}function a4(r,l){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&l.version>=65)return i4(r);const d=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const U=d.apply(this);return this._reverseStreams=this._reverseStreams||{},U.map(Z=>this._reverseStreams[Z.id])};const g=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(U){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},U.getTracks().forEach(Z=>{if(this.getSenders().find(ae=>ae.track===Z))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[U.id]){const Z=new r.MediaStream(U.getTracks());this._streams[U.id]=Z,this._reverseStreams[Z.id]=U,U=Z}g.apply(this,[U])};const C=r.RTCPeerConnection.prototype.removeStream;function A(U,Z){let ae=Z.sdp;return Object.keys(U._reverseStreams||[]).forEach(ce=>{const we=U._reverseStreams[ce],Pe=U._streams[we.id];ae=ae.replace(new RegExp(Pe.id,"g"),we.id)}),new RTCSessionDescription({type:Z.type,sdp:ae})}r.RTCPeerConnection.prototype.removeStream=function(U){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},C.apply(this,[this._streams[U.id]||U]),delete this._reverseStreams[this._streams[U.id]?this._streams[U.id].id:U.id],delete this._streams[U.id]},r.RTCPeerConnection.prototype.addTrack=function(U,Z){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const ae=[].slice.call(arguments,1);if(ae.length!==1||!ae[0].getTracks().find(we=>we===U))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(we=>we.track===U))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const ce=this._streams[Z.id];if(ce)ce.addTrack(U),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const we=new r.MediaStream([U]);this._streams[Z.id]=we,this._reverseStreams[we.id]=Z,this.addStream(we)}return this.getSenders().find(we=>we.track===U)},["createOffer","createAnswer"].forEach(function(U){const Z=r.RTCPeerConnection.prototype[U],ae={[U](){const ce=arguments;return arguments.length&&typeof arguments[0]=="function"?Z.apply(this,[we=>{const Pe=A(this,we);ce[0].apply(null,[Pe])},we=>{ce[1]&&ce[1].apply(null,we)},arguments[2]]):Z.apply(this,arguments).then(we=>A(this,we))}};r.RTCPeerConnection.prototype[U]=ae[U]});const L=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(U,Z){let ae=Z.sdp;return Object.keys(U._reverseStreams||[]).forEach(ce=>{const we=U._reverseStreams[ce],Pe=U._streams[we.id];ae=ae.replace(new RegExp(we.id,"g"),Pe.id)}),new RTCSessionDescription({type:Z.type,sdp:ae})}(this,arguments[0]),L.apply(this,arguments)):L.apply(this,arguments)};const B=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const U=B.get.apply(this);return U.type===""?U:A(this,U)}}),r.RTCPeerConnection.prototype.removeTrack=function(U){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!U._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(U._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let Z;this._streams=this._streams||{},Object.keys(this._streams).forEach(ae=>{this._streams[ae].getTracks().find(ce=>U.track===ce)&&(Z=this._streams[ae])}),Z&&(Z.getTracks().length===1?this.removeStream(this._reverseStreams[Z.id]):Z.removeTrack(U.track),this.dispatchEvent(new Event("negotiationneeded")))}}function fw(r,l){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&l.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const g=r.RTCPeerConnection.prototype[d],C={[d](){return arguments[0]=new(d==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),g.apply(this,arguments)}};r.RTCPeerConnection.prototype[d]=C[d]})}function s4(r,l){ef(r,"negotiationneeded",d=>{const g=d.target;if(!(l.version<72||g.getConfiguration&&g.getConfiguration().sdpSemantics==="plan-b")||g.signalingState==="stable")return d})}var l4=Object.freeze({__proto__:null,shimMediaStream:e4,shimOnTrack:t4,shimGetSendersWithDtmf:n4,shimGetStats:o4,shimSenderReceiverGetStats:r4,shimAddTrackRemoveTrackWithNative:i4,shimAddTrackRemoveTrack:a4,shimPeerConnection:fw,fixNegotiationNeeded:s4,shimGetUserMedia:Q3,shimGetDisplayMedia:function(r,l){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(typeof l=="function"?r.navigator.mediaDevices.getDisplayMedia=function(d){return l(d).then(g=>{const C=d.video&&d.video.width,A=d.video&&d.video.height,L=d.video&&d.video.frameRate;return d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:g,maxFrameRate:L||3}},C&&(d.video.mandatory.maxWidth=C),A&&(d.video.mandatory.maxHeight=A),r.navigator.mediaDevices.getUserMedia(d)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function c4(r,l){const d=r&&r.navigator,g=r&&r.MediaStreamTrack;if(d.getUserMedia=function(C,A,L){dw("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),d.mediaDevices.getUserMedia(C).then(A,L)},!(l.version>55&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){const C=function(L,B,U){B in L&&!(U in L)&&(L[U]=L[B],delete L[B])},A=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(L){return typeof L=="object"&&typeof L.audio=="object"&&(L=JSON.parse(JSON.stringify(L)),C(L.audio,"autoGainControl","mozAutoGainControl"),C(L.audio,"noiseSuppression","mozNoiseSuppression")),A(L)},g&&g.prototype.getSettings){const L=g.prototype.getSettings;g.prototype.getSettings=function(){const B=L.apply(this,arguments);return C(B,"mozAutoGainControl","autoGainControl"),C(B,"mozNoiseSuppression","noiseSuppression"),B}}if(g&&g.prototype.applyConstraints){const L=g.prototype.applyConstraints;g.prototype.applyConstraints=function(B){return this.kind==="audio"&&typeof B=="object"&&(B=JSON.parse(JSON.stringify(B)),C(B,"autoGainControl","mozAutoGainControl"),C(B,"noiseSuppression","mozNoiseSuppression")),L.apply(this,[B])}}}}function u4(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pw(r,l){if(typeof r!="object"||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),l.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(C){const A=r.RTCPeerConnection.prototype[C],L={[C](){return arguments[0]=new(C==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),A.apply(this,arguments)}};r.RTCPeerConnection.prototype[C]=L[C]});const d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[C,A,L]=arguments;return g.apply(this,[C||null]).then(B=>{if(l.version<53&&!A)try{B.forEach(U=>{U.type=d[U.type]||U.type})}catch(U){if(U.name!=="TypeError")throw U;B.forEach((Z,ae)=>{B.set(ae,Object.assign({},Z,{type:d[Z.type]||Z.type}))})}return B}).then(A,L)}}function d4(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const l=r.RTCPeerConnection.prototype.getSenders;l&&(r.RTCPeerConnection.prototype.getSenders=function(){const g=l.apply(this,[]);return g.forEach(C=>C._pc=this),g});const d=r.RTCPeerConnection.prototype.addTrack;d&&(r.RTCPeerConnection.prototype.addTrack=function(){const g=d.apply(this,arguments);return g._pc=this,g}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function h4(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const l=r.RTCPeerConnection.prototype.getReceivers;l&&(r.RTCPeerConnection.prototype.getReceivers=function(){const d=l.apply(this,[]);return d.forEach(g=>g._pc=this),d}),ef(r,"track",d=>(d.receiver._pc=d.srcElement,d)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function f4(r){r.RTCPeerConnection&&!("removeStream"in r.RTCPeerConnection.prototype)&&(r.RTCPeerConnection.prototype.removeStream=function(l){dw("removeStream","removeTrack"),this.getSenders().forEach(d=>{d.track&&l.getTracks().includes(d.track)&&this.removeTrack(d)})})}function p4(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function m4(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype.addTransceiver;l&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let d=arguments[1]&&arguments[1].sendEncodings;d===void 0&&(d=[]),d=[...d];const g=d.length>0;g&&d.forEach(A=>{if("rid"in A&&!/^[a-z0-9]{0,16}$/i.test(A.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in A&&!(parseFloat(A.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in A&&!(parseFloat(A.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const C=l.apply(this,arguments);if(g){const{sender:A}=C,L=A.getParameters();(!("encodings"in L)||L.encodings.length===1&&Object.keys(L.encodings[0]).length===0)&&(L.encodings=d,A.sendEncodings=d,this.setParametersPromises.push(A.setParameters(L).then(()=>{delete A.sendEncodings}).catch(()=>{delete A.sendEncodings})))}return C})}function g4(r){if(typeof r!="object"||!r.RTCRtpSender)return;const l=r.RTCRtpSender.prototype.getParameters;l&&(r.RTCRtpSender.prototype.getParameters=function(){const d=l.apply(this,arguments);return"encodings"in d||(d.encodings=[].concat(this.sendEncodings||[{}])),d})}function v4(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>l.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):l.apply(this,arguments)}}function _4(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>l.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):l.apply(this,arguments)}}var y4=Object.freeze({__proto__:null,shimOnTrack:u4,shimPeerConnection:pw,shimSenderGetStats:d4,shimReceiverGetStats:h4,shimRemoveStream:f4,shimRTCDataChannel:p4,shimAddTransceiver:m4,shimGetParameters:g4,shimCreateOffer:v4,shimCreateAnswer:_4,shimGetUserMedia:c4,shimGetDisplayMedia:function(r,l){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video){const g=new DOMException("getDisplayMedia without video constraints is undefined");return g.name="NotFoundError",g.code=8,Promise.reject(g)}return d.video===!0?d.video={mediaSource:l}:d.video.mediaSource=l,r.navigator.mediaDevices.getUserMedia(d)})}});function I4(r){if(typeof r=="object"&&r.RTCPeerConnection){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const l=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(d){this._localStreams||(this._localStreams=[]),this._localStreams.includes(d)||this._localStreams.push(d),d.getAudioTracks().forEach(g=>l.call(this,g,d)),d.getVideoTracks().forEach(g=>l.call(this,g,d))},r.RTCPeerConnection.prototype.addTrack=function(d,...g){return g&&g.forEach(C=>{this._localStreams?this._localStreams.includes(C)||this._localStreams.push(C):this._localStreams=[C]}),l.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(l){this._localStreams||(this._localStreams=[]);const d=this._localStreams.indexOf(l);if(d===-1)return;this._localStreams.splice(d,1);const g=l.getTracks();this.getSenders().forEach(C=>{g.includes(C.track)&&this.removeTrack(C)})})}}function b4(r){if(typeof r=="object"&&r.RTCPeerConnection&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(d){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=d),this.addEventListener("track",this._onaddstreampoly=g=>{g.streams.forEach(C=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(C))return;this._remoteStreams.push(C);const A=new Event("addstream");A.stream=C,this.dispatchEvent(A)})})}});const l=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const d=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(g){g.streams.forEach(C=>{if(d._remoteStreams||(d._remoteStreams=[]),d._remoteStreams.indexOf(C)>=0)return;d._remoteStreams.push(C);const A=new Event("addstream");A.stream=C,d.dispatchEvent(A)})}),l.apply(d,arguments)}}}function C4(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype,d=l.createOffer,g=l.createAnswer,C=l.setLocalDescription,A=l.setRemoteDescription,L=l.addIceCandidate;l.createOffer=function(U,Z){const ae=arguments.length>=2?arguments[2]:arguments[0],ce=d.apply(this,[ae]);return Z?(ce.then(U,Z),Promise.resolve()):ce},l.createAnswer=function(U,Z){const ae=arguments.length>=2?arguments[2]:arguments[0],ce=g.apply(this,[ae]);return Z?(ce.then(U,Z),Promise.resolve()):ce};let B=function(U,Z,ae){const ce=C.apply(this,[U]);return ae?(ce.then(Z,ae),Promise.resolve()):ce};l.setLocalDescription=B,B=function(U,Z,ae){const ce=A.apply(this,[U]);return ae?(ce.then(Z,ae),Promise.resolve()):ce},l.setRemoteDescription=B,B=function(U,Z,ae){const ce=L.apply(this,[U]);return ae?(ce.then(Z,ae),Promise.resolve()):ce},l.addIceCandidate=B}function S4(r){const l=r&&r.navigator;if(l.mediaDevices&&l.mediaDevices.getUserMedia){const d=l.mediaDevices,g=d.getUserMedia.bind(d);l.mediaDevices.getUserMedia=C=>g(E4(C))}!l.getUserMedia&&l.mediaDevices&&l.mediaDevices.getUserMedia&&(l.getUserMedia=(function(d,g,C){l.mediaDevices.getUserMedia(d).then(g,C)}).bind(l))}function E4(r){return r&&r.video!==void 0?Object.assign({},r,{video:J3(r.video)}):r}function T4(r){if(!r.RTCPeerConnection)return;const l=r.RTCPeerConnection;r.RTCPeerConnection=function(d,g){if(d&&d.iceServers){const C=[];for(let A=0;A<d.iceServers.length;A++){let L=d.iceServers[A];L.urls===void 0&&L.url?(dw("RTCIceServer.url","RTCIceServer.urls"),L=JSON.parse(JSON.stringify(L)),L.urls=L.url,delete L.url,C.push(L)):C.push(d.iceServers[A])}d.iceServers=C}return new l(d,g)},r.RTCPeerConnection.prototype=l.prototype,"generateCertificate"in l&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:()=>l.generateCertificate})}function M4(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function k4(r){const l=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(d){if(d){d.offerToReceiveAudio!==void 0&&(d.offerToReceiveAudio=!!d.offerToReceiveAudio);const g=this.getTransceivers().find(A=>A.receiver.track.kind==="audio");d.offerToReceiveAudio===!1&&g?g.direction==="sendrecv"?g.setDirection?g.setDirection("sendonly"):g.direction="sendonly":g.direction==="recvonly"&&(g.setDirection?g.setDirection("inactive"):g.direction="inactive"):d.offerToReceiveAudio!==!0||g||this.addTransceiver("audio",{direction:"recvonly"}),d.offerToReceiveVideo!==void 0&&(d.offerToReceiveVideo=!!d.offerToReceiveVideo);const C=this.getTransceivers().find(A=>A.receiver.track.kind==="video");d.offerToReceiveVideo===!1&&C?C.direction==="sendrecv"?C.setDirection?C.setDirection("sendonly"):C.direction="sendonly":C.direction==="recvonly"&&(C.setDirection?C.setDirection("inactive"):C.direction="inactive"):d.offerToReceiveVideo!==!0||C||this.addTransceiver("video",{direction:"recvonly"})}return l.apply(this,arguments)}}function w4(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}var R4=Object.freeze({__proto__:null,shimLocalStreamsAPI:I4,shimRemoteStreamsAPI:b4,shimCallbacksAPI:C4,shimGetUserMedia:S4,shimConstraints:E4,shimRTCIceServerUrls:T4,shimTrackEventTransceiver:M4,shimCreateOfferLegacy:k4,shimAudioContext:w4}),uC={},Vne={get exports(){return uC},set exports(r){uC=r}};(function(r){const l={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};l.localCName=l.generateIdentifier(),l.splitLines=function(d){return d.trim().split(`
`).map(g=>g.trim())},l.splitSections=function(d){return d.split(`
m=`).map((g,C)=>(C>0?"m="+g:g).trim()+`\r
`)},l.getDescription=function(d){const g=l.splitSections(d);return g&&g[0]},l.getMediaSections=function(d){const g=l.splitSections(d);return g.shift(),g},l.matchPrefix=function(d,g){return l.splitLines(d).filter(C=>C.indexOf(g)===0)},l.parseCandidate=function(d){let g;g=d.indexOf("a=candidate:")===0?d.substring(12).split(" "):d.substring(10).split(" ");const C={foundation:g[0],component:{1:"rtp",2:"rtcp"}[g[1]]||g[1],protocol:g[2].toLowerCase(),priority:parseInt(g[3],10),ip:g[4],address:g[4],port:parseInt(g[5],10),type:g[7]};for(let A=8;A<g.length;A+=2)switch(g[A]){case"raddr":C.relatedAddress=g[A+1];break;case"rport":C.relatedPort=parseInt(g[A+1],10);break;case"tcptype":C.tcpType=g[A+1];break;case"ufrag":C.ufrag=g[A+1],C.usernameFragment=g[A+1];break;default:C[g[A]]===void 0&&(C[g[A]]=g[A+1])}return C},l.writeCandidate=function(d){const g=[];g.push(d.foundation);const C=d.component;C==="rtp"?g.push(1):C==="rtcp"?g.push(2):g.push(C),g.push(d.protocol.toUpperCase()),g.push(d.priority),g.push(d.address||d.ip),g.push(d.port);const A=d.type;return g.push("typ"),g.push(A),A!=="host"&&d.relatedAddress&&d.relatedPort&&(g.push("raddr"),g.push(d.relatedAddress),g.push("rport"),g.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(g.push("tcptype"),g.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(g.push("ufrag"),g.push(d.usernameFragment||d.ufrag)),"candidate:"+g.join(" ")},l.parseIceOptions=function(d){return d.substring(14).split(" ")},l.parseRtpMap=function(d){let g=d.substring(9).split(" ");const C={payloadType:parseInt(g.shift(),10)};return g=g[0].split("/"),C.name=g[0],C.clockRate=parseInt(g[1],10),C.channels=g.length===3?parseInt(g[2],10):1,C.numChannels=C.channels,C},l.writeRtpMap=function(d){let g=d.payloadType;d.preferredPayloadType!==void 0&&(g=d.preferredPayloadType);const C=d.channels||d.numChannels||1;return"a=rtpmap:"+g+" "+d.name+"/"+d.clockRate+(C!==1?"/"+C:"")+`\r
`},l.parseExtmap=function(d){const g=d.substring(9).split(" ");return{id:parseInt(g[0],10),direction:g[0].indexOf("/")>0?g[0].split("/")[1]:"sendrecv",uri:g[1],attributes:g.slice(2).join(" ")}},l.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+(d.attributes?" "+d.attributes:"")+`\r
`},l.parseFmtp=function(d){const g={};let C;const A=d.substring(d.indexOf(" ")+1).split(";");for(let L=0;L<A.length;L++)C=A[L].trim().split("="),g[C[0].trim()]=C[1];return g},l.writeFmtp=function(d){let g="",C=d.payloadType;if(d.preferredPayloadType!==void 0&&(C=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){const A=[];Object.keys(d.parameters).forEach(L=>{d.parameters[L]!==void 0?A.push(L+"="+d.parameters[L]):A.push(L)}),g+="a=fmtp:"+C+" "+A.join(";")+`\r
`}return g},l.parseRtcpFb=function(d){const g=d.substring(d.indexOf(" ")+1).split(" ");return{type:g.shift(),parameter:g.join(" ")}},l.writeRtcpFb=function(d){let g="",C=d.payloadType;return d.preferredPayloadType!==void 0&&(C=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(A=>{g+="a=rtcp-fb:"+C+" "+A.type+(A.parameter&&A.parameter.length?" "+A.parameter:"")+`\r
`}),g},l.parseSsrcMedia=function(d){const g=d.indexOf(" "),C={ssrc:parseInt(d.substring(7,g),10)},A=d.indexOf(":",g);return A>-1?(C.attribute=d.substring(g+1,A),C.value=d.substring(A+1)):C.attribute=d.substring(g+1),C},l.parseSsrcGroup=function(d){const g=d.substring(13).split(" ");return{semantics:g.shift(),ssrcs:g.map(C=>parseInt(C,10))}},l.getMid=function(d){const g=l.matchPrefix(d,"a=mid:")[0];if(g)return g.substring(6)},l.parseFingerprint=function(d){const g=d.substring(14).split(" ");return{algorithm:g[0].toLowerCase(),value:g[1].toUpperCase()}},l.getDtlsParameters=function(d,g){return{role:"auto",fingerprints:l.matchPrefix(d+g,"a=fingerprint:").map(l.parseFingerprint)}},l.writeDtlsParameters=function(d,g){let C="a=setup:"+g+`\r
`;return d.fingerprints.forEach(A=>{C+="a=fingerprint:"+A.algorithm+" "+A.value+`\r
`}),C},l.parseCryptoLine=function(d){const g=d.substring(9).split(" ");return{tag:parseInt(g[0],10),cryptoSuite:g[1],keyParams:g[2],sessionParams:g.slice(3)}},l.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+(typeof d.keyParams=="object"?l.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+`\r
`},l.parseCryptoKeyParams=function(d){if(d.indexOf("inline:")!==0)return null;const g=d.substring(7).split("|");return{keyMethod:"inline",keySalt:g[0],lifeTime:g[1],mkiValue:g[2]?g[2].split(":")[0]:void 0,mkiLength:g[2]?g[2].split(":")[1]:void 0}},l.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")},l.getCryptoParameters=function(d,g){return l.matchPrefix(d+g,"a=crypto:").map(l.parseCryptoLine)},l.getIceParameters=function(d,g){const C=l.matchPrefix(d+g,"a=ice-ufrag:")[0],A=l.matchPrefix(d+g,"a=ice-pwd:")[0];return C&&A?{usernameFragment:C.substring(12),password:A.substring(10)}:null},l.writeIceParameters=function(d){let g="a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`;return d.iceLite&&(g+=`a=ice-lite\r
`),g},l.parseRtpParameters=function(d){const g={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},C=l.splitLines(d)[0].split(" ");g.profile=C[2];for(let L=3;L<C.length;L++){const B=C[L],U=l.matchPrefix(d,"a=rtpmap:"+B+" ")[0];if(U){const Z=l.parseRtpMap(U),ae=l.matchPrefix(d,"a=fmtp:"+B+" ");switch(Z.parameters=ae.length?l.parseFmtp(ae[0]):{},Z.rtcpFeedback=l.matchPrefix(d,"a=rtcp-fb:"+B+" ").map(l.parseRtcpFb),g.codecs.push(Z),Z.name.toUpperCase()){case"RED":case"ULPFEC":g.fecMechanisms.push(Z.name.toUpperCase())}}}l.matchPrefix(d,"a=extmap:").forEach(L=>{g.headerExtensions.push(l.parseExtmap(L))});const A=l.matchPrefix(d,"a=rtcp-fb:* ").map(l.parseRtcpFb);return g.codecs.forEach(L=>{A.forEach(B=>{L.rtcpFeedback.find(U=>U.type===B.type&&U.parameter===B.parameter)||L.rtcpFeedback.push(B)})}),g},l.writeRtpDescription=function(d,g){let C="";C+="m="+d+" ",C+=g.codecs.length>0?"9":"0",C+=" "+(g.profile||"UDP/TLS/RTP/SAVPF")+" ",C+=g.codecs.map(L=>L.preferredPayloadType!==void 0?L.preferredPayloadType:L.payloadType).join(" ")+`\r
`,C+=`c=IN IP4 0.0.0.0\r
`,C+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,g.codecs.forEach(L=>{C+=l.writeRtpMap(L),C+=l.writeFmtp(L),C+=l.writeRtcpFb(L)});let A=0;return g.codecs.forEach(L=>{L.maxptime>A&&(A=L.maxptime)}),A>0&&(C+="a=maxptime:"+A+`\r
`),g.headerExtensions&&g.headerExtensions.forEach(L=>{C+=l.writeExtmap(L)}),C},l.parseRtpEncodingParameters=function(d){const g=[],C=l.parseRtpParameters(d),A=C.fecMechanisms.indexOf("RED")!==-1,L=C.fecMechanisms.indexOf("ULPFEC")!==-1,B=l.matchPrefix(d,"a=ssrc:").map(we=>l.parseSsrcMedia(we)).filter(we=>we.attribute==="cname"),U=B.length>0&&B[0].ssrc;let Z;const ae=l.matchPrefix(d,"a=ssrc-group:FID").map(we=>we.substring(17).split(" ").map(Pe=>parseInt(Pe,10)));ae.length>0&&ae[0].length>1&&ae[0][0]===U&&(Z=ae[0][1]),C.codecs.forEach(we=>{if(we.name.toUpperCase()==="RTX"&&we.parameters.apt){let Pe={ssrc:U,codecPayloadType:parseInt(we.parameters.apt,10)};U&&Z&&(Pe.rtx={ssrc:Z}),g.push(Pe),A&&(Pe=JSON.parse(JSON.stringify(Pe)),Pe.fec={ssrc:U,mechanism:L?"red+ulpfec":"red"},g.push(Pe))}}),g.length===0&&U&&g.push({ssrc:U});let ce=l.matchPrefix(d,"b=");return ce.length&&(ce=ce[0].indexOf("b=TIAS:")===0?parseInt(ce[0].substring(7),10):ce[0].indexOf("b=AS:")===0?1e3*parseInt(ce[0].substring(5),10)*.95-16e3:void 0,g.forEach(we=>{we.maxBitrate=ce})),g},l.parseRtcpParameters=function(d){const g={},C=l.matchPrefix(d,"a=ssrc:").map(B=>l.parseSsrcMedia(B)).filter(B=>B.attribute==="cname")[0];C&&(g.cname=C.value,g.ssrc=C.ssrc);const A=l.matchPrefix(d,"a=rtcp-rsize");g.reducedSize=A.length>0,g.compound=A.length===0;const L=l.matchPrefix(d,"a=rtcp-mux");return g.mux=L.length>0,g},l.writeRtcpParameters=function(d){let g="";return d.reducedSize&&(g+=`a=rtcp-rsize\r
`),d.mux&&(g+=`a=rtcp-mux\r
`),d.ssrc!==void 0&&d.cname&&(g+="a=ssrc:"+d.ssrc+" cname:"+d.cname+`\r
`),g},l.parseMsid=function(d){let g;const C=l.matchPrefix(d,"a=msid:");if(C.length===1)return g=C[0].substring(7).split(" "),{stream:g[0],track:g[1]};const A=l.matchPrefix(d,"a=ssrc:").map(L=>l.parseSsrcMedia(L)).filter(L=>L.attribute==="msid");return A.length>0?(g=A[0].value.split(" "),{stream:g[0],track:g[1]}):void 0},l.parseSctpDescription=function(d){const g=l.parseMLine(d),C=l.matchPrefix(d,"a=max-message-size:");let A;C.length>0&&(A=parseInt(C[0].substring(19),10)),isNaN(A)&&(A=65536);const L=l.matchPrefix(d,"a=sctp-port:");if(L.length>0)return{port:parseInt(L[0].substring(12),10),protocol:g.fmt,maxMessageSize:A};const B=l.matchPrefix(d,"a=sctpmap:");if(B.length>0){const U=B[0].substring(10).split(" ");return{port:parseInt(U[0],10),protocol:U[1],maxMessageSize:A}}},l.writeSctpDescription=function(d,g){let C=[];return C=d.protocol!=="DTLS/SCTP"?["m="+d.kind+" 9 "+d.protocol+" "+g.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+g.port+`\r
`]:["m="+d.kind+" 9 "+d.protocol+" "+g.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+g.port+" "+g.protocol+` 65535\r
`],g.maxMessageSize!==void 0&&C.push("a=max-message-size:"+g.maxMessageSize+`\r
`),C.join("")},l.generateSessionId=function(){return Math.random().toString().substr(2,22)},l.writeSessionBoilerplate=function(d,g,C){let A;const L=g!==void 0?g:2;return A=d||l.generateSessionId(),`v=0\r
o=`+(C||"thisisadapterortc")+" "+A+" "+L+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},l.getDirection=function(d,g){const C=l.splitLines(d);for(let A=0;A<C.length;A++)switch(C[A]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return C[A].substring(2)}return g?l.getDirection(g):"sendrecv"},l.getKind=function(d){return l.splitLines(d)[0].split(" ")[0].substring(2)},l.isRejected=function(d){return d.split(" ",2)[1]==="0"},l.parseMLine=function(d){const g=l.splitLines(d)[0].substring(2).split(" ");return{kind:g[0],port:parseInt(g[1],10),protocol:g[2],fmt:g.slice(3).join(" ")}},l.parseOLine=function(d){const g=l.matchPrefix(d,"o=")[0].substring(2).split(" ");return{username:g[0],sessionId:g[1],sessionVersion:parseInt(g[2],10),netType:g[3],addressType:g[4],address:g[5]}},l.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;const g=l.splitLines(d);for(let C=0;C<g.length;C++)if(g[C].length<2||g[C].charAt(1)!=="=")return!1;return!0},r.exports=l})(Vne);var Pm=uC,Gne=o({__proto__:null,default:Pm},[uC]);function dC(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const l=r.RTCIceCandidate;r.RTCIceCandidate=function(d){if(typeof d=="object"&&d.candidate&&d.candidate.indexOf("a=")===0&&((d=JSON.parse(JSON.stringify(d))).candidate=d.candidate.substring(2)),d.candidate&&d.candidate.length){const g=new l(d),C=Pm.parseCandidate(d.candidate);for(const A in C)A in g||Object.defineProperty(g,A,{value:C[A]});return g.toJSON=function(){return{candidate:g.candidate,sdpMid:g.sdpMid,sdpMLineIndex:g.sdpMLineIndex,usernameFragment:g.usernameFragment}},g}return new l(d)},r.RTCIceCandidate.prototype=l.prototype,ef(r,"icecandidate",d=>(d.candidate&&Object.defineProperty(d,"candidate",{value:new r.RTCIceCandidate(d.candidate),writable:"false"}),d))}function mw(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||ef(r,"icecandidate",l=>{if(l.candidate){const d=Pm.parseCandidate(l.candidate.candidate);d.type==="relay"&&(l.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[d.priority>>24])}return l})}function hC(r,l){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const d=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,l.browser==="chrome"&&l.version>=76){const{sdpSemantics:g}=this.getConfiguration();g==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(g){if(!g||!g.sdp)return!1;const C=Pm.splitSections(g.sdp);return C.shift(),C.some(A=>{const L=Pm.parseMLine(A);return L&&L.kind==="application"&&L.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const g=function(U){const Z=U.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(Z===null||Z.length<2)return-1;const ae=parseInt(Z[1],10);return ae!=ae?-1:ae}(arguments[0]),C=function(U){let Z=65536;return l.browser==="firefox"&&(Z=l.version<57?U===-1?16384:2147483637:l.version<60?l.version===57?65535:65536:2147483637),Z}(g),A=function(U,Z){let ae=65536;l.browser==="firefox"&&l.version===57&&(ae=65535);const ce=Pm.matchPrefix(U.sdp,"a=max-message-size:");return ce.length>0?ae=parseInt(ce[0].substring(19),10):l.browser==="firefox"&&Z!==-1&&(ae=2147483637),ae}(arguments[0],g);let L;L=C===0&&A===0?Number.POSITIVE_INFINITY:C===0||A===0?Math.max(C,A):Math.min(C,A);const B={};Object.defineProperty(B,"maxMessageSize",{get:()=>L}),this._sctp=B}return d.apply(this,arguments)}}function fC(r){if(!r.RTCPeerConnection||!("createDataChannel"in r.RTCPeerConnection.prototype))return;function l(g,C){const A=g.send;g.send=function(){const L=arguments[0],B=L.length||L.size||L.byteLength;if(g.readyState==="open"&&C.sctp&&B>C.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+C.sctp.maxMessageSize+" bytes)");return A.apply(g,arguments)}}const d=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const g=d.apply(this,arguments);return l(g,this),g},ef(r,"datachannel",g=>(l(g.channel,g.target),g))}function gw(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const l=r.RTCPeerConnection.prototype;Object.defineProperty(l,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(l,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(d){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),d&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=d)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(d=>{const g=l[d];l[d]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=C=>{const A=C.target;if(A._lastConnectionState!==A.connectionState){A._lastConnectionState=A.connectionState;const L=new Event("connectionstatechange",C);A.dispatchEvent(L)}return C},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),g.apply(this,arguments)}})}function vw(r,l){if(!r.RTCPeerConnection||l.browser==="chrome"&&l.version>=71||l.browser==="safari"&&l.version>=605)return;const d=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(g){if(g&&g.sdp&&g.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const C=g.sdp.split(`
`).filter(A=>A.trim()!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&g instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:g.type,sdp:C}):g.sdp=C}return d.apply(this,arguments)}}function pC(r,l){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const d=r.RTCPeerConnection.prototype.addIceCandidate;d&&d.length!==0&&(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(l.browser==="chrome"&&l.version<78||l.browser==="firefox"&&l.version<68||l.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function mC(r,l){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const d=r.RTCPeerConnection.prototype.setLocalDescription;d&&d.length!==0&&(r.RTCPeerConnection.prototype.setLocalDescription=function(){let g=arguments[0]||{};if(typeof g!="object"||g.type&&g.sdp)return d.apply(this,arguments);if(g={type:g.type,sdp:g.sdp},!g.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":g.type="offer";break;default:g.type="answer"}return g.sdp||g.type!=="offer"&&g.type!=="answer"?d.apply(this,[g]):(g.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(C=>d.apply(this,[C]))})}var Bne=Object.freeze({__proto__:null,shimRTCIceCandidate:dC,shimRTCIceCandidateRelayProtocol:mw,shimMaxMessageSize:hC,shimSendThrowTypeError:fC,shimConnectionState:gw,removeExtmapAllowMixed:vw,shimAddIceCandidateNullOrEmpty:pC,shimParameterlessSetLocalDescription:mC});(function({window:r}={},l={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const d=j3,g=function(A){const L={browser:null,version:null};if(A===void 0||!A.navigator||!A.navigator.userAgent)return L.browser="Not a browser.",L;const{navigator:B}=A;if(B.mozGetUserMedia)L.browser="firefox",L.version=cC(B.userAgent,/Firefox\/(\d+)\./,1);else if(B.webkitGetUserMedia||A.isSecureContext===!1&&A.webkitRTCPeerConnection)L.browser="chrome",L.version=cC(B.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!A.RTCPeerConnection||!B.userAgent.match(/AppleWebKit\/(\d+)\./))return L.browser="Not a supported browser.",L;L.browser="safari",L.version=cC(B.userAgent,/AppleWebKit\/(\d+)\./,1),L.supportsUnifiedPlan=A.RTCRtpTransceiver&&"currentDirection"in A.RTCRtpTransceiver.prototype}return L}(r),C={browserDetails:g,commonShim:Bne,extractVersion:cC,disableLog:Une,disableWarnings:Fne,sdp:Gne};switch(g.browser){case"chrome":if(!l4||!fw||!l.shimChrome)return d("Chrome shim is not included in this adapter release."),C;if(g.version===null)return d("Chrome shim can not determine version, not shimming."),C;d("adapter.js shimming chrome."),C.browserShim=l4,pC(r,g),mC(r),Q3(r,g),e4(r),fw(r,g),t4(r),a4(r,g),n4(r),o4(r),r4(r),s4(r,g),dC(r),mw(r),gw(r),hC(r,g),fC(r),vw(r,g);break;case"firefox":if(!y4||!pw||!l.shimFirefox)return d("Firefox shim is not included in this adapter release."),C;d("adapter.js shimming firefox."),C.browserShim=y4,pC(r,g),mC(r),c4(r,g),pw(r,g),u4(r),f4(r),d4(r),h4(r),p4(r),m4(r),g4(r),v4(r),_4(r),dC(r),gw(r),hC(r,g),fC(r);break;case"safari":if(!R4||!l.shimSafari)return d("Safari shim is not included in this adapter release."),C;d("adapter.js shimming safari."),C.browserShim=R4,pC(r,g),mC(r),T4(r),k4(r),C4(r),I4(r),b4(r),M4(r),S4(r),w4(r),dC(r),mw(r),hC(r,g),fC(r),vw(r,g);break;default:d("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var xn,Hne=Object.create,C_=Object.defineProperty,$ne=Object.defineProperties,A4=Object.getOwnPropertyDescriptor,qne=Object.getOwnPropertyDescriptors,Kne=Object.getOwnPropertyNames,gC=Object.getOwnPropertySymbols,D4=Object.getPrototypeOf,_w=Object.prototype.hasOwnProperty,O4=Object.prototype.propertyIsEnumerable,zne=Reflect.get,yw=Math.pow,Iw=(r,l,d)=>l in r?C_(r,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[l]=d,Fn=(r,l)=>{for(var d in l||(l={}))_w.call(l,d)&&Iw(r,d,l[d]);if(gC)for(var d of gC(l))O4.call(l,d)&&Iw(r,d,l[d]);return r},Io=(r,l)=>$ne(r,qne(l)),kc=(r,l)=>()=>(l||r((l={exports:{}}).exports,l),l.exports),S_=(r,l)=>{for(var d in l)C_(r,d,{get:l[d],enumerable:!0})},Vi=(r,l,d)=>(d=r!=null?Hne(D4(r)):{},((g,C,A,L)=>{if(C&&typeof C=="object"||typeof C=="function")for(let B of Kne(C))!_w.call(g,B)&&B!==A&&C_(g,B,{get:()=>C[B],enumerable:!(L=A4(C,B))||L.enumerable});return g})(!l&&r&&r.__esModule?d:C_(d,"default",{value:r,enumerable:!0}),r)),In=(r,l,d,g)=>{for(var C,A=A4(l,d),L=r.length-1;L>=0;L--)(C=r[L])&&(A=C(l,d,A)||A);return A&&C_(l,d,A),A},Se=(r,l,d)=>(Iw(r,typeof l!="symbol"?l+"":l,d),d),Ys=(r,l,d)=>zne(D4(r),d,l),at=(r,l,d)=>new Promise((g,C)=>{var A=U=>{try{B(d.next(U))}catch(Z){C(Z)}},L=U=>{try{B(d.throw(U))}catch(Z){C(Z)}},B=U=>U.done?g(U.value):Promise.resolve(U.value).then(A,L);B((d=d.apply(r,l)).next())}),qa=kc((r,l)=>{var d=Object.prototype.hasOwnProperty,g="~";function C(){}function A(Z,ae,ce){this.fn=Z,this.context=ae,this.once=ce||!1}function L(Z,ae,ce,we,Pe){if(typeof ce!="function")throw new TypeError("The listener must be a function");var Ze=new A(ce,we||Z,Pe),Ct=g?g+ae:ae;return Z._events[Ct]?Z._events[Ct].fn?Z._events[Ct]=[Z._events[Ct],Ze]:Z._events[Ct].push(Ze):(Z._events[Ct]=Ze,Z._eventsCount++),Z}function B(Z,ae){--Z._eventsCount==0?Z._events=new C:delete Z._events[ae]}function U(){this._events=new C,this._eventsCount=0}Object.create&&(C.prototype=Object.create(null),new C().__proto__||(g=!1)),U.prototype.eventNames=function(){var Z,ae,ce=[];if(this._eventsCount===0)return ce;for(ae in Z=this._events)d.call(Z,ae)&&ce.push(g?ae.slice(1):ae);return Object.getOwnPropertySymbols?ce.concat(Object.getOwnPropertySymbols(Z)):ce},U.prototype.listeners=function(Z){var ae=g?g+Z:Z,ce=this._events[ae];if(!ce)return[];if(ce.fn)return[ce.fn];for(var we=0,Pe=ce.length,Ze=new Array(Pe);we<Pe;we++)Ze[we]=ce[we].fn;return Ze},U.prototype.listenerCount=function(Z){var ae=g?g+Z:Z,ce=this._events[ae];return ce?ce.fn?1:ce.length:0},U.prototype.emit=function(Z,ae,ce,we,Pe,Ze){var Ct=g?g+Z:Z;if(!this._events[Ct])return!1;var Bt,Wt,kt=this._events[Ct],En=arguments.length;if(kt.fn){switch(kt.once&&this.removeListener(Z,kt.fn,void 0,!0),En){case 1:return kt.fn.call(kt.context),!0;case 2:return kt.fn.call(kt.context,ae),!0;case 3:return kt.fn.call(kt.context,ae,ce),!0;case 4:return kt.fn.call(kt.context,ae,ce,we),!0;case 5:return kt.fn.call(kt.context,ae,ce,we,Pe),!0;case 6:return kt.fn.call(kt.context,ae,ce,we,Pe,Ze),!0}for(Wt=1,Bt=new Array(En-1);Wt<En;Wt++)Bt[Wt-1]=arguments[Wt];kt.fn.apply(kt.context,Bt)}else{var Ln,Hn=kt.length;for(Wt=0;Wt<Hn;Wt++)switch(kt[Wt].once&&this.removeListener(Z,kt[Wt].fn,void 0,!0),En){case 1:kt[Wt].fn.call(kt[Wt].context);break;case 2:kt[Wt].fn.call(kt[Wt].context,ae);break;case 3:kt[Wt].fn.call(kt[Wt].context,ae,ce);break;case 4:kt[Wt].fn.call(kt[Wt].context,ae,ce,we);break;default:if(!Bt)for(Ln=1,Bt=new Array(En-1);Ln<En;Ln++)Bt[Ln-1]=arguments[Ln];kt[Wt].fn.apply(kt[Wt].context,Bt)}}return!0},U.prototype.on=function(Z,ae,ce){return L(this,Z,ae,ce,!1)},U.prototype.once=function(Z,ae,ce){return L(this,Z,ae,ce,!0)},U.prototype.removeListener=function(Z,ae,ce,we){var Pe=g?g+Z:Z;if(!this._events[Pe])return this;if(!ae)return B(this,Pe),this;var Ze=this._events[Pe];if(Ze.fn)Ze.fn===ae&&(!we||Ze.once)&&(!ce||Ze.context===ce)&&B(this,Pe);else{for(var Ct=0,Bt=[],Wt=Ze.length;Ct<Wt;Ct++)(Ze[Ct].fn!==ae||we&&!Ze[Ct].once||ce&&Ze[Ct].context!==ce)&&Bt.push(Ze[Ct]);Bt.length?this._events[Pe]=Bt.length===1?Bt[0]:Bt:B(this,Pe)}return this},U.prototype.removeAllListeners=function(Z){var ae;return Z?(ae=g?g+Z:Z,this._events[ae]&&B(this,ae)):(this._events=new C,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=g,U.EventEmitter=U,l!==void 0&&(l.exports=U)}),L4=kc((r,l)=>{var d=l.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(g){return g.encoding?"rtpmap:%d %s/%s/%s":g.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(g){return g.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(g){return g.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(g){return"extmap:%d"+(g.direction?"/%s":"%v")+(g["encrypt-uri"]?" %s":"%v")+" %s"+(g.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(g){return g.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(g){var C="candidate:%s %d %s %d %s %d typ %s";return C+=g.raddr!=null?" raddr %s rport %d":"%v%v",C+=g.tcptype!=null?" tcptype %s":"%v",g.generation!=null&&(C+=" generation %d"),C+=g["network-id"]!=null?" network-id %d":"%v",C+=g["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(g){var C="ssrc:%d";return g.attribute!=null&&(C+=" %s",g.value!=null&&(C+=":%s")),C}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(g){return g.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(g){return g.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(g){return"imageattr:%s %s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(g){return"simulcast:%s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(g){return"ts-refclk:%s"+(g.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(g){var C="mediaclk:";return C+=g.id!=null?"id=%s %s":"%v%s",C+=g.mediaClockValue!=null?"=%s":"",C+=g.rateNumerator!=null?" rate=%s":"",C+=g.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(g){d[g].forEach(function(C){C.reg||(C.reg=/(.*)/),C.format||(C.format="%s")})})}),Wne=kc(r=>{var l=function(L){return String(Number(L))===L?Number(L):L},d=function(L,B,U){var Z=L.name&&L.names;L.push&&!B[L.push]?B[L.push]=[]:Z&&!B[L.name]&&(B[L.name]={});var ae=L.push?{}:Z?B[L.name]:B;(function(ce,we,Pe,Ze){if(Ze&&!Pe)we[Ze]=l(ce[1]);else for(var Ct=0;Ct<Pe.length;Ct+=1)ce[Ct+1]!=null&&(we[Pe[Ct]]=l(ce[Ct+1]))})(U.match(L.reg),ae,L.names,L.name),L.push&&B[L.push].push(ae)},g=L4(),C=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(L){var B={},U=[],Z=B;return L.split(/(\r\n|\r|\n)/).filter(C).forEach(function(ae){var ce=ae[0],we=ae.slice(2);ce==="m"&&(U.push({rtp:[],fmtp:[]}),Z=U[U.length-1]);for(var Pe=0;Pe<(g[ce]||[]).length;Pe+=1){var Ze=g[ce][Pe];if(Ze.reg.test(we))return d(Ze,Z,we)}}),B.media=U,B};var A=function(L,B){var U=B.split(/=(.+)/,2);return U.length===2?L[U[0]]=l(U[1]):U.length===1&&B.length>1&&(L[U[0]]=void 0),L};r.parseParams=function(L){return L.split(/;\s?/).reduce(A,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(L){return L.toString().split(" ").map(Number)},r.parseRemoteCandidates=function(L){for(var B=[],U=L.split(" ").map(l),Z=0;Z<U.length;Z+=3)B.push({component:U[Z],ip:U[Z+1],port:U[Z+2]});return B},r.parseImageAttributes=function(L){return L.split(" ").map(function(B){return B.substring(1,B.length-1).split(",").reduce(A,{})})},r.parseSimulcastStreamList=function(L){return L.split(";").map(function(B){return B.split(",").map(function(U){var Z,ae=!1;return U[0]!=="~"?Z=l(U):(Z=l(U.substring(1,U.length)),ae=!0),{scid:Z,paused:ae}})})}}),jne=kc((r,l)=>{var d=L4(),g=/%[sdv%]/g,C=function(U){var Z=1,ae=arguments,ce=ae.length;return U.replace(g,function(we){if(Z>=ce)return we;var Pe=ae[Z];switch(Z+=1,we){case"%%":return"%";case"%s":return String(Pe);case"%d":return Number(Pe);case"%v":return""}})},A=function(U,Z,ae){var ce=[U+"="+(Z.format instanceof Function?Z.format(Z.push?ae:ae[Z.name]):Z.format)];if(Z.names)for(var we=0;we<Z.names.length;we+=1){var Pe=Z.names[we];Z.name?ce.push(ae[Z.name][Pe]):ce.push(ae[Z.names[we]])}else ce.push(ae[Z.name]);return C.apply(null,ce)},L=["v","o","s","i","u","e","p","c","b","t","r","z","a"],B=["i","c","b","a"];l.exports=function(U,Z){Z=Z||{},U.version==null&&(U.version=0),U.name==null&&(U.name=" "),U.media.forEach(function(Pe){Pe.payloads==null&&(Pe.payloads="")});var ae=Z.outerOrder||L,ce=Z.innerOrder||B,we=[];return ae.forEach(function(Pe){d[Pe].forEach(function(Ze){Ze.name in U&&U[Ze.name]!=null?we.push(A(Pe,Ze,U)):Ze.push in U&&U[Ze.push]!=null&&U[Ze.push].forEach(function(Ct){we.push(A(Pe,Ze,Ct))})})}),U.media.forEach(function(Pe){we.push(A("m",d.m[0],Pe)),ce.forEach(function(Ze){d[Ze].forEach(function(Ct){Ct.name in Pe&&Pe[Ct.name]!=null?we.push(A(Ze,Ct,Pe)):Ct.push in Pe&&Pe[Ct.push]!=null&&Pe[Ct.push].forEach(function(Bt){we.push(A(Ze,Ct,Bt))})})})}),we.join(`\r
`)+`\r
`}}),Yne=kc(r=>{var l=Wne(),d=jne();r.write=d,r.parse=l.parse,r.parseParams=l.parseParams,r.parseFmtpConfig=l.parseFmtpConfig,r.parsePayloads=l.parsePayloads,r.parseRemoteCandidates=l.parseRemoteCandidates,r.parseImageAttributes=l.parseImageAttributes,r.parseSimulcastStreamList=l.parseSimulcastStreamList}),N4=kc((r,l)=>{var d=l.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(g){return g.encoding?"rtpmap:%d %s/%s/%s":g.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(g){return g.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(g){return g.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(g){return"extmap:%d"+(g.direction?"/%s":"%v")+(g["encrypt-uri"]?" %s":"%v")+" %s"+(g.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(g){return g.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(g){var C="candidate:%s %d %s %d %s %d typ %s";return C+=g.raddr!=null?" raddr %s rport %d":"%v%v",C+=g.tcptype!=null?" tcptype %s":"%v",g.generation!=null&&(C+=" generation %d"),C+=g["network-id"]!=null?" network-id %d":"%v",C+=g["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(g){var C="ssrc:%d";return g.attribute!=null&&(C+=" %s",g.value!=null&&(C+=":%s")),C}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(g){return g.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(g){return g.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(g){return"imageattr:%s %s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(g){return"simulcast:%s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(g){return"ts-refclk:%s"+(g.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(g){var C="mediaclk:";return C+=g.id!=null?"id=%s %s":"%v%s",C+=g.mediaClockValue!=null?"=%s":"",C+=g.rateNumerator!=null?" rate=%s":"",C+=g.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(d).forEach(function(g){d[g].forEach(function(C){C.reg||(C.reg=/(.*)/),C.format||(C.format="%s")})})}),Jne=kc(r=>{var l=function(L){return String(Number(L))===L?Number(L):L},d=function(L,B,U){var Z=L.name&&L.names;L.push&&!B[L.push]?B[L.push]=[]:Z&&!B[L.name]&&(B[L.name]={});var ae=L.push?{}:Z?B[L.name]:B;(function(ce,we,Pe,Ze){if(Ze&&!Pe)we[Ze]=l(ce[1]);else for(var Ct=0;Ct<Pe.length;Ct+=1)ce[Ct+1]!=null&&(we[Pe[Ct]]=l(ce[Ct+1]))})(U.match(L.reg),ae,L.names,L.name),L.push&&B[L.push].push(ae)},g=N4(),C=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(L){var B={},U=[],Z=B;return L.split(/(\r\n|\r|\n)/).filter(C).forEach(function(ae){var ce=ae[0],we=ae.slice(2);ce==="m"&&(U.push({rtp:[],fmtp:[]}),Z=U[U.length-1]);for(var Pe=0;Pe<(g[ce]||[]).length;Pe+=1){var Ze=g[ce][Pe];if(Ze.reg.test(we))return d(Ze,Z,we)}}),B.media=U,B};var A=function(L,B){var U=B.split(/=(.+)/,2);return U.length===2?L[U[0]]=l(U[1]):U.length===1&&B.length>1&&(L[U[0]]=void 0),L};r.parseParams=function(L){return L.split(/;\s?/).reduce(A,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(L){return L.toString().split(" ").map(Number)},r.parseRemoteCandidates=function(L){for(var B=[],U=L.split(" ").map(l),Z=0;Z<U.length;Z+=3)B.push({component:U[Z],ip:U[Z+1],port:U[Z+2]});return B},r.parseImageAttributes=function(L){return L.split(" ").map(function(B){return B.substring(1,B.length-1).split(",").reduce(A,{})})},r.parseSimulcastStreamList=function(L){return L.split(";").map(function(B){return B.split(",").map(function(U){var Z,ae=!1;return U[0]!=="~"?Z=l(U):(Z=l(U.substring(1,U.length)),ae=!0),{scid:Z,paused:ae}})})}}),Xne=kc((r,l)=>{var d=N4(),g=/%[sdv%]/g,C=function(U){var Z=1,ae=arguments,ce=ae.length;return U.replace(g,function(we){if(Z>=ce)return we;var Pe=ae[Z];switch(Z+=1,we){case"%%":return"%";case"%s":return String(Pe);case"%d":return Number(Pe);case"%v":return""}})},A=function(U,Z,ae){var ce=[U+"="+(Z.format instanceof Function?Z.format(Z.push?ae:ae[Z.name]):Z.format)];if(Z.names)for(var we=0;we<Z.names.length;we+=1){var Pe=Z.names[we];Z.name?ce.push(ae[Z.name][Pe]):ce.push(ae[Z.names[we]])}else ce.push(ae[Z.name]);return C.apply(null,ce)},L=["v","o","s","i","u","e","p","c","b","t","r","z","a"],B=["i","c","b","a"];l.exports=function(U,Z){Z=Z||{},U.version==null&&(U.version=0),U.name==null&&(U.name=" "),U.media.forEach(function(Pe){Pe.payloads==null&&(Pe.payloads="")});var ae=Z.outerOrder||L,ce=Z.innerOrder||B,we=[];return ae.forEach(function(Pe){d[Pe].forEach(function(Ze){Ze.name in U&&U[Ze.name]!=null?we.push(A(Pe,Ze,U)):Ze.push in U&&U[Ze.push]!=null&&U[Ze.push].forEach(function(Ct){we.push(A(Pe,Ze,Ct))})})}),U.media.forEach(function(Pe){we.push(A("m",d.m[0],Pe)),ce.forEach(function(Ze){d[Ze].forEach(function(Ct){Ct.name in Pe&&Pe[Ct.name]!=null?we.push(A(Ze,Ct,Pe)):Ct.push in Pe&&Pe[Ct.push]!=null&&Pe[Ct.push].forEach(function(Bt){we.push(A(Ze,Ct,Bt))})})})}),we.join(`\r
`)+`\r
`}}),P4=kc(r=>{var l=Jne(),d=Xne();r.write=d,r.parse=l.parse,r.parseParams=l.parseParams,r.parseFmtpConfig=l.parseFmtpConfig,r.parsePayloads=l.parsePayloads,r.parseRemoteCandidates=l.parseRemoteCandidates,r.parseImageAttributes=l.parseImageAttributes,r.parseSimulcastStreamList=l.parseSimulcastStreamList}),Zne=Vi(qa()),x4=((xn=x4||{})[xn.INVALID_PARAMETER=4096]="INVALID_PARAMETER",xn[xn.INVALID_OPERATION=4097]="INVALID_OPERATION",xn[xn.NOT_SUPPORTED=4098]="NOT_SUPPORTED",xn[xn.DEVICE_NOT_FOUND=4099]="DEVICE_NOT_FOUND",xn[xn.INITIALIZE_FAILED=4100]="INITIALIZE_FAILED",xn[xn.SIGNAL_CHANNEL_SETUP_FAILED=16385]="SIGNAL_CHANNEL_SETUP_FAILED",xn[xn.SIGNAL_CHANNEL_ERROR=16386]="SIGNAL_CHANNEL_ERROR",xn[xn.ICE_TRANSPORT_ERROR=16387]="ICE_TRANSPORT_ERROR",xn[xn.JOIN_ROOM_FAILED=16388]="JOIN_ROOM_FAILED",xn[xn.CREATE_OFFER_FAILED=16389]="CREATE_OFFER_FAILED",xn[xn.SIGNAL_CHANNEL_RECONNECTION_FAILED=16390]="SIGNAL_CHANNEL_RECONNECTION_FAILED",xn[xn.UPLINK_RECONNECTION_FAILED=16391]="UPLINK_RECONNECTION_FAILED",xn[xn.DOWNLINK_RECONNECTION_FAILED=16392]="DOWNLINK_RECONNECTION_FAILED",xn[xn.REMOTE_STREAM_NOT_EXIST=16400]="REMOTE_STREAM_NOT_EXIST",xn[xn.CLIENT_BANNED=16448]="CLIENT_BANNED",xn[xn.SERVER_TIMEOUT=16449]="SERVER_TIMEOUT",xn[xn.SUBSCRIPTION_TIMEOUT=16450]="SUBSCRIPTION_TIMEOUT",xn[xn.PLAY_NOT_ALLOWED=16451]="PLAY_NOT_ALLOWED",xn[xn.DEVICE_AUTO_RECOVER_FAILED=16452]="DEVICE_AUTO_RECOVER_FAILED",xn[xn.START_PUBLISH_CDN_FAILED=16453]="START_PUBLISH_CDN_FAILED",xn[xn.STOP_PUBLISH_CDN_FAILED=16454]="STOP_PUBLISH_CDN_FAILED",xn[xn.START_MIX_TRANSCODE_FAILED=16455]="START_MIX_TRANSCODE_FAILED",xn[xn.STOP_MIX_TRANSCODE_FAILED=16456]="STOP_MIX_TRANSCODE_FAILED",xn[xn.NOT_SUPPORTED_H264=16457]="NOT_SUPPORTED_H264",xn[xn.SWITCH_ROLE_FAILED=16458]="SWITCH_ROLE_FAILED",xn[xn.API_CALL_TIMEOUT=16459]="API_CALL_TIMEOUT",xn[xn.SCHEDULE_FAILED=16460]="SCHEDULE_FAILED",xn[xn.API_CALL_ABORTED=16461]="API_CALL_ABORTED",xn[xn.SPC_INITIALIZED_FAILED=16462]="SPC_INITIALIZED_FAILED",xn[xn.UNKNOWN=65535]="UNKNOWN",xn),an=x4,Qne=class extends Error{constructor(r){let{name:l="RtcError",message:d,code:g=an.UNKNOWN,extraCode:C=0,constraint:A}=r,L="<".concat(function(U){for(let Z in an)if(an[Z]===U)return Z;return"UNKNOWN"}(g)," 0x").concat(g.toString(16),">"),B="".concat(d).concat(A?" constraint: ".concat(A):"").concat(d!=null&&d.includes(L)?"":" ".concat(L));super(B),Se(this,"code"),Se(this,"extraCode"),Se(this,"message"),Se(this,"originMessage"),Se(this,"name"),Se(this,"constraint"),this.code=g,this.extraCode=C,this.name=l,this.message=B,this.constraint=A,this.originMessage=d}getCode(){return this.code}getExtraCode(){return this.extraCode}toString(){return this.originMessage}},Rn=Qne,bw=(new Date().getTime(),0),Cw=function(){return new Date().getTime()+bw},U4=function(){let r=new Date;return r.setTime(Cw()),r.toLocaleString()},Dl={};S_(Dl,{bytes2ms:()=>xoe,convertObjectNumberToInt:()=>mR,copyProperties:()=>Poe,deepClone:()=>X_,deepMerge:()=>cf,fibonacci:()=>Y_,formatedTime:()=>zoe,getAbilityConfigUrl:()=>Ooe,getConstructorName:()=>DF,getContainerFromElement:()=>qoe,getEnv:()=>Noe,getInternalVersion:()=>Boe,getLoggerUrl:()=>W_,getMuteStateFromFlag:()=>J_,getNetworkType:()=>MF,getNumNetworkType:()=>UC,getReconnectionTimeout:()=>$m,getStringByteLength:()=>pR,getTurnServer:()=>$oe,getUint32Version:()=>xF,getValueType:()=>ya,getViewListFromView:()=>VC,glog:()=>Foe,ipv4ToUint32:()=>FC,isArray:()=>Gi,isAudioWorkletSupported:()=>Goe,isBoolean:()=>za,isConstructor:()=>hR,isEmpty:()=>LF,isFunction:()=>Er,isLangChinese:()=>nd,isMediaStreamTrack:()=>Voe,isNumber:()=>Ti,isObject:()=>od,isOverseaSdkAppId:()=>xC,isPlainObject:()=>Dc,isPortrait:()=>PF,isPromise:()=>dR,isRemoteTrack:()=>qm,isString:()=>rr,isUndefined:()=>Ft,loadImage:()=>GC,ms2bytes:()=>Uoe,ms2samples:()=>AF,performanceNow:()=>xo,promiseAny:()=>fR,samples2ms:()=>RF,setNetworkType:()=>wF,stringify:()=>Oc,stringifyIncludeValue:()=>NF});var F4={};S_(F4,{AUDIO_MUTE_BIT:()=>Lw,AUDIO_STAT_BIT:()=>w_,AUX_STAT_BIT:()=>_C,AUX_STREAM_MSID:()=>j4,BACKEND_ENV:()=>Dw,BASE_DOC_URL:()=>tf,BASE_HOST:()=>kw,CAPABILITIES_KEYS:()=>Fw,CLASS_NAME:()=>_oe,CLOUD_CONSOLE_URL:()=>toe,DATA_FREEZE_TIMING:()=>Pw,DOC_URL:()=>noe,DTLS_STATE_UNKNOWN:()=>Xu,ENV_NAME:()=>nf,EXCHANGE_SDP_TIMEOUT:()=>eF,INTERVAL:()=>SC,IS_WORKER:()=>vC,IS_WORKLET:()=>Tw,KIBANA_EVENT:()=>wc,LOCAL_STREAM_PUBLISH_STATE:()=>tF,LOGGER_CMD_TYPE:()=>M_,LOGGER_DOMAIN:()=>H4,LOGGER_DOMAIN_OVERSEA:()=>$4,LOG_LEVEL:()=>Ju,LOG_LEVEL_NAME:()=>Ioe,MAIN_STREAM_MSID:()=>yC,MICROPHONE_COMMUNICATIONS:()=>yoe,MICROPHONE_DEFAULT:()=>A_,NAME:()=>Be,NETWORK_TYPE:()=>ww,NOT_SUPPORTED_H264:()=>bC,PAUSED_RETRY_COUNT:()=>nF,PEERCONNECTION_CONNECTING_TIMEOUT:()=>xw,PEER_CONNECTION_STATE:()=>ni,PEER_LEAVE_REASON:()=>oF,RAF:()=>Uw,RECOVER_CAPTURE_INTERVAL:()=>O_,REMOTE_STREAM_TYPE_AUX:()=>J4,REMOTE_STREAM_TYPE_MAIN:()=>Y4,RENDER_FREEZE_TIMING:()=>poe,RIC:()=>Um,SCHEDULE_DOMAIN:()=>Nl,SCHEDULE_TIMEOUT:()=>voe,SDP_SEMANTICS_PLAN_B:()=>IC,SDP_SEMANTICS_UNIFIED_PLAN:()=>R_,SECOND_HOST:()=>G4,SIGNAL_PING_PONG_INTERVAL:()=>roe,SIGNAL_PING_TIMEOUT:()=>ooe,SIGNAL_RECONNECTION_COUNT:()=>hoe,SMALL_STAT_BIT:()=>Ow,SPEAKER_DEFAULT:()=>CC,STORAGE_EXPIRES_TIME:()=>K4,STREAM_TYPE_BIG:()=>moe,STREAM_TYPE_SMALL:()=>goe,SUBSCRIBE_SMALL_RETRY_COUNT:()=>D_,SYNC_USER_LIST_INTERVAL:()=>foe,Scene:()=>W4,Switch:()=>z4,THIRD_HOST:()=>B4,TIMEOUT:()=>L_,TRANSPORT_DIRECTION:()=>bo,TRTC_ERROR_ASSISTANCE:()=>q4,TRTC_QUALITY_BAD:()=>coe,TRTC_QUALITY_DISCONNECTED:()=>doe,TRTC_QUALITY_EXCELLENT:()=>aoe,TRTC_QUALITY_GOOD:()=>soe,TRTC_QUALITY_POOR:()=>loe,TRTC_QUALITY_UNKNOWN:()=>ioe,TRTC_QUALITY_VERY_BAD:()=>uoe,UPDATE_OFFER_TIMEOUT:()=>Q4,VIDEO_MUTE_BIT:()=>Nw,VIDEO_STAT_BIT:()=>k_,audioProfileMap:()=>Rw,getRetryCount:()=>xm,getScriptDir:()=>eoe,innerVersion:()=>Sw,loggerProxy:()=>Mw,screenProfileMap:()=>Aw,setLoggerProxy:()=>T_,setRetryCount:()=>Z4,setVersion:()=>V4,version:()=>Ol,videoProfileMap:()=>Ll});var Sw="4.15.00.1600",Ol="5.0.0";function V4(r){Ol=r;let[l,d,g]=r.split(".").map(C=>parseInt(C,10));Sw="".concat(l,".").concat(Math.min(15,d),".").concat(Math.min(15,g),".").concat(d.toString().padStart(2,"0")).concat(g.toString().padStart(2,"0"))}var Ew,E_,Ka,vC=typeof importScripts<"u",Tw=typeof registerProcessor<"u",eoe=()=>{let r=vC?self.location.href:document.currentScript.src;return r.substring(0,r.lastIndexOf("/")+1)},Mw="",T_=r=>Mw=r,kw="web.sdk.qcloud.com",G4="web.sdk.tencent.cn",B4="web.sdk.cloud.tencent.cn",toe="https://console.cloud.tencent.com/trtc",tf="https://".concat(kw,"/trtc/webrtc/v5/doc"),noe="".concat(tf,"/zh-cn/"),H4="https://yun.tim.qq.com",$4="https://apisgp.my-imcloud.com",q4="trtc_error_assistance",M_={LOG:"jssdk_log",EVENT:"jssdk_event",KEY_POINT:"jssdk_new_endreport",KV_STAT:"jssdk_key_metrics_report"},nf={QCLOUD:"qcloud",OLD_CLOUD_LADDER:"trtc",WEBRTC:"webrtc"},Ju=((Ka=Ju||{})[Ka.TRACE=0]="TRACE",Ka[Ka.DEBUG=1]="DEBUG",Ka[Ka.INFO=2]="INFO",Ka[Ka.WARN=3]="WARN",Ka[Ka.ERROR=4]="ERROR",Ka[Ka.NONE=5]="NONE",Ka),ooe=18e3,roe=2e3,ww={unknown:0,wifi:1,"3g":2,"2g":3,"4g":4,wired:5,"5g":6},K4=6048e5,z4=((E_=z4||{}).USEAINS="useAINS",E_.ENABLEDEBUG="enableDebug",E_.USEV2="useV2",E_.USEWT="useWt",E_),Rw={standard:{sampleRate:48e3,channelCount:1,bitrate:40},"standard-stereo":{sampleRate:48e3,channelCount:2,bitrate:64},high:{sampleRate:48e3,channelCount:1,bitrate:128},"high-stereo":{sampleRate:48e3,channelCount:2,bitrate:192}},Ll={"120p":{width:160,height:120,frameRate:15,bitrate:200},"120p_2":{width:160,height:120,frameRate:15,bitrate:100},"180p":{width:320,height:180,frameRate:15,bitrate:350},"180p_2":{width:320,height:180,frameRate:15,bitrate:150},"240p":{width:320,height:240,frameRate:15,bitrate:400},"240p_2":{width:320,height:240,frameRate:15,bitrate:200},"360p":{width:640,height:360,frameRate:15,bitrate:800},"360p_2":{width:640,height:360,frameRate:15,bitrate:400},"480p":{width:640,height:480,frameRate:15,bitrate:900},"480p_2":{width:640,height:480,frameRate:15,bitrate:500},"720p":{width:1280,height:720,frameRate:15,bitrate:1500},"1080p":{width:1920,height:1080,frameRate:15,bitrate:2e3},"1440p":{width:2560,height:1440,frameRate:30,bitrate:4860},"4K":{width:3840,height:2160,frameRate:30,bitrate:9e3}},Aw={"480p":{width:640,height:480,frameRate:5,bitrate:900},"480p_2":{width:640,height:480,frameRate:30,bitrate:1e3},"720p":{width:1280,height:720,frameRate:5,bitrate:1200},"720p_2":{width:1280,height:720,frameRate:30,bitrate:3e3},"1080p":{width:1920,height:1080,frameRate:5,bitrate:1600},"1080p_2":{width:1920,height:1080,frameRate:30,bitrate:4e3}},Be={CANVAS:"canvas",AUDIO:"audio",VIDEO:"video",SCREEN:"screen",SMALL:"small",BIG:"big",AUXILIARY:"auxiliary",SMALL_VIDEO:"smallVideo",FACING_MODE_USER:"user",FACING_MODE_ENVIRONMENT:"environment",MUTE:"mute",UNMUTE:"unmute",ENDED:"ended",PLAYING:"playing",PAUSE:"pause",ERROR:"error",LOADEDDATA:"loadeddata",AUDIO_INPUT:"audioinput",VIDEO_INPUT:"videoinput",DETAIL:"detail",TEXT:"text",MAIN:"main",BACKUP:"backup",BANNED:"banned",KICK:"kick",USER_TIME_OUT:"user_time_out",ROOM_DISBAND:"room_disband",SEI_MESSAGE:"sei-message",ADD:"add",REMOVE:"remove",REPLACE:"replace",TRACK:"track",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",TRANSCEIVER_DIRECTION_SENDONLY:"sendonly",TRANSCEIVER_DIRECTION_RECVONLY:"recvonly",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture"},bo={INACTIVE:"inactive",SENDONLY:"sendonly",RECVONLY:"recvonly"},Dw={OLD_CLOUD_LADDER:"wss://trtc.rtc.qq.com",WEBRTC:"wss://webrtc.qq.com"},W4=((Ew=W4||{}).LIVE="live",Ew.RTC="rtc",Ew),k_=1,Ow=2,_C=4,w_=8,Lw=64,Nw=16,yC="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",j4="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",Y4=Be.MAIN,J4=Be.AUXILIARY,ioe=0,aoe=1,soe=2,loe=3,coe=4,uoe=5,doe=6,Xu="unknown",ni={NEW:"new",CONNECTING:"connecting",FAILED:"failed",CLOSED:"closed",DISCONNECTED:"disconnected",CONNECTED:"connected",COMPLETED:"completed"},X4=1/0;function Z4(r){X4=r}function xm(){return X4}var of,hoe=30,wc={JOIN:"join",DELTA_JOIN:"delta-join",REJOIN:"rejoin",LEAVE:"leave",DELTA_LEAVE:"delta-leave",PUBLISH:"publish",DELTA_PUBLISH:"delta-publish",UNPUBLISH:"unpublish",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",UPLINK_CONNECTION:"uplink-connection",UPLINK_RECONNECTION:"uplink-reconnection",DOWNLINK_CONNECTION:"downlink-connection",DOWNLINK_RECONNECTION:"downlink-reconnection",ON_TRACK:"ontrack",ICE_CONNECTION_STATE:"iceConnectionState",LOCAL_STREAM_INITIALIZE:"stream-initialize",SIGNAL_CONNECTION:"websocketConnectionState",SIGNAL_RECONNECTION:"websocketReconnectionState",UPDATE_STREAM:"update-stream",RECOVER_LOCAL_AUDIO_TRACK:"recover-local-audio-track",RECOVER_LOCAL_VIDEO_TRACK:"recover-local-video-track",RECOVER_SUBSCRIPTION:"recover-subscription",START_MIX_TRANSCODE:"start-mix-transcode",STOP_MIX_TRANSCODE:"stop-mix-transcode",PLAYER_ERROR:"player-error",SCHEDULE:"schedule",LOAD_WORKLET:"load-worklet",VIDEO_FROZEN_COUNT:"videoFrozenCount",GET_USER_MEDIA_RETRY:"getUserMedia-retry"},foe=1e4,Q4=1e4,eF=1e4,R_="unified-plan",IC="plan-b",bC=1028,tF=((of=tF||{})[of.UNPUBLISH=-1]="UNPUBLISH",of[of.PUBLISHING=0]="PUBLISHING",of[of.PUBLISHED=1]="PUBLISHED",of),Pw=500,poe=1e3,moe=Be.BIG,goe=Be.SMALL,xw=1e4,Nl={MAIN:"schedule.cloud-rtc.com",BACKUP:"schedule.rtc.qcloud.com",MAIN_OVERSEA:"schedule.rtc-web.com",BACKUP_OVERSEA:"schedule.rtc-web.io",MAIN_OVERSEA_OLD:"schedule.rtc.tencentcloud.com",BACKUP_OVERSEA_OLD:"schedule-ecdn.rtc.tencentcloud.com"},voe=2e3,_oe={TRTC:"TRTC",CLIENT:"Client",LOCAL_STREAM:"LocalStream",REMOTE_STREAM:"RemoteStream",STREAM:"Stream"},nF=5,A_="default",CC=A_,yoe="communications",Ioe=Object.keys(Ju),oF=["normal leave","timeout leave","kick","role change"],D_=10,O_=2e3,Um="ric",Uw="raf",SC="interval",L_="timeout",Fw=["width","height","frameRate","facingMode","sampleRate","sampleSize","channelCount","deviceId","min","max"];function N_(r){let{url:l,body:d,method:g,timeout:C}=r,A=new XMLHttpRequest;return new Promise((L,B)=>{A.onreadystatechange=()=>{if(A.readyState===4)if(A.status>=200&&A.status<300)try{let U=JSON.parse(A.response);L({data:U})}catch{L({data:A.response})}else B({status:A.status,statusText:A.statusText||"request failed!"})},A.timeout=C||5e3,A.open(g||"POST",l,!0),A.send(d)})}function rF(r){return at(this,null,function*(){let l=xo(),d=JSON.stringify(r);try{if(!CompressionStream||d.length<=2800)return d;let g=new Blob([d],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),C=yield(yield(yield new Response(g)).blob()).arrayBuffer();return pn.debug("compressJSON ".concat(d.length," -> ").concat(C.byteLength," ").concat(xo()-l,"ms")),C}catch{return d}})}var Zu=1e8,to={AVOID_REPEATED_CALL:"AVOID_REPEATED_CALL",INVALID_PARAMETER_REQUIRED:"INVALID_PARAMETER_REQUIRED",INVALID_PARAMETER_TYPE:"INVALID_PARAMETER_TYPE",INVALID_PARAMETER_EMPTY:"INVALID_PARAMETER_EMPTY",INVALID_PARAMETER_INSTANCE:"INVALID_PARAMETER_INSTANCE",INVALID_PARAMETER_RANGE:"INVALID_PARAMETER_RANGE",INVALID_PARAMETER_MIN:"INVALID_PARAMETER_MIN",INVALID_PARAMETER_MAX:"INVALID_PARAMETER_MAX",INVALID_PARAMETER_STREAMTYPE:"INVALID_PARAMETER_STREAMTYPE",API_CALL_TIMEOUT:"API_CALL_TIMEOUT",SIGNAL_CHANNEL_RECONNECTION_FAILED:"SIGNAL_CHANNEL_RECONNECTION_FAILED",SIGNAL_CHANNEL_SETUP_FAILED:"SIGNAL_CHANNEL_SETUP_FAILED",ERROR_MESSAGE:"ERROR_MESSAGE",EXCHANGE_SDP_TIMEOUT:"EXCHANGE_SDP_TIMEOUT",DOWNLINK_RECONNECTION_FAILED:"DOWNLINK_RECONNECTION_FAILED",EXCHANGE_SDP_FAILED:"EXCHANGE_SDP_FAILED",UPDATE_OFFER_TIMEOUT:"UPDATE_OFFER_TIMEOUT",UPLINK_RECONNECTION_FAILED:"UPLINK_RECONNECTION_FAILED",INVALID_RECORDID:"INVALID_RECORDID",INVALID_PURE_AUDIO:"INVALID_PURE_AUDIO",INVALID_STREAMID:"INVALID_STREAMID",INVALID_USER_DEFINE_RECORDID:"INVALID_USER_DEFINE_RECORDID",INVALID_USER_DEFINE_PUSH_ARGS:"INVALID_USER_DEFINE_PUSH_ARGS",INVALID_PROXY:"INVALID_PROXY",INVALID_JOIN:"INVALID_JOIN",INVALID_ROOMID_STRING:"INVALID_ROOMID_STRING",INVALID_ROOMID_INTEGER:"INVALID_ROOMID_INTEGER",INVALID_SIGNAL_CHANNEL:"INVALID_SIGNAL_CHANNEL",JOIN_ROOM_TIMEOUT:"JOIN_ROOM_TIMEOUT",JOIN_ROOM_FAILED:"JOIN_ROOM_FAILED",REJOIN_ROOM_FAILED:"REJOIN_ROOM_FAILED",INVALID_DESTROY:"INVALID_DESTROY",INVALID_PUBLISH:"INVALID_PUBLISH",INVALID_UNPUBLISH:"INVALID_UNPUBLISH",INVALID_AUDIENCE:"INVALID_AUDIENCE",INVALID_INITIALIZE:"INVALID_INITIALIZE",INVALID_DUPLICATE_PUBLISHING:"INVALID_DUPLICATE_PUBLISHING",INVALID_SUBSCRIBE_UNDEFINED:"INVALID_SUBSCRIBE_UNDEFINED",INVALID_SUBSCRIBE_LOCAL:"INVALID_SUBSCRIBE_LOCAL",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",SUBSCRIBE_FAILED:"SUBSCRIBE_FAILED",INVALID_ROLE:"INVALID_ROLE",INVALID_PARAMETER_SWITCH_ROLE:"INVALID_PARAMETER_SWITCH_ROLE",INVALID_OPERATION_SWITCH_ROLE:"INVALID_OPERATION_SWITCH_ROLE",SWITCH_ROLE_TIMEOUT:"SWITCH_ROLE_TIMEOUT",SWITCH_ROLE_FAILED:"SWITCH_ROLE_FAILED",CLIENT_BANNED:"CLIENT_BANNED",INVALID_OPERATION_START_PUBLISH_CDN:"INVALID_OPERATION_START_PUBLISH_CDN",INVALID_OPERATION_STOP_PUBLISH_CDN:"INVALID_OPERATION_STOP_PUBLISH_CDN",INVALID_STREAM_ID:"INVALID_STREAM_ID",START_PUBLISH_CDN_FAILED:"START_PUBLISH_CDN_FAILED",STOP_PUBLISH_CDN_FAILED:"STOP_PUBLISH_CDN_FAILED",START_MIX_TRANSCODE:"START_MIX_TRANSCODE",STOP_MIX_TRANSCODE:"STOP_MIX_TRANSCODE",INVALID_AUDIO_VOLUME:"INVALID_AUDIO_VOLUME",ENABLE_SMALL_STREAM_PUBLISHED:"ENABLE_SMALL_STREAM_PUBLISHED",DISABLE_SMALL_STREAM_PUBLISHED:"DISABLE_SMALL_STREAM_PUBLISHED",NOT_SUPPORTED_SMALL_STREAM:"NOT_SUPPORTED_SMALL_STREAM",INVALID_SMALL_STREAM_PROFILE:"INVALID_SMALL_STREAM_PROFILE",INVALID_PARAMETER_REMOTE_STREAM:"INVALID_PARAMETER_REMOTE_STREAM",INVALID_OPERATION_CHANGE_SMALL:"INVALID_OPERATION_CHANGE_SMALL",REMOTE_NOT_PUBLISH_SMALL_STREAM:"REMOTE_NOT_PUBLISH_SMALL_STREAM",INVALID_SWITCH_DEVICE:"INVALID_SWITCH_DEVICE",INVALID_SWITCH_DEVICE_PUBLISHING:"INVALID_SWITCH_DEVICE_PUBLISHING",INVALID_REPLACE_TRACK:"INVALID_REPLACE_TRACK",INVALID_INITIALIZE_LOCAL_STREAM:"INVALID_INITIALIZE_LOCAL_STREAM",INVALID_ADD_TRACK_REPETITIVE:"INVALID_ADD_TRACK_REPETITIVE",INVALID_ADD_TRACK_REMOVING:"INVALID_ADD_TRACK_REMOVING",INVALID_ADD_TRACK_PUBLISHING:"INVALID_ADD_TRACK_PUBLISHING",INVALID_STREAM_INITIALIZED:"INVALID_STREAM_INITIALIZED",INVALID_ADD_TRACK_NUMBER:"INVALID_ADD_TRACK_NUMBER",INVALID_REMOVE_AUDIO_TRACK:"INVALID_REMOVE_AUDIO_TRACK",INVALID_REMOVE_AUDIO_ADDING:"INVALID_REMOVE_AUDIO_ADDING",INVALID_REMOVE_AUDIO_ON:"INVALID_REMOVE_AUDIO_ON",INVALID_REMOVE_TRACK_PUBLISHING:"INVALID_REMOVE_TRACK_PUBLISHING",INVALID_REMOVE_TRACK_NOT_TRACK:"INVALID_REMOVE_TRACK_NOT_TRACK",INVALID_REMOVE_TRACK_NUMBER:"INVALID_REMOVE_TRACK_NUMBER",INVALID_REPLACE_TRACK_NO_TRACK:"INVALID_REPLACE_TRACK_NO_TRACK",REPEAT_JOIN:"REPEAT_JOIN",CLIENT_DESTROYED:"CLIENT_DESTROYED",NOT_BUG_PACKAGE:"NOT_BUG_PACKAGE",START_MIX_TRANSCODE_FAILED:"START_MIX_TRANSCODE_FAILED",STOP_MIX_TRANSCODE_FAILED:"STOP_MIX_TRANSCODE_FAILED",MIX_TRANSCODE_NOT_STARTED:"MIX_TRANSCODE_NOT_STARTED",CANNOT_LESS_THAN_ZERO:"CANNOT_LESS_THAN_ZERO",MIX_PARAMS_VIDEO_FRAMERATE:"MIX_PARAMS_VIDEO_FRAMERATE",MIX_PARAMS_VIDEO_GOP:"MIX_PARAMS_VIDEO_GOP",MIX_PARAMS_AUDIO_BITRATE:"MIX_PARAMS_AUDIO_BITRATE",MIX_PARAMS_USER_Z_ORDER:"MIX_PARAMS_USER_Z_ORDER",MIX_PARAMS_NOT_SELF:"MIX_PARAMS_NOT_SELF",MIX_PARAMS_USER_STREAM:"MIX_PARAMS_USER_STREAM",INVALID_PLAY:"INVALID_PLAY",INVALID_ELEMENT_ID:"INVALID_ELEMENT_ID",INVALID_ELEMENT_ID_TYPE:"INVALID_ELEMENT_ID_TYPE",PLAY_FAILED:"PLAY_FAILED",INVALID_USERID:"INVALID_USERID",INVALID_CREATE_STREAM_SOURCE:"INVALID_CREATE_STREAM_SOURCE",INVALID_CREATE_STREAM_SCREEN:"INVALID_CREATE_STREAM_SCREEN",INVALID_CREATE_STREAM_AUDIO:"INVALID_CREATE_STREAM_AUDIO",INVALID_CREATE_STREAM_SCREEN_AUDIO:"INVALID_CREATE_STREAM_SCREEN_AUDIO",NOT_SUPPORTED_HTTP:"NOT_SUPPORTED_HTTP",NOT_SUPPORTED_WEBRTC:"NOT_SUPPORTED_WEBRTC",NOT_SUPPORTED_PROFILE:"NOT_SUPPORTED_PROFILE",NOT_SUPPORTED_MEDIA:"NOT_SUPPORTED_MEDIA",NOT_SUPPORTED_H264ENCODE:"NOT_SUPPORTED_H264ENCODE",NOT_SUPPORTED_H264DECODE:"NOT_SUPPORTED_H264DECODE",NOT_SUPPORTED_TRACK:"NOT_SUPPORTED_TRACK",NOT_SUPPORTED_SWITCH_DEVICE:"NOT_SUPPORTED_SWITCH_DEVICE",NOT_SUPPORTED_CAPTURE:"NOT_SUPPORTED_CAPTURE",NOT_SUPPORTED_AUX:"NOT_SUPPORTED_AUX",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",SIGNAL_RESPONSE_FAILED:"SIGNAL_RESPONSE_FAILED",CATCH_HANDLER_ERROR:"CATCH_HANDLER_ERROR",API_NOT_EXIST:"API_NOT_EXIST",CONNECTION_CLOSED:"CONNECTION_CLOSED",SUBSCRIBE_ALL_FALSE:"SUBSCRIBE_ALL_FALSE",SEI_NOT_SUPPORT:"SEI_NOT_SUPPORT",SEI_DISABLED:"SEI_DISABLED",SEI_BEFORE_PUBLISH:"SEI_BEFORE_PUBLISH",SEI_NOT_VIDEO:"SEI_NOT_VIDEO",CALL_FREQUENCY_LIMIT:"CALL_FREQUENCY_LIMIT",CONNECTION_ABORTED:"CONNECTION_ABORTED",API_CALL_ABORTED:"API_CALL_ABORTED",DUPLICATE_AUX:"DUPLICATE_AUX"},Js={AVOID_REPEATED_CALL:r=>"previous ".concat(r.name,"() is ongoing, please avoid repeated calls."),INVALID_PARAMETER_REQUIRED(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' is a required param when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_TYPE(r){let{key:l,rule:d,fnName:g,value:C}=r,A="".concat(l||d.name),L="";return L=Array.isArray(d.type)?d.type.join("|"):d.type,"'".concat(A,"' must be type of ").concat(L," when calling ").concat(g,"(), received type: ").concat(ya(C),".")},INVALID_PARAMETER_EMPTY(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' cannot be '").concat(C,"' when calling ").concat(g,"().")},INVALID_PARAMETER_INSTANCE(r){let{key:l,rule:d,fnName:g,value:C}=r,A="".concat(l||d.name),L="".concat(d.instanceOf.name||d.instanceOf);return"'".concat(A,"' must be instanceof ").concat(L," when calling ").concat(g,"(), received type: ").concat(ya(C),".")},INVALID_PARAMETER_RANGE(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' must be one of ").concat(d.values.join("|")," when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_MIN(r){let{key:l,rule:d,fnName:g,value:C}=r;return"the min value of ".concat(l||d.name," is ").concat(d.min,", received: ").concat(C,".")},INVALID_PARAMETER_MAX(r){let{key:l,rule:d,fnName:g,value:C}=r;return"the max value of ".concat(l||d.name," is ").concat(d.max,", received: ").concat(C,".")},API_CALL_TIMEOUT:r=>"".concat(r.commandDesc||r.command," timeout observed."),SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:r=>"SignalChannel setup failure: (errorCode: ".concat(r.errorCode,", errorMsg: ").concat(r.errorMsg," })."),ERROR_MESSAGE(r){let l="".concat(r.type," failed");return r.message&&(l="".concat(l,": ").concat(r.message,".")),l},EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:r=>"exchange sdp failed ".concat(r.errMsg,"."),UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:r=>"'".concat(r,"' must be validate string when useStringRoomId is true."),INVALID_ROOMID_INTEGER:r=>"'".concat(r,"' must be an integer between [1, 4294967294] when useStringRoomId is false."),INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED(r){let{error:l,code:d}=r;return"Failed to join room - ".concat(l," code: ").concat(d)},REJOIN_ROOM_FAILED:r=>"reJoin room: ".concat(r.roomId," failed, please check your network."),INVALID_DESTROY:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:"no permission to publish() under live/".concat("audience",', please call switchRole("',"anchor",'") firstly before publish().'),INVALID_INITIALIZE:"cannot publish stream because stream is not initialized, is switching device, or has been closed.",INVALID_DUPLICATE_PUBLISHING:r=>"duplicate ".concat(r," stream publishing, please unpublish your prev ").concat(r," stream and then re-publish."),INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED(r){let{message:l,userId:d,streamType:g}=r;return"failed to subscribe ".concat(d," ").concat(g," stream, reason: ").concat(l,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as ".concat("anchor"," or ","audience","."),INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:r=>"switchRole failed, errCode: ".concat(r.code," errMsg: ").concat(r.message,"."),CLIENT_BANNED:r=>"client was banned because of ".concat(r.message,"."),INVALID_OPERATION_START_PUBLISH_CDN:"please call startPublishCDNStream() after join room and publish the local stream.",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:r=>"startPublishCDNStream failed, errMsg: ".concat(r.message,"."),STOP_PUBLISH_CDN_FAILED:r=>"stopPublishCDNStream failed, errMsg: ".concat(r.message,"."),INVALID_STREAM_ID:r=>"'".concat(r,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores."),START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",INVALID_OPERATION_CHANGE_SMALL:"cannot switch to the small stream without subscribing to the video of remoteStream.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported on your browser.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_TRACK:"localStream has not this track.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REPLACE_TRACK_NO_TRACK:r=>"cannot replace ".concat(r.kind," track because stream has not ").concat(r.kind," track"),NOT_BUG_PACKAGE:"You need to buy packages, refer to tencent console.",START_MIX_TRANSCODE_FAILED:r=>"startMixTranscode failed, errMsg: ".concat(r.message,"."),STOP_MIX_TRANSCODE_FAILED:r=>"stopMixTranscode failed, errMsg: ".concat(r.message,"."),MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' cannot be less than 0 when calling ").concat(g,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:r=>"'".concat(r,"' is required and must be between 1 and 15."),MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_ELEMENT_ID:r=>{let{key:l,fnName:d}=r;return"'".concat(l,"' is not found in the document object when calling ").concat(d,"().")},INVALID_ELEMENT_ID_TYPE:r=>{let{key:l,fnName:d,type:g}=r;return"the element corresponding to '".concat(l,"' must be instanceof HTMLElement when calling ").concat(d,"(), received: ").concat(g,".")},PLAY_FAILED:r=>"".concat(r.media," play failed，browser exception: ").concat(r.error.toString()),INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"http protocol does not support the ability to capture microphone, camera and screen. please use https to deploy your page.",NOT_SUPPORTED_WEBRTC:"your browser or environment does not support full WebRTC capabilities.",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser or environment does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_TRACK:r=>"".concat(r,"Track is not supported on your browser."),NOT_SUPPORTED_SWITCH_DEVICE:"switchDevice is not supported on your browser.",NOT_SUPPORTED_CAPTURE:"Your browser or environment does not support screen sharing, please check whether the browser version.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone.",CAMERA_NOT_FOUND:"no camera detected, please check your camera.",SIGNAL_RESPONSE_FAILED:r=>"".concat(r.signalResponse," failed, response code is ").concat(r.code," , errMsg: ").concat(r.message,"."),CATCH_HANDLER_ERROR(r){let{name:l,event:d}=r;return"an error was caught on ".concat(l,".on('").concat(d,"', handler), please check your code on 'handler'.")},API_NOT_EXIST(r){let{name:l}=r;return"experimental api ".concat(l," does not exist.")},REPEAT_JOIN:r=>"[".concat(r,"] is calling client.join api or has already joined room, please avoid repeated join."),CONNECTION_CLOSED:"remoteStream has been unsubscribed or unpublished by remote user.",SUBSCRIBE_ALL_FALSE:"cannot subscribe when both audio & video are false, use client.unsubscribe() instead",CLIENT_DESTROYED(r){let{funName:l}=r;return"failed to call ".concat(l,"() because client was destroyed.")},SEI_NOT_SUPPORT:r=>"not support to sendSEIMessage".concat(r===!1?" without using h264 codec":""),SEI_DISABLED:"SEI is disabled",SEI_BEFORE_PUBLISH:"please call sendSEIMessage() after publish() success",SEI_NOT_VIDEO:"cannot send sei when localStream has not video.",CALL_FREQUENCY_LIMIT:r=>{let{isSize:l,name:d,timesInSecond:g,maxSizeInSecond:C}=r;return"api ".concat(d," call ").concat(l?"size":"times"," is over ").concat(l?"".concat(C," bytes"):g," in a second.")},CONNECTION_ABORTED:r=>"connection aborted due to: ".concat(r),API_CALL_ABORTED(r){let l;return l=r.message.includes("REMOTE_STREAM_NOT_EXIST")?"Subscribe ".concat(r.userId," ").concat(r.streamType," stream aborted, reason: remote user ").concat(r.userId," unpublished stream."):"API aborted, reason: ".concat(r.message),l},DUPLICATE_AUX:"only one auxiliary stream can be published in a room.",NOT_SUPPORTED_AUX:"publish auxiliary stream is not supported on your browser.",INVALID_PARAMETER_STREAMTYPE:r=>"'streamType' is required when 'userId' is not '*', calling ".concat(r,"()")},iF={};S_(iF,{ANDROID_VERSION:()=>Bw,CHROME_MAJOR_VERSION:()=>Bm,CHROME_VERSION:()=>rR,EDGE_VERSION:()=>$w,EDG_MAJOR_VERSION:()=>cF,EDG_VERSION:()=>qw,FIREFOX_MAJOR_VERSION:()=>lF,FIREFOX_VERSION:()=>Hw,HUAWEI_VERSION:()=>eR,IE_VERSION:()=>Toe,IOS_MAIN_VERSION:()=>iR,IOS_VERSION:()=>Qu,IPADQQB_VERSION:()=>Zw,IS_ANDROID:()=>gs,IS_ANDROID_WEBVIEW:()=>mF,IS_ANY_SAFARI:()=>q_,IS_CHROME:()=>PC,IS_CHROME_OS:()=>dF,IS_CHROMIUM_BASE:()=>$_,IS_EDG:()=>U_,IS_EDGE:()=>x_,IS_ELECTRON:()=>fF,IS_FIREFOX:()=>Nr,IS_HEADLESS_CHROME:()=>pF,IS_HUAWEI:()=>koe,IS_HUAWEIBROWSER:()=>LC,IS_IE:()=>uF,IS_IE8:()=>Eoe,IS_IOS:()=>Rc,IS_IOS_13_OR_14:()=>vF,IS_IOS_15_1:()=>gF,IS_IPAD:()=>P_,IS_IPADQQB:()=>AC,IS_IPAD_PRO:()=>Gw,IS_IPHONE:()=>Fm,IS_IPOD:()=>sF,IS_LINUX:()=>DC,IS_LOCAL:()=>af,IS_MAC:()=>rf,IS_MACQQB:()=>RC,IS_MIBROWSER:()=>OC,IS_MQQB:()=>V_,IS_NATIVE_ANDROID:()=>Soe,IS_OLD_ANDROID:()=>Coe,IS_OPPOBROWSER:()=>B_,IS_SAFARI:()=>Ac,IS_SAFARI_15_1:()=>woe,IS_SAMSUNGBROWSER:()=>NC,IS_SOGOU:()=>TC,IS_SOGOUM:()=>EC,IS_TBS:()=>Pl,IS_UCBROWSER:()=>hF,IS_VIVOBROWSER:()=>H_,IS_WECHAT:()=>kC,IS_WIN:()=>Vm,IS_WQQB:()=>wC,IS_WX:()=>Moe,IS_X5MQQB:()=>F_,IS_XWEB:()=>MC,MACQQB_VERSION:()=>Xw,MI_VERSION:()=>Qw,MQQB_VERSION:()=>G_,OPPO_VERSION:()=>nR,SAFARI_VERSION:()=>K_,SAMSUNG_VERSION:()=>tR,SOGOUM_VERSION:()=>Kw,SOGOU_VERSION:()=>zw,TBS_VERSION:()=>Ww,USER_AGENT:()=>Xs,VIVO_VERSION:()=>oR,WECHAT_VERSION:()=>Yw,WQQB_VERSION:()=>Jw,XWEB_VERSION:()=>jw,browserInfo:()=>ed,getBrowserInfo:()=>_F,getChromeMajorVersion:()=>Gm,getOSName:()=>sR,getOSString:()=>lR,getOSType:()=>Roe,getTerminalType:()=>IF,getUserAgentData:()=>aR,isLocalStorageEnabled:()=>sf});var Xs=typeof navigator>"u"?"":navigator.userAgent,co=r=>new RegExp(r,"i").test(Xs),si=r=>{if(co(r)){let l=new RegExp("".concat(r,"\\/([\\d.]+)")),d=Xs.match(l);if(d&&d[1])return d[1]}return""},Vw=r=>{if(co(r)){let l=new RegExp("".concat(r,"\\/(\\d+)")),d=Xs.match(l);if(d&&d[1])return parseFloat(d[1])}return NaN},aF=/AppleWebKit\/([\d.]+)/i.exec(Xs),boe=aF?parseFloat(aF[1]):NaN,P_=co("iPad"),Gw=typeof navigator<"u"&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&co("Macintosh"),Fm=co("iPhone")&&!P_,sF=co("iPod"),Rc=Fm||P_||sF||Gw,gs=co("Android"),Bw=function(){if(gs){let r=Xs.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(r){let l=r[1]&&parseFloat(r[1]),d=r[2]&&parseFloat(r[2]);if(l&&d)return parseFloat("".concat(r[1],".").concat(r[2]));if(l)return l}}return NaN}(),Coe=gs&&co("webkit")&&Bw<2.3,Soe=gs&&Bw<5&&boe<537,Nr=co("Firefox"),Hw=si("Firefox"),lF=Vw("Firefox"),x_=co("Edge"),$w=si("Edge"),U_=co("Edg"),qw=si("Edg"),cF=Vw("Edg"),EC=co("SogouMobileBrowser"),Kw=si("SogouMobileBrowser"),TC=co("MetaSr\\s"),zw=si("MetaSr\\s"),Pl=co("TBS"),Ww=si("TBS"),MC=co("XWEB"),jw=si("XWEB"),Eoe=co("MSIE\\s8\\.0"),uF=co("MSIE\\/\\d+"),Toe=function(){if(uF){let r=/MSIE\s(\d+)\.\d/.exec(Xs),l=r&&parseFloat(r[1]);return!l&&/Trident\/7.0/i.test(Xs)&&/rv:11.0/.test(Xs)&&(l=11),l}return NaN}(),kC=co("(micromessenger|webbrowser)"),Yw=si("MicroMessenger"),F_=!Pl&&co("MQQBrowser")&&co("COVC"),V_=!Pl&&co("MQQBrowser")&&!co("COVC"),G_=V_||F_?si("MQQBrowser"):"",wC=!Pl&&co(" QQBrowser"),Jw=si(" QQBrowser"),RC=!Pl&&co("QQBrowserLite"),Xw=si("QQBrowserLite"),AC=!Pl&&co("MQBHD"),Zw=si("MQBHD"),Vm=co("Windows"),rf=!Rc&&co("MAC OS X"),DC=!gs&&co("Linux"),dF=co("CrOS"),Moe=co("MicroMessenger"),hF=co("UCBrowser"),fF=co("Electron"),OC=co("MiuiBrowser"),Qw=si("MiuiBrowser"),LC=co("HuaweiBrowser"),koe=co("Huawei"),eR=si("HuaweiBrowser"),NC=co("SamsungBrowser"),tR=si("SamsungBrowser"),B_=co("HeyTapBrowser"),nR=si("HeyTapBrowser"),H_=co("VivoBrowser"),oR=si("VivoBrowser"),Gm=()=>Vw("Chrome"),$_=co("Chrome"),PC=!x_&&!TC&&!EC&&!Pl&&!MC&&!U_&&!wC&&!OC&&!LC&&!NC&&!B_&&!H_&&$_,pF=co("HeadlessChrome"),Bm=Gm(),rR=si("Chrome"),Ac=!$_&&!V_&&!F_&&!RC&&!AC&&co("Safari"),q_=Ac||Rc,K_=si("Version"),mF=/Android.*(wv|.0.0.0)/.test(Xs),Qu=(()=>{if(Gw)return K_;if(Rc){let r=Xs.match(/OS (\d+)_(\d+)/i);if(r&&r[1]){let l=r[1];return r[2]&&(l+=".".concat(r[2])),l}}return""})(),iR=Number(Qu.split(".")[0]),woe=K_==="15.1",gF=Qu==="15.1",vF=(()=>{let r=Number(Qu.split(".")[0]);return r===14||r===13})(),af=typeof location<"u"&&(location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"),sf=(()=>{let r;return()=>{if(Ft(r))try{r=!!window.localStorage}catch{r=!1}return r}})(),ed=_F();function _F(){let r=new Map([[Nr,["Firefox",Hw]],[U_,["Edg",qw]],[PC,["Chrome",rR]],[Ac,["Safari",K_]],[Pl,["TBS",Ww]],[MC,["XWEB",jw]],[kC&&Fm,["WeChat",Yw]],[wC,["QQ(Win)",Jw]],[V_,["QQ(Mobile)",G_]],[F_,["QQ(Mobile X5)",G_]],[RC,["QQ(Mac)",Xw]],[AC,["QQ(iPad)",Zw]],[OC,["MI",Qw]],[LC,["HW",eR]],[NC,["Samsung",tR]],[B_,["OPPO",nR]],[H_,["VIVO",oR]],[x_,["EDGE",$w]],[EC,["SogouMobile",Kw]],[TC,["Sogou",zw]]]),l="unknown",d="unknown";return r.has(!0)&&([l,d]=r.get(!0)),{name:l,version:d}}var Zs=null;function aR(){return at(this,null,function*(){if(Zs)return Zs;if(!navigator.userAgentData||!Er(navigator.userAgentData.getHighEntropyValues))return null;try{return Zs=yield navigator.userAgentData.getHighEntropyValues(["architecture","bitness","model","platformVersion","fullVersionList"])}catch{return null}})}var yF=new Map([[gs,"Android"],[Rc,"iOS"],[Vm,"Windows"],[rf,"MacOS"],[DC,"Linux"],[dF,"ChromeOS"]]),sR=function(){return yF.get(!0)?yF.get(!0):Zs?Zs.platform:"unknown"},lR=()=>{let r=sR();return r+="/".concat(ed.name,"/").concat(Ac?ed.version:ed.version.split(".")[0]),Zs!=null&&Zs.platformVersion&&(r+="/".concat(Zs.platformVersion)),Zs!=null&&Zs.architecture&&(r+="/".concat(Zs.architecture)),r};function IF(){return gs?4:Fm?2:P_?3:rf?12:Vm?5:DC?13:1}function Roe(){return gs?"Android":Fm?"iPhone":P_?"iPad":rf?"Mac":Vm?"Windows":DC?"Linux":"unknown"}var bF=(r,l)=>l?"".concat(tf,"/").concat(r,"/").concat(l):"".concat(tf,"/").concat(r,"/index.html"),Aoe=()=>{if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};let r=localStorage.getItem(q4);if(r){r=JSON.parse(r);let l=document.createElement("script");l.type="text/javascript",l.text=r.message,document.body.appendChild(l);let d=window.TRTC_ERROR_INFO,g=window.TRTC_ERROR_LINK;return document.body.removeChild(l),{TRTC_ERROR_INFO:d,TRTC_ERROR_LINK:g}}return{}};function so(r){let{key:l,data:d,link:g,addDocLink:C=!0}=r,A="",L="",B="";Er(Js[l])?A=Js[l](d):rr(Js[l])&&(A=Js[l]);let{TRTC_ERROR_INFO:U,TRTC_ERROR_LINK:Z}=Aoe();g?B="".concat(g.className,".html#").concat(g.fnName):Z&&Z[l]&&(Er(Z[l])?B=Z[l](d):rr(Z[l])&&(B=Z[l]));let ae=A;return nd()&&(U&&U[l]&&(Er(U[l])?L=U[l](d):rr(U[l])&&(L=U[l])),L&&(ae=C?"".concat(L,`
请查看文档: `).concat(bF("zh-cn",B),`

`):"".concat(L,`

`),ae+=A)),C&&(ae+=` 
Refer to: `.concat(bF("en",B),`
`)),ae}var oo,z_=function(r){let{retryFunction:l,settings:d,onError:g,onRetrying:C,onRetryFailed:A,onRetrySuccess:L,context:B}=r;return function(){for(var U=arguments.length,Z=new Array(U),ae=0;ae<U;ae++)Z[ae]=arguments[ae];let{retries:ce=5,timeout:we=1e3}=d,Pe=0,Ze=-1,Ct=0,Bt=(Wt,kt)=>at(this,null,function*(){let En=B||this;try{let Ln=yield l.apply(En,Z);Pe>0&&L&&L.call(this,Pe),Pe=0,Wt(Ln)}catch(Ln){let Hn=()=>{clearTimeout(Ze),Pe=0,Ct=2,kt(Ln)},Zo=()=>{Ct!==2&&Pe<(Er(ce)?ce():ce)?(Pe++,Ct=1,Er(C)&&C.call(this,Pe,Hn),Ze=window.setTimeout(()=>{Ze=-1,Bt(Wt,kt)},Er(we)?we(Pe):we)):(Hn(),Er(A)&&A.call(this,Ln))};Er(g)?g.call(this,{error:Ln,retry:Zo,reject:kt,retryFuncArgs:Z,retriedCount:Pe}):Zo()}});return new Promise(Bt)}},en=new(Vi(qa(),1)).default,CF=((oo=CF||{}).ROOM_DESTROY="1",oo.JOIN_START="21",oo.JOIN_SCHEDULE_SUCCESS="22",oo.JOIN_SIGNAL_CONNECTION_START="23",oo.JOIN_SIGNAL_CONNECTION_END="24",oo.JOIN_SEND_CMD="25",oo.JOIN_RECEIVED_CMD_RES="26",oo.JOIN_SUCCESS="27",oo.JOIN_FAILED="28",oo.LEAVE_START="51",oo.LEAVE_SEND_CMD="52",oo.LEAVE_SUCCESS="53",oo.PUBLISH_START="61",oo.SEND_FIRST_VIDEO_FRAME="62",oo.PUBLISH_FAILED="63",oo.SUBSCRIBE_START="81",oo.SUBSCRIBE_SUCCESS="82",oo.SUBSCRIBE_FAILED="84",oo.UNSUBSCRIBE_SUCCESS="83",oo.LOCAL_TRACK_CAPTURE_START="101",oo.LOCAL_TRACK_CAPTURE_SUCCESS="102",oo.LOCAL_TRACK_CAPTURE_FAILED="103",oo.LOCAL_TRACK_PUBLISHED="104",oo.LOCAL_TRACK_UNPUBLISHED="105",oo.LOCAL_TRACK_REPLACED="106",oo.SWITCH_DEVICE_SUCCESS="107",oo.TRACK_MUTED="108",oo.TRACK_UNMUTED="109",oo.REMOTE_TRACK_SUBSCRIBED="110",oo.REMOTE_TRACK_UNSUBSCRIBED="111",oo.PLAY_TRACK_START="151",oo.PLAYER_STATE_CHANGED="152",oo.VIDEO_LOADED_DATA="153",oo.AUTOPLAY_DIALOG_CLICK_CONFIRM="154",oo.SIGNAL_CONNECTION_STATE_CHANGED="201",oo.PEER_CONNECTION_STATE_CHANGED="202",oo.SINGLE_CONNECTION_STAT="203",oo.SPC_RECONNECTED="204",oo.HEARTBEAT_REPORT="251",oo.RECEIVED_PUBLISHED_USER_LIST="252",oo.REMOTE_PUBLISH_STATE_CHANGED="253",oo.AUDIO_LEVEL_INTERVAL="260",oo.NETWORK_QUALITY="261",oo),li=new class{constructor(){this._roomIdMap=new Map,typeof registerProcessor>"u"&&(this._configs={sdkAppId:"",userId:"",version:Ol,env:nf.QCLOUD,browserVersion:ed.name+ed.version,ua:navigator.userAgent})}setConfig(r){let{sdkAppId:l,env:d,userId:g,roomId:C}=r;l!==this._configs.sdkAppId&&(this._configs.sdkAppId=String(l)),this._configs.env=d,this._configs.userId=g,this._roomIdMap.set(g,String(C))}logSuccessEvent(r){af||!pn.isAbleToUpload||this._configs.env===nf.QCLOUD&&this.uploadEventToKibana(Io(Fn({},r),{result:"success"}))}logFailedEvent(r){if(af||!pn.isAbleToUpload)return;let{eventType:l,code:d,error:g,userId:C}=r,A={roomId:this._roomIdMap.get(C||this._configs.userId),userId:C,eventType:l,result:"failed",code:d||(g==null?void 0:g.extraCode)||(g==null?void 0:g.code)||an.UNKNOWN};this._configs.env===nf.QCLOUD&&this.uploadEventToKibana(Io(Fn({},A),{error:g}))}uploadEventToKibana(r){let l="stat-".concat(r.eventType,"-").concat(r.result);(r.eventType==="delta-join"||r.eventType==="delta-leave"||r.eventType==="delta-publish")&&(l="".concat(r.eventType,":").concat(r.delta)),this.uploadEvent({log:l,userId:r.userId}),r.result==="failed"&&(l="stat-".concat(r.eventType,"-").concat(r.result,"-").concat(r.code),this.uploadEvent({log:l,userId:r.userId,error:r.error}))}uploadEvent(r){let{log:l,userId:d,error:g}=r,C={timestamp:U4(),sdkAppId:this._configs.sdkAppId,userId:d||this._configs.userId,version:Ol,log:l};g&&(C.errorInfo=g.message),this.sendRequest(W_(this._configs.sdkAppId,M_.LOG),C)}sendRequest(r,l){pn.isAbleToUpload?N_({url:r,body:JSON.stringify(l)}).catch(()=>{}):setTimeout(()=>{this.sendRequest(r,l)},1e3)}},cR=null,uR=!0;function td(r){za(r)&&r!==uR&&(uR=r,pn.info("setIsNeedToSchedule ".concat(r)))}function Doe(r){return at(this,arguments,function(l){let{userId:d,sdkAppId:g,useStringRoomId:C,roomId:A,userSig:L,version:B,frameWorkType:U}=l;return function*(){if(!uR&&cR)return{isCached:!0,result:cR};let Z={delta:0,count:[1,1],msg:[],detail:[]};try{let ae=new FormData;ae.append("userId",String(d)),ae.append("sdkAppId",String(g)),ae.append("isStrGroupId",String(C)),ae.append("groupId",String(A)),ae.append("sdkVersion",B),ae.append("userSig",String(L)),U&&ae.append("frameWorkType",String(U));let ce=xo(),we=yield function(Ze,Ct,Bt){return new Promise((Wt,kt)=>{let En=null;fR([TF(Ln=>Ct.count[0]=Ln+1,Ln=>{let{error:Hn,retry:Zo,retriedCount:ir,retryFuncArgs:fd}=Ln;Ct.msg[0]=Hn.message,En||(ir>=2&&(fd[0]=Hm(Bt,Be.MAIN,!0)),Zo())})(Hm(Bt,Be.MAIN),Ze,{get timeout(){return 1e3*Y_(2+Ct.count[0])}}),TF(Ln=>Ct.count[1]=Ln+1,Ln=>{let{error:Hn,retry:Zo,retriedCount:ir,retryFuncArgs:fd}=Ln;Ct.msg[1]=Hn.message,En||(ir>=2&&(fd[0]=Hm(Bt,Be.BACKUP,!0)),Zo())})(Hm(Bt,Be.BACKUP),Ze,{get timeout(){return 1e3*Y_(2+Ct.count[1])}})]).then(Ln=>{En=Ln,Wt(En)}).catch(kt)})}(ae,Z,g);we.config&&(we.config.loggerDomain&&T_(we.config.loggerDomain),za(we.config.scheduleCache)&&td(!we.config.scheduleCache)),Z.delta=xo()-ce;let Pe=function(Ze,Ct,Bt){let Wt=performance.getEntriesByType("resource"),kt=Hm(Ze,Be.MAIN),En=Hm(Ze,Be.BACKUP),Ln={totalCost:0,local:0,dns:0,tcp:0,tls:0,request:0,response:0};for(let Hn of Wt)if(Hn.startTime>=Bt&&(Hn.name===kt||Hn.name===En)&&Hn.transferSize>0){let Zo=Hn.name===kt?Be.MAIN:Be.BACKUP,ir=Math.round(Hn.duration),fd=Math.round(Hn.domainLookupStart-Hn.startTime),qi=Math.round(Hn.domainLookupEnd-Hn.domainLookupStart),gS=Math.round(Hn.requestStart-Hn.secureConnectionStart),Gl=Math.round(Hn.secureConnectionStart-Hn.connectStart),IG=Math.round(Hn.responseStart-Hn.requestStart),bG=Math.round(Hn.responseEnd-Hn.responseStart),nae=[fd,qi,gS,Gl,IG,bG];li.uploadEvent({log:"stat-schedule-net:".concat(ir,"(").concat(nae.join("->"),") ").concat(Zo),userId:Ct}),Ln=Io(Fn({},Ln),{totalCost:ir,local:fd,dns:qi,tcp:Gl,tls:gS,request:IG,response:bG});break}return Ln}(Number(g),d,ce);return cR=we,{isCached:!1,result:we,detailCost:Pe}}catch(ae){let ce=Gi(ae)?ae[0]:ae,we=Ti(ce.code)?ce.code:0,Pe="schedule failed".concat(ce.message?": ".concat(ce.message):""),Ze=new Rn({code:an.SCHEDULE_FAILED,extraCode:we,message:so({key:to.JOIN_ROOM_FAILED,data:{error:Pe,code:we}})});throw pn.error(Pe,we),Ze}}()})}document&&document.head.insertAdjacentHTML("beforeend",Object.values(Nl).map(r=>'<link rel="dns-prefetch" href="https://'.concat(r,'">')).join(`\r
`)),en.on("28",()=>td(!0)),en.on("63",()=>td(!0)),en.on("84",()=>td(!0)),en.on("201",r=>{r.state==="RECONNECTING"&&td(!0)}),en.on("202",r=>{r.state==="RECONNECTING"&&td(!0)});var lf={main:"",backup:""};function SF(r){Gi(r)?(lf.main=r[0],lf.backup=r[1]):lf.main=r}function Hm(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be.MAIN,d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return"https://".concat(lf[l]||EF(r,l,d),"/api/v1/config")}function Ooe(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be.MAIN;return"https://".concat(lf[l]||EF(r,l),"/api/v1/trtcAutoConf")}function EF(r){let l,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be.MAIN,g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return xC(r)?d===Be.MAIN?Nl.MAIN_OVERSEA:Nl.BACKUP_OVERSEA:(l=xC(r)?g?d===Be.MAIN?Nl.MAIN_OVERSEA_OLD:Nl.BACKUP_OVERSEA_OLD:d===Be.MAIN?Nl.MAIN_OVERSEA:Nl.BACKUP_OVERSEA:d===Be.MAIN?Nl.MAIN:Nl.BACKUP,l)}function Loe(r,l,d){return new Promise((g,C)=>{N_({url:r,body:l,timeout:d.timeout}).then(A=>{A.data.code===0?g(A.data.data):C({code:A.data.code,message:A.data.msg})}).catch(C)})}var TF=(r,l)=>z_({retryFunction:Loe,settings:{retries:3,timeout:0},onError:l,onRetrying:r}),Noe=function(){return new URLSearchParams(location.search).get("trtc_env")||""},xC=r=>Number(r)<14e8,W_=function(r,l){let d;d=Mw||(xC(r)?$4:H4);let g=Math.floor(Math.random()*yw(2,31));return"".concat(d,"/v5/AVQualityReportSvc/C2S?random=").concat(g,"&sdkappid=").concat(r,"&cmdtype=").concat(l)},j_="unknown";function MF(){if(j_!=="unknown")return j_;let{userAgent:r,connection:l}=navigator,d=(r.match(/NetType\/\S+/)||[])[0]||"";d=d.toLowerCase().replace("nettype/",""),d==="3gnet"&&(d="3g");let g=l&&l.type&&l.type.toLowerCase(),C=l&&l.effectiveType&&l.effectiveType.toLowerCase();return C==="slow-2"&&(C="2g"),g&&(j_=kF(g,C)),j_}function kF(r,l){if(ww[r])return r;switch(r){case"cellular":case"wimax":return l||"unknown";case"ethernet":return"wired";default:return"unknown"}}function wF(r){j_=kF(r)}function UC(){return ww[MF()]}function Poe(r,l){for(let d of Reflect.ownKeys(l))if(d!=="constructor"&&d!=="prototype"&&d!=="name"){let g=Object.getOwnPropertyDescriptor(l,d)||"";Object.defineProperty(r,d,g)}return r}function xoe(r){return RF(r/4,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function RF(r){return 1e3*r/(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function Uoe(r){return 4*AF(r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function AF(r){return r*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)/1e3}var Foe=typeof window<"u"&&typeof window.glog=="function"?window.glog:()=>{},nd=()=>{let r=navigator.language;return r=r.substring(0,2),r==="zh"},Dc=function(r){if(!r||typeof r!="object"||Object.prototype.toString.call(r)!="[object Object]")return!1;let l=Object.getPrototypeOf(r);if(l===null)return!0;let d=Object.prototype.hasOwnProperty.call(l,"constructor")&&l.constructor;return typeof d=="function"&&d instanceof d&&Function.prototype.toString.call(d)===Function.prototype.toString.call(Object)};function Y_(r){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return r<=1?l:Y_(r-1,l,(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)+l)}function $m(r){return r>8?3e4:1e3*Y_(r)}function ya(r){return Reflect.apply(Object.prototype.toString,r,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}var Er=r=>typeof r=="function",Ft=r=>r===void 0,rr=r=>typeof r=="string",Ti=r=>typeof r=="number",za=r=>typeof r=="boolean",od=r=>ya(r)==="object",Gi=r=>ya(r)==="array",Voe=r=>ya(r)==="MediaStreamTrack".toLowerCase(),qm=r=>r.isRemote,dR=r=>ya(r)==="promise",hR=r=>Er(r)&&r.prototype.constructor===r,DF=r=>hR(r)?r.prototype.constructor.name:"",Goe=typeof AudioWorkletNode<"u";function fR(r){return new Promise((l,d)=>{let g=[];r.forEach(C=>{C.then(l).catch(A=>{g.push(A),g.length===r.length&&d(g)})})})}function xo(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}var OF=r=>+r<10?"0".concat(r):r,Boe=r=>{let l=r.match(/^\d+\.\d+\.\d+/)[0];if(!l)return r;let d=l.split("."),g=OF(d[1])+OF(d[2]);return d[1]-15>0&&(d[1]="15"),d[2]-15>0&&(d[2]="15"),"".concat(d.join("."),".").concat(g)},Hoe=Object.prototype.hasOwnProperty;function LF(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(Dc(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let l in r)if(Hoe.call(r,l))return!1;return!0}return!1}function J_(r,l){return{userId:l,hasAudio:!!(r&w_),hasVideo:!!(r&k_),hasAuxiliary:!!(r&_C),hasSmall:!!(r&Ow),audioMuted:!!(r&Lw),videoMuted:!!(r&Nw),audioAvailable:!(!(r&w_)||r&Lw),videoAvailable:!(!(r&k_)||r&Nw)}}function $oe(r){let l={urls:"turn:".concat(r.url)};return!Ft(r.username)&&!Ft(r.credential)&&(l.username=r.username,l.credential=r.credential,l.credentialType="password",Ft(r.credentialType)||(l.credentialType=r.credentialType)),l}function FC(r){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!rr(r))return 0;let d=r.split(".");return l?(Number(d[0])<<24|Number(d[1])<<16|Number(d[2])<<8|Number(d[3]))>>>0:(Number(d[3])<<24|Number(d[2])<<16|Number(d[1])<<8|Number(d[0]))>>>0}var cf=function(r,l,d,g){if(!od(r)||!od(l))return 0;let C,A=0,L=Object.keys(l);for(let B=0,U=L.length;B<U;B++)if(C=L[B],!(Ft(l[C])||d&&d.includes(C)))if(od(r[C])&&od(l[C]))A+=cf(r[C],l[C],d,g);else{if(g&&g.includes(l[C]))continue;r[C]!==l[C]&&(r[C]=X_(l[C]),A+=1)}return A};function X_(r){if(Gi(r)){let l=[];return r.forEach((d,g)=>{l[g]=X_(d)}),l}if(od(r)){let l={};return Object.keys(r).forEach(d=>{l[d]=X_(r[d])}),l}return r}var VC=r=>{let l=[];if(Gi(r))l=[...r];else if(rr(r)){let d=document.getElementById(r);d&&l.push(d)}else r&&l.push(r);return l},qoe=r=>rr(r)?document.getElementById(r):r,Koe=new Intl.DateTimeFormat("zh-CN",{dateStyle:"short",timeStyle:"medium"}),zoe=()=>Koe.format(new Date);function Oc(r,l){let{keysToInclude:d,keysToExclude:g}=l;try{if(Gi(r))return"[".concat(r.map(B=>Oc(B,{keysToInclude:d,keysToExclude:g})).join(","),"]");if(!Dc(r)||!Gi(d)&&!Gi(g))return JSON.stringify(r);let C={},A=new Set(d),L=new Set(g);return Object.keys(r).forEach(B=>{(L.size===0&&A.has(B)||A.size===0&&!L.has(B))&&(C[B]=Dc(r[B])||Gi(r[B])?JSON.parse(Oc(r[B],{keysToExclude:g,keysToInclude:d})):r[B])}),JSON.stringify(C)}catch{return"{}"}}function NF(r){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1],d=[];return Object.keys(r).forEach(g=>{l===r[g]&&d.push(g)}),Oc(r,{keysToInclude:d})}function pR(r){return r.replace(/[\u4e00-\u9fa5]/g,"aa").length}var PF=()=>{var r,l,d,g;return(r=window.screen)!=null&&r.orientation?!((g=(d=(l=window.screen)==null?void 0:l.orientation)==null?void 0:d.type)==null||!g.includes("portrait")):window.orientation===0||window.orientation===180},GC=r=>at(void 0,null,function*(){return new Promise((l,d)=>{let g;if(rr(r))g=new Image,g.crossOrigin="anonymous",g.src=r;else if(g=r,g.complete)return void l(g);g.onload=()=>l(g),g.onerror=d})}),xF=r=>{let l=r.split(".");return+l[0]<<24|+l[1]<<16|+l[2]<<8|+l[3]},mR=r=>(Object.keys(r).forEach(l=>{Ti(r[l])&&(l.startsWith("uint")||l.startsWith("int"))?r[l]=Math.floor(r[l]):(Dc(r[l])||Gi(r[l]))&&mR(r[l])}),r),Woe=Object.prototype.hasOwnProperty;function joe(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(function(l){if(!l||typeof l!="object"||Object.prototype.toString.call(l)!="[object Object]")return!1;let d=Object.getPrototypeOf(l);if(d===null)return!0;let g=Object.prototype.hasOwnProperty.call(d,"constructor")&&d.constructor;return typeof g=="function"&&g instanceof g&&Function.prototype.toString.call(g)===Function.prototype.toString.call(Object)}(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let l in r)if(Woe.call(r,l))return!1;return!0}return!1}var Yoe=class{constructor(r){Se(this,"userId"),Se(this,"remoteUserId"),Se(this,"id"),Se(this,"sdkAppId"),Se(this,"type"),Se(this,"isLocal"),this.id=r.id,this.userId=r.userId,this.sdkAppId=r.sdkAppId,this.remoteUserId=r.remoteUserId,this.isLocal=typeof r.isLocal!="boolean"||r.isLocal,this.type=this.isLocal?"":r.type}createChild(r){return Object.setPrototypeOf(r,this)}setUserId(r){this.userId=r}setSdkAppId(r){this.sdkAppId=r}log(r,l){let d=this.isLocal?this.userId:this.remoteUserId;l.unshift("[".concat(this.isLocal?"↑":"↓").concat(this.type&&this.type!=="main"?"*":"").concat(this.id).concat(d?"|".concat(d):"","]")),pn.log(r,l,this.userId===void 0||joe(this.userId),this.userId,this.sdkAppId)}info(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(2,l)}debug(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(1,l)}warn(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(3,l)}error(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(4,l)}},$t=CF,Joe=!(Rc||gs||pF),pn=new class{constructor(){Se(this,"_isEnableUploadLog",!0),Se(this,"_localJoinedUser",new Map),Se(this,"_queue",[]),Se(this,"_timeoutId",-1),Se(this,"_logLevel",1),Se(this,"_logLevelToUpload",2),!vC&&!Tw&&(this.checkURLParam(),this.installEvents())}get isAbleToUpload(){return this._isEnableUploadLog&&this._timeoutId!==-1}installEvents(){en.on($t.JOIN_SCHEDULE_SUCCESS,r=>{let{schedule:l}=r;var d;(d=l==null?void 0:l.config)!=null&&d.logLevelToUpload&&Ju[l.config.logLevelToUpload]&&(this._logLevelToUpload=l.config.logLevelToUpload)}),en.on($t.JOIN_SUCCESS,r=>{let{room:l}=r;this.addJoinedUser({userId:l.userId,sdkAppId:l.sdkAppId}),this.startUpload()}),en.once($t.JOIN_FAILED,()=>{this.startUpload()}),en.on($t.LEAVE_SUCCESS,r=>{let{room:l}=r;this.deleteJoinedUser(l.userId)})}startUpload(){this._timeoutId===-1&&this.uploadInterval()}addJoinedUser(r){this._localJoinedUser.set(r.userId,r),this.startUpload()}deleteJoinedUser(r){this._localJoinedUser.delete(r)}uploadInterval(){this.upload().catch(()=>{}),this._timeoutId=window.setTimeout(()=>this.uploadInterval(),2e3)}getLogsToUpload(){let r={map:new Map,splicedQueue:[]};if(this._queue[0].forAllJoinedClients&&this._localJoinedUser.size===0)return r;let l=0;for(;l<this._queue.length&&l!==50;l++){let d=this._queue[l];if(d.forAllJoinedClients)this._localJoinedUser.forEach(g=>{let{userId:C,sdkAppId:A}=g;r.map.has(C)?r.map.get(C).logs.push(d):r.map.set(C,{userId:C,sdkAppId:A,logs:[d]})});else if(rr(d.userId)&&Ti(d.sdkAppId)){let{userId:g,sdkAppId:C}=d;r.map.has(g)?r.map.get(g).logs.push(d):r.map.set(g,{userId:g,sdkAppId:C,logs:[d]})}}return r.map.size>0&&(r.splicedQueue=this._queue.splice(0,l)),r}upload(){return at(this,null,function*(){if(this._queue.length===0||!this._isEnableUploadLog)return;let{map:r,splicedQueue:l}=this.getLogsToUpload();if(r.size===0)return;try{let g=[...r.values()];for(let C=0;C<g.length;C++){let{userId:A,sdkAppId:L,logs:B}=g[C];yield this.uploadLogWithRetry(JSON.stringify({timestamp:U4(),sdkAppId:String(L),userId:A,version:Ol,log:B.map(U=>U.log).join(`
`)}),L),B.forEach(U=>U.uploaded=!0)}}catch{}let d=l.filter(g=>!g.uploaded);d.length>0&&(this._queue=d.concat(this._queue))})}uploadLogWithRetry(r,l){return z_({retryFunction:()=>N_({url:W_(l,M_.LOG),body:r,timeout:5e3}),settings:{retries:3,timeout:1e3},onError:d=>{let{retry:g}=d;g()}})()}getPrefix(r){let l=new Date;l.setTime(Cw());let d=String(l.getMilliseconds());return"padStart"in String.prototype&&(d=d.toString().padStart(3,"0")),"[".concat(l.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(d,"] <").concat(Ju[r],">")}getLogLevel(){return this._logLevel}setLogLevel(r){Ft(Ju[r])||(this._logLevel!==r&&this.info("setLogLevel",r),this._logLevel=r)}enableUploadLog(){this._isEnableUploadLog=!0}disableUploadLog(){this.warn("disableUploadLog"),this._isEnableUploadLog=!1}logChunkToString(r){if(rr(r))return r;try{return r instanceof Error?r.toString():JSON.stringify(r)}catch{return""}}log(r,l){let d=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],g=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0;var A;if(l.unshift(this.getPrefix(r)),this._isEnableUploadLog&&r>=this._logLevelToUpload&&this._queue.push({log:l.reduce((B,U)=>"".concat(B," ").concat(this.logChunkToString(U)).trim(),""),level:r,userId:g,sdkAppId:C,forAllJoinedClients:d}),r<this._logLevel)return;let L=((A=Ju[r])==null?void 0:A.toLowerCase())||"info";Joe?console[L]("%cTRTC%c%s","padding: 1px 4px;border-radius: 3px;color: #fff;background: #1E88E5;","display: inline",...l):console[L](...l)}debug(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(1,l)}info(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(2,l)}warn(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(3,l)}error(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.log(4,l)}createLogger(r){return new Yoe(r)}checkURLParam(){let r=new URLSearchParams(location.search).get("logLevelToUpload"),l=r?Number(r):-1;Ju[l]&&(this._logLevelToUpload=l)}},UF=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let l=16*Math.random()|0;return(r=="x"?l:3&l|8).toString(16)})},Km=new class{constructor(){Se(this,"_prefix","TRTC"),Se(this,"_queue",new Map),this.checkStorage()}getRealKey(r){return"".concat(this._prefix,"_").concat(r)}checkStorage(){sf()&&(setInterval(this.doFlush.bind(this),2e4),Object.keys(localStorage).filter(r=>{if(r.startsWith(this._prefix)){let l=localStorage.getItem(r);if(!l)return!1;let d=JSON.parse(l);if(d&&d.expiresIn<Date.now())return!0}return!1}).forEach(r=>localStorage.removeItem(r)))}doFlush(){if(sf())try{for(let[r,l]of this._queue)localStorage.setItem(r,JSON.stringify(l))}catch(r){pn.warn(r)}}getItem(r){if(!sf())return null;try{let l=localStorage.getItem(this.getRealKey(r));if(!l)return null;let d=JSON.parse(l);return d&&d.expiresIn>=Date.now()?d.value:null}catch(l){pn.warn(l)}}setItem(r,l){if(sf())try{let d={expiresIn:Date.now()+K4,value:l};this._queue.set(this.getRealKey(r),d)}catch(d){pn.warn(d)}}deleteItem(r){if(!sf())return!1;try{return r=this.getRealKey(r),this._queue.delete(r),localStorage.removeItem(r),!0}catch(l){return pn.warn(l),!1}}clear(){if(sf())try{localStorage.clear()}catch(r){pn.warn(r)}}},Z_={};S_(Z_,{HTTPS_API:()=>tre,IS_GET_CAPABILITIES_SUPPORTED:()=>zF,IS_GET_SETTINGS_SUPPORTED:()=>zm,IS_SEI_SUPPORTED:()=>ey,IS_SPC_SUPPORTED:()=>KC,basis:()=>rre,checkSystemRequirementsInternal:()=>IR,decodeSupportStatus:()=>yR,encodeSupportStatus:()=>_R,getBrowserInfo:()=>Zoe,getDisplayResolution:()=>BF,isAddTransceiverSupported:()=>Lc,isBrowserSupported:()=>gR,isGetReceiversSupported:()=>$C,isGetSendersSupported:()=>qC,isGetTransceiversSupported:()=>rd,isGetUserMediaSupported:()=>HF,isMediaDevicesSupported:()=>vR,isMediaSessionSupported:()=>jF,isMediaStreamTrackProcessorSupported:()=>Qoe,isReplaceTrackSupported:()=>KF,isScreenCaptureApiAvailable:()=>BC,isSelectedCandidatePair:()=>Q_,isSetParametersSupported:()=>bR,isSmallStreamAPISupported:()=>qF,isSmallStreamSupported:()=>HC,isStopTransceiverSupported:()=>ore,isTRTCSupported:()=>ere,isUnifiedPlanDefault:()=>nre,isUsedInHttpProtocol:()=>uf,isWebAudioSupported:()=>$F,isWebCodecSupported:()=>WF,isWebCodecsSupported:()=>VF,isWebRTCSupported:()=>CR,isWebTransportSupported:()=>YF});var FF=Vi(Yne(),1),Oo={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isWebCodecsSupported:!1,isMediaDevicesSupported:!1,isScreenShareSupported:!1,isSmallStreamSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1}},Xoe=new Map([[Nr,["Firefox",Hw]],[U_,["Edg",qw]],[PC,["Chrome",rR]],[Ac,["Safari",K_]],[Pl,["TBS",Ww]],[MC,["XWEB",jw]],[kC&&Fm,["WeChat",Yw]],[wC,["QQ(Win)",Jw]],[V_,["QQ(Mobile)",G_]],[F_,["QQ(Mobile X5)",G_]],[RC,["QQ(Mac)",Xw]],[AC,["QQ(iPad)",Zw]],[OC,["MI",Qw]],[LC,["HW",eR]],[NC,["Samsung",tR]],[B_,["OPPO",nR]],[H_,["VIVO",oR]],[x_,["EDGE",$w]],[EC,["SogouMobile",Kw]],[TC,["Sogou",zw]]]);function Zoe(){let r=Xoe.get(!0);return{browserName:r?r[0]:"unknown",browserVersion:r?r[1]:"unknown"}}var gR=function(){return!(hF||x_||U_&&cF<80||Nr&&lF<56)},VF=function(){return["VideoDecoder","VideoEncoder","AudioEncoder","AudioDecoder","MediaStreamTrackGenerator"].every(r=>r in window)},vR=function(){if(!navigator.mediaDevices)return uf()||pn.error(Js.NOT_SUPPORTED_MEDIA),!1;let r=["getUserMedia","enumerateDevices"];return r.filter(l=>l in navigator.mediaDevices).length===r.length},GF=!1;function uf(){return location.protocol==="http:"&&!af&&(GF||pn.error(so({key:to.NOT_SUPPORTED_HTTP})),GF=!0,!0)}var Qoe=function(){return(window==null?void 0:window.OffscreenCanvas)&&(window==null?void 0:window.MediaStreamTrackProcessor)&&(window==null?void 0:window.MediaStreamTrackGenerator)},_R=function(){return at(this,null,function*(){if(Oo.detail.isH264EncodeSupported&&Oo.detail.isVp8EncodeSupported)return{isH264EncodeSupported:Oo.detail.isH264EncodeSupported,isVp8EncodeSupported:Oo.detail.isVp8EncodeSupported};let r,l=!1,d=!1;try{let g=new RTCPeerConnection,C=document.createElement(Be.CANVAS);C.getContext("2d");let A=C.captureStream(0);return g.addTrack(A.getVideoTracks()[0],A),r=yield g.createOffer(),r.sdp.toLowerCase().indexOf("h264")!==-1&&(l=!0),r.sdp.toLowerCase().indexOf("vp8")!==-1&&(d=!0),g.close(),Oo.detail.isH264EncodeSupported=l,Oo.detail.isVp8EncodeSupported=d,{isH264EncodeSupported:Oo.detail.isH264EncodeSupported,isVp8EncodeSupported:Oo.detail.isVp8EncodeSupported}}catch{return{isH264EncodeSupported:!1,isVp8EncodeSupported:!1}}})},yR=function(){return at(this,null,function*(){if(Oo.detail.isH264DecodeSupported&&Oo.detail.isVp8DecodeSupported)return{isH264DecodeSupported:Oo.detail.isH264DecodeSupported,isVp8DecodeSupported:Oo.detail.isVp8DecodeSupported};let r,l=!1,d=!1;try{let g=new RTCPeerConnection;return r=yield g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}),r.sdp.toLowerCase().indexOf("h264")!==-1&&(l=!0),r.sdp.toLowerCase().indexOf("vp8")!==-1&&(d=!0),g.close(),{isH264DecodeSupported:l,isVp8DecodeSupported:d}}catch{return{isH264DecodeSupported:!1,isVp8DecodeSupported:!1}}})},IR=function(){return at(this,null,function*(){if(Oo.result&&Oo.detail.isH264EncodeSupported&&Oo.detail.isVp8EncodeSupported&&Oo.detail.isH264DecodeSupported&&Oo.detail.isVp8DecodeSupported)return Oo;let r=gR(),l=CR(),d=VF(),g=vR(),{isH264EncodeSupported:C,isVp8EncodeSupported:A}=yield _R(),{isH264DecodeSupported:L,isVp8DecodeSupported:B}=yield yR();if(!C||!A){let U=yield _R();pn.warn("detect encode again h264:".concat(C," vp8:").concat(A," result: ").concat(JSON.stringify(U))),C=U.isH264EncodeSupported,A=U.isVp8EncodeSupported}if(C&&L&&(B_||H_||mF)&&!Pl&&Gm()<79){let{encode:U,decode:Z}=yield function(){return at(this,null,function*(){return new Promise(ae=>at(this,null,function*(){let ce={encode:!1,decode:!1},we=()=>{};try{pn.warn("start detect h264 supported by encoding and decoding canvas stream");let Pe=document.createElement("canvas"),Ze=Pe.getContext("2d");Pe.width=640,Pe.height=480;let Ct=setInterval(()=>{Ze.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))},33),Bt=-1,Wt=-1;we=()=>{clearInterval(Bt),clearInterval(Ct),clearTimeout(Wt),En.close(),Ln.close(),kt.getTracks().forEach(qi=>qi.stop())},Wt=setTimeout(()=>{we(),ae(ce)},3e3);let kt=Pe.captureStream(),En=new RTCPeerConnection({}),Ln=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0});En.addEventListener("icecandidate",qi=>Ln.addIceCandidate(qi.candidate)),Ln.addEventListener("icecandidate",qi=>En.addIceCandidate(qi.candidate)),En.addTrack(kt.getVideoTracks()[0],kt);let Hn=yield En.createOffer();yield En.setLocalDescription(Hn),yield Ln.setRemoteDescription(Hn);let Zo=yield Ln.createAnswer(),ir=FF.default.parse(Zo.sdp),fd=ir.media[0].rtp.findIndex(qi=>qi.codec==="H264");ir.media[0].rtp=[ir.media[0].rtp[fd]],ir.media[0].fmtp=ir.media[0].fmtp.filter(qi=>qi.payload===ir.media[0].rtp[0].payload),ir.media[0].rtcpFb&&(ir.media[0].rtcpFb=ir.media[0].rtcpFb.filter(qi=>qi.payload===ir.media[0].rtp[0].payload)),Zo.sdp=FF.default.write(ir),yield Ln.setLocalDescription(Zo),yield En.setRemoteDescription(Zo),Bt=setInterval(()=>at(this,null,function*(){ce.encode&&ce.decode&&(we(),ae(ce));let qi=yield En.getStats(),gS=yield Ln.getStats();ce.encode||qi.forEach(Gl=>{Gl.type==="outbound-rtp"&&Gl.mediaType===Be.VIDEO&&Gl.framesEncoded>0&&(ce.encode=!0)}),ce.decode||gS.forEach(Gl=>{Gl.type==="inbound-rtp"&&Gl.mediaType===Be.VIDEO&&Gl.framesDecoded>0&&(ce.decode=!0)})}),500)}catch(Pe){we(),pn.warn(Pe),ae(ce)}}))})}();C=U,L=Z}return Oo.result=r&&l&&g&&(C||A)&&(L||B),Oo.detail.isBrowserSupported=r,Oo.detail.isWebRTCSupported=l,Oo.detail.isWebCodecsSupported=d,Oo.detail.isMediaDevicesSupported=g,Oo.detail.isScreenShareSupported=BC(),Oo.detail.isSmallStreamSupported=HC(),Oo.detail.isH264EncodeSupported=C,Oo.detail.isVp8EncodeSupported=A,Oo.detail.isH264DecodeSupported=L,Oo.detail.isVp8DecodeSupported=B,Oo.result||pn.error("".concat(navigator.userAgent," ").concat(NF(Oo.detail,!1))),Km.setItem(JF,{ua:navigator.userAgent,checkResult:Oo}),Oo})},ere=function(){return Oo.result},BC=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},tre=(r,l,d)=>{location.protocol==="http:"&&!af&&(r[l]=()=>{throw new Rn({code:an.INVALID_OPERATION,message:Js.NOT_SUPPORTED_HTTP})})},Q_=function(r){return!(r.type!=="candidate-pair"||!r.nominated||r.state!=="in-progress"&&r.state!=="succeeded")&&!(za(r.selected)&&!r.selected)};function BF(){let r="";if(screen.width){let l=screen.width?screen.width*window.devicePixelRatio:"",d=screen.height?screen.height*window.devicePixelRatio:"";r+="".concat(l," * ").concat(d)}return r}function HF(){return navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function $F(){let r={isSupported:!1},l=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"];for(let d=0;d<l.length;d++)if(l[d]in window){r.isSupported=!0;break}return r.isSupported}function qF(){return"captureStream"in HTMLCanvasElement.prototype}function HC(){return!(kC||Rc||Bm&&Bm<63)&&!(!gR()||!qF())}var nre=function(){if(Ft(window.RTCRtpTransceiver)||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let r=null,l=!1;try{r=new RTCPeerConnection({sdpSemantics:R_}),r.addTransceiver(Be.AUDIO),l=!0}catch{}return r==null||r.close(),l};function $C(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype}function qC(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype}function rd(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype}function Lc(){return iR!==11&&"RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype}var KC=!(!Lc()||$_&&Bm<74);function ore(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype}function KF(){return"RTCRtpSender"in window&&"replaceTrack"in window.RTCRtpSender.prototype}function bR(){return"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype&&qC()}var zm=window.MediaStreamTrack&&"getSettings"in MediaStreamTrack.prototype,zF=window.MediaStreamTrack&&"getCapabilities"in MediaStreamTrack.prototype,ey="RTCRtpSender"in window&&"createEncodedStreams"in window.RTCRtpSender.prototype&&Gm()>=86,CR=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter(r=>r in window).length>0};function WF(){let r={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1};return Ft(window.AudioDecoder)||(r.AudioDecoder=!0),Ft(window.AudioEncoder)||(r.AudioEncoder=!0),Ft(window.VideoDecoder)||(r.VideoDecoder=!0),Ft(window.VideoEncoder)||(r.VideoEncoder=!0),Ft(window.ImageDecoder)||(r.ImageDecoder=!0),r}function jF(){return"mediaSession"in navigator&&!Ft(navigator.mediaSession.setActionHandler)}function YF(){return!Ft(window.WebTransport)}function rre(){let r={browser:"".concat(ed.name,"/").concat(ed.version),os:sR(),displayResolution:BF(),isScreenShareSupported:BC(),isWebRTCSupported:CR(),isGetUserMediaSupported:HF(),isWebAudioSupported:$F(),isWebSocketsSupported:"WebSocket"in window&&window.WebSocket.CLOSING===2,isWebCodecSupported:WF(),isMediaSessionSupported:jF(),isWebTransportSupported:YF()};return navigator.userAgent.includes("miniProgram")&&(r.browser="mini/".concat(r.browser)),r}var JF="checkResult";(function(){uf();let r=Km.getItem(JF);r&&r.ua===navigator.userAgent&&(Oo=r.checkResult),IR()})();var ire=Vi(qa(),1),XF=Symbol("instance"),zC=Symbol("cacheResult"),SR=class{constructor(r,l,d){this.oldState=r,this.newState=l,this.action=d,this.aborted=!1}abort(r){this.aborted=!0,ny.call(r,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},ER=class extends Error{constructor(r,l,d){super(l),this.state=r,this.message=l,this.cause=d}},ty=new Map;function Bi(r,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(g,C,A)=>{let L=d.action||C;if(!d.context){let U=ty.get(g)||[];ty.has(g)||ty.set(g,U),U.push({from:r,to:l,action:L})}let B=A.value;A.value=function(){let U=this;for(var Z=arguments.length,ae=new Array(Z),ce=0;ce<Z;ce++)ae[ce]=arguments[ce];if(d.context&&(U=wo.get(typeof d.context=="function"?d.context.call(this,...ae):d.context)),U.state===l)return d.sync?U[zC]:Promise.resolve(U[zC]);U.state instanceof SR&&U.state.action==d.abortAction&&U.state.abort(U);let we=null;Array.isArray(r)?r.length==0?U.state instanceof SR&&U.state.abort(U):(typeof U.state!="string"||!r.includes(U.state))&&(we=new ER(U._state,"".concat(U.name," ").concat(L," to ").concat(l," failed: current state ").concat(U._state," not from ").concat(r.join("|")))):r!==U.state&&(we=new ER(U._state,"".concat(U.name," ").concat(L," to ").concat(l," failed: current state ").concat(U._state," not from ").concat(r)));let Pe=kt=>{if(d.fail&&d.fail.call(this,kt),d.sync){if(d.ignoreError)return kt;throw kt}return d.ignoreError?Promise.resolve(kt):Promise.reject(kt)};if(we)return Pe(we);let Ze=U.state,Ct=new SR(Ze,l,L);ny.call(U,Ct);let Bt=kt=>{var En;return U[zC]=kt,Ct.aborted||(ny.call(U,l),(En=d.success)===null||En===void 0||En.call(this,U[zC])),kt},Wt=kt=>{let En=kt instanceof Error?kt.message:String(kt);return ny.call(U,Ze,kt),Pe(new ER(U._state,"action '".concat(L,"' failed :").concat(En),kt instanceof Error?kt:new Error(En)))};try{let kt=B.apply(this,ae);return function(En){return typeof En=="object"&&En&&"then"in En}(kt)?kt.then(Bt).catch(Wt):d.sync?Bt(kt):Promise.resolve(Bt(kt))}catch(kt){return Wt(kt)}}}}var are=typeof window<"u"&&window.__AFSM__?(r,l)=>{window.dispatchEvent(new CustomEvent(r,{detail:l}))}:typeof importScripts<"u"?(r,l)=>{postMessage({type:r,payload:l})}:()=>{};function ny(r,l){let d=this._state;this._state=r;let g=r.toString();r&&this.emit(g,d),this.emit(wo.STATECHANGED,r,d,l),this.updateDevTools({value:r,old:d,err:l instanceof Error?l.message:String(l)})}var wo=class extends ire.default{constructor(r,l,d){super(),this.name=r,this.groupName=l,this._state=wo.INIT,r||(r=Date.now().toString(36)),d?Object.setPrototypeOf(this,d):d=Object.getPrototypeOf(this),l||(this.groupName=this.constructor.name);let g=d[XF];g?this.name=g.name+"-"+g.count++:d[XF]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let r=Object.getPrototypeOf(this),l=ty.get(r)||[],d=new Set,g=[],C=[],A=new Set,L=Object.getPrototypeOf(r);ty.has(L)&&(L.stateDiagram.forEach(U=>d.add(U)),L.allStates.forEach(U=>A.add(U))),l.forEach(U=>{let{from:Z,to:ae,action:ce}=U;typeof Z=="string"?g.push({from:Z,to:ae,action:ce}):Z.length?Z.forEach(we=>{g.push({from:we,to:ae,action:ce})}):C.push({to:ae,action:ce})}),g.forEach(U=>{let{from:Z,to:ae,action:ce}=U;A.add(Z),A.add(ae),A.add(ce+"ing"),d.add("".concat(Z," --> ").concat(ce,"ing : ").concat(ce)),d.add("".concat(ce,"ing --> ").concat(ae," : ").concat(ce," 🟢")),d.add("".concat(ce,"ing --> ").concat(Z," : ").concat(ce," 🔴"))}),C.forEach(U=>{let{to:Z,action:ae}=U;d.add("".concat(ae,"ing --> ").concat(Z," : ").concat(ae," 🟢")),A.forEach(ce=>{ce!==Z&&d.add("".concat(ce," --> ").concat(ae,"ing : ").concat(ae))})});let B=[...d];return Object.defineProperties(r,{stateDiagram:{value:B},allStates:{value:A}}),B}static get(r){let l;return typeof r=="string"?(l=wo.instances.get(r),l||wo.instances.set(r,l=new wo(r,void 0,Object.create(wo.prototype)))):(l=wo.instances2.get(r),l||wo.instances2.set(r,l=new wo(r.constructor.name,void 0,Object.create(wo.prototype)))),l}static getState(r){var l;return(l=wo.get(r))===null||l===void 0?void 0:l.state}updateDevTools(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};are(wo.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},r))}get state(){return this._state}set state(r){ny.call(this,r)}};wo.STATECHANGED="stateChanged",wo.UPDATEAFSM="updateAFSM",wo.INIT="[*]",wo.ON="on",wo.OFF="off",wo.instances=new Map,wo.instances2=new WeakMap;var ZF=(window==null?void 0:window.requestIdleCallback)||function(r){let l=Date.now();return setTimeout(()=>{r({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-l))})},1e3)},sre=(window==null?void 0:window.cancelIdleCallback)||function(r){clearTimeout(r)},lre=(window==null?void 0:window.cancelAnimationFrame)||(window==null?void 0:window.mozCancelAnimationFrame),TR=class{static generateTaskID(){return this.currentTaskID++}static run(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L_,l=arguments.length>1?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0;d=Fn(r===SC?{delay:2e3,count:0,backgroundTask:!0}:r===Um?{delay:1e4,count:0}:r===Uw?{fps:60,delay:16.6,count:0,backgroundTask:!0}:{delay:2e3,count:0,backgroundTask:!0},d),od(l)&&(d=Fn(Fn({},d),l)),Er(r)&&(l=r,r=L_);let g=Fn({taskID:this.generateTaskID(),loopCount:0,intervalID:null,timeoutID:null,rafID:null,ricID:null,taskName:r,callback:l},d);return this.taskMap.set(g.taskID,g),this[r](g),g.taskID}static interval(r){return r.intervalID=setInterval(()=>{r.callback(),r.loopCount+=1,this.isBreakLoop(r)},r.delay)}static intervalInWorker(r){r.delay=(1e3/r.fps).toFixed(2);let l=new Worker(URL.createObjectURL(new Blob([`
        let timerID = null;
        self.onmessage = function (e) {
          if (e.data === 'start') {
            timerID = setInterval(() => {
              self.postMessage('tick');
            }, `.concat(r.delay,`);
          } else if (e.data === 'stop') {
            clearInterval(timerID);
          }
        };
      `)],{type:"application/javascript"})));l.onmessage=d=>{d.data==="tick"&&(r.callback(),r.loopCount+=1,this.isBreakLoop(r)&&l.postMessage("stop"))},r.worker=l,l.postMessage("start")}static timeout(r){let l=()=>{if(r.callback(),r.loopCount+=1,!this.isBreakLoop(r))return r.timeoutID=setTimeout(l,r.delay)};return r.timeoutID=setTimeout(l,r.delay)}static ric(r){let l,d=xo(),g=()=>{if(l=xo()-d,l>=r.delay&&(d=xo()-Math.floor(l%r.delay),r.callback(),r.loopCount+=1),!this.isBreakLoop(r))return r.ricID=ZF(g,{timeout:r.delay})};return r.ricID=ZF(g,{timeout:r.delay})}static raf(r){r.delay=(1e3/r.fps).toFixed(2);let l,d=xo(),g=()=>document.hidden&&r.backgroundTask?(l=xo()-d,d=xo(),r.callback(),r.loopCount+=1,this.isBreakLoop(r)?void 0:r.timeoutID=setTimeout(g,r.delay-Math.floor(l%r.delay))):(l=xo()-d,l>=r.delay&&(d=xo()-Math.floor(l%r.delay),r.callback(),r.loopCount+=1),this.isBreakLoop(r)?void 0:r.rafID=requestAnimationFrame(g));if(r.rafID=requestAnimationFrame(g),r.backgroundTask){let C=()=>{if(document.hidden){let A=xo()-d;A>=r.delay?g():r.timeoutID=setTimeout(g,r.delay-A)}};document.addEventListener("visibilitychange",C),r.onVisibilitychange=C,document.hidden&&C()}return r.taskID}static hasTask(r){return this.taskMap.has(r)}static clearTask(r){if(!this.taskMap.has(r))return!0;let{intervalID:l,timeoutID:d,rafID:g,ricID:C,onVisibilitychange:A,worker:L}=this.taskMap.get(r);return L&&L.terminate(),l&&clearInterval(l),d&&clearTimeout(d),g&&lre(g),C&&sre(C),A&&document.removeEventListener("visibilitychange",A),this.taskMap.delete(r),!0}static isBreakLoop(r){return!this.taskMap.has(r.taskID)||r.count!==0&&r.loopCount>=r.count&&(this.clearTask(r.taskID),!0)}};TR.taskMap=new Map,TR.currentTaskID=1;var Hr=TR,xl={LOADED_DATA:Be.LOADEDDATA,MEDIA_TRACK_CHANGED:"media-track-changed",PLAYER_STATE_CHANGED:"player-state-changed"},MR={};S_(MR,{create:()=>Ul,remove:()=>Ia});var oy=new WeakMap;function Ul(r,l){oy.has(r)||oy.set(r,[]);let d=oy.get(r),g={add:(C,A)=>("addEventListener"in l?(d.push(l.removeEventListener.bind(l,C,A)),l.addEventListener(C,A)):(d.push(l.off.bind(l,C,A)),l.on(C,A)),g)};return g}function Ia(r){let l=oy.get(r);l&&(l.forEach(d=>d()),oy.delete(r))}var ry=class extends wo{constructor(r,l){super(r.id,"".concat(l,"-player")),this.kind=l,Se(this,"id"),Se(this,"element",null),Se(this,"track"),Se(this,"url"),Se(this,"attr"),Se(this,"muted"),Se(this,"_log"),Se(this,"_pausedRetryCount"),Se(this,"_isElementPlayingFired",!1),Se(this,"_interval"),this.id=r.id,this._log=r.log,this.track=r.track,this.muted=r.muted,this._pausedRetryCount=nF,this._state="STOPPED",this.bindTrackEvents(),this._log.info("create ".concat(l,"-player ").concat(this.id))}get isPlaying(){return this._state==="PLAYING"}get isStopped(){return this._state==="STOPPED"}setAttr(r){this.attr=r}setUrl(r){this.track&&(this.unbindTrackEvents(),this.element&&(this.element.srcObject=null),this.track=null),r!==this.url&&(this.url=r,r!==null&&this.element&&(this.element.crossOrigin="anonymous",this.element.src=r))}play(){return at(this,null,function*(){if(!this.isPlaying)try{this.bindAutoPlayEvent(),yield this.element.play()}catch(r){let l=so({key:to.PLAY_FAILED,data:{media:this.kind,error:r}});if(this.track&&!this.track.muted&&this._log.warn(r),l.includes("NotAllowedError"))throw new Rn({code:an.PLAY_NOT_ALLOWED,message:l})}})}stop(){this.unbindEvents(),this._isElementPlayingFired=!1,this.element&&(this.element.remove(),this.element.srcObject=null,this.element=null),this.handleStopped(Be.ENDED),this._interval>0&&Hr.clearTask(this._interval)}pause(){var r;this.isPlaying&&((r=this.element)==null||r.pause())}resume(){return this.isPlaying?Promise.resolve():gF?this.replay():this.play().catch(()=>{})}setMuted(r){this.element&&(this.element.muted=r),this.muted=r}replay(){return this.stop(),this.play().catch(()=>{})}bindElementEvents(){if(this.element){let r=this.handleElementEvent.bind(this);return Ul(this.element,this.element).add(Be.PLAYING,r).add(Be.ENDED,r).add(Be.PAUSE,r).add(Be.ERROR,r).add(Be.LOADEDDATA,r)}}bindTrackEvents(){if(this.track){let r=this.handleTrackEvent.bind(this);MR==null||MR.create(this.track,this.track).add(Be.ENDED,r).add(Be.MUTE,r).add(Be.UNMUTE,r),this.track.readyState===Be.ENDED&&this.handleTrackEvent({type:Be.ENDED}),this.track.muted&&this.handleTrackEvent({type:Be.MUTE})}}bindAutoPlayEvent(){en.on($t.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}unbindTrackEvents(){this.track&&Ia(this.track)}unbindEvents(){this.element&&Ia(this.element),this.unbindTrackEvents(),en.off($t.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}handleElementEvent(r){switch(r.type){case Be.PLAYING:this._isElementPlayingFired=!0,this._log.info("".concat(this.kind," player is playing")),this.handlePlaying(Be.PLAYING),this._interval&&(Hr.clearTask(this._interval),this._interval=-1);break;case Be.ENDED:this._log.info("".concat(this.kind," player is ended")),this.handleStopped(Be.ENDED);break;case Be.PAUSE:this._log.info("".concat(this.kind," player is paused")),this.handlePaused(Be.PAUSE),Rc&&(this._interval=Hr.run(L_,()=>{this.element&&this._state==="PAUSED"&&this.resume()},{delay:3e3}));break;case Be.ERROR:if(this.element&&this.element.error){let{code:l,message:d}=this.element.error;this._log.error("".concat(this.kind," player error observed. code: ").concat(l," message: ").concat(d," userAgent: ").concat(navigator.userAgent)),li.uploadEvent({log:"stat-".concat(this.kind,"-").concat(wc.PLAYER_ERROR,"-").concat(l,"-").concat(navigator.userAgent),error:this.element.error})}break;case Be.LOADEDDATA:this.kind===Be.VIDEO&&this.emit(xl.LOADED_DATA)}}handleTrackEvent(r){switch(r.type){case Be.ENDED:this._log.info("".concat(this.kind," track is ended")),this.handleStopped(Be.ENDED);break;case Be.MUTE:this._log.info("".concat(this.kind," track is unable to provide media output")),this.handlePaused(Be.MUTE);break;case Be.UNMUTE:this._log.info("".concat(this.kind," track is able to provide media output")),this._isElementPlayingFired&&this.handlePlaying(Be.UNMUTE)}}handlePlaying(r){this.emit(xl.PLAYER_STATE_CHANGED,{type:this.kind,state:"PLAYING",reason:r})}handlePaused(r){this.emit(xl.PLAYER_STATE_CHANGED,{type:this.kind,state:"PAUSED",reason:r})}handleStopped(r){this.emit(xl.PLAYER_STATE_CHANGED,{type:this.kind,state:"STOPPED",reason:r})}getElement(){return this.element}};In([Bi([],"PLAYING",{sync:!0})],ry.prototype,"handlePlaying"),In([Bi("PLAYING","PAUSED",{ignoreError:!0,sync:!0})],ry.prototype,"handlePaused"),In([Bi([],"STOPPED",{sync:!0})],ry.prototype,"handleStopped");var Nc="trtc_autoplay",kR="".concat(Nc,"_mask"),Wm="".concat(Nc,"_wrapper"),QF="".concat(Nc,"_header"),wR="".concat(Nc,"_content"),WC="".concat(Nc,"_action_wrapper"),RR="".concat(Nc,"_question"),AR="".concat(Nc,"_collapse"),jC="".concat(Nc,"_action_confirm"),eV="".concat(Nc,"_detail"),tV="#2473E8",DR="dialog",cre="".concat(DR,"-show"),ure="".concat(DR,"-1"),dre="".concat(DR,"-2"),nV=!1,oV=()=>!!document.querySelector(".".concat(Wm)),rV="".concat(tf,"/").concat(nd()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),iV="<br><a href='".concat(rV,"' target='_blank'>").concat(nd()?"其他方案？":"Any other solution?","</a>"),hre="".concat(nd()?"浏览器自动播放策略：在用户与页面产生交互（点击、触摸）之前，浏览器禁止播放有声媒体。该弹窗用于帮助用户恢复音视频播放。".concat(iV):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat(iV)),fre=class{constructor(){if(Se(this,"content","音视频播放被浏览器拦截，请点击“恢复播放”。"),Se(this,"_dialogNode",null),Se(this,"_bodyPosition",""),Se(this,"_showDetail",!1),Se(this,"_isCollapseClicked",!1),Se(this,"_isQuestionClicked",!1),nd()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!nV){let r=document.createElement("style");r.innerHTML=".".concat(kR,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(kR," div:not(.").concat(WC,"){display:block !important;}.").concat(Wm,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(Wm," a{color:").concat(tV,";}.").concat(QF,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(wR,"{margin:8px 0;}.").concat(WC,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat(AR,"{margin-right:auto;cursor:pointer}.").concat(RR,"{height:100%;line-height:16px;cursor:pointer;}.").concat(jC,"{margin-left:8px;color:#fff;background:").concat(tV,";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(jC,":hover{opacity:0.9;}.").concat(AR,",.").concat(jC,",.").concat(wR,",.").concat(RR,"{font-size:14px;}@media screen and (max-width:750px){.").concat(Wm,"{width:80vw;}}"),document.head.appendChild(r),nV=!0}this.addDiaLog()}createDiaLog(){let r=document.createElement("template");r.innerHTML='<div class="'.concat(kR,`"><div class='`).concat(Wm,"'><div class='").concat(QF,"'>").concat(location.host,"</div><div class='").concat(wR,"'>").concat(this.content,"</div><div class='").concat(eV,`' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">`).concat(hre,"</div><div class='").concat(WC,"'></div></div></div>").trim();let l=document.createElement("button");l.className=jC,l.innerText=nd()?"恢复播放":"Resume",l.onclick=this.onConfirm.bind(this);let d=document.createElement("div");d.className=RR,d.innerHTML=`<?xml version="1.0" encoding="UTF-8"?>
    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>
    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>
    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>
    </svg>
    `,d.onclick=this.onQuestionClick.bind(this);let g=document.createElement("div");g.className=AR,g.innerText="".concat(nd()?"详情 >":"Detail >"),g.onclick=this.onCollapseClick.bind(this);let C=r.content.firstChild,A=C.querySelector(".".concat(WC));return A.appendChild(g),A.appendChild(d),A.appendChild(l),C}addDiaLog(){oV()||(this._dialogNode=this.createDiaLog(),document.body.appendChild(this._dialogNode),this._dialogNode.onclick=this.onConfirm.bind(this),this._dialogNode.querySelector(".".concat(Wm)).onclick=r=>r.stopPropagation(),this._bodyPosition=document.body.style.position,document.body.style.position="fixed",pn.info("show autoplay dialog"),li.uploadEvent({log:cre}))}deleteDiaLog(){this._dialogNode&&(document.body.removeChild(this._dialogNode),document.body.style.position=this._bodyPosition,this._dialogNode=null)}onConfirm(){pn.warn("confirm clicked, try resume stream"),en.emit($t.AUTOPLAY_DIALOG_CLICK_CONFIRM),this.deleteDiaLog()}onCollapseClick(){let r=this._dialogNode.querySelector(".".concat(eV));r.style.visibility="".concat(this._showDetail?"hidden":"visible"),r.style.height="".concat(this._showDetail?0:"fit-content"),this._showDetail=!this._showDetail,this._isCollapseClicked||li.uploadEvent({log:ure}),this._isCollapseClicked=!0}onQuestionClick(){window.open(rV,"_blank"),this._isQuestionClicked||li.uploadEvent({log:dre}),this._isQuestionClicked=!0}},df=class extends ry{constructor(r){super(r,Be.VIDEO),Se(this,"viewMirror",!1),Se(this,"objectFit"),Se(this,"container"),Se(this,"canvas"),this.container=r.container,this.canvas=r.canvas,Ft(r.viewMirror)||(this.viewMirror=r.viewMirror),Ft(r.objectFit)||(this.objectFit=r.objectFit),this.initializeElement()}initializeElement(){var r;let l=document.createElement(Be.VIDEO);this.track&&(l.srcObject=new MediaStream([this.track])),l.muted=!0,l.setAttribute("id","video_".concat(this.id)),l.setAttribute("style",this.styleAttribute),this.canvas&&this.canvas.setAttribute("style",this.styleAttribute),l.setAttribute("autoplay","autoplay"),l.setAttribute("playsinline","playsinline"),this.element=l,(r=this.container)==null||r.appendChild(this.elementToRender),this.bindElementEvents()}get styleAttribute(){let r="width: 100%; height: 100%; object-fit: ".concat(this.objectFit,";background-color: black;");return this.viewMirror&&(r+="transform: scaleX(-1);"),r}setContainer(r){var l;this.container=r,this.track&&this.elementToRender&&((l=this.container)==null||l.appendChild(this.elementToRender))}bindElementEvents(){let r=super.bindElementEvents();this.handleElementEvent=this.handleElementEvent.bind(this),r&&r.add(Be.ENTER_PICTURE_IN_PICTURE,this.handleElementEvent).add(Be.LEAVE_PICTURE_IN_PICTURE,this.handleElementEvent)}handleElementEvent(r){var l;super.handleElementEvent(r);let d=r.type;if(d===Be.PAUSE&&(this.container&&document.getElementById(this.container.id)||this._log.warn("".concat(this.kind," player has been remove, element ID: ").concat((l=this.container)==null?void 0:l.id)),this._pausedRetryCount>0&&!oV()&&(this._log.info("".concat(this.kind," player auto resume when paused")),this.resume(),this._pausedRetryCount--)),this.viewMirror&&this.element){let g=this.element.style.transform;d===Be.ENTER_PICTURE_IN_PICTURE?this.element.style.transform=g.replace("scaleX(-1)",""):d===Be.LEAVE_PICTURE_IN_PICTURE&&!g.includes("scaleX")&&(this.element.style.transform="".concat(g," scaleX(-1)"))}}setCanvas(r){var l,d;this.canvas!==r&&((l=this.canvas)==null||l.remove(),r==null||r.setAttribute("style",this.styleAttribute),this.canvas=r,r&&((d=this.container)==null||d.appendChild(r)))}setAttr(r){let l=Object.assign({autoplay:"autoplay",playsinline:"playsinline",muted:!0},r);l.style=Object.assign({width:"100%",height:"100%"},l.style),super.setAttr(l)}get mirror(){return this.viewMirror}setRect(r,l){this.elementToRender&&(this.elementToRender.style.width="".concat(r,"px"),this.elementToRender.style.height="".concat(l,"px"))}setViewMirror(r){this.elementToRender&&(this.elementToRender.style.transform=r?"scaleX(-1)":""),this.viewMirror=r}setObjectFit(r){this.elementToRender&&(this.elementToRender.style.objectFit="".concat(r)),this.objectFit=r}stop(){var r;super.stop(),(r=this.canvas)==null||r.remove()}play(){return this.element?this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender):this.initializeElement(),super.play()}get elementToRender(){return this.canvas||this.element}setTrack(r){r!==this.track&&(this.unbindTrackEvents(),this.track=r,this.emit(xl.MEDIA_TRACK_CHANGED,r),r!==null&&(this.bindTrackEvents(),this.element&&(this.element.srcObject=new MediaStream([r]),this.element.remove()),this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender)))}getVideoFrame(){if(this.canvas)return this.canvas.toDataURL("image/png");if(!this.element)return"";let r=document.createElement("canvas");return r.width=this.element.videoWidth,r.height=this.element.videoHeight,r.getContext("2d").drawImage(this.element,0,0),r.toDataURL("image/png")}getElement(){return this.element}};function YC(r,l){return at(this,null,function*(){if(!r.audioWorklet)return Promise.reject("audioWorklet is not supported");try{yield r.audioWorklet.addModule(l),pn.info("worklet addModule success")}catch(d){throw pn.info("worklet addModule catch error. ".concat(d.message)),d}})}typeof window<"u"&&(window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext);var hf=new window.AudioContext({sampleRate:48e3}),JC=()=>{hf.state==="suspended"?(hf.resume(),document.addEventListener("click",JC)):hf.state==="interrupted"?hf.resume():document.removeEventListener("click",JC)};document.addEventListener("click",JC),hf.onstatechange=()=>{pn.info("context state: ".concat(hf.state)),JC()};var Qs,Eo,OR,id=r=>hf,aV=class{constructor(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.countMap=new Map,this.distributionMap=new Map,this.log=pn.createLogger({id:"kv"}),r&&(en.on("102",l=>{let{track:d,cost:g}=l;this.addSuccessEvent({key:d.kind===Be.AUDIO?LR.START_MICROPHONE:NR.START_CAMERA,cost:g})}),en.on("103",l=>{let{track:d,error:g}=l;this.addFailedEvent({key:d.kind===Be.AUDIO?LR.START_MICROPHONE:NR.START_CAMERA,error:g})}))}getReportData(){let r={msg_sdk_basic_info:{uint32_sdk_version:xF(this.version||Ol),uint32_terminal_type:15,bytes_device_name:"",bytes_os_version:"",uint32_framework:30,uint32_network_type:0},stats_count:[...this.countMap.entries()].map(l=>{let[d,g]=l;return{uint32_key:d,uint32_count:g}}),stats_distribution:[...this.distributionMap.entries()].map(l=>{let[d,g]=l;return{uint32_key:d,distribution_items:[...g.entries()].map(C=>{let[A,L]=C;return{uint32_item_key:A,uint32_item_value:L}})}})};return this.countMap.clear(),this.distributionMap.clear(),r}clear(){this.countMap.clear(),this.distributionMap.clear()}isEnumKey(r){let l=+String(r).slice(-3);return l>=700&&l<799}isErrorCodeKey(r){let l=+String(r).slice(-3);return l>=600&&l<699}isCountKey(r){let l=+String(r).slice(-3);return l>=0&&l<599}isNumberKey(r){let l=+String(r).slice(-3);return l>=800&&l<899}addCount(r){let{key:l,useUV:d=!1}=r;this.isCountKey(l)?d&&this.countMap.has(l)||this.countMap.set(l,(this.countMap.get(l)||0)+1):this.log.debug("".concat(l," is not count key, last 3 number should be 0~599"))}addEnum(r){let{key:l,value:d,useUV:g=!0}=r;var C;if(!this.isEnumKey(l))return this.log.debug("".concat(l," is not enum key, last 3 number should be 700~799"));if(g&&this.countMap.has(l))return;this.countMap.set(l,(this.countMap.get(l)||0)+1);let A=((C=this.distributionMap)==null?void 0:C.get(l))||new Map;A.set(d,(A.get(d)||0)+1),this.distributionMap.set(l,A)}addNumber(r){let{key:l,value:d,split:g=100,useUV:C=!1}=r;var A;if(!this.isNumberKey(l))return this.log.debug("".concat(l," is not number key, last 3 number should be 800~899"));if(C&&this.countMap.has(l))return;this.countMap.set(l,(this.countMap.get(l)||0)+1);let L=((A=this.distributionMap)==null?void 0:A.get(l))||new Map,B=0;if(Ti(g))B=Math.floor(d/g);else for(let U=g.length-1;U>0;U--)if(d>g[U]){B=U;break}L.set(B,(L.get(B)||0)+1),this.distributionMap.set(l,L)}addSuccessEvent(r){let{key:l,cost:d,timeKey:g,split:C}=r;if(l&&(this.addEnum({key:l,value:1,useUV:!1}),d)){let A=+String(l).slice(-3);A<800&&A>=700?this.addNumber({key:g||l+100,value:d,split:C}):g||this.log.debug("time stat ignored, ".concat(l))}}addFailedEvent(r){let{key:l,error:d}=r;if(!l)return;let g=an.UNKNOWN;Ti(d)?g=d:(!Ft(d.extraCode)||!Ft(d.code))&&(g=d.extraCode||d.code),this.addEnum({key:l,value:0,useUV:!1}),this.addEnum({key:l,value:g,useUV:!1})}},sV=((Eo=sV||{})[Eo.enterRoom=500700]="enterRoom",Eo[Eo.exitRoom=500701]="exitRoom",Eo[Eo.switchRole=500702]="switchRole",Eo[Eo.destroy=500703]="destroy",Eo[Eo.startLocalAudio=500704]="startLocalAudio",Eo[Eo.updateLocalAudio=500705]="updateLocalAudio",Eo[Eo.stopLocalAudio=500706]="stopLocalAudio",Eo[Eo.startLocalVideo=500707]="startLocalVideo",Eo[Eo.updateLocalVideo=500708]="updateLocalVideo",Eo[Eo.stopLocalVideo=500709]="stopLocalVideo",Eo[Eo.startScreenShare=500710]="startScreenShare",Eo[Eo.updateScreenShare=500711]="updateScreenShare",Eo[Eo.stopScreenShare=500712]="stopScreenShare",Eo[Eo.startRemoteVideo=500713]="startRemoteVideo",Eo[Eo.updateRemoteVideo=500714]="updateRemoteVideo",Eo[Eo.stopRemoteVideo=500715]="stopRemoteVideo",Eo[Eo.muteRemoteAudio=500716]="muteRemoteAudio",Eo[Eo.setRemoteAudioVolume=500717]="setRemoteAudioVolume",Eo),lV=((Qs=lV||{})[Qs.AudioMixer=550700]="AudioMixer",Qs[Qs.AIDenoiser=551700]="AIDenoiser",Qs[Qs.VirtualBackground=570700]="VirtualBackground",Qs[Qs.Beauty=571700]="Beauty",Qs[Qs.Watermark=572700]="Watermark",Qs),cV=(r=>(r[r.AudioMixer=550701]="AudioMixer",r[r.AIDenoiser=551701]="AIDenoiser",r[r.VirtualBackground=570701]="VirtualBackground",r[r.Beauty=571701]="Beauty",r[r.Watermark=572701]="Watermark",r))(cV||{}),uV=(r=>(r[r.AudioMixer=550702]="AudioMixer",r[r.AIDenoiser=551702]="AIDenoiser",r[r.VirtualBackground=570702]="VirtualBackground",r[r.Beauty=571702]="Beauty",r[r.Watermark=572702]="Watermark",r))(uV||{}),LR=(r=>(r[r.START_MICROPHONE=501700]="START_MICROPHONE",r[r.MICROPHONE_CAHNNELS=501701]="MICROPHONE_CAHNNELS",r[r.MICROPHONE_SAMPLERATE=501702]="MICROPHONE_SAMPLERATE",r))(LR||{}),NR=((OR=NR||{})[OR.START_CAMERA=511700]="START_CAMERA",OR),pre=new aV(!0),iy=new aV(!1),Lo=pre,jm=class{constructor(){this.pre=new Set,this.next=new Set,this.connectedNodes=new Set}setContext(r){this.context=r,this.node&&r.addMixWeight()}removeContext(){var r;this.node&&((r=this.context)==null||r.reduceMixWeight()),delete this.context}setNode(r){var l;if(!this.node)try{(l=this.context)==null||l.addMixWeight(),this.node=r,this.preNodeReconnect(),this.reconnect(),Lo.addSuccessEvent({key:502701})}catch(d){pn.error(d),Lo.addFailedEvent({key:502701,error:d})}}deleteNode(){var r;if(this.node)try{this._disconnect(),delete this.node,(r=this.context)==null||r.reduceMixWeight(),this.preNodeReconnect(),Lo.addSuccessEvent({key:502702})}catch(l){pn.error(l),Lo.addFailedEvent({key:502702,error:l})}}preNodeReconnect(){this.pre.forEach(r=>{r.node?r.reconnect():r.preNodeReconnect()})}connectNext(r){this.next.forEach(l=>r._connect(l.node)||l.connectNext(r))}_connect(r){return!(!this.node||!r)&&(this.node.connect(r),this.connectedNodes.add(r),!0)}_disconnect(){this.connectedNodes.forEach(r=>{var l;return(l=this.node)==null?void 0:l.disconnect(r)}),this.connectedNodes.clear()}reconnect(){this._disconnect(),this.connectNext(this)}pipeTo(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return l.forEach(g=>{this.next.add(g),g.pre.add(this)}),this}},mre=class extends jm{constructor(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:256;super(),this.fftSize=r,this.dataArray=new Uint8Array(0)}setNode(r){r.fftSize=this.fftSize,this.dataArray=new Uint8Array(r.frequencyBinCount),super.setNode(r)}getByteTimeDomainData(){var r;return(r=this.node)==null||r.getByteTimeDomainData(this.dataArray),this.dataArray}get level(){var r;return(r=this.node)==null||r.getByteTimeDomainData(this.dataArray),Math.max(...this.dataArray)/128-1}get timeDomainPathData(){let r=this.getByteTimeDomainData(),l=0,d=0,g="M".concat(l,",").concat(d);for(let C=0;C<r.length;C++)d=r[C]/128*100/2,g+="L".concat(l,",").concat(d),l+=1;return g}},dV=class{constructor(){this.source=new jm,this.gain=new jm,this.destination=new jm}get volume(){var r;return((r=this.gain.node)==null?void 0:r.gain.value)||1}setVolume(r){r!==1?(this.gain.node||this.gain.setNode(this.source.node.context.createGain()),this.gain.node.gain.value=r):this.gain.node&&this.gain.deleteNode()}replaceSource(r){this.source.deleteNode(),this.source.setNode(function(l){let d=fV.get(l);if(d)return d;let g=id();if(l instanceof HTMLAudioElement)d=g.createMediaElementSource(l);else{if(!(l instanceof MediaStreamTrack))return l;d=g.createMediaStreamSource(new MediaStream([l]))}return fV.set(l,d),d}(r))}get track(){var r;return(r=this.stream)==null?void 0:r.getAudioTracks()[0]}get stream(){var r;return(r=this.destination.node)==null?void 0:r.stream}},hV=class extends dV{constructor(r){super(),this.context=r,this.denoiser=new jm,this.source.pipeTo(this.denoiser.pipeTo(this.gain.pipeTo(this.destination)))}connect(){this.context.inputs.has(this)||(this.destination.setNode(this.context.destination),this.source.setContext(this.context),this.denoiser.setContext(this.context),this.gain.setContext(this.context),this.context.inputs.add(this))}disconnect(){!this.context.inputs.has(this)||(this.destination.deleteNode(),this.source.removeContext(),this.denoiser.removeContext(),this.gain.removeContext(),this.context.inputs.delete(this))}remove(){this.gain.deleteNode(),this.denoiser.deleteNode(),this.source.deleteNode(),this.disconnect()}setVolume(r){r!==1?(this.gain.node||this.gain.setNode(this.context.audioContext.createGain()),this.gain.node.gain.value=r):this.gain.node&&this.gain.deleteNode()}},gre=class{constructor(){this.audioContext=id(),this.destination=this.audioContext.createMediaStreamDestination(),this.inputs=new Set,this.mixWeight=0,this.destination.channelCount=1}addMixWeight(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.mixWeight+=r,this.mixWeight-1==r+1>>1&&this.mixOnChange()}reduceMixWeight(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.addMixWeight(-r)}close(){this.inputs.forEach(r=>r.remove())}get mixTrack(){return this.destination.stream.getAudioTracks()[0]}},fV=new WeakMap,Ym=class{constructor(r){Se(this,"_volume",0),Se(this,"_log"),Se(this,"_scriptProcessorNode",null),Se(this,"_audioWorkletNode",null),Se(this,"_interval",200),Se(this,"ready",this.preload());let{log:l}=r;this._log=l,en.on($t.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}get node(){return this._audioWorkletNode||this._scriptProcessorNode}preload(){return Ym.workletReady||(Ym.workletReady=YC(Ym.audioContext,URL.createObjectURL(new Blob(['class VolumeMeter extends AudioWorkletProcessor{constructor(){super(),this.volume=0,this.intervalTime=200,this.tick=this.intervalTime,this.isStop=!1,this.port.onmessage=t=>{let{data:e}=t;switch(e.name){case"setIntervalTime":this.intervalTime=e.intervalTime;break;case"stop":this.isStop=!0}}}process(t){let e=t[0];if(this.isStop)return!1;if(e.length>0){let i=e[0],s=0;for(let l=0;l<i.length;++l)s=Math.max(Math.abs(i[l]),s);this.volume=s,this.tick-=i.length,this.tick<0&&(this.tick+=this.intervalTime/1e3*sampleRate,this.port.postMessage({volume:this.volume}))}return!0}}registerProcessor("volume-meter",VolumeMeter);'],{type:"application/javascript"})))),Ym.workletReady.then(()=>this.initAudioWorklet()).catch(()=>this.initScriptProcessor())}initAudioWorklet(){if(!this._audioWorkletNode)try{this._audioWorkletNode=new AudioWorkletNode(Ym.audioContext,"volume-meter"),this._audioWorkletNode.port.onmessage=r=>{this._volume=r.data.volume||0},this.handleAudioLevelInterval({interval:this._interval})}catch(r){li.logFailedEvent({userId:this._log.userId,eventType:wc.LOAD_WORKLET,error:r}),this.initScriptProcessor()}}initScriptProcessor(){if(!this._scriptProcessorNode)try{this._scriptProcessorNode=id().createScriptProcessor(2048,1,1),this._scriptProcessorNode.onaudioprocess=r=>{let l=r.inputBuffer.getChannelData(0),d=0;for(let g=0;g<l.length;++g)d+=l[g]*l[g];this._volume=Math.sqrt(d/l.length)||0}}catch(r){this._log.error("volumeMeter init script processor error: ".concat(r))}}destroy(){this._scriptProcessorNode&&(this._scriptProcessorNode.onaudioprocess=null),this._audioWorkletNode&&(this._audioWorkletNode.port.postMessage({name:"stop"}),this._audioWorkletNode.port.onmessage=null),this._audioWorkletNode=null,this._scriptProcessorNode=null,en.off($t.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}getInternalAudioLevel(){return this._volume}getCalculatedVolume(){return parseFloat(this._volume.toFixed(2))}handleAudioLevelInterval(r){var l;let{interval:d}=r;this._interval=d,(l=this._audioWorkletNode)==null||l.port.postMessage({name:"setIntervalTime",intervalTime:d})}},PR=Ym;Se(PR,"audioContext",id()),Se(PR,"workletReady");var vre=class extends jm{constructor(r){super(),Se(this,"_volumeMeter"),this._volumeMeter=new PR(r)}deleteNode(){this._volumeMeter.destroy(),super.deleteNode()}init(){return at(this,null,function*(){yield this._volumeMeter.preload(),this.setNode(this._volumeMeter.node)})}getCalculatedVolume(){return this._volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this._volumeMeter.getInternalAudioLevel()}},_re=Vi(qa(),1),pV=r=>l=>l.deviceId===r,xR=class{constructor(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Input";Se(this,"kind"),Se(this,"type"),Se(this,"devices",[]),this.kind=r,this.type=l}update(r,l){let d=r.filter(g=>g.kind==="".concat(this.kind).concat(this.type.toLocaleLowerCase()));this.devices.length===1&&ay(this.devices[0])||l&&(d.forEach(g=>{if(g.deviceId&&!this.devices.find(pV(g.deviceId))){let C="".concat(this.kind).concat(this.type,"Added");pn.warn("".concat(C,": ").concat(JSON.stringify(g))),l.emit(C,g)}}),this.devices.forEach(g=>{if(g.deviceId&&!d.find(pV(g.deviceId))){let C="".concat(this.kind).concat(this.type,"Removed");pn.warn("".concat(C,": ").concat(JSON.stringify(g))),l.emit(C,g)}})),this.devices=d}hasDevice(r){return!!this.devices.find(l=>l.deviceId===r)}},yre=class extends _re.EventEmitter{constructor(){super(),Se(this,"audioInputs",new xR(Be.AUDIO)),Se(this,"videoInputs",new xR(Be.VIDEO)),Se(this,"audioOutputs",new xR(Be.AUDIO,"Output")),this.init(),navigator.mediaDevices&&(navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",()=>this.update()),"ondevicechange"in navigator.mediaDevices||Hr.run(SC,()=>{this.update()},{delay:1e4}))}init(){UR().then(r=>{this.audioInputs.update(r),this.videoInputs.update(r),this.audioOutputs.update(r)})}update(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){let d=yield UR(l);return r.audioInputs.update(d,r),r.videoInputs.update(d,r),r.audioOutputs.update(d,r),r}()})}},Hi=Tw||vC?null:new yre;function ay(r){return r.deviceId===r.groupId&&r.groupId===""}function UR(){return at(this,arguments,function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){if(uf()||!vR())return[];let l=yield navigator.mediaDevices.enumerateDevices();if(r!==0){let d={audio:!1,video:!1};if(l.forEach(g=>{ay(g)&&(g.kind===Be.AUDIO_INPUT?d.audio=!0:g.kind===Be.VIDEO_INPUT&&(d.video=!0))}),r===2&&(d.audio=!1),r===1&&(d.video=!1),d.audio||d.video){let g;try{g=yield navigator.mediaDevices.getUserMedia(d)}catch(C){pn.debug("capture before getDevices failed: ",C)}l=yield navigator.mediaDevices.enumerateDevices(),g==null||g.getTracks().forEach(C=>C.stop())}}return l.map((d,g)=>{let C={kind:d.kind,deviceId:d.deviceId,groupId:d.groupId,label:d.label||"".concat(d.kind,"_").concat(g)};return d.deviceId.length>0&&FR.add("".concat(d.deviceId,"_").concat(d.kind)),d.getCapabilities&&(C.getCapabilities=()=>d.getCapabilities()),C})}()})}function Pc(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Hi.update(r?1:0).then(l=>l.audioInputs.devices)}function ad(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Hi.update(r?2:0).then(l=>l.videoInputs.devices)}var mV=!1;function Jm(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return at(this,null,function*(){return Hi.update(r?1:0).then(l=>l.audioOutputs.devices)})}var FR=new Set;function gV(r,l){return at(this,null,function*(){let d=(yield Pc()).find(g=>g.deviceId===A_);return(d==null?void 0:d.groupId)===r&&d.label===l})}var Ire=class extends dV{constructor(r){super(),this.log=r,Se(this,"volumeMeter"),Se(this,"analyser",new mre),this.volumeMeter=new vre({log:this.log})}destory(){this.gain.deleteNode(),this.volumeMeter.deleteNode(),this.analyser.deleteNode(),this.source.deleteNode(),this.destination.deleteNode()}},VR=class extends ry{constructor(r){super(r,Be.AUDIO),Se(this,"_outputDeviceId"),Se(this,"_volume",1),Se(this,"_destination",id().createMediaStreamDestination()),Se(this,"pipeline"),Se(this,"volumeMeterMode","worklet"),this.pipeline=new Ire(this._log)}getMediaStream(){return this.pipeline.stream||(this.track?new MediaStream([this.track]):null)}initializeElement(){if((Qu==="15.2"||Qu==="15.3"||Qu==="15.4")&&this.muted)return void this._log.info("audioElement is muted.");let r=new Audio;r.setAttribute("autoplay","autoplay"),r.srcObject=this.getMediaStream(),r.muted=this.muted,this.element=r,this.bindElementEvents()}play(){return at(this,null,function*(){if(this.track)return this.pipeline.source.node||this.pipeline.replaceSource(this.track),this.element||this.initializeElement(),this._outputDeviceId&&(yield this.setSinkId(this._outputDeviceId)),this.volumeMeterMode==="worklet"?this.pipeline.volumeMeter.init():this.volumeMeterMode==="analyser"&&this.pipeline.analyser.setNode(id().createAnalyser()),this.setVolume(this._volume),function(){at(this,null,function*(){try{mV||(mV=!0,pn.info("speakers:".concat((yield Jm()).map(r=>" ".concat(r.deviceId.slice(0,8),": ").concat(r.label)))))}catch{}})}(),Ys(VR.prototype,this,"play").call(this)})}stop(){this.pipeline.destory(),super.stop()}setSinkId(r){return at(this,null,function*(){var l,d;this._outputDeviceId!==r&&(this._outputDeviceId=r),this.element&&this.element.sinkId!==r&&(yield(d=(l=this.element).setSinkId)==null?void 0:d.call(l,r))})}get useDestination(){return!!this.pipeline.stream}setLoop(r){!this.element||(this.element.loop=r)}getAudioLevel(){return this.pipeline.volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this.pipeline.volumeMeter.getInternalAudioLevel()}},bre=class extends VR{constructor(r){super(r),this.pipeline.source.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination)}setTrack(r){this.track!==r&&(this.unbindTrackEvents(),this.track=r,this.emit(xl.MEDIA_TRACK_CHANGED,r),r?(this.bindTrackEvents(),this.pipeline.replaceSource(r),!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([r]))):this.pipeline.source.deleteNode())}setSourceNode(r){!r||this.pipeline.source.node===r||(this.pipeline.replaceSource(r),r instanceof MediaStreamAudioSourceNode?this.pipeline.destination.setNode(this._destination):this.pipeline.destination.deleteNode(),this.element&&(this.element.srcObject=this.getMediaStream(),this.element.play().catch(()=>{}),this.setVolume(this._volume)))}setVolume(r){this._volume=r,this.element&&(this.element.volume=r)}},Cre=class extends VR{constructor(r){super(r),Se(this,"_sourceElement"),this.pipeline.source.pipeTo(this.pipeline.gain.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination))}setTrack(r){this.track!==r&&(this.unbindTrackEvents(),this.track=r,this.emit(xl.MEDIA_TRACK_CHANGED,r),r?(this.bindTrackEvents(),this._sourceElement?this._sourceElement.srcObject=new MediaStream([r]):!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([r])),this.pipeline.replaceSource(r)):this.pipeline.source.deleteNode())}setVolume(r){this._volume=r,this.useDestination?(this.pipeline.setVolume(r),this._log.info("set pipeline volume: ".concat(r))):r<=1?(this.element?this._log.info("set element volume: ".concat(r)):this._log.info("set element volume: no element"),this.element&&(this.element.volume=r)):(this._log.info("start set pipeline volume: ".concat(r)),this.pipeline.setVolume(r),this.element&&!this._sourceElement&&(this.pipeline.destination.setNode(this._destination),Ia(this.element),this._sourceElement=this.element,this._sourceElement.muted=!0,this.element=null,this.play()))}stop(){this.pipeline.destory(),this._sourceElement&&(this._sourceElement.srcObject=null,delete this._sourceElement),super.stop()}},GR=class extends wo{constructor(r){let{userId:l,sdkAppId:d,mediaType:g,room:C,PlayerClass:A=g===1?Cre:df}=r;var L;super(),Se(this,"id",UF()),Se(this,"userId",""),Se(this,"isRemote"),Se(this,"mediaType"),Se(this,"room"),Se(this,"user"),Se(this,"_log"),Se(this,"_inputTrack"),Se(this,"_outputTrack"),Se(this,"isPlayCalled"),Se(this,"container",null),Se(this,"player"),Se(this,"subVideoPlayerMap"),Se(this,"muted",!1),Se(this,"abortCtrl"),Se(this,"objectFit","cover"),Se(this,"mirror"),Se(this,"isScreen",!1),Se(this,"manager"),Se(this,"trackSettings"),this.userId=l||"",this.mediaType=g,this._log=pn.createLogger({id:"".concat(this.kind[0],"t"),userId:(L=C||this.room)==null?void 0:L.userId,remoteUserId:this instanceof ld?void 0:this.userId,sdkAppId:d,type:this.mediaType===2?"auxiliary":"main",isLocal:this instanceof ld}),this.player=new A({id:this.userId||this.id,track:null,muted:!1,container:null,log:this.log}),this.player.on(xl.PLAYER_STATE_CHANGED,B=>{en.emit($t.PLAYER_STATE_CHANGED,Fn({track:this},B)),this.emit("player-state-changed",B)}),this.kind===Be.VIDEO&&(this.player.on(xl.LOADED_DATA,()=>{en.emit($t.VIDEO_LOADED_DATA,{track:this})}),this.player.on(xl.MEDIA_TRACK_CHANGED,B=>{var U;(U=this.subVideoPlayerMap)==null||U.forEach(Z=>Z.setTrack(B))}))}get log(){return this._log||pn}get kind(){return this.mediaType===1?Be.AUDIO:Be.VIDEO}get strMediaType(){return this.mediaType===4?Be.VIDEO:this.mediaType===2?Be.SCREEN:Be.AUDIO}get streamType(){return 2&this.mediaType?"auxiliary":"main"}play(r,l){return at(this,null,function*(){let d=Gi(r)?r[0]:r;if(this.isPlayCalled)return this.log.info("play update options: ".concat(JSON.stringify(l))),l&&!Ft(l.muted)&&this.setPlayerMute(l.muted),l&&!Ft(l.objectFit)&&(this.objectFit=l.objectFit),void(this.player instanceof df&&(this.player.setObjectFit(this.objectFit),this.container!==d&&d&&(this.container=d,this.player.setContainer(d)),Gi(r)&&r.length>=1&&(yield this.playSubContainer(r.slice(1),l))));if(l&&!Ft(l.muted)?this.setPlayerMute(l.muted):(!this.isRemote||this.kind===Be.VIDEO)&&this.setPlayerMute(!0),l&&!Ft(l.objectFit)&&(this.objectFit=l.objectFit),this.player instanceof df&&this.player.setObjectFit(this.objectFit),this.isPlayCalled=!0,d&&(this.container=d,this.player instanceof df&&this.player.setContainer(d)),en.emit($t.PLAY_TRACK_START,{track:this}),this._outputTrack){this._log.info("play with options: ".concat(JSON.stringify(l)));try{this.player.setTrack(this.playerMediaTrack),yield this.player.play(),Gi(r)&&r.length>1&&(yield this.playSubContainer(r.slice(1),l))}catch(g){throw this.handleAutoPlayFailed(),this.emit("error",g),g}}else this.log.info("play has not mediaTrack, abort")})}setMirror(r,l){if(this.isScreen||this.kind!==Be.VIDEO||Ft(r)||r===this.mirror)return;this.mirror=r;let d=this.player;l&&(d=l);let g=this.manager;if(za(this.mirror))return d.setViewMirror(this.mirror),void(g&&(g.mirror=!1));switch(this.mirror){case"view":g&&(g.mirror=!1),d.setViewMirror(!0);break;case"publish":g&&(g.mirror=!0),d.setViewMirror(!0);break;case"both":g&&(g.mirror=!0),d.setViewMirror(!1)}}playSubContainer(r,l){return at(this,null,function*(){if(!this._outputTrack||this.kind===Be.AUDIO)return;this.subVideoPlayerMap||(this.subVideoPlayerMap=new Map),this.subVideoPlayerMap.forEach((g,C)=>{var A;r.find(L=>C===L)||(g.stop(),(A=this.subVideoPlayerMap)==null||A.delete(C))});for(let[g,C]of r.entries()){let A=this.subVideoPlayerMap.get(C);A?l&&(Ft(l.objectFit)||A.setObjectFit(l.objectFit)):this.subVideoPlayerMap.set(C,new df({id:this.userId||this.id,track:this.playerMediaTrack,container:C,muted:this.player.muted,objectFit:this.objectFit,log:this.log.createChild({id:"vp-sub".concat(g+1)})}))}let d=[...this.subVideoPlayerMap.values()];for(let g of d)g.setViewMirror(this.player.mirror),yield g.play()})}setAudioOutput(r){return this.player.setSinkId(r)}setAudioVolume(r){this.player.setVolume(r)}getAudioLevel(){return this.player.getAudioLevel()||0}getInternalAudioLevel(){var r;return((r=this.player)==null?void 0:r.getInternalAudioLevel())||0}stop(){!this.isPlayCalled||(this.isPlayCalled=!1,this.player&&(this.log.info("stop ".concat(this.kind," player")),this.player.stop()),this.subVideoPlayerMap&&this.subVideoPlayerMap.size>0&&this.subVideoPlayerMap.forEach(r=>{r.stop()}),this.container=null)}resume(){return at(this,null,function*(){var r;!this.isPlayCalled||(yield(r=this.player)==null?void 0:r.resume())})}close(){this.log.info("close"),this.isPlayCalled&&this.stop()}setMute(r){this.muted=r,this._inputTrack&&(this._inputTrack.enabled=!r),this._outputTrack&&(this._outputTrack.enabled=!r),this.emit(r?"mute":"unmute",this),en.emit(r?$t.TRACK_MUTED:$t.TRACK_UNMUTED,{track:this})}setPlayerMute(r){this.player.setMuted(r)}get mediaTrack(){return this._inputTrack||null}get outMediaTrack(){return this._outputTrack||null}get playerMediaTrack(){return this.outMediaTrack}setInputMediaStreamTrack(r){var l;let d=this._inputTrack;if(r!==d)return this._inputTrack=r,this.trackSettings=(l=r.getSettings)==null?void 0:l.call(r),r.enabled=!this.muted,this.emit("input-media-track-changed",r||null,d||null),this.manager?this.manager.changeInput(this):this.setOutputMediaStreamTrack(r)}setOutputMediaStreamTrack(r){var l;r!==this._outputTrack&&(this.isRemote?this.log.debug("setOutputMediaStreamTrack",r.label):this.log.info("setOutputMediaStreamTrack",(l=r.getSettings)==null?void 0:l.call(r).deviceId,r.label),this._outputTrack=r,this.updatePlayingState(!!r),this.emit("output-media-track-changed",r))}setMediaType(r){this.mediaType=r}updatePlayingState(r){if(this.isPlayCalled){if(r){if(this.player.setTrack(this.playerMediaTrack),this.player.isStopped)return this.player.play().catch(()=>this.handleAutoPlayFailed()),void this.log.info("playing state updated, play ".concat(this.kind))}else if(!this.player.isStopped)return this.player.stop(),void this.log.info("playing state updated, stop ".concat(this.kind))}this.log.debug("updatePlayingState abort ".concat(this.isPlayCalled," ").concat(r," ").concat(this.player.isStopped))}handleAutoPlayFailed(){if(this.room&&this.room.enableAutoPlayDialog)new fre;else{let r=()=>{this.resume().then(()=>{document.removeEventListener("click",r,!0),document.removeEventListener("touchstart",r,!0)})};document.addEventListener("click",r,!0),document.addEventListener("touchstart",r,!0)}}getVideoFrame(){return this.player instanceof df?this.player.getVideoFrame():""}};In([Bi([],wo.INIT,{sync:!0})],GR.prototype,"close");var Sre=Object.prototype.hasOwnProperty,sd=function(r){if(r==null)return!0;if(typeof r=="boolean")return!1;if(typeof r=="number")return r===0;if(typeof r=="string"||typeof r=="function"||Array.isArray(r))return r.length===0;if(r instanceof Error)return r.message==="";if(Dc(r))switch(Object.prototype.toString.call(r)){case"[object File]":case"[object Map]":case"[object Set]":return r.size===0;case"[object Object]":for(let l in r)if(Sre.call(r,l))return!1;return!0}return!1},Ere=z_({retryFunction:function(r){return at(this,null,function*(){let l=function(A){return{audio:Tre(A),video:Mre(A)}}(r);pn.info("getUserMedia with constraints: ".concat(JSON.stringify(l)));let d=[],g=[],C=["label","deviceId"];l.audio&&(d=yield Pc(),pn.info("microphones: ".concat(Oc(d,{keysToInclude:C})))),l.video&&(g=yield ad(),pn.info("cameras: ".concat(Oc(g,{keysToInclude:C}))));try{let A=yield navigator.mediaDevices.getUserMedia(l);return zF&&A.getTracks().forEach(L=>{pn.info("".concat(L.kind," capabilities: ").concat(Oc(L.getCapabilities(),{keysToInclude:Fw})))}),A}catch(A){let{message:L}=A;throw A.name==="NotFoundError"&&(r.video&&g&&g.length===0&&(L=so({key:to.CAMERA_NOT_FOUND})),r.audio&&d&&d.length===0&&(L=so({key:to.MICROPHONE_NOT_FOUND}))),new Rn({code:an.INITIALIZE_FAILED,name:A.name,message:L,constraint:A.constraint})}})},settings:{retries:3,timeout:500},onError:r=>{let{error:l,retry:d,reject:g,retryFuncArgs:C,retriedCount:A}=r,L=A+1;l.name==="NotReadableError"||l.name==="OverconstrainedError"?(L===1?C[0].video&&(C[0].maxResolution=!1,C[0].frameRate&&(C[0].frameRate=C[0].frameRate>10?10:5)):L===2?C[0].useDeviceIdOnly=!0:L===3&&!C[0].useExactDeviceId&&(C[0].useTrueAsConstraint=!0),d()):g(l),C[0].microphoneId&&vV(C[0].microphoneId,!1),C[0].cameraId&&vV(C[0].cameraId,!0)},onRetrying:r=>{pn.warn("getUserMedia NotReadableError observed, retrying [".concat(r,"/3]"))},onRetryFailed:r=>{li.logFailedEvent({eventType:wc.GET_USER_MEDIA_RETRY,error:r})},onRetrySuccess:r=>{li.logSuccessEvent({eventType:wc.GET_USER_MEDIA_RETRY}),li.uploadEvent({log:"stat-".concat(wc.GET_USER_MEDIA_RETRY,"-success-").concat(r)})}});function vV(r,l){return at(this,null,function*(){let d=(l?yield ad():yield Pc()).find(g=>g.deviceId===r);d&&Er(d.getCapabilities)&&pn.warn(Oc(d.getCapabilities(),{keysToInclude:Fw}))})}function Tre(r){if(!r.audio)return!1;if(r.useTrueAsConstraint)return!0;let l={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:r.sampleRate};return!sd(r.microphoneId)&&(l.deviceId=r.useExactDeviceId?{exact:r.microphoneId}:r.microphoneId,r.useDeviceIdOnly)?l:(Ti(r.channelCount)&&(l.channelCount=r.channelCount),za(r.echoCancellation)&&!r.echoCancellation&&(l.echoCancellation=!1),za(r.noiseSuppression)&&!r.noiseSuppression&&(l.noiseSuppression=!1),za(r.autoGainControl)&&!r.autoGainControl&&(l.autoGainControl=!1),!!sd(l)||l)}function Mre(r){if(!r.video)return!1;if(r.useTrueAsConstraint)return!0;let{maxResolution:l=!0}=r,d={};return r.cameraId?d.deviceId=r.useExactDeviceId?{exact:r.cameraId}:r.cameraId:r.facingMode&&(d.facingMode=r.facingMode),r.useDeviceIdOnly&&!sd(d)?d:(r.width&&(d.width={ideal:r.width},l&&!Nr&&(d.width.max=r.width)),r.height&&(d.height={ideal:r.height},l&&!Nr&&(d.height.max=r.height)),Nr&&rf&&r.width&&r.height&&r.width*r.height<101376&&(d.width=r.width,d.height=r.height),r.frameRate&&(d.frameRate=r.frameRate),!!sd(d)||d)}var kre=Ere;function _V(r){return Tr((l,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return at(this,null,function*(){return yield r.apply(this,C),l.apply(this,C)})})}function yV(r){return Tr((l,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return at(this,null,function*(){return r.call(this,l.apply(this,C))})})}function Tr(r){return function(l,d,g){return g.value=r(g.value,d),g}}var wre=(()=>{let r=!1,l=document.visibilityState;return()=>{document.visibilityState!==l&&pn.info("visibility change: ".concat(document.visibilityState)),!r&&(document.addEventListener("visibilitychange",()=>{pn.info("visibility change: ".concat(document.visibilityState)),l=document.visibilityState}),r=!0)}})(),Rre=0,IV=class{constructor(){this.log=pn.createLogger({id:"fq".concat(++Rre)}),this.isRunning=!1,this.queue=[]}get length(){return this.queue.length}get lastQueueItem(){return this.length===0?null:this.queue[this.length-1]}push(r){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var d,g;let C=Fn({},r),A=new Promise((L,B)=>{C.resolve=L,C.reject=B});return C.promise=A,l?this.length<=1?this.queue.push(C):(g=(d=this.lastQueueItem)==null?void 0:d.promise)==null||g.then(C.resolve,C.reject):this.queue.push(C),this.log.debug("push ".concat(this.length)),this.isRunning||this.callNext(),A}shift(){let r=this.queue.shift();return this.log.debug("shift ".concat(this.length)),r}callNext(){if(this.isRunning||this.length===0)return;this.log.debug("callNext ",this.length);let{fn:r,args:l,context:d,resolve:g,reject:C}=this.queue[0];this.isRunning=!0,r.apply(d,l).then(g,C).finally(()=>{this.isRunning=!1,this.shift(),this.callNext()})}},sy=new WeakMap,XC=new WeakMap;function Xm(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return function(l,d,g){let C=g.value;return g.value=function(){let A=sy.get(this)||new IV;for(var L=arguments.length,B=new Array(L),U=0;U<L;U++)B[U]=arguments[U];return sy.set(this,A),A.push({fn:C,args:B,context:this},r)},g}}function bV(r){return function(l,d,g){let C=g.value;return g.value=function(){var A,L,B;let U=[];for(var Z=arguments.length,ae=new Array(Z),ce=0;ce<Z;ce++)ae[ce]=arguments[ce];return(L=(A=sy.get(this))==null?void 0:A.queue)==null||L.forEach(we=>U.push(we)),(B=XC.get(this))==null||B.forEach(we=>we==null?void 0:we.queue.forEach(Pe=>U.push(Pe))),U.forEach(we=>{we.reject(new Rn({code:an.API_CALL_ABORTED,message:r}))}),sy.delete(this),XC.delete(this),C.apply(this,ae)},g}}function ZC(r){return function(l,d,g){let C=g.value,A=L=>r(...L);return g.value=function(){for(var L=arguments.length,B=new Array(L),U=0;U<L;U++)B[U]=arguments[U];let Z=XC.get(this)||new Map,ae=Z.get(A(B))||new IV;return Z.set(A(B),ae),XC.set(this,Z),ae.push({fn:C,args:B,context:this})},g}}var ld=class extends GR{constructor(r,l){super({mediaType:r,PlayerClass:l}),Se(this,"isRemote",!1),Se(this,"deviceId"),Se(this,"groupId",""),Se(this,"label",""),Se(this,"_isRecapturing",!1),Se(this,"_lastRecaptureTime",0),Se(this,"_onMuteTimeoutId",-1),Se(this,"profile"),this.onTrackMuted=this.onTrackMuted.bind(this),this.onTrackUnmuted=this.onTrackUnmuted.bind(this),this.onTrackEnded=this.onTrackEnded.bind(this)}get isPublished(){return this.state==="publish"}installTrackEvent(r){Ul(r,r).add(Be.MUTE,this.onTrackMuted).add(Be.UNMUTE,this.onTrackUnmuted).add(Be.ENDED,this.onTrackEnded),r.muted&&this.onTrackMuted(),r.readyState===Be.ENDED&&this.onTrackEnded()}uninstallTrackEvent(r){Ia(r)}setStateToCapture(){}capture(r){return at(this,null,function*(){var l;try{let d,g=xo();en.emit($t.LOCAL_TRACK_CAPTURE_START,{track:this}),r.customSource?(d=new MediaStream,d.addTrack(r.customSource)):((l=this.mediaTrack)==null||l.stop(),d=yield kre(r));let C=d.getTracks()[0];return yield this.setInputMediaStreamTrack(C),r.customSource||(this.updateDeviceIdInUse(),this.listenDeviceChange()),en.emit($t.LOCAL_TRACK_CAPTURE_SUCCESS,{track:this,cost:xo()-g}),d}catch(d){throw en.emit($t.LOCAL_TRACK_CAPTURE_FAILED,{track:this,error:d}),this.log.error("getUserMedia error observed ".concat(d)),d}})}setInputMediaStreamTrack(r){this.state===wo.INIT&&this.setStateToCapture(),this._inputTrack&&this.uninstallTrackEvent(this._inputTrack);let l=super.setInputMediaStreamTrack(r);return this.installTrackEvent(r),l}setOutputMediaStreamTrack(r){var l;return super.setOutputMediaStreamTrack(r),(l=this.room)==null?void 0:l.replaceTrack(this)}publish(r,l){return this.room=r,this.emit("4",{mediaType:this.strMediaType,state:"starting",prevState:"stopped"}),this.userId=r.userId,this._log.setUserId(r.userId),this._log.setSdkAppId(r.sdkAppId),l}unpublish(){this.room&&this.room.localTracks.delete(this),en.emit($t.LOCAL_TRACK_UNPUBLISHED,{track:this})}updateDeviceIdInUse(){return at(this,null,function*(){if(this.mediaTrack&&zm){let{deviceId:r,groupId:l}=this.mediaTrack.getSettings(),{label:d}=this.mediaTrack;(yield function(g){return at(this,arguments,function(C){let{newDeviceId:A,oldDeviceId:L,oldGroupId:B,oldLabel:U,kind:Z}=C;return function*(){return A===L&&(Z!==Be.AUDIO||A!==A_||(yield gV(B,U)))}()})}({newDeviceId:r,oldDeviceId:this.deviceId,oldGroupId:this.groupId,oldLabel:this.label,kind:this.kind}))||(this.deviceId=r,this.label=d,l&&(this.groupId=l),UR().then(g=>{let C=g.find(A=>A.deviceId===r);C&&this.emit("2",C)}))}})}setProfile(r){this.log.info("setProfile",r),Object.assign(this.profile,r)}isNeedToRecapture(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!(!this.deviceId||!this.mediaTrack||this.kind===Be.AUDIO&&!function(l){if(l instanceof CanvasCaptureMediaStreamTrack||!(l instanceof MediaStreamTrack))return!1;let d=l.label.toLocaleLowerCase();if(d.includes("mic")||d.includes("麦克风"))return!0;let g="".concat(((l==null?void 0:l.getSettings())||{}).deviceId,"_").concat(Be.AUDIO_INPUT);return!!FR.has(g)}(this.mediaTrack)||this.kind===Be.VIDEO&&!function(l){if(l instanceof CanvasCaptureMediaStreamTrack||!(l instanceof MediaStreamTrack))return!1;let d=l.label.toLocaleLowerCase();if(d.includes("camera")||d.includes("webcam"))return!0;let g="".concat(((l==null?void 0:l.getSettings())||{}).deviceId,"_").concat(Be.VIDEO_INPUT);return!!FR.has(g)}(this.mediaTrack)||this._isRecapturing||r&&rf&&Ac)}onTrackMuted(){if(wre(),this.isNeedToRecapture(!0)){if(Date.now()-this._lastRecaptureTime<O_)return void setTimeout(()=>this.onTrackMuted(),O_);this._onMuteTimeoutId=setTimeout(()=>at(this,null,function*(){var r;if((r=this.mediaTrack)!=null&&r.muted){if((Rc||gs)&&document.visibilityState!=="visible")return;this.recapture(yield this.getRecoverCaptureDeviceId())}}),5e3)}}onTrackUnmuted(){this._onMuteTimeoutId>0&&clearTimeout(this._onMuteTimeoutId)}onTrackEnded(){return at(this,null,function*(){if(this.isNeedToRecapture()){if(Date.now()-this._lastRecaptureTime<O_)return void setTimeout(()=>this.onTrackEnded(),O_);this.recapture(yield this.getRecoverCaptureDeviceId())}})}recapture(r){return at(this,null,function*(){var l;if(this._isRecapturing||!this._inputTrack)return;this.log.warn("recapture trying"),(l=this._inputTrack)==null||l.stop(),this._isRecapturing=!0,this._lastRecaptureTime=Date.now();let d={useExactDeviceId:!0};if(r==="user"||r==="environment")d.facingMode=r;else{let g;(this.kind==="audio"?yield Pc():yield ad()).find(C=>C.deviceId===r)&&(g=r),d.deviceId=g}return this.capture(d).then(()=>{this._isRecapturing=!1,this.log.warn("recapture success"),this.emit("1",{deviceId:this.deviceId})}).catch(g=>{this._isRecapturing=!1,this.log.warn("recapture failed ".concat(g.message)),this.emit("5",g)})})}getRecoverCaptureDeviceId(){return at(this,null,function*(){let r=this instanceof Wa;if(r&&this.facingMode)return this.facingMode;let{deviceId:l}=this;if(l){let d=(ly.get(l)||0)+1;if(ly.set(l,d),d>=3){let g=r?(yield ad()).find(C=>!ly.has(C.deviceId)):(yield Pc()).find(C=>!ly.has(C.deviceId));g&&(this.log.warn("".concat(l," capture fail ").concat(d," times, change new ").concat(g.deviceId)),l=g.deviceId)}}return l})}close(){var r;super.close(),this._inputTrack&&(this._inputTrack.stop(),this.uninstallTrackEvent(this._inputTrack)),(r=this.manager)==null||r.removeInput(this)}};In([Bi(wo.INIT,"capture",{ignoreError:!0,sync:!0})],ld.prototype,"setStateToCapture"),In([Xm()],ld.prototype,"capture"),In([Bi("capture","publish",{ignoreError:!0,success(){this.room.localTracks.add(this),en.emit($t.LOCAL_TRACK_PUBLISHED,{track:this}),this.emit("4",{mediaType:this.strMediaType,state:"started",prevState:"starting"})},fail(r){let l="error",d=r.cause;d.message.includes("timeout")?l="timeout":d.code===an.API_CALL_ABORTED&&(l="api-call"),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:"starting",reason:l,error:d})}})],ld.prototype,"publish"),In([Tr(r=>function(){return at(this,null,function*(){let l=this.state==="publish"?"started":"starting";r.call(this),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:l,reason:"api-call"})})}),Bi([],"capture",{sync:!0})],ld.prototype,"unpublish");var ly=new Map;en.on($t.SWITCH_DEVICE_SUCCESS,r=>{r.track.deviceId&&ly.delete(r.track.deviceId)});var xc=class extends ld{constructor(r){super(1,bre),Se(this,"mediaType",1),Se(this,"volume",0),Se(this,"profile",{echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0,sampleRate:48e3,channelCount:1,bitrate:40}),Se(this,"playerMuted",!0),Se(this,"pipeline"),this.manager=r,this.pipeline=new hV(r),this.handleMicrophoneAdded=this.handleMicrophoneAdded.bind(this),this.handleMicrophoneRemoved=this.handleMicrophoneRemoved.bind(this)}getAudioLevel(){let r=(this.volume||super.getAudioLevel())*this.captureVolume;return r>1?1:r}get playerMediaTrack(){return this.mediaTrack}setInputMediaStreamTrack(r){return at(this,null,function*(){yield Ys(xc.prototype,this,"setInputMediaStreamTrack").call(this,r);let l=this.trackSettings||{};Lo.addEnum({key:501701,value:l.channelCount||0,useUV:!1}),Lo.addEnum({key:501702,value:l.sampleRate||0,useUV:!1}),Lo.addEnum({key:502700,value:0});let{sampleRate:d,channelCount:g}=l;this._log.info("local audio track input ".concat(JSON.stringify({sampleRate:d,channelCount:g}))),this.pipeline.replaceSource(r),this.updatePlayingState(!!r)})}capture(r){let{deviceId:l,customSource:d,useExactDeviceId:g=!1}=r;return super.capture({video:!1,audio:!0,microphoneId:l,echoCancellation:this.profile.echoCancellation,autoGainControl:this.profile.autoGainControl,noiseSuppression:this.profile.noiseSuppression,sampleRate:this.profile.sampleRate,channelCount:this.profile.channelCount,useExactDeviceId:g,customSource:d})}switchDevice(r){return at(this,null,function*(){if(this.mediaTrack){if(this.deviceId===r&&(r!==A_||(yield gV(this.groupId,this.label))))return;try{this.log.info("switchDevice audio to: ".concat(r)),this.mediaTrack&&this.mediaTrack.stop(),yield this.capture({deviceId:r,useExactDeviceId:!0}),this.room&&(yield this.room.replaceTrack(this)),en.emit($t.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch microphone success")}catch(l){throw this.log.error("switch microphone failed ".concat(l)),this.deviceId&&this.recapture(this.deviceId),l}}})}listenDeviceChange(){Hi&&!Hi.listeners("audioInputRemoved").includes(this.handleMicrophoneRemoved)&&Hi.on("audioInputRemoved",this.handleMicrophoneRemoved,this)}handleMicrophoneRemoved(r){return at(this,null,function*(){if(r.deviceId===this.deviceId){this.log.warn("current microphone is lost: ".concat(JSON.stringify(r)));let l=yield Pc();l[0]?this.recapture(l[0].deviceId):Hi.on("audioInputAdded",this.handleMicrophoneAdded,this)}})}handleMicrophoneAdded(r){this.log.warn("microphone added: ".concat(JSON.stringify(r))),this.recapture(r.deviceId)}update3A(r){return at(this,arguments,function(l){var d=this;let{echoCancellation:g,noiseSuppression:C,autoGainControl:A}=l;return function*(){let L=!1;!Ft(g)&&g!==d.profile.echoCancellation&&(d.profile.echoCancellation=g,L=!0),!Ft(C)&&C!==d.profile.noiseSuppression&&(d.profile.noiseSuppression=C,L=!0),!Ft(A)&&A!==d.profile.autoGainControl&&(d.profile.autoGainControl=A,L=!0),L&&d.deviceId&&(yield d.recapture(d.deviceId))}()})}get captureVolume(){return this.pipeline.volume}setCaptureVolume(r){this.pipeline.setVolume(r/100),this.pipeline.gain.node&&Lo.addEnum({key:502700,value:2}),this.resetPlayerSource()}enableTrackANS(r){if(!this._inputTrack)return;let l=this._inputTrack.getConstraints();return l.noiseSuppression=r,this._inputTrack.applyConstraints(l).catch(d=>this._log.warn("".concat(r?"enable":"disable"," ANS failed "),d))}addDenoiser(r){var l;Bm<=92&&((l=this.trackSettings)==null?void 0:l.sampleRate)!==48e3?this._log.warn("denoiser only support sampleRate 48000 before chrome 93"):(Lo.addEnum({key:502700,value:1}),this.pipeline.denoiser.setNode(r),this.resetPlayerSource(),this.enableTrackANS(!1))}removeDenoiser(r){this.pipeline.denoiser.node===r&&(this.pipeline.denoiser.deleteNode(),this.resetPlayerSource(),this.enableTrackANS(!0))}resetPlayerSource(){this.player.setSourceNode(this.pipeline.gain.node||this.pipeline.denoiser.node||this.pipeline.source.node)}close(){this.pipeline.remove(),Hi.off("audioInputAdded",this.handleMicrophoneAdded,this),Hi.off("audioInputRemoved",this.handleMicrophoneRemoved,this),super.close()}recapture(r){return at(this,null,function*(){try{yield Ys(xc.prototype,this,"recapture").call(this,r)}catch(l){let d=(yield Pc()).find(g=>g.deviceId!==r);if(!d)throw l;yield Ys(xc.prototype,this,"recapture").call(this,d.deviceId)}})}},Wa=class extends ld{constructor(r){super(arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,df),Se(this,"profile",{width:640,height:480,frameRate:15,bitrate:500}),Se(this,"states",{bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0}),Se(this,"small"),Se(this,"isNeedToSetBandwidth"),Se(this,"muteImage"),Se(this,"manager"),this.manager=r;let l=()=>{this.isAllowed2k4k(this.profile)?this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),this.setProfile(Io(Fn({},this.profile),{width:1920,height:1080})),this.applyProfile())};this.on("input-media-track-changed",l),this.on("publish",l),this.handleCameraAdded=this.handleCameraAdded.bind(this),this.handleCameraRemoved=this.handleCameraRemoved.bind(this)}get facingMode(){if(zm&&this.mediaTrack)return this.mediaTrack.getSettings().facingMode}setMute(r){return at(this,null,function*(){var l,d,g;if(rr(r)){if(this.muteImage===r)return;yield(l=this.manager)==null?void 0:l.deleteWatermark("mute"),yield(d=this.manager)==null?void 0:d.setWatermark({x:0,y:0,width:this.settings.width,height:this.settings.height,type:"mute",zIndex:999,imageUrl:r}),this.muteImage=r,Ys(Wa.prototype,this,"setMute").call(this,!1)}else yield(g=this.manager)==null?void 0:g.deleteWatermark("mute"),this.muteImage=void 0,Ys(Wa.prototype,this,"setMute").call(this,r)})}capture(r){let{deviceId:l,facingMode:d,useExactDeviceId:g=!1,customSource:C}=r;return super.capture({audio:!1,video:!0,facingMode:d||this.facingMode,cameraId:l,width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate,useExactDeviceId:g,customSource:C})}setProfile(r){let l=Fn({},r),d=l.width>l.height;l.width*l.height<=19200&&gs&&$_&&(this.log.warn("resolution is ".concat(l.width,"*").concat(l.height,", fallback to 240*180")),l.width=d?240:180,l.height=d?180:240,l.bitrate=Math.max(l.bitrate,150)),l.width*l.height>921600&&vF&&(l.width=d?1280:720,l.height=d?720:1280,this.log.warn("reset to 1280 * 720 on iOS 13~14")),l.bitrate&&(this.isNeedToSetBandwidth=l.bitrate!==this.profile.bitrate),this.isAllowed2k4k(this.profile)?super.setProfile(l):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),super.setProfile(Io(Fn({},this.profile),{width:1920,height:1080})))}applyProfile(){var r;if(!this.mediaTrack)return;let l=this.settings;return l.height!==this.profile.height||l.width!==this.profile.width||l.frameRate!==this.profile.frameRate?(r=this.mediaTrack)==null?void 0:r.applyConstraints({width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate}).then(()=>{if(this.manager&&this.manager.changeInput(this),this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}),this.isNeedToSetBandwidth&&this.room&&this.room.setBandWidth)return this.isNeedToSetBandwidth=!1,this.room.setBandWidth({bandwidth:this.profile.bitrate,type:Be.VIDEO,videoType:Be.BIG})}):void 0}get settings(){let r={width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate};return zm&&this.mediaTrack&&Object.assign(r,this.mediaTrack.getSettings()),r}get scaleResolutionDownBy(){let{settings:r}=this;return r.width===this.profile.width&&r.height===this.profile.height?1:PF()&&this.profile.width>this.profile.height&&r.height>r.width?Math.max(r.width/this.profile.height,r.height/this.profile.width,1):Math.max(r.width/this.profile.width,r.height/this.profile.height,1)}isAllowed2k4k(r){var l;return!(this.room&&this.room.scheduleResult&&!this.isScreen&&!(r.height*r.width<3686400))||((l=this.room.scheduleResult.trtcAutoConf)==null?void 0:l["2k4k"])===1}isNeedToSwitchDevice(r){return!(!this.mediaTrack||this.deviceId===r||this.facingMode===r)}switchDevice(r){return at(this,null,function*(){try{if(!this.isNeedToSwitchDevice(r))return;let l={useExactDeviceId:!0};r==="user"||r==="environment"?l.facingMode=r:l.deviceId=r,this.mediaTrack.stop(),yield this.capture(l),en.emit($t.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch camera success")}catch(l){throw this.log.error("switch camera failed ".concat(l)),this.deviceId&&this.recapture(this.deviceId),l}})}listenDeviceChange(){Hi&&!Hi.listeners("videoInputRemoved").includes(this.handleCameraRemoved)&&Hi.on("videoInputRemoved",this.handleCameraRemoved,this)}handleCameraRemoved(r){return at(this,null,function*(){if(r.deviceId===this.deviceId){this.log.warn("current camera is lost: ".concat(JSON.stringify(r)));let l=yield ad();l[0]?this.recapture(l[0].deviceId):Hi.on("videoInputAdded",this.handleCameraAdded,this)}})}handleCameraAdded(r){return at(this,null,function*(){this.log.warn("camera added: ".concat(JSON.stringify(r))),this.recapture(r.deviceId)})}play(r,l){return at(this,null,function*(){return Ft(this.mirror)&&!this.isScreen&&this.setMirror("view"),Ys(Wa.prototype,this,"play").call(this,r,l)})}close(){Hi.off("videoInputAdded",this.handleCameraAdded,this),Hi.off("videoInputRemoved",this.handleCameraRemoved,this),super.close()}recapture(r){return at(this,null,function*(){try{yield Ys(Wa.prototype,this,"recapture").call(this,r)}catch(l){let d=(yield ad()).find(g=>g.deviceId!==r);if(!d)throw l;yield Ys(Wa.prototype,this,"recapture").call(this,d.deviceId)}})}},CV=UF();if(navigator.mediaDevices&&"setCaptureHandleConfig"in navigator.mediaDevices)try{navigator.mediaDevices.setCaptureHandleConfig({handle:CV,exposeOrigin:!0,permittedOrigins:["*"]})}catch{}var BR,Are=function(r){return at(this,null,function*(){let l=null,d=function(A){let L={preferCurrentTab:A.preferDisplaySurface==="current-tab",systemAudio:"include",selfBrowserSurface:"include",surfaceSwitching:"include"},B={width:Ac?{max:A.width}:{ideal:A.width,max:A.width},height:Ac?{max:A.height}:{ideal:A.height,max:A.height},frameRate:A.frameRate,displaySurface:A.preferDisplaySurface||"monitor"};if(L.video=B,A.systemAudio){let{echoCancellation:U=!0,noiseSuppression:Z=!1,autoGainControl:ae=!1}=A;L.audio={echoCancellation:U,noiseSuppression:Z,autoGainControl:ae,sampleRate:48e3}}return L}(r);pn.info("getDisplayMedia with constraints: ".concat(JSON.stringify(d)));let g=yield navigator.mediaDevices.getDisplayMedia(d);r.systemAudio&&g.getAudioTracks().length===0&&(PC&&Bm<74||Ac||Nr)&&pn.warn("Your browser not support capture system audio");let C=g.getVideoTracks()[0];if(C){if(r.frameRate)try{yield C.applyConstraints({frameRate:{min:r.frameRate,ideal:r.frameRate},width:r.width,height:r.height})}catch(A){pn.warn("screen applyConstraints failed: ".concat(A))}r.captureElement&&(yield function(A,L){return at(this,null,function*(){var B;if("CropTarget"in window&&"fromElement"in CropTarget&&Er(A.cropTo))try{if(((B=A.getCaptureHandle())==null?void 0:B.handle)!==CV)return;let U=yield CropTarget.fromElement(L);yield A.cropTo(U)}catch(U){pn.warn("cropTo target failed ".concat(U))}})}(C,r.captureElement))}if(r.audio){let A=function(L){let B={echoCancellation:L.echoCancellation,autoGainControl:L.autoGainControl,noiseSuppression:L.noiseSuppression,sampleRate:L.sampleRate,channelCount:L.channelCount};return Ft(L.microphoneId)||(B.deviceId=L.microphoneId),{audio:B,video:!1}}(r);pn.info("getUserMedia with constraints: ".concat(JSON.stringify(A))),l=yield navigator.mediaDevices.getUserMedia(A),g.addTrack(l.getAudioTracks()[0])}return g})},ff=class extends Wa{constructor(r){super(r,2),Se(this,"profile",{width:1920,height:1080,frameRate:5,bitrate:1600}),Se(this,"objectFit","contain"),Se(this,"isScreen",!0),this._log.id="s-".concat(this._log.id)}capture(r){return at(this,arguments,function(l){var d=this;let{systemAudio:g=!1,autoGainControl:C,echoCancellation:A,noiseSuppression:L,audioTrack:B,videoTrack:U,captureElement:Z,preferDisplaySurface:ae}=l;return function*(){try{let ce;return U||B?(ce=new MediaStream,U&&ce.addTrack(U),B&&ce.addTrack(B)):ce=yield Are({audio:!1,systemAudio:g,width:d.profile.width,height:d.profile.height,frameRate:d.profile.frameRate,autoGainControl:C,echoCancellation:A,noiseSuppression:L,captureElement:Z,preferDisplaySurface:ae}),yield d.setInputMediaStreamTrack(ce.getVideoTracks()[0]),ce}catch(ce){throw d.log.error("getDisplayMedia error observed ".concat(ce)),ce instanceof Rn?ce:new Rn({code:an.INITIALIZE_FAILED,name:ce.name,message:ce.message})}}()})}switchDevice(r){return at(this,null,function*(){throw new Error("Method not implemented.")})}},cy=class extends xc{constructor(r){super(r),this._log.id="s-".concat(this._log.id)}},Dre=class extends gre{constructor(r){super(),this.room=r,Se(this,"_localAudioTrack"),Se(this,"_localScreenAudioTrack"),Se(this,"log",pn.createLogger({id:"am"})),Se(this,"denoiser"),r&&(this.log.setUserId(r.userId),this.log.setSdkAppId(r.sdkAppId))}get _localAudioPipline(){var r;return(r=this._localAudioTrack)==null?void 0:r.pipeline}dump(r){var l,d;if(!this._localAudioTrack)return;let g=[],C=[];(l=this._localAudioPipline)!=null&&l.source.node&&(g.push(this._localAudioPipline.source.node),C.push("mic")),(d=this._localAudioPipline)!=null&&d.denoiser.node&&(g.push(this._localAudioPipline.denoiser.node),C.push("mic-processed")),this.mixWeight>1&&(g.push(this.audioContext.createMediaStreamSource(this._localAudioPipline.stream)),C.push("mix")),this.log.info("dump audio track ".concat(C,", duration: ").concat(r));let A=new AbortController,L=[],B=setTimeout(()=>{this.log.info('dump audio track complete please input "download()" to download.'),A.abort("timeout")},1e3*r),U=()=>{for(let ae=0;ae<C.length;ae++){let ce=URL.createObjectURL(new Blob(L[ae])),we=document.createElement("a");we.href=ce,we.download="".concat(C[ae],".pcm"),we.style.display="none",document.body.appendChild(we),we.click(),URL.revokeObjectURL(ce),we.remove()}clearTimeout(B),A.abort("download")},Z=function(ae){return at(this,null,function*(){let ce=id();BR||(BR=YC(ce,URL.createObjectURL(new Blob(["registerProcessor('dumper', class extends AudioWorkletProcessor {process(inputs) {this.port.postMessage(inputs);return true;}});"],{type:"application/javascript"})))),yield BR;let we=new AudioWorkletNode(ce,"dumper",{numberOfInputs:ae.length,numberOfOutputs:0});return ae.forEach((Pe,Ze)=>Pe.connect(we,0,Ze)),new ReadableStream({start(Pe){we.port.onmessage=Ze=>{Pe.enqueue(Ze.data)}},cancel(){ae.forEach(Pe=>Pe.disconnect(we)),we.port.close()}})})}(g).then(ae=>ae.pipeTo(new WritableStream({write(ce){ce.forEach((we,Pe)=>L[Pe]=L[Pe]?L[Pe].concat(we[0]):[we[0]])}}),A).catch(ce=>U));return{then:Z.then.bind(Z),download:U}}get hasScreenAudioTrack(){return this._localScreenAudioTrack!==null}get hasAudioTrack(){return this._localAudioTrack!==null}changeInput(r){var l;if(r instanceof cy)this._localScreenAudioTrack=r,r.pipeline.connect(),this.mixOnChange();else if(r instanceof xc)this._localAudioTrack=r,this.destination.channelCount=((l=r.trackSettings)==null?void 0:l.channelCount)||1,this.denoiser&&r.addDenoiser(this.denoiser),r.pipeline.connect(),this.mixOnChange();else if(r instanceof HR)return r.setOutputMediaStreamTrack(r.mediaTrack)}mixOnChange(){var r,l;(r=this._localAudioTrack)==null||r.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localAudioTrack.mediaTrack),(l=this._localScreenAudioTrack)==null||l.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localScreenAudioTrack.mediaTrack)}removeInput(r){r instanceof cy?delete this._localScreenAudioTrack:r instanceof xc&&delete this._localAudioTrack}addDenoiser(r){var l;this.denoiser=r,(l=this._localAudioTrack)==null||l.addDenoiser(r)}removeDenoiser(r){var l;delete this.denoiser,(l=this._localAudioTrack)==null||l.removeDenoiser(r)}destroy(){this.close()}};function SV(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:30,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return Tr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),L=0;L<C;L++)A[L]=arguments[L];return new Promise((B,U)=>{let Z=setTimeout(()=>{let ae=new Rn({code:an.API_CALL_TIMEOUT,message:"checkPendingPromise ".concat(g,"() timeout ").concat(r,"s")});pn.warn(ae),l===2?U(ae):l===1&&B()},1e3*r);d.apply(this,A).then(B,U).finally(()=>{clearTimeout(Z)})})})}var EV=class extends GR{constructor(r,l,d){super({userId:l.userId,sdkAppId:r.sdkAppId,mediaType:d,room:r}),this.room=r,this.user=l,Se(this,"tinyId"),Se(this,"isRemote",!0),this.tinyId=l.tinyId}setMute(r){this.hasFlag&&super.setMute(r)}setInputMediaStreamTrack(r){super.setInputMediaStreamTrack(r),this.hasFlag&&this.isSubscribed&&this.player.setTrack(this.outMediaTrack)}waitHasMediaTrack(){return new Promise(r=>{this.mediaTrack?r():this.once("input-media-track-changed",r)})}get isSubscribing(){return this.state.toString()==="subscribeing"}get isSubscribed(){return this.state===EV.STATE_SUBSCRIBE}subscribe(r){return r}unsubscribe(){this.player.setTrack(null),this.streamType==="main"&&this.kind==="video"&&this.room.changeType(!1,this.user)}updatePlayingState(r){if(this.isPlayCalled&&this.player.isStopped===r){if(r&&(!this.isSubscribed||!this.hasFlag||!this.outMediaTrack))return void this.log.info("abort play, isSubscribed:".concat(this.isSubscribed," hasFlag:").concat(this.hasFlag," hasTrack:").concat(!!this.outMediaTrack));super.updatePlayingState(r)}}onFlagChanged(){this.updatePlayingState(this.hasFlag)}},cd=EV;Se(cd,"STATE_SUBSCRIBE","subscribe"),In([SV(5,1)],cd.prototype,"waitHasMediaTrack"),In([Bi(wo.INIT,cd.STATE_SUBSCRIBE,{success(){this.log.info("subscribed"),en.emit($t.REMOTE_TRACK_SUBSCRIBED,{track:this}),this.updatePlayingState(!0)},ignoreError:!0})],cd.prototype,"subscribe"),In([Bi(cd.STATE_SUBSCRIBE,wo.INIT,{sync:!0,success(){this.log.info("unsubscribed"),this.updatePlayingState(!1),en.emit($t.REMOTE_TRACK_UNSUBSCRIBED,{track:this})}})],cd.prototype,"unsubscribe");var HR=class extends cd{constructor(r,l){super(r,l,1),Se(this,"volume",0),Se(this,"mediaType",1),Se(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,end2EndDelay:0,jitterBufferDelay:0}),this.manager=r.audioManager}getAudioLevel(){let r=this.volume||super.getAudioLevel();return r>1?1:r}get hasFlag(){return this.user.muteState.hasAudio&&!this.user.muteState.audioMuted}isFlagChanged(r){let l=r.hasAudio&&!r.audioMuted;return this.hasFlag||(this.volume=0),this.hasFlag!==l}},uy=class extends cd{constructor(r,l){super(r,l,arguments.length>2&&arguments[2]!==void 0?arguments[2]:4),Se(this,"mediaType",4),Se(this,"source"),Se(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,end2EndDelay:0,jitterBufferDelay:0}),this.manager=r.videoManager}get isBig(){return this.mediaType===4}get isSmall(){return this.mediaType===8}changeType(r){this.room.changeType(r,this.user)}get hasFlag(){return this.user.muteState.hasVideo&&!this.user.muteState.videoMuted}isFlagChanged(r){let l=r.hasVideo&&!r.videoMuted;return this.hasFlag!==l}setMirror(r){r==="publish"||r==="both"||super.setMirror(r)}},TV=class extends uy{constructor(r,l){super(r,l,2),Se(this,"mediaType",2),Se(this,"objectFit","contain")}get hasFlag(){return this.user.muteState.hasAuxiliary}isFlagChanged(r){let l=r.hasAuxiliary;return this.hasFlag!==l}};function dy(){}var Ore=r=>r(),Lre=()=>typeof __FASTRX_DEVTOOLS__<"u",Nre=1,hy=class extends Function{toString(){return"".concat(this.name,"(").concat(this.args.length?[...this.args].join(", "):"",")")}subscribe(r){let l=new Pre(r,this,this.streamId++);return Uc.subscribe({id:this.id,end:!1},{nodeId:l.sourceId,streamId:l.id}),this(l),l}},MV=class{constructor(){this.defers=new Set,this.disposed=!1}next(r){}complete(){this.dispose()}error(r){this.dispose()}get bindDispose(){return()=>this.dispose()}dispose(){this.disposed=!0,this.complete=dy,this.error=dy,this.next=dy,this.dispose=dy,this.subscribe=dy,this.doDefer()}subscribe(r){return r instanceof hy?r.subscribe(this):r(this),this}get bindSubscribe(){return r=>this.subscribe(r)}doDefer(){this.defers.forEach(Ore),this.defers.clear()}defer(r){this.defers.add(r)}removeDefer(r){this.defers.delete(r)}reset(){this.disposed=!1,delete this.complete,delete this.next,delete this.dispose,delete this.next,delete this.subscribe}resetNext(){delete this.next}resetComplete(){delete this.complete}resetError(){delete this.error}},kV=class extends MV{constructor(r){super(),this.sink=r,r.defer(this.bindDispose)}next(r){this.sink.next(r)}complete(){this.sink.complete()}error(r){this.sink.error(r)}};function QC(r,l,d){if(Lre()){let g=Object.defineProperties(Object.setPrototypeOf(r,hy.prototype),{streamId:{value:0,writable:!0,configurable:!0},name:{value:l,writable:!0,configurable:!0},args:{value:d,writable:!0,configurable:!0},id:{value:0,writable:!0,configurable:!0}});Uc.create(g);for(let C=0;C<d.length;C++){let A=d[C];typeof A=="function"&&A instanceof hy&&Uc.addSource(g,A)}return g}return r}function ud(r,l){window.postMessage({source:"fastrx-devtools-backend",payload:{event:r,payload:l}})}var Pre=class extends kV{constructor(r,l,d){super(r),this.source=l,this.id=d,this.sourceId=r.sourceId,this.defer(()=>{Uc.defer(this.source,this.id)})}next(r){Uc.next(this.source,this.id,r),this.sink.next(r)}complete(){Uc.complete(this.source,this.id),this.sink.complete()}error(r){Uc.complete(this.source,this.id,r),this.sink.error(r)}},Uc={addSource(r,l){ud("addSource",{id:r.id,name:r.toString(),source:{id:l.id,name:l.toString()}})},next(r,l,d){ud("next",{id:r.id,streamId:l,data:d&&d.toString()})},subscribe(r,l){let{id:d,end:g}=r;ud("subscribe",{id:d,end:g,sink:{nodeId:l&&l.nodeId,streamId:l&&l.streamId}})},complete(r,l,d){ud("complete",{id:r.id,streamId:l,err:d?d.toString():null})},defer(r,l){ud("defer",{id:r.id,streamId:l})},pipe(r){ud("pipe",{name:r.toString(),id:r.id,source:{id:r.source.id,name:r.source.toString()}})},update(r){ud("update",{id:r.id,name:r.toString()})},create(r){r.id||(r.id=Nre++),ud("create",{name:r.toString(),id:r.id})}},xre=class extends MV{constructor(r){super(),this.source=r,this.sinks=new Set}add(r){r.defer(()=>this.remove(r)),this.sinks.add(r).size===1&&(this.reset(),this.subscribe(this.source))}remove(r){this.sinks.delete(r),this.sinks.size===0&&this.dispose()}next(r){this.sinks.forEach(l=>l.next(r))}complete(){this.sinks.forEach(r=>r.complete()),this.sinks.clear()}error(r){this.sinks.forEach(l=>l.error(r)),this.sinks.clear()}},Ure=function(r,l){return function(){for(var d=arguments.length,g=new Array(d),C=0;C<d;C++)g[C]=arguments[C];return A=>{if(A instanceof hy){let L=QC(B=>{let U=new r(B,...g);U.sourceId=L.id,U.subscribe(A)},l,arguments);return L.source=A,Uc.pipe(L),L}return L=>A(new r(L,...g))}}}(class extends kV{constructor(r,l,d){super(r),this.mapper=l,this.thisArg=d}next(r){super.next(this.mapper.call(this.thisArg,r))}},"map");(function(r){for(var l=arguments.length,d=new Array(l>1?l-1:0),g=1;g<l;g++)d[g-1]=arguments[g];d.reduce((C,A)=>A(C),r)})(function(r){return QC(l=>{let d=0,g=setInterval(()=>l.next(d++),r);return l.defer(()=>{clearInterval(g)}),"interval"},"interval",arguments)}(250),Ure(()=>performance.now()),function(){return r=>{let l=new xre(r);if(r instanceof hy){let d=QC(g=>{l.add(g)},"share",arguments);return l.sourceId=d.id,d.source=r,Uc.pipe(d),d}return QC(l.add.bind(l),"share",arguments)}}());var Zm=new Map;function gi(r,l){let d=Io(Fn({},l),{timestamp:Cw()});Zm.has(r)?Zm.get(r).push(d):Zm.set(r,[d])}en.on($t.JOIN_SUCCESS,r=>{let{room:l}=r;gi(l.userId,{eventId:32788,eventDesc:"join room"})}),en.on($t.LEAVE_START,r=>{let{room:l}=r;gi(l.userId,{eventId:32789,eventDesc:"leave room"})}),en.on($t.LOCAL_TRACK_PUBLISHED,r=>{let{track:l}=r;if(l.room){let d=32769;l.mediaType===4?d=32768:l.mediaType===2&&(d=32805),gi(l.room.userId,{eventId:d,eventDesc:"publish ".concat(l.kind)})}}),en.on($t.LOCAL_TRACK_UNPUBLISHED,r=>{let{track:l}=r;if(l.room){let d=32771;l.mediaType===4?d=32770:l.mediaType===2&&(d=32806),gi(l.room.userId,{eventId:d,eventDesc:"unpublish ".concat(l.kind)})}}),en.on($t.TRACK_MUTED,r=>{let{track:l}=r;l.room&&(l.kind===Be.AUDIO?gi(l.room.userId,{eventId:l.isRemote?32785:32772,eventDesc:"mute audio",remoteUserId:l.isRemote?l.userId:void 0}):gi(l.room.userId,{eventId:l.isRemote?32784:32773,eventDesc:"mute video",remoteUserId:l.isRemote?l.userId:void 0}))}),en.on($t.TRACK_UNMUTED,r=>{let{track:l}=r;l.room&&(l.kind===Be.AUDIO?gi(l.room.userId,{eventId:l.isRemote?32787:32774,eventDesc:"unmute audio",remoteUserId:l.isRemote?l.userId:void 0}):gi(l.room.userId,{eventId:l.isRemote?32786:32775,eventDesc:"unmute video",remoteUserId:l.isRemote?l.userId:void 0}))}),en.on($t.REMOTE_TRACK_SUBSCRIBED,r=>{let{track:l}=r;!l.room||(l.mediaType===1&&gi(l.room.userId,{eventId:32777,eventDesc:"".concat(Be.SUBSCRIBE," ").concat(l.kind),remoteUserId:l.userId}),l.mediaType===4&&gi(l.room.userId,{eventId:32776,eventDesc:"".concat(Be.SUBSCRIBE," ").concat(l.kind),remoteUserId:l.userId}),l.mediaType===8&&gi(l.room.userId,{eventId:32803,eventDesc:"".concat(Be.SUBSCRIBE," ").concat(Be.SMALL_VIDEO),remoteUserId:l.userId}))}),en.on($t.REMOTE_TRACK_UNSUBSCRIBED,r=>{let{track:l}=r;!l.room||(l.mediaType===1&&gi(l.room.userId,{eventId:32779,eventDesc:"".concat(Be.UNSUBSCRIBE," ").concat(l.kind),remoteUserId:l.userId}),l.mediaType===4&&gi(l.room.userId,{eventId:32778,eventDesc:"".concat(Be.UNSUBSCRIBE," ").concat(l.kind),remoteUserId:l.userId}),l.mediaType===8&&gi(l.room.userId,{eventId:32804,eventDesc:"".concat(Be.UNSUBSCRIBE," ").concat(Be.SMALL_VIDEO),remoteUserId:l.userId}))}),en.on($t.SWITCH_DEVICE_SUCCESS,r=>{let{track:l}=r;l.room&&gi(l.room.userId,{eventId:l.kind===Be.VIDEO?32780:32781,eventDesc:"switch ".concat(l.kind===Be.VIDEO?"camera":"microphone")})}),en.on($t.LOCAL_TRACK_REPLACED,r=>{let{track:l}=r;l.room&&gi(l.room.userId,{eventId:l.kind===Be.VIDEO?32782:32783,eventDesc:"replace ".concat(l.kind)})}),en.on($t.SIGNAL_CONNECTION_STATE_CHANGED,r=>{let l,d,{room:g,prevState:C,state:A}=r;switch(A){case"CONNECTED":C==="RECONNECTING"?(l=32795,d="signal reconnected"):(l=32791,d="signal connected");break;case"DISCONNECTED":C==="RECONNECTING"?(l=32796,d="signal reconnect fail"):(l=32790,d="signal disconnected");break;case"RECONNECTING":l=32794,d="signal reconnecting"}l&&d&&gi(g.userId,{eventId:l,eventDesc:d})}),en.on($t.PEER_CONNECTION_STATE_CHANGED,r=>{let l,d,{room:g,prevState:C,state:A,remoteUserId:L}=r,B=!!L,U=B?"downlink":"uplink";switch(A){case"CONNECTED":C==="RECONNECTING"?(l=B?32801:32798,d="".concat(U," reconnected")):(l=B?32793:32792,d="".concat(U," connected"));break;case"DISCONNECTED":C==="RECONNECTING"&&(l=B?32802:32799,d="".concat(U," reconnect fail"));break;case"RECONNECTING":l=B?32800:32797,d="".concat(U," reconnecting")}l&&d&&gi(g.userId,{eventId:l,eventDesc:d,remoteUserId:L})});var Fre=Vi(qa(),1),Vre=class extends Fre.EventEmitter{constructor(r,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"userId";super(),this.mySelfId=r,this._log=l,this.key=d,Se(this,"userMap",new Map),Se(this,"remotePublishedUserMap",new Map)}getPublishedUser(r){return this.remotePublishedUserMap.get(r)}addUser(r){let l=r[this.key],{userId:d,tinyId:g,role:C}=r;if(this.userMap.has(l))return;let A={userId:d,tinyId:g,role:C===20?"anchor":"audience"};this.userMap.set(l,A),this.emit("1",A)}deleteUser(r,l){let d=this.userMap.get(r);if(!d)return;let g="peer leave [".concat(r,"]");Ft(l)||(g+=":".concat(oF[l])),this._log.info(g);let C=this.remotePublishedUserMap.get(r);if(C){let A=C.muteState;C.flag=0,this.emit("5",C.userId),this.deleteRemotePublishedUser(r),this.emit("6",{prevMuteState:A,muteState:C.muteState,flag:0})}this.userMap.delete(r),this.emit("2",d.userId)}setUserList(r){this.userMap.forEach(l=>{r.findIndex(d=>d[this.key]===l[this.key])<0&&this.deleteUser(l[this.key],0)}),r.forEach(l=>{!this.userMap.has(l[this.key])&&l[this.key]!==this.mySelfId&&this.addUser(l)})}addRemotePublishedUser(r){this.remotePublishedUserMap.has(r[this.key])||this.remotePublishedUserMap.set(r[this.key],r)}deleteRemotePublishedUser(r){!this.remotePublishedUserMap.has(r)||this.remotePublishedUserMap.delete(r)}setRemotePublishedUserList(r){this.remotePublishedUserMap.forEach(l=>{let d=l[this.key];if(r.findIndex(g=>g[this.key]===l[this.key])<0){this._log.info("remote [".concat(d,"] unpublish"));let g=l.muteState;l.flag=0,this.emit("5",l.userId),this.deleteRemotePublishedUser(d),this.emit("6",{prevMuteState:g,muteState:l.muteState,flag:0})}}),r.forEach(l=>{var d;let g=l[this.key];if(g===this.mySelfId)return;let{flag:C,userId:A,tinyId:L}=l,B=J_(C,A),U=(d=this.remotePublishedUserMap.get(g))==null?void 0:d.muteState;if(U){let Z=this.remotePublishedUserMap.get(g);Z&&Z.flag!==C&&(Z.flag=C,this._log.info("remote publish updated: ".concat(JSON.stringify(Z.muteState))),this.emit("6",{prevMuteState:U,muteState:B,flag:C}))}else this._log.info("remote publish. state: ".concat(JSON.stringify(B))),this.addUser({userId:A,tinyId:L,role:20}),this.emit("3",l),this.emit("6",{prevMuteState:J_(0,A),muteState:B,flag:C})})}clear(){this.userMap.clear(),this.remotePublishedUserMap.clear()}};function wV(r){let{timesInSecond:l,maxSizeInSecond:d,getSize:g}=r;return Tr((C,A)=>{let L=new Map;return en.on($t.ROOM_DESTROY,B=>{let{room:U}=B;return L.delete(U)}),function(){let B=L.get(this);for(var U=arguments.length,Z=new Array(U),ae=0;ae<U;ae++)Z[ae]=arguments[ae];if(B||(B={callCountInSecond:0,timestamp:0,totalSizeInSecond:0},L.set(this,B)),B.timestamp===0?B.timestamp=Date.now():Date.now()-B.timestamp>1e3&&(B.timestamp=Date.now(),B.callCountInSecond=0,B.totalSizeInSecond=0),g&&(B.totalSizeInSecond+=g(...Z)),B.timestamp!==0&&Date.now()-B.timestamp<1e3&&(B.callCountInSecond>=l||B.totalSizeInSecond>d))throw new Rn({code:an.INVALID_OPERATION,message:so({key:to.CALL_FREQUENCY_LIMIT,data:{isTimes:B.callCountInSecond>=l,isSize:B.totalSizeInSecond>d,name:A,timesInSecond:l,maxSizeInSecond:d}})});B.callCountInSecond++,C.call(this,...Z)}})}var xt,RV=!0,Fc={SCENE_LIVE:"live",SCENE_RTC:"rtc",ROLE_ANCHOR:"anchor",ROLE_AUDIENCE:"audience",STREAM_TYPE_MAIN:"main",STREAM_TYPE_SUB:"sub",AUDIO_PROFILE_STANDARD:"standard",AUDIO_PROFILE_STANDARD_STEREO:"standard-stereo",AUDIO_PROFILE_HIGH:"high",AUDIO_PROFILE_HIGH_STEREO:"high-stereo",QOS_PREFERENCE_SMOOTH:"smooth",QOS_PREFERENCE_CLEAR:"clear"},no={INVALID_PARAMETER:5e3,INVALID_OPERATION:5100,ENV_NOT_SUPPORTED:5200,DEVICE_ERROR:5300,SERVER_ERROR:5400,OPERATION_FAILED:5500,OPERATION_ABORT:5998,UNKNOWN_ERROR:5999},eS=((xt=eS||{})[xt.INVALID_PARAMETER=5e3]="INVALID_PARAMETER",xt[xt.INVALID_PARAMETER_REQUIRED=5001]="INVALID_PARAMETER_REQUIRED",xt[xt.INVALID_PARAMETER_TYPE=5002]="INVALID_PARAMETER_TYPE",xt[xt.INVALID_PARAMETER_EMPTY=5003]="INVALID_PARAMETER_EMPTY",xt[xt.INVALID_PARAMETER_INSTANCE=5004]="INVALID_PARAMETER_INSTANCE",xt[xt.INVALID_PARAMETER_RANGE=5005]="INVALID_PARAMETER_RANGE",xt[xt.INVALID_PARAMETER_LESS_THAN_ZERO=5006]="INVALID_PARAMETER_LESS_THAN_ZERO",xt[xt.INVALID_PARAMETER_MIN=5007]="INVALID_PARAMETER_MIN",xt[xt.INVALID_PARAMETER_MAX=5008]="INVALID_PARAMETER_MAX",xt[xt.INVALID_ELEMENT_ID=5009]="INVALID_ELEMENT_ID",xt[xt.INVALID_ELEMENT_ID_TYPE=5010]="INVALID_ELEMENT_ID_TYPE",xt[xt.INVALID_STREAM_ID=5011]="INVALID_STREAM_ID",xt[xt.INVALID_ROOM_ID_STRING=5012]="INVALID_ROOM_ID_STRING",xt[xt.INVALID_ROOM_ID_INTEGER=5013]="INVALID_ROOM_ID_INTEGER",xt[xt.INVALID_STREAM_TYPE=5014]="INVALID_STREAM_TYPE",xt[xt.INVALID_ROOM_ID_REQUIED=5015]="INVALID_ROOM_ID_REQUIED",xt[xt.INVALID_ROOM_ID_INTEGER_STRING=5016]="INVALID_ROOM_ID_INTEGER_STRING",xt[xt.INVALID_BUFFER_EMPTY=5017]="INVALID_BUFFER_EMPTY",xt[xt.INVALID_BUFFER_OVERSIZE=5018]="INVALID_BUFFER_OVERSIZE",xt[xt.INVALID_OPERATION=5100]="INVALID_OPERATION",xt[xt.INVALID_OPERATION_NOT_JOINED=5101]="INVALID_OPERATION_NOT_JOINED",xt[xt.INVALID_OPERATION_REMOTE_USER_NOT_EXIST=5102]="INVALID_OPERATION_REMOTE_USER_NOT_EXIST",xt[xt.INVALID_OPERATION_STREAM_TYPE_NOT_EXIST=5103]="INVALID_OPERATION_STREAM_TYPE_NOT_EXIST",xt[xt.INVALID_OPERATION_REPEAT_CALL=5104]="INVALID_OPERATION_REPEAT_CALL",xt[xt.INVALID_OPERATION_NEED_VIDEO=5105]="INVALID_OPERATION_NEED_VIDEO",xt[xt.INVALID_OPERATION_NEED_AUDIO=5106]="INVALID_OPERATION_NEED_AUDIO",xt[xt.INVALID_ROLE_AUDIENCE=5107]="INVALID_ROLE_AUDIENCE",xt[xt.ENV_NOT_SUPPORTED=5200]="ENV_NOT_SUPPORTED",xt[xt.NOT_SUPPORTED_HTTP=5201]="NOT_SUPPORTED_HTTP",xt[xt.NOT_SUPPORTED_WEBRTC=5202]="NOT_SUPPORTED_WEBRTC",xt[xt.NOT_SUPPORTED_H264_ENCODE=5203]="NOT_SUPPORTED_H264_ENCODE",xt[xt.NOT_SUPPORTED_H264_DECODE=5204]="NOT_SUPPORTED_H264_DECODE",xt[xt.NOT_SUPPORTED_SCREEN_SHARE=5205]="NOT_SUPPORTED_SCREEN_SHARE",xt[xt.NOT_SUPPORTED_SMALL_VIDEO=5206]="NOT_SUPPORTED_SMALL_VIDEO",xt[xt.NOT_SUPPORTED_SEI=5207]="NOT_SUPPORTED_SEI",xt[xt.NOT_SUPPORTED_WEBGL=5208]="NOT_SUPPORTED_WEBGL",xt[xt.NOT_SUPPORTED_CHROME_VERSION=5209]="NOT_SUPPORTED_CHROME_VERSION",xt[xt.DEVICE_ERROR=5300]="DEVICE_ERROR",xt[xt.DEVICE_NOT_FOUND_ERROR=5301]="DEVICE_NOT_FOUND_ERROR",xt[xt.DEVICE_NOT_ALLOWED_ERROR=5302]="DEVICE_NOT_ALLOWED_ERROR",xt[xt.DEVICE_NOT_READABLE_ERROR=5303]="DEVICE_NOT_READABLE_ERROR",xt[xt.DEVICE_OVERCONSTRAINED_ERROR=5304]="DEVICE_OVERCONSTRAINED_ERROR",xt[xt.DEVICE_INVALID_STATE_ERROR=5305]="DEVICE_INVALID_STATE_ERROR",xt[xt.DEVICE_SECURITY_ERROR=5306]="DEVICE_SECURITY_ERROR",xt[xt.DEVICE_ABORT_ERROR=5307]="DEVICE_ABORT_ERROR",xt[xt.CAMERA_RECOVER_FAILED=5308]="CAMERA_RECOVER_FAILED",xt[xt.MICROPHONE_RECOVER_FAILED=5309]="MICROPHONE_RECOVER_FAILED",xt[xt.SERVER_ERROR=5400]="SERVER_ERROR",xt[xt.NEED_TO_BUY=5401]="NEED_TO_BUY",xt[xt.ACCOUNT_NO_MONEY=-100013]="ACCOUNT_NO_MONEY",xt[xt.OPERATION_FAILED=5500]="OPERATION_FAILED",xt[xt.FIREWALL_RESTRICTION=5501]="FIREWALL_RESTRICTION",xt[xt.REJOIN_FAILED=5502]="REJOIN_FAILED",xt[xt.EVENT_HANDLER_ERROR=5503]="EVENT_HANDLER_ERROR",xt[xt.VIDEO_CONTEXT_ERROR=5504]="VIDEO_CONTEXT_ERROR",xt[xt.OPERATION_ABORT=5998]="OPERATION_ABORT",xt[xt.UNKNOWN_ERROR=5999]="UNKNOWN_ERROR",xt),AV=Io(Fn({},Js),{INVALID_PARAMETER(r){let{fnName:l}=r;return"the parameters of the '".concat(l,"' you called does not meet the requirements, please check the API documentation.")},INVALID_PARAMETER_REQUIRED(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' is a required param when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_TYPE(r){let{key:l,rule:d,fnName:g,value:C}=r,A="".concat(l||d.name),L="";return L=Array.isArray(d.type)?d.type.join("|"):d.type,"'".concat(A,"' must be type of ").concat(L," when calling ").concat(g,"(), received type: ").concat(ya(C),".")},INVALID_PARAMETER_EMPTY(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' cannot be '").concat(C,"' when calling ").concat(g,"().")},INVALID_PARAMETER_INSTANCE(r){let{key:l,rule:d,fnName:g,value:C}=r,A="".concat(l||d.name),L="".concat(d.instanceOf.name||d.instanceOf);return"'".concat(A,"' must be instanceof ").concat(L," when calling ").concat(g,"(), received type: ").concat(ya(C),".")},INVALID_PARAMETER_RANGE(r){let{key:l,rule:d,fnName:g,value:C}=r;return"'".concat(l||d.name,"' must be one of ").concat(d.values.join("|")," when calling ").concat(g,"(), received: ").concat(C,".")},INVALID_PARAMETER_LESS_THAN_ZERO(r){let{key:l,rule:d,fnName:g}=r;return"'".concat(l||d.name,"' cannot be less than 0 when calling ").concat(g,"().")},INVALID_PARAMETER_MIN(r){let{key:l,rule:d,value:g}=r;return"the min value of ".concat(l||d.name," is ").concat(d.min,", received: ").concat(g,".")},INVALID_PARAMETER_MAX(r){let{key:l,rule:d,value:g}=r;return"the max value of ".concat(l||d.name," is ").concat(d.max,", received: ").concat(g,".")},INVALID_ELEMENT_ID(r){let{key:l,fnName:d}=r;return"'".concat(l,"' is not found in the document object when calling ").concat(d,"().")},INVALID_ELEMENT_ID_TYPE(r){let{key:l,fnName:d,type:g}=r;return"the element corresponding to '".concat(l,"' must be instanceof HTMLElement when calling ").concat(d,"(), received: ").concat(g,".")},INVALID_STREAM_ID(r){let{key:l}=r;return"'".concat(l,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores.")},INVALID_ROOM_ID_STRING(r){let{key:l}=r;return"'".concat(l,"' must be a valid string.")},INVALID_ROOM_ID_INTEGER(r){let{key:l}=r;return"'".concat(l,"' must be an integer between [1, 4294967294].")},INVALID_ROOM_ID_INTEGER_STRING(r){let{key:l}=r;return"'".concat(l,"' must be an integer but go a string, use 'parseInt' to convert it or use 'strRoomId' instead.")},INVALID_ROOM_ID_REQUIED:()=>"at least one of 'roomId'(between [1, 4294967294]) and 'strRoomId'(not empty) is required.",INVALID_STREAM_TYPE:r=>{let{fnName:l}=r;return"'streamType' is required when 'userId' is not '*', calling ".concat(l,"()")},INVALID_IMAGE_URL:"The 'src' param must be filled in when the background type is image.",INVALID_OPERATION(r){let{fnName:l}=r;return"the API '".concat(l,"' you called does not meet the requirements, please check the API documentation.")},INVALID_OPERATION_NOT_JOINED(r){let{fnName:l}=r;return"cannot ".concat(l," because you are not enter room yet.")},INVALID_OPERATION_REMOTE_USER_NOT_EXIST(r){let{fnName:l,value:d}=r;return"cannot ".concat(l," because remote user(userId: ").concat(d.userId,") does not publishing stream.")},INVALID_OPERATION_STREAM_TYPE_NOT_EXIST(r){let{fnName:l,value:d}=r;return"cannot ".concat(l," because remote user(userId: ").concat(d.userId,") does not publishing ").concat(d.streamType," video.")},INVALID_OPERATION_REPEAT_CALL(r){let{fnName:l}=r;return"you are already ".concat(l,"(), cannot repeated call '").concat(l,"'.")},INVALID_OPERATION_NEED_VIDEO(r){let{fnName:l}=r;return"cannot call '".concat(l,"' because the camera is not turned on.")},INVALID_OPERATION_NEED_AUDIO(r){let{fnName:l}=r;return"cannot call '".concat(l,"' because the microphone is not turned on.")},INVALID_BUFFER_EMPTY:r=>{let{key:l}=r;return"the buffer size of paramerter '".concat(l,"' cannot be empty")},INVALID_BUFFER_OVERSIZE:()=>"buffer size is over 1000 Bytes",INVALID_ROLE_AUDIENCE:()=>"role: '".concat("audience","' cannot call this api."),ENV_NOT_SUPPORTED(r){let{fnName:l}=r;return"the current browser does not support the capability of the function '".concat(l,"' you are calling, please check the API documentation.")},NOT_SUPPORTED_WEBRTC:"the current browser does not support WebRTC capability, please check the SDK documentation.",NOT_SUPPORTED_H264_ENCODE:"this browser does not support H264 encode.",NOT_SUPPORTED_H264_DECODE:"this browser does not support H264 decode.",NOT_SUPPORTED_SCREEN_SHARE:"this browser does not support screen share, please check the browser version.",NOT_SUPPORTED_SMALL_VIDEO:"this browser does not support small video, please check the browser version.",NOT_SUPPORTED_SEI:"this browser does not support SEI, please check the browser version.",NOT_SUPPORTED_WEBGL:"this browser does not support WebGL, please check the browser version.",NOT_SUPPORTED_CHROME_VERSION(r){let{fnName:l}=r;return"cannot call ".concat(l," because the browser version is too low, please upgrade to the latest version")},DEVICE_ERROR(r){let{fnName:l,error:d}=r;return"'".concat(l,"' got device exception").concat(d?", error: ".concat(d.toString(),"."):".")},DEVICE_NOT_FOUND_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"NotFoundError, no ".concat(d," detected, please check your device and the configuration on '").concat(l,"'").concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_NOT_ALLOWED_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"NotAllowedError, you have disabled ".concat(d," access, please allow the current application to use the ").concat(d).concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_NOT_READABLE_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"NotReadableError, the ".concat(d," maybe in use by another APP, please check if the device is pre-occupied by another APP.")},DEVICE_OVERCONSTRAINED_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"OverconstrainedError, the device ID is incorrect, please check whether the device ID passed in is correct".concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_INVALID_STATE_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"InvalidStateError, after the user clicks and interacts with the page, turn on the ".concat(d).concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_SECURITY_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"SecurityError, check whether the system security policy restricts the use of the ".concat(d,", and it is recommended to turn on the ").concat(d," after the user interacts with the page").concat(g?", error: ".concat(g.toString(),"."):".")},DEVICE_ABORT_ERROR(r){let{fnName:l,deviceType:d=pf(l),error:g}=r;return"AbortError, an unknown exception in the system makes the device unusable, recommended to change the device or browser and re-check whether the device is normal".concat(g?" error: ".concat(g.toString(),"."):".")},CAMERA_RECOVER_FAILED(r){let{error:l}=r;return"camera recover capture failed ".concat((l==null?void 0:l.name)||"",": ").concat((l==null?void 0:l.originMessage)||(l==null?void 0:l.message))},MICROPHONE_RECOVER_FAILED(r){let{error:l}=r;return"microphone recover capture failed ".concat((l==null?void 0:l.name)||"",": ").concat((l==null?void 0:l.originMessage)||(l==null?void 0:l.message))},OPERATION_FAILED(r){let{fnName:l,error:d}=r;return"'".concat(l,"' failed, reason: ").concat(d==null?void 0:d.toString())},FIREWALL_RESTRICTION:()=>"media connection failure due to firewall restrictions, please try to change your network.",EVENT_HANDLER_ERROR(r){let{eventName:l}=r;return"an error was caught on trtc.on('".concat(l,"', handler), please check your code on 'handler'.")},VIDEO_CONTEXT_ERROR(r){let{reason:l,error:d}=r;return"video context error ".concat(l," ").concat((d==null?void 0:d.name)||""," ").concat((d==null?void 0:d.message)||"")},SERVER_ERROR(r){let{fnName:l,error:d}=r;return"'".concat(l,"' got server error: ").concat(d==null?void 0:d.toString(),", please check the SDK documentation.")},NEED_TO_BUY(r){let{value:l,url:d}=r;return"You need to buy packages for ".concat(l,". Refer to: ").concat(d)},ACCOUNT_NO_MONEY:r=>{let{fnParams:l}=r;return"your TRTC account run out of credit, please recharge.".concat(l.sdkAppId?" SDKAppId: ".concat(l.sdkAppId):"")},OPERATION_ABORT(r){let{fnName:l}=r;return"'".concat(l,"' abort")},UNKNOWN_ERROR(r){let{fnName:l,error:d}=r;return"'".concat(l,"' throw unknown exception").concat(d?", error: ".concat(d.toString(),"."):".")}});function pf(r){if(!r)return"camera";let l=r.toLowerCase();return l.includes("screen")?"screen share":l.includes("audio")?"microphone":"camera"}var tS=class extends Error{constructor(r){let{code:l,extraCode:d,message:g="",messageParams:C,fnName:A="",originError:L}=r;var B;let U;U=g||function(Z){let ae,{code:ce,params:we,enableDocLink:Pe=!1}=Z,Ze="",Ct=eS[ce];try{ae=AV[Ct]}catch{ae=AV.UNKNOWN_ERROR}return Er(ae)?Ze=ae(we):rr(ae)&&(Ze=ae),we.fnName&&!Ze.includes(we.fnName)&&(Ze[Ze.length-1]!=="."&&(Ze+="."),Ze+=" thrown from ".concat(we.fnName,"()")),Pe&&(Ze+=" doc:"),Ze}({code:d||l,params:Fn({fnName:A,error:L},C)}),super(U),Se(this,"name","RtcError"),Se(this,"code"),Se(this,"extraCode"),Se(this,"functionName"),Se(this,"message"),Se(this,"handler"),Se(this,"originError"),this.name=eS[l],this.code=l,this.extraCode=d,this.functionName=A,this.originError=L,this.message=U,this.extraCode===5302&&((B=this.originError)!=null&&B.message.includes("system"))&&(this.handler=()=>{let Z=document.createElement("a");Vm?Z.href="ms-settings:privacy-".concat({startLocalVideo:"webcam",startLocalAudio:"microphone"}[this.functionName]):rf&&(Z.href="x-apple.systempreferences:com.apple.preference.security?Privacy_".concat({startLocalVideo:"Camera",startLocalAudio:"Microphone",startScreenShare:"ScreenCapture"}[this.functionName])),Z.href.length>0&&Z.click()})}static convertFrom(r,l,d){let g=r;if(r instanceof Rn){let{stack:C}=r,A={code:no.UNKNOWN_ERROR,fnName:l,originError:r};switch(r.getCode()){case an.INVALID_PARAMETER:A.code=no.INVALID_PARAMETER,A.message=r.message;break;case an.INVALID_OPERATION:A.code=no.INVALID_OPERATION;break;case an.NOT_SUPPORTED:case an.NOT_SUPPORTED_H264:A.code=no.ENV_NOT_SUPPORTED,r.getCode()===an.NOT_SUPPORTED_H264&&(A.extraCode=r.message.includes(Js.NOT_SUPPORTED_H264ENCODE)?5203:5204);break;case an.JOIN_ROOM_FAILED:A.messageParams={fnParams:d};case an.SERVER_TIMEOUT:case an.SWITCH_ROLE_FAILED:A.code=no.SERVER_ERROR,A.extraCode=r.getExtraCode();break;case an.API_CALL_ABORTED:A.code=no.OPERATION_ABORT;break;case an.DEVICE_NOT_FOUND:case an.DEVICE_AUTO_RECOVER_FAILED:case an.INITIALIZE_FAILED:A.code=5300,r.name&&(A.extraCode=function(L){let B;switch(L){case"NotFoundError":B=5301;break;case"NotAllowedError":B=5302;break;case"NotReadableError":B=5303;break;case"OverconstrainedError":B=5304;break;case"InvalidStateError":B=5305;break;case"SecurityError":B=5306;break;case"AbortError":B=5307;break;default:B=5300}return B}(r.name));break;case an.UNKNOWN:break;default:A.code=no.OPERATION_FAILED}g=new tS(A),C&&(g.stack+=C.substr(C.indexOf(`
`)))}else{if(r instanceof tS)return r;g=new tS({code:no.UNKNOWN_ERROR,fnName:l,originError:r})}return g}},Wn=tS,DV={type:"object",properties:{cameraId:{type:"string"},useFrontCamera:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:["string","boolean"],values:[!0,!1,"view","publish","both"]},small:{properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack}}},OV={type:"object",properties:{systemAudio:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},profile:{type:["string","object"],properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack},audioTrack:{instanceOf:MediaStreamTrack}}},Qm={type:["string",HTMLElement,null,"array"],arrayItem:{instanceOf:HTMLElement},validate(r,l,d){if(rr(r)&&!document.getElementById(r))throw new Wn({code:no.INVALID_PARAMETER,extraCode:5009,fnName:d,messageParams:{key:l}})}},LV={name:"userId",required:!0,type:"string"},NV={type:"object",properties:{microphoneId:{type:"string"},audioTrack:{instanceOf:MediaStreamTrack},captureVolume:{type:"number",min:0},earMonitorVolume:{type:"number",min:0,max:100},profile:{values:[Fc.AUDIO_PROFILE_STANDARD,Fc.AUDIO_PROFILE_STANDARD_STEREO,Fc.AUDIO_PROFILE_HIGH,Fc.AUDIO_PROFILE_HIGH_STEREO]},echoCancellation:{type:"boolean"},autoGainControl:{type:"boolean"},noiseSuppression:{type:"boolean"}}};function fy(r,l){if(!r)throw new Wn({code:no.INVALID_OPERATION,extraCode:5101,fnName:l})}function PV(r,l,d){if(!r)throw new Wn({code:no.INVALID_OPERATION,extraCode:5102,fnName:l,messageParams:{value:d}})}var Gre={create:[{name:"RoomConfig",instanceOf:Function},{name:"CreateConfig",type:"object",properties:{plugins:{type:"array",arrayItem:{instanceOf:Function}}}}],enterRoom:{name:"EnterRoomConfig",type:"object",required:!0,validate(r,l,d){if(this._room.isJoined)throw new Wn({code:no.INVALID_OPERATION,extraCode:5104,fnName:d});if(r.roomId){if(rr(r.roomId))throw new Wn({code:no.INVALID_PARAMETER,extraCode:5016,fnName:d,messageParams:{key:l}});if(!(/^[1-9]\d*$/.test(String(r.roomId))&&r.roomId<4294967295))throw new Wn({code:no.INVALID_PARAMETER,extraCode:5013,fnName:d,messageParams:{key:l}})}else{if(!r.strRoomId)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5015,fnName:d});if(!/^[A-Za-z\d\s!#$%&()+\-:;<=.>?@[\]^_{}|~,]{1,64}$/.test(r.strRoomId))throw new Wn({code:no.INVALID_PARAMETER,extraCode:5012,fnName:d,messageParams:{key:l}})}},properties:{sdkAppId:{required:!0,type:"number",allowEmpty:!1},userId:{required:!0,type:"string",allowEmpty:!1},userSig:{required:!0,type:"string",allowEmpty:!1},scene:{type:"string",values:["live","rtc"]},role:{type:"string",values:["audience","anchor"]},roomId:{type:["string","number"]},strRoomId:{type:"string"},proxy:{type:["object","string"],properties:{websocketProxy:{type:"string"},turnServer:{type:["object","array"],properties:{url:{required:!0,type:"string"},username:{type:"string"},credential:{type:"string"},credentialType:{type:"string",values:["password"]}}},loggerProxy:{type:"string"},webtransportProxy:{type:"string"}}},enableAutoPlayDialog:{type:"boolean"},userDefineRecordId:{type:"string"}}},startLocalVideo:{name:"LocalVideoConfig",type:"object",properties:{view:Qm,mute:{type:["boolean","string"]},publish:{type:"boolean"},option:DV},validate(r){var l;if(((l=r==null?void 0:r.option)==null||!l.videoTrack)&&uf())throw new Wn({code:no.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalVideo:{name:"updateLocalVideoConfig",type:"object",required:!0,properties:{view:Io(Fn({},Qm),{required:!1}),publish:{type:"boolean"},mute:{type:["boolean","string"]},option:DV}},startLocalAudio:{name:"LocalAudioConfig",type:"object",properties:{publish:{type:"boolean"},option:NV},validate(r){var l;if(((l=r==null?void 0:r.option)==null||!l.audioTrack)&&uf())throw new Wn({code:no.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalAudio:{name:"updateLocalAudioConfig",type:"object",required:!0,properties:{publish:{type:"boolean"},mute:{type:"boolean"},option:NV}},startScreenShare:{name:"ScreenShareConfig",type:"object",properties:{view:Qm,publish:{type:"boolean"},option:OV},validate(r,l,d,g,C){var A;if(((A=r==null?void 0:r.option)==null||!A.videoTrack)&&uf())throw new Wn({code:no.ENV_NOT_SUPPORTED,extraCode:5201});if(!BC())throw new Wn({code:no.ENV_NOT_SUPPORTED,fnName:d,extraCode:5205})}},updateScreenShare:{name:"updateScreenShareConfig",type:"object",required:!0,properties:{view:Qm,publish:{type:"boolean"},option:OV}},muteRemoteAudio:[LV,{name:"mute",required:!0,type:"boolean"}],setRemoteAudioVolume:[LV,{name:"volume",required:!0,type:"number",min:0}],startRemoteVideo:{name:"startRemoteVideoConfig",type:"object",required:!0,properties:{view:Qm,userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(r,l,d){fy(this._room.isJoined,d);let g=this._room.remotePublishedUserMap.get(r.userId);if(PV(!!g,d,r),g&&(r.streamType==="main"&&!g.muteState.videoAvailable||r.streamType==="sub"&&!g.muteState.hasAuxiliary))throw new Wn({code:no.INVALID_OPERATION,extraCode:5103,fnName:d,messageParams:{value:r}})}},updateRemoteVideo:{name:"updateRemoteVideoConfig",type:"object",required:!0,properties:{view:Io(Fn({},Qm),{required:!1}),userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(r,l,d){fy(this._room.isJoined,d);let g=this._room.remotePublishedUserMap.get(r.userId);if(PV(!!g,d,r),g&&(r.streamType==="main"&&!g.muteState.videoAvailable||r.streamType==="sub"&&!g.muteState.hasAuxiliary))throw new Wn({code:no.INVALID_OPERATION,extraCode:5103,fnName:d,messageParams:{value:r}})}},stopRemoteVideo:{name:"stopRemoteVideoConfig",type:"object",required:!0,properties:{userId:{type:"string",required:!0},streamType:{values:["main","sub"]}},validate(r,l,d){if(r.userId!=="*"&&Ft(r.streamType))throw new Wn({code:no.INVALID_PARAMETER,extraCode:5014,fnName:d})}},switchRole:{name:"role",required:!0,values:["anchor","audience"],validate(r,l,d){fy(this._room.isJoining||this._room.isJoined,d)}},enableAudioVolumeEvaluation:[{name:"interval",type:"number"},{name:"enableInBackground",type:"boolean"}],sendSEIMessage:[{name:"buffer",required:!0,instanceOf:ArrayBuffer,validate(r,l,d,g){if(!ey)throw new Wn({code:no.ENV_NOT_SUPPORTED,fnName:d,extraCode:5207});if(!this._room.enableSEI)throw new Wn({code:no.INVALID_OPERATION,messageParams:{key:to.SEI_DISABLED}});if(r.byteLength>1e3)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5018,fnName:d});if(r.byteLength===0)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5017,messageParams:{key:l},fnName:d});if(fy(this._room.isJoined,d),!this._room.isMainStreamPublished)throw new Wn({code:no.INVALID_PARAMETER,messageParams:{key:to.SEI_BEFORE_PUBLISH}})}},{name:"options",type:"object",properties:{seiPayloadType:{type:"number",values:[5,243]}}}],sendCustomMessage:{name:"message",required:!0,type:"object",properties:{cmdId:{type:"number",required:!0,min:1,max:10},data:{instanceOf:ArrayBuffer,required:!0,validate(r,l,d,g){if(r.byteLength>1e3)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5018,fnName:d});if(r.byteLength===0)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5017,fnName:d,messageParams:{key:l}})}}},validate(r,l,d){if(fy(this._room.isJoined,d),this._room.scene==="live"&&this._room.role==="audience")throw new Wn({code:no.INVALID_OPERATION,extraCode:5107,fnName:d,messageParams:{key:l}})}}},Mi={TRTC:Gre},ja=class extends Error{};function Bre(r,l){let d=X_(r);for(let g=0;g<l.length;g++)cf(d[g],l[g]);return d}function Hre(r){this._resolve=Promise.resolve(r)}function $re(r){this._reject=Promise.reject(r)}var py=class{constructor(r,l){this.instance=r,this.group=l,this.started=!1,this.ops=[],this.startSame=()=>!0,this.mergeUpdate=Bre;let d=py.instances.get(r);d?d.set(l,this):py.instances.set(r,new Map([[l,this]]))}static get(r,l){let d=py.instances.get(r);return d&&d.get(l)||new py(r,l)}action(r,l,d){let g=L=>{var B;return r===0?this.started=!0:r===3&&(this.started=!1),this.ops.shift(),(B=this.currentOp)==null||B.action(),L},C=L=>{var B,U;throw this.ops.shift(),r===0&&((B=this.currentOp)==null?void 0:B.type)===2&&this.ops.shift().reject(new ja("start failed")),(U=this.currentOp)==null||U.action(),L},A={type:r,action:()=>l(...A.args).then(g,C),args:d,resolve:Hre,reject:$re};try{switch(this.state){case 1:if(r===0)throw new ja("already started");break;case 4:if(r===2)throw new ja("not started");break;default:return this.cacheOp(A)}}catch(L){return Promise.reject(L)}return this.ops.push(A),A.promise=l(...A.args).then(g,C)}cacheOp(r){if(this.ops.length===1)switch(this.state){case 0:case 2:if(r.type===0)throw new ja("already start");break;case 3:switch(r.type){case 2:throw new ja("update not allowed when stopping");case 3:return this.currentOp.promise}break;default:throw new ja("unknown state")}else switch(r.type){case 3:if(this.lastOpType===3)return this.lastOp.promise;{let d=new ja("keep stop");if(this.ops.slice(1).forEach(g=>g.reject(d)),this.ops=this.ops.slice(0,1),this.state===3)return this.currentOp.promise}break;case 2:switch(this.lastOpType){case 2:return this.lastOp.args=this.mergeUpdate(this.lastOp.args,r.args),this.lastOp.promise;case 3:throw new ja("update not allowed after stop")}break;case 0:switch(this.lastOpType){case 2:throw new ja("start not allowed after update");case 0:throw new ja("duplicate start");case 3:if(this.startSame(this.currentOp.args,r.args))throw this.ops.pop().reject(new ja("keep start")),new ja("already start")}}r.promise=new Promise((d,g)=>{r._resolve?r._resolve.then(d):r.resolve=d,r._reject?r._reject.catch(g):r.reject=g});let{action:l}=r;return r.action=()=>l().then(r.resolve,r.reject),this.ops.push(r),r.promise}get lastOp(){return this.ops[this.ops.length-1]}get lastOpType(){return this.lastOp.type}get currentOp(){return this.ops[0]}get state(){return this.currentOp?this.currentOp.type:this.started?1:4}},gy=py;gy.instances=new WeakMap;var nS=new WeakMap,oS=(r,l)=>{if(l instanceof ja){let{stack:d}=l;l=new Wn({code:no.OPERATION_ABORT,message:"".concat(r," abort: ").concat(l.message),fnName:r}),d&&(l.stack+=d.substr(d.indexOf(`
`)))}throw l};function mf(r,l){return Tr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),L=0;L<C;L++)A[L]=arguments[L];let B=gy.get(this,typeof r=="string"?r:r.call(this,...A));return l&&(B.startSame=l.bind(this)),B.action(0,d.bind(this),A).catch(oS.bind(null,g))})}function eg(r,l){let{merge:d,debounce:g}=l||{};return Tr((C,A)=>function(){for(var L=arguments.length,B=new Array(L),U=0;U<L;U++)B[U]=arguments[U];let Z=gy.get(this,typeof r=="string"?r:r.call(this,...B));if(d&&(Z.mergeUpdate=d.bind(this)),g&&g.isNeedToDebounce.apply(this,B)){let{delay:ae,getKey:ce}=g;return new Promise((we,Pe)=>{var Ze,Ct;let Bt=(Ze=nS.get(this))==null?void 0:Ze.get(ce(...B));if(Bt){let{timeoutId:kt,resolve:En}=Bt;clearTimeout(kt),En()}let Wt=setTimeout(()=>{if(Z.state===3||Z.state===4)return we();Z.action(2,C.bind(this),B).catch(oS.bind(null,A)).then(we,Pe)},ae);nS.has(this)?(Ct=nS.get(this))==null||Ct.set(ce(...B),{timeoutId:Wt,resolve:we}):nS.set(this,new Map([[ce(...B),{timeoutId:Wt,resolve:we}]]))})}return Z.action(2,C.bind(this),B).catch(oS.bind(null,A))})}function gf(r){return Tr((l,d)=>function(){for(var g=arguments.length,C=new Array(g),A=0;A<g;A++)C[A]=arguments[A];return gy.get(this,typeof r=="string"?r:r.call(this,...C)).action(3,l.bind(this),C).catch(oS.bind(null,d))})}var ro={ERROR:"error",AUTOPLAY_FAILED:"autoplay-failed",KICKED_OUT:"kicked-out",REMOTE_USER_ENTER:"remote-user-enter",REMOTE_USER_EXIT:"remote-user-exit",REMOTE_AUDIO_AVAILABLE:"remote-audio-available",REMOTE_AUDIO_UNAVAILABLE:"remote-audio-unavailable",REMOTE_VIDEO_AVAILABLE:"remote-video-available",REMOTE_VIDEO_UNAVAILABLE:"remote-video-unavailable",AUDIO_VOLUME:"audio-volume",NETWORK_QUALITY:"network-quality",CONNECTION_STATE_CHANGED:"connection-state-changed",AUDIO_PLAY_STATE_CHANGED:"audio-play-state-changed",VIDEO_PLAY_STATE_CHANGED:"video-play-state-changed",SCREEN_SHARE_STOPPED:"screen-share-stopped",DEVICE_CHANGED:"device-changed",PUBLISH_STATE_CHANGED:"publish-state-changed",TRACK:"track",STATISTICS:"statistics",SEI_MESSAGE:"sei-message",CUSTOM_MESSAGE:"custom-message"};function rS(r){return r==="sub"?"auxiliary":r==="auxiliary"?"sub":"main"}function tg(r){return r===Fc.QOS_PREFERENCE_CLEAR?"detail":r===Fc.QOS_PREFERENCE_SMOOTH?"motion":""}var iS=new WeakMap;function na(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return Tr((g,C)=>function(){for(var A=arguments.length,L=new Array(A),B=0;B<A;B++)L[B]=arguments[B];try{$R.call(this,l,L,C,this._name)}catch(U){return Promise.reject(U)}return g.apply(this,L)})}function xV(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return Tr((g,C)=>function(){for(var A=arguments.length,L=new Array(A),B=0;B<A;B++)L[B]=arguments[B];try{$R.call(this,l,L,C,this._name)}catch(U){throw U}return g.apply(this,L)})}function $R(r,l,d,g){if(Gi(r))for(let C=0;C<r.length;C++)aS.call(this,{rule:r[C],value:l[C],key:r[C].name,fnName:d,className:g});else aS.call(this,{rule:r,value:l[0],key:r.name,fnName:d,className:g})}function aS(r){let{rule:l,value:d,key:g,fnName:C,className:A}=r;function L(Z){return{code:no.INVALID_PARAMETER,extraCode:Z,fnName:C,messageParams:{key:g,rule:l,value:d}}}if(Ft(d)){if(l.required)throw new Wn(L(5001));if(Ft(l.defaultValue))return void(Er(l.validate)&&l.validate.call(this,d,g,C,A,this));d=l.defaultValue}if(Array.isArray(l.type)){let Z=!1;for(let ae=0;ae<l.type.length;ae++)l.type[ae]===null&&d===null&&(Z=!0),Er(l.type[ae])&&d instanceof l.type[ae]&&(Z=!0),rr(l.type[ae])&&ya(d)===l.type[ae].toLowerCase()&&(Z=!0);if(!Z)throw new Wn({code:no.INVALID_PARAMETER,extraCode:5002,fnName:C,messageParams:{key:g,rule:{type:l.type.map(ae=>hR(ae)?DF(ae):rr(ae)?ae:ya(ae))},value:d}})}else if(!Ft(l.type)&&ya(d)!==l.type)throw new Wn(L(5002));if(l.allowEmpty===!1){let Z=Ti(d)&&(d===0||Number.isNaN(d)),ae=rr(d)&&d.trim()==="";if(Z||ae)throw new Wn(L(5003))}if(l.notLessThanZero&&Ti(d)&&d<0)throw new Wn(L(5006));if(!Ft(l.min)&&Ti(d)&&d<l.min)throw new Wn(L(5007));if(!Ft(l.max)&&Ti(d)&&d>l.max)throw new Wn(L(5008));if(rr(l.instanceOf)){if(!d||d._name!==l.instanceOf)throw new Wn(L(5004))}else if(Er(l.instanceOf)&&!(d instanceof l.instanceOf))throw new Wn(L(5004));if(Array.isArray(l.values)&&!l.values.includes(d))throw new Wn(L(5005));let{properties:B}=l;Dc(B)&&od(d)&&Object.keys(B).forEach(Z=>{aS.call(this,{rule:B[Z],value:d&&d[Z],key:"".concat(Z),fnName:C,className:A})});let{arrayItem:U}=l;Dc(U)&&Gi(d)&&d.forEach((Z,ae)=>{aS.call(this,{rule:U,value:Z,key:"".concat(g,"[").concat(ae,"]"),fnName:C,className:A})}),Er(l.validate)&&l.validate.call(this,d,g,C,A,this)}function Mr(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{getRemoteId:l=()=>"",replaceArg:d,getKVReportKey:g}=r;return Tr((C,A)=>function(){for(var L=arguments.length,B=new Array(L),U=0;U<L;U++)B[U]=arguments[U];function Z(we,Pe,Ze){if(Ze&&Ze.includes(we))return"hided";if(d){let Ct=d(...B);if(B[Ct.argIndex]===Pe)return Ct.value}if(Pe===B||we in B)return Pe;try{return Pe instanceof HTMLElement?"id: ".concat(Pe.id," type:").concat(ya(Pe)):(JSON.stringify(Pe),Pe)}catch{return"type:".concat(ya(Pe))}}let ae=this._log||pn;B.length>0?ae.info("".concat(A,"() ").concat(JSON.stringify(B,(we,Pe)=>Z(we,Pe,["userSig","privateMapKey"])))):ae.info("".concat(A,"()"));let ce=g?g(...B):sV[A];try{let we=C.apply(this,B),Pe=xo();return dR(we)?we.then(Ze=>(ae.info("".concat(A,"() success ").concat(l.call(this,...B))),Lo.addSuccessEvent({key:ce,cost:xo()-Pe}),Ze)).catch(Ze=>{throw Ze=Wn.convertFrom.call(this,Ze,A,B.length===1?B[0]:B),ae.error("".concat(A,"() failed ").concat(l.call(this,...B)," ").concat(Ze," params: ").concat(JSON.stringify(B,Z))),Lo.addFailedEvent({key:ce,error:Ze}),Ze}):(Lo.addSuccessEvent({key:ce}),we)}catch(we){throw we=Wn.convertFrom.call(this,we,A),ae.error("".concat(A,"() failed ").concat(we," params: ").concat(JSON.stringify(B,Z))),Lo.addFailedEvent({key:ce,error:we}),we}})}var qR=r=>Tr((l,d)=>function(g,C){return at(this,null,function*(){let A=this._plugins.get(g);if(!A)throw this._log.error("plugin ".concat(String(g)," is not found")),new Wn({code:no.OPERATION_ABORT,message:"plugin ".concat(String(g)," is not found"),fnName:d});return $R.call(this,A.getValidateRule(r),[C],d,"TRTC"),l.call(this,A,C)})}),KR=0,qre=class{constructor(r,l){Se(this,"player"),Se(this,"publisher"),Se(this,"mixInput"),this.mixInput=new hV(l),r.url?(this.player=new Audio(r.url),this.player.crossOrigin="anonymous",this.publisher=new Audio(r.url),this.publisher.crossOrigin="anonymous",this.mixInput.replaceSource(this.publisher)):this.mixInput.replaceSource(r.track),r.loop&&(this.loop=r.loop),r.volume&&(this.volume=r.volume),this.mixInput.connect()}reset(){this.seek(0),this.mixInput.connect()}seek(r){!this.player||r<0&&r>this.player.duration||(this.player.currentTime=r,this.publisher.currentTime=r)}play(){var r,l;return(r=this.publisher)==null||r.play(),(l=this.player)==null?void 0:l.play()}pause(){var r,l;(r=this.player)==null||r.pause(),(l=this.publisher)==null||l.pause()}stop(){var r;(r=this.player)==null||r.pause(),this.mixInput.disconnect()}setOperation(r){r==="pause"&&this.pause(),r==="resume"&&(this.pause(),this.play()),r==="stop"&&(this.pause(),this.seek(0))}set volume(r){!this.player||!this.publisher||(this.player.volume=r,this.publisher.volume=r)}set loop(r){!this.player||!this.publisher||(this.player.loop=r,this.publisher.loop=r)}},vy=class{constructor(r){this.core=r,Se(this,"log"),Se(this,"mixedMusicMap",new Map),Se(this,"cacheMusicMap",new Map),KR+=1,this.log=r.log.createChild({id:"".concat(this.getAlias()).concat(KR)}),this.log.info("[audioMixer] created id=".concat(this.getAlias()).concat(KR)),this.core=r}getName(){return vy.Name}getAlias(){return"ax"}getGroup(r){return r==null?void 0:r.id}getValidateRule(r){switch(r){case"start":return vy.startValidateRule;case"update":return vy.updateValidateRule;case"stop":return vy.stopValidateRule}}start(r){return at(this,null,function*(){let{room:l}=this.core;this.log.info("add music source, id: ".concat(r.id," url: ").concat(r.url,", track: ").concat(r.track));let{id:d,url:g}=r;if(this.mixedMusicMap.has(d))return;let C=this.cacheMusicMap.get(d);C?r.url?C.reset():(C.mixInput.replaceSource(r.track),C.mixInput.connect()):(C=new qre(r,l.audioManager),this.cacheMusicMap.set(d,C)),yield C.play(),this.mixedMusicMap.set(d,C),this.log.info("start mix audio track ".concat(d," success.")),Lo.addEnum({key:502700,value:3})})}update(r){return at(this,null,function*(){let{id:l,volume:d,loop:g,operation:C,seekFrom:A}=r;this.log.info("update music source, ".concat(JSON.stringify(r)));let L=this.mixedMusicMap.get(l);L?(Ft(d)||(L.volume=d),Ft(g)||(L.loop=g),Ft(C)||L.setOperation(C),Ft(A)||L.seek(A)):this.log.warn("update music source failed, music id: ".concat(l," not found."))})}stop(r){return at(this,arguments,function(l){var d=this;let{id:g}=l;return function*(){var C;d.mixedMusicMap.has(g)&&(d.log.info("remove music source, music id: ".concat(g)),(C=d.mixedMusicMap.get(g))==null||C.stop(),d.mixedMusicMap.delete(g)),g==="*"&&d.destroyAllMusic()}()})}destroyAllMusic(){this.log.info("destroy all music source."),this.mixedMusicMap.forEach((r,l)=>this.stop({id:l}))}destroyAllCache(){this.log.info("destroy all music cache."),this.cacheMusicMap.clear()}destroy(){this.log.info("destroy audio mixer plugin."),this.destroyAllMusic(),this.destroyAllCache()}},_y=vy;Se(_y,"startValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},url:{type:"string",required:!1},track:{required:!1},loop:{type:"boolean"},volume:{type:"number"}},validate(r,l,d){if(r.url&&r.url!=="*"){let g=r.url.split("?")[0],C=["mp3","ogg","wav","flac"],A=g.split(".").pop(),L=C.indexOf(A)>=0,B=g.startsWith("blob"),U=g.startsWith("data");if(!(L||B||U))throw new Wn({code:no.INVALID_PARAMETER,message:"start audioMixer plugin: music url is invalid, please check your file format.",fnName:d})}if(!r.url&&!r.track)throw new Wn({code:no.INVALID_PARAMETER,message:"start audioMixer plugin: param url or track is required.",fnName:d})}}),Se(_y,"updateValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},loop:{type:"boolean"},volume:{type:"number"},seekFrom:{type:"number"},operation:{type:"string",values:["pause","resume","stop"]}}}),Se(_y,"stopValidateRule",{name:"options",type:"object",required:!0,properties:{id:{type:"string",required:!0}}}),Se(_y,"Name","AudioMixer");var Kre=r=>(r=Number(r))>0&&r<14e8,zR=0,yy=class{constructor(r){this.core=r,Se(this,"log"),Se(this,"workletReady"),Se(this,"audioContext",id()),Se(this,"workletNode"),zR+=1,this.log=r.log.createChild({id:"".concat(this.getAlias()).concat(zR)}),this.log.info("[audioDenoiser] created id=".concat(this.getAlias()).concat(zR)),r.assetsPath&&(this.workletReady=YC(this.audioContext,"".concat(r.assetsPath,"/denoiser-wasm.js")),this.workletReady.catch(l=>{this.log.error("Init assets from ".concat(r.assetsPath," failed! Reason: ").concat(l))}))}static startValidateRule(r){return{name:"options",required:!0,type:"object",properties:{sdkAppId:{type:"number",required:!0},userId:{type:"string",required:!0},userSig:{type:"string",required:!0}},validate(l,d,g,C){if(!r.room.audioManager.hasAudioTrack)throw new Wn({code:no.INVALID_OPERATION,extraCode:5106,fnName:g})}}}getName(){return yy.Name}getAlias(){return"ad"}getGroup(){return"AIDenoiser_".concat(Date.now())}getValidateRule(r){switch(r){case"start":return yy.startValidateRule(this.core);case"update":return yy.updateValidateRule;case"stop":return yy.stopValidateRule}}start(r){return at(this,null,function*(){let{room:l}=this.core;if(this.workletReady||(this.workletReady=YC(this.audioContext,"".concat(r.assetsPath,"/denoiser-wasm.js")),this.workletReady.catch(d=>{this.log.error("Init assets from ".concat(r.assetsPath," failed! Reason: ").concat(d))})),!this.workletNode){let d=String(Date.now()).slice(0,-3),{auth:g,sign:C,status:A,message:L}=yield function(B){return at(this,arguments,function(U){let{sdkAppId:Z,userId:ae,userSig:ce,timestamp:we}=U;return function*(){let Pe="https://".concat(function(Hn){let Zo;return Zo=Kre(Hn)?UV.MAIN_OVERSEA:UV.MAIN,Zo}(Z),"/api/v1/audioAiAuth?sdkAppId=").concat(Z,"&userId=").concat(ae,"&userSig=").concat(ce,"&timestamp=").concat(we),Ze=yield fetch(Pe),{data:{errCode:Ct,errMsg:Bt,sign:Wt,status:kt}}=yield Ze.json();if(kt==="1")return{auth:!0,sign:Wt,status:kt,message:Bt};let En="Init RTCAIDenoiser failed.",Ln="";switch(Ct){case 1:Ln="Please check your params.";break;case 2:Ln="You need to buy packages. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 3:Ln="Server is invalid. Please contact our engineer. ";break;case 4:Ln="Your packages is not active. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 5:Ln="Your packages is expired. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 6:Ln="Your version is not supported."}return{auth:!1,status:kt,message:Bt?"".concat(En," Reason: ").concat(Bt,". ").concat(Ln):"".concat(En,", ").concat(Ln)}}()})}(Io(Fn({},r),{timestamp:d}));if(!g)throw this.log.info("RTCAIDenoiser: ".concat(r.userId," auth result: ").concat(g,". Message: ").concat(L)),new Wn({code:no.INVALID_PARAMETER,message:L});yield this.workletReady,this.workletNode=new AudioWorkletNode(this.audioContext,"trtc-denoiser-processor",{numberOfInputs:1,numberOfOutputs:1}),this.workletNode.port.postMessage({type:"init",data:{sdkAppId:String(r.sdkAppId),userId:r.userId,timestamp:d,sign:C,status:A}}),this.workletNode.port.onmessage=B=>{let{data:U}=B;U.type==="cost"&&this.log.debug("[RTCAIDenoiser] ".concat(U.value))}}this.workletNode.port.postMessage({type:"enable"}),l.audioManager.addDenoiser(this.workletNode),l.sendAbilityStatus({ai_denoise:1})})}update(){return at(this,null,function*(){})}stop(){return at(this,null,function*(){if(!this.workletNode)return;let{room:r}=this.core;this.workletNode.port.postMessage({type:"disable"}),yield r.audioManager.removeDenoiser(this.workletNode)})}destroy(){}},sS=yy;Se(sS,"updateValidateRule",{type:"object"}),Se(sS,"stopValidateRule",{type:"object"}),Se(sS,"Name","AIDenoiser");var UV={MAIN:"schedule.cloud-rtc.com",MAIN_OVERSEA:"schedule.rtc.tencentcloud.com"},FV=0,WR=new Set,$i=null;V4("5.6.1");var zre={RtcError:Wn,ErrorCode:no,ErrorCodeDictionary:eS},lS=class extends Zne.EventEmitter{constructor(r,l){super(),Se(this,"_room"),Se(this,"_eventListened",new Set),Se(this,"_localVideoTrack",null),Se(this,"_localAudioTrack",null),Se(this,"_localScreenTrack",null),Se(this,"_localScreenAudioTrack",null),Se(this,"_localVideoConfig",null),Se(this,"_localScreenConfig",null),Se(this,"_localAudioConfig",null),Se(this,"_remoteVideoConfigMap",new Map),Se(this,"_remoteAudioConfigMap",new Map),Se(this,"_remoteAudioMuteMap",new Map),Se(this,"_mediaTrackMap",new WeakMap),Se(this,"_log",pn.createLogger({id:"t".concat(++FV)})),Se(this,"_plugins",new Map),Se(this,"_networkQuality",null),Se(this,"_speakerId"),this._room=new r(Fn({logger:this._log,frameWorkType:lS.frameWorkType},l)),this._log.debug(JSON.stringify(l)),Object.defineProperties(this,{dumpAudio:{enumerable:!1,value(d){return this._room.audioManager.dump(d)}}}),l.plugins&&l.plugins.forEach(d=>{this._use(d,l.assetsPath)}),this._use(_y,l.assetsPath),this._use(sS,l.assetsPath),this._room.on("audio-volume",d=>{!d.find(g=>g.userId==="")&&this._localAudioTrack&&d.push({userId:"",volume:Math.floor(100*this._localAudioTrack.getAudioLevel())}),this.emit(ro.AUDIO_VOLUME,{result:d.sort((g,C)=>C.volume-g.volume)})}),this._room.videoManager.on("error",d=>{let{reason:g,error:C}=d;this._log.error(new Wn({code:no.OPERATION_FAILED,extraCode:5504,messageParams:{reason:g,error:C}}))}),this._listenEvents(),this._initActiveSpeaker(),((d,g)=>{let{emit:C}=d;d.emit=function(){for(var A=arguments.length,L=new Array(A),B=0;B<A;B++)L[B]=arguments[B];try{return C.apply(d,L)}catch(U){let Z=so({key:to.CATCH_HANDLER_ERROR,data:{name:g,event:L[0]},addDocLink:!1});return pn.warn("".concat(Z,`

`).concat(U.stack)),!1}}})(this,"trtc")}static create(r){}static _create(r,l){var d;RV&&(RV=!1,pn.getLogLevel()!==5&&(console.info("******************************************************************************"),console.info("*   TRTC Web SDK"),console.info("*   API Document: ".concat(tf,"/en/index.html")),console.info("*   Changelog: ".concat(tf,"/en/tutorial-01-info-changelog.html")),console.info("*   Report issues: https://github.com/LiteAVSDK/TRTC_Web/issues"),console.info("******************************************************************************")),pn.info("TRTC Web SDK Version:",Ol),pn.info("UA:",navigator.userAgent),pn.info("URL: ".concat(location.href).concat(((d=self.frameElement)==null?void 0:d.tagName)==="IFRAME"?" in iframe":"")),aR().then(C=>{if(C){let A="UAData: ".concat(C.platform,"/").concat(C.platformVersion);C.architecture&&C.bitness&&(A+=" ".concat(C.architecture,"/").concat(C.bitness)),C.mobile&&(A+=" mobile"),C.model&&(A+=" model: ".concat(C.model)),C.fullVersionList&&(A+=" ".concat(C.fullVersionList.filter(L=>L.brand!=="Not/A)Brand").map(L=>"".concat(L.brand,"/").concat(L.version)).join(","))),pn.info(A)}}));let g=new lS(r,l||{});return WR.add(g),g}_listenEvents(){Ul(this,this._room).add("peer-join",r=>{let{userId:l}=r;this.emit(ro.REMOTE_USER_ENTER,{userId:l})}).add("peer-leave",r=>{this.emit(ro.REMOTE_USER_EXIT,{userId:r})}).add("banned",r=>{this._exitRoom().then(()=>{this.emit(ro.KICKED_OUT,{reason:r.reason})})}).add("error",r=>{this._exitRoom().then(()=>{this.emit(ro.ERROR,Wn.convertFrom(r))})}).add("signal-connection-state-changed",r=>{this.emit(ro.CONNECTION_STATE_CHANGED,r)}).add("network-quality",r=>{this._networkQuality=r,this.emit(ro.NETWORK_QUALITY,r)}).add("remote-published",r=>{[r.remoteAudioTrack,r.remoteVideoTrack,r.remoteAuxiliaryTrack].forEach(l=>{Ul(l,l).add("player-state-changed",d=>{let g=Io(Fn({},d),{userId:r.userId});l.kind===Be.VIDEO&&(g.streamType=rS(l.streamType)),this.emit(l.kind===Be.AUDIO?ro.AUDIO_PLAY_STATE_CHANGED:ro.VIDEO_PLAY_STATE_CHANGED,g)}).add("error",d=>{d.getCode()===an.PLAY_NOT_ALLOWED&&this.emit(ro.AUTOPLAY_FAILED,{userId:l.userId})})})}).add("remote-unpublished",r=>{[r.remoteAudioTrack,r.remoteVideoTrack,r.remoteAuxiliaryTrack].forEach(l=>{Ia(l)})}).add("remote-publish-state-changed",r=>{let{prevMuteState:l,muteState:d}=r,{userId:g}=d,C=l.audioAvailable,A=l.videoAvailable,{audioAvailable:L,videoAvailable:B}=d;L||this._remoteAudioConfigMap.delete(g),B||this._remoteVideoConfigMap.delete("".concat(g,"_","main")),d.hasAuxiliary||this._remoteVideoConfigMap.delete("".concat(g,"_","sub")),C!==L&&(this.emit(L?ro.REMOTE_AUDIO_AVAILABLE:ro.REMOTE_AUDIO_UNAVAILABLE,{userId:g}),L?this._onAudioAvailable({userId:g}):this._onAudioUnavailable({userId:g,muteState:d})),A!==B&&(this.emit(B?ro.REMOTE_VIDEO_AVAILABLE:ro.REMOTE_VIDEO_UNAVAILABLE,{userId:g,streamType:"main"}),B?this._onVideoAvailable({userId:g,streamType:"main"}):this._onVideoUnavailable({userId:g,streamType:"main"})),l.hasAuxiliary!==d.hasAuxiliary&&(this.emit(d.hasAuxiliary?ro.REMOTE_VIDEO_AVAILABLE:ro.REMOTE_VIDEO_UNAVAILABLE,{userId:g,streamType:"sub"}),d.hasAuxiliary?this._onVideoAvailable({userId:g,streamType:"sub"}):this._onVideoUnavailable({userId:g,streamType:"sub"}))}).add("firewall-restriction",()=>{this.emit(ro.ERROR,new Wn({code:no.OPERATION_FAILED,extraCode:5501}))}).add("sei-message",r=>{this.emit(ro.SEI_MESSAGE,Io(Fn({},r),{streamType:rS(r.streamType)}))}).add("heartbeat-report",r=>{var l,d,g,C,A,L,B;let U={2:"big",3:"small",7:"sub"},Z={rtt:r.msg_up_stream_info.msg_network_status.uint32_rtt||((l=r.msg_down_stream_info[0])==null?void 0:l.msg_network_status.uint32_rtt)||((d=this._networkQuality)==null?void 0:d.uplinkRTT)||((g=this._networkQuality)==null?void 0:g.downlinkRTT)||0,upLoss:((C=this._networkQuality)==null?void 0:C.uplinkLoss)||0,downLoss:((A=this._networkQuality)==null?void 0:A.downlinkLoss)||0,bytesSent:r.bytes_sent||0,bytesReceived:r.bytes_received||0,localStatistics:{audio:{bitrate:(((L=r.msg_up_stream_info.msg_audio_status)==null?void 0:L.uint32_audio_codec_bitrate)||0)/1e3,audioLevel:(((B=r.msg_up_stream_info.msg_audio_status)==null?void 0:B.uint32_audio_level)||0)/Zu},video:r.msg_up_stream_info.msg_video_status.filter(ae=>U[ae.uint32_video_stream_type]).map(ae=>({bitrate:(ae.uint32_video_codec_bitrate||0)/1e3,width:ae.uint32_video_width,height:ae.uint32_video_height,frameRate:ae.uint32_video_enc_fps,videoType:U[ae.uint32_video_stream_type]}))},remoteStatistics:r.msg_down_stream_info.map(ae=>({userId:ae.msg_user_info.str_identifier,audio:{bitrate:(ae.msg_audio_status.uint32_audio_codec_bitrate||0)/1e3,audioLevel:(ae.msg_audio_status.uint32_audio_level||0)/Zu},video:ae.msg_video_status.map(ce=>({bitrate:(ce.uint32_video_codec_bitrate||0)/1e3,width:ce.uint32_video_width,height:ce.uint32_video_height,frameRate:ce.uint32_video_dec_fps,videoType:U[ce.uint32_video_stream_type]}))}))};this.emit(ro.STATISTICS,Z)}).add("custom-message",r=>{this.emit(ro.CUSTOM_MESSAGE,r)}),Ul(this,Hi).add("audioInputAdded",r=>{this.emit(ro.DEVICE_CHANGED,{type:"microphone",action:"add",device:r})}).add("audioInputRemoved",r=>{this.emit(ro.DEVICE_CHANGED,{type:"microphone",action:"remove",device:r})}).add("videoInputAdded",r=>{this.emit(ro.DEVICE_CHANGED,{type:"camera",action:"add",device:r})}).add("videoInputRemoved",r=>{this.emit(ro.DEVICE_CHANGED,{type:"camera",action:"remove",device:r})}).add("audioOutputAdded",r=>at(this,null,function*(){if(this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"add",device:r}),$i&&$i.deviceId===CC){let l=(yield Jm()).find(d=>d.deviceId===CC);l&&$i.groupId!==l.groupId&&($i=l,this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"active",device:l}))}})).add("audioOutputRemoved",r=>at(this,null,function*(){this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"remove",device:r});let l=(yield Jm())[0];l&&$i&&($i.deviceId===r.deviceId||$i.deviceId===CC&&$i.groupId!==l.groupId)&&($i=l,this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"active",device:l}))}))}use(r){let l,d;"plugin"in r?(l=r.plugin,d=r.assetsPath):l=r,this._use(l,d||"https://web.sdk.qcloud.com/trtc/webrtc/v5/assets/")}_use(r,l){if(this._plugins.get(r.Name))return void this._log.warn("duplicate install plugin",r.Name);let d=new r(function(g,C,A){return{room:g,assetsPath:A,innerEmitter:en,constants:F4,environment:iF,utils:Dl,eventLogger:li,log:g.getLogger(),errorModule:C,kvStatManager:Lo,clearStarted(L,B){let U=L.getAlias(),Z=gy.instances.get(g);if(Z)if(B){let ae=Z.get(U+B);if(!ae)return;ae.started=!1}else Z.forEach((ae,ce)=>{ce.startsWith(U)&&(ae.started=!1)})}}}(this._room,zre,l));this._plugins.set(r.Name,d)}enterRoom(r){return at(this,null,function*(){var l,d;let{scene:g="rtc",enableAutoPlayDialog:C=!0,autoReceiveAudio:A=!0,autoReceiveVideo:L=!1}=r;r.proxy&&(this._room.setProxyServer(r.proxy),!rr(r.proxy)&&r.proxy.turnServer&&((d=(l=this._room).setTurnServer)==null||d.call(l,r.proxy.turnServer,r.proxy.iceTransportPolicy))),this._room.enableAutoPlayDialog=C,this._room.autoReceiveAudio=A,this._room.autoReceiveVideo=L,za(r.enableHWEncoder)&&(this._room.enableHWEncoder=r.enableHWEncoder);let B={sdkAppId:r.sdkAppId,userId:r.userId,userSig:r.userSig,privateMapKey:r.privateMapKey||null,role:r.role==="audience"?21:20,roomId:r.roomId||0,strRoomId:r.strRoomId||"",businessInfo:r.businessInfo||null,streamId:null,userDefineRecordId:r.userDefineRecordId||null,frameWorkType:r.frameWorkType,component:r.component,language:r.language};r.strRoomId&&!r.roomId?this._room.useStringRoomId=!0:this._room.useStringRoomId=!1,yield this._room.join(B,g,lS.frameWorkType),this._checkTrackToPublish()})}exitRoom(){return at(this,null,function*(){return yield this._exitRoom()})}switchRole(r,l){return at(this,null,function*(){l!=null&&l.privateMapKey&&(this._room.privateMapKey=l.privateMapKey),yield this._room.switchRole(r),r==="anchor"&&this._checkTrackToPublish()})}destroy(){Ia(this),this.removeAllListeners(),this._room.destroy(),WR.delete(this),this._localAudioTrack&&this.stopLocalAudio(),this._localVideoTrack&&this.stopLocalVideo(),this._localScreenTrack&&this.stopScreenShare(),this._plugins.forEach(r=>{var l;return(l=r.destroy)==null?void 0:l.call(r)})}startLocalAudio(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0};return function*(){if(r._localAudioTrack)return void r._log.warn("local audio is already started");let{publish:d=!0,mute:g,option:C}=l,A=new xc(r._room.audioManager),L={},B={muted:!0};C&&(Ft(C.microphoneId)?Ft(C.audioTrack)||(L.customSource=C.audioTrack):L.deviceId=C.microphoneId,C&&Ti(C.captureVolume)&&A.setCaptureVolume(C.captureVolume),Ft(C.profile)||(rr(C.profile)?Rw[C.profile]&&A.setProfile(Rw[C.profile]):A.setProfile(C.profile)),Ti(C.earMonitorVolume)&&(B.muted=!(C.earMonitorVolume>0),B.volume=C.earMonitorVolume),Ft(C.echoCancellation)||(A.profile.echoCancellation=C.echoCancellation),Ft(C.noiseSuppression)||(A.profile.noiseSuppression=C.noiseSuppression),Ft(C.autoGainControl)||(A.profile.autoGainControl=C.autoGainControl)),A.on("5",U=>{r.emit(ro.ERROR,new Wn({code:no.DEVICE_ERROR,extraCode:5309,messageParams:{error:U}}))}),A.on("2",U=>{r.emit(ro.DEVICE_CHANGED,{type:"microphone",action:"active",device:U})}),A.on("4",U=>{let Z;U.error&&(Z=Wn.convertFrom(U.error)),r.emit(ro.PUBLISH_STATE_CHANGED,Io(Fn({},U),{error:Z}))}),r._listenOutputTrackChanged(A),r._speakerId&&A.setAudioOutput(r._speakerId),yield A.capture(L),Ft(g)||A.setMute(g),Ul(A,A).add("player-state-changed",U=>{r.emit(ro.AUDIO_PLAY_STATE_CHANGED,Io(Fn({},U),{userId:""}))}),d&&r._room.isJoined&&r._room.publish(A).catch(()=>{}),r._localAudioTrack=A,r._localAudioConfig=Io(Fn({},l),{publish:d}),yield r._updateAudioPlayOption({playOption:B,track:A})}()})}updateLocalAudio(r){return at(this,null,function*(){if(!this._localAudioTrack||!this._localAudioConfig)return;let{publish:l,mute:d,option:g}=r,C={};g&&(g.microphoneId?yield this._localAudioTrack.switchDevice(g.microphoneId):Ft(g.audioTrack)||(yield this._localAudioTrack.setInputMediaStreamTrack(g.audioTrack)),Ft(g.captureVolume)||this._localAudioTrack.setCaptureVolume(g.captureVolume),Ft(g.earMonitorVolume)||(C.muted=!(g.earMonitorVolume>0),C.volume=g.earMonitorVolume),yield this._localAudioTrack.update3A(g)),this._room.isJoined&&!Ft(l)&&(l&&!this._localAudioConfig.publish&&this._room.publish(this._localAudioTrack).catch(()=>{}),this._localAudioConfig.publish&&!l&&this._room.unpublish(this._localAudioTrack).catch(()=>{})),Ft(d)||this._localAudioTrack.setMute(d),yield this._updateAudioPlayOption({playOption:C,track:this._localAudioTrack,prevConfig:this._localAudioConfig}),cf(this._localAudioConfig,r)})}stopLocalAudio(){return at(this,null,function*(){!this._localAudioTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localAudioTrack).catch(()=>{})),this._localAudioTrack.stop(),this._localAudioTrack.close(),this._room.audioManager.removeInput(this._localAudioTrack),Ia(this._localAudioTrack),this._localAudioTrack=null,this._localAudioConfig=null)})}startLocalVideo(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(r._localVideoTrack)return void r._log.warn("local video is already started");let{view:d,publish:g=!0,mute:C,option:A}=l,L=new Wa(r._room.videoManager),B={},U={};if(A&&(A.cameraId?B.deviceId=A.cameraId:Ft(A.useFrontCamera)?Ft(A.videoTrack)||(B.customSource=A.videoTrack):B.facingMode=A.useFrontCamera?Be.FACING_MODE_USER:Be.FACING_MODE_ENVIRONMENT,Ft(A.profile)||(rr(A.profile)?Ll[A.profile]&&L.setProfile(Ll[A.profile]):L.setProfile(A.profile)),Ft(A.fillMode)||(U.objectFit=A.fillMode),Ft(A.mirror)||(U.mirror=A.mirror),Ft(A.small)||(HC()?rr(A.small)?L.small=Ll[A.small]:A.small===!0?L.small=Ll["120p"]:L.small=A.small:r._log.warn("small stream is not supported"))),L.on("5",Z=>{r.emit(ro.ERROR,new Wn({code:no.DEVICE_ERROR,extraCode:5308,messageParams:{error:Z}}))}),L.on("2",Z=>{r.emit(ro.DEVICE_CHANGED,{type:"camera",action:"active",device:Z})}),L.on("4",Z=>{let ae;Z.error&&(ae=Wn.convertFrom(Z.error)),r.emit(ro.PUBLISH_STATE_CHANGED,Io(Fn({},Z),{error:ae}))}),r._listenOutputTrackChanged(L),yield L.capture(B),Ft(C)||(yield L.setMute(C)),L.mediaTrack)if(A!=null&&A.qosPreference){let Z=tg(A.qosPreference);L.mediaTrack.contentHint=Z}else A!=null&&A.videoTrack||(L.mediaTrack.contentHint=tg(Fc.QOS_PREFERENCE_SMOOTH));Ul(L,L).add("player-state-changed",Z=>{r.emit(ro.VIDEO_PLAY_STATE_CHANGED,Io(Fn({},Z),{userId:"",streamType:"main"}))}),g&&r._room.isJoined&&r._room.publish(L).catch(()=>{}),r._localVideoTrack=L,r._localVideoConfig=Io(Fn({},l),{view:d,publish:g}),yield r._updateVideoPlayOption({view:d,playOption:U,track:L})}()})}updateLocalVideo(r){return at(this,null,function*(){if(!this._localVideoTrack||!this._localVideoConfig)return;let{view:l,publish:d,mute:g,option:C}=r,A={};if(C){if(Ft(C.profile)||(rr(C.profile)?Ll[C.profile]&&this._localVideoTrack.setProfile(Ll[C.profile]):this._localVideoTrack.setProfile(C.profile),(!C.cameraId||!this._localVideoTrack.isNeedToSwitchDevice(C.cameraId))&&Ft(C.useFrontCamera)&&this._localVideoTrack.applyProfile()),C.cameraId?yield this._localVideoTrack.switchDevice(C.cameraId):Ft(C.useFrontCamera)?Ft(C.videoTrack)||(yield this._localVideoTrack.setInputMediaStreamTrack(C.videoTrack)):yield this._localVideoTrack.switchDevice(C.useFrontCamera?Be.FACING_MODE_USER:Be.FACING_MODE_ENVIRONMENT),Ft(C.fillMode)||(A.objectFit=C.fillMode),Ft(C.mirror)||(A.mirror=C.mirror),C.qosPreference&&this._localVideoTrack.mediaTrack){let L=tg(C.qosPreference);this._localVideoTrack.mediaTrack.contentHint=L}if(C.small){let L=!this._localVideoTrack.small;HC()?(C.small===!0?this._localVideoTrack.small=Ll["120p"]:rr(C.small)?this._localVideoTrack.small=Ll[C.small]:this._localVideoTrack.small=C.small,this._room.videoManager.update(),L&&this._room.enableSmall(!0)):this._log.warn("small stream is not supported")}else C.small===!1&&this._localVideoTrack.small&&(delete this._localVideoTrack.small,this._room.videoManager.update(),this._room.enableSmall(!1))}this._room.isJoined&&!Ft(d)&&(d&&!this._localVideoConfig.publish&&this._room.publish(this._localVideoTrack).catch(()=>{}),this._localVideoConfig.publish&&!d&&this._room.unpublish(this._localVideoTrack).catch(()=>{})),Ft(g)||(yield this._localVideoTrack.setMute(g)),yield this._updateVideoPlayOption({view:l,playOption:A,track:this._localVideoTrack,prevConfig:this._localVideoConfig}),cf(this._localVideoConfig,r)})}stopLocalVideo(){return at(this,null,function*(){!this._localVideoTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localVideoTrack).catch(()=>{})),this._localVideoTrack.stop(),this._localVideoTrack.close(),Ia(this._localVideoTrack),this._localVideoTrack=null,this._localVideoConfig=null)})}startScreenShare(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(r._localScreenTrack)return void r._log.warn("screen share is already started");let{view:d=null,publish:g=!0,option:C}=l,A=new ff(r._room.videoManager);A.on("4",ae=>{let ce;ae.error&&(ce=Wn.convertFrom(ae.error)),r.emit(ro.PUBLISH_STATE_CHANGED,Io(Fn({},ae),{error:ce}))}),r._listenOutputTrackChanged(A);let L=null,B={},U={};C&&(Ft(C.profile)||(rr(C.profile)?Aw[C.profile]&&A.setProfile(Aw[C.profile]):A.setProfile(C.profile)),C.systemAudio&&(B.systemAudio=!0,B.echoCancellation=C.echoCancellation,B.noiseSuppression=C.noiseSuppression,B.autoGainControl=C.autoGainControl),Ft(C.fillMode)||(U.objectFit=C.fillMode),C.videoTrack&&(B.videoTrack=C.videoTrack),C.audioTrack&&(B.audioTrack=C.audioTrack),C.captureElement&&(B.captureElement=C.captureElement),C.preferDisplaySurface&&(B.preferDisplaySurface=C.preferDisplaySurface));let Z=yield A.capture(B);if(C!=null&&C.qosPreference){let ae=tg(C.qosPreference);A.mediaTrack.contentHint=ae}else C!=null&&C.videoTrack||(A.mediaTrack.contentHint=tg(Fc.QOS_PREFERENCE_CLEAR));if(A.mediaTrack.addEventListener(Be.ENDED,()=>{r._stopScreenShare(),r.emit(ro.SCREEN_SHARE_STOPPED)}),Z.getAudioTracks()[0]&&(L=new cy(r._room.audioManager),L.setInputMediaStreamTrack(Z.getAudioTracks()[0]),r._speakerId&&L.setAudioOutput(r._speakerId)),Ul(A,A).add("player-state-changed",ae=>{r.emit(ro.VIDEO_PLAY_STATE_CHANGED,Io(Fn({},ae),{userId:"",streamType:"sub"}))}),g&&r._room.isJoined){let ae=[A];L&&ae.push(L),r._room.publish(...ae).catch(()=>{})}r._localScreenTrack=A,r._localScreenAudioTrack=L,r._localScreenConfig=Io(Fn({},l),{view:d,publish:g}),yield r._updateVideoPlayOption({view:d,playOption:U,track:A})}()})}updateScreenShare(r){return at(this,null,function*(){if(!this._localScreenTrack||!this._localScreenConfig)return;let{view:l,publish:d,option:g}=r,C={};if(g&&(Ft(g.fillMode)||(C.objectFit=g.fillMode),g.qosPreference)){let A=tg(g.qosPreference);this._localScreenTrack.mediaTrack.contentHint=A}this._room.isJoined&&!Ft(d)&&(d&&!this._localScreenConfig.publish&&(this._room.publish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.publish(this._localScreenAudioTrack).catch(()=>{})),this._localScreenConfig.publish&&!d&&(this._room.unpublish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.unpublish(this._localScreenAudioTrack).catch(()=>{}))),yield this._updateVideoPlayOption({view:l,playOption:C,track:this._localScreenTrack,prevConfig:this._localScreenConfig}),cf(this._localScreenConfig,r)})}stopScreenShare(){return at(this,null,function*(){return yield this._stopScreenShare()})}startRemoteVideo(r){return at(this,null,function*(){let{view:l,userId:d,streamType:g,option:C}=r,A="".concat(d,"_").concat(g);if(this._remoteVideoConfigMap.has(A))return void this._log.warn("remote video has already started. userId:".concat(d,", streamType:").concat(g));let L=this._room.remotePublishedUserMap.get(d);if(!L)return;let B={},U=g==="main"?L.remoteVideoTrack:L.remoteAuxiliaryTrack;this._listenOutputTrackChanged(U),C&&(Ft(C.fillMode)||(B.objectFit=C.fillMode),Ft(C.mirror)||(B.mirror=C.mirror),g==="main"&&!Ft(C.small)&&(L.remoteVideoTrack.setMediaType(C.small?8:4),this._room.changeType(C.small,U.user))),yield this._room.subscribe(U),yield this._updateVideoPlayOption({view:l,playOption:B,track:U}),this._emitTrackEvent(U),this._remoteVideoConfigMap.set(A,{config:r}),C&&!Ft(C.receiveWhenViewVisible)&&this._observeView({remoteTrack:U,view:l,receiveWhenViewVisible:C.receiveWhenViewVisible,viewRoot:C==null?void 0:C.viewRoot})})}updateRemoteVideo(r){return at(this,null,function*(){var l,d;let{view:g,userId:C,streamType:A,option:L}=r,B="".concat(C,"_").concat(A),U=this._remoteVideoConfigMap.get(B);if(!U||!this._room.remotePublishedUserMap.has(C))return;let Z={};L&&(Ft(L.fillMode)||(Z.objectFit=L.fillMode),Ft(L.mirror)||(Z.mirror=L.mirror));let ae=null,ce=this._room.remotePublishedUserMap.get(C);if(A==="main"&&(ce!=null&&ce.muteState.hasVideo)&&(ae=ce.remoteVideoTrack),A==="sub"&&(ce!=null&&ce.muteState.hasAuxiliary)&&(ae=ce.remoteAuxiliaryTrack),!ae)return;let{config:we}=U;A==="main"&&L&&!Ft(L.small)&&this._room.changeType(L.small,ae.user),yield this._updateVideoPlayOption({view:g,playOption:Z,track:ae,prevConfig:we}),cf(we,r);let Pe=Ft(L==null?void 0:L.receiveWhenViewVisible)?(l=we.option)==null?void 0:l.receiveWhenViewVisible:L.receiveWhenViewVisible,Ze=Ft(g)?we.view:g,Ct=Ft(L==null?void 0:L.viewRoot)?(d=we.option)==null?void 0:d.viewRoot:L.viewRoot;this._observeView({remoteTrack:ae,view:Ze,receiveWhenViewVisible:Pe,viewRoot:Ct})})}stopRemoteVideo(r){return at(this,null,function*(){return this._stopRemoteVideo(r)})}_stopRemoteVideo(r){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return at(this,null,function*(){let d=[],g=this._room.remotePublishedUserMap.get(r.userId);if(g){let{muteState:A,remoteVideoTrack:L,remoteAuxiliaryTrack:B}=g;r.streamType==="main"&&(L.stop(),A.hasVideo&&d.push(L)),r.streamType==="sub"&&(B.stop(),A.hasAuxiliary&&d.push(B))}for(let A of d)l&&(yield this._room.unsubscribe(A),this._mediaTrackMap.get(A.outMediaTrack)===A.userId&&this._mediaTrackMap.delete(A.outMediaTrack));let C=this._remoteVideoConfigMap.get("".concat(r.userId,"_").concat(r.streamType));C&&C.observer&&C.observer.disconnect(),this._remoteVideoConfigMap.delete("".concat(r.userId,"_").concat(r.streamType))})}muteRemoteAudio(r,l){return at(this,null,function*(){if(r==="*")if(l)yield this._stopRemoteAudio({userId:r});else{let d=[...this._room.remotePublishedUserMap.values()];for(let g of d)g.muteState.hasAudio&&(yield this._startRemoteAudio({userId:g.userId}))}else l?yield this._stopRemoteAudio({userId:r}):yield this._startRemoteAudio({userId:r});this._remoteAudioMuteMap.set(r,l)})}setRemoteAudioVolume(r,l){if(r==="*"){let d=[...this._room.remotePublishedUserMap.values()];for(let g of d)this._updateAudioPlayOption({playOption:{volume:l},track:g.remoteAudioTrack})}else if(r){let d=this._room.remotePublishedUserMap.get(r);d&&this._updateAudioPlayOption({playOption:{volume:l},track:d.remoteAudioTrack})}}startPlugin(r,l){return at(this,null,function*(){return r.start(l)})}updatePlugin(r,l){return at(this,null,function*(){return r.update(l)})}stopPlugin(r,l){return at(this,null,function*(){return r.stop(l)})}enableAudioVolumeEvaluation(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._room.enableAudioVolumeEvaluation(r,l)}on(r,l,d){return this.listeners(r).includes(l)||(super.on(r,l,d),this._eventListened.add(r)),this}off(r,l,d){return r==="*"?(this._eventListened.clear(),this.removeAllListeners()):super.off(r,l,d),this}getAudioTrack(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"};var l,d;let g,C="main";if(rr(r)?g=r:(g=r.userId,r.streamType&&(C=r.streamType)),!g)return C==="sub"?((l=this._localScreenAudioTrack)==null?void 0:l.mediaTrack)||null:((d=this._localAudioTrack)==null?void 0:d.mediaTrack)||null;{let A=this._room.remotePublishedUserMap.get(g);if(A)return A.remoteAudioTrack.mediaTrack}return null}getVideoTrack(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"},{userId:l="",streamType:d="main"}=r;if(l===""){if(d==="main"&&this._localVideoTrack)return this._localVideoTrack.mediaTrack;if(d==="sub"&&this._localScreenTrack)return this._localScreenTrack.mediaTrack}else{let g=this._room.remotePublishedUserMap.get(l);if(g)return d==="main"?g.remoteVideoTrack.mediaTrack:g.remoteAuxiliaryTrack.mediaTrack}return null}getVideoSnapshot(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{userId:l,streamType:d="main"}=r;if(l){let g=this._room.remotePublishedUserMap.get(l);if(d==="main"&&(g!=null&&g.muteState.hasVideo))return g.remoteVideoTrack.getVideoFrame();if(d==="sub"&&(g!=null&&g.muteState.hasAuxiliary))return g.remoteAuxiliaryTrack.getVideoFrame()}else{if(d==="main"&&this._localVideoTrack)return this._localVideoTrack.getVideoFrame();if(d==="sub"&&this._localScreenTrack)return this._localScreenTrack.getVideoFrame()}return""}setCurrentSpeaker(r){var l,d;this._speakerId=r,(l=this._localAudioTrack)==null||l.setAudioOutput(r),(d=this._localScreenAudioTrack)==null||d.setAudioOutput(r),this._room.remotePublishedUserMap.forEach(g=>g.remoteAudioTrack.setAudioOutput(r))}_startRemoteAudio(r){return this._doStartRemoteAudio(r)}_doStartRemoteAudio(r){return at(this,null,function*(){let{userId:l,option:d}=r;if(this._remoteAudioConfigMap.has(l))return void this._log.warn("remote audio has already started. userId:".concat(l));let g=this._room.remotePublishedUserMap.get(l);if(!g)return;let C={};d&&(Ft(d.volume)||(C.volume=d.volume));let A=g.remoteAudioTrack;this._listenOutputTrackChanged(A),this._speakerId&&A.setAudioOutput(this._speakerId);try{this._remoteAudioConfigMap.set(l,r),yield this._room.subscribe(A),yield this._updateAudioPlayOption({playOption:C,track:A})}catch(L){throw this._remoteAudioConfigMap.delete(l),L}this._emitTrackEvent(A)})}_stopRemoteAudio(r){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return at(this,null,function*(){let d=this._room.remotePublishedUserMap.get(r.userId);d&&(d.remoteAudioTrack.stop(),d.muteState.hasAudio&&l&&(yield this._room.unsubscribe(d.remoteAudioTrack)),this._mediaTrackMap.get(d.remoteAudioTrack.outMediaTrack)===r.userId&&this._mediaTrackMap.delete(d.remoteAudioTrack.outMediaTrack)),this._remoteAudioConfigMap.delete("".concat(r.userId))})}_updateVideoPlayOption(r){return at(this,arguments,function(l){let{view:d,playOption:g,track:C,prevConfig:A}=l;return function*(){if(C.setMirror(g.mirror),Ft(d)&&A&&A.view&&!LF(g)){let L=VC(A.view);L.length>0&&(yield C.play(L,g))}if(!Ft(d)){let L=VC(d);L.length>0?yield C.play(L,g):C.stop()}}()})}_updateAudioPlayOption(r){return at(this,arguments,function(l){let{playOption:d={},track:g,prevConfig:C}=l;return function*(){if(!g.isPlayCalled)try{yield g.play(null,d)}catch{}Ft(d.muted)||g.setPlayerMute(d.muted),Ft(d.volume)||g.setAudioVolume(d.volume/100)}()})}_listenOutputTrackChanged(r){r.listeners("output-media-track-changed").length===0&&r.on("output-media-track-changed",()=>this._emitTrackEvent(r))}_emitTrackEvent(r){let l=r.isRemote?r.userId:"";r.outMediaTrack&&this._mediaTrackMap.get(r.outMediaTrack)!==l&&(this._mediaTrackMap.set(r.outMediaTrack,l),this.emit(ro.TRACK,{userId:l,streamType:rS(r.streamType),track:r.outMediaTrack}))}_checkTrackToPublish(){var r,l,d;let g=[];if((r=this._localAudioConfig)!=null&&r.publish&&this._localAudioTrack&&g.push(this._localAudioTrack),(l=this._localVideoConfig)!=null&&l.publish&&this._localVideoTrack&&g.push(this._localVideoTrack),(d=this._localScreenConfig)!=null&&d.publish&&(this._localScreenTrack&&g.push(this._localScreenTrack),this._localScreenAudioTrack&&g.push(this._localScreenAudioTrack)),g.length!==0)return this._room.publish(...g).catch(()=>{})}_observeView(r){let{remoteTrack:l,view:d,receiveWhenViewVisible:g=!1,viewRoot:C}=r;if(Ft(d))return;let A=this._remoteVideoConfigMap.get("".concat(l.userId,"_").concat(rS(l.streamType)));if(!A)return;let L=A.observer||void 0;if(d===null||Gi(d)&&d.length===0||!g)return L==null||L.disconnect(),void(l.isSubscribed||this._room.subscribe(l).catch(()=>{}));let B=A.visibleViewMap||new Map,U=-1;(!L||L.root!==C)&&(L==null||L.disconnect(),B.clear(),L=new IntersectionObserver(ae=>{ae.forEach(ce=>{B.set(ce.target,ce.isIntersecting)}),clearTimeout(U),U=window.setTimeout(()=>{[...B.values()].find(ce=>ce)?l.isSubscribed||this._room.subscribe(l).catch(()=>{}):l.isSubscribed&&this._room.unsubscribe(l).catch(()=>{})},200)},{root:C}));let Z=new Set(VC(d));B.forEach((ae,ce)=>{Z.has(ce)||(L.unobserve(ce),B.delete(ce))}),Z.forEach(ae=>{B.set(ae,!0),L.observe(ae)}),L.takeRecords().forEach(ae=>{B.set(ae.target,ae.isIntersecting)}),A.visibleViewMap=B,A.observer=L}_exitRoom(){return at(this,null,function*(){this._room.isJoined&&(yield this._room.leave()),new Set([...this._remoteAudioConfigMap.keys(),...this._remoteAudioMuteMap.keys()]).forEach(r=>{this._stopRemoteAudio({userId:r}).catch()}),[...this._remoteVideoConfigMap.keys()].forEach(r=>{let l=r.includes("main")?"main":"sub",d=r.split("_".concat(l))[0];d&&this._stopRemoteVideo({userId:d,streamType:l}).catch()}),this._remoteVideoConfigMap.clear(),this._remoteAudioConfigMap.clear(),this._remoteAudioMuteMap.clear(),this._room.remotePublishedUserMap.forEach(r=>{Ia(r.remoteAudioTrack),Ia(r.remoteVideoTrack),Ia(r.remoteAuxiliaryTrack)})})}_stopScreenShare(){return at(this,null,function*(){var r;if(this._localScreenTrack){if(this._room.isJoined){let l=[this._localScreenTrack];this._localScreenAudioTrack&&l.push(this._localScreenAudioTrack),yield(r=this._room)==null?void 0:r.unpublish(...l).catch(()=>{})}this._localScreenTrack.stop(),this._localScreenTrack.close(),this._localScreenAudioTrack&&(this._localScreenAudioTrack.stop(),this._localScreenAudioTrack.close(),this._room.audioManager.removeInput(this._localScreenAudioTrack),this._localScreenAudioTrack=null),Ia(this._localScreenTrack),this._localScreenTrack=null,this._localScreenConfig=null}})}_initActiveSpeaker(){return at(this,null,function*(){if($i&&!ay($i))this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"active",device:$i});else{let r=yield Jm();if(r[0]&&!ay(r[0]))$i=r[0],this.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"active",device:r[0]});else{let l=d=>{let{track:g}=d;g.kind==="audio"&&(!$i||ay($i))&&(this._initActiveSpeaker(),en.off("102",this._initActiveSpeaker))};en.on("102",l)}}})}_onAudioAvailable(r){let{userId:l}=r,d=this._remoteAudioMuteMap.has(l)?this._remoteAudioMuteMap.get(l):this._remoteAudioMuteMap.get("*");(d===!1||this._room.autoReceiveAudio&&!d)&&this._doStartRemoteAudio({userId:l}).catch(()=>{})}_onVideoAvailable(r){let{userId:l,streamType:d}=r;if(!this._room.autoReceiveVideo)return;let g=this._room.remotePublishedUserMap.get(l);if(g){let C=d==="main"?g.remoteVideoTrack:g.remoteAuxiliaryTrack;this._room.subscribe(C).then(()=>{this._emitTrackEvent(C)}).catch(()=>{})}}_onAudioUnavailable(r){let{userId:l,muteState:d}=r;d.hasAudio&&d.audioMuted||this._stopRemoteAudio({userId:l},!1).catch(()=>{})}_onVideoUnavailable(r){let{userId:l,streamType:d}=r;this._stopRemoteVideo({userId:l,streamType:d},!1).catch(()=>{})}sendSEIMessage(r,l){this._room.sendSEI(r,l||{seiPayloadType:243})}sendCustomMessage(r){var l,d;(d=(l=this._room).sendCustomMessage)==null||d.call(l,r)}static setLogLevel(r,l){pn.setLogLevel(r),Ft(l)||(l?pn.enableUploadLog():pn.disableUploadLog())}static isSupported(){return IR()}static getCameraList(){return ad(!0)}static getMicrophoneList(){return Pc(!0)}static getSpeakerList(){return Jm(!0)}static setCurrentSpeaker(r){return at(this,null,function*(){(yield Jm()).forEach(l=>{l.deviceId===r&&(WR.forEach(d=>{d.setCurrentSpeaker(r),d.emit(ro.DEVICE_CHANGED,{type:"speaker",action:"active",device:l})}),$i=l)})})}static _addKVStat(r){let{type:l,key:d,value:g,base:C,useUV:A,version:L}=r;switch(L&&(iy.version=L),l){case"count":iy.addCount({key:d,useUV:A});break;case"enum":iy.addEnum({key:d,value:g,useUV:A});break;case"number":iy.addNumber({key:d,value:g,split:C})}}},mo=lS;Se(mo,"_loggerManager",pn),Se(mo,"EVENT",ro),Se(mo,"ERROR_CODE",no),Se(mo,"TYPE",Fc),Se(mo,"frameWorkType",30),In([Mr({replaceArg:r=>({argIndex:0,value:{name:"plugin"in r?r.plugin.Name:r.Name,assetsPath:"assetsPath"in r?r==null?void 0:r.assetsPath:"default"}})})],mo.prototype,"use"),In([na(Mi.TRTC.enterRoom),mf("room",(r,l)=>{let[d]=r,[g]=l;return(d.roomId||d.strRoomId)===(g.roomId||g.strRoomId)&&d.userId===g.userId&&d.sdkAppId===g.sdkAppId}),Tr(r=>function(l){return this._log.setUserId(l.userId),this._log.setSdkAppId(l.sdkAppId),r.call(this,l)}),Mr()],mo.prototype,"enterRoom"),In([Mr()],mo.prototype,"exitRoom"),In([na(Mi.TRTC.switchRole),eg("room",{merge:(r,l)=>l}),Mr()],mo.prototype,"switchRole"),In([Mr()],mo.prototype,"destroy"),In([na(Mi.TRTC.startLocalAudio),mf("audio",(r,l)=>{let[d]=r,[g]=l;var C,A;return((C=d==null?void 0:d.option)==null?void 0:C.microphoneId)===((A=g==null?void 0:g.option)==null?void 0:A.microphoneId)}),Mr()],mo.prototype,"startLocalAudio"),In([na(Mi.TRTC.updateLocalAudio),eg("audio",{debounce:{delay:200,getKey:()=>"".concat(FV,"-localAudio"),isNeedToDebounce:r=>{var l;return!Ft((l=r.option)==null?void 0:l.captureVolume)}}}),Mr()],mo.prototype,"updateLocalAudio"),In([gf("audio"),Mr()],mo.prototype,"stopLocalAudio"),In([na(Mi.TRTC.startLocalVideo),mf("video",(r,l)=>{let[d]=r,[g]=l;var C,A;return((C=d==null?void 0:d.option)==null?void 0:C.cameraId)===((A=g==null?void 0:g.option)==null?void 0:A.cameraId)}),Mr()],mo.prototype,"startLocalVideo"),In([na(Mi.TRTC.updateLocalVideo),eg("video"),Mr()],mo.prototype,"updateLocalVideo"),In([gf("video"),Mr()],mo.prototype,"stopLocalVideo"),In([na(Mi.TRTC.startScreenShare),mf("screen",()=>!0),Mr()],mo.prototype,"startScreenShare"),In([na(Mi.TRTC.updateScreenShare),eg("screen"),Mr()],mo.prototype,"updateScreenShare"),In([Mr()],mo.prototype,"stopScreenShare"),In([na(Mi.TRTC.startRemoteVideo),mf(r=>"v".concat(r.userId).concat(r.streamType),()=>!0),Mr({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],mo.prototype,"startRemoteVideo"),In([na(Mi.TRTC.updateRemoteVideo),eg(r=>"v".concat(r.userId).concat(r.streamType)),Mr({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],mo.prototype,"updateRemoteVideo"),In([na(Mi.TRTC.stopRemoteVideo),Tr(r=>function(l){return at(this,null,function*(){if(l.userId==="*"){let d=[];return this._room.remotePublishedUserMap.forEach(g=>{this._remoteVideoConfigMap.has("".concat(g.userId,"_","main"))&&d.push(this.stopRemoteVideo({streamType:"main",userId:g.userId}).catch(()=>{})),this._remoteVideoConfigMap.has("".concat(g.userId,"_","sub"))&&d.push(this.stopRemoteVideo({streamType:"sub",userId:g.userId}).catch(()=>{}))}),Promise.all(d)}return r.call(this,l)})}),Mr({getRemoteId:r=>"".concat(r.userId,"_").concat(r.streamType)})],mo.prototype,"stopRemoteVideo"),In([gf(r=>"v".concat(r.userId).concat(r.streamType))],mo.prototype,"_stopRemoteVideo"),In([na(...Mi.TRTC.muteRemoteAudio),Mr({getRemoteId:r=>r})],mo.prototype,"muteRemoteAudio"),In([xV(...Mi.TRTC.setRemoteAudioVolume),function(r,l){return Tr((d,g)=>function(){for(var C=arguments.length,A=new Array(C),L=0;L<C;L++)A[L]=arguments[L];var B,U;let Z=(B=iS.get(this))==null?void 0:B.get(l(...A));Z&&Z>0&&clearTimeout(Z);let ae=window.setTimeout(()=>{d.apply(this,A)},r);iS.has(this)?(U=iS.get(this))==null||U.set(l(...A),ae):iS.set(this,new Map([[l(...A),ae]]))})}(200,r=>r),Mr({getRemoteId:r=>r})],mo.prototype,"setRemoteAudioVolume"),In([qR("start"),mf((r,l)=>r.getAlias()+r.getGroup(l)),Mr({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>lV[r.getName()]})],mo.prototype,"startPlugin"),In([qR("update"),eg((r,l)=>r.getAlias()+r.getGroup(l)),Mr({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>cV[r.getName()]})],mo.prototype,"updatePlugin"),In([qR("stop"),gf((r,l)=>r.getAlias()+r.getGroup(l)),Mr({replaceArg:r=>({argIndex:0,value:r.getName()}),getKVReportKey:r=>uV[r.getName()]})],mo.prototype,"stopPlugin"),In([xV(...Mi.TRTC.enableAudioVolumeEvaluation)],mo.prototype,"enableAudioVolumeEvaluation"),In([Mr()],mo.prototype,"getVideoSnapshot"),In([Mr()],mo.prototype,"setCurrentSpeaker"),In([mf(r=>"a".concat(r.userId),()=>!0)],mo.prototype,"_startRemoteAudio"),In([Tr(r=>function(l){return at(this,null,function*(){return l.userId==="*"?Promise.all([...this._room.remotePublishedUserMap.values()].map(d=>this._stopRemoteAudio(Io(Fn({},l),{userId:d.userId})).catch(()=>{}))):r.call(this,l)})}),gf(r=>"a".concat(r.userId))],mo.prototype,"_stopRemoteAudio"),In([gf("room")],mo.prototype,"_exitRoom"),In([gf("screen")],mo.prototype,"_stopScreenShare"),In([na(...Mi.TRTC.sendSEIMessage),wV({timesInSecond:30,maxSizeInSecond:8e3,getSize:function(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return l[0].byteLength}})],mo.prototype,"sendSEIMessage"),In([na(Mi.TRTC.sendCustomMessage),wV({timesInSecond:30,maxSizeInSecond:8e3,getSize:r=>r.data.byteLength})],mo.prototype,"sendCustomMessage"),In([na(Mi.TRTC.create)],mo,"_create");var cS=mo,Wre=class{constructor(){this._set=new Set,en.on($t.LEAVE_SUCCESS,this.delete,this)}add(r){let{room:l,roomId:d}=r;if(l.scene==="rtc")return;let g=this.getKey(l.userId,d||l.roomId,l.sdkAppId,l.useStringRoomId);this._set.add(g)}delete(r){let{room:l,roomId:d}=r;if(l.scene==="rtc")return;let g=this.getKey(l.userId,l.roomId||d,l.sdkAppId,l.useStringRoomId);this._set.delete(g)}getKey(r,l,d,g){return"".concat(d,"_").concat(l,"_").concat(r,"_").concat(g)}isJoined(r){let{userId:l,roomId:d,sdkAppId:g,room:C}=r;return C.scene!=="rtc"&&this._set.has(this.getKey(l,d,g,C.useStringRoomId))}};function jre(){return at(this,null,function*(){let r,l;try{let ce=yield Pc();r=ce&&ce.length}catch{}try{let ce=yield ad();l=ce&&ce.length}catch{}let d={microphone:r,camera:l},{isH264EncodeSupported:g,isVp8EncodeSupported:C,isH264DecodeSupported:A,isVp8DecodeSupported:L}=this.checkSystemResult.detail,B=Z_.basis(),U={webRTC:B.isWebRTCSupported,getUserMedia:B.isGetUserMediaSupported,webSocket:B.isWebSocketsSupported,screenShare:B.isScreenShareSupported,webAudio:B.isWebAudioSupported,h264Encode:g,h264Decode:A,vp8Encode:C,vp8Decode:L},Z={browser:B.browser,os:B.os,trtc:U,devices:d},ae={isWebCodecSupported:B.isWebCodecSupported,isMediaSessionSupported:B.isMediaSessionSupported,isWebTransportSupported:B.isWebTransportSupported};li.uploadEvent({log:"trtcstats-".concat(JSON.stringify(Z)),userId:this.userId}),this._log.info("TrtcStats-".concat(JSON.stringify(Z))),li.uploadEvent({log:"trtcadvancedstats-".concat(JSON.stringify(ae)),userId:this.userId})})}var Yre=Vi(qa(),1),VV=Symbol("instance"),jR=Symbol("cacheResult"),uS=class{constructor(r,l,d){this.oldState=r,this.newState=l,this.action=d,this.aborted=!1}abort(r){this.aborted=!0,by.call(r,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},YR=class extends Error{constructor(r,l,d){super(l),this.state=r,this.message=l,this.cause=d}},Iy=new Map;function GV(r,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(g,C,A)=>{let L=d.action||C;if(!d.context){let U=Iy.get(g)||[];Iy.has(g)||Iy.set(g,U),U.push({from:r,to:l,action:L})}let B=A.value;A.value=function(){let U=this;for(var Z=arguments.length,ae=new Array(Z),ce=0;ce<Z;ce++)ae[ce]=arguments[ce];if(d.context&&(U=Pr.get(typeof d.context=="function"?d.context.call(this,...ae):d.context)),U.state===l)return U[jR];U.state instanceof uS&&U.state.action==d.abortAction&&U.state.abort(U);let we=null;if(Array.isArray(r)?r.length==0?U.state instanceof uS&&U.state.abort(U):(typeof U.state!="string"||!r.includes(U.state))&&(we=new YR(U._state,"".concat(U.name," ").concat(L," to ").concat(l," failed: current state ").concat(U._state," not in from config"))):r!==U.state&&(we=new YR(U._state,"".concat(U.name," ").concat(L," to ").concat(l," failed: current state ").concat(U._state," not from ").concat(r))),we){if(!d.fail){if(d.ignoreError)return we;throw we}d.fail.call(this,we)}let Pe=U.state,Ze=new uS(Pe,l,L);by.call(U,Ze);let Ct=Wt=>{var kt;return U[jR]=Wt,Ze.aborted||(by.call(U,l),(kt=d.success)===null||kt===void 0||kt.call(this,U[jR])),Wt},Bt=Wt=>{let kt=Wt instanceof Error?Wt.message:String(Wt);if(by.call(U,Pe,Wt),!d.fail){if(d.ignoreError)return Wt;throw Wt}d.fail.call(this,new YR(U._state,"action '".concat(L,"' failed :").concat(kt),Wt instanceof Error?Wt:new Error(kt)))};try{let Wt=B.apply(this,ae);return function(kt){return typeof kt=="object"&&kt&&"then"in kt}(Wt)?Wt.then(Ct).catch(Bt):Ct(Wt)}catch(Wt){Bt(Wt)}}}}var Jre=typeof window<"u"&&window.__AFSM__?(r,l)=>{window.dispatchEvent(new CustomEvent(r,{detail:l}))}:typeof importScripts<"u"?(r,l)=>{postMessage({type:r,payload:l})}:()=>{};function by(r,l){let d=this._state;this._state=r;let g=r.toString();r&&this.emit(g,d),this.emit(Pr.STATECHANGED,r,d,l),this.updateDevTools({value:r,old:d,err:l instanceof Error?l.message:String(l)})}var Pr=class extends Yre.default{constructor(r,l,d){super(),this.name=r,this.groupName=l,this._state=Pr.INIT,r||(r=Date.now().toString(36)),d?Object.setPrototypeOf(this,d):d=Object.getPrototypeOf(this),l||(this.groupName=this.constructor.name);let g=d[VV];g?this.name=g.name+"-"+g.count++:d[VV]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let r=Object.getPrototypeOf(this),l=Iy.get(r)||[],d=new Set,g=[],C=[],A=new Set,L=Object.getPrototypeOf(r);Iy.has(L)&&(L.stateDiagram.forEach(U=>d.add(U)),L.allStates.forEach(U=>A.add(U))),l.forEach(U=>{let{from:Z,to:ae,action:ce}=U;typeof Z=="string"?g.push({from:Z,to:ae,action:ce}):Z.length?Z.forEach(we=>{g.push({from:we,to:ae,action:ce})}):C.push({to:ae,action:ce})}),g.forEach(U=>{let{from:Z,to:ae,action:ce}=U;A.add(Z),A.add(ae),A.add(ce+"ing"),d.add("".concat(Z," --> ").concat(ce,"ing : ").concat(ce)),d.add("".concat(ce,"ing --> ").concat(ae," : ").concat(ce," 🟢")),d.add("".concat(ce,"ing --> ").concat(Z," : ").concat(ce," 🔴"))}),C.forEach(U=>{let{to:Z,action:ae}=U;d.add("".concat(ae,"ing --> ").concat(Z," : ").concat(ae," 🟢")),A.forEach(ce=>{ce!==Z&&d.add("".concat(ce," --> ").concat(ae,"ing : ").concat(ae))})});let B=[...d];return Object.defineProperties(r,{stateDiagram:{value:B},allStates:{value:A}}),B}static get(r){let l;return typeof r=="string"?(l=Pr.instances.get(r),l||Pr.instances.set(r,l=new Pr(r,void 0,Object.create(Pr.prototype)))):(l=Pr.instances2.get(r),l||Pr.instances2.set(r,l=new Pr(r.constructor.name,void 0,Object.create(Pr.prototype)))),l}static getState(r){var l;return(l=Pr.get(r))===null||l===void 0?void 0:l.state}updateDevTools(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jre(Pr.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},r))}get state(){return this._state}set state(r){by.call(this,r)}};Pr.STATECHANGED="stateChanged",Pr.UPDATEAFSM="updateAFSM",Pr.INIT="[*]",Pr.ON="on",Pr.OFF="off",Pr.instances=new Map,Pr.instances2=new WeakMap;var Xre=Vi(qa()),BV="1",HV="5",JR="2",ng="3",Zre="5",Qre="4",Fl={CLIENT_BANNED:9,CHANNEL_SETUP_RESULT:19,CHANNEL_RECONNECT_RESULT:514,JOIN_ROOM_RESULT:20,PEER_JOIN:4134,PEER_LEAVE:4135,STREAM_ADDED:16,STREAM_REMOVED:18,UPLINK_NETWORK_STATS:22,UPDATE_REMOTE_MUTE_STAT:23,PUBLISH_RESULT:4098,PUBLISH_STATE_CHANGE_RESULT:4112,UNPUBLISH_RESULT:4100,SUBSCRIBE_RESULT:4102,UNSUBSCRIBE_RESULT:4104,SUBSCRIBE_CHANGE_RESULT:4106,MUTE_RESULT:4108,UPDATE_OFFER_RESULT:4128,START_PUBLISH_TENCENT_CDN_RES:1286,STOP_PUBLISH_TENCENT_CDN_RES:1288,START_PUBLISH_GIVEN_CDN_RES:777,STOP_PUBLISH_GIVEN_CDN_RES:779,START_MIX_TRANSCODE_RES:781,STOP_MIX_TRANSCODE_RES:783,USER_LIST_RES:4137,SWITCH_ROLE_RES:4110,UPDATE_CONSTRAINT_CONFIG_RES:772,REBUILD_PEER_CONNECTION_RES:4150,SPC_PUBLISH_RESULT:4146,SPC_SUBSCRIBE_RESULT:4156,ABILITY_STATUS_REPORT_RESULT:4158,SERVER_FIRST_PACKAGE_RECEIVED:5e3,RECEIVE_CUSTOM_MSG:4140},eie=[Fl.UPDATE_REMOTE_MUTE_STAT,Fl.UPLINK_NETWORK_STATS,Fl.USER_LIST_RES,Fl.MUTE_RESULT,Fl.SERVER_FIRST_PACKAGE_RECEIVED,Fl.RECEIVE_CUSTOM_MSG],go={CLIENT_BANNED:"client-banned",CHANNEL_SETUP_RESULT:"channel-setup-result",CHANNEL_RECONNECT_RESULT:"channel-reconnect-result",JOIN_ROOM_RESULT:"join-room-result",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",UPLINK_NETWORK_STATS:"uplink-network-stats",UPDATE_REMOTE_MUTE_STAT:"update-remote-mute-stat",PUBLISH_RESULT:"publish-result",PUBLISH_STATE_CHANGE_RESULT:"publish-state-change-result",UNPUBLISH_RESULT:"unpublish-result",SUBSCRIBE_RESULT:"subscribe-result",SUBSCRIBE_CHANGE_RESULT:"subscribe-change-result",UNSUBSCRIBE_RESULT:"unsubscribe-result",UPDATE_OFFER_RESULT:"update-offer-result",START_PUBLISH_TENCENT_CDN_RES:"start-publish-tencent-cdn-res",STOP_PUBLISH_TENCENT_CDN_RES:"stop-publish-tencent-cdn-res",START_PUBLISH_GIVEN_CDN_RES:"start-publish-given-cdn-res",STOP_PUBLISH_GIVEN_CDN_RES:"stop-publish-given-cdn-res",START_MIX_TRANSCODE_RES:"start-mix-transcode-res",STOP_MIX_TRANSCODE_RES:"stop-mix-transcode-res",USER_LIST_RES:"user-list-res",SWITCH_ROLE_RES:"switch_role_res",MUTE_RESULT:"mute-result",UPDATE_CONSTRAINT_CONFIG_RES:"update-contraint-config-res",REBUILD_PEER_CONNECTION_RES:"rebuild-pc-res",SPC_PUBLISH_RESULT:"spc-publish-result",SPC_SUBSCRIBE_RESULT:"spc-subscribe-result",ABILITY_STATUS_REPORT_RESULT:"ability-status-report",SERVER_FIRST_PACKAGE_RECEIVED:"first-pkg-received",RECEIVE_CUSTOM_MSG:"receive-custom-msg"},tie="publish_change",nie="join",oie="leave",rie="quality_report",$V="mute_uplink",iie="publish",qV="publish_state_change",XR="unpublish",aie="subscribe",KV="unsubscribe",zV="subscribe_change",sie="start_publishing",lie="stop_publishing",cie="start_push_user_cdn",uie="stop_push_user_cdn",die="start_mcu_mix",hie="stop_mcu_mix",fie="get_user_list",pie="change_role",WV="update_constraint_config",mie="rebuild_pc",gie="join/v2",vie="publish/v2",_ie="subscribe/v3",yie="ability_status_report",Iie="reconnect",bie="channel_msg",Vc=new WeakMap;function Cy(r){let{settings:l={retries:5,timeout:2e3},onError:d,onRetrying:g,onRetryFailed:C}=r;return function(A,L,B){let U=z_({retryFunction:B.value,settings:l,onError(Z){let{error:ae,retry:ce,reject:we,retryFuncArgs:Pe}=Z;d&&d.call(this,ae,()=>{var Ze;(Ze=Vc.get(A))!=null&&Ze.has(L)?ce():we(ae)},we,Pe)},onRetrying(Z,ae){var ce;Er(g)&&g.call(this,Z,ae),(ce=Vc.get(A))!=null&&ce.has(L)&&(Vc.get(A).get(L).stopRetry=ae)},onRetryFailed:C});return B.value=function(){let Z=Vc.get(A);for(var ae=arguments.length,ce=new Array(ae),we=0;we<ae;we++)ce[we]=arguments[we];return Z?Z.set(L,{args:ce}):Vc.set(A,new Map([[L,{args:ce}]])),U.apply(this,ce).finally(()=>{var Pe;return(Pe=Vc.get(A))==null?void 0:Pe.delete(L)})},B}}function dS(r){let{fnName:l,callback:d,validateArgs:g=!0}=r;return function(C,A,L){let B=L.value;return L.value=function(){for(var U,Z,ae=arguments.length,ce=new Array(ae),we=0;we<ae;we++)ce[we]=arguments[we];if((U=Vc.get(C))!=null&&U.has(l)){let{stopRetry:Pe,args:Ze}=Vc.get(C).get(l),Ct=!0;if(g){for(let Bt of Ze)if(!ce.find(Wt=>Wt===Bt)){Ct=!1;break}}Ct&&(d&&d.apply(this,ce),Pe&&Pe(),(Z=Vc.get(C))==null||Z.delete(l))}return B.apply(this,ce)},L}}var hS=new Set,jV=class extends Xre.default{constructor(r){var l,d;super(),Se(this,"room"),Se(this,"url"),Se(this,"backupUrl"),Se(this,"race"),Se(this,"destroyed",!1),Se(this,"_socketInUse"),Se(this,"_socket"),Se(this,"_backupSocket"),Se(this,"_signalInfo",{tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0}),Se(this,"_currentState","DISCONNECTED"),Se(this,"_isReconnecting",!1),Se(this,"_seq",0),Se(this,"_log"),Se(this,"_lastMessageTime",-1),Se(this,"_connnectStartTime",-1),Se(this,"_stopConnectRetry"),Se(this,"bytesSent",0),Se(this,"bytesReceived",0),Se(this,"keepAlive",!1),this.room=r.room,this.race=!!Ft(r.race)||r.race,(((d=(l=this.room.scheduleResult)==null?void 0:l.config)==null?void 0:d.keepAliveClient)||0)-hS.size>0&&this.room.enableSPC&&(this.keepAlive=!0,hS.add(this)),this.url=r.url,this.backupUrl=r.backupUrl,this._seq=0,this._log=pn.createLogger({id:"ws",userId:this.userId,sdkAppId:this.sdkAppId}),this.onmessage=this.onmessage.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this)}get urlParam(){let r="?sdkAppId=".concat(encodeURIComponent(this.sdkAppId),"&userId=").concat(encodeURIComponent(this.userId),"&userSig=").concat(encodeURIComponent(this.userSig),"&keepAlive=").concat(encodeURIComponent(Number(this.keepAlive)));return this.race?"".concat(r,"&race=1"):r}get _urlWithParam(){return"".concat(this.url).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get _backupUrlWithParam(){return"".concat(this.backupUrl).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get isConnected(){return this._currentState==="CONNECTED"}get isConnecting(){return this._currentState==="CONNECTING"}get sdkAppId(){return this.room.sdkAppId}get userId(){return this.room.userId}get userSig(){return this.room.userSig}get isOnline(){return this._currentState==="CONNECTED"&&Date.now()-this._lastMessageTime<12e3}connect(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1e4;return function*(){if(r.isConnected)return Promise.resolve();r._log.info("connect to [".concat(r.url,", ").concat(r.backupUrl,"]").concat(l?" timeout: ".concat(l):""," keepAlive: ").concat(Number(r.keepAlive))),r.emitConnectionStateChanged("CONNECTING"),r._connnectStartTime=xo();let d=[r.connectWS({url:r._urlWithParam,isMain:!0,timeout:l})];r.race&&r._backupUrlWithParam!==r._urlWithParam&&d.push(r.connectWS({url:r._backupUrlWithParam,isMain:!1,timeout:l})),r._socketInUse=yield fR(d),r.unbindAndCloseSocket(r._socketInUse===r._socket?Be.BACKUP:Be.MAIN),r.emitConnectionStateChanged("CONNECTED")}()})}connectWS(r){let{url:l,timeout:d,isMain:g}=r,C=new WebSocket(l);this.bindSocket(C),g?this._socket=C:this._backupSocket=C;let A=-1;return new Promise((L,B)=>{C.onclose=B,C.onerror=B,C.onopen=()=>L(C),d&&(A=setTimeout(()=>{this.unbindAndCloseSocket(g?Be.MAIN:Be.BACKUP),B(new Rn({code:an.SIGNAL_CHANNEL_SETUP_FAILED,message:"ws connect timeout"}))},d))}).finally(()=>{C.onclose=null,C.onerror=null,C.onopen=null,clearTimeout(A)})}bindSocket(r){r.addEventListener("close",this.onclose),r.addEventListener("error",this.onerror),r.addEventListener("message",this.onmessage)}unbindSocket(r){r.removeEventListener("close",this.onclose),r.removeEventListener("error",this.onerror),r.removeEventListener("message",this.onmessage)}unbindAndCloseSocket(r){if(r===Be.MAIN){if(this._socket){this.unbindSocket(this._socket);try{this._socket.close(1e3)}catch{}this._socket=null}}else if(this._backupSocket){this.unbindSocket(this._backupSocket);try{this._backupSocket.close(1e3)}catch{}this._backupSocket=null}}onclose(r){if(r.target===this._socketInUse&&(this._log.warn("".concat(r.target===this._socket?"main":"backup"," is closed code:").concat(r.code," ").concat(r.reason)),this.emitConnectionStateChanged("DISCONNECTED"),!r.wasClean||r.code!==1e3)){this._socketInUse.onclose=null,this._socketInUse.close(4011);let l=this._socketInUse===this._socket;this.unbindAndCloseSocket(l?Be.MAIN:Be.BACKUP),this._socketInUse=null,this.reconnect()}}onerror(r){this._log.error("".concat(r.target===this._socket?"main":"backup"," error observed")),r.target===this._socketInUse&&(this.unbindAndCloseSocket(Be.MAIN),this.unbindAndCloseSocket(Be.BACKUP),this._socketInUse=null,this.reconnect())}onmessage(r){if(!this.isConnected)return;this._lastMessageTime=Date.now(),this.bytesReceived+=pR(r.data);let l=JSON.parse(r.data),{cmd:d,data:g}=l,C=Object.values(Fl),A=Object.keys(Fl)[C.indexOf(d)],L=go[A];switch(eie.includes(d)||(this._log.debug("received ".concat(d," msg: ").concat(r.data)),L&&this._log.info("Received event: [ ".concat(L," ]"))),d){case Fl.CHANNEL_SETUP_RESULT:if(l.code===0)this._signalInfo.clientIp=g.clientIp,this._signalInfo.signalIp=g.signalInnerIp,g.svrTime&&function(B){bw=B-new Date().getTime();let U=new Date;U.setTime(B),pn.info("baseTime from server: ".concat(U," offset: ").concat(bw))}(g.svrTime),this._log.info("ChannelSetup Success"),Lo.addSuccessEvent({key:521701,cost:xo()-this._connnectStartTime}),this._connnectStartTime=-1,this.emit(BV,{signalInfo:this._signalInfo});else{let B=new Rn({code:an.SIGNAL_CHANNEL_SETUP_FAILED,extraCode:l.code,message:so({key:to.SIGNAL_CHANNEL_SETUP_FAILED,data:{errorCode:l.code,errorMsg:l.message}})});this._log.error("".concat(l.code,", ").concat(l.message)),this.close(),Lo.addFailedEvent({key:521701,error:B}),this.emit(HV,B)}break;case Fl.JOIN_ROOM_RESULT:l.code===0&&(this._signalInfo.relayIp=g.relayOuterIp,this._signalInfo.relayInnerIp=g.relayInnerIp,this._signalInfo.relayPort=g.relayPort,this._signalInfo.tinyId=l.tinyId,this._log.info("signalIp:".concat(this._signalInfo.signalIp," clientIp:").concat(this._signalInfo.clientIp," relayIp: ").concat(this._signalInfo.relayIp))),this.emit(L,{data:l});break;default:this.emit(L,{data:l})}}reGetSignalChannelUrl(){return at(this,null,function*(){try{td(!0),yield this.room.schedule(this.room.roomId);let{mainUrl:r,backupUrl:l}=this.room.getSignalChannelUrl();this.url=r,this.backupUrl=l}catch{}})}reconnect(){return at(this,null,function*(){if(!this._isReconnecting){if(!this.room.isJoined&&this.keepAlive)return void this.close();this._isReconnecting=!0;try{this._log.warn("reconnect"),yield this.connect();let{roomId:r,useStringRoomId:l}=this.room,{relayIp:d,relayInnerIp:g,relayPort:C}=this._signalInfo,{data:A}=yield this.sendWaitForResponse({command:Iie,data:{roomId:r,useStringRoomId:l,relayInnerIp:g,relayOuterIp:d,relayPort:C},responseCommand:go.CHANNEL_RECONNECT_RESULT});A.code===0?(this._log.warn("reconnect success"),this.stopReconnection(),Lo.addSuccessEvent({key:521702,cost:xo()-this._connnectStartTime}),this._connnectStartTime=-1,this.room.syncUserList(),this.room.checkConnectionsToReconnect()):(Lo.addFailedEvent({key:521702,error:A.code}),this._log.warn("reconnect failed, ".concat(A.code," ").concat(A.message)),this.room.reJoin())}catch(r){this._log.error(r),this.room.reJoin()}}})}send(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isConnected&&!this.room.isLeft){let d={cmd:r,data:l,userId:this.userId,tinyId:this._signalInfo.tinyId,seq:++this._seq},g=JSON.stringify(d);return this._socketInUse.send(g),this.bytesSent+=pR(g),d.seq}}sendWaitForResponse(r){let{command:l,data:d,timeout:g=5e3,responseCommand:C,commandDesc:A,enableLog:L=!0}=r;return new Promise((B,U)=>{let Z=setTimeout(()=>{this.off(C,ae);let we=new Rn({code:an.API_CALL_TIMEOUT,message:so({key:to.API_CALL_TIMEOUT,data:{commandDesc:A,command:l}})});L&&this._log.warn(we),U(we)},g),ae=we=>{we.data.seq===ce&&(clearTimeout(Z),this.off(C,ae),B(we))};this.on(C,ae);let ce=this.send(l,d)})}sendWaitForResponseWithRetry(r){let{commandDesc:l,command:d,retries:g=0,retryTimeout:C=0}=r;return z_({retryFunction:this.sendWaitForResponse,onError:A=>{let{retry:L}=A;this.isOnline?L():(this._log.warn("retry ".concat(d," when connected")),this.once(ng,L))},onRetrying:A=>{this._log.warn("".concat(l||d," timeout observed, retrying [").concat(A,"/").concat(g,"]"))},settings:{retries:g,timeout:C},context:this})(r)}getCurrentState(){return this._currentState}getSignalInfo(){return this._signalInfo}stopReconnection(){this._isReconnecting=!1,this._stopConnectRetry&&this._stopConnectRetry()}close(){this._log.info("closed"),hS.delete(this),this.stopReconnection(),this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._socketInUse=null,this.bytesSent=0,this.bytesReceived=0,this._stopConnectRetry&&this._stopConnectRetry(),this.unbindAndCloseSocket(Be.MAIN),this.unbindAndCloseSocket(Be.BACKUP),this.emitConnectionStateChanged("DISCONNECTED")}destroy(){this.close(),this.destroyed=!0}stopKeepAliveIn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3600;if(this.keepAlive){this._log.info("stopKeepAlive in ".concat(r,"s"));let l=setTimeout(()=>{this.keepAlive=!1,this._log.info("close due to not used ".concat(r,"s")),this.close()},1e3*r),d=g=>{g instanceof uS&&g.action==="join"&&(this._log.info("stopKeepAlive clear timeout"),clearTimeout(l),this.room.off(Pr.STATECHANGED,d))};this.room.on(Pr.STATECHANGED,d)}}emitConnectionStateChanged(r){r!==this._currentState&&(this._log.info("".concat(this._currentState," -> ").concat(r)),this.emit(JR,{prevState:this._currentState,state:r}),this._currentState=r,r==="CONNECTED"?this.emit(ng):r==="DISCONNECTED"&&this.emit(Zre))}};In([Cy({settings:{retries:1/0,timeout:2e3},onError(r,l){!this.room.isDestroyed&&!this.destroyed&&l()},onRetrying(r,l){this._log.warn("retrying to connect ".concat(r)),r>=3&&r%3==0&&this.reGetSignalChannelUrl(),l&&(this._stopConnectRetry=l,(this.room.isDestroyed||this.destroyed)&&l())}})],jV.prototype,"connect");var Cie=Vi(qa()),ZR=0,QR=!1,fS=new Set,YV=!1,vf=class{constructor(r){Se(this,"userId"),Se(this,"tinyId"),Se(this,"_sdpSemantics"),Se(this,"_isUplink"),Se(this,"_room"),Se(this,"_log"),Se(this,"_signalChannel"),Se(this,"_isErrorObserved",!1),Se(this,"_waitForPeerConnectionConnectedPromise"),Se(this,"_waitForPeerConnectionConnectedPromiseReject",null),Se(this,"_peerConnection",null),Se(this,"_emitter",new Cie.default),Se(this,"_currentState","DISCONNECTED"),Se(this,"_isReconnecting",!1),Se(this,"_reconnectionCount",0),Se(this,"_reconnectionTimer",-1),Se(this,"_isFirstConnection",!0),Se(this,"_prevTime",-1),Se(this,"_enableSEI"),Se(this,"_sei"),Se(this,"_localAddress"),Se(this,"_remoteAddress"),this.userId=r.userId,this.tinyId=r.tinyId,this._room=r.room,this._sdpSemantics=r.room.sdpSemantics,this._isUplink=r.isUplink,this._log=pn.createLogger({id:"n-mpc",userId:this._room.userId,remoteUserId:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=r.signalChannel,this._enableSEI=r.enableSEI}beforeConnect(){this._prevTime<0&&(this._prevTime=xo())}afterConnect(r){return at(this,null,function*(){try{yield r,this._isFirstConnection?(this._isFirstConnection=!1,Lo.addSuccessEvent({key:521705,cost:Math.min(xo()-this._prevTime,3e4)})):this._isReconnecting&&Lo.addSuccessEvent({key:521706,cost:xo()-this._prevTime}),this._prevTime=-1}catch(l){throw this._isFirstConnection?(this._isFirstConnection=!1,Lo.addFailedEvent({key:521705,error:l})):this._isReconnecting&&this._reconnectionCount>=3&&Lo.addFailedEvent({key:521706,error:l}),l}})}initialize(){let r={encodedInsertableStreams:this._enableSEI&&ey,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"};this._peerConnection=new RTCPeerConnection(r),this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this)}close(r){this._log.info("close connection"),this._emitter.emit("closed",r),this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this._sei&&(this._sei.destroy(),this._sei=null),fS.delete(this)}closePeerConnection(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._peerConnection&&(this._log.info("close pc"),this._peerConnection.onconnectionstatechange=null,this._peerConnection.close(),this._peerConnection=null,r&&this.emitConnectionStateChangedEvent("DISCONNECTED")),this._waitForPeerConnectionConnectedPromiseReject&&this._waitForPeerConnectionConnectedPromiseReject(new Rn({code:an.API_CALL_ABORTED,message:"connection closed"}))}getDTLSTransportState(){if(!this._peerConnection)return Xu;let r=null;if(this._isUplink){if(!qC()||this._peerConnection.getSenders().length===0)return Xu;r=this._peerConnection.getSenders()[0].transport}else{if(!$C()||this._peerConnection.getReceivers().length===0)return Xu;r=this._peerConnection.getReceivers()[0].transport}return r?r.state:Xu}onConnectionStateChange(r){let l=this._peerConnection.iceConnectionState,d=this.getDTLSTransportState();if(this._log.info("connectionState: ".concat(r.target.connectionState,", ICE: ").concat(l,", DTLS: ").concat(d)),r.target.connectionState===ni.CONNECTING&&this.emitConnectionStateChangedEvent("CONNECTING"),r.target.connectionState===ni.FAILED||r.target.connectionState===ni.CLOSED){let g="connection ".concat(r.target.connectionState,". ICE Transport state: ").concat(l,", DTLS Transport state: ").concat(d),C=new Rn({message:g,code:an.ICE_TRANSPORT_ERROR});this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection(),this._isErrorObserved||this._emitter.emit("error",C)}(r.target.connectionState===ni.CONNECTED||r.target.connectionState===ni.COMPLETED)&&(this.logSelectedCandidate(),li.logSuccessEvent({userId:this._room.userId,eventType:wc.ICE_CONNECTION_STATE}),this.emitConnectionStateChangedEvent("CONNECTED"))}emitConnectionStateChangedEvent(r){return r!==this._currentState&&(r==="CONNECTED"?(ZR=0,QR=!1,YV=!0,fS.add(this)):fS.delete(this),en.emit($t.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:r,remoteUserId:this._isUplink?void 0:this.userId}),this._emitter.emit("connection-state-changed",{prevState:this._currentState,state:r}),this._currentState=r,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}logSelectedCandidate(){return at(this,null,function*(){if(!this._peerConnection)return;let r=yield this._peerConnection.getStats();for(let[,l]of r)if(Q_(l)){let d=r.get(l.localCandidateId),g=r.get(l.remoteCandidateId);d&&(this._log.info("local candidate: ".concat(d.candidateType," ").concat(d.protocol,":").concat(d.ip||d.address,":").concat(d.port," ").concat(d.networkType||""," ").concat(d.candidateType==="relay"?"relayProtocol:".concat(d.relayProtocol):"")),this._localAddress="".concat(d.ip||d.address,":").concat(d.port)),g&&(this._log.info("remote candidate: ".concat(g.candidateType," ").concat(g.protocol,":").concat(g.ip||g.address,":").concat(g.port)),this._remoteAddress="".concat(g.protocol,":").concat(g.ip||g.address));break}})}getCurrentState(){return this._currentState}waitForPeerConnectionConnected(){return this._waitForPeerConnectionConnectedPromise||(this._waitForPeerConnectionConnectedPromise=new Promise((r,l)=>{if(this._currentState==="CONNECTED")return r();this._waitForPeerConnectionConnectedPromiseReject=l;let d=L=>{L.state==="CONNECTED"&&(clearTimeout(A),C(),r())},g=L=>{let{room:B}=L;B===this._room&&(clearTimeout(A),C(),l(new Rn({code:an.API_CALL_ABORTED,message:so({key:to.CONNECTION_ABORTED,data:"leave room"})})))},C=()=>{en.off($t.LEAVE_SUCCESS,g,this),this._emitter.off("connection-state-changed",d,this)},A=setTimeout(()=>{C();let L=new Rn({code:an.API_CALL_TIMEOUT,message:"connection timeout"});var B;ZR+=1,B=this._signalChannel.isConnected,ZR>2&&!QR&&fS.size===0&&B&&(this._log.warn("firewall restriction"),QR=!0,this._emitter.emit("firewall-restriction")),l(L)},xw);en.on($t.LEAVE_SUCCESS,g,this),this._emitter.on("connection-state-changed",d,this)}),this._waitForPeerConnectionConnectedPromise=this._waitForPeerConnectionConnectedPromise.finally(()=>{this._waitForPeerConnectionConnectedPromise=null,this._waitForPeerConnectionConnectedPromiseReject=null})),this._waitForPeerConnectionConnectedPromise}getReconnectionCount(){return this._reconnectionCount}startReconnection(){this._isReconnecting=!0,this.reconnect()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}stopReconnection(){this._log.info("stop reconnection"),this._isReconnecting=!1,this._reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(ng,this.reconnect,this)}beforeReconnect(){if(this._reconnectionTimer!==-1)return this._log.warn("reconnect() is reconnecting, ignore"),-1;if(this._reconnectionCount>=xm()){this._log.warn("SDK has tried reconnect for ".concat(this._reconnectionCount," times, but all failed, please check your network")),this.stopReconnection();let r=new Rn({code:this._isUplink?an.UPLINK_RECONNECTION_FAILED:an.DOWNLINK_RECONNECTION_FAILED,message:so({key:this._isUplink?to.UPLINK_RECONNECTION_FAILED:to.DOWNLINK_RECONNECTION_FAILED})});return this.emitConnectionStateChangedEvent("DISCONNECTED"),this._emitter.emit("error",r),-1}return this._signalChannel.isConnected?(this._reconnectionCount+=1,this._log.warn("reconnect() trying [".concat(this._reconnectionCount,"]")),1):(this._log.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this._signalChannel.once(ng,this.reconnect,this),-1)}on(r,l,d){this._emitter.on(r,l,d)}off(r,l,d){this._emitter.off(r,l,d)}getIsReconnecting(){return this._isReconnecting}get isH264(){var r,l;return!((l=(r=this._peerConnection)==null?void 0:r.remoteDescription)==null||!l.sdp.includes("H264"))}},JV=Vi(P4()),vi=function(r){return JV.default.parse(r)},dd=function(r){return JV.default.write(r)};function eA(r){return Object.keys(r).filter(l=>r[l])}var XV=class extends vf{constructor(r){super(Io(Fn({},r),{isUplink:!1})),Se(this,"_flag",0),Se(this,"role","anchor"),Se(this,"remoteAudioTrack"),Se(this,"remoteVideoTrack"),Se(this,"remoteAuxiliaryTrack"),Se(this,"ssrc",{audio:0,video:0,auxiliary:0}),Se(this,"_isSDPExchanging",!1),this.flag=r.flag,this.remoteAudioTrack=r.remoteAudioTrack||new HR(this._room,this),this.remoteVideoTrack=r.remoteVideoTrack||new uy(this._room,this),this.remoteAuxiliaryTrack=r.remoteAuxiliaryTrack||new TV(this._room,this)}get subscribeState(){let r={audio:!1,video:!1,auxiliary:!1,smallVideo:!1};return this.remoteVideoTrack.isSubscribed&&(8&this.remoteVideoTrack.mediaType?r.smallVideo=!0:r.video=!0),this.remoteAudioTrack.isSubscribed&&(r.audio=!0),this.remoteAuxiliaryTrack.isSubscribed&&(r.auxiliary=!0),r}get muteState(){return J_(this.flag,this.userId)}get flag(){return this._flag}set flag(r){var l,d,g;r!==this._flag&&(this._flag=r,(l=this.remoteAudioTrack)==null||l.onFlagChanged(),(d=this.remoteVideoTrack)==null||d.onFlagChanged(),(g=this.remoteAuxiliaryTrack)==null||g.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(r){return r===Be.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){super.initialize(),this.installEvents(),this._peerConnection.ontrack=this.onTrack.bind(this)}close(r){super.close(r),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents()}installEvents(){}uninstallEvents(){this._emitter.removeAllListeners()}emitConnectionStateChangedEvent(r){var l,d;let g=this._currentState,C=super.emitConnectionStateChangedEvent(r);return C&&g!==r&&((l=this.remoteVideoTrack)==null||l.emit("connection-state-changed",{prevState:g,state:r}),(d=this.remoteAuxiliaryTrack)==null||d.emit("connection-state-changed",{prevState:g,state:r})),C}onTrack(r){let l=r.streams[0],{track:d}=r,g=l.id===yC?Be.MAIN:Be.AUXILIARY;this._log.debug("ontrack ".concat(g," ").concat(d.kind));let C=Be.AUDIO;d.kind===Be.VIDEO&&(C=g===Be.MAIN?Be.VIDEO:Be.AUXILIARY);let A=this.remoteAudioTrack;C===Be.VIDEO?A=this.remoteVideoTrack:C===Be.AUXILIARY&&(A=this.remoteAuxiliaryTrack),A.setInputMediaStreamTrack(d)}addRRTRLine(r){let l=r.split(`\r
`),d=new Map;l.forEach((C,A)=>{/^a=rtcp-fb:/.test(C)&&l[A+1]&&!/^a=rtcp-fb:/.test(l[A+1])&&d.set(A+1,"".concat(C.match(/^a=rtcp-fb:\d+/)[0]," rrtr"))});let g=[...d];for(let C=0;C<g.length;C++){let[A,L]=g[C];l.splice(A+C,0,L)}return l.join(`\r
`)}addSPSDescription(r){let l=vi(r);return l.media.forEach(d=>{d.type===Be.VIDEO&&d.fmtp.forEach(g=>{g.config+=";sps-pps-idr-in-keyframe=1"})}),dd(l)}removeSDESDescription(r){let l=["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"],d=vi(r);return d.media.forEach(g=>{!g.ext||(g.ext=g.ext.filter(C=>!l.includes(C.uri)))}),dd(d)}isSubscriptionStateNotChanged(r){return JSON.stringify(r)===JSON.stringify(this.subscribeState)}subscribe(r,l){return at(this,null,function*(){var d,g;try{if((((d=this._peerConnection)==null?void 0:d.connectionState)===ni.NEW||((g=this._peerConnection)==null?void 0:g.connectionState)===ni.CONNECTING)&&(yield this.waitForPeerConnectionConnected()),this.isSubscriptionStateNotChanged(r))return void(this._peerConnection||(this.initialize(),yield this.connect(r)));if(this._log.info("subscribe ".concat(l," ").concat(JSON.stringify(r))),this._peerConnection||this._isSDPExchanging){let C="subscribe_change";Object.values(r).find(A=>A===!0)||(C="unsubscribe"),yield this.sendSubscription(C,r)}else this.initialize(),yield this.connect(r)}catch(C){throw this._room.isJoined&&this.isStreamUnpublished(l)?(this._log.warn("".concat(C.message," ").concat(JSON.stringify(this.muteState))),new Rn({code:an.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):C}})}unsubscribe(r){return at(this,arguments,function(l){var d=this;let{remoteTracks:g,streamType:C}=l;return function*(){if(d._currentState==="CONNECTED"&&(C==="main"&&!d.isMainStreamSubscribed||C==="auxiliary"&&!d.isAuxStreamSubscribed))return void d._log.info("".concat(C," stream already unsubscribed"));let A=Fn({},d.subscribeState);g.forEach(B=>{switch(B.mediaType){case 1:A.audio=!1;break;case 4:A.video=!1;break;case 8:A.smallVideo=!1;break;case 2:A.auxiliary=!1}});let L="subscribe_change";Object.values(A).find(B=>B===!0)||(L="unsubscribe"),d._log.info("".concat(L==="unsubscribe"?L:"subscribe"," ").concat(C," [").concat(eA(A),"]")),yield d.sendSubscription(L,A),L==="unsubscribe"&&(d.closePeerConnection(),d.emitConnectionStateChangedEvent("DISCONNECTED"))}()})}sendSubscription(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,d={srcTinyId:this.tinyId,srcUserId:this.userId},g=KV,C=go.UNSUBSCRIBE_RESULT;return r==="subscribe_change"&&(d={audio:l.audio,bigVideo:l.video,auxVideo:l.auxiliary,smallVideo:l.smallVideo,srcTinyId:this.tinyId},g=zV,C=go.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponse({command:g,data:d,responseCommand:C,timeout:1e4}).then(A=>{let{data:L}=A;if(L.code!==0){let B=new Rn({code:L.code,message:so({key:to.ERROR_MESSAGE,data:{type:r,message:L.message}})});throw this._log.error(B),B}})}connect(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState;return function*(){try{yield r.exchangeSDP(l),yield r.waitForPeerConnectionConnected()}catch(d){throw r.closePeerConnection(!0),d}}()})}exchangeSDP(r){return at(this,null,function*(){try{this._isSDPExchanging=!0,yield this.createOffer(),this._log.info("createOffer success, sending offer");let{type:l,sdp:d}=this._peerConnection.localDescription,g={type:l,sdp:d,srcUserId:this.userId,srcTinyId:this.tinyId,audio:r.audio,bigVideo:r.video,auxVideo:r.auxiliary,smallVideo:r.smallVideo},C=yield this._signalChannel.sendWaitForResponse({command:aie,commandDesc:"exchange sdp",data:g,responseCommand:go.SUBSCRIBE_RESULT,timeout:eF});if(!this._peerConnection){let A=new Rn({code:an.INVALID_OPERATION,message:so({key:to.CONNECTION_CLOSED})});throw this._log.warn(A),A}yield this.onSubscribeResult(C),this._isSDPExchanging=!1}catch(l){throw this._isSDPExchanging=!1,l}})}createOffer(){return at(this,null,function*(){let r={voiceActivityDetection:!1};Lc()&&this._sdpSemantics===R_?(this._peerConnection.addTransceiver(Be.AUDIO,{direction:bo.RECVONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:bo.RECVONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:bo.RECVONLY})):(r.offerToReceiveAudio=!0,r.offerToReceiveVideo=!0);let l=yield this._peerConnection.createOffer(r);if(l.sdp){let{isH264DecodeSupported:d}=yield yR();d||(this._log.warn("remove h264 desc from sdp"),l.sdp=function(g){let C=vi(g);return C.media.forEach(A=>{var L,B;if(A.type===Be.VIDEO){let U=new Set;A.rtp.forEach(ae=>{let{payload:ce,codec:we}=ae;return we==="H264"&&U.add(ce)}),A.fmtp.forEach(ae=>{let{payload:ce,config:we}=ae,Pe=we.match(/apt=(\d+)/);Pe&&Pe[1]&&U.has(Number(Pe[1]))&&U.add(ce)});let Z=ae=>{let{payload:ce}=ae;return!U.has(ce)};A.rtp=A.rtp.filter(Z),A.rtcpFb=(L=A.rtcpFb)==null?void 0:L.filter(Z),A.fmtp=A.fmtp.filter(Z),A.payloads=(B=A.payloads)==null?void 0:B.split(" ").filter(ae=>!U.has(Number(ae))).join(" ")}}),dd(C)}(l.sdp)),l.sdp=this.addRRTRLine(l.sdp),l.sdp=this.addSPSDescription(l.sdp),l.sdp=function(g){let C=vi(g);return C.media.forEach(A=>{A.type===Be.AUDIO&&A.fmtp.forEach(L=>{L.config+=";sprop-stereo=1;stereo=1"})}),dd(C)}(l.sdp),this._sdpSemantics===R_&&(l.sdp=this.removeSDESDescription(l.sdp))}yield this._peerConnection.setLocalDescription(l)})}onSubscribeResult(r){return at(this,null,function*(){let{code:l,message:d=""}=r&&r.data||{},{type:g,sdp:C}=r&&r.data&&r.data.data||{};if(l===bC)throw new Rn({code:an.NOT_SUPPORTED_H264,message:so({key:to.NOT_SUPPORTED_H264DECODE})});try{if(l!==0)throw new Rn({code:l,message:so({key:to.EXCHANGE_SDP_FAILED,data:{errMsg:d}})});this._log.debug("accept remote answer: ".concat(C)),yield this._peerConnection.setRemoteDescription({type:g,sdp:C}),this._sei&&(this._sei.handleEncodedStreams(),this._sei.onSEIMessage=A=>{this._emitter.emit("sei-message",Io(Fn({},A),{userId:this.userId}))}),this.updateSSRC(C)}catch(A){throw this._log.error(A),A}})}updateSSRC(r){try{vi(r).media.forEach(l=>{if(l.ssrcs)if(l.type===Be.AUDIO){let d=l.ssrcs.find(g=>{var C;return(C=g.value)==null?void 0:C.includes(yC)});d&&(this.ssrc.audio=Number(d.id))}else{let d=l.ssrcs.find(C=>{var A;return(A=C.value)==null?void 0:A.includes(yC)}),g=l.ssrcs.find(C=>{var A;return(A=C.value)==null?void 0:A.includes(j4)});d&&(this.ssrc.video=Number(d.id)),g&&(this.ssrc.auxiliary=Number(g.id))}})}catch{}}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}reconnect(){return at(this,null,function*(){if(!(Ys(XV.prototype,this,"beforeReconnect").call(this)<0))try{this.closePeerConnection(),this.initialize(),yield this.connect(),this.stopReconnection(),this._log.warn("reconnect() success")}catch{let l=$m(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(l/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},l)}})}getIsReconnecting(){return this._isReconnecting}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}getCurrentState(){return this._currentState}setDelay(r){let{audioDelay:l,videoDelay:d}=r;this.remoteAudioTrack.stat.end2EndDelay=l,this.remoteVideoTrack.stat.end2EndDelay=d}},tA=XV;In([Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];return new Promise((C,A)=>{let L=B=>{this._emitter.off("closed",L),A(new Rn({code:an.API_CALL_ABORTED,message:so({key:to.CONNECTION_ABORTED,data:B})}))};this._emitter.on("closed",L),r.apply(this,d).then(C,A).finally(()=>{this._emitter.off("closed",L)})})})],tA.prototype,"subscribe"),In([yV(vf.prototype.afterConnect),_V(vf.prototype.beforeConnect)],tA.prototype,"connect");var ZV=tA,QV={voiceActivityDetection:!1},eG=class extends vf{constructor(r){super(Io(Fn({},r),{isUplink:!0})),Se(this,"localMainAudioTrack",null),Se(this,"localMainVideoTrack",null),Se(this,"localAuxAudioTrack",null),Se(this,"localAuxVideoTrack",null),Se(this,"ssrc",{audio:0,video:0,small:0,auxiliary:0}),Se(this,"_isPublishingAux",!1),Se(this,"_publishingLocalAudioTrack"),Se(this,"_publishingLocalVideoTrack"),Se(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),Se(this,"flag",0)}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var r,l,d,g;let C={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let A=this._peerConnection.getSenders();A&&(rd()?(C.audio=!((r=A[0])==null||!r.track),C.bigVideo=!((l=A[1])==null||!l.track),C.smallVideo=!((d=A[2])==null||!d.track),C.auxVideo=!((g=A[3])==null||!g.track)):A.forEach(L=>{L.track&&(L.track.kind===Be.AUDIO?C.audio=!0:(C.bigVideo=!0,this._room.videoManager.hasSmall&&(C.smallVideo=!0)))}))}return C}initialize(){super.initialize(),this.installEvents()}reset(){this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this.uninstallEvents()}close(r){super.close(r),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){this._emitter.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this._emitter.on("connection-state-changed",this.handleConnectionStateChange,this)}uninstallEvents(){this._emitter.off("connection-state-changed",this.handleConnectionStateChange,this)}emitConnectionStateChangedEvent(r,l){var d,g,C;let A=this._currentState,L=super.emitConnectionStateChangedEvent(r);return L&&A!==r&&(l?l.emit("connection-state-changed",{prevState:A,state:r}):((d=this.localMainVideoTrack)==null||d.emit("connection-state-changed",{prevState:A,state:r}),(g=this.localAuxVideoTrack)==null||g.emit("connection-state-changed",{prevState:A,state:r}),(C=this._publishingLocalVideoTrack)==null||C.emit("connection-state-changed",{prevState:A,state:r}))),L}publish(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C,isAuxiliary:A}=l;return function*(){var L;let B;d._peerConnection||d.initialize(),g&&(d._publishingLocalAudioTrack=g),C&&(d._publishingLocalVideoTrack=C),d._isPublishingAux=A,C&&!A&&C.small&&(B=d._room.videoManager.smallTrack),d.sendMediaSettings(),Lc()?yield d.publishByTransceiver({localAudioTrack:g,localVideoTrack:C,smallTrack:B,isAuxiliary:A}):yield d.publishByAddTrack({localAudioTrack:g,localVideoTrack:C,smallTrack:B}),d._publishingLocalAudioTrack=null,d._publishingLocalVideoTrack=null,d._isPublishingAux=!1,A?(C&&(d.localAuxVideoTrack=C),g&&(d.localAuxAudioTrack=g)):(C&&(d.localMainVideoTrack=C),g&&(d.localMainAudioTrack=g)),(L=d._sei)==null||L.handleEncodedStreams(),d.installTrackMuteEvents(g,C),d.sendMutedFlag()}()})}publishByTransceiver(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C,smallTrack:A,isAuxiliary:L}=l;return function*(){d._log.info("publish by transceiver");let B=new MediaStream,U=C==null?void 0:C.outMediaTrack,Z=g==null?void 0:g.outMediaTrack;Z&&B.addTrack(Z),U&&B.addTrack(U);let ae=d._peerConnection.getTransceivers();if(ae.length===0)d._peerConnection.addTransceiver(Z||Be.AUDIO,{direction:bo.SENDONLY,streams:[B]}),d._peerConnection.addTransceiver(L?Be.VIDEO:U||Be.VIDEO,{direction:bo.SENDONLY,streams:[B]}),d._peerConnection.addTransceiver(A||Be.VIDEO,{direction:bo.SENDONLY,streams:[B]}),d._peerConnection.addTransceiver(L&&U||Be.VIDEO,{direction:bo.SENDONLY,streams:[B]}),yield d.connect();else{let ce=[];if(Z&&(ae[0].sender.track||ce.push(0),yield ae[0].sender.replaceTrack(Z),yield d.setBandwidth({bandwidth:(g==null?void 0:g.profile.bitrate)||40,type:Be.AUDIO})),U){let we=L?3:1;yield ae[we].sender.replaceTrack(U),yield d.setBandwidth({bandwidth:C.profile.bitrate,type:Be.VIDEO,videoType:L?Be.AUXILIARY:Be.BIG}),ce.push(we),A&&(yield ae[2].sender.replaceTrack(A),yield d.setBandwidth({bandwidth:C.small.bitrate,type:Be.VIDEO,videoType:Be.SMALL}),ce.push(2))}yield d.setTransceiverDirection(bo.SENDONLY,ce),yield d.doPublishChange(),C==null||C.emit("connection-state-changed",{prevState:"DISCONNECTED",state:"CONNECTING"}),C==null||C.emit("connection-state-changed",{prevState:"CONNECTING",state:"CONNECTED"})}}()})}publishByAddTrack(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C,smallTrack:A}=l;return function*(){d._log.info("publish by addtrack");let L=C==null?void 0:C.outMediaTrack,B=g==null?void 0:g.outMediaTrack;if(d._peerConnection&&d._peerConnection.connectionState!=="new")return g&&B&&(yield d.addTrack(g)),void(L&&(yield d.addTrack(C)));let U=new MediaStream;if(B&&U.addTrack(B),L&&U.addTrack(L),B&&d._peerConnection.addTrack(B,U),L&&(d._peerConnection.addTrack(L,U),A)){let Z=new MediaStream;Z.addTrack(A),d._peerConnection.addTrack(A,Z)}yield d.connect()}()})}enableSmall(r){return at(this,null,function*(){let l=this._peerConnection.getTransceivers();r?this._room.videoManager.smallTrack&&(yield l[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection(bo.SENDONLY,[2])):(yield l[2].sender.replaceTrack(null),yield this.setTransceiverDirection(bo.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];l.forEach(g=>{g&&(g==null||g.on("mute",this.sendMutedFlag,this),g==null||g.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];l.forEach(g=>{g&&(g==null||g.off("mute",this.sendMutedFlag,this),g==null||g.off("unmute",this.sendMutedFlag,this))})}unpublish(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C}=l;return function*(){if(!rd())return g&&g.outMediaTrack&&!C&&d.localMainVideoTrack?(yield d.removeTrack(g),void(d.localMainAudioTrack=null)):C&&C.outMediaTrack&&!g&&d.localMainAudioTrack?(yield d.removeTrack(C),void(d.localMainVideoTrack=null)):(yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),void d.emitConnectionStateChangedEvent("DISCONNECTED",C));let A=C&&C===d.localAuxVideoTrack,L=C==null?void 0:C.outMediaTrack,B=d._peerConnection.getSenders(),U=[];g&&(yield B[0].replaceTrack(null),U.push(0),A?d.localAuxAudioTrack=null:d.localMainAudioTrack=null),L&&(A?(yield B[3].replaceTrack(null),d.localAuxVideoTrack=null,d._mediaSettings=Io(Fn({},d._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),U.push(3)):(yield B[1].replaceTrack(null),yield B[2].replaceTrack(null),d.localMainVideoTrack=null,d._mediaSettings=Io(Fn({},d._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),U.push(1,2))),d.isMainStreamPublished||d.isAuxStreamPublished?(yield d.setTransceiverDirection(bo.INACTIVE,U),yield d.doPublishChange(!1)):yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),C==null||C.emit("connection-state-changed",{prevState:d._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return at(this,null,function*(){let l={state:this.publishState,constraintConfig:this._mediaSettings},d=yield this._signalChannel.sendWaitForResponse({command:qV,data:l,responseCommand:go.PUBLISH_STATE_CHANGE_RESULT,enableLog:r});this.checkPublishResultCode(d.data.code,d.data.message)})}doUnpublish(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:XR,commandDesc:"unpublish",responseCommand:go.UNPUBLISH_RESULT,enableLog:r}).catch(l=>{if(l.getCode()===an.API_CALL_TIMEOUT)return Promise.resolve();throw l})}updateMediaSettings(){let{detail:{isH264EncodeSupported:r,isVp8EncodeSupported:l}}=this._room.checkSystemResult;r?this._mediaSettings.videoCodec="H264":l&&(this._mediaSettings.videoCodec="VP8");let d=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:g,localAuxVideoTrack:C}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?C=this._publishingLocalVideoTrack:g=this._publishingLocalVideoTrack),zm){if(d&&d.outMediaTrack){let A=d.outMediaTrack.getSettings();this._mediaSettings.audioChannel=A.channelCount||1,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=A.sampleRate||0}if(g&&g.outMediaTrack){let A=g.outMediaTrack.getSettings();this._mediaSettings.videoWidth=A.width||0,this._mediaSettings.videoHeight=A.height||0,this._mediaSettings.videoFps=A.frameRate||0,this._mediaSettings.videoBps=1e3*g.profile.bitrate,g.small&&(this._mediaSettings.smallVideoWidth=g.small.width,this._mediaSettings.smallVideoHeight=g.small.height,this._mediaSettings.smallVideoFps=g.small.frameRate,this._mediaSettings.smallVideoBps=1e3*g.small.bitrate)}if(C&&C.outMediaTrack){let A=C.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=A.width||0,this._mediaSettings.auxVideoHeight=A.height||0,this._mediaSettings.auxVideoFps=A.frameRate||0,this._mediaSettings.auxVideoBps=1e3*C.profile.bitrate}}else d&&d.outMediaTrack&&(this._mediaSettings.audioChannel=d.profile.channelCount,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=d.profile.sampleRate),g&&g.outMediaTrack&&(this._mediaSettings.videoWidth=g.profile.width,this._mediaSettings.videoHeight=g.profile.height,this._mediaSettings.videoFps=g.profile.frameRate,this._mediaSettings.videoBps=1e3*g.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:WV,data:this._mediaSettings,responseCommand:go.UPDATE_CONSTRAINT_CONFIG_RES}).then(r=>{r.data.code!==0&&this._log.warn(r.data.message)}).catch(()=>{})}addTrack(r){return at(this,null,function*(){var l;if(!this._peerConnection)return;let d=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is adding ".concat(r.kind," track to current published local ").concat(d?Be.AUXILIARY:Be.MAIN," stream")),(l=this._sei)==null||l.handleEncodedStreams(),Lc()?yield this.addTrackByTransceiver(r,d):yield this.addTrackBySender(r)})}addTrackByTransceiver(r,l){return at(this,null,function*(){var d;if(!r.mediaTrack)return;let g=this._peerConnection.getTransceivers();if(r.kind===Be.AUDIO)yield g[0].sender.replaceTrack(r.outMediaTrack);else{let C=l?3:1;yield g[C].sender.replaceTrack(r.outMediaTrack),C===1&&((d=this.localMainVideoTrack)!=null&&d.small)&&(yield g[2].sender.replaceTrack(this._room.videoManager.smallTrack)),g[C].direction===bo.INACTIVE&&(yield this.setTransceiverDirection(bo.SENDONLY,[C]))}this.updateMediaSettings(),yield this.doPublishChange()})}addTrackBySender(r){return at(this,null,function*(){if(!r.outMediaTrack)return;let l=r.outMediaTrack;rd()&&this._peerConnection.getTransceivers().findIndex(g=>g.direction==="stopped")>=0&&(this._log.warn("transceiver is stopping, negotiate sdp first"),yield this.updateOffer("remove",l));let d=this._peerConnection.getSenders().find(g=>g.track&&g.track.kind===l.kind);if(d&&d.track){this._log.warn("sender already exists, remove sender first");let g=d.track;this.removeSender(d),yield this.updateOffer("remove",g)}if(l&&this._peerConnection.addTrack(l,new MediaStream([l])),l.kind===Be.VIDEO&&r instanceof Wa&&r.small){let g=new MediaStream,{smallTrack:C}=this._room.videoManager;g.addTrack(C),this._peerConnection.addTrack(C,g)}yield this.updateOffer("add",l)})}isNeedToResetOfferOrder(){if(this._sdpSemantics===IC||!this._peerConnection||!this._peerConnection.localDescription)return!1;let{sdp:r}=this._peerConnection.localDescription,l=vi(r);for(let d=0;d<l.media.length;d++)if(Number(l.media[d].mid)===0&&l.media[d].type===Be.VIDEO)return!0;return!1}removeSender(r){let l=null;rd()&&(l=this._peerConnection.getTransceivers().find(d=>d.sender&&d.sender.track===r.track)),this._peerConnection.removeTrack(r),l&&Er(l.stop)&&(this._log.info("stop transceiver"),l.stop())}removeTrack(r){return at(this,null,function*(){if(!this._peerConnection)return;let l=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is removing ".concat(r.kind," track from current published local ").concat(l?Be.AUXILIARY:Be.MAIN," stream")),Lc()?yield this.removeTrackByTransceiver(r,l):yield this.removeTrackBySender(r)})}removeTrackByTransceiver(r,l){return at(this,null,function*(){if(!r.outMediaTrack)return;let d=this._peerConnection.getTransceivers();if(r.kind===Be.AUDIO)yield d[0].sender.replaceTrack(null);else{let g=l?3:1;yield d[g].sender.replaceTrack(null),g===1&&r.small&&(yield d[2].sender.replaceTrack(null)),yield this.setTransceiverDirection(bo.INACTIVE,[g])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(r,l){return at(this,null,function*(){if(!Nr)return;let d=!1,g=!1;this._log.info("setting transceiver ".concat(l.join(",")," direction to ").concat(r));let C=this._peerConnection.getTransceivers();if(l.forEach(B=>{C[B].direction!==r&&(C[B].direction=r,d=!0)}),d){this._log.info("updating offer");let B=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(B)}let A=-1,L=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(B=>{if(B.match(new RegExp("a=(".concat(bo.INACTIVE,"|").concat(bo.RECVONLY,"|").concat(bo.SENDONLY,")")))&&A++,l.includes(A)){if(r===bo.INACTIVE&&B.includes("a=".concat(bo.RECVONLY)))return g=!0,"a=".concat(r);if(r===bo.SENDONLY&&B.includes("a=".concat(bo.INACTIVE)))return g=!0,"a=".concat(bo.RECVONLY)}return B}).join(`\r
`);g&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:L}))})}removeTrackBySender(r){return at(this,null,function*(){if(!r.outMediaTrack)return;if(r.kind===Be.VIDEO&&this.isNeedToResetOfferOrder()&&this.localMainAudioTrack)return this.reset(),this.initialize(),void(yield this.publish({localAudioTrack:this.localMainAudioTrack,isAuxiliary:!1}));let l=this._peerConnection.getSenders().find(d=>d.track===r.outMediaTrack);l&&(this.removeSender(l),r.kind===Be.VIDEO&&r.small&&this._peerConnection.getSenders().forEach(d=>{d.track&&d.track.kind===Be.VIDEO&&this.removeSender(d)})),yield this.updateOffer("remove",r.outMediaTrack)})}replaceTrack(r){return at(this,null,function*(){var l;let d,g=(l=this._peerConnection)==null?void 0:l.getSenders();if(!g||g.length===0||!r.mediaTrack||(d=Lc()?r.kind===Be.AUDIO?g[0]:g[1]:g.find(A=>A.track&&A.track.kind===r.kind),!d))return;let C=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is replacing ".concat(r.kind," track on ").concat(C?Be.AUXILIARY:Be.MAIN," stream")),r.kind===Be.AUDIO?yield d.replaceTrack(r.outMediaTrack):r.kind===Be.VIDEO&&(C?g[3]&&(yield g[3].replaceTrack(r.outMediaTrack)):yield d.replaceTrack(r.outMediaTrack))})}updateOffer(r,l){return at(this,null,function*(){try{let d=yield this._peerConnection.createOffer(QV);Nr&&d.sdp&&(d.sdp=this.setSDPDirection(d.sdp,"sendrecv")),yield this._peerConnection.setLocalDescription(d);let g=this.updateMediaSettings(),C={action:r,trackId:l.id,kind:l.kind===Be.VIDEO?"bigVideo":l.kind,type:"offer",sdp:this._peerConnection.localDescription.sdp,constraintConfig:g,state:this.publishState};this._log.info("createOffer success, sending updated offer to remote server"),this._log.debug("updatedOffer: ".concat(C.sdp));let A=yield this._signalChannel.sendWaitForResponse({command:tie,data:C,responseCommand:go.UPDATE_OFFER_RESULT,timeout:Q4,commandDesc:"update offer"}),{code:L,message:B}=A.data;L!==0&&this.checkPublishResultCode(L,B),yield this.acceptAnswer(A.data.data),d.sdp&&this.updateSSRC(d.sdp)}catch(d){throw this._log.error(d),d}})}setBandwidth(r){return at(this,arguments,function(l){var d=this;let{bandwidth:g,type:C,videoType:A,sdp:L}=l;return function*(){if(!bR())return L?C===Be.VIDEO?d.updateVideoBandwidthRestriction(L,g,A):d.updateAudioBandwidthRestriction(L,g):void 0;let B,U=d._peerConnection.getSenders();if(Lc()){let Z=0;C===Be.VIDEO&&(Z=A===Be.SMALL?2:A===Be.AUXILIARY?3:1),B=U[Z]}else B=U.find(Z=>Z.track&&Z.track.kind===C);if(B){let Z=B.getParameters();(!Z.encodings||Z.encodings.length===0)&&(Z.encodings=[{}]),Z.encodings[0].maxBitrate=1e3*g;try{return yield B.setParameters(Z),d._log.info("".concat(A||"").concat(C," bandwidth ").concat(g," kbps")),L}catch(ae){if(d._log.info("failed to set bandwidth by setting maxBitrate: ".concat(ae)),L)return C===Be.VIDEO?d.updateVideoBandwidthRestriction(L,g,A):d.updateAudioBandwidthRestriction(L,g)}}return L}()})}updateVideoBandwidthRestriction(r,l,d){let g="AS";Nr&&(g="TIAS",l*=1e3);let C=0,A=-1;return d===Be.SMALL?C=1:d===Be.AUXILIARY&&(C=2),r=r.replace(/m=video (.*)\r\nc=IN (.*)\r\n/g,L=>(A+=1,A===C?"".concat(L,"b=").concat(g,":").concat(l,`\r
`):L))}updateAudioBandwidthRestriction(r,l){let d="AS";return Nr&&(d="TIAS",l*=1e3),r=r.replace(/m=audio (.*)\r\nc=IN (.*)\r\n/,`m=audio $1\r
c=IN $2\r
b=`.concat(d,":").concat(l,`\r
`))}removeBandwidthRestriction(r){return r.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}removeVideoOrientation(r){return r.replace(/urn:3gpp:video-orientation/,"")}connect(){return at(this,null,function*(){try{yield this.exchangeSDP(),yield this.waitForPeerConnectionConnected()}catch(r){throw this.closePeerConnection(!0),this.uninstallEvents(),r}})}exchangeSDP(){return at(this,null,function*(){try{yield this.createOffer(),this._log.info("createOffer success, sending offer to remote server"),yield this.doExchangeSDP()}catch(r){throw r}})}createOffer(){return at(this,null,function*(){try{let r=yield this._peerConnection.createOffer(QV);yield this._peerConnection.setLocalDescription(r),r.sdp&&this.updateSSRC(r.sdp)}catch(r){throw r}})}doExchangeSDP(){let r={command:iie,responseCommand:go.PUBLISH_RESULT,data:{type:this._peerConnection.localDescription.type,sdp:this.removeVideoOrientation(this._peerConnection.localDescription.sdp),screen:this.localMainVideoTrack instanceof ff||this.localAuxVideoTrack instanceof ff,state:this.publishState,constraintConfig:this._mediaSettings},enableLog:!1};return this._log.debug("sending sdp offer: ".concat(r.data.sdp)),this._signalChannel.sendWaitForResponse(r).then(l=>{let{code:d,message:g,data:C}=l.data;return d===0?this.acceptAnswer(C):this.checkPublishResultCode(d,g)})}setSDPDirection(r,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"all",g=vi(r);return g.media.forEach(C=>{(d==="all"||C.type===d)&&(C.direction=l)}),dd(g)}acceptAnswer(r){return at(this,null,function*(){var l,d,g,C,A;try{let L;if(this._publishingLocalAudioTrack||this._publishingLocalVideoTrack||this.isMainStreamPublished){let U=((l=this._publishingLocalVideoTrack)==null?void 0:l.profile.bitrate)||((d=this.localMainVideoTrack)==null?void 0:d.profile.bitrate),Z=((g=this._publishingLocalAudioTrack)==null?void 0:g.profile.bitrate)||((C=this.localMainAudioTrack)==null?void 0:C.profile.bitrate);if(U){let ae=this._isPublishingAux?Be.AUXILIARY:Be.BIG;L=yield this.setBandwidth({bandwidth:U,type:Be.VIDEO,sdp:L,videoType:ae})}Z&&(L=yield this.setBandwidth({bandwidth:Z,type:Be.AUDIO,sdp:L}))}if(L=this.removeVideoOrientation(r.sdp),(A=this._publishingLocalVideoTrack)!=null&&A.small){let{smallStreamConfig:U}=this._room;L=yield this.setBandwidth({bandwidth:this._publishingLocalVideoTrack.small.bitrate||U.bitrate,type:Be.VIDEO,videoType:Be.SMALL,sdp:L})}let B={type:r.type,sdp:L};yield this._peerConnection.setRemoteDescription(B),this._log.debug("accepted answer: ".concat(L))}catch(L){throw this._log.error("failed to accept remote answer ".concat(L)),L}})}sendMutedFlag(r){var l,d,g;if(r===this.localAuxAudioTrack||r===this.localAuxVideoTrack)return;let C={audio:!((l=this.localMainAudioTrack)==null||!l.muted),bigVideo:!((d=this.localMainVideoTrack)==null||!d.muted),auxVideo:!((g=this.localAuxVideoTrack)==null||!g.muted)};this._log.info("send muted state: ".concat(JSON.stringify(C))),this._signalChannel.send($V,C)}getIsReconnecting(){return this._isReconnecting}reconnect(){return at(this,null,function*(){if(!(Ys(eG.prototype,this,"beforeReconnect").call(this)<0))try{yield this._signalChannel.sendWaitForResponse({command:XR,responseCommand:go.UNPUBLISH_RESULT,enableLog:!1}),this.closePeerConnection(),this.initialize(),this.isMainStreamPublished&&(yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0})),this._log.warn("reconnect() uplink reconnect successfully"),this.stopReconnection()}catch{let l=$m(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(l/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},l)}})}handleConnectionStateChange(r){r.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&en.emit($t.SEND_FIRST_VIDEO_FRAME,{room:this._room})}updateSSRC(r){try{vi(r).media.forEach((l,d)=>{if(l.type===Be.AUDIO){let g=l.ssrcs&&l.ssrcs[0];g&&(this.ssrc.audio=Number(g.id))}else{if(this._sdpSemantics===IC&&l.ssrcGroups)return void l.ssrcGroups.forEach((C,A)=>{let L=Number(C.ssrcs.split(" ")[0]);A===0?this.ssrc.video=L:A===1&&(this.ssrc.small=L)});let g=l.ssrcs&&l.ssrcs[0];if(!g)return;switch(d){case 1:this.ssrc.video=Number(g.id);break;case 2:this.ssrc.small=Number(g.id);break;case 3:this.ssrc.auxiliary=Number(g.id)}}})}catch{}}getVideoTrackId(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Be.VIDEO;if(this._peerConnection){let l=this._peerConnection.getSenders();if(r===Be.AUXILIARY&&l[3]&&l[3].track)return l[3].track.id;if(r===Be.VIDEO&&l[1]&&l[1].track)return l[1].track.id}if(this.localMainVideoTrack&&r===Be.VIDEO){let l=this.localMainVideoTrack.mediaTrack;if(l)return l.id}if(this.localAuxVideoTrack&&r===Be.AUXILIARY){let l=this.localAuxVideoTrack.mediaTrack;if(l)return l.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(r,l){if(r!==0)throw r===bC?(this._log.error(Js.NOT_SUPPORTED_H264ENCODE),new Rn({code:an.NOT_SUPPORTED_H264,message:so({key:to.NOT_SUPPORTED_H264ENCODE})})):new Rn({code:an.UNKNOWN,message:so({key:to.SIGNAL_RESPONSE_FAILED,data:{signalResponse:go.PUBLISH_RESULT,code:r,message:l}})})}sendSEI(r,l){var d;(d=this._sei)==null||d.push(r,l)}},nA=eG;In([Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];return new Promise((C,A)=>{let L=B=>{this._emitter.off("closed",L),A(new Rn({code:an.API_CALL_ABORTED,message:so({key:to.CONNECTION_ABORTED,data:B})}))};this._emitter.on("closed",L),r.apply(this,d).then(C,A).finally(()=>{this._emitter.off("closed",L)})})})],nA.prototype,"publish"),In([yV(vf.prototype.afterConnect),_V(vf.prototype.beforeConnect)],nA.prototype,"connect");var oA=nA,Sie=class{constructor(r,l){this.room=r,Se(this,"_log"),Se(this,"_prevReportTime"),Se(this,"_prevReport",{}),Se(this,"_prevEncoderImplementation"),Se(this,"_prevQualityLimitationReason"),Se(this,"_prevAuxQualityLimitationReason"),Se(this,"_prevDecoderImplementationMap",new Map),Se(this,"totalBytesSent",0),Se(this,"totalBytesReceived",0),Se(this,"_spcStats",null),this._log=l,this._prevReportTime=0,this._prevEncoderImplementation="",this._prevQualityLimitationReason="",this._prevAuxQualityLimitationReason=""}get statInterval(){return this._prevReportTime===0?2:(Date.now()-this._prevReportTime)/1e3}getSenderStats(r){return at(this,null,function*(){let l={audio:{bytesSent:0,packetsSent:0,audioLevel:0,totalAudioEnergy:0},video:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},small:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},auxiliary:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},rtt:0},d=r.getPeerConnection(),g=r.getSSRC();if(d)try{if((this._spcStats||(yield d.getStats())).forEach(C=>{var A;if(C.type==="outbound-rtp")if((C.mediaType||C.kind)===Be.VIDEO){let L,B;if(C.ssrc===g.video?(L=Be.VIDEO,B=r.localMainVideoTrack):C.ssrc===g.small?L=Be.SMALL:C.ssrc===g.auxiliary&&(B=r.localAuxVideoTrack,L=Be.AUXILIARY),!L)return;l[L].bytesSent=C.bytesSent,l[L].packetsSent=C.packetsSent,l[L].framesEncoded=C.framesEncoded,Ft(C.keyFramesEncoded)||(l[L].keyFramesEncoded=C.keyFramesEncoded),Ft(C.nackCount)||(l[L].nackCount=C.nackCount),Ft(C.pliCount)||(l[L].pliCount=C.pliCount),Ft(C.retransmittedPacketsSent)||(l[L].retransmittedPacketsSent=C.retransmittedPacketsSent),Ft(C.totalEncodeTime)||(l[L].totalEncodeTime=C.totalEncodeTime),Ft(C.totalPacketSendDelay)||(l[L].totalPacketSendDelay=C.totalPacketSendDelay),C.ssrc===g.video?(!Ft(C.encoderImplementation)&&this._prevEncoderImplementation!==C.encoderImplementation&&(this._log.info("encoderImplementation change to ".concat(C.encoderImplementation)),this._prevEncoderImplementation=C.encoderImplementation),!Ft(C.qualityLimitationReason)&&C.bytesSent!==0&&this._prevQualityLimitationReason!==C.qualityLimitationReason&&(this._log.info("qualityLimitationReason change to ".concat(C.qualityLimitationReason)),this._prevQualityLimitationReason=C.qualityLimitationReason)):C.ssrc===g.auxiliary&&!Ft(C.qualityLimitationReason)&&C.bytesSent!==0&&this._prevAuxQualityLimitationReason!==C.qualityLimitationReason&&(this._log.info("aux qualityLimitationReason change to ".concat(C.qualityLimitationReason)),this._prevAuxQualityLimitationReason=C.qualityLimitationReason)}else l.audio.bytesSent=C.bytesSent,l.audio.packetsSent=C.packetsSent;else C.type==="candidate-pair"?Q_(C)&&Ti(C.currentRoundTripTime)&&(l.rtt=Math.floor(1e3*C.currentRoundTripTime),this.totalBytesSent=C.bytesSent):C.type==="media-source"&&(C.kind===Be.AUDIO?(l.audio.audioLevel=C.audioLevel||0,l.audio.totalAudioEnergy=C.totalAudioEnergy||0):C.kind===Be.VIDEO&&(C.trackIdentifier===r.getVideoTrackId(Be.VIDEO)?l.video.fpsCapture=C.framesPerSecond:C.trackIdentifier===r.getVideoTrackId(Be.AUXILIARY)?l.auxiliary.fpsCapture=C.framesPerSecond:l.small.fpsCapture=C.framesPerSecond));if(!Ft(C.audioLevel)&&((A=r.localMainAudioTrack)!=null&&A.mediaTrack)&&C.trackIdentifier===r.localMainAudioTrack.mediaTrack.id&&(l.audio.audioLevel=C.audioLevel||0),!Ft(C.frameWidth)){let L=Be.SMALL;C.trackIdentifier===r.getVideoTrackId(Be.VIDEO)||C.ssrc===g.video?L=Be.VIDEO:(C.trackIdentifier===r.getVideoTrackId(Be.AUXILIARY)||C.ssrc===g.auxiliary)&&(L=Be.AUXILIARY),l[L].frameWidth=C.frameWidth,l[L].frameHeight=C.frameHeight,l[L].framesSent=C.framesSent}}),r.localMainAudioTrack){let C=r.localMainAudioTrack.getInternalAudioLevel();l.audio.micAudioLevel=C,l.audio.audioLevel===0&&(l.audio.audioLevel=C)}this.totalBytesSent||(this.totalBytesSent+=l.audio.bytesSent+l.video.bytesSent+l.auxiliary.bytesSent)}catch(C){this._log.warn("failed to getStats on sender connection ".concat(C))}return l})}getReceiverStats(r){return at(this,null,function*(){let l={tinyId:r.tinyId,userId:r.userId,rtt:0,hasAudio:!1,hasVideo:!1,hasAuxiliary:!1,isSmallSubscribed:!1,audio:{bytesReceived:0,packetsReceived:0,packetsLost:0,p2pDelay:0,totalJitter:0,totalJitterCount:0,audioLevel:0,totalAudioEnergy:0,insertedSamplesForDeceleration:0,removedSamplesForAcceleration:0},video:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0},auxiliary:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0}},d=r.getPeerConnection();if(d)try{let{ssrc:g}=r,{muteState:C,subscribeState:A}=r;(this._spcStats||(yield d.getStats())).forEach(L=>{if(L.type==="inbound-rtp")if((L.mediaType||L.kind)===Be.AUDIO){if(L.ssrc!==g.audio||!C.hasAudio)return;l.audio.packetsReceived=L.packetsReceived,l.audio.bytesReceived=L.bytesReceived,l.audio.packetsLost=L.packetsLost,L.insertedSamplesForDeceleration&&(l.audio.insertedSamplesForDeceleration=L.insertedSamplesForDeceleration),L.removedSamplesForAcceleration&&(l.audio.removedSamplesForAcceleration=L.removedSamplesForAcceleration);let{remoteAudioTrack:B}=r;B.stat.packetsReceived=L.packetsReceived,B.stat.bytesReceived=L.bytesReceived,B.stat.packetsLost=L.packetsLost,l.audio.p2pDelay=B.stat.end2EndDelay,L.jitterBufferDelay&&(l.audio.totalJitter=L.jitterBufferDelay,l.audio.totalJitterCount=L.jitterBufferEmittedCount),l.hasAudio=!0}else{if(Nr&&L.bytesReceived===0)return;let B;L.ssrc===g.video&&C.hasVideo&&(l.video.packetsReceived=L.packetsReceived,l.video.bytesReceived=L.bytesReceived,l.video.packetsLost=L.packetsLost,l.video.framesReceived=L.framesReceived,l.video.framesDecoded=L.framesDecoded,l.video.fpsDecoded=L.framesPerSecond,l.hasVideo=!0,B=r.remoteVideoTrack,C.hasSmall&&A.smallVideo&&(l.isSmallSubscribed=!0),L.decoderImplementation&&(!this._prevDecoderImplementationMap.has(l.userId)||this._prevDecoderImplementationMap.get(l.userId)!==L.decoderImplementation)&&(this._log.info("".concat(l.userId," decoderImplementation change to ").concat(L.decoderImplementation)),this._prevDecoderImplementationMap.set(l.userId,L.decoderImplementation))),L.ssrc===g.auxiliary&&C.hasAuxiliary&&(l.auxiliary.packetsReceived=L.packetsReceived,l.auxiliary.bytesReceived=L.bytesReceived,l.auxiliary.packetsLost=L.packetsLost,l.auxiliary.framesReceived=L.framesReceived,l.auxiliary.framesDecoded=L.framesDecoded,l.auxiliary.fpsDecoded=L.framesPerSecond,B=r.remoteAuxiliaryTrack,l.hasAuxiliary=!0),B&&(B.stat.packetsReceived=L.packetsReceived,B.stat.bytesReceived=L.bytesReceived,B.stat.packetsLost=L.packetsLost,B.stat.framesReceived=L.framesReceived,B.stat.framesDecoded=L.framesDecoded,L.jitterBufferDelay&&(B.stat.jitterBufferDelay=Math.floor(L.jitterBufferDelay/L.jitterBufferEmittedCount*1e3)))}else L.type==="candidate-pair"&&Q_(L)&&Ti(L.currentRoundTripTime)&&(l.rtt=Math.floor(1e3*L.currentRoundTripTime),this.totalBytesReceived=L.bytesReceived);Ft(L.frameWidth)||((L.trackIdentifier===r.getMainStreamVideoTrackId()||L.ssrc===g.video)&&(l.video.frameWidth=L.frameWidth,l.video.frameHeight=L.frameHeight,r.remoteVideoTrack.stat.frameWidth=L.frameWidth,r.remoteVideoTrack.stat.frameHeight=L.frameHeight),(L.trackIdentifier===r.getAuxStreamVideoTrackId()||L.ssrc===g.auxiliary)&&(l.auxiliary.frameWidth=L.frameWidth,l.auxiliary.frameHeight=L.frameHeight,r.remoteAuxiliaryTrack.stat.frameWidth=L.frameWidth,r.remoteAuxiliaryTrack.stat.frameHeight=L.frameHeight)),!Ft(L.audioLevel)&&r.muteState.audioAvailable&&r.remoteAudioTrack.mediaTrack&&L.trackIdentifier===r.remoteAudioTrack.mediaTrack.id&&(l.audio.audioLevel=L.audioLevel||0,l.audio.totalAudioEnergy=L.totalAudioEnergy||0)}),l.audio.audioLevel===0&&r.muteState.audioAvailable&&(l.audio.audioLevel=r.remoteAudioTrack.getInternalAudioLevel()||0),this.totalBytesReceived||(this.totalBytesReceived+=l.audio.bytesReceived+l.video.bytesReceived+l.auxiliary.bytesReceived)}catch(g){this._log.warn("failed to getStats on receiver connection ".concat(g))}return l})}getStats(r,l){return at(this,null,function*(){let d={},g=[];if(this.room.singlePC){let C=this.room.singlePC.getPeerConnection();if(!C)return{senderStats:d,receiverStats:g};let A=yield C.getStats(),L=[],B=new Set(["inbound-rtp","outbound-rtp","track","candidate-pair","media-source"]);A.forEach(U=>B.has(U.type)&&L.push(U)),this._spcStats=L}r&&(d=yield this.getSenderStats(r));for(let[C,A]of l){let L=yield this.getReceiverStats(A);g.push(L)}return{senderStats:d,receiverStats:g}})}getDifferenceValue(r,l){if(sd(r))return l;let d=l-r;return d<0?0:d}prepareReport(r){let{stats:l,report:d,freezeMap:g}=r;if(!sd(l.senderStats)){let U={uint32_audio_level:l.senderStats.audio.audioLevel*Zu,uint32_audio_energy:1e6*l.senderStats.audio.totalAudioEnergy,uint32_audio_codec_bitrate:l.senderStats.audio.bytesSent};l.senderStats.audio.micAudioLevel&&(U.uint32_mic_audio_level=l.senderStats.audio.micAudioLevel*Zu);let Z=[];if(l.senderStats.video.bytesSent){let ce={uint32_video_stream_type:2,uint32_video_codec_fps:l.senderStats.video.framesSent,uint32_video_capture_fps:l.senderStats.video.fpsCapture,uint32_video_width:l.senderStats.video.frameWidth,uint32_video_height:l.senderStats.video.frameHeight,uint32_video_codec_bitrate:l.senderStats.video.bytesSent,uint32_video_enc_fps:l.senderStats.video.framesEncoded,uint32_key_frame_count:l.senderStats.video.keyFramesEncoded,uint32_nack_count:l.senderStats.video.nackCount,uint32_pli_count:l.senderStats.video.pliCount,uint32_encode_cost:1e3*(l.senderStats.video.totalEncodeTime||0),uint32_send_packet_cost:1e3*(l.senderStats.video.totalPacketSendDelay||0),uint32_video_arq_packets:l.senderStats.video.retransmittedPacketsSent};Z.push(ce)}if(l.senderStats.small.bytesSent){let ce={uint32_video_stream_type:3,uint32_video_codec_fps:l.senderStats.small.framesSent||0,uint32_video_capture_fps:l.senderStats.small.fpsCapture||0,uint32_video_width:l.senderStats.small.frameWidth||0,uint32_video_height:l.senderStats.small.frameHeight||0,uint32_video_codec_bitrate:l.senderStats.small.bytesSent,uint32_video_enc_fps:l.senderStats.small.framesEncoded||0,uint32_key_frame_count:l.senderStats.small.keyFramesEncoded,uint32_nack_count:l.senderStats.small.nackCount,uint32_pli_count:l.senderStats.small.pliCount,uint32_encode_cost:1e3*(l.senderStats.small.totalEncodeTime||0),uint32_send_packet_cost:1e3*(l.senderStats.small.totalPacketSendDelay||0),uint32_video_arq_packets:l.senderStats.small.retransmittedPacketsSent};Z.push(ce)}if(l.senderStats.auxiliary.bytesSent){let ce={uint32_video_stream_type:7,uint32_video_codec_fps:l.senderStats.auxiliary.framesSent||0,uint32_video_capture_fps:l.senderStats.auxiliary.fpsCapture||0,uint32_video_width:l.senderStats.auxiliary.frameWidth||0,uint32_video_height:l.senderStats.auxiliary.frameHeight||0,uint32_video_codec_bitrate:l.senderStats.auxiliary.bytesSent,uint32_video_enc_fps:l.senderStats.auxiliary.framesEncoded||0,uint32_key_frame_count:l.senderStats.auxiliary.keyFramesEncoded,uint32_nack_count:l.senderStats.auxiliary.nackCount,uint32_pli_count:l.senderStats.auxiliary.pliCount,uint32_encode_cost:1e3*(l.senderStats.auxiliary.totalEncodeTime||0),uint32_send_packet_cost:1e3*(l.senderStats.auxiliary.totalPacketSendDelay||0),uint32_video_arq_packets:l.senderStats.auxiliary.retransmittedPacketsSent};Z.push(ce)}let ae={uint32_bitrate:0,uint32_lost:0,uint32_rtt:l.senderStats.rtt};d.msg_up_stream_info={msg_audio_status:U,msg_video_status:Z,msg_network_status:ae}}let{statInterval:C}=this;d.msg_down_stream_info=[],l.receiverStats.forEach(U=>{let Z={msg_user_info:{str_identifier:U.userId,uint64_tinyid:U.tinyId},msg_network_status:{uint32_rtt:U.rtt,uint32_bitrate:0,uint32_lost:0},msg_audio_status:{},msg_video_status:[]};if(U.hasAudio){let ae={uint32_audio_p2p_delay:U.audio.p2pDelay,uint32_audio_cache_ms:U.audio.totalJitter,uint32_audio_cache_ms_count:U.audio.totalJitterCount,uint32_audio_codec_bitrate:U.audio.bytesReceived,uint32_audio_total_bitrate:U.audio.bytesReceived,uint32_audio_level:1e8*U.audio.audioLevel,uint32_audio_energy:1e6*U.audio.totalAudioEnergy,uint32_audio_receive:U.audio.packetsReceived,uint32_audio_origin_lost:U.audio.packetsLost};Z.msg_audio_status=ae}if(U.hasVideo){let ae=g.get("".concat(U.userId,"_").concat(Y4)),ce=ae?ae.duration:0,we={uint32_video_stream_type:U.isSmallSubscribed?3:2,uint32_video_receive_fps:U.video.framesReceived,uint32_video_width:U.video.frameWidth,uint32_video_height:U.video.frameHeight,uint32_video_codec_bitrate:U.video.bytesReceived,uint32_video_receive:U.video.packetsReceived,uint32_video_origin_lost:U.video.packetsLost,uint32_video_block_time:ce,uint32_video_dec_fps:U.video.framesDecoded};Z.msg_video_status.push(we)}if(U.hasAuxiliary){let ae=g.get("".concat(U.userId,"_").concat(J4)),ce=ae?ae.duration:0,we={uint32_video_stream_type:7,uint32_video_receive_fps:U.auxiliary.framesReceived,uint32_video_width:U.auxiliary.frameWidth,uint32_video_height:U.auxiliary.frameHeight,uint32_video_codec_bitrate:U.auxiliary.bytesReceived,uint32_video_receive:U.auxiliary.packetsReceived+U.auxiliary.packetsLost,uint32_video_origin_lost:U.auxiliary.packetsLost,uint32_video_block_time:ce,uint32_video_dec_fps:U.auxiliary.framesDecoded};Z.msg_video_status.push(we)}d.msg_down_stream_info.push(Z)});let A=this._prevReport;if(this._prevReport=JSON.parse(JSON.stringify(d)),d.msg_up_stream_info.msg_audio_status&&A.msg_up_stream_info.msg_audio_status){let U=A.msg_up_stream_info.msg_audio_status,Z=d.msg_up_stream_info.msg_audio_status;if(U.uint32_audio_codec_bitrate===0)Z.uint32_audio_codec_bitrate=0;else{let ae=this.getDifferenceValue(U.uint32_audio_codec_bitrate,Z.uint32_audio_codec_bitrate);Z.uint32_audio_codec_bitrate=Math.round(8*ae/C),d.msg_up_stream_info.msg_network_status.uint32_bitrate+=Z.uint32_audio_codec_bitrate}}let L=A.msg_up_stream_info.msg_video_status;d.msg_up_stream_info.msg_video_status.forEach(U=>{let Z=L.find(Ze=>Ze.uint32_video_stream_type===U.uint32_video_stream_type);if(!Z||Z.uint32_video_codec_bitrate===0)return U.uint32_video_codec_bitrate=0,U.uint32_video_enc_fps=0,void(U.uint32_video_codec_fps=0);let ae=0,ce=0,we=0;Z&&U.uint32_video_codec_bitrate>=Z.uint32_video_codec_bitrate&&(ae=Z.uint32_video_codec_bitrate,ce=Z.uint32_video_enc_fps,we=Z.uint32_video_codec_fps);let Pe=this.getDifferenceValue(ae,U.uint32_video_codec_bitrate);U.uint32_video_codec_bitrate=Math.round(8*Pe/C),d.msg_up_stream_info.msg_network_status.uint32_bitrate+=U.uint32_video_codec_bitrate,U.uint32_video_enc_fps=Math.round(this.getDifferenceValue(ce,U.uint32_video_enc_fps)/C),U.uint32_video_codec_fps=Math.round(this.getDifferenceValue(we,U.uint32_video_codec_fps)/C),Vm&&Gm()===115&&Z.uint32_video_width===0&&Z.uint32_video_height===0&&Z.uint32_video_codec_fps===0&&(U.uint32_video_codec_fps=U.uint32_video_enc_fps),Ft(Z.uint32_key_frame_count)||(U.uint32_key_frame_count=Math.round(this.getDifferenceValue(Z.uint32_key_frame_count,U.uint32_key_frame_count))),Ft(Z.uint32_nack_count)||(U.uint32_nack_count=Math.round(this.getDifferenceValue(Z.uint32_nack_count,U.uint32_nack_count))),Ft(Z.uint32_pli_count)||(U.uint32_pli_count=Math.round(this.getDifferenceValue(Z.uint32_pli_count,U.uint32_pli_count))),Ft(Z.uint32_video_arq_packets)||(U.uint32_video_arq_packets=Math.round(this.getDifferenceValue(Z.uint32_video_arq_packets,U.uint32_video_arq_packets))),Ft(Z.uint32_encode_cost)||(U.uint32_encode_cost=Math.round(this.getDifferenceValue(Z.uint32_encode_cost,U.uint32_encode_cost)/C)),Ft(Z.uint32_send_packet_cost)||(U.uint32_send_packet_cost=Math.round(this.getDifferenceValue(Z.uint32_send_packet_cost,U.uint32_send_packet_cost)/C))});let B=A.msg_down_stream_info;return d.msg_down_stream_info=d.msg_down_stream_info.filter(U=>B.find(Z=>Z.msg_user_info.uint64_tinyid===U.msg_user_info.uint64_tinyid)),d.msg_down_stream_info.forEach(U=>{let Z=B.find(ae=>ae.msg_user_info.uint64_tinyid===U.msg_user_info.uint64_tinyid);if(sd(U.msg_audio_status)||sd(Z.msg_audio_status))U.msg_audio_status={};else{let ae=U.msg_audio_status,ce=Z.msg_audio_status,we=this.getDifferenceValue(ce.uint32_audio_cache_ms_count,ae.uint32_audio_cache_ms_count);delete ae.uint32_audio_cache_ms_count,ae.uint32_audio_cache_ms=Math.floor(1e3*this.getDifferenceValue(ce.uint32_audio_cache_ms,ae.uint32_audio_cache_ms)/we)||0;let Pe=this.room.remotePublishedUserMap.get(U.msg_user_info.str_identifier);Pe&&(Pe.remoteAudioTrack.stat.jitterBufferDelay=ae.uint32_audio_cache_ms),ae.uint32_audio_origin_lost=this.getDifferenceValue(ce.uint32_audio_origin_lost,ae.uint32_audio_origin_lost),ae.uint32_audio_receive=this.getDifferenceValue(ce.uint32_audio_receive,ae.uint32_audio_receive),ae.uint32_audio_receive+=ae.uint32_audio_origin_lost;let Ze=this.getDifferenceValue(ce.uint32_audio_codec_bitrate,ae.uint32_audio_codec_bitrate);ae.uint32_audio_codec_bitrate=Math.round(8*Ze/C),ae.uint32_audio_total_bitrate=Math.round(8*Ze/C)}if(U.msg_video_status&&Z.msg_video_status){let ae=Z.msg_video_status;U.msg_video_status=U.msg_video_status.filter(ce=>ae.find(we=>we.uint32_video_stream_type===ce.uint32_video_stream_type)),U.msg_video_status.forEach(ce=>{let we=ae.find(Ln=>Ln.uint32_video_stream_type===ce.uint32_video_stream_type),Pe=we.uint32_video_receive,Ze=we.uint32_video_origin_lost,Ct=we.uint32_video_codec_bitrate,Bt=we.uint32_video_receive_fps,Wt=we.uint32_video_dec_fps;ce.uint32_video_origin_lost=this.getDifferenceValue(Ze,ce.uint32_video_origin_lost),ce.uint32_video_receive=this.getDifferenceValue(Pe,ce.uint32_video_receive)+ce.uint32_video_origin_lost;let kt=this.getDifferenceValue(Ct,ce.uint32_video_codec_bitrate);ce.uint32_video_codec_bitrate=Math.round(8*kt/C);let En=this.getDifferenceValue(Bt,ce.uint32_video_receive_fps);ce.uint32_video_receive_fps=Math.round(En/C),ce.uint32_video_dec_fps=Math.round(this.getDifferenceValue(Wt,ce.uint32_video_dec_fps)/C)})}}),d}getStatsReport(r){return at(this,arguments,function(l){var d=this;let{uplinkConnection:g,downlinkConnections:C,freezeMap:A}=l;return function*(){let L={msg_up_stream_info:{msg_audio_status:{uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_level:0,uint32_audio_energy:0},msg_video_status:[],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}},msg_down_stream_info:[{msg_user_info:{str_identifier:"",uint64_tinyid:0},msg_audio_status:{uint32_audio_cache_ms:0,uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_total_bitrate:0,uint32_audio_level:0,uint32_audio_energy:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_final_lost:0},msg_video_status:[{uint32_video_stream_type:0,uint32_video_receive_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_codec_bitrate:0,uint32_video_receive:0,uint32_video_origin_lost:0,uint32_video_block_time:0,uint32_video_dec_fps:0}],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}}]},B=yield d.getStats(g,C);return JSON.stringify(d._prevReport)==="{}"&&(d._prevReport=JSON.parse(JSON.stringify(L))),d.prepareReport({stats:B,report:L,freezeMap:A}),d._prevReportTime=Date.now(),L}()})}reset(){this._prevReportTime=0,this._prevReport={},this._prevEncoderImplementation="",this._prevQualityLimitationReason="",this._prevDecoderImplementationMap=new Map}},Eie=Vi(qa()),tG=class extends Eie.default{constructor(r){let{signalChannel:l,room:d}=r;super(),Se(this,"_room"),Se(this,"_signalChannel"),Se(this,"_log"),Se(this,"_uplinkRTT",0),Se(this,"_uplinkLoss",0),Se(this,"_downlinkRTT",0),Se(this,"_downlinkLoss",0),Se(this,"_downlinkPrevStatMap",new Map),Se(this,"_downlinkLossAndRTTMap",new Map),Se(this,"_interval",-1),Se(this,"_uplinkNetworkQuality",0),Se(this,"_downlinkNetworkQuality",0),this._room=d,this._signalChannel=l,this._log=pn.createLogger({id:"q",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this.initialize()}get uplinkNetworkQuality(){return this._uplinkNetworkQuality}set uplinkNetworkQuality(r){r!==this._uplinkNetworkQuality&&this._log.info("uplink ".concat(this.uplinkNetworkQuality," -> ").concat(r,", rtt: ").concat(this._uplinkRTT,", loss: ").concat(this._uplinkLoss)),this._uplinkNetworkQuality=r}get downlinkNetworkQuality(){return this._downlinkNetworkQuality}set downlinkNetworkQuality(r){if(r!==this._downlinkNetworkQuality){let{rtt:l,loss:d}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._log.info("downlink ".concat(this.downlinkNetworkQuality," -> ").concat(r,", rtt: ").concat(l,", loss: ").concat(d))}this._downlinkNetworkQuality=r}initialize(){this._signalChannel.on(go.UPLINK_NETWORK_STATS,r=>{this.handleUplinkNetworkQuality(r)}),this._signalChannel.on(JR,this.handleSignalConnectionStateChange.bind(this)),this.start()}handleUplinkNetworkQuality(r){var l,d;if(r.data.code!==0)return;let g=r.data.data;if(g.delay&&this.updateDelay(g.delay),!this._room.uplinkConnection)return this.uplinkNetworkQuality=0,this._uplinkLoss=0,void(this._uplinkRTT=0);let C=(d=(l=this._room)==null?void 0:l.uplinkConnection)==null?void 0:d.getPeerConnection();if(C&&this.isPeerConnectionDisconnected(C))return this.uplinkNetworkQuality=6,this._uplinkLoss=0,void(this._uplinkRTT=0);let A=g.expectAudPkg+g.expectVidPkg,L=g.recvAudPkg+g.recvVidPkg,B=A-L;A===0&&L===0||(this._uplinkLoss=B<=0?0:Math.round(B/A*100),this._uplinkRTT=g.rtt,this.uplinkNetworkQuality=this.getNetworkQuality(this._uplinkLoss,this._uplinkRTT))}handleDownlinkNetworkQuality(){return at(this,null,function*(){if(this._room.remotePublishedUserMap.size===0)return void(this.downlinkNetworkQuality=0);let r=[...this._room.remotePublishedUserMap.values()],l=r.filter(C=>{var A;return((A=C.getPeerConnection())==null?void 0:A.connectionState)===ni.CONNECTED});if(r.filter(C=>this.isPeerConnectionDisconnected(C.getPeerConnection())).length===r.length)return void(this.downlinkNetworkQuality=6);for(let C=0;C<l.length;C++){let A=l[C].getPeerConnection();if(!A)return;let{rtt:L,totalPacketsLost:B,totalPacketsReceived:U}=yield this.getStat(A);if(!this._downlinkPrevStatMap.has(A)){this._downlinkPrevStatMap.set(A,{totalPacketsLost:B,totalPacketsReceived:U});continue}let Z=0,ae=this._downlinkPrevStatMap.get(A),ce=B-ae.totalPacketsLost,we=U-ae.totalPacketsReceived;Z=ce<=0||we<0?0:Math.round(ce/(ce+we)*100),this._downlinkPrevStatMap.set(A,{totalPacketsLost:B,totalPacketsReceived:U}),this._downlinkLossAndRTTMap.set(A,{rtt:L,loss:Z,userId:l[C].getUserId(),audioDelay:l[C].remoteAudioTrack.stat.end2EndDelay,videoDelay:l[C].remoteVideoTrack.stat.end2EndDelay})}if([...this._downlinkPrevStatMap.keys()].forEach(C=>{this.isPeerConnectionDisconnected(C)&&(this._downlinkPrevStatMap.delete(C),this._downlinkLossAndRTTMap.delete(C))}),this._downlinkLossAndRTTMap.size===0)return;let{rtt:d,loss:g}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._downlinkRTT=d,this._downlinkLoss=g,this.downlinkNetworkQuality=this.getNetworkQuality(g,d)})}getStat(r){return at(this,null,function*(){let l={rtt:0,totalPacketsLost:0,totalPacketsReceived:0};if(!r||!$C())return l;let d=r.getReceivers();try{for(let g=0;g<d.length;g++)(yield d[g].getStats()).forEach(C=>{C.type==="candidate-pair"&&Ti(C.currentRoundTripTime)&&(l.rtt=Math.round(1e3*C.currentRoundTripTime)),C.type==="inbound-rtp"&&(C.mediaType===Be.AUDIO||C.mediaType===Be.VIDEO)&&(l.totalPacketsLost+=C.packetsLost,l.totalPacketsReceived+=C.packetsReceived)});return l}catch{return l}})}getAverageLossAndRTT(r){let l={rtt:0,loss:0};return Array.isArray(r)&&r.length>0&&(r.forEach(d=>{l.rtt+=d.rtt,l.loss+=d.loss}),Object.keys(l).forEach(d=>{l[d]=Math.round(l[d]/r.length)})),l}getNetworkQuality(r,l){return r>50||l>500?5:r>30||l>350?4:r>20||l>200?3:r>10||l>100?2:r>=0||l>=0?1:0}handleSignalConnectionStateChange(r){r.state==="DISCONNECTED"?(this._uplinkRTT=0,this._uplinkLoss=0,this.uplinkNetworkQuality=6):r.state==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}handleUplinkConnectionStateChange(r){let{state:l}=r;l==="DISCONNECTED"?(this._uplinkLoss=0,this._uplinkRTT=0,this.uplinkNetworkQuality=6):l==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}isPeerConnectionDisconnected(r){return!(!r||r.connectionState!==ni.DISCONNECTED&&r.connectionState!==ni.FAILED&&r.connectionState!==ni.CLOSED)}setUplinkConnection(r){this._room.uplinkConnection=r,this._room.uplinkConnection?this._room.uplinkConnection.on("connection-state-changed",this.handleUplinkConnectionStateChange.bind(this)):(this.uplinkNetworkQuality=0,this._uplinkRTT=0,this._uplinkLoss=0)}start(){this._interval===-1?(this._log.debug("start network quality calculating"),this._interval=Hr.run(Um,()=>{this.handleDownlinkNetworkQuality();let r=[...this._downlinkLossAndRTTMap.values()];en.emit($t.NETWORK_QUALITY,{room:this._room,uplink:{rtt:this._uplinkRTT,loss:this._uplinkLoss},downlinks:r}),this.emit(tG.EVENT_NETWORK_QUALITY,{uplinkNetworkQuality:this.uplinkNetworkQuality,downlinkNetworkQuality:this.downlinkNetworkQuality,uplinkRTT:this._uplinkRTT,uplinkLoss:this._uplinkLoss,downlinkRTT:this._downlinkRTT,downlinkLoss:this._downlinkLoss,downlinkInfo:r})},{delay:2e3})):this._log.info("network quality calculating is already started")}stop(){this._log.debug("stopped"),this._interval!==-1&&(Hr.clearTask(this._interval),this._interval=-1),this._downlinkLossAndRTTMap.clear(),this._downlinkPrevStatMap.clear()}updateDelay(r){let{tinyIdToUserIdMap:l}=this._room;r.forEach(d=>{let{srcTinyId:g,videoDelay:C,audioDelay:A}=d,L=l.get(g);if(L){let B=this._room.remotePublishedUserMap.get(L);B==null||B.setDelay({videoDelay:C,audioDelay:A})}})}},rA=tG;Se(rA,"EVENT_NETWORK_QUALITY","0");var nG=class{constructor(r){this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._eventMap=new Map,this._frameWorkType=r.frameWorkType||30,this._component=r.component||0,this.connectionType=r.connectionType||1,this._language=r.language||0,this._room=r.room,this._keyPrefix="key_point",this._log=pn.createLogger({id:"kpm",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),Object.getOwnPropertyNames(this.__proto__).forEach(l=>{l.startsWith("handle")&&Er(this[l])&&(this[l]=function(d){let{fn:g,context:C}=d;return function(){try{for(var A=arguments.length,L=new Array(A),B=0;B<A;B++)L[B]=arguments[B];let U=g.apply(C,L);return dR(U)?U.catch(Z=>pn.error("".concat(g.name,"() error observed ").concat(Z))):U}catch(U){pn.error("".concat(g.name,"() error observed ").concat(U))}}}({fn:this[l],context:this}))}),this.initData(),this.installEvents(),this._intervalId=Hr.run(Um,this.setStorage.bind(this),{delay:2e4})}get _storageKey(){return"".concat(this._keyPrefix,"_").concat(this._room.userId)}initData(){this._firstPublishedUserList=[],this._networkQuality={totalUplinkRTT:0,totalUplinkLoss:0,count:0,totalDownlinkRTTAndLossMap:new Map},this._basicInfo={string_sdk_version:Ol,uint32_os_type:15,string_device_name:"",string_http_user_agent:navigator.userAgent,string_os_version:"",uint32_avg_rtt:0,uint32_avg_up_loss:0,uint32_scene:this._room.scene==="live"?1:0,uint32_joining_duration:0,uint32_networkType:0,uint32_framework:this._frameWorkType,uint32_component:this._component,uint32_connection_type:this.connectionType,uint32_caller_coding_language:this._language,string_domain:location.hostname},this._pathJoinRoom={uint64_start_time:0,uint64_send_request_acc_ip_cmd_start_time:0,uint64_send_request_acc_ip_cmd_end_time:0,uint64_send_request_enter_room_cmd_start_time:0,uint64_send_request_enter_room_cmd_end_time:0,uint64_send_first_video_frame_time:0,uint64_recv_userlist_time:0,uint64_end_time:0,int32_send_request_acc_ip_cmd_ret:0,int32_send_request_enter_room_cmd_ret:0,int32_end_ret:0},this._pathLeaveRoom={uint64_start_time:0,uint64_send_request_exit_room_cmd_start_time:0,uint64_send_request_exit_room_cmd_end_time:0,uint64_end_time:0,int32_send_request_exit_room_cmd_ret:0,int32_end_ret:0},this._localStreamStat={totalVideoBitrate:0,totalVideoFPS:0,totalVideoHeight:0,totalVideoWidth:0,totalAudioLevel:0,videoCount:0,audioLevelCount:0,publishStartTime:0,statsToReport:{uint32_audio_capture_db:0,uint32_video_big_capture_fps:0,uint32_video_big_bitrate:0,uint32_video_big_resolution:0}},this._pathMainVideoMap=new Map,this._pathMainAudioMap=new Map,this._pathAuxiliaryMap=new Map,this._remoteStreamStatMap=new Map,aR().then(r=>{this._basicInfo.string_os_version=lR(),this._basicInfo.string_device_name=r&&r.mobile?r.model:this._basicInfo.string_os_version})}addEvent(r,l){return this._eventMap.set(r,l),en.on(r,l),this}installEvents(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("unload",this.handleUnload),this._room.once("banned",()=>this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})),this.addEvent($t.JOIN_START,this.handleJoinStart).addEvent($t.JOIN_SCHEDULE_SUCCESS,this.handleJoinScheduleSuccess).addEvent($t.JOIN_SIGNAL_CONNECTION_START,this.handleSignalConnectionStart).addEvent($t.JOIN_SIGNAL_CONNECTION_END,this.handleSignalConnectionEnd).addEvent($t.JOIN_SEND_CMD,this.handleJoinSendCMD).addEvent($t.JOIN_RECEIVED_CMD_RES,this.handleJoinReceivedCMDResponce).addEvent($t.JOIN_SUCCESS,this.handleJoinSuccess).addEvent($t.JOIN_FAILED,this.handleJoinFailed).addEvent($t.LEAVE_START,this.handleLeaveStart).addEvent($t.LEAVE_SUCCESS,this.handleLeaveSuccess).addEvent($t.LEAVE_SEND_CMD,this.handleLeaveSendCMD).addEvent($t.LOCAL_TRACK_CAPTURE_START,this.handleTrackCaptureStart).addEvent($t.LOCAL_TRACK_CAPTURE_SUCCESS,this.handleTrackCaptureSuccess).addEvent($t.LOCAL_TRACK_CAPTURE_FAILED,this.handleTrackCaptureFailed).addEvent($t.PUBLISH_START,this.handlePublishStart).addEvent($t.SEND_FIRST_VIDEO_FRAME,this.handleSendFirstVideoFrame).addEvent($t.SUBSCRIBE_START,this.handleSubscribeStart).addEvent($t.SUBSCRIBE_SUCCESS,this.handleSubscribed).addEvent($t.PLAY_TRACK_START,this.handlePlayStart).addEvent($t.VIDEO_LOADED_DATA,this.handleVideoLoadedData).addEvent($t.PLAYER_STATE_CHANGED,r=>{let{track:l,state:d,type:g}=r;!qm(l)||!this.hitTest(l.room)||d==="PLAYING"&&(g===Be.AUDIO?this.handleAudioPlaying(l):this.handleVideoPlaying(l))}).addEvent($t.NETWORK_QUALITY,this.handleNetworkQuality).addEvent($t.HEARTBEAT_REPORT,this.handleHeartbeatStats).addEvent($t.RECEIVED_PUBLISHED_USER_LIST,this.handleReceivedPublishUserList).addEvent($t.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:l,prevMuteState:d,muteState:g}=r;if(!this.hitTest(l))return;let C=d.hasAudio||d.hasVideo||d.hasSmall,A=d.hasAuxiliary,L=g.hasAudio||g.hasVideo||g.hasSmall,B=g.hasAuxiliary;!C&&L&&this.handleRemoteStreamAdded(g.userId,"main"),!A&&B&&this.handleRemoteStreamAdded(g.userId,"auxiliary")}).addEvent($t.SINGLE_CONNECTION_STAT,r=>{let{room:l,stat:d}=r;this.hitTest(l)&&(this._pathJoinRoom.int32_ice_cost=d.ice,this._pathJoinRoom.int32_dtls_cost=d.dtls,this._pathJoinRoom.int32_peer_connection_cost=d.peerConnection)})}uninstallEvents(){window.removeEventListener("unload",this.handleUnload),this._eventMap.forEach((r,l)=>en.off(l,r)),this._eventMap.clear()}destroy(){this.uninstallEvents(),Hr.clearTask(this._intervalId)}handleUnload(){this._room.isJoined&&this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})}handleJoinStart(r){this.hitTest(r.room)&&(this._pathJoinRoom.uint64_start_time===0&&(this._pathJoinRoom.uint64_start_time=Date.now(),this.checkStorage()),r.params&&(Ft(r.params.frameWorkType)||(this._frameWorkType=r.params.frameWorkType,this._basicInfo.uint32_framework=this._frameWorkType),Ft(r.params.component)||(this._component=r.params.component,this._basicInfo.uint32_component=this._component),Ft(r.params.language)||(this._language=r.params.language,this._basicInfo.uint32_caller_coding_language=this._language)))}handleJoinScheduleSuccess(r){let{room:l,detailCost:d}=r;if(this.hitTest(l)&&d){let{totalCost:g,local:C,dns:A,tcp:L,tls:B,request:U,response:Z}=d;this._pathJoinRoom.int32_schedule_cost=g,this._pathJoinRoom.int32_schedule_local=C,this._pathJoinRoom.int32_schedule_dns=A,this._pathJoinRoom.int32_schedule_tcp=L,this._pathJoinRoom.int32_schedule_tls=B,this._pathJoinRoom.int32_schedule_request=U,this._pathJoinRoom.int32_schedule_response=Z}}handleSignalConnectionStart(r){let{room:l}=r;this.hitTest(l)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time=Date.now())}handleSignalConnectionEnd(r){let{room:l,error:d}=r;this.hitTest(l)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time=Date.now(),d&&(this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret=d instanceof Rn?Number(d.getExtraCode()||d.getCode()):an.UNKNOWN,this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret))}handleJoinSendCMD(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time=Date.now())}handleJoinReceivedCMDResponce(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time=Date.now(),this._pathJoinRoom.int32_send_request_enter_room_cmd_ret=r.code,r.code!==0&&(this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_enter_room_cmd_ret))}handleJoinSuccess(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_end_time===0&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret=0,this._signalInfo=r.room.getSignalInfo())}handleJoinFailed(r){let{room:l,error:d}=r;this.hitTest(l)&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret===0&&(this._pathJoinRoom.int32_end_ret=d.code||this._pathJoinRoom.int32_send_request_enter_room_cmd_ret||this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret),setTimeout(()=>{this.report()}))}handleReceivedPublishUserList(r){this.hitTest(r.room)&&this._pathJoinRoom.uint64_recv_userlist_time===0&&(this._pathJoinRoom.uint64_recv_userlist_time=Date.now(),this._firstPublishedUserList=r.publishedUserList||[])}handleSendFirstVideoFrame(r){let{room:l}=r;!this.hitTest(l)||this._pathJoinRoom.uint64_send_first_video_frame_time===0&&this._pathJoinRoom.uint64_start_time!==0&&(this._pathJoinRoom.uint64_send_first_video_frame_time=Date.now())}handleLeaveStart(r){this.hitTest(r.room)&&(this._pathLeaveRoom.uint64_start_time=Date.now())}handleLeaveSuccess(r){this.hitTest(r.room)&&this._pathLeaveRoom.uint64_end_time===0&&(this._pathLeaveRoom.uint64_end_time=Date.now(),this._pathJoinRoom.uint64_end_time!==0?this._basicInfo.uint32_joining_duration=this._pathLeaveRoom.uint64_end_time-this._pathJoinRoom.uint64_end_time:this._log.warn("pathJoinRoom endTime is 0"),this.report())}handleLeaveSendCMD(r){this.hitTest(r.room)&&(this._pathLeaveRoom.uint64_send_request_exit_room_cmd_start_time=Date.now(),this._pathLeaveRoom.uint64_send_request_exit_room_cmd_end_time=Date.now())}handleRemoteStreamAdded(r,l){var d;let g="".concat(r,"_").concat(l);if(!this._remoteStreamStatMap.has(g)){let C={userId:r,totalVideoFPS:0,totalVideoBitrate:0,totalAudioLevel:0,totalAudioBitrate:0,totalLoss:0,audioCount:0,audioLevelCount:0,videoCount:0,networkQualityCount:0,streamAddedTime:Date.now(),subscribeStartTime:0,subscribedTime:0,playStreamTime:0,statsToReport:Io(Fn({},Tie),{msg_user_info:new iA({userId:r,tinyId:(d=this._room.remotePublishedUserMap.get(r))==null?void 0:d.tinyId,role:20})})};C.statsToReport.uint32_stream_type=l==="main"?2:7,this._remoteStreamStatMap.set(g,C)}}handleSubscribeStart(r){let{room:l,remotePublishedUser:d,streamType:g,subscribeState:C}=r;if(!this.hitTest(l))return;let{userId:A,tinyId:L,role:B}=d,U=new iA({userId:A,tinyId:L,role:B==="anchor"?20:21}),Z=Date.now(),ae="".concat(A,"_").concat(g),ce=this._remoteStreamStatMap.get(ae);ce&&ce.subscribeStartTime===0&&(ce.subscribeStartTime=Z),g==="main"?(d.muteState.hasVideo&&(C.video||C.smallVideo)&&!this._pathMainVideoMap.has(ae)&&this._pathMainVideoMap.set(ae,{statsToReport:{msg_user_info:U,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_render_first_frame_time:0,uint64_combine_first_frame_time:0},userId:A,sendSubscribeCMDTime:Z}),d.muteState.hasAudio&&C.audio&&!this._pathMainAudioMap.has(ae)&&this._pathMainAudioMap.set(ae,{statsToReport:{msg_user_info:U,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_play_first_frame_time:0},userId:A,sendSubscribeCMDTime:Z})):d.muteState.hasAuxiliary&&C.auxiliary&&!this._pathAuxiliaryMap.has(ae)&&this._pathAuxiliaryMap.set(ae,{sendSubscribeCMDTime:Z})}handleSubscribed(r){let{room:l,remotePublishedUser:d,streamType:g}=r;if(this.hitTest(l)){let C="".concat(d.userId,"_").concat(g),A=this._remoteStreamStatMap.get(C);A&&A.subscribedTime===0&&(A.subscribedTime=Date.now())}}handlePlayStart(r){let{track:l}=r;if(!qm(l)||!this.hitTest(l.room))return;let d="".concat(l.userId,"_").concat(l.streamType),g=this._remoteStreamStatMap.get(d);(g==null?void 0:g.playStreamTime)===0&&(g.playStreamTime=Date.now())}handleVideoLoadedData(r){let{track:l}=r;if(!qm(l)||!this.hitTest(l.room))return;let d="".concat(l.userId,"_").concat(l.streamType),g=this._pathMainVideoMap.get(d);g&&g.statsToReport.uint64_combine_first_frame_time===0&&(g.statsToReport.uint64_combine_first_frame_time=Date.now())}handleVideoPlaying(r){let l="".concat(r.userId,"_").concat(r.streamType),d=Date.now(),g=this._pathMainVideoMap.get(l),C=this._remoteStreamStatMap.get(l);if(g&&(g.statsToReport.uint64_render_first_frame_time===0&&(g.statsToReport.uint64_render_first_frame_time=d),C)){let{statsToReport:L,playStreamTime:B,subscribedTime:U}=C;L.uint32_video_render_first===0&&B-U<=100&&(L.uint32_video_render_first=d-g.sendSubscribeCMDTime)}let A=this._pathAuxiliaryMap.get(l);if(A&&C){let{statsToReport:L,playStreamTime:B,subscribedTime:U}=C;L.uint32_video_render_first===0&&B-U<=100&&(L.uint32_video_render_first=d-A.sendSubscribeCMDTime)}}handleAudioPlaying(r){let l="".concat(r.userId,"_").concat(r.streamType),d=this._pathMainAudioMap.get(l);d&&d.statsToReport.uint64_play_first_frame_time===0&&(d.statsToReport.uint64_play_first_frame_time=Date.now())}handleNetworkQuality(r){this.hitTest(r.room)&&(this._networkQuality.totalUplinkLoss+=r.uplink.loss,this._networkQuality.totalUplinkRTT+=r.uplink.rtt,this._networkQuality.count++,r.downlinks.forEach(l=>{let{rtt:d,loss:g,userId:C,videoDelay:A,audioDelay:L}=l,B=this._networkQuality.totalDownlinkRTTAndLossMap.get(C);if(B)B.totalRTT+=d,B.totalLoss+=g,A&&(B.totalVideoDelay=(B.totalVideoDelay||0)+A,B.videoDelayCount=(B.videoDelayCount||0)+1),L&&(B.totalAudioDelay=(B.totalAudioDelay||0)+L,B.audioDelayCount=(B.audioDelayCount||0)+1),B.count++;else{let U,Z,ae,ce;A&&(Z=A,ae=1),L&&(U=L,ce=1),this._networkQuality.totalDownlinkRTTAndLossMap.set(C,{totalRTT:d,totalLoss:g,count:1,totalAudioDelay:U,totalVideoDelay:Z,audioDelayCount:ce,videoDelayCount:ae})}}))}handleHeartbeatStats(r){if(this.hitTest(r.room)){let{msg_up_stream_info:l,msg_down_stream_info:d}=r.report;if(l.msg_video_status[0]){let{uint32_video_codec_bitrate:g,uint32_video_enc_fps:C,uint32_video_width:A,uint32_video_height:L}=l.msg_video_status[0];this._localStreamStat.totalVideoBitrate+=g,this._localStreamStat.totalVideoFPS+=C,this._localStreamStat.totalVideoWidth+=A,this._localStreamStat.totalVideoHeight+=L,this._localStreamStat.videoCount++}if(l.msg_audio_status){let{uint32_audio_level:g}=l.msg_audio_status;Math.floor(g/Zu*100)>0&&(this._localStreamStat.totalAudioLevel+=g/Zu,this._localStreamStat.audioLevelCount++)}d.forEach(g=>{let{msg_user_info:C,msg_audio_status:A,msg_video_status:L}=g,B=C.str_identifier,U=this._room.remotePublishedUserMap.get(B);if(L.forEach(Z=>{let ae=Z.uint32_video_stream_type===2,ce=Z.uint32_video_stream_type===7,we="".concat(B,"_").concat(ae?"main":"auxiliary"),Pe=this._remoteStreamStatMap.get(we);if(Pe&&(ae&&(U!=null&&U.remoteVideoTrack.isSubscribed)||ce&&(U!=null&&U.remoteAuxiliaryTrack))){Pe.totalVideoFPS+=Z.uint32_video_receive_fps,Pe.totalVideoBitrate+=Z.uint32_video_codec_bitrate,Pe.videoCount++,Pe.statsToReport.uint32_video_width===0&&(Pe.statsToReport.uint32_video_width=Z.uint32_video_width),Pe.statsToReport.uint32_video_height===0&&(Pe.statsToReport.uint32_video_height=Z.uint32_video_height);let Ze=ae?U.remoteVideoTrack:U.remoteAuxiliaryTrack;Ze.stat.jitterBufferDelay&&(Pe.videoJitterBufferDelay=Ze.stat.jitterBufferDelay),Ze.stat.framesReceived&&(Pe.statsToReport.uint32_video_consume_render_rate=Math.floor(Ze.stat.framesDecoded/Ze.stat.framesReceived*yw(10,6)))}}),A){let Z="".concat(B,"_","main"),ae=this._remoteStreamStatMap.get(Z);this._remoteStreamStatMap.has(Z)&&ae&&(U!=null&&U.remoteAudioTrack.isSubscribed)&&(ae.totalAudioBitrate+=A.uint32_audio_codec_bitrate,ae.audioCount++,U.remoteAudioTrack.stat.jitterBufferDelay&&(ae.audioJitterBufferDelay=U.remoteAudioTrack.stat.jitterBufferDelay),Math.floor(A.uint32_audio_level/Zu*100)>0&&(ae.totalAudioLevel+=A.uint32_audio_level/Zu,ae.audioLevelCount++))}})}}handlePublishStart(r){let{room:l}=r;this.hitTest(l)&&this._localStreamStat.publishStartTime===0&&(this._localStreamStat.publishStartTime=Date.now())}handleTrackCaptureStart(r){let{track:l}=r;l.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_start_time&&(this._pathJoinRoom.uint64_init_audio_start_time=Date.now()),l.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_start_time&&(this._pathJoinRoom.uint64_init_camera_start_time=Date.now())}handleTrackCaptureSuccess(r){let{track:l}=r;l.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=0,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),l.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=0,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}handleTrackCaptureFailed(r){let{track:l,error:d}=r,g={NotFoundError:1,NotAllowedError:2,NotReadableError:3,OverConstrainedError:4,AbortError:5,InvalidStateError:6,SecurityError:7,TypeError:8}[d.name]||(d instanceof Rn?d.getExtraCode()||d.getCode():an.UNKNOWN);l.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=g,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),l.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=g,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}hasVideoFlag(r){return this._firstPublishedUserList.findIndex(l=>l.userId===r&&l.flag&k_)>=0}hasAudioFlag(r){return this._firstPublishedUserList.findIndex(l=>l.userId===r&&l.flag&w_)>=0}hasAuxFlag(r){return this._firstPublishedUserList.findIndex(l=>l.userId===r&&l.flag&_C)>=0}hitTest(r){return r===this._room}checkStorage(){return at(this,null,function*(){try{let r=Km.getItem(this._storageKey);r&&(yield this.upload(r),Km.deleteItem(this._storageKey))}catch(r){this._log.warn(r)}})}setStorage(){this.prepareReport();let r=this.getReportData();r.msg_path_enter_room.uint64_start_time!==0&&Km.setItem(this._storageKey,r)}prepareReport(){if(this._networkQuality.count>0&&(this._basicInfo.uint32_avg_rtt=Math.floor(this._networkQuality.totalUplinkRTT/this._networkQuality.count),this._basicInfo.uint32_avg_up_loss=Math.floor(this._networkQuality.totalUplinkLoss/this._networkQuality.count)),this._localStreamStat.videoCount>0){this._localStreamStat.statsToReport.uint32_video_big_capture_fps=Math.floor(this._localStreamStat.totalVideoFPS/this._localStreamStat.videoCount),this._localStreamStat.statsToReport.uint32_video_big_bitrate=Math.floor(this._localStreamStat.totalVideoBitrate/this._localStreamStat.videoCount);let r=Math.floor(this._localStreamStat.totalVideoWidth/this._localStreamStat.videoCount),l=Math.floor(this._localStreamStat.totalVideoHeight/this._localStreamStat.videoCount);this._localStreamStat.statsToReport.uint32_video_big_resolution=r<<16|l}this._localStreamStat.audioLevelCount>0&&(this._localStreamStat.statsToReport.uint32_audio_capture_db=Math.floor(this._localStreamStat.totalAudioLevel/this._localStreamStat.audioLevelCount*100)),this._remoteStreamStatMap.forEach((r,l)=>{let{userId:d}=r,g=this._networkQuality.totalDownlinkRTTAndLossMap.get(d);if(g){let{totalLoss:Z,count:ae,audioDelayCount:ce,videoDelayCount:we,totalAudioDelay:Pe,totalVideoDelay:Ze}=g;r.statsToReport.uint32_avg_down_loss=Math.floor(Z/ae),ce&&Pe&&(r.statsToReport.uint32_audio_network_p2p_delay=Math.floor(Pe/ce),r.audioJitterBufferDelay&&(r.statsToReport.uint32_p2p_delay=Math.floor(r.statsToReport.uint32_audio_network_p2p_delay+r.audioJitterBufferDelay))),we&&Ze&&(r.statsToReport.uint32_video_network_p2p_delay=Math.floor(Ze/we))}r.videoCount>0&&(r.statsToReport.uint32_video_avg_fps=Math.floor(r.totalVideoFPS/r.videoCount),r.statsToReport.uint32_video_avg_bitrate=Math.floor(r.totalVideoBitrate/r.videoCount)),r.audioCount>0&&(r.statsToReport.uint32_audio_recv_bitrate=r.statsToReport.uint32_audio_bitrate=Math.floor(r.totalAudioBitrate/r.audioCount)),r.audioLevelCount>0&&(r.statsToReport.uint32_audio_play_db=Math.floor(r.totalAudioLevel/r.audioLevelCount*100));let{callDurationCalculator:C}=this._room;C&&(r.statsToReport.uint32_audio_play_time=C.getDuration(l,Be.AUDIO),r.statsToReport.uint32_video_play_time=C.getDuration(l,Be.VIDEO)),r.statsToReport.uint32_video_render_first=Math.min(r.statsToReport.uint32_video_render_first,_f);let{badCaseDetector:A}=this._room,{dataFreeze:L,count:B}=A.getDataFreezeDuration(l),{renderFreeze:U}=A.getRenderFreezeDuration(l);r.statsToReport.uint32_video_block_count=B,r.statsToReport.uint32_video_block_time=Math.min(L,r.statsToReport.uint32_video_play_time),r.statsToReport.uint32_video_external_block_time=Math.min(U,r.statsToReport.uint32_video_play_time),A.isBlackStream(l)&&r.statsToReport.uint32_video_avg_fps===0?r.statsToReport.uint32_video_black_screen_subjective=1:r.statsToReport.uint32_video_black_screen_subjective=0,(r.subscribeStartTime===0||r.subscribeStartTime-r.streamAddedTime>100||r.playStreamTime===0)&&(this._pathMainAudioMap.delete(l),this._pathMainVideoMap.delete(l),r.statsToReport.uint32_video_render_first=0)}),this._pathMainAudioMap.forEach((r,l)=>{this.hasAudioFlag(r.userId)?r.statsToReport.uint64_play_first_frame_time-r.statsToReport.uint64_start_enter_time>_f&&(r.statsToReport.uint64_play_first_frame_time=r.statsToReport.uint64_start_enter_time+_f):this._pathMainAudioMap.delete(l)}),this._pathMainVideoMap.forEach((r,l)=>{this.hasVideoFlag(r.userId)?r.statsToReport.uint64_render_first_frame_time-r.statsToReport.uint64_start_enter_time>_f&&(r.statsToReport.uint64_render_first_frame_time=r.statsToReport.uint64_start_enter_time+_f):this._pathMainVideoMap.delete(l)}),this._pathJoinRoom.uint64_end_time-this._pathJoinRoom.uint64_start_time>_f&&(this._pathJoinRoom.uint64_end_time=this._pathJoinRoom.uint64_start_time+_f)}getReportData(){this._basicInfo.uint32_networkType=UC();let r={uint32_sdk_app_id:Number(this._room.sdkAppId),msg_user_info:new iA({userId:this._room.userId,tinyId:this._room.tinyId,role:this._room.role==="anchor"?20:21}),msg_basic_info:this._basicInfo,uint32_acc_ip:FC(this._signalInfo.relayIp),uint32_client_ip:FC(this._signalInfo.clientIp,!1),uint32_acc_port:this._signalInfo.relayPort||0,uint64_timestamp:Date.now(),uint32_seq:Math.floor(Math.random()*yw(2,31)),msg_path_enter_room:this._pathJoinRoom,msg_path_exit_room:this._pathLeaveRoom,msg_path_recv_video:[...this._pathMainVideoMap.values()].map(l=>l.statsToReport),msg_quality_statistics:[...this._remoteStreamStatMap.values()].map(l=>l.statsToReport),str_room_name:String(this._room.roomId||0),msg_path_recv_audio:[...this._pathMainAudioMap.values()].map(l=>l.statsToReport),uint32_info_client_ip:FC(this._signalInfo.clientIp,!1),error_code:[],msg_local_statistics:this._localStreamStat.statsToReport};return mR(r),r}report(){return at(this,null,function*(){try{this.prepareReport();let r=this.getReportData();yield this.upload(r),Km.deleteItem(this._storageKey),this.initData()}catch(r){this._log.warn(r)}})}upload(r){return at(this,null,function*(){if(af&&!fF||r.msg_path_enter_room.uint64_start_time===0||[kw,G4,B4].findIndex(L=>L===location.host)>=0)return;let l=Number(this._room.sdkAppId),d=yield rF(r),g=d instanceof ArrayBuffer,C="".concat(W_(l,M_.KEY_POINT),"&gzip=").concat(+g),A=!1;navigator.sendBeacon&&(A=navigator.sendBeacon(C,d)),A||N_({url:C,body:d}),this.uploadKVStat(Lo),this.uploadKVStat(iy)})}setConnectionType(r){this.connectionType=r,this._basicInfo.uint32_connection_type=r}uploadKVStat(r){return at(this,null,function*(){let l=r.getReportData();if(l.stats_count.length===0&&l.stats_distribution.length===0)return;l.msg_sdk_basic_info=Io(Fn({},l.msg_sdk_basic_info),{bytes_device_name:this._basicInfo.string_device_name||"",bytes_os_version:this._basicInfo.string_os_version||"",uint32_framework:this._frameWorkType,uint32_network_type:this._basicInfo.uint32_networkType||0}),this._log.debug(l);let d=yield rF(l),g="".concat(W_(+this._room.sdkAppId,M_.KV_STAT),"&gzip=").concat(+(d instanceof ArrayBuffer)),C=!1;navigator.sendBeacon&&(C=navigator.sendBeacon(g,d)),C||N_({url:g,body:d})})}};In([Cy({settings:{timeout:500,retries:3}})],nG.prototype,"upload");var _f=5e3,Tie={msg_user_info:null,uint32_video_avg_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_avg_bitrate:0,uint32_video_block_time:0,uint32_video_play_time:0,uint32_audio_block_time:0,uint32_audio_play_time:0,uint32_audio_play_db:0,uint32_avg_down_loss:0,uint32_stream_type:0,uint32_video_render_first:0,uint32_video_block_count:0,uint32_audio_block_count:0,uint32_audio_bitrate:0,uint32_video_black_screen_subjective:0,uint32_audio_recv_bitrate:0,uint32_video_external_block_time:0,uint32_video_consume_render_rate:0},iA=class{constructor(r){this.str_identifier=String(r.userId),this.str_tinyid=String(r.tinyId||0),this.uint32_role=r.role}},Mie=nG,pS=class{constructor(){Se(this,"_startTime"),Se(this,"_endTime"),this._startTime=0,this._endTime=0,this.start()}start(){this._startTime===0&&(this._startTime=xo())}stop(){this._endTime===0&&(this._endTime=xo())}getDuration(){return this._endTime===0?xo()-this._startTime:this._endTime-this._startTime}get endTime(){return this._endTime}},kie=class{constructor(r){Se(this,"_room",null),Se(this,"_durationMap"),Se(this,"_eventMap",new Map),this._room=r.room,this._durationMap=new Map,this.installEvents()}installEvents(){this._eventMap.set($t.SUBSCRIBE_SUCCESS,this.handleSubscribed).set($t.UNSUBSCRIBE_SUCCESS,this.handleStreamStopped).set($t.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:l,prevMuteState:d,muteState:g}=r;var C;let{userId:A}=g;if(!this.hitTest(l))return;d.hasAudio&&!g.hasAudio&&this.stopDurationItem("".concat(A,"_","main"),Be.AUDIO),d.hasVideo&&!g.hasVideo&&this.stopDurationItem("".concat(A,"_","main"),Be.VIDEO),d.hasAuxiliary&&!g.hasAuxiliary&&this.stopDurationItem("".concat(A,"_","auxiliary"),Be.VIDEO);let L=(C=this._room)==null?void 0:C.remotePublishedUserMap.get(A);!L||(!d.hasAudio&&g.hasAudio&&L.remoteAudioTrack.isSubscribed&&this.addDuractionItem(A,Be.AUDIO,"main"),!d.hasVideo&&g.hasVideo&&L.remoteVideoTrack.isSubscribed&&this.addDuractionItem(A,Be.VIDEO,"main"),!d.hasAuxiliary&&g.hasAuxiliary&&L.remoteAuxiliaryTrack.isSubscribed&&this.addDuractionItem(A,Be.VIDEO,"auxiliary"))}),this._eventMap.forEach((r,l)=>en.on(l,r,this))}uninstallEvents(){this._eventMap.forEach((r,l)=>en.off(l,r,this)),this._eventMap.clear()}handleSubscribed(r){let{room:l,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(l))return;let{userId:C}=g,A="".concat(C,"_").concat(d);if(g.muteState.hasAudio&&d==="main")if(g.remoteAudioTrack.isSubscribed){let L=new pS,B=this._durationMap.get(A);B?this.isRecording(B.audio)||B.audio.push(L):this._durationMap.set(A,{userId:C,type:d,audio:[L],video:[]})}else this.stopDurationItem(A,Be.AUDIO);if(g.muteState.hasVideo||g.muteState.hasAuxiliary)if(g.remoteVideoTrack.isSubscribed||g.remoteAuxiliaryTrack.isSubscribed){let L=new pS,B=this._durationMap.get(A);B?this.isRecording(B.video)||B.video.push(L):this._durationMap.set(A,{userId:C,type:d,audio:[],video:[L]})}else this.stopDurationItem(A,Be.VIDEO)}handleStreamStopped(r){let{room:l,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(l))return;let{userId:C}=g,A="".concat(C,"_").concat(d);this.stopDurationItem(A,Be.AUDIO),this.stopDurationItem(A,Be.VIDEO)}isRecording(r){return r.findIndex(l=>l.endTime===0)>=0}addDuractionItem(r,l,d){let g="".concat(r,"_").concat(d),C=new pS,A=this._durationMap.get(g);A?this.isRecording(A[l])||A[l].push(C):this._durationMap.set(g,{userId:r,type:d,audio:l===Be.AUDIO?[C]:[],video:l===Be.AUDIO?[]:[C]})}stopDurationItem(r,l){if(this._durationMap.has(r)){let d=this._durationMap.get(r)[l].find(g=>g.endTime===0);d&&d.stop()}}hitTest(r){return this._room===r}getDuration(r,l){return this._durationMap.has(r)?this._durationMap.get(r)[l].reduce((d,g)=>d+g.getDuration(),0):0}getDurationMap(){return this._durationMap}reset(){this._durationMap.clear()}destroy(){this._room=null,this.uninstallEvents()}},wie=class{constructor(r){Se(this,"_room"),Se(this,"_renderFreezeMap",new Map),Se(this,"_isVideoPlayingEventFiredMap",new Map),Se(this,"_dataFreezeMap",new Map),Se(this,"_monitorFreezeData",new Map),Se(this,"_eventMap",new Map),this._room=r.room,this.installEvents()}installEvents(){this._eventMap.set($t.LEAVE_SUCCESS,r=>{let{room:l}=r;this.hitTest(l)&&this.stop()}).set($t.PLAY_TRACK_START,this.onPlayTrackStart).set($t.UNSUBSCRIBE_SUCCESS,r=>{let{room:l,streamType:d,remotePublishedUser:g}=r;if(!this.hitTest(l))return;let{userId:C}=g,A="".concat(C,"_").concat(d);this.stopDataFreeze({key:A,userId:C,type:d})}).set($t.REMOTE_PUBLISH_STATE_CHANGED,r=>{let{room:l,prevMuteState:d,muteState:g}=r;if(!this.hitTest(l))return;let{userId:C}=g;if(d.hasVideo&&!g.hasVideo){let A="main",L="".concat(g.userId,"_").concat(A);this.stopDataFreeze({key:L,userId:C,type:A})}if(d.hasAuxiliary&&!g.hasAuxiliary){let A="auxiliary",L="".concat(g.userId,"_").concat(A);this.stopDataFreeze({key:L,userId:C,type:A})}}).set($t.PLAYER_STATE_CHANGED,r=>{let{track:l,state:d,reason:g,type:C}=r;if(qm(l)&&this.hitTest(l.room)&&C===Be.VIDEO){if(d==="PLAYING"){let A="".concat(l.userId,"_").concat(l.streamType);this._isVideoPlayingEventFiredMap.set(A,!0)}g===Be.MUTE?this.onVideoTrackMuted(l):g===Be.UNMUTE&&this.onVideoTrackUnmuted(l)}}).set($t.HEARTBEAT_REPORT,this.onHearBeatReport),this._eventMap.forEach((r,l)=>en.on(l,r,this))}uninstallEvents(){this._eventMap.forEach((r,l)=>en.off(l,r,this)),this._eventMap.clear()}stop(){this._renderFreezeMap.clear(),this._dataFreezeMap.clear(),this._isVideoPlayingEventFiredMap.clear()}onVideoTrackMuted(r){if(!r.isSubscribed)return;let{userId:l,streamType:d}=r,g="".concat(l,"_").concat(d),C=this._dataFreezeMap.get(g),A=new pS;C?C.durationItemList.push(A):this._dataFreezeMap.set(g,{userId:l,type:d,durationItemList:[A],isFreezing(){let L=this.durationItemList[this.durationItemList.length-1];return L&&L.endTime===0}})}onVideoTrackUnmuted(r){if(!r.isSubscribed)return;let{userId:l,streamType:d}=r,g="".concat(l,"_").concat(d);this.stopDataFreeze({key:g,userId:l,type:d})}onHearBeatReport(r){let{room:l,report:d}=r;!this.hitTest(l)||d.msg_down_stream_info.forEach(g=>{let C=this._room.remotePublishedUserMap.get(g.msg_user_info.str_identifier);if(!C)return;let{userId:A,muteState:L}=C;g.msg_video_status.forEach(B=>{B.uint32_video_stream_type===2&&L.hasVideo&&!L.videoMuted&&C.remoteVideoTrack.isSubscribed&&this.handleRenderFreeze({userId:A,fps:B.uint32_video_dec_fps,type:"main"}),B.uint32_video_stream_type===7&&L.hasAuxiliary&&C.remoteAuxiliaryTrack.isSubscribed&&this.handleRenderFreeze({userId:A,fps:B.uint32_video_dec_fps,type:"auxiliary"})})})}stopDataFreeze(r){let{key:l,userId:d,type:g}=r,C=this._dataFreezeMap.get(l);if(!C||!C.isFreezing())return;let A=C.durationItemList[C.durationItemList.length-1];A.stop();let L=A.getDuration();L>Pw?this._monitorFreezeData.set(l,{userId:d,type:g,duration:L}):C.durationItemList.pop()}getTotalDuration(r){return r.reduce((l,d)=>{let g=d.getDuration();return l+Math.min(g,5e3)},0)}handleRenderFreeze(r){return at(this,arguments,function(l){var d=this;let{userId:g,fps:C,type:A}=l;return function*(){let L="".concat(g,"_").concat(A),B=d._renderFreezeMap.get(L);if(C<=2){let U=xo();B&&!B.isFreeze&&(B.freezeTimeline.push({startTime:U,endTime:0}),B.isFreeze=!0),B||d._renderFreezeMap.set(L,{userId:g,type:A,isFreeze:!0,freezeTimeline:[{startTime:U,endTime:0}],renderFreezeTotal:0})}else if(B&&B.isFreeze){B.isFreeze=!1;let U=B.freezeTimeline.pop();if(U){U.endTime=xo();let Z=U.endTime-U.startTime;B.freezeTimeline.push(U),B.renderFreezeTotal+=Math.min(5e3,Z)}}}()})}onPlayTrackStart(r){let{track:l}=r;if(!qm(l)||!this.hitTest(l.room)||l.kind!==Be.VIDEO||l.hasFlag)return;let d="".concat(l.userId,"_").concat(l.streamType);this._isVideoPlayingEventFiredMap.has(d)||this._isVideoPlayingEventFiredMap.set(d,!1)}getDataFreezeDuration(r){let l={dataFreeze:0,count:0},d=this._dataFreezeMap.get(r);if(d){if(d.isFreezing()){let g=d.durationItemList[d.durationItemList.length-1];g.stop(),g.getDuration()<Pw&&d.durationItemList.pop()}l.dataFreeze=this.getTotalDuration(d.durationItemList),l.count=d.durationItemList.length}return l}getRenderFreezeDuration(r){let l=this._renderFreezeMap.get(r),d=0,g=0;if(l)if(l.isFreeze){let C=xo()-l.freezeTimeline[l.freezeTimeline.length-1].startTime;d=l.renderFreezeTotal+Math.min(C,5e3),g=l.freezeTimeline.length}else d=l.renderFreezeTotal;return{renderFreeze:d,count:g}}getMonitorFreeze(){return this._monitorFreezeData}isBlackStream(r){return!!this._isVideoPlayingEventFiredMap.has(r)&&!this._isVideoPlayingEventFiredMap.get(r)}resetMonitor(){this._monitorFreezeData.clear()}hitTest(r){return r===this._room}destroy(){this.uninstallEvents()}},Rie=Vi(qa(),1),Aie=[-1,-1,1,-1,-1,1,1,1],Die=[0,0,1,0,0,1,1,1],yf=class extends wo{constructor(r,l){if(super(),this.context=r,Se(this,"name"),Se(this,"input"),Se(this,"output"),Se(this,"texture"),Se(this,"image"),Se(this,"ctx2d",null),Se(this,"fbo"),Se(this,"width",0),Se(this,"height",0),Se(this,"x",0),Se(this,"y",0),Se(this,"program"),Se(this,"vertexShader"),Se(this,"fragmentShader"),Se(this,"totalFrames",0),Se(this,"dropFrames",0),Se(this,"matchInputSize",!0),Se(this,"texCoordBuffer"),Se(this,"positionBuffer"),Se(this,"lastInfo",{name:"",timestamp:0,totalFrames:0,x:0,y:0,width:0,height:0,fps:0}),Se(this,"cost",0),Se(this,"_canvas",null),this.context.on("disconnect",this.close,this),this.name=l.name,this.matchInputSize=l.matchInputSize!==!1,this.width=l.width||r.width,this.height=l.height||r.height,r instanceof hd){if(r.ctx&&l.create2d){let d=document.createElement("canvas"),g=typeof d.transferControlToOffscreen=="function"?d.transferControlToOffscreen():d;g.width=this.width,g.height=this.height,this.ctx2d=g.getContext("2d"),this.image=g,this._canvas=g}}else try{let d=r.ctx;this.texCoordBuffer=this.createBuffer(Die),this.positionBuffer=this.createBuffer(Aie),l.createTexture!==!1&&(this.texture=d.createTexture(),this.useTexture(),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.pixelStorei(d.PACK_ALIGNMENT,1),d.pixelStorei(d.UNPACK_ALIGNMENT,1)),l.useFbo&&(this.fbo=d.createFramebuffer(),this.useBufferFrame(),this.useTexture(),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,this.width,this.height,0,d.RGBA,d.UNSIGNED_BYTE,null),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this.texture,0)),l.useDefaultProgram?this.program=r.defaultProgam:(l.vertexShaderSource||l.fragmentShaderSource)&&(this.vertexShader=l.vertexShaderSource?r.createShader(d.VERTEX_SHADER,l.vertexShaderSource):r.defaultVShader,this.fragmentShader=l.fragmentShaderSource?r.createShader(d.FRAGMENT_SHADER,l.fragmentShaderSource):r.defaultFShader,this.program=r.createProgram(this.vertexShader,this.fragmentShader))}catch(d){this.context.destroy(d)}}createFramebuffer(r){let l=this.context.ctx,d=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,d),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),d}connect(r){for(var l=arguments.length,d=new Array(l>1?l-1:0),g=1;g<l;g++)d[g-1]=arguments[g];return r.addInput(this,...d),this.output=r,r}addInput(r){this.input=r,this.matchInputSize&&r.width&&r.height&&this.resize(r.width,r.height)}requestFrame(r){let l=Date.now();return!!(this.context instanceof Vl&&this.render(r)||this.context instanceof hd&&this.render2d(r))&&(this.totalFrames++,this.cost=Date.now()-l,!0)}render2d(r){var l;return!((l=this.input)==null||!l.requestFrame(r))&&this.draw2d(this.input.image,0,0,this.width,this.height)}disconnect(){for(var r,l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];(r=this.output)==null||r.removeInput(this,...d),delete this.output}removeInput(r){delete this.input}close(){var r,l;if(this.context.off("disconnect",this.close,this),(r=this.output)==null||r.removeInput(this),delete this.output,(l=this.input)==null||l.disconnect(),this.context instanceof Vl){let d=this.context.ctx;d.deleteBuffer(this.texCoordBuffer),d.deleteBuffer(this.positionBuffer),this.fbo&&d.deleteFramebuffer(this.fbo),this.texture&&d.deleteTexture(this.texture),this.vertexShader&&this.vertexShader!==this.context.defaultVShader&&d.deleteShader(this.vertexShader),this.fragmentShader&&this.fragmentShader!==this.context.defaultFShader&&d.deleteShader(this.fragmentShader),this.program&&this.program!==this.context.defaultProgam&&d.deleteProgram(this.program)}this._canvas&&(this._canvas.width=0,this._canvas.height=0,this.ctx2d=null),this.removeAllListeners()}useTexture(){this.useTextures(this.texture)}useInputTexture(){var r;this.useTextures((r=this.input)==null?void 0:r.texture)}useTextures(){let r=this.context.ctx;for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];d.forEach((C,A)=>{C&&(r.activeTexture(r.TEXTURE0+A),r.bindTexture(r.TEXTURE_2D,C))})}useProgram(){this.context.ctx.useProgram(this.program)}useBufferFrame(){let r=this.context.ctx;r.bindFramebuffer(r.FRAMEBUFFER,this.fbo||null)}createBuffer(r){let l=this.context.ctx,d=l.createBuffer();return l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(r),l.STATIC_DRAW),d}setTexBuffer(r){let l=this.context.ctx;l.bindBuffer(l.ARRAY_BUFFER,this.texCoordBuffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array(r),l.STATIC_DRAW)}setPosBuffer(r){let l=this.context.ctx;l.bindBuffer(l.ARRAY_BUFFER,this.positionBuffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array(r),l.STATIC_DRAW)}changeBufferData(r,l){let d=this.context.ctx;d.bindBuffer(d.ARRAY_BUFFER,r),d.bufferData(d.ARRAY_BUFFER,new Float32Array(l),d.STATIC_DRAW)}setAttributes(){let r=this.context.ctx;for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];d.forEach((C,A)=>{r.enableVertexAttribArray(A),r.bindBuffer(r.ARRAY_BUFFER,C),r.vertexAttribPointer(A,2,r.FLOAT,!1,0,0)})}getVertexPoint(r,l){return[r/this.width*2-1,l/this.height*2-1]}layout2texCoords(r){return[...this.getVertexPoint(r.x,r.y),...this.getVertexPoint(r.x+r.width,r.y),...this.getVertexPoint(r.x,r.y+r.height),...this.getVertexPoint(r.x+r.width,r.y+r.height)]}resize(r,l){if(this.width!==r||this.height!==l){if(this.width=r,this.height=l,this._canvas&&(this._canvas.width=r,this._canvas.height=l),this.texture&&this.fbo){this.useTexture();let d=this.context.ctx;d.texImage2D(d.TEXTURE_2D,0,d.RGBA,r,l,0,d.RGBA,d.UNSIGNED_BYTE,null)}this.output&&this.output.matchInputSize&&this.output.resize(r,l)}}draw(r,l){this.setAttributes(r||this.positionBuffer,l||this.texCoordBuffer);let d=this.context.ctx;d.drawArrays(d.TRIANGLE_STRIP,0,4)}draw2d(r,l,d,g,C){return!(!this.ctx2d||!r)&&(r instanceof ImageData?this.ctx2d.putImageData(r,l,d):this.ctx2d.drawImage(r,l,d,g,C),!0)}getInfo(){var r;let{totalFrames:l,x:d,y:g,width:C,height:A,name:L,cost:B}=this,U=Date.now(),Z=(l-this.lastInfo.totalFrames)/((U-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:l,x:d,y:g,width:C,height:A,timestamp:U,fps:Z,name:L,cost:B},Fn({parent:(r=this.input)==null?void 0:r.getInfo()},this.lastInfo)}createTexture(r){let l=this.context.ctx,d=l.createTexture();return this.useTextures(d),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.pixelStorei(l.PACK_ALIGNMENT,1),l.pixelStorei(l.UNPACK_ALIGNMENT,1),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,r),d}};In([Bi(wo.INIT,"connected",{sync:!0})],yf.prototype,"connect"),In([Bi("connected",wo.INIT,{ignoreError:!0,sync:!0})],yf.prototype,"disconnect"),In([Bi([],"closed",{sync:!0})],yf.prototype,"close");var Oie=[0,1,1,1,0,0,1,0],oG=class extends yf{constructor(r,l){super(r,Object.assign({useDefaultProgram:!0,createTexture:!1,name:"destination"},l)),Se(this,"_intervalId",0),Se(this,"_sequence",0),Se(this,"checkGLError",!1),r instanceof hd?this.ctx2d=r.ctx:r.available&&(l!=null&&l.mirrorUpAndDown)&&this.setTexBuffer(Oie)}start(r){this._intervalId=Hr.run("intervalInWorker",()=>{if(r!==this.context.frameRate&&(Hr.clearTask(this._intervalId),this.start(this.context.frameRate)),this.requestFrame(this._sequence++),this.checkGLError&&this.context instanceof Vl){let l=this.context.ctx.getError();l&&this.context.destroy(new Error("".concat(this.name," req ").concat(this._sequence," render ").concat(this.totalFrames," faild ").concat(l)))}},{fps:this.context.frameRate})}render(r){var l;return!((l=this.input)==null||!l.requestFrame(r))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}addInput(r){for(var l=arguments.length,d=new Array(l>1?l-1:0),g=1;g<l;g++)d[g-1]=arguments[g];super.addInput(r,...d),this.start(this.context.frameRate)}removeInput(r){super.removeInput(r),Hr.clearTask(this._intervalId)}resize(r,l){super.resize(r,l),this.context.setSize(r,l)}},aA=class extends oG{constructor(r,l){super(r,l),Se(this,"_videoTrack"),[this._videoTrack]=r._canvas.captureStream(r.frameRate).getVideoTracks();let d=g=>{var C;let A=()=>{var B;return(B=this._videoTrack)==null?void 0:B.removeEventListener(g,L)},L=()=>{A(),this.context.destroy(new Error("video track ".concat(g)))};this.once("closed",A),(C=this._videoTrack)==null||C.addEventListener(g,L)};r instanceof Vl&&d("mute"),d("ended")}get videoTrack(){return this._videoTrack}close(){var r;super.close(),(r=this._videoTrack)==null||r.stop(),delete this._videoTrack}},Lie=class extends aA{render(r){var l;return!((l=this.input)==null||!l.requestFrame(r))}},Nie=class extends aA{constructor(r,l){super(r,{name:"smallDestination"}),this.resolution=l}resize(r,l){let d,g=r*l,C=this.resolution.width*this.resolution.height;pn.info("big res: ".concat(r,"*").concat(l," small res: ").concat(this.resolution.width,"*").concat(this.resolution.height," ")),g>C?d=g/C:(pn.warn("Small stream resolution is not smaller than big stream, which is invalid. big: ".concat(r," * ").concat(l," small: ").concat(this.resolution.width," * ").concat(this.resolution.height)),d=g/19200),super.resize(r/Math.sqrt(d),l/Math.sqrt(d))}},rG=class extends yf{constructor(r,l,d){super(r,Fn({name:"imageSource"},d)),this.image=l,Se(this,"_image"),Se(this,"_totalFrames",0),Se(this,"_autoResize",!1),this._autoResize=(d==null?void 0:d.autoResize)!==!1}_render(r,l){let{width:d,height:g}=this;if(this.image instanceof HTMLVideoElement){if(Er(this.image.getVideoPlaybackQuality)&&!q_){let C=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===C)return!1;this._totalFrames=C,this.dropFrames=this._totalFrames-this.totalFrames}if({videoWidth:d,videoHeight:g}=this.image,!d||!g)return!1;this.image.width=d,this.image.height=g}else if(this.image instanceof HTMLImageElement||this.image instanceof ImageData||this.image instanceof ImageBitmap){if({width:d,height:g}=this.image,this.image!==this._image)this._image=this.image;else if(d===this.width&&g===this.height)return!1}else(this.image instanceof HTMLCanvasElement||this.image instanceof OffscreenCanvas)&&({width:d,height:g}=this.image,this._image=this.image);if(!this._autoResize)return!0;if(this.width===d&&this.height===g&&this.totalFrames){if(l){this.useTexture();let C=this.context.ctx;C.texSubImage2D(C.TEXTURE_2D,0,0,0,C.RGBA,C.UNSIGNED_BYTE,this.image)}}else{if(l){this.useTexture();let C=this.context.ctx;C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,this.image)}this.resize(d,g)}return!0}render(r){return this._render(r,!0)}render2d(r){return this._render(r,!1)}},iG=class extends rG{constructor(r,l,d){let g=document.createElement("video");g.setAttribute("playsinline","playsinline"),g.setAttribute("muted",""),super(r,g,d),this._videoTrack=l,Se(this,"_mediaStream"),this.name="videoTrackSource",this._mediaStream=new MediaStream([l]),this.image.srcObject=this._mediaStream,this.image.play()}replaceTrack(r){var l,d;this._videoTrack!==r&&((l=this._mediaStream)==null||l.removeTrack(this._videoTrack),this._videoTrack=r,(d=this._mediaStream)==null||d.addTrack(this._videoTrack),this.image.play())}close(){var r;super.close(),(r=this._mediaStream)==null||r.removeTrack(this._videoTrack),delete this._mediaStream,this.image.srcObject=null}},aG=class extends wo{constructor(r){super(),Se(this,"frameRate"),Se(this,"_canvas"),Se(this,"log"),Se(this,"hasAlpha",!1),Se(this,"name"),this.name=r.name,this.log=r.logger.createChild({id:"vc-".concat(this.name)}),this.frameRate=r.frameRate}set width(r){this._canvas&&(this._canvas.width=r)}get width(){var r;return((r=this._canvas)==null?void 0:r.width)||0}set height(r){this._canvas&&(this._canvas.height=r)}get height(){var r;return((r=this._canvas)==null?void 0:r.height)||0}setSize(r,l){this._canvas&&(this._canvas.width=r,this._canvas.height=l)}createVideoTrackSource(r){return new iG(this,r)}createVideoTrackDestination(r){return new aA(this,r)}createVideoImageSource(r,l){return new rG(this,r,l)}get available(){return this.state==="created"}disconnect(){this.emit("disconnect")}},Pie={alpha:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0,powerPreference:"low-power"},Vl=class extends aG{constructor(){super(...arguments),Se(this,"defaultProgam"),Se(this,"defaultVShader"),Se(this,"defaultFShader"),Se(this,"ctx")}create(){if(this._canvas||(this._canvas=document.createElement("canvas")),this.ctx=this._canvas.getContext("webgl2",Pie),!this.ctx)throw new Error("webgl2 not supported");this.defaultVShader=this.createShader(this.ctx.VERTEX_SHADER,`
// 顶点着色器
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoord;

void main() {
  gl_Position = a_position;
  v_texCoord = a_texCoord;
}
`),this.defaultFShader=this.createShader(this.ctx.FRAGMENT_SHADER,`
// 片元着色器
precision mediump float;
varying vec2 v_texCoord;
uniform sampler2D u_texture;

void main() {
  gl_FragColor = texture2D(u_texture, v_texCoord);
} `),this.defaultProgam=this.createProgram(this.defaultVShader,this.defaultFShader),this._canvas.addEventListener("webglcontextlost",()=>{this.destroy(new Error("webgl context lost"))}),this.log.info("video context created use webgl")}destroy(r){return this.disconnect(),this.log.info("video context destroy ".concat(r?": ".concat(r):"")),this.ctx&&(this.ctx.deleteShader(this.defaultVShader),this.ctx.deleteShader(this.defaultFShader),this.ctx.deleteProgram(this.defaultProgam),delete this.ctx),r}set width(r){var l;(l=this.ctx)==null||l.viewport(0,0,r,this.height),super.width=r}set height(r){var l;(l=this.ctx)==null||l.viewport(0,0,this.width,r),super.height=r}setSize(r,l){var d;(d=this.ctx)==null||d.viewport(0,0,r,l),super.setSize(r,l)}createShader(r,l){let d=this.ctx,g=d.createShader(r);return d.shaderSource(g,l),d.compileShader(g),g}createProgram(r,l){let d=this.ctx,g=d.createProgram();return d.attachShader(g,r),d.attachShader(g,l),d.linkProgram(g),d.getProgramParameter(g,d.LINK_STATUS)||this.log.error(d.getProgramInfoLog(g)),g}};In([Bi(wo.INIT,"created",{sync:!0})],Vl.prototype,"create"),In([Bi("created",wo.INIT,{ignoreError:!0,sync:!0,success(r){r&&this.emit("unavailable",r),this.removeAllListeners()}})],Vl.prototype,"destroy");var hd=class extends aG{constructor(){super(...arguments),Se(this,"ctx")}create(r){if(this.hasAlpha=r.alpha,this._canvas=document.createElement("canvas"),this.ctx=this._canvas.getContext("2d",{alpha:r.alpha}),!this.ctx)throw new Error("2d context not supported");this.log.info("video context created use 2d")}destroy(r){this.disconnect(),this.log.info("video context destroy ".concat(r?": ".concat(r):"")),delete this.ctx,this._canvas&&(this._canvas.remove(),this._canvas.width=0,this._canvas.height=0,delete this._canvas),this.removeAllListeners()}};In([Bi(wo.INIT,"created",{sync:!0})],hd.prototype,"create"),In([Bi("created",wo.INIT,{ignoreError:!0,sync:!0})],hd.prototype,"destroy");var xie=[1,0,0,0,1,1,0,1],Uie=class extends yf{constructor(r){if(super(r,{useDefaultProgram:!0,useFbo:!0,create2d:!0,name:"mirror"}),r instanceof Vl)try{this.setTexBuffer(xie)}catch(l){r.destroy(l)}}draw2d(r,l,d,g,C){if(this.ctx2d){this.ctx2d.save(),this.ctx2d.scale(-1,1),this.ctx2d.translate(-this.width,0);let A=super.draw2d(r,l,d,g,C);return this.ctx2d.restore(),A}return!1}render(r){var l;return!((l=this.input)==null||!l.requestFrame(r))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}},Fie=class{constructor(r,l){this.node=r,this.layout=l,Se(this,"positionBuffer")}get x(){return this.layout.x||this.node.x}get y(){return this.layout.y||this.node.y}get width(){return this.layout.width||this.node.width}get height(){return this.layout.height||this.node.height}get right(){return this.x+this.width}get bottom(){return this.y+this.height}},Vie=class extends yf{constructor(r){super(r,{useDefaultProgram:!0,useFbo:!0,name:"mix",create2d:!0}),Se(this,"inputs",[])}addInput(r,l){if(this.inputs[l.zIndex])throw new Error("input already exists");let d=new Fie(r,l);this.inputs[l.zIndex]=d}resize(r,l){let d=this.inputs.reduce((g,C)=>C?Object.assign(g,{width:Math.max(g.width,C.right),height:Math.max(g.height,C.bottom)}):g,{width:0,height:0});super.resize(d.width,d.height),this.context instanceof Vl&&this.inputs.forEach(g=>{if(g){let C=this.layout2texCoords(g);g.positionBuffer?this.changeBufferData(g.positionBuffer,C):g.positionBuffer=this.createBuffer(C)}})}connect(r){for(var l=arguments.length,d=new Array(l>1?l-1:0),g=1;g<l;g++)d[g-1]=arguments[g];return super.connect(r,...d),this.resize(0,0),r}removeInput(r){this.inputs[this.inputs.findIndex(l=>(l==null?void 0:l.node)===r)]=void 0}render(r){let l=this.context.ctx;if(l.clearColor(0,0,0,0),!this.inputs.reduce((d,g)=>(!g||!g.node.requestFrame(r))&&d,!0)&&l){this.useProgram(),l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),this.useBufferFrame();for(let d=0;d<this.inputs.length;d++){let g=this.inputs[d];g&&(g.node.useTexture(),this.draw(g.positionBuffer))}return!0}return!1}render2d(r){if(!this.inputs.reduce((l,d)=>(!d||!d.node.requestFrame(r))&&l,!0)&&this.ctx2d){this.ctx2d.clearRect(0,0,this.width,this.height);for(let l=0;l<this.inputs.length;l++){let d=this.inputs[l];d&&this.draw2d(d.node.image,d.x,d.y,d.width,d.height)}return!0}return!1}getInfo(){let{totalFrames:r,x:l,y:d,width:g,height:C,name:A}=this,L=Date.now(),B=(r-this.lastInfo.totalFrames)/((L-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:r,x:l,y:d,width:g,height:C,timestamp:L,fps:B,name:A},Fn({parent:this.inputs.filter(U=>U).map(U=>U.node.getInfo())},this.lastInfo)}close(){super.close(),this.inputs.forEach(r=>{var l,d;if(r&&((l=r.node)==null||l.disconnect(),r.positionBuffer&&this.context instanceof Vl))try{(d=this.context.ctx)==null||d.deleteBuffer(r.positionBuffer)}catch{}})}},Gie=class extends iG{constructor(r,l){super(r,l.input,{name:"vb",create2d:!1,useDefaultProgram:!1,useFbo:!1,createTexture:!0}),Se(this,"ready",!1),Se(this,"_bgTexture"),Se(this,"_waterMarkTexture"),Se(this,"_lastMaskTexture"),Se(this,"_lastMaskFbo"),Se(this,"_textureValid",!1),Se(this,"_selfieTextureValid",!1),Se(this,"_selfieSegmentation"),Se(this,"wasm"),Se(this,"_prePrograme"),Se(this,"_segmentationMask"),Se(this,"_weixin",!1),this._selfieSegmentation=l.selfieSegmentation,this._selfieSegmentation.onResults=this.onPredict.bind(this),this.init(l).catch(()=>this.context.destroy(new Error("selfie_segmentation init faild")))}init(r){return at(this,null,function*(){let l=r.Wasm,d=this.context.ctx;if(this.wasm=new l.AllIn1(d),this.wasm.blurRadius=r.blurRadius||3,this.wasm.mirror=!!r.mirror,this.wasm.vbMode=r.bg==="blur"?1:r.bg instanceof HTMLImageElement?2:r.bg==="green"?3:0,r.waterMark){let{x:g,y:C,width:A,height:L}=r.waterMark;this.wasm.setWaterMark(g,C,A,L)}if(this.program=this.wasm.init(),this.useProgram(),this.setAttributes(this.positionBuffer,this.texCoordBuffer),d.uniform1i(d.getUniformLocation(this.program,"mask"),1),r.bg instanceof HTMLImageElement&&(d.uniform1i(d.getUniformLocation(this.program,"bg"),2),this._bgTexture=this.createTexture(r.bg)),r.waterMark&&(d.uniform1i(d.getUniformLocation(this.program,"waterMark"),3),this._waterMarkTexture=this.createTexture(r.waterMark.image)),d.uniform1i(d.getUniformLocation(this.program,"lastMask"),4),this._weixin){let g=this.context.createShader(d.FRAGMENT_SHADER,`#version 300 es
precision highp float;
uniform sampler2D u_texture;
uniform sampler2D mask;

in vec2 v_texCoord;
out vec4 outColor;
void main() {
  outColor = vec4(texture(u_texture, v_texCoord).rgb, texture(mask, v_texCoord).a);
}`),C=this.context.createShader(d.VERTEX_SHADER,`#version 300 es
in vec2 a_position;
in vec2 a_texCoord;
out vec2 v_texCoord;
void main() {
  gl_Position = vec4(a_position.x, a_position.y, 0, 1);
  v_texCoord = a_texCoord;
}`);this._prePrograme=this.context.createProgram(C,g),d.useProgram(this._prePrograme),this.setAttributes(this.positionBuffer,this.texCoordBuffer),d.uniform1i(d.getUniformLocation(this._prePrograme,"mask"),1)}this.ready=!0})}onPredict(r){let l=this.context.ctx;this._weixin&&(this._lastMaskTexture||(this._lastMaskTexture=this.createTexture(this.image),this._lastMaskFbo=this.createFramebuffer(this._lastMaskTexture))),this.useProgram(),this._weixin?this.useTexture():this._selfieSegmentation.bindTexture(),l.activeTexture(l.TEXTURE1),this._selfieSegmentation.bindTexture2d(r),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,this._bgTexture||null),l.activeTexture(l.TEXTURE3),l.bindTexture(l.TEXTURE_2D,this._waterMarkTexture||null),this.useBufferFrame(),l.drawArrays(l.TRIANGLE_STRIP,0,4),this._segmentationMask=r,this.totalFrames++}render(r){let l=this.context.ctx;if(typeof this.image.getVideoPlaybackQuality=="function"&&!q_){let A=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===A)return!1;this._totalFrames=A,this.dropFrames=this._totalFrames-this.totalFrames}let{videoWidth:d,videoHeight:g}=this.image;this.image.width=d,this.image.height=g;let C=!1;if(this.totalFrames)this._weixin?this.useTexture():this._selfieSegmentation.bindTexture(),C=this._selfieTextureValid,this._selfieTextureValid=!0;else{if(!this.program)return!1;this.useTexture(),C=this._textureValid,this._textureValid=!0}return this.width===d&&this.height===g&&C?l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.image):(this.resize(d,g),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,this.image)),this.ready&&(this._weixin&&(l.useProgram(this._prePrograme),this.useTexture(),this._segmentationMask&&(l.activeTexture(l.TEXTURE1),this._selfieSegmentation.bindTexture2d(this._segmentationMask),l.bindFramebuffer(l.FRAMEBUFFER,this._lastMaskFbo||null)),l.drawArrays(l.TRIANGLE_STRIP,0,4),this._selfieSegmentation.bindTexture(),this._segmentationMask?l.copyTexSubImage2D(l.TEXTURE_2D,0,0,0,0,0,d,g):l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,d,g,0)),this._selfieSegmentation.send(d,g)),this.totalFrames||(l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,this._bgTexture||null),l.activeTexture(l.TEXTURE3),l.bindTexture(l.TEXTURE_2D,this._waterMarkTexture||null),l.drawArrays(l.TRIANGLE_STRIP,0,4)),!1}close(){var r;super.close();let l=this.context.ctx;this._bgTexture&&l.deleteTexture(this._bgTexture),this._waterMarkTexture&&l.deleteTexture(this._waterMarkTexture),this._lastMaskTexture&&l.deleteTexture(this._lastMaskTexture),this._lastMaskFbo&&l.deleteFramebuffer(this._lastMaskFbo),this._prePrograme&&l.deleteProgram(this._prePrograme),(r=this.wasm)==null||r.close()}},Bie=class extends Rie.EventEmitter{constructor(r){super(),this.room=r,Se(this,"videoContext"),Se(this,"_glVideoContext"),Se(this,"_2dVideoContext"),Se(this,"destination"),Se(this,"smallVideoContext"),Se(this,"smallDestination"),Se(this,"smallTrackSource"),Se(this,"smallImageSource"),Se(this,"_isMirror",!1),Se(this,"cameraTrack"),Se(this,"cameraNode"),Se(this,"mirrorNode"),Se(this,"mixNode"),Se(this,"screenTrack"),Se(this,"screenNode"),Se(this,"selfModel",!1),Se(this,"blurRadius",3),Se(this,"arTrack"),Se(this,"Wasm"),Se(this,"waterMarkNode"),Se(this,"_waterMarkOption"),Se(this,"watermarkImageList",[]),Se(this,"_isMixScreen",!1),Se(this,"_virtualBackground"),Se(this,"virtualBackgroundInstance"),Se(this,"isUsingArTrack",!1),Se(this,"_bgAssetPath"),Se(this,"log",pn.createLogger({id:"vm"})),Se(this,"_checkId",0),Se(this,"_use2d",!1),Se(this,"_autoSwitchRenderMode",!0),Se(this,"_selfieSegmentation"),r&&(this.log.setUserId(r.userId),this.log.setSdkAppId(r.sdkAppId)),this.smallVideoContext=new hd({frameRate:15,logger:this.log,name:"s"}),this.enablePrintDetail()}get _hasVirtualBg(){return!!this._virtualBackground}get _hasWaterMark(){return this.watermarkImageList.length>0}get renderMode(){return this._autoSwitchRenderMode?"auto":this._use2d?"2d":"webgl"}set renderMode(r){if(this._autoSwitchRenderMode=r==="auto",this._autoSwitchRenderMode)return;let l=r==="2d";this._use2d!==l&&(this._use2d=l,this.clear(),this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.update())}get2dVideoContext(){return this._2dVideoContext?this._2dVideoContext.destroy():this._2dVideoContext=new hd({frameRate:15,logger:this.log,name:"m"}),this._2dVideoContext.create({alpha:this._hasWaterMark||this._hasVirtualBg}),this.sendCreateResult("videoCtx2d",this._2dVideoContext.ctx?void 0:new Error("create 2d context failed")),this._2dVideoContext}getGlVideoContext(){if(this._glVideoContext){if(this._glVideoContext.available)return this._glVideoContext}else this._glVideoContext=new Vl({frameRate:15,logger:this.log,name:"m"});try{this._glVideoContext.create(),this.sendCreateResult(),this._glVideoContext.on("unavailable",(r,l)=>{this.emit("error",{reason:r,error:l}),this.log.warn("video context unavailable",r,l),this.sendCreateResult("videoCtxGl",l||new Error(r)),this.update()})}catch(r){this.emit("error",{reason:"create",error:r}),this.sendCreateResult("videoCtxGl",r)}return this._glVideoContext}enablePrintDetail(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3;this._checkId=Hr.run(SC,()=>{this.destination&&this.log.debug(this.destination.getInfo())},{delay:r})}destroy(){var r,l;(r=this._2dVideoContext)==null||r.destroy(),(l=this._glVideoContext)==null||l.destroy(),this.smallVideoContext.destroy(),Hr.clearTask(this._checkId)}get needAlpha(){return this._hasWaterMark||this._hasVirtualBg}get active(){return(q_||this._isMixScreen||this._isMirror||this._hasWaterMark||this._hasVirtualBg)&&this.checkOrCreateVideoContext()}sendCreateResult(){let r=arguments.length>1?arguments[1]:void 0,l=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"videoCtxGl")==="videoCtxGl"?512700:512701;r?Lo.addFailedEvent({key:l,error:r}):Lo.addSuccessEvent({key:l})}checkOrCreateVideoContext(){let r=this._use2d;if(this._autoSwitchRenderMode&&(this._use2d=!this._hasVirtualBg),this.videoContext)if(this.videoContext.available){let l=!this.videoContext.hasAlpha&&this.needAlpha;if(this._autoSwitchRenderMode&&r===this._hasVirtualBg)this.clear();else{if(!l||!this._use2d)return!0;this.clear()}}else this.clear(),this._use2d=!0;return this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.videoContext.available}get smallTrack(){var r;return(r=this.smallDestination)==null?void 0:r.videoTrack}get hasSmall(){return!!this.smallTrack}get initialTrack(){var r;return(r=this.cameraTrack)==null?void 0:r.mediaTrack}initVirtualBackground(r){return this._selfieSegmentation=r,this._selfieSegmentation.changeModel()}_setMainOutput(r){var l;let d=this.cameraTrack,{small:g,settings:C,player:A}=d;g?(this.smallVideoContext.available||(this.smallVideoContext.create({alpha:!1}),this.smallDestination=new Nie(this.smallVideoContext,g)),this.smallVideoContext.frameRate=g.frameRate,this.smallDestination.resolution=g,r?(this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource),this.smallImageSource?this.smallImageSource.image=r:(this.smallImageSource=this.smallVideoContext.createVideoImageSource(r),this.smallImageSource.connect(this.smallDestination))):(this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource?this.smallTrackSource.replaceTrack(this.initialTrack):(this.smallTrackSource=this.smallVideoContext.createVideoTrackSource(this.initialTrack),this.smallTrackSource.width=C.width,this.smallTrackSource.height=C.height,this.smallTrackSource.connect(this.smallDestination)))):this.smallVideoContext.available&&(this.smallVideoContext.destroy(),delete this.smallDestination,delete this.smallTrackSource,delete this.smallImageSource),q_&&A.setCanvas(r);let L=r&&((l=this.destination)==null?void 0:l.videoTrack)||this.initialTrack;return this.isUsingArTrack&&this.arTrack&&(this.emit("output-track-changed"),L=this.arTrack),this._selfieSegmentation&&r&&(this._selfieSegmentation._glName||this._selfieSegmentation.setCanvas(r)),d.setOutputMediaStreamTrack(L)}update(){return at(this,null,function*(){var r,l;if(!this.cameraTrack||!this.cameraTrack.mediaTrack)return;if(!this.active)return this.cameraNode&&this.clear(),this._setMainOutput();let{settings:d,profile:g}=this.cameraTrack;if(this._use2d||!this._selfieSegmentation?(this.destination||(this.destination=this.videoContext.createVideoTrackDestination({name:"mainDestination"})),this.cameraNode?this.cameraNode.replaceTrack(this.initialTrack):(this.cameraNode=this.videoContext.createVideoTrackSource(this.initialTrack),this.cameraNode.resize(d.width,d.height))):(this.cameraNode&&this.cameraNode.close(),this.destination||(this.destination=new Lie(this.videoContext,{name:"mainDestination"})),this.cameraNode=new Gie(this.videoContext,{input:this.cameraTrack.mediaTrack,mirror:this._isMirror,bg:this._virtualBackground,selfModel:this.selfModel,waterMark:this._waterMarkOption,useTflite:!0,blurRadius:this.blurRadius,assetPath:this._bgAssetPath,selfieSegmentation:this._selfieSegmentation,Wasm:this.Wasm}),this.cameraNode.connect(this.destination)),this.videoContext.frameRate=g.frameRate,this._use2d){let C=this.cameraNode;C.disconnect(),this._isMirror&&(this.mirrorNode||(this.mirrorNode=new Uie(this.videoContext)),C=C.connect(this.mirrorNode),C.disconnect(),this.log.info("start mirror")),this.mixNode&&this.mixNode.close(),delete this.mixNode,(this._isMixScreen||this._hasWaterMark)&&(this.mixNode=new Vie(this.videoContext),C.connect(this.mixNode,{zIndex:1}),this._hasWaterMark&&!this.waterMarkNode&&this._waterMarkOption&&(this.waterMarkNode=this.videoContext.createVideoImageSource(this._waterMarkOption.image,{autoResize:!1}),this.waterMarkNode.resize(this._waterMarkOption.width,this._waterMarkOption.height),this.waterMarkNode.x=this._waterMarkOption.x,this.waterMarkNode.y=this._waterMarkOption.y),(r=this.waterMarkNode)==null||r.connect(this.mixNode,{zIndex:2}),this._isMixScreen&&this.screenTrack&&!this.screenNode&&(this.screenNode=this.videoContext.createVideoTrackSource(this.screenTrack.mediaTrack)),(l=this.screenNode)==null||l.connect(this.mixNode,{zIndex:0}),C=this.mixNode,this.log.info("start mix","".concat(this.mixNode.width,"x").concat(this.mixNode.height))),C.connect(this.destination)}return this._setMainOutput(this.videoContext._canvas)})}changeInput(r){if(this.log.info("change input"),r instanceof ff)return this.setScreenTrack(r);if(r instanceof Wa)return this.setCameraTrack(r);if(r instanceof uy){let l=r.mediaTrack;if(iR===17&&+Qu.split(".")[1]<4&&!r.source&&r.player.element){let d=new hd({frameRate:15,logger:this.log,name:r.userId});d.create({alpha:!1});let g=d.createVideoImageSource(r.player.element);r.source=g;let C=new oG(d);g.connect(C),r.player.setCanvas(d._canvas)}return r.setOutputMediaStreamTrack(l)}}removeInput(r){var l;r instanceof ff?((l=this.screenNode)==null||l.close(),delete this.screenNode,delete this.screenTrack,this.update()):r instanceof Wa?(this.clear(),delete this.cameraTrack,this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource)):r instanceof uy&&r.source&&r.source.context.destroy()}setCameraTrack(r){return at(this,null,function*(){this.cameraTrack=r,this.update()})}setScreenTrack(r){return this.screenTrack=r,this._isMixScreen&&(this.screenNode?this.screenNode.replaceTrack(r.mediaTrack):this.update()),r.setOutputMediaStreamTrack(r.mediaTrack)}getWatermarkImage(r,l){return at(this,null,function*(){let d=document.createElement("canvas");l&&r&&(d.height=l,d.width=r);let g=d.getContext("2d");if(!g)throw new Rn({code:an.NOT_SUPPORTED,message:"Make image failed because of canvas context is null"});return this.watermarkImageList.sort((C,A)=>C.zIndex-A.zIndex),this.watermarkImageList.forEach(C=>{let{image:A,x:L,y:B,width:U,height:Z}=C;g.drawImage(A,L,B,U,Z)}),GC(d.toDataURL())})}pushWaterMarkImageList(r){let{type:l}=r;this.watermarkImageList.some(d=>d.imageUrl===r.imageUrl&&d.height===r.height&&d.width===r.width&&d.x===r.x&&d.y===r.y&&d.type===r.type&&d.zIndex===r.zIndex)||((l==="mute"||l==="watermark")&&(this.watermarkImageList=this.watermarkImageList.filter(d=>d.type!==l)),this.watermarkImageList.push(r))}setWatermark(r){return at(this,null,function*(){let l;try{l=yield GC((r==null?void 0:r.imageElement)||r.imageUrl)}catch{throw new Rn({code:an.INVALID_PARAMETER,message:"load image failed, url: ".concat(r.imageUrl)})}let{x:d=0,y:g=0,width:C=l.width,height:A=l.height,type:L="watermark",zIndex:B=2}=r;this.pushWaterMarkImageList({x:d,y:g,width:C,height:A,image:l,zIndex:B,type:L,imageUrl:r.imageUrl}),yield this.freshWatermark(),this.log.info("set watermark",JSON.stringify(this.watermarkImageList))})}deleteWatermark(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"watermark";return at(this,null,function*(){this.watermarkImageList=this.watermarkImageList.filter(l=>l.type!==r),this.log.info("delete watermark",r,JSON.stringify(this.watermarkImageList)),yield this.freshWatermark()})}freshWatermark(){return at(this,null,function*(){var r,l,d;(r=this.waterMarkNode)==null||r.close(),delete this.waterMarkNode,delete this._waterMarkOption;let g=yield this.getWatermarkImage((l=this.cameraTrack)==null?void 0:l.settings.width,(d=this.cameraTrack)==null?void 0:d.settings.height);this._waterMarkOption={x:0,y:0,width:g.width,height:g.height,image:g},this.update()})}setVirtualBackground(r){return at(this,null,function*(){if(r){if(this._use2d&&!this._autoSwitchRenderMode)return Promise.reject(new Error("not support virtual background in 2d mode"));this._bgAssetPath=r.assetPath,r.type==="image"?this._virtualBackground=yield GC(r.imageUrl):(this.blurRadius=r.blurRadius||3,this._virtualBackground=r.type)}else this._virtualBackground=void 0;this.log.info("".concat(this._virtualBackground?"start":"stop"," visual background, ").concat((r==null?void 0:r.type)||"")),this.update()})}get mixScreen(){return this._isMixScreen}set mixScreen(r){var l;this._isMixScreen=r,this._isMixScreen||((l=this.screenNode)==null||l.close(),delete this.screenNode),this.update()}set mirror(r){var l;this._isMirror!==r&&(this._isMirror=r,this._isMirror||((l=this.mirrorNode)==null||l.close(),delete this.mirrorNode),this.update())}get mirror(){return this._isMirror}enableAr(r){this.arTrack=r,this.isUsingArTrack=!0,this.update()}updateAr(){return at(this,null,function*(){var r;(r=this.cameraTrack)==null||!r.mediaTrack||(yield this.virtualBackgroundInstance.ar.updateInputTrack(this.cameraTrack.mediaTrack.clone()))})}disableAr(){var r;this.isUsingArTrack=!1,(r=this.arTrack)==null||r.stop(),this.arTrack=void 0,this.update()}clear(){var r;(r=this.videoContext)==null||r.disconnect(),delete this.destination,delete this.cameraNode,delete this.mirrorNode,delete this.screenNode,delete this.waterMarkNode}},Hie=0,$ie=class extends wo{constructor(r){super("room"),this.seq=++Hie,this.role="anchor",this.localTracks=new Set,this.enableAutoPlayDialog=!0,this.autoReceiveAudio=!0,this.autoReceiveVideo=!0,this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null},this._isUsingCachedSchedule=!1,this._log=pn.createLogger({id:"r".concat(this.seq)}),this._joinedTimestamp=0,this.isDestroyed=!1,this.useStringRoomId=!!r.useStringRoomId,za(r.autoReceiveAudio)&&(this.autoReceiveAudio=r.autoReceiveAudio),za(r.autoReceiveVideo)&&(this.autoReceiveVideo=r.autoReceiveVideo),za(r.enableAutoPlayDialog)&&(this.enableAutoPlayDialog=r.enableAutoPlayDialog),this._sdkType=r.sdkType,this.keyPointManager=new Mie({room:this,frameWorkType:r.frameWorkType,component:r.component,language:r.language}),this.callDurationCalculator=new kie({room:this}),this.badCaseDetector=new wie({room:this}),this.audioManager=new Dre(this),this.videoManager=new Bie(this)}get isMainStreamPublished(){for(let r of this.localTracks)if(4&r.mediaType)return!0;return!1}get isAuxStreamPublished(){for(let r of this.localTracks)if(2&r.mediaType)return!0;return!1}get hasAuxStream(){for(let r of this.remotePublishedUserMap.values())if(r.muteState.hasAuxiliary)return!0;return this.isAuxStreamPublished}getLogger(){return this._log}get isJoining(){return this.state.toString()==="joining"}get isJoined(){return this.state==="joined"}get isLeft(){return this.state==="left"}addTrack(r){return at(this,null,function*(){return this.publish(r)})}removeTrack(r){return at(this,null,function*(){return this.unpublish(r)})}replaceTrack(r){return at(this,null,function*(){})}setEncodedDataProcessingListener(r){throw new Error("Method not implemented.")}enableAIVoice(r){throw new Error("Method not implemented.")}setProxyServer(r){if(rr(r))r.startsWith("wss://")?this.proxy_ws=r:r.startsWith("https://")&&(this.proxy_wt=r);else if(Dc(r)){let{websocketProxy:l,webtransportProxy:d,loggerProxy:g,scheduleProxy:C,unifiedProxy:A}=r;this.proxy_ws=l,this.proxy_wt=d,this.proxy_unified=A,A?(SF([A,A]),T_("https://".concat(A))):(g&&T_(g),C&&SF(C))}en.once($t.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({sched_domain:lf.main,sched_back_domain:lf.backup,signal_domain:this.proxy_ws||this.proxy_wt||""}))}getRemoteAudioStats(){return at(this,null,function*(){let r={};return this.remotePublishedUserMap.forEach(l=>{r[l.userId]=l.remoteAudioTrack.stat}),r})}getTransportStats(){return at(this,null,function*(){var r;let l={rtt:((r=this.quality)==null?void 0:r.uplinkRTT)||0,downlinksRTT:{}};if(this.quality)for(let d of this.quality.downlinkInfo)l.downlinksRTT[d.userId]=d.rtt;return l})}getRemoteVideoStats(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"main";return function*(){let d={};return r.remotePublishedUserMap.forEach(g=>{let C=l==="auxiliary"?g.remoteAuxiliaryTrack:g.remoteVideoTrack;d[g.userId]=C.stat}),d}()})}checkDestroy(){if(this.isDestroyed)throw new Rn({code:an.INVALID_OPERATION,message:so({key:to.CLIENT_DESTROYED,data:{funName:"join"}})})}destroy(){if(this.isJoined)throw this._log.warn(Js.INVALID_DESTROY),new Rn({code:an.INVALID_OPERATION,message:so({key:to.INVALID_DESTROY})});this._log.info("destroy room"),this.audioManager.destroy(),this.videoManager.destroy(),this.keyPointManager.destroy(),this.callDurationCalculator.destroy(),this.badCaseDetector.destroy(),this.isDestroyed=!0,en.emit($t.ROOM_DESTROY,{room:this})}schedule(r,l){return at(this,null,function*(){var d,g;let C=xo();try{let{isCached:A,result:L,detailCost:B}=yield Doe({userId:this.userId,sdkAppId:this.sdkAppId,roomId:r,useStringRoomId:this.useStringRoomId,version:Ol,userSig:this.userSig,frameWorkType:l});this._isUsingCachedSchedule=A,this._log.info("schedule cache:".concat(+A," ").concat(Oc(L,{keysToExclude:["username","credential"]}))),A&&en.once($t.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({scheduleCache:1})),this.scheduleResult=Fn(Fn({},this.scheduleResult),L),Ti((d=L.config)==null?void 0:d.retryCount)&&Z4(L.config.retryCount),rr((g=L.config)==null?void 0:g.loggerDomain)&&T_(L.config.loggerDomain),en.emit($t.JOIN_SCHEDULE_SUCCESS,{room:this,schedule:this.scheduleResult,detailCost:B}),Lo.addSuccessEvent({key:521700,cost:xo()-C,split:50})}catch(A){throw Lo.addFailedEvent({key:521700,error:A}),A}})}},qie=Vi(qa()),sG=Vi(P4()),Kie=r=>{let{serverAbility:l,clientAbility:d,offerSDP:g,enableCustomMessage:C}=r,A=vi(g),L={extmapAllowMixed:"extmap-allow-mixed",groups:A.groups,icelite:"ice-lite",media:[],msidSemantic:{semantic:"",token:"WMS"},name:"-",origin:{address:"127.0.0.1",username:"-",sessionId:String(Date.now()),sessionVersion:1,netType:"IN",ipVer:4},timing:{start:0,stop:0},version:0},B={candidates:l.candidates.map(U=>({component:1,foundation:"1",generation:0,ip:U.ip,port:U.port,priority:U.priority,transport:U.foundation,type:U.type})),connection:{version:4,ip:"0.0.0.0"},direction:Be.TRANSCEIVER_DIRECTION_RECVONLY,ext:l.audio.extensions.map(U=>({value:U.id,uri:U.uri})),fingerprint:{type:l.dtls.hash,hash:l.dtls.fingerprint},fmtp:[{payload:l.audio.codecs[0].payload,config:l.audio.codecs[0].fmtp}],icePwd:l.ice.password,iceUfrag:l.ice.ufrag,mid:"0",payloads:String(l.audio.codecs[0].payload),port:A.media[0].port,protocol:A.media[0].protocol,type:Be.AUDIO,setup:l.dtls.setup,rtcpFb:l.audio.codecs[0].rtcpfb.map(U=>({payload:l.audio.codecs[0].payload,type:U.id,subtype:U.params[0]})),rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[{payload:l.audio.codecs[0].payload,codec:l.audio.codecs[0].codec,rate:l.audio.codecs[0].rate,encoding:l.audio.codecs[0].channels}]};return L.media.push(B),[1,2,3].forEach(U=>{L.media.push(lG({mid:U,serverAbility:l,clientAbility:d,parsedOffer:A}))}),C&&L.media.push(A.media.find(U=>U.mid==="dc")),dd(L)},lG=r=>{let{mid:l,serverAbility:d,clientAbility:g,parsedOffer:C,useAllCodec:A=!1}=r,L={candidates:d.candidates.map(B=>({component:1,foundation:"1",generation:0,ip:B.ip,port:B.port,priority:B.priority,transport:B.foundation,type:B.type})),connection:{version:4,ip:"0.0.0.0"},direction:Be.TRANSCEIVER_DIRECTION_RECVONLY,ext:d.video.extensions.map(B=>({value:B.id,uri:B.uri})),fingerprint:{type:d.dtls.hash,hash:d.dtls.fingerprint},fmtp:[],icePwd:d.ice.password,iceUfrag:d.ice.ufrag,mid:String(l),payloads:"",port:C.media[0].port,protocol:C.media[0].protocol,type:Be.VIDEO,setup:d.dtls.setup,rtcpFb:[],rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[]};if(d.video.codecs.length>0)if(A)for(let B=0;B<d.video.codecs.length;B++)mS(L,d.video.codecs[B]);else{let B=d.video.codecs.findIndex(U=>U.codec.toLowerCase()===(d.useVp8?"vp8":"h264"));mS(L,d.video.codecs[B])}else if(A)for(let B=0;B<g.video.codecs.length;B++)mS(L,g.video.codecs[B]);else mS(L,g.video.codecs[0]);return L.payloads=L.payloads.trim(),L},mS=(r,l)=>{r.payloads="".concat(r.payloads," ").concat(l.payload),r.fmtp.push({payload:l.payload,config:l.fmtp}),r.rtcpFb=[...r.rtcpFb||[],...(l.rtcpfb||l.rtcpFb).map(d=>({payload:l.payload,type:d.id,subtype:d.params[0]}))],r.rtp.push({payload:l.payload,codec:l.codec.toUpperCase(),rate:l.rate}),l.rtx&&(r.payloads="".concat(r.payloads," ").concat(l.rtx),r.fmtp.push({payload:l.rtx,config:"apt=".concat(l.payload)}),r.rtp.push({payload:l.rtx,codec:"rtx",rate:l.rate}))},el,zie=r=>{let l=sG.default.parse(r);return l.media.forEach(d=>{var g;(d.type===Be.AUDIO||d.type===Be.VIDEO)&&(function(C){if(!C.rtcpFb)return;let A=[];C.rtcpFb.forEach((L,B)=>{var U;A.push(L),C.rtcpFb&&((U=C.rtcpFb[B+1])==null?void 0:U.payload)!==L.payload&&L.type!=="rrtr"&&A.push({payload:L.payload,type:"rrtr"})}),C.rtcpFb=A}(d),function(C){C.type===Be.VIDEO&&C.fmtp&&C.fmtp.forEach(A=>{A.config.includes("apt")||(A.config+=";sps-pps-idr-in-keyframe=1")})}(d),function(C){C.type===Be.AUDIO&&C.fmtp&&C.fmtp.forEach(A=>{A.config+=";sprop-stereo=1;stereo=1"})}(d),function(C){let A=new Set(["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"]);C.ext&&(C.ext=C.ext.filter(L=>!A.has(L.uri)))}(d)),(g=d.payloads)!=null&&g.includes("datachannel")&&l.groups&&d.mid&&(l.groups[0].mids=l.groups[0].mids.replace(d.mid,"dc"),d.mid="dc")}),sG.default.write(l)},cG=class{constructor(r){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.dataView=r,this.isSEI&&(l?this.addPreventionByte():this.removePreventionByte())}addPreventionByte(){let r=this.seiPayloadStartIndex,l=this.dataView.byteLength-2,d=[],g=0;for(let A=r;A<=l;A++){let L=this.dataView.getInt8(A);switch(L){case 0:case 1:case 2:case 3:g===2&&(d.push(3),g=0),L==0?g++:g=0,d.push(L);break;default:g=0,d.push(L)}}d.push(this.dataView.getInt8(this.dataView.byteLength-1));let C=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,r),...d]).buffer);this.dataView=C}removePreventionByte(){let r=this.seiPayloadStartIndex,l=this.dataView.byteLength-1,d=[],g=0;for(let A=r;A<=l;A++)switch(this.dataView.getInt8(A)){case 0:g++,d.push(this.dataView.getInt8(A));break;case 3:g!==2&&d.push(this.dataView.getInt8(A)),g=0;break;default:d.push(this.dataView.getInt8(A)),g=0}let C=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,r),...d]).buffer);this.dataView=C}get isSEI(){return this.dataView.getUint8(4)===6}get seiPayloadStartIndex(){let r=6;for(let l=6;l<this.dataView.buffer.byteLength&&(r++,this.dataView.getUint8(l)===255);l++);return r}get seiPayloadType(){return this.isSEI?this.dataView.getUint8(5):null}get seiPayload(){if(!this.isSEI)return null;let r=0,l=6;for(let C=6;C<this.dataView.buffer.byteLength;C++){let A=this.dataView.getUint8(C);if(l++,A!==255){r+=A;break}r+=255}let d=new ArrayBuffer(r),g=new DataView(d);for(let C=0;C<d.byteLength;C++,l++)g.setInt8(C,this.dataView.getInt8(l));return g}},Wie=class{constructor(r,l){this._singlePC=r,this._log=l,Se(this,"_seiMessageList",[]),Se(this,"_smallSeiMessageList",[]),Se(this,"_seiPayloadType",243),Se(this,"_seiAbortMap",new Map),Se(this,"_nonSeiAbortMap",new Map),Se(this,"onSEIMessage",null)}isRunning(r){return this._seiAbortMap.has(r)}start(r){let l=r.direction===Be.TRANSCEIVER_DIRECTION_SENDONLY,d=(l?r.sender:r.receiver).createEncodedStreams(),g=d.readable,C=d.writable,A=new TransformStream({transform:l?(B,U)=>this.encodeVideoFrame(B,U,r):(B,U)=>this.decodeVideoFrame(B,U,r)}),L=new AbortController;g.pipeThrough(A).pipeTo(C,L).catch(B=>{B!=="destroy"&&this._log.warn(B)}),this._seiAbortMap.set(r,L)}restart(r){this.stop(r),this.start(r)}stop(r){var l;(l=this._seiAbortMap.get(r))==null||l.abort(),this._seiAbortMap.delete(r)}destroy(){this._seiAbortMap.forEach(r=>r.abort("destroy")),this._seiAbortMap.clear(),this._nonSeiAbortMap.forEach(r=>r.abort("destroy")),this._nonSeiAbortMap.clear(),this.onSEIMessage=null}handleEncodedStreams(){try{this._singlePC.getPeerConnection().getTransceivers().forEach((r,l)=>{var d,g;if(r.direction!=="inactive"&&r.mid)if(l<4)l===1||l===2?this.isRunning(r)||this.start(r):this._nonSeiAbortMap.has(r)||this.pipeSenderOrReceiver(r);else{let C=(l-4)%3==1,A=(l-4)%3==2;((g=(d=r.receiver)==null?void 0:d.track)==null?void 0:g.kind)===Be.VIDEO&&(C||A)?this.isRunning(r)||this.start(r):this._nonSeiAbortMap.has(r)||this.pipeSenderOrReceiver(r)}})}catch(r){this._log.warn(r)}}pipeSenderOrReceiver(r){let l=r.direction===Be.TRANSCEIVER_DIRECTION_SENDONLY?r.sender:r.receiver,{readable:d,writable:g}=l.createEncodedStreams(),C=new AbortController;this._nonSeiAbortMap.set(r,C),d.pipeTo(g,C).catch(()=>{})}push(r,l){var d,g;l&&l.seiPayloadType&&(this._seiPayloadType=l.seiPayloadType),this._seiMessageList.push(r),(g=(d=this._singlePC.getPeerConnection())==null?void 0:d.getSenders()[2])!=null&&g.track&&this._smallSeiMessageList.push(r)}hasSEI(r){let l=new DataView(r);return l.getInt32(0)===1&&l.getInt8(4)===6}isEmptyFrame(r){return r.type==="empty"||r.data.byteLength===0}getNaluCount(r){let l=0,d=0,g=new DataView(r);for(let C=0;C<r.byteLength;C++)switch(g.getUint8(C)){case 0:l++;break;case 1:(l===2||l===3)&&d++,l=0;break;default:l=0}return d}encodeVideoFrame(r,l,d){try{let g=Number(d.mid)===2?this._smallSeiMessageList:this._seiMessageList;if(this._singlePC.isUsingH264&&g.length>0&&!this.isEmptyFrame(r)){let C=9-this.getNaluCount(r.data);if(C<=0)return;let A=g.splice(0,C).reverse().map(this.encodeSEINalu.bind(this)),L=A.reduce((ce,we)=>ce+we.dataView.byteLength,0),B=new ArrayBuffer(L+r.data.byteLength),U=new DataView(B),Z=new DataView(r.data),ae=0;for(let ce=0;ce<A.length;ce++)for(let we=0;we<A[ce].dataView.byteLength;we++)U.setInt8(ae++,A[ce].dataView.getInt8(we));for(let ce=0;ce<r.data.byteLength;ce++)U.setInt8(ae++,Z.getInt8(ce));r.data=B,this._log.debug("".concat(A.length," sei sent"))}}catch(g){this._log.warn(g)}l.enqueue(r)}decodeVideoFrame(r,l,d){try{if(this._singlePC.isUsingH264&&!this.isEmptyFrame(r)&&this.hasSEI(r.data)){let g=[],C=new DataView(r.data),A=0,L=-1,B=-1;for(let U=0;U<r.data.byteLength;U++){let Z=C.getUint8(U);if(Z===0)A++;else if(Z===1){if(A===2||A===3){let ae=U-A;if(L===-1?L=ae:B===-1&&(B=ae,g.push(new cG(new DataView(C.buffer.slice(L,B)))),L=ae,B=-1),C.getUint8(U+1)!==6){r.data=new DataView(C.buffer.slice(ae)).buffer;break}}A=0}else A=0}this._log.debug("".concat(g.length," sei received")),Er(this.onSEIMessage)&&g.reverse().forEach(U=>{let Z=Number(d.mid);this.onSEIMessage({seiPayloadType:U.seiPayloadType,data:U.seiPayload.buffer,mid:Z,streamType:(Z-4)%3==2?"auxiliary":"main"})})}}catch(g){this._log.warn(g)}l.enqueue(r)}encodeSEINalu(r){let l=r.byteLength,d=parseInt(String(l/255),10),g=l%255,C=[];C.push(0,0,0,1,6,this._seiPayloadType);for(let L=0;L<d;L++)C.push(255);C.push(g);let A=new DataView(r);return C.push(...new Uint8Array(A.buffer)),C.push(128),new cG(new DataView(new Uint8Array(C).buffer),!0)}},If=((el=If||{}).TRACK="track",el.DATA_CHANNEL_MESSAGE="data_channel_msg",el[el.CONNECTION_STATE_CHANGED="connection-state-changed"]="CONNECTION_STATE_CHANGED",el[el.FIREWALL_RESTRICTION="firewall-restriction"]="FIREWALL_RESTRICTION",el.RECONNECTED="spc-reconnected",el.RECONNECT_FAILED="spc-reconnect-failed",el.ERROR="error",el.SEI_MESSAGE="sei-message",el),uG=0,dG=!1,jie=new Set,Yie=1,Sy=class extends qie.default{constructor(r){let{signalChannel:l,room:d,enableCustomMessage:g}=r;super(),Se(this,"stat",{iceStartTime:0,iceEndTime:0,dtlsStartTime:0,dtlsEndTime:0,peerConnectionStartTime:0,peerConnectionEndTime:0}),Se(this,"currentState","DISCONNECTED"),Se(this,"_room"),Se(this,"_signalChannel"),Se(this,"_peerConnection",null),Se(this,"_datachannel",null),Se(this,"_enableCustomMessage"),Se(this,"_log"),Se(this,"_downlinkMIDMap",new Map),Se(this,"_downlinkMIDUserIDMap",new Map),Se(this,"_reconnectionTimer",-1),Se(this,"reconnectionCount",0),Se(this,"clientAbility"),Se(this,"_serverAbility",null),Se(this,"addDownlinkQueue",new Set),Se(this,"removeDownlinkQueue",new Set),Se(this,"_parsedAnswer",null),Se(this,"_updateSDPPromise",null),Se(this,"_waitForPCConnectedPromise"),Se(this,"_waitForPCConnectedPromiseReject",null),Se(this,"_isSDPLogged",!1),Se(this,"seiCodec",null),this._room=d,this._enableCustomMessage=g,this._signalChannel=l,this._log=pn.createLogger({id:"spc".concat(Yie++),userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this._room.enableSEI&&ey&&(this._log.info("create sei codec"),this.seiCodec=new Wie(this,this._log),this.seiCodec.onSEIMessage=C=>{this.emit("sei-message",{userId:this._downlinkMIDUserIDMap.get(C.mid),data:C.data,seiPayloadType:C.seiPayloadType,streamType:C.streamType})})}get isH264EncodeSupported(){let r=this._room.checkSystemResult.detail.isH264EncodeSupported;return this._serverAbility&&(r=r&&!!this._serverAbility.video.codecs.find(l=>l.codec.toLowerCase()==="h264")),r}get isVP8EncodeSupported(){let r=this._room.checkSystemResult.detail.isVp8EncodeSupported;return this._serverAbility&&(r=r&&this._serverAbility.useVp8),r}get videoCodec(){var r;return(r=this._serverAbility)!=null&&r.useVp8?"vp8":"h264"}get isUsingH264(){return this.videoCodec==="h264"}get uplinkSSRC(){return this._peerConnection&&this._peerConnection.localDescription?(r=>{let l=vi(r),d={audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0};return l.media.forEach((g,C)=>{var A;if(g.ssrcs&&!Ft(g.ssrcs[0].id)){let L=Number(g.ssrcs[0].id),B=Number((A=g.ssrcs.filter(U=>U.attribute==="cname")[1])==null?void 0:A.id);switch(C){case 0:d.audioSsrc=L;break;case 1:d.bigVideoSsrc=L,d.bigVideoRtxSsrc=B;break;case 2:d.smallVideoSsrc=L,d.smallVideoRtxSsrc=B;break;case 3:d.auxVideoSsrc=L,d.auxVideoRtxSsrc=B}}}),d})(this._peerConnection.localDescription.sdp):{audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0}}get isReconnecting(){return this.currentState==="RECONNECTING"||this._reconnectionTimer>0||this.reconnectionCount>0}get dtlsTransport(){if(!this._peerConnection)return null;let r=this._peerConnection.getSenders();return r.length===0?null:r[0].transport}initialize(){return at(this,null,function*(){let r;try{return this._peerConnection=new RTCPeerConnection({encodedInsertableStreams:this._room.enableSEI&&ey,offerExtmapAllowMixed:!0,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._room.sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"}),this._peerConnection.oniceconnectionstatechange=()=>{if(!this._peerConnection)return;let l=this._peerConnection.iceConnectionState;this._log.debug("ice state: ".concat(l)),l==="checking"&&this.stat.iceStartTime===0?this.stat.iceStartTime=Date.now():l==="connected"&&this.stat.iceEndTime===0&&(this.stat.iceEndTime=Date.now())},this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this),this._peerConnection.ontrack=l=>this.emit("track",l),this._enableCustomMessage&&(this._datachannel=this._peerConnection.createDataChannel("".concat(this._room.userId,"dc")),this._datachannel.binaryType="arraybuffer",this._datachannel.onopen=()=>{this._log.info("datachannel open")},this._datachannel.onclose=()=>{this._log.warn("datachannel close")},this._datachannel.onmessage=l=>{let d=new Xie(l.data);this.emit("data_channel_msg",{data:d})},this._datachannel.onerror=l=>{this._log.warn("datachannel error",l)}),this._peerConnection.addTransceiver(Be.AUDIO,{direction:Be.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:Be.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:Be.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:Be.TRANSCEIVER_DIRECTION_SENDONLY}),r=yield this._peerConnection.createOffer(),yield this.setOffer(r),this.dtlsTransport&&(this.dtlsTransport.onstatechange=()=>{let{dtlsTransport:l}=this;!l||(this._log.debug("dtls state: ".concat(l.state)),l.state==="connecting"&&this.stat.dtlsStartTime===0?this.stat.dtlsStartTime=Date.now():l.state==="connected"&&this.stat.dtlsEndTime===0&&(this.stat.dtlsEndTime=Date.now()))}),this.clientAbility=((l,d)=>{var g,C;let A=vi(l),L={ice:{ufrag:"",password:""},dtls:{hash:"",fingerprint:"",setup:""},audio:{codecs:[],extensions:[]},video:{codecs:[],extensions:[]},useDataChannel:d};L.ice.ufrag=String(A.media[0].iceUfrag),L.ice.password=A.media[0].icePwd||"",A.fingerprint&&(L.dtls.hash=A.fingerprint.type,L.dtls.fingerprint=A.fingerprint.hash,L.dtls.setup=A.setup||""),A.media[0].fingerprint&&(L.dtls.hash=A.media[0].fingerprint.type,L.dtls.fingerprint=A.media[0].fingerprint.hash),L.dtls.setup=A.media[0].setup||"";let B=A.media[0],U=A.media[1];B.ext&&(L.audio.extensions=B.ext.map(ae=>({id:ae.value,uri:ae.uri}))),U.ext&&(L.video.extensions=U.ext.map(ae=>({id:ae.value,uri:ae.uri})));let Z={codec:B.rtp[0].codec,fmtp:B.fmtp[0].config,payload:B.fmtp[0].payload,rate:B.rtp[0].rate,channel:B.rtp[0].encoding,rtcpFb:[],rtx:0};(g=B.rtcpFb)==null||g.forEach(ae=>{let{payload:ce,type:we,subtype:Pe}=ae;if(ce===Z.payload){let Ze={id:we,params:[]};Pe&&Ze.params.push(Pe),Z.rtcpFb.push(Ze)}}),L.audio.codecs.push(Z);for(let ae=0;ae<U.rtp.length;ae++){if(["rtx","red","ulpfec"].includes(U.rtp[ae].codec))continue;let ce=U.fmtp.filter(we=>we.payload===U.rtp[ae].payload)[0];L.video.codecs.push({payload:U.rtp[ae].payload,codec:U.rtp[ae].codec,fmtp:ce?ce.config:"",rate:U.rtp[ae].rate,rtx:((C=U.rtp[ae+1])==null?void 0:C.codec)==="rtx"?U.rtp[ae+1].payload:0,rtcpFb:((U==null?void 0:U.rtcpFb)||[]).filter(we=>we.payload===U.rtp[ae].payload).map(we=>{let{type:Pe,subtype:Ze}=we;return{id:Pe,params:Ze?[Ze]:[]}})})}return L})(r.sdp,this._enableCustomMessage),Lo.addSuccessEvent({key:521707}),this.clientAbility}catch(l){throw Lo.addFailedEvent({key:521707,error:l}),this._log.error("initialize failed ".concat(l,` 
offer: `).concat(r==null?void 0:r.sdp)),l}})}connect(r){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return at(this,null,function*(){var d;try{if(this.currentState==="CONNECTED")return;let g=xo(),C={type:"answer",sdp:Kie({serverAbility:r,clientAbility:this.clientAbility,offerSDP:this._peerConnection.localDescription.sdp,enableCustomMessage:this._enableCustomMessage})};this._serverAbility=r,yield this.setAnswer(C),yield this.waitForPeerConnectionConnected(),l||Lo.addSuccessEvent({key:521703,cost:xo()-g}),(d=this.seiCodec)==null||d.handleEncodedStreams()}catch(g){let C=g instanceof Rn&&g.code===an.API_CALL_ABORTED;throw C||this._log.error("connect failed: ".concat(g),r),this.reset(),!C&&!this.isReconnecting&&(Lo.addFailedEvent({key:521703,error:g}),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),g}})}reconnect(){return at(this,null,function*(){if(this._reconnectionTimer===-1){if(!this._signalChannel.isConnected)return this._log.warn("reconnect() wait signal channel is connected"),void this._signalChannel.once(ng,this.reconnect,this);try{this.reconnectionCount++,this._log.warn("reconnect() trying [".concat(this.reconnectionCount,"]")),this.reset();let r=yield this.initialize(),l=yield this._signalChannel.sendWaitForResponse({command:mie,responseCommand:go.REBUILD_PEER_CONNECTION_RES,data:{ability:r},enableLog:!1});if(l.data.code!==0)throw new Rn({code:l.data.code,message:l.data.message});yield this.connect(l.data.data.ability,!0),Lo.addSuccessEvent({key:521704}),this._log.warn("reconnect() success"),this.stopReconnection(),en.emit($t.SPC_RECONNECTED,{room:this._room}),this.emit("spc-reconnected")}catch(r){if(!this.isReconnecting)return;if(r!=null&&r.message.includes("timeout")){let l=$m(this.reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(l/1e3,"s")),this._reconnectionTimer=window.setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},l)}else this._log.error("reconnect() failed ".concat(r==null?void 0:r.code," ").concat(r)),Lo.addFailedEvent({key:521704,error:r}),this.reconnectionCount>=xm()&&this._log.warn("SDK has tried reconnect for ".concat(xm()," times, but all failed, please check your network")),this.stopReconnection(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.emit("error")}}else this._log.warn("reconnect() is reconnecting, ignore current reconnection")})}getPeerConnection(){return this._peerConnection}startReconnection(){return at(this,null,function*(){this._log.warn("start reconnect"),this._updateSDPPromise=null,this.emitConnectionStateChangedEvent("RECONNECTING"),yield this.reconnect()})}stopReconnection(){this.isReconnecting&&(this._log.info("stop reconnect"),this.reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(ng,this.reconnect,this))}checkPeerConnectionToReconnect(){var r;!this.isReconnecting&&((r=this._peerConnection)==null?void 0:r.connectionState)===ni.CLOSED&&this.startReconnection()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}onConnectionStateChange(r){let l=this._peerConnection.iceConnectionState,d=this.getDTLSTransportState();this._log.info("connectionState: ".concat(r.target.connectionState," ICE: ").concat(l," DTLS: ").concat(d)),r.target.connectionState===ni.CONNECTING&&(this.stat.peerConnectionStartTime===0&&(this.stat.peerConnectionStartTime=Date.now()),this.emitConnectionStateChangedEvent("CONNECTING")),(r.target.connectionState===ni.FAILED||r.target.connectionState===ni.CLOSED)&&(this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),(r.target.connectionState===ni.CONNECTED||r.target.connectionState===ni.COMPLETED)&&(this.stat.peerConnectionEndTime===0&&(this.stat.peerConnectionEndTime=Date.now()),en.emit($t.SINGLE_CONNECTION_STAT,{room:this._room,stat:{ice:this.stat.iceEndTime-this.stat.iceStartTime,dtls:this.stat.dtlsEndTime-this.stat.dtlsStartTime,peerConnection:this.stat.peerConnectionEndTime-this.stat.peerConnectionStartTime}}),this.logSelectedCandidate(),this.emitConnectionStateChangedEvent("CONNECTED"))}getDTLSTransportState(){if(!this._peerConnection)return Xu;let r=null;return qC()&&this._peerConnection.getSenders().length!==0?(r=this._peerConnection.getSenders()[0].transport,$C()&&this._peerConnection.getReceivers().length!==0&&r?r.state:Xu):Xu}emitConnectionStateChangedEvent(r){r!==this.currentState&&(this.currentState==="RECONNECTING"&&r==="CONNECTING"||(this.emit(If.CONNECTION_STATE_CHANGED,{prevState:this.currentState,state:r}),this.currentState=r))}logSelectedCandidate(){return at(this,null,function*(){if(!this._peerConnection)return;let r=yield this._peerConnection.getStats();for(let[l,d]of r)if(Q_(d)){let g=r.get(d.localCandidateId),C=r.get(d.remoteCandidateId);g&&(this._log.info("local candidate: ".concat(g.candidateType," ").concat(g.protocol,":").concat(g.ip||g.address,":").concat(g.port," ").concat(g.networkType||""," ").concat(g.candidateType==="relay"?"relayProtocol:".concat(g.relayProtocol):"")),g.networkType&&wF(g.networkType)),C&&this._log.info("remote candidate: ".concat(C.candidateType," ").concat(C.protocol,":").concat(C.ip||C.address,":").concat(C.port));break}})}waitForPeerConnectionConnected(){return this._waitForPCConnectedPromise||(this._waitForPCConnectedPromise=new Promise((r,l)=>{if(this.currentState==="CONNECTED")return r();this._waitForPCConnectedPromiseReject=l;let d=L=>{L.state==="CONNECTED"&&(clearTimeout(A),C(),r())},g=L=>{let{room:B}=L;B===this._room&&(clearTimeout(A),C(),l(new Rn({code:an.API_CALL_ABORTED,message:so({key:to.CONNECTION_ABORTED,data:"leave room"})})))},C=()=>{en.off($t.LEAVE_SUCCESS,g,this),this.off(If.CONNECTION_STATE_CHANGED,d,this)},A=setTimeout(()=>{C();let L=new Rn({code:an.API_CALL_TIMEOUT,message:"connection timeout"});var B;uG+=1,B=this._signalChannel.isConnected,uG>2&&!dG&&jie.size===0&&B&&(this._log.warn("firewall restriction"),dG=!0,this.emit(If.FIREWALL_RESTRICTION)),l(L)},xw);en.on($t.LEAVE_SUCCESS,g,this),this.on(If.CONNECTION_STATE_CHANGED,d,this)}),this._waitForPCConnectedPromise=this._waitForPCConnectedPromise.finally(()=>{this._waitForPCConnectedPromise=null,this._waitForPCConnectedPromiseReject=null})),this._waitForPCConnectedPromise}waitForReconnected(){return this.isReconnecting?new Promise((r,l)=>{this.once("spc-reconnected",r),this.once("error",l)}):Promise.resolve()}addDownlink(r){return at(this,null,function*(){var l;if(this._log.info("addDownlink(".concat(r.userId,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise),this.updateLocalAndRemoteSDPConfig(r),this.addDownlinkQueue.size===0)try{yield this.updateSDP(),(l=this.seiCodec)==null||l.handleEncodedStreams(),this._log.info("addDownlink(".concat(r.userId,") done"))}catch(d){this._log.error("addDownlink(".concat(r.userId,") failed ").concat(d)),yield this.startReconnection()}})}updateLocalAndRemoteSDPConfig(r){let{ssrc:l,userId:d,tinyId:g}=r;if(!this._peerConnection)return;this._log.info("updateLocalAndRemoteSDPConfig ".concat(d," ").concat(JSON.stringify(l)));let C=this._peerConnection.getTransceivers().filter(ce=>ce.direction==="inactive").slice(0,3).map(ce=>(ce.direction=Be.TRANSCEIVER_DIRECTION_RECVONLY,Number(ce.mid)));this._parsedAnswer||(this._parsedAnswer=vi(this._peerConnection.remoteDescription.sdp));let A,L,B,U=this._parsedAnswer.media.filter(ce=>{var we;return(we=ce.ssrcs)==null?void 0:we.find(Pe=>{var Ze;return(Ze=Pe.value)==null?void 0:Ze.includes(g)})});if(U.length===3)A=U[0],L=U[1],B=U[2];else if(C.length===3)A=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[0])),L=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[1])),B=this._parsedAnswer.media.find(ce=>Number(ce.mid)===Number(C[2]));else if(C.length===0){this._peerConnection.addTransceiver(Be.AUDIO,{direction:Be.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:Be.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(Be.VIDEO,{direction:Be.TRANSCEIVER_DIRECTION_RECVONLY}),A=JSON.parse(JSON.stringify(this._parsedAnswer.media[0]));let ce=lG({mid:1,serverAbility:this._serverAbility,clientAbility:this.clientAbility,parsedOffer:vi(this._peerConnection.localDescription.sdp),useAllCodec:!0});L=JSON.parse(JSON.stringify(ce)),B=JSON.parse(JSON.stringify(ce)),A.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(A),L.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(L),B.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(B)}A.direction=Be.TRANSCEIVER_DIRECTION_SENDONLY;let Z="".concat(g,"-").concat(l.audio);A.ssrcs=[{id:l.audio,attribute:"cname",value:"".concat(Z)},{id:l.audio,attribute:"msid",value:"".concat(Z,"-").concat(Be.MAIN," ").concat(Z,"-audio")}],L.direction=Be.TRANSCEIVER_DIRECTION_SENDONLY,L.ssrcs=[{id:l.video,attribute:"cname",value:"".concat(Z)},{id:l.video,attribute:"msid",value:"".concat(Z,"-").concat(Be.MAIN," ").concat(Z,"-bigvideo")},{id:l.videoRtx,attribute:"cname",value:"".concat(Z)},{id:l.videoRtx,attribute:"msid",value:"".concat(Z,"-").concat(Be.MAIN," ").concat(Z,"-bigvideo")}],L.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(l.video," ").concat(l.videoRtx)}],B.direction=Be.TRANSCEIVER_DIRECTION_SENDONLY;let ae="".concat(Z,"-aux");B.ssrcs=[{id:l.auxiliary,attribute:"cname",value:ae},{id:l.auxiliary,attribute:"msid",value:"".concat(ae," ").concat(Z,"-aux").concat(Be.VIDEO)},{id:l.auxiliaryRtx,attribute:"cname",value:"".concat(ae," ").concat(Z,"-aux").concat(Be.VIDEO)},{id:l.auxiliaryRtx,attribute:"msid",value:"".concat(ae," ").concat(Z,"-aux").concat(Be.VIDEO)}],B.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(l.auxiliary," ").concat(l.auxiliaryRtx)}],this._parsedAnswer.groups&&(this._parsedAnswer.groups[0].mids=this._parsedAnswer.media.map(ce=>ce.mid).join(" ")),this._downlinkMIDMap.set(d,[A.mid,L.mid,B.mid]),this._downlinkMIDUserIDMap.set(A.mid,d),this._downlinkMIDUserIDMap.set(L.mid,d),this._downlinkMIDUserIDMap.set(B.mid,d)}removeDownlink(r){return at(this,null,function*(){if(!this._downlinkMIDMap.has(r)||!this._peerConnection)return;this._log.info("removeDownlink(".concat(r,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise);let l=this._downlinkMIDMap.get(r),d=!1;this._peerConnection.getTransceivers().forEach(g=>{l!=null&&l.includes(Number(g.mid))&&(d=!0,g.direction="inactive")}),this._parsedAnswer||(this._parsedAnswer=vi(this._peerConnection.remoteDescription.sdp)),this._parsedAnswer.media.forEach(g=>{l!=null&&l.includes(Number(g.mid))&&(d=!0,g.direction="inactive",g.ssrcs=[],g.ssrcGroups=[])}),this.removeDownlinkQueue.size===0&&d&&(yield this.updateSDP()),this._downlinkMIDMap.delete(r),l==null||l.forEach(g=>this._downlinkMIDUserIDMap.delete(g)),this._log.info("removeDownlink(".concat(r,") done"))})}setBandwidth(r){return at(this,null,function*(){if(!this._peerConnection)return;let{audio:l,bigVideo:d,smallVideo:g,auxVideo:C}=r;try{if(bR()){let A=this._peerConnection.getSenders().slice(0,4);for(let B=0;B<A.length;B++){let U,Z=A[B];B===0&&l?U=l:B===1&&d?U=d:B===2&&g?U=g:B===3&&C&&(U=C),U&&(yield this.setSenderMaxBitrate(Z,U))}let L=!1;d&&A[1].track&&(L=this.setStartBitrate(1,d)),C&&A[3].track&&(L=this.setStartBitrate(3,C)||L),L&&(yield this.updateSDP())}else yield this.setBandwidthBySDP(r);this._log.info("setBandwidth ".concat(JSON.stringify(r)))}catch(A){this._log.error("failed to set bandwidth: ".concat(A))}})}setStartBitrate(r,l){var d,g;return!((d=this._peerConnection)==null||!d.remoteDescription||(this._parsedAnswer||(this._parsedAnswer=vi(this._peerConnection.remoteDescription.sdp)),(g=this._parsedAnswer.media[r])==null||!g.fmtp[0]))&&(this._parsedAnswer.media[r].fmtp[0].config+=";x-google-start-bitrate=".concat(l>5e3?5e3:l),!0)}setSenderMaxBitrate(r,l){let d=r.getParameters();return(!d.encodings||d.encodings.length===0)&&(d.encodings=[{}]),l==="unlimited"?delete d.encodings[0].maxBitrate:d.encodings[0].maxBitrate=1e3*l,r.setParameters(d)}setBandwidthBySDP(r){let{audio:l,bigVideo:d,smallVideo:g,auxVideo:C}=r;if(!this._peerConnection||!this._peerConnection.localDescription)return;let A=vi(this._peerConnection.localDescription.sdp);this._parsedAnswer||(this._parsedAnswer=vi(this._peerConnection.remoteDescription.sdp));let L=Nr?"TIAS":"AS";l&&(A.media[0].bandwidth=[{type:L,limit:Nr?1e3*l:l}],this._parsedAnswer.media[0].bandwidth=[{type:L,limit:Nr?1e3*l:l}]),d&&(A.media[1].bandwidth=[{type:L,limit:Nr?1e3*d:d}],this._parsedAnswer.media[1].bandwidth=[{type:L,limit:Nr?1e3*d:d}]),g&&(A.media[2].bandwidth=[{type:L,limit:Nr?1e3*g:g}],this._parsedAnswer.media[2].bandwidth=[{type:L,limit:Nr?1e3*g:g}]),C&&(A.media[3].bandwidth=[{type:L,limit:Nr?1e3*C:C}],this._parsedAnswer.media[3].bandwidth=[{type:L,limit:Nr?1e3*C:C}]);let B={type:"offer",sdp:dd(A)};return this.updateSDP({localDescription:B})}setScaleResolutionDownBy(r,l){if(l===1)return;let d=r.getParameters();return(!d.encodings||d.encodings.length===0)&&(d.encodings=[{}]),d.encodings[0].scaleResolutionDownBy=l,r.setParameters(d)}updateSDP(){let{localDescription:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._parsedAnswer)return Promise.resolve();let l=dd(this._parsedAnswer);return this._updateSDPPromise=new Promise((d,g)=>at(this,null,function*(){var C,A;try{!r&&this._peerConnection&&(this._log.info("creating offer"),r=yield this._peerConnection.createOffer()),r&&(yield this.setOffer(r)),yield this.setAnswer({type:"answer",sdp:l}),this._updateSDPPromise=null,d()}catch(L){this._log.error(L),!this._isSDPLogged&&this._peerConnection&&(this._log.warn("current offer: ".concat(this.filterSDPDirection((C=this._peerConnection.localDescription)==null?void 0:C.sdp),` 
next offer: `).concat(this.filterSDPDirection(r==null?void 0:r.sdp))),this._log.warn("current answer: ".concat(this.filterSDPDirection((A=this._peerConnection.remoteDescription)==null?void 0:A.sdp),` 
next answer: `).concat(this.filterSDPDirection(l))),this._log.warn("offer: ".concat(r==null?void 0:r.sdp)),this._log.warn("answer: ".concat(l)),this._log.warn("transceivers: ".concat(JSON.stringify(this._peerConnection.getTransceivers().map(B=>{let{mid:U,currentDirection:Z,direction:ae,stopped:ce}=B;return{mid:U,currentDirection:Z,direction:ae,stopped:ce}})))),this._log.warn("parsedAnswer: ".concat(JSON.stringify(this._parsedAnswer))),this._isSDPLogged=!0),this._updateSDPPromise=null,g(L)}})),this._updateSDPPromise}filterSDPDirection(){return vi(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").media.map(r=>r.direction)}setOffer(r){return this._log.info("setting offer"),this._peerConnection.setLocalDescription({type:"offer",sdp:zie(r.sdp)})}setAnswer(r){return this._log.info("setting answer"),this._room.enableHWEncoder&&r.sdp&&(r.sdp=r.sdp.replaceAll("42e01f","42001f")),this._peerConnection.setRemoteDescription(r)}sendDataChannelMessage(r){var l;(l=this._datachannel)==null||l.send(r)}reset(){var r;(r=this._peerConnection)==null||r.close(),this._waitForPCConnectedPromise=null,this._parsedAnswer=null}close(){this._log.info("close pc"),this.seiCodec&&(this.seiCodec.destroy(),this.seiCodec=null),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this._downlinkMIDMap.clear(),this.stopReconnection(),this.removeAllListeners()}sendSEI(r,l){var d;(d=this.seiCodec)==null||d.push(r,l)}};In([bV("reconnect")],Sy.prototype,"startReconnection"),In([ZC(r=>r.userId)],Sy.prototype,"addDownlink"),In([ZC(r=>r)],Sy.prototype,"removeDownlink"),In([Xm(!0)],Sy.prototype,"updateSDP");var Jie=class{constructor(r){Se(this,"tag"),Se(this,"len"),Se(this,"data");let l=new DataView(r);this.tag=l.getUint16(),this.len=l.getUint16(2),this.data=new Uint8Array(r).slice(4,4+this.len).buffer}},Xie=class{constructor(r){Se(this,"tinyId"),Se(this,"data");let l=new DataView(r),d=0,g=[];for(;d<l.byteLength;){let C=l.getUint16(d+2),A=new Jie(new Uint8Array(r).slice(d,d+2+2+C).buffer);g.push(A),d+=4+C}g.forEach(C=>{C.tag===1?this.tinyId=new TextDecoder().decode(C.data):C.tag===2&&(this.data=C.data)})}},hG=new Set;function og(){let r=Math.floor(4294967296*Math.random());return hG.has(r)?og():(hG.add(r),r)}var Zie=Vi(qa()),fG=class extends Zie.default{constructor(r){super(),Se(this,"userId"),Se(this,"tinyId"),Se(this,"_sdpSemantics"),Se(this,"_isUplink"),Se(this,"_room"),Se(this,"_log"),Se(this,"_signalChannel"),Se(this,"_currentState","DISCONNECTED"),Se(this,"_prevTime",-1),Se(this,"_enableSEI"),this.userId=r.userId,this.tinyId=r.tinyId,this._room=r.room,this._sdpSemantics=r.room.sdpSemantics,this._isUplink=r.isUplink,this._log=pn.createLogger({id:"n",userId:this._room.userId,remoteUserId:this._isUplink?void 0:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=r.signalChannel,this._enableSEI=r.enableSEI}get _peerConnection(){var r;return((r=this.singlePC)==null?void 0:r.getPeerConnection())||null}get singlePC(){return this._room.singlePC}close(r){this._log.info("close connection"),this.emit("closed",r)}emitConnectionStateChangedEvent(r){return r!==this._currentState&&(en.emit($t.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:r,remoteUserId:this._isUplink?void 0:this.userId}),this.emit("connection-state-changed",{prevState:this._currentState,state:r}),this._currentState=r,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}getCurrentState(){return this._currentState}get isH264(){var r,l;return!((l=(r=this._peerConnection)==null?void 0:r.remoteDescription)==null||!l.sdp.includes("H264"))}},pG=class extends fG{constructor(r){super(Io(Fn({},r),{isUplink:!0})),Se(this,"localMainAudioTrack",null),Se(this,"localMainVideoTrack",null),Se(this,"localAuxAudioTrack",null),Se(this,"localAuxVideoTrack",null),Se(this,"_isPublishingAux",!1),Se(this,"_publishingLocalAudioTrack"),Se(this,"_publishingLocalVideoTrack"),Se(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),Se(this,"_flag",0),Se(this,"_checkPublishStateTimeoutId",-1),this.initialize()}get ssrc(){if(!this.singlePC)return{audio:0,video:0,videoRtx:0,small:0,smallRtx:0,auxiliary:0,auxiliaryRtx:0};let{audioSsrc:r,bigVideoSsrc:l,bigVideoRtxSsrc:d,smallVideoSsrc:g,smallVideoRtxSsrc:C,auxVideoSsrc:A,auxVideoRtxSsrc:L}=this.singlePC.uplinkSSRC;return{audio:r||0,video:l||0,videoRtx:d||0,small:g||0,smallRtx:C||0,auxiliary:A||0,auxiliaryRtx:L||0}}get flag(){return this._flag}set flag(r){this._flag!==r&&(this._flag=r,this.checkPublishState())}checkPublishState(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!r&&this._checkPublishStateTimeoutId>0)return;let{publishState:l,serverPublishState:d}=this,g=Object.keys(l).find(C=>l[C]!==d[C]);if(g){if(!r)return void(this._checkPublishStateTimeoutId=Hr.run(L_,()=>this.checkPublishState(!0),{delay:1e4,count:1}));this._log.warn("publish state not matched, ".concat(g," local:").concat(l[g]," server:").concat(d[g]," ").concat(lR())),Lo.addCount({key:521e3})}Hr.clearTask(this._checkPublishStateTimeoutId),this._checkPublishStateTimeoutId=-1}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var r,l,d,g;let C={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let A=this._peerConnection.getSenders();A&&(rd()?(C.audio=!((r=A[0])==null||!r.track),C.bigVideo=!((l=A[1])==null||!l.track),C.smallVideo=!((d=A[2])==null||!d.track),C.auxVideo=!((g=A[3])==null||!g.track)):A.forEach(L=>{L.track&&(L.track.kind===Be.AUDIO?C.audio=!0:(C.bigVideo=!0,this._room.videoManager.hasSmall&&(C.smallVideo=!0)))}))}return C}get serverPublishState(){return{audio:!!(this.flag&w_),bigVideo:!!(this.flag&k_),smallVideo:!!(this.flag&Ow),auxVideo:!!(this.flag&_C)}}get muteState(){var r,l,d;return{audio:!((r=this.localMainAudioTrack)==null||!r.muted),bigVideo:!((l=this.localMainVideoTrack)==null||!l.muted),auxVideo:!((d=this.localAuxVideoTrack)==null||!d.muted)}}initialize(){this.installEvents()}reset(){this.uninstallEvents(),this.uninstallTrackMuteEvents(this.localMainAudioTrack,this.localMainVideoTrack,this.localAuxVideoTrack)}close(r){super.close(r),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){var r;this.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this.on("connection-state-changed",this.handleConnectionStateChange,this),this.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||(r=this.singlePC)==null||r.on("spc-reconnected",this.onSinglePCReconnected,this)}uninstallEvents(){var r;this.off("connection-state-changed",this.handleConnectionStateChange,this),(r=this.singlePC)==null||r.off("spc-reconnected",this.onSinglePCReconnected,this)}emitConnectionStateChangedEvent(r,l){var d,g,C;let A=this._currentState,L=super.emitConnectionStateChangedEvent(r);return L&&A!==r&&(l?l.emit("connection-state-changed",{prevState:A,state:r}):((d=this.localMainVideoTrack)==null||d.emit("connection-state-changed",{prevState:A,state:r}),(g=this.localAuxVideoTrack)==null||g.emit("connection-state-changed",{prevState:A,state:r}),(C=this._publishingLocalVideoTrack)==null||C.emit("connection-state-changed",{prevState:A,state:r}))),L}publish(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C,isAuxiliary:A}=l;return function*(){var L,B,U,Z,ae,ce,we;if(!d.singlePC)return;yield d.singlePC.waitForPeerConnectionConnected();let Pe,{publishState:Ze,muteState:Ct}=d;if(g&&(d._publishingLocalAudioTrack=g,Ze.audio=!0,Ct.audio=g.muted),C){if(!d.singlePC.isH264EncodeSupported&&!d.singlePC.isVP8EncodeSupported)throw new Rn({code:an.NOT_SUPPORTED_H264,message:so({key:to.NOT_SUPPORTED_H264ENCODE})});gs&&Gm()===115&&C.profile.width*C.profile.height<=230400&&(d._log.warn("fallback video to 480p"),C.setProfile(Ll["480p_2"]),yield C.applyProfile()),d._publishingLocalVideoTrack=C,A?(Ze.auxVideo=!0,Ct.auxVideo=C.muted):(Ze.bigVideo=!0,Ct.bigVideo=C.muted)}if(d._isPublishingAux=A,C&&!A&&C.small&&(Pe=d._room.videoManager.smallTrack,Ze.smallVideo=!0),yield d._signalChannel.sendWaitForResponseWithRetry({command:vie,responseCommand:go.SPC_PUBLISH_RESULT,data:Io(Fn({},d.singlePC.uplinkSSRC),{state:Ze,muteState:Ct}),retries:3}),yield d.publishByTransceiver({localAudioTrack:g,localVideoTrack:C,smallTrack:Pe,isAuxiliary:A}),(L=d.singlePC.seiCodec)==null||L.handleEncodedStreams(),d._publishingLocalAudioTrack=null,d._publishingLocalVideoTrack=null,d._isPublishingAux=!1,A)C&&(d.localAuxVideoTrack=C),g&&(d.localAuxAudioTrack=g);else{if(C){d.localMainVideoTrack=C;let{scaleResolutionDownBy:Bt}=C;Bt>1&&(d._log.warn("setScaleResolutionDownBy main ".concat(Bt)),yield d.singlePC.setScaleResolutionDownBy(d._peerConnection.getSenders()[1],Bt))}g&&(d.localMainAudioTrack=g)}yield d.singlePC.setBandwidth({audio:((B=d.localMainAudioTrack)==null?void 0:B.profile.bitrate)||((U=d.localAuxAudioTrack)==null?void 0:U.profile.bitrate),bigVideo:(Z=d.localMainVideoTrack)==null?void 0:Z.profile.bitrate,smallVideo:(ce=(ae=d.localMainVideoTrack)==null?void 0:ae.small)==null?void 0:ce.bitrate,auxVideo:(we=d.localAuxVideoTrack)==null?void 0:we.profile.bitrate}),d.sendMediaSettings(),d.installTrackMuteEvents(g,C)}()})}publishByTransceiver(r){let{localAudioTrack:l,localVideoTrack:d,smallTrack:g,isAuxiliary:C}=r;if(!Lc())return;this._log.info("publish by transceiver");let A=d==null?void 0:d.outMediaTrack,L=l==null?void 0:l.outMediaTrack,B=this._peerConnection.getTransceivers(),U=[],Z=[];if(L){let ce=B[0].sender.replaceTrack(L);Z.push(0),U.push(ce)}if(A)if(C){let ce=B[3].sender.replaceTrack(A);Z.push(3),U.push(ce)}else{let ce=B[1].sender.replaceTrack(A);Z.push(1),U.push(ce)}if(g){let ce=B[2].sender.replaceTrack(g);Z.push(2),U.push(ce)}let ae=this.setTransceiverDirection(bo.SENDONLY,Z);return U.push(ae),Promise.all(U)}enableSmall(r){return at(this,null,function*(){if(!this.singlePC)return;let l=this._peerConnection.getTransceivers();r?this._room.videoManager.smallTrack&&(yield l[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection(bo.SENDONLY,[2])):(yield l[2].sender.replaceTrack(null),yield this.setTransceiverDirection(bo.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];l.forEach(g=>{g&&(g==null||g.on("mute",this.sendMutedFlag,this),g==null||g.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];l.forEach(g=>{g&&(g==null||g.off("mute",this.sendMutedFlag,this),g==null||g.off("unmute",this.sendMutedFlag,this))})}unpublish(r){return at(this,arguments,function(l){var d=this;let{localAudioTrack:g,localVideoTrack:C}=l;return function*(){let A=C&&C===d.localAuxVideoTrack,L=C==null?void 0:C.outMediaTrack,B=d._peerConnection.getSenders(),U=[];g&&(yield B[0].replaceTrack(null),U.push(0),A?d.localAuxAudioTrack=null:d.localMainAudioTrack=null),L&&(A?(yield B[3].replaceTrack(null),d.localAuxVideoTrack=null,d._mediaSettings=Io(Fn({},d._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),U.push(3)):(yield B[1].replaceTrack(null),yield B[2].replaceTrack(null),d.localMainVideoTrack=null,d._mediaSettings=Io(Fn({},d._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),U.push(1,2))),d.isMainStreamPublished||d.isAuxStreamPublished?(yield d.setTransceiverDirection(bo.INACTIVE,U),yield d.doPublishChange(!1)):yield d.doUnpublish(),d.uninstallTrackMuteEvents(g,C),C==null||C.emit("connection-state-changed",{prevState:d._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return at(this,null,function*(){let l={state:this.publishState,constraintConfig:this._mediaSettings},d=yield this._signalChannel.sendWaitForResponseWithRetry({command:qV,data:l,responseCommand:go.PUBLISH_STATE_CHANGE_RESULT,enableLog:r,retries:3});this.checkPublishResultCode(d.data.code,d.data.message)})}doUnpublish(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:XR,commandDesc:"unpublish",responseCommand:go.UNPUBLISH_RESULT,enableLog:r}).catch(l=>{if(l.getCode()===an.API_CALL_TIMEOUT)return Promise.resolve();throw l})}updateMediaSettings(){let{detail:{isH264EncodeSupported:r,isVp8EncodeSupported:l}}=this._room.checkSystemResult;r?this._mediaSettings.videoCodec="H264":l&&(this._mediaSettings.videoCodec="VP8");let d=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:g,localAuxVideoTrack:C}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?C=this._publishingLocalVideoTrack:g=this._publishingLocalVideoTrack),zm){if(d&&d.outMediaTrack){let A=d.outMediaTrack.getSettings();this._mediaSettings.audioChannel=A.channelCount||1,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=A.sampleRate||0}if(g&&g.outMediaTrack){let A=g.outMediaTrack.getSettings();this._mediaSettings.videoWidth=A.width||0,this._mediaSettings.videoHeight=A.height||0,this._mediaSettings.videoFps=A.frameRate||0,this._mediaSettings.videoBps=1e3*g.profile.bitrate,g.small&&(this._mediaSettings.smallVideoWidth=g.small.width,this._mediaSettings.smallVideoHeight=g.small.height,this._mediaSettings.smallVideoFps=g.small.frameRate,this._mediaSettings.smallVideoBps=1e3*g.small.bitrate)}if(C&&C.outMediaTrack){let A=C.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=A.width||0,this._mediaSettings.auxVideoHeight=A.height||0,this._mediaSettings.auxVideoFps=A.frameRate||0,this._mediaSettings.auxVideoBps=1e3*C.profile.bitrate}}else d&&d.outMediaTrack&&(this._mediaSettings.audioChannel=d.profile.channelCount,this._mediaSettings.audioBps=1e3*d.profile.bitrate,this._mediaSettings.audioFs=d.profile.sampleRate),g&&g.outMediaTrack&&(this._mediaSettings.videoWidth=g.profile.width,this._mediaSettings.videoHeight=g.profile.height,this._mediaSettings.videoFps=g.profile.frameRate,this._mediaSettings.videoBps=1e3*g.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:WV,data:this._mediaSettings,responseCommand:go.UPDATE_CONSTRAINT_CONFIG_RES}).then(r=>{r.data.code!==0&&this._log.warn(r.data.message)}).catch(()=>{})}addTrack(r){return at(this,null,function*(){if(!this._peerConnection)return;let l=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is adding ".concat(r.kind," track to current published local ").concat(l?Be.AUXILIARY:Be.MAIN," stream")),rd()&&(yield this.addTrackByTransceiver(r,l))})}addTrackByTransceiver(r,l){return at(this,null,function*(){var d;if(!r.mediaTrack)return;let g=this._peerConnection.getTransceivers();if(r.kind===Be.AUDIO)yield g[0].sender.replaceTrack(r.outMediaTrack);else{let C=l?3:1;yield g[C].sender.replaceTrack(r.outMediaTrack),C===1&&((d=this.localMainVideoTrack)!=null&&d.small)&&(yield g[2].sender.replaceTrack(this._room.videoManager.smallTrack)),g[C].direction===bo.INACTIVE&&(yield this.setTransceiverDirection(bo.SENDONLY,[C]))}this.updateMediaSettings(),yield this.doPublishChange()})}removeTrack(r){return at(this,null,function*(){if(!this._peerConnection)return;let l=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is removing ".concat(r.kind," track from current published local ").concat(l?Be.AUXILIARY:Be.MAIN," stream")),rd()&&(yield this.removeTrackByTransceiver(r,l))})}removeTrackByTransceiver(r,l){return at(this,null,function*(){if(!r.mediaTrack)return;let d=this._peerConnection.getTransceivers();if(r.kind===Be.AUDIO)yield d[0].sender.replaceTrack(null);else{let g=l?3:1;yield d[g].sender.replaceTrack(null),g===1&&this._room.videoManager.hasSmall&&(yield d[2].sender.replaceTrack(null)),yield this.setTransceiverDirection(bo.INACTIVE,[g])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(r,l){return at(this,null,function*(){if(!Nr)return;let d=!1,g=!1;this._log.info("setting transceiver ".concat(l.join(",")," direction to ").concat(r));let C=this._peerConnection.getTransceivers();if(l.forEach(B=>{C[B].direction!==r&&(C[B].direction=r,d=!0)}),d){this._log.info("updating offer");let B=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(B)}let A=-1,L=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(B=>{if(B.match(new RegExp("a=(".concat(bo.INACTIVE,"|").concat(bo.RECVONLY,"|").concat(bo.SENDONLY,")")))&&A++,l.includes(A)){if(r===bo.INACTIVE&&B.includes("a=".concat(bo.RECVONLY)))return g=!0,"a=".concat(r);if(r===bo.SENDONLY&&B.includes("a=".concat(bo.INACTIVE)))return g=!0,"a=".concat(bo.RECVONLY)}return B}).join(`\r
`);g&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:L}))})}replaceTrack(r){return at(this,null,function*(){var l;let d=(l=this._peerConnection)==null?void 0:l.getSenders(),g=r.outMediaTrack||r.mediaTrack;if(!d||d.length===0||!g||d.find(A=>A.track===g))return;let C=r===this.localAuxAudioTrack||r===this.localAuxVideoTrack;this._log.info("is replacing ".concat(g.kind," track on ").concat(C?Be.AUXILIARY:Be.MAIN," stream")),g.kind===Be.AUDIO&&d[0]&&(yield d[0].replaceTrack(g)),g.kind===Be.VIDEO&&(!C&&d[1]&&(yield d[1].replaceTrack(g)),C&&d[3]&&(yield d[3].replaceTrack(g)))})}setBandwidth(r){return at(this,arguments,function(l){var d=this;let{bandwidth:g,type:C,videoType:A}=l;return function*(){if(d.singlePC){let L={};C===Be.AUDIO?L.audio=g:A==="big"?L.bigVideo=g:A==="small"?L.smallVideo=g:L.auxVideo=g,yield d.singlePC.setBandwidth(L)}}()})}sendMutedFlag(r){r===this.localAuxAudioTrack||r===this.localAuxVideoTrack||(this._log.info("send muted state: ".concat(JSON.stringify(this.muteState))),this._signalChannel.sendWaitForResponseWithRetry({command:$V,responseCommand:go.MUTE_RESULT,data:this.muteState,retries:3}).catch(()=>{}))}handleConnectionStateChange(r){r.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&en.emit($t.SEND_FIRST_VIDEO_FRAME,{room:this._room})}getVideoTrackId(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Be.VIDEO;if(this._peerConnection){let l=this._peerConnection.getSenders();if(r===Be.AUXILIARY&&l[3]&&l[3].track)return l[3].track.id;if(r===Be.VIDEO&&l[1]&&l[1].track)return l[1].track.id}if(this.localMainVideoTrack&&r===Be.VIDEO){let l=this.localMainVideoTrack.mediaTrack;if(l)return l.id}if(this.localAuxVideoTrack&&r===Be.AUXILIARY){let l=this.localAuxVideoTrack.mediaTrack;if(l)return l.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(r,l){if(r!==0)throw r===bC?(this._log.error(Js.NOT_SUPPORTED_H264ENCODE),new Rn({code:an.NOT_SUPPORTED_H264,message:so({key:to.NOT_SUPPORTED_H264ENCODE})})):new Rn({code:an.UNKNOWN,message:so({key:to.SIGNAL_RESPONSE_FAILED,data:{signalResponse:go.PUBLISH_RESULT,code:r,message:l}})})}onSinglePCReconnected(){return at(this,null,function*(){this.isMainStreamPublished&&(this._log.warn("republish main stream"),yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(this._log.warn("republish aux stream"),yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0}))})}};function mG(r){return Object.keys(r).filter(l=>r[l])}var sA=class extends fG{constructor(r){super(Io(Fn({},r),{isUplink:!1})),Se(this,"_flag",0),Se(this,"role","anchor"),Se(this,"remoteAudioTrack"),Se(this,"remoteVideoTrack"),Se(this,"remoteAuxiliaryTrack"),Se(this,"ssrc",{audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0}),this.flag=r.flag,this.remoteAudioTrack=new HR(this._room,this),this.remoteVideoTrack=new uy(this._room,this),this.remoteAuxiliaryTrack=new TV(this._room,this),this.initialize()}get subscribeState(){return{audio:this.remoteAudioTrack.isSubscribed||this.remoteAudioTrack.isSubscribing,video:this.remoteVideoTrack.isBig&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),smallVideo:this.remoteVideoTrack.isSmall&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),auxiliary:this.remoteAuxiliaryTrack.isSubscribed||this.remoteAuxiliaryTrack.isSubscribing}}get muteState(){return J_(this.flag,this.userId)}get flag(){return this._flag}set flag(r){var l,d,g;r!==this._flag&&(this._flag=r,(l=this.remoteAudioTrack)==null||l.onFlagChanged(),(d=this.remoteVideoTrack)==null||d.onFlagChanged(),(g=this.remoteAuxiliaryTrack)==null||g.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(r){return r===Be.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){this.installEvents()}close(r){super.close(r),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents(),this.removeDownlink()}installEvents(){!this.singlePC||(this.listeners("track").includes(this.onTrack)||this.singlePC.on("track",this.onTrack,this),this.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||this.singlePC.on("spc-reconnected",this.onSinglePCReconnected,this))}uninstallEvents(){!this.singlePC||(this.singlePC.off("track",this.onTrack,this),this.singlePC.off("spc-reconnected",this.onSinglePCReconnected,this))}emitConnectionStateChangedEvent(r){var l,d;let g=this._currentState,C=super.emitConnectionStateChangedEvent(r);return C&&g!==r&&((l=this.remoteVideoTrack)==null||l.emit("connection-state-changed",{prevState:g,state:r}),(d=this.remoteAuxiliaryTrack)==null||d.emit("connection-state-changed",{prevState:g,state:r})),C}onTrack(r){let l=r.streams[0],{track:d}=r;if(!l.id.includes(this.tinyId))return;let g=l.id.includes("aux")?"auxiliary":"main";this._log.debug("ontrack ".concat(g," ").concat(d.kind));let C=Be.AUDIO;d.kind===Be.VIDEO&&(C=g===Be.MAIN?Be.VIDEO:Be.AUXILIARY);let A=this.remoteAudioTrack;C===Be.VIDEO?A=this.remoteVideoTrack:C===Be.AUXILIARY&&(A=this.remoteAuxiliaryTrack),A.setInputMediaStreamTrack(d)}isSubscriptionStateNotChanged(r){return JSON.stringify(r)===JSON.stringify(this.subscribeState)}subscribe(r,l){return at(this,null,function*(){try{if(this.isSubscriptionStateNotChanged(r))return;if(this._log.info("subscribe ".concat(l," ").concat(mG(r))),this.hasSSRC){let d="subscribe_change";Object.values(r).find(g=>g===!0)||(d="unsubscribe"),yield this.sendSubscription(d,r)}else yield this.doSubscribe(r),this.checkTrackEnded(r)}catch(d){throw this._room.isJoined&&this.isStreamUnpublished(l)?(this._log.warn("".concat(d.message," ").concat(JSON.stringify(this.muteState))),new Rn({code:an.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):d}})}checkTrackEnded(r){var l,d,g;(r.audio&&((l=this.remoteAudioTrack.mediaTrack)==null?void 0:l.readyState)==="ended"||r.video&&((d=this.remoteVideoTrack.mediaTrack)==null?void 0:d.readyState)==="ended"||r.auxiliary&&((g=this.remoteAuxiliaryTrack.mediaTrack)==null?void 0:g.readState)==="ended")&&this.singlePC&&!this.singlePC.isReconnecting&&(this._log.warn("remote track ended start spc reconnect"),this.singlePC.startReconnection())}unsubscribe(r){return at(this,arguments,function(l){var d=this;let{remoteTracks:g,streamType:C}=l;return function*(){var A;if(C==="main"&&!d.isMainStreamSubscribed||C==="auxiliary"&&!d.isAuxStreamSubscribed)return void d._log.info("".concat(C," stream already unsubscribed"));let L=Fn({},d.subscribeState);g.forEach(U=>{switch(U.mediaType){case 1:L.audio=!1;break;case 4:L.video=!1;break;case 8:L.smallVideo=!1;break;case 2:L.auxiliary=!1}});let B="subscribe_change";Object.values(L).find(U=>U===!0)||(B="unsubscribe"),d._log.info("".concat(B==="unsubscribe"?B:"subscribe"," ").concat(C," [").concat(mG(L),"]")),B==="unsubscribe"&&((A=d.singlePC)==null||A.removeDownlinkQueue.add(d.tinyId)),yield d.sendSubscription(B,L),B==="unsubscribe"&&(yield d.removeDownlink())}()})}sendSubscription(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,d={srcTinyId:this.tinyId,srcUserId:this.userId},g=KV,C=go.UNSUBSCRIBE_RESULT;return r==="subscribe_change"&&(d={audio:l.audio,bigVideo:l.video,auxVideo:l.auxiliary,smallVideo:l.smallVideo,srcTinyId:this.tinyId},g=zV,C=go.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponseWithRetry({command:g,data:d,responseCommand:C,timeout:1e4,retries:3}).then(A=>{let{data:L}=A;if(L.code!==0){let B=new Rn({code:L.code,message:so({key:to.ERROR_MESSAGE,data:{type:r,message:L.message}})});throw this._log.error(B),B}})}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}setDelay(r){let{audioDelay:l,videoDelay:d}=r;this.remoteAudioTrack.stat.end2EndDelay=l,this.remoteVideoTrack.stat.end2EndDelay=d}onSinglePCReconnected(){(this.ssrc.audio||this.ssrc.video||this.ssrc.auxiliary)&&(this._log.warn("resubscribe ".concat(JSON.stringify(this.subscribeState))),this.doSubscribe(this.subscribeState))}get hasSSRC(){return this.ssrc.audio&&this.ssrc.video&&this.ssrc.auxiliary}doSubscribe(){return at(this,arguments,function(){var r=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState,d=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return function*(){if(r.singlePC){if(r.singlePC.addDownlinkQueue.add(r.tinyId),yield r.singlePC.waitForPeerConnectionConnected(),d||!r.hasSSRC){let g={audioSsrc:og(),bigVideoSsrc:og(),bigVideoRtxSsrc:og(),auxVideoSsrc:og(),auxVideoRtxSsrc:og()},{audioSsrc:C,bigVideoSsrc:A,bigVideoRtxSsrc:L,auxVideoSsrc:B,auxVideoRtxSsrc:U}=g;r.ssrc={audio:C,video:A,videoRtx:L,auxiliary:B,auxiliaryRtx:U},r.singlePC.addDownlinkQueue.delete(r.tinyId),yield r.singlePC.addDownlink({userId:r.userId,tinyId:r.tinyId,ssrc:r.ssrc});try{let Z=yield r._signalChannel.sendWaitForResponseWithRetry({command:_ie,responseCommand:go.SPC_SUBSCRIBE_RESULT,data:{srcUserId:r.userId,srcTinyId:r.tinyId,audio:l.audio,bigVideo:l.video,auxVideo:l.auxiliary,smallVideo:l.smallVideo,customData:!1,ssrc:g},retries:3,retryTimeout:0});if(Z.data.code!==0)throw new Rn({code:Z.data.code,message:Z.data.message})}catch(Z){throw yield r.removeDownlink(),Z}return}r.singlePC.addDownlinkQueue.delete(r.tinyId),yield r.singlePC.addDownlink({userId:r.userId,tinyId:r.tinyId,ssrc:r.ssrc})}}()})}removeDownlink(){return at(this,null,function*(){!this.singlePC||(this.ssrc={audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0},this.singlePC.removeDownlinkQueue.delete(this.tinyId),yield this.singlePC.removeDownlink(this.userId))})}};In([Xm(),Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];return new Promise((C,A)=>{let L=B=>{this.off("closed",L),A(new Rn({code:an.API_CALL_ABORTED,message:so({key:to.CONNECTION_ABORTED,data:B})}))};this.on("closed",L),r.apply(this,d).then(C,A).finally(()=>{this.off("closed",L)})})})],sA.prototype,"subscribe"),In([Xm()],sA.prototype,"unsubscribe");var Qie=sA,eae=Vi(qa()),gG=class extends eae.EventEmitter{constructor(r,l){super(),this.room=r,this.signalChannel=l,Se(this,"log"),Se(this,"cmdIdSeqMap",new Map),Se(this,"messageMap",new Map),this.log=pn.createLogger({id:"cmm",userId:r.userId}),this.onReceiveMsg=this.onReceiveMsg.bind(this),l.on(go.RECEIVE_CUSTOM_MSG,this.onReceiveMsg)}send(r){let{cmdId:l,data:d}=r,g=this.cmdIdSeqMap.get(l)||Math.floor(16383*Math.random()),C={cmdId:l,msg:btoa(String.fromCharCode(...new Uint8Array(d))),ordered:!0,reliable:!0,streamSeq:g};this.cmdIdSeqMap.set(l,g+1),this.signalChannel.send(bie,C)}onReceiveMsg(r){let{data:l}=r.data,d=this.room.tinyIdToUserIdMap.get(l.srcTinyId);if(d){let g={userId:d,cmdId:l.cmdId,seq:l.streamSeq,data:Uint8Array.from(atob(l.msg),C=>C.charCodeAt(0)).buffer};if(l.ordered){let C="".concat(d,"_").concat(g.cmdId),A=this.messageMap.get(C);if(!A||Math.abs(A.lastSeq-g.seq)>gG.SEQ_INTERVAL)this.messageMap.set(C,{lastSeq:g.seq,cachedMessageMap:new Map}),this.emitMessage(g);else if(g.seq>A.lastSeq){if(g.seq===A.lastSeq+1)this.emitMessage(g);else if(!A.cachedMessageMap.has(g.seq)){let L=setTimeout(()=>this.emitMessage(g,!0),5e3);A.cachedMessageMap.set(g.seq,{message:g,timeoutId:L})}}else this.log.debug("drop message ".concat(g.userId,"-").concat(g.cmdId,"-").concat(g.seq))}else this.emit("message",g)}}emitMessage(r){let l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var d;let g=this.messageMap.get("".concat(r.userId,"_").concat(r.cmdId)),C=r;if(g){if(l){let L=[...g.cachedMessageMap.values()].sort((B,U)=>B.message.seq-U.message.seq);L[0]&&(C=L[0].message)}C.seq-g.lastSeq>1&&this.log.debug("msg lost userId: ".concat(C.userId," seq: ").concat(g.lastSeq," -> ").concat(C.seq)),g.lastSeq=C.seq,clearTimeout((d=g.cachedMessageMap.get(C.seq))==null?void 0:d.timeoutId),g.cachedMessageMap.delete(C.seq)}this.emit("message",C);let A=g==null?void 0:g.cachedMessageMap.get(C.seq+1);A&&this.emitMessage(A.message)}},vG=gG;Se(vG,"SEQ_INTERVAL",300);var _G,{isString:yG,isUndefined:rg,getNetworkType:tae,isEmpty:Ey}=Dl,bf=class extends $ie{constructor(r){super(r),this._heartbeat=-1,this._lastHeartBeatTime=-1,this._joinTimeout=-1,this._firstPublishedList=null,this._joinReject=null,this._isRelayChanged=!1,this._signalChannel=null,this.uplinkConnection=null,this.singlePC=null,this.enableSPC=KC,this._changeBigSmallRecords=new Map,this._networkQuality=null,this._turnServers=[],this._syncUserListInterval=-1,this._smallStreamConfig={bitrate:100,frameRate:15,height:120,width:160},this.enableSEI=!1,this._enableAudioVolumeEvaluation=!1,this._audioVolumeIntervalId=0,this._enableMultiAuxStream=!1,this._pureAudioPushMode=!1,this.enableHWEncoder=!1,this._stats=new Sie(this,this._log),this.userManager=new Vre(this.userId,this._log),this._version=Ol,this.sdpSemantics=IC,rg(r.sdpSemantics)?Z_.isUnifiedPlanDefault()&&(this.sdpSemantics=R_):this.sdpSemantics=r.sdpSemantics,this._log.info("sdpSemantics: ".concat(this.sdpSemantics,", netType: ").concat(tae())),r.iceTransportPolicy&&(this._iceTransportPolicy=r.iceTransportPolicy),this._enableMultiAuxStream=!rg(r.enableMultiAuxStream)&&r.enableMultiAuxStream,this.enableSEI=r.enableSEI,!rg(r.enableSPC)&&KC&&(this.enableSPC=r.enableSPC),this.enableHWEncoder=r.enableHWEncoder||!1,this._initBusinessInfo(r)}get isMainStreamPublished(){var r;return!((r=this.uplinkConnection)==null||!r.isMainStreamPublished)}get isMainAudioPublished(){var r;return!((r=this.uplinkConnection)==null||!r.localMainAudioTrack)}get isAuxStreamPublished(){var r;return!((r=this.uplinkConnection)==null||!r.isAuxStreamPublished)}get hasAuxStream(){return[...this.remotePublishedUserMap.values()].findIndex(r=>r.muteState.hasAuxiliary)>=0}get userMap(){return this.userManager.userMap}get remotePublishedUserMap(){return this.userManager.remotePublishedUserMap}get tinyIdToUserIdMap(){return new Map([...this.userMap.values()].map(r=>[r.tinyId,r.userId]))}join(r,l,d){return at(this,null,function*(){return this.userManager.mySelfId=this.userId,this.userManager.on("1",g=>{this.emit("peer-join",g)}),this.userManager.on("2",g=>{this.closeDownLinkConnection(g,"remote user exitRoom"),this.emit("peer-leave",g)}),this.userManager.on("3",this.createDownlinkConnection,this),this.userManager.on("5",this.closeDownLinkConnection,this),this.userManager.on("6",g=>{var C=((A,L)=>{var B={};for(var U in A)_w.call(A,U)&&L.indexOf(U)<0&&(B[U]=A[U]);if(A!=null&&gC)for(var U of gC(A))L.indexOf(U)<0&&O4.call(A,U)&&(B[U]=A[U]);return B})(g,[]);en.emit($t.REMOTE_PUBLISH_STATE_CHANGED,Fn({room:this},C)),this.emit("remote-publish-state-changed",Fn({},C))}),this._joinOptions=r,new Promise((g,C)=>at(this,null,function*(){var A,L;this._joinReject=C;try{this.checkDestroy();try{yield Promise.all([this.initialize(),this.initSinglePC()])}catch(B){if(!(B instanceof Rn&&B.code===an.SPC_INITIALIZED_FAILED))return C(B);(A=this._signalChannel)==null||A.destroy(),yield this.initialize()}yield this.doJoin(r,(L=this.singlePC)==null?void 0:L.clientAbility),g(),this._firstPublishedList&&this.onPublishedUserList({data:{userList:this._firstPublishedList}})}catch(B){C(B)}this._joinReject=null}))})}initSinglePC(){return at(this,null,function*(){if(this.enableSPC&&!this.singlePC){this.singlePC=new Sy({signalChannel:this._signalChannel,room:this,enableCustomMessage:!1}),this.singlePC.on("sei-message",r=>this.emit("sei-message",r)),this.singlePC.once("error",()=>this.fallbackToMPC());try{return yield this.singlePC.initialize()}catch(r){throw this.fallbackToMPC(),new Rn({code:an.SPC_INITIALIZED_FAILED,message:r==null?void 0:r.message})}}})}doJoin(r,l){return new Promise((d,g)=>at(this,null,function*(){var C,A,L;r.privateMapKey&&(this.privateMapKey=r.privateMapKey),this._signalChannel.once(HV,Z=>{this.clearJoinTimeout(),en.emit($t.JOIN_SIGNAL_CONNECTION_END,{room:this,error:Z}),g(Z)}),za((A=(C=this.scheduleResult)==null?void 0:C.config)==null?void 0:A.singlePC)&&KC&&(this.enableSPC=this.scheduleResult.config.singlePC),this.keyPointManager.setConnectionType(this.singlePC?1:2);let B={roomId:String(r.roomId||r.strRoomId),useStringRoomId:this.useStringRoomId,privateMapKey:this.privateMapKey,trtcRole:r.role,trtcScene:this.scene==="live"?2:1,sdpSemantics:this.sdpSemantics,version:this._version,ua:navigator&&navigator.userAgent||"",terminalType:IF(),netType:UC(),bussinessInfo:this._businessInfo,ability:l,sdkType:this._sdkType,userSig:this.userSig};this._log.debug("join room signal data: ".concat(JSON.stringify(B)));let U=5e3;(L=this.scheduleResult.config)!=null&&L.enterRoomTimeout&&this.scheduleResult.config.enterRoomTimeout>=1&&(U=1e3*this.scheduleResult.config.enterRoomTimeout),this._joinTimeout=window.setTimeout(()=>{g(new Rn({code:an.JOIN_ROOM_FAILED,message:so({key:to.JOIN_ROOM_TIMEOUT})}))},U),en.emit($t.JOIN_SEND_CMD,{room:this}),this._signalChannel.send(this.singlePC?gie:nie,B),this._signalChannel.once(go.JOIN_ROOM_RESULT,Z=>{this.clearJoinTimeout();let{code:ae,message:ce,data:we,tinyId:Pe}=Z.data;en.emit($t.JOIN_RECEIVED_CMD_RES,{room:this,code:ae}),ae===0?(this._log.info("Join room success, start heartbeat"),Pe&&(this.tinyId=Pe),this.startHeartbeat(),this.syncUserList(),this.startSyncUserListInterval(),this._firstPublishedList=we.publishers,this.singlePC&&this.singlePC.connect(we.ability).catch(()=>{}),d()):(this._log.error("Join room failed result: ".concat(ae," error: ").concat(ce)),g(new Rn({code:an.JOIN_ROOM_FAILED,extraCode:ae,message:so({key:to.JOIN_ROOM_FAILED,data:{error:ce,code:ae}})})))})}))}reJoin(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return at(this,null,function*(){if(this.isJoined)try{this._log.warn("reJoin pending: ".concat(this._joinOptions.roomId));let l,d=[];if(this.singlePC&&(this.singlePC.close(),this.singlePC=null,d.push(this.initSinglePC().then(g=>(l=g,g)))),this._signalChannel&&(this._signalChannel.race=r,this._signalChannel.close(),d.push(this._signalChannel.connect())),yield Promise.all(d),yield this.doJoin(Io(Fn({},this._joinOptions),{role:this.role==="anchor"?20:21,privateMapKey:this.privateMapKey}),l),this._log.warn("reJoin success"),li.logSuccessEvent({userId:this.userId,eventType:wc.REJOIN}),this.singlePC){let g=C=>{var A;C.state==="CONNECTED"&&((A=this.singlePC)==null||A.off(If.CONNECTION_STATE_CHANGED,g),this.uplinkConnection instanceof pG&&this.uplinkConnection.onSinglePCReconnected(),this.remotePublishedUserMap.forEach(L=>{L.installEvents(),L.onSinglePCReconnected()}))};this.singlePC.on(If.CONNECTION_STATE_CHANGED,g),this.checkConnectionsToReconnect(),this.uplinkConnection instanceof oA&&!this.uplinkConnection.getIsReconnecting()&&this.uplinkConnection.startReconnection()}}catch(l){this._log.warn("reJoin fail ".concat(l)),this.reset(),li.logFailedEvent({userId:this.userId,eventType:wc.REJOIN,error:l}),this.emit("error",new Rn({code:an.JOIN_ROOM_FAILED,message:so({key:to.REJOIN_ROOM_FAILED,data:{roomId:this._joinOptions.roomId}})}))}else this._log.warn("reJoin abort")})}initialize(){return at(this,null,function*(){let{mainUrl:r,backupUrl:l}=this.getSignalChannelUrl(),d=this._signalChannel||function(C){return[...hS.values()].find(L=>L.room.userId===C&&!L.room.isJoined)||null}(this.userId),g=!!(d&&d.isConnected&&d.keepAlive);return this._log.info("".concat(g?"reuse":"setup"," signal channel")),g?(d.url=r,d.backupUrl=l,d.room=this,this._signalChannel=d):(this._signalChannel=new jV({sdkAppId:this.sdkAppId,userId:this.userId,userSig:this.userSig,url:r,backupUrl:l,race:this.enableSPC&&!this.proxy_ws,room:this}),this._customMessageManager=new vG(this,this._signalChannel),this._customMessageManager.on("message",C=>{this.emit("custom-message",C)})),this._networkQuality||(this._networkQuality=new rA({signalChannel:this._signalChannel,room:this}),this._networkQuality.on(rA.EVENT_NETWORK_QUALITY,C=>{this.emit("network-quality",C)})),Ul(this,this._signalChannel).add(JR,C=>{en.emit($t.SIGNAL_CONNECTION_STATE_CHANGED,Fn({room:this},C)),this.emit("signal-connection-state-changed",C)}).add(Qre,C=>{this.reset(),this.emit("error",C)}).add(go.PEER_JOIN,C=>{let{srcTinyId:A,userId:L,role:B}=C.data.data;this.userManager.addUser({userId:L,tinyId:A,role:B})}).add(go.PEER_LEAVE,C=>{let{userId:A,reason:L=0}=C.data.data;this.userManager.deleteUser(A,L)}).add(go.UPDATE_REMOTE_MUTE_STAT,C=>{this._lastHeartBeatTime>0&&Date.now()-this._lastHeartBeatTime>=1e4&&this.doHeartbeat(),this.onPublishedUserList(C.data)}).add(go.CLIENT_BANNED,C=>{let A=C.data.data,{reason:L}=A;if(li.uploadEvent({log:"stat-banned:".concat(L),userId:this.userId}),L==="user_time_out")return this._log.warn("".concat(L," last heart beat time: ").concat(this._lastHeartBeatTime," interval: ").concat(Date.now()-this._lastHeartBeatTime,", visibility: ").concat(document.visibilityState)),void this.reJoin();this._log[L==="kick"?"error":"info"]("user was banned because of [".concat(L,"]")),this.reset(),this.emit("banned",{reason:L})}),this._signalChannel.once(BV,C=>{this.tinyId=C.signalInfo.tinyId,en.emit($t.JOIN_SIGNAL_CONNECTION_END,{room:this})}),en.emit($t.JOIN_SIGNAL_CONNECTION_START,{room:this}),yield this._signalChannel.connect(),g&&en.emit($t.JOIN_SIGNAL_CONNECTION_END,{room:this}),g})}setSignalChannel(r){this._signalChannel=r,r||Ia(this)}leave(){return at(this,null,function*(){var r;try{yield this.doHeartbeat()}catch{}this._log.info("leave() => leaving room"),en.emit($t.LEAVE_SEND_CMD,{room:this}),(r=this._signalChannel)==null||r.send(oie)})}clearNetworkQuality(){this._networkQuality&&(this._networkQuality.stop(),this._networkQuality=null)}closeConnections(){this.remotePublishedUserMap.forEach(r=>{this.closeDownLinkConnection(r.userId,"you exitRoom")})}clearJoinTimeout(){clearTimeout(this._joinTimeout),this._joinTimeout=-1}startHeartbeat(){this._heartbeat===-1&&(this._heartbeat=Hr.run(Um,this.doHeartbeat.bind(this),{delay:2e3}))}stopHeartbeat(){this._heartbeat!==-1&&(this._log.info("stopHeartbeat"),Hr.clearTask(this._heartbeat),this._heartbeat=-1,this._lastHeartBeatTime=-1)}doHeartbeat(){return at(this,null,function*(){var r;let l=this.badCaseDetector.getMonitorFreeze(),d=yield this._stats.getStatsReport({uplinkConnection:this.uplinkConnection,downlinkConnections:this.remotePublishedUserMap,freezeMap:l});if(this.badCaseDetector.resetMonitor(),(r=this._signalChannel)==null||!r.isConnected)return;let g=this._signalChannel.isConnected?function(L){if(Zm.has(L)){let B=Zm.get(L).map(U=>({uint32_event_id:U.eventId,uint64_date:U.timestamp,str_userid:U.remoteUserId,str_event_json:U.eventDesc}));return Zm.delete(L),B}return[]}(this.userId):[],C=Fn({str_sdk_version:Sw,uint64_datetime:new Date().getTime(),msg_user_info:{str_identifier:this.userId,uint64_tinyid:this.tinyId},msg_device_info:{uint32_terminal_type:15,str_device_name:navigator.platform,str_os_version:"",uint32_net_type:UC()},msg_event_msg:g,str_acc_ip:this.getSignalInfo().relayIp,str_client_ip:this.getSignalInfo().clientIp},d);en.emit($t.HEARTBEAT_REPORT,{room:this,report:C}),this._signalChannel.send(rie,C),this.emit("heartbeat-report",Io(Fn({},C),{bytes_sent:this._stats.totalBytesSent+this._signalChannel.bytesSent,bytes_received:this._stats.totalBytesReceived+this._signalChannel.bytesReceived}));let A=Date.now();this._lastHeartBeatTime>0&&A-this._lastHeartBeatTime>1e4&&this._log.warn("heartbeat took ".concat(A-this._lastHeartBeatTime)),this._signalChannel.isConnected&&(this._lastHeartBeatTime=A),!this._isRelayChanged&&this.isRelayMaybeFailed()&&(this.reJoin(),this._isRelayChanged=!0)})}onPublishedUserList(r){if(!this.isJoined)return;let l=r.data.userList.map(d=>{let{userId:g,srcTinyId:C,flag:A}=d;g===this.userId&&this.uplinkConnection&&(this.uplinkConnection.flag=A);let L=this.remotePublishedUserMap.get(g);return L&&this.checkSubscribeBigSmallVideo(L),{userId:g,tinyId:C,flag:A}});en.emit($t.RECEIVED_PUBLISHED_USER_LIST,{room:this,publishedUserList:l}),this.userManager.setRemotePublishedUserList(l)}closeUplink(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"you unpublished";this.uplinkConnection&&(this.localTracks.size>0&&this.uplinkConnection.doUnpublish(),this.uplinkConnection.close(r),this.uplinkConnection=null),this.localTracks.forEach(l=>l.unpublish()),this.localTracks.clear()}createDownlinkConnection(r){let{userId:l,tinyId:d,flag:g}=r,C=new(this.singlePC?Qie:ZV)({userId:l,tinyId:d,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:g});this.userManager.addRemotePublishedUser(C),this.installDownlinkEvents(C,l),this.emit("remote-published",C)}closeDownLinkConnection(r){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"remote user unpublished",d=this.remotePublishedUserMap.get(r);d&&(d.close(l),this.emit("remote-unpublished",d))}installDownlinkEvents(r,l){r.on("error",d=>{let g=d.getCode();g!==an.ICE_TRANSPORT_ERROR&&(g===an.DOWNLINK_RECONNECTION_FAILED&&this.closeDownLinkConnection(l),this.emit("error",d))}),r.on("connection-state-changed",d=>{this.emit("media-connection-state-changed",Io(Fn({},d),{userId:r.userId}))}),r.on("firewall-restriction",()=>{this.emit("firewall-restriction")})}startSyncUserListInterval(){this._syncUserListInterval===-1&&(this._syncUserListInterval=Hr.run(Um,this.syncUserList.bind(this)))}stopSyncUserListInterval(){Hr.clearTask(this._syncUserListInterval),this._syncUserListInterval=-1}syncUserList(){return this.getUserList().then(r=>{this.userManager.setUserList(r)}).catch(r=>{this._log.debug("sync user list failed: ".concat(r))})}getUserList(){var r;return(r=this._signalChannel)!=null&&r.isConnected?this._signalChannel.sendWaitForResponse({command:fie,responseCommand:go.USER_LIST_RES,enableLog:!1,timeout:2e3}).then(l=>{let{data:d}=l,{code:g,message:C}=d;if(g===0)return(d.data&&d.data.userList||[]).map(A=>{let{userId:L,srcTinyId:B,role:U}=A;return{userId:L,tinyId:B,role:U}});throw so({key:to.SIGNAL_RESPONSE_FAILED,data:{signalResponse:go.USER_LIST_RES,code:g,message:C}})}):Promise.reject("not connected")}getAllConnections(){let r=[...this.remotePublishedUserMap.values()];return this.uplinkConnection&&r.push(this.uplinkConnection),r}isRelayMaybeFailed(){if(this._signalChannel&&!this._signalChannel.isOnline||!YV)return!1;if(this.singlePC)return this.singlePC.reconnectionCount>6;let r=this.getAllConnections();if(r.length===0)return!1;for(let l=0;l<r.length;l++)if(r[l].getReconnectionCount()<6)return!1;return!0}checkConnectionsToReconnect(){var r;this.singlePC?((r=this.singlePC.getPeerConnection())==null?void 0:r.connectionState)===ni.CLOSED&&!this.singlePC.isReconnecting&&(this._log.warn("spc pc is closed but not reconnect"),this.singlePC.startReconnection()):this.getAllConnections().forEach(l=>{if(l instanceof vf&&!l.getIsReconnecting()){let d=l.getPeerConnection();d&&d.connectionState===ni.CLOSED&&(this._log.warn("[".concat(l.getUserId(),"] pc is closed but not reconnect")),l.startReconnection())}})}fallbackToMPC(){return at(this,null,function*(){var r;if(this._log.warn("fallback to multi pc"),li.uploadEvent({log:"stat-fallback",userId:this.userId}),this.enableSPC=!1,(r=this.singlePC)==null||r.close(),this.singlePC=null,this.isJoined&&(yield this.reJoin(!1)),this.uplinkConnection){let l=this.uplinkConnection;this.uplinkConnection=new oA({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),l.isMainStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:l.localMainAudioTrack,localVideoTrack:l.localMainVideoTrack,isAuxiliary:!1})),l.isAuxStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:l.localAuxAudioTrack,localVideoTrack:l.localAuxVideoTrack,isAuxiliary:!0})),l.close()}this.remotePublishedUserMap.forEach(l=>{let d=new ZV({userId:l.userId,tinyId:l.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:l.flag,remoteAudioTrack:l.remoteAudioTrack,remoteVideoTrack:l.remoteVideoTrack,remoteAuxiliaryTrack:l.remoteAuxiliaryTrack});this.installDownlinkEvents(d,l.userId),this.remotePublishedUserMap.set(l.userId,d),l.isMainStreamSubscribed&&d.subscribe(l.subscribeState,"main"),l.isAuxStreamSubscribed&&d.subscribe(l.subscribeState,"auxiliary")})})}destroy(){this.isDestroyed||(this._signalChannel&&(this._log.info("destroying SignalChannel"),this._signalChannel.close(),this._signalChannel=null),super.destroy(),this._joinReject&&(this._joinReject(new Rn({code:an.INVALID_OPERATION,message:so({key:to.CLIENT_DESTROYED,data:{funName:"join"}})})),this.clearJoinTimeout(),this.reset()),this.removeAllListeners())}switchRole(r){return at(this,null,function*(){this.role!==r&&(r==="audience"&&this.uplinkConnection&&this.closeUplink("you switch role to audience"),yield this.doSwitchRole(r))})}doSwitchRole(r){let l={command:pie,data:{role:r==="anchor"?20:21,privateMapKey:this.privateMapKey},responseCommand:go.SWITCH_ROLE_RES,retries:1};return this._log.info("switchRole signal data: ".concat(JSON.stringify(l.data))),this._signalChannel.sendWaitForResponseWithRetry(l).then(d=>{let{code:g,message:C}=d.data;if(g!==0)throw new Rn({code:an.SWITCH_ROLE_FAILED,message:so({key:to.SWITCH_ROLE_FAILED,data:{message:C,code:g}})});this.role=r}).catch(d=>{throw d instanceof Rn&&d.getCode()===an.API_CALL_TIMEOUT&&(d=new Rn({code:an.SWITCH_ROLE_FAILED,message:so({key:to.SWITCH_ROLE_TIMEOUT})})),this._log.error(d),d})}publish(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return at(this,null,function*(){let g={},C={};l.forEach(U=>{U instanceof xc&&(U instanceof cy?C.audio=U:g.audio=U),U instanceof Wa&&(U instanceof ff&&U.mediaType===2?C.video=U:g.video=U)});let A=Ey(g),L=Ey(C);(!A||!L)&&!this.uplinkConnection&&(this.singlePC?this.uplinkConnection=new pG({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}):this.uplinkConnection=new oA({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),this.uplinkConnection.on("connection-state-changed",U=>{this.emit("media-connection-state-changed",Io(Fn({},U),{userId:this.userId}))}),this.uplinkConnection.on("firewall-restriction",()=>{this.emit("firewall-restriction")}),this.uplinkConnection.on("error",U=>{let Z=U.getCode();Z!==an.ICE_TRANSPORT_ERROR&&(Z===an.UPLINK_RECONNECTION_FAILED&&this.closeUplink(),this.emit("error",U))}));let B=l.map(U=>U.kind).join(",");A||(this._log.info("publish() => main ".concat(B)),yield this.uplinkConnection.publish({localAudioTrack:g.audio,localVideoTrack:g.video,isAuxiliary:!1}),this._log.info("main is published")),L||(this._log.info("publish() => aux ".concat(B)),yield this.uplinkConnection.publish({localAudioTrack:C.audio,localVideoTrack:C.video,isAuxiliary:!0}),this._log.info("aux is published"))})}unpublish(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return at(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||!this.isMainStreamPublished&&!this.isAuxStreamPublished||!this.uplinkConnection)return;let g={},C={};l.forEach(A=>{!A.mediaTrack||!A.isPublished||(A instanceof xc&&(A instanceof cy?C.audio=A:g.audio=A),A instanceof Wa&&(A instanceof ff&&A.mediaType===2?C.video=A:g.video=A))});try{let A=l.map(L=>L.kind).join(",");Ey(g)||(this._log.info("unpublish() => main ".concat(A)),yield this.uplinkConnection.unpublish({localAudioTrack:g.audio,localVideoTrack:g.video})),Ey(C)||(this._log.info("unpublish() => aux ".concat(A)),yield this.uplinkConnection.unpublish({localAudioTrack:C.audio,localVideoTrack:C.video}))}catch{}this.localTracks.size===0&&this.closeUplink("you unpublished")})}addTrack(r){if(!this.uplinkConnection||!r.mediaTrack)return Promise.resolve();let l=this.uplinkConnection.addTrack(r);return r.publish(this,l),l}removeTrack(r){return this.uplinkConnection&&r.mediaTrack?this.uplinkConnection.removeTrack(r).then(l=>(r.unpublish(),l)):Promise.resolve()}replaceTrack(r){return this.uplinkConnection&&r.mediaTrack&&KF()?this.uplinkConnection.replaceTrack(r).then(l=>{en.emit($t.LOCAL_TRACK_REPLACED,{track:r})}):Promise.resolve()}setBandWidth(r){return at(this,null,function*(){!this.uplinkConnection||(yield this.uplinkConnection.setBandwidth(r),yield this.uplinkConnection.sendMediaSettings())})}enableSmall(r){return at(this,null,function*(){if(!this.uplinkConnection||!this.uplinkConnection.localMainVideoTrack)return Promise.resolve();r&&this.uplinkConnection.localMainVideoTrack.small&&(yield this.setBandWidth({type:Be.VIDEO,videoType:Be.SMALL,bandwidth:this.uplinkConnection.localMainVideoTrack.small.bitrate})),yield this.uplinkConnection.enableSmall(r)})}subscribe(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return at(this,null,function*(){if(l=l.filter(L=>!L.isSubscribed),l.length===0)return;let{userId:g}=l[0],C=this.remotePublishedUserMap.get(g);if(!C)return;let A=l.find(L=>L.mediaType===2)?"auxiliary":"main";try{let L=Fn({},C.subscribeState);l.forEach(U=>{switch(U.mediaType){case 1:L.audio=!0;break;case 4:L.video=!0;break;case 8:L.smallVideo=!0;break;case 2:L.auxiliary=!0}});let B=this._changeBigSmallRecords.get(g);B&&B.options.smallVideo&&C.muteState.hasSmall&&L.video&&(L.video=!1,L.smallVideo=!0),en.emit($t.SUBSCRIBE_START,{room:this,streamType:A,remotePublishedUser:C,subscribeState:L}),this._log.info("subscribe() => ".concat(g," ").concat(A," [").concat(eA(L),"] prev: [").concat(eA(C.subscribeState),"]")),yield C.subscribe(L,A),this._log.info("subscribe ".concat(g," ").concat(A," done"));for(let U of l)U.mediaTrack||(yield U.waitHasMediaTrack());en.emit($t.SUBSCRIBE_SUCCESS,{room:this,streamType:A,remotePublishedUser:C})}catch(L){let B=L instanceof Rn?L.getCode():an.UNKNOWN,U=L;throw L instanceof Rn?B===an.REMOTE_STREAM_NOT_EXIST&&(U=new Rn({code:an.API_CALL_ABORTED,message:so({key:to.API_CALL_ABORTED,data:{message:L.message,userId:g,streamType:A}})}),this._log.warn(U)):(U=new Rn({code:B,message:so({key:to.SUBSCRIBE_FAILED,data:{message:L.message,userId:g,streamType:A}})}),this._log.error(U)),U}})}unsubscribe(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return at(this,null,function*(){let{userId:g}=l[0],C=this.remotePublishedUserMap.get(g);if(!C)return;let A=l.find(L=>L.mediaType===2)?"auxiliary":"main";this._log.info("unsubscribe() => ".concat(g," ").concat(A));try{yield C.unsubscribe({remoteTracks:l,streamType:A})}catch(L){this._log.warn("unsubscribe() => failed ".concat(L))}l.forEach(L=>{L.unsubscribe(),L.mediaType===8&&L.setMediaType(4)}),en.emit($t.UNSUBSCRIBE_SUCCESS,{room:this,streamType:A,remotePublishedUser:C})})}setEncodedDataProcessingListener(r){throw new Error("Method not implemented.")}enableAudioVolumeEvaluation(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,l=arguments.length>1?arguments[1]:void 0;if(r<=0)return this._enableAudioVolumeEvaluation=!1,void Hr.clearTask(this._audioVolumeIntervalId);r=Math.floor(Math.max(r,100)),en.emit($t.AUDIO_LEVEL_INTERVAL,{interval:r}),this._audioVolumeIntervalId&&Hr.clearTask(this._audioVolumeIntervalId),this._enableAudioVolumeEvaluation=!0,this._audioVolumeIntervalId=Hr.run(Uw,()=>{var d;let g=[];(d=this.remotePublishedUserMap)==null||d.forEach(C=>{if(C.muteState.hasAudio){let A=Math.floor(100*C.remoteAudioTrack.getAudioLevel());g.push({userId:C.userId,volume:A})}}),this.emit("audio-volume",g)},{fps:1e3/r,backgroundTask:l})}getLocalAudioStats(){return at(this,null,function*(){let r={};if(r[this.userId]={bytesSent:0,packetsSent:0},this.uplinkConnection){let l=yield this._stats.getSenderStats(this.uplinkConnection);r[this.userId]={bytesSent:l.audio.bytesSent,packetsSent:l.audio.packetsSent}}return r})}getLocalVideoStats(){return at(this,null,function*(){let r={};if(r[this.userId]={bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0},this.uplinkConnection){let{video:{bytesSent:l,packetsSent:d,framesEncoded:g,framesSent:C,frameWidth:A,frameHeight:L}}=yield this._stats.getSenderStats(this.uplinkConnection);r[this.userId]={bytesSent:l,packetsSent:d,framesEncoded:g,framesSent:C,frameWidth:A,frameHeight:L}}return r})}getTransportStats(){return at(this,null,function*(){let r={rtt:0,downlinksRTT:{}};if(this.uplinkConnection){let l=yield this._stats.getSenderStats(this.uplinkConnection);r.rtt=l.rtt}for(let[,l]of this.remotePublishedUserMap){let d=yield this._stats.getReceiverStats(l);r.downlinksRTT[d.userId]=d.rtt}return r})}getRemoteVideoStats(r){return at(this,null,function*(){let l={};for(let[d,g]of this.remotePublishedUserMap)r==="main"&&g.muteState.hasVideo&&(l[d]=g.remoteVideoTrack.stat),r==="auxiliary"&&g.muteState.hasAuxiliary&&(l[d]=g.remoteAuxiliaryTrack.stat);return l})}getRemoteAudioStats(){return at(this,null,function*(){let r={};for(let[l,d]of this.remotePublishedUserMap)d.muteState.hasAudio&&(r[l]=d.remoteAudioTrack.stat);return r})}setTurnServer(r,l){this._log.info("set turn server: ".concat(JSON.stringify(r)," ").concat(l||""));let d=[];Array.isArray(r)?r.forEach(g=>d.push(Dl.getTurnServer(g))):Dl.isPlainObject(r)&&d.push(Dl.getTurnServer(r)),this._turnServers=d,l&&(this._iceTransportPolicy=l)}sendStartMixTranscode(r){return this._signalChannel.sendWaitForResponse({command:die,data:r,timeout:5e3,responseCommand:go.START_MIX_TRANSCODE_RES,commandDesc:"startMixTranscode"})}sendStopMixTranscode(r){return this._signalChannel.sendWaitForResponse({command:hie,data:r,timeout:5e3,responseCommand:go.STOP_MIX_TRANSCODE_RES,commandDesc:"stopMixTranscode"})}sendStartPublishCDN(r){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:l?sie:cie,data:r,timeout:5e3,responseCommand:l?go.START_PUBLISH_TENCENT_CDN_RES:go.START_PUBLISH_GIVEN_CDN_RES,commandDesc:"startPublishCDN"})}sendStopPublishCDN(r){let l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:l?lie:uie,data:r,timeout:5e3,responseCommand:l?go.STOP_PUBLISH_TENCENT_CDN_RES:go.STOP_PUBLISH_GIVEN_CDN_RES,commandDesc:"stopPublishCDN"})}sendAbilityStatus(r){var l;(l=this._signalChannel)==null||l.sendWaitForResponse({command:yie,data:r,timeout:5e3,responseCommand:go.ABILITY_STATUS_REPORT_RESULT,commandDesc:"ability status report"}).catch(d=>{})}getIceServers(){return this._turnServers.length===0&&this.scheduleResult.iceServers?this.scheduleResult.iceServers:this._turnServers}getIceTransportPolicy(){return this._iceTransportPolicy||this.scheduleResult.iceTransportPolicy||"all"}getLogger(){return this._log}enableAIVoice(){throw new Error("Method not implemented.")}getSignalChannelUrl(){let r={mainUrl:"",backupUrl:""},l=Dl.getEnv();return l?(r.mainUrl="wss://".concat(l,".rtc.qq.com"),r.backupUrl=r.mainUrl):this.proxy_ws?(r.mainUrl=this.proxy_ws,r.backupUrl=r.mainUrl):Array.isArray(this.scheduleResult.domains)&&this.scheduleResult.domains.length>0&&(r.mainUrl="wss://".concat(this.scheduleResult.domains[0]),r.backupUrl=r.mainUrl,this.scheduleResult.domains[1]&&(r.backupUrl="wss://".concat(this.scheduleResult.domains[1]))),r}getSignalInfo(){var r;return((r=this._signalChannel)==null?void 0:r.getSignalInfo())||{clientIp:"",relayIp:""}}reset(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.stopSyncUserListInterval(),this.stopHeartbeat(),this.closeConnections(),this.clearNetworkQuality(),this.closeUplink("you exitRoom"),this._signalChannel&&(r&&this._signalChannel.keepAlive&&this._signalChannel.isConnected?this._signalChannel.stopKeepAliveIn(3600):this._signalChannel.close(),this.setSignalChannel(null)),this._stats.reset(),this.userManager.clear(),this.userManager.removeAllListeners(),this.singlePC&&(this.singlePC.close(),this.singlePC=null),this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null}}checkSubscribeBigSmallVideo(r){return at(this,null,function*(){let{subscribeState:l,userId:d,muteState:{hasSmall:g,hasVideo:C}}=r;if(!g&&!C||!l.video&&!l.smallVideo)return;let A=this._changeBigSmallRecords.get(d);if(!A||A.isSubscribing||A.reSubscribeCount<=0)return;let{options:L,reSubscribeCount:B}=A;if(L.video&&l.video||L.smallVideo&&l.smallVideo&&g)return;let U={audio:r.remoteAudioTrack.isSubscribed||r.remoteAudioTrack.isSubscribing,auxiliary:r.remoteAuxiliaryTrack.isSubscribed||r.remoteAuxiliaryTrack.isSubscribing,video:L.video,smallVideo:L.smallVideo};try{if(!g&&U.smallVideo&&(U.video=!0,U.smallVideo=!1),U.smallVideo===l.smallVideo&&U.video===l.video)return;A.isSubscribing=!0,A.reSubscribeCount=B-1,yield r.subscribe(U,"main"),r.remoteVideoTrack.setMediaType(U.smallVideo?8:4),this._log.info("change [".concat(d,"] to ").concat(U.smallVideo?"small":"big"," video successfully. count ").concat(D_-A.reSubscribeCount,".")),A.isSubscribing=!1,A.reSubscribeCount=D_}catch{this._log.info("change [".concat(d,"] to ").concat(U.smallVideo?"small":"big"," video failed. count ").concat(D_-A.reSubscribeCount,".")),A.isSubscribing=!1,A.reSubscribeCount===0&&this._changeBigSmallRecords.delete(d)}})}changeType(r,l){let d={options:{video:!r,smallVideo:r},isSubscribing:!1,reSubscribeCount:D_};this._changeBigSmallRecords.set(l.userId,d),this._log.info("set [".concat(l.userId,"] video prefer type: ").concat(r?"small":"big"))}get smallStreamConfig(){return this._smallStreamConfig}_initBusinessInfo(r){this._businessInfo=r.businessInfo;let l={};if(yG(r.businessInfo)&&(l=JSON.parse(r.businessInfo)),!rg(r.pureAudioPushMode)){if(!Number.isInteger(Number(r.pureAudioPushMode)))throw new Rn({code:an.INVALID_PARAMETER,message:so({key:to.INVALID_PURE_AUDIO})});this._pureAudioPushMode=r.pureAudioPushMode,l.Str_uc_params||(l.Str_uc_params={}),l.Str_uc_params.pure_audio_push_mod=this._pureAudioPushMode}if(!rg(r.userDefineRecordId)){let d=/^[A-Za-z0-9_-]{1,64}$/gi;if(r.userDefineRecordId.match(d)===null)throw new Rn({code:an.INVALID_PARAMETER,message:so({key:to.INVALID_USER_DEFINE_RECORDID})});l.Str_uc_params||(l.Str_uc_params={}),l.Str_uc_params.userdefine_record_id=r.userDefineRecordId}if(!rg(r.userDefinePushArgs)){if(!(yG(r.userDefinePushArgs)&&String(r.userDefinePushArgs)&&String(r.userDefinePushArgs).length<=256))throw new Rn({code:an.INVALID_PARAMETER,message:so({key:to.INVALID_USER_DEFINE_PUSH_ARGS})});l.Str_uc_params||(l.Str_uc_params={}),l.Str_uc_params.userdefine_push_args=r.userDefinePushArgs}Ey(l)||(this._businessInfo=JSON.stringify(l))}sendSEI(r,l){this.singlePC&&this.singlePC.sendSEI(r,l)}sendCustomMessage(r){var l;(l=this._customMessageManager)==null||l.send(r)}};return In([GV(["left",Pr.INIT],"joined"),Cy({settings:{retries:1,timeout:0},onError(r,l,d){this._isUsingCachedSchedule&&!this.isDestroyed?(this._log.warn("is using cached schedule, retry join"),td(!0),this.reset(),l()):this._signalChannel&&this._signalChannel.isConnected&&this._signalChannel.keepAlive?(this._log.warn("is using keepAlive ws, retry join"),this._signalChannel.close(),this.reset(),l()):(this.reset(),this._log.error(r),d(r))}}),Tr(r=>{let l=new Wre;return function(d,g,C){return at(this,null,function*(){let A=String(d.roomId||d.strRoomId);if(this.userId=d.userId,this.sdkAppId=d.sdkAppId,this.userSig=d.userSig,this._log.setSdkAppId(this.sdkAppId),this._log.setUserId(this.userId),this.scene=g,d.privateMapKey=d.privateMapKey||"",this.isJoined)throw new Rn({code:an.INVALID_OPERATION,message:so({key:to.INVALID_JOIN})});if(this.checkDestroy(),l.isJoined({userId:this.userId,roomId:A,sdkAppId:this.sdkAppId,room:this}))throw new Rn({code:an.INVALID_OPERATION,message:so({key:to.REPEAT_JOIN,data:this.userId})});l.add({room:this,roomId:A}),this.role=d.role===21?"audience":"anchor",this._log.info("Join() => joining room: ".concat(A," useStringRoomId: ").concat(this.useStringRoomId," scene: ").concat(this.scene," role: ").concat(this.role)),en.emit($t.JOIN_START,{room:this,roomId:A,params:d}),this.checkSystemResult=yield Z_.checkSystemRequirementsInternal(),this.checkDestroy();let L=Dl.getEnv();L||(L=nf.QCLOUD,this.proxy_ws&&(this.proxy_ws.startsWith(Dw.OLD_CLOUD_LADDER)?L=nf.OLD_CLOUD_LADDER:this.proxy_ws.startsWith(Dw.WEBRTC)&&(L=nf.WEBRTC))),li.setConfig({env:L,sdkAppId:String(this.sdkAppId),userId:this.userId,roomId:A}),jre.call(this);let{isH264EncodeSupported:B,isVp8EncodeSupported:U}=this.checkSystemResult.detail;if(!Z_.isWebRTCSupported()||!B&&!U)throw new Rn({code:an.NOT_SUPPORTED,message:so({key:to.NOT_SUPPORTED_WEBRTC})});try{!this.proxy_ws&&!this.proxy_wt&&!this.scheduleResult.domains&&!Dl.getEnv()&&(yield this.schedule(A,C));let Z=yield r.call(this,d,g,C);return this.roomId=A,this._joinedTimestamp=Dl.performanceNow(),en.emit($t.JOIN_SUCCESS,{room:this}),li.uploadEvent({log:"stat-conv-".concat(Number(af),"-").concat(location.hostname),userId:this.userId}),Z}catch(Z){throw l.delete({room:this,roomId:A}),en.emit($t.JOIN_FAILED,{room:this,error:Z}),Z}})}})],bf.prototype,"join"),In([GV("joined","left",{ignoreError:!0,success(){this.reset(!0)}}),Tr(r=>function(){return at(this,null,function*(){en.emit($t.LEAVE_START,{room:this}),yield r.call(this),en.emit($t.LEAVE_SUCCESS,{room:this,roomId:this.roomId})})}),bV("leave room"),dS({fnName:"publish",validateArgs:!1}),dS({fnName:"unsubscribe",validateArgs:!1})],bf.prototype,"leave"),In([Xm(),Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];return at(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||(d=d.filter(A=>A.outMediaTrack&&A.state==="capture"),!d.length))return;en.emit("61",{room:this});let C=r.apply(this,d);return d.forEach(A=>A.publish(this,C)),C})}),Cy({settings:{retries:xm,timeout:r=>$m(r)},onError(r,l,d){var g;(g=r.message)!=null&&g.includes("timeout")?(this._log.warn("publish timeout"),l()):(this._log.error("publish failed: ".concat(r)),d(r),en.emit($t.PUBLISH_FAILED,{room:this}))}})],bf.prototype,"publish"),In([dS({fnName:"publish"}),(_G="api-call",function(r,l,d){let g=d.value;return d.value=function(){for(var C=arguments.length,A=new Array(C),L=0;L<C;L++)A[L]=arguments[L];let B=sy.get(this);if(B){let U=B.queue.filter((Z,ae)=>{if(ae===0)return!0;let ce=!0;return Z.args.forEach(we=>{A.find(Pe=>Pe===we)||(ce=!1)}),!ce||(Z.reject(new Rn({code:an.API_CALL_ABORTED,message:_G})),!1)});B.queue=U}return g.apply(this,A)},d}),Xm(),Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];let C=r.apply(this,d);return d.forEach(A=>A.unpublish()),C})],bf.prototype,"unpublish"),In([ZC(function(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return l[0].userId}),SV(),Tr(r=>function(){for(var l=arguments.length,d=new Array(l),g=0;g<l;g++)d[g]=arguments[g];let C=r.apply(this,d);return d.forEach(A=>!A.isSubscribed&&A.subscribe(C)),C}),Cy({settings:{retries:xm,timeout:r=>$m(r)},onError(r,l,d,g){r.message.includes("timeout")?(this._log.warn("subscribe timeout"),l()):(this._log.error("subscribe failed: ".concat(r)),d(r),en.emit($t.SUBSCRIBE_FAILED,{room:this,remoteTracks:g}))}})],bf.prototype,"subscribe"),In([dS({fnName:"subscribe",callback(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];this.singlePC||l.forEach(g=>{let C=this.remotePublishedUserMap.get(g.userId);C&&!C.isMainStreamSubscribed&&!C.isAuxStreamSubscribed&&C.close("you unsubscribed")})}}),ZC(function(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return l[0].userId})],bf.prototype,"unsubscribe"),cS.create=cS._create.bind(cS,bf),cS})})(a7);var Dce=a7.exports;const wy=Ns(Dce);var $g=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},zl=[],_s=[],Oce=typeof Uint8Array<"u"?Uint8Array:Array,TL=!1;function s7(){TL=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,o=e.length;t<o;++t)zl[t]=e[t],_s[e.charCodeAt(t)]=t;_s[45]=62,_s[95]=63}function Lce(e,t,o){for(var i,c,u=[],f=t;f<o;f+=3)i=(e[f]<<16)+(e[f+1]<<8)+e[f+2],u.push(zl[(c=i)>>18&63]+zl[c>>12&63]+zl[c>>6&63]+zl[63&c]);return u.join("")}function M6(e){var t;TL||s7();for(var o=e.length,i=o%3,c="",u=[],f=0,p=o-i;f<p;f+=16383)u.push(Lce(e,f,f+16383>p?p:f+16383));return i===1?(t=e[o-1],c+=zl[t>>2],c+=zl[t<<4&63],c+="=="):i===2&&(t=(e[o-2]<<8)+e[o-1],c+=zl[t>>10],c+=zl[t>>4&63],c+=zl[t<<2&63],c+="="),u.push(c),u.join("")}function TS(e,t,o,i,c){var u,f,p=8*c-i-1,v=(1<<p)-1,_=v>>1,b=-7,S=o?c-1:0,k=o?-1:1,M=e[t+S];for(S+=k,u=M&(1<<-b)-1,M>>=-b,b+=p;b>0;u=256*u+e[t+S],S+=k,b-=8);for(f=u&(1<<-b)-1,u>>=-b,b+=i;b>0;f=256*f+e[t+S],S+=k,b-=8);if(u===0)u=1-_;else{if(u===v)return f?NaN:1/0*(M?-1:1);f+=Math.pow(2,i),u-=_}return(M?-1:1)*f*Math.pow(2,u-i)}function l7(e,t,o,i,c,u){var f,p,v,_=8*u-c-1,b=(1<<_)-1,S=b>>1,k=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=i?0:u-1,R=i?1:-1,w=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(p=isNaN(t)?1:0,f=b):(f=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-f))<1&&(f--,v*=2),(t+=f+S>=1?k/v:k*Math.pow(2,1-S))*v>=2&&(f++,v/=2),f+S>=b?(p=0,f=b):f+S>=1?(p=(t*v-1)*Math.pow(2,c),f+=S):(p=t*Math.pow(2,S-1)*Math.pow(2,c),f=0));c>=8;e[o+M]=255&p,M+=R,p/=256,c-=8);for(f=f<<c|p,_+=c;_>0;e[o+M]=255&f,M+=R,f/=256,_-=8);e[o+M-R]|=128*w}var Nce={}.toString,c7=Array.isArray||function(e){return Nce.call(e)=="[object Array]"};function ND(){return Ot.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Xc(e,t){if(ND()<t)throw new RangeError("Invalid typed array length");return Ot.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Ot.prototype:(e===null&&(e=new Ot(t)),e.length=t),e}function Ot(e,t,o){if(!(Ot.TYPED_ARRAY_SUPPORT||this instanceof Ot))return new Ot(e,t,o);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return PD(this,e)}return u7(this,e,t,o)}function u7(e,t,o,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?function(c,u,f,p){if(u.byteLength,f<0||u.byteLength<f)throw new RangeError("'offset' is out of bounds");if(u.byteLength<f+(p||0))throw new RangeError("'length' is out of bounds");return u=f===void 0&&p===void 0?new Uint8Array(u):p===void 0?new Uint8Array(u,f):new Uint8Array(u,f,p),Ot.TYPED_ARRAY_SUPPORT?(c=u).__proto__=Ot.prototype:c=IA(c,u),c}(e,t,o,i):typeof t=="string"?function(c,u,f){if(typeof f=="string"&&f!==""||(f="utf8"),!Ot.isEncoding(f))throw new TypeError('"encoding" must be a valid string encoding');var p=0|h7(u,f),v=(c=Xc(c,p)).write(u,f);return v!==p&&(c=c.slice(0,v)),c}(e,t,o):function(c,u){if(Wl(u)){var f=0|ML(u.length);return(c=Xc(c,f)).length===0||u.copy(c,0,0,f),c}if(u){if(typeof ArrayBuffer<"u"&&u.buffer instanceof ArrayBuffer||"length"in u)return typeof u.length!="number"||(p=u.length)!=p?Xc(c,0):IA(c,u);if(u.type==="Buffer"&&c7(u.data))return IA(c,u.data)}var p;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d7(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function PD(e,t){if(d7(t),e=Xc(e,t<0?0:0|ML(t)),!Ot.TYPED_ARRAY_SUPPORT)for(var o=0;o<t;++o)e[o]=0;return e}function IA(e,t){var o=t.length<0?0:0|ML(t.length);e=Xc(e,o);for(var i=0;i<o;i+=1)e[i]=255&t[i];return e}function ML(e){if(e>=ND())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ND().toString(16)+" bytes");return 0|e}function Wl(e){return!(e==null||!e._isBuffer)}function h7(e,t){if(Wl(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var o=e.length;if(o===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":case void 0:return LE(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return g7(e).length;default:if(i)return LE(e).length;t=(""+t).toLowerCase(),i=!0}}function Pce(e,t,o){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return qce(this,t,o);case"utf8":case"utf-8":return p7(this,t,o);case"ascii":return Hce(this,t,o);case"latin1":case"binary":return $ce(this,t,o);case"base64":return Bce(this,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kce(this,t,o);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function Tf(e,t,o){var i=e[t];e[t]=e[o],e[o]=i}function k6(e,t,o,i,c){if(e.length===0)return-1;if(typeof o=="string"?(i=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,isNaN(o)&&(o=c?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(c)return-1;o=e.length-1}else if(o<0){if(!c)return-1;o=0}if(typeof t=="string"&&(t=Ot.from(t,i)),Wl(t))return t.length===0?-1:w6(e,t,o,i,c);if(typeof t=="number")return t&=255,Ot.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?c?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):w6(e,[t],o,i,c);throw new TypeError("val must be string, number or Buffer")}function w6(e,t,o,i,c){var u,f=1,p=e.length,v=t.length;if(i!==void 0&&((i=String(i).toLowerCase())==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(e.length<2||t.length<2)return-1;f=2,p/=2,v/=2,o/=2}function _(M,R){return f===1?M[R]:M.readUInt16BE(R*f)}if(c){var b=-1;for(u=o;u<p;u++)if(_(e,u)===_(t,b===-1?0:u-b)){if(b===-1&&(b=u),u-b+1===v)return b*f}else b!==-1&&(u-=u-b),b=-1}else for(o+v>p&&(o=p-v),u=o;u>=0;u--){for(var S=!0,k=0;k<v;k++)if(_(e,u+k)!==_(t,k)){S=!1;break}if(S)return u}return-1}function xce(e,t,o,i){o=Number(o)||0;var c=e.length-o;i?(i=Number(i))>c&&(i=c):i=c;var u=t.length;if(u%2!=0)throw new TypeError("Invalid hex string");i>u/2&&(i=u/2);for(var f=0;f<i;++f){var p=parseInt(t.substr(2*f,2),16);if(isNaN(p))return f;e[o+f]=p}return f}function Uce(e,t,o,i){return MT(LE(t,e.length-o),e,o,i)}function f7(e,t,o,i){return MT(function(c){for(var u=[],f=0;f<c.length;++f)u.push(255&c.charCodeAt(f));return u}(t),e,o,i)}function Fce(e,t,o,i){return f7(e,t,o,i)}function Vce(e,t,o,i){return MT(g7(t),e,o,i)}function Gce(e,t,o,i){return MT(function(c,u){for(var f,p,v,_=[],b=0;b<c.length&&!((u-=2)<0);++b)f=c.charCodeAt(b),p=f>>8,v=f%256,_.push(v),_.push(p);return _}(t,e.length-o),e,o,i)}function Bce(e,t,o){return t===0&&o===e.length?M6(e):M6(e.slice(t,o))}function p7(e,t,o){o=Math.min(e.length,o);for(var i=[],c=t;c<o;){var u,f,p,v,_=e[c],b=null,S=_>239?4:_>223?3:_>191?2:1;if(c+S<=o)switch(S){case 1:_<128&&(b=_);break;case 2:(192&(u=e[c+1]))==128&&(v=(31&_)<<6|63&u)>127&&(b=v);break;case 3:u=e[c+1],f=e[c+2],(192&u)==128&&(192&f)==128&&(v=(15&_)<<12|(63&u)<<6|63&f)>2047&&(v<55296||v>57343)&&(b=v);break;case 4:u=e[c+1],f=e[c+2],p=e[c+3],(192&u)==128&&(192&f)==128&&(192&p)==128&&(v=(15&_)<<18|(63&u)<<12|(63&f)<<6|63&p)>65535&&v<1114112&&(b=v)}b===null?(b=65533,S=1):b>65535&&(b-=65536,i.push(b>>>10&1023|55296),b=56320|1023&b),i.push(b),c+=S}return function(k){var M=k.length;if(M<=R6)return String.fromCharCode.apply(String,k);for(var R="",w=0;w<M;)R+=String.fromCharCode.apply(String,k.slice(w,w+=R6));return R}(i)}Ot.TYPED_ARRAY_SUPPORT=$g.TYPED_ARRAY_SUPPORT===void 0||$g.TYPED_ARRAY_SUPPORT,Ot.poolSize=8192,Ot._augment=function(e){return e.__proto__=Ot.prototype,e},Ot.from=function(e,t,o){return u7(null,e,t,o)},Ot.TYPED_ARRAY_SUPPORT&&(Ot.prototype.__proto__=Uint8Array.prototype,Ot.__proto__=Uint8Array),Ot.alloc=function(e,t,o){return function(i,c,u,f){return d7(c),c<=0?Xc(i,c):u!==void 0?typeof f=="string"?Xc(i,c).fill(u,f):Xc(i,c).fill(u):Xc(i,c)}(null,e,t,o)},Ot.allocUnsafe=function(e){return PD(null,e)},Ot.allocUnsafeSlow=function(e){return PD(null,e)},Ot.isBuffer=X0,Ot.compare=function(e,t){if(!Wl(e)||!Wl(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var o=e.length,i=t.length,c=0,u=Math.min(o,i);c<u;++c)if(e[c]!==t[c]){o=e[c],i=t[c];break}return o<i?-1:i<o?1:0},Ot.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ot.concat=function(e,t){if(!c7(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return Ot.alloc(0);var o;if(t===void 0)for(t=0,o=0;o<e.length;++o)t+=e[o].length;var i=Ot.allocUnsafe(t),c=0;for(o=0;o<e.length;++o){var u=e[o];if(!Wl(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,c),c+=u.length}return i},Ot.byteLength=h7,Ot.prototype._isBuffer=!0,Ot.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Tf(this,t,t+1);return this},Ot.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Tf(this,t,t+3),Tf(this,t+1,t+2);return this},Ot.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Tf(this,t,t+7),Tf(this,t+1,t+6),Tf(this,t+2,t+5),Tf(this,t+3,t+4);return this},Ot.prototype.toString=function(){var e=0|this.length;return e===0?"":arguments.length===0?p7(this,0,e):Pce.apply(this,arguments)},Ot.prototype.equals=function(e){if(!Wl(e))throw new TypeError("Argument must be a Buffer");return this===e||Ot.compare(this,e)===0},Ot.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Ot.prototype.compare=function(e,t,o,i,c){if(!Wl(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),o===void 0&&(o=e?e.length:0),i===void 0&&(i=0),c===void 0&&(c=this.length),t<0||o>e.length||i<0||c>this.length)throw new RangeError("out of range index");if(i>=c&&t>=o)return 0;if(i>=c)return-1;if(t>=o)return 1;if(this===e)return 0;for(var u=(c>>>=0)-(i>>>=0),f=(o>>>=0)-(t>>>=0),p=Math.min(u,f),v=this.slice(i,c),_=e.slice(t,o),b=0;b<p;++b)if(v[b]!==_[b]){u=v[b],f=_[b];break}return u<f?-1:f<u?1:0},Ot.prototype.includes=function(e,t,o){return this.indexOf(e,t,o)!==-1},Ot.prototype.indexOf=function(e,t,o){return k6(this,e,t,o,!0)},Ot.prototype.lastIndexOf=function(e,t,o){return k6(this,e,t,o,!1)},Ot.prototype.write=function(e,t,o,i){if(t===void 0)i="utf8",o=this.length,t=0;else if(o===void 0&&typeof t=="string")i=t,o=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(o)?(o|=0,i===void 0&&(i="utf8")):(i=o,o=void 0)}var c=this.length-t;if((o===void 0||o>c)&&(o=c),e.length>0&&(o<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var u=!1;;)switch(i){case"hex":return xce(this,e,t,o);case"utf8":case"utf-8":return Uce(this,e,t,o);case"ascii":return f7(this,e,t,o);case"latin1":case"binary":return Fce(this,e,t,o);case"base64":return Vce(this,e,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gce(this,e,t,o);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),u=!0}},Ot.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R6=4096;function Hce(e,t,o){var i="";o=Math.min(e.length,o);for(var c=t;c<o;++c)i+=String.fromCharCode(127&e[c]);return i}function $ce(e,t,o){var i="";o=Math.min(e.length,o);for(var c=t;c<o;++c)i+=String.fromCharCode(e[c]);return i}function qce(e,t,o){var i=e.length;(!t||t<0)&&(t=0),(!o||o<0||o>i)&&(o=i);for(var c="",u=t;u<o;++u)c+=Wce(e[u]);return c}function Kce(e,t,o){for(var i=e.slice(t,o),c="",u=0;u<i.length;u+=2)c+=String.fromCharCode(i[u]+256*i[u+1]);return c}function _i(e,t,o){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>o)throw new RangeError("Trying to access beyond buffer length")}function ba(e,t,o,i,c,u){if(!Wl(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>c||t<u)throw new RangeError('"value" argument is out of bounds');if(o+i>e.length)throw new RangeError("Index out of range")}function MS(e,t,o,i){t<0&&(t=65535+t+1);for(var c=0,u=Math.min(e.length-o,2);c<u;++c)e[o+c]=(t&255<<8*(i?c:1-c))>>>8*(i?c:1-c)}function kS(e,t,o,i){t<0&&(t=4294967295+t+1);for(var c=0,u=Math.min(e.length-o,4);c<u;++c)e[o+c]=t>>>8*(i?c:3-c)&255}function m7(e,t,o,i,c,u){if(o+i>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function A6(e,t,o,i,c){return c||m7(e,0,o,4),l7(e,t,o,i,23,4),o+4}function D6(e,t,o,i,c){return c||m7(e,0,o,8),l7(e,t,o,i,52,8),o+8}Ot.prototype.slice=function(e,t){var o,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=t===void 0?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),Ot.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=Ot.prototype;else{var c=t-e;o=new Ot(c,void 0);for(var u=0;u<c;++u)o[u]=this[u+e]}return o},Ot.prototype.readUIntLE=function(e,t,o){e|=0,t|=0,o||_i(e,t,this.length);for(var i=this[e],c=1,u=0;++u<t&&(c*=256);)i+=this[e+u]*c;return i},Ot.prototype.readUIntBE=function(e,t,o){e|=0,t|=0,o||_i(e,t,this.length);for(var i=this[e+--t],c=1;t>0&&(c*=256);)i+=this[e+--t]*c;return i},Ot.prototype.readUInt8=function(e,t){return t||_i(e,1,this.length),this[e]},Ot.prototype.readUInt16LE=function(e,t){return t||_i(e,2,this.length),this[e]|this[e+1]<<8},Ot.prototype.readUInt16BE=function(e,t){return t||_i(e,2,this.length),this[e]<<8|this[e+1]},Ot.prototype.readUInt32LE=function(e,t){return t||_i(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ot.prototype.readUInt32BE=function(e,t){return t||_i(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ot.prototype.readIntLE=function(e,t,o){e|=0,t|=0,o||_i(e,t,this.length);for(var i=this[e],c=1,u=0;++u<t&&(c*=256);)i+=this[e+u]*c;return i>=(c*=128)&&(i-=Math.pow(2,8*t)),i},Ot.prototype.readIntBE=function(e,t,o){e|=0,t|=0,o||_i(e,t,this.length);for(var i=t,c=1,u=this[e+--i];i>0&&(c*=256);)u+=this[e+--i]*c;return u>=(c*=128)&&(u-=Math.pow(2,8*t)),u},Ot.prototype.readInt8=function(e,t){return t||_i(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ot.prototype.readInt16LE=function(e,t){t||_i(e,2,this.length);var o=this[e]|this[e+1]<<8;return 32768&o?4294901760|o:o},Ot.prototype.readInt16BE=function(e,t){t||_i(e,2,this.length);var o=this[e+1]|this[e]<<8;return 32768&o?4294901760|o:o},Ot.prototype.readInt32LE=function(e,t){return t||_i(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ot.prototype.readInt32BE=function(e,t){return t||_i(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ot.prototype.readFloatLE=function(e,t){return t||_i(e,4,this.length),TS(this,e,!0,23,4)},Ot.prototype.readFloatBE=function(e,t){return t||_i(e,4,this.length),TS(this,e,!1,23,4)},Ot.prototype.readDoubleLE=function(e,t){return t||_i(e,8,this.length),TS(this,e,!0,52,8)},Ot.prototype.readDoubleBE=function(e,t){return t||_i(e,8,this.length),TS(this,e,!1,52,8)},Ot.prototype.writeUIntLE=function(e,t,o,i){e=+e,t|=0,o|=0,i||ba(this,e,t,o,Math.pow(2,8*o)-1,0);var c=1,u=0;for(this[t]=255&e;++u<o&&(c*=256);)this[t+u]=e/c&255;return t+o},Ot.prototype.writeUIntBE=function(e,t,o,i){e=+e,t|=0,o|=0,i||ba(this,e,t,o,Math.pow(2,8*o)-1,0);var c=o-1,u=1;for(this[t+c]=255&e;--c>=0&&(u*=256);)this[t+c]=e/u&255;return t+o},Ot.prototype.writeUInt8=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,1,255,0),Ot.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Ot.prototype.writeUInt16LE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,2,65535,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):MS(this,e,t,!0),t+2},Ot.prototype.writeUInt16BE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,2,65535,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):MS(this,e,t,!1),t+2},Ot.prototype.writeUInt32LE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,4,4294967295,0),Ot.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):kS(this,e,t,!0),t+4},Ot.prototype.writeUInt32BE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,4,4294967295,0),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):kS(this,e,t,!1),t+4},Ot.prototype.writeIntLE=function(e,t,o,i){if(e=+e,t|=0,!i){var c=Math.pow(2,8*o-1);ba(this,e,t,o,c-1,-c)}var u=0,f=1,p=0;for(this[t]=255&e;++u<o&&(f*=256);)e<0&&p===0&&this[t+u-1]!==0&&(p=1),this[t+u]=(e/f>>0)-p&255;return t+o},Ot.prototype.writeIntBE=function(e,t,o,i){if(e=+e,t|=0,!i){var c=Math.pow(2,8*o-1);ba(this,e,t,o,c-1,-c)}var u=o-1,f=1,p=0;for(this[t+u]=255&e;--u>=0&&(f*=256);)e<0&&p===0&&this[t+u+1]!==0&&(p=1),this[t+u]=(e/f>>0)-p&255;return t+o},Ot.prototype.writeInt8=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,1,127,-128),Ot.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ot.prototype.writeInt16LE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,2,32767,-32768),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):MS(this,e,t,!0),t+2},Ot.prototype.writeInt16BE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,2,32767,-32768),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):MS(this,e,t,!1),t+2},Ot.prototype.writeInt32LE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,4,2147483647,-2147483648),Ot.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):kS(this,e,t,!0),t+4},Ot.prototype.writeInt32BE=function(e,t,o){return e=+e,t|=0,o||ba(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Ot.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):kS(this,e,t,!1),t+4},Ot.prototype.writeFloatLE=function(e,t,o){return A6(this,e,t,!0,o)},Ot.prototype.writeFloatBE=function(e,t,o){return A6(this,e,t,!1,o)},Ot.prototype.writeDoubleLE=function(e,t,o){return D6(this,e,t,!0,o)},Ot.prototype.writeDoubleBE=function(e,t,o){return D6(this,e,t,!1,o)},Ot.prototype.copy=function(e,t,o,i){if(o||(o=0),i||i===0||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<o&&(i=o),i===o||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-o&&(i=e.length-t+o);var c,u=i-o;if(this===e&&o<t&&t<i)for(c=u-1;c>=0;--c)e[c+t]=this[c+o];else if(u<1e3||!Ot.TYPED_ARRAY_SUPPORT)for(c=0;c<u;++c)e[c+t]=this[c+o];else Uint8Array.prototype.set.call(e,this.subarray(o,o+u),t);return u},Ot.prototype.fill=function(e,t,o,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,o=this.length):typeof o=="string"&&(i=o,o=this.length),e.length===1){var c=e.charCodeAt(0);c<256&&(e=c)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!Ot.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e&=255);if(t<0||this.length<t||this.length<o)throw new RangeError("Out of range index");if(o<=t)return this;var u;if(t>>>=0,o=o===void 0?this.length:o>>>0,e||(e=0),typeof e=="number")for(u=t;u<o;++u)this[u]=e;else{var f=Wl(e)?e:LE(new Ot(e,i).toString()),p=f.length;for(u=0;u<o-t;++u)this[u+t]=f[u%p]}return this};var zce=/[^+\/0-9A-Za-z-_]/g;function Wce(e){return e<16?"0"+e.toString(16):e.toString(16)}function LE(e,t){var o;t=t||1/0;for(var i=e.length,c=null,u=[],f=0;f<i;++f){if((o=e.charCodeAt(f))>55295&&o<57344){if(!c){if(o>56319){(t-=3)>-1&&u.push(239,191,189);continue}if(f+1===i){(t-=3)>-1&&u.push(239,191,189);continue}c=o;continue}if(o<56320){(t-=3)>-1&&u.push(239,191,189),c=o;continue}o=65536+(c-55296<<10|o-56320)}else c&&(t-=3)>-1&&u.push(239,191,189);if(c=null,o<128){if((t-=1)<0)break;u.push(o)}else if(o<2048){if((t-=2)<0)break;u.push(o>>6|192,63&o|128)}else if(o<65536){if((t-=3)<0)break;u.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;u.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return u}function g7(e){return function(t){var o,i,c,u,f,p;TL||s7();var v=t.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");f=t[v-2]==="="?2:t[v-1]==="="?1:0,p=new Oce(3*v/4-f),c=f>0?v-4:v;var _=0;for(o=0,i=0;o<c;o+=4,i+=3)u=_s[t.charCodeAt(o)]<<18|_s[t.charCodeAt(o+1)]<<12|_s[t.charCodeAt(o+2)]<<6|_s[t.charCodeAt(o+3)],p[_++]=u>>16&255,p[_++]=u>>8&255,p[_++]=255&u;return f===2?(u=_s[t.charCodeAt(o)]<<2|_s[t.charCodeAt(o+1)]>>4,p[_++]=255&u):f===1&&(u=_s[t.charCodeAt(o)]<<10|_s[t.charCodeAt(o+1)]<<4|_s[t.charCodeAt(o+2)]>>2,p[_++]=u>>8&255,p[_++]=255&u),p}(function(t){if((t=function(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}(t).replace(zce,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(e))}function MT(e,t,o,i){for(var c=0;c<i&&!(c+o>=t.length||c>=e.length);++c)t[c+o]=e[c];return c}function X0(e){return e!=null&&(!!e._isBuffer||O6(e)||function(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&O6(t.slice(0,0))}(e))}function O6(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Uo(e,t){return e(t={exports:{}},t.exports),t.exports}var Vo=Uo(function(e,t){var o;e.exports=(o=o||function(i,c){var u=Object.create||function(){function E(){}return function(N){var F;return E.prototype=N,F=new E,E.prototype=null,F}}(),f={},p=f.lib={},v=p.Base={extend:function(E){var N=u(this);return E&&N.mixIn(E),N.hasOwnProperty("init")&&this.init!==N.init||(N.init=function(){N.$super.init.apply(this,arguments)}),N.init.prototype=N,N.$super=this,N},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var N in E)E.hasOwnProperty(N)&&(this[N]=E[N]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}},_=p.WordArray=v.extend({init:function(E,N){E=this.words=E||[],this.sigBytes=N??4*E.length},toString:function(E){return(E||S).stringify(this)},concat:function(E){var N=this.words,F=E.words,x=this.sigBytes,P=E.sigBytes;if(this.clamp(),x%4)for(var G=0;G<P;G++){var H=F[G>>>2]>>>24-G%4*8&255;N[x+G>>>2]|=H<<24-(x+G)%4*8}else for(var G=0;G<P;G+=4)N[x+G>>>2]=F[G>>>2];return this.sigBytes+=P,this},clamp:function(){var E=this.words,N=this.sigBytes;E[N>>>2]&=4294967295<<32-N%4*8,E.length=i.ceil(N/4)},clone:function(){var E=v.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var N,F=[],x=function(Y){var Y=Y,j=987654321,W=4294967295;return function(){var O=((j=36969*(65535&j)+(j>>16)&W)<<16)+(Y=18e3*(65535&Y)+(Y>>16)&W)&W;return O/=4294967296,(O+=.5)*(i.random()>.5?1:-1)}},P=0;P<E;P+=4){var G=x(4294967296*(N||i.random()));N=987654071*G(),F.push(4294967296*G()|0)}return new _.init(F,E)}}),b=f.enc={},S=b.Hex={stringify:function(E){for(var N=E.words,F=E.sigBytes,x=[],P=0;P<F;P++){var G=N[P>>>2]>>>24-P%4*8&255;x.push((G>>>4).toString(16)),x.push((15&G).toString(16))}return x.join("")},parse:function(E){for(var N=E.length,F=[],x=0;x<N;x+=2)F[x>>>3]|=parseInt(E.substr(x,2),16)<<24-x%8*4;return new _.init(F,N/2)}},k=b.Latin1={stringify:function(E){for(var N=E.words,F=E.sigBytes,x=[],P=0;P<F;P++){var G=N[P>>>2]>>>24-P%4*8&255;x.push(String.fromCharCode(G))}return x.join("")},parse:function(E){for(var N=E.length,F=[],x=0;x<N;x++)F[x>>>2]|=(255&E.charCodeAt(x))<<24-x%4*8;return new _.init(F,N)}},M=b.Utf8={stringify:function(E){try{return decodeURIComponent(escape(k.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return k.parse(unescape(encodeURIComponent(E)))}},R=p.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new _.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=M.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var N=this._data,F=N.words,x=N.sigBytes,P=this.blockSize,G=4*P,H=x/G,Y=(H=E?i.ceil(H):i.max((0|H)-this._minBufferSize,0))*P,j=i.min(4*Y,x);if(Y){for(var W=0;W<Y;W+=P)this._doProcessBlock(F,W);var O=F.splice(0,Y);N.sigBytes-=j}return new _.init(O,j)},clone:function(){var E=v.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0}),w=(p.Hasher=R.extend({cfg:v.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var N=this._doFinalize();return N},blockSize:16,_createHelper:function(E){return function(N,F){return new E.init(F).finalize(N)}},_createHmacHelper:function(E){return function(N,F){return new w.HMAC.init(E,F).finalize(N)}}}),f.algo={});return f}(Math),o)}),L6=(Uo(function(e,t){var o,i,c,u,f,p;e.exports=(c=(i=o=Vo).lib,u=c.Base,f=c.WordArray,(p=i.x64={}).Word=u.extend({init:function(v,_){this.high=v,this.low=_}}),p.WordArray=u.extend({init:function(v,_){v=this.words=v||[],this.sigBytes=_??8*v.length},toX32:function(){for(var v=this.words,_=v.length,b=[],S=0;S<_;S++){var k=v[S];b.push(k.high),b.push(k.low)}return f.create(b,this.sigBytes)},clone:function(){for(var v=u.clone.call(this),_=v.words=this.words.slice(0),b=_.length,S=0;S<b;S++)_[S]=_[S].clone();return v}}),o)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){if(typeof ArrayBuffer=="function"){var i=o.lib.WordArray,c=i.init;(i.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var f=u.byteLength,p=[],v=0;v<f;v++)p[v>>>2]|=u[v]<<24-v%4*8;c.call(this,p,f)}else c.apply(this,arguments)}).prototype=i}}(),o.lib.WordArray)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.WordArray,u=i.enc;function f(p){return p<<8&4278255360|p>>>8&16711935}u.Utf16=u.Utf16BE={stringify:function(p){for(var v=p.words,_=p.sigBytes,b=[],S=0;S<_;S+=2){var k=v[S>>>2]>>>16-S%4*8&65535;b.push(String.fromCharCode(k))}return b.join("")},parse:function(p){for(var v=p.length,_=[],b=0;b<v;b++)_[b>>>1]|=p.charCodeAt(b)<<16-b%2*16;return c.create(_,2*v)}},u.Utf16LE={stringify:function(p){for(var v=p.words,_=p.sigBytes,b=[],S=0;S<_;S+=2){var k=f(v[S>>>2]>>>16-S%4*8&65535);b.push(String.fromCharCode(k))}return b.join("")},parse:function(p){for(var v=p.length,_=[],b=0;b<v;b++)_[b>>>1]|=f(p.charCodeAt(b)<<16-b%2*16);return c.create(_,2*v)}}}(),o.enc.Utf16)}),Uo(function(e,t){var o,i,c;e.exports=(c=(i=o=Vo).lib.WordArray,i.enc.Base64={stringify:function(u){var f=u.words,p=u.sigBytes,v=this._map;u.clamp();for(var _=[],b=0;b<p;b+=3)for(var S=(f[b>>>2]>>>24-b%4*8&255)<<16|(f[b+1>>>2]>>>24-(b+1)%4*8&255)<<8|f[b+2>>>2]>>>24-(b+2)%4*8&255,k=0;k<4&&b+.75*k<p;k++)_.push(v.charAt(S>>>6*(3-k)&63));var M=v.charAt(64);if(M)for(;_.length%4;)_.push(M);return _.join("")},parse:function(u){var f=u.length,p=this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var _=0;_<p.length;_++)v[p.charCodeAt(_)]=_}var b=p.charAt(64);if(b){var S=u.indexOf(b);S!==-1&&(f=S)}return function(k,M,R){for(var w=[],E=0,N=0;N<M;N++)if(N%4){var F=R[k.charCodeAt(N-1)]<<N%4*2,x=R[k.charCodeAt(N)]>>>6-N%4*2;w[E>>>2]|=(F|x)<<24-E%4*8,E++}return c.create(w,E)}(u,f,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,v=c.algo,_=[];(function(){for(var w=0;w<64;w++)_[w]=4294967296*i.abs(i.sin(w+1))|0})();var b=v.MD5=p.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(w,E){for(var N=0;N<16;N++){var F=E+N,x=w[F];w[F]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8)}var P=this._hash.words,G=w[E+0],H=w[E+1],Y=w[E+2],j=w[E+3],W=w[E+4],O=w[E+5],Q=w[E+6],J=w[E+7],oe=w[E+8],pe=w[E+9],ie=w[E+10],te=w[E+11],he=w[E+12],re=w[E+13],X=w[E+14],ye=w[E+15],ue=P[0],Ie=P[1],ve=P[2],Ce=P[3];ue=S(ue,Ie,ve,Ce,G,7,_[0]),Ce=S(Ce,ue,Ie,ve,H,12,_[1]),ve=S(ve,Ce,ue,Ie,Y,17,_[2]),Ie=S(Ie,ve,Ce,ue,j,22,_[3]),ue=S(ue,Ie,ve,Ce,W,7,_[4]),Ce=S(Ce,ue,Ie,ve,O,12,_[5]),ve=S(ve,Ce,ue,Ie,Q,17,_[6]),Ie=S(Ie,ve,Ce,ue,J,22,_[7]),ue=S(ue,Ie,ve,Ce,oe,7,_[8]),Ce=S(Ce,ue,Ie,ve,pe,12,_[9]),ve=S(ve,Ce,ue,Ie,ie,17,_[10]),Ie=S(Ie,ve,Ce,ue,te,22,_[11]),ue=S(ue,Ie,ve,Ce,he,7,_[12]),Ce=S(Ce,ue,Ie,ve,re,12,_[13]),ve=S(ve,Ce,ue,Ie,X,17,_[14]),ue=k(ue,Ie=S(Ie,ve,Ce,ue,ye,22,_[15]),ve,Ce,H,5,_[16]),Ce=k(Ce,ue,Ie,ve,Q,9,_[17]),ve=k(ve,Ce,ue,Ie,te,14,_[18]),Ie=k(Ie,ve,Ce,ue,G,20,_[19]),ue=k(ue,Ie,ve,Ce,O,5,_[20]),Ce=k(Ce,ue,Ie,ve,ie,9,_[21]),ve=k(ve,Ce,ue,Ie,ye,14,_[22]),Ie=k(Ie,ve,Ce,ue,W,20,_[23]),ue=k(ue,Ie,ve,Ce,pe,5,_[24]),Ce=k(Ce,ue,Ie,ve,X,9,_[25]),ve=k(ve,Ce,ue,Ie,j,14,_[26]),Ie=k(Ie,ve,Ce,ue,oe,20,_[27]),ue=k(ue,Ie,ve,Ce,re,5,_[28]),Ce=k(Ce,ue,Ie,ve,Y,9,_[29]),ve=k(ve,Ce,ue,Ie,J,14,_[30]),ue=M(ue,Ie=k(Ie,ve,Ce,ue,he,20,_[31]),ve,Ce,O,4,_[32]),Ce=M(Ce,ue,Ie,ve,oe,11,_[33]),ve=M(ve,Ce,ue,Ie,te,16,_[34]),Ie=M(Ie,ve,Ce,ue,X,23,_[35]),ue=M(ue,Ie,ve,Ce,H,4,_[36]),Ce=M(Ce,ue,Ie,ve,W,11,_[37]),ve=M(ve,Ce,ue,Ie,J,16,_[38]),Ie=M(Ie,ve,Ce,ue,ie,23,_[39]),ue=M(ue,Ie,ve,Ce,re,4,_[40]),Ce=M(Ce,ue,Ie,ve,G,11,_[41]),ve=M(ve,Ce,ue,Ie,j,16,_[42]),Ie=M(Ie,ve,Ce,ue,Q,23,_[43]),ue=M(ue,Ie,ve,Ce,pe,4,_[44]),Ce=M(Ce,ue,Ie,ve,he,11,_[45]),ve=M(ve,Ce,ue,Ie,ye,16,_[46]),ue=R(ue,Ie=M(Ie,ve,Ce,ue,Y,23,_[47]),ve,Ce,G,6,_[48]),Ce=R(Ce,ue,Ie,ve,J,10,_[49]),ve=R(ve,Ce,ue,Ie,X,15,_[50]),Ie=R(Ie,ve,Ce,ue,O,21,_[51]),ue=R(ue,Ie,ve,Ce,he,6,_[52]),Ce=R(Ce,ue,Ie,ve,j,10,_[53]),ve=R(ve,Ce,ue,Ie,ie,15,_[54]),Ie=R(Ie,ve,Ce,ue,H,21,_[55]),ue=R(ue,Ie,ve,Ce,oe,6,_[56]),Ce=R(Ce,ue,Ie,ve,ye,10,_[57]),ve=R(ve,Ce,ue,Ie,Q,15,_[58]),Ie=R(Ie,ve,Ce,ue,re,21,_[59]),ue=R(ue,Ie,ve,Ce,W,6,_[60]),Ce=R(Ce,ue,Ie,ve,te,10,_[61]),ve=R(ve,Ce,ue,Ie,Y,15,_[62]),Ie=R(Ie,ve,Ce,ue,pe,21,_[63]),P[0]=P[0]+ue|0,P[1]=P[1]+Ie|0,P[2]=P[2]+ve|0,P[3]=P[3]+Ce|0},_doFinalize:function(){var w=this._data,E=w.words,N=8*this._nDataBytes,F=8*w.sigBytes;E[F>>>5]|=128<<24-F%32;var x=i.floor(N/4294967296),P=N;E[15+(F+64>>>9<<4)]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8),E[14+(F+64>>>9<<4)]=16711935&(P<<8|P>>>24)|4278255360&(P<<24|P>>>8),w.sigBytes=4*(E.length+1),this._process();for(var G=this._hash,H=G.words,Y=0;Y<4;Y++){var j=H[Y];H[Y]=16711935&(j<<8|j>>>24)|4278255360&(j<<24|j>>>8)}return G},clone:function(){var w=p.clone.call(this);return w._hash=this._hash.clone(),w}});function S(w,E,N,F,x,P,G){var H=w+(E&N|~E&F)+x+G;return(H<<P|H>>>32-P)+E}function k(w,E,N,F,x,P,G){var H=w+(E&F|N&~F)+x+G;return(H<<P|H>>>32-P)+E}function M(w,E,N,F,x,P,G){var H=w+(E^N^F)+x+G;return(H<<P|H>>>32-P)+E}function R(w,E,N,F,x,P,G){var H=w+(N^(E|~F))+x+G;return(H<<P|H>>>32-P)+E}c.MD5=p._createHelper(b),c.HmacMD5=p._createHmacHelper(b)}(Math),o.MD5)}),Uo(function(e,t){var o,i,c,u,f,p,v,_;e.exports=(c=(i=o=Vo).lib,u=c.WordArray,f=c.Hasher,p=i.algo,v=[],_=p.SHA1=f.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(b,S){for(var k=this._hash.words,M=k[0],R=k[1],w=k[2],E=k[3],N=k[4],F=0;F<80;F++){if(F<16)v[F]=0|b[S+F];else{var x=v[F-3]^v[F-8]^v[F-14]^v[F-16];v[F]=x<<1|x>>>31}var P=(M<<5|M>>>27)+N+v[F];P+=F<20?1518500249+(R&w|~R&E):F<40?1859775393+(R^w^E):F<60?(R&w|R&E|w&E)-1894007588:(R^w^E)-899497514,N=E,E=w,w=R<<30|R>>>2,R=M,M=P}k[0]=k[0]+M|0,k[1]=k[1]+R|0,k[2]=k[2]+w|0,k[3]=k[3]+E|0,k[4]=k[4]+N|0},_doFinalize:function(){var b=this._data,S=b.words,k=8*this._nDataBytes,M=8*b.sigBytes;return S[M>>>5]|=128<<24-M%32,S[14+(M+64>>>9<<4)]=Math.floor(k/4294967296),S[15+(M+64>>>9<<4)]=k,b.sigBytes=4*S.length,this._process(),this._hash},clone:function(){var b=f.clone.call(this);return b._hash=this._hash.clone(),b}}),i.SHA1=f._createHelper(_),i.HmacSHA1=f._createHmacHelper(_),o.SHA1)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,v=c.algo,_=[],b=[];(function(){function M(N){for(var F=i.sqrt(N),x=2;x<=F;x++)if(!(N%x))return!1;return!0}function R(N){return 4294967296*(N-(0|N))|0}for(var w=2,E=0;E<64;)M(w)&&(E<8&&(_[E]=R(i.pow(w,.5))),b[E]=R(i.pow(w,1/3)),E++),w++})();var S=[],k=v.SHA256=p.extend({_doReset:function(){this._hash=new f.init(_.slice(0))},_doProcessBlock:function(M,R){for(var w=this._hash.words,E=w[0],N=w[1],F=w[2],x=w[3],P=w[4],G=w[5],H=w[6],Y=w[7],j=0;j<64;j++){if(j<16)S[j]=0|M[R+j];else{var W=S[j-15],O=(W<<25|W>>>7)^(W<<14|W>>>18)^W>>>3,Q=S[j-2],J=(Q<<15|Q>>>17)^(Q<<13|Q>>>19)^Q>>>10;S[j]=O+S[j-7]+J+S[j-16]}var oe=E&N^E&F^N&F,pe=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),ie=Y+((P<<26|P>>>6)^(P<<21|P>>>11)^(P<<7|P>>>25))+(P&G^~P&H)+b[j]+S[j];Y=H,H=G,G=P,P=x+ie|0,x=F,F=N,N=E,E=ie+(pe+oe)|0}w[0]=w[0]+E|0,w[1]=w[1]+N|0,w[2]=w[2]+F|0,w[3]=w[3]+x|0,w[4]=w[4]+P|0,w[5]=w[5]+G|0,w[6]=w[6]+H|0,w[7]=w[7]+Y|0},_doFinalize:function(){var M=this._data,R=M.words,w=8*this._nDataBytes,E=8*M.sigBytes;return R[E>>>5]|=128<<24-E%32,R[14+(E+64>>>9<<4)]=i.floor(w/4294967296),R[15+(E+64>>>9<<4)]=w,M.sigBytes=4*R.length,this._process(),this._hash},clone:function(){var M=p.clone.call(this);return M._hash=this._hash.clone(),M}});c.SHA256=p._createHelper(k),c.HmacSHA256=p._createHmacHelper(k)}(Math),o.SHA256)}),Uo(function(e,t){var o,i,c,u,f,p;e.exports=(c=(i=o=Vo).lib.WordArray,u=i.algo,f=u.SHA256,p=u.SHA224=f.extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var v=f._doFinalize.call(this);return v.sigBytes-=4,v}}),i.SHA224=f._createHelper(p),i.HmacSHA224=f._createHmacHelper(p),o.SHA224)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.Hasher,u=i.x64,f=u.Word,p=u.WordArray,v=i.algo;function _(){return f.create.apply(f,arguments)}var b=[_(1116352408,3609767458),_(1899447441,602891725),_(3049323471,3964484399),_(3921009573,2173295548),_(961987163,4081628472),_(1508970993,3053834265),_(2453635748,2937671579),_(2870763221,3664609560),_(3624381080,2734883394),_(310598401,1164996542),_(607225278,1323610764),_(1426881987,3590304994),_(1925078388,4068182383),_(2162078206,991336113),_(2614888103,633803317),_(3248222580,3479774868),_(3835390401,2666613458),_(4022224774,944711139),_(264347078,2341262773),_(604807628,2007800933),_(770255983,1495990901),_(1249150122,1856431235),_(1555081692,3175218132),_(1996064986,2198950837),_(2554220882,3999719339),_(2821834349,766784016),_(2952996808,2566594879),_(3210313671,3203337956),_(3336571891,1034457026),_(3584528711,2466948901),_(113926993,3758326383),_(338241895,168717936),_(666307205,1188179964),_(773529912,1546045734),_(1294757372,1522805485),_(1396182291,2643833823),_(1695183700,2343527390),_(1986661051,1014477480),_(2177026350,1206759142),_(2456956037,344077627),_(2730485921,1290863460),_(2820302411,3158454273),_(3259730800,3505952657),_(3345764771,106217008),_(3516065817,3606008344),_(3600352804,1432725776),_(4094571909,1467031594),_(275423344,851169720),_(430227734,3100823752),_(506948616,1363258195),_(659060556,3750685593),_(883997877,3785050280),_(958139571,3318307427),_(1322822218,3812723403),_(1537002063,2003034995),_(1747873779,3602036899),_(1955562222,1575990012),_(2024104815,1125592928),_(2227730452,2716904306),_(2361852424,442776044),_(2428436474,593698344),_(2756734187,3733110249),_(3204031479,2999351573),_(3329325298,3815920427),_(3391569614,3928383900),_(3515267271,566280711),_(3940187606,3454069534),_(4118630271,4000239992),_(116418474,1914138554),_(174292421,2731055270),_(289380356,3203993006),_(460393269,320620315),_(685471733,587496836),_(852142971,1086792851),_(1017036298,365543100),_(1126000580,2618297676),_(1288033470,3409855158),_(1501505948,4234509866),_(1607167915,987167468),_(1816402316,1246189591)],S=[];(function(){for(var M=0;M<80;M++)S[M]=_()})();var k=v.SHA512=c.extend({_doReset:function(){this._hash=new p.init([new f.init(1779033703,4089235720),new f.init(3144134277,2227873595),new f.init(1013904242,4271175723),new f.init(2773480762,1595750129),new f.init(1359893119,2917565137),new f.init(2600822924,725511199),new f.init(528734635,4215389547),new f.init(1541459225,327033209)])},_doProcessBlock:function(M,R){for(var w=this._hash.words,E=w[0],N=w[1],F=w[2],x=w[3],P=w[4],G=w[5],H=w[6],Y=w[7],j=E.high,W=E.low,O=N.high,Q=N.low,J=F.high,oe=F.low,pe=x.high,ie=x.low,te=P.high,he=P.low,re=G.high,X=G.low,ye=H.high,ue=H.low,Ie=Y.high,ve=Y.low,Ce=j,Fe=W,Oe=O,be=Q,xe=J,Le=oe,rt=pe,Qe=ie,Ge=te,_e=he,Re=re,Ke=X,je=ye,ze=ue,nt=Ie,it=ve,dt=0;dt<80;dt++){var gt=S[dt];if(dt<16)var ft=gt.high=0|M[R+2*dt],Mt=gt.low=0|M[R+2*dt+1];else{var lt=S[dt-15],Et=lt.high,Yt=lt.low,sn=(Et>>>1|Yt<<31)^(Et>>>8|Yt<<24)^Et>>>7,dn=(Yt>>>1|Et<<31)^(Yt>>>8|Et<<24)^(Yt>>>7|Et<<25),Sn=S[dt-2],yn=Sn.high,fo=Sn.low,Xt=(yn>>>19|fo<<13)^(yn<<3|fo>>>29)^yn>>>6,vn=(fo>>>19|yn<<13)^(fo<<3|yn>>>29)^(fo>>>6|yn<<26),Ne=S[dt-7],qe=Ne.high,ke=Ne.low,ot=S[dt-16],tn=ot.high,Nt=ot.low;ft=(ft=(ft=sn+qe+((Mt=dn+ke)>>>0<dn>>>0?1:0))+Xt+((Mt+=vn)>>>0<vn>>>0?1:0))+tn+((Mt+=Nt)>>>0<Nt>>>0?1:0),gt.high=ft,gt.low=Mt}var Dn,dr=Ge&Re^~Ge&je,io=_e&Ke^~_e&ze,hr=Ce&Oe^Ce&xe^Oe&xe,K=Fe&be^Fe&Le^be&Le,ri=(Ce>>>28|Fe<<4)^(Ce<<30|Fe>>>2)^(Ce<<25|Fe>>>7),Gt=(Fe>>>28|Ce<<4)^(Fe<<30|Ce>>>2)^(Fe<<25|Ce>>>7),Ho=(Ge>>>14|_e<<18)^(Ge>>>18|_e<<14)^(Ge<<23|_e>>>9),jo=(_e>>>14|Ge<<18)^(_e>>>18|Ge<<14)^(_e<<23|Ge>>>9),xi=b[dt],Vr=xi.high,Ui=xi.low,ii=nt+Ho+((Dn=it+jo)>>>0<it>>>0?1:0),ha=Gt+K;nt=je,it=ze,je=Re,ze=Ke,Re=Ge,Ke=_e,Ge=rt+(ii=(ii=(ii=ii+dr+((Dn+=io)>>>0<io>>>0?1:0))+Vr+((Dn+=Ui)>>>0<Ui>>>0?1:0))+ft+((Dn+=Mt)>>>0<Mt>>>0?1:0))+((_e=Qe+Dn|0)>>>0<Qe>>>0?1:0)|0,rt=xe,Qe=Le,xe=Oe,Le=be,Oe=Ce,be=Fe,Ce=ii+(ri+hr+(ha>>>0<Gt>>>0?1:0))+((Fe=Dn+ha|0)>>>0<Dn>>>0?1:0)|0}W=E.low=W+Fe,E.high=j+Ce+(W>>>0<Fe>>>0?1:0),Q=N.low=Q+be,N.high=O+Oe+(Q>>>0<be>>>0?1:0),oe=F.low=oe+Le,F.high=J+xe+(oe>>>0<Le>>>0?1:0),ie=x.low=ie+Qe,x.high=pe+rt+(ie>>>0<Qe>>>0?1:0),he=P.low=he+_e,P.high=te+Ge+(he>>>0<_e>>>0?1:0),X=G.low=X+Ke,G.high=re+Re+(X>>>0<Ke>>>0?1:0),ue=H.low=ue+ze,H.high=ye+je+(ue>>>0<ze>>>0?1:0),ve=Y.low=ve+it,Y.high=Ie+nt+(ve>>>0<it>>>0?1:0)},_doFinalize:function(){var M=this._data,R=M.words,w=8*this._nDataBytes,E=8*M.sigBytes;return R[E>>>5]|=128<<24-E%32,R[30+(E+128>>>10<<5)]=Math.floor(w/4294967296),R[31+(E+128>>>10<<5)]=w,M.sigBytes=4*R.length,this._process(),this._hash.toX32()},clone:function(){var M=c.clone.call(this);return M._hash=this._hash.clone(),M},blockSize:32});i.SHA512=c._createHelper(k),i.HmacSHA512=c._createHmacHelper(k)}(),o.SHA512)}),Uo(function(e,t){var o,i,c,u,f,p,v,_;e.exports=(c=(i=o=Vo).x64,u=c.Word,f=c.WordArray,p=i.algo,v=p.SHA512,_=p.SHA384=v.extend({_doReset:function(){this._hash=new f.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var b=v._doFinalize.call(this);return b.sigBytes-=16,b}}),i.SHA384=v._createHelper(_),i.HmacSHA384=v._createHmacHelper(_),o.SHA384)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,v=c.x64.Word,_=c.algo,b=[],S=[],k=[];(function(){for(var w=1,E=0,N=0;N<24;N++){b[w+5*E]=(N+1)*(N+2)/2%64;var F=(2*w+3*E)%5;w=E%5,E=F}for(w=0;w<5;w++)for(E=0;E<5;E++)S[w+5*E]=E+(2*w+3*E)%5*5;for(var x=1,P=0;P<24;P++){for(var G=0,H=0,Y=0;Y<7;Y++){if(1&x){var j=(1<<Y)-1;j<32?H^=1<<j:G^=1<<j-32}128&x?x=x<<1^113:x<<=1}k[P]=v.create(G,H)}})();var M=[];(function(){for(var w=0;w<25;w++)M[w]=v.create()})();var R=_.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],E=0;E<25;E++)w[E]=new v.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,E){for(var N=this._state,F=this.blockSize/2,x=0;x<F;x++){var P=w[E+2*x],G=w[E+2*x+1];P=16711935&(P<<8|P>>>24)|4278255360&(P<<24|P>>>8),G=16711935&(G<<8|G>>>24)|4278255360&(G<<24|G>>>8),(ve=N[x]).high^=G,ve.low^=P}for(var H=0;H<24;H++){for(var Y=0;Y<5;Y++){for(var j=0,W=0,O=0;O<5;O++)j^=(ve=N[Y+5*O]).high,W^=ve.low;var Q=M[Y];Q.high=j,Q.low=W}for(Y=0;Y<5;Y++){var J=M[(Y+4)%5],oe=M[(Y+1)%5],pe=oe.high,ie=oe.low;for(j=J.high^(pe<<1|ie>>>31),W=J.low^(ie<<1|pe>>>31),O=0;O<5;O++)(ve=N[Y+5*O]).high^=j,ve.low^=W}for(var te=1;te<25;te++){var he=(ve=N[te]).high,re=ve.low,X=b[te];X<32?(j=he<<X|re>>>32-X,W=re<<X|he>>>32-X):(j=re<<X-32|he>>>64-X,W=he<<X-32|re>>>64-X);var ye=M[S[te]];ye.high=j,ye.low=W}var ue=M[0],Ie=N[0];for(ue.high=Ie.high,ue.low=Ie.low,Y=0;Y<5;Y++)for(O=0;O<5;O++){var ve=N[te=Y+5*O],Ce=M[te],Fe=M[(Y+1)%5+5*O],Oe=M[(Y+2)%5+5*O];ve.high=Ce.high^~Fe.high&Oe.high,ve.low=Ce.low^~Fe.low&Oe.low}ve=N[0];var be=k[H];ve.high^=be.high,ve.low^=be.low}},_doFinalize:function(){var w=this._data,E=w.words,N=(this._nDataBytes,8*w.sigBytes),F=32*this.blockSize;E[N>>>5]|=1<<24-N%32,E[(i.ceil((N+1)/F)*F>>>5)-1]|=128,w.sigBytes=4*E.length,this._process();for(var x=this._state,P=this.cfg.outputLength/8,G=P/8,H=[],Y=0;Y<G;Y++){var j=x[Y],W=j.high,O=j.low;W=16711935&(W<<8|W>>>24)|4278255360&(W<<24|W>>>8),O=16711935&(O<<8|O>>>24)|4278255360&(O<<24|O>>>8),H.push(O),H.push(W)}return new f.init(H,P)},clone:function(){for(var w=p.clone.call(this),E=w._state=this._state.slice(0),N=0;N<25;N++)E[N]=E[N].clone();return w}});c.SHA3=p._createHelper(R),c.HmacSHA3=p._createHmacHelper(R)}(Math),o.SHA3)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(i){var c=o,u=c.lib,f=u.WordArray,p=u.Hasher,v=c.algo,_=f.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),b=f.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),S=f.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),k=f.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),M=f.create([0,1518500249,1859775393,2400959708,2840853838]),R=f.create([1352829926,1548603684,1836072691,2053994217,0]),w=v.RIPEMD160=p.extend({_doReset:function(){this._hash=f.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(H,Y){for(var j=0;j<16;j++){var W=Y+j,O=H[W];H[W]=16711935&(O<<8|O>>>24)|4278255360&(O<<24|O>>>8)}var Q,J,oe,pe,ie,te,he,re,X,ye,ue,Ie=this._hash.words,ve=M.words,Ce=R.words,Fe=_.words,Oe=b.words,be=S.words,xe=k.words;for(te=Q=Ie[0],he=J=Ie[1],re=oe=Ie[2],X=pe=Ie[3],ye=ie=Ie[4],j=0;j<80;j+=1)ue=Q+H[Y+Fe[j]]|0,ue+=j<16?E(J,oe,pe)+ve[0]:j<32?N(J,oe,pe)+ve[1]:j<48?F(J,oe,pe)+ve[2]:j<64?x(J,oe,pe)+ve[3]:P(J,oe,pe)+ve[4],ue=(ue=G(ue|=0,be[j]))+ie|0,Q=ie,ie=pe,pe=G(oe,10),oe=J,J=ue,ue=te+H[Y+Oe[j]]|0,ue+=j<16?P(he,re,X)+Ce[0]:j<32?x(he,re,X)+Ce[1]:j<48?F(he,re,X)+Ce[2]:j<64?N(he,re,X)+Ce[3]:E(he,re,X)+Ce[4],ue=(ue=G(ue|=0,xe[j]))+ye|0,te=ye,ye=X,X=G(re,10),re=he,he=ue;ue=Ie[1]+oe+X|0,Ie[1]=Ie[2]+pe+ye|0,Ie[2]=Ie[3]+ie+te|0,Ie[3]=Ie[4]+Q+he|0,Ie[4]=Ie[0]+J+re|0,Ie[0]=ue},_doFinalize:function(){var H=this._data,Y=H.words,j=8*this._nDataBytes,W=8*H.sigBytes;Y[W>>>5]|=128<<24-W%32,Y[14+(W+64>>>9<<4)]=16711935&(j<<8|j>>>24)|4278255360&(j<<24|j>>>8),H.sigBytes=4*(Y.length+1),this._process();for(var O=this._hash,Q=O.words,J=0;J<5;J++){var oe=Q[J];Q[J]=16711935&(oe<<8|oe>>>24)|4278255360&(oe<<24|oe>>>8)}return O},clone:function(){var H=p.clone.call(this);return H._hash=this._hash.clone(),H}});function E(H,Y,j){return H^Y^j}function N(H,Y,j){return H&Y|~H&j}function F(H,Y,j){return(H|~Y)^j}function x(H,Y,j){return H&j|Y&~j}function P(H,Y,j){return H^(Y|~j)}function G(H,Y){return H<<Y|H>>>32-Y}c.RIPEMD160=p._createHelper(w),c.HmacRIPEMD160=p._createHmacHelper(w)}(),o.RIPEMD160)}),Uo(function(e,t){var o,i,c,u,f,p;e.exports=(i=(o=Vo).lib,c=i.Base,u=o.enc,f=u.Utf8,p=o.algo,void(p.HMAC=c.extend({init:function(v,_){v=this._hasher=new v.init,typeof _=="string"&&(_=f.parse(_));var b=v.blockSize,S=4*b;_.sigBytes>S&&(_=v.finalize(_)),_.clamp();for(var k=this._oKey=_.clone(),M=this._iKey=_.clone(),R=k.words,w=M.words,E=0;E<b;E++)R[E]^=1549556828,w[E]^=909522486;k.sigBytes=M.sigBytes=S,this.reset()},reset:function(){var v=this._hasher;v.reset(),v.update(this._iKey)},update:function(v){return this._hasher.update(v),this},finalize:function(v){var _=this._hasher,b=_.finalize(v);_.reset();var S=_.finalize(this._oKey.clone().concat(b));return S}})))}),Uo(function(e,t){var o,i,c,u,f,p,v,_,b;e.exports=(c=(i=o=Vo).lib,u=c.Base,f=c.WordArray,p=i.algo,v=p.SHA1,_=p.HMAC,b=p.PBKDF2=u.extend({cfg:u.extend({keySize:4,hasher:v,iterations:1}),init:function(S){this.cfg=this.cfg.extend(S)},compute:function(S,k){for(var M=this.cfg,R=_.create(M.hasher,S),w=f.create(),E=f.create([1]),N=w.words,F=E.words,x=M.keySize,P=M.iterations;N.length<x;){var G=R.update(k).finalize(E);R.reset();for(var H=G.words,Y=H.length,j=G,W=1;W<P;W++){j=R.finalize(j),R.reset();for(var O=j.words,Q=0;Q<Y;Q++)H[Q]^=O[Q]}w.concat(G),F[0]++}return w.sigBytes=4*x,w}}),i.PBKDF2=function(S,k,M){return b.create(M).compute(S,k)},o.PBKDF2)}),Uo(function(e,t){var o,i,c,u,f,p,v,_;e.exports=(c=(i=o=Vo).lib,u=c.Base,f=c.WordArray,p=i.algo,v=p.MD5,_=p.EvpKDF=u.extend({cfg:u.extend({keySize:4,hasher:v,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(b,S){for(var k=this.cfg,M=k.hasher.create(),R=f.create(),w=R.words,E=k.keySize,N=k.iterations;w.length<E;){F&&M.update(F);var F=M.update(b).finalize(S);M.reset();for(var x=1;x<N;x++)F=M.finalize(F),M.reset();R.concat(F)}return R.sigBytes=4*E,R}}),i.EvpKDF=function(b,S,k){return _.create(k).compute(b,S)},o.EvpKDF)}),Uo(function(e,t){var o,i,c,u,f,p,v,_,b,S,k,M,R,w,E,N,F,x,P,G,H,Y,j,W;e.exports=void((o=Vo).lib.Cipher||(c=o,u=c.lib,f=u.Base,p=u.WordArray,v=u.BufferedBlockAlgorithm,_=c.enc,_.Utf8,b=_.Base64,S=c.algo,k=S.EvpKDF,M=u.Cipher=v.extend({cfg:f.extend(),createEncryptor:function(O,Q){return this.create(this._ENC_XFORM_MODE,O,Q)},createDecryptor:function(O,Q){return this.create(this._DEC_XFORM_MODE,O,Q)},init:function(O,Q,J){this.cfg=this.cfg.extend(J),this._xformMode=O,this._key=Q,this.reset()},reset:function(){v.reset.call(this),this._doReset()},process:function(O){return this._append(O),this._process()},finalize:function(O){O&&this._append(O);var Q=this._doFinalize();return Q},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function O(Q){return typeof Q=="string"?W:H}return function(Q){return{encrypt:function(J,oe,pe){return O(oe).encrypt(Q,J,oe,pe)},decrypt:function(J,oe,pe){return O(oe).decrypt(Q,J,oe,pe)}}}}()}),u.StreamCipher=M.extend({_doFinalize:function(){var O=this._process(!0);return O},blockSize:1}),R=c.mode={},w=u.BlockCipherMode=f.extend({createEncryptor:function(O,Q){return this.Encryptor.create(O,Q)},createDecryptor:function(O,Q){return this.Decryptor.create(O,Q)},init:function(O,Q){this._cipher=O,this._iv=Q}}),E=R.CBC=function(){var O=w.extend();function Q(J,oe,pe){var ie=this._iv;if(ie){var te=ie;this._iv=i}else var te=this._prevBlock;for(var he=0;he<pe;he++)J[oe+he]^=te[he]}return O.Encryptor=O.extend({processBlock:function(J,oe){var pe=this._cipher,ie=pe.blockSize;Q.call(this,J,oe,ie),pe.encryptBlock(J,oe),this._prevBlock=J.slice(oe,oe+ie)}}),O.Decryptor=O.extend({processBlock:function(J,oe){var pe=this._cipher,ie=pe.blockSize,te=J.slice(oe,oe+ie);pe.decryptBlock(J,oe),Q.call(this,J,oe,ie),this._prevBlock=te}}),O}(),N=c.pad={},F=N.Pkcs7={pad:function(O,Q){for(var J=4*Q,oe=J-O.sigBytes%J,pe=oe<<24|oe<<16|oe<<8|oe,ie=[],te=0;te<oe;te+=4)ie.push(pe);var he=p.create(ie,oe);O.concat(he)},unpad:function(O){var Q=255&O.words[O.sigBytes-1>>>2];O.sigBytes-=Q}},u.BlockCipher=M.extend({cfg:M.cfg.extend({mode:E,padding:F}),reset:function(){M.reset.call(this);var O=this.cfg,Q=O.iv,J=O.mode;if(this._xformMode==this._ENC_XFORM_MODE)var oe=J.createEncryptor;else{var oe=J.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==oe?this._mode.init(this,Q&&Q.words):(this._mode=oe.call(J,this,Q&&Q.words),this._mode.__creator=oe)},_doProcessBlock:function(O,Q){this._mode.processBlock(O,Q)},_doFinalize:function(){var O=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){O.pad(this._data,this.blockSize);var Q=this._process(!0)}else{var Q=this._process(!0);O.unpad(Q)}return Q},blockSize:4}),x=u.CipherParams=f.extend({init:function(O){this.mixIn(O)},toString:function(O){return(O||this.formatter).stringify(this)}}),P=c.format={},G=P.OpenSSL={stringify:function(O){var Q=O.ciphertext,J=O.salt;if(J)var oe=p.create([1398893684,1701076831]).concat(J).concat(Q);else var oe=Q;return oe.toString(b)},parse:function(O){var Q=b.parse(O),J=Q.words;if(J[0]==1398893684&&J[1]==1701076831){var oe=p.create(J.slice(2,4));J.splice(0,4),Q.sigBytes-=16}return x.create({ciphertext:Q,salt:oe})}},H=u.SerializableCipher=f.extend({cfg:f.extend({format:G}),encrypt:function(O,Q,J,oe){oe=this.cfg.extend(oe);var pe=O.createEncryptor(J,oe),ie=pe.finalize(Q),te=pe.cfg;return x.create({ciphertext:ie,key:J,iv:te.iv,algorithm:O,mode:te.mode,padding:te.padding,blockSize:O.blockSize,formatter:oe.format})},decrypt:function(O,Q,J,oe){oe=this.cfg.extend(oe),Q=this._parse(Q,oe.format);var pe=O.createDecryptor(J,oe).finalize(Q.ciphertext);return pe},_parse:function(O,Q){return typeof O=="string"?Q.parse(O,this):O}}),Y=c.kdf={},j=Y.OpenSSL={execute:function(O,Q,J,oe){oe||(oe=p.random(8));var pe=k.create({keySize:Q+J}).compute(O,oe),ie=p.create(pe.words.slice(Q),4*J);return pe.sigBytes=4*Q,x.create({key:pe,iv:ie,salt:oe})}},W=u.PasswordBasedCipher=H.extend({cfg:H.cfg.extend({kdf:j}),encrypt:function(O,Q,J,oe){var pe=(oe=this.cfg.extend(oe)).kdf.execute(J,O.keySize,O.ivSize);oe.iv=pe.iv;var ie=H.encrypt.call(this,O,Q,pe.key,oe);return ie.mixIn(pe),ie},decrypt:function(O,Q,J,oe){oe=this.cfg.extend(oe),Q=this._parse(Q,oe.format);var pe=oe.kdf.execute(J,O.keySize,O.ivSize,Q.salt);oe.iv=pe.iv;var ie=H.decrypt.call(this,O,Q,pe.key,oe);return ie}})))}),Uo(function(e,t){var o;e.exports=((o=Vo).mode.CFB=function(){var i=o.lib.BlockCipherMode.extend();function c(u,f,p,v){var _=this._iv;if(_){var b=_.slice(0);this._iv=void 0}else b=this._prevBlock;v.encryptBlock(b,0);for(var S=0;S<p;S++)u[f+S]^=b[S]}return i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,v=p.blockSize;c.call(this,u,f,v,p),this._prevBlock=u.slice(f,f+v)}}),i.Decryptor=i.extend({processBlock:function(u,f){var p=this._cipher,v=p.blockSize,_=u.slice(f,f+v);c.call(this,u,f,v,p),this._prevBlock=_}}),i}(),o.mode.CFB)}),Uo(function(e,t){var o,i,c;e.exports=((o=Vo).mode.CTR=(i=o.lib.BlockCipherMode.extend(),c=i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,v=p.blockSize,_=this._iv,b=this._counter;_&&(b=this._counter=_.slice(0),this._iv=void 0);var S=b.slice(0);p.encryptBlock(S,0),b[v-1]=b[v-1]+1|0;for(var k=0;k<v;k++)u[f+k]^=S[k]}}),i.Decryptor=c,i),o.mode.CTR)}),Uo(function(e,t){var o;e.exports=((o=Vo).mode.CTRGladman=function(){var i=o.lib.BlockCipherMode.extend();function c(f){if((f>>24&255)==255){var p=f>>16&255,v=f>>8&255,_=255&f;p===255?(p=0,v===255?(v=0,_===255?_=0:++_):++v):++p,f=0,f+=p<<16,f+=v<<8,f+=_}else f+=1<<24;return f}var u=i.Encryptor=i.extend({processBlock:function(f,p){var v=this._cipher,_=v.blockSize,b=this._iv,S=this._counter;b&&(S=this._counter=b.slice(0),this._iv=void 0),function(R){(R[0]=c(R[0]))===0&&(R[1]=c(R[1]))}(S);var k=S.slice(0);v.encryptBlock(k,0);for(var M=0;M<_;M++)f[p+M]^=k[M]}});return i.Decryptor=u,i}(),o.mode.CTRGladman)}),Uo(function(e,t){var o,i,c;e.exports=((o=Vo).mode.OFB=(i=o.lib.BlockCipherMode.extend(),c=i.Encryptor=i.extend({processBlock:function(u,f){var p=this._cipher,v=p.blockSize,_=this._iv,b=this._keystream;_&&(b=this._keystream=_.slice(0),this._iv=void 0),p.encryptBlock(b,0);for(var S=0;S<v;S++)u[f+S]^=b[S]}}),i.Decryptor=c,i),o.mode.OFB)}),Uo(function(e,t){var o,i;e.exports=((o=Vo).mode.ECB=((i=o.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(c,u){this._cipher.encryptBlock(c,u)}}),i.Decryptor=i.extend({processBlock:function(c,u){this._cipher.decryptBlock(c,u)}}),i),o.mode.ECB)}),Uo(function(e,t){var o;e.exports=((o=Vo).pad.AnsiX923={pad:function(i,c){var u=i.sigBytes,f=4*c,p=f-u%f,v=u+p-1;i.clamp(),i.words[v>>>2]|=p<<24-v%4*8,i.sigBytes+=p},unpad:function(i){var c=255&i.words[i.sigBytes-1>>>2];i.sigBytes-=c}},o.pad.Ansix923)}),Uo(function(e,t){var o;e.exports=((o=Vo).pad.Iso10126={pad:function(i,c){var u=4*c,f=u-i.sigBytes%u;i.concat(o.lib.WordArray.random(f-1)).concat(o.lib.WordArray.create([f<<24],1))},unpad:function(i){var c=255&i.words[i.sigBytes-1>>>2];i.sigBytes-=c}},o.pad.Iso10126)}),Uo(function(e,t){var o;e.exports=((o=Vo).pad.Iso97971={pad:function(i,c){i.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(i,c)},unpad:function(i){o.pad.ZeroPadding.unpad(i),i.sigBytes--}},o.pad.Iso97971)}),Uo(function(e,t){var o;e.exports=((o=Vo).pad.ZeroPadding={pad:function(i,c){var u=4*c;i.clamp(),i.sigBytes+=u-(i.sigBytes%u||u)},unpad:function(i){for(var c=i.words,u=i.sigBytes-1;!(c[u>>>2]>>>24-u%4*8&255);)u--;i.sigBytes=u+1}},o.pad.ZeroPadding)}),Uo(function(e,t){var o;e.exports=((o=Vo).pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding)}),Uo(function(e,t){var o,i,c,u;e.exports=(c=(i=o=Vo).lib.CipherParams,u=i.enc.Hex,i.format.Hex={stringify:function(f){return f.ciphertext.toString(u)},parse:function(f){var p=u.parse(f);return c.create({ciphertext:p})}},o.format.Hex)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.BlockCipher,u=i.algo,f=[],p=[],v=[],_=[],b=[],S=[],k=[],M=[],R=[],w=[];(function(){for(var F=[],x=0;x<256;x++)F[x]=x<128?x<<1:x<<1^283;var P=0,G=0;for(x=0;x<256;x++){var H=G^G<<1^G<<2^G<<3^G<<4;H=H>>>8^255&H^99,f[P]=H,p[H]=P;var Y=F[P],j=F[Y],W=F[j],O=257*F[H]^16843008*H;v[P]=O<<24|O>>>8,_[P]=O<<16|O>>>16,b[P]=O<<8|O>>>24,S[P]=O,O=16843009*W^65537*j^257*Y^16843008*P,k[H]=O<<24|O>>>8,M[H]=O<<16|O>>>16,R[H]=O<<8|O>>>24,w[H]=O,P?(P=Y^F[F[F[W^Y]]],G^=F[F[G]]):P=G=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],N=u.AES=c.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var F=this._keyPriorReset=this._key,x=F.words,P=F.sigBytes/4,G=4*((this._nRounds=P+6)+1),H=this._keySchedule=[],Y=0;Y<G;Y++)if(Y<P)H[Y]=x[Y];else{var j=H[Y-1];Y%P?P>6&&Y%P==4&&(j=f[j>>>24]<<24|f[j>>>16&255]<<16|f[j>>>8&255]<<8|f[255&j]):(j=f[(j=j<<8|j>>>24)>>>24]<<24|f[j>>>16&255]<<16|f[j>>>8&255]<<8|f[255&j],j^=E[Y/P|0]<<24),H[Y]=H[Y-P]^j}for(var W=this._invKeySchedule=[],O=0;O<G;O++)Y=G-O,j=O%4?H[Y]:H[Y-4],W[O]=O<4||Y<=4?j:k[f[j>>>24]]^M[f[j>>>16&255]]^R[f[j>>>8&255]]^w[f[255&j]]}},encryptBlock:function(F,x){this._doCryptBlock(F,x,this._keySchedule,v,_,b,S,f)},decryptBlock:function(F,x){var P=F[x+1];F[x+1]=F[x+3],F[x+3]=P,this._doCryptBlock(F,x,this._invKeySchedule,k,M,R,w,p),P=F[x+1],F[x+1]=F[x+3],F[x+3]=P},_doCryptBlock:function(F,x,P,G,H,Y,j,W){for(var O=this._nRounds,Q=F[x]^P[0],J=F[x+1]^P[1],oe=F[x+2]^P[2],pe=F[x+3]^P[3],ie=4,te=1;te<O;te++){var he=G[Q>>>24]^H[J>>>16&255]^Y[oe>>>8&255]^j[255&pe]^P[ie++],re=G[J>>>24]^H[oe>>>16&255]^Y[pe>>>8&255]^j[255&Q]^P[ie++],X=G[oe>>>24]^H[pe>>>16&255]^Y[Q>>>8&255]^j[255&J]^P[ie++],ye=G[pe>>>24]^H[Q>>>16&255]^Y[J>>>8&255]^j[255&oe]^P[ie++];Q=he,J=re,oe=X,pe=ye}he=(W[Q>>>24]<<24|W[J>>>16&255]<<16|W[oe>>>8&255]<<8|W[255&pe])^P[ie++],re=(W[J>>>24]<<24|W[oe>>>16&255]<<16|W[pe>>>8&255]<<8|W[255&Q])^P[ie++],X=(W[oe>>>24]<<24|W[pe>>>16&255]<<16|W[Q>>>8&255]<<8|W[255&J])^P[ie++],ye=(W[pe>>>24]<<24|W[Q>>>16&255]<<16|W[J>>>8&255]<<8|W[255&oe])^P[ie++],F[x]=he,F[x+1]=re,F[x+2]=X,F[x+3]=ye},keySize:8});i.AES=c._createHelper(N)}(),o.AES)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib,u=c.WordArray,f=c.BlockCipher,p=i.algo,v=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],_=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],b=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],S=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],k=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],M=p.DES=f.extend({_doReset:function(){for(var N=this._key.words,F=[],x=0;x<56;x++){var P=v[x]-1;F[x]=N[P>>>5]>>>31-P%32&1}for(var G=this._subKeys=[],H=0;H<16;H++){var Y=G[H]=[],j=b[H];for(x=0;x<24;x++)Y[x/6|0]|=F[(_[x]-1+j)%28]<<31-x%6,Y[4+(x/6|0)]|=F[28+(_[x+24]-1+j)%28]<<31-x%6;for(Y[0]=Y[0]<<1|Y[0]>>>31,x=1;x<7;x++)Y[x]=Y[x]>>>4*(x-1)+3;Y[7]=Y[7]<<5|Y[7]>>>27}var W=this._invSubKeys=[];for(x=0;x<16;x++)W[x]=G[15-x]},encryptBlock:function(N,F){this._doCryptBlock(N,F,this._subKeys)},decryptBlock:function(N,F){this._doCryptBlock(N,F,this._invSubKeys)},_doCryptBlock:function(N,F,x){this._lBlock=N[F],this._rBlock=N[F+1],R.call(this,4,252645135),R.call(this,16,65535),w.call(this,2,858993459),w.call(this,8,16711935),R.call(this,1,1431655765);for(var P=0;P<16;P++){for(var G=x[P],H=this._lBlock,Y=this._rBlock,j=0,W=0;W<8;W++)j|=S[W][((Y^G[W])&k[W])>>>0];this._lBlock=Y,this._rBlock=H^j}var O=this._lBlock;this._lBlock=this._rBlock,this._rBlock=O,R.call(this,1,1431655765),w.call(this,8,16711935),w.call(this,2,858993459),R.call(this,16,65535),R.call(this,4,252645135),N[F]=this._lBlock,N[F+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function R(N,F){var x=(this._lBlock>>>N^this._rBlock)&F;this._rBlock^=x,this._lBlock^=x<<N}function w(N,F){var x=(this._rBlock>>>N^this._lBlock)&F;this._lBlock^=x,this._rBlock^=x<<N}i.DES=f._createHelper(M);var E=p.TripleDES=f.extend({_doReset:function(){var N=this._key.words;this._des1=M.createEncryptor(u.create(N.slice(0,2))),this._des2=M.createEncryptor(u.create(N.slice(2,4))),this._des3=M.createEncryptor(u.create(N.slice(4,6)))},encryptBlock:function(N,F){this._des1.encryptBlock(N,F),this._des2.decryptBlock(N,F),this._des3.encryptBlock(N,F)},decryptBlock:function(N,F){this._des3.decryptBlock(N,F),this._des2.encryptBlock(N,F),this._des1.decryptBlock(N,F)},keySize:6,ivSize:2,blockSize:2});i.TripleDES=f._createHelper(E)}(),o.TripleDES)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=u.RC4=c.extend({_doReset:function(){for(var _=this._key,b=_.words,S=_.sigBytes,k=this._S=[],M=0;M<256;M++)k[M]=M;M=0;for(var R=0;M<256;M++){var w=M%S,E=b[w>>>2]>>>24-w%4*8&255;R=(R+k[M]+E)%256;var N=k[M];k[M]=k[R],k[R]=N}this._i=this._j=0},_doProcessBlock:function(_,b){_[b]^=p.call(this)},keySize:8,ivSize:0});function p(){for(var _=this._S,b=this._i,S=this._j,k=0,M=0;M<4;M++){S=(S+_[b=(b+1)%256])%256;var R=_[b];_[b]=_[S],_[S]=R,k|=_[(_[b]+_[S])%256]<<24-8*M}return this._i=b,this._j=S,k}i.RC4=c._createHelper(f);var v=u.RC4Drop=f.extend({cfg:f.cfg.extend({drop:192}),_doReset:function(){f._doReset.call(this);for(var _=this.cfg.drop;_>0;_--)p.call(this)}});i.RC4Drop=c._createHelper(v)}(),o.RC4)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=[],p=[],v=[],_=u.Rabbit=c.extend({_doReset:function(){for(var S=this._key.words,k=this.cfg.iv,M=0;M<4;M++)S[M]=16711935&(S[M]<<8|S[M]>>>24)|4278255360&(S[M]<<24|S[M]>>>8);var R=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],w=this._C=[S[2]<<16|S[2]>>>16,4294901760&S[0]|65535&S[1],S[3]<<16|S[3]>>>16,4294901760&S[1]|65535&S[2],S[0]<<16|S[0]>>>16,4294901760&S[2]|65535&S[3],S[1]<<16|S[1]>>>16,4294901760&S[3]|65535&S[0]];for(this._b=0,M=0;M<4;M++)b.call(this);for(M=0;M<8;M++)w[M]^=R[M+4&7];if(k){var E=k.words,N=E[0],F=E[1],x=16711935&(N<<8|N>>>24)|4278255360&(N<<24|N>>>8),P=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),G=x>>>16|4294901760&P,H=P<<16|65535&x;for(w[0]^=x,w[1]^=G,w[2]^=P,w[3]^=H,w[4]^=x,w[5]^=G,w[6]^=P,w[7]^=H,M=0;M<4;M++)b.call(this)}},_doProcessBlock:function(S,k){var M=this._X;b.call(this),f[0]=M[0]^M[5]>>>16^M[3]<<16,f[1]=M[2]^M[7]>>>16^M[5]<<16,f[2]=M[4]^M[1]>>>16^M[7]<<16,f[3]=M[6]^M[3]>>>16^M[1]<<16;for(var R=0;R<4;R++)f[R]=16711935&(f[R]<<8|f[R]>>>24)|4278255360&(f[R]<<24|f[R]>>>8),S[k+R]^=f[R]},blockSize:4,ivSize:2});function b(){for(var S=this._X,k=this._C,M=0;M<8;M++)p[M]=k[M];for(k[0]=k[0]+1295307597+this._b|0,k[1]=k[1]+3545052371+(k[0]>>>0<p[0]>>>0?1:0)|0,k[2]=k[2]+886263092+(k[1]>>>0<p[1]>>>0?1:0)|0,k[3]=k[3]+1295307597+(k[2]>>>0<p[2]>>>0?1:0)|0,k[4]=k[4]+3545052371+(k[3]>>>0<p[3]>>>0?1:0)|0,k[5]=k[5]+886263092+(k[4]>>>0<p[4]>>>0?1:0)|0,k[6]=k[6]+1295307597+(k[5]>>>0<p[5]>>>0?1:0)|0,k[7]=k[7]+3545052371+(k[6]>>>0<p[6]>>>0?1:0)|0,this._b=k[7]>>>0<p[7]>>>0?1:0,M=0;M<8;M++){var R=S[M]+k[M],w=65535&R,E=R>>>16,N=((w*w>>>17)+w*E>>>15)+E*E,F=((4294901760&R)*R|0)+((65535&R)*R|0);v[M]=N^F}S[0]=v[0]+(v[7]<<16|v[7]>>>16)+(v[6]<<16|v[6]>>>16)|0,S[1]=v[1]+(v[0]<<8|v[0]>>>24)+v[7]|0,S[2]=v[2]+(v[1]<<16|v[1]>>>16)+(v[0]<<16|v[0]>>>16)|0,S[3]=v[3]+(v[2]<<8|v[2]>>>24)+v[1]|0,S[4]=v[4]+(v[3]<<16|v[3]>>>16)+(v[2]<<16|v[2]>>>16)|0,S[5]=v[5]+(v[4]<<8|v[4]>>>24)+v[3]|0,S[6]=v[6]+(v[5]<<16|v[5]>>>16)+(v[4]<<16|v[4]>>>16)|0,S[7]=v[7]+(v[6]<<8|v[6]>>>24)+v[5]|0}i.Rabbit=c._createHelper(_)}(),o.Rabbit)}),Uo(function(e,t){var o;e.exports=(o=Vo,function(){var i=o,c=i.lib.StreamCipher,u=i.algo,f=[],p=[],v=[],_=u.RabbitLegacy=c.extend({_doReset:function(){var S=this._key.words,k=this.cfg.iv,M=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],R=this._C=[S[2]<<16|S[2]>>>16,4294901760&S[0]|65535&S[1],S[3]<<16|S[3]>>>16,4294901760&S[1]|65535&S[2],S[0]<<16|S[0]>>>16,4294901760&S[2]|65535&S[3],S[1]<<16|S[1]>>>16,4294901760&S[3]|65535&S[0]];this._b=0;for(var w=0;w<4;w++)b.call(this);for(w=0;w<8;w++)R[w]^=M[w+4&7];if(k){var E=k.words,N=E[0],F=E[1],x=16711935&(N<<8|N>>>24)|4278255360&(N<<24|N>>>8),P=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),G=x>>>16|4294901760&P,H=P<<16|65535&x;for(R[0]^=x,R[1]^=G,R[2]^=P,R[3]^=H,R[4]^=x,R[5]^=G,R[6]^=P,R[7]^=H,w=0;w<4;w++)b.call(this)}},_doProcessBlock:function(S,k){var M=this._X;b.call(this),f[0]=M[0]^M[5]>>>16^M[3]<<16,f[1]=M[2]^M[7]>>>16^M[5]<<16,f[2]=M[4]^M[1]>>>16^M[7]<<16,f[3]=M[6]^M[3]>>>16^M[1]<<16;for(var R=0;R<4;R++)f[R]=16711935&(f[R]<<8|f[R]>>>24)|4278255360&(f[R]<<24|f[R]>>>8),S[k+R]^=f[R]},blockSize:4,ivSize:2});function b(){for(var S=this._X,k=this._C,M=0;M<8;M++)p[M]=k[M];for(k[0]=k[0]+1295307597+this._b|0,k[1]=k[1]+3545052371+(k[0]>>>0<p[0]>>>0?1:0)|0,k[2]=k[2]+886263092+(k[1]>>>0<p[1]>>>0?1:0)|0,k[3]=k[3]+1295307597+(k[2]>>>0<p[2]>>>0?1:0)|0,k[4]=k[4]+3545052371+(k[3]>>>0<p[3]>>>0?1:0)|0,k[5]=k[5]+886263092+(k[4]>>>0<p[4]>>>0?1:0)|0,k[6]=k[6]+1295307597+(k[5]>>>0<p[5]>>>0?1:0)|0,k[7]=k[7]+3545052371+(k[6]>>>0<p[6]>>>0?1:0)|0,this._b=k[7]>>>0<p[7]>>>0?1:0,M=0;M<8;M++){var R=S[M]+k[M],w=65535&R,E=R>>>16,N=((w*w>>>17)+w*E>>>15)+E*E,F=((4294901760&R)*R|0)+((65535&R)*R|0);v[M]=N^F}S[0]=v[0]+(v[7]<<16|v[7]>>>16)+(v[6]<<16|v[6]>>>16)|0,S[1]=v[1]+(v[0]<<8|v[0]>>>24)+v[7]|0,S[2]=v[2]+(v[1]<<16|v[1]>>>16)+(v[0]<<16|v[0]>>>16)|0,S[3]=v[3]+(v[2]<<8|v[2]>>>24)+v[1]|0,S[4]=v[4]+(v[3]<<16|v[3]>>>16)+(v[2]<<16|v[2]>>>16)|0,S[5]=v[5]+(v[4]<<8|v[4]>>>24)+v[3]|0,S[6]=v[6]+(v[5]<<16|v[5]>>>16)+(v[4]<<16|v[4]>>>16)|0,S[7]=v[7]+(v[6]<<8|v[6]>>>24)+v[5]|0}i.RabbitLegacy=c._createHelper(_)}(),o.RabbitLegacy)}),Uo(function(e,t){e.exports=Vo}));function v7(){throw new Error("setTimeout has not been defined")}function _7(){throw new Error("clearTimeout has not been defined")}var yd=v7,Id=_7;function y7(e){if(yd===setTimeout)return setTimeout(e,0);if((yd===v7||!yd)&&setTimeout)return yd=setTimeout,setTimeout(e,0);try{return yd(e,0)}catch{try{return yd.call(null,e,0)}catch{return yd.call(this,e,0)}}}typeof $g.setTimeout=="function"&&(yd=setTimeout),typeof $g.clearTimeout=="function"&&(Id=clearTimeout);var Ff,Zc=[],kg=!1,oE=-1;function jce(){kg&&Ff&&(kg=!1,Ff.length?Zc=Ff.concat(Zc):oE=-1,Zc.length&&I7())}function I7(){if(!kg){var e=y7(jce);kg=!0;for(var t=Zc.length;t;){for(Ff=Zc,Zc=[];++oE<t;)Ff&&Ff[oE].run();oE=-1,t=Zc.length}Ff=null,kg=!1,function(o){if(Id===clearTimeout)return clearTimeout(o);if((Id===_7||!Id)&&clearTimeout)return Id=clearTimeout,clearTimeout(o);try{Id(o)}catch{try{return Id.call(null,o)}catch{return Id.call(this,o)}}}(e)}}function ki(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];Zc.push(new b7(e,t)),Zc.length!==1||kg||y7(I7)}function b7(e,t){this.fun=e,this.array=t}b7.prototype.run=function(){this.fun.apply(null,this.array)};var Ry=$g.performance||{};Ry.now||Ry.mozNow||Ry.msNow||Ry.oNow||Ry.webkitNow;function bd(){}function Fo(){Fo.init.call(this)}function C7(e){return e._maxListeners===void 0?Fo.defaultMaxListeners:e._maxListeners}function Yce(e,t,o){if(t)e.call(o);else for(var i=e.length,c=Z0(e,i),u=0;u<i;++u)c[u].call(o)}function Jce(e,t,o,i){if(t)e.call(o,i);else for(var c=e.length,u=Z0(e,c),f=0;f<c;++f)u[f].call(o,i)}function Xce(e,t,o,i,c){if(t)e.call(o,i,c);else for(var u=e.length,f=Z0(e,u),p=0;p<u;++p)f[p].call(o,i,c)}function Zce(e,t,o,i,c,u){if(t)e.call(o,i,c,u);else for(var f=e.length,p=Z0(e,f),v=0;v<f;++v)p[v].call(o,i,c,u)}function Qce(e,t,o,i){if(t)e.apply(o,i);else for(var c=e.length,u=Z0(e,c),f=0;f<c;++f)u[f].apply(o,i)}function N6(e,t,o,i){var c,u,f,p;if(typeof o!="function")throw new TypeError('"listener" argument must be a function');if((u=e._events)?(u.newListener&&(e.emit("newListener",t,o.listener?o.listener:o),u=e._events),f=u[t]):(u=e._events=new bd,e._eventsCount=0),f){if(typeof f=="function"?f=u[t]=i?[o,f]:[f,o]:i?f.unshift(o):f.push(o),!f.warned&&(c=C7(e))&&c>0&&f.length>c){f.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=e,v.type=t,v.count=f.length,p=v,typeof console.warn=="function"?console.warn(p):console.log(p)}}else f=u[t]=o,++e._eventsCount;return e}function P6(e,t,o){var i=!1;function c(){e.removeListener(t,c),i||(i=!0,o.apply(e,arguments))}return c.listener=o,c}function x6(e){var t=this._events;if(t){var o=t[e];if(typeof o=="function")return 1;if(o)return o.length}return 0}function Z0(e,t){for(var o=new Array(t);t--;)o[t]=e[t];return o}bd.prototype=Object.create(null),Fo.EventEmitter=Fo,Fo.usingDomains=!1,Fo.prototype.domain=void 0,Fo.prototype._events=void 0,Fo.prototype._maxListeners=void 0,Fo.defaultMaxListeners=10,Fo.init=function(){this.domain=null,Fo.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new bd,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Fo.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Fo.prototype.getMaxListeners=function(){return C7(this)},Fo.prototype.emit=function(e){var t,o,i,c,u,f,p,v=e==="error";if(f=this._events)v=v&&f.error==null;else if(!v)return!1;if(p=this.domain,v){if(t=arguments[1],!p){if(t instanceof Error)throw t;var _=new Error('Uncaught, unspecified "error" event. ('+t+")");throw _.context=t,_}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=p,t.domainThrown=!1,p.emit("error",t),!1}if(!(o=f[e]))return!1;var b=typeof o=="function";switch(i=arguments.length){case 1:Yce(o,b,this);break;case 2:Jce(o,b,this,arguments[1]);break;case 3:Xce(o,b,this,arguments[1],arguments[2]);break;case 4:Zce(o,b,this,arguments[1],arguments[2],arguments[3]);break;default:for(c=new Array(i-1),u=1;u<i;u++)c[u-1]=arguments[u];Qce(o,b,this,c)}return!0},Fo.prototype.addListener=function(e,t){return N6(this,e,t,!1)},Fo.prototype.on=Fo.prototype.addListener,Fo.prototype.prependListener=function(e,t){return N6(this,e,t,!0)},Fo.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,P6(this,e,t)),this},Fo.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,P6(this,e,t)),this},Fo.prototype.removeListener=function(e,t){var o,i,c,u,f;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(o=i[e]))return this;if(o===t||o.listener&&o.listener===t)--this._eventsCount==0?this._events=new bd:(delete i[e],i.removeListener&&this.emit("removeListener",e,o.listener||t));else if(typeof o!="function"){for(c=-1,u=o.length;u-- >0;)if(o[u]===t||o[u].listener&&o[u].listener===t){f=o[u].listener,c=u;break}if(c<0)return this;if(o.length===1){if(o[0]=void 0,--this._eventsCount==0)return this._events=new bd,this;delete i[e]}else(function(p,v){for(var _=v,b=_+1,S=p.length;b<S;_+=1,b+=1)p[_]=p[b];p.pop()})(o,c);i.removeListener&&this.emit("removeListener",e,f||t)}return this},Fo.prototype.removeAllListeners=function(e){var t,o;if(!(o=this._events))return this;if(!o.removeListener)return arguments.length===0?(this._events=new bd,this._eventsCount=0):o[e]&&(--this._eventsCount==0?this._events=new bd:delete o[e]),this;if(arguments.length===0){for(var i,c=Object.keys(o),u=0;u<c.length;++u)(i=c[u])!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new bd,this._eventsCount=0,this}if(typeof(t=o[e])=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},Fo.prototype.listeners=function(e){var t,o=this._events;return o&&(t=o[e])?typeof t=="function"?[t.listener||t]:function(i){for(var c=new Array(i.length),u=0;u<c.length;++u)c[u]=i[u].listener||i[u];return c}(t):[]},Fo.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):x6.call(e,t)},Fo.prototype.listenerCount=x6,Fo.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Ma=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e},eue=/%[sdj%]/g;function tue(e){if(!xD(e)){for(var t=[],o=0;o<arguments.length;o++)t.push(Vd(arguments[o]));return t.join(" ")}o=1;for(var i=arguments,c=i.length,u=String(e).replace(eue,function(p){if(p==="%%")return"%";if(o>=c)return p;switch(p){case"%s":return String(i[o++]);case"%d":return Number(i[o++]);case"%j":try{return JSON.stringify(i[o++])}catch{return"[Circular]"}default:return p}}),f=i[o];o<c;f=i[++o])kL(f)||!Q0(f)?u+=" "+f:u+=" "+Vd(f);return u}function S7(e,t){if(Od($g.process))return function(){return S7(e,t).apply(this,arguments)};var o=!1;return function(){return o||(console.error(t),o=!0),e.apply(this,arguments)}}var bA,wS={};function Vd(e,t){var o={seen:[],stylize:oue};return arguments.length>=3&&(o.depth=arguments[2]),arguments.length>=4&&(o.colors=arguments[3]),E7(t)?o.showHidden=t:t&&function(i,c){if(!c||!Q0(c))return i;for(var u=Object.keys(c),f=u.length;f--;)i[u[f]]=c[u[f]]}(o,t),Od(o.showHidden)&&(o.showHidden=!1),Od(o.depth)&&(o.depth=2),Od(o.colors)&&(o.colors=!1),Od(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=nue),NE(o,e,o.depth)}function nue(e,t){var o=Vd.styles[t];return o?"\x1B["+Vd.colors[o][0]+"m"+e+"\x1B["+Vd.colors[o][1]+"m":e}function oue(e,t){return e}function NE(e,t,o){if(e.customInspect&&t&&MA(t.inspect)&&t.inspect!==Vd&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(o,e);return xD(i)||(i=NE(e,i,o)),i}var c=function(M,R){if(Od(R))return M.stylize("undefined","undefined");if(xD(R)){var w="'"+JSON.stringify(R).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return M.stylize(w,"string")}if(E=R,typeof E=="number")return M.stylize(""+R,"number");var E;if(E7(R))return M.stylize(""+R,"boolean");if(kL(R))return M.stylize("null","null")}(e,t);if(c)return c;var u=Object.keys(t),f=function(M){var R={};return M.forEach(function(w,E){R[w]=!0}),R}(u);if(e.showHidden&&(u=Object.getOwnPropertyNames(t)),TA(t)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return CA(t);if(u.length===0){if(MA(t)){var p=t.name?": "+t.name:"";return e.stylize("[Function"+p+"]","special")}if(EA(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(U6(t))return e.stylize(Date.prototype.toString.call(t),"date");if(TA(t))return CA(t)}var v,_,b="",S=!1,k=["{","}"];return v=t,Array.isArray(v)&&(S=!0,k=["[","]"]),MA(t)&&(b=" [Function"+(t.name?": "+t.name:"")+"]"),EA(t)&&(b=" "+RegExp.prototype.toString.call(t)),U6(t)&&(b=" "+Date.prototype.toUTCString.call(t)),TA(t)&&(b=" "+CA(t)),u.length!==0||S&&t.length!=0?o<0?EA(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),_=S?function(M,R,w,E,N){for(var F=[],x=0,P=R.length;x<P;++x)T7(R,String(x))?F.push(SA(M,R,w,E,String(x),!0)):F.push("");return N.forEach(function(G){G.match(/^\d+$/)||F.push(SA(M,R,w,E,G,!0))}),F}(e,t,o,f,u):u.map(function(M){return SA(e,t,o,f,M,S)}),e.seen.pop(),function(M,R,w){return M.reduce(function(E,N){return N.indexOf(`
`),E+N.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?w[0]+(R===""?"":R+`
 `)+" "+M.join(`,
  `)+" "+w[1]:w[0]+R+" "+M.join(", ")+" "+w[1]}(_,b,k)):k[0]+b+k[1]}function CA(e){return"["+Error.prototype.toString.call(e)+"]"}function SA(e,t,o,i,c,u){var f,p,v;if((v=Object.getOwnPropertyDescriptor(t,c)||{value:t[c]}).get?p=v.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):v.set&&(p=e.stylize("[Setter]","special")),T7(i,c)||(f="["+c+"]"),p||(e.seen.indexOf(v.value)<0?(p=kL(o)?NE(e,v.value,null):NE(e,v.value,o-1)).indexOf(`
`)>-1&&(p=u?p.split(`
`).map(function(_){return"  "+_}).join(`
`).substr(2):`
`+p.split(`
`).map(function(_){return"   "+_}).join(`
`)):p=e.stylize("[Circular]","special")),Od(f)){if(u&&c.match(/^\d+$/))return p;(f=JSON.stringify(""+c)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=e.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=e.stylize(f,"string"))}return f+": "+p}function E7(e){return typeof e=="boolean"}function kL(e){return e===null}function xD(e){return typeof e=="string"}function Od(e){return e===void 0}function EA(e){return Q0(e)&&wL(e)==="[object RegExp]"}function Q0(e){return typeof e=="object"&&e!==null}function U6(e){return Q0(e)&&wL(e)==="[object Date]"}function TA(e){return Q0(e)&&(wL(e)==="[object Error]"||e instanceof Error)}function MA(e){return typeof e=="function"}function wL(e){return Object.prototype.toString.call(e)}function T7(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Af(){this.head=null,this.tail=null,this.length=0}Vd.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Vd.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Af.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},Af.prototype.unshift=function(e){var t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length},Af.prototype.shift=function(){if(this.length!==0){var e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},Af.prototype.clear=function(){this.head=this.tail=null,this.length=0},Af.prototype.join=function(e){if(this.length===0)return"";for(var t=this.head,o=""+t.data;t=t.next;)o+=e+t.data;return o},Af.prototype.concat=function(e){if(this.length===0)return Ot.alloc(0);if(this.length===1)return this.head.data;for(var t=Ot.allocUnsafe(e>>>0),o=this.head,i=0;o;)o.data.copy(t,i),i+=o.data.length,o=o.next;return t};var rue=Ot.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Zy(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!rue(t))throw new Error("Unknown encoding: "+t)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=aue;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=sue;break;default:return void(this.write=iue)}this.charBuffer=new Ot(6),this.charReceived=0,this.charLength=0}function iue(e){return e.toString(this.encoding)}function aue(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function sue(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}Zy.prototype.write=function(e){for(var t="";this.charLength;){var o=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,o),this.charReceived+=o,this.charReceived<this.charLength)return"";if(e=e.slice(o,e.length),!((c=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&c<=56319)){if(this.charReceived=this.charLength=0,e.length===0)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived);var c;if(i=(t+=e.toString(this.encoding,0,i)).length-1,(c=t.charCodeAt(i))>=55296&&c<=56319){var u=this.surrogateSize;return this.charLength+=u,this.charReceived+=u,this.charBuffer.copy(this.charBuffer,u,0,u),e.copy(this.charBuffer,0,0,u),t.substring(0,i)}return t},Zy.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var o=e[e.length-t];if(t==1&&o>>5==6){this.charLength=2;break}if(t<=2&&o>>4==14){this.charLength=3;break}if(t<=3&&o>>3==30){this.charLength=4;break}}this.charReceived=t},Zy.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var o=this.charReceived,i=this.charBuffer,c=this.encoding;t+=i.slice(0,o).toString(c)}return t},$r.ReadableState=M7;var Qo=function(e){return Od(bA)&&(bA=""),e=e.toUpperCase(),wS[e]||(new RegExp("\\b"+e+"\\b","i").test(bA)?wS[e]=function(){var t=tue.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:wS[e]=function(){}),wS[e]}("stream");function M7(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Ms&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=o||o===0?o:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new Af,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new Zy(e.encoding),this.encoding=e.encoding)}function $r(e){if(!(this instanceof $r))return new $r(e);this._readableState=new M7(e,this),this.readable=!0,e&&typeof e.read=="function"&&(this._read=e.read),Fo.call(this)}function F6(e,t,o,i,c){var u=function(_,b){var S=null;return X0(b)||typeof b=="string"||b==null||_.objectMode||(S=new TypeError("Invalid non-string/buffer chunk")),S}(t,o);if(u)e.emit("error",u);else if(o===null)t.reading=!1,function(_,b){if(!b.ended){if(b.decoder){var S=b.decoder.end();S&&S.length&&(b.buffer.push(S),b.length+=b.objectMode?1:S.length)}b.ended=!0,PE(_)}}(e,t);else if(t.objectMode||o&&o.length>0)if(t.ended&&!c){var f=new Error("stream.push() after EOF");e.emit("error",f)}else if(t.endEmitted&&c){var p=new Error("stream.unshift() after end event");e.emit("error",p)}else{var v;!t.decoder||c||i||(o=t.decoder.write(o),v=!t.objectMode&&o.length===0),c||(t.reading=!1),v||(t.flowing&&t.length===0&&!t.sync?(e.emit("data",o),e.read(0)):(t.length+=t.objectMode?1:o.length,c?t.buffer.unshift(o):t.buffer.push(o),t.needReadable&&PE(e))),function(_,b){b.readingMore||(b.readingMore=!0,ki(lue,_,b))}(e,t)}else c||(t.reading=!1);return function(_){return!_.ended&&(_.needReadable||_.length<_.highWaterMark||_.length===0)}(t)}Ma($r,Fo),$r.prototype.push=function(e,t){var o=this._readableState;return o.objectMode||typeof e!="string"||(t=t||o.defaultEncoding)!==o.encoding&&(e=Ot.from(e,t),t=""),F6(this,o,e,t,!1)},$r.prototype.unshift=function(e){return F6(this,this._readableState,e,"",!0)},$r.prototype.isPaused=function(){return this._readableState.flowing===!1},$r.prototype.setEncoding=function(e){return this._readableState.decoder=new Zy(e),this._readableState.encoding=e,this};var V6=8388608;function G6(e,t){return e<=0||t.length===0&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(o){return o>=V6?o=V6:(o--,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,o|=o>>>16,o++),o}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function PE(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Qo("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?ki(B6,e):B6(e))}function B6(e){Qo("emit readable"),e.emit("readable"),RL(e)}function lue(e,t){for(var o=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Qo("maybeReadMore read 0"),e.read(0),o!==t.length);)o=t.length;t.readingMore=!1}function cue(e){Qo("readable nexttick read 0"),e.read(0)}function uue(e,t){t.reading||(Qo("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),RL(e),t.flowing&&!t.reading&&e.read(0)}function RL(e){var t=e._readableState;for(Qo("flow",t.flowing);t.flowing&&e.read()!==null;);}function H6(e,t){return t.length===0?null:(t.objectMode?o=t.buffer.shift():!e||e>=t.length?(o=t.decoder?t.buffer.join(""):t.buffer.length===1?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):o=function(i,c,u){var f;return i<c.head.data.length?(f=c.head.data.slice(0,i),c.head.data=c.head.data.slice(i)):f=i===c.head.data.length?c.shift():u?function(p,v){var _=v.head,b=1,S=_.data;for(p-=S.length;_=_.next;){var k=_.data,M=p>k.length?k.length:p;if(M===k.length?S+=k:S+=k.slice(0,p),(p-=M)===0){M===k.length?(++b,_.next?v.head=_.next:v.head=v.tail=null):(v.head=_,_.data=k.slice(M));break}++b}return v.length-=b,S}(i,c):function(p,v){var _=Ot.allocUnsafe(p),b=v.head,S=1;for(b.data.copy(_),p-=b.data.length;b=b.next;){var k=b.data,M=p>k.length?k.length:p;if(k.copy(_,_.length-p,0,M),(p-=M)===0){M===k.length?(++S,b.next?v.head=b.next:v.head=v.tail=null):(v.head=b,b.data=k.slice(M));break}++S}return v.length-=S,_}(i,c),f}(e,t.buffer,t.decoder),o);var o}function kA(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,ki(due,t,e))}function due(e,t){e.endEmitted||e.length!==0||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function $6(e,t){for(var o=0,i=e.length;o<i;o++)if(e[o]===t)return o;return-1}function hue(){}function fue(e,t,o){this.chunk=e,this.encoding=t,this.callback=o,this.next=null}function UD(e,t){Object.defineProperty(this,"buffer",{get:S7(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Ms&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var o=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=o||o===0?o:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var c=e.decodeStrings===!1;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(u){(function(f,p){var v=f._writableState,_=v.sync,b=v.writecb;if(function(k){k.writing=!1,k.writecb=null,k.length-=k.writelen,k.writelen=0}(v),p)(function(k,M,R,w,E){--M.pendingcb,R?ki(E,w):E(w),k._writableState.errorEmitted=!0,k.emit("error",w)})(f,v,_,p,b);else{var S=w7(v);S||v.corked||v.bufferProcessing||!v.bufferedRequest||k7(f,v),_?ki(q6,f,v,S,b):q6(f,v,S,b)}})(t,u)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new A7(this)}function Ki(e){if(!(this instanceof Ki||this instanceof Ms))return new Ki(e);this._writableState=new UD(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev)),Fo.call(this)}function FD(e,t,o,i,c,u,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,o?e._writev(c,t.onwrite):e._write(c,u,t.onwrite),t.sync=!1}function q6(e,t,o,i){o||function(c,u){u.length===0&&u.needDrain&&(u.needDrain=!1,c.emit("drain"))}(e,t),t.pendingcb--,i(),R7(e,t)}function k7(e,t){t.bufferProcessing=!0;var o=t.bufferedRequest;if(e._writev&&o&&o.next){var i=t.bufferedRequestCount,c=new Array(i),u=t.corkedRequestsFree;u.entry=o;for(var f=0;o;)c[f]=o,o=o.next,f+=1;FD(e,t,!0,t.length,c,"",u.finish),t.pendingcb++,t.lastBufferedRequest=null,u.next?(t.corkedRequestsFree=u.next,u.next=null):t.corkedRequestsFree=new A7(t)}else{for(;o;){var p=o.chunk,v=o.encoding,_=o.callback;if(FD(e,t,!1,t.objectMode?1:p.length,p,v,_),o=o.next,t.writing)break}o===null&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=o,t.bufferProcessing=!1}function w7(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function K6(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function R7(e,t){var o=w7(t);return o&&(t.pendingcb===0?(K6(e,t),t.finished=!0,e.emit("finish")):K6(e,t)),o}function A7(e){var t=this;this.next=null,this.entry=null,this.finish=function(o){var i=t.entry;for(t.entry=null;i;){var c=i.callback;e.pendingcb--,c(o),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}$r.prototype.read=function(e){Qo("read",e),e=parseInt(e,10);var t=this._readableState,o=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Qo("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?kA(this):PE(this),null;if((e=G6(e,t))===0&&t.ended)return t.length===0&&kA(this),null;var i,c=t.needReadable;return Qo("need readable",c),(t.length===0||t.length-e<t.highWaterMark)&&Qo("length less than watermark",c=!0),t.ended||t.reading?Qo("reading or ended",c=!1):c&&(Qo("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=G6(o,t))),(i=e>0?H6(e,t):null)===null?(t.needReadable=!0,e=0):t.length-=e,t.length===0&&(t.ended||(t.needReadable=!0),o!==e&&t.ended&&kA(this)),i!==null&&this.emit("data",i),i},$r.prototype._read=function(e){this.emit("error",new Error("not implemented"))},$r.prototype.pipe=function(e,t){var o=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,Qo("pipe count=%d opts=%j",i.pipesCount,t);var c=!t||t.end!==!1?f:_;function u(E){Qo("onunpipe"),E===o&&_()}function f(){Qo("onend"),e.end()}i.endEmitted?ki(c):o.once("end",c),e.on("unpipe",u);var p=function(E){return function(){var N=E._readableState;Qo("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&E.listeners("data").length&&(N.flowing=!0,RL(E))}}(o);e.on("drain",p);var v=!1;function _(){Qo("cleanup"),e.removeListener("close",M),e.removeListener("finish",R),e.removeListener("drain",p),e.removeListener("error",k),e.removeListener("unpipe",u),o.removeListener("end",f),o.removeListener("end",_),o.removeListener("data",S),v=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||p()}var b=!1;function S(E){Qo("ondata"),b=!1,e.write(E)!==!1||b||((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&$6(i.pipes,e)!==-1)&&!v&&(Qo("false write response, pause",o._readableState.awaitDrain),o._readableState.awaitDrain++,b=!0),o.pause())}function k(E){var N;Qo("onerror",E),w(),e.removeListener("error",k),N="error",e.listeners(N).length===0&&e.emit("error",E)}function M(){e.removeListener("finish",R),w()}function R(){Qo("onfinish"),e.removeListener("close",M),w()}function w(){Qo("unpipe"),o.unpipe(e)}return o.on("data",S),function(E,N,F){if(typeof E.prependListener=="function")return E.prependListener(N,F);E._events&&E._events[N]?Array.isArray(E._events[N])?E._events[N].unshift(F):E._events[N]=[F,E._events[N]]:E.on(N,F)}(e,"error",k),e.once("close",M),e.once("finish",R),e.emit("pipe",o),i.flowing||(Qo("pipe resume"),o.resume()),e},$r.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var o=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var c=0;c<i;c++)o[c].emit("unpipe",this);return this}var u=$6(t.pipes,e);return u===-1?this:(t.pipes.splice(u,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},$r.prototype.on=function(e,t){var o=Fo.prototype.on.call(this,e,t);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&PE(this):ki(cue,this))}return o},$r.prototype.addListener=$r.prototype.on,$r.prototype.resume=function(){var e=this._readableState;return e.flowing||(Qo("resume"),e.flowing=!0,function(t,o){o.resumeScheduled||(o.resumeScheduled=!0,ki(uue,t,o))}(this,e)),this},$r.prototype.pause=function(){return Qo("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Qo("pause"),this._readableState.flowing=!1,this.emit("pause")),this},$r.prototype.wrap=function(e){var t=this._readableState,o=!1,i=this;for(var c in e.on("end",function(){if(Qo("wrapped end"),t.decoder&&!t.ended){var u=t.decoder.end();u&&u.length&&i.push(u)}i.push(null)}),e.on("data",function(u){Qo("wrapped data"),t.decoder&&(u=t.decoder.write(u)),t.objectMode&&u==null||(t.objectMode||u&&u.length)&&(i.push(u)||(o=!0,e.pause()))}),e)this[c]===void 0&&typeof e[c]=="function"&&(this[c]=function(u){return function(){return e[u].apply(e,arguments)}}(c));return function(u,f){for(var p=0,v=u.length;p<v;p++)f(u[p],p)}(["error","close","destroy","pause","resume"],function(u){e.on(u,i.emit.bind(i,u))}),i._read=function(u){Qo("wrapped _read",u),o&&(o=!1,e.resume())},i},$r._fromList=H6,Ki.WritableState=UD,Ma(Ki,Fo),UD.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Ki.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Ki.prototype.write=function(e,t,o){var i=this._writableState,c=!1;return typeof t=="function"&&(o=t,t=null),Ot.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),typeof o!="function"&&(o=hue),i.ended?function(u,f){var p=new Error("write after end");u.emit("error",p),ki(f,p)}(this,o):function(u,f,p,v){var _=!0,b=!1;return p===null?b=new TypeError("May not write null values to stream"):Ot.isBuffer(p)||typeof p=="string"||p===void 0||f.objectMode||(b=new TypeError("Invalid non-string/buffer chunk")),b&&(u.emit("error",b),ki(v,b),_=!1),_}(this,i,e,o)&&(i.pendingcb++,c=function(u,f,p,v,_){p=function(M,R,w){return M.objectMode||M.decodeStrings===!1||typeof R!="string"||(R=Ot.from(R,w)),R}(f,p,v),Ot.isBuffer(p)&&(v="buffer");var b=f.objectMode?1:p.length;f.length+=b;var S=f.length<f.highWaterMark;if(S||(f.needDrain=!0),f.writing||f.corked){var k=f.lastBufferedRequest;f.lastBufferedRequest=new fue(p,v,_),k?k.next=f.lastBufferedRequest:f.bufferedRequest=f.lastBufferedRequest,f.bufferedRequestCount+=1}else FD(u,f,!1,b,p,v,_);return S}(this,i,e,t,o)),c},Ki.prototype.cork=function(){this._writableState.corked++},Ki.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||k7(this,e))},Ki.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Ki.prototype._write=function(e,t,o){o(new Error("not implemented"))},Ki.prototype._writev=null,Ki.prototype.end=function(e,t,o){var i=this._writableState;typeof e=="function"?(o=e,e=null,t=null):typeof t=="function"&&(o=t,t=null),e!=null&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(c,u,f){u.ending=!0,R7(c,u),f&&(u.finished?ki(f):c.once("finish",f)),u.ended=!0,c.writable=!1}(this,i,o)},Ma(Ms,$r);for(var z6=Object.keys(Ki.prototype),wA=0;wA<z6.length;wA++){var RA=z6[wA];Ms.prototype[RA]||(Ms.prototype[RA]=Ki.prototype[RA])}function Ms(e){if(!(this instanceof Ms))return new Ms(e);$r.call(this,e),Ki.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",pue)}function pue(){this.allowHalfOpen||this._writableState.ended||ki(mue,this)}function mue(e){e.end()}function gue(e){this.afterTransform=function(t,o){return function(i,c,u){var f=i._transformState;f.transforming=!1;var p=f.writecb;if(!p)return i.emit("error",new Error("no writecb in Transform class"));f.writechunk=null,f.writecb=null,u!=null&&i.push(u),p(c);var v=i._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&i._read(v.highWaterMark)}(e,t,o)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Is(e){if(!(this instanceof Is))return new Is(e);Ms.call(this,e),this._transformState=new gue(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(o){W6(t,o)}):W6(t)})}function W6(e,t){if(t)return e.emit("error",t);var o=e._writableState,i=e._transformState;if(o.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Qy(e){if(!(this instanceof Qy))return new Qy(e);Is.call(this,e)}function Bc(){Fo.call(this)}Ma(Is,Ms),Is.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ms.prototype.push.call(this,e,t)},Is.prototype._transform=function(e,t,o){throw new Error("Not implemented")},Is.prototype._write=function(e,t,o){var i=this._transformState;if(i.writecb=o,i.writechunk=e,i.writeencoding=t,!i.transforming){var c=this._readableState;(i.needTransform||c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}},Is.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Ma(Qy,Is),Qy.prototype._transform=function(e,t,o){o(null,e)},Ma(Bc,Fo),Bc.Readable=$r,Bc.Writable=Ki,Bc.Duplex=Ms,Bc.Transform=Is,Bc.PassThrough=Qy,Bc.Stream=Bc,Bc.prototype.pipe=function(e,t){var o=this;function i(b){e.writable&&e.write(b)===!1&&o.pause&&o.pause()}function c(){o.readable&&o.resume&&o.resume()}o.on("data",i),e.on("drain",c),e._isStdio||t&&t.end===!1||(o.on("end",f),o.on("close",p));var u=!1;function f(){u||(u=!0,e.end())}function p(){u||(u=!0,typeof e.destroy=="function"&&e.destroy())}function v(b){if(_(),Fo.listenerCount(this,"error")===0)throw b}function _(){o.removeListener("data",i),e.removeListener("drain",c),o.removeListener("end",f),o.removeListener("close",p),o.removeListener("error",v),e.removeListener("error",v),o.removeListener("end",_),o.removeListener("close",_),e.removeListener("close",_)}return o.on("error",v),e.on("error",v),o.on("end",_),o.on("close",_),e.on("close",_),e.emit("pipe",o),e};var D7={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function vue(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function jc(e,t,o,i,c){if(t.subarray&&e.subarray)e.set(t.subarray(o,o+i),c);else for(var u=0;u<i;u++)e[c+u]=t[o+u]}var xE=Uint8Array,Cs=Uint16Array,UE=Int32Array,_ue=4,j6=0,Y6=1,yue=2;function cv(e){for(var t=e.length;--t>=0;)e[t]=0}var Iue=0,O7=1,bue=2,AL=29,eI=256,S0=eI+1+AL,wg=30,DL=19,J6=2*S0+1,Vf=15,AA=16,Cue=7,OL=256,L7=16,N7=17,P7=18,VD=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],rE=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Sue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],X6=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],zc=new Array(2*(S0+2));cv(zc);var e0=new Array(2*wg);cv(e0);var E0=new Array(512);cv(E0);var T0=new Array(256);cv(T0);var LL=new Array(AL);cv(LL);var Z6,Q6,e5,FE=new Array(wg);function DA(e,t,o,i,c){this.static_tree=e,this.extra_bits=t,this.extra_base=o,this.elems=i,this.max_length=c,this.has_stree=e&&e.length}function OA(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x7(e){return e<256?E0[e]:E0[256+(e>>>7)]}function M0(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function ka(e,t,o){e.bi_valid>AA-o?(e.bi_buf|=t<<e.bi_valid&65535,M0(e,e.bi_buf),e.bi_buf=t>>AA-e.bi_valid,e.bi_valid+=o-AA):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=o)}function jl(e,t,o){ka(e,o[2*t],o[2*t+1])}function U7(e,t){var o=0;do o|=1&e,e>>>=1,o<<=1;while(--t>0);return o>>>1}function F7(e,t,o){var i,c,u=new Array(Vf+1),f=0;for(i=1;i<=Vf;i++)u[i]=f=f+o[i-1]<<1;for(c=0;c<=t;c++){var p=e[2*c+1];p!==0&&(e[2*c]=U7(u[p]++,p))}}function V7(e){var t;for(t=0;t<S0;t++)e.dyn_ltree[2*t]=0;for(t=0;t<wg;t++)e.dyn_dtree[2*t]=0;for(t=0;t<DL;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*OL]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function G7(e){e.bi_valid>8?M0(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function t5(e,t,o,i){var c=2*t,u=2*o;return e[c]<e[u]||e[c]===e[u]&&i[t]<=i[o]}function LA(e,t,o){for(var i=e.heap[o],c=o<<1;c<=e.heap_len&&(c<e.heap_len&&t5(t,e.heap[c+1],e.heap[c],e.depth)&&c++,!t5(t,i,e.heap[c],e.depth));)e.heap[o]=e.heap[c],o=c,c<<=1;e.heap[o]=i}function n5(e,t,o){var i,c,u,f,p=0;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+2*p]<<8|e.pending_buf[e.d_buf+2*p+1],c=e.pending_buf[e.l_buf+p],p++,i===0?jl(e,c,t):(jl(e,(u=T0[c])+eI+1,t),(f=VD[u])!==0&&ka(e,c-=LL[u],f),jl(e,u=x7(--i),o),(f=rE[u])!==0&&ka(e,i-=FE[u],f));while(p<e.last_lit);jl(e,OL,t)}function NA(e,t){var o,i,c,u=t.dyn_tree,f=t.stat_desc.static_tree,p=t.stat_desc.has_stree,v=t.stat_desc.elems,_=-1;for(e.heap_len=0,e.heap_max=J6,o=0;o<v;o++)u[2*o]!==0?(e.heap[++e.heap_len]=_=o,e.depth[o]=0):u[2*o+1]=0;for(;e.heap_len<2;)u[2*(c=e.heap[++e.heap_len]=_<2?++_:0)]=1,e.depth[c]=0,e.opt_len--,p&&(e.static_len-=f[2*c+1]);for(t.max_code=_,o=e.heap_len>>1;o>=1;o--)LA(e,u,o);c=v;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],LA(e,u,1),i=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=i,u[2*c]=u[2*o]+u[2*i],e.depth[c]=(e.depth[o]>=e.depth[i]?e.depth[o]:e.depth[i])+1,u[2*o+1]=u[2*i+1]=c,e.heap[1]=c++,LA(e,u,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(b,S){var k,M,R,w,E,N,F=S.dyn_tree,x=S.max_code,P=S.stat_desc.static_tree,G=S.stat_desc.has_stree,H=S.stat_desc.extra_bits,Y=S.stat_desc.extra_base,j=S.stat_desc.max_length,W=0;for(w=0;w<=Vf;w++)b.bl_count[w]=0;for(F[2*b.heap[b.heap_max]+1]=0,k=b.heap_max+1;k<J6;k++)(w=F[2*F[2*(M=b.heap[k])+1]+1]+1)>j&&(w=j,W++),F[2*M+1]=w,M>x||(b.bl_count[w]++,E=0,M>=Y&&(E=H[M-Y]),N=F[2*M],b.opt_len+=N*(w+E),G&&(b.static_len+=N*(P[2*M+1]+E)));if(W!==0){do{for(w=j-1;b.bl_count[w]===0;)w--;b.bl_count[w]--,b.bl_count[w+1]+=2,b.bl_count[j]--,W-=2}while(W>0);for(w=j;w!==0;w--)for(M=b.bl_count[w];M!==0;)(R=b.heap[--k])>x||(F[2*R+1]!==w&&(b.opt_len+=(w-F[2*R+1])*F[2*R],F[2*R+1]=w),M--)}}(e,t),F7(u,_,e.bl_count)}function o5(e,t,o){var i,c,u=-1,f=t[1],p=0,v=7,_=4;for(f===0&&(v=138,_=3),t[2*(o+1)+1]=65535,i=0;i<=o;i++)c=f,f=t[2*(i+1)+1],++p<v&&c===f||(p<_?e.bl_tree[2*c]+=p:c!==0?(c!==u&&e.bl_tree[2*c]++,e.bl_tree[2*L7]++):p<=10?e.bl_tree[2*N7]++:e.bl_tree[2*P7]++,p=0,u=c,f===0?(v=138,_=3):c===f?(v=6,_=3):(v=7,_=4))}function r5(e,t,o){var i,c,u=-1,f=t[1],p=0,v=7,_=4;for(f===0&&(v=138,_=3),i=0;i<=o;i++)if(c=f,f=t[2*(i+1)+1],!(++p<v&&c===f)){if(p<_)do jl(e,c,e.bl_tree);while(--p!=0);else c!==0?(c!==u&&(jl(e,c,e.bl_tree),p--),jl(e,L7,e.bl_tree),ka(e,p-3,2)):p<=10?(jl(e,N7,e.bl_tree),ka(e,p-3,3)):(jl(e,P7,e.bl_tree),ka(e,p-11,7));p=0,u=c,f===0?(v=138,_=3):c===f?(v=6,_=3):(v=7,_=4)}}cv(FE);var i5=!1;function Eue(e){i5||(function(){var t,o,i,c,u,f=new Array(Vf+1);for(i=0,c=0;c<AL-1;c++)for(LL[c]=i,t=0;t<1<<VD[c];t++)T0[i++]=c;for(T0[i-1]=c,u=0,c=0;c<16;c++)for(FE[c]=u,t=0;t<1<<rE[c];t++)E0[u++]=c;for(u>>=7;c<wg;c++)for(FE[c]=u<<7,t=0;t<1<<rE[c]-7;t++)E0[256+u++]=c;for(o=0;o<=Vf;o++)f[o]=0;for(t=0;t<=143;)zc[2*t+1]=8,t++,f[8]++;for(;t<=255;)zc[2*t+1]=9,t++,f[9]++;for(;t<=279;)zc[2*t+1]=7,t++,f[7]++;for(;t<=287;)zc[2*t+1]=8,t++,f[8]++;for(F7(zc,S0+1,f),t=0;t<wg;t++)e0[2*t+1]=5,e0[2*t]=U7(t,5);Z6=new DA(zc,VD,eI+1,S0,Vf),Q6=new DA(e0,rE,0,wg,Vf),e5=new DA(new Array(0),Sue,0,DL,Cue)}(),i5=!0),e.l_desc=new OA(e.dyn_ltree,Z6),e.d_desc=new OA(e.dyn_dtree,Q6),e.bl_desc=new OA(e.bl_tree,e5),e.bi_buf=0,e.bi_valid=0,V7(e)}function B7(e,t,o,i){ka(e,(Iue<<1)+(i?1:0),3),function(c,u,f,p){G7(c),M0(c,f),M0(c,~f),jc(c.pending_buf,c.window,u,f,c.pending),c.pending+=f}(e,t,o)}function Tue(e){ka(e,O7<<1,3),jl(e,OL,zc),function(t){t.bi_valid===16?(M0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(e)}function Mue(e,t,o,i){var c,u,f=0;e.level>0?(e.strm.data_type===yue&&(e.strm.data_type=function(p){var v,_=4093624447;for(v=0;v<=31;v++,_>>>=1)if(1&_&&p.dyn_ltree[2*v]!==0)return j6;if(p.dyn_ltree[18]!==0||p.dyn_ltree[20]!==0||p.dyn_ltree[26]!==0)return Y6;for(v=32;v<eI;v++)if(p.dyn_ltree[2*v]!==0)return Y6;return j6}(e)),NA(e,e.l_desc),NA(e,e.d_desc),f=function(p){var v;for(o5(p,p.dyn_ltree,p.l_desc.max_code),o5(p,p.dyn_dtree,p.d_desc.max_code),NA(p,p.bl_desc),v=DL-1;v>=3&&p.bl_tree[2*X6[v]+1]===0;v--);return p.opt_len+=3*(v+1)+5+5+4,v}(e),c=e.opt_len+3+7>>>3,(u=e.static_len+3+7>>>3)<=c&&(c=u)):c=u=o+5,o+4<=c&&t!==-1?B7(e,t,o,i):e.strategy===_ue||u===c?(ka(e,(O7<<1)+(i?1:0),3),n5(e,zc,e0)):(ka(e,(bue<<1)+(i?1:0),3),function(p,v,_,b){var S;for(ka(p,v-257,5),ka(p,_-1,5),ka(p,b-4,4),S=0;S<b;S++)ka(p,p.bl_tree[2*X6[S]+1],3);r5(p,p.dyn_ltree,v-1),r5(p,p.dyn_dtree,_-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,f+1),n5(e,e.dyn_ltree,e.dyn_dtree)),V7(e),i&&G7(e)}function Gd(e,t,o){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&o,e.last_lit++,t===0?e.dyn_ltree[2*o]++:(e.matches++,t--,e.dyn_ltree[2*(T0[o]+eI+1)]++,e.dyn_dtree[2*x7(t)]++),e.last_lit===e.lit_bufsize-1}function GD(e,t,o,i){for(var c=65535&e|0,u=e>>>16&65535|0,f=0;o!==0;){o-=f=o>2e3?2e3:o;do u=u+(c=c+t[i++]|0)|0;while(--f);c%=65521,u%=65521}return c|u<<16|0}var kue=function(){for(var e,t=[],o=0;o<256;o++){e=o;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[o]=e}return t}();function yi(e,t,o,i){var c=kue,u=i+o;e^=-1;for(var f=i;f<u;f++)e=e>>>8^c[255&(e^t[f])];return-1^e}var yg,np=0,wue=1,Rue=3,Dd=4,a5=5,Lf=0,s5=1,op=-2,Aue=-3,PA=-5,Due=-1,Oue=1,RS=2,Lue=3,Nue=4,Pue=2,NL=8,xue=9,BD=286,Uue=30,Fue=19,Vue=2*BD+1,Gue=15,Jo=3,Ld=258,sl=Ld+Jo+1,Bue=32,PL=42,HD=69,iE=73,aE=91,sE=103,Gf=113,Uy=666,Ii=1,t0=2,Bf=3,Rg=4,Hue=3;function Nd(e,t){return e.msg=D7[t],t}function l5(e){return(e<<1)-(e>4?9:0)}function Nf(e){for(var t=e.length;--t>=0;)e[t]=0}function Cd(e){var t=e.state,o=t.pending;o>e.avail_out&&(o=e.avail_out),o!==0&&(jc(e.output,t.pending_buf,t.pending_out,o,e.next_out),e.next_out+=o,t.pending_out+=o,e.total_out+=o,e.avail_out-=o,t.pending-=o,t.pending===0&&(t.pending_out=0))}function wi(e,t){Mue(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Cd(e.strm)}function zo(e,t){e.pending_buf[e.pending++]=t}function Ay(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function H7(e,t){var o,i,c=e.max_chain_length,u=e.strstart,f=e.prev_length,p=e.nice_match,v=e.strstart>e.w_size-sl?e.strstart-(e.w_size-sl):0,_=e.window,b=e.w_mask,S=e.prev,k=e.strstart+Ld,M=_[u+f-1],R=_[u+f];e.prev_length>=e.good_match&&(c>>=2),p>e.lookahead&&(p=e.lookahead);do if(_[(o=t)+f]===R&&_[o+f-1]===M&&_[o]===_[u]&&_[++o]===_[u+1]){u+=2,o++;do;while(_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&_[++u]===_[++o]&&u<k);if(i=Ld-(k-u),u=k-Ld,i>f){if(e.match_start=t,f=i,i>=p)break;M=_[u+f-1],R=_[u+f]}}while((t=S[t&b])>v&&--c!=0);return f<=e.lookahead?f:e.lookahead}function k0(e){var t,o,i,c,u,f,p,v,_,b,S=e.w_size;do{if(c=e.window_size-e.lookahead-e.strstart,e.strstart>=S+(S-sl)){jc(e.window,e.window,S,S,0),e.match_start-=S,e.strstart-=S,e.block_start-=S,t=o=e.hash_size;do i=e.head[--t],e.head[t]=i>=S?i-S:0;while(--o);t=o=S;do i=e.prev[--t],e.prev[t]=i>=S?i-S:0;while(--o);c+=S}if(e.strm.avail_in===0)break;if(f=e.strm,p=e.window,v=e.strstart+e.lookahead,_=c,b=void 0,(b=f.avail_in)>_&&(b=_),o=b===0?0:(f.avail_in-=b,jc(p,f.input,f.next_in,b,v),f.state.wrap===1?f.adler=GD(f.adler,p,b,v):f.state.wrap===2&&(f.adler=yi(f.adler,p,b,v)),f.next_in+=b,f.total_in+=b,b),e.lookahead+=o,e.lookahead+e.insert>=Jo)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+Jo-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<Jo)););}while(e.lookahead<sl&&e.strm.avail_in!==0)}function xA(e,t){for(var o,i;;){if(e.lookahead<sl){if(k0(e),e.lookahead<sl&&t===np)return Ii;if(e.lookahead===0)break}if(o=0,e.lookahead>=Jo&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),o!==0&&e.strstart-o<=e.w_size-sl&&(e.match_length=H7(e,o)),e.match_length>=Jo)if(i=Gd(e,e.strstart-e.match_start,e.match_length-Jo),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Jo){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=Gd(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(wi(e,!1),e.strm.avail_out===0))return Ii}return e.insert=e.strstart<Jo-1?e.strstart:Jo-1,t===Dd?(wi(e,!0),e.strm.avail_out===0?Bf:Rg):e.last_lit&&(wi(e,!1),e.strm.avail_out===0)?Ii:t0}function ig(e,t){for(var o,i,c;;){if(e.lookahead<sl){if(k0(e),e.lookahead<sl&&t===np)return Ii;if(e.lookahead===0)break}if(o=0,e.lookahead>=Jo&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Jo-1,o!==0&&e.prev_length<e.max_lazy_match&&e.strstart-o<=e.w_size-sl&&(e.match_length=H7(e,o),e.match_length<=5&&(e.strategy===Oue||e.match_length===Jo&&e.strstart-e.match_start>4096)&&(e.match_length=Jo-1)),e.prev_length>=Jo&&e.match_length<=e.prev_length){c=e.strstart+e.lookahead-Jo,i=Gd(e,e.strstart-1-e.prev_match,e.prev_length-Jo),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=c&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jo-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=Jo-1,e.strstart++,i&&(wi(e,!1),e.strm.avail_out===0))return Ii}else if(e.match_available){if((i=Gd(e,0,e.window[e.strstart-1]))&&wi(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Ii}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Gd(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Jo-1?e.strstart:Jo-1,t===Dd?(wi(e,!0),e.strm.avail_out===0?Bf:Rg):e.last_lit&&(wi(e,!1),e.strm.avail_out===0)?Ii:t0}function Hl(e,t,o,i,c){this.good_length=e,this.max_lazy=t,this.nice_length=o,this.max_chain=i,this.func=c}function $ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=NL,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Cs(2*Vue),this.dyn_dtree=new Cs(2*(2*Uue+1)),this.bl_tree=new Cs(2*(2*Fue+1)),Nf(this.dyn_ltree),Nf(this.dyn_dtree),Nf(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Cs(Gue+1),this.heap=new Cs(2*BD+1),Nf(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Cs(2*BD+1),Nf(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function c5(e){var t,o=function(i){var c;return i&&i.state?(i.total_in=i.total_out=0,i.data_type=Pue,(c=i.state).pending=0,c.pending_out=0,c.wrap<0&&(c.wrap=-c.wrap),c.status=c.wrap?PL:Gf,i.adler=c.wrap===2?0:1,c.last_flush=np,Eue(c),Lf):Nd(i,op)}(e);return o===Lf&&((t=e.state).window_size=2*t.w_size,Nf(t.head),t.max_lazy_match=yg[t.level].max_lazy,t.good_match=yg[t.level].good_length,t.nice_match=yg[t.level].nice_length,t.max_chain_length=yg[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Jo-1,t.match_available=0,t.ins_h=0),o}function que(e,t){var o,i,c,u;if(!e||!e.state||t>a5||t<0)return e?Nd(e,op):op;if(i=e.state,!e.output||!e.input&&e.avail_in!==0||i.status===Uy&&t!==Dd)return Nd(e,e.avail_out===0?PA:op);if(i.strm=e,o=i.last_flush,i.last_flush=t,i.status===PL)if(i.wrap===2)e.adler=0,zo(i,31),zo(i,139),zo(i,8),i.gzhead?(zo(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),zo(i,255&i.gzhead.time),zo(i,i.gzhead.time>>8&255),zo(i,i.gzhead.time>>16&255),zo(i,i.gzhead.time>>24&255),zo(i,i.level===9?2:i.strategy>=RS||i.level<2?4:0),zo(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(zo(i,255&i.gzhead.extra.length),zo(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=yi(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=HD):(zo(i,0),zo(i,0),zo(i,0),zo(i,0),zo(i,0),zo(i,i.level===9?2:i.strategy>=RS||i.level<2?4:0),zo(i,Hue),i.status=Gf);else{var f=NL+(i.w_bits-8<<4)<<8;f|=(i.strategy>=RS||i.level<2?0:i.level<6?1:i.level===6?2:3)<<6,i.strstart!==0&&(f|=Bue),f+=31-f%31,i.status=Gf,Ay(i,f),i.strstart!==0&&(Ay(i,e.adler>>>16),Ay(i,65535&e.adler)),e.adler=1}if(i.status===HD)if(i.gzhead.extra){for(c=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),Cd(e),c=i.pending,i.pending!==i.pending_buf_size));)zo(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=iE)}else i.status=iE;if(i.status===iE)if(i.gzhead.name){c=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),Cd(e),c=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,zo(i,u)}while(u!==0);i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),u===0&&(i.gzindex=0,i.status=aE)}else i.status=aE;if(i.status===aE)if(i.gzhead.comment){c=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),Cd(e),c=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,zo(i,u)}while(u!==0);i.gzhead.hcrc&&i.pending>c&&(e.adler=yi(e.adler,i.pending_buf,i.pending-c,c)),u===0&&(i.status=sE)}else i.status=sE;if(i.status===sE&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Cd(e),i.pending+2<=i.pending_buf_size&&(zo(i,255&e.adler),zo(i,e.adler>>8&255),e.adler=0,i.status=Gf)):i.status=Gf),i.pending!==0){if(Cd(e),e.avail_out===0)return i.last_flush=-1,Lf}else if(e.avail_in===0&&l5(t)<=l5(o)&&t!==Dd)return Nd(e,PA);if(i.status===Uy&&e.avail_in!==0)return Nd(e,PA);if(e.avail_in!==0||i.lookahead!==0||t!==np&&i.status!==Uy){var p=i.strategy===RS?function(v,_){for(var b;;){if(v.lookahead===0&&(k0(v),v.lookahead===0)){if(_===np)return Ii;break}if(v.match_length=0,b=Gd(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++,b&&(wi(v,!1),v.strm.avail_out===0))return Ii}return v.insert=0,_===Dd?(wi(v,!0),v.strm.avail_out===0?Bf:Rg):v.last_lit&&(wi(v,!1),v.strm.avail_out===0)?Ii:t0}(i,t):i.strategy===Lue?function(v,_){for(var b,S,k,M,R=v.window;;){if(v.lookahead<=Ld){if(k0(v),v.lookahead<=Ld&&_===np)return Ii;if(v.lookahead===0)break}if(v.match_length=0,v.lookahead>=Jo&&v.strstart>0&&(S=R[k=v.strstart-1])===R[++k]&&S===R[++k]&&S===R[++k]){M=v.strstart+Ld;do;while(S===R[++k]&&S===R[++k]&&S===R[++k]&&S===R[++k]&&S===R[++k]&&S===R[++k]&&S===R[++k]&&S===R[++k]&&k<M);v.match_length=Ld-(M-k),v.match_length>v.lookahead&&(v.match_length=v.lookahead)}if(v.match_length>=Jo?(b=Gd(v,1,v.match_length-Jo),v.lookahead-=v.match_length,v.strstart+=v.match_length,v.match_length=0):(b=Gd(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++),b&&(wi(v,!1),v.strm.avail_out===0))return Ii}return v.insert=0,_===Dd?(wi(v,!0),v.strm.avail_out===0?Bf:Rg):v.last_lit&&(wi(v,!1),v.strm.avail_out===0)?Ii:t0}(i,t):yg[i.level].func(i,t);if(p!==Bf&&p!==Rg||(i.status=Uy),p===Ii||p===Bf)return e.avail_out===0&&(i.last_flush=-1),Lf;if(p===t0&&(t===wue?Tue(i):t!==a5&&(B7(i,0,0,!1),t===Rue&&(Nf(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Cd(e),e.avail_out===0))return i.last_flush=-1,Lf}return t!==Dd?Lf:i.wrap<=0?s5:(i.wrap===2?(zo(i,255&e.adler),zo(i,e.adler>>8&255),zo(i,e.adler>>16&255),zo(i,e.adler>>24&255),zo(i,255&e.total_in),zo(i,e.total_in>>8&255),zo(i,e.total_in>>16&255),zo(i,e.total_in>>24&255)):(Ay(i,e.adler>>>16),Ay(i,65535&e.adler)),Cd(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Lf:s5)}yg=[new Hl(0,0,0,0,function(e,t){var o=65535;for(o>e.pending_buf_size-5&&(o=e.pending_buf_size-5);;){if(e.lookahead<=1){if(k0(e),e.lookahead===0&&t===np)return Ii;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+o;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,wi(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-sl&&(wi(e,!1),e.strm.avail_out===0))return Ii}return e.insert=0,t===Dd?(wi(e,!0),e.strm.avail_out===0?Bf:Rg):(e.strstart>e.block_start&&(wi(e,!1),e.strm.avail_out),Ii)}),new Hl(4,4,8,4,xA),new Hl(4,5,16,8,xA),new Hl(4,6,32,32,xA),new Hl(4,4,16,16,ig),new Hl(8,16,32,32,ig),new Hl(8,16,128,128,ig),new Hl(8,32,128,256,ig),new Hl(32,128,258,1024,ig),new Hl(32,258,258,4096,ig)];var AS=30,Kue=12;function zue(e,t){var o,i,c,u,f,p,v,_,b,S,k,M,R,w,E,N,F,x,P,G,H,Y,j,W,O;o=e.state,i=e.next_in,W=e.input,c=i+(e.avail_in-5),u=e.next_out,O=e.output,f=u-(t-e.avail_out),p=u+(e.avail_out-257),v=o.dmax,_=o.wsize,b=o.whave,S=o.wnext,k=o.window,M=o.hold,R=o.bits,w=o.lencode,E=o.distcode,N=(1<<o.lenbits)-1,F=(1<<o.distbits)-1;e:do{R<15&&(M+=W[i++]<<R,R+=8,M+=W[i++]<<R,R+=8),x=w[M&N];t:for(;;){if(M>>>=P=x>>>24,R-=P,(P=x>>>16&255)===0)O[u++]=65535&x;else{if(!(16&P)){if(!(64&P)){x=w[(65535&x)+(M&(1<<P)-1)];continue t}if(32&P){o.mode=Kue;break e}e.msg="invalid literal/length code",o.mode=AS;break e}G=65535&x,(P&=15)&&(R<P&&(M+=W[i++]<<R,R+=8),G+=M&(1<<P)-1,M>>>=P,R-=P),R<15&&(M+=W[i++]<<R,R+=8,M+=W[i++]<<R,R+=8),x=E[M&F];n:for(;;){if(M>>>=P=x>>>24,R-=P,!(16&(P=x>>>16&255))){if(!(64&P)){x=E[(65535&x)+(M&(1<<P)-1)];continue n}e.msg="invalid distance code",o.mode=AS;break e}if(H=65535&x,R<(P&=15)&&(M+=W[i++]<<R,(R+=8)<P&&(M+=W[i++]<<R,R+=8)),(H+=M&(1<<P)-1)>v){e.msg="invalid distance too far back",o.mode=AS;break e}if(M>>>=P,R-=P,H>(P=u-f)){if((P=H-P)>b&&o.sane){e.msg="invalid distance too far back",o.mode=AS;break e}if(Y=0,j=k,S===0){if(Y+=_-P,P<G){G-=P;do O[u++]=k[Y++];while(--P);Y=u-H,j=O}}else if(S<P){if(Y+=_+S-P,(P-=S)<G){G-=P;do O[u++]=k[Y++];while(--P);if(Y=0,S<G){G-=P=S;do O[u++]=k[Y++];while(--P);Y=u-H,j=O}}}else if(Y+=S-P,P<G){G-=P;do O[u++]=k[Y++];while(--P);Y=u-H,j=O}for(;G>2;)O[u++]=j[Y++],O[u++]=j[Y++],O[u++]=j[Y++],G-=3;G&&(O[u++]=j[Y++],G>1&&(O[u++]=j[Y++]))}else{Y=u-H;do O[u++]=O[Y++],O[u++]=O[Y++],O[u++]=O[Y++],G-=3;while(G>2);G&&(O[u++]=O[Y++],G>1&&(O[u++]=O[Y++]))}break}}break}}while(i<c&&u<p);i-=G=R>>3,M&=(1<<(R-=G<<3))-1,e.next_in=i,e.next_out=u,e.avail_in=i<c?c-i+5:5-(i-c),e.avail_out=u<p?p-u+257:257-(u-p),o.hold=M,o.bits=R}var ag=15,u5=852,d5=592,h5=0,UA=1,f5=2,Wue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],jue=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Yue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Jue=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function n0(e,t,o,i,c,u,f,p){var v,_,b,S,k,M,R,w,E,N=p.bits,F=0,x=0,P=0,G=0,H=0,Y=0,j=0,W=0,O=0,Q=0,J=null,oe=0,pe=new Cs(ag+1),ie=new Cs(ag+1),te=null,he=0;for(F=0;F<=ag;F++)pe[F]=0;for(x=0;x<i;x++)pe[t[o+x]]++;for(H=N,G=ag;G>=1&&pe[G]===0;G--);if(H>G&&(H=G),G===0)return c[u++]=20971520,c[u++]=20971520,p.bits=1,0;for(P=1;P<G&&pe[P]===0;P++);for(H<P&&(H=P),W=1,F=1;F<=ag;F++)if(W<<=1,(W-=pe[F])<0)return-1;if(W>0&&(e===h5||G!==1))return-1;for(ie[1]=0,F=1;F<ag;F++)ie[F+1]=ie[F]+pe[F];for(x=0;x<i;x++)t[o+x]!==0&&(f[ie[t[o+x]]++]=x);if(e===h5?(J=te=f,M=19):e===UA?(J=Wue,oe-=257,te=jue,he-=257,M=256):(J=Yue,te=Jue,M=-1),Q=0,x=0,F=P,k=u,Y=H,j=0,b=-1,S=(O=1<<H)-1,e===UA&&O>u5||e===f5&&O>d5)return 1;for(;;){R=F-j,f[x]<M?(w=0,E=f[x]):f[x]>M?(w=te[he+f[x]],E=J[oe+f[x]]):(w=96,E=0),v=1<<F-j,P=_=1<<Y;do c[k+(Q>>j)+(_-=v)]=R<<24|w<<16|E|0;while(_!==0);for(v=1<<F-1;Q&v;)v>>=1;if(v!==0?(Q&=v-1,Q+=v):Q=0,x++,--pe[F]==0){if(F===G)break;F=t[o+f[x]]}if(F>H&&(Q&S)!==b){for(j===0&&(j=H),k+=P,W=1<<(Y=F-j);Y+j<G&&!((W-=pe[Y+j])<=0);)Y++,W<<=1;if(O+=1<<Y,e===UA&&O>u5||e===f5&&O>d5)return 1;c[b=Q&S]=H<<24|Y<<16|k-u|0}}return Q!==0&&(c[k+Q]=F-j<<24|64<<16|0),p.bits=H,0}var Xue=0,$7=1,q7=2,p5=4,Zue=5,DS=6,VE=0,Que=1,ede=2,Bd=-2,tde=-3,nde=-4,ode=-5,m5=8,K7=1,g5=2,v5=3,_5=4,y5=5,I5=6,b5=7,C5=8,S5=9,E5=10,T5=11,Hc=12,FA=13,M5=14,VA=15,k5=16,w5=17,R5=18,A5=19,OS=20,LS=21,D5=22,O5=23,L5=24,N5=25,P5=26,GA=27,x5=28,U5=29,kr=30,rde=31,ide=32,ade=852,sde=592;function F5(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function lde(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Cs(320),this.work=new Cs(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function z7(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function(o){var i;return o&&o.state?(i=o.state,o.total_in=o.total_out=i.total=0,o.msg="",i.wrap&&(o.adler=1&i.wrap),i.mode=K7,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new UE(ade),i.distcode=i.distdyn=new UE(sde),i.sane=1,i.back=-1,VE):Bd}(e)):Bd}function cde(e,t){var o,i;return e?(i=new lde,e.state=i,i.window=null,(o=function(c,u){var f,p;return c&&c.state?(p=c.state,u<0?(f=0,u=-u):(f=1+(u>>4),u<48&&(u&=15)),u&&(u<8||u>15)?Bd:(p.window!==null&&p.wbits!==u&&(p.window=null),p.wrap=f,p.wbits=u,z7(c))):Bd}(e,t))!==VE&&(e.state=null),o):Bd}var BA,HA,V5=!0;function ude(e){if(V5){var t;for(BA=new UE(512),HA=new UE(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(n0($7,e.lens,0,288,BA,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;n0(q7,e.lens,0,32,HA,0,e.work,{bits:5}),V5=!1}e.lencode=BA,e.lenbits=9,e.distcode=HA,e.distbits=5}function dde(e,t){var o,i,c,u,f,p,v,_,b,S,k,M,R,w,E,N,F,x,P,G,H,Y,j,W,O=0,Q=new xE(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Bd;(o=e.state).mode===Hc&&(o.mode=FA),f=e.next_out,c=e.output,v=e.avail_out,u=e.next_in,i=e.input,p=e.avail_in,_=o.hold,b=o.bits,S=p,k=v,Y=VE;e:for(;;)switch(o.mode){case K7:if(o.wrap===0){o.mode=FA;break}for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(2&o.wrap&&_===35615){o.check=0,Q[0]=255&_,Q[1]=_>>>8&255,o.check=yi(o.check,Q,2,0),_=0,b=0,o.mode=g5;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&_)<<8)+(_>>8))%31){e.msg="incorrect header check",o.mode=kr;break}if((15&_)!==m5){e.msg="unknown compression method",o.mode=kr;break}if(b-=4,H=8+(15&(_>>>=4)),o.wbits===0)o.wbits=H;else if(H>o.wbits){e.msg="invalid window size",o.mode=kr;break}o.dmax=1<<H,e.adler=o.check=1,o.mode=512&_?E5:Hc,_=0,b=0;break;case g5:for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(o.flags=_,(255&o.flags)!==m5){e.msg="unknown compression method",o.mode=kr;break}if(57344&o.flags){e.msg="unknown header flags set",o.mode=kr;break}o.head&&(o.head.text=_>>8&1),512&o.flags&&(Q[0]=255&_,Q[1]=_>>>8&255,o.check=yi(o.check,Q,2,0)),_=0,b=0,o.mode=v5;case v5:for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.head&&(o.head.time=_),512&o.flags&&(Q[0]=255&_,Q[1]=_>>>8&255,Q[2]=_>>>16&255,Q[3]=_>>>24&255,o.check=yi(o.check,Q,4,0)),_=0,b=0,o.mode=_5;case _5:for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.head&&(o.head.xflags=255&_,o.head.os=_>>8),512&o.flags&&(Q[0]=255&_,Q[1]=_>>>8&255,o.check=yi(o.check,Q,2,0)),_=0,b=0,o.mode=y5;case y5:if(1024&o.flags){for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.length=_,o.head&&(o.head.extra_len=_),512&o.flags&&(Q[0]=255&_,Q[1]=_>>>8&255,o.check=yi(o.check,Q,2,0)),_=0,b=0}else o.head&&(o.head.extra=null);o.mode=I5;case I5:if(1024&o.flags&&((M=o.length)>p&&(M=p),M&&(o.head&&(H=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),jc(o.head.extra,i,u,M,H)),512&o.flags&&(o.check=yi(o.check,i,M,u)),p-=M,u+=M,o.length-=M),o.length))break e;o.length=0,o.mode=b5;case b5:if(2048&o.flags){if(p===0)break e;M=0;do H=i[u+M++],o.head&&H&&o.length<65536&&(o.head.name+=String.fromCharCode(H));while(H&&M<p);if(512&o.flags&&(o.check=yi(o.check,i,M,u)),p-=M,u+=M,H)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=C5;case C5:if(4096&o.flags){if(p===0)break e;M=0;do H=i[u+M++],o.head&&H&&o.length<65536&&(o.head.comment+=String.fromCharCode(H));while(H&&M<p);if(512&o.flags&&(o.check=yi(o.check,i,M,u)),p-=M,u+=M,H)break e}else o.head&&(o.head.comment=null);o.mode=S5;case S5:if(512&o.flags){for(;b<16;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_!==(65535&o.check)){e.msg="header crc mismatch",o.mode=kr;break}_=0,b=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),e.adler=o.check=0,o.mode=Hc;break;case E5:for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}e.adler=o.check=F5(_),_=0,b=0,o.mode=T5;case T5:if(o.havedict===0)return e.next_out=f,e.avail_out=v,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,ede;e.adler=o.check=1,o.mode=Hc;case Hc:if(t===Zue||t===DS)break e;case FA:if(o.last){_>>>=7&b,b-=7&b,o.mode=GA;break}for(;b<3;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}switch(o.last=1&_,b-=1,3&(_>>>=1)){case 0:o.mode=M5;break;case 1:if(ude(o),o.mode=OS,t===DS){_>>>=2,b-=2;break e}break;case 2:o.mode=w5;break;case 3:e.msg="invalid block type",o.mode=kr}_>>>=2,b-=2;break;case M5:for(_>>>=7&b,b-=7&b;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if((65535&_)!=(_>>>16^65535)){e.msg="invalid stored block lengths",o.mode=kr;break}if(o.length=65535&_,_=0,b=0,o.mode=VA,t===DS)break e;case VA:o.mode=k5;case k5:if(M=o.length){if(M>p&&(M=p),M>v&&(M=v),M===0)break e;jc(c,i,u,M,f),p-=M,u+=M,v-=M,f+=M,o.length-=M;break}o.mode=Hc;break;case w5:for(;b<14;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(o.nlen=257+(31&_),_>>>=5,b-=5,o.ndist=1+(31&_),_>>>=5,b-=5,o.ncode=4+(15&_),_>>>=4,b-=4,o.nlen>286||o.ndist>30){e.msg="too many length or distance symbols",o.mode=kr;break}o.have=0,o.mode=R5;case R5:for(;o.have<o.ncode;){for(;b<3;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.lens[J[o.have++]]=7&_,_>>>=3,b-=3}for(;o.have<19;)o.lens[J[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,j={bits:o.lenbits},Y=n0(Xue,o.lens,0,19,o.lencode,0,o.work,j),o.lenbits=j.bits,Y){e.msg="invalid code lengths set",o.mode=kr;break}o.have=0,o.mode=A5;case A5:for(;o.have<o.nlen+o.ndist;){for(;N=(O=o.lencode[_&(1<<o.lenbits)-1])>>>16&255,F=65535&O,!((E=O>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(F<16)_>>>=E,b-=E,o.lens[o.have++]=F;else{if(F===16){for(W=E+2;b<W;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_>>>=E,b-=E,o.have===0){e.msg="invalid bit length repeat",o.mode=kr;break}H=o.lens[o.have-1],M=3+(3&_),_>>>=2,b-=2}else if(F===17){for(W=E+3;b<W;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}b-=E,H=0,M=3+(7&(_>>>=E)),_>>>=3,b-=3}else{for(W=E+7;b<W;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}b-=E,H=0,M=11+(127&(_>>>=E)),_>>>=7,b-=7}if(o.have+M>o.nlen+o.ndist){e.msg="invalid bit length repeat",o.mode=kr;break}for(;M--;)o.lens[o.have++]=H}}if(o.mode===kr)break;if(o.lens[256]===0){e.msg="invalid code -- missing end-of-block",o.mode=kr;break}if(o.lenbits=9,j={bits:o.lenbits},Y=n0($7,o.lens,0,o.nlen,o.lencode,0,o.work,j),o.lenbits=j.bits,Y){e.msg="invalid literal/lengths set",o.mode=kr;break}if(o.distbits=6,o.distcode=o.distdyn,j={bits:o.distbits},Y=n0(q7,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,j),o.distbits=j.bits,Y){e.msg="invalid distances set",o.mode=kr;break}if(o.mode=OS,t===DS)break e;case OS:o.mode=LS;case LS:if(p>=6&&v>=258){e.next_out=f,e.avail_out=v,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,zue(e,k),f=e.next_out,c=e.output,v=e.avail_out,u=e.next_in,i=e.input,p=e.avail_in,_=o.hold,b=o.bits,o.mode===Hc&&(o.back=-1);break}for(o.back=0;N=(O=o.lencode[_&(1<<o.lenbits)-1])>>>16&255,F=65535&O,!((E=O>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(N&&!(240&N)){for(x=E,P=N,G=F;N=(O=o.lencode[G+((_&(1<<x+P)-1)>>x)])>>>16&255,F=65535&O,!(x+(E=O>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}_>>>=x,b-=x,o.back+=x}if(_>>>=E,b-=E,o.back+=E,o.length=F,N===0){o.mode=P5;break}if(32&N){o.back=-1,o.mode=Hc;break}if(64&N){e.msg="invalid literal/length code",o.mode=kr;break}o.extra=15&N,o.mode=D5;case D5:if(o.extra){for(W=o.extra;b<W;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.length+=_&(1<<o.extra)-1,_>>>=o.extra,b-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=O5;case O5:for(;N=(O=o.distcode[_&(1<<o.distbits)-1])>>>16&255,F=65535&O,!((E=O>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(!(240&N)){for(x=E,P=N,G=F;N=(O=o.distcode[G+((_&(1<<x+P)-1)>>x)])>>>16&255,F=65535&O,!(x+(E=O>>>24)<=b);){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}_>>>=x,b-=x,o.back+=x}if(_>>>=E,b-=E,o.back+=E,64&N){e.msg="invalid distance code",o.mode=kr;break}o.offset=F,o.extra=15&N,o.mode=L5;case L5:if(o.extra){for(W=o.extra;b<W;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}o.offset+=_&(1<<o.extra)-1,_>>>=o.extra,b-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){e.msg="invalid distance too far back",o.mode=kr;break}o.mode=N5;case N5:if(v===0)break e;if(M=k-v,o.offset>M){if((M=o.offset-M)>o.whave&&o.sane){e.msg="invalid distance too far back",o.mode=kr;break}M>o.wnext?(M-=o.wnext,R=o.wsize-M):R=o.wnext-M,M>o.length&&(M=o.length),w=o.window}else w=c,R=f-o.offset,M=o.length;M>v&&(M=v),v-=M,o.length-=M;do c[f++]=w[R++];while(--M);o.length===0&&(o.mode=LS);break;case P5:if(v===0)break e;c[f++]=o.length,v--,o.mode=LS;break;case GA:if(o.wrap){for(;b<32;){if(p===0)break e;p--,_|=i[u++]<<b,b+=8}if(k-=v,e.total_out+=k,o.total+=k,k&&(e.adler=o.check=o.flags?yi(o.check,c,k,f-k):GD(o.check,c,k,f-k)),k=v,(o.flags?_:F5(_))!==o.check){e.msg="incorrect data check",o.mode=kr;break}_=0,b=0}o.mode=x5;case x5:if(o.wrap&&o.flags){for(;b<32;){if(p===0)break e;p--,_+=i[u++]<<b,b+=8}if(_!==(4294967295&o.total)){e.msg="incorrect length check",o.mode=kr;break}_=0,b=0}o.mode=U5;case U5:Y=Que;break e;case kr:Y=tde;break e;case rde:return nde;case ide:default:return Bd}return e.next_out=f,e.avail_out=v,e.next_in=u,e.avail_in=p,o.hold=_,o.bits=b,(o.wsize||k!==e.avail_out&&o.mode<kr&&(o.mode<GA||t!==p5))&&function(oe,pe,ie,te){var he,re=oe.state;re.window===null&&(re.wsize=1<<re.wbits,re.wnext=0,re.whave=0,re.window=new xE(re.wsize)),te>=re.wsize?(jc(re.window,pe,ie-re.wsize,re.wsize,0),re.wnext=0,re.whave=re.wsize):((he=re.wsize-re.wnext)>te&&(he=te),jc(re.window,pe,ie-te,he,re.wnext),(te-=he)?(jc(re.window,pe,ie-te,te,0),re.wnext=te,re.whave=re.wsize):(re.wnext+=he,re.wnext===re.wsize&&(re.wnext=0),re.whave<re.wsize&&(re.whave+=he)))}(e,e.output,e.next_out,k-e.avail_out),S-=e.avail_in,k-=e.avail_out,e.total_in+=S,e.total_out+=k,o.total+=k,o.wrap&&k&&(e.adler=o.check=o.flags?yi(o.check,c,k,e.next_out-k):GD(o.check,c,k,e.next_out-k)),e.data_type=o.bits+(o.last?64:0)+(o.mode===Hc?128:0)+(o.mode===OS||o.mode===VA?256:0),(S===0&&k===0||t===p5)&&Y===VE&&(Y=ode),Y}var NS,Ig=1,o0=7;function $l(e){if(e<Ig||e>o0)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function hde(e,t){for(var o=0;o<e.length;o++)this[t+o]=e[o]}$l.prototype.init=function(e,t,o,i,c){var u;switch(this.windowBits=e,this.level=t,this.memLevel=o,this.strategy=i,this.mode!==3&&this.mode!==4||(this.windowBits+=16),this.mode===o0&&(this.windowBits+=32),this.mode!==5&&this.mode!==6||(this.windowBits=-this.windowBits),this.strm=new vue,this.mode){case Ig:case 3:case 5:u=function(f,p,v,_,b,S){if(!f)return op;var k=1;if(p===Due&&(p=6),_<0?(k=0,_=-_):_>15&&(k=2,_-=16),b<1||b>xue||v!==NL||_<8||_>15||p<0||p>9||S<0||S>Nue)return Nd(f,op);_===8&&(_=9);var M=new $ue;return f.state=M,M.strm=f,M.wrap=k,M.gzhead=null,M.w_bits=_,M.w_size=1<<M.w_bits,M.w_mask=M.w_size-1,M.hash_bits=b+7,M.hash_size=1<<M.hash_bits,M.hash_mask=M.hash_size-1,M.hash_shift=~~((M.hash_bits+Jo-1)/Jo),M.window=new xE(2*M.w_size),M.head=new Cs(M.hash_size),M.prev=new Cs(M.w_size),M.lit_bufsize=1<<b+6,M.pending_buf_size=4*M.lit_bufsize,M.pending_buf=new xE(M.pending_buf_size),M.d_buf=1*M.lit_bufsize,M.l_buf=3*M.lit_bufsize,M.level=p,M.strategy=S,M.method=v,c5(f)}(this.strm,this.level,8,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case o0:u=cde(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}u===0?(this.write_in_progress=!1,this.init_done=!0):this._error(u)},$l.prototype.params=function(){throw new Error("deflateParams Not supported")},$l.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===0)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},$l.prototype.write=function(e,t,o,i,c,u,f){this._writeCheck(),this.write_in_progress=!0;var p=this;return ki(function(){p.write_in_progress=!1;var v=p._write(e,t,o,i,c,u,f);p.callback(v[0],v[1]),p.pending_close&&p.close()}),this},$l.prototype.writeSync=function(e,t,o,i,c,u,f){return this._writeCheck(),this._write(e,t,o,i,c,u,f)},$l.prototype._write=function(e,t,o,i,c,u,f){if(this.write_in_progress=!0,e!==0&&e!==1&&e!==2&&e!==3&&e!==4&&e!==5)throw new Error("Invalid flush value");t==null&&(t=new Ot(0),i=0,o=0),c._set?c.set=c._set:c.set=hde;var p,v=this.strm;switch(v.avail_in=i,v.input=t,v.next_in=o,v.avail_out=f,v.output=c,v.next_out=u,this.mode){case Ig:case 3:case 5:p=que(v,e);break;case o0:case 2:case 4:case 6:p=dde(v,e);break;default:throw new Error("Unknown mode "+this.mode)}return p!==1&&p!==0&&this._error(p),this.write_in_progress=!1,[v.avail_in,v.avail_out]},$l.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===Ig||this.mode===3||this.mode===5?function(e){var t;e&&e.state&&((t=e.state.status)!==PL&&t!==HD&&t!==iE&&t!==aE&&t!==sE&&t!==Gf&&t!==Uy?Nd(e,op):(e.state=null,t===Gf&&Nd(e,Aue)))}(this.strm):function(e){if(!e||!e.state)return Bd;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},$l.prototype.reset=function(){switch(this.mode){case Ig:case 5:NS=c5(this.strm);break;case 2:case 6:NS=z7(this.strm)}NS!==0&&this._error(NS)},$l.prototype._error=function(e){this.onerror(D7[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var G5=Object.freeze({NONE:0,DEFLATE:Ig,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:o0,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:$l}),bn={};Object.keys(G5).forEach(function(e){bn[e]=G5[e]}),bn.Z_MIN_WINDOWBITS=8,bn.Z_MAX_WINDOWBITS=15,bn.Z_DEFAULT_WINDOWBITS=15,bn.Z_MIN_CHUNK=64,bn.Z_MAX_CHUNK=1/0,bn.Z_DEFAULT_CHUNK=16384,bn.Z_MIN_MEMLEVEL=1,bn.Z_MAX_MEMLEVEL=9,bn.Z_DEFAULT_MEMLEVEL=8,bn.Z_MIN_LEVEL=-1,bn.Z_MAX_LEVEL=9,bn.Z_DEFAULT_LEVEL=bn.Z_DEFAULT_COMPRESSION;var lE={Z_OK:bn.Z_OK,Z_STREAM_END:bn.Z_STREAM_END,Z_NEED_DICT:bn.Z_NEED_DICT,Z_ERRNO:bn.Z_ERRNO,Z_STREAM_ERROR:bn.Z_STREAM_ERROR,Z_DATA_ERROR:bn.Z_DATA_ERROR,Z_MEM_ERROR:bn.Z_MEM_ERROR,Z_BUF_ERROR:bn.Z_BUF_ERROR,Z_VERSION_ERROR:bn.Z_VERSION_ERROR};function Mf(e,t,o){var i=[],c=0;function u(){for(var p;(p=e.read())!==null;)i.push(p),c+=p.length;e.once("readable",u)}function f(){var p=Ot.concat(i,c);i=[],o(null,p),e.close()}e.on("error",function(p){e.removeListener("end",f),e.removeListener("readable",u),o(p)}),e.on("end",f),e.end(t),u()}function kf(e,t){if(typeof t=="string"&&(t=new Ot(t)),!X0(t))throw new TypeError("Not a string or buffer");var o=bn.Z_FINISH;return e._processChunk(t,o)}function Hf(e){if(!(this instanceof Hf))return new Hf(e);xr.call(this,e,bn.DEFLATE)}function $f(e){if(!(this instanceof $f))return new $f(e);xr.call(this,e,bn.INFLATE)}function qf(e){if(!(this instanceof qf))return new qf(e);xr.call(this,e,bn.GZIP)}function Kf(e){if(!(this instanceof Kf))return new Kf(e);xr.call(this,e,bn.GUNZIP)}function zf(e){if(!(this instanceof zf))return new zf(e);xr.call(this,e,bn.DEFLATERAW)}function Wf(e){if(!(this instanceof Wf))return new Wf(e);xr.call(this,e,bn.INFLATERAW)}function jf(e){if(!(this instanceof jf))return new jf(e);xr.call(this,e,bn.UNZIP)}function xr(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||bn.Z_DEFAULT_CHUNK,Is.call(this,e),e.flush&&e.flush!==bn.Z_NO_FLUSH&&e.flush!==bn.Z_PARTIAL_FLUSH&&e.flush!==bn.Z_SYNC_FLUSH&&e.flush!==bn.Z_FULL_FLUSH&&e.flush!==bn.Z_FINISH&&e.flush!==bn.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||bn.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<bn.Z_MIN_CHUNK||e.chunkSize>bn.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<bn.Z_MIN_WINDOWBITS||e.windowBits>bn.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<bn.Z_MIN_LEVEL||e.level>bn.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<bn.Z_MIN_MEMLEVEL||e.memLevel>bn.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=bn.Z_FILTERED&&e.strategy!=bn.Z_HUFFMAN_ONLY&&e.strategy!=bn.Z_RLE&&e.strategy!=bn.Z_FIXED&&e.strategy!=bn.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!X0(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new bn.Zlib(t);var o=this;this._hadError=!1,this._binding.onerror=function(u,f){o._binding=null,o._hadError=!0;var p=new Error(u);p.errno=f,p.code=bn.codes[f],o.emit("error",p)};var i=bn.Z_DEFAULT_COMPRESSION;typeof e.level=="number"&&(i=e.level);var c=bn.Z_DEFAULT_STRATEGY;typeof e.strategy=="number"&&(c=e.strategy),this._binding.init(e.windowBits||bn.Z_DEFAULT_WINDOWBITS,i,e.memLevel||bn.Z_DEFAULT_MEMLEVEL,c,e.dictionary),this._buffer=new Ot(this._chunkSize),this._offset=0,this._closed=!1,this._level=i,this._strategy=c,this.once("end",this.close)}Object.keys(lE).forEach(function(e){lE[lE[e]]=e}),Ma(xr,Is),xr.prototype.params=function(e,t,o){if(e<bn.Z_MIN_LEVEL||e>bn.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=bn.Z_FILTERED&&t!=bn.Z_HUFFMAN_ONLY&&t!=bn.Z_RLE&&t!=bn.Z_FIXED&&t!=bn.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var i=this;this.flush(bn.Z_SYNC_FLUSH,function(){i._binding.params(e,t),i._hadError||(i._level=e,i._strategy=t,o&&o())})}else ki(o)},xr.prototype.reset=function(){return this._binding.reset()},xr.prototype._flush=function(e){this._transform(new Ot(0),"",e)},xr.prototype.flush=function(e,t){var o=this._writableState;if((typeof e=="function"||e===void 0&&!t)&&(t=e,e=bn.Z_FULL_FLUSH),o.ended)t&&ki(t);else if(o.ending)t&&this.once("end",t);else if(o.needDrain){var i=this;this.once("drain",function(){i.flush(t)})}else this._flushFlag=e,this.write(new Ot(0),"",t)},xr.prototype.close=function(e){if(e&&ki(e),!this._closed){this._closed=!0,this._binding.close();var t=this;ki(function(){t.emit("close")})}},xr.prototype._transform=function(e,t,o){var i,c=this._writableState,u=(c.ending||c.ended)&&(!e||c.length===e.length);if(!e===null&&!X0(e))return o(new Error("invalid input"));u?i=bn.Z_FINISH:(i=this._flushFlag,e.length>=c.length&&(this._flushFlag=this._opts.flush||bn.Z_NO_FLUSH)),this._processChunk(e,i,o)},xr.prototype._processChunk=function(e,t,o){var i=e&&e.length,c=this._chunkSize-this._offset,u=0,f=this,p=typeof o=="function";if(!p){var v,_=[],b=0;this.on("error",function(w){v=w});do var S=this._binding.writeSync(t,e,u,i,this._buffer,this._offset,c);while(!this._hadError&&R(S[0],S[1]));if(this._hadError)throw v;var k=Ot.concat(_,b);return this.close(),k}var M=this._binding.write(t,e,u,i,this._buffer,this._offset,c);function R(w,E){if(!f._hadError){var N=c-E;if(function(P,G){if(!P)throw new Error(G)}(N>=0,"have should not go down"),N>0){var F=f._buffer.slice(f._offset,f._offset+N);f._offset+=N,p?f.push(F):(_.push(F),b+=F.length)}if((E===0||f._offset>=f._chunkSize)&&(c=f._chunkSize,f._offset=0,f._buffer=new Ot(f._chunkSize)),E===0){if(u+=i-w,i=w,!p)return!0;var x=f._binding.write(t,e,u,i,f._buffer,f._offset,f._chunkSize);return x.callback=R,void(x.buffer=e)}if(!p)return!1;o()}}M.buffer=e,M.callback=R},Ma(Hf,xr),Ma($f,xr),Ma(qf,xr),Ma(Kf,xr),Ma(zf,xr),Ma(Wf,xr),Ma(jf,xr);var B5={codes:lE,createDeflate:function(e){return new Hf(e)},createInflate:function(e){return new $f(e)},createDeflateRaw:function(e){return new zf(e)},createInflateRaw:function(e){return new Wf(e)},createGzip:function(e){return new qf(e)},createGunzip:function(e){return new Kf(e)},createUnzip:function(e){return new jf(e)},deflate:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new Hf(t),e,o)},deflateSync:function(e,t){return kf(new Hf(t),e)},gzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new qf(t),e,o)},gzipSync:function(e,t){return kf(new qf(t),e)},deflateRaw:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new zf(t),e,o)},deflateRawSync:function(e,t){return kf(new zf(t),e)},unzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new jf(t),e,o)},unzipSync:function(e,t){return kf(new jf(t),e)},inflate:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new $f(t),e,o)},inflateSync:function(e,t){return kf(new $f(t),e)},gunzip:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new Kf(t),e,o)},gunzipSync:function(e,t){return kf(new Kf(t),e)},inflateRaw:function(e,t,o){return typeof t=="function"&&(o=t,t={}),Mf(new Wf(t),e,o)},inflateRawSync:function(e,t){return kf(new Wf(t),e)},Deflate:Hf,Inflate:$f,Gzip:qf,Gunzip:Kf,DeflateRaw:zf,InflateRaw:Wf,Unzip:jf,Zlib:xr};class fde{constructor(t,o,i){this.SDKAPPID=t,this.EXPIRETIME=i,this.PRIVATEKEY=o}genTestUserSig(t){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(t)?this._isNumber(this.EXPIRETIME)?(console.log("sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+t+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(t,this.EXPIRETIME,null)):(console.error("expireTime must be a number"),""):(console.error("userID must be a string"),""):(console.error("privateKey must be a string"),""):(console.error("sdkAppID must be a number"),"")}newBuffer(t,o){return Ot.from?Ot.from(t,o):new Ot(t,o)}unescape(t){return t.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}escape(t){return t.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}encode(t){return this.escape(this.newBuffer(t).toString("base64"))}decode(t){return this.newBuffer(this.unescape(t),"base64")}base64encode(t){return this.newBuffer(t).toString("base64")}base64decode(t){return this.newBuffer(t,"base64").toString()}_hmacsha256(t,o,i,c){let u="TLS.identifier:"+t+`
`;u+="TLS.sdkappid:"+this.SDKAPPID+`
`,u+="TLS.time:"+o+`
`,u+="TLS.expire:"+i+`
`,c!=null&&(u+="TLS.userbuf:"+c+`
`);let f=L6.HmacSHA256(u,this.PRIVATEKEY);return L6.enc.Base64.stringify(f)}_utc(){return Math.round(Date.now()/1e3)}_isNumber(t){return t!==null&&(typeof t=="number"&&!isNaN(t-0)||typeof t=="object"&&t.constructor===Number)}_isString(t){return typeof t=="string"}genSigWithUserbuf(t,o,i){let c=this._utc(),u={"TLS.ver":"2.0","TLS.identifier":t,"TLS.sdkappid":this.SDKAPPID,"TLS.time":c,"TLS.expire":o},f="";if(i!=null){let b=this.base64encode(i);u["TLS.userbuf"]=b,f=this._hmacsha256(t,c,o,b)}else f=this._hmacsha256(t,c,o,null);u["TLS.sig"]=f;let p=JSON.stringify(u),v=B5.deflateSync(this.newBuffer(p)).toString("base64"),_=this.escape(v);return console.log("ret="+_),_}validate(t){let o=this.decode(t),i=B5.inflateSync(o);console.log("validate ret="+i)}}function W7({sdkAppId:e,userId:t,sdkSecretKey:o}){if(!t){console.error("Missing userID parameter.");return}if(!e){console.error("Missing SDKAppID parameter.");return}if(!o){console.error("Missing SecretKey parameter.");return}const i=e,c=604800,u=o;return{userSig:new fde(i,u,c).genTestUserSig(t),SDKAppID:e}}const pde={class:"flex items-center flex-col text-center p-12 h-screen"},mde={class:"container1 h-full mb-4"},gde=["id"],H5=20022655,vde="352a708f07e30c918fe120f0e8a5327c69b19b74f2eed513b3ee9c8aea0133a2",_de=Te({__name:"VideoChat",setup(e){const t=i7(),o=Number(t.query.roomId),i=String(t.query.userId);let c,u=le([]);const f=wy.create();mn(()=>{alert(`房间号为${o}`),c=W7({sdkAppId:H5,userId:i,sdkSecretKey:vde}).userSig,f.on(wy.EVENT.REMOTE_VIDEO_AVAILABLE,async({userId:R,streamType:w})=>{if(w==wy.TYPE.STREAM_TYPE_MAIN){u.value.includes(R)||u.value.push(`${R}`),await Vt(),await f.startRemoteVideo({userId:R,streamType:w,view:`${R}`});for(let E of u.value)console.log(E,"1111111111")}}),f.on(wy.EVENT.REMOTE_VIDEO_UNAVAILABLE,M);function M(R){const{streamType:w}=R;f.stopRemoteVideo({userId:R.userId,streamType:w}),w===wy.TYPE.STREAM_TYPE_MAIN&&(u.value=u.value.filter(E=>E!==`${R.userId}`),console.log("11111"+u))}});const p=async()=>{await f.stopLocalVideo(),await f.exitRoom()},v=async()=>{try{await f.enterRoom({sdkAppId:H5,userId:i,userSig:c,roomId:o}),console.log("enter room successfully")}catch(M){console.error("failed to enter room "+M)}};async function _(){await f.startLocalAudio()}async function b(){await f.stopLocalAudio()}const S=async()=>{const M=document.getElementById("localvideo");await f.startLocalVideo({view:M})};async function k(){await f.stopLocalVideo()}return(M,R)=>(ee(),ge("div",pde,[Ee("div",mde,[Ee("div",{ref:"localVideo",class:"w-96 h-full bg-gray-200 mb-4 object-cover",id:"localvideo"},mt(y(i)),513),(ee(!0),ge(Ht,null,Un(y(u),w=>(ee(),ge(Ht,{key:w},[y(u).includes(w)?(ee(),ge("div",{key:0,class:"w-96 h-full bg-gray-200 mb-4 object-cover",id:w},mt(w)+" 在线："+mt(y(u).includes(w)),9,gde)):$e("",!0)],64))),128))]),Ee("div",{class:"flex gap-3 mb-1 mt-3"},[Ee("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:v}," 进入房间 "),Ee("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:_}," 打开麦克风 "),Ee("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:S}," 打开摄像头 "),Ee("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:b}," 关闭麦克风 "),Ee("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:k}," 关闭摄像头 "),Ee("button",{class:"rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white",onClick:p}," 挂断视频 ")])]))}}),yde=(e,t)=>{const o=e.__vccOpts||e;for(const[i,c]of t)o[i]=c;return o},Ide=yde(_de,[["__scopeId","data-v-f52423de"]]),bde={class:"parent"},Cde=Ee("h1",{style:{"font-weight":"700","font-family":"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif","font-style":"italic","font-size":"larger"}},"欢迎来到通信小屋",-1),Sde={class:"containerlogin gap-4 mb-4"},Ede={style:{"text-align":"center"}},Tde=Te({__name:"login",setup(e){const t=le(""),o=le("");function i(){console.log(`${o.value}${t.value}`),console.log(!(!t||!o))}return(c,u)=>{const f=Cn("el-input"),p=Cn("el-form-item"),v=Cn("el-form");return ee(),ge("div",bde,[Cde,Ee("div",Sde,[Me(v,{"label-width":"auto",style:{"max-width":"600px"}},{default:Ae(()=>[Me(p,{label:"用户名"},{default:Ae(()=>[Me(f,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=_=>t.value=_),style:{width:"240px"},placeholder:"初始化你的用户名",clearable:""},null,8,["modelValue"])]),_:1}),Me(p,{label:"房间号或用户名"},{default:Ae(()=>[Me(f,{modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=_=>o.value=_),style:{width:"240px"},placeholder:"创建数字房间号或会话用户名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),Ee("div",Ede,[Ee("button",{class:"rounded-md px-4 py-2 text-sm font-semibold text-white mr-5",style:qt({backgroundColor:!t.value||!o.value?"gray":"indigo"}),onClick:i},[Mn(" 文字聊天 "),t.value&&o.value?(ee(),We(y(LD),{key:0,to:{path:"/videoChatByTRTC/Chat",query:{roomId:o.value,userId:t.value}},class:"button"},{default:Ae(()=>[Mn(" 进入房间 ")]),_:1},8,["to"])):$e("",!0)],4),Ee("button",{class:"rounded-md px-4 py-2 text-sm font-semibold text-white",style:qt({backgroundColor:!t.value||!o.value?"gray":"indigo"}),onClick:i},[Mn(" 视频 "),t.value&&o.value?(ee(),We(y(LD),{key:0,to:{path:"/videoChatByTRTC/VideoChat",query:{roomId:o.value,userId:t.value}},class:"button"},{default:Ae(()=>[Mn(" 进入房间 ")]),_:1},8,["to"])):$e("",!0)],4)])])}}});var j7={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){function o(n,a){(a==null||a>n.length)&&(a=n.length);for(var s=0,h=Array(a);s<a;s++)h[s]=n[s];return h}function i(n){if(Array.isArray(n))return n}function c(n,m,s){m=b(m);var h=n,m=k()?Reflect.construct(m,s||[],b(n).constructor):m.apply(n,s);if(!m||typeof m!="object"&&typeof m!="function"){if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");if((m=h)===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return m}function u(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")}function f(n,a){for(var s=0;s<a.length;s++){var h=a[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(n,G(h.key),h)}}function p(n,a,s){return a&&f(n.prototype,a),s&&f(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function v(n,a){var s,h,m,I,T=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(T)return m=!(h=!0),{s:function(){T=T.call(n)},n:function(){var D=T.next();return h=D.done,D},e:function(D){m=!0,s=D},f:function(){try{h||T.return==null||T.return()}finally{if(m)throw s}}};if(Array.isArray(n)||(T=Y(n))||a&&n&&typeof n.length=="number")return T&&(n=T),I=0,{s:a=function(){},n:function(){return I>=n.length?{done:!0}:{done:!1,value:n[I++]}},e:function(D){throw D},f:a};throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(n,a,s){return(a=G(a))in n?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s,n}function b(n){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(n)}function S(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),a&&F(n,a)}function k(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k=function(){return!!n})()}function M(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function R(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(n,a){var s,h=Object.keys(n);return Object.getOwnPropertySymbols&&(s=Object.getOwnPropertySymbols(n),a&&(s=s.filter(function(m){return Object.getOwnPropertyDescriptor(n,m).enumerable})),h.push.apply(h,s)),h}function E(n){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?w(Object(s),!0).forEach(function(h){_(n,h,s[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):w(Object(s)).forEach(function(h){Object.defineProperty(n,h,Object.getOwnPropertyDescriptor(s,h))})}return n}function N(n,a){if(n==null)return{};var s,h=function(T,D){if(T==null)return{};var V,$={};for(V in T)if({}.hasOwnProperty.call(T,V)){if(0<=D.indexOf(V))continue;$[V]=T[V]}return $}(n,a);if(Object.getOwnPropertySymbols)for(var m=Object.getOwnPropertySymbols(n),I=0;I<m.length;I++)s=m[I],0<=a.indexOf(s)||{}.propertyIsEnumerable.call(n,s)&&(h[s]=n[s]);return h}function F(n,a){return(F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,h){return s.__proto__=h,s})(n,a)}function x(n,a){return i(n)||function(s,h){var m=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(m!=null){var I,T,D,V,$=[],q=!0,se=!1;try{if(D=(m=m.call(s)).next,h===0){if(Object(m)!==m)return;q=!1}else for(;!(q=(I=D.call(m)).done)&&($.push(I.value),$.length!==h);q=!0);}catch(me){se=!0,T=me}finally{try{if(!q&&m.return!=null&&(V=m.return(),Object(V)!==V))return}finally{if(se)throw T}}return $}}(n,a)||Y(n,a)||R()}function P(n){return function(a){if(Array.isArray(a))return o(a)}(n)||M(n)||Y(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function G(n){return n=function(a){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s===void 0)return String(a);if(s=s.call(a,"string"),typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}(n),typeof n=="symbol"?n:n+""}function H(n){return(H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(n)}function Y(n,a){var s;if(n)return typeof n=="string"?o(n,a):(s=(s={}.toString.call(n).slice(8,-1))==="Object"&&n.constructor?n.constructor.name:s)==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?o(n,a):void 0}function j(n){var a=typeof Map=="function"?new Map:void 0;return function(s){if(s===null||!function(m){try{return Function.toString.call(m).indexOf("[native code]")!==-1}catch{return typeof m=="function"}}(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(a!==void 0){if(a.has(s))return a.get(s);a.set(s,h)}function h(){return function(m,I,T){var D;return k()?Reflect.construct.apply(null,arguments):((D=[null]).push.apply(D,I),I=new(m.bind.apply(m,D)),T&&F(I,T.prototype),I)}(s,arguments,b(this).constructor)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),F(h,s)}(n)}var W={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",MY_FOLLOWERS_LIST_UPDATED:"onMyFollowersListUpdated",MY_FOLLOWING_LIST_UPDATED:"onMyFollowingListUpdated",MUTUAL_FOLLOWERS_LIST_UPDATED:"onMutualFollowersListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",ALL_RECEIVE_MESSAGE_OPT_UPDATED:"onAllReceiveMessageOptUpdated"},O={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_ROOM:"Room",GRP_LIVE:"Live",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_MSG_EXCEPT_AT:"NotReceiveMsgExceptAt",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3,IOS_OFFLINE_PUSH_NO_SOUND:"push.no_sound",IOS_OFFLINE_PUSH_DEFAULT_SOUND:"default"},Q={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},J=p(function n(){u(this,n),this.cache=[],this.options=null},[{key:"use",value:function(n){if(typeof n!="function")throw"middleware must be a function";return this.cache.push(n),this}},{key:"next",value:function(n){if(this.middlewares&&0<this.middlewares.length)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(n){return this.middlewares=this.cache.map(function(a){return a}),this.options=n,this.next()}}]),oe=p(function n(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;u(this,n),this.high=a,this.low=s},[{key:"equal",value:function(n){return n!==null&&this.low===n.low&&this.high===n.high}},{key:"toString",value:function(){var n=Number(this.high).toString(16),a=Number(this.low).toString(16);if(a.length<8)for(var s=8-a.length;s;)a="0"+a,s--;return n+a}}]),pe={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",BACKUP_WEB:"wss://*w4c.my-cpaas.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",BACKUP_WEB:"wss://*w4c.my-cpaas.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT0:"wss://*w4s.my-imcloud.com",DEFAULT:"wss://wsssgp.im.qcloud.com",IPV6:"wss://wsssgpv6.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",BACKUP_WEB:"wss://*w4s.my-cpaas.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT0:"wss://*w4k.my-imcloud.com",DEFAULT:"wss://wsskr.im.qcloud.com",IPV6:"wss://wsskrv6.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",BACKUP_WEB:"wss://*w4k.my-cpaas.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT0:"wss://*w4g.my-imcloud.com",DEFAULT:"wss://wssger.im.qcloud.com",IPV6:"wss://wssgerv6.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",BACKUP_WEB:"wss://*w4g.my-cpaas.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT0:"wss://*w4i.my-imcloud.com",DEFAULT:"wss://wssind.my-imcloud.com",IPV6:"wss://wssindv6.im.qcloud.com",BACKUP:"wss://wssind.im.qcloud.com",BACKUP_WEB:"wss://*w4i.my-cpaas.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.19.46"},JPN:{DEFAULT0:"wss://*w4j.my-imcloud.com",DEFAULT:"wss://wssjpn.im.qcloud.com",IPV6:"wss://wssjpnv6.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",BACKUP_WEB:"wss://*w4j.my-cpaas.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT0:"wss://*w4u.my-imcloud.com",DEFAULT:"wss://wssusa.im.qcloud.com",IPV6:"wss://wssusav6.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",BACKUP_WEB:"wss://*w4u.my-cpaas.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT0:"wss://*w4y.my-imcloud.com",DEFAULT:"wss://wssidn.im.qcloud.com",IPV6:"wss://wssidnv6.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",BACKUP_WEB:"wss://*w4y.my-cpaas.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},ie={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15,DONUT_NATIVE_APP:19,NS_NATIVE_APP:20,RN_NATIVE_APP:21},te="1.7.3",he=537048168,re="CHINA",X={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){this.CURRENT=pe.PRODUCTION[0<arguments.length&&arguments[0]!==void 0?arguments[0]:re]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GRP:"group_open_http_svc",GRP_AV:"group_open_avchatroom_http_svc",GRP_COMMUNITY:"million_group_open_http_svc",GRP_ATTR:"group_open_attr_http_svc",FD:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GRP_NO_AUTH:"group_open_http_noauth_svc",BIG_GRP_POLLING:"group_open_long_polling_http_svc",BIG_GRP_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MSG:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MSG_SEARCH:"message_search",GRP_SEARCH:"group_search",GRP_MEMBER_SEARCH:"group_member_search",USER_SEARCH:"user_search",FOLLOW:"follow",OFFLINE_PUSH_REPORT:"offline_push_report",IM_MSG_LOGIC:"im_msg_db_logic"}},ye={SEARCH_GRP_SNS:new oe(0,Math.pow(2,1)).toString(),AV_HISTORY_MSG:new oe(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new oe(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new oe(0,Math.pow(2,4)).toString(),AV_MBR_LIST:new oe(0,Math.pow(2,6)).toString(),USER_STATUS:new oe(0,Math.pow(2,7)).toString(),CONV_MARK:new oe(0,Math.pow(2,9)).toString(),CONV_GROUP:new oe(0,Math.pow(2,10)).toString(),AV_BAN_MBR:new oe(0,Math.pow(2,11)).toString(),MSG_EXT:new oe(0,Math.pow(2,13)).toString(),GRP_COUNTER:new oe(0,Math.pow(2,15)).toString(),PLUGIN_TRANSLATE:new oe(Math.pow(2,6)).toString(),PLUGIN_VOICE_TO_TEXT:new oe(Math.pow(2,7)).toString(),PLUGIN_CS:new oe(Math.pow(2,8)).toString(),PLUGIN_PUSH:new oe(Math.pow(2,9)).toString(),PLUGIN_BOT:new oe(Math.pow(2,10)).toString(),MSG_REACTION:new oe(Math.pow(2,16)).toString(),FOLLOW:new oe(Math.pow(2,20)).toString()},ue="group_profile",Ie=["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],ve=["Role","JoinTime","MsgSeq","MsgFlag"];X.HOST.setCurrent(re);for(var Ce,Fe=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,Oe=Fe&&typeof wx.createGamePortal=="function",be=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,xe=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,Le=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,rt=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,Dt=typeof jd<"u"&&typeof jd.getSystemInfoSync=="function",Qe=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",zn=Fe&&H(wx.miniapp)==="object",Ge=typeof uni<"u",_e=Fe||be||xe||Le||rt||Qe||Dt,Bn=typeof window>"u"&&!_e&&typeof wr<"u"&&wr.NativeScriptGlobals!==void 0,Re=typeof wr<"u"&&(wr.nativeModuleProxy!==void 0||wr.ReactNative!==void 0),Ke=typeof uni<"u"?!_e:typeof window<"u"&&!_e&&!Re,je=be?qq:xe?tt:Le?swan:rt?my:Fe?wx:Qe?uni:Dt?jd:{},ze=Ke&&window&&window.navigator&&window.navigator.userAgent||"",nt=(Dt="WEB",/(micromessenger|webbrowser)/i.test(ze)?Dt="WEB":be?Dt="QQ_MP":xe?Dt="TT_MP":Le?Dt="BAIDU_MP":rt?Dt="ALI_MP":Fe?Dt=zn?"DONUT_NATIVE_APP":"WX_MP":Qe?Dt="UNI_NATIVE_APP":Bn?Dt="NS_NATIVE_APP":Re&&(Dt="RN_NATIVE_APP"),ie[Dt]),zn=/iPad/i.test(ze),Bn=/iPhone/i.test(ze)&&!zn,Dt=/iPod/i.test(ze),it=Bn||zn||Dt,dt=(Bn=ze.match(/OS (\d+)_/i))&&Bn[1]?Bn[1]:null,gt=/Android/i.test(ze),ft=(zn=ze.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(Dt=zn[1]&&parseFloat(zn[1]),Bn=zn[2]&&parseFloat(zn[2]),Dt&&Bn?parseFloat(zn[1]+"."+zn[2]):Dt||null):null,Bn=/Edge/i.test(ze),zn=!Bn&&/Chrome/i.test(ze),Mt=/MSIE/.test(ze)||-1<ze.indexOf("Trident")&&-1<ze.indexOf("rv:11.0"),lt=Dt=!(Dt=(Dt=/MSIE\s(\d+)\.\d/.exec(ze))&&parseFloat(Dt[1]))&&/Trident\/7.0/i.test(ze)&&/rv:11.0/.test(ze)?11:Dt,Dt=/Safari/i.test(ze)&&!zn&&!gt&&!Bn,Et=/Windows/i.test(ze),Yt=/MAC OS X/i.test(ze),sn=Ke&&typeof Worker<"u"&&!Mt,dn=gt||it,Sn=Ke&&window.tencent_cloud_im_csig_flutter_for_web_25F_cy!==void 0,yn=typeof window<"u"&&window.navigator!==void 0&&(zn=window.navigator.standalone,!(!it||zn||Dt)),fo=typeof console<"u"?console:typeof wr<"u"&&wr.console?wr.console:typeof window<"u"&&window.console?window.console:{},Xt=function(){},vn=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Ne=vn.length;Ne--;)Ce=vn[Ne],console[Ce]||(fo[Ce]=Xt);function qe(){var n=new Date;return n.setTime(Dn()),n}function ke(){Nt=0}function ot(){return Math.floor(Dn()/1e3)}var tn=fo,Nt=0,Dn=function(){return new Date().getTime()+Nt},dr=0;function io(){return Tv()?"%c Chat %c":"Chat"}function hr(){var n=qe();return n.toLocaleTimeString("en-US",{hour12:!1})+"."+function(a){var s;switch(a.toString().length){case 1:s="00"+a;break;case 2:s="0"+a;break;default:s=a}return s}(n.getMilliseconds())}var K={arguments2String:function(n){var a="";if(n.length===1)a=n[0];else for(var s=0,h=n.length;s<h;s++){if(Us(n[s]))try{a+=ch(n[s])?JSON.stringify(n[s],["message","code"]):JSON.stringify(n[s])}catch(m){a+=m?m.message:"";break}else a+=n[s];a+=" "}return a},_exec:function(n,a){Tv()?tn[n](io(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",hr(),a):tn[n]("".concat(io()," ").concat(hr()," ").concat(a))},d:function(){var n;dr<=-1&&(n=this.arguments2String(arguments),this._exec("debug",n))},l:function(){var n;dr<=0&&(n=this.arguments2String(arguments),this._exec("log",n))},log:function(){var n;dr<=0&&(n=this.arguments2String(arguments),this._exec("log",n))},i:function(){var n;dr<=1&&(n=this.arguments2String(arguments),this._exec("info",n))},w:function(){var n;dr<=2&&(n=this.arguments2String(arguments),this._exec("warn",n))},e:function(){var n;dr<=3&&(n=this.arguments2String(arguments),this._exec("error",n))},setLevel:function(n){n<4&&this._exec("log","set level from "+dr+" to "+n),dr=n},getLevel:function(){return dr}},ri={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Bn="Tag_Profile_IM_",Gt={NICK:"".concat(Bn,"Nick"),GENDER:"".concat(Bn,"Gender"),BIRTHDAY:"".concat(Bn,"BirthDay"),LOCATION:"".concat(Bn,"Location"),SELFSIGNATURE:"".concat(Bn,"SelfSignature"),ALLOWTYPE:"".concat(Bn,"AllowType"),LANGUAGE:"".concat(Bn,"Language"),AVATAR:"".concat(Bn,"Image"),MESSAGESETTINGS:"".concat(Bn,"MsgSettings"),ADMINFORBIDTYPE:"".concat(Bn,"AdminForbidType"),LEVEL:"".concat(Bn,"Level"),ROLE:"".concat(Bn,"Role")},Ho={GROUP:"".concat("Tag_SNS_IM_","Group"),REMARK:"".concat("Tag_SNS_IM_","Remark"),ADDSOURCE:"".concat("Tag_SNS_IM_","AddSource"),ADDWORDING:"".concat("Tag_SNS_IM_","Wording"),ADDTIME:"".concat("Tag_SNS_IM_","AddTime")},zn="Gender_Type_",jo={UNKNOWN:"".concat(zn,"Unknown"),FEMALE:"".concat(zn,"Female"),MALE:"".concat(zn,"Male")},xi={NONE:"".concat("AdminForbid_Type_","None"),SEND_OUT:"".concat("AdminForbid_Type_","SendOut")},Vr={NEED_CONFIRM:"".concat("AllowType_Type_","NeedConfirm"),ALLOW_ANY:"".concat("AllowType_Type_","AllowAny"),DENY_ANY:"".concat("AllowType_Type_","DenyAny")},Ui="JoinedSuccess",ii="WaitAdminApproval",ha="@TOPIC#_",gl=Object.prototype.hasOwnProperty;function Tt(n){if(n==null)return!0;if(typeof n=="boolean")return!1;if(typeof n=="number")return n===0;if(typeof n=="string"||typeof n=="function"||Array.isArray(n))return n.length===0;if(n instanceof Error)return n.message==="";if(On(n)){for(var a in n)if(gl.call(n,a))return!1;return!0}return!!(sc(n)||lh(n)||_t(n))&&n.size===0}function sc(n){return is(n)==="map"}function lh(n){return is(n)==="set"}function _t(n){return is(n)==="file"}function It(n){return n!==null&&(typeof n=="number"&&!isNaN(+n)||H(n)==="object"&&n.constructor===Number)}function Vn(n){return n!==null&&H(n)==="object"}function On(n){if(H(n)==="object"&&n!==null){if((n=Object.getPrototypeOf(n))===null)return 1;for(var a=n;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return n===a}}function wt(n){return typeof Array.isArray=="function"?Array.isArray(n):is(n)==="array"}function zr(n){return wt(n)&&0<n.length}function No(n){return typeof n=="function"}function La(n){return is(n)==="filelist"}function Na(n){return typeof n=="string"&&(n=n[0],!/[^a-zA-Z0-9]/.test(n))}function ei(n,a,s,h){if(!Us(n)||!Us(a))return 0;for(var m,I=0,T=Object.keys(a),D=0,V=T.length;D<V;D++)if(m=T[D],!(et(a[m])||s&&s.includes(m)))if(Us(n[m])&&Us(a[m]))I+=ei(n[m],a[m],s,h);else{if(h&&h.includes(a[m]))continue;n[m]!==a[m]&&(n[m]=a[m],I+=1)}return I}function bt(n,a){var s,h=new Map,m=v(n.entries());try{for(m.s();!(s=m.n()).done;){var I=x(s.value,2),T=I[0],D=I[1];D&&h.set(T,a?JSON.stringify(D):JSON.parse(JSON.stringify(D)))}}catch(V){m.e(V)}finally{m.f()}return h}function Qt(n){if(n.length===0)return 0;for(var a=0,s=0,h=typeof document<"u"&&document.characterSet!==void 0?document.characterSet:"UTF-8";n[a]!==void 0;)s+=n[a++].charCodeAt[a]<=255?1:h===!1?3:2;return s}function hn(n){return n=n||99999999,Math.round(Math.random()*n)}function Yn(){for(var n="",a=32;0<a;--a)n+=_I[Math.floor(Math.random()*n1)];return n}function fr(n,a){for(var s in n)if(n[s]===a)return 1}function Wr(n){return n.indexOf("http://")===-1||n.indexOf("https://")===-1?"https://"+n:n.replace(/https|http/,"https")}function Ar(n){if(Object.getOwnPropertyNames(n).length===0)return Object.create(null);var a,s,h=Array.isArray(n)?[]:Object.create(null);for(s in n)n[s]!==null?n[s]!==void 0?(a=H(n[s]),0<=["string","number","function","boolean"].indexOf(a)?h[s]=n[s]:h[s]=Ar(n[s])):h[s]=void 0:h[s]=null;return h}var xs=["url"],_n=function(n){return typeof n=="string"},et=function(n){return n===void 0},Us=function(n){return wt(n)||Vn(n)},ch=function(n){return n instanceof Error},is=function(n){return Object.prototype.toString.call(n).match(/^\[object (.*)\]$/)[1].toLowerCase()},_I=(Date.now||(Date.now=function(){return new Date().getTime()}),"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),n1=_I.length,uh={};function vu(n,a){var s;return!(!wt(n)||!wt(a))&&(s=!1,a.forEach(function(I){var m=I.key,I=I.value,T=n.find(function(D){return D.key===m});T?T.value!==I&&(T.value=I,s=!0):(n.push({key:m,value:I}),s=!0)}),s)}function Cv(n){return Tt(n)?[]:n.filter(function(a){return a.isModified===!0})}function yI(n){if(On(n)&&On(n.webhookInfo)){var a=[];if(n.webhookInfo.disableCloudMessagePreHook&&a.push("ForbidBeforeSendMsgCallback"),n.webhookInfo.disableCloudMessagePostHook&&a.push("ForbidAfterSendMsgCallback"),a.length!==0)return a}}function Sv(n){return Tt(n)?[]:n.filter(function(a){return a.isModified===!1})}function jr(n){return n===O.GRP_AVCHATROOM}function Yr(s){var a=s.type,s=s.groupID;return a===O.GRP_COMMUNITY||"".concat(s).startsWith("@TGS#_")&&!"".concat(s).includes(ha)}function vr(n){return"".concat(n).startsWith("@TGS#_")&&"".concat(n).includes(ha)}function Gr(n){return _n(n)&&n.slice(0,3)===O.CONV_C2C}function Br(n){return _n(n)&&n.slice(0,5)===O.CONV_GROUP}function dh(n){return _n(n)&&n===O.CONV_SYSTEM}function II(n,a){var s={};return Object.keys(n).forEach(function(h){s[h]=a(n[h],h)}),s}function _u(n){return Re?Promise.resolve({width:0,height:0}):_e?new Promise(function(a,s){je.getImageInfo({src:n,success:function(h){a({width:h.width,height:h.height})},fail:function(){a({width:0,height:0})}})}):Mt&&lt===9?Promise.resolve({width:0,height:0}):new Promise(function(a,s){var h=new Image;h.onload=function(){a({width:this.width,height:this.height}),h=null},h.onerror=function(){a({width:0,height:0}),h=null},h.src=n})}function hh(){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(n()+n()).concat(n()).concat(n()).concat(n()).concat(n()).concat(n()).concat(n())}function Ev(){var n=gt?"android":it?"ios":Et?"windows":Yt?"mac":"unknown";if(_e)try{var a=je.getSystemInfoSync().platform;a!==void 0&&(n=a)}catch{}return n}function bI(n,a){n=n.split("."),a=a.split(".");for(var s=Math.max(n.length,a.length);n.length<s;)n.push("0");for(;a.length<s;)a.push("0");for(var h=0;h<s;h++){var m=parseInt(n[h]),I=parseInt(a[h]);if(I<m)return 1;if(m<I)return-1}return 0}function fh(s){var a=s.originUrl,a=a===void 0?void 0:a,h=s.originWidth,m=s.originHeight,s=s.min,s=s===void 0?198:s,h=parseInt(h),m=parseInt(m),I={url:void 0,width:0,height:0};return(h<=m?h:m)<=s?(I.url=a,I.width=h,I.height=m):(m<=h?(I.width=Math.ceil(h*s/m),I.height=s):(I.width=s,I.height=Math.ceil(m*s/h)),m=a&&-1<a.indexOf("?")?"".concat(a,"&"):"".concat(a,"?"),I.url="".concat(m,s===198?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")),et(a)?N(I,xs):I}function CI(n){var a=n[2];n[2]=n[1],n[1]=a;for(var s=0;s<n.length;s++)n[s].setType(s)}function ph(n){return n=n.servcmd,n.slice(n.indexOf(".")+1)}function Xi(n,a){return Math.round(Number(n)*Math.pow(10,a))/Math.pow(10,a)}function yp(n,a){return n.includes(a)}function SI(n,a){return n.includes(a)}function pr(n){return n.split(ha)[0]}function mh(n,a,s){if(et(a))return"";switch(n){case O.MSG_TEXT:return a.text;case O.MSG_IMAGE:return s?"[Image]":"[图片]";case O.MSG_LOCATION:return s?"[Location]":"[位置]";case O.MSG_AUDIO:return s?"[Voice]":"[语音]";case O.MSG_VIDEO:return s?"[Video]":"[视频]";case O.MSG_FILE:return s?"[File]":"[文件]";case O.MSG_CUSTOM:return s?"[Custom Messages]":"[自定义消息]";case O.MSG_GRP_TIP:return s?"[Group Notification]":"[群提示消息]";case O.MSG_GRP_SYS_NOTICE:return s?"[Group System Message]":"[群系统通知]";case O.MSG_FACE:return s?"[Animated Sticker]":"[动画表情]";case O.MSG_MERGER:return s?"[Chat Record]":"[聊天记录]";default:return""}}function EI(n){return n===O.MSG_TEXT||n===O.MSG_CUSTOM||n===O.MSG_LOCATION||n===O.MSG_FACE}function Pa(n){var a=[];if(_n(n)){var s=n.length;if(s!==0)for(var h=s-1;0<=h;h--)n[h]==="1"&&a.push(Math.pow(2,s-h-1))}return a}function Tv(){return!Mt&&!_e}function lc(n){return"the length of userIDList cannot exceed ".concat(n)}function TI(n){var a;if(wt(n)&&n.length!==0)return a=0,n.forEach(function(s){a+=s}),a.toFixed(0)}function gh(n){var a;if(wt(n)&&n.length!==0)return a=0,n.forEach(function(s){a+=s}),(a/n.length).toFixed(0)}function br(n,h,m){var h=!(1<arguments.length&&h!==void 0)||h,m=!(2<arguments.length&&m!==void 0)||m,I=Date.now();return h?m?"".concat(I-n," ms"):"".concat(Math.round((I-n)/1e3)," s"):m?I-n:Math.round((I-n)/1e3)}function MI(n){return!!(n&&1<n)}function vl(n,a,s,h){var m,I,T;return a===void 0||(m=!0,a.required&&Tt(n)&&(K.e("[".concat(s,'] Missing required params: "').concat(h,'".')),m=!1),Tt(n)||(I=is(n))===(T=a.type.toLowerCase())||I==="asyncfunction"&&T==="function"||(K.e("[".concat(s,'] Invalid params: type check failed for "').concat(h,'". Expected ').concat(a.type,".")),m=!1),a.validator&&!a.validator(n,s,h)&&(K.e("[".concat(s,'] Invalid params: custom validator check failed for "').concat(h,'".')),m=!1),m)}function _l(n){return!(!n||!(Gr(n)||Br(n)||dh(n))&&((n=ao("InvalidConversationID",n))&&K.w(n),1))}function St(n){n.desc!==""&&ao("API_REFER")!==""&&K.w("[".concat(n.api,"] | ").concat(n.paramName," | ").concat(n.desc,", ").concat(ao("API_REFER")).concat(n.api))}function Zi(){return ao("StringRequiredLog")}function yu(n){return ao("NonEmptyStringRequiredLog",n)}function Iu(){return ao("NumberRequiredLog")}function bu(){return ao("UndefinedNotAllowedLog")}function Ip(){return ao("FileRequiredLog")}function xa(){return ao("FunctionRequiredLog")}function ai(){return ao("ArrayRequiredLog")}function yl(){return ao("NonEmptyArrayLog")}function bp(){return ao("CallbackMissingLog")}function kI(){return ao("PositiveIntegerRequiredLog")}function Il(n,a){return ao("StringNotLongerThanLog",n,a)}function Mv(n,a){return ao("NumberGreaterThanLog",n,a)}function Cp(n,a){return ao("NumberGreaterOrEqualLog",n,a)}function Sp(n){return ao("KeyValueStringRequiredLog",n)}function Ua(){return ao("PlainObjectRequiredLog")}function kv(){return ao("NonEmptyContentRequiredLog")}function Cu(){return ao("FileNotSelectedLog")}function Ep(){return ao("MessageInstanceRequiredLog")}function vh(){return ao("NonAnonymousFunctionLog")}function wv(){return ao("MessageExtensionNotAvailableLog")}function Rv(){return ao("MessageReactionRequiredLog")}function wI(n,a){return ao("ContainsUnsupportedTypeLog",n,a)}function Fs(n,a,s,T){var m=T.allowUndefined,I=T.allowEmpty,T=T.maxLength;return et(n)?!!m||(St({api:a,paramName:s,desc:bu()}),!1):wt(n)?!(n.length===0&&(St({api:a,paramName:s,desc:yl()}),!I)||T&&n.length>T&&(St({api:a,paramName:s,desc:ao("MaximumArrayLengthLog",s,T)}),1)):(St({api:a,paramName:s,desc:ai()}),!1)}function Su(n,a,s,T){var m=T.allowUndefined,I=T.min,T=T.max;return et(n)?!!m||(St({api:a,paramName:s,desc:bu()}),!1):It(n)?It(I)&&n<I?(St({api:a,paramName:s,desc:I===0?Cp(s,I):Mv(s,I-1)}),!1):!(It(T)&&T<n&&(St({api:a,paramName:s,desc:ao("MaximumNumberLog",s,T)}),1)):(St({api:a,paramName:s,desc:Iu()}),!1)}function Kt(n){return{code:0,data:n||{}}}function ln(n){return Promise.resolve(Kt(n))}function De(n){var a,s=1<arguments.length&&arguments[1]!==void 0&&arguments[1];return n instanceof po?(s&&cc!==null&&cc.emit(W.ERROR,n),Promise.reject(n)):n instanceof Error?(a=new po({code:Je.UNCAUGHT_ERROR}),s&&cc!==null&&cc.emit(W.ERROR,a),Promise.reject(a)):et(n)||et(n.code)?Promise.reject(new po({code:Je.UNCAUGHT_ERROR})):(a=new po(n),s&&cc!==null&&cc.emit(W.ERROR,a),Promise.reject(a))}var Tp="unSend",Fi="success",Mp="fail",Vs="notStart",RI="pending",_h="resolved",bl="rejected",Dt={type:"String",required:!0},Bn={type:"Array",required:!0},zn={type:"Object",required:!0},Vu={type:"Boolean",required:!0},$o={type:"number",required:!0},cr={keywordListForMsg:{type:"Array",required:!1,validator:function(n,a,s){return Fs(n,a,s,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},keywordListExceptMsg:{type:"Array",required:!0,validator:function(n,a,s){return Fs(n,a,s,{allowUndefined:!1,allowEmpty:!1,maxLength:5})}},keywordListMatchType:{type:"String",required:!1,validator:function(n,a,s){return!n||n==="or"||n==="and"||St({api:a,paramName:s,desc:"".concat(n," is invalid match type")})}},cursor:{type:"String",required:!1},count:{type:"Number",required:!1,validator:function(n,a,s){return Su(n,a,s,{allowUndefined:!0,min:1,max:100})}},groupTypeList:{type:"Array",required:!1,validator:function(n,a,s){var h;return!n||!(!Fs(n,a,s,{allowUndefined:!0,allowEmpty:!0})||(h=[O.GRP_PUBLIC,O.GRP_COMMUNITY,O.GRP_WORK,O.GRP_MEETING],0<n.filter(function(m){return h.indexOf(m)===-1}).length&&(St({api:a,paramName:s,desc:wI(s,"group")}),1)))}}},ao=null,Av={hookGetAPITips:function(n){ao=n},login:{userID:Dt,userSig:Dt},addToBlacklist:{userIDList:Bn},removeFromBlacklist:{userIDList:Bn},on:[{name:"eventName",type:"String",validator:function(n,a,s){return typeof n=="string"&&n.length!==0||(St({api:a,paramName:s,desc:yu(s)}),!1)}},{name:"handler",type:"Function",validator:function(n,a,s){return typeof n!="function"?(St({api:a,paramName:s,desc:xa()}),!1):(n.name===""&&St({api:a,paramName:s,desc:vh()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(n,a,s){return typeof n=="string"&&n.length!==0||(St({api:a,paramName:s,desc:yu(s)}),!1)}},{name:"handler",type:"Function",validator:function(n,a,s){return typeof n!="function"?(St({api:a,paramName:s,desc:xa()}),!1):(n.name===""&&St({api:a,paramName:s,desc:vh()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(n,a,s){return typeof n=="string"&&n.length!==0||(St({api:a,paramName:s,desc:yu(s)}),!1)}},{name:"handler",type:"Function",validator:function(n,a,s){return typeof n!="function"?(St({api:a,paramName:s,desc:xa()}),!1):(n.name===""&&St({api:a,paramName:s,desc:vh()}),!0)}}],sendMessage:[E({name:"message"},zn)],setMessageExtensions:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return n.status===Fi&&n.isSupportExtension===!0||(St({api:a,paramName:s,desc:wv()}),!1)}}),E({name:"extensions"},Bn)],getMessageExtensions:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return n.status===Fi&&n.isSupportExtension===!0||(St({api:a,paramName:s,desc:wv()}),!1)}})],deleteMessageExtensions:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return n.status===Fi&&n.isSupportExtension===!0||(St({api:a,paramName:s,desc:wv()}),!1)}})],addMessageReaction:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return n.status===Fi||(St({api:a,paramName:s,desc:Rv()}),!1)}}),E({name:"reactionID"},Dt)],removeMessageReaction:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return n.status===Fi||(St({api:a,paramName:s,desc:Rv()}),!1)}}),E({name:"reactionID"},Dt)],getMessageReactions:{messageList:E({},Bn)},getAllUserListOfMessageReaction:{message:E(E({},zn),{},{validator:function(n,a,s){return n.status===Fi||(St({api:a,paramName:s,desc:Rv()}),!1)}}),reactionID:E({},Dt),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:E(E({},Dt),{},{validator:_l}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(n,a,s){return!(!et(n)&&!/^[1-9][0-9]*$/.test(n)&&(St({api:a,paramName:s,desc:kI()}),1))}}},getMessageListHopping:{conversationID:E(E({},Dt),{},{validator:_l}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(n,a,s){return!(!et(n)&&n!==0&&n!==1&&(St({api:a,paramName:s,desc:ao("0Or1RequiredLog")}),1))}},count:{type:"Number",validator:function(n,a,s){return!(!et(n)&&!/^[1-9][0-9]*$/.test(n)&&(St({api:a,paramName:s,desc:kI}),1))}}},setMessageRead:{conversationID:E(E({},Dt),{},{validator:_l})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(n,a,s){return!n||[O.READ_ALL_C2C_MSG,O.READ_ALL_GROUP_MSG,O.READ_ALL_MSG].indexOf(n)!==-1||(St({api:a,paramName:s,desc:ao("ValidScopeRequired")}),!1)}}},getConversationProfile:[E(E({name:"conversationID"},Dt),{},{validator:_l})],clearHistoryMessage:[E(E({name:"conversationID"},Dt),{},{validator:_l})],pinConversation:{conversationID:E(E({},Dt),{},{validator:_l}),isPinned:E({},Vu)},setConversationDraft:{conversationID:E(E({},Dt),{},{validator:_l}),draftText:{type:"String",validator:function(n,a,s){return!!_n(n)||(St({api:a,paramName:s,desc:Zi()}),!1)}}},setConversationCustomData:{conversationIDList:E({},Bn),customData:{type:"String",validator:function(n,a,s){return _n(n)?!(256<n.length&&(St({api:a,paramName:s,desc:Il(s,256)}),1)):(St({api:a,paramName:s,desc:Zi()}),!1)}}},markConversation:{conversationIDList:E({},Bn),markType:{type:"number",validator:function(n,a,s){return It(n)?n<=0?(St({api:a,paramName:s,desc:Mv(s,0)}),!1):!(n>=Math.pow(2,64)&&(St({api:a,paramName:s,desc:ao("NumberLessThanLog",s,"Math.pow(2,64)")}),1)):(St({api:a,paramName:s,desc:Iu()}),!1)}},enableMark:E({},Vu)},createConversationGroup:{conversationIDList:E({},Bn),groupName:E(E({},Dt),{},{validator:function(n,a,s){return!(!n||32<n.length&&(St({api:a,paramName:s,desc:Il(s,32)}),1))}})},deleteConversationGroup:[E({name:"groupName"},Dt)],renameConversationGroup:{oldName:E({},Dt),newName:E(E({},Dt),{},{validator:function(n,a,s){return!(!n||32<n.length&&(St({api:a,paramName:s,desc:Il(s,32)}),1))}})},addConversationsToGroup:{conversationIDList:E({},Bn),groupName:E({},Dt)},deleteConversationsFromGroup:{conversationIDList:E({},Bn),groupName:E({},Dt)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:Dt,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:Bn},createGroup:{name:Dt},joinGroup:{groupID:Dt,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[E({name:"groupID"},Dt)],handleApplication:{message:zn,handleAction:Dt,handleMessage:{type:"String"}},changeGroupOwner:{groupID:Dt,newOwnerID:Dt},updateGroupProfile:{groupID:Dt,muteAllMembers:{type:"Boolean"}},dismissGroup:[E({name:"groupID"},Dt)],searchGroupByID:[E({name:"groupID"},Dt)],getGroupOnlineMemberCount:[E({name:"groupID"},Dt)],initGroupAttributes:{groupID:Dt,groupAttributes:E(E({},zn),{},{validator:function(n,a,s){var h=!0;return Object.keys(n).forEach(function(m){if(!_n(n[m]))return St({api:a,paramName:s,desc:Sp("value")}),h=!1}),h}})},setGroupAttributes:{groupID:Dt,groupAttributes:E(E({},zn),{},{validator:function(n,a,s){var h=!0;return Object.keys(n).forEach(function(m){if(!_n(n[m]))return St({api:a,paramName:s,desc:Sp("value")}),h=!1}),h}})},deleteGroupAttributes:{groupID:Dt,keyList:{type:"Array",validator:function(n,a,s){var h;return et(n)||!wt(n)?(St({api:a,paramName:s,desc:ai()}),!1):!!Tt(n)||(h=!0,n.forEach(function(m){if(!_n(m))return St({api:a,paramName:s,desc:ao("StringArrayRequiredLog")}),h=!1}),h)}}},getGroupAttributes:{groupID:Dt,keyList:{type:"Array",validator:function(n,a,s){var h;return et(n)||!wt(n)?(St({api:a,paramName:s,desc:ai()}),!1):!!Tt(n)||(h=!0,n.forEach(function(m){if(!_n(m))return St({api:a,paramName:s,desc:Sp("key")}),h=!1}),h)}}},setGroupCounters:{groupID:Dt,counters:zn},increaseGroupCounter:{groupID:Dt,key:Dt,value:$o},decreaseGroupCounter:{groupID:Dt,key:Dt,value:$o},getGroupCounters:{groupID:Dt},getGroupMemberList:{groupID:Dt,count:{type:"Number"}},getGroupMemberProfile:{groupID:Dt,userIDList:Bn,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:Dt,userIDList:Bn},setGroupMemberRole:{groupID:Dt,userID:Dt,role:Dt},setGroupMemberMuteTime:{groupID:Dt,userID:Dt,muteTime:{type:"Number",validator:function(n){return 0<=n}}},setGroupMemberNameCard:{groupID:Dt,userID:{type:"String"},nameCard:{type:"String",validator:function(n,a,s){return _n(n)?(n.length,!0):(St({api:a,paramName:s,desc:Zi()}),!1)}}},setGroupMemberCustomField:{groupID:Dt,userID:{type:"String"},memberCustomField:Bn},deleteGroupMember:{groupID:Dt},markGroupMemberList:{groupID:Dt,markType:{type:"number",validator:function(n,a,s){return It(n)?!(n<1e3&&(St({api:a,paramName:s,desc:Cp(s,1e3)}),1)):(St({api:a,paramName:s,desc:Iu()}),!1)}},userIDList:E({},Bn),enableMark:E({},Vu)},createTextMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return On(n)?_n(n.text)?n.text.length!==0||(St({api:a,paramName:"payload.text",desc:kv()}),!1):(St({api:a,paramName:"payload.text",desc:Zi()}),!1):(St({api:a,paramName:s,desc:Ua()}),!1)}})},createTextAtMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return On(n)?_n(n.text)?n.text.length===0?(St({api:a,paramName:"payload.text",desc:kv()}),!1):!(n.atUserList&&!wt(n.atUserList)&&(St({api:a,paramName:"payload.atUserList",desc:ai()}),1)):(St({api:a,paramName:"payload.text",desc:Zi()}),!1):(St({api:a,paramName:s,desc:Ua()}),!1)}})},createCustomMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return On(n)?n.data&&!_n(n.data)?(St({api:a,paramName:"payload.data",desc:Zi()}),!1):n.description&&!_n(n.description)?(St({api:a,paramName:"payload.description",desc:Zi()}),!1):!(n.extension&&!_n(n.extension)&&(St({api:a,paramName:"payload.extension",desc:Zi()}),1)):(St({api:a,paramName:"payload",desc:Ua()}),!1)}})},createImageMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){if(!On(n))return St({api:a,paramName:s,desc:Ua()}),!1;if(et(n.file))return St({api:a,paramName:"payload.file",desc:bu()}),!1;if(Ke){if(!(n.file instanceof HTMLInputElement||_t(n.file)))return On(n.file)&&typeof uni<"u"?n.file.tempFilePaths.length!==0&&n.file.tempFiles.length!==0||(St({api:a,paramName:"payload.file",desc:Cu()}),!1):(St({api:a,paramName:"payload.file",desc:Ip()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:a,paramName:"payload.file",desc:Cu()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:bp()}),!0}}})},createAudioMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return!!On(n)||(St({api:a,paramName:s,desc:Ua()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:bp()}),!0}}},createVideoMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){if(!On(n))return St({api:a,paramName:s,desc:Ua()}),!1;if(et(n.file))return St({api:a,paramName:"payload.file",desc:bu()}),!1;if(Ke){if(!(n.file instanceof HTMLInputElement||_t(n.file)))return On(n.file)&&typeof uni<"u"?!!_t(n.file.tempFile)||(St({api:a,paramName:"payload.file",desc:Cu()}),!1):(St({api:a,paramName:"payload.file",desc:Ip()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:a,paramName:"payload.file",desc:Cu()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:bp()}),!0}}},createFaceMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return On(n)?It(n.index)?!!_n(n.data)||(St({api:a,paramName:"payload.data",desc:Zi()}),!1):(St({api:a,paramName:"payload.index",desc:Iu()}),!1):(St({api:a,paramName:s,desc:Ua()}),!1)}})},createFileMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){if(!On(n))return St({api:a,paramName:s,desc:Ua()}),!1;if(et(n.file))return St({api:a,paramName:"payload.file",desc:bu()}),!1;if(Ke){if(!(n.file instanceof HTMLInputElement||_t(n.file)))return On(n.file)&&typeof uni<"u"?n.file.tempFilePaths.length!==0&&n.file.tempFiles.length!==0||(St({api:a,paramName:"payload.file",desc:Cu()}),!1):(St({api:a,paramName:"payload.file",desc:Ip()}),!1);if(n.file instanceof HTMLInputElement&&n.file.files.length===0)return St({api:a,paramName:"payload.file",desc:Cu()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:bp()}),!0}}},createLocationMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){return On(n)?_n(n.description)?It(n.longitude)?!!It(n.latitude)||(St({api:a,paramName:"payload.latitude",desc:Iu()}),!1):(St({api:a,paramName:"payload.longitude",desc:Iu()}),!1):(St({api:a,paramName:"payload.description",desc:Zi()}),!1):(St({api:a,paramName:s,desc:Ua()}),!1)}})},createMergerMessage:{to:Dt,conversationType:Dt,payload:E(E({},zn),{},{validator:function(n,a,s){var h;return Tt(n.messageList)?(St({api:a,paramName:"payload.messageList",desc:yl()}),!1):Tt(n.compatibleText)?(St({api:a,paramName:"payload.compatibleText",desc:yu("compatibleText")}),!1):(h=!1,n.messageList.forEach(function(m){m.status===Mp&&(h=!0)}),!h||(St({api:a,paramName:"payload.messageList",desc:ao("MergeFailedMessageLog")}),!1))}})},revokeMessage:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return Tt(n)?(St({api:a,paramName:s,desc:Ep()}),!1):n.conversationType===O.CONV_SYSTEM?(St({api:a,paramName:s,desc:ao("MessageCanBeRevokedDesc")}),!1):n.isRevoked!==!0||(St({api:a,paramName:s,desc:ao("MessageRevokedLog")}),!1)}})],deleteMessage:[E(E({name:"messageList"},Bn),{},{validator:function(n,a,s){return!Tt(n)||(St({api:a,paramName:s,desc:yl()}),!1)}})],translateText:{sourceTextList:Bn,sourceLanguage:Dt,targetLanguage:Dt},convertVoiceToText:{message:E(E({},zn),{},{validator:function(n,a,s){return Tt(n)?(St({api:a,paramName:s,desc:Ep()}),!1):n.type===O.MSG_AUDIO&&n.status===Fi||(St({api:a,paramName:s,desc:ao("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return Tt(n)?(St({api:a,paramName:s,desc:Ep()}),!1):n.conversationType===O.CONV_SYSTEM?(St({api:a,paramName:s,desc:ao("MessageCanBeModifiedLog")}),!1):n._onlineOnlyFlag!==!0||(St({api:a,paramName:s,desc:ao("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:cr.keywordListForMsg,keywordListMatchType:cr.keywordListMatchType,cursor:cr.cursor,senderUserIDList:{type:"Array",required:!1,validator:function(n,a,s){return Fs(n,a,s,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},messageTypeList:{type:"Array",required:!1,validator:function(n,a,s){var h;return!n||!(!Fs(n,a,s,{allowUndefined:!0,allowEmpty:!0})||(h=[O.MSG_TEXT,O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_FILE,O.MSG_VIDEO,O.MSG_LOCATION,O.MSG_CUSTOM,O.MSG_MERGER],0<n.filter(function(m){return h.indexOf(m)===-1}).length&&(St({api:a,paramName:s,desc:wI(s,"message")}),1)))}},conversationID:{type:"String",required:!1,validator:function(n){return!n||_l(n)}},timePosition:{type:"number",required:!1,validator:function(n,a,s){return Su(n,a,s,{allowUndefined:!0,min:0})}},timePeriod:{type:"number",required:!1,validator:function(n,a,s){return Su(n,a,s,{allowUndefined:!0,min:0})}}},searchCloudUsers:{keywordList:cr.keywordListExceptMsg,keywordListMatchType:cr.keywordListMatchType,cursor:cr.cursor,count:cr.count,miniBirthday:{type:"Number",required:!1,validator:function(n,a,s){return Su(n,a,s,{allowUndefined:!0,min:0})}},maxBirthday:{type:"Number",required:!1,validator:function(n,a,s){return Su(n,a,s,{allowUndefined:!0,min:0})}},gender:{type:"String",required:!1,validator:function(n,a,s){return!n||n===O.GENDER_FEMALE||n===O.GENDER_MALE||St({api:a,paramName:s,desc:"".concat(n," is invalid match type")})}}},searchCloudGroups:{keywordList:cr.keywordListExceptMsg,keywordListMatchType:cr.keywordListMatchType,cursor:cr.cursor,count:cr.count,groupTypeList:cr.groupTypeList},searchCloudGroupMembers:{keywordList:cr.keywordListExceptMsg,keywordListMatchType:cr.keywordListMatchType,cursor:cr.cursor,count:cr.count,groupTypeList:cr.groupTypeList,groupIDList:{type:"Array",required:!1,validator:function(n,a,s){return Fs(n,a,s,{allowUndefined:!0,allowEmpty:!0})}}},getUserProfile:{userIDList:{type:"Array",validator:function(n,a,s){return wt(n)?(n.length===0&&St({api:a,paramName:s,desc:yl()}),!0):(St({api:a,paramName:s,desc:ai()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(n,a,s){return!!et(n)||!!wt(n)||(St({api:a,paramName:s,desc:ai()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(n,a,s){return!!_n(n)||(St({api:a,paramName:s,desc:Zi()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(n,a,s){return wt(n)?n.length!==0||(St({api:a,paramName:s,desc:yl()}),!1):(St({api:a,paramName:s,desc:ai()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(n,a,s){return wt(n)?n.length!==0||(St({api:a,paramName:s,desc:yl()}),!1):(St({api:a,paramName:s,desc:ai()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(n,a,s){return!n||!!wt(n)||(St({api:a,paramName:s,desc:ai()}),!1)}}},addFriend:{to:Dt,source:{type:"String",required:!0,validator:function(n,a,s){return!(!n||(n.startsWith("AddSource_Type_")?8<n.replace("AddSource_Type_","").length&&(St({api:a,paramName:s,desc:Il("keyword",8)}),1):(St({api:a,paramName:s,desc:ao("SourcePrefixLog")}),1)))}},remark:{type:"String",required:!1,validator:function(n,a,s){return!(_n(n)&&96<n.length&&(St({api:a,paramName:s,desc:Il(s,96)}),1))}}},deleteFriend:{userIDList:Bn},checkFriend:{userIDList:Bn},getFriendProfile:{userIDList:Bn},updateFriend:{userID:Dt,remark:{type:"String",required:!1,validator:function(n,a,s){return!(_n(n)&&96<n.length&&(St({api:a,paramName:s,desc:Il(s,96)}),1))}},friendCustomField:{type:"Array",required:!1,validator:function(n,a,s){var h;return!n||(wt(n)?(h=!0,n.forEach(function(m){return _n(m.key)&&m.key.indexOf("Tag_SNS_Custom")!==-1?_n(m.value)?8<m.key.replace("Tag_SNS_Custom_","").length?(St({api:a,paramName:s,desc:Il("keyword",8)}),h=!1):void 0:(St({api:a,paramName:s,desc:Sp("value")}),h=!1):(St({api:a,paramName:s,desc:ao("FriendCustomFieldPrefixLog")}),h=!1)}),h):(St({api:a,paramName:s,desc:ai()}),!1))}}},acceptFriendApplication:{userID:Dt},refuseFriendApplication:{userID:Dt},deleteFriendApplication:{userID:Dt},createFriendGroup:{name:Dt},deleteFriendGroup:{name:Dt},addToFriendGroup:{name:Dt,userIDList:Bn},removeFromFriendGroup:{name:Dt,userIDList:Bn},renameFriendGroup:{oldName:Dt,newName:Dt},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(n,a,s){return wt(n)?n.length!==0||(St({api:a,paramName:s,desc:yl()}),!1):(St({api:a,paramName:s,desc:ai()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(n,a,s){return wt(n)?n.length!==0||(St({api:a,paramName:s,desc:yl()}),!1):(St({api:a,paramName:s,desc:ai()}),!1)}}],createTopicInCommunity:{groupID:Dt,topicName:Dt},deleteTopicFromCommunity:{groupID:Dt,topicIDList:{type:"Array",validator:function(n,a,s){return!n||!!wt(n)||(St({api:a,paramName:s,desc:ai()}),!1)}}},updateTopicProfile:{groupID:Dt,topicID:Dt},getTopicList:{groupID:Dt,topicIDList:{type:"Array",validator:function(n,a,s){return!n||!!wt(n)||(St({api:a,paramName:s,desc:ai()}),!1)}}},followUser:[E({name:"userIDList"},Bn)],unfollowUser:[E({name:"userIDList"},Bn)],getMyFollowingList:[E(E({name:"startIndex"},Dt),{},{required:!1})],getMyFollowersList:[E(E({name:"startIndex"},Dt),{},{required:!1})],getMutualFollowersList:[E(E({name:"startIndex"},Dt),{},{required:!1})],getUserFollowInfo:[E(E({name:"userIDList"},Bn),{},{required:!1})],checkFollowType:[E({name:"userIDList"},Bn)],addSignalingListener:[{name:"eventName",type:"String",validator:function(n,a,s){return typeof n=="string"&&n.length!==0||(St({api:a,paramName:s,desc:yu(s)}),!1)}},{name:"handler",type:"Function",validator:function(n,a,s){return typeof n!="function"?(St({api:a,paramName:s,desc:xa()}),!1):(n.name===""&&St({api:a,paramName:s,desc:vh()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(n,a,s){return typeof n=="string"&&n.length!==0||(St({api:a,paramName:s,desc:yu(s)}),!1)}},{name:"handler",type:"Function",validator:function(n,a,s){return typeof n!="function"?(St({api:a,paramName:s,desc:xa()}),!1):(n.name===""&&St({api:a,paramName:s,desc:vh()}),!0)}}],invite:{userID:Dt},inviteSync:[E(E({},zn),{},{validator:function(n,a,s){return On(n)?!!_n(n.userID)||(St({api:a,paramName:"options.userID",desc:Zi()}),!1):(St({api:a,paramName:"options",desc:Ua()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:xa()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:xa()}),!0}}],inviteInGroup:{groupID:Dt,inviteeList:Bn},inviteInGroupSync:[E(E({},zn),{},{validator:function(n,a,s){return On(n)?_n(n.groupID)?!!wt(n.inviteeList)||(St({api:a,paramName:"options.inviteeList",desc:ai()}),!1):(St({api:a,paramName:"options.groupID",desc:Zi()}),!1):(St({api:a,paramName:"options",desc:Ua()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:xa()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(n,a,s){return et(n)&&St({api:a,paramName:s,desc:xa()}),!0}}],accept:{inviteID:Dt},reject:{inviteID:Dt},getSignalingInfo:[E(E({name:"message"},zn),{},{validator:function(n,a,s){return!Tt(n)||(St({api:a,paramName:s,desc:Ep()}),!1)}})],modifyInvitation:{inviteID:Dt,data:Dt}},kp={login:1,logout:1,getLoginUser:1,getServerTime:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,setMessageRemindType:1,setAllReceiveMessageOpt:1,getAllReceiveMessageOpt:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,searchCloudMessages:1,searchCloudUsers:1,searchCloudGroups:1,searchCloudGroupMembers:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,followUser:1,unfollowUser:1,getMyFollowingList:1,getMyFollowersList:1,getMutualFollowersList:1,getUserFollowInfo:1,checkFollowType:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},po=(S(Tu,j(Error)),p(Tu)),Je={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AV:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_ERR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AV:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AV:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AV:2661,CANNOT_JOIN_NON_AV_WITHOUT_LOGIN:2662,NOT_OWNER:2681,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AV:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,NO_PROTOCOL:2997,NO_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,NO_USE:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020},cc=null,$o=p(function n(a){u(this,n),this._m=a,this._n=""},[{key:"isLoggedIn",value:function(){return this._m.get(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.get(12).isOversea()}},{key:"isPrivateNetWork",value:function(){var n=this._m.get(12);return n.isPrivateNetWork()&&!n.getFileDownloadProxy()}},{key:"getFileDownloadProxy",value:function(){return this._m.get(12).getFileDownloadProxy()}},{key:"getDownloadFileAuthKey",value:function(){return this._m.get(12).getDownloadFileAuthKey()}},{key:"getMyUserID",value:function(){return this._m.get(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.get(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.get(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.get(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.get(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.get(12).isDevMode()}},{key:"get",value:function(n){return this._m.get(n)}},{key:"getPlatform",value:function(){return nt}},{key:"getCloudConfig",value:function(n){return this._m.get(23).getCloudConfig(n)}},{key:"emitOEvt",value:function(n,a){this._m.getOEmitInst().emit(n,a)}},{key:"emitIEvt",value:function(n,a){this._m.getIEmitInst().emit(n,a)}},{key:"getIEmitInst",value:function(){return this._m.getIEmitInst()}},{key:"req",value:function(n){return this._m.get(20).req(n)}},{key:"canIUse",value:function(n){return this._m.get(27).canIUse(n)}},{key:"getErrMsg",value:function(n,a,s){return this._m.getErrMsg(n,a,s)}},{key:"warn",value:function(n,a,s){n=this.getErrMsg(n,a,s),n&&K.w(n)}},{key:"noUse",value:function(n){var a=Je.NO_USE;return De({code:a,message:this.getErrMsg(a,n)})}}]),de={LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MSG:"getmsg",SEND_C2C_MSG:"sendmsg",SEND_GRP_MSG:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BL:"black_list_get",ADD_TO_BL:"black_list_add",RM_FROM_BL:"black_list_delete",GET_FD_LIST:"friend_get",GET_FD_PROFILE:"friend_get_specified",CHECK_FD:"friend_check",DEL_FD:"friend_delete",ADD_FD:"friend_add",UPDATE_FD:"friend_update",RESPOND_FD_APPLICATION:"friend_response",GET_FD_APPLICATION_LIST:"pendency_get",DEL_FD_APPLICATION:"pendency_delete",REFUSE_FD_APPLICATION:"pendency_refuse",REPORT_FD_APPLICATION:"pendency_report",GET_FD_GRP_LIST:"group_get",CREATE_FD_GRP:"group_add",DEL_FD_GRP:"group_delete",UPDATE_FD_GRP:"group_update",REVOKE_C2C_MSG:"msgwithdraw",SET_C2C_MSG_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MSG:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DEL_C2C_MSG:"delete_c2c_msg_ramble",MODIFY_C2C_MSG:"modify_c2c_msg",MODIFY_C2C_MSG_EXT:"set_key_values",GET_C2C_MSG_EXT:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",RM_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONV_LIST:"page_get",DEL_CONV:"batch_delete",CLEAR_HISTORY_MSG:"clear_msg",PIN_CONV:"top",DEL_GROUP_AT_TIPS:"deletemsg",SET_CONV_CUSTOM_DATA:"set_conv_custom_data",MARK_CONV:"mark_contact",CREATE_CONV_GRP:"create_contact_group",DEL_CONV_GRP:"del_contact_group",RENAME_CONV_GRP:"update_contact_group",ADD_CONV_TO_GRP:"add_conv_to_group",DEL_CONV_FROM_GRP:"del_conv_from_group",GET_CONV_GRP_LIST:"get_contact_group",SEARCH_CONV_GRP_MARK:"search_contact_group",GET_GRP_LIST:"get_joined_group_list",GET_GRP_PROFILE:"get_group_self_member_info",CREATE_GRP:"create_group",DISMISS_GRP:"destroy_group",UPDATE_GRP_PROFILE:"modify_group_base_info",APPLY_JOIN_GRP:"apply_join_group",APPLY_JOIN_GRP_NOAUTH:"apply_join_group_noauth",QUIT_GRP:"quit_group",SEARCH_GRP:"get_group_public_info",CHANGE_GRP_OWNER:"change_group_owner",HANDLE_GRP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GRP:"handle_invite_join_permission_group",HANDLE_GRP_INVITATION:"handle_invite_join_group",REVOKE_GRP_MSG:"group_msg_recall",SET_GRP_MSG_READ:"msg_read_report",SET_ALL_MSG_READ:"read_all_unread_msg",GET_GRP_ROAMING_MSG:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GRP_RECEIPTS_BY_USERS:"get_group_msg_receipts_by_users",GET_GRP_PENDENCY:"get_pendency",DEL_GRP_SYSTEM_NOTICE:"deletemsg",AV_POLLING:"get_msg",AV_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MBR_NUM:"get_online_member_num",DEL_GRP_MSG:"delete_group_ramble_msg_by_seq",MODIFY_GRP_MSG:"modify_group_msg",SET_GRP_ATTR:"set_group_attr",MODIFY_GRP_ATTR:"modify_group_attr",DEL_GRP_ATTR:"delete_group_attr",CLEAR_GRP_ATTR:"clear_group_attr",GET_GRP_ATTR:"get_group_attr",MODIFY_GRP_MSG_EXT:"group_set_key_values",GET_GRP_MSG_EXT:"group_get_key_values",GET_GRP_NOTIFY:"batch_get_group_notify",UPDATE_GRP_COUNTER:"update_group_counter",GET_GRP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",RM_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GRP_MBR_LIST:"get_group_member_info",GET_AV_MBR_LIST:"get_members",GET_GRP_MBR_PROFILE:"get_specified_group_member_info",ADD_GRP_MBR:"add_group_member",DEL_GRP_MBR:"delete_group_member",BAN_AV_MBR:"ban_group_member",MODIFY_GRP_MBR_INFO:"modify_group_member_info",MARK_AV_MBR_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MSG_PUSH:"msg_push",CS:"query",GRP_CS:"query_grp",MBR_CS:"query_grp_member",USER_CS:"query_user",MULTI_MSG_PUSH:"multi_msg_push_ws",MSG_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MSG:"save_relay_json_msg",DOWNLOAD_MERGER_MSG:"get_relay_json_msg",FETCH_CLOUD_CTRL_CONFIG:"fetch_config",PUSHED_CLOUD_CTRL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DEL_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUB_USER_STATUS:"ws_status_subscribe",UNSUB_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PUSH_REPORT:"uniapp_sdk_report",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition",FOLLOW:"follow_add",UNFOLLOW:"follow_delete",GET_FOLLOW:"follow_get",GET_FOLLOW_INFO:"follow_get_info",CHECK_FOLLOW_TYPE:"follow_check",SET_ALL_RECEIVE_MSG_OPT:"ws_set_do_not_disturb",GET_ALL_RECEIVE_MSG_OPT:"ws_get_do_not_disturb"},yh="networkRTT",Eu="messageE2EDelay",as="sendMessageC2C",Gs="sendMessageGroup",uc="sendMessageGroupAV",Fa="sendMessageRichMedia",Si="cosUpload",dc="messageReceivedGroup",Ih="messageReceivedGroupAVPush",ss="messageReceivedGroupAVPull",o1=_(_(_(_(_(_(_(_(_(_({},yh,2),Eu,3),as,4),Gs,5),uc,6),Fa,7),dc,8),Ih,9),ss,10),Si,11),r1={info:4,warning:5,error:6},ls={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},i1={login:4,plugin_search:16,plugin_translate:16,plugin_voice_to_text:16,plugin_cs:16,plugin_push:16,plugin_bot:16,plugin_emoji_reaction:16,tui_key_features:16},ct=p(wp,[{key:"updateTimeStamp",value:function(){this.timestamp=Dn()}},{key:"start",value:function(n){return this._startts=n,this}},{key:"end",value:function(){var n,a=this,s=0<arguments.length&&arguments[0]!==void 0&&arguments[0];this._sentFlag||(this._netMonitorModule&&(n=this._netMonitorModule.getNetworkType(),this.setNetworkType(n)),n=Dn(),this.costTime===0&&(this.costTime=n-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(n)),s?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout(function(){a._sentFlag=!0,a._eventStatModule&&a._eventStatModule.pushIn(a)},0))}},{key:"setError",value:function(n){var a;return n instanceof Error?this._sentFlag||(a=!0,(a=this._netMonitorModule?this._netMonitorModule.isOnline():a)?(n.code&&this.setCode(n.code),n.message&&this.setMoreMessage(n.message)):this.setCode(Je.NO_NETWORK),this.setLevel("error")):K.w("".concat(this._n,".setError value not instanceof Error, please check!")),this}},{key:"setCode",value:function(n){return et(n)||this._sentFlag||(n==="ECONNABORTED"&&(this.code=103),It(n)?this.code=n:K.w("".concat(this._n,".setCode value not a number, please check!"),n,H(n))),this}},{key:"setMessage",value:function(n){return et(n)||this._sentFlag||(It(n)&&(this.message=n.toString()),_n(n)&&(this.message=n)),this}},{key:"setCostTime",value:function(n){return this.costTime=n,this}},{key:"setLevel",value:function(n){return et(n)||this._sentFlag||(this.level=r1[n]),this}},{key:"setMoreMessage",value:function(n){return Tt(this.moreMessage)?this.moreMessage="".concat(n):this.moreMessage+=" ".concat(n),this}},{key:"setNetworkType",value:function(n){return et(n)?K.w("".concat(this._n,".setNetworkType value is undefined, please check!")):(n=ls[n.toLowerCase()],et(n)||(this.networkType=n)),this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(n){return this.uiPlatform=n,this}},{key:"setExtension",value:function(n){return this.extension=n,this}},{key:"setEventType",value:function(n){return this.eventType=n,this}}],[{key:"bindEventStatModule",value:function(n){wp.prototype._eventStatModule=n}},{key:"bindNetMonitorModule",value:function(n){wp.prototype._netMonitorModule=n}}]),Dv=p(function n(a){u(this,n),this.type=O.MSG_TEXT,this.content={text:a.text||""}},[{key:"setText",value:function(n){this.content.text=n}},{key:"sendable",value:function(){return this.content.text.length!==0}}]);function wp(n){u(this,wp),this._n="SSOLogData",this.eventType=i1[n]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=n,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Dn()}function Tu(m){u(this,Tu),a=c(this,Tu);var a,s=m.code,h=m.message,m=m.data;return a.code=s,h?a.message=h:a._getErrMsg&&(a.message=a._getErrMsg(a.code)),a.data=m||{},a}function Xo(n,a,s,I){var m,I=3<arguments.length&&I!==void 0?I:[];return n&&(m=n,a&&(n.startsWith("http://")?m=n.replace(/^http:\/\/[^/]+/,a):n.startsWith("https://")&&(m=n.replace(/^https:\/\/[^/]+/,a))),s&&m.indexOf("authKey=")===-1&&hc(m,I)?(-1<m.indexOf("?")?"".concat(m,"&authKey="):"".concat(m,"?authKey=")).concat(s):m)}function Rp(n,a,m){var h=2<arguments.length&&m!==void 0?m:[],m=a[0].content||a[0].payload;return n===O.MSG_IMAGE?m.imageInfoArray.forEach(function(I){hc(I.imageUrl,h)&&(I.imageUrl=Mu(I.imageUrl))}):n===O.MSG_VIDEO?(hc(m.snapshotUrl,h)&&(m.snapshotUrl=Mu(m.snapshotUrl),m.thumbUrl=Mu(m.thumbUrl)),hc(m.remoteVideoUrl,h)&&(m.remoteVideoUrl=Mu(m.remoteVideoUrl))):n===O.MSG_AUDIO?hc(m.remoteAudioUrl,h)&&(m.remoteAudioUrl=Mu(m.remoteAudioUrl)):n===O.MSG_FILE?hc(m.fileUrl,h)&&(m.fileUrl=Mu(m.fileUrl)):n===O.MSG_MERGER&&(n=(m=a[0].content||a[0].payload).downloadKey,m=(m=m.messageList)===void 0?[]:m,Tt(n===void 0?"":n))&&m.forEach(function(I){Rp(I.messageBody[0].type,I.messageBody,h)}),a}function Mu(n){if(!n||n.indexOf("authKey=")===-1)return n;for(var n=n.split("?"),a=n[1].split("&"),s=0,h=0;h<a.length;h++)if(-1<a[h].indexOf("authKey=")){s=h;break}return a.splice(s,1),0<a.length?"".concat(n[0],"?").concat(a.join("&")):n[0]}function hc(n,a){var s=!1;if(n){var n=n.match(/:\/\/([0-9]?\.)?(.[^/:]+)/),h=n&&n[2]||"";if(h.includes("rich-dev"))return 1;for(var m=0;m<a.length;m++)if(h.endsWith(a[m])){s=!0;break}}return s}var ku=p(function n(a,s,h,m){u(this,n),this._imageMemoryURL="",this._fileDownloadProxy=s,this._authKey=h,this._fileDNList=m,_e||Re?this.createImageDataASURL(a.file):this.createImageDataASURLInWeb(a.file),this._initImageInfoModel(),this.type=O.MSG_IMAGE,this._percent=0,this.content={imageFormat:a.imageFormat||ri.UNKNOWN,uuid:a.uuid,imageInfoArray:[]},this.initImageInfoArray(a.imageInfoArray),this._autoFixUrl()},[{key:"_initImageInfoModel",value:function(){var n=this;this._ImageInfoModel=function(a){this.instanceID=hn(9999999),this.sizeType=a.type||0,this.type=0,this.size=a.size||0,this.width=a.width||0,this.height=a.height||0,this.imageUrl=a.imageUrl||a.url||"",this.url=Xo(a.url||n._imageMemoryURL,n._fileDownloadProxy,n._authKey,n._fileDNList)},this._ImageInfoModel.prototype={setSizeType:function(a){this.sizeType=a},setType:function(a){this.type=a},setImageUrl:function(a){a&&(this.imageUrl=Xo(a,n._fileDownloadProxy,n._authKey,n._fileDNList))},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(n){for(var a,s=0,h=null;s<=2;)a=et(n)||et(n[s])?{type:0,size:0,width:0,height:0,url:""}:n[s],(h=new this._ImageInfoModel(a)).setSizeType(s+1),h.setType(s),this.addImageInfo(h),s++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(n){for(var a,s=this.content.imageInfoArray.length,h=0;h<s;h++)a=this.content.imageInfoArray[h],n[h].size&&(a.size=n[h].size),n[h].url&&a.setImageUrl(n[h].url),n[h].width&&(a.width=n[h].width),n[h].height&&(a.height=n[h].height)}},{key:"_autoFixUrl",value:function(){for(var n=this.content.imageInfoArray.length,a="",s="",h=["http","https"],m=null,I=0;I<n;I++)this.content.imageInfoArray[I].url&&(m=this.content.imageInfoArray[I]).imageUrl!==""&&(s=m.imageUrl.slice(0,m.imageUrl.indexOf("://")+1),a=m.imageUrl.slice(m.imageUrl.indexOf("://")+1),h.indexOf(s)<0&&(s="https:"),this.content.imageInfoArray[I].setImageUrl([s,a].join("")))}},{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateImageFormat",value:function(n){this.content.imageFormat=ri[n.toUpperCase()]||ri.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(n){n!==void 0&&0<n.files.length&&(this._imageMemoryURL=window.URL.createObjectURL(n.files[0]))}},{key:"createImageDataASURL",value:function(n){n&&n.url&&(this._imageMemoryURL=n.url)}},{key:"replaceImageInfo",value:function(n,a){this.content.imageInfoArray[a]instanceof this._ImageInfoModel||(this.content.imageInfoArray[a]=n)}},{key:"addImageInfo",value:function(n){3<=this.content.imageInfoArray.length||this.content.imageInfoArray.push(n)}},{key:"updateAccessSideImageInfoArray",value:function(){var n=this.content.imageInfoArray,s=n[0],a=s.width,a=a===void 0?0:a,s=s.height,s=s===void 0?0:s;a!==0&&s!==0&&(CI(n),Object.assign(n[2],fh({originWidth:a,originHeight:s,min:720})))}},{key:"sendable",value:function(){return this.content.imageInfoArray.length!==0&&this.content.imageInfoArray[0].imageUrl!==""&&this.content.imageInfoArray[0].size!==0}}]),Ov=p(function n(a){u(this,n),this.type=O.MSG_FACE,this.content=a||null},[{key:"sendable",value:function(){return this.content!==null}}]),Qi=p(function n(a,s,h,m){u(this,n),this.type=O.MSG_AUDIO,this._percent=0,this._fileDownloadProxy=s,this._authKey=h,this._fileDNList=m,this.content={downloadFlag:2,second:a.second,size:a.size,url:Xo(a.url,this._fileDownloadProxy,this._authKey,this._fileDNList),remoteAudioUrl:Xo(a.url||"",this._fileDownloadProxy,this._authKey,this._fileDNList),uuid:a.uuid}},[{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateAudioUrl",value:function(n){this.content.remoteAudioUrl=Xo(n,this._fileDownloadProxy,this._authKey,this._fileDNList)}},{key:"sendable",value:function(){return this.content.remoteAudioUrl!==""}}]),wu={from:!0,groupID:!0,groupName:!0,to:!0},pi=p(function n(a){u(this,n),this.type=O.MSG_GRP_TIP,this.content={},this._initContent(a)},[{key:"_initContent",value:function(n){var a=this;Object.keys(n).forEach(function(s){switch(s){case"remarkInfo":break;case"groupProfile":a.content.groupProfile={},a._initGroupProfile(n[s]);break;case"operatorInfo":a.content.operatorInfo={},a._initOperatorInfo(n[s]);break;case"memberInfoList":case"msgMemberInfo":a._updateMemberList(n[s]);break;case"memberExtraInfo":case"onlineMemberInfo":break;case"memberNum":a.content[s]=n[s],a.content.memberCount=n[s];break;case"newGroupProfile":a.content.newGroupProfile={},a._initNewGroupProfile(n[s]);break;default:a.content[s]=n[s]}}),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(n){for(var a=Object.keys(n),s=0;s<a.length;s++){var h=a[s];wu[h]&&(this.content.groupProfile[h]=n[h])}}},{key:"_initOperatorInfo",value:function(n){for(var a=Object.keys(n),s=0;s<a.length;s++){var h=a[s];this.content.operatorInfo[h]=n[h]}}},{key:"_updateMemberList",value:function(n){Tt(this.content.memberList)?this.content.memberList=n:this.content.memberList.forEach(function(a){n.forEach(function(s){a.userID===s.userID&&Object.assign(a,s)})})}},{key:"_initNewGroupProfile",value:function(n){for(var a=Object.keys(n),s=0;s<a.length;s++){var h=a[s];this.content.newGroupProfile[h]=h!=="muteAllMembers"?n[h]:n[h]===1}}}]),bh={from:!0,groupID:!0,groupName:!0,to:!0,groupType:!0},Ap=p(function n(a){u(this,n),this.type=O.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(a)},[{key:"_initContent",value:function(n){var a=this;Object.keys(n).forEach(function(s){switch(s){case"memberInfoList":break;case"remarkInfo":a.content.handleMessage=n[s];break;case"groupProfile":a.content.groupProfile={},a._initGroupProfile(n[s]);break;default:a.content[s]=n[s]}})}},{key:"_initGroupProfile",value:function(n){for(var a=Object.keys(n),s=0;s<a.length;s++){var h=a[s];bh[h]&&(h==="groupName"?this.content.groupProfile.name=n[h]:this.content.groupProfile[h]=n[h])}}}]),Ch=p(function n(a,s,h,m){u(this,n),this.type=O.MSG_FILE,this._percent=0;var I=this._getFileInfo(a);this.content={downloadFlag:2,fileUrl:Xo(a.url||a.fileUrl,s,h,m)||"",uuid:a.uuid,fileName:I.name||"",fileSize:I.size||0}},[{key:"_getFileInfo",value:function(n){var a,s;return et(n.fileName)||et(n.fileSize)?(a=n.file.files[0],Qe&&(a.path&&a.path.indexOf(".")!==-1&&(s=a.path.slice(a.path.lastIndexOf(".")+1).toLowerCase(),a.type=s,a.name||(a.name="".concat(hn(999999),".").concat(s))),a.name||(a.type="",a.name=a.path.slice(a.path.lastIndexOf("/")+1).toLowerCase()),a.suffix&&(a.type=a.suffix),a.url||(a.url=a.path)),{size:a.size,name:a.name}):{size:n.fileSize,name:n.fileName}}},{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateFileUrl",value:function(n){this.content.fileUrl=n}},{key:"sendable",value:function(){return this.content.fileUrl!==""&&this.content.fileName!==""&&this.content.fileSize!==0}}]),Dp=p(function n(a){u(this,n),this.type=O.MSG_CUSTOM,this.content={data:a.data||"",description:a.description||"",extension:a.extension||""}},[{key:"setData",value:function(n){return this.content.data=n,this}},{key:"setDescription",value:function(n){return this.content.description=n,this}},{key:"setExtension",value:function(n){return this.content.extension=n,this}},{key:"sendable",value:function(){return this.content.data.length!==0||this.content.description.length!==0||this.content.extension.length!==0}}]),Op=p(function n(a,s,h,m){u(this,n),this.type=O.MSG_VIDEO,this._percent=0,this._fileDownloadProxy=s,this._authKey=h,this._fileDNList=m,this.content={remoteVideoUrl:Xo(a.remoteVideoUrl||a.videoUrl||"",this._fileDownloadProxy,this._authKey,this._fileDNList),videoFormat:a.videoFormat,videoSecond:parseInt(a.videoSecond,10),videoSize:a.videoSize,videoUrl:Xo(a.videoUrl,this._fileDownloadProxy,this._authKey,this._fileDNList),videoDownloadFlag:2,videoUUID:a.videoUUID,thumbUUID:a.thumbUUID,thumbFormat:a.thumbFormat,thumbWidth:a.thumbWidth,snapshotWidth:a.thumbWidth,thumbHeight:a.thumbHeight,snapshotHeight:a.thumbHeight,thumbSize:a.thumbSize,snapshotSize:a.thumbSize,thumbDownloadFlag:2,thumbUrl:Xo(a.thumbUrl,this._fileDownloadProxy,this._authKey,this._fileDNList),snapshotUrl:Xo(a.thumbUrl,this._fileDownloadProxy,this._authKey,this._fileDNList)}},[{key:"updatePercent",value:function(n){this._percent=n,1<this._percent&&(this._percent=1)}},{key:"updateVideoUrl",value:function(n){n&&(this.content.remoteVideoUrl=Xo(n,this._fileDownloadProxy,this._authKey,this._fileDNList))}},{key:"updateSnapshotInfo",value:function(h){var a=h.snapshotUrl,s=h.snapshotWidth,h=h.snapshotHeight;Tt(a)||(this.content.thumbUrl=this.content.snapshotUrl=a),Tt(s)||(this.content.thumbWidth=this.content.snapshotWidth=Number(s)),Tt(h)||(this.content.thumbHeight=this.content.snapshotHeight=Number(h))}},{key:"sendable",value:function(){return this.content.remoteVideoUrl!==""}}]),Lv=p(function n(m){u(this,n),this.type=O.MSG_LOCATION;var s=m.description,h=m.longitude,m=m.latitude;this.content={description:s,longitude:h,latitude:m}},[{key:"sendable",value:function(){return!0}}]),AI=p(function n(a,s,h,m){var I,T;u(this,n),this.from=a.from,this.messageSender=a.from,this.time=a.time,this.messageSequence=a.sequence,this.clientSequence=a.clientSequence||a.sequence,this.messageRandom=a.random,this.cloudCustomData=a.cloudCustomData||"",this.clientTime=a.clientTime||void 0,a.ID?(this.ID=a.ID||"",this.nick=a.nick||"",this.avatar=a.avatar||"",a.messageBody?this.messageBody=JSON.parse(JSON.stringify(a.messageBody)):this.messageBody=[{type:a.type,payload:a.payload}],a.conversationType?a.conversationType.startsWith(O.CONV_C2C)?this.receiverUserID=a.to:a.conversationType.startsWith(O.CONV_GROUP)&&(this.receiverGroupID=a.to):a.receiverGroupID?this.receiverGroupID=a.receiverGroupID:a.receiverUserID&&(this.receiverUserID=a.receiverUserID),this.messageReceiver=a.to||a.messageReceiver):(this.nick=a.nick||"",this.avatar=a.avatar||"",this.messageBody=[],I=a.elements[0].type,T=a.elements[0].content,this._patchRichMediaPayload(I,T),this._updateRichMediaDownloadUrl(I,T,s,h,m),I===O.MSG_MERGER?this.messageBody.push({type:I,payload:new Lp(T,s,h,m).content}):this.messageBody.push({type:I,payload:T}),a.groupID&&(this.receiverGroupID=a.groupID,this.messageReceiver=a.groupID),a.to&&(this.receiverUserID=a.to,this.messageReceiver=a.to),this.ID="".concat(a.tinyID,"-").concat(a.clientTime,"-").concat(a.random))},[{key:"_patchRichMediaPayload",value:function(n,a){n===O.MSG_IMAGE?a.imageInfoArray.forEach(function(s){!s.imageUrl&&s.url&&(s.imageUrl=s.url,s.sizeType=s.type,s.type===1?s.type=0:s.type===3&&(s.type=1))}):n===O.MSG_VIDEO?!a.remoteVideoUrl&&a.videoUrl&&(a.remoteVideoUrl=a.videoUrl):n===O.MSG_AUDIO?!a.remoteAudioUrl&&a.url&&(a.remoteAudioUrl=a.url):n===O.MSG_FILE&&!a.fileUrl&&a.url&&(a.fileUrl=a.url,a.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(n,a,s,h,m){(s||h)&&(n===O.MSG_IMAGE?a.imageInfoArray.forEach(function(I){I.imageUrl=Xo(I.imageUrl,s,h,m),I.url=Xo(I.url,s,h,m)}):n===O.MSG_VIDEO?(a.remoteVideoUrl=Xo(a.remoteVideoUrl,s,h,m),a.videoUrl=Xo(a.videoUrl,s,h,m),a.thumbUrl=Xo(a.thumbUrl,s,h,m),a.snapshotUrl=Xo(a.thumbUrl,s,h,m),a.snapshotHeight=a.thumbHeight,a.snapshotWidth=a.thumbWidth):n===O.MSG_AUDIO?(a.remoteAudioUrl=Xo(a.remoteAudioUrl,s,h,m),a.url=Xo(a.url,s,h,m)):n===O.MSG_FILE&&(a.fileUrl=Xo(a.fileUrl,s,h,m)))}}]),Lp=p(function n(a,s,h,m){var I,T,D,V,$,q,se;u(this,n),this.type=O.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},a.downloadKey?(T=a.downloadKey,D=a.pbDownloadKey,V=a.title,$=a.abstractList,q=a.compatibleText,I=a.version,this.content.downloadKey=T,this.content.pbDownloadKey=D,this.content.title=V,this.content.abstractList=$,this.content.compatibleText=q,this.content.version=I||0):Tt(a.messageList)?a.layersOverLimit===1&&(this.content.layersOverLimit=!0):(T=a.messageList,D=a.title,V=a.abstractList,$=a.compatibleText,q=a.version,se=[],T.forEach(function(me){Tt(me)||(me=new AI(me,s,h,m),se.push(me))}),this.content.messageList=se,this.content.title=D,this.content.abstractList=V,this.content.compatibleText=$,this.content.version=q||0)},[{key:"sendable",value:function(){return!Tt(this.content.messageList)||!Tt(this.content.downloadKey)}}]),Nv={1:O.MSG_PRIORITY_HIGH,2:O.MSG_PRIORITY_NORMAL,3:O.MSG_PRIORITY_LOW,4:O.MSG_PRIORITY_LOWEST},_r=p(function n(a){u(this,n),this.ID="",this.conversationID=a.conversationID||null,this.conversationType=a.conversationType||O.CONV_C2C,this.conversationSubType=a.conversationSubType,this.time=a.time||Math.ceil(Date.now()/1e3),this.sequence=a.sequence||0,this.clientSequence=a.clientSequence||a.sequence||0,this.random=a.random||a.random===0?a.random:hn(),this.priority=this._computePriority(a.priority),this.nick=a.nick||"",this.avatar=a.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=MI(a.checkResult),this._elements=[],this.isPlaceMessage=a.isPlaceMessage||0,this.isRevoked=a.isPlaceMessage===2||a.msgFlagBits===8,this.from=a.from||null,this.to=a.to||null,this.flow="",this.isSystemMessage=a.isSystemMessage||!1,this.protocol=a.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=a.status||Fi,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=a.cloudCustomData||"",this.isDeleted=!1,this.isModified=!!a.messageVersion,this._isExcludedFromUnreadCount=!(!a.messageControlInfo||a.messageControlInfo.excludedFromUnreadCount!==1),this._isExcludedFromLastMessage=!(!a.messageControlInfo||a.messageControlInfo.excludedFromLastMessage!==1),this.clientTime=a.clientTime||ot()||0,this.senderTinyID=a.senderTinyID||a.tinyID||"",this.readReceiptInfo=a.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0,timestamp:0},this.needReadReceipt=a.needReadReceipt===!0||a.needReadReceipt===1,this.version=a.messageVersion||0,this.isBroadcastMessage=a.isBroadcastMessage||!1,this._receiverList=a.receiverList||void 0,this.isSupportExtension=a.isSupportExtension===!0||a.isSupportExtension===1,this._cmConfigID=a.customModerationConfigurationID,this.revoker=a.revokerInfo&&a.revokerInfo.revoker||"",this.revokerInfo=a.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=a.revokeReason||"",this.reInitialize(a.currentUser),this.extractGroupInfo(a.groupProfile||null),this.handleGroupAtInfo(a),this.initC2CReadReceiptInfo(a)},[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(n){n!==null&&(_n(n.nick)&&(this.nick=n.nick),_n(n.avatar)&&(this.avatar=n.avatar),n=n.messageFromAccountExtraInformation,On(n))&&_n(n.nameCard)&&(this.nameCard=n.nameCard)}},{key:"handleGroupAtInfo",value:function(n){var a=this;n.payload&&n.payload.atUserList&&n.payload.atUserList.forEach(function(s){s!==O.MSG_AT_ALL?(a._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:s}),a.atUserList.push(s)):(a._groupAtInfoList.push({groupAtAllFlag:1}),a.atUserList.push(O.MSG_AT_ALL))}),wt(n.groupAtInfo)&&n.groupAtInfo.forEach(function(s){s.groupAtAllFlag===0?a.atUserList.push(s.groupAtUserID):s.groupAtAllFlag===1&&a.atUserList.push(O.MSG_AT_ALL)})}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(n){n&&(this.status=this.from?Fi:Tp,!this.from)&&(this.from=n),this._initFlow(n),this._initSequence(n),this._concatConversationID(n),this.generateMessageID()}},{key:"isSendable",value:function(){return this._elements.length!==0&&(this._relayFlag===!0||typeof this._elements[0].sendable=="function"&&this._elements[0].sendable())}},{key:"_initTo",value:function(n){this.conversationType===O.CONV_GROUP&&(this.to=n.groupID)}},{key:"_initSequence",value:function(n){var a,s,h;this.clientSequence===0&&n&&(this.clientSequence=!!(n=n)&&(uh[n]===void 0&&(h=new Date,a="3".concat(h.getHours()).slice(-2),s="0".concat(h.getMinutes()).slice(-2),h="0".concat(h.getSeconds()).slice(-2),uh[n]=parseInt([a,s,h,"0001"].join("")),h=s=a=null,K.l("autoIncrementIndex start index:".concat(uh[n]))),uh[n]++)),this.sequence===0&&this.conversationType===O.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===O.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(n){n!==""&&(n===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(n){var a=this.to,s=this.conversationType;s!==O.CONV_SYSTEM?(n=s===O.CONV_C2C?n===this.from?a:this.from:this.to,this.conversationID=n?"".concat(s).concat(n):null):this.conversationID=O.CONV_SYSTEM}},{key:"isElement",value:function(n){return n instanceof Dv||n instanceof ku||n instanceof Ov||n instanceof Qi||n instanceof Ch||n instanceof Op||n instanceof pi||n instanceof Ap||n instanceof Dp||n instanceof Lv||n instanceof Lp}},{key:"setElement",value:function(n,a,s,h){var m=this;if(this.isElement(n))this._elements=[n];else{var I=function(D){if(D.type&&D.content)switch(D.type){case O.MSG_TEXT:m.setTextElement(D.content);break;case O.MSG_IMAGE:m.setImageElement(D.content,a,s,h);break;case O.MSG_AUDIO:m.setAudioElement(D.content,a,s,h);break;case O.MSG_FILE:m.setFileElement(D.content,a,s,h);break;case O.MSG_VIDEO:m.setVideoElement(D.content,a,s,h);break;case O.MSG_CUSTOM:m.setCustomElement(D.content);break;case O.MSG_LOCATION:m.setLocationElement(D.content);break;case O.MSG_GRP_TIP:m.setGroupTipElement(D.content);break;case O.MSG_GRP_SYS_NOTICE:m.setGroupSystemNoticeElement(D.content);break;case O.MSG_FACE:m.setFaceElement(D.content);break;case O.MSG_MERGER:m.setMergerElement(D.content,a,s,h)}};if(wt(n))for(var T=0;T<n.length;T++)I(n[T]);else I(n)}this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(n){n=typeof n=="string"?n:n.text,n=new Dv({text:n}),this._elements.push(n)}},{key:"setImageElement",value:function(n,a,s,h){n=new ku(n,a,s,h),this._elements.push(n)}},{key:"setAudioElement",value:function(n,a,s,h){n=new Qi(n,a,s,h),this._elements.push(n)}},{key:"setFileElement",value:function(n,a,s,h){n=new Ch(n,a,s,h),this._elements.push(n)}},{key:"setVideoElement",value:function(n,a,s,h){n=new Op(n,a,s,h),this._elements.push(n)}},{key:"setLocationElement",value:function(n){n=new Lv(n),this._elements.push(n)}},{key:"setCustomElement",value:function(n){n=new Dp(n),this._elements.push(n)}},{key:"setGroupTipElement",value:function(n){var a,s={},h=n.operationType;Tt(n.memberInfoList)?n.operatorInfo&&(s=n.operatorInfo):h!==O.GRP_TIP_MBR_JOIN&&h!==O.GRP_TIP_MBR_KICKED_OUT&&h!==O.GRP_TIP_MBR_SET_ADMIN&&h!==O.GRP_TIP_MBR_CANCELED_ADMIN||(s=n.memberInfoList[0]),Tt(n.memberExtraInfo)||(a=n.memberExtraInfo.reason,n.msgMemberInfo.forEach(function(m){m.reason=a})),h=s.nick,s=s.avatar,_n(h)&&(this.nick=h),_n(s)&&(this.avatar=s),h=new pi(n),this._elements.push(h)}},{key:"setGroupSystemNoticeElement",value:function(n){n=new Ap(n),this._elements.push(n)}},{key:"setFaceElement",value:function(n){n=new Ov(n),this._elements.push(n)}},{key:"setMergerElement",value:function(n,a,s,h){n=new Lp(n,a,s,h),this._elements.push(n)}},{key:"setIsRead",value:function(n){this.isRead=n}},{key:"setRelayFlag",value:function(n){this._relayFlag=n}},{key:"_computePriority",value:function(n){if(!et(n)){if(_n(n)&&Object.values(Nv).indexOf(n)!==-1)return n;if(It(n)&&(n=""+n,Object.keys(Nv).indexOf(n)!==-1))return Nv[n]}return O.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(s){var a=s.nick,s=s.avatar;_n(a)&&(this.nick=a),_n(s)&&(this.avatar=s)}},{key:"setNameCard",value:function(n){_n(n)&&(this.nameCard=n)}},{key:"initC2CReadReceiptInfo",value:function(s){var a=s.readReceiptSentByPeer,s=s.timestamp,s=s===void 0?0:s;this.conversationType===O.CONV_C2C&&this.needReadReceipt===!0&&(this.readReceiptInfo.isPeerRead=(a===void 0?void 0:a)===1,this.readReceiptInfo.timestamp=s)}}]),a1=["sound","FCMChannelID"];function Np(n){if(On(n))return{pushFlag:n.disablePush===!0?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:(s=(s=(a=n).apnsInfo)===void 0?{}:s,h=a.ignoreIOSBadge,a=a.disableVoipPush,h=s.ignoreIOSBadge===!0||(h!==void 0&&h)===!0?1:0,m=void 0,et(a)||(m=a===!1?1:0),et(s.disableVoipPush)||(m=s.disableVoipPush===!1?1:0),E(E({},s),{},{badgeMode:h,isVoipPush:m})),androidInfo:(s=(s=(a=n).androidInfo)===void 0?{}:s,a=a.androidOPPOChannelID,a=s.OPPOChannelID||(a===void 0?"":a),h=(h=s.sound)===void 0?"":h,m=(m=s.FCMChannelID)===void 0?"":m,E(E({},N(s,a1)),{},{Sound:(h=(s=h).lastIndexOf("."))===-1?s:s.slice(0,h),OPPOChannelID:a,GoogleChannelID:m}))};var a,s,h,m}S(xp,$o);var s1=p(xp,[{key:"onNewMessage",value:function(s){var I=s.dataList,a=s.isInstantMessage,h=s.C2CRemainingUnreadList,m=s.C2CPairUnreadList,s=s.isSyncingEnded,I=(a||K.l("".concat(this._n,".onNewMessage C2CPairUnreadList:"),m,"C2CRemainingUnreadList:",h),this._assembly({dataList:I,C2CRemainingUnreadList:h,C2CPairUnreadList:m,isInstantMessage:a})),h=I.conversationOptionsList,m=I.messageList,I=I.isUnreadC2CMessage,T=Cv(m),T=(0<T.length&&this.emitOEvt(W.MESSAGE_MODIFIED,T),this.get(11).onNewMessage({conversationOptionsList:h,isInstantMessage:a,isUnreadC2CMessage:I,isSyncingEnded:s}),Sv(m));a&&0<T.length&&this.emitOEvt(W.MESSAGE_RECEIVED,T),m.length=0}},{key:"_assembly",value:function(n){for(var a=n.dataList,s=n.C2CRemainingUnreadList,h=n.C2CPairUnreadList,m=n.isInstantMessage,I=null,T=[],D=[],V={},$=this.get(26),q=!1,se=this.get(11),me=this.get(4),n=this.get(17),fe=this.getFileDownloadProxy(),He=this.getDownloadFileAuthKey(),Xe=n.getFileDNList(),Ye=0,Lt=a.length;Ye<Lt;Ye++)if(this._isC2CNotice(a[Ye]))this._noticeFromUnreadDBList.push(a[Ye].eventArray[0].c2CNotifyMsgArray[0]);else{var yt=a[Ye],rn=(yt.currentUser=this.getMyUserID(),yt.conversationType=O.CONV_C2C,yt.isSystemMessage=!!yt.isSystemMessage,(et(yt.nick)||et(yt.avatar))&&(q=!0),(I=new _r(yt)).setElement(yt.elements,fe,He,Xe),I.setNickAndAvatar({nick:yt.nick,avatar:yt.avatar}),I.conversationID);if(m){if(this._msgFromUnreadDBMap.get(I.ID))continue;var on,Pn,Gn=!1,Jn=(I.from!==this.getMyUserID()?(Pn=se.getLatestMessageSentByPeer(rn))&&(on=Pn.nick,Pn=Pn.avatar,q?I.setNickAndAvatar({nick:on,avatar:Pn}):on===I.nick&&Pn===I.avatar||(Gn=!0)):(on=se.getLatestMessageSentByMe(rn))&&(Pn=on.nick,Jn=on.avatar,Pn===I.nick&&Jn===I.avatar||(se.modifyMessageSentByMe({conversationID:rn,latestNick:I.nick,latestAvatar:I.avatar}),me.mockOnNickAvatarModified(I.nick,I.avatar))),a[Ye].isModified===1);if(se.isMessageSentByCurrentInstance(I)?I.isModified=Jn:Jn=!1,yt.msgLifeTime===0)I._onlineOnlyFlag=!0,se.isMessageSentByCurrentInstance(I)||D.push(I);else{if(!se.pushIntoMessageList(D,I,Jn))continue;Gn&&(se.modifyMessageSentByPeer({conversationID:rn,latestNick:I.nick,latestAvatar:I.avatar}),se.updateUserProfileSpecifiedKey({conversationID:rn,nick:I.nick,avatar:I.avatar}))}m&&0<I.clientTime&&$.addMessageDelay(I.clientTime)}else this._msgFromUnreadDBMap.set(I.ID,I);if(yt.msgLifeTime!==0){if(I._onlineOnlyFlag===!1){if(Gn=se.getLastMessageTime(rn),It(Gn)&&I.time<Gn)continue;m&&(et(V[rn])?(yt=0,I.flow!=="in"||I._isExcludedFromUnreadCount||(yt=1),V[rn]=T.push({conversationID:rn,unreadCount:yt,type:I.conversationType,subType:I.conversationSubType,lastMessage:I._isExcludedFromLastMessage?"":I})-1):(yt=V[rn],T[yt].type=I.conversationType,T[yt].subType=I.conversationSubType,T[yt].lastMessage=I._isExcludedFromLastMessage?"":I,I.flow!=="in"||I._isExcludedFromUnreadCount||T[yt].unreadCount++))}}else I._onlineOnlyFlag=!0}this._handleNoticeFromUnreadDB();var qo=!1;if(wt(h)&&0<h.length)for(var ko=0,yo=h.length;ko<yo;ko++)(function(Po){if(h[Po].from!==O.CONV_SYSTEM){qo=!0;var tr=T.find(function(Dr){return Dr.conversationID==="".concat(O.CONV_C2C).concat(h[Po].from)});tr?tr.unreadCount=h[Po].unreadCount:T.push({conversationID:"".concat(O.CONV_C2C).concat(h[Po].from),unreadCount:h[Po].unreadCount,type:O.CONV_C2C})}})(ko);if(wt(s))for(var Ko=0,$s=s.length;Ko<$s;Ko++)(function(Po){T.find(function(tr){return tr.conversationID==="".concat(O.CONV_C2C).concat(s[Po].from)})||T.push({conversationID:"".concat(O.CONV_C2C).concat(s[Po].from),type:O.CONV_C2C,lastMsgTime:s[Po].lastMsgTime})})(Ko);return{conversationOptionsList:T,messageList:D,isUnreadC2CMessage:qo}}},{key:"getMessageListFromUnreadDB",value:function(){return P(this._msgFromUnreadDBMap.values())}},{key:"_isC2CNotice",value:function(n){return n=n.eventArray,!(!wt(n)||n[0].event!==10)}},{key:"_handleNoticeFromUnreadDB",value:function(){var n,a=this._noticeFromUnreadDBList.length;a!==0&&(K.l("".concat(this._n,"._handleNoticeFromUnreadDB count:").concat(a)),n=[],this._noticeFromUnreadDBList.forEach(function(s){s.hasOwnProperty("c2cMessageRevokedNotify")&&n.push(s)}),this.onMsgRevoked({dataList:n}),this._noticeFromUnreadDBList.length=0,n.length=0)}},{key:"onMsgRevoked",value:function(n,a){var s,h=this,m=this.get(11),I=[];n.dataList.forEach(function(T){T.c2cMessageRevokedNotify&&(T=T.c2cMessageRevokedNotify.revokedInfos,et(T)||T.forEach(function(D){var V=h.getMyUserID()===D.from?"".concat(O.CONV_C2C).concat(D.to):"".concat(O.CONV_C2C).concat(D.from);s=m.revoke(V,D.sequence,D.random);var $,q=D.revokerInfo&&D.revokerInfo.revoker,se=D.revokerInfo&&D.revokerInfo.reason||"";s?$=s:($={conversationID:V,sequence:D.sequence},D.tinyID&&D.clientTime&&D.random&&($.ID="".concat(D.tinyID,"-").concat(D.clientTime,"-").concat(D.random)),D.time&&($.time=D.time)),$&&($.revoker=q,$.revokeReason=se,$.revokerInfo={userID:q,nick:"",avatar:""},I.push($))}))}),I.length!==0&&(K.l("".concat(this._n,".onMsgRevoked count:").concat(I.length," updateUnreadCount:").concat(a)),m.onMessageRevoked(I,a),m.updateRevokerInfo(I).then(function(T){h.emitOEvt(W.MESSAGE_REVOKED,T)}))}},{key:"onMsgReadReceipt",value:function(n){var a=this;n.dataList.forEach(function(s){var h;Tt(s.c2cMessageReadReceipt)||(h=s.c2cMessageReadReceipt.to,s.c2cMessageReadReceipt.uinPairReadArray.forEach(function(I){var I=I.peerReadTime,T=(K.l("".concat(a._n,".onMsgReadReceipt to:").concat(h," peerReadTime:").concat(I)),"".concat(O.CONV_C2C).concat(h)),D=a.get(11);D.recordPeerReadTime(T,I),D.updateMsgIsPeerReadProp(T,I)}))})}},{key:"onMsgReadNotice",value:function(n){var a=this;n.dataList.forEach(function(s){var h;Tt(s.c2cMessageReadNotice)||(h=a.get(11),s.c2cMessageReadNotice.uinPairReadArray.forEach(function(I){var T=I.from,I=I.peerReadTime,T=(K.l("".concat(a._n,".onMsgReadNotice from:").concat(T," lastReadTime:").concat(I)),"".concat(O.CONV_C2C).concat(T));h.updateIsReadAfterReadReport({conversationID:T,lastMessageTime:I}),h.updateUnreadCount(T)}))})}},{key:"onMsgModified",value:function(n){K.l("".concat(this._n,".onMsgModified options:"),n);var a=this.get(11);n.dataList.forEach(function(s){a.onMessageModified(E(E({},s),{},{conversationType:O.CONV_C2C}))})}},{key:"onReadReceiptList",value:function(n){K.l("".concat(this._n,".onReadReceiptList options:"),n),this.get(11).updateReadReceiptInfo(n.dataList)}},{key:"sendMessage",value:function(n,a){return n=this._createC2CMessagePack(n,a),this.req(n)}},{key:"_createC2CMessagePack",value:function(n,a){var s=null,h=(a&&(a.offlinePushInfo&&(s=a.offlinePushInfo),a.onlineUserOnly===!0)&&(s?s.disablePush=!0:s={disablePush:!0}),""),m=(_n(n.cloudCustomData)&&0<n.cloudCustomData.length&&(h=n.cloudCustomData),[]),I=(On(a)&&On(a.messageControlInfo)&&(I=(D=a.messageControlInfo).excludedFromUnreadCount,T=D.excludedFromLastMessage,D=D.excludedFromContentModeration,I===!0&&m.push("NoUnread"),T===!0&&m.push("NoLastMsg"),D===!0)&&m.push("NoMsgCheck"),this.isOnlineMessage(n,a)?0:void 0),T=JSON.parse(JSON.stringify(n.getElements())),D=this.get(17).getFileDNList();return{P:de.SEND_C2C_MSG,data:{fromAccount:this.getMyUserID(),toAccount:n.to,msgBody:Rp(n.type,T,D),cloudCustomData:h,msgSeq:n.sequence,msgRandom:n.random,msgLifeTime:I,nick:n.nick,avatar:n.avatar,offlinePushInfo:Np(s),messageControlInfo:I!==0?m:void 0,clientTime:n.clientTime,needReadReceipt:n.needReadReceipt===!0?1:0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0,cmConfigID:n._cmConfigID,forbidCallbackControl:yI(a)}}}},{key:"isOnlineMessage",value:function(n,a){return!(!a||a.onlineUserOnly!==!0)}},{key:"revokeMessage",value:function(n){return this.req({P:de.REVOKE_C2C_MSG,data:{msgInfo:{fromAccount:n.from,toAccount:n.to,msgSeq:n.sequence,msgRandom:n.random,msgTimeStamp:n.time}}})}},{key:"deleteMessage",value:function(s){var a=s.to,s=s.keyList;return K.l("".concat(this._n,".deleteMessage toAccount:").concat(a," count:").concat(s.length)),this.req({P:de.DEL_C2C_MSG,data:{fromAccount:this.getMyUserID(),to:a,keyList:s}})}},{key:"modifyRemoteMessage",value:function(q){var a=q.from,s=q.to,h=q.version,h=h===void 0?0:h,m=q.sequence,I=q.random,T=q.time,D=q.payload,V=q.type,$=q.cloudCustomData,q=q._elements,se=void 0;return EI(V)&&(1<q.length&&q.splice(0,1,{type:V,content:D}),se=q),this.req({P:de.MODIFY_C2C_MSG,data:{from:a,to:s,version:h,sequence:m,random:I,time:T,elements:se,cloudCustomData:$}})}},{key:"setMessageRead",value:function(I){var a=this,s=I.conversationID,h=I.lastMessageTime,m="".concat(this._n,".").concat("setMessageRead"),I="convID:".concat(s," lastMessageTime:").concat(h),T=(K.l("".concat(m," ").concat(I)),It(h)||this.warn("DoNotModifyLastTime"),new ct("setMessageRead"));return T.setMessage(I),this.req({P:de.SET_C2C_MSG_READ,data:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:s.replace("C2C",""),lastMessageTime:h,receipt:1}]}}}).then(function(){T.end(),K.l("".concat(m," ok"));var D=a.get(11);return D.updateIsReadAfterReadReport({conversationID:s,lastMessageTime:h}),D.updateUnreadCount(s),Kt()}).catch(function(D){return T.setError(D).end(),K.l("".concat(m," failed. error:"),D),De(D)})}},{key:"getRoamingMessage",value:function(D){var a=this,s="".concat(this._n,".").concat("getRoamingMessage"),h=D.peerAccount,m=D.conversationID,I=D.count,T=D.lastMessageTime,D=D.messageKey,V="peerAccount:".concat(h," count:").concat(I||15," lastMessageTime:").concat(T||0," messageKey:").concat(D),$=(K.l("".concat(s," ").concat(V)),new ct("getRoamingMessage"));return this.req({P:de.GET_C2C_ROAMING_MSG,data:{peerAccount:h,count:I||15,lastMessageTime:T||0,messageKey:D}}).then(function(se){var se=se.data,fe=se.complete,Xe=se.messageList,Ye=se.messageKey,se=se.lastMessageTime,me=(et(Xe)?K.l("".concat(s," ok. complete:").concat(fe," but messageList is undefined!")):K.l("".concat(s," ok. complete:").concat(fe," count:").concat(Xe.length)),$.setMessage("".concat(V," complete:").concat(fe," length:").concat(Xe.length)).end(),a.get(11)),fe=fe===1,He=(fe&&me.setCompleted(m),[]),Xe=me.onRoamingMessage(Xe,m,!0,He),Ye=(me.modifyMessageList(m),me.updateIsRead(m),me.updateRoamingMsgKeyAndTime(m,Ye,se),me.getPeerReadTime(m)),Ye=(K.l("".concat(s," update isPeerRead property. convID:").concat(m," peerReadTime:").concat(Ye)),Ye?me.updateMsgIsPeerReadProp(m,Ye):(se=m.replace(O.CONV_C2C,""),a.getRemotePeerReadTime([se]).then(function(){me.updateMsgIsPeerReadProp(m,me.getPeerReadTime(m))})),"");return 0<Xe.length?Ye=Xe[0].ID:(se=me.getLocalOldestMessage(m))&&(Ye=se.ID),K.l("".concat(s," nextReqID:").concat(Ye," storedMsgCount:").concat(Xe.length)),{nextReqID:Ye,storedMessageList:Xe,assembledMessageList:He,isPullingCompleted:fe}}).catch(function(q){return $.setMessage(V).setError(q).end(),K.w("".concat(s," failed. error:"),q),De(q)})}},{key:"getRoamingMessagesHopping",value:function(n){var a=this,s="".concat(this._n,".").concat("getRoamingMessagesHopping"),h=n.peerAccount,m=n.time,m=m===void 0?0:m,I=n.count,T=n.direction,D="".concat(O.CONV_C2C).concat(h),V="peerAccount:".concat(h," count:").concat(I," time:").concat(m," direction:").concat(T),$=(K.l("".concat(s," ").concat(V)),new ct("getRoamingMessagesHopping"));return this.req({P:de.GET_C2C_ROAMING_MSG,data:{peerAccount:h,count:I+1,lastMessageTime:m,direction:T}}).then(function(se){var se=se.data,Xe=se.complete,He=se.messageList,He=He===void 0?[]:He,se=se.lastMessageTime,fe="complete:".concat(Xe," count:").concat(He.length),me=(K.l("".concat(s," ok. ").concat(fe)),$.setMessage("".concat(V," ").concat(fe)).end(),Xe!==1&&(T===1?He.pop():He.shift()),a.get(11)),fe=me.onRoamingMessage(He,D,!1),He=(a._modifyMessageList(D,fe),a._computeResult({complete:Xe,lastMessageTime:se,resultList:fe})),Xe=(me.storeHoppingMessageList(He.messageList),me.getPeerReadTime(D));return K.l("".concat(s," update isPeerRead property. convID:").concat(D," peerReadTime:").concat(Xe)),Xe?me.updateMsgIsPeerReadProp(D,Xe):(se=D.replace(O.CONV_C2C,""),a.getRemotePeerReadTime([se]).then(function(){me.updateMsgIsPeerReadProp(D,me.getPeerReadTime(D))})),Kt(He)}).catch(function(q){return $.setMessage(V).setError(q).end(),K.w("".concat(s," failed. error:"),q),De(q)})}},{key:"_computeResult",value:function(h){var a=h.complete,a=a===void 0?0:a,s=h.lastMessageTime,h=h.resultList,h={messageList:P(h===void 0?[]:h),isCompleted:!1,nextMessageTime:""};return a===1?h.isCompleted=!0:h.nextMessageTime=s,h}},{key:"_modifyMessageList",value:function(n,a){if(n=this.get(11).getLocalConversation(n),n)for(var s=n.userProfile.nick,h=n.userProfile.avatar,n=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),m=n.nick,I=n.avatar,T=a.length-1;0<=T;T--){var D=a[T];D.flow==="in"&&(D.nick!==s&&D.setNickAndAvatar({nick:s}),D.avatar!==h)&&D.setNickAndAvatar({avatar:h}),D.flow==="out"&&(D.nick!==m&&D.setNickAndAvatar({nick:m}),D.avatar!==I)&&D.setNickAndAvatar({avatar:I})}}},{key:"getRemotePeerReadTime",value:function(n){var a,s=this,h="".concat(this._n,".").concat("getRemotePeerReadTime");return Tt(n)?Promise.resolve():(a=new ct("getRemotePeerReadTime"),K.l("".concat(h," userIDList:").concat(n)),this.req({P:de.GET_C2C_PEER_READ_TIME,data:{userIDList:n}}).then(function(m){var I=m.data.peerReadTimeList;K.l("".concat(h," ok. peerReadTimeList:").concat(I));for(var T="",D=s.get(11),V=0;V<n.length;V++)T+="".concat(n[V],"-").concat(I[V]," "),0<I[V]&&D.recordPeerReadTime("".concat(O.CONV_C2C).concat(n[V]),I[V]);a.setMessage(T).end()}).catch(function(m){a.setError(m).end(),K.w("".concat(h," failed. error:"),m)}))}},{key:"sendReadReceipt",value:function(I){var a,s=I[0].conversationID.replace(O.CONV_C2C,""),h=new ct("sendReadReceipt"),m=(h.setMessage("peerAccount:".concat(s)),this.getMyUserID()),I=I.filter(function(T){return T.from!==m&&T.needReadReceipt===!0}).map(function(T){return{fromAccount:T.from,toAccount:T.to,sequence:T.sequence,random:T.random,time:T.time,clientTime:T.clientTime}});return I.length===0?De({code:Je.READ_RECEIPT_MSG_LIST_EMPTY}):(a="".concat(this._n,".").concat("sendReadReceipt"),K.l("".concat(a,". peerAccount:").concat(s," length:").concat(I.length)),this.req({P:de.SEND_C2C_READ_RECEIPT,data:{peerAccount:s,messageInfoList:I}}).then(function(T){return h.end(),K.l("".concat(a," ok")),Kt()}).catch(function(T){return h.setError(T).end(),K.w("".concat(a," failed. error:"),T),De(T)}))}},{key:"getReadReceiptList",value:function(n){var a=n[0].conversationID.replace(O.CONV_C2C,"");return K.l("".concat(this._n,".getReadReceiptList peerAccount:").concat(a," msgCount:").concat(n.length)),ln({messageList:n})}},{key:"getMessageExtensions",value:function(n,a){return K.l("".concat(this._n,".getMessageExtensions startSequence:").concat(a)),this.req({P:de.GET_C2C_MSG_EXT,data:{from:n.from,to:n.to,messageKey:this.getMessageKey(n),startSequence:a}})}},{key:"modifyMsgExts",value:function(n,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return K.l("".concat(this._n,".modifyMsgExts operateType:").concat(s)),this.req({P:de.MODIFY_C2C_MSG_EXT,data:{from:n.from,to:n.to,messageKey:this.getMessageKey(n),extensionList:a,operateType:s}})}},{key:"getMessageKey",value:function(h){var a=h.clientSequence,s=h.random,h=h.time;return"".concat(a,"_").concat(s,"_").concat(h)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._msgFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]),So={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)},Pp=p(function n(a){u(this,n),this._convM=a,this._map=new Map,this._n="MsgListHandler",this._latestMsgSentByPeerMap=new Map,this._latestMsgSentByMeMap=new Map,this._hoppingMsgMap=new Map,this.TOPIC_MSG_LIMIT=1e3,this._convM.getIEmitInst().on(So.CLOUD_CONFIG,this._onCloudConfig,this)},[{key:"_onCloudConfig",value:function(){var n=this._convM.getCloudConfig("topic_msg_limit");et(n)||(this.TOPIC_MSG_LIMIT=Number(n)),K.l("".concat(this._n,"._onCloudConfig topicMsgLimit:").concat(this.TOPIC_MSG_LIMIT))}},{key:"onCheckTimer",value:function(n){if(n%20==0&&0<this._map.size){var a,s=v(this._map);try{for(s.s();!(a=s.n()).done;){var h=x(a.value,2),m=h[0],I=h[1];m.includes(ha)&&I.size>=this.TOPIC_MSG_LIMIT&&this._convM.clearMemMsg(m,!0)}}catch(T){s.e(T)}finally{s.f()}}}},{key:"pushIn",value:function(n){var a=1<arguments.length&&arguments[1]!==void 0&&arguments[1],s=n.conversationID,h=!0,m=(this._map.has(s)||this._map.set(s,new Map),this._getUniqueIDOfMsg(n));if(this._map.get(s).has(m)){var I=this._map.get(s).get(m);if(!a||I.isModified===!0)return!1}return this._map.get(s).set(m,n),this._setLatestMsgSentByPeer(s,n),this._setLatestMsgSentByMe(s,n),h}},{key:"unshift",value:function(n,a){var s;if(wt(n)?0<n.length&&(s=n[0].conversationID,this._unshiftMultipleMsgs(n,a)):(s=n.conversationID,this._unshiftSingleMsg(n,a)),s){var h=Array.from(this._map.get(s).values()),n=h.length;if(n!==0){for(var m=n-1;0<=m;m--)if(h[m].flow==="out"){this._setLatestMsgSentByMe(s,h[m]);break}if(s.startsWith(O.CONV_C2C)){for(var I=n-1;0<=I;I--)if(h[I].flow==="in"){this._setLatestMsgSentByPeer(s,h[I]);break}}}}}},{key:"_unshiftSingleMsg",value:function(n,a){var s,h,m=n.conversationID,I=this._getUniqueIDOfMsg(n);this._map.has(m)?(s=this._map.get(m),h=Array.from(s),s.has(I)||(h.unshift([I,n]),this._map.set(m,new Map(h)),a.push(n))):(this._map.set(m,new Map),this._map.get(m).set(I,n),a.push(n))}},{key:"_unshiftMultipleMsgs",value:function(n,a){for(var s=n.length,h=[],m=n[0].conversationID,I=this._map.get(m),T=this._map.has(m)?Array.from(I):[],D=0;D<s;D++){var V=this._getUniqueIDOfMsg(n[D]);I&&I.has(V)||(h.push([V,n[D]]),a.push(n[D]))}this._map.set(m,new Map(h.concat(T)))}},{key:"remove",value:function(s){var a=s.conversationID,s=this._getUniqueIDOfMsg(s);this._map.has(a)&&this._map.get(a).delete(s)}},{key:"revoke",value:function(n,a,s){var h;return this._map.has(n)?(h=this._map.get(n),this._updateMsgIsRevoked(h,a,s)):this._hoppingMsgMap.has(n)?(h=this._hoppingMsgMap.get(n),this._updateMsgIsRevoked(h,a,s)):null}},{key:"_updateMsgIsRevoked",value:function(n,a,s){var h,m=v(n);try{for(m.s();!(h=m.n()).done;){var I=x(h.value,2)[1];if(I.sequence===a&&(et(s)||I.random===s))return I.isRevoked||(I.isRevoked=!0),I}}catch(T){m.e(T)}finally{m.f()}}},{key:"removeByConvID",value:function(n){var a=this._map.has(n);K.l("".concat(this._n,".removeByConvID convID:").concat(n," has:").concat(a)),a&&(this._map.delete(n),this._latestMsgSentByPeerMap.delete(n),this._latestMsgSentByMeMap.delete(n))}},{key:"findMessage",value:function(n){return this._findMsg(n,this._map)||this._findMsg(n,this._hoppingMsgMap)}},{key:"_findMsg",value:function(n,a){var s,h=null,m=v(a);try{for(m.s();!(s=m.n()).done;)for(var I=P(x(s.value,2)[1].values()),T=I.length,D=0;D<T;D++)if(I[D].ID===n){h=I[D];break}}catch(V){m.e(V)}finally{m.f()}return h}},{key:"updateMsgIsPeerReadProp",value:function(n,a){var s,h=[];return this._map.has(n)?(s=this._map.get(n),h=this._updateMsgIsPeerReadProp(s,a)):this._hoppingMsgMap.has(n)&&(s=this._hoppingMsgMap.get(n),h=this._updateMsgIsPeerReadProp(s,a)),K.l("".concat(this._n,".updateMsgIsPeerReadProp convID:").concat(n," peerReadTime:").concat(a," count:").concat(h.length)),h}},{key:"_updateMsgIsPeerReadProp",value:function(n,a){var s,h=[],m=v(n);try{for(m.s();!(s=m.n()).done;){var I=x(s.value,2)[1];I.time<=a&&!I.isPeerRead&&I.flow==="out"&&(I.isPeerRead=!0,h.push(I))}}catch(T){m.e(T)}finally{m.f()}return h}},{key:"updateMsgIsModifiedProp",value:function(n){var a=n.conversationID;this._map.has(a)&&(n=this._getUniqueIDOfMsg(n),a=this._map.get(a).get(n))&&(a.isModified=!0)}},{key:"hasLocalMsgList",value:function(n){return this._map.has(n)}},{key:"getLocalMsgList",value:function(n){return this.hasLocalMsgList(n)?P(this._map.get(n).values()):[]}},{key:"getLocalMaxSeq",value:function(n){return this.hasLocalMsgList(n)?(n=P(this._map.get(n).values()).map(function(a){return a.sequence}),Math.max.apply(Math,P(n))):0}},{key:"getLocalMaxTime",value:function(n){return this.hasLocalMsgList(n)?(n=P(this._map.get(n).values()).map(function(a){return a.time}),Math.max.apply(Math,P(n))):0}},{key:"hasLocalMsg",value:function(n,a){for(var s=!1,h=this.getLocalMsgList(n),m=h.length,I=0;I<m;I++)h[I].ID===a&&(s=!0);return s}},{key:"getLocalMsg",value:function(n,a){for(var s=null,h=this.getLocalMsgList(n),m=h.length,I=0;I<m;I++)if(h[I].ID===a){s=h[I];break}return s}},{key:"getLocalLastMsg",value:function(n){for(var a=this.getLocalMsgList(n),s=void 0,h=a.length-1;0<=h;h--)if(a[h].status===Fi){s=a[h];break}return s}},{key:"getLocalSecondLastMsg",value:function(n){return n=this.getLocalMsgList(n),n[n.length-2]}},{key:"getLocalOldestMsg",value:function(n){return this.getLocalMsgList(n)[0]}},{key:"_setLatestMsgSentByPeer",value:function(n,a){n.startsWith(O.CONV_C2C)&&a.flow==="in"&&this._latestMsgSentByPeerMap.set(n,a)}},{key:"_setLatestMsgSentByMe",value:function(n,a){a.flow==="out"&&this._latestMsgSentByMeMap.set(n,a)}},{key:"getLatestMsgSentByPeer",value:function(n){return this._latestMsgSentByPeerMap.get(n)}},{key:"getLatestMsgSentByMe",value:function(n){return this._latestMsgSentByMeMap.get(n)}},{key:"modifyMsgSentByPeer",value:function(m){var a=m.conversationID,s=m.latestNick,h=m.latestAvatar,m=this._map.get(a);if(!Tt(m)){var I=Array.from(m.values()),m=I.length;if(m!==0){for(var T=null,D=0,V=!1,$=m-1;0<=$;$--)I[$].flow==="in"&&((T=I[$]).nick!==s&&(T.setNickAndAvatar({nick:s}),V=!0),T.avatar!==h&&(T.setNickAndAvatar({avatar:h}),V=!0),V)&&(D+=1);K.l("".concat(this._n,".modifyMsgSentByPeer convID:").concat(a," count:").concat(D))}}}},{key:"modifyMsgSentByMe",value:function(m){var a=m.conversationID,s=m.latestNick,h=m.latestAvatar,m=this._map.get(a);if(!Tt(m)){var I=Array.from(m.values()),m=I.length;if(m!==0){for(var T=null,D=0,V=!1,$=m-1;0<=$;$--)I[$].flow==="out"&&((T=I[$]).nick!==s&&(T.setNickAndAvatar({nick:s}),V=!0),T.avatar!==h&&(T.setNickAndAvatar({avatar:h}),V=!0),V)&&(D+=1);K.l("".concat(this._n,".modifyMsgSentByMe convID:").concat(a," count:").concat(D))}}}},{key:"getTopicConvIDList",value:function(n){return P(this._map.keys()).filter(function(a){return a.startsWith("".concat(O.CONV_GROUP).concat(n))})}},{key:"onMsgModified",value:function(n,a){var s,h,m,I;return(this._map.has(n)||this._hoppingMsgMap.has(n))&&(s="".concat(this._n,".onMsgModified"),m=this._getUniqueIDOfMsg(a),I=!!(h=this._getTargetMsg(n,m)),K.l("".concat(s," convID:").concat(n," uniqueID:").concat(m," has:").concat(I)),I)?(n=a.messageVersion,m=a.elements,I=a.cloudCustomData,a=a.checkResult,K.l("".concat(s," localVersion:").concat(h.version," remoteVersion:").concat(n)),h.version<n?(h.version=n,h._elements=JSON.parse(JSON.stringify(m)),h.payload=h._elements[0].content,h.type=h._elements[0].type,h.cloudCustomData=I,h.isModified=!0,h.hasRiskContent=MI(a),{isUpdated:!0,message:h}):{isUpdated:!1,message:h}):{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMsg",value:function(I){var a=I.from,s=I.to,h=I.random,m=I.sequence,I=I.time;return"".concat(a,"-").concat(s,"-").concat(h,"-").concat(m,"-").concat(I)}},{key:"_getTargetMsg",value:function(n,a){if(this._map.has(n))return this._map.get(n).get(a);var s=void 0;if(this._hoppingMsgMap.has(n)){for(var h=P(this._hoppingMsgMap.get(n).values()),m=0;m<h.length;m++)if(this._getUniqueIDOfMsg(h[m])===a){s=h[m];break}}return s}},{key:"storeHoppingMsgList",value:function(n){if(n.length!==0){var a=n[0].conversationID,s=n.length;this._hoppingMsgMap.has(a)||this._hoppingMsgMap.set(a,new Map);for(var h=this._hoppingMsgMap.get(a),m=0;m<s;m++){var I=n[m];h.has(I.ID)||h.set(I.ID,I)}}}},{key:"getHoppingMsg",value:function(n,a){if(this._hoppingMsgMap.has(n))return this._hoppingMsgMap.get(n).get(a)}},{key:"reset",value:function(){this._map.clear(),this._latestMsgSentByPeerMap.clear(),this._latestMsgSentByMeMap.clear(),this._hoppingMsgMap.clear()}}]);function xp(n){return u(this,xp),(n=c(this,xp,[n]))._n="C2CModule",n._msgFromUnreadDBMap=new Map,n._noticeFromUnreadDBList=[],n}function Sh(n){this.mixin(n)}Sh.mixin=function(n){n=n.prototype||n,n._isReady=!1,n.ready=function(a){if(a)return this._isReady?void(1<arguments.length&&arguments[1]!==void 0&&arguments[1]?a.call(this):setTimeout(a,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(a))},n.triggerReady=function(){var a=this;this._isReady=!0,setTimeout(function(){var s=a._readyQueue;a._readyQueue=[],s&&0<s.length&&s.forEach(function(h){h.call(this)},a)},1)},n.resetReady=function(){this._isReady=!1,this._readyQueue=[]},n.isReady=function(){return this._isReady}};function DI(n,a,s){return et(n)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:s&&n.ID||n instanceof _r?{lastTime:n.time||0,lastSequence:n.sequence||0,fromAccount:n.from||"",messageForShow:mh(n.type,n.payload,a),payload:n.payload||null,type:n.type||null,isRevoked:n.isRevoked||!1,cloudCustomData:n.cloudCustomData||"",onlineOnlyFlag:n._onlineOnlyFlag||!1,nick:n.nick||"",nameCard:n.nameCard||"",version:n.version||0,isPeerRead:n.isPeerRead||!1,revoker:n.revoker||null}:E(E({},n),{},{messageForShow:mh(n.type,n.payload,a)})}function Pv(n,a){return Tt(n)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:n.time||0,lastSequence:n.sequence||0,fromAccount:n.from||"",payload:n.payload||null,type:n.type||"",messageForShow:mh(n.type,n.payload,a),nick:n.nick||"",avatar:n.avatar||"",version:n.version||0,cloudCustomData:n.cloudCustomData||"",isRevoked:n.isRevoked||!1,revoker:n.revoker||null}}function Up(n){var a=String(n).replace(/[=]+$/,""),s="";if(a.length%4==1)return"";for(var h,m,I=0,T=0;m=a.charAt(T++);~m&&(h=I%4?64*h+m:m,I++%4)&&(s+=String.fromCharCode(255&h>>(-2*I&6))))m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(m);try{return decodeURIComponent(escape(s))}catch{return""}}var xv=["jpg","jpeg","gif","png","bmp","image","webp"],Eh=["mp4","quicktime","mov"],Th=p(function n(a){var s=this;u(this,n),Tt(a)||(this.userID=a.userID||"",this.nick=a.nick||"",this.gender=a.gender||"",this.birthday=a.birthday||0,this.location=a.location||"",this.selfSignature=a.selfSignature||"",this.allowType=a.allowType||O.ALLOW_TYPE_ALLOW_ANY,this.language=a.language||0,this.avatar=a.avatar||"",this.messageSettings=a.messageSettings||0,this.adminForbidType=a.adminForbidType||O.FORBID_TYPE_NONE,this.level=a.level||0,this.role=a.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],Tt(a.profileCustomField))||a.profileCustomField.forEach(function(h){s.profileCustomField.push({key:h.key,value:h.value})})},[{key:"validate",value:function(n){var a,s=!0,h="";if(Tt(n))return{valid:!1,tips:"empty options"};if(n.profileCustomField)for(var m=n.profileCustomField.length,I=null,T=0;T<m;T++){if(I=n.profileCustomField[T],!_n(I.key)||I.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!_n(I.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(a in n)if(Object.prototype.hasOwnProperty.call(n,a)){if(a==="profileCustomField")continue;if(Tt(n[a])&&!_n(n[a])&&!It(n[a])){h="key:"+a+", invalid value:"+n[a],s=!1;continue}switch(a){case"nick":_n(n[a])||(s=!(h="nick must be a string")),500<Qt(n[a])&&(h="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(Qt(n[a])," bytes"),s=!1);break;case"gender":fr(jo,n.gender)||(h="key:gender, invalid value:"+n.gender,s=!1);break;case"birthday":It(n.birthday)||(s=!(h="birthday must be a number"));break;case"location":_n(n.location)||(s=!(h="location must be a string"));break;case"selfSignature":_n(n.selfSignature)||(s=!(h="selfSignature must be a string"));break;case"allowType":fr(Vr,n.allowType)||(h="key:allowType, invalid value:"+n.allowType,s=!1);break;case"language":It(n.language)||(s=!(h="language must be a number"));break;case"avatar":_n(n.avatar)||(s=!(h="avatar must be a string"));break;case"messageSettings":n.messageSettings!==0&&n.messageSettings!==1&&(s=!(h="messageSettings must be 0 or 1"));break;case"adminForbidType":fr(xi,n.adminForbidType)||(h="key:adminForbidType, invalid value:"+n.adminForbidType,s=!1);break;case"level":It(n.level)||(s=!(h="level must be a number"));break;case"role":It(n.role)||(s=!(h="role must be a number"));break;default:h="unknown key:"+a+"  "+n[a],s=!1}}return{valid:s,tips:h}}}]),Mh=p(function n(a){u(this,n),this.MAX_LENGTH=a,this.map=new Map},[{key:"set",value:function(n){var a;this.map.size>=this.MAX_LENGTH&&(a=this.map.entries().next().value[0],this.map.delete(a)),this.map.set(n,1)}},{key:"has",value:function(n){return this.map.has(n)}},{key:"delete",value:function(n){this.has(n)&&this.map.delete(n)}},{key:"reset",value:function(){this.map.clear()}}]),l1=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],fa=p(function n(a){u(this,n),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(a)},[{key:"memberNum",get:function(){return this.memberCount},set:function(n){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(n){}},{key:"_initGroup",value:function(n){for(var a in n)l1.indexOf(a)<0||(a!=="selfInfo"?(a==="memberNum"&&(this.memberCount=n[a]),a==="maxMemberNum"&&(this.maxMemberCount=n[a]),a!=="isSupportTopic"?this[a]=n[a]:this.isSupportTopic=n[a]===1):this.updateSelfInfo(n[a]))}},{key:"updateGroup",value:function(s){var a=this,s=(s.appid=void 0,s.grossTopicNextMsgSeq=void 0,s.selfInfo&&(s.selfInfo.grossTopicReadSeq=void 0),JSON.parse(JSON.stringify(s)));s.lastMsgTime&&(this.lastMessage.lastTime=s.lastMsgTime),et(s.muteAllMembers)||(s.muteAllMembers==="On"?s.muteAllMembers=!0:s.muteAllMembers=!1),s.groupCustomField&&vu(this.groupCustomField,s.groupCustomField),et(s.memberNum)||(this.memberCount=s.memberNum),et(s.maxMemberNum)||(this.maxMemberCount=s.maxMemberNum),et(s.isSupportTopic)||(this.isSupportTopic=It(s.isSupportTopic)?s.isSupportTopic===1:s.isSupportTopic),ei(this,s,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),wt(s.members)&&0<s.members.length&&s.members.forEach(function(h){h.userID===a.selfInfo.userID&&ei(a.selfInfo,h,["sequence"])})}},{key:"updateSelfInfo",value:function(n){n={nameCard:n.nameCard,joinTime:n.joinTime,role:n.role,messageRemindType:n.messageRemindType,readedSequence:n.readedSequence,excludedUnreadSequenceList:n.excludedUnreadSequenceList},ei(this.selfInfo,E({},n),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(n){this.selfInfo.nameCard=n}}]),fc=p(function n(a,s){var h=2<arguments.length&&arguments[2]!==void 0&&arguments[2];u(this,n),this.conversationID=a.conversationID||"",this.unreadCount=a.unreadCount||0,this.type=a.type||"",this.lastMessage=DI(a.lastMessage,s,h),a.lastMsgTime&&(this.lastMessage.lastTime=a.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=a.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=a.isPinned||!1,this.messageRemindType=a.messageRemindType,this.markList=a.markList||[],this.customData=a.customData||"",this.conversationGroupList=a.conversationGroupList||[],this.draftText=a.draftText||"",this._initProfile(a),this.subType=this.groupProfile?this.groupProfile.type:""},[{key:"toAccount",get:function(){return this.conversationID.startsWith(O.CONV_C2C)?this.conversationID.replace(O.CONV_C2C,""):this.conversationID.startsWith(O.CONV_GROUP)?this.conversationID.replace(O.CONV_GROUP,""):""}},{key:"_initProfile",value:function(n){var a=this;Object.keys(n).forEach(function(s){switch(s){case"userProfile":a.userProfile=n.userProfile;break;case"groupProfile":a.groupProfile=n.groupProfile}}),et(this.userProfile)&&this.type===O.CONV_C2C?this.userProfile=new Th({userID:n.conversationID.replace("C2C","")}):et(this.groupProfile)&&this.type===O.CONV_GROUP&&(this.groupProfile=new fa({groupID:n.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(h){var a=h.nextUnreadCount,s=h.isFromGetConversations,h=h.isUnreadC2CMessage;et(a)||(jr(this.subType)?this.unreadCount=0:s&&this.type===O.CONV_GROUP||s&&this.type===O.CONV_TOPIC||h&&this.type===O.CONV_C2C?this.unreadCount=a:this.unreadCount=this.unreadCount+a)}},{key:"updateLastMessage",value:function(n){this.lastMessage=DI(n)}},{key:"updateGroupAtInfoList",value:function(n){var a;this._isNeedMergeGroupAtInfo(n)||((a=(i(a=n.groupAtType)||M(a)||Y(a)||R()).slice(0)).indexOf(O.CONV_AT_ME)!==-1&&a.indexOf(O.CONV_AT_ALL)!==-1&&(a=[O.CONV_AT_ALL_AT_ME]),a={from:n.from,groupID:n.groupID,topicID:n.topicID,messageSequence:n.sequence,atTypeArray:a,__random:n.__random,__sequence:n.__sequence},this.groupAtInfoList.push(a))}},{key:"_isNeedMergeGroupAtInfo",value:function(n){var a,s=n.groupID,h=n.sequence;return!!Yr({groupID:s})&&(a=!1,this.groupAtInfoList.forEach(function(m){m.messageSequence===h&&(-1<m.atTypeArray.indexOf(O.CONV_AT_ME)&&-1<n.groupAtType.indexOf(O.CONV_AT_ALL)&&(m.atTypeArray=[O.CONV_AT_ALL_AT_ME]),-1<m.atTypeArray.indexOf(O.CONV_AT_ALL)&&-1<n.groupAtType.indexOf(O.CONV_AT_ME)&&(m.atTypeArray=[O.CONV_AT_ALL_AT_ME],m.__random=n.__random,m.__sequence=n.__sequence),a=!0)}),a)}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(s){var a=s.sequence,s=s.time;return this.type===O.CONV_C2C&&a===this.lastMessage.lastSequence&&s===this.lastMessage.lastTime||this.type===O.CONV_GROUP&&a===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(n){this.lastMessage.isRevoked=n}},{key:"setLastMessageRevoker",value:function(n){this.lastMessage.revoker=n}},{key:"setDraftText",value:function(n){this.draftText=n}}]),OI=_(_(_({},O.MSG_REMIND_ACPT_AND_NOTE,0),O.MSG_REMIND_DISCARD,1),O.MSG_REMIND_ACPT_NOT_NOTE,2),c1=p(function n(a){u(this,n),this._convM=a,this._n="MsgRemindHandler"},[{key:"onAllRcvMsgOptNotify",value:function(n){n=this._handleResult(n),this._convM.emitOEvt(W.ALL_RECEIVE_MESSAGE_OPT_UPDATED,n)}},{key:"getC2CMsgRemindType",value:function(n){var a=this,s="".concat(this._n,".getC2CMsgRemindType");return this._convM.req({P:de.GET_C2C_PEER_MUTE_NOTIFICATIONS,data:{toAccount:this._convM.getMyUserID(),userIDList:n}}).then(function(h){K.l("".concat(s," ok. userIDList:").concat(n)),h=h.data.muteFlagList,a._convM.onC2CMsgRemindTypeFetched(h)}).catch(function(h){K.e("".concat(s," failed. error:"),h)})}},{key:"set",value:function(n){return n.groupID?this._setGroupMsgRemindType(n):wt(n.userIDList)?this._setC2CMsgRemindType(n):void 0}},{key:"_setGroupMsgRemindType",value:function(n){var a=this,s="".concat(this._n,".").concat("_setGroupMsgRemindType"),h=n.groupID,m=n.messageRemindType,I="groupID:".concat(h," messageRemindType:").concat(m),T=new ct("_setGroupMsgRemindType"),D=(T.setMessage(I),this._get(7));return D?D.modifyGroupMemberInfo({groupID:h,messageRemindType:m,userID:this._convM.getMyUserID()}).then(function(){T.end(),K.l("".concat(s," ok. ").concat(I));var V=a.onGroupMsgRemindTypeUpdated(n);return a._convM.onTotalUnreadCountUpdate(),Kt(V)}).catch(function(V){return T.setError(V).end(),K.e("".concat(s," failed. error:"),V),De(V)}):De({code:Je.NO_MODULE})}},{key:"onGroupMsgRemindTypeUpdated",value:function(m){var a,s,h=m.groupID,m=m.messageRemindType,I=(K.l("".concat(this._n,".onGroupMsgRemindTypeUpdated groupID:").concat(h," messageRemindType:").concat(m)),this._get(7).getLocalGroupProfile(h));return I&&(I.selfInfo.messageRemindType=m),vr(h)?(a=pr(s=h),(s=this._get(10).getLocalTopic(a,s))&&s.updateSelfInfo({messageRemindType:m})&&this._convM.emitOEvt(W.TOPIC_UPDATED,{groupID:a,topic:s}),{topic:s}):(this._convM.patchMsgRemindType({ID:h,isC2CConversation:!1,messageRemindType:m})&&this._emitConvUpdate(),{group:I})}},{key:"_setC2CMsgRemindType",value:function(T){var a=this,s="".concat(this._n,".").concat("_setC2CMsgRemindType"),h=T.userIDList,m=T.messageRemindType,I=h.slice(0,30),T=OI[m]||0,D="userIDList:".concat(I," messageRemindType:").concat(m),V=new ct("_setC2CMsgRemindType");return V.setMessage(D),this._convM.req({P:de.SET_C2C_PEER_MUTE_NOTIFICATIONS,data:{userIDList:I,muteFlag:T}}).then(function(me){V.end();var me=me.data.errorList,q=[],se=[],me=(wt(me)&&me.forEach(function(He){q.push(He.userID),se.push({userID:He.userID,code:He.errorCode})}),I.filter(function(He){return q.indexOf(He)===-1})),fe=(K.l("".concat(s," ok. ").concat(D," successUserIDList:").concat(me," failureUserIDList:").concat(JSON.stringify(se))),0);return me.forEach(function(He){a._convM.patchMsgRemindType({ID:He,isC2CConversation:!0,messageRemindType:m})&&(fe+=1)}),1<=fe&&a._emitConvUpdate(),I.length=q.length=0,a._convM.onTotalUnreadCountUpdate(),ln({successUserIDList:me.map(function(He){return{userID:He}}),failureUserIDList:se})}).catch(function($){return V.setError($).end(),K.e("".concat(s," failed. error:"),$),De($)})}},{key:"_get",value:function(n){return this._convM.get(n)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"setAllRcvMsgOpt",value:function(T){var a="".concat(this._n,".").concat("setAllRcvMsgOpt"),s=T.messageRemindType,s=s===void 0?O.MSG_REMIND_ACPT_NOT_NOTE:s,h=T.isRepeated,h=h===void 0||h,I=this._calcStartAndEndTime(T),m=I.startTime,m=m===void 0?0:m,I=I.endTime,I=I===void 0?0:I,T=JSON.stringify(T),D=new ct("setAllRcvMsgOpt");return D.setMessage(T),K.l("".concat(a," options:").concat(T)),this._convM.req({P:de.SET_ALL_RECEIVE_MSG_OPT,data:{messageRemindType:OI[s],startTime:m,endTime:I,isRepeated:h?1:0}}).then(function(V){return D.end(),K.l("".concat(a," ok.")),Kt(V)}).catch(function(V){return D.setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})}},{key:"_calcStartAndEndTime",value:function(I){var a=I.startHour,a=a===void 0?0:a,s=I.startMinute,s=s===void 0?0:s,h=I.startSecond,h=h===void 0?0:h,m=I.duration,m=m===void 0?0:m,I=I.isRepeated,I=I===void 0||I,D=new Date,V=D.getFullYear(),T=D.getMonth(),D=D.getDate(),V=Math.round(new Date(V,T,D,a,s,h).getTime()/1e3);return{startTime:V,endTime:I&&86400<=m?V+86400:V+m}}},{key:"getAllRcvMsgOpt",value:function(){var n=this,a="".concat(this._n,".").concat("getAllRcvMsgOpt"),s=new ct("getAllRcvMsgOpt");return this._convM.req({P:de.GET_ALL_RECEIVE_MSG_OPT,data:{toAccount:this._convM.getMyUserID()}}).then(function(h){return h=h.data,s.setMessage(JSON.stringify(h)).end(),K.l("".concat(a," ok. data:").concat(JSON.stringify(h))),h=n._handleResult(h),Kt(h)}).catch(function(h){return s.setError(h).end(),K.e("".concat(a," failed. error:"),h),De(h)})}},{key:"_handleResult",value:function(m){var a=m.messageRemindType,s=m.startTime,h=m.endTime,m=m.isRepeated,I=O.MSG_REMIND_ACPT_AND_NOTE;return a===1&&(I=O.MSG_REMIND_DISCARD),{messageRemindType:I=a===2?O.MSG_REMIND_ACPT_NOT_NOTE:I,startTime:s,endTime:h,isRepeated:m===1}}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}]),Fp=p(function n(a){u(this,n),this._convM=a,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=Vs},[{key:"setConvCustomData",value:function(n){var a=this,s="".concat(this._n,".").concat("setConvCustomData"),h=n.conversationIDList,m=n.customData,I=(K.l("".concat(s," options:"),n),new ct("setConvCustomData")),T=(I.setMessage(JSON.stringify(n)),{fromAccount:this._getMyUserID(),itemList:[]}),D=[],V=[];return h.forEach(function($){var q;return a._hasLocalConv($)?Gr($)||Br($)?(q={operationType:2,contactItem:void 0,customMark:m},Gr($)?q.contactItem={type:1,toAccount:$.replace(O.CONV_C2C,"")}:Br($)&&(q.contactItem={type:2,groupID:$.replace(O.CONV_GROUP,"")}),void T.itemList.push(q)):(a._onConvIDInvalid(V,$),!0):(a._onConvNotFound(V,$),!0)}),V.length===h.length?ln({successConversationIDList:D,failureConversationIDList:V}):this._convM.req({P:de.SET_CONV_CUSTOM_DATA,data:T}).then(function(fe){I.end(),K.l("".concat(s," ok"));var q,se,me,fe=fe.data.resultItem;return wt(fe)&&(me=!1,fe.forEach(function(He){q=a._concatConvID(He.contactItem),He.resultCode===0?(D.push(q),(se=a._getLocalConv(q))&&se.customData!==m&&(se.customData=m,me=!0)):V.push({conversationID:q,code:He.resultCode,message:He.resultInfo})}),me===!0)&&a._emitConvUpdate(),Kt({successConversationIDList:D,failureConversationIDList:V})}).catch(function($){return I.setError($).end(),K.e("".concat(s," failed. error:"),$),De($)})}},{key:"markConv",value:function(n){var a,s,h,m,I,T,D,V,$,q,se=this;return this._convM.canIUse(ye.CONV_MARK)?(a="".concat(this._n,".").concat("markConv"),s=n.conversationIDList,h=n.markType,m=n.enableMark,K.l("".concat(a," options:"),n),I=new ct("markConv"),T=void I.setMessage(JSON.stringify(n)),D=void 0,n=this._getFlagBit(h),m===!0?D=[n]:T=[n],V={fromAccount:this._getMyUserID(),itemList:[]},$=[],q=[],s.forEach(function(me){var fe;return se._hasLocalConv(me)?Gr(me)||Br(me)?(fe={operationType:1,contactItem:void 0,clearMark:T,setMark:D},Gr(me)?fe.contactItem={type:1,toAccount:me.replace(O.CONV_C2C,"")}:Br(me)&&(fe.contactItem={type:2,groupID:me.replace(O.CONV_GROUP,"")}),void V.itemList.push(fe)):(se._onConvIDInvalid(q,me),!0):(se._onConvNotFound(q,me),!0)}),q.length===s.length?ln({successConversationIDList:$,failureConversationIDList:q}):this._convM.req({P:de.MARK_CONV,data:V}).then(function(Ye){I.end(),K.l("".concat(a," ok"));var fe,He,Xe,Ye=Ye.data.resultItem;return wt(Ye)&&(Xe=!1,Ye.forEach(function(Lt){var yt;fe=se._concatConvID(Lt.contactItem),Lt.resultCode===0?($.push(fe),(He=se._getLocalConv(fe))&&(yt=He.markList.indexOf(h),m===!0?yt===-1&&(He.markList.push(h),Xe=!0):yt!==-1&&(He.markList.splice(yt,1),Xe=!0))):q.push({conversationID:fe,code:Lt.resultCode,message:Lt.resultInfo})}),Xe===!0)&&se._emitConvUpdate(),Kt({successConversationIDList:$,failureConversationIDList:q})}).catch(function(me){return I.setError(me).end(),K.e("".concat(a," failed. error:"),me),De(me)})):this._convM.noUse("markConv")}},{key:"getLocalConvGroupList",value:function(){var n=this;return K.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===bl?this.getRemoteConvGroupList().then(function(){return Kt(P(n._convGroupMap.values()))}):ln(P(this._convGroupMap.values()))}},{key:"searchConvGroupAndMark",value:function(n,a){var s=this,h="".concat(this._n,".searchConvGroupAndMark"),m=[];return n.forEach(function(I){a===1?m.push({type:1,toAccount:I}):a===2&&m.push({type:2,groupID:I})}),K.l("".concat(h," type:").concat(a," list:"),n),this._convM.req({P:de.SEARCH_CONV_GRP_MARK,data:{fromAccount:this._getMyUserID(),contactItem:m}}).then(function(D){var D=D.data,T=D.contactItem,D=D.groupItem;K.l("".concat(h," ok. contactItem:"),T,"groupItem:",D),s._fillConvGroupMap(D),s._handleContactItem(T),s._emitConvUpdate()}).catch(function(I){K.w("".concat(h," failed. error:"),I)})}},{key:"_fillConvGroupMap",value:function(n){var a=this;wt(n)&&n.forEach(function(m){var h=m.convGroupID,m=m.groupName;a._convGroupMap.set(h,m)})}},{key:"_handleContactItem",value:function(n){var a,s=this;wt(n)&&n.forEach(function(h){var m=[],I=h.standardMark,T=h.customData,D=h.convGroupIDList;wt(D)&&D.forEach(function(V){s._convGroupMap.has(V)&&m.push(s._convGroupMap.get(V))}),a=s._concatConvID(h),(a=s._getLocalConv(a))&&(a.markList=Pa(I),a.customData=T||"",a.conversationGroupList=[].concat(m))})}},{key:"getRemoteConvGroupList",value:function(){var n=this,a="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=RI,this._convM.req({P:de.GET_CONV_GRP_LIST,data:{fromAccount:this._getMyUserID(),startIndex:this._startIndex}}).then(function(T){var T=T.data,h=T.completeFlag,m=T.contactItem,I=T.nextStartIndex,I=I===void 0?0:I,T=T.groupItem;if(n._startIndex=I,K.l("".concat(a," completeFlag:").concat(h," nextStartIndex:").concat(I,", groupItem:"),T,"contactItem:",m),n._fillConvGroupMap(T),n._handleContactItem(m),h===0)return n.getRemoteConvGroupList();h===1&&(n._pagingStatus=_h,n._emitConvUpdate(),n._emitConvGroupListUpdate())}).catch(function(s){n._pagingStatus=bl,K.w("".concat(a," failed. error:"),s)})}},{key:"createConvGroup",value:function(n){var a,s,h,m,I,T,D=this;return this._convM.canIUse(ye.CONV_GROUP)?(a="".concat(this._n,".").concat("createConvGroup"),K.l("".concat(a," options:"),n),(s=new ct("createConvGroup")).setMessage(JSON.stringify(n)),h=n.groupName,n=n.conversationIDList,m={fromAccount:this._getMyUserID(),itemList:[{groupName:h,contactItem:[]}]},I=[],T=[],n.forEach(function(V){return D._hasLocalConv(V)?Gr(V)||Br(V)?void(Gr(V)?m.itemList[0].contactItem.push({type:1,toAccount:V.replace(O.CONV_C2C,"")}):Br(V)&&m.itemList[0].contactItem.push({type:2,groupID:V.replace(O.CONV_GROUP,"")})):(D._onConvIDInvalid(T,V),!0):(D._onConvNotFound(T,V),!0)}),T.length===n.length?ln({successConversationIDList:I,failureConversationIDList:T}):this._convM.req({P:de.CREATE_CONV_GRP,data:m}).then(function(fe){s.end(),K.l("".concat(a," ok"));var $,q,se,fe=fe.data.groupResultItem[0],me=fe.groupItem,fe=fe.resultItem;return On(me)&&(D._convGroupMap.set(me.convGroupID,me.groupName),D._emitConvGroupListUpdate()),wt(fe)&&(se=!1,fe.forEach(function(He){$=D._concatConvID(He.contactItem),He.resultCode===0?(I.push($),(q=D._getLocalConv($))&&q.conversationGroupList.indexOf(h)===-1&&(q.conversationGroupList.push(h),se=!0)):T.push({conversationID:$,code:He.resultCode,message:He.resultInfo})}),se===!0)&&(D._emitConvUpdate(),D._emitConvGroupListUpdate()),Kt({successConversationIDList:I,failureConversationIDList:T})}).catch(function(V){return s.setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})):this._convM.noUse("createConvGroup")}},{key:"deleteConvGroup",value:function(n){var a,s,h=this;return this._convM.canIUse(ye.CONV_GROUP)?(a="".concat(this._n,".").concat("deleteConvGroup"),K.l("".concat(a," groupName:").concat(n)),(s=new ct("deleteConvGroup")).setMessage(n),this._convM.req({P:de.DEL_CONV_GRP,data:{fromAccount:this._getMyUserID(),groupName:[n]}}).then(function(T){s.end(),K.l("".concat(a," ok"));var I,T=T.data.groupItem;wt(T)&&(I=!1,T.forEach(function(D){h._convGroupMap.has(D.convGroupID)&&(h._convGroupMap.delete(D.convGroupID),I=!0)}),I===!0)&&h._emitConvGroupListUpdate(),h._eraseFromConversationGroupList([n])}).catch(function(m){return s.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})):this._convM.noUse("deleteConvGroup")}},{key:"renameConvGroup",value:function(n){var a,s,h,m,I=this;return this._convM.canIUse(ye.CONV_GROUP)?(a="".concat(this._n,".").concat("renameConvGroup"),K.l("".concat(a," options:"),n),(s=new ct("renameConvGroup")).setMessage(JSON.stringify(n)),h=n.oldName,m=n.newName,this._convM.req({P:de.RENAME_CONV_GRP,data:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:h,newName:m}}}).then(function($){s.end(),K.l("".concat(a," ok")),$=$.data.updateGroupResult.convGroupID,I._convGroupMap.set($,m),I._emitConvGroupListUpdate();var D,V,$=I._convM.getLocalConvList(),q=!1;$.forEach(function(se){D=se.conversationGroupList,(V=D.indexOf(h))!==-1&&(D.splice(V,1,m),q=!0)}),q===!0&&I._emitConvUpdate()}).catch(function(T){return s.setError(T).end(),K.e("".concat(a," failed. error:"),T),De(T)})):this._convM.noUse("renameConvGroup")}},{key:"addConvsToGroup",value:function(n){var a,s,h,m,I,T,D,V=this;return this._convM.canIUse(ye.CONV_GROUP)?(a="".concat(this._n,".").concat("addConvsToGroup"),K.l("".concat(a," options:"),n),(s=new ct("addConvsToGroup")).setMessage(JSON.stringify(n)),h=n.conversationIDList,m=n.groupName,I={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:m,updateItem:[]}},T=[],D=[],h.forEach(function($){return V._hasLocalConv($)?Gr($)||Br($)?void(Gr($)?I.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:$.replace(O.CONV_C2C,"")}}):Br($)&&I.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:$.replace(O.CONV_GROUP,"")}})):(V._onConvIDInvalid(D,$),!0):(V._onConvNotFound(D,$),!0)}),D.length===h.length?ln({successConversationIDList:T,failureConversationIDList:D}):this._convM.req({P:de.ADD_CONV_TO_GRP,data:I}).then(function(fe){s.end(),K.l("".concat(a," ok"));var q,se,me,fe=fe.data.updateGroupResult.contactResultItem;return wt(fe)&&(me=!1,fe.forEach(function(He){q=V._concatConvID(He.contactItem),He.resultCode===0?(se=V._getLocalConv(q))&&se.conversationGroupList.indexOf(m)===-1&&(se.conversationGroupList.push(m),T.push(q),me=!0):D.push({conversationID:q,code:He.resultCode,message:He.resultInfo})}),me===!0)&&(V._emitConvUpdate(),V._emitConvInGroupUpdate(m)),Kt({successConversationIDList:T,failureConversationIDList:D})}).catch(function($){return s.setError($).end(),K.e("".concat(a," failed. error:"),$),De($)})):this._convM.noUse("addConvsToGroup")}},{key:"deleteConvsFromGroup",value:function(n){var a,s,h,m,I,T,D,V=this,$="deleteConvsFromGroup";return this._convM.canIUse(ye.CONV_GROUP)?(a="".concat(this._n,".").concat($),K.l("".concat(a," options:"),n),(s=new ct($)).setMessage(JSON.stringify(n)),h=n.conversationIDList,m=n.groupName,I={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:m,updateItem:[]}},T=[],D=[],h.forEach(function(q){return V._hasLocalConv(q)?Gr(q)||Br(q)?void(Gr(q)?I.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:q.replace(O.CONV_C2C,"")}}):Br(q)&&I.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:q.replace(O.CONV_GROUP,"")}})):(V._onConvIDInvalid(D,q),!0):(V._onConvNotFound(D,q),!0)}),D.length===h.length?ln({successConversationIDList:T,failureConversationIDList:D}):this._convM.req({P:de.DEL_CONV_FROM_GRP,data:I}).then(function(He){s.end(),K.l("".concat(a," ok"));var se,me,fe,He=He.data.updateGroupResult.contactResultItem;return wt(He)&&(fe=!1,He.forEach(function(Xe){var Ye;se=V._concatConvID(Xe.contactItem),Xe.resultCode===0?(me=V._getLocalConv(se))&&(Ye=me.conversationGroupList.indexOf(m))!==-1&&(me.conversationGroupList.splice(Ye,1),T.push(se),fe=!0):D.push({conversationID:se,code:Xe.resultCode,message:Xe.resultInfo})}),fe===!0)&&(V._emitConvUpdate(),V._emitConvInGroupUpdate(m)),Kt({successConversationIDList:T,failureConversationIDList:D})}).catch(function(q){return s.setError(q).end(),K.e("".concat(a," failed. error:"),q),De(q)})):this._convM.noUse($)}},{key:"onConvMarkUpdated",value:function(n){var a,s,h=this;Tt(n)||(K.l("".concat(this._n,".onConvMarkUpdated markItemList:"),n),s=!1,n.forEach(function(V){var I=V.recentContactItem,T=V.optType,D=V.standardMark,V=V.customMark;a=h._concatConvID(I),(a=h._getLocalConv(a))&&(T===1?s=h._diffStandardMark(a,D):T===2?s=h._diffCustomMark(a,V):T===3&&(I=h._diffStandardMark(a,D),T=h._diffCustomMark(a,V),s=I||T))}),s===!0&&this._emitConvUpdate())}},{key:"_diffStandardMark",value:function(n,s){var s=Pa(s),h=!1;return function(m,I){if(m!==I){if(!m||!I||m.length!==I.length)return!1;for(var T=0,D=m.length;T<D;T++)if(m[T]!==I[T])return!1}return!0}(n.markList,s)!==!0&&(n.markList=s,h=!0),h}},{key:"_diffCustomMark",value:function(n,a){var s=!1;return n.customData!==a&&a!==void 0&&(n.customData=a,s=!0),s}},{key:"onConvGroupCreated",value:function(n){var a=this,s=(K.l("".concat(this._n,".onConvGroupCreated resultList:"),n),!1),h=!1;wt(n)&&(n.forEach(function(m){var V=m.msgGroupItem,I=V.groupID,T=V.groupName;a._convGroupMap.get(I)!==T&&(a._convGroupMap.set(I,T),h=!0);var D,V=m.msgRecentContactItem;wt(V)&&V.forEach(function($){D=a._concatConvID($),(D=a._getLocalConv(D))&&D.conversationGroupList.indexOf(T)===-1&&(D.conversationGroupList.push(T),s=!0)})}),s===!0&&this._emitConvUpdate(),h===!0)&&this._emitConvGroupListUpdate()}},{key:"onConvGroupDeleted",value:function(n){var a,s=this,h=(K.l("".concat(this._n,".onConvGroupDeleted groupItemList:"),n),[]);wt(n)&&(a=!1,n.forEach(function(T){var I=T.groupID,T=T.groupName;s._convGroupMap.has(I)&&(s._convGroupMap.delete(I),a=!0,h.push(T))}),a===!0)&&this._emitConvGroupListUpdate(),this._eraseFromConversationGroupList(h)}},{key:"_eraseFromConversationGroupList",value:function(n){Tt(n)||(this._convM.getLocalConvList().forEach(function(a){a.conversationGroupList=a.conversationGroupList.filter(function(s){return!n.includes(s)})}),this._emitConvUpdate())}},{key:"onConvGroupNameUpdated",value:function(n){K.l("".concat(this._n,".onConvGroupNameUpdated options:"),n);var a,s,h,m=n.groupID,I=n.groupName,T=n.oldGroupName;this._convGroupMap.get(m)!==I&&(this._convGroupMap.set(m,I),this._emitConvGroupListUpdate(),n=this._convM.getLocalConvList(),h=!1,n.forEach(function(D){a=D.conversationGroupList,(s=a.indexOf(T))!==-1&&(a.splice(s,1,I),h=!0)}),h===!0)&&this._emitConvUpdate()}},{key:"onConvInGroupUpdated",value:function(T){var a,s,h,m=this,I=(K.l("".concat(this._n,".onConvInGroupUpdated options:"),T),T.oldGroupName),T=T.recentContactUpdateGroupItem;wt(T)&&(h=!1,T.forEach(function($){var V=$.contactOptType,$=$.recentContactItem;a=m._concatConvID($),(a=m._getLocalConv(a))&&(s=a.conversationGroupList.indexOf(I),V===1?s===-1&&(a.conversationGroupList.push(I),h=!0):V===2&&s!==-1&&(a.conversationGroupList.splice(s,1),h=!0))}),h===!0)&&(this._emitConvUpdate(),this._emitConvInGroupUpdate(I))}},{key:"onConvAddedToOrDeletedFromGroup",value:function(m){var a,s,h=this,I=(K.l("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),m),m.msgRecentContactItem),m=m.msgRecentContactUpdateContactItem,I=this._concatConvID(I),T=this._getLocalConv(I);T&&wt(m)&&(s=!1,m.forEach(function($){var V=$.groupOptType,$=$.recentContactGroupItem.groupName;a=T.conversationGroupList.indexOf($),V===1?a===-1&&(T.conversationGroupList.push($),s=!0):V===2&&a!==-1&&(T.conversationGroupList.splice(a,1),s=!0),s===!0&&h._emitConvInGroupUpdate($)}),s===!0)&&this._emitConvUpdate()}},{key:"onConvGroupListSynced",value:function(n){wt(n)&&n.length!==0&&(K.l("".concat(this._n,".onConvGroupListSynced groupItem:"),n),this._fillConvGroupMap(n))}},{key:"getConvGroupListByID",value:function(n){var a,s=this;if(!Tt(n))return a=[],n.forEach(function(h){s._convGroupMap.has(h)&&a.push(s._convGroupMap.get(h))}),a}},{key:"_onConvNotFound",value:function(n,a){n.push({conversationID:a,code:Je.CONV_NOT_FOUND,message:this._convM.getErrMsg(Je.CONV_NOT_FOUND)})}},{key:"_onConvIDInvalid",value:function(n,a){n.push({conversationID:a,code:Je.INVALID_CONV_ID,message:this._convM.getErrMsg(Je.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(n){for(var a=n.toString(2),s=a.length,h=s-1;0<=h;h--)if(a[h]==="1")return s-h-1}},{key:"_concatConvID",value:function(I){var a,s=I.type,h=I.to,m=I.groupID,I=I.userID;return s===1?et(I)?et(h)||(a="".concat(O.CONV_C2C).concat(h)):a="".concat(O.CONV_C2C).concat(I):s===2&&(a="".concat(O.CONV_GROUP).concat(m)),a}},{key:"_getMyUserID",value:function(){return this._convM.getMyUserID()}},{key:"_getLocalConv",value:function(n){return this._convM.getLocalConversation(n)}},{key:"_hasLocalConv",value:function(n){return this._convM.hasLocalConversation(n)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._convM.emitOEvt(W.CONVERSATION_GROUP_LIST_UPDATED,P(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(n){var a={groupName:n,conversationList:[]},s=this._convM.getLocalConvList();a.conversationList=s.filter(function(h){return h.conversationGroupList.includes(n)}),this._convM.emitOEvt(W.CONVERSATION_IN_GROUP_UPDATED,a)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=Vs}}]),Uv=(S($p,$o),p($p,[{key:"_initListeners",value:function(){var n=this.getIEmitInst();n.on(So.A2KEY_AND_TINYID_UPDATED,this._init,this),n.on(So.PROFILE_UPDATED,this._onProfileUpdated,this),n.on(So.CLOUD_CONFIG,this._onCloudConfig,this)}},{key:"_init",value:function(){var n=this,a=(K.l("".concat(this._n,"._init")),this.get(13).getItem("conversationMap")),s=this.isIntl(),h=this.isUsingChatCore();if(a){for(var m=a.length,I=0;I<m;I++){var T=a[I];T&&(this._isNonExistentAccount(T.conversationID)||T.groupProfile&&jr(T.groupProfile.type))||this._convMap.set(T.conversationID,new fc(a[I],s,h))}this.emitConvUpdate(!0,!1)}this.ready(function(){0<n._tmpGroupList.length&&(n.updateConvGroupProfile(n._tmpGroupList),n._tmpGroupList.length=0)}),this.syncConvList()}},{key:"_isNonExistentAccount",value:function(n){var a;return(a=n.startsWith(O.CONV_C2C)?n.replace(O.CONV_C2C,""):a)==="@TLS#ERROR"||a==="@TLS#NOT_FOUND"}},{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&this._msgListHandler.onCheckTimer(n)}},{key:"onMessageSent",value:function(n){this._onSendOrRcvMsg({conversationOptionsList:n.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(n){this._onSendOrRcvMsg(n)}},{key:"_onSendOrRcvMsg",value:function(n){var a=this,s=n.conversationOptionsList,h=n.isInstantMessage,h=h===void 0||h,m=n.isUnreadC2CMessage,m=m!==void 0&&m,I=n.updateUnreadCount,I=I===void 0||I,T=n.isSyncingEnded,T=T!==void 0&&T;this._isReady?s.length!==0?(h===!0&&this._checkNewConv(s),this._updateLocalConvList({conversationOptionsList:s,isInstantMessage:h,isUnreadC2CMessage:m,isFromGetConversations:!1,updateUnreadCount:I}),h||(this._convIDFromUnreadDBMap=new Map([].concat(P(this._convIDFromUnreadDBMap),P(s.map(function(D){return[D.conversationID,1]})))),this._diffAndDeleteConv(),T&&this.emitIEvt(So.C2C_UNREAD_HANDLE_COMPLETED)),0<s.filter(function(D){return!a._isConvNeedShow(D.conversationID)}).length||this.emitConvUpdate()):T&&this.emitIEvt(So.C2C_UNREAD_HANDLE_COMPLETED):this.ready(function(){a._onSendOrRcvMsg(n)})}},{key:"updateConvGroupProfile",value:function(n){var a,s=this;wt(n)&&n.length===0||(this._convMap.size!==0?(a=!1,n.forEach(function(h){var m="".concat(O.CONV_GROUP).concat(h.groupID);s._convMap.has(m)&&(a=!0,(m=s._convMap.get(m)).groupProfile=JSON.parse(JSON.stringify(h)),m.lastMessage.lastSequence<h.nextMessageSeq&&(m.lastMessage.lastSequence=h.nextMessageSeq-1),m.subType||(m.subType=h.type))}),a&&this.emitConvUpdate(!0,!1)):this._tmpGroupList=n)}},{key:"onMessageRevoked",value:function(n,a){var s,h,m,I=this;n.length!==0&&(s=null,h=!1,m=[],n.forEach(function(T){(s=I._convMap.get(T.conversationID))&&(a&&s.reduceUnreadCount()&&(h=s.type!==O.CONV_TOPIC),s.type===O.CONV_TOPIC?m.push(T):s.isLastMessageRevoked({sequence:T.sequence,time:T.time})&&(s.setLastMessageRevoked(!0),s.setLastMessageRevoker(T.revoker),h=!0))}),this.get(10).onMessageRevoked(m),h)&&this.emitConvUpdate(!0,!1)}},{key:"updateRevokerInfo",value:function(n){for(var a=new Set,s=0;s<n.length;s++){var h=n[s].revoker;a.add(h)}var m=P(a),I=this.get(4);return new Promise(function(T){I.getUserProfile({userIDList:m}).then(function(D){if(D=D.data,!wt(D)||D.length===0)return T(n);var V,$={},q=v(D);try{for(q.s();!(V=q.n()).done;){var se=V.value,me=se.userID,fe=se.nick,He=se.avatar;$[me]={nick:fe,avatar:He}}}catch(Xe){q.e(Xe)}finally{q.f()}n.forEach(function(Xe){var Ye=Xe.revoker;$[Ye]&&(Xe.revokerInfo.nick=$[Ye].nick||"",Xe.revokerInfo.avatar=$[Ye].avatar||"")}),T(n)}).catch(function(){T(n)})})}},{key:"isLastMessageRevoked",value:function(n){var a=!1,s=n.conversationID,h=n.sequence,m=n.time,I=this._convMap.get(s);return I&&(a=I.type===O.CONV_TOPIC?this.get(10).isLastMessageRevoked({topicID:s.replace(O.CONV_GROUP,""),sequence:h}):I.isLastMessageRevoked({sequence:h,time:m})),K.l("".concat(this._n,".isLastMessageRevoked options:"),n,"ret:".concat(a)),a}},{key:"onMessageDeleted",value:function(n){var a=this;if(n.length!==0){var s=null;n.forEach(function(V){(s=a._msgListHandler.getLocalMsg(V.conversationID,V.ID))&&(s.isDeleted=!0),V!==s&&(V.isDeleted=!0)});for(var n=n[0].conversationID,h=this._msgListHandler.getLocalMsgList(n),m={},I=h.length-1;0<=I;I--)if(!h[I].isDeleted){m=h[I];break}var T,D=this._convMap.get(n);D&&(T=!1,D.lastMessage.lastSequence===m.sequence&&D.lastMessage.lastTime===m.time||(Tt(m)&&(m=void 0),D.updateLastMessage(m),D.type!==O.CONV_TOPIC&&(T=!0),K.l("".concat(this._n,".onMessageDeleted. update convID:").concat(n," with lastMessage:"),D.lastMessage)),n.startsWith(O.CONV_C2C)&&this.updateUnreadCount(n),T)&&this.emitConvUpdate(!0,!1)}}},{key:"onMessageModified",value:function(n){var a="".concat(this._n,".onMessageModified"),q=n.conversationType,s=n.from,h=n.to,m=n.time,I=n.sequence,T=n.elements,D=n.cloudCustomData,V=n.messageVersion,se=this.getMyUserID(),$="".concat(q).concat(h),se=(h===se&&q===O.CONV_C2C&&($="".concat(q).concat(s)),this._msgListHandler.onMsgModified($,n)),q=se.isUpdated,se=se.message,me=(q===!0&&this.emitOEvt(W.MESSAGE_MODIFIED,[se]),this._isTopicConv($));return se===null?K.l("".concat(a," message is null! options:"),n):K.l("".concat(a," isUpdated:").concat(q," isTopicMessage:").concat(me," from:").concat(s," to:").concat(h," sequence:").concat(se.sequence," time:").concat(se.time)),me?this.get(10).onMessageModified(n):(q=this._convMap.get($))&&(s=q.lastMessage)&&s.lastTime===m&&s.lastSequence===I&&s.version!==V&&(K.l("".concat(a," convID:").concat($," lastMessage updated")),s.type=T[0].type,s.payload=T[0].content,s.messageForShow=mh(s.type,s.payload,this.isIntl()),s.cloudCustomData=D,s.version=V,this.emitConvUpdate(!0,!1)),se}},{key:"onNewGroupAtTips",value:function(s){var a=this,s=s.dataList,h=null;s.forEach(function(m){m.groupAtTips?h=m.groupAtTips:m.elements?h=E(E({},m.elements),{},{sync:!0}):m.groupAtType&&(h=E(E({},m),{},{sync:!0})),h.__random=m.random,h.__sequence=m.clientSequence,a._tmpGroupAtTipsList.push(h)}),K.l("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var n,a=this;this._tmpGroupAtTipsList.length!==0&&(n=!1,this._tmpGroupAtTipsList.forEach(function(s){var h=s.groupID,m=s.from,I=s.topicID,I=I===void 0?void 0:I,T=s.sync,T=T!==void 0&&T;m!==a.getMyUserID()&&(et(I)?(m=a._convMap.get("".concat(O.CONV_GROUP).concat(h)))&&(m.updateGroupAtInfoList(s),n=!0):((h=a._convMap.get("".concat(O.CONV_GROUP).concat(I)))&&(h.updateGroupAtInfoList(s),a.get(10).onAtInfoUpdated({topicID:I,groupAtInfoList:h.groupAtInfoList})),Tt(h)&&T&&(a.updateTopicConversation([{conversationID:"".concat(O.CONV_GROUP).concat(I),type:O.CONV_TOPIC}]),a._convMap.get("".concat(O.CONV_GROUP).concat(I)).updateGroupAtInfoList(s))))}),n&&this.emitConvUpdate(!0,!1),this._tmpGroupAtTipsList.length=0)}},{key:"_checkNewConv",value:function(n){var a=this,s=[],h=[];n.forEach(function(m){a._convMap.has(m.conversationID)||(m.type===O.CONV_C2C?s.push(m.conversationID.replace(O.CONV_C2C,"")):m.type===O.CONV_GROUP&&h.push(m.conversationID.replace(O.CONV_GROUP,"")))}),0<s.length&&(this._onNewC2CConv(s),s=null),0<h.length&&(this._onNewGroupConv(h),h=null)}},{key:"_onNewC2CConv",value:function(n){var a=this.get(6);return Promise.all([a.getRemotePeerReadTime(n),this._msgRemindHandler.getC2CMsgRemindType(n),this._convGroupHandler.searchConvGroupAndMark(n,1)])}},{key:"_onNewGroupConv",value:function(n){var a=this.get(7);return a?Promise.all([a.getMsgRemindType(n),this._convGroupHandler.searchConvGroupAndMark(n,2)]):Promise.resolve()}},{key:"_setStorageConvList",value:function(){var n=0<arguments.length&&arguments[0]!==void 0&&arguments[0],a=this.getLocalConvList().filter(function(s){return s.type===O.CONV_C2C||s.type===O.CONV_GROUP&&s.lastMessage.type!==O.MSG_GRP_TIP}).slice(0,20).map(function(s){return{conversationID:s.conversationID,type:s.type,subType:s.subType,lastMessage:s.lastMessage,groupProfile:s.groupProfile,userProfile:s.userProfile}});this.get(13).setItem("conversationMap",a,n)}},{key:"emitConvUpdate",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],a=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=this.getLocalConvList();a&&(a=this.get(7))&&a.updateGroupLastMessage(s),n&&(this.get(12).isPartialUpdatedConvs()?(this._diffConvMap(this._convMapForDiff,this._convMap),0<this._partialUpdatedConvMap.size&&(this.emitOEvt(W.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate(),this._convMapForDiff.clear(),this._convMapForDiff=bt(this._convMap,!0)),this._convMapForDiff.size===0&&(this._convMapForDiff=bt(this._convMap,!0))):(this.emitOEvt(W.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate()))}},{key:"_diffConvMap",value:function(n,a){var s,h=v(a);try{for(h.s();!(s=h.n()).done;){var m=x(s.value,2),I=m[0],T=m[1];n.has(I)&&JSON.stringify(T)===n.get(I)||this._partialUpdatedConvMap.set(I,T)}}catch(D){h.e(D)}finally{h.f()}}},{key:"getPartialUpdatedConvs",value:function(){var n=P(bt(this._partialUpdatedConvMap,!1).values());return this._partialUpdatedConvMap.clear(),n}},{key:"getLocalConvList",value:function(){var n=this;return P(this._convMap.values()).filter(function(a){return n._isConvNeedShow(a.conversationID)})}},{key:"getLocalConversation",value:function(n){return this._convMap.get(n)}},{key:"hasLocalConversation",value:function(n){return this._convMap.has(n)}},{key:"getLocalOldestMessage",value:function(n){return this._msgListHandler.getLocalOldestMsg(n)}},{key:"syncConvList",value:function(){var n=this,a=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s="syncConvList",h=new ct(s);return this._pagingStatus===Vs&&this._convMap.clear(),this._pagingGetConvList(a).then(function(m){var I=gh(n._pagingGetCostList),T=TI(n._pagingGetCostList),T=(n._pagingGetCostList.length=0,n._pagingStatus=_h,n._diffAndDeleteConv(),n.emitConvUpdate(!0,!1),n._setStorageConvList(),n._handleC2CPeerReadTime(),n.emitIEvt(So.CONV_SYNC_COMPLETED),"count:".concat(n._convMap.size," sum:").concat(T," avg:").concat(I));return K.l("".concat(n._n,".").concat(s,". ").concat(T)),h.setMessage(T).end(),m}).catch(function(m){return n._pagingStatus=bl,h.setMessage(n._pagingTs).setError(m).end(),De(m)})}},{key:"_diffAndDeleteConv",value:function(){var n,a=this;this._isSyncCompleted()&&(n=[],this._convMap.forEach(function(s,h){!a._pagingConvIDMap.has(h)&&a._convIDFromUnreadDBMap.has(h)&&(a._convMap.delete(h),n.push(h))}),K.l("".concat(this._n,"._diffAndDeleteConv list:").concat(n)),n=null)}},{key:"_pagingGetConvList",value:function(){var n=this,a=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s="".concat(this._n,"._pagingGetConvList"),h=(K.l("".concat(s," incrementalPullFlag:").concat(a," ts:").concat(this._pagingTs," startIdx:").concat(this._pagingStartIdx)+" pinnedTs:".concat(this._pagingPinnedTs," pinnedStartIdx:").concat(this._pagingPinnedStartIdx)),Date.now());return this._pagingStatus=RI,this.req({P:de.PAGING_GET_CONV_LIST,data:{fromAccount:this.getMyUserID(),timeStamp:a?this._pagingTs:0,startIndex:a?this._pagingStartIdx:0,pinnedTimeStamp:a?this._pagingPinnedTs:0,pinnedStartIndex:a?this._pagingPinnedStartIdx:0,orderType:1}}).then(function(se){var se=se.data,I=se.completeFlag,T=se.conversations,T=T===void 0?[]:T,D=se.timeStamp,V=se.startIndex,$=se.pinnedTimeStamp,q=se.pinnedStartIndex,se=se.groupItem;if(n._pagingGetCostList.push(br(h,!1)),K.l("".concat(s," ok. completeFlag:").concat(I," count:").concat(T.length," cost:").concat(br(h))),n._convGroupHandler.onConvGroupListSynced(se),0<T.length&&(se=n._getConvOptions(T),n._pagingConvIDMap=new Map([].concat(P(n._pagingConvIDMap),P(se.map(function(me){return[me.conversationID,1]})))),n._updateLocalConvList({conversationOptionsList:se,isFromGetConversations:!0,updateUnreadCount:!0}),n.isLoggedIn())&&n.emitConvUpdate(),!n._isReady){if(!n.isLoggedIn())return ln();n.triggerReady()}return n._pagingTs=D,n._pagingStartIdx=V,n._pagingPinnedTs=$,n._pagingPinnedStartIdx=q,I!==1?n._pagingGetConvList():(n._handleGroupAtTipsList(),n._convGroupHandler.getRemoteConvGroupList(),ln())}).catch(function(m){throw!n.isLoggedIn()||n._isReady||(K.w("".concat(s," failed. error:"),m),n.triggerReady()),m})}},{key:"_updateLocalConvList",value:function(h){var a=h.isFromGetConversations,s=Date.now(),h=this._getTmpConvListMapping(h).newConvList;this._convMap=new Map(this._sortConvList(P(this._convMap))),a||this._updateUserOrGroupProfile(h),K.l("".concat(this._n,"._updateLocalConvList cost:").concat(br(s)))}},{key:"_getTmpConvListMapping",value:function(n){for(var a=n.conversationOptionsList,s=n.isFromGetConversations,h=n.isInstantMessage,m=n.isUnreadC2CMessage,I=m!==void 0&&m,T=n.updateUnreadCount,D=[],V=[],$=this.get(7),q=this.get(8),se=this.isIntl(),me=this.isUsingChatCore(),fe=0,He=a.length;fe<He;fe++){var Xe=new fc(a[fe],se,me),Ye=Xe.conversationID,Lt=Xe.type;if(!this._isNonExistentAccount(Ye)){if(this._convMap.has(Ye)){var yt=this._convMap.get(Ye);if(s&&Lt!==O.CONV_TOPIC){this._convMap.set(Ye,Xe),Lt===O.CONV_C2C?Xe.unreadCount=yt.unreadCount:Lt===O.CONV_GROUP&&(Xe.groupProfile=JSON.parse(JSON.stringify(yt.groupProfile)));continue}var rn=["unreadCount","allowType","adminForbidType","payload"],on=(h===!1&&rn.push("lastMessage"),typeof h=="boolean"&&rn.push("isPinned"),a[fe].lastMessage),Pn=!et(on);Pn||a[fe].type===O.CONV_TOPIC||this._onLastMsgNotExist(a[fe]),et(h)&&Pn&&yt.lastMessage.payload===null&&(yt.lastMessage.payload=on.payload),Tt(yt.lastMessage.revoker)||(yt.lastMessage.revoker=null),ei(yt,Xe,rn,[null,void 0,"",0,NaN]),T===!0&&yt.updateUnreadCount({nextUnreadCount:Xe.unreadCount,isFromGetConversations:s,isUnreadC2CMessage:I}),h&&Pn&&(on.payload&&(yt.lastMessage.payload=on.payload),yt.type===O.CONV_GROUP)&&(yt.lastMessage.nameCard=on.nameCard,yt.lastMessage.nick=on.nick),Pn&&yt.lastMessage.cloudCustomData!==on.cloudCustomData&&(yt.lastMessage.cloudCustomData=on.cloudCustomData||"")}else Lt===O.CONV_GROUP&&$?(rn=Xe.groupProfile.groupID,(Pn=$.getLocalGroupProfile(rn))&&(Xe.groupProfile=Pn,T===!0)&&Xe.updateUnreadCount({nextUnreadCount:0})):Lt===O.CONV_C2C&&(yt=Ye.replace(O.CONV_C2C,""),q)&&q.isMyFriend(yt)&&(Xe.remark=q.getFriendRemark(yt)),D.push(Xe),this._convMap.set(Ye,Xe);this._convMap.get(Ye).type===O.CONV_TOPIC&&V.push(this._convMap.get(Ye))}}for(var Gn=this.get(10),Jn=0,qo=V.length;Jn<qo;Jn++){var yo=V[Jn],ko=yo.conversationID,yo=yo.groupAtInfoList;Tt(yo)||Gn.onAtInfoUpdated({topicID:ko.replace(O.CONV_GROUP,""),groupAtInfoList:yo})}return{newConvList:D}}},{key:"_onLastMsgNotExist",value:function(n){new ct("lastMsgNotExist").setMessage(JSON.stringify(n)).end()}},{key:"_sortConvList",value:function(n){var a=[],s=[],h=[],m=[];return n.forEach(function(I){(I[1].isPinned===!0?Tt(I[1].lastMessage.lastTime)?s:a:Tt(I[1].lastMessage.lastTime)?m:h).push(I)}),a.sort(function(I,T){return T[1].lastMessage.lastTime-I[1].lastMessage.lastTime}).concat(s).concat(h.sort(function(I,T){return T[1].lastMessage.lastTime-I[1].lastMessage.lastTime})).concat(m)}},{key:"_sortConvListAndEmitEvent",value:function(){this._convMap=new Map(this._sortConvList(P(this._convMap))),this.emitConvUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(n){var a,s,h,m,I=this;n.length!==0&&(a=[],s=[],h=this.get(4),m=this.get(7),n.forEach(function(T){var D;T.type===O.CONV_C2C?a.push(T.toAccount):T.type===O.CONV_GROUP&&(D=T.toAccount,m.hasLocalGroup(D)?T.groupProfile=m.getLocalGroupProfile(D):s.push(D))}),K.l("".concat(this._n,"._updateUserOrGroupProfile userIDList:").concat(a," groupIDList:").concat(s)),0<a.length&&h.getUserProfile({userIDList:a}).then(function(T){T=T.data,wt(T)?T.forEach(function(D){I._doUpdateUserProfile("".concat(O.CONV_C2C).concat(D.userID),D)}):I._doUpdateUserProfile("".concat(O.CONV_C2C).concat(T.userID),T)}),0<s.length)&&m.getGroupProfileAdvance({groupIDList:s,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then(function(D){var D=D.data.successGroupList,V=!1;D.forEach(function($){var q="".concat(O.CONV_GROUP).concat($.groupID);I._convMap.has(q)&&(q=I._convMap.get(q),ei(q.groupProfile,$,[],[null,void 0,"",0,NaN]),!q.subType&&$.type&&(q.subType=$.type),V=!0)}),V&&I.emitConvUpdate()})}},{key:"_doUpdateUserProfile",value:function(n,a){this.hasLocalConversation(n)&&(this.getLocalConversation(n).userProfile=a,this.emitConvUpdate())}},{key:"_getConvOptions",value:function(m){var a=this,s=[],m=m.filter(function(D){var T=D.type,D=D.userID;return T===1&&!a._isNonExistentAccount(D)||T===2}),h=this.getMyUserID(),m=m.map(function(I){var T;return et(I.lastMsg)&&(I.lastMsg={elements:[]}),I.type===1?(T={userID:I.userID,nick:I.peerNick,avatar:I.peerAvatar},s.push(T),{conversationID:"".concat(O.CONV_C2C).concat(I.userID),type:O.CONV_C2C,lastMessage:{lastTime:I.time,lastSequence:I.sequence,fromAccount:I.lastC2CMsgFromAccount,type:I.lastMsg.elements[0]?I.lastMsg.elements[0].type:null,payload:I.lastMsg.elements[0]?a._amendLayersOverLimitProp(I.lastMsg.elements[0].content,I.lastMsg.elements[0].type):null,cloudCustomData:I.lastMsg.cloudCustomData||"",isRevoked:I.lastMessageFlag===8,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:I.lastC2CMsgFromAccount===h&&I.time<=I.c2cPeerReadTime,revoker:I.lastMsg.revokerInfo?I.lastMsg.revokerInfo.revoker:null},unreadCount:0,userProfile:new Th(T),peerReadTime:I.c2cPeerReadTime,isPinned:I.isPinned===1,customData:I.customMark||"",markList:Pa(I.standardMark),conversationGroupList:a._convGroupHandler.getConvGroupListByID(I.contactGroupId),remark:I.friendRemark||"",messageRemindType:a._transMsgRemindType(I.messageRemindType)}):{conversationID:"".concat(O.CONV_GROUP).concat(I.groupID),type:O.CONV_GROUP,lastMessage:E(E({lastTime:I.time,lastSequence:I.sequence,fromAccount:I.msgGroupFromAccount},a._patchTypeAndPayload(I)),{},{cloudCustomData:I.lastMsg.cloudCustomData||"",isRevoked:I.lastMessageFlag===2,onlineOnlyFlag:!1,nick:I.senderNick||"",nameCard:I.senderNameCard||"",revoker:I.lastMsg.revokerInfo?I.lastMsg.revokerInfo.revoker:null}),groupProfile:new fa({groupID:I.groupID,name:I.groupNick,avatar:I.groupImage,type:I.groupType,nextMessageSeq:I.nextMessageSeq}),unreadCount:a._computeGroupUnreadCount(I),peerReadTime:0,isPinned:I.isPinned===1,version:0,customData:I.customMark||"",markList:Pa(I.standardMark),conversationGroupList:a._convGroupHandler.getConvGroupListByID(I.contactGroupId),messageRemindType:a._transMsgRemindType(I.messageRemindType)}});return 0<s.length&&this.get(4).onConvProfileUpdated(s),m}},{key:"_transMsgRemindType",value:function(n){var a="";return n===0?a=O.MSG_REMIND_ACPT_AND_NOTE:n===1?a=O.MSG_REMIND_DISCARD:n===2?a=O.MSG_REMIND_ACPT_NOT_NOTE:n===3&&(a=O.NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT),a}},{key:"_computeGroupUnreadCount",value:function(a){var s=a.unreadCount,a=a.noUnreadCount,s=(s===void 0?0:s)-(a===void 0?0:a);return 0<s?s:0}},{key:"_patchTypeAndPayload",value:function(h){var h=h.lastMsg,a=h.event,s=h.elements,s=s===void 0?[]:s,h=h.groupTips,h=h===void 0?{}:h;return et(a===void 0?void 0:a)||Tt(h)?{type:s[0]?s[0].type:null,payload:s[0]?this._amendLayersOverLimitProp(s[0].content,s[0].type):null}:((a=new _r(h)).setElement({type:O.MSG_GRP_TIP,content:E(E({},h.elements),{},{groupProfile:h.groupProfile})}),s=JSON.parse(JSON.stringify(a.payload)),a=null,{type:O.MSG_GRP_TIP,payload:s})}},{key:"_amendLayersOverLimitProp",value:function(n,a){var s=this.getFileDownloadProxy(),h=this.getDownloadFileAuthKey(),m=this.get(17).getFileDNList(),I=n.layersOverLimit,T=null;return a===O.MSG_IMAGE&&(T=new ku(n,s,h,m)),a===O.MSG_VIDEO&&(T=new Op(n,s,h,m)),a===O.MSG_SOUND&&(T=new Qi(n,s,h,m)),a===O.MSG_FILE&&((T=new Ch(n,s,h,m)).content.url=void 0),I===0?n.layersOverLimit=!1:I===1&&(n.layersOverLimit=!0),T&&Object.assign(n,T.content),n}},{key:"getLocalMessageList",value:function(n){return this._msgListHandler.getLocalMsgList(n)}},{key:"deleteLocalMessage",value:function(n){n instanceof _r&&this._msgListHandler.remove(n)}},{key:"onConvDeleted",value:function(n){wt(n)&&(n=n.map(function(m){var s=m.type,h=m.userID,m=m.groupID;return s===1?"".concat(O.CONV_C2C).concat(h):s===2?"".concat(O.CONV_GROUP).concat(m):void 0}),K.l("".concat(this._n,".onConvDeleted convIDList:").concat(n)),this.deleteLocalConvList(n))}},{key:"onConvPinnedStatus",value:function(n,a){var s,h=this;wt(n)&&(s=!1,n.forEach(function(V){var I,T=V.type,D=V.userID,V=V.groupID;T===1?I=h.getLocalConversation("".concat(O.CONV_C2C).concat(D)):T===2&&(I=h.getLocalConversation("".concat(O.CONV_GROUP).concat(V))),I&&(K.l("".concat(h._n,".onConvPinnedStatus convID:").concat(I.conversationID," localPinned:").concat(I.isPinned," remotePinned:").concat(a)),a?I.isPinned||(I.isPinned=!0,s=!0):I.isPinned&&(I.isPinned=!1,s=!0))}),s)&&this._sortConvListAndEmitEvent()}},{key:"getMessageList",value:function(m){var a=this,s=m.conversationID,h=m.nextReqMessageID,m=m.count,I="".concat(this._n,".getMessageList"),V=this.getLocalConversation(s),T="";if(V&&V.groupProfile&&(T=V.groupProfile.type),jr(T))return K.l("".concat(I," not available in ").concat(T,". convID:").concat(s)),ln({messageList:[],nextReqMessageID:"",isCompleted:!0});(et(m)||15<m)&&(m=15),h||this._isMeInCommunity(s)||this.clearMemMsg(s);var D=this._computeRemainingCount({conversationID:s,nextReqMessageID:h}),V=this._completedMap.has(s);return K.l("".concat(I," convID:").concat(s," isEverCleared:").concat(this._isEverCleared(s)," nextReqMessageID:").concat(h)+" remainingCount:".concat(D," count:").concat(m," isCompleted:").concat(V)),this._needGetHistory({conversationID:s,remainingCount:D,count:m})?this.getHistoryMessages({conversationID:s,nextReqMessageID:h,count:20}).then(function(se){var q=se.nextReqID,Xe=se.storedMessageList,Ye=se.assembledMessageList,se=se.isPullingCompleted,me=a._completedMap.has(s),fe=Xe,He=(0<D&&(fe=a._msgListHandler.getLocalMsgList(s).slice(0,Xe.length+D)),{nextReqMessageID:void 0,messageList:void 0,isCompleted:void 0}),Xe=(a._isEverCleared(s)?(He.nextReqMessageID=q,He.messageList=Ye,He.isCompleted=se):(He.nextReqMessageID=me?"":q,He.messageList=fe,He.isCompleted=me),He.messageList.filter(function(Lt){return Lt.isRevoked})||[]),Ye=He.messageList.map(function(Lt){return Lt.sequence});return K.l("".concat(I," ret.nextReqMessageID:").concat(He.nextReqMessageID," ret.isCompleted:").concat(He.isCompleted," sequenceList:"),Ye),wt(Xe)&&Xe.length!==0?a.updateRevokerInfo(Xe).then(function(Lt){return Lt.forEach(function(yt){var rn=yt.revokerInfo;He.messageList=He.messageList.map(function(on){return on.ID===yt.ID&&rn&&(on.revokeReason=rn.reason||"",on.revokerInfo={userID:rn.revoker||on.revoker,nick:rn.nick,avatar:rn.avatar}),on})}),Kt(He)}):Kt(He)}):(this.modifyMessageList(s),T=this._getMsgListFromMem({conversationID:s,nextReqMessageID:h,count:m}),ln(T))}},{key:"_isEverCleared",value:function(n){return this._everClearedMap.has(n)}},{key:"_getMsgListFromMem",value:function($){var a=$.conversationID,s=$.nextReqMessageID,$=$.count,h="".concat(this._n,"._getMsgListFromMem"),m=this._msgListHandler.getLocalMsgList(a),I=m.length,T=Gr(a),D=0,V={isCompleted:!1,nextReqMessageID:"",messageList:[]},$=(s?(D=T?m.findIndex(function(q){return q.ID===s}):m.findIndex(function(q){return q.sequence+""===s}))>$?(V.messageList=m.slice(D-$,D),V.nextReqMessageID=T?m[D-$].ID:m[D-$].sequence+""):(V.messageList=m.slice(0,D),V.isCompleted=!0):$<I?(V.messageList=m.slice(D=I-$,I),V.nextReqMessageID=T?m[D].ID:m[D].sequence+""):(V.messageList=m.slice(0,I),V.isCompleted=!0),V.messageList.map(function(q){return q.sequence}));return K.l("".concat(h," convID:").concat(a)+" ret.nextReqMessageID:".concat(V.nextReqMessageID," ret.isCompleted:").concat(V.isCompleted," sequenceList:").concat($)),V}},{key:"getMessageListHopping",value:function(D){var a,s,h=D.conversationID,m=D.sequence,I=D.time,T=D.count,D=D.direction,D=D===void 0?0:D;return(et(T)||15<T)&&(T=15),h.startsWith(O.CONV_C2C)?(a=this.get(6),s=h.replace(O.CONV_C2C,""),a.getRoamingMessagesHopping({peerAccount:s,time:I,count:T,direction:D})):h.startsWith(O.CONV_GROUP)?(a=this.get(7),s=h.replace(O.CONV_GROUP,""),a.getRoamingMessagesHopping({groupID:s,sequence:m,count:T,direction:D})):void 0}},{key:"_computeRemainingCount",value:function(m){var a,s=m.conversationID,h=m.nextReqMessageID,m=this._msgListHandler.getLocalMsgList(s),I=m.length;return K.l("".concat(this._n,"._computeRemainingCount convID:").concat(s," nextReqMessageID:").concat(h," length:").concat(I)),h?(a=0,Gr(s)?a=m.findIndex(function(T){return T.ID===h}):Br(s)&&(a=h.indexOf("-")!==-1?m.findIndex(function(T){return T.ID===h}):m.findIndex(function(T){return T.sequence+""===h})),a===-1?0:a):I}},{key:"_needGetHistory",value:function(h){var a=h.conversationID,s=h.remainingCount,h=h.count,m=this.getLocalConversation(a),I="";return m&&m.groupProfile&&(I=m.groupProfile.type),!(dh(a)||jr(I)||!this._isEverCleared(a)&&(m=s<=h&&!this._completedMap.has(a),K.l("".concat(this._n,"._needGetHistory convID:").concat(a," ret:").concat(m)),!m))}},{key:"_isTopicConv",value:function(n){return n=n.replace(O.CONV_GROUP,""),vr(n)}},{key:"getHistoryMessages",value:function($){var a,s,h,m,I,T,D=$.conversationID,V=$.count,$=$.nextReqMessageID;return D===O.CONV_SYSTEM?ln():(V=20<V?20:15,a=null,Gr(D)?(T=0,s="",h=!1,I=this._roamingMsgKeyAndTimeMap.has(D),$&&(h=!0,I?(T=this._roamingMsgKeyAndTimeMap.get(D).lastMessageTime,s=this._roamingMsgKeyAndTimeMap.get(D).messageKey):(m=this._msgListHandler.findMessage($))&&(T=m.time,K.l("".concat(this._n,".getHistoryMessages convID:").concat(D," isRelayInfoExisted:").concat(I," lastMessageTime:").concat(T)))),(a=this.get(6)).getRoamingMessage({conversationID:D,peerAccount:D.replace(O.CONV_C2C,""),count:V,lastMessageTime:h?T:0,messageKey:h?s:""})):Br(D)?(a=this.get(7))?(m=D.replace(O.CONV_GROUP,""),I=null,this._convMap.has(D)&&!vr(m)&&(I=this._convMap.get(D).lastMessage),T=0,$?T=Number($):I&&(T=I.lastSequence),a.getRoamingMessage({conversationID:D,groupID:m,count:V,sequence:T})):De({code:Je.NO_MODULE}):ln())}},{key:"patchConvLastMessage",value:function(n){var a,s,h=1<arguments.length&&arguments[1]!==void 0&&arguments[1],m=this.getLocalConversation(n);m&&(a=(s=m.lastMessage).messageForShow,s=s.payload,Tt(a)||Tt(s)||h)&&(a=this._msgListHandler.getLocalMsgList(n)).length!==0&&(s=a[a.length-1],K.l("".concat(this._n,".patchConvLastMessage bForceUpdate:").concat(h," convID:").concat(n," payload:"),s.payload),m.updateLastMessage(s))}},{key:"onRoamingMessage",value:function(){for(var n,a,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],V=1<arguments.length?arguments[1]:void 0,h=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2],m=3<arguments.length?arguments[3]:void 0,I=V.startsWith(O.CONV_C2C)?O.CONV_C2C:O.CONV_GROUP,T=null,D=[],V=[],Ye=0,Lt=s.length,$=I===O.CONV_GROUP,q=this.getFileDownloadProxy(),se=this.getDownloadFileAuthKey(),me=wt(m),fe=this.get(17).getFileDNList(),He=function(){$?--Ye:++Ye},Xe=function(){return $?Lt<=Ye:Ye<Lt},Ye=$?s.length-1:0,Lt=$?0:s.length;Xe();He())s[Ye].isPlaceMessage!==1&&((T=new _r(s[Ye])).to=s[Ye].to,I!==O.CONV_GROUP||et(s[Ye].topicID)||(T.to=s[Ye].topicID),T.isSystemMessage=!!s[Ye].isSystemMessage,T.conversationType=I,n=s[Ye].event===4?{type:O.MSG_GRP_TIP,content:E(E({},s[Ye].elements),{},{groupProfile:s[Ye].groupProfile})}:s[Ye].elements,$||T.setNickAndAvatar({nick:s[Ye].nick,avatar:s[Ye].avatar}),Tt(n)?((a=new ct("emptyMessageBody")).setMessage("from:".concat(T.from," to:").concat(T.to," sequence:").concat(T.sequence," event:").concat(s[Ye].event)),a.setLevel("warning").end()):(T.setElement(n,q,se,fe),T.reInitialize(this.getMyUserID()),D.push(T),me&&m.push(T)));return He=Xe=null,h?(this._msgListHandler.unshift(D,V),D=null,V):D}},{key:"findMessage",value:function(n){return this._msgListHandler.findMessage(n)}},{key:"_isMeInCommunity",value:function(n){var a=!0;return this._isTopicConv(n)&&(n=pr(n.replace(O.CONV_GROUP,"")),this.get(7).hasLocalGroup(n)||(a=!1,K.l("".concat(this._n,"._isMeInCommunity groupID:").concat(n," ret:").concat(a)))),a}},{key:"deleteTopicRoamingInfo",value:function(n){var a=this;Yr({groupID:n})&&this._msgListHandler.getTopicConvIDList(n).forEach(function(s){a.clearMemMsg(s)})}},{key:"deleteGroupRoamingInfo",value:function(n){n="".concat(O.CONV_GROUP).concat(n),0<this._msgListHandler.getLocalMsgList(n).length&&this.clearMemMsg(n)}},{key:"setMessageRead",value:function(h){var a=h.conversationID,s=this.getLocalConversation(a),h="".concat(this._n,".setMessageRead");if(K.l("".concat(h," convID:").concat(a," unreadCount:").concat(s?s.unreadCount:0)),!s||(s.type!==O.CONV_GROUP&&s.type!==O.CONV_TOPIC||Tt(s.groupAtInfoList)||this.deleteGroupAtTips(a),s.unreadCount===0))return ln();var m=this._msgListHandler.getLocalLastMsg(a),I=s.lastMessage.lastTime,T=this._msgListHandler.getLocalMaxTime(a),T=(I<T&&(K.l("".concat(h," update lastMessageTime from ").concat(I," to ").concat(T)),I=T),this._msgListHandler.getLocalMaxSeq(a)),D=s.lastMessage.lastSequence,V=(D<T&&(K.l("".concat(h," update lastMessageSeq from ").concat(D," to ").concat(T)),D=T),s.type===O.CONV_TOPIC&&et(m)&&(h=this.get(10),m=pr(T=a.replace(O.CONV_GROUP,"")),h=h.getLocalTopic(m,T))&&(D=h.nextMessageSeq-1),null);switch(s.type){case O.CONV_C2C:return(V=this.get(6))?V.setMessageRead({conversationID:a,lastMessageTime:I}):De({code:Je.NO_MODULE});case O.CONV_GROUP:case O.CONV_TOPIC:return(V=this.get(7))?V.setMessageRead({conversationID:a,lastMessageSeq:D}):De({code:Je.NO_MODULE});case O.CONV_SYSTEM:return s.unreadCount=0,this.emitConvUpdate(!0,!1),ln();default:return ln()}}},{key:"setAllMessageRead",value:function(){var n,a=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},h="setAllMessageRead",m="".concat(this._n,".").concat(h),I=(s.scope||(s.scope=O.READ_ALL_MSG),K.l("".concat(m," options:"),s),this._createSetAllMessageReadPack(s));return I.readAllC2CMessage===0&&I.groupMessageReadInfoList.length===0?ln():(n=new ct(h),this.req({P:de.SET_ALL_MSG_READ,data:I}).then(function(T){return T=T.data,T=a._handleAllMsgRead(T),n.setMessage("scope:".concat(s.scope," failureGroups:").concat(JSON.stringify(T))).end(),ln()}).catch(function(T){return n.setError(T).end(),K.w("".concat(m," failed. error:"),T),De({code:T&&T.code?T.code:Je.MSG_UNREAD_ALL_FAIL,message:T&&T.message?T.message:void 0})}))}},{key:"setConvCustomData",value:function(n){return this._convGroupHandler.setConvCustomData(n)}},{key:"markConv",value:function(n){return this._convGroupHandler.markConv(n)}},{key:"getConvGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConvGroup",value:function(n){return this._convGroupHandler.createConvGroup(n)}},{key:"deleteConvGroup",value:function(n){return this._convGroupHandler.deleteConvGroup(n)}},{key:"renameConvGroup",value:function(n){return this._convGroupHandler.renameConvGroup(n)}},{key:"addConvsToGroup",value:function(n){return this._convGroupHandler.addConvsToGroup(n)}},{key:"deleteConvsFromGroup",value:function(n){return this._convGroupHandler.deleteConvsFromGroup(n)}},{key:"onConvMarkUpdated",value:function(n){this._convGroupHandler.onConvMarkUpdated(n)}},{key:"onConvGroupCreated",value:function(n){this._convGroupHandler.onConvGroupCreated(n)}},{key:"onConvGroupDeleted",value:function(n){this._convGroupHandler.onConvGroupDeleted(n)}},{key:"onConvGroupNameUpdated",value:function(n){this._convGroupHandler.onConvGroupNameUpdated(n)}},{key:"onConvInGroupUpdated",value:function(n){this._convGroupHandler.onConvInGroupUpdated(n)}},{key:"onConvAddedToOrDeletedFromGroup",value:function(n){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(n)}},{key:"_getConvLastMessageSeq",value:function(s){var a=this._msgListHandler.getLocalLastMsg(s.conversationID),s=s.lastMessage.lastSequence;return s=a&&s<a.sequence?a.sequence:s}},{key:"_getConvLastMessageTime",value:function(s){var a=this._msgListHandler.getLocalLastMsg(s.conversationID),s=s.lastMessage.lastTime;return s=a&&s<a.time?a.time:s}},{key:"_createSetAllMessageReadPack",value:function(n){var a,s={readAllC2CMessage:0,groupMessageReadInfoList:[]},h=n.scope,m=v(this._convMap);try{for(m.s();!(a=m.n()).done;){var I,T=x(a.value,2)[1];if(0<T.unreadCount)if(T.type===O.CONV_C2C&&s.readAllC2CMessage===0){if(h===O.READ_ALL_MSG)s.readAllC2CMessage=1;else if(h===O.READ_ALL_C2C_MSG){s.readAllC2CMessage=1;break}}else T.type!==O.CONV_GROUP||h!==O.READ_ALL_GROUP_MSG&&h!==O.READ_ALL_MSG||(I=this._getConvLastMessageSeq(T),s.groupMessageReadInfoList.push({groupID:T.groupProfile.groupID,messageSequence:I}))}}catch(D){m.e(D)}finally{m.f()}return s}},{key:"onPushedAllMessageRead",value:function(n){this._handleAllMsgRead(n)}},{key:"_handleAllMsgRead",value:function(a){var s=a.groupMessageReadInfoList,a=a.readAllC2CMessage,s=this._parseGroupReadInfo(s);return 1<=this._updateAllConvUnreadCount({readAllC2CMessage:a})&&this.emitConvUpdate(!0,!1),s}},{key:"_parseGroupReadInfo",value:function(n){var a=[];if(n&&n.length)for(var s=0,h=n.length;s<h;s++){var D=n[s],m=D.groupID,I=D.sequence,T=D.retCode,D=D.lastMessageSeq;et(T)?this._remoteGroupReadSeqMap.set(m,D):(this._remoteGroupReadSeqMap.set(m,I),T!==0&&a.push("".concat(m,"-").concat(I,"-").concat(T)))}return a}},{key:"_updateAllConvUnreadCount",value:function(n){var a,s=n.readAllC2CMessage,h=0,m=v(this._convMap);try{for(m.s();!(a=m.n()).done;){var I,T,D,V,$=x(a.value,2),q=$[0],se=$[1];1<=se.unreadCount&&(s===1&&se.type===O.CONV_C2C?(I=this._getConvLastMessageTime(se),this.updateIsReadAfterReadReport({conversationID:q,lastMessageTime:I})):se.type===O.CONV_GROUP&&(T=q.replace(O.CONV_GROUP,""),this._remoteGroupReadSeqMap.has(T))&&(D=this._remoteGroupReadSeqMap.get(T),V=this._getConvLastMessageSeq(se),this.updateIsReadAfterReadReport({conversationID:q,remoteReadSequence:D}),D<=V)&&this._remoteGroupReadSeqMap.delete(T),this.updateUnreadCount(q,!1))&&(h+=1)}}catch(me){m.e(me)}finally{m.f()}return h}},{key:"isRemoteRead",value:function(h){var a,s=h.conversationID,h=h.sequence,m=s.replace(O.CONV_GROUP,""),I=!1;return this._remoteGroupReadSeqMap.has(m)&&(h<=(a=this._remoteGroupReadSeqMap.get(m))&&(I=!0,K.l("".concat(this._n,".isRemoteRead convID:").concat(s," msgSeq:").concat(h," remoteReadSeq:").concat(a))),a+10<=h)&&this._remoteGroupReadSeqMap.delete(m),I}},{key:"updateIsReadAfterReadReport",value:function(n){var a=n.conversationID,s=n.lastMessageSeq,h=n.lastMessageTime,m=this._msgListHandler.getLocalMsgList(a);if(m.length!==0){for(var I,T=m.length-1;0<=T;T--)if(I=m[T],!(h&&I.time>h||s&&I.sequence>s)){if(I.flow==="in"&&I.isRead)break;I.setIsRead(!0)}}}},{key:"updateUnreadCount",value:function(n){var a,s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],h=!1,m=this.getLocalConversation(n),I=this._msgListHandler.getLocalMsgList(n);if(m)return(a=m.unreadCount)!==(I=I.filter(function(T){return!T.isRead&&!T._onlineOnlyFlag&&!T.isDeleted}).length)&&(m.unreadCount=I,h=!0,K.l("".concat(this._n,".updateUnreadCount from ").concat(a," to ").concat(I,", convID:").concat(n)),s===!0)&&this.emitConvUpdate(!0,!1),h&&m.type===O.CONV_TOPIC&&(a=m.unreadCount,I=this.get(10),s=n.replace(O.CONV_GROUP,""),I.onUnreadCountUpdatedFromConv(s,a)),h}},{key:"clearGroupAtInfoList",value:function(n){var a,s=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],h=this.getLocalConversation(n);h&&0<h.groupAtInfoList.length&&(h.clearGroupAtInfoList(),K.l("".concat(this._n,".clearGroupAtInfoList convID:").concat(n)),h.type===O.CONV_TOPIC&&(h=h.groupAtInfoList,a=this.get(10),n=n.replace(O.CONV_GROUP,""),a.onAtInfoUpdated({topicID:n,groupAtInfoList:h})),s===!0)&&this.emitConvUpdate(!0,!1)}},{key:"updateReadReceiptInfo",value:function(V){var a,s,h,m=this,D=V.userID,I=D===void 0?void 0:D,D=V.groupID,T=D===void 0?void 0:D,D=V.readReceiptList,V=V.timestamp,$=V===void 0?0:V;Tt(D)||(a=[],et(I)?et(T)||(s="".concat(O.CONV_GROUP).concat(T),D.forEach(function(me){var fe=me.tinyID,He=me.clientTime,Xe=me.random,se=me.readCount,me=me.unreadCount,fe="".concat(fe,"-").concat(He,"-").concat(Xe),He=m._msgListHandler.getLocalMsg(s,fe)||m._msgListHandler.getHoppingMsg(s,fe),Xe={groupID:T,messageID:fe,readCount:0,unreadCount:0};He&&(It(se)&&(He.readReceiptInfo.readCount=se,Xe.readCount=se),It(me)&&(He.readReceiptInfo.unreadCount=me,Xe.unreadCount=me),a.push(Xe))})):(h="".concat(O.CONV_C2C).concat(I),D.forEach(function(se){var me=se.tinyID,fe=se.clientTime,se=se.random,me="".concat(me,"-").concat(fe,"-").concat(se),fe=m._msgListHandler.getLocalMsg(h,me)||m._msgListHandler.getHoppingMsg(h,me);fe&&!fe.readReceiptInfo.isPeerRead&&(fe.readReceiptInfo.isPeerRead=!0,fe.readReceiptInfo.timestamp=$,a.push({userID:I,messageID:me,isPeerRead:!0,timestamp:$}))})),0<a.length&&this.emitOEvt(W.MESSAGE_READ_RECEIPT_RECEIVED,a))}},{key:"updateIsRead",value:function(n){var a=this.getLocalConversation(n),s=this.getLocalMessageList(n);if(a&&s.length!==0&&!dh(a.type)){for(var h=[],m=0,I=s.length;m<I;m++)s[m].flow!=="in"?s[m].flow!=="out"||s[m].isRead||s[m].setIsRead(!0):h.push(s[m]);var T=0;T=a.type===O.CONV_C2C?(n=h.slice(-a.unreadCount).filter(function(V){return V.isRevoked}).length,h.length-a.unreadCount-n):h.length-a.unreadCount;for(var D=0;D<T&&!h[D].isRead;D++)h[D].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(n){var a,s,h,m=this,I="".concat(this._n,".deleteGroupAtTips"),T=(K.l("".concat(I)),this._convMap.get(n));return!T||(a=T.groupAtInfoList).length===0?Promise.resolve():(T=void 0,n.startsWith(O.CONV_GROUP)&&(T=n.replace(O.CONV_GROUP,"")),s=P(a),(Yr({groupID:T})||vr(T))&&(s=a.filter(function(D){return!D.atTypeArray.includes(O.CONV_AT_ALL)})).length===0?(this.clearGroupAtInfoList(n,!1),Promise.resolve()):(h=this.getMyUserID(),this.req({P:de.DEL_GROUP_AT_TIPS,data:{messageListToDelete:s.map(function(D){return{from:D.from,to:h,messageSeq:D.__sequence,messageRandom:D.__random,groupID:et(D.topicID)?D.groupID:D.topicID}})}}).then(function(){return K.l("".concat(I," ok. count:").concat(a.length)),m.clearGroupAtInfoList(n,!1),Promise.resolve()}).catch(function(D){return K.e("".concat(I," failed. error:"),D),De(D)})))}},{key:"appendToMessageList",value:function(n){return this._msgListHandler.pushIn(n)}},{key:"setMessageRandom",value:function(n){this._sll.set(n.random)}},{key:"deleteMessageRandom",value:function(n){this._sll.delete(n.random)}},{key:"pushIntoMessageList",value:function(n,a,s){return!(!this._msgListHandler.pushIn(a,s)||this._sll.has(a.random)&&!s||(n.push(a),0))}},{key:"revoke",value:function(n,a,s){return this._msgListHandler.revoke(n,a,s)}},{key:"getPeerReadTime",value:function(n){return this._peerReadTimeMap.get(n)}},{key:"recordPeerReadTime",value:function(n,a){(!this._peerReadTimeMap.has(n)||this._peerReadTimeMap.get(n)<a)&&this._peerReadTimeMap.set(n,a)}},{key:"updateMsgIsPeerReadProp",value:function(n,a){var s;n.startsWith(O.CONV_C2C)&&0<a&&(0<(s=this._msgListHandler.updateMsgIsPeerReadProp(n,a)).length&&this.emitOEvt(W.MESSAGE_READ_BY_PEER,s),this._convMap.has(n))&&!Tt(s=this._convMap.get(n).lastMessage)&&s.fromAccount===this.getMyUserID()&&s.lastTime<=a&&!s.isPeerRead&&(s.isPeerRead=!0,this.emitConvUpdate(!0,!1))}},{key:"updateMsgIsModifiedProp",value:function(n){this._msgListHandler.updateMsgIsModifiedProp(n)}},{key:"setCompleted",value:function(n){K.l("".concat(this._n,".setCompleted convID:").concat(n)),this._completedMap.set(n,!0)}},{key:"updateRoamingMsgKeyAndTime",value:function(n,a,s){this._roamingMsgKeyAndTimeMap.set(n,{messageKey:a,lastMessageTime:s})}},{key:"getConvList",value:function(n){var a,s=this,h="".concat(this._n,".").concat("getConvList"),m="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._convMap.size,", options:").concat(JSON.stringify(n));return K.l("".concat(h,". ").concat(m)),this._pagingStatus===bl?((a=new ct("getConvList")).setMessage(m),this.syncConvList().then(function(){a.end();var I=s._getConvList(n);return Kt({conversationList:I,isSyncCompleted:s._isSyncCompleted()})}).catch(function(I){return a.setError(I).end(),K.e("".concat(h," failed. error:"),I),De(I)})):(m=this._getConvList(n),K.l("".concat(h,". returned conversation count:").concat(m.length)),ln({conversationList:m,isSyncCompleted:this._isSyncCompleted()}))}},{key:"_getConvList",value:function(n){var a,s,h,m,I,T=this;return et(n)?this.getLocalConvList():wt(n)?n.length===0?[]:this.getLocalConvList().filter(function(D){return n.includes(D.conversationID)}):On(n)?(a=n.type,s=n.markType,h=n.groupName,m=n.hasUnreadCount,I=n.hasGroupAtInfo,this.getLocalConvList().filter(function(D){return T._filterType(D,a)&&T._filterMarkType(D,s)&&T._filterGroupName(D,h)&&T._filterUnreadCount(D,m)&&T._filterGroupAtInfo(D,I)})):[]}},{key:"_filterType",value:function(n,a){return a!==O.CONV_C2C&&a!==O.CONV_GROUP||n.type===a}},{key:"_filterGroupName",value:function(n,a){return!_n(a)||(a===""?n.conversationGroupList.length===0:n.conversationGroupList.includes(a))}},{key:"_filterMarkType",value:function(n,a){return!It(a)||(a===0?n.markList.length===0:n.markList.includes(a))}},{key:"_filterUnreadCount",value:function(n,a){var s=!0;return a===!0?s=1<=n.unreadCount:a===!1&&(s=n.unreadCount===0),s}},{key:"_filterGroupAtInfo",value:function(n,a){var s=!0;return a===!0?s=1<=n.groupAtInfoList.length:a===!1&&(s=n.groupAtInfoList.length===0),s}},{key:"_handleC2CPeerReadTime",value:function(){var n,a=v(this._convMap);try{for(a.s();!(n=a.n()).done;){var s=x(n.value,2),h=s[0],m=s[1];m.type===O.CONV_C2C&&this.recordPeerReadTime(h,m.peerReadTime)}}catch(I){a.e(I)}finally{a.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var n=this.get(7);return!n||n.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var n=this.get(7);return n?n.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(n){var a=this.get(7);return!!a&&a.hasLocalGroup(n.replace(O.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(n){var a,s=this,h=!1;if(this._convMap.has(n)?a=this._convMap.get(n):(a=new fc({conversationID:n,type:Gr(n)?O.CONV_C2C:O.CONV_GROUP},this.isIntl(),this.isUsingChatCore()),h=!0),a._isInfoCompleted||a.type===O.CONV_SYSTEM)return ln({conversation:a});if(Br(n)){if(!this.get(7))return De({code:Je.NO_MODULE});if(!this._hasLocalGroup(n))return ln({conversation:a})}var m="".concat(this._n,".").concat("getConversationProfile"),I=new ct("getConversationProfile");return K.l("".concat(m,". convID:").concat(n," remark:").concat(a.remark," lastMessage:"),a.lastMessage),this._getUserOrGroupProfile(a).then(function(T){I.setMessage("convID:".concat(n," unreadCount:").concat(T.data.conversation.unreadCount)).end();var D,V=s.get(8);if(V&&a.type===O.CONV_C2C&&(D=n.replace(O.CONV_C2C,""),V.isMyFriend(D))&&(V=V.getFriendRemark(D),a.remark!==V)&&(a.remark=V,K.l("".concat(m,". convID:").concat(n," patch remark:").concat(a.remark))),K.l("".concat(m," ok. isNewConv:").concat(h," convID:").concat(n)),h){if(a.type===O.CONV_C2C)return s._onNewC2CConv([n.replace(O.CONV_C2C,"")]).then(function(){return ln({conversation:a})});if(a.type===O.CONV_GROUP)return s._onNewGroupConv([n.replace(O.CONV_GROUP,"")]).then(function(){return ln({conversation:a})})}return T}).catch(function(T){return I.setError(T).setMessage("convID:".concat(n)).end(),K.e("".concat(m," failed. error:"),T),De(T)})}},{key:"_getUserOrGroupProfile",value:function(n){var a=this;return n.type===O.CONV_C2C?this.get(4).getUserProfile({userIDList:[n.toAccount]}).then(function(s){return s=s.data,s.length===0?De({code:Je.USER_OR_GRP_NOT_FOUND}):(n.userProfile=s[0],n._isInfoCompleted=!0,a._insertConvAfterTopmost(n),ln({conversation:n}))}):this.get(7).getGroupProfile({groupID:n.toAccount}).then(function(s){return n.groupProfile=s.data.group,n._isInfoCompleted=!0,a._insertConvAfterTopmost(n),ln({conversation:n})})}},{key:"_insertConvAfterTopmost",value:function(n){var a,s;n instanceof fc&&!this._convMap.has(n.conversationID)&&(s=(a=P(this._convMap)).findIndex(function(h){return h[1].isPinned===!1}),a.splice(s,0,[n.conversationID,n]),this._convMap=new Map(a),this._setStorageConvList(),this.emitConvUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(n){var a=this;n.data.forEach(function(s){var h=s.userID;h===a.getMyUserID()?a._onMyProfileModified({latestNick:s.nick,latestAvatar:s.avatar}):(h=a._convMap.get("".concat(O.CONV_C2C).concat(h)))&&(h.userProfile=s)})}},{key:"_onCloudConfig",value:function(n){this.getCloudConfig("pull_on_invite")==="0"&&(this._bPullOnInvite=!1),K.l("".concat(this._n,"._onCloudConfig bPullOnInvite:").concat(this._bPullOnInvite))}},{key:"disableMsgPullOnInvite",value:function(){this._bPullOnInvite=!1}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===_h}},{key:"_errorLog",value:function(n,a,s,h){var m=new Error("Params validate failed."),I="".concat(this.getErrMsg("API_REFER")).concat(n);throw K.w("[".concat(n,"] | ").concat(a," | ").concat(this.getErrMsg(s,h),", ").concat(I)),K.e("[".concat(n,"] Invalid ").concat(a,": type check failed for ").concat(a,".")),m}},{key:"_isValidConvID",value:function(n){return Gr(n)||Br(n)||dh(n)}},{key:"deleteConversation",value:function(n){var a=this,s="deleteConversation";return _n(n)||Vn(n)||this._errorLog(s,"options","StringOrObjectRequiredLog"),_n(n)?(this._isValidConvID(n)||this._errorLog(s,"options","InvalidConversationID",n),K.l("".concat(this._n,".").concat(s," convID:").concat(n)),this.deleteConvList({conversationIDList:[n],flag:1})):(wt(n.conversationIDList)||this._errorLog(s,"conversationIDList","ArrayRequiredLog"),n.conversationIDList.length===0&&this._errorLog(s,"conversationIDList","NonEmptyArrayLog"),n.conversationIDList.forEach(function(h){a._isValidConvID(h)||a._errorLog(s,"conversationIDList","InvalidConversationID",h)}),"clearHistoryMessage"in n&&typeof n.clearHistoryMessage!="boolean"&&this._errorLog(s,"clearHistoryMessage","BooleanRequiredLog"),100<n.conversationIDList.length&&(n.conversationIDList=n.conversationIDList.slice(0,100)),this.deleteConvList(n))}},{key:"deleteConvList",value:function(I){var a=I.conversationIDList,a=a===void 0?[]:a,s=I.clearHistoryMessage,s=s===void 0||s,I=I.flag,h=I===void 0?0:I,m="".concat(this._n,".").concat("deleteConvList"),I="convIDList:".concat(a," clearHistoryMessage:").concat(s),T=(K.l("".concat(m," ").concat(I)),new ct("deleteConvList"));return T.setMessage(I),Promise.all([this.rmLocalOnlyConvList(a),this.rmLocalAndRemoteConvList(a,s)]).then(function(D){return T.end(),D=[].concat(P(D[0]),P(D[1])),D.length===0?De(new po({code:Je.CONV_NOT_FOUND})):(K.l("".concat(m," ok")),ln(h===1?{conversationID:D[0]}:{conversationIDList:D}))}).catch(function(D){return T.setError(D).end(),K.e("".concat(m," failed. error:"),D),De(D)})}},{key:"rmLocalOnlyConvList",value:function(n){var a=this;return n.filter(function(s){var h;return!!a._convMap.has(s)&&((h=a.getLocalConversation(s).type)!==O.CONV_GROUP||a._hasLocalGroup(s)?h===O.CONV_SYSTEM&&(a.get(7).deleteGroupSystemNotice({messageList:a._msgListHandler.getLocalMsgList(s)}),a.deleteLocalConv(s),!0):(a.deleteLocalConv(s),!0))})}},{key:"rmLocalAndRemoteConvList",value:function(n,a){var s=this,h={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:a?1:0};return n.forEach(function(m){var I;s._convMap.has(m)&&((I=s.getLocalConversation(m).type)===O.CONV_C2C?h.conversationList.push({toAccount:m.replace(I,""),type:1}):I===O.CONV_GROUP&&s._hasLocalGroup(m)&&h.conversationList.push({toGroupID:m.replace(I,""),type:2}))}),h.conversationList.length===0?[]:this.req({P:de.DEL_CONV,data:h}).then(function(m){var I=[];return 0<m.data.resultList.length&&m.data.resultList.map(function(T){T.code===0&&(T=T.type===1?"".concat(O.CONV_C2C).concat(T.to):"".concat(O.CONV_GROUP).concat(T.groupID),I.push(T))}),s.deleteLocalConvList(I),I})}},{key:"setConvDraft",value:function(s){var a=s.conversationID,s=s.draftText,h="".concat(this._n,".").concat("setConvDraft");return K.l("".concat(h," convID:").concat(a," draftText:").concat(s)),this._convMap.has(a)?((h=this._convMap.get(a)).setDraftText(s),this.emitConvUpdate(),ln({code:0,conversation:h})):De({code:Je.CONV_NOT_FOUND})}},{key:"clearHistoryMessage",value:function(n){var a=this,s={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._convMap.has(n))return De({code:Je.CONV_NOT_FOUND});var h=this._convMap.get(n).type;if(h===O.CONV_C2C)s.type=1,s.toAccount=n.replace(O.CONV_C2C,"");else{if(h!==O.CONV_GROUP)return h===O.CONV_SYSTEM?(this.get(7).deleteGroupSystemNotice({messageList:this._msgListHandler.getLocalMsgList(n)}),ln({conversationID:n})):De({code:Je.CONV_UN_RECORDED_TYPE});s.type=2,s.toGroupID=n.replace(O.CONV_GROUP,"")}var m="".concat(this._n,".").concat("clearHistoryMessage"),I=new ct("clearHistoryMessage");return I.setMessage("convID:".concat(n)),K.l("".concat(m,". convID:").concat(n)),this.setMessageRead({conversationID:n}).then(function(){return a.req({P:de.CLEAR_HISTORY_MSG,data:s})}).then(function(){I.end(),K.l("".concat(m," ok")),a.clearMemMsg(n);var T=a.getLocalConversation(n);return T&&(T.updateLastMessage(),a._sortConvListAndEmitEvent()),ln({conversationID:n})}).catch(function(T){return I.setError(T).end(),K.e("".concat(m," failed. error:"),T),De(T)})}},{key:"pinConversation",value:function(n){var a,s,h,m=this,I=n.conversationID,T=n.isPinned,D=this.getLocalConversation(I);return D&&D.isPinned===T?ln({conversationID:I}):dh(I)?(D&&(D.isPinned=T),this._sortConvListAndEmitEvent(),ln({conversationID:I})):(n=null,Gr(I)?n={type:1,toAccount:I.replace(O.CONV_C2C,"")}:Br(I)&&(n={type:2,groupID:I.replace(O.CONV_GROUP,"")}),n===null?De({code:Je.INVALID_CONV_ID}):(a="".concat(this._n,".").concat("pinConversation"),s="convID:".concat(I," isPinned:").concat(T),(h=new ct("pinConversation")).setMessage(s),K.l("".concat(a,". ").concat(s)),this.req({P:de.PIN_CONV,data:{fromAccount:this.getMyUserID(),operationType:T===!0?1:2,itemList:[n]}}).then(function(){return h.end(),K.l("".concat(a," ok")),D?D.isPinned!==T&&(D.isPinned=T):m._convMap.set(I,new fc({conversationID:I,type:Gr(I)?O.CONV_C2C:O.CONV_GROUP,isPinned:T},m.isIntl(),m.isUsingChatCore())),m._sortConvListAndEmitEvent(),Kt({conversationID:I})}).catch(function(V){return h.setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})))}},{key:"setMessageRemindType",value:function(n){return this._msgRemindHandler.set(n)}},{key:"patchMsgRemindType",value:function(n){var a=n.ID,m=n.isC2CConversation,s=n.messageRemindType,h=!1,m=this.getLocalConversation("".concat(m?O.CONV_C2C:O.CONV_GROUP).concat(a));return m&&m.messageRemindType!==s&&(m.messageRemindType=s,h=!0),K.l("".concat(this._n,".patchMsgRemindType options:"),n,"ret:".concat(h)),h}},{key:"onC2CMsgRemindTypeFetched",value:function(n){var a,s=this;wt(n)&&0<n.length&&(a=0,n.forEach(function(I){var m=I.userID,I=I.muteFlag,I=s._transMsgRemindType(I);s.patchMsgRemindType({ID:m,isC2CConversation:!0,messageRemindType:I})===!0&&(a+=1)}),K.l("".concat(this._n,".onC2CMsgRemindTypeFetched updateCount:").concat(a)),1<=a)&&this.emitConvUpdate(!0,!1)}},{key:"onC2CMsgRemindTypeSynced",value:function(n){var a=this,s="".concat(this._n,".onC2CMsgRemindTypeSynced");n.dataList.forEach(function(h){var m;Tt(h.muteNotificationsSync)||(m=(h=h.muteNotificationsSync).to,h=h.muteFlag,h=a._transMsgRemindType(h),a.patchMsgRemindType({ID:m,isC2CConversation:!(m=0),messageRemindType:h})&&(m+=1),K.l("".concat(s," updateCount:").concat(m)),1<=m&&a.emitConvUpdate(!0,!1))})}},{key:"onGroupMsgRemindTypeUpdated",value:function(n){this._msgRemindHandler.onGroupMsgRemindTypeUpdated(n)}},{key:"deleteLocalConv",value:function(n){var a=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=this._convMap.has(n);K.l("".concat(this._n,".deleteLocalConv convID:").concat(n," has:").concat(s)),s&&(this._convMap.delete(n),this._convMapForDiff.delete(n),this.clearMemMsg(n),this._setStorageConvList(!0),a)&&(s=!this._isTopicConv(n),this.emitConvUpdate(s,!1))}},{key:"pullMsgOnInvite",value:function(n){var a,s,h,m,I,T=this.get(7);T&&(a="".concat(this._n,".pullMsgOnInvite"),K.l("".concat(a," flag:").concat(this._bPullOnInvite)),this._bPullOnInvite)&&(I=this.getLocalLastMessage(n),s=this.getLocalSecondLastMessage(n),m=h=1,I&&(h=I.sequence),s&&(m=s.sequence),I=T.getGroupRemoteLastSeq(n.replace(O.CONV_GROUP,"")),K.l("".concat(a," convID:").concat(n," localLastSeq:").concat(h," localSecondLastSeq:").concat(m," remoteLastSeq:").concat(I)),this.clearMemMsg(n),1<h-m?this._recursiveGetMsgList([],n,!1,h,m):1<I-h&&this._recursiveGetMsgList([],n,!0,I,h))}},{key:"_recursiveGetMsgList",value:function(n,a,s,h,m,I){var T=this;this.getMessageList({conversationID:a,nextReqMessageID:I}).then(function(q){var q=q.data,V=q.messageList,$=q.isCompleted,q=q.nextReqMessageID,se=V.filter(function(me){return s?me.sequence>m&&me.sequence<=h:me.sequence>m&&me.sequence<h});n.unshift.apply(n,P(se)),!$&&0<V.length&&V[0].sequence>m&&n.length<60?T._recursiveGetMsgList(n,a,s,h,m,q):T._emitMsgReceived(a,n)})}},{key:"_emitMsgReceived",value:function(n,a){var s,h,m=this;0<a.length&&(a=a.filter(function(I,T,D){return T===D.findIndex(function(V){return V.sequence===I.sequence})}),s=this.hasLocalConversation(n),h=a.map(function(I){return I.sequence}),K.l("".concat(this._n,"._emitMsgReceived convID:").concat(n," has:").concat(s," count:").concat(h.length," sequenceList:"),h),this.emitOEvt(W.MESSAGE_RECEIVED,a),s?this.patchConvLastMessage(n,!0):this.getConversationProfile(n).then(function(){m.patchConvLastMessage(n,!0)}))}},{key:"deleteLocalConvList",value:function(n){var a=this,s=!1;n.forEach(function(h){a._convMap.has(h)&&(a.deleteLocalConv(h,!1),s=!0)}),K.l("".concat(this._n,".deleteLocalConvList convID:").concat(n," isConvIDExisted:").concat(s)),s&&this.emitConvUpdate(!0,!1)}},{key:"isMessageSentByCurrentInstance",value:function(n){return!(!this._msgListHandler.hasLocalMsg(n.conversationID,n.ID)&&!this._sll.has(n.random))}},{key:"modifyMessageList",value:function(n){var a,s;n.startsWith(O.CONV_C2C)&&this._convMap.has(n)&&(s=this._convMap.get(n),a=Date.now(),this._msgListHandler.modifyMsgSentByPeer({conversationID:n,latestNick:s.userProfile.nick,latestAvatar:s.userProfile.avatar}),s=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),this._msgListHandler.modifyMsgSentByMe({conversationID:n,latestNick:s.nick,latestAvatar:s.avatar}),K.l("".concat(this._n,".modifyMessageList convID:").concat(n," cost:").concat(br(a))))}},{key:"updateUserProfileSpecifiedKey",value:function(h){K.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),h);var a=h.conversationID,s=h.nick,h=h.avatar;this._convMap.has(a)&&(a=this._convMap.get(a).userProfile,_n(s)&&a.nick!==s&&(a.nick=s),_n(h)&&a.avatar!==h&&(a.avatar=h),this.emitConvUpdate(!0,!1))}},{key:"_onMyProfileModified",value:function(n){var a=this,s=this.getLocalConvList(),h=Date.now();s.forEach(function(m){a.modifyMessageSentByMe(E({conversationID:m.conversationID},n))}),K.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat(br(h)))}},{key:"modifyMessageSentByMe",value:function(n){this._msgListHandler.modifyMsgSentByMe(n)}},{key:"getLatestMessageSentByMe",value:function(n){return this._msgListHandler.getLatestMsgSentByMe(n)}},{key:"modifyMessageSentByPeer",value:function(n){this._msgListHandler.modifyMsgSentByPeer(n)}},{key:"getLatestMessageSentByPeer",value:function(n){return this._msgListHandler.getLatestMsgSentByPeer(n)}},{key:"pushIntoNoticeResult",value:function(n,a){return!(!this._msgListHandler.pushIn(a)||this._sll.has(a.random)||(n.push(a),0))}},{key:"getLocalLastMessage",value:function(n){return this._msgListHandler.getLocalLastMsg(n)}},{key:"getLocalSecondLastMessage",value:function(n){return this._msgListHandler.getLocalSecondLastMsg(n)}},{key:"checkAndPatchRemark",value:function(){var n,a,s=this.get(8);this._convMap.size!==0&&s&&(n=P(this._convMap.values()).filter(function(h){return h.type===O.CONV_C2C})).length!==0&&(a=0,n.forEach(function(h){var m=h.conversationID.replace(O.CONV_C2C,"");s.isMyFriend(m)&&(m=s.getFriendRemark(m),h.remark!==m)&&(h.remark=m,a+=1)}),K.l("".concat(this._n,".checkAndPatchRemark. c2cConvCount:").concat(n.length," patchedCount:").concat(a)),0<a)&&this.emitConvUpdate(!0,!1)}},{key:"updateTopicConversation",value:function(n){this._updateLocalConvList({conversationOptionsList:n,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(n){var a=n[0],s=null;return a.conversationType===O.CONV_C2C?s=this._m.get(6):a.conversationType===O.CONV_GROUP&&(s=this._m.get(7)),s?s.sendReadReceipt(n):De({code:Je.NO_MODULE})}},{key:"getReadReceiptList",value:function(n){var a=n[0],s=null;return a.conversationType===O.CONV_C2C?s=this._m.get(6):a.conversationType===O.CONV_GROUP&&(s=this._m.get(7)),s?s.getReadReceiptList(n):De({code:Je.NO_MODULE})}},{key:"getLastMessageTime",value:function(n){return n=this.getLocalConversation(n),n?n.lastMessage.lastTime:0}},{key:"getTotalUnreadCount",value:function(){var n=this.getLocalConvList(),a=0;return n.forEach(function(s){s.type===O.CONV_SYSTEM||s.messageRemindType!==""&&s.messageRemindType!==O.MSG_REMIND_ACPT_AND_NOTE||(a+=s.unreadCount)}),a}},{key:"onTotalUnreadCountUpdate",value:function(){var n=this.getTotalUnreadCount();this._convTotalUnreadCount!==n&&(K.l("".concat(this._n,".onTotalUnreadCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(n)),this._convTotalUnreadCount=n,this.emitOEvt(W.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"_isConvNeedShow",value:function(h){var a,s,h=this.getLocalConversation(h);return!(!et(h)&&(a=h.type===O.CONV_TOPIC,s=h.type===O.CONV_GROUP&&h.groupProfile.type===O.GRP_ROOM,h=h.type===O.CONV_GROUP&&h.groupProfile.type===O.GRP_LIVE,a||s||h))}},{key:"setAllRcvMsgOpt",value:function(n){return this._msgRemindHandler.setAllRcvMsgOpt(n)}},{key:"getAllRcvMsgOpt",value:function(){return this._msgRemindHandler.getAllRcvMsgOpt()}},{key:"onAllRcvMsgOptNotify",value:function(n){this._msgRemindHandler.onAllRcvMsgOptNotify(n)}},{key:"clearUnreadCount",value:function(n){n=this.getLocalConversation(n),n&&0<n.unreadCount&&(n.unreadCount=0,this.emitConvUpdate(!0,!1))}},{key:"storeHoppingMessageList",value:function(n){this._msgListHandler.storeHoppingMsgList(n)}},{key:"clearMemMsg",value:function(n){var a=1<arguments.length&&arguments[1]!==void 0&&arguments[1];K.l("".concat(this._n,".clearMemMsg convID:").concat(n," isOverLimit:").concat(a)),this._msgListHandler.removeByConvID(n),this._completedMap.delete(n),this._roamingMsgKeyAndTimeMap.delete(n),this._everClearedMap.set(n,1)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._setStorageConvList(!0),this._pagingStatus=Vs,this._msgListHandler.reset(),this._msgRemindHandler.reset(),this._roamingMsgKeyAndTimeMap.clear(),this._sll.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._convMap.clear(),this._pagingTs=0,this._pagingStartIdx=0,this._pagingPinnedTs=0,this._pagingPinnedStartIdx=0,this._remoteGroupReadSeqMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this._convMapForDiff.clear(),this._partialUpdatedConvMap.clear(),this._everClearedMap.clear(),this._bPullOnInvite=!0,this._convGroupHandler.reset(),this.resetReady()}}])),u1=p(function n(a){u(this,n),this._grpM=a,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4},[{key:"onCheckTimer",value:function(n){n%1==0&&0<this._cachedGroupTipsMap.size&&this._check()}},{key:"_check",value:function(){var n=this;this._cachedGroupTipsMap.forEach(function(a,s){var h=n._checkCountMap.get(s),m=n._grpM.hasLocalGroup(s);K.l("".concat(n._n,"._check groupID:").concat(s," hasLocalGroup:").concat(m," checkCount:").concat(h)),m?(n._notifyCachedGroupTips(s),n._checkCountMap.delete(s),n._grpM.deleteUnjoinedAVChatRoom(s)):h>=n.MAX_CHECK_COUNT?(n._deleteCachedGroupTips(s),n._checkCountMap.delete(s)):n._checkCountMap.set(s,++h)})}},{key:"onNewGroupTips",value:function(h){K.l("".concat(this._n,".onNewGroupTips options:").concat(JSON.stringify(h.dataList)));var h=this._assembly(h),a=h.eventDataList,s=h.result,h=h.AVChatRoomMessageList;0<h.length&&this._grpM.onAVChatRoomMessage(h),0<s.length&&(this._grpM.emitOEvt(W.MESSAGE_RECEIVED,s),this._handleTips(s)),0<a.length&&(this._grpM.updateNextMessageSeq(a),this._grpM.get(11).onNewMessage({conversationOptionsList:a,isInstantMessage:!0}))}},{key:"_assembly",value:function(n){for(var a=n.event,s=n.dataList,h=null,m=[],I=[],T={},D=[],V=0,$=s.length;V<$;V++){var q=Ar(s[V]);if(!(a===6&&(this._grpM.isGroupAttributesUpdatedNotice(q)||this._grpM.isGroupCountersNotice(q)))){var Xe=q.groupProfile,se=Xe.groupID,me=Xe.communityType,me=me===void 0?0:me,fe=Xe.topicID,fe=fe===void 0?void 0:fe,He=Xe.invisible,Xe=Xe.groupType,Xe=Xe===void 0?void 0:Xe,Ye=void 0,Lt=this._grpM.isMessageFromTopic(me,fe),yt=(Lt&&(Ye=O.CONV_TOPIC,q.to=fe),this._grpM.hasLocalGroup(se));if(yt||!this._grpM.isUnjoinedAVChatRoom(se))if(yt||Lt)if(this._grpM.isMessageFromOrToAVChatroom(se))q.event=a,D.push(q);else if(q.currentUser=this._grpM.getMyUserID(),q.conversationType=O.CONV_GROUP,(h=new _r(q)).setElement({type:O.MSG_GRP_TIP,content:E(E({},q.elements),{},{groupProfile:q.groupProfile})}),h.isSystemMessage=!1,He!==1){var yt=this._grpM.get(11),Lt=h,He=Lt.conversationID,Lt=Lt.sequence;if(a===6)h._onlineOnlyFlag=!0,I.push(h);else if(!yt.pushIntoNoticeResult(I,h))continue;this._grpM.isMessageFromCommunityOfTopic(me,fe)||a===6&&yt.getLocalConversation(He)||(a!==6&&this._qualityStat(h),me=yt.isRemoteRead({conversationID:He,sequence:Lt}),et(T[He])?(fe=0,h.flow!=="in"||h._isExcludedFromUnreadCount||h._onlineOnlyFlag||me||(fe=1),T[He]=m.push({conversationID:He,unreadCount:fe,type:et(Ye)?h.conversationType:Ye,subType:h.conversationSubType,lastMessage:h._isExcludedFromLastMessage?"":h})-1):(m[yt=T[He]].type=h.conversationType,m[yt].subType=h.conversationSubType,m[yt].lastMessage=h._isExcludedFromLastMessage?"":h,h.flow!=="in"||h._isExcludedFromUnreadCount||h._onlineOnlyFlag||me||m[yt].unreadCount++))}else this._qualityStat(h);else this._cacheAndCompare({groupID:se,event:a,item:q,groupType:Xe})}}return{eventDataList:m,result:I,AVChatRoomMessageList:D}}},{key:"_qualityStat",value:function(n){this._grpM.get(26).addMessageSequence({key:dc,message:n})}},{key:"_handleTips",value:function(n){var a=this;n.forEach(function(s){switch(s.payload.operationType){case 1:a._onNewMemberComeIn(s);break;case 2:a._onMemberQuit(s);break;case 3:a._onMemberKickedOut(s);break;case 4:a._onMemberSetAdmin(s);break;case 5:a._onMemberCancelledAdmin(s);break;case 6:a._onGroupProfileModified(s);break;case 7:a._onMemberInfoModified(s);break;case 8:a._onTopicProfileUpdated(s);break;default:K.w("".concat(a._n,"._handleTips unknown operationType:").concat(s.payload.operationType))}})}},{key:"_onNewMemberComeIn",value:function(s){var s=s.payload,a=s.memberNum,s=s.groupProfile.groupID,s=this._grpM.getLocalGroupProfile(s);s&&It(a)&&s.memberCount!==a&&(s.memberCount=a,this._updateConvGroupProfile(s))}},{key:"_onMemberQuit",value:function(n){var s=n.payload,a=s.memberNum,s=s.groupProfile.groupID,h=this._grpM.getLocalGroupProfile(s);h&&It(a)&&h.memberCount!==a&&(h.memberCount=a,this._updateConvGroupProfile(h)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(s,n.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(n){var s=n.payload,a=s.memberNum,s=s.groupProfile.groupID,h=this._grpM.getLocalGroupProfile(s);h&&It(a)&&h.memberCount!==a&&(h.memberCount=a,this._updateConvGroupProfile(h)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(s,n.payload.userIDList)}},{key:"_updateConvGroupProfile",value:function(n){this._grpM.get(11).updateConvGroupProfile([n])}},{key:"_onMemberSetAdmin",value:function(s){var a=s.payload.groupProfile.groupID,s=s.payload.userIDList,h=this._grpM.getGroupMemberHandler();s.forEach(function(m){m=h.getLocalGroupMemberInfo(a,m),m&&m.updateRole(O.GRP_MBR_ROLE_ADMIN)})}},{key:"_onMemberCancelledAdmin",value:function(s){var a=s.payload.groupProfile.groupID,s=s.payload.userIDList,h=this._grpM.getGroupMemberHandler();s.forEach(function(m){m=h.getLocalGroupMemberInfo(a,m),m&&m.updateRole(O.GRP_MBR_ROLE_MEMBER)})}},{key:"_onGroupProfileModified",value:function(m){var a=this,m=m.payload,s=m.newGroupProfile,T=m.groupProfile,h=m.operatorInfo,m=T.groupID,I=this._grpM.getLocalGroupProfile(m),T=(Object.keys(s).forEach(function(D){switch(D){case"ownerID":a._ownerChanged(I,s);break;case"groupName":I.name=s[D];break;default:I[D]=s[D]}}),et(h)||Object.keys(h).forEach(function(D){var V;D==="nameCard"?I.updateSelfInfo({nameCard:h[D]}):D==="role"&&(V="",h[D]===400?V=O.GRP_MBR_ROLE_OWNER:h[D]===300?V=O.GRP_MBR_ROLE_ADMIN:h[D]===200&&(V=O.GRP_MBR_ROLE_MEMBER),I.updateSelfInfo({role:V}))}),!I.isSupportTopic);this._grpM.emitGroupListUpdate(!0,T)}},{key:"_ownerChanged",value:function(s,a){var s=s.groupID,h=this._grpM.getLocalGroupProfile(s),m=this._grpM.getMyUserID();m===a.ownerID&&(h.updateGroup({selfInfo:{role:O.GRP_MBR_ROLE_OWNER}}),h=(a=this._grpM.getGroupMemberHandler()).getLocalGroupMemberInfo(s,m),m=this._grpM.getLocalGroupProfile(s).ownerID,a=a.getLocalGroupMemberInfo(s,m),h&&h.updateRole(O.GRP_MBR_ROLE_OWNER),a)&&a.updateRole(O.GRP_MBR_ROLE_MEMBER)}},{key:"_onMemberInfoModified",value:function(n){var a=n.to,h=n.payload,s=h.groupProfile,h=h.memberList,m=s.groupID,I=(vr(a)&&this._updateTopicMuteTime(n),this._grpM.getGroupMemberHandler());h.forEach(function(T){var D=I.getLocalGroupMemberInfo(m,T.userID);D&&It(T.muteTime)&&D.updateMuteUntil(T.muteTime)})}},{key:"_updateTopicMuteTime",value:function(h){var a=h.to,h=h.payload,m=h.groupProfile,h=h.memberList,s=h===void 0?[]:h,h=this._grpM.get(10),m=m.groupID,I=h.getLocalTopic(m,a);if(I){for(var T=!1,D=0;D<s.length;D++){var V=s[D];if(V.userID===this._grpM.getMyUserID()&&0<=V.muteTime){I.updateSelfInfo({muteTime:V.muteTime}),T=!0;break}}T&&this._grpM.emitOEvt(W.TOPIC_UPDATED,{groupID:m,topic:I})}}},{key:"_onTopicProfileUpdated",value:function(n){var s=n.payload,a=s.groupProfile.groupID,s=s.newTopicInfo;this._grpM.get(10).onTopicProfileUpdated(E({groupID:a,topicID:n.to},s))}},{key:"_cacheGroupTips",value:function(n,a){this._cachedGroupTipsMap.has(n)||this._cachedGroupTipsMap.set(n,[]),this._cachedGroupTipsMap.get(n).push(a)}},{key:"_deleteCachedGroupTips",value:function(n){this._cachedGroupTipsMap.has(n)&&this._cachedGroupTipsMap.delete(n)}},{key:"_notifyCachedGroupTips",value:function(n,a){var s=this,h=this._cachedGroupTipsMap.get(n)||[];K.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(n," groupType:").concat(a," count:").concat(h.length)),h.forEach(function(m){s.onNewGroupTips(m)}),this._deleteCachedGroupTips(n)}},{key:"_cacheAndCompare",value:function(h){var a=h.groupID,m=h.event,s=h.item,h=h.groupType,m=(K.l("".concat(this._n,"._cacheAndCompare groupID:").concat(a," groupType:").concat(h)),this._cacheGroupTips(a,{event:m,dataList:[s]}),{groupID:a,type:h});h===O.GRP_AVCHATROOM?this._grpM.hasLocalGroup(a)?this._notifyCachedGroupTips(a,h):this._grpM.setUnjoinedAVChatRoom(a):(this._grpM.updateGroupMap([m]),this._notifyCachedGroupTips(a,h)),this._checkCountMap.has(a)||this._checkCountMap.set(a,0)}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear()}}]),d1=p(function n(a){u(this,n),this._grpM=a,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._pagingStatus=Vs,this._pagingGetCostList=[],a.getIEmitInst().on(So.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)},[{key:"onCheckTimer",value:function(n){n%1==0&&0<this._cachedGroupMessageMap.size&&this._check()}},{key:"_check",value:function(){var n=this;this._cachedGroupMessageMap.forEach(function(a,s){var h=n._checkCountMap.get(s),m=n._grpM.hasLocalGroup(s);K.l("".concat(n._n,"._check groupID:").concat(s," hasLocalGroup:").concat(m," checkCount:").concat(h)),m?(n._notifyCachedGroupMessage(s),n._checkCountMap.delete(s),n._grpM.deleteUnjoinedAVChatRoom(s)):h>=n.MAX_CHECK_COUNT?(n._deleteCachedGroupMessage(s),n._checkCountMap.delete(s)):n._checkCountMap.set(s,++h)})}},{key:"updateLastMsg",value:function(n){var a="".concat(this._n,".updateLastMsg");if(this._grpM.getGroupMap().size!==0){for(var s,h,m,I,T=!1,D=n.length,V=0;V<D;V++)(s=n[V]).type===O.CONV_GROUP&&s.lastMessage.lastSequence!==0&&s.lastMessage.payload!==null&&(h=s.conversationID.split(/^GROUP/)[1],h=this._grpM.getLocalGroupProfile(h))&&(m=h.lastMessage,I=s.lastMessage,JSON.stringify(m)!==JSON.stringify(I))&&(h.lastMessage=E({},s.lastMessage),T=!0);K.l("".concat(a," convCount:").concat(D," groupCount:").concat(this._grpM.getLocalGroupList().length," isUpdated:").concat(T)),T&&(this._grpM.sortLocalGroupList(),this._grpM.emitGroupListUpdate(!0,!1))}else this.tempConversationList=n}},{key:"onNewMessage",value:function(n){var h=this._assembly(n),a=h.conversationOptionsList,s=h.messageList,h=h.AVChatRoomMessageList,h=(0<h.length&&this._grpM.onAVChatRoomMessage(h),Cv(s)),h=(0<h.length&&this._grpM.emitOEvt(W.MESSAGE_MODIFIED,h),0<a.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:a,isInstantMessage:n.isInstantMessage!==!1,updateUnreadCount:n.updateUnreadCount!==!1}),this._grpM.updateNextMessageSeq(a)),Sv(s));0<h.length&&this._grpM.emitOEvt(W.MESSAGE_RECEIVED,h),s.length=0}},{key:"_assembly",value:function(n){var a=n.dataList,s=n.event,h=n.isInstantMessage,m=null,I=[],T=[],D=[],V={},$=this._grpM.getFileDownloadProxy(),q=this._grpM.getDownloadFileAuthKey(),se=this._grpM.get(17).getFileDNList(),me=a.length;1<me&&a.sort(function(yo,Ko){return yo.sequence-Ko.sequence});for(var fe=this._grpM.get(11),He=this._grpM.get(4),Xe=0;Xe<me;Xe++){var Ye,Lt=Ar(a[Xe]),Gn=Lt.groupProfile,yt=Gn.groupID,rn=Gn.communityType,rn=rn===void 0?0:rn,on=Gn.topicID,on=on===void 0?void 0:on,Pn=Gn.invisible,Gn=Gn.groupType,Gn=Gn===void 0?void 0:Gn,Jn=void 0,qo=this._grpM.isMessageFromTopic(rn,on),ko=(qo&&(Jn=O.CONV_TOPIC,Lt.to=on),this._grpM.hasLocalGroup(yt));!ko&&this._grpM.isUnjoinedAVChatRoom(yt)||(ko||qo?this._grpM.isMessageFromOrToAVChatroom(yt)?(Lt.event=s,D.push(Lt)):(Lt.currentUser=this._grpM.getMyUserID(),Lt.conversationType=O.CONV_GROUP,Lt.isSystemMessage=!!Lt.isSystemMessage,(m=new _r(Lt)).setElement(Lt.elements,$,q,se),Pn!==1?(ko=a[Xe].isModified===1,fe.isMessageSentByCurrentInstance(m)?m.isModified=ko:ko=!1,Lt.onlineOnlyFlag===1?(m._onlineOnlyFlag=!0,fe.isMessageSentByCurrentInstance(m)||T.push(m)):this._grpM.isMessageFromCommunityOfTopic(rn,on)?T.push(m):(m.from===this._grpM.getMyUserID()&&(qo=fe.getLatestMessageSentByMe(m.conversationID))&&(Pn=qo.nick,rn=qo.avatar,Pn===m.nick&&rn===m.avatar||(fe.modifyMessageSentByMe({conversationID:Ye,latestNick:m.nick,latestAvatar:m.avatar}),He.mockOnNickAvatarModified(m.nick,m.avatar))),fe.pushIntoMessageList(T,m,ko)&&(this._qualityStat(h,m),Ye=(on=m).conversationID,qo=on.sequence,Pn=fe.isRemoteRead({conversationID:Ye,sequence:qo}),et(V[Ye])?(rn=0,m.flow!=="in"||m._isExcludedFromUnreadCount||Pn||(rn=1),V[Ye]=I.push({conversationID:Ye,unreadCount:rn,type:et(Jn)?m.conversationType:Jn,subType:m.conversationSubType,lastMessage:m._isExcludedFromLastMessage?"":m})-1):(I[ko=V[Ye]].type=et(Jn)?m.conversationType:Jn,I[ko].subType=m.conversationSubType,I[ko].lastMessage=m._isExcludedFromLastMessage?"":m,m.flow!=="in"||m._isExcludedFromUnreadCount||Pn||I[ko].unreadCount++)))):this._qualityStat(h,m)):this._cacheAndCompare({groupID:yt,event:s,item:Lt,groupType:Gn}))}return{conversationOptionsList:I,messageList:T,AVChatRoomMessageList:D}}},{key:"_qualityStat",value:function(n,a){var s=this._grpM.get(26);s.addMessageSequence({key:dc,message:a}),n&&0<a.clientTime&&s.addMessageDelay(a.clientTime)}},{key:"onMsgRevoked",value:function(n,a){var s=this,h=this._grpM.get(11),m=[],I=[];n.dataList.forEach(function(T){var D=T.elements.revokedInfos,V=T.revokerInfo,$=T.groupProfile,q=!1;$&&(q=Yr({groupID:$.groupID})||!Tt($.topicID)),et(D)||D.forEach(function(se){var me,fe=Tt(se.topicID)?"GROUP".concat(se.groupID):"GROUP".concat(se.topicID),He=h.getLocalConversation(fe),Xe=se.revokerInfo&&se.revokerInfo.revoker||V&&V.revoker,Ye=V&&V.reason||"";He&&jr(He.type)?me={conversationID:fe,sequence:se.sequence,ID:"".concat(se.tinyID,"-").concat(se.clientTime,"-").concat(se.random)}:(He=h.revoke(fe,se.sequence,se.random))?me=He:(me={conversationID:fe,sequence:se.sequence},se.tinyID&&se.clientTime&&se.random&&(me.ID="".concat(se.tinyID,"-").concat(se.clientTime,"-").concat(se.random)),se.time&&(me.time=se.time)),me&&(me.revoker=Xe,me.revokeReason=Ye,me.revokerInfo={userID:Xe,nick:"",avatar:""},(q?(me.revokerInfo.nick=$.nick,me.revokerInfo.avatar=$.avatar,m):I).push(me))})}),I.length===0&&m.length===0||(h.onMessageRevoked([].concat(m,I),a),0<m.length&&this._grpM.emitOEvt(W.MESSAGE_REVOKED,m),0<I.length&&h.updateRevokerInfo(I).then(function(T){s._grpM.emitOEvt(W.MESSAGE_REVOKED,T)}))}},{key:"_groupListTreeShaking",value:function(n){for(var a=new Map(P(this._grpM.getGroupMap())),s=0,h=n.length;s<h;s++)a.delete(n[s].groupID);this._grpM.hasJoinedAVChatRoom()&&this._grpM.getJoinedAVChatRoom().forEach(function(D){a.delete(D)}),this._grpM.getGroupMap().forEach(function(D,V){D.isSupportTopic&&a.delete(V)});for(var m=P(a.keys()),I=0,T=m.length;I<T;I++)this._grpM.deleteGroup(m[I])}},{key:"syncGroupList",value:function(){var n,a,s=this,h=0<arguments.length&&arguments[0]!==void 0&&arguments[0],m=(this._pagingStatus===Vs&&this._grpM.clearGroupMap(),P(Ie)),I=this.PAGING_GRP_COUNT_LIMIT,T=[];return h===!0?this._pagingGetGroupListWithTopic({limit:I,offset:0,groupBaseInfoFilter:m,groupList:T}):(h="syncGroupList",n="".concat(this._n,".").concat(h),a=new ct(h),this._pagingGetGroupList({limit:I,offset:0,groupBaseInfoFilter:m,groupList:T}).then(function(){var D=gh(s._pagingGetCostList),V=TI(s._pagingGetCostList),$=(s._pagingGetCostList.length=0,s._pagingStatus=_h,s._groupListTreeShaking(T),s._grpM.updateGroupMap(T),s._grpM.getLocalGroupList().length),$="count:".concat($," sum:").concat(V," avg:").concat(D);return K.l("".concat(n," ok. ").concat($)),a.setMessage($).end(),s.tempConversationList&&(s.updateLastMsg(s.tempConversationList),s.tempConversationList=null),s._grpM.emitGroupListUpdate(!0,!0),Kt({groupList:s._grpM.getLocalGroupList()})}).catch(function(D){return s._pagingStatus=bl,a.setError(D).end(),K.e("".concat(n," failed. error:"),D),De(D)}))}},{key:"getGroupList",value:function(){var n,a=this,s="".concat(this._n,".").concat("getGroupList");return K.l("".concat(s," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===bl||this._pagingStatus===Vs?this.syncGroupList().then(function(){var h=a._grpM.getLocalGroupList();return Kt({groupList:h,isSyncCompleted:a.isPagingGetCompleted()})}).catch(function(h){return K.e("".concat(s," failed. error:"),h),De(h)}):(n=this._grpM.getLocalGroupList(),K.l("".concat(s,". returned group count:").concat(n.length)),ln({groupList:n,isSyncCompleted:this.isPagingGetCompleted()}))}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===_h}},{key:"_pagingGetGroupList",value:function(n){var a=this,s="".concat(this._n,".").concat("_pagingGetGroupList"),V=n.isCommunityRelay,h=V!==void 0&&V,m=n.limit,I=n.offset,T=n.groupBaseInfoFilter,D=n.groupList,V=void 0,$=(h&&(V=O.GRP_COMMUNITY,T.push("AtInfoList")),Date.now());return this._grpM.req({P:de.GET_GRP_LIST,data:{type:V,memberAccount:this._grpM.getMyUserID(),limit:m,offset:I,responseFilter:{groupBaseInfoFilter:T,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then(function(fe){var fe=fe.data,se=fe.groups,se=se===void 0?[]:se,fe=fe.totalCount,se=(D.push.apply(D,P(se)),a._handleGroupAtInfoWithoutTopic(h,se),I+m),me=!(se<fe),fe="offset:".concat(I," limit:").concat(m," total:").concat(fe," isCompleted:").concat(me," ")+"current:".concat(D.length," isCommunityRelay:").concat(h);return a._pagingGetCostList.push(br($,!1)),K.l("".concat(s," ok. ").concat(fe," cost:").concat(br($))),h||me?!h&&me?(K.l("".concat(s," start to get community list")),I=0,a._pagingGetGroupList({limit:m,offset:I,groupBaseInfoFilter:T,groupList:D,isCommunityRelay:!0})):h&&!me?(I=se,a._pagingGetGroupList({limit:m,offset:I,groupBaseInfoFilter:T,groupList:D,isCommunityRelay:!0})):Kt({groupList:D}):(I=se,a._pagingGetGroupList({limit:m,offset:I,groupBaseInfoFilter:T,groupList:D}))}).catch(function(q){return q.code===10018?(K.w("".concat(a.logPrefix," response size exceeds the limit, request count:").concat(m)),m=50,a._pagingGetGroupList({limit:m,offset:I,groupBaseInfoFilter:T,groupList:D,isCommunityRelay:h})):h?(q.code===11e3&&K.l("".concat(s," ok. community unavailable")),ln({groupList:D})):De(q)})}},{key:"_pagingGetGroupListWithTopic",value:function(n){var a=this,s="".concat(this._n,"._pagingGetGroupListWithTopic"),h=n.limit,m=n.offset,I=n.groupBaseInfoFilter,T=n.groupList,D=Date.now();return this._grpM.req({P:de.GET_GRP_LIST,data:{type:O.GRP_COMMUNITY,memberAccount:this._grpM.getMyUserID(),limit:h,offset:m,responseFilter:{groupBaseInfoFilter:I,selfInfoFilter:P(ve)},isSupportTopic:1,needAppDefineData:1}}).then(function($){var $=$.data,q=$.groups,$=$.totalCount,q=(T.push.apply(T,P(q===void 0?[]:q)),m+h),se=!(q<$);return K.l("".concat(s," ok. offset:").concat(m," limit:").concat(h," totalCount:").concat($," isCompleted:").concat(se," currentCount:").concat(T.length," cost:").concat(br(D))),se?(a._grpM.updateGroupMap(T),a._grpM.emitGroupListUpdate(!0,!1),$=a._grpM.getLocalGroupList().filter(function(me){return me.isSupportTopic===!0}),Kt({groupList:$})):(m=q,a._pagingGetGroupListWithTopic({limit:h,offset:m,groupBaseInfoFilter:I,groupList:T}))}).catch(function(V){return V.code===10018?(K.w("".concat(a.logPrefix," response size exceeds the limit, request count:").concat(h)),h=50,a._pagingGetGroupListWithTopic({limit:h,offset:m,groupBaseInfoFilter:I,groupList:T})):De(V)})}},{key:"_cacheGroupMessage",value:function(n,a){this._cachedGroupMessageMap.has(n)||this._cachedGroupMessageMap.set(n,[]),this._cachedGroupMessageMap.get(n).push(a)}},{key:"_deleteCachedGroupMessage",value:function(n){this._cachedGroupMessageMap.has(n)&&this._cachedGroupMessageMap.delete(n)}},{key:"_notifyCachedGroupMessage",value:function(n,a){var s=this,h=this._cachedGroupMessageMap.get(n)||[];K.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(n," groupType:").concat(a," count:").concat(h.length)),h.forEach(function(m){s.onNewMessage(m)}),this._deleteCachedGroupMessage(n)}},{key:"_cacheAndCompare",value:function(h){var a=h.groupID,m=h.event,s=h.item,h=h.groupType,m=(K.l("".concat(this._n,"._cacheAndCompare groupID:").concat(a," groupType:").concat(h)),this._cacheGroupMessage(a,{event:m,dataList:[s]}),{groupID:a,type:h});h===O.GRP_AVCHATROOM?this._grpM.hasLocalGroup(a)?this._notifyCachedGroupMessage(a,h):this._grpM.setUnjoinedAVChatRoom(a):(this._grpM.updateGroupMap([m]),this._notifyCachedGroupMessage(a,h)),this._checkCountMap.has(a)||this._checkCountMap.set(a,0)}},{key:"_handleGroupAtInfoWithoutTopic",value:function(n,a){var s=this;n&&a.length!==0&&a.forEach(function(I){var m=I.groupID,I=I.groupAtInfoList,T=[];et(I)||(I.forEach(function(D){T.push(E(E({},D),{},{groupID:m}))}),s._grpM.get(11).onNewGroupAtTips({dataList:T}))})}},{key:"setPagingGroupCount",value:function(n){et(n)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(n,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._pagingStatus=Vs,this._pagingGetCostList=[]}}]),h1=p(function n(a){u(this,n),this._grpM=a,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(So.CLOUD_CONFIG,this._onCloudConfig,this)},[{key:"_onCloudConfig",value:function(){var n=this._grpM.getCloudConfig("grp_attr_cache_time");et(n)||(this.CACHE_EXPIRE_TIME=Number(n))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach(function(n){n.localMainSequence=0})}},{key:"isGroupAttributesUpdatedNotice",value:function(s){var a=s.to,s=s.elements.newGroupProfile,h=!et(s)&&!Tt(s.groupAttributeOption);return h&&this._onGroupAttributesUpdated({groupID:a,groupAttributeOption:s.groupAttributeOption}),h}},{key:"_onGroupAttributesUpdated",value:function(D){var a,s=this,h=D.groupID,D=D.groupAttributeOption,m=D.mainSequence,I=D.isWithChangedAttributeInfo,T=D.groupAttributeList,T=T===void 0?[]:T,D=D.operationType;K.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(h," isWithChangedAttributeInfo:").concat(I," operationType:").concat(D)),et(D)||(this._groupAttributesCopy=this._getCachedAttributes({groupID:h}),(a=m-this._getLocalGroupAttributes(h).localMainSequence)!=0&&(I===1&&a==1?(this._refreshCachedGroupAttributes({groupID:h,remoteMainSequence:m,groupAttributeList:T,operationType:D}),this._emitGroupAttributesUpdated(h)):this._hasLocalGroupAttributes(h)&&(I=this._getLocalGroupAttributes(h).avChatRoomKey,this._getGroupAttributes({groupID:h,avChatRoomKey:I}).then(function(){s._emitGroupAttributesUpdated(h)}))))}},{key:"initGroupAttributesCache",value:function(s){var a=s.groupID,s=s.avChatRoomKey,s=s===void 0?void 0:s;this._groupAttributesMap.set(a,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:s}),K.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(a," avChatRoomKey:").concat(s))}},{key:"initGroupAttributes",value:function(I){var a=this,s=I.groupID,h=I.groupAttributes,I=this._getLocalGroupAttributes(s),m=I.remoteMainSequence,I=I.avChatRoomKey,T=new ct("initGroupAttributes");return T.setMessage("groupID:".concat(s," avChatRoomKey:").concat(I," mainSequence:").concat(m)),this._grpM.req({P:de.SET_GRP_ATTR,data:{groupID:s,avChatRoomKey:I,mainSequence:m,groupAttributeList:this._transformGroupAttributes(h)}}).then(function($){K.l("".concat(a._n,".").concat("initGroupAttributes"," ok. groupID:").concat(s));var $=$.data,V=$.mainSequence,$=P($.groupAttributeList);return $.forEach(function(q){q.value=h[q.key]}),a._groupAttributesCopy=a._getCachedAttributes({groupID:s}),a._refreshCachedGroupAttributes({groupID:s,remoteMainSequence:V,groupAttributeList:$,operationType:1}),a._emitGroupAttributesUpdated(s),T.end(),Kt({groupAttributes:h})}).catch(function(D){return T.setError(D).end(),De(D)})}},{key:"setGroupAttributes",value:function(V){var a=this,s="".concat(this._n,".").concat("setGroupAttributes"),h=V.groupID,m=V.groupAttributes,V=this._getLocalGroupAttributes(h),I=V.remoteMainSequence,T=V.avChatRoomKey,D=V.attributes,V=this._transformGroupAttributes(m),$=(V.forEach(function(q){var se=q.key;q.sequence=0,D.has(se)&&(q.sequence=D.get(se).sequence)}),new ct("setGroupAttributes"));return $.setMessage("groupID:".concat(h," groupAttributes:").concat(JSON.stringify(m))),K.l("".concat(s,". groupID:").concat(h," mainSequence:").concat(I)),this._grpM.req({P:de.MODIFY_GRP_ATTR,data:{groupID:h,avChatRoomKey:T,mainSequence:I,groupAttributeList:V}}).then(function(me){K.l("".concat(s," ok."));var me=me.data,se=me.mainSequence,me=P(me.groupAttributeList);return me.forEach(function(fe){fe.value=m[fe.key]}),a._groupAttributesCopy=a._getCachedAttributes({groupID:h}),a._refreshCachedGroupAttributes({groupID:h,remoteMainSequence:se,groupAttributeList:me,operationType:2}),a._emitGroupAttributesUpdated(h),$.end(),Kt({groupAttributes:m})}).catch(function(q){return $.setError(q).end(),De(q)})}},{key:"deleteGroupAttributes",value:function(h){var a=this,s=h.groupID,h=h.keyList,h=h===void 0?[]:h,D=this._getLocalGroupAttributes(s),m=D.remoteMainSequence,$=D.avChatRoomKey,I=D.attributes,T=P(I.keys()),D=de.CLEAR_GRP_ATTR,V=3,$={groupID:s,avChatRoomKey:$,mainSequence:m},q=[],se=(0<h.length&&(T=[],D=de.DEL_GRP_ATTR,V=4,h.forEach(function(me){var fe=0;I.has(me)&&(fe=I.get(me).sequence,T.push(me)),q.push({key:me,sequence:fe})}),$.groupAttributeList=q),new ct("deleteGroupAttributes"));return se.setMessage("groupID:".concat(s," mainSequence:").concat(m," keyList:").concat(h," proto:").concat(D)),this._grpM.req({P:D,data:$}).then(function(me){return K.l("".concat(a._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(s)),me=me.data.mainSequence,a._groupAttributesCopy=a._getCachedAttributes({groupID:s}),a._refreshCachedGroupAttributes({groupID:s,remoteMainSequence:me,groupAttributeList:q,operationType:V}),a._emitGroupAttributesUpdated(s),se.end(),Kt({keyList:T})}).catch(function(me){return se.setError(me).end(),De(me)})}},{key:"getGroupAttributes",value:function(n){var a=this,s="".concat(this._n,".").concat("getGroupAttributes"),h=n.groupID,D=this._getLocalGroupAttributes(h),m=D.avChatRoomKey,I=D.lastUpdateTime,T=D.localMainSequence,D=D.remoteMainSequence,V=new ct("getGroupAttributes");return V.setMessage("groupID:".concat(h," localMainSequence:").concat(T," remoteMainSequence:").concat(D," keyList:").concat(n.keyList)),Date.now()-I>=this.CACHE_EXPIRE_TIME||T<D?this._getGroupAttributes({groupID:h,avChatRoomKey:m}).then(function($){return V.setMoreMessage("get attributes from remote. count:".concat($.length)).end(),K.l("".concat(s," from remote. groupID:").concat(h)),$=a._getCachedAttributes(n),Kt({groupAttributes:$})}).catch(function($){return V.setError($).end(),De($)}):(V.setMoreMessage("get attributes from cache").end(),K.l("".concat(s," from cache. groupID:").concat(h)),I=this._getCachedAttributes(n),ln({groupAttributes:I}))}},{key:"_getGroupAttributes",value:function(n){var a=this,s=0;return et(n.avChatRoomKey)||(s=1),this._grpM.req({P:de.GET_GRP_ATTR,data:E(E({},n),{},{groupType:s})}).then(function(I){K.l("".concat(a._n,"._getGroupAttributes ok. groupID:").concat(n.groupID));var I=I.data,m=I.mainSequence,I=I.groupAttributeList,T=P(I);return et(m)||a._refreshCachedGroupAttributes({groupID:n.groupID,remoteMainSequence:m,groupAttributeList:T,operationType:5}),I}).catch(function(h){return De(h)})}},{key:"_refreshCachedGroupAttributes",value:function(m){var a=m.groupID,s=m.remoteMainSequence,h=m.groupAttributeList,m=m.operationType;if(this._hasLocalGroupAttributes(a)){var I=this._getLocalGroupAttributes(a),T=I.localMainSequence;if(m===5||s-T==1)I.remoteMainSequence=s,I.localMainSequence=s,I.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:I,groupAttributeList:h,operationType:m});else{if(T===s)return;I.remoteMainSequence=s}this._groupAttributesMap.set(a,I),h="operationType:".concat(m," localMainSequence:").concat(T," remoteMainSequence:").concat(s),K.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(h))}}},{key:"_getCachedAttributes",value:function(s){var a=s.groupID,s=s.keyList,s=s===void 0?[]:s,h={};if(this._hasLocalGroupAttributes(a)){var m=this._getLocalGroupAttributes(a).attributes;if(0<s.length)s.forEach(function(V){m.has(V)&&(h[V]=m.get(V).value)});else{var I,T=v(m.keys());try{for(T.s();!(I=T.n()).done;){var D=I.value;h[D]=m.get(D).value}}catch(V){T.e(V)}finally{T.f()}}}return h}},{key:"_updateCachedAttributes",value:function(h){var a=h.groupAttributes,s=h.groupAttributeList,h=h.operationType;h!==3?h!==4?(h===1&&a.attributes.clear(),s.forEach(function(D){var I=D.key,T=D.value,D=D.sequence;a.attributes.set(I,{value:T,sequence:D})})):s.forEach(function(m){a.attributes.delete(m.key)}):a.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(n){return this._groupAttributesMap.has(n)}},{key:"_getLocalGroupAttributes",value:function(n){return this._hasLocalGroupAttributes(n)||this.initGroupAttributesCache({groupID:n}),this._groupAttributesMap.get(n)}},{key:"_transformGroupAttributes",value:function(n){var a=[];return Object.keys(n).forEach(function(s){a.push({key:s,value:n[s]})}),a}},{key:"_emitGroupAttributesUpdated",value:function(n){var a=this._getCachedAttributes({groupID:n}),h=this._computeAttrChangedInfo(a),s=h.updatedKeyList,h=h.deletedKeyList;K.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(s.length,", delete:").concat(h.length)),s.length===0&&h.length===0||this._grpM.emitOEvt(W.GROUP_ATTRIBUTES_UPDATED,{groupID:n,groupAttributes:a,updatedKeyList:s,deletedKeyList:h})}},{key:"_computeAttrChangedInfo",value:function(n){var a=this,s=[],h=[];return Object.keys(n).forEach(function(m){n[m]!==a._groupAttributesCopy[m]&&s.push(m)}),Object.keys(this._groupAttributesCopy).forEach(function(m){et(n[m])&&h.push(m)}),this._groupAttributesCopy={},{updatedKeyList:s,deletedKeyList:h}}},{key:"deleteLocalGroupAttributes",value:function(n){this._hasLocalGroupAttributes(n)&&this._groupAttributesMap.delete(n)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),f1=p(function n(a){u(this,n),this._grpM=a,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(So.CLOUD_CONFIG,this._onCloudConfig,this)},[{key:"_onCloudConfig",value:function(){var n=this._grpM.getCloudConfig("grp_counter_expire_time");et(n)||(this.EXPIRE_TIME=Number(n))}},{key:"isGroupCountersNotice",value:function(s){var a=s.to,s=s.elements.groupCounterInfo,h=!1;return Tt(s)||(this._onGroupCountersUpdated({groupID:a,groupCounterInfo:s}),h=!0),h}},{key:"_onGroupCountersUpdated",value:function(n){var a=this,s=n.groupID;n.groupCounterInfo.forEach(function(T){var m=T.type,I=T.groupCounterSeq,T=T.counterList,T=T===void 0?[]:T;m!==0&&m!==2||(a._updateLocalGroupCounters({groupID:s,groupCounterSeq:I,counterList:T}),T.forEach(function(D){a._grpM.emitOEvt(W.GROUP_COUNTER_UPDATED,{groupID:s,key:D.key,value:D.value})})),m===1&&a._deleteLocalGroupCounters({groupID:s,groupCounterSeq:I,counterList:T})}),K.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(s))}},{key:"initGroupCountersCache",value:function(s){var a=s.groupID,s=s.avChatRoomKey;this._groupCountersMap.set(a,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:s}),K.l("".concat(this._n,".initGroupCountersCache groupID:").concat(a," avChatRoomKey:").concat(s))}},{key:"setGroupCounters",value:function(n){var a,s,h,m,I;return this._grpM.canIUse(ye.GRP_COUNTER)?(a="".concat(this._n,".").concat("setGroupCounters"),s=n.groupID,n=n.counters,n=this._convertObjectToList(n),h=this._getLocalGroupCounters(s).avChatRoomKey,m="groupID:".concat(s," count:").concat(n.length),(I=new ct("setGroupCounters")).setMessage("".concat(m)),K.l("".concat(a,". ").concat(m)),this._updateGroupCounters({groupID:s,counterList:n,avChatRoomKey:h,mode:"Set"}).then(function(T){return I.end(),K.l("".concat(a," ok.")),Kt({counters:T})}).catch(function(T){return I.setError(T).end(),K.e("".concat(a," failed. error:"),T),De(T)})):this._grpM.noUse("setGroupCounters")}},{key:"increaseGroupCounter",value:function(n){var a,s,h,m,I,T,D="increaseGroupCounter";return this._grpM.canIUse(ye.GRP_COUNTER)?(a="".concat(this._n,".").concat(D),s=n.groupID,h=n.key,n=n.value,m=this._getLocalGroupCounters(s).avChatRoomKey,I="groupID:".concat(s," key:").concat(h," value:").concat(n),(T=new ct(D)).setMessage("".concat(I)),K.l("".concat(a,". ").concat(I)),this._updateGroupCounters({groupID:s,counterList:[{key:h,value:n}],avChatRoomKey:m,mode:"Increase"}).then(function(V){return T.end(),K.l("".concat(a," ok.")),Kt({counters:V})}).catch(function(V){return T.setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})):this._grpM.noUse(D)}},{key:"decreaseGroupCounter",value:function(n){var a,s,h,m,I,T,D="decreaseGroupCounter";return this._grpM.canIUse(ye.GRP_COUNTER)?(a="".concat(this._n,".").concat(D),s=n.groupID,h=n.key,n=n.value,m=this._getLocalGroupCounters(s).avChatRoomKey,I="groupID:".concat(s," key:").concat(h," value:").concat(n),(T=new ct(D)).setMessage("".concat(I)),K.l("".concat(a,". ").concat(I)),this._updateGroupCounters({groupID:s,counterList:[{key:h,value:n}],avChatRoomKey:m,mode:"Decrease"}).then(function(V){return T.end(),K.l("".concat(a," ok.")),Kt({counters:V})}).catch(function(V){return T.setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})):this._grpM.noUse(D)}},{key:"getGroupCounters",value:function(T){var a=this;if(!this._grpM.canIUse(ye.GRP_COUNTER))return this._grpM.noUse("getGroupCounters");var s="".concat(this._n,".").concat("getGroupCounters"),h=T.groupID,T=T.keyList,m=T===void 0?[]:T,T=this._getLocalGroupCounters(h),I=T.avChatRoomKey,T=T.lastUpdateTime,D=new ct("getGroupCounters");return D.setMessage("groupID:".concat(h)),Date.now()-T>=this.EXPIRE_TIME?this._getRemoteGroupCounters({groupID:h,avChatRoomKey:I}).then(function(V){return D.setMoreMessage("from remote. count:".concat(V.length)).end(),K.l("".concat(s," from remote. groupID:").concat(h)),V=a._getLocalCounters(h,m),Kt({counters:V})}).catch(function(V){return D.setError(V).end(),De(V)}):(D.setMoreMessage("from cache").end(),K.l("".concat(s," from cache. groupID:").concat(h)),T=this._getLocalCounters(h,m),ln({counters:T}))}},{key:"_getRemoteGroupCounters",value:function(n){var a=this;return this._grpM.req({P:de.GET_GRP_COUNTER,data:E({},n)}).then(function(m){var m=m.data,h=m.counterList,h=h===void 0?[]:h,m=m.groupCounterSeq;return a._updateLocalGroupCounters({groupID:n.groupID,counterList:h,groupCounterSeq:m}),K.l("".concat(a._n,"._getRemoteGroupCounters ok. groupID:").concat(n.groupID)),h}).catch(function(s){return De(s)})}},{key:"_convertObjectToList",value:function(n){var a=[];return Object.keys(n).forEach(function(s){a.push({key:s,value:n[s]})}),a}},{key:"_updateGroupCounters",value:function(n){var a="".concat(this._n,"._updateGroupCounters"),s=n.groupID,h=n.avChatRoomKey,m=n.mode;return K.l("".concat(a,". groupID:").concat(s," avChatRoomKey:").concat(h," mode:").concat(m)),this._grpM.req({P:de.UPDATE_GRP_COUNTER,data:E({},n)}).then(function(T){K.l("".concat(a," ok."));var T=T.data.counterList,D={};return(T===void 0?[]:T).forEach(function(q){var $=q.key,q=q.value;D[$]=q}),D}).catch(function(I){return De(I)})}},{key:"_hasLocalGroupCounters",value:function(n){return this._groupCountersMap.has(n)}},{key:"_getLocalGroupCounters",value:function(n){return this._hasLocalGroupCounters(n)||this.initGroupCountersCache({groupID:n}),this._groupCountersMap.get(n)}},{key:"_updateLocalGroupCounters",value:function(T){var a,s,h,m=T.groupID,I=T.counterList,I=I===void 0?[]:I,T=T.groupCounterSeq;this._hasLocalGroupCounters(m)&&(h=this._getLocalGroupCounters(m),a=h.counters,s=h.avChatRoomKey,h=h.groupCounterSeq,0<T&&T<h||(I.forEach(function($){var V=$.key,$=$.value;a.set(V,$)}),this._groupCountersMap.set(m,{lastUpdateTime:Date.now(),groupCounterSeq:T,counters:a,avChatRoomKey:s})))}},{key:"_deleteLocalGroupCounters",value:function(I){var a,s,h=I.groupID,m=I.counterList,m=m===void 0?[]:m,I=I.groupCounterSeq;this._hasLocalGroupCounters(h)&&(s=this._getLocalGroupCounters(h),a=s.counters,s=s.avChatRoomKey,m.forEach(function(T){a.delete(T.key)}),this._groupCountersMap.set(h,{lastUpdateTime:Date.now(),groupCounterSeq:I,counters:a,avChatRoomKey:s}))}},{key:"_getLocalCounters",value:function(n,a){var s={};if(this._hasLocalGroupCounters(n)){var h=this._getLocalGroupCounters(n).counters;if(0<a.length)a.forEach(function(D){h.has(D)&&(s[D]=h.get(D))});else{var m,I=v(h.keys());try{for(I.s();!(m=I.n()).done;){var T=m.value;s[T]=h.get(T)}}catch(D){I.e(D)}finally{I.f()}}}return s}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),LI=p(function n(T){u(this,n);var s=T.manager,h=T.groupID,m=T.onInit,I=T.onSuccess,T=T.onFail;this._n="Polling",this._manager=s,this._grpM=s._grpM,this._onInit=m,this._onSuccess=I,this._onFail=T,this._groupID=h,this._timeoutID=-1,this._isRunning=!1,this._proto=de.AV_POLLING},[{key:"start",value:function(){var n=this._grpM.isLoggedIn();n||(this._proto=de.AV_NOAUTH_POLLING),K.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(n)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var n=this,a=this._onInit(this._groupID);this._grpM.req({P:this._proto,data:a}).then(function(s){n._onSuccess(n._groupID,s),n.isRunning()&&(-1<n._timeoutID&&clearTimeout(n._timeoutID),n._timeoutID=setTimeout(n._request.bind(n),n._manager.getPollingInterval()))}).catch(function(s){n._onFail(n._groupID,s),n.isRunning()&&(-1<n._timeoutID&&clearTimeout(n._timeoutID),n._timeoutID=setTimeout(n._request.bind(n),n._manager.MAX_POLLING_INTERVAL))})}},{key:"stop",value:function(){K.l("".concat(this._n,".stop")),-1<this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),kh={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0,100:!0},p1=p(function n(a){u(this,n),this._grpM=a,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this._seqSll=new Mh(200),this._IDSll=new Mh(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0},[{key:"hasJoinedAVChatRoom",value:function(){var n=[];return 0<(n=0<this._joinedGroupMap.size?P(this._joinedGroupMap.values()).filter(function(a){return a.type===O.GRP_AVCHATROOM}):n).length}},{key:"getJoinedLiveList",value:function(){var n=[];return n=0<this._joinedGroupMap.size?P(this._joinedGroupMap.values()).filter(function(a){return a.type===O.GRP_LIVE}):n}},{key:"checkJoinedAVChatRoomByID",value:function(n){return this._joinedGroupMap.has(n)}},{key:"getJoinedAVChatRoom",value:function(){return 0<this._joinedGroupMap.size?P(this._joinedGroupMap.keys()):[]}},{key:"_updatedata",value:function(n){var a=this._pollingRequestInfoMap.get(n);return n===P(this._pollingInstanceMap.keys())[0]?E(E({},a),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):E(E({},a),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(n,a){var s,V=a.data,h=V.key,m=V.nextSeq,I=V.rspMsgList,T=V.errorCode,D=V.nextBroadcastSeq,V=V.broadcastMessageList;T!==0?(T=this._pollingRequestInfoMap.get(n),s=new ct("longPollingAVError"),T=T?"".concat(T.key,"-").concat(T.startSeq):"requestInfo is undefined",s.setMessage("".concat(n,"-").concat(T,"-").concat(a.errorInfo)).setCode(a.errorCode).end(!0)):this.checkJoinedAVChatRoomByID(n)&&(_n(h)&&It(m)&&this._pollingRequestInfoMap.set(n,{key:h,startSeq:m}),It(D)&&D>this._startBroadcastSeq&&(this._startBroadcastSeq=D),wt(I)&&0<I.length?(I.forEach(function($){$.to=$.groupID}),this.onMessage(I,n)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(V))}},{key:"_handleFailure",value:function(n,a){}},{key:"onMessage",value:function(n,a){if(wt(n)&&n.length!==0){var s="".concat(this._n,".onMessage"),h=(a&&(s+=" groupID:".concat(a)),this._pollingNoMessageCount!==0&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL),null),m=[],I=this._get(11),T=this._get(26),D=n.length,V=(1<D&&n.sort(function(He,Xe){return He.sequence-Xe.sequence}),this._get(12).isUnlimitedAVChatRoom()),$=!1;K.getLevel()<=0&&(a=n.map(function(He){return He.sequence}),K.l("".concat(s," count:").concat(a.length," sequenceList:").concat(a)),a.length=0);for(var q=0;q<D;q++){var se=this.restoreMessageFromSimplified(n[q]);if(kh[se.event]){if(se.event===6&&(this._grpM.isGroupAttributesUpdatedNotice(se)||this._grpM.isGroupCountersNotice(se)))continue;if(se.event!==20)if(se.event!==21)if(se.event!==100){var h=this.packMessage(se,se.event),me=se.isModified===1,$=se.isHistoryMessage===1;if(!V){if(this._seqSll.has(h.sequence))continue;this._seqSll.set(h.sequence)}var fe=this._IDSll.has(h.ID);fe?K.w("".concat(s," ID:").concat(h.ID," has:").concat(fe)):(this._IDSll.set(h.ID),fe=!1,!$&&this._isMessageSentByCurrentInstance(h)?me&&(fe=!0,h.isModified=me,I.updateMsgIsModifiedProp(h)):fe=!0,fe&&(h.conversationType===O.CONV_SYSTEM&&h.payload.operationType===5&&this._onGroupDismissed(h.payload.groupProfile.groupID),$||h.conversationType===O.CONV_SYSTEM||(me=h.conversationID.replace(O.CONV_GROUP,""),this._pollingInstanceMap.has(me)?this._grpM.isLoggedIn()&&T.addMessageSequence({key:ss,message:h}):(h.type!==O.MSG_GRP_TIP&&0<h.clientTime&&T.addMessageDelay(h.clientTime),T.addMessageSequence({key:Ih,message:h}))),m.push(h)))}else this.onRoomCustomData(se);else this._get(34).onMessageReactionNotify({event:21,dataList:se.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(se)}else K.w("".concat(s,". unknown event:").concat(se.event))}m.length!==0&&(0<(a=Cv(m)).length&&this._grpM.emitOEvt(W.MESSAGE_MODIFIED,a),$||0<(a=this.packConversationOption(m)).length&&I.onNewMessage({conversationOptionsList:a,isInstantMessage:!0}),this._checkMessageStacked(m),0<(a=Sv(m)).length&&this._grpM.emitOEvt(W.MESSAGE_RECEIVED,a),m.length=0)}}},{key:"handleMessageRevokedNotice",value:function(n){var a=this,s=n.groupID,h=n.elements.revokeMsgList,m=n.revokerInfo,I=[];h.forEach(function($){var q=$.tinyID,D=$.clientTime,V=$.random,$=$.sequence,q={conversationID:"".concat(O.CONV_GROUP).concat(s),ID:"".concat(q,"-").concat(D,"-").concat(V),revoker:m.revoker,revokeReason:m.reason||"",revokerInfo:{userID:m.revoker,nick:"",avatar:""},sequence:$};I.push(q)}),I.length!==0&&this._get(11).updateRevokerInfo(I).then(function(T){a._grpM.emitOEvt(W.MESSAGE_REVOKED,T)})}},{key:"isBroadcastOrNormal",value:function(n){return n===3||n===17}},{key:"isGroupTip",value:function(n){return n===4||n===6}},{key:"isGroupSystemNotice",value:function(n){return n===5}},{key:"restoreGroupTipElements",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},m=n.operatorInfo,m=m===void 0?{}:m,I=n.operatorID,a=n.userIDList,a=a===void 0?[]:a,s=n.operationType,s=(It(n.groupJoinType)||s!==1&&s!==2||(n.groupJoinType=s===2?0:1),m.userID),h=m.avatar,m=m.nick,I=(n.operatorInfo={userID:s===void 0?I:s,avatar:h===void 0?"":h,nick:m===void 0?"":m},a.map(function(T){return{userID:T}}));return n.memberInfoList=n.memberInfoList||I,n}},{key:"restoreMessageFromSimplified",value:function(n){var a,s,h,m=n.event;return this.isBroadcastOrNormal(m)&&(n.cloudCustomData=n.cloudCustomData||"",n.elements=n.elements.map(function(I){var T;return I.type===O.MSG_CUSTOM&&(T=I.content,I.content=E({data:"",description:"",extension:""},T===void 0?{}:T)),I})),(this.isGroupTip(m)||this.isGroupSystemNotice(m))&&(n.from=n.from||"@TIM#SYSTEM"),this.isGroupTip(m)&&(n.elements=this.restoreGroupTipElements(n.elements),s=(h=(h=n.elements)===void 0?{}:h).operationType,a=h.operatorInfo,s===1)&&(s=[{userID:(a===void 0?{}:a).userID}],h.memberInfoList=h.memberInfoList||s),this.isGroupSystemNotice(m)&&(h=(a=n.elements).memberInfoList,s=a.operatorInfo,n.elements.memberInfoList=E({userID:n.elements.operatorID,avatar:"",nick:""},h=h||(s===void 0?{}:s)),n.elements=E({authentication:"",remarkInfo:"",messageKey:1e3*n.time},n.elements),m=Object.keys(n.elements).filter(function(I){return I!=="operatorInfo"}).reduce(function(I,T){return E(E({},I),{},_({},T,n.elements[T]))},{}),n.elements=m),n}},{key:"_onGroupDismissed",value:function(n){K.l("".concat(this._n,"._onGroupDismissed groupID:").concat(n)),this._grpM.deleteLocalGroupAndConversation(n),this.reset(n)}},{key:"_checkMessageStacked",value:function(s){var a="MessageStacked",s=s.length;100<=s&&(this._grpM.warn(a,s),this._reportMessageStackedCount<5)&&(new ct(a).setMessage("count:".concat(s," groupID:").concat(P(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1)}},{key:"_isMessageSentByCurrentInstance",value:function(n){return!!this._get(11).isMessageSentByCurrentInstance(n)}},{key:"packMessage",value:function(h,m){h.currentUser=this._grpM.getMyUserID(),h.conversationType=m===5?O.CONV_SYSTEM:O.CONV_GROUP,h.isSystemMessage=!!h.isSystemMessage;var s=new _r(h),h=this.packElements(h,m),m=this._grpM.getFileDownloadProxy(),I=this._grpM.getDownloadFileAuthKey(),T=this._get(17).getFileDNList();return s.setElement(h,m,I,T),s}},{key:"packElements",value:function(n,a){return a===4||a===6?(this._updateMemberCountByGroupTips(n),{type:O.MSG_GRP_TIP,content:E(E({},n.elements),{},{groupProfile:n.groupProfile})}):a===5?{type:O.MSG_GRP_SYS_NOTICE,content:E(E({},n.elements),{},{groupProfile:E(E({},n.groupProfile),{},{groupID:n.groupID})})}:n.elements}},{key:"packConversationOption",value:function(n){for(var a=new Map,s=0;s<n.length;s++){var h,m=n[s],I=m.conversationID;a.has(I)?((h=a.get(I)).lastMessage=m).flow==="in"&&h.unreadCount++:a.set(I,{conversationID:m.conversationID,unreadCount:m.flow==="out"?0:1,type:m.conversationType,subType:m.conversationSubType,lastMessage:m})}return P(a.values())}},{key:"_updateMemberCountByGroupTips",value:function(I){var a,s,h,m=I.groupProfile.groupID,I=I.elements.onlineMemberInfo,I=I===void 0?void 0:I;Tt(I)||(a=(a=I.onlineMemberNum)===void 0?0:a,I=(I=I.expireTime)===void 0?this.DEFAULT_EXPIRE_TIME:I,s=this._onlineMemberCountMap.get(m)||{},h=Date.now(),Tt(s)?Object.assign(s,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:h,memberCount:a,expireTime:I}):(s.latestUpdateTime=h,s.memberCount=a),this._onlineMemberCountMap.set(m,s))}},{key:"_onBroadcastMessage",value:function(n){if(!Tt(n)){for(var a=[],s=n.length,h=null,m=0;m<s;m++){var I=this.restoreMessageFromSimplified(n[m]);kh[I.event]?((h=this.packMessage(I,I.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(h.ID)||(a.push(h),this._broadcastMessageIDMap.set(h.ID,1))):K.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(I.event))}0<a.length&&this._grpM.emitOEvt(W.MESSAGE_RECEIVED,a)}}},{key:"start",value:function(n){var a;this._pollingInstanceMap.has(n)?(a=this._pollingInstanceMap.get(n)).isRunning()||a.start():((a=new LI({manager:this,groupID:n,onInit:this._updatedata.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)})).start(),this._pollingInstanceMap.set(n,a),K.l("".concat(this._n,".start groupID:").concat(n)))}},{key:"handleJoinResult",value:function(n){var a=this;return this._preCheck(n.group).then(function(){var s=n.longPollingKey,h=n.group,m=h.groupID;return a._joinedGroupMap.set(m,h),a._grpM.updateGroupMap([h]),a._grpM.deleteUnjoinedAVChatRoom(m),a._grpM.emitGroupListUpdate(!0,!1),et(s)?ln({status:Ui,group:h}):Promise.resolve()})}},{key:"startRunLoop",value:function(n){var a=this;return this.handleJoinResult(n).then(function(){var s=n.longPollingKey,h=n.group,m=n.startSeq,I=h.groupID;return a._pollingRequestInfoMap.set(I,{key:s,startSeq:m===void 0?0:m}),a.start(I),a._grpM.isLoggedIn()?ln({status:Ui,group:h}):ln({status:Ui})})}},{key:"_preCheck",value:function(n){if(!this._get(12).isUnlimitedAVChatRoom()&&this.hasJoinedAVChatRoom()&&n.type!==O.GRP_LIVE){var n=x(this._joinedGroupMap.entries().next().value,2),a=n[0],n=n[1];if(this._grpM.isLoggedIn()&&n.selfInfo.role!==O.GRP_MBR_ROLE_OWNER&&n.ownerID!==this._grpM.getMyUserID())return this._grpM.quitGroup(a);this._grpM.deleteLocalGroupAndConversation(a),this.reset(a)}return Promise.resolve()}},{key:"joinWithoutAuth",value:function(n){var a=this,s=n.groupID,h="".concat(this._n,".").concat("joinWithoutAuth"),m=new ct("joinWithoutAuth");return this._grpM.req({P:de.APPLY_JOIN_GRP_NOAUTH,data:n}).then(function(I){if(I=I.data.longPollingKey,m.setMessage("groupID:".concat(s," longPollingKey:").concat(I)).end(!0),et(I))return De({code:Je.CANNOT_JOIN_NON_AV_WITHOUT_LOGIN});K.l("".concat(h," ok. groupID:").concat(s)),a._get(11).setCompleted("".concat(O.CONV_GROUP).concat(s));var T=new fa({groupID:s});return a.startRunLoop({group:T,longPollingKey:I}),Kt({status:Ui})}).catch(function(I){return K.e("".concat(h," failed. groupID:").concat(s," error:"),I),m.setError(I).setMessage("groupID:".concat(s)).end(!0),De(I)}).finally(function(){a._grpM.get(14).reportAtOnce()})}},{key:"getGroupOnlineMemberCount",value:function(n){var a=this._onlineMemberCountMap.get(n)||{},s=Date.now();return Tt(a)||s-a.lastSyncTime>1e3*a.expireTime&&1e4<s-a.latestUpdateTime&&3e3<s-a.lastReqTime?(a.lastReqTime=s,this._onlineMemberCountMap.set(n,a),this._getGroupOnlineMemberCount(n).then(function(h){return Kt({memberCount:h.memberCount})}).catch(function(h){return De(h)})):ln({memberCount:a.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(n){var a=this,s="".concat(this._n,".").concat("_getGroupOnlineMemberCount"),h=new ct("_getGroupOnlineMemberCount");return this._grpM.requestOnlineCount(n).then(function(D){var I=a._onlineMemberCountMap.get(n)||{},D=D.data,T=D.memberCount,T=T===void 0?0:T,D=D.expireTime,D=D===void 0?a.DEFAULT_EXPIRE_TIME:D,V=(K.l("".concat(s," ok. groupID:").concat(n," memberCount:").concat(T," expireTime:").concat(D)),Date.now());return Tt(I)&&(I.lastReqTime=V),a._onlineMemberCountMap.set(n,Object.assign(I,{lastSyncTime:V,latestUpdateTime:V,memberCount:T,expireTime:D})),{memberCount:T}}).catch(function(m){return K.w("".concat(s," failed. error:"),m),h.setCode(m.code).setMessage("groupID:".concat(n," error:").concat(JSON.stringify(m))).end(),Promise.reject(m)})}},{key:"_get",value:function(n){return this._grpM.get(n)}},{key:"setPollingInterval",value:function(n){et(n)||(It(n)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=n:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(n,10))}},{key:"setPollingIntervalPlus",value:function(n){et(n)||(It(n)?this.DEFAULT_POLLING_INTERVAL_PLUS=n:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(n,10))}},{key:"setPollingNoMessageCount",value:function(n){et(n)||(It(n)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=n:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(n,10))}},{key:"setPollingSimplifiedMessage",value:function(n){et(n)||n!=="0"&&n!=="1"||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(n,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(n){n=n.payload.groupProfile.groupID,K.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(n)),this._grpM.deleteLocalGroupAndConversation(n),this.reset(n)}},{key:"restartPolling",value:function(){K.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var n,a=v(this._pollingInstanceMap.values());try{for(a.s();!(n=a.n()).done;){var s=n.value;s.stop(),s.start()}}catch(h){a.e(h)}finally{a.f()}}},{key:"getPollingTimerID",value:function(n){var a;return this._pollingInstanceMap.has(n)?(a=this._pollingInstanceMap.get(n).getPollingTimerID(),K.l("".concat(this._n,".getPollingTimerID groupID:").concat(n," timerID:").concat(a)),a):-1}},{key:"hasPollingInstance",value:function(n){return this._pollingInstanceMap.has(n)}},{key:"onRoomCustomData",value:function(m){var a=m.groupID,s=m.sequence,h=m.time,m=m.elements,m=m&&m.content;this._get(30).onRoomCustomDataReceived(m),K.l("".concat(this._n,".onRoomCustomData groupID:").concat(a," sequence:").concat(s," time:").concat(h," data:").concat(m))}},{key:"reset",value:function(n){if(n){K.l("".concat(this._n,".reset groupID:").concat(n));var a=this._pollingInstanceMap.get(n);a&&a.stop(),this._pollingInstanceMap.delete(n),this._joinedGroupMap.delete(n),this._pollingRequestInfoMap.delete(n),this._onlineMemberCountMap.delete(n)}else{K.l("".concat(this._n,".reset all"));var s,h=v(this._pollingInstanceMap.values());try{for(h.s();!(s=h.n()).done;)s.value.stop()}catch(m){h.e(m)}finally{h.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this._seqSll.reset(),this._IDSll.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),m1=p(function n(a){u(this,n),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline=!1,this.updateMember(a)},[{key:"updateMember",value:function(n){et(n.onlineStatus)||(this.isOnline=n.onlineStatus==="Online");var a=[null,void 0,"",0,NaN];n.memberCustomField&&vu(this.memberCustomField,n.memberCustomField),ei(this,n,["memberCustomField","marks","onlineStatus"],a)}},{key:"updateRole",value:function(n){["Owner","Admin","Member"].indexOf(n)<0||(this.role=n)}},{key:"updateMuteUntil",value:function(n){et(n)||(this.muteUntil=Math.floor((Date.now()+1e3*n)/1e3))}},{key:"updateNameCard",value:function(n){et(n)||(this.nameCard=n)}},{key:"updateMemberCustomField",value:function(n){n&&vu(this.memberCustomField,n)}}]),g1=p(function n(a){u(this,n),this._grpM=a,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._grpM.getIEmitInst().on(So.PROFILE_UPDATED,this._onProfileUpdated,this)},[{key:"_onProfileUpdated",value:function(n){for(var a=this,s=n.data,h=0;h<s.length;h++)(function(){var m=s[h];a.groupMemberListMap.forEach(function(I){I.has(m.userID)&&I.get(m.userID).updateMember({nick:m.nick,avatar:m.avatar})})})()}},{key:"deleteGroupMemberList",value:function(n){this.groupMemberListMap.delete(n)}},{key:"getGroupMemberList",value:function(D){var a,s=this,h=D.groupID,m=D.role,m=m===void 0?void 0:m,se=D.offset,I=se===void 0?0:se,se=D.count,T=se===void 0?15:se,se=D.filter,D=se===void 0?void 0:se,V="".concat(this._n,".").concat("getGroupMemberList"),se=this._grpM.hasLocalGroup(h);if(K.l("".concat(V," groupID:").concat(h," role:").concat(m," offset:").concat(I," count:").concat(T," hasLocalGroup:").concat(se)),!se)return ln({memberList:[],offset:0});if(this._grpM.getLocalGroupProfile(h).type===O.GRP_AVCHATROOM){if(this._grpM.canIUse(ye.AV_MBR_LIST))return this._getAVChatRoomMemberList({groupID:h,offset:I,filter:D});this._grpM.warn("LiveOnlineMember")}m!==O.GRP_MBR_ROLE_ADMIN&&m!==O.GRP_MBR_ROLE_OWNER&&m!==O.GRP_MBR_ROLE_MEMBER||(a=m);var $=new ct("getGroupMemberList"),q=0,se={groupID:h,limit:100<T?100:T,memberRoleFilter:a?[a]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER},me=(Yr({groupID:h})?se.next="".concat(I):q=(se.offset=I)+T,[]);return this._grpM.req({P:de.GET_GRP_MBR_LIST,data:se}).then(function(Ye){var Ye=Ye.data,He=Ye.members,Xe=Ye.memberNum,Ye=Ye.next,Ye=Ye===void 0?void 0:Ye;return et(Ye)||(q=Tt(Ye)?0:Ye),wt(He)&&He.length!==0?(s._grpM.hasLocalGroup(h)&&(s._grpM.getLocalGroupProfile(h).memberNum=Xe),me=s._updateLocalGroupMemberMap(h,He),s._grpM.get(4).getUserProfile({userIDList:He.map(function(Lt){return Lt.userID}),tagList:[Gt.NICK,Gt.AVATAR]})):(q=0,Promise.resolve([]))}).then(function(He){var He=He.data;return wt(He)&&He.length!==0?(He=He.map(function(Xe){return{userID:Xe.userID,nick:Xe.nick,avatar:Xe.avatar}}),s._updateLocalGroupMemberMap(h,He),me.length<T&&(q=0),$.setMessage("groupID:".concat(h," offset:").concat(I," count:").concat(T)).end(),K.l("".concat(V," ok.")),Kt({memberList:me,offset:q})):ln({memberList:[],offset:q})}).catch(function(fe){return $.setError(fe).end(),K.e("".concat(V," failed. error:"),fe),De(fe)})}},{key:"_getAVChatRoomMemberList",value:function(m){var a=this,s=m.groupID,h=m.offset,m=m.filter,I="".concat(this._n,".").concat("_getAVChatRoomMemberList"),T=new ct("_getAVChatRoomMemberList");return T.setMessage("groupID:".concat(s," offset:").concat(h," filter:").concat(m)),this._grpM.req({P:de.GET_AV_MBR_LIST,data:{groupID:s,offset:h,filter:m}}).then(function(V){var V=V.data,$=V.memberList,$=$===void 0?[]:$,V=V.offset,V=V===void 0?0:V,$=(T.end(),K.l("".concat(I," ok. member count:").concat($.length,", next request timestamp:").concat(V)),$.map(function(q){return E(E({},q),{},{onlineStatus:"Online"})})),$=a._updateLocalGroupMemberMap(s,$);return Kt({memberList:$,offset:V})}).catch(function(D){return T.setError(D).end(),K.e("".concat(I," failed. error:"),D),De(D)})}},{key:"getGroupMemberProfile",value:function(n){var a,s=this,h="getGroupMemberProfile",D="".concat(this._n,".").concat(h),m="groupID:".concat(n.groupID),I=(5<n.userIDList.length?m+=" userIDList.length:".concat(n.userIDList.length):m+=" userIDList:".concat(n.userIDList),K.l("".concat(D," ").concat(m)),50<n.userIDList.length&&(n.userIDList=n.userIDList.slice(0,50)),n.groupID),T=n.userIDList,D=this._grpM.getLocalGroupProfile(I);return D&&jr(D.type)?De({code:D=Je.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(D,h)}):((a=new ct(h)).setMessage(m),this._getGroupMemberProfileAdvance(E(E({},n),{},{userIDList:T})).then(function(V){return V=V.data.members,wt(V)&&V.length!==0?(s._updateLocalGroupMemberMap(I,V),s._grpM.get(4).getUserProfile({userIDList:V.map(function($){return $.userID}),tagList:[Gt.NICK,Gt.AVATAR]})):ln([])}).then(function(V){return V=V.data.map(function($){return{userID:$.userID,nick:$.nick,avatar:$.avatar}}),s._updateLocalGroupMemberMap(I,V),V=T.filter(function($){return s.hasLocalGroupMember(I,$)}).map(function($){return s.getLocalGroupMemberInfo(I,$)}),a.end(),Kt({memberList:V})}))}},{key:"addGroupMember",value:function(n){var a=this,s="".concat(this._n,".").concat("addGroupMember"),h=n.groupID,m=this._grpM.getLocalGroupProfile(h),I=m.type,T=new ct("addGroupMember");return T.setMessage("groupID:".concat(h," groupType:").concat(I)),jr(I)?(I=new po({code:Je.CANNOT_ADD_MEMBER_IN_AV}),T.setError(I).end(),De(I)):(n.userIDList=n.userIDList.map(function(D){return{userID:D}}),K.l("".concat(s," groupID:").concat(h)),this._grpM.req({P:de.ADD_GRP_MBR,data:n}).then(function(se){var se=se.data.members,V=(K.l("".concat(s," ok")),se.filter(function(fe){return fe.result===1}).map(function(fe){return fe.userID})),$=se.filter(function(fe){return fe.result===0}).map(function(fe){return fe.userID}),q=se.filter(function(fe){return fe.result===2}).map(function(fe){return fe.userID}),se=se.filter(function(fe){return fe.result===4}).map(function(fe){return fe.userID}),me="groupID:".concat(n.groupID,", ")+"successUserIDList:".concat(V,", ")+"failureUserIDList:".concat($,", ")+"existedUserIDList:".concat(q,", ")+"overLimitUserIDList:".concat(se);return T.setMoreMessage(me).end(),V.length===0?Kt({successUserIDList:V,failureUserIDList:$,existedUserIDList:q,overLimitUserIDList:se}):(a._updateConvGroupProfile(m),Kt({successUserIDList:V,failureUserIDList:$,existedUserIDList:q,overLimitUserIDList:se,group:m}))}).catch(function(D){return T.setError(D).end(),K.e("".concat(s," failed. error:"),D),De(D)}))}},{key:"deleteGroupMember",value:function(n){var a,s,h=this,m="".concat(this._n,".").concat("deleteGroupMember"),I=n.groupID,T=n.userIDList,D=this._grpM.getLocalGroupProfile(I);return et(D)?De({code:Je.CANNOT_FIND_GRP}):jr(D.type)?this._grpM.canIUse(ye.AV_BAN_MBR)?this._banAVChatRoomMember(n):this._grpM.noUse("deleteGroupMember"):(a="groupID:".concat(I," ").concat(5<T.length?"userIDList.length:".concat(T.length):"userIDList:".concat(T)),K.l("".concat(m," groupID:").concat(I," userIDList:"),T),(s=new ct("deleteGroupMember")).setMessage(a),this._grpM.req({P:de.DEL_GRP_MBR,data:n}).then(function(){return s.end(),K.l("".concat(m," ok")),h._updateConvGroupProfile(D),h.deleteLocalGroupMembers(I,T),Kt({group:D,userIDList:T})}).catch(function(V){return s.setError(V).end(),K.e("".concat(m," failed. error:"),V),De(V)}))}},{key:"_updateConvGroupProfile",value:function(n){this._grpM.get(11).updateConvGroupProfile([n])}},{key:"_banAVChatRoomMember",value:function(n){var a=this,s="".concat(this._n,".").concat("_banAVChatRoomMember"),h=n.groupID,m=n.userIDList,I="groupID:".concat(h," ").concat(5<m.length?"userIDList.length:".concat(m.length):"userIDList:".concat(m)),T=new ct("_banAVChatRoomMember"),D=(T.setMessage(I),K.l("".concat(s," groupID:").concat(h," userIDList:"),m),this._grpM.getLocalGroupProfile(h));return et(n.duration)||n.duration===0?De({code:Je.BAN_DURATION_INVALID}):this._grpM.req({P:de.BAN_AV_MBR,data:n}).then(function(){return T.end(),K.l("".concat(s," ok")),a.deleteLocalGroupMembers(h,m),Kt({group:D,userIDList:m})}).catch(function(V){return T.setError(V).end(),K.e("".concat(s," failed. error:"),V),De(V)})}},{key:"setGroupMemberMuteTime",value:function(T){var a,s,h=this,m=T.groupID,I=T.userID,T=T.muteTime,D="".concat(this._n,".").concat("setGroupMemberMuteTime");return I===this._grpM.getMyUserID()?De({code:Je.CANNOT_MUTE_SELF}):(a="groupID:".concat(m," userID:").concat(I," muteTime:").concat(T),K.l("".concat(D," ").concat(a)),(s=new ct("setGroupMemberMuteTime")).setMessage(a),this.modifyGroupMemberInfo({groupID:m,userID:I,muteTime:T}).then(function(V){s.end(),K.l("".concat(D," ok"));var $=h._grpM.getLocalGroupProfile(m);return Kt({group:$,member:V})}).catch(function(V){return s.setError(V).end(),K.e("".concat(D," failed. error:"),V),De(V)}))}},{key:"setGroupMemberRole",value:function(T){var a,s,h="".concat(this._n,".").concat("setGroupMemberRole"),m=T.groupID,I=T.userID,T=T.role,D="groupID:".concat(m," userID:").concat(I," role:").concat(T),V=this._grpM.getLocalGroupProfile(m);return V&&V.selfInfo.role!==O.GRP_MBR_ROLE_OWNER?De({code:Je.NOT_OWNER}):(a=[O.GRP_MBR_ROLE_ADMIN,O.GRP_MBR_ROLE_MEMBER],Yr({groupID:m})&&a.push(O.GRP_MBR_ROLE_CUSTOM),a.indexOf(T)<0?De({code:Je.INVALID_MEMBER_ROLE}):I===this._grpM.getMyUserID()?De({code:Je.CANNOT_SET_SELF_MEMBER_ROLE}):((s=new ct("setGroupMemberRole")).setMessage(D),K.l("".concat(h," ").concat(D)),this.modifyGroupMemberInfo({groupID:m,userID:I,role:T}).then(function($){return s.end(),K.l("".concat(h," ok")),Kt({group:V,member:$})}).catch(function($){return s.setError($).end(),K.e("".concat(h," failed. error:"),$),De($)})))}},{key:"_filterProfanity",value:function(n,a){var s,h=this._grpM.get(29);return!h||(s=(h=h.filterText(a[n],"group_member_profile")).isAllowedToSend,h=h.modifiedText,s===!0&&(a[n]=h,!0))}},{key:"setGroupMemberNameCard",value:function(n){var a,s,h,m,I,T=this,D="setGroupMemberNameCard",V="".concat(this._n,".").concat(D);return n.nameCard&&this._filterProfanity("nameCard",n)===!1?De({code:Je.PROFANITY_FOUND}):(a=n.groupID,m=n.userID,s=m===void 0?this._grpM.getMyUserID():m,h=n.nameCard,m="groupID:".concat(a," userID:").concat(s," nameCard:").concat(h),K.l("".concat(V," ").concat(m)),(n=this._grpM.getLocalGroupProfile(a))&&jr(n.type)?De({code:n=Je.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(n,D)}):((I=new ct(D)).setMessage(m),this.modifyGroupMemberInfo({groupID:a,userID:s,nameCard:h}).then(function($){K.l("".concat(V," ok")),I.end();var q=T._grpM.getLocalGroupProfile(a);return s===T._grpM.getMyUserID()&&q&&q.setSelfNameCard(h),Kt({group:q,member:$})}).catch(function($){return I.setError($).end(),K.e("".concat(V," failed. error:"),$),De($)})))}},{key:"setGroupMemberCustomField",value:function(D){var a,s=this,h="setGroupMemberCustomField",m="".concat(this._n,".").concat(h),I=D.groupID,T=D.userID,T=T===void 0?this._grpM.getMyUserID():T,D=D.memberCustomField,V="groupID:".concat(I," userID:").concat(T," memberCustomField:").concat(JSON.stringify(D)),$=(K.l("".concat(m," ").concat(V)),this._grpM.getLocalGroupProfile(I));return $&&jr($.type)?De({code:$=Je.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg($,h)}):((a=new ct(h)).setMessage(V),this.modifyGroupMemberInfo({groupID:I,userID:T,memberCustomField:D}).then(function(q){a.end(),K.l("".concat(m," ok"));var se=s._grpM.getLocalGroupProfile(I);return Kt({group:se,member:q})}).catch(function(q){return a.setError(q).end(),K.e("".concat(m," failed. error:"),q),De(q)}))}},{key:"modifyGroupMemberInfo",value:function(n){var a=this,s=n.groupID,h=n.userID,m=void 0;return vr(s)&&(s=pr(m=s)),this._grpM.req({P:de.MODIFY_GRP_MBR_INFO,data:E(E({},n),{},{groupID:s,topicID:m})}).then(function(){var I;return a.hasLocalGroupMember(s,h)?(I=a.getLocalGroupMemberInfo(s,h),et(n.muteTime)||I.updateMuteUntil(n.muteTime),et(n.role)||I.updateRole(n.role),et(n.nameCard)||I.updateNameCard(n.nameCard),et(n.memberCustomField)||I.updateMemberCustomField(n.memberCustomField),I):(I=a._grpM.getLocalGroupProfile(s))&&!jr(I.type)?a.getGroupMemberProfile({groupID:s,userIDList:[h]}).then(function(T){return x(T.data.memberList,1)[0]}):void 0})}},{key:"markGroupMemberList",value:function(I){var a="".concat(this._n,".").concat("markGroupMemberList"),s=I.groupID,h=I.markType,V=I.enableMark,I=I.userIDList,m=I===void 0?[]:I,I="groupID:".concat(s," markType:").concat(h," enableMark:").concat(V," userIDList count:").concat(m.length),T=(K.l("".concat(a," ").concat(I)),2),D=[],V=(V===!0&&(T=1),P(m)),$=(500<m.length&&(V=m.slice(0,500),K.w("".concat(a," ").concat(lc(500)))),V.forEach(function(q){D.push({userID:q,markType:[h]})}),V=null,new ct("markGroupMemberList"));return $.setMessage(I),this._grpM.req({P:de.MARK_AV_MBR_INFO,data:{groupID:s,operationType:T,memberList:D}}).then(function(fe){var fe=fe.data.memberList,fe=fe===void 0?[]:fe,se=[],me=[],fe=(fe.length===m.length?se.push.apply(se,P(m)):(fe.forEach(function(He){se.push(He.userID)}),m.forEach(function(He){se.includes(He)||me.push(He)})),"success count:".concat(se.length," fail count:").concat(me.length));return $.setMessage(fe).end(),K.l("".concat(a," ok. ").concat(fe)),Kt({successUserIDList:se,failureUserIDList:me})}).catch(function(q){return $.setError(q).end(),K.e("".concat(a," failed. error:"),q),De(q)})}},{key:"_getGroupMemberProfileAdvance",value:function(n){return this._grpM.req({P:de.GET_GRP_MBR_PROFILE,data:E(E({},n),{},{memberInfoFilter:n.memberInfoFilter||this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(n,a){var s=this;return wt(a)&&a.length!==0?a.map(function(h){return s.hasLocalGroupMember(n,h.userID)?s.getLocalGroupMemberInfo(n,h.userID).updateMember(h):s.setLocalGroupMember(n,new m1(h)),s.getLocalGroupMemberInfo(n,h.userID)}):[]}},{key:"deleteLocalGroupMembers",value:function(n,a){var s=this.groupMemberListMap.get(n);s&&a.forEach(function(h){s.delete(h)})}},{key:"getLocalGroupMemberInfo",value:function(n,a){return this.groupMemberListMap.has(n)?this.groupMemberListMap.get(n).get(a):null}},{key:"setLocalGroupMember",value:function(n,a){this.groupMemberListMap.has(n)?this.groupMemberListMap.get(n).set(a.userID,a):(a=new Map().set(a.userID,a),this.groupMemberListMap.set(n,a))}},{key:"getLocalGroupMemberList",value:function(n){return this.groupMemberListMap.get(n)}},{key:"hasLocalGroupMember",value:function(n,a){return this.groupMemberListMap.has(n)&&this.groupMemberListMap.get(n).has(a)}},{key:"hasLocalGroupMemberMap",value:function(n){return this.groupMemberListMap.has(n)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),v1=[17,18,20],_1=p(function n(a){u(this,n),this._grpM=a,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map},[{key:"onNewGroupSystemNotice",value:function(s){var m=s.dataList,a=s.isSyncingEnded,s=s.isInstantMessage,m=(K.d("".concat(this._n,".onReceiveSystemNotice count:").concat(m.length)),this._assembly({notifiesList:m,isInstantMessage:s})),h=m.eventDataList,m=m.result;0<h.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:h,isInstantMessage:s}),this._onReceivedGroupSystemNotice({result:m,isInstantMessage:s})),s?0<m.length&&this._grpM.emitOEvt(W.MESSAGE_RECEIVED,m):a===!0&&this._clearGroupSystemNotice()}},{key:"_assembly",value:function(n){for(var a=n.notifiesList,s=n.isInstantMessage,h=null,m=a.length,D=0,I=[],T={conversationID:O.CONV_SYSTEM,unreadCount:0,type:O.CONV_SYSTEM,subType:null,lastMessage:null},D=0;D<m;D++){var V=a[D],q=V.groupProfile,$=q.communityType,q=q.topicID,q=q===void 0?void 0:q,me=V.elements,se=me.topicIDList,se=se===void 0?void 0:se,me=me.operationType;if(!(($===void 0?0:$)!==2||Tt(q)&&Tt(se))){if(v1.includes(me)){this._handleTopicSystemNotice(V);continue}Tt(q)||(V.to=q)}V.elements.operationType!==15&&(V.currentUser=this._grpM.getMyUserID(),V.conversationType=O.CONV_SYSTEM,V.conversationID=O.CONV_SYSTEM,(h=new _r(V)).setElement({type:O.MSG_GRP_SYS_NOTICE,content:E(E({},V.elements),{},{groupProfile:E({},V.groupProfile)})}),h.isSystemMessage=!0,(h.sequence===1&&h.random===1||h.sequence===2&&h.random===2)&&(h.sequence=hn(),h.random=hn(),h.generateMessageID(),K.l("".concat(this._n,"._assembly regenerate ID:").concat(h.ID))),this._grpM.get(11).pushIntoNoticeResult(I,h))&&(s?T.unreadCount++:h.setIsRead(!0),T.subType=h.conversationSubType)}return T.lastMessage=I[I.length-1],{eventDataList:0<I.length?[T]:[],result:I}}},{key:"_clearGroupSystemNotice",value:function(){var n=this;this._getPendencyList().then(function(s){s.forEach(function(m){n.pendencyMap.set("".concat(m.from,"_").concat(m.groupID,"_").concat(m.to),m)});var s=n._grpM.get(11).getLocalMessageList(O.CONV_SYSTEM),h=[];s.forEach(function(m){var D=m.payload,I=D.operatorID,T=D.operationType,D=D.groupProfile;T===1&&(T="".concat(I,"_").concat(D.groupID,"_").concat(D.to),I=n.pendencyMap.get(T))&&It(I.handled)&&I.handled!==0&&h.push(m)}),n.deleteGroupSystemNotice({messageList:h})})}},{key:"deleteGroupSystemNotice",value:function(n){var a=this,s="".concat(this._n,".deleteGroupSystemNotice");return wt(n.messageList)&&n.messageList.length!==0?(K.l("".concat(s," ")+n.messageList.map(function(h){return h.ID})),this._grpM.req({P:de.DEL_GRP_SYSTEM_NOTICE,data:{messageListToDelete:n.messageList.map(function(h){return{from:O.CONV_SYSTEM,messageSeq:h.clientSequence,messageRandom:h.random}})}}).then(function(){K.l("".concat(s," ok"));var h=a._grpM.get(11);return n.messageList.forEach(function(m){h.deleteLocalMessage(m)}),Kt()}).catch(function(h){return K.e("".concat(s," error:"),h),De(h)})):ln()}},{key:"_getPendencyList",value:function(){var n=this,h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},a=h.type,s=h.startTime,h=h.limit;return this._grpM.req({P:de.GET_GRP_PENDENCY,data:{type:a===void 0?void 0:a,startTime:s===void 0?0:s,limit:h===void 0?20:h,handleAccount:this._grpM.getMyUserID()}}).then(function(m){var I=m.data.pendencyList;return m.data.nextStartTime!==0?n._getPendencyList({startTime:m.data.nextStartTime}).then(function(T){return[].concat(P(I),P(T))}):I})}},{key:"getGroupApplicationList",value:function(){var n=this;return this._getPendencyList().then(function(a){return n._getPendencyList({type:O.GRP_COMMUNITY}).then(function(s){return a.push.apply(a,P(s)),n._handlePendencyResult(a)}).catch(function(s){return n._handlePendencyResult(a)})})}},{key:"_handlePendencyResult",value:function(n){var a=this,s=[];return n.forEach(function(h){a.pendencyMap.set("".concat(h.from,"_").concat(h.groupID,"_").concat(h.to),h),h.handled===0&&s.push({applicant:h.from,applicantNick:h.fromUserNickName,groupName:h.groupName,groupID:h.groupID,authentication:h.authentication,messageKey:h.time,applicationType:h.applicationType,userID:h.userID,note:h.note})}),ln({applicationList:s})}},{key:"_onReceivedGroupSystemNotice",value:function(n){var a=this,s=n.result;n.isInstantMessage&&s.forEach(function(h){switch(h.payload.operationType){case 1:break;case 2:a._onApplyJoinGroup(h);break;case 3:break;case 4:a._onMemberKicked(h);break;case 5:a._onGroupDismissed(h);break;case 6:break;case 7:a._onInviteGroup(h);break;case 8:a._onQuitGroup(h);break;case 9:a._onSetManager(h);break;case 10:a._onDeleteManager(h);break;case 11:case 12:case 15:break;case 20:a._onMessageRemindTypeSynced(h);break;case 21:a._grpM.onAVChatRoomMemberBanned(h)}})}},{key:"_onApplyJoinGroup",value:function(h){var a=this,h=h.payload.groupProfile,s=h.groupID,h=h.groupType,m=this._grpM.hasLocalGroup(s);K.l("".concat(this._n,"._onApplyJoinGroup groupID:").concat(s," groupType:").concat(h," hasGroup:").concat(m)),m||jr(h)||this._grpM.getGroupProfile({groupID:s}).then(function(T){var T=T.data.group;T&&(a._grpM.updateGroupMap([T]),T=!T.isSupportTopic,a._grpM.emitGroupListUpdate(!0,T))})}},{key:"_onMemberKicked",value:function(n){n=n.payload.groupProfile.groupID,this._grpM.hasLocalGroup(n)&&this._grpM.deleteLocalGroupAndConversation(n)}},{key:"_onGroupDismissed",value:function(a){var a=a.payload.groupProfile.groupID,s=(this._grpM.hasLocalGroup(a)&&this._grpM.deleteLocalGroupAndConversation(a),this._grpM._AVChatRoomHandler);s&&s.checkJoinedAVChatRoomByID(a)&&s.reset(a)}},{key:"_onInviteGroup",value:function(h){var a=this,s=h.payload.groupProfile.groupID,h=this._grpM.hasLocalGroup(s);K.l("".concat(this._n,"._onInviteGroup groupID:").concat(s," hasGroup:").concat(h)),this._grpM.getGroupProfile({groupID:s}).then(function(){a._grpM.emitGroupListUpdate(),a._grpM.get(11).pullMsgOnInvite("".concat(O.CONV_GROUP).concat(s))})}},{key:"_onQuitGroup",value:function(s){var s=s.payload.groupProfile,a=s.groupID,s=s.groupType,h=this._grpM.hasLocalGroup(a);K.l("".concat(this._n,"._onQuitGroup groupID:").concat(a," groupType:").concat(s," hasGroup:").concat(h)),h&&this._grpM.deleteLocalGroupAndConversation(a)}},{key:"_onSetManager",value:function(s){var s=s.payload.groupProfile,a=s.to,s=s.groupID,s=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(s,a);s&&s.updateRole(O.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(s){var s=s.payload.groupProfile,a=s.to,s=s.groupID,s=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(s,a);s&&s.updateRole(O.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(s){var a=s.payload.groupProfile.groupID,s=s.payload.messageRemindType;this._grpM.get(11).onGroupMsgRemindTypeUpdated({groupID:a,messageRemindType:s})}},{key:"_handleTopicSystemNotice",value:function(I){var s=I.groupProfile,a=s.groupID,s=s.topicID,I=I.elements,h=I.operationType,m=I.topicIDList,I=I.messageRemindType,T=this._grpM.get(10);h===17?T.onTopicCreated({groupID:a,topicID:s}):h===18?T.onTopicDeleted({groupID:a,topicIDList:m}):h===20&&T.onMessageRemindTypeUpdated({groupID:a,topicID:s,messageRemindType:I})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),y1=["relayFlag"],I1=(S(Hp,$o),p(Hp,[{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("polling_interval"),a=this.getCloudConfig("polling_interval_plus"),s=this.getCloudConfig("polling_no_msg_count"),h=this.getCloudConfig("polling_simplified_msg"),m=this.getCloudConfig("paging_grp_count");K.l("".concat(this._n,"._onCloudConfig pollingInterval:").concat(n)+" pollingIntervalPlus:".concat(a," pollingNoMessageCount:").concat(s)+" pollingSimplifiedMessage:".concat(h," pagingGroupCount:").concat(m)),this._AVChatRoomHandler.setPollingInterval(n),this._AVChatRoomHandler.setPollingIntervalPlus(a),this._AVChatRoomHandler.setPollingNoMessageCount(s),this._AVChatRoomHandler.setPollingSimplifiedMessage(h),this._commonGroupHandler.setPagingGroupCount(m)}},{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(n),this._groupTipsHandler.onCheckTimer(n))}},{key:"guardForAVChatRoom",value:function(n){var a,s=this;return n.conversationType!==O.CONV_GROUP||(a=vr(n.to)?pr(n.to):n.to,this.hasLocalGroup(a))?ln():this.getGroupProfile({groupID:a}).then(function(m){var m=m.data.group.type;return K.l("".concat(s._n,".guardForAVChatRoom. groupID:").concat(a," type:").concat(m)),m===O.GRP_AVCHATROOM?De(new po({code:m=Je.MSG_SEND_FAIL_NOT_IN_AV,message:s.getErrMsg(m,n.from,a),data:{message:n}})):ln()})}},{key:"checkJoinedAVChatRoomByID",value:function(n){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n)}},{key:"onNewMessage",value:function(n){this._commonGroupHandler.onNewMessage(n)}},{key:"updateNextMessageSeq",value:function(n){var a,s=this;wt(n)&&(a=this.get(10),n.forEach(function(h){var m=h.conversationID.replace(O.CONV_GROUP,"");vr(m)&&a.updateUnreadCountAndLastMsg(m,h.lastMessage),s.groupMap.has(m)&&(s.groupMap.get(m).nextMessageSeq=h.lastMessage.sequence+1)}))}},{key:"onNewGroupTips",value:function(n){this._groupTipsHandler.onNewGroupTips(n)}},{key:"onMsgRevoked",value:function(n){this._commonGroupHandler.onMsgRevoked(n,!(1<arguments.length&&arguments[1]!==void 0)||arguments[1])}},{key:"onNewGroupSystemNotice",value:function(n){this._groupSystemNoticeHandler.onNewGroupSystemNotice(n)}},{key:"onMsgReadNotice",value:function(n){var a=this;n.dataList.forEach(function(m){var h,m=m.elements.groupMessageReadNotice;et(m)||(h=a.get(11),m.forEach(function(D){var V=D.groupID,T=D.topicID,T=T===void 0?void 0:T,D=D.lastMessageSeq,V=(K.l("".concat(a._n,".onMsgReadNotice groupID:").concat(V," lastMessageSeq:").concat(D)),"".concat(O.CONV_GROUP).concat(V)),$=!0;Tt(T)||(V="".concat(O.CONV_GROUP).concat(T),$=!1),h.updateIsReadAfterReadReport({conversationID:V,lastMessageSeq:D}),h.updateUnreadCount(V,$),h.clearGroupAtInfoList(V,$)}))})}},{key:"onReadReceiptList",value:function(n){var a=this;K.l("".concat(this._n,".onReadReceiptList options:"),n),n.dataList.forEach(function(I){var h=I.groupProfile,I=I.elements,h=h.groupID,m=a.get(11),I=I.readReceiptList;m.updateReadReceiptInfo({groupID:h,readReceiptList:I})})}},{key:"onMsgModified",value:function(n){K.l("".concat(this._n,".onMsgModified options:"),n);var a=this.get(11);n.dataList.forEach(function(s){a.onMessageModified(E(E({},s),{},{conversationType:O.CONV_GROUP,to:s.topicID||s.groupID}))})}},{key:"deleteGroupSystemNotice",value:function(n){this._groupSystemNoticeHandler.deleteGroupSystemNotice(n)}},{key:"initGroupMap",value:function(n){this.groupMap.set(n.groupID,new fa(n))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(n){this.groupMap.delete(n)}},{key:"updateGroupMap",value:function(n){var a,s=this,h=this.get(11);n.forEach(function(V){a=V.groupID,s.groupMap.has(a)?s.groupMap.get(a).updateGroup(V):(s.groupMap.set(a,new fa(V)),h.deleteGroupRoamingInfo(a))});var m,I=this.getMyUserID(),T=v(this.groupMap);try{for(T.s();!(m=T.n()).done;){var D=x(m.value,2)[1];D.selfInfo.userID=I,D.selfInfo.role==="Owner"&&(D.ownerID=I)}}catch(V){T.e(V)}finally{T.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return P(this.groupMap.values()).filter(function(n){return n.type!==O.GRP_ROOM&&n.type!==O.GRP_LIVE})}},{key:"getLocalGroupProfile",value:function(n){return this.groupMap.get(n)}},{key:"sortLocalGroupList",value:function(){var n=P(this.groupMap).filter(function(a){return a=x(a,2),a[0],!Tt(a[1].lastMessage)});n.sort(function(a,s){return s[1].lastMessage.lastTime-a[1].lastMessage.lastTime}),this.groupMap=new Map(P(n))}},{key:"updateGroupLastMessage",value:function(n){this._commonGroupHandler.updateLastMsg(n)}},{key:"emitGroupListUpdate",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],a=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=this.getLocalGroupList();n&&this.emitOEvt(W.GROUP_LIST_UPDATED),a&&(n=JSON.parse(JSON.stringify(s)),this.get(11).updateConvGroupProfile(n))}},{key:"getMyNameCardByGroupID",value:function(n){return n=this.getLocalGroupProfile(n),n?n.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMsgRemindType",value:function(n){var a=this;return!wt(n)||n.length===0||(n=n.filter(function(s){return!jr(a.getLocalGroupProfile(s).type)})).length===0?Promise.resolve():(K.l("".concat(this._n,".getMsgRemindType groupIDList:").concat(n)),this.getGroupProfileAdvance({groupIDList:n,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then(function(h){var h=h.data.successGroupList,m=a.get(11);h.forEach(function(I){m.onGroupMsgRemindTypeUpdated({groupID:I.groupID,messageRemindType:wt(I.members)?I.members[0].messageRemindType:""})})}))}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(n){var a=this,s="".concat(this._n,".").concat("getGroupProfile"),h=new ct("getGroupProfile"),m=n.groupID,I=n.groupCustomFieldFilter,I=(K.l("".concat(s," groupID:").concat(m)),{groupIDList:[m],responseFilter:{groupBaseInfoFilter:P(Ie),groupCustomFieldFilter:I,memberInfoFilter:[].concat(P(ve),["NameCard"])}});return this.getGroupProfileAdvance(I).then(function(V){var V=V.data,D=V.successGroupList,V=V.failureGroupList;return K.l("".concat(s," ok")),0<V.length?De(V[0]):((V=jr(D[0].type)&&!a.hasLocalGroup(m)?new fa(D[0]):(a.updateGroupMap(D),a.getLocalGroupProfile(m))).isSupportTopic||a.get(11).updateConvGroupProfile([V]),h.setMessage("groupID:".concat(m," type:").concat(V.type," muteAllMembers:").concat(V.muteAllMembers," ownerID:").concat(V.ownerID)).end(),Kt({group:V}))}).catch(function(T){return h.setError(T).setMessage("groupID:".concat(n.groupID)).end(),K.e("".concat(s," failed. error:"),T),De(T)})}},{key:"getGroupProfileAdvance",value:function(n){var a,s="".concat(this._n,".getGroupProfileAdvance"),I=n.groupIDList,h=(wt(I)&&50<I.length&&(this.warn("GetGroupProfileLimit"),I.length=50),[]),m=[],I=(I.forEach(function(T){(Yr({groupID:T})?m:h).push(T)}),[]);return 0<h.length&&(a=this._getGroupProfileAdvance(E(E({},n),{},{groupIDList:h})),I.push(a)),0<m.length&&(a=this._getGroupProfileAdvance(E(E({},n),{},{groupIDList:m,relayFlag:0<h.length})),I.push(a)),Promise.all(I).then(function(T){var D=[],V=[];return T.forEach(function($){D.push.apply(D,P($.successGroupList)),V.push.apply(V,P($.failureGroupList))}),Kt({successGroupList:D,failureGroupList:V})}).catch(function(T){return K.e("".concat(s," failed. error:"),T),De(T)})}},{key:"_getGroupProfileAdvance",value:function(n){var a=this,s=n.relayFlag,h=s!==void 0&&s,m=N(n,y1);return this.req({P:de.GET_GRP_PROFILE,data:m}).then(function(I){return K.l("".concat(a._n,"._getGroupProfileAdvance ok. options:"),m),I=I.data.groups,{successGroupList:I.filter(function(T){return et(T.errorCode)||T.errorCode===0}),failureGroupList:I.filter(function(T){return T.errorCode&&T.errorCode!==0}).map(function(T){return new po({code:T.errorCode,message:T.errorInfo,data:{groupID:T.groupID}})})}}).catch(function(I){return h&&Yr({groupID:n.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:De(I)})}},{key:"createGroup",value:function(n){var a=this,s=[O.GRP_PUBLIC,O.GRP_WORK,O.GRP_MEETING,O.GRP_AVCHATROOM,O.GRP_COMMUNITY],h="".concat(this._n,".").concat("createGroup"),m=n.type,I=n.groupID;if(n.name&&this._filterProfanity("name",n)===!1)return De({code:Je.PROFANITY_FOUND});if(n.introduction&&this._filterProfanity("introduction",n)===!1)return De({code:Je.PROFANITY_FOUND});if(n.notification&&this._filterProfanity("notification",n)===!1)return De({code:Je.PROFANITY_FOUND});if(!s.includes(m))return De({code:Je.ILLEGAL_GRP_TYPE});if(!Yr({type:m})){if(!Tt(I)&&Yr({groupID:I}))return De({code:Je.ILLEGAL_GRP_ID});n.isSupportTopic=void 0}if(jr(m)&&!et(n.memberList)&&0<n.memberList.length&&(n.memberList=void 0),this._canIUseJoinOption(m)||et(n.joinOption)||(n.joinOption=void 0),Yr({type:m})){if(!Tt(I)&&!Yr({groupID:I}))return De({code:Je.ILLEGAL_GRP_ID});n.isSupportTopic=n.isSupportTopic===!0?1:0}var T=new ct("createGroup"),D=(K.l("".concat(h," options:"),n),null),V=[];return this.req({P:de.CREATE_GRP,data:E(E({},n),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then(function(Xe){var q,se,me,Xe=Xe.data,fe=Xe.groupID,Xe=Xe.overLimitUserIDList,He=Xe===void 0?[]:Xe,Xe=(D=fe,V=He,"groupType:".concat(n.type," groupID:").concat(fe," overLimitUserIDList:").concat(He));return T.setMessage(Xe).end(),K.l("".concat(h," ok. ").concat(Xe)),n.type===O.GRP_AVCHATROOM||n.type===O.GRP_COMMUNITY&&n.isSupportTopic===1||(Tt(n.memberList)||Tt(He)||(n.memberList=n.memberList.filter(function(Ye){return He.indexOf(Ye.userID)===-1})),a.updateGroupMap([E(E({},n),{},{groupID:fe})]),Xe=a.get(2),me="",q=0,n.type===O.GRP_COMMUNITY?(me=a.isIntl()?"Create Community":"创建社群",q=1):me=a.isIntl()?"Create Group":"创建群组",se=a.get(4).getMyNick(),me=Xe.createCustomMessage({to:fe,conversationType:O.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:me,cmd:q,opUser:se||a.getMyUserID(),version:4})}}),Xe.sendMessageInstance(me),a.emitGroupListUpdate()),a.getGroupProfile({groupID:fe})}).then(function(q){var q=q.data.group,me=q.selfInfo,se=me.nameCard,me=me.joinTime;return q.updateSelfInfo({nameCard:se,joinTime:me,messageRemindType:O.MSG_REMIND_ACPT_AND_NOTE,role:O.GRP_MBR_ROLE_OWNER}),Kt({group:q,overLimitUserIDList:V})}).catch(function($){var q;return T.setMessage("groupType:".concat(n.type)).setError($).end(),$.code===10010||$.code===10007?(a._silentlyGetGroupProfile($.code,D),a.updateGroupMap([E(E({},n),{},{groupID:D})]),(q=a.getLocalGroupProfile(D)).selfInfo.role=O.GRP_MBR_ROLE_OWNER,Kt({group:q,overLimitUserIDList:V})):(K.e("".concat(h," failed. error:"),$),De($))})}},{key:"dismissGroup",value:function(n){var a=this,s="".concat(this._n,".").concat("dismissGroup"),h="groupID:".concat(n),m=new ct("dismissGroup");return m.setMessage(h),K.l("".concat(s," ").concat(h)),this.req({P:de.DISMISS_GRP,data:{groupID:n}}).then(function(){return m.end(),K.l("".concat(s," ok")),a.deleteLocalGroupAndConversation(n),a.checkJoinedAVChatRoomByID(n)&&a._AVChatRoomHandler.reset(n),a._groupAttributesHandler.deleteLocalGroupAttributes(n),Kt({groupID:n})}).catch(function(I){return m.setError(I).end(),K.e("".concat(s," failed. error:"),I),De(I)})}},{key:"updateGroupProfile",value:function(n){var a,s,h=this,m="".concat(this._n,".").concat("updateGroupProfile");return this.hasLocalGroup(n.groupID)&&(a=this.getLocalGroupProfile(n.groupID).type,this._canIUseJoinOption(a)||et(n.joinOption)||(K.w("".concat(m," joinOption is unavailable for Work/Meeting/AVChatRoom")),n.joinOption=void 0)),et(n.muteAllMembers)||(n.muteAllMembers?n.muteAllMembers="On":n.muteAllMembers="Off"),n.name&&this._filterProfanity("name",n)===!1||n.introduction&&this._filterProfanity("introduction",n)===!1||n.notification&&this._filterProfanity("notification",n)===!1?De({code:Je.PROFANITY_FOUND}):((s=new ct("updateGroupProfile")).setMessage(JSON.stringify(n)),K.l("".concat(m," groupID:").concat(n.groupID)),this.req({P:de.UPDATE_GRP_PROFILE,data:n}).then(function(){return s.end(),K.l("".concat(m," ok")),h.hasLocalGroup(n.groupID)&&h.groupMap.get(n.groupID).updateGroup(n),Kt({group:h.groupMap.get(n.groupID)})}).catch(function(I){return s.setError(I).end(),K.l("".concat(m," failed. error:"),I),De(I)}))}},{key:"_filterProfanity",value:function(n,a){var s,h=this.get(29);return!h||(s=(h=h.filterText(a[n],ue)).isAllowedToSend,h=h.modifiedText,s===!0&&(a[n]=h,!0))}},{key:"joinGroup",value:function(n){var a,s=this,h=n.groupID,m="".concat(this._n,".joinGroup");return this.deleteUnjoinedAVChatRoom(h),this.hasLocalGroup(h)?this.isLoggedIn()?(a=new ct("applyJoinGroup"),this.getGroupProfile({groupID:h}).then(function(){return a.setMessage("groupID:".concat(h," joinedStatus:").concat(O.JOIN_STATUS_ALREADY_IN_GROUP)).end(),ln({status:O.JOIN_STATUS_ALREADY_IN_GROUP})}).catch(function(I){return a.setMessage("groupID:".concat(h," unjoined")).end(),K.w("".concat(m," ").concat(h," was unjoined, now join!")),s.groupMap.delete(h),s.applyJoinGroup(n)})):ln({status:O.JOIN_STATUS_ALREADY_IN_GROUP}):(K.l("".concat(m," groupID:").concat(h)),this.isLoggedIn()?this.applyJoinGroup(n):this._AVChatRoomHandler.joinWithoutAuth(n))}},{key:"applyJoinGroup",value:function(n){var a,s,h=this,m="".concat(this._n,".").concat("applyJoinGroup"),I=n.groupID;return Tt(n.applyMessage)||this._filterProfanity("applyMessage",n)!==!1?(a=new ct("applyJoinGroup"),n=E({},n),(s=this.canIUse(ye.AV_HISTORY_MSG))&&(n.historyMessageFlag=1),this.get(11).deleteTopicRoamingInfo(I),this.req({P:de.APPLY_JOIN_GRP,data:n}).then(function(fe){var fe=fe.data,D=fe.joinedStatus,V=fe.longPollingKey,$=fe.startSeq,q=fe.avChatRoomFlag,se=fe.avChatRoomKey,me=fe.messageList,fe="groupID:".concat(I," joinedStatus:").concat(D," longPollingKey:").concat(V," startSeq:").concat($)+" avChatRoomFlag:".concat(q," canGetAVChatRoomHistoryMsg:").concat(s,",")+" historyMsgCount:".concat(Tt(me)?0:me.length);switch(a.setMessage(fe).end(),K.l("".concat(m," ok. ").concat(fe)),D){case ii:return Kt({status:ii});case Ui:return h.getGroupProfile({groupID:I}).then(function(Xe){return Xe=Xe.data.group,h._handleJoinResult({group:Xe,avChatRoomFlag:q,longPollingKey:V,startSeq:$,avChatRoomKey:se,messageList:me})}).catch(function(Xe){var Ye;return Xe.code===10010||Xe.code===10007?(h._silentlyGetGroupProfile(Xe.code,I),Ye=new fa({groupID:I}),h.updateGroupMap([Ye]),h._handleJoinResult({group:Ye,avChatRoomFlag:q,longPollingKey:V,startSeq:$,avChatRoomKey:se,messageList:me})):(K.e("".concat(m," failed. error:"),Xe),De(Xe))});default:var He=new po({code:Je.JOIN_GRP_FAIL});return K.e("".concat(m," failed. error:"),He),De(He)}}).catch(function(T){return a.setMessage("groupID:".concat(I)).setError(T).end(),K.e("".concat(m," failed. error:"),T),De(T)})):De({code:Je.PROFANITY_FOUND})}},{key:"_handleJoinResult",value:function(n){var a=this,s=n.group,h=n.avChatRoomFlag,m=n.longPollingKey,I=n.startSeq,T=n.avChatRoomKey,D=n.messageList,V=s.groupID;return h===1?(this.get(11).setCompleted("".concat(O.CONV_GROUP).concat(V)),this._groupAttributesHandler.initGroupAttributesCache({groupID:V,avChatRoomKey:T}),this._groupCountersHandler.initGroupCountersCache({groupID:V,avChatRoomKey:T}),(n=et(m)?this._AVChatRoomHandler.handleJoinResult({group:s}):this._AVChatRoomHandler.startRunLoop({group:s,longPollingKey:m,startSeq:I})).then(function(){a._onAVChatRoomHistoryMessage(D,V)}),n):(this.emitGroupListUpdate(!0,!1),Kt({status:Ui,group:s}))}},{key:"quitGroup",value:function(n){var a,s=this,h="".concat(this._n,".").concat("quitGroup"),m="groupID:".concat(n),I=(K.l("".concat(h," ").concat(m)),this.checkJoinedAVChatRoomByID(n));return I||this.hasLocalGroup(n)?I&&!this.isLoggedIn()?(K.l("".concat(h," anonymously ok. ").concat(m)),this.deleteLocalGroupAndConversation(n),this._AVChatRoomHandler.reset(n),ln({groupID:n})):((a=new ct("quitGroup")).setMessage(m),this.req({P:de.QUIT_GRP,data:{groupID:n}}).then(function(){return a.end(),K.l("".concat(h," ok")),s.deleteLocalGroupAndConversation(n),I&&s._AVChatRoomHandler.reset(n),s._groupAttributesHandler.deleteLocalGroupAttributes(n),Kt({groupID:n})}).catch(function(T){return a.setError(T).end(),K.e("".concat(h," failed. error:"),T),De(T)})):De({code:Je.MEMBER_NOT_IN_GRP})}},{key:"searchGroupByID",value:function(n){var a="".concat(this._n,".").concat("searchGroupByID"),s={groupIDList:[n]},h=new ct("searchGroupByID");return h.setMessage("groupID:".concat(n)),K.l("".concat(a," groupID:").concat(n)),this.req({P:de.SEARCH_GRP,data:s}).then(function(m){if(m=m.data.groupProfile,m[0].errorCode!==0)throw new po({code:m[0].errorCode,message:m[0].errorInfo});return h.end(),K.l("".concat(a," ok")),Kt({group:new fa(m[0])})}).catch(function(m){return h.setError(m).end(),K.w("".concat(a," failed. error:"),m),De(m)})}},{key:"changeGroupOwner",value:function(n){var a,s=this,h="".concat(this._n,".").concat("changeGroupOwner");return this.hasLocalGroup(n.groupID)&&this.getLocalGroupProfile(n.groupID).type===O.GRP_AVCHATROOM?De({code:Je.CANNOT_CHANGE_OWNER_IN_AV}):n.newOwnerID===this.getMyUserID()?De({code:Je.CANNOT_CHANGE_OWNER_TO_SELF}):((a=new ct("changeGroupOwner")).setMessage("groupID:".concat(n.groupID," newOwnerID:").concat(n.newOwnerID)),K.l("".concat(h," groupID:").concat(n.groupID)),this.req({P:de.CHANGE_GRP_OWNER,data:n}).then(function(){a.end(),K.l("".concat(h," ok"));var m,I=n.groupID,T=n.newOwnerID,D=(s.groupMap.get(I).ownerID=T,s._groupMemberHandler.getLocalGroupMemberList(I));return D instanceof Map&&(m=D.get(s.getMyUserID()),et(m)||(m.updateRole("Member"),s.groupMap.get(I).selfInfo.role="Member"),m=D.get(T),et(m)||m.updateRole("Owner")),s.emitGroupListUpdate(!0,!1),Kt({group:s.groupMap.get(I)})}).catch(function(m){return a.setError(m).end(),K.e("".concat(h," failed. error:"),m),De(m)}))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(n){var a,s,h,m,I,T=this,D="".concat(this._n,".").concat("handleGroupApplication"),V=n.handleAction,$=n.handleMessage,q=n.message,se=n.application,me=(q?(a=q.payload.operatorID,s=q.payload.groupProfile.groupID,h=q.payload.authentication,m=q.payload.messageKey):se&&(a=se.applicant,s=se.groupID,h=se.authentication,m=se.messageKey),de.HANDLE_GRP_APPLICATION),fe=(se&&se.applicationType===2&&(me=de.HANDLE_INVITE_JOIN_GRP,I=se.userID),new ct("handleGroupApplication"));return fe.setMessage("groupID:".concat(s)),K.l("".concat(D," groupID:").concat(s)),this.req({P:me,data:{handleAction:V,handleMessage:$,applicant:a,invitee:I,groupID:s,authentication:h,messageKey:m}}).then(function(){return fe.end(),K.l("".concat(D," ok")),q&&T._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[n.message]}),Kt({group:T.getLocalGroupProfile(s)})}).catch(function(He){return fe.setError(He).end(),K.e("".concat(D," failed. error"),He),De(He)})}},{key:"handleGroupInvitation",value:function(n){var a=this,s="".concat(this._n,".").concat("handleGroupInvitation"),T=n.message.payload,h=T.groupProfile.groupID,m=T.authentication,I=T.messageKey,T=T.operatorID,D=n.handleAction,V=new ct("handleGroupInvitation");return V.setMessage("groupID:".concat(h," inviter:").concat(T," handleAction:").concat(D)),K.l("".concat(s," groupID:").concat(h," inviter:").concat(T," handleAction:").concat(D)),this.req({P:de.HANDLE_GRP_INVITATION,data:E(E({},n),{},{inviter:T,groupID:h,authentication:m,messageKey:I})}).then(function(){return V.end(),K.l("".concat(s," ok")),a._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[n.message]}),Kt({group:a.getLocalGroupProfile(h)})}).catch(function($){return V.setError($).end(),K.e("".concat(s," failed. error"),$),De($)})}},{key:"getGroupOnlineMemberCount",value:function(n){var a=this,s="".concat(this._n,".getGroupOnlineMemberCount"),h=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n),m=this.hasLocalGroup(n);if(K.l("".concat(s," groupID:").concat(n," isAVChatRoom:").concat(h," has:").concat(m)),h)return this._AVChatRoomHandler.getGroupOnlineMemberCount(n);if(!m)return ln({memberCount:0});if(h=Date.now(),this._onlineMemberCountMap.has(n)){if(m=this._onlineMemberCountMap.get(n),h-m.lastReqTime<=6e4)return ln({memberCount:m.memberCount});m.lastReqTime=h}return this.requestOnlineCount(n).then(function(I){return I=I.data.memberCount,I=I===void 0?0:I,a._onlineMemberCountMap.set(n,{lastReqTime:Date.now(),memberCount:I}),K.l("".concat(s," ok. groupID:").concat(n," memberCount:").concat(I)),ln({memberCount:I})}).catch(function(I){return K.w("".concat(s," failed. error:"),I),Promise.reject(I)})}},{key:"requestOnlineCount",value:function(n){return this.req({P:de.GET_ONLINE_MBR_NUM,data:{groupID:n}})}},{key:"hasLocalGroup",value:function(n){return this.groupMap.has(n)}},{key:"deleteLocalGroupAndConversation",value:function(n){var a=this.checkJoinedAVChatRoomByID(n),s=(K.l("".concat(this._n,".deleteLocalGroupAndConversation groupID:").concat(n," isJoinedAVChatRoom:").concat(a)),this.get(11)),h="".concat(O.CONV_GROUP).concat(n);a&&(this.stopMessageLongPolling({groupID:n}),s.deleteLocalConv(h)),Yr({groupID:n})&&(a=this.getLocalGroupProfile(n))&&a.isSupportTopic===!0&&this.get(10).deleteTopicListInCommunity(n),s.clearUnreadCount(h),s.setCompleted(h),this._deleteLocalGroup(n),this._onlineMemberCountMap.delete(n),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(n){this.groupMap.delete(n),this._groupMemberHandler.deleteGroupMemberList(n)}},{key:"sendMessage",value:function(n,a){return wt(n._receiverList)&&0<n._receiverList.length&&!this.canIUse(ye.MSG_TO_SPECIFIED_GRP_MBR)?this.noUse("Targeted Group Message"):(n=this.createGroupMessagePack(n,a),this.req(n))}},{key:"createGroupMessagePack",value:function(n,a){var s=null,h=(a&&a.offlinePushInfo&&(s=a.offlinePushInfo),""),m=(_n(n.cloudCustomData)&&0<n.cloudCustomData.length&&(h=n.cloudCustomData),[]),I=(On(a)&&On(a.messageControlInfo)&&(I=($=a.messageControlInfo).excludedFromUnreadCount,T=$.excludedFromLastMessage,$=$.excludedFromContentModeration,I===!0&&m.push("NoUnread"),T===!0&&m.push("NoLastMsg"),$===!0)&&m.push("NoMsgCheck"),void 0),T=(wt(n._receiverList)&&0<n._receiverList.length&&(I=n._receiverList,50<n._receiverList.length)&&(I=n._receiverList.slice(0,50),this.warn("ReceiverListLimit")),this.isOnlineMessage(n,a)?1:0),$=JSON.parse(JSON.stringify(n.getElements())),D=this.get(17).getFileDNList(),V=n.getGroupAtInfoList(),$={fromAccount:this.getMyUserID(),groupID:n.to,msgBody:Rp(n.type,$,D),cloudCustomData:h,random:n.random,priority:n.priority,clientSequence:n.clientSequence,groupAtInfo:n.type!==O.MSG_TEXT||Tt(V)?void 0:V,onlineOnlyFlag:T,clientTime:n.clientTime,offlinePushInfo:Np(s),messageControlInfo:T==0?m:void 0,needReadReceipt:n.needReadReceipt!==!0||this.isMessageFromOrToAVChatroom(n.to)?0:1,receiverList:I,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0,cmConfigID:n._cmConfigID,forbidCallbackControl:yI(a)};return vr(n.to)&&($.groupID=pr(n.to),$.topicID=n.to),{P:de.SEND_GRP_MSG,data:$}}},{key:"revokeMessage",value:function(n){var a={groupID:n.to,msgSeqList:[{msgSeq:n.sequence}]};return vr(n.to)&&(a.groupID=pr(n.to),a.topicID=n.to),this.req({P:de.REVOKE_GRP_MSG,data:a})}},{key:"deleteMessage",value:function(s){var a=s.to,s=s.keyList,s=(K.l("".concat(this._n,".deleteMessage groupID:").concat(a," count:").concat(s.length)),{groupID:a,deleter:this.getMyUserID(),keyList:s});return vr(a)&&(s.groupID=pr(a),s.topicID=a),this.req({P:de.DEL_GRP_MSG,data:s})}},{key:"modifyRemoteMessage",value:function(T){var $=T.to,a=T.sequence,s=T.payload,h=T.type,m=T.version,m=m===void 0?0:m,I=T.cloudCustomData,T=T._elements,D=$,V=void 0,$=(vr($)&&(D=pr($),V=$),void 0);return EI(h)&&(1<T.length&&T.splice(0,1,{type:h,content:s}),$=T),this.req({P:de.MODIFY_GRP_MSG,data:{groupID:D,topicID:V,sequence:a,version:m,elements:$,cloudCustomData:I}})}},{key:"getRoamingMessage",value:function(I){var a=this,s="".concat(this._n,".").concat("getRoamingMessage"),h=I.conversationID,m=I.groupID,I=I.sequence,T=new ct("getRoamingMessage"),D=0,V=void 0;return vr(m)&&(m=pr(V=m)),this._computeLastSequence({groupID:m,topicID:V,sequence:I}).then(function($){return D=$,K.l("".concat(s," groupID:").concat(m," startSequence:").concat(D)),a.req({P:de.GET_GRP_ROAMING_MSG,data:{groupID:m,count:21,sequence:D,topicID:V}})}).then(function(me){var se=me.data,Ye=se.messageList,q=se.complete,se=se.invisibleSequenceList,se=se===void 0?[]:se,me=me.data.nextSequence,me=me===void 0?0:me,fe=(et(Ye)?K.l("".concat(s," ok. complete:").concat(q," nextSequence:").concat(me," but messageList is undefined!")):K.l("".concat(s," ok. complete:").concat(q," nextSequence:").concat(me," count:").concat(Ye.length)),T.setMessage("groupID:".concat(m," topicID:").concat(V," startSequence:").concat(D," complete:").concat(q," nextSequence:").concat(me)).end(),a.get(11)),He=[],Xe=[],Ye=(Tt(Ye)||(He=fe.onRoamingMessage(Ye,h,!0,Xe),fe.updateIsRead(h),fe.patchConvLastMessage(h)),q===2||me<1);return Ye&&(fe.setCompleted(h),me=""),K.l("".concat(s," isPullingCompleted:").concat(Ye," nextReqID:").concat(me," storedMsgCount:").concat(He.length)+" invisibleSeqCount:".concat(se.length)),{nextReqID:me+"",storedMessageList:He,assembledMessageList:Xe,isPullingCompleted:Ye}}).catch(function($){return T.setError($).setMessage("groupID:".concat(m," topicID:").concat(V," startSequence:").concat(D)).end(),K.w("".concat(s," failed. error:"),$),De($)})}},{key:"_getGroupIDOfMessage",value:function(n){return n.conversationID.replace(O.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(n){var a,s="".concat(this._n,".").concat("getReadReceiptList"),h=this._getGroupIDOfMessage(n[0]),m=this.getMyUserID(),I=n.filter(function(T){return T.from===m&&T.needReadReceipt===!0}).map(function(T){return{sequence:T.sequence}});return K.l("".concat(s," groupID:").concat(h," sequenceList:").concat(JSON.stringify(I))),I.length===0?ln({messageList:n}):((a=new ct("getReadReceiptList")).setMessage("groupID:".concat(h)),this.req({P:de.GET_READ_RECEIPT,data:{groupID:h,sequenceList:I}}).then(function(T){return a.end(),K.l("".concat(s," ok")),T=T.data.readReceiptList,wt(T)&&T.forEach(function(D){n.forEach(function(V){D.code===0&&D.sequence===V.sequence&&(V.readReceiptInfo.readCount=D.readCount,V.readReceiptInfo.unreadCount=D.unreadCount)})}),Kt({messageList:n})}).catch(function(T){return a.setError(T).end(),K.w("".concat(s," failed. error:"),T),De(T)}))}},{key:"sendReadReceipt",value:function(I){var a="".concat(this._n,".").concat("sendReadReceipt"),s=this._getGroupIDOfMessage(I[0]),h=new ct("sendReadReceipt"),m=(h.setMessage("groupID:".concat(s)),this.getMyUserID()),I=I.filter(function(T){return T.from!==m&&T.needReadReceipt===!0}).map(function(T){return{sequence:T.sequence}});return I.length===0?De({code:Je.READ_RECEIPT_MSG_LIST_EMPTY}):(K.l("".concat(a,". sequenceList:").concat(JSON.stringify(I))),this.req({P:de.SEND_READ_RECEIPT,data:{groupID:s,sequenceList:I}}).then(function(T){return h.end(),K.l("".concat(a," ok")),Kt()}).catch(function(T){return h.setError(T).end(),K.w("".concat(a," failed. error:"),T),De(T)}))}},{key:"getReadReceiptDetail",value:function(q){var a=this,m=q.message,V=q.filter,$=q.cursor,q=q.count,s=this._getGroupIDOfMessage(m),h=m.ID,m=m.sequence,I="".concat(this._n,".").concat("getReadReceiptDetail"),T=this._receiptDetailCompleteMap.get(h)||!1,D=V!==0&&V!==1?0:V,V=_n($)?$:"",$=!It(q)||q<=0||100<=q?100:q,q="groupID:".concat(s," sequence:").concat(m," cursor:").concat(V," filter:").concat(D," completeFlag:").concat(T),se=(K.l("".concat(I," ").concat(q)),{cursor:"",isCompleted:!1,messageID:h,unreadUserIDList:[],readUserIDList:[]}),me=new ct("getReadReceiptDetail");return me.setMessage(q),this.req({P:de.GET_READ_RECEIPT_DETAIL,data:{groupID:s,sequence:m,flag:D,cursor:V,count:$}}).then(function(Lt){me.end();var Lt=Lt.data,He=Lt.cursor,Xe=Lt.isCompleted,Ye=Lt.unreadUserIDList,Lt=Lt.readUserIDList;return se.cursor=He,Xe===1&&(se.isCompleted=!0,a._receiptDetailCompleteMap.set(h,!0)),D===0?se.readUserIDList=Lt.map(function(yt){return yt.userID}):D===1&&(se.unreadUserIDList=Ye.map(function(yt){return yt.userID})),K.l("".concat(I," ok")),Kt(se)}).catch(function(fe){return me.setError(fe).end(),K.w("".concat(I," failed. error:"),fe),De(fe)})}},{key:"getGroupReceiptsByUsers",value:function(h){var a="".concat(this._n,".").concat("getGroupReceiptsByUsers"),s=h.groupID,h=h.dataList,h=h===void 0?[]:h,m="groupID:".concat(s," dataList length:").concat(h.length);return K.l("".concat(a," ").concat(m)),h.length===0&&K.w("".concat(a," dataList is empty.")),this.req({P:de.GET_GRP_RECEIPTS_BY_USERS,data:{groupID:s,dataList:h}}).then(function(I){return I=I.data.dataList,I=I===void 0?[]:I,K.l("".concat(a," ok.")),Kt({dataList:I})}).catch(function(I){return K.w("".concat(a," failed. error:"),I),De(I)})}},{key:"getRoamingMessagesHopping",value:function(n){var a=this,s="".concat(this._n,".").concat("getRoamingMessagesHopping"),h=n.groupID,m=n.count,I=n.sequence,T=n.direction,D=void 0;return et(I)&&T===1?ln({messageList:[],isCompleted:!0,nextMessageSeq:""}):(vr(h)&&(h=pr(D=h)),this._computeReqSeqHopping({groupID:h,topicID:D,sequence:I}).then(function(V){et(I)||T!==1||(V=I+m-1);var $="".concat(D?"topicID:".concat(D):"groupID:".concat(h)," sequence:").concat(I," reqSeq:").concat(V," direction:").concat(T),q=(K.l("".concat(s," ").concat($)),new ct("getRoamingMessagesHopping"));return a.req({P:de.GET_GRP_ROAMING_MSG,data:{groupID:h,topicID:D,count:m,sequence:V}}).then(function(He){var He=He.data,Lt=He.messageList,Lt=Lt===void 0?[]:Lt,me=He.complete,fe=He.nextSequence,fe=fe===void 0?0:fe,He=He.invisibleSequenceList,He=He===void 0?[]:He,Ye="complete:".concat(me," nextSequence:").concat(fe," remoteMsgCount:").concat(Lt.length," invisibleSequenceList:").concat(He),Ye=(q.setMessage("".concat($," ").concat(Ye)).end(),K.l("".concat(s," ok. ").concat(Ye)),"".concat(O.CONV_GROUP).concat(n.groupID)),Xe=a.get(11),Ye=Xe.onRoamingMessage(Lt,Ye,!1),Lt=a._computeResult({groupID:n.groupID,direction:T,sequence:I,remoteMessageList:Lt,processedMessageList:Ye,complete:me,nextSequence:fe,invisibleSequenceList:He});return Xe.storeHoppingMessageList(Lt.messageList),Kt(Lt)}).catch(function(se){return q.setError(se).setMessage("groupID:".concat(h," sequence:").concat(I," count:").concat(m)).end(),K.w("".concat(s," failed. error:"),se),De(se)})}))}},{key:"_computeReqSeqHopping",value:function(m){var a=this,s=m.groupID,h=m.topicID,h=h===void 0?void 0:h,m=m.sequence,m=m===void 0?void 0:m;return 0<m?Promise.resolve(m):et(h)?this.getGroupProfileAdvance({groupIDList:[s],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then(function(T){var T=T.data.successGroupList,D=0;return Tt(T)||(D=T[0].nextMessageSeq-1),K.l("".concat(a._n,"._computeReqSeqHopping groupID:").concat(s," lastSequence:").concat(D," from remote")),D}).catch(function(I){return De(I)}):Promise.resolve(0)}},{key:"_computeResult",value:function($){var a={messageList:[],isCompleted:!1,nextMessageSeq:""},s=$.groupID,h=$.direction,m=$.sequence,I=$.remoteMessageList,I=I===void 0?[]:I,T=$.processedMessageList,T=T===void 0?[]:T,D=$.complete,V=$.nextSequence,$=$.invisibleSequenceList;if(h===0)return a.nextMessageSeq=V,(D===2||V<1)&&(a.isCompleted=!0,a.nextMessageSeq=""),a.messageList=T,a;if(h===1){if(Tt(I)){if(Tt($))return a.isCompleted=!0,a.nextMessageSeq="",a;a.nextMessageSeq=$[0]+1}else D=I[0].sequence,V=$[0]||0,a.nextMessageSeq=V<D?D+1:V+1;return T.forEach(function(q){q.sequence>=m&&a.messageList.push(q)}),(Yr({groupID:s})||vr(s))&&a.messageList.length===0&&I[0].sequence<m&&(a.isCompleted=!0,a.nextMessageSeq=""),a}}},{key:"setMessageRead",value:function(I){var a=this,s=I.conversationID,h=I.lastMessageSeq,m="".concat(this._n,".").concat("setMessageRead"),I="convID:".concat(s," lastMessageSeq:").concat(h),T=(K.l("".concat(m," ").concat(I)),It(h)||this.warn("DoNotModifyLastSeq"),new ct("setMessageRead")),D=(T.setMessage(I),s.replace(O.CONV_GROUP,"")),V=void 0;return vr(D)&&(D=pr(V=D)),this.req({P:de.SET_GRP_MSG_READ,data:{groupID:D,topicID:V,messageReadSeq:h}}).then(function(){T.end(),K.l("".concat(m," ok"));var $,q=a.get(11),se=(q.updateIsReadAfterReadReport({conversationID:s,lastMessageSeq:h}),!0);return!et(V)&&(se=!1,$=a.get(10).getLocalTopic(D,V))&&$.updateSelfInfo({readedSequence:h}),q.updateUnreadCount(s,se),Kt()}).catch(function($){return T.setError($).end(),K.l("".concat(m," failed. error:"),$),De($)})}},{key:"_computeLastSequence",value:function(h){var a=h.groupID,s=h.topicID,s=s===void 0?void 0:s,h=h.sequence;return 0<h?Promise.resolve(h):et(s)?this.getGroupLastSequence(a):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(n){var a="".concat(this._n,".").concat("getGroupLastSequence"),s=new ct("getGroupLastSequence"),h=0,m="",I="groupID:".concat(n);if(this.hasLocalGroup(n)){var T=this.getLocalGroupProfile(n),D=T.lastMessage;if(0<D.lastSequence&&D.onlineOnlyFlag===!1)return h=D.lastSequence,m="".concat(I,", ").concat(h," from group.lastMessage.lastSequence"),K.l("".concat(a," ").concat(m)),s.setMessage(m).end(),Promise.resolve(h);if(1<T.nextMessageSeq)return h=T.nextMessageSeq-1,m="".concat(I,", ").concat(h," from group.nextMessageSeq"),K.l("".concat(a," ").concat(m)),s.setMessage(m).end(),Promise.resolve(h)}return D=this.get(11).getLocalConversation("GROUP".concat(n)),D&&D.lastMessage.lastSequence&&D.lastMessage.onlineOnlyFlag===!1?(h=D.lastMessage.lastSequence,m="".concat(I,", ").concat(h," from conversation.lastMessage.lastSequence"),K.l("".concat(a," ").concat(m)),s.setMessage(m).end(),Promise.resolve(h)):this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then(function(V){return V=V.data.successGroupList,Tt(V)?K.w("".concat(a," ").concat(I,", empty successGroupList")):(h=V[0].nextMessageSeq-1,m="".concat(I,", ").concat(h," from remote"),K.l("".concat(a," ").concat(m))),s.setMessage(m).end(),h}).catch(function(V){return s.setError(V).setMessage(I).end(),K.w("".concat(a," failed. error:"),V),De(V)})}},{key:"isMessageFromOrToAVChatroom",value:function(n){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(n)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"getGroupRemoteLastSeq",value:function(n){return n=this.getLocalGroupProfile(n),n?n.nextMessageSeq-1:1}},{key:"isOnlineMessage",value:function(n,a){return!(!this._canIUseOnlineOnlyFlag(n)||!a||a.onlineUserOnly!==!0)}},{key:"_canIUseOnlineOnlyFlag",value:function(n){var a=this.getJoinedAVChatRoom();return!a||!a.includes(n.to)||n.conversationType!==O.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(n,a){var s;Tt(n)||(K.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(a," count:").concat(n.length)),s=[],n.forEach(function(h){s.push(E(E({},h),{},{isHistoryMessage:1}))}),this.onAVChatRoomMessage(s,a))}},{key:"onAVChatRoomMessage",value:function(n){this._AVChatRoomHandler.onMessage(n,1<arguments.length&&arguments[1]!==void 0?arguments[1]:"")}},{key:"onAVChatRoomMemberBanned",value:function(n){this._AVChatRoomHandler.onAVChatRoomMemberBanned(n)}},{key:"setUnjoinedAVChatRoom",value:function(n){this._unjoinedAVChatRoomList.set(n,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(n){this._unjoinedAVChatRoomList.has(n)&&this._unjoinedAVChatRoomList.delete(n)}},{key:"isUnjoinedAVChatRoom",value:function(n){return this._unjoinedAVChatRoomList.has(n)}},{key:"isGroupAttributesUpdatedNotice",value:function(n){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(n)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(n){return this._groupAttributesHandler.initGroupAttributes(n)}},{key:"setGroupAttributes",value:function(n){return this._groupAttributesHandler.setGroupAttributes(n)}},{key:"deleteGroupAttributes",value:function(n){return this._groupAttributesHandler.deleteGroupAttributes(n)}},{key:"getGroupAttributes",value:function(n){return this._groupAttributesHandler.getGroupAttributes(n)}},{key:"isMessageFromTopic",value:function(n,a){return n===2&&!Tt(a)}},{key:"isMessageFromCommunityOfTopic",value:function(n,a){return n===2&&Tt(a)}},{key:"getMessageExtensions",value:function(n,a){return K.l("".concat(this._n,".getMessageExtensions startSequence:").concat(a)),this.req({P:de.GET_GRP_MSG_EXT,data:{groupID:n.to,messageSequence:n.sequence,startSequence:a}})}},{key:"modifyMsgExts",value:function(n,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return K.l("".concat(this._n,".modifyMsgExts operateType:").concat(s)),this.req({P:de.MODIFY_GRP_MSG_EXT,data:{groupID:n.to,messageSequence:n.sequence,extensionList:a,operateType:s}})}},{key:"_genNotifyReqList",value:function(n){for(var a,s,h,m,I=[],T=0,D=n.length;T<D;T++)a=n[T],m=this.getLocalGroupProfile(a).type,s=this._getGroupLastRevokedTime(a),h=1e3*Dn(),m={notifyType:1,limit:20,type:Yr({type:m,groupID:a})?O.GRP_COMMUNITY:void 0,groupID:a,beginTime:s,endTime:h},I.push(m);return I}},{key:"getNotice",value:function(h){var a=this,s="".concat(this._n,".getNotice"),h=h.filter(function(m){var I;return!!a.hasLocalGroup(m)&&(I=(m=a.getLocalGroupProfile(m)).type,m=m.isSupportTopic,!jr(I))&&!m});h.length!==0&&(K.l("".concat(s," list:").concat(h)),this.req({P:de.GET_GRP_NOTIFY,data:{notifyReqList:this._genNotifyReqList(h)}}).then(function(D){var I,T,D=D.data.notifyRspList,V=[];wt(D)&&(I={dataList:[]},T="".concat(s," ok."),D.forEach(function($){var q=$.nextRevokedTime,se=$.groupID,me=$.notifyList;T+=" groupID:".concat(se," nextRevokedTime:").concat(q," count:").concat(me.length,`
`),I.dataList.push({elements:{revokedInfos:a._genRevokedInfos($)}}),q!==0?(a._setGroupLastRevokedTime(se,q),V.push(se)):a._setGroupLastRevokedTime(se,1e3*Dn())}),K.l(T),a.onMsgRevoked(I,!1)),0<V.length&&a.getNotice(V)}).catch(function(m){K.e("".concat(s," failed. error:"),m)}))}},{key:"_genRevokedInfos",value:function(n){var a=n.notifyList,s=n.groupID,h=[];return wt(a)&&a.forEach(function(m){h.push({groupID:s,sequence:m.sequence,random:m.random,revokerInfo:E({},m.revokerInfo)})}),h}},{key:"_getGroupLastRevokedTime",value:function(n){return this.hasLocalGroup(n)?this.getLocalGroupProfile(n)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(n,a){this.hasLocalGroup(n)&&(this.getLocalGroupProfile(n)._lastRevokedTime=a)}},{key:"isGroupCountersNotice",value:function(n){return this._groupCountersHandler.isGroupCountersNotice(n)}},{key:"setGroupCounters",value:function(n){return this._groupCountersHandler.setGroupCounters(n)}},{key:"increaseGroupCounter",value:function(n){return this._groupCountersHandler.increaseGroupCounter(n)}},{key:"decreaseGroupCounter",value:function(n){return this._groupCountersHandler.decreaseGroupCounter(n)}},{key:"getGroupCounters",value:function(n){return this._groupCountersHandler.getGroupCounters(n)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(n){return this._groupMemberHandler.getGroupMemberList(n)}},{key:"getGroupMemberProfile",value:function(n){return this._groupMemberHandler.getGroupMemberProfile(n)}},{key:"addGroupMember",value:function(n){return this._groupMemberHandler.addGroupMember(n)}},{key:"deleteGroupMember",value:function(n){return this._groupMemberHandler.deleteGroupMember(n)}},{key:"setGroupMemberMuteTime",value:function(n){return this._groupMemberHandler.setGroupMemberMuteTime(n)}},{key:"setGroupMemberRole",value:function(n){return this._groupMemberHandler.setGroupMemberRole(n)}},{key:"setGroupMemberNameCard",value:function(n){return this._groupMemberHandler.setGroupMemberNameCard(n)}},{key:"setGroupMemberCustomField",value:function(n){return this._groupMemberHandler.setGroupMemberCustomField(n)}},{key:"markGroupMemberList",value:function(n){return this._groupMemberHandler.markGroupMemberList(n)}},{key:"modifyGroupMemberInfo",value:function(n){return this._groupMemberHandler.modifyGroupMemberInfo(n)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(n){var a;return n&&(a=this.getLocalGroupProfile(n))&&jr(a.type)?this._AVChatRoomHandler.getPollingTimerID(n):-1}},{key:"_canIUseJoinOption",value:function(n){return n===O.GRP_PUBLIC||Yr({type:n})}},{key:"_silentlyGetGroupProfile",value:function(n,a){var s=setTimeout(this.getGroupProfile.bind(this,{groupID:a}),3e3);this._timeoutIDs.push(s),K.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(n," groupID:").concat(a," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach(function(n){n&&clearTimeout(n)}),this._timeoutIDs=[]}},{key:"startMessageLongPolling",value:function(m){var a,s=m.groupID,h=m.longPollingKey,m=m.longPollingSequence,m=m===void 0?1:m,I=this.get(12).isUnlimitedAVChatRoom();if(!Tt(h))return this._AVChatRoomHandler.hasPollingInstance(s)&&this.stopMessageLongPolling({groupID:s}),a=this._AVChatRoomHandler.getJoinedLiveList(),!I&&0<a.length&&this.stopMessageLongPolling({groupID:a[0]}),I=new fa({groupID:s,type:O.GRP_LIVE}),K.l("".concat(this._n,".startMessageLongPolling groupID:").concat(s," longPollingKey:").concat(h," longPollingSequence:").concat(m)),this._AVChatRoomHandler.startRunLoop({group:I,longPollingKey:h,startSeq:m});console.warn("".concat(this._n,".startMessageLongPolling longPollingKey is empty."))}},{key:"stopMessageLongPolling",value:function(a){var a=a.groupID,s=this.get(11);return this._AVChatRoomHandler.reset(a),this._deleteLocalGroup(a),s.deleteLocalConv("".concat(O.CONV_GROUP).concat(a)),K.l("".concat(this._n,".stopMessageLongPolling ok, groupID:").concat(a)),ln({groupID:a})}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}])),b1=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],C1=p(function n(a,s){u(this,n),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=Pv(a.lastMessage,s),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(a)},[{key:"_initTopic",value:function(n){for(var a in n)b1.indexOf(a)<0||(a==="selfInfo"?this.updateSelfInfo(n[a]):this[a]=a==="muteAllMembers"?n[a]===1:n[a])}},{key:"updateUnreadCount",value:function(){this.unreadCount=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0}},{key:"updateNextMessageSeq",value:function(n){this.nextMessageSeq=n}},{key:"updateLastMessage",value:function(n){this.lastMessage=Pv(n)}},{key:"updateGroupAtInfoList",value:function(n){this.groupAtInfoList=JSON.parse(JSON.stringify(n))}},{key:"updateTopic",value:function(n){et(n.selfInfo)||this.updateSelfInfo(n.selfInfo),et(n.muteAllMembers)||(this.muteAllMembers=n.muteAllMembers===1),ei(this,n,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(n){return ei(this.selfInfo,n,[],[""])===0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(n){return n.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(n){this.lastMessage.isRevoked=n}},{key:"setLastMessageRevoker",value:function(n){this.lastMessage.revoker=n}}]),S1=(S(Bp,$o),p(Bp,[{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("topic_cache_time"),a=this.getCloudConfig("topic_last_active_time");et(n)||(this.TOPIC_CACHE_TIME=Number(n)),et(a)||(this.TOPIC_LAST_ACTIVE_TIME=Number(a))}},{key:"onTopicCreated",value:function(n){var a=n.groupID;this.resetGetTopicTime(a),this.emitOEvt(W.TOPIC_CREATED,n)}},{key:"onTopicDeleted",value:function(n){var a=this,s=n.groupID,h=n.topicIDList;(h===void 0?[]:h).forEach(function(m){a._deleteLocalTopic(s,m)}),this.emitOEvt(W.TOPIC_DELETED,n)}},{key:"onTopicProfileUpdated",value:function(n){var a=n.groupID,s=n.topicID,s=this.getLocalTopic(a,s);s&&(s.updateTopic(n),this.emitOEvt(W.TOPIC_UPDATED,{groupID:a,topic:s}))}},{key:"onTopicLatestMsg",value:function(m){var a,s,m=m||{},h=m.topicLatestMessage,m=m.excludedUnreadSequenceList;Tt(h)||(a=h.groupProfile.topicID,h.conversationType=O.CONV_GROUP,h.to=a,(s=new _r(h)).setElement(h.elements),this.updateUnreadCountAndLastMsg(a,s,m))}},{key:"onMessageRemindTypeUpdated",value:function(m){var a,s=m.groupID,h=m.topicID,m=m.messageRemindType,I=this.getLocalTopic(s,h);I&&((a=I.updateSelfInfo({messageRemindType:m}))&&this.emitOEvt(W.TOPIC_UPDATED,{groupID:s,topic:I}),K.l("".concat(this._n,".onMessageRemindTypeUpdated topicID:").concat(h," messageRemindType:").concat(m," isUpdated:").concat(a)))}},{key:"onAtInfoUpdated",value:function(a){var h=a.topicID,a=a.groupAtInfoList,s=pr(h),h=this.getLocalTopic(s,h);h&&!et(a)&&(h.updateGroupAtInfoList(a),this.emitOEvt(W.TOPIC_UPDATED,{groupID:s,topic:h}))}},{key:"onUnreadCountUpdatedFromConv",value:function(h){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,s=pr(h),h=this.getLocalTopic(s,h);h&&h.unreadCount!==a&&(h.updateUnreadCount(a),a===0&&h.updateSelfInfo({readedSequence:h.lastMessage.lastSequence}),this.emitOEvt(W.TOPIC_UPDATED,{groupID:s,topic:h}))}},{key:"onMessageSent",value:function(m){var a,s,h=m.groupID,I=m.topicID,m=m.lastMessage,I=this.getLocalTopic(h,I);I&&(s=(a=(a=m.sequence)===void 0?0:a)+1)>I.nextMessageSeq&&(I.updateNextMessageSeq(s),I.updateLastMessage(m),I.updateSelfInfo({readedSequence:a}),I.updateUnreadCount(0),this.emitOEvt(W.TOPIC_UPDATED,{groupID:h,topic:I}))}},{key:"onMessageModified",value:function(n){var a,s=n.to,h=n.time,m=n.sequence,I=n.elements,T=n.cloudCustomData,D=n.messageVersion,V=pr(s),$=this.getLocalTopic(V,s);$&&(a=$.lastMessage,K.d("".concat(this._n,".onMessageModified topicID:").concat(s," lastMessage:"),JSON.stringify(a),"options:",JSON.stringify(n)),a)&&(a.payload===null||a.lastTime===h&&a.lastSequence===m&&a.version!==D)&&(a.type=I[0].type,a.payload=I[0].content,a.messageForShow=mh(a.type,a.payload,this.isIntl()),a.cloudCustomData=T,a.version=D,a.lastSequence=m,a.lastTime=h,this.emitOEvt(W.TOPIC_UPDATED,{groupID:V,topic:$}))}},{key:"onMessageRevoked",value:function(n){var a,s,h,m=this;n.length!==0&&(s=a=null,h=!1,n.forEach(function(I){var T=I.to;s=pr(T),(a=m.getLocalTopic(s,T))&&(a.reduceUnreadCount()&&(h=!0),a.isLastMessageRevoked(I)&&(a.setLastMessageRevoked(!0),a.setLastMessageRevoker(I.revoker),h=!0),(T=a.selfInfo.excludedUnreadSequenceList||[]).push(I.sequence),a.updateSelfInfo({excludedUnreadSequenceList:T}))}),h)&&this.emitOEvt(W.TOPIC_UPDATED,{groupID:s,topic:a})}},{key:"isLastMessageRevoked",value:function(a){var h=a.topicID,a=a.sequence,s=pr(h),s=this.getLocalTopic(s,h),h=!1;return h=s?s.isLastMessageRevoked({sequence:a}):h}},{key:"updateUnreadCountAndLastMsg",value:function(n,a,s){var h,m=pr(n),I=this.getLocalTopic(m,n);I&&(h=I.selfInfo.excludedUnreadSequenceList||[],et(s)||(h=s),a._isExcludedFromUnreadCount&&h.push(a.sequence),I.updateSelfInfo({excludedUnreadSequenceList:h}),K.l("".concat(this._n,".updateUnreadCountAndLastMsg seq:").concat(a.sequence," lastSeq:").concat(I.lastMessage.lastSequence)),a.sequence>I.lastMessage.lastSequence)&&(I.updateLastMessage(a),s=a.sequence+1,I.updateNextMessageSeq(s),h=this._computeUnreadCount(I),I.updateUnreadCount(h),(a=this.get(11).getLocalConversation("".concat(O.CONV_GROUP).concat(n)))&&a.updateUnreadCount({nextUnreadCount:h,isFromGetConversations:!0}),this.emitOEvt(W.TOPIC_UPDATED,{groupID:m,topic:I}))}},{key:"getJoinedCommunityList",value:function(){return this.get(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(n){var a,s=this,h="".concat(this._n,".").concat("createTopicInCommunity"),m=n.topicID;return et(m)||vr(m)?n.topicName&&this._filterProfanity("topicName",n)===!1||n.introduction&&this._filterProfanity("introduction",n)===!1||n.notification&&this._filterProfanity("notification",n)===!1?De({code:Je.PROFANITY_FOUND}):(a=new ct("createTopicInCommunity"),this.req({P:de.CREATE_TOPIC,data:E({},n)}).then(function(I){return I=I.data.topicID,a.setMessage("topicID:".concat(I)).end(),K.l("".concat(h," ok. topicID:").concat(I)),s._updateTopicMap([E(E({},n),{},{topicID:I})]),Kt({topicID:I})}).catch(function(I){return a.setError(I).end(),K.e("".concat(h," failed. error:"),I),De(I)})):De({code:Je.ILLEGAL_TOPIC_ID})}},{key:"deleteTopicFromCommunity",value:function(m){var a=this,s="".concat(this._n,".").concat("deleteTopicFromCommunity"),h=m.groupID,m=m.topicIDList,m=m===void 0?[]:m,I=new ct("deleteTopicFromCommunity");return I.setMessage("groupID:".concat(h," topicIDList:").concat(m)),this.req({P:de.DEL_TOPIC,data:{groupID:h,topicIDList:m}}).then(function($){var $=$.data.resultList,D=[],V=[],$=(($===void 0?[]:$).forEach(function(fe){var se=fe.topicID,me=fe.errorCode,fe=fe.errorInfo;me===0?D.push({topicID:se}):V.push({topicID:se,code:me,message:fe})}),"success count:".concat(D.length,", fail count:").concat(V.length));return I.setMoreMessage($).end(),K.l("".concat(s," ok. ").concat($)),D.forEach(function(q){a._deleteLocalTopic(h,q.topicID)}),Kt({successTopicList:D,failureTopicList:V})}).catch(function(T){return I.setError(T).end(),K.e("".concat(s," failed. error:"),T),De(T)})}},{key:"updateTopicProfile",value:function(n){var a,s=this,h="".concat(this._n,".").concat("updateTopicProfile");return K.l("".concat(h," options:"),n),n.topicName&&this._filterProfanity("topicName",n)===!1||n.introduction&&this._filterProfanity("introduction",n)===!1||n.notification&&this._filterProfanity("notification",n)===!1?De({code:Je.PROFANITY_FOUND}):((a=new ct("updateTopicProfile")).setMessage("groupID:".concat(n.groupID," topicID:").concat(n.topicID)),et(n.muteAllMembers)||(n.muteAllMembers=n.muteAllMembers===!0?"On":"Off"),this.req({P:de.UPDATE_TOPIC_PROFILE,data:E({},n)}).then(function(){return a.end(),K.l("".concat(h," ok")),s._updateTopicMap([n]),Kt({topic:s.getLocalTopic(n.groupID,n.topicID)})}).catch(function(m){return a.setError(m).end(),K.e("".concat(h," failed. error:"),m),De(m)}))}},{key:"getTopicList",value:function(m){var a=this,s="".concat(this._n,".").concat("getTopicList"),h=m.groupID,m=m.topicIDList,m=m===void 0?[]:m,I=m.length===0,T=new ct("getTopicList");if(T.setMessage("groupID:".concat(h)),this._getTopicTimeMap.has(h)){var V=this._getTopicTimeMap.get(h),D=V.isGetAll,V=V.time;if((D||!D&&!I)&&Date.now()-V<1e3*this.TOPIC_CACHE_TIME&&(D=this._getLocalTopicList(h,m),I||D.length===m.length))return T.setMoreMessage("from cache, topic count:".concat(D.length)).end(),K.l("".concat(s," groupID:").concat(h," from cache, topic count:").concat(D.length)),ln({successTopicList:D,failureTopicList:[]})}return this.req({P:de.GET_TOPIC_LIST,data:{groupID:h,topicIDList:m}}).then(function(fe){var fe=fe.data.topicInfoList,q=[],se=[],me=[],fe=((fe===void 0?[]:fe).forEach(function(yt){var Xe=yt.topic,Ye=yt.selfInfo,Lt=yt.errorCode,yt=yt.errorInfo,rn=Xe.topicID;Lt===0?(q.push(E(E({},Xe),{},{selfInfo:Ye})),se.push(rn)):me.push({topicID:rn,code:Lt,message:yt})}),a._updateTopicMap(q),a._handleTopicAtInfo(q),"success count:".concat(se.length,", fail count:").concat(me.length)),fe=(T.setMoreMessage(fe).end(),K.l("".concat(s," groupID:").concat(h," from remote, ").concat(fe)),[]);return Tt(se)||(a._getTopicTimeMap.set(h,{time:Date.now(),isGetAll:I}),fe=a._getLocalTopicList(h,se)),Kt({successTopicList:fe,failureTopicList:me})}).catch(function($){return T.setError($).end(),K.e("".concat(s," failed. error:"),$),De($)})}},{key:"hasLocalTopic",value:function(n,a){return!!this._topicMap.has(n)&&this._topicMap.get(n).has(a)}},{key:"getLocalTopic",value:function(n,a){var s=null;return s=this._topicMap.has(n)?this._topicMap.get(n).get(a):s}},{key:"_getLocalTopicList",value:function(s){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[],s=this._topicMap.get(s),h=[];return s&&(h=P(s.values())),a.length===0?h:h.filter(function(m){return a.includes(m.topicID)})}},{key:"_deleteLocalTopic",value:function(n,a){this._topicMap.has(n)&&this._topicMap.get(n).has(a)&&(this._topicMap.get(n).delete(a),K.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(n," topicID:").concat(a)))}},{key:"_updateTopicMap",value:function(n){var a=this,s=[];n.forEach(function(D){var m=D.groupID,I=D.topicID,T=null,D=(a._topicMap.has(m)||a._topicMap.set(m,new Map),a._topicMap.get(m).has(I)?(T=a._topicMap.get(m).get(I)).updateTopic(D):(a._getTopicLastMessage(D),T=new C1(D,a.isIntl()),a._topicMap.get(m).set(I,T)),a._computeUnreadCount(T));T.updateUnreadCount(D),s.push({conversationID:"".concat(O.CONV_GROUP).concat(I),type:O.CONV_TOPIC,unreadCount:D})}),0<s.length&&this.get(11).updateTopicConversation(s)}},{key:"resetGetTopicTime",value:function(n){var a=this;et(n)?P(this._getTopicTimeMap.keys()).forEach(function(s){a._getTopicTimeMap.set(s,0)}):this._getTopicTimeMap.set(n,0)}},{key:"getTopicListOnReconnected",value:function(){var n=this,a=P(this._topicMap.keys()),s=[],h=this.get(11);a.forEach(function(m){var I=[],T=n._getLocalTopicList(m);h.deleteTopicRoamingInfo(m),T.forEach(function(D){var V=D.lastMessage.lastTime,V=V===void 0?0:V;Date.now()-1e3*V<1e3*n.TOPIC_LAST_ACTIVE_TIME&&I.push(D.topicID)}),0<I.length&&s.push({groupID:m,topicIDList:I})}),K.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(s.length)),this._relayGetTopicList(s)}},{key:"_relayGetTopicList",value:function(n){var a,s,h,m=this;n.length!==0&&(s=5<(a=n.shift()).topicIDList.length?"topicIDList.length:".concat(a.topicIDList.length):"topicIDList:".concat(a.topicIDList),(h=new ct("relayGetTopicList")).setMessage(s),K.l("".concat(this._n,"._relayGetTopicList. ").concat(s)),this.getTopicList(a).then(function(){h.end(),m._relayGetTopicList(n)}).catch(function(I){h.setError(I).end(),m._relayGetTopicList(n)}))}},{key:"_handleTopicAtInfo",value:function(n){var a=this;n.length!==0&&n.forEach(function(I){var h=I.groupID,m=I.topicID,I=I.groupAtInfoList,T=[];et(I)||(I.forEach(function(D){T.push(E(E({},D),{},{groupID:h,topicID:m}))}),a.get(11).onNewGroupAtTips({dataList:T}))})}},{key:"_getTopicLastMessage",value:function(n){var a;et(n.lastMsg)||(a={time:n.lastMsg.time,sequence:n.lastMsg.sequence,from:n.lastMsg.from,payload:n.lastMsg.elements[0]?n.lastMsg.elements[0].content:null,type:n.lastMsg.elements[0]?n.lastMsg.elements[0].type:"",nick:n.lastMsg.nick,avatar:n.lastMsg.avatar,version:n.lastMsg.messageVersion,cloudCustomData:n.lastMsg.cloudCustomData,isRevoked:n.lastMsg.isPlaceMessage===2,revoker:Tt(n.lastMsg.revokerInfo)?null:n.lastMsg.revokerInfo.revoker},n.lastMessage=a)}},{key:"deleteTopicListInCommunity",value:function(n){var a=this,s=this._getLocalTopicList(n),h=this.get(11);s.forEach(function(m){m=m.topicID,a._deleteLocalTopic(n,m),a._getTopicTimeMap.delete(n),h.deleteLocalConv("".concat(O.CONV_GROUP).concat(m))})}},{key:"_computeUnreadCount",value:function(n){var a,m=n.selfInfo,s=m.excludedUnreadSequenceList,h=m.readedSequence,m=n.nextMessageSeq-n.selfInfo.readedSequence-1;return wt(s)&&(a=0,s.forEach(function(I){h<I&&I<=n.nextMessageSeq-1&&(a+=1)}),1<=a)&&(m-=a),m<0?0:m}},{key:"_filterProfanity",value:function(n,a){var s,h=this.get(29);return!h||(s=(h=h.filterText(a[n],ue)).isAllowedToSend,h=h.modifiedText,s===!0&&(a[n]=h,!0))}},{key:"getMessageExtensions",value:function(n,a){K.l("".concat(this._n,".getMessageExtensions startSequence:").concat(a));var s=pr(n.to);return this.req({P:de.GET_GRP_MSG_EXT,data:{groupID:s,topicID:n.to,messageSequence:n.sequence,startSequence:a}})}},{key:"modifyMsgExts",value:function(n,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,h=(K.l("".concat(this._n,".modifyMsgExts operateType:").concat(s)),pr(n.to));return this.req({P:de.MODIFY_GRP_MSG_EXT,data:{groupID:h,topicID:n.to,messageSequence:n.sequence,extensionList:a,operateType:s}})}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}])),pa=p(function n(a){u(this,n),this._userM=a,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5},[{key:"setExpirationTime",value:function(n){this.expirationTime=n}},{key:"getUserProfile",value:function(n){var a=this,s="".concat(this._n,".").concat("getUserProfile"),h=n.userIDList;n.fromAccount=this._userM.getMyAccount(),100<h.length&&(K.w("".concat(s," ").concat(lc(100))),h.length=100);for(var m,I=[],T=[],D=0,V=h.length;D<V;D++)m=h[D],this._userM.isMyFriend(m)&&this._contains(m)?T.push(this._getProfileFromMap(m)):I.push(m);if(I.length===0)return ln(T);n.toAccount=I;var $=n.bFromGetMyProfile||!1,q=[],se=(n.toAccount.forEach(function(me){q.push({toAccount:me,standardSequence:0,customSequence:0})}),n.userItem=q,new ct("getUserProfile"));return se.setMessage(5<h.length?"userIDList.length:".concat(h.length):"userIDList:".concat(h)),this._userM.req({P:de.GET_USER_PROFILE,data:n}).then(function(me){return se.end(),K.i("".concat(s," ok")),me=a._handleResponse(me).concat(T),Kt($?me[0]:me)}).catch(function(me){return se.setError(me).end(),K.e("".concat(s," failed. error:"),me),De(me)})}},{key:"getMyProfile",value:function(){var n,a=this._userM.getMyAccount(),s="".concat(this._n,".getMyProfile");return K.l("".concat(s," myAccount:").concat(a)),this._fill(),this._contains(a)?(n=this._getProfileFromMap(a),K.d("".concat(s," from cache, myProfile:").concat(JSON.stringify(n))),ln(n)):this.getUserProfile({fromAccount:a,userIDList:[a],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(n){var a=n.data.userProfileItem;if(!wt(a))return[];for(var s=[],n=Date.now(),h=0,m=a.length;h<m;h++){var T=a[h],I=T.to,T=T.profileItem;I!=="@TLS#NOT_FOUND"&&I!==""&&(I=this._update(I,this._getLatestProfileFromResponse(I,T)).latestProfile,s.push(I))}return K.l("".concat(this._n,"._handleResponse cost:").concat(br(n))),s}},{key:"_getLatestProfileFromResponse",value:function(n,a){var s={userID:n,profileCustomField:[]};if(!Tt(a))for(var h=0,m=a.length;h<m;h++)if(-1<a[h].tag.indexOf("Tag_Profile_Custom"))s.profileCustomField.push({key:a[h].tag,value:a[h].value});else switch(a[h].tag){case Gt.NICK:s.nick=a[h].value;break;case Gt.GENDER:s.gender=a[h].value;break;case Gt.BIRTHDAY:s.birthday=a[h].value;break;case Gt.LOCATION:s.location=a[h].value;break;case Gt.SELFSIGNATURE:s.selfSignature=a[h].value;break;case Gt.ALLOWTYPE:s.allowType=a[h].value;break;case Gt.LANGUAGE:s.language=a[h].value;break;case Gt.AVATAR:s.avatar=a[h].value;break;case Gt.MESSAGESETTINGS:s.messageSettings=a[h].value;break;case Gt.ADMINFORBIDTYPE:s.adminForbidType=a[h].value;break;case Gt.LEVEL:s.level=a[h].value;break;case Gt.ROLE:s.role=a[h].value;break;default:K.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),a[h].tag,a[h].value)}return s}},{key:"updateMyProfile",value:function(n){var a=this,s="".concat(this._n,".").concat("updateMyProfile");if(n.nick&&this._userM.filterProfanity("nick",n)===!1)return De({code:Je.PROFANITY_FOUND});if(n.selfSignature&&this._userM.filterProfanity("selfSignature",n)===!1)return De({code:Je.PROFANITY_FOUND});var h=new ct("updateMyProfile"),m=(h.setMessage(JSON.stringify(n)),new Th().validate(n));if(!m.valid)return h.setCode(Je.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(m.tips)).end(),K.e("".concat(s," info:").concat(m.tips)),De({code:Je.UPDATE_PROFILE_INVALID_PARAM});var I,T,D=[];for(I in n)Object.prototype.hasOwnProperty.call(n,I)&&(I==="profileCustomField"?n.profileCustomField.forEach(function(V){D.push({tag:V.key,value:V.value})}):D.push({tag:Gt[I.toUpperCase()],value:n[I]}));return D.length===0?(m=new po({code:Je.UPDATE_PROFILE_NO_KEY}),h.setError(m).end(),K.e("".concat(s," failed. error:"),m),De(m)):(T=this._userM.getMyAccount(),this._userM.req({P:de.UPDATE_MY_PROFILE,data:{fromAccount:T,profileItem:D}}).then(function(V){h.end(),K.i("".concat(s," ok"));var q=a._update(T,n),$=q.isProfileUpdated,q=q.latestProfile;return $===!0&&a._userM.emitOEvt(W.PROFILE_UPDATED,[q]),ln(q)}).catch(function(V){return h.setError(V).end(),K.e("".concat(s," failed. error:"),V),De(V)}))}},{key:"onProfileModified",value:function(n){var a=n.dataList;if(!Tt(a)){var s=a.length;K.d("".concat(this._n,".onProfileModified count:").concat(s," dataList:"),n.dataList);for(var h=[],m=0;m<s;m++){var T=a[m].userID,T=this._update(T,this._getLatestProfileFromResponse(T,a[m].profileList)),I=T.isProfileUpdated,T=T.latestProfile;I===!0&&h.push(T)}0<h.length&&(this._userM.emitIEvt(So.PROFILE_UPDATED,h),this._userM.emitOEvt(W.PROFILE_UPDATED,h))}}},{key:"_fill",value:function(){if(this.accountProfileMap.size===0){for(var n=this._getCachedProfiles(),a=Date.now(),s=0,h=n.length;s<h;s++)a-n[s].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(n[s].userID,n[s]);K.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(n,a){var s,h=!1,m=Date.now();return this._contains(n)?(s=this._getProfileFromMap(n),a.profileCustomField&&vu(s.profileCustomField,a.profileCustomField)===!0&&(s.lastUpdatedTime=m,h=!0),0<ei(s,a,["profileCustomField"])&&(s.lastUpdatedTime=m,h=!0)):(s=new Th(a),!this._userM.isMyFriend(n)&&n!==this._userM.getMyAccount()||(s.lastUpdatedTime=m,h=!0,this.accountProfileMap.set(n,s))),this._flush(n===this._userM.getMyAccount()),h===!0&&K.l("".concat(this._n,"._update account:").concat(n," isUpdated:").concat(h)),{isProfileUpdated:h,latestProfile:s}}},{key:"_flush",value:function(n){var a=P(this.accountProfileMap.values()),s=this._userM.getStorageModule();K.d("".concat(this._n,"._flush length:").concat(a.length," flushAtOnce:").concat(n)),s.setItem(this.TAG,a,n)}},{key:"_contains",value:function(n){return this.accountProfileMap.has(n)}},{key:"_getProfileFromMap",value:function(n){return this.accountProfileMap.get(n)}},{key:"_getCachedProfiles",value:function(){var n=this._userM.getStorageModule().getItem(this.TAG);return Tt(n)?[]:n}},{key:"onConvProfileUpdated",value:function(n){for(var a,s,h,m=[],I=0,T=n.length;I<T;I++)s=(a=n[I]).userID,this._userM.isMyFriend(s)&&(this._contains(s)?(h=this._getProfileFromMap(s),0<ei(h,a)&&m.push(s)):m.push(a.userID));m.length!==0&&(K.l("".concat(this._n,".onConvProfileUpdated toAccountList:").concat(m)),this.getUserProfile({userIDList:m}))}},{key:"getNickAndAvatarByUserID",value:function(n){return this._contains(n)?{nick:(n=this._getProfileFromMap(n)).nick,avatar:n.avatar}:{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(n){var a,s=this,h=P(new Set(n)),m=(K.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(n.length," uniqueUserIDList.length:").concat(h.length)),[]);return n.length===0?Promise.resolve(m):(n=this._createUserIDListGroup(h),a=[],n.forEach(function(I){a.push(s.getUserProfile({userIDList:I}))}),Promise.all(a).then(function(I){return I.forEach(function(T){T=T.data.map(function(D){return{userID:D.userID,nick:D.nick,avatar:D.avatar}}),m.push.apply(m,P(T))}),m}))}},{key:"_createUserIDListGroup",value:function(n){for(var a=[],s=0;s<n.length;)a.push(n.slice(s,s+=100));return a}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),Ru=p(function n(a){u(this,n)}),E1=p(function n(a){u(this,n),this._userM=a,this._n="BlacklistHandler",this._blacklistMap=new Map,this._startIndex=0},[{key:"getLocalBlacklist",value:function(){return P(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var n=this,a="".concat(this._n,".getBlacklist"),s={fromAccount:this._userM.getMyAccount(),maxLimited:100,startIndex:this._startIndex},h=new ct("getBlacklist");return this._userM.req({P:de.GET_BL,data:s}).then(function(T){var T=T.data,I=T.blackListItem,T=T.startIndex,D=Tt(I)?0:I.length;h.setMessage("count:".concat(D)).end(),K.i("".concat(a," ok")),n._startIndex=T,n._handleResponse(I,!0),n._userM.emitOEvt(W.BLACKLIST_UPDATED,P(n._blacklistMap.keys())),n._startIndex!==0&&n.getBlacklist()}).catch(function(m){return h.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})}},{key:"addBlacklist",value:function(n){var a,s,h=this,m=new ct("addToBlacklist"),I="".concat(this._n,".addBlacklist"),T=this._userM.getMyAccount();return n.userIDList.length===1&&n.userIDList[0]===T?(s=this._userM.getErrMsg(a=Je.CANNOT_ADD_SELF_TO_BLACKLIST),m.setCode(a).setMessage(s).end(),s=new po({code:a}),K.e("".concat(I," failed. error:"),s),De(s)):(n.userIDList.includes(T)&&(n.userIDList=n.userIDList.filter(function(D){return D!==T})),n.fromAccount=this._userM.getMyAccount(),n.toAccount=n.userIDList,this._userM.req({P:de.ADD_TO_BL,data:n}).then(function(D){return m.setMessage(5<n.userIDList.length?"userIDList.length:".concat(n.userIDList.length):"userIDList:".concat(n.userIDList)).end(),K.i("".concat(I," ok")),h._handleResponse(D.resultItem,!0),Kt(P(h._blacklistMap.keys()))}).catch(function(D){return m.setError(D).end(),K.e("".concat(I," failed. error:"),D),De(D)}))}},{key:"_handleResponse",value:function(n,a){if(!Tt(n))for(var s,h,m,I=0,T=n.length;I<T;I++)h=n[I].to,m=n[I].resultCode,!et(m)&&m!==0||(a?((s=this._blacklistMap.has(h)?this._blacklistMap.get(h):new Ru).userID=h,Tt(n[I].addBlackTimeStamp)||(s.timeStamp=n[I].addBlackTimeStamp),this._blacklistMap.set(h,s)):this._blacklistMap.has(h)&&(s=this._blacklistMap.get(h),this._blacklistMap.delete(h)));K.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(a))}},{key:"deleteBlacklist",value:function(n){var a=this,s="".concat(this._n,".deleteBlacklist"),h=new ct("removeFromBlacklist");return n.fromAccount=this._userM.getMyAccount(),n.toAccount=n.userIDList,this._userM.req({P:de.RM_FROM_BL,data:n}).then(function(m){return h.setMessage(5<n.userIDList.length?"userIDList.length:".concat(n.userIDList.length):"userIDList:".concat(n.userIDList)).end(),K.i("".concat(s," ok")),a._handleResponse(m.data.resultItem,!1),Kt(P(a._blacklistMap.keys()))}).catch(function(m){return h.setError(m).end(),K.e("".concat(s," failed. error:"),m),De(m)})}},{key:"onAccountDeleted",value:function(n){for(var a=0,s=n.length;a<s;a++){var h=n[a];this._blacklistMap.has(h)&&this._blacklistMap.delete(h)}var m=n.length;0<m&&(K.l("".concat(this._n,".onAccountDeleted count:").concat(m," ").concat(m<30?"userIDList:".concat(n):"")),this._userM.emitOEvt(W.BLACKLIST_UPDATED,P(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(n){for(var a,s=[],h=0,m=n.length;h<m;h++)a=n[h],this._blacklistMap.has(a)||(this._blacklistMap.set(a,new Ru({userID:a})),s.push(a));0<s.length&&(K.l("".concat(this._n,".onAccountAdded count:").concat(s.length," userIDList:"),s),this._userM.emitOEvt(W.BLACKLIST_UPDATED,P(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this._startIndex=0}}]),T1=p(function n(a){u(this,n),this._userM=a,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userM.getIEmitInst().on(So.CLOUD_CONFIG,this._onCloudConfig,this)},[{key:"_onCloudConfig",value:function(){var n=this._userM.getCloudConfig("status_query_count"),a=this._userM.getCloudConfig("status_sub_count"),s=this._userM.getCloudConfig("status_unsub_count");K.l("".concat(this._n,"._onCloudConfig statusQueryCount:").concat(n," statusSubscribeCount:").concat(a)+" statusUnsubscribeCount:".concat(s)),et(n)||(this.MAX_QUERY_USER_COUNT=parseInt(n,10)),et(n)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(a,10)),et(n)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(s,10))}},{key:"onUserStatusUpdated",value:function(h){var h=h.dataList,a=this._userM.getMyUserID(),s=this._userM.get(12),h=h.map(function(D){var I=D.to,T=D.statusType,D=D.customStatus,D=Up(D);return I===a&&s.setCustomStatus(D),{userID:I,statusType:T,customStatus:D}});K.l("".concat(this._n,".onUserStatusUpdated list:").concat(JSON.stringify(h))),this._userM.emitOEvt(W.USER_STATUS_UPDATED,h)}},{key:"setSelfStatus",value:function(n){var a,s,h=this,m="".concat(this._n,".setSelfStatus");return this._userM.filterProfanity("customStatus",n)===!1?De({code:Je.PROFANITY_FOUND}):(a=new ct("setSelfStatus"),s=n.customStatus,this._userM.req({P:de.SET_SELF_STATUS,data:{customStatus:s}}).then(function(I){return a.setMessage("customStatus:".concat(s)).end(),K.l("".concat(m," ok. customStatus:").concat(s)),h._userM.get(12).setCustomStatus(s),Kt({userID:h._userM.getMyUserID(),statusType:1,customStatus:s})}).catch(function(I){return a.setError(I).end(),K.e("".concat(m," failed. error:"),I),De(I)}))}},{key:"getUserStatus",value:function(h){var a="".concat(this._n,".").concat("getUserStatus"),h=h.userIDList,s=h===void 0?[]:h,h=this._userM.getMyUserID(),m=P(s),I=void 0,T=m.indexOf(h);if(-1<T&&(m.splice(T,1),I={userID:h,statusType:1,customStatus:this._userM.get(12).getCustomStatus()}),m.length===0)return ln({successUserList:[I],failureUserList:[]});if(!this._userM.canIUse(ye.USER_STATUS))return this._userM.noUse("getUserStatus");m.length>this.MAX_QUERY_USER_COUNT&&(K.w("".concat(a," ").concat(lc(this.MAX_QUERY_USER_COUNT))),m=s.slice(0,this.MAX_QUERY_USER_COUNT));var D=new ct("getUserStatus");return this._userM.req({P:de.GET_USER_STATUS,data:{userIDList:m}}).then(function(q){var q=q.data,$=q.successUserList,$=$===void 0?[]:$,q=q.failureUserList,q=q===void 0?[]:q,$=$.map(function(Xe){var fe=Xe.userID,He=Xe.statusType,Xe=Xe.customStatus;return{userID:fe,statusType:He,customStatus:Up(Xe)}}),q=q.map(function(Ye){var fe=Ye.userID,He=Ye.invalidUserID,Xe=Ye.errorCode,Ye=Ye.errorInfo;return{userID:Tt(He)?fe:He,code:Xe,message:Ye}}),se=(et(I)||$.unshift(I),"userID count:".concat(s.length,", success count:").concat($.length,", fail count:").concat(q.length));return D.setMessage("".concat(se)).end(),K.l("".concat(a," ok. ").concat(se,".")),Kt({successUserList:$,failureUserList:q})}).catch(function(V){return D.setMessage("userID count:".concat(s.length)).setError(V).end(),K.e("".concat(a," failed. error:"),V),De(V)})}},{key:"subscribeUserStatus",value:function(n){var a,s,h,m,I="subscribeUserStatus";return this._userM.canIUse(ye.USER_STATUS)?(a="".concat(this._n,".").concat(I),(s=P(n=(n=n.userIDList)===void 0?[]:n)).length>this.MAX_SUBSCRIBE_USER_COUNT&&(K.w("".concat(a," ").concat(lc(this.MAX_SUBSCRIBE_USER_COUNT))),s=n.slice(0,this.MAX_SUBSCRIBE_USER_COUNT)),h=new ct(I),m="userID count:".concat(n.length),K.l("".concat(a," ").concat(m)),this._userM.req({P:de.SUB_USER_STATUS,data:{userIDList:s}}).then(function(T){return T=T.data.failureUserList,T=(T===void 0?[]:T).map(function(se){var V=se.userID,$=se.invalidUserID,q=se.errorCode,se=se.errorInfo;return{userID:Tt($)?V:$,code:q,message:se}}),h.setMessage("".concat(m," fail count:").concat(T.length)).end(),K.l("".concat(a," ok. fail count:").concat(T.length,".")),Kt({failureUserList:T})}).catch(function(T){return h.setMessage(m).setError(T).end(),K.e("".concat(a," failed. error:"),T),De(T)})):this._userM.noUse(I)}},{key:"unsubscribeUserStatus",value:function(n){var a,s,h,m,I="unsubscribeUserStatus";return this._userM.canIUse(ye.USER_STATUS)?(a="".concat(this._n,".").concat(I),s=P(n=(n=(n||{}).userIDList)===void 0?[]:n),n.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(K.w("".concat(a," ").concat(lc(this.MAX_UNSUBSCRIBE_USER_COUNT))),s=n.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT)),h=new ct(I),m="userID count:".concat(n.length),K.l("".concat(a," ").concat(m)),n={userIDList:s},s.length===0&&(n.userIDList=void 0,n.unsubscribeAll=1),this._userM.req({P:de.UNSUB_USER_STATUS,data:n}).then(function(T){return T=T.data.failureUserList,T=(T===void 0?[]:T).map(function(se){var V=se.userID,$=se.invalidUserID,q=se.errorCode,se=se.errorInfo;return{userID:Tt($)?V:$,code:q,message:se}}),h.setMessage("".concat(m," fail count:").concat(T.length)).end(),K.l("".concat(a," ok. fail count:").concat(T.length,".")),Kt({failureUserList:T})}).catch(function(T){return h.setMessage("".concat(m)).setError(T).end(),K.e("".concat(a," failed. error:"),T),De(T)})):this._userM.noUse(I)}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),Fv=(S(Gp,$o),p(Gp,[{key:"onContextUpdated",value:function(n){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(n,a){K.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(n," avatar:").concat(a)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:Gt.NICK,value:n},{tag:Gt.AVATAR,value:a}]}]})}},{key:"onProfileModified",value:function(n){this._profileHandler.onProfileModified(n)}},{key:"onRelationChainModified",value:function(h){var a,s,h=h.dataList;Tt(h)||(a=[],h.forEach(function(m){m.blackListDelAccount&&a.push.apply(a,P(m.blackListDelAccount))}),0<a.length&&this._blacklistHandler.onAccountDeleted(a),s=[],h.forEach(function(m){m.blackListAddAccount&&s.push.apply(s,P(m.blackListAddAccount))}),0<s.length&&this._blacklistHandler.onAccountAdded(s))}},{key:"onConvProfileUpdated",value:function(n){this._profileHandler.onConvProfileUpdated(n)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.get(13)}},{key:"filterProfanity",value:function(n,a){var s,h=this.get(29);return!h||(s=(h=h.filterText(a[n],"user_profile")).isAllowedToSend,h=h.modifiedText,s===!0&&(a[n]=h,!0))}},{key:"isMyFriend",value:function(n){var a=this.get(8);return!!a&&a.isMyFriend(n)}},{key:"getUserProfile",value:function(n){return this._profileHandler.getUserProfile(n)}},{key:"updateMyProfile",value:function(n){return this._profileHandler.updateMyProfile(n)}},{key:"getNickAndAvatarByUserID",value:function(n){return this._profileHandler.getNickAndAvatarByUserID(n)}},{key:"getUserNickAndAvatar",value:function(n){return this._profileHandler.getUserNickAndAvatar(n)}},{key:"getLocalBlacklist",value:function(){var n=this._blacklistHandler.getLocalBlacklist();return ln(n)}},{key:"addBlacklist",value:function(n){return this._blacklistHandler.addBlacklist(n)}},{key:"deleteBlacklist",value:function(n){return this._blacklistHandler.deleteBlacklist(n)}},{key:"onUserStatusUpdated",value:function(n){this._userStatusHandler.onUserStatusUpdated(n)}},{key:"setSelfStatus",value:function(n){return this._userStatusHandler.setSelfStatus(n)}},{key:"getUserStatus",value:function(n){return this._userStatusHandler.getUserStatus(n)}},{key:"subscribeUserStatus",value:function(n){return this._userStatusHandler.subscribeUserStatus(n)}},{key:"unsubscribeUserStatus",value:function(n){return this._userStatusHandler.unsubscribeUserStatus(n)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}])),pc=p(function n(a,s){u(this,n),this._m=a,this._isLoggedIn=!1,this._SDKAppID=s.SDKAppID,this._userID=s.userID||"",this._userSig=s.userSig||"",this._version="3.5.4",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=s.unlimitedAVChatRoom,this._scene=s.scene||"",this._oversea=s.oversea,this._instanceID=s.instanceID,this._statusInstanceID=0,this._isDevMode=s.devMode,this._isTestEnv=s.testEnv,this._proxyServer=s.proxyServer,this._fileUploadProxy=s.fileUploadProxy,this._fileDownloadProxy=s.fileDownloadProxy,this._applicationID=0,this._isPartialUpdatedConvs=s.partialUpdatedConversations,this._isIndependentDomainDisabled=s.disableIndependentDomain,this._isUsingChatCore=!1,this._uiPlatform=0,this._authKey="",this._customLoginInfo=""},[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isTestEnv",value:function(){return this._isTestEnv}},{key:"isPartialUpdatedConvs",value:function(){return this._isPartialUpdatedConvs}},{key:"isIndependentDomainDisabled",value:function(){return this._isIndependentDomainDisabled}},{key:"isSingaporeSite",value:function(){return 2e7<=this._SDKAppID&&this._SDKAppID<3e7||172e7<=this._SDKAppID&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return 3e7<=this._SDKAppID&&this._SDKAppID<4e7||173e7<=this._SDKAppID&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return 4e7<=this._SDKAppID&&this._SDKAppID<5e7||174e7<=this._SDKAppID&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return 5e7<=this._SDKAppID&&this._SDKAppID<6e7||175e7<=this._SDKAppID&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return 6e7<=this._SDKAppID&&this._SDKAppID<7e7||176e7<=this._SDKAppID&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return 7e7<=this._SDKAppID&&this._SDKAppID<8e7||177e7<=this._SDKAppID&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return 8e7<=this._SDKAppID&&this._SDKAppID<9e7||178e7<=this._SDKAppID&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return(n=this._SDKAppID)===0||2e7<=n&&n<9e7||172e7<=n&&n<179e7;var n}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(n){this._isUsingChatCore=n}},{key:"getUIPlatform",value:function(){return this._uiPlatform}},{key:"setUIPlatform",value:function(n){this._uiPlatform=n}},{key:"setUserID",value:function(n){this._userID=n}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(n){this._userSig=n}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(n){this._tinyID=n,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(n){this._customStatus=n}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return Sn?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(n){this._statusInstanceID=n}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(n){this._a2Key=n}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(n){this._applicationID=n}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"setDowloadFileAuthKey",value:function(n){this._authKey=n}},{key:"getDownloadFileAuthKey",value:function(){return this._authKey}},{key:"setCustomLoginInfo",value:function(n){this._customLoginInfo=n}},{key:"getCustomLoginInfo",value:function(){return this._customLoginInfo}},{key:"_isTUIKit",value:function(){var n=!1,a=!1,s=!1,h=!1,D=[];_e&&(D=Object.keys(je));for(var m=0,I=(D=Ke?Object.keys(Ge?uni:window):D).length;m<I;m++)if(D[m].toLowerCase().includes("uikit")){n=!0;break}var T,D=null,V=(_e&&!No(je.createGamePortal)&&No(getApp)&&!et(getApp())&&(T=getApp().globalData,On(T))&&T.isTUIKit===!0&&(a=!0),this._m.get(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))===!0&&(s=!0),null);if(Fe&&!xe&&typeof uni>"u"&&__wxConfig&&(V=__wxConfig.pages),be&&typeof uni>"u"&&__qqConfig&&(V=__qqConfig.pages),wt(V)&&0<V.length){for(var $=0,q=V.length;$<q;$++)if(V[$].toLowerCase().includes("tui")){h=!0;break}V=null}return n||a||s||h}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),NI={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12,"k-rn":13},PI=(S(Vp,$o),p(Vp,[{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&n%this._helloInterval==0&&this._hello()}},{key:"getPushModule",value:function(){var n=void 0,a=this.get(36),s=this.get(28);return a.canIUseTIMPush()?n=a:s.canIUseOfflinePush()&&(n=s),n}},{key:"login",value:function(n){if(this.isLoggedIn())return s=this.getMyUserID(),(s=this.getErrMsg("RepeatLogin",s))&&K.w(s),ln({actionStatus:"OK",errorCode:0,errorInfo:s,repeatLogin:!0});if(Date.now()-this._lastLoginTs<=15e3)return this.warn("LoggingIn",n.userID),De({code:Je.REPEAT_LOGIN});K.l("".concat(this._n,".login userID:").concat(n.userID));var a,s=this._checkLoginInfo(n);return s.code!==0?De(s):(s=this.get(12),a=n.userID,n=n.userSig,s.setUserID(a),s.setUserSig(n),this.get(20).updateProtocolConfig(),this._login())}},{key:"_login",value:function(){var n=this,a=this.get(12),s=a.getScene(),h=0,m=s,I=(s&&s.startsWith("k-")&&(m=NI[s],s="tuikit"),new ct("login")),D=(I.setMessage("".concat(m)).setMoreMessage("identifier:".concat(this.getMyUserID())),s==="tuikit"),T=0,D=(Ge?T=D?m===3||m===4||m===5||m===6?31:m===9||m===10||m===11||m===12?32:4:3:_e?T=Oe?36:s==="tuikit"?12:11:Ke?T=Sn?s==="flutter_web_uikit"?21:20:this._isReactUIKit()?dn?25:24:D?m===1||m===2?29:m===7||m===8?30:dn?17:14:dn?16:13:m===13&&(T=38),I.setUIPlatform(T),a.setUIPlatform(T),this.getPushModule()),V=(D&&(this._isWebUniapp=D.getUniAppPlatform(),m=this._getStatusInstanceID(),a.setStatusInstanceID(m),this.get(20).updateProtocolConfig(),h=D.getDeviceBrand()),"".concat(this._n,"._login"));return this._lastLoginTs=Date.now(),this.req({P:de.LOGIN,data:{deviceBrand:h,isWebUniapp:this._isWebUniapp,customInfo:a.getCustomLoginInfo()}}).then(function($){n._lastLoginTs=0;var Pn=Date.now(),q=null,yt=$.data,se=yt.a2Key,me=yt.tinyID,fe=yt.helloInterval,He=yt.instanceID,Xe=yt.timeStamp,Ye=yt.customStatus,Ye=Ye===void 0?"":Ye,Lt=yt.purchaseBits,yt=yt.authKey,yt=yt===void 0?"":yt,rn=1e3*Xe,on=Pn-I.getStartTs(),on=rn+parseInt(on/2)-Pn,Pn=I.getStartTs()+on;if(I.start(Pn),Pn=rn,Nt=on,(rn=new Date).setTime(Pn),K.i("baseTime from server:".concat(rn," offset:").concat(Nt)),me){if(se)return Pn=n.get(21).getSocketID(),rn=Up(Ye),Ye="socketID:".concat(Pn," scene:").concat(s," helloInterval:").concat(fe," instanceID:").concat(He," timeStamp:").concat(Xe)+" offset:".concat(on," customStatus:").concat(rn," isWebUniapp:").concat(n._isWebUniapp),K.l("".concat(V," ok. ").concat(Ye)),Xe=Pn="",Fe&&No(je.getAccountInfoSync)&&(on=je.getAccountInfoSync().miniProgram)&&(Pn=on.appId,Xe=on.envVersion),I.setMoreMessage("".concat(Ye," href:").concat(Ke?window.location.href:""," mpAppId:").concat(Pn," envVersion:").concat(Xe," authKey:").concat(yt)).end(),a.setA2Key(se),a.setTinyID(me),a.setStatusInstanceID(He),a.setCustomStatus(rn),a.setDowloadFileAuthKey(yt),Lt&&n.get(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:Lt}),n.get(20).updateProtocolConfig(),n.emitIEvt(So.A2KEY_AND_TINYID_UPDATED),n._helloInterval=fe,n.triggerReady(),(on=n.getPushModule())&&(uni.setStorageSync("timUniAppInstanceID",He),on.init()),n._fetchCloudControlConfig(),n.get(29).init(),$;q=new po({code:Je.NO_A2KEY})}else q=new po({code:Je.NO_TINYID});throw I.setError(q).end(),q}).catch(function($){return I.setError($).end(!0),n._m.setNotReadyReason(Je.LOGIN_FAILED),K.e("".concat(V," failed. error:"),$),n._lastLoginTs=0,n._m.onLoginFailed(),De($)})}},{key:"logout",value:function(){var n=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s="".concat(this._n,".logout"),h=this.isLoggedIn();return K.i("".concat(s," type:").concat(a," isLoggedIn:").concat(h," isWebUniapp:").concat(this._isWebUniapp)),h?(new ct("logout").setMessage("identifier:".concat(this.getMyUserID())).end(!0),a===0&&this._m.setNotReadyReason(Je.LOGGED_OUT),this.req({P:de.LOGOUT,data:{type:a,isWebUniapp:this._isWebUniapp}}).then(function(){return n.resetReady(),ln({})}).catch(function(m){return K.e("".concat(s," error:"),m),n.resetReady(),ln({})})):De({code:Je.USER_NOT_LOGGED_IN})}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.get(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")||0}},{key:"_hello",value:function(){var n=this;this._lastWsHelloTs=Date.now(),this.req({P:de.HELLO,data:{isWebUniapp:this._isWebUniapp}}).catch(function(a){K.w("".concat(n._n,"._hello error:"),a)})}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(n){var a=0;return Tt(this.get(12).getSDKAppID())?a=Je.NO_SDKAPPID:Tt(n.userID)?a=Je.NO_IDENTIFIER:Tt(n.userSig)&&(a=Je.NO_USERSIG),{code:a}}},{key:"_isReactUIKit",value:function(){return Ke&&window.tencent_cloud_im_csig_react_uikit_23F_xa!==void 0}},{key:"onMultipleAccountKickedOut",value:function(n){var a=this;new ct("kickedOut").setMessage("type:".concat(O.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),K.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.logout(1).then(function(){a.emitOEvt(W.KICKED_OUT,{type:O.KICKED_OUT_MULT_ACCOUNT}),a._m.setNotReadyReason(Je.KICKED_OUT_MULT_ACCOUNT),a._m.reset()})}},{key:"onMultipleDeviceKickedOut",value:function(n){var a=this;new ct("kickedOut").setMessage("type:".concat(O.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),K.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.logout(1).then(function(){a.emitOEvt(W.KICKED_OUT,{type:O.KICKED_OUT_MULT_DEVICE}),a._m.setNotReadyReason(Je.KICKED_OUT_MULT_DEVICE),a._m.reset()})}},{key:"onUserSigExpired",value:function(){new ct("kickedOut").setMessage(O.KICKED_OUT_USERSIG_EXPIRED).end(!0),K.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),this.get(12).getStatusInstanceID()!==0&&(this.emitOEvt(W.KICKED_OUT,{type:O.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(Je.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(n){new ct("kickedOut").setMessage("type:".concat(O.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(n))).end(!0),K.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),n),this.get(12).getStatusInstanceID()!==0&&(this.emitOEvt(W.KICKED_OUT,{type:O.KICKED_OUT_REST_API}),this._m.setNotReadyReason(Je.KICKED_OUT_REST_API),this._m.reset(),this.get(21).onRestApiKickedOut())}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]));function Vp(n){return u(this,Vp),(n=c(this,Vp,[n]))._n="SignModule",n._helloInterval=120,n._lastLoginTs=0,n._lastWsHelloTs=0,n._isWebUniapp=0,Sh.mixin(n),n}function Gp(n){return u(this,Gp),(n=c(this,Gp,[n]))._n="UserModule",n._profileHandler=new pa(n),n._blacklistHandler=new E1(n),n._userStatusHandler=new T1(n),n.getIEmitInst().on(So.A2KEY_AND_TINYID_UPDATED,n.onContextUpdated,n),n}function Bp(n){return u(this,Bp),(n=c(this,Bp,[n]))._n="TopicModule",n._topicMap=new Map,n._getTopicTimeMap=new Map,n.TOPIC_CACHE_TIME=300,n.TOPIC_LAST_ACTIVE_TIME=3600,n.getIEmitInst().on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function Hp(n){return u(this,Hp),(n=c(this,Hp,[n]))._n="GroupModule",n._commonGroupHandler=new d1(n),n._groupAttributesHandler=new h1(n),n._groupCountersHandler=new f1(n),n._AVChatRoomHandler=new p1(n),n._groupTipsHandler=new u1(n),n._groupSystemNoticeHandler=new _1(n),n._groupMemberHandler=new g1(n),n.groupMap=new Map,n._unjoinedAVChatRoomList=new Map,n._receiptDetailCompleteMap=new Map,n._onlineMemberCountMap=new Map,n._timeoutIDs=[],n.getIEmitInst().on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function $p(n){return u(this,$p),(n=c(this,$p,[n]))._n="ConvModule",Sh.mixin(n),n._msgListHandler=new Pp(n),n._msgRemindHandler=new c1(n),n._convGroupHandler=new Fp(n),n._sll=new Mh(100),n._pagingStatus=Vs,n._pagingTs=0,n._pagingStartIdx=0,n._pagingPinnedTs=0,n._pagingPinnedStartIdx=0,n._pagingConvIDMap=new Map,n._convIDFromUnreadDBMap=new Map,n._convMap=new Map,n._tmpGroupList=[],n._tmpGroupAtTipsList=[],n._peerReadTimeMap=new Map,n._completedMap=new Map,n._roamingMsgKeyAndTimeMap=new Map,n._remoteGroupReadSeqMap=new Map,n._convTotalUnreadCount=0,n._pagingGetCostList=[],n._convMapForDiff=new Map,n._partialUpdatedConvMap=new Map,n._everClearedMap=new Map,n._bPullOnInvite=!0,n._initListeners(),n}function qp(){return null}function Vv(n){var a=n.get(12);return{SDKType:10,SDKAppID:a.getSDKAppID(),SDKVersion:a.getVersion(),tinyID:Number(a.getTinyID()),userID:a.getUserID(),platform:n.getPlatform(),instanceID:a.getInstanceID(),traceID:Dn()}}var M1=p(function n(a){u(this,n),this._m=a,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()},[{key:"_errorTolerantHandle",value:function(){_e||typeof window<"u"&&this._canIUseCookies()||(this.getItem=qp,this.setItem=qp,this.removeItem=qp,this.clear=qp)}},{key:"onCheckTimer",value:function(n){n%20==0&&this._storageQueue.size!==0&&this._doFlush()}},{key:"_doFlush",value:function(){try{var n,a=v(this._storageQueue);try{for(a.s();!(n=a.n()).done;){var s=x(n.value,2),h=s[0],m=s[1];this._setStorageSync(this._getKey(h),m)}}catch(I){a.e(I)}finally{a.f()}this._storageQueue.clear()}catch(I){K.w("".concat(this._n,"._doFlush error:"),I)}}},{key:"_getPrefix",value:function(){var n=this._m.get(12);return"TIM_".concat(n.getSDKAppID(),"_").concat(n.getUserID(),"_")}},{key:"_getKey",value:function(n){return"".concat(this._getPrefix()).concat(n)}},{key:"getItem",value:function(n){var a=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var s=a?this._getKey(n):n;return this.getStorageSync(s)}catch(h){return K.w("".concat(this._n,".getItem error:"),h),{}}}},{key:"setItem",value:function(n,a){var s;2<arguments.length&&arguments[2]!==void 0&&arguments[2]?(s=!(3<arguments.length&&arguments[3]!==void 0)||arguments[3]?this._getKey(n):n,this._setStorageSync(s,a)):this._storageQueue.set(n,a)}},{key:"clear",value:function(){try{_e?je.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(n){K.w("".concat(this._n,".clear error:"),n)}}},{key:"removeItem",value:function(n){var a=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];try{var s=a?this._getKey(n):n;this._removeStorageSync(s)}catch(h){K.w("".concat(this._n,".removeItem error:"),h)}}},{key:"getSize",value:function(n){var a=this,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"b";try{var h={size:0,limitSize:5242880,unit:s};if(Object.defineProperty(h,"leftSize",{enumerable:!0,get:function(){return h.limitSize-h.size}}),_e&&(h.limitSize=1024*je.getStorageInfoSync().limitSize),n)h.size=JSON.stringify(this.getItem(n)).length+this._getKey(n).length;else if(_e)je.getStorageInfoSync().keys.forEach(function(I){h.size+=JSON.stringify(a.getStorageSync(I)).length+a._getKey(I).length});else if(this._canIUseCookies())for(var m in localStorage)localStorage.hasOwnProperty(m)&&(h.size+=localStorage.getItem(m).length+m.length);return this._convertUnit(h)}catch(I){K.w("".concat(this._n," error:"),I)}}},{key:"_convertUnit",value:function(n){var a,s={},h=n.unit;for(a in s.unit=h,n)typeof n[a]=="number"&&(h.toLowerCase()==="kb"?s[a]=Math.round(n[a]/1024):h.toLowerCase()==="mb"?s[a]=Math.round(n[a]/1024/1024):s[a]=n[a]);return s}},{key:"_setStorageSync",value:function(n,a){_e?rt?my.setStorageSync({key:n,data:a}):je.setStorageSync(n,a):this._canIUseCookies()&&localStorage.setItem(n,JSON.stringify(a))}},{key:"getStorageSync",value:function(n){return _e?rt?my.getStorageSync({key:n}).data:je.getStorageSync(n):this._canIUseCookies()?JSON.parse(localStorage.getItem(n)):{}}},{key:"_removeStorageSync",value:function(n){_e?rt?my.removeStorageSync({key:n}):je.removeStorageSync(n):this._canIUseCookies()&&localStorage.removeItem(n)}},{key:"_canIUseCookies",value:function(){return typeof window<"u"&&navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._doFlush()}}]),k1=p(function n(a){u(this,n),this._n="SSOLogBody",this._report=[]},[{key:"pushIn",value:function(n){K.d("".concat(this._n,".pushIn"),this._report.length,n),this._report.push(n)}},{key:"backfill",value:function(n){var a;wt(n)&&n.length!==0&&(K.d("".concat(this._n,".backfill"),this._report.length,n.length),(a=this._report).unshift.apply(a,P(n)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return this._report.length===0}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var n=this._report.slice();return this._reset(),n}}]),w1=(S(zp,$o),p(zp,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var n=this,a=this.get(13),s=a.getItem(this.TAG,!1);!Tt(s)&&No(s.forEach)&&(K.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(s.length)),s.forEach(function(h){n._reportBody.pushIn(h)}),a.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("evt_rpt_threshold"),a=this.getCloudConfig("evt_rpt_waiting"),s=this.getCloudConfig("evt_rpt_level"),h=this.getCloudConfig("evt_rpt_sdkappid_bl"),m=this.getCloudConfig("evt_rpt_tinyid_wl");et(n)||(this.MIN_THRESHOLD=Number(n)),et(a)||(this.WAITING_TIME=Number(a)),et(s)||(this.REPORT_LEVEL=s.split(",").map(function(I){return Number(I)})),et(h)||(this.REPORT_SDKAPPID_BLACKLIST=h.split(",").map(function(I){return Number(I)})),et(m)||(this.REPORT_TINYID_WHITELIST=m.split(","))}},{key:"pushIn",value:function(n){n instanceof ct&&(n.updateTimeStamp(),this._reportBody.pushIn(n),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD)&&this._report()}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(n){var a=this,h=this.get(12),s=h.getSDKAppID(),h=h.getTinyID();return yp(this.REPORT_SDKAPPID_BLACKLIST,s)&&!SI(this.REPORT_TINYID_WHITELIST,h)?[]:n.filter(function(m){return a.REPORT_LEVEL.includes(m.level)})}},{key:"_report",value:function(){var n,a,s=this;this._reportBody.isEmpty()||(n=this._reportBody.getLogsInMemory(),(a=this._filterLogs(n)).length!==0?(a={header:Vv(this),event:a},this.req({P:de.SSO_STAT,data:E({},a)}).then(function(){s._lastReportTime=Date.now()}).catch(function(h){K.w("".concat(s._n,"._report failed. error:"),h),s._lastReportTime=Date.now(),s._reportBody.backfill(n),s._reportBody.getLogsNumInMemory()>s.MAX_THRESHOLD&&s._flushAtOnce()})):this._lastReportTime=Date.now())}},{key:"_flushAtOnce",value:function(){var n=this.get(13),a=n.getItem(this.TAG,!1),s=this._reportBody.getLogsInMemory(),h="".concat(this._n,"._flushAtOnce");Tt(a)?(K.l("".concat(h," count:").concat(s.length)),n.setItem(this.TAG,s,!0,!1)):((s=s.concat(a)).length>this.MAX_THRESHOLD&&(s=s.slice(0,this.MAX_THRESHOLD)),K.l("".concat(h," count:").concat(s.length)),n.setItem(this.TAG,s,!0,!1))}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}])),Kp="none",Gv="online",R1=p(function n(a){u(this,n),this._m=a,this._networkType=Gv,this._n="NetMonitorModule",this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null,this._removeListener=null,this._m.getIEmitInst().on(So.A2KEY_AND_TINYID_UPDATED,this._startRN,this)},[{key:"_startRN",value:function(){var n,a=this;Re&&(n=this._m.get(18).getPlugin("chat-network-monitor"))&&(this._removeListener=n.addEventListener(function(m){var h=m.isConnected,m=m.type;a._networkType!==m&&a._onNetworkStatusChange({isConnected:h!==void 0&&h,networkType:m})}))}},{key:"start",value:function(){var n=this,a="".concat(this._n,".start");_e?(je.getNetworkType({success:function(s){n._networkType=s.networkType||s.subtype||"",s.networkType===Kp?K.w("".concat(a," no network, please check!")):K.i("".concat(a," networkType:").concat(s.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),je.onNetworkStatusChange(this._mpNetworkStatusCallback)):Ke&&(this._networkType=Gv,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:Gv})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:Kp})}},{key:"_onNetworkStatusChange",value:function(s){var a=s.isConnected,s=s.networkType,h="".concat(this._n,"._onNetworkStatusChange"),m=!1,I="previous:".concat(this._networkType," current:").concat(s);a?(K.i("".concat(h," ").concat(I)),this._networkType!==s&&(m=!0,this._networkType=s,this._m.get(21).reConnect(!0))):this._networkType!==s&&(m=!0,this._networkType=s,K.w("".concat(h," no network, please check!")),this._m.get(21).offline()),m&&new ct("networkChange").setMessage("isConnected:".concat(a," ").concat(I)).end()}},{key:"isOnline",value:function(){return this._networkType!==Kp}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),_e?this._mpNetworkStatusCallback!==null&&(je.offNetworkStatusChange&&je.offNetworkStatusChange(this._mpNetworkStatusCallback),this._mpNetworkStatusCallback=null):Ke?(this._webOnlineCallback!==null&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),this._onWebOffline!==null&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null)):Re&&this._removeListener&&(this._removeListener(),this._removeListener=null)}}]);function zp(n){u(this,zp),(n=c(this,zp,[n]))._n="EventStatModule",n.TAG="im-ssolog-event",n._reportBody=new k1,n.MIN_THRESHOLD=20,n.MAX_THRESHOLD=100,n.WAITING_TIME=6e4,n.REPORT_LEVEL=[4,5,6],n.REPORT_SDKAPPID_BLACKLIST=[],n.REPORT_TINYID_WHITELIST=[],n._lastReportTime=Date.now();var a=n.getIEmitInst();return a.on(So.A2KEY_AND_TINYID_UPDATED,n._onLoginSuccess,n),a.on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function Au(n,a){return n(a={exports:{}},a.exports),a.exports}var xI=Au(function(n){var a=Object.prototype.hasOwnProperty,s="~";function h(){}function m(V,$,q){this.fn=V,this.context=$,this.once=q||!1}function I(V,$,q,se,me){if(typeof q!="function")throw new TypeError("The listener must be a function");return q=new m(q,se||V,me),se=s?s+$:$,V._events[se]?V._events[se].fn?V._events[se]=[V._events[se],q]:V._events[se].push(q):(V._events[se]=q,V._eventsCount++),V}function T(V,$){--V._eventsCount==0?V._events=new h:delete V._events[$]}function D(){this._events=new h,this._eventsCount=0}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(s=!1)),D.prototype.eventNames=function(){var V,$,q=[];if(this._eventsCount===0)return q;for($ in V=this._events)a.call(V,$)&&q.push(s?$.slice(1):$);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(V)):q},D.prototype.listeners=function($){var $=s?s+$:$,q=this._events[$];if(!q)return[];if(q.fn)return[q.fn];for(var se=0,me=q.length,fe=new Array(me);se<me;se++)fe[se]=q[se].fn;return fe},D.prototype.listenerCount=function(V){return V=s?s+V:V,V=this._events[V],V?V.fn?1:V.length:0},D.prototype.emit=function(V,$,q,se,me,fe){var He=s?s+V:V;if(!this._events[He])return!1;var Xe,Ye=this._events[He],Lt=arguments.length;if(Ye.fn){switch(Ye.once&&this.removeListener(V,Ye.fn,void 0,!0),Lt){case 1:return Ye.fn.call(Ye.context),!0;case 2:return Ye.fn.call(Ye.context,$),!0;case 3:return Ye.fn.call(Ye.context,$,q),!0;case 4:return Ye.fn.call(Ye.context,$,q,se),!0;case 5:return Ye.fn.call(Ye.context,$,q,se,me),!0;case 6:return Ye.fn.call(Ye.context,$,q,se,me,fe),!0}for(on=1,Xe=new Array(Lt-1);on<Lt;on++)Xe[on-1]=arguments[on];Ye.fn.apply(Ye.context,Xe)}else for(var yt,rn=Ye.length,on=0;on<rn;on++)switch(Ye[on].once&&this.removeListener(V,Ye[on].fn,void 0,!0),Lt){case 1:Ye[on].fn.call(Ye[on].context);break;case 2:Ye[on].fn.call(Ye[on].context,$);break;case 3:Ye[on].fn.call(Ye[on].context,$,q);break;case 4:Ye[on].fn.call(Ye[on].context,$,q,se);break;default:if(!Xe)for(yt=1,Xe=new Array(Lt-1);yt<Lt;yt++)Xe[yt-1]=arguments[yt];Ye[on].fn.apply(Ye[on].context,Xe)}return!0},D.prototype.on=function(V,$,q){return I(this,V,$,q,!1)},D.prototype.once=function(V,$,q){return I(this,V,$,q,!0)},D.prototype.removeListener=function(V,$,q,se){if(V=s?s+V:V,this._events[V])if($){var me=this._events[V];if(me.fn)me.fn!==$||se&&!me.once||q&&me.context!==q||T(this,V);else{for(var fe=0,He=[],Xe=me.length;fe<Xe;fe++)(me[fe].fn!==$||se&&!me[fe].once||q&&me[fe].context!==q)&&He.push(me[fe]);He.length?this._events[V]=He.length===1?He[0]:He:T(this,V)}}else T(this,V);return this},D.prototype.removeAllListeners=function(V){return V?(V=s?s+V:V,this._events[V]&&T(this,V)):(this._events=new h,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=s,n.exports=D.EventEmitter=D}),A1=["rich.my-imcloud.com","imrich.qcloud.com"],D1=["requestSnapshotUrl"],O1=(S(Wp,$o),p(Wp,[{key:"_init",value:function(){this._fileDownloadProxy=this.getFileDownloadProxy(),this._authKey=this.getDownloadFileAuthKey();var n=this.get(18);this.TIMUploadPlugin=n.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin?this._initUploaderMethod():(this.COSSDK=n.getPlugin(n=_e?"cos-wx-sdk":"cos-js-sdk"),this.COSSDK?(this._getAuthorizationKey(),this.warn("CosReplacement",n)):this.warn("PluginUndetected"))}},{key:"_onCloudConfig",value:function(){var n=this,a="".concat(this._n,"._onCloudConfig"),s=this.getCloudConfig("upload_size_limit"),h=this.getCloudConfig("simple_cos"),m=this.getCloudConfig("file_dn_list");if(K.l("".concat(a," uploadSizeLimit:").concat(s," simpleCos:").concat(h)),!et(s))try{var I=JSON.parse(s);this.UPLOAD_SIZE_LIMIT={A:I.a?1048576*parseInt(I.a):this.UPLOAD_SIZE_LIMIT.A,F:I.f?1048576*parseInt(I.f):this.UPLOAD_SIZE_LIMIT.F,I:I.i?1048576*parseInt(I.i):this.UPLOAD_SIZE_LIMIT.I,V:I.v?1048576*parseInt(I.v):this.UPLOAD_SIZE_LIMIT.V}}catch{}if(et(h)||(this.isSimpleCos=h==="1"),!et(m))try{JSON.parse(m).forEach(function(T){n._fileDNList.includes(T)||n._fileDNList.push(T)})}catch{}}},{key:"_getAuthorizationKey",value:function(){var n=this,a="".concat(this._n,".").concat("_getAuthorizationKey"),s=new ct("_getAuthorizationKey"),h=Math.ceil(Date.now()/1e3);this.req({P:de.COS_SIGN,data:{duration:this.expiredTimeLimit}}).then(function(I){var I=I.data,T=(K.l("".concat(a," ok. data:"),I),I.expiredTime-h);s.setMessage("requestId:".concat(I.requestId," requestTime:").concat(h," expiredTime:").concat(I.expiredTime," diff:").concat(T,"s")).end(),!_e&&I.region&&(n.region=I.region),n.appid=I.appid,n.bucketName=I.bucketName,n.ciUrl=I.ciUrl,n.directory=I.directory,n.downloadUrl=I.downloadUrl,n.uploadUrl=I.uploadUrl,n.cosOptions={secretId:I.secretId,secretKey:I.secretKey,sessionToken:I.sessionToken,expiredTime:I.expiredTime},K.l("".concat(a," ok. region:").concat(n.region," bucketName:").concat(n.bucketName)),n._initUploaderMethod()}).catch(function(m){s.setError(m).end(),K.w("".concat(a," failed. error:"),m)})}},{key:"_getCosPreSigUrl",value:function(n){var a=this,s="".concat(this._n,".").concat("_getCosPreSigUrl"),h=Math.ceil(Date.now()/1e3),m=new ct("_getCosPreSigUrl"),I={uploadMethod:n.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:n.userID,conversationType:n.conversationType,uploadConfig:[{fileID:1,fileType:n.fileType,fileName:n.fileName}]},T=de.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(I={fileType:n.fileType,fileName:n.fileName,uploadMethod:n.uploadMethod,duration:n.duration},T=de.COS_PRE_SIG),this.req({P:T,data:I}).then(function(q){a.tryCount=0;var V,$,q=q.data||{},se=(K.l("".concat(s," ok. isSimpleCos:").concat(a.isSimpleCos," data:"),q),"");return se=a.isSimpleCos?(V=($=q.preSig[0]).uploadUrl,$=$.fileKey,"uploadIP:".concat(q.uploadIP," uploadUrl:").concat(V," fileKey:").concat($," cost:").concat(br(h))):"requestId:".concat(q.requestId," expiredTime:").concat(q.expiredTime," diff:").concat(q.expiredTime-h,"s"),m.setMessage(se).end(),q}).catch(function(D){return D.code===-1&&(D.code=Je.COS_GET_SIG_FAIL),m.setError(D).end(),K.w("".concat(s," failed. error:"),D),a.tryCount<1?(a.tryCount++,a._getCosPreSigUrl(n)):(a.tryCount=0,De({code:Je.COS_GET_SIG_FAIL}))})}},{key:"_initUploaderMethod",value:function(){var n=this;this.TIMUploadPlugin?(this.timUploadPlugin=new this.TIMUploadPlugin,this._cosUploadMethod=function(a,s){n.timUploadPlugin.uploadFile(a,s)}):this.appid&&(this.cos=_e?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=_e?function(a,s){n.cos.postObject(a,s)}:function(a,s){n.cos.uploadFiles(a,s)})}},{key:"onCheckTimer",value:function(n){!this.COSSDK||this.TIMUploadPlugin||this.isLoggedIn()&&n%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey()}},{key:"getFileDNList",value:function(){return this._fileDNList}},{key:"_getAuthorization",value:function(n,a){a({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(n){if(n._relayFlag===!0)return Promise.resolve();var a=this.get(26);switch(n.type){case O.MSG_IMAGE:return a.addTotalCount(Si),this._uploadImage(n);case O.MSG_FILE:return a.addTotalCount(Si),this._uploadFile(n);case O.MSG_AUDIO:return a.addTotalCount(Si),this._uploadAudio(n);case O.MSG_VIDEO:return a.addTotalCount(Si),this._uploadVideo(n);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(n){var a=this,s=this.get(2),h=n.getElements()[0],m=s.getMessageOption(n.clientSequence);return this.doUploadImage({file:m.payload.file,to:m.to,message:n,onProgress:function(I){if(h.updatePercent(I),No(m.onProgress))try{m.onProgress(I)}catch{return De({code:Je.MSG_ONPROGRESS_ERR})}}}).then(function(yt){var T=yt.location,D=yt.fileType,V=yt.fileSize,$=yt.width,q=yt.height,se=yt.smallImageUrl,me=yt.smallImageWidth,fe=yt.smallImageHeight,He=yt.largeImageUrl,Xe=yt.largeImageWidth,Ye=yt.largeImageHeight,Lt=yt.imageInfoArray,yt=a.isPrivateNetWork()?T:Wr(T);h.updateImageFormat(D);var rn,on,Pn={size:V,url:yt,width:$,height:q};if(Lt&&0<Lt.length)for(var Gn=0;Gn<Lt.length;Gn++){var Jn=Lt[Gn];Jn.type===1?rn=Jn:Jn.type===2?on=Jn:Pn=E(E({},Pn),Jn)}else on=se&&He?(rn={url:se,width:me,height:fe},{url:He,width:Xe,height:Ye}):(rn=fh({originUrl:yt,originWidth:$,originHeight:q,min:198}),fh({originUrl:yt,originWidth:$,originHeight:q,min:720}));return h.updateImageInfoArray([E({},Pn),E({},on),E({},rn)]),n})}},{key:"_uploadFile",value:function(n){var a=this,s=this.get(2),h=n.getElements()[0],m=s.getMessageOption(n.clientSequence);return this.doUploadFile({file:m.payload.file,to:m.to,message:n,onProgress:function(I){if(h.updatePercent(I),No(m.onProgress))try{m.onProgress(I)}catch{return De({code:Je.MSG_ONPROGRESS_ERR})}}}).then(function(T){var T=T.location,D=T;return a.isPrivateNetWork()||(D=Xo(D=Wr(T),a._fileDownloadProxy,a._authKey,a._fileDNList)),h.updateFileUrl(D),n})}},{key:"_uploadAudio",value:function(n){var a=this,s=this.get(2),h=n.getElements()[0],m=s.getMessageOption(n.clientSequence);return this.doUploadAudio({file:m.payload.file,to:m.to,message:n,onProgress:function(I){if(h.updatePercent(I),No(m.onProgress))try{m.onProgress(I)}catch{return De({code:Je.MSG_ONPROGRESS_ERR})}}}).then(function(I){return I=I.location,I=a.isPrivateNetWork()?I:Wr(I),h.updateAudioUrl(I),n})}},{key:"_uploadVideo",value:function(n){var a=this,s=this.get(2),h=n.getElements()[0],m=s.getMessageOption(n.clientSequence);return this.doUploadVideo({file:m.payload.file,to:m.to,message:n,onProgress:function(I){if(h.updatePercent(I),No(m.onProgress))try{m.onProgress(I)}catch{return De({code:Je.MSG_ONPROGRESS_ERR})}}}).then(function(T){var D=T.location,T=T.snapshotInfo,D=a.isPrivateNetWork()?D:Wr(D);return h.updateVideoUrl(D),Tt(T)||h.updateSnapshotInfo(T),n})}},{key:"_checkSizeError",value:function(n){var a="";return n==="A"?a="audio":n==="I"?a="image":n==="V"?a="video":n==="F"&&(a="file"),De({code:Je["MSG_".concat(n,"_SIZE_LIMIT")],message:this.getErrMsg("UploadSizeLimit",a,"".concat(this.UPLOAD_SIZE_LIMIT[n]/1048576,"MB"))})}},{key:"doUploadImage",value:function(n){var a,s,h=this;return!n.file||this._isEmptyFileList(n.file.files)?De({code:Je.MSG_I_SELECT_F_FIRST}):(a=this._checkImageType(n.file))!==!0||(a=this._checkImageSize(n.file))!==!0?a:(s=null,this._setUploadFileType(1),this.uploadByCOS(n).then(function(m){if(s=m,h.isPrivateNetWork())return _u(T);if(wt(s.imageInfoArray)){var I=s.imageInfoArray.find(function(D){return D.type===3});if(I)return I}var T;return Re?{width:n.file.width,height:n.file.height}:(T=Wr(m.location),h.COSSDK?_u(T):_u(T=Xo(T,h._fileDownloadProxy,h._authKey,h._fileDNList)))}).then(function(m){return s.width=m.width,s.height=m.height,Promise.resolve(s)}))}},{key:"_checkImageType",value:function(n){var a="",a=_e?n.url.slice(n.url.lastIndexOf(".")+1):Re?n.type.split("/")[1]:n.files[0].name.slice(n.files[0].name.lastIndexOf(".")+1);return 0<=xv.indexOf(a.toLowerCase())||De({code:Je.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(n){return(n=(_e||Re?n:n.files[0]).size)===0?De({code:Je.MSG_F_IS_EMPTY}):n<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(n){return!n.file||this._isEmptyFileList(n.file.files)?De({code:Je.MSG_F_SELECT_F_FIRST}):n.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):n.file.files[0].size===0?De({code:Je.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(n))}},{key:"doUploadVideo",value:function(n){return n.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):n.file.videoFile.size===0?De({code:Je.MSG_F_IS_EMPTY}):Eh.indexOf(n.file.videoFile.type)===-1?De({code:Je.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),_e||Re?this.handleVideoUpload(E(E({},n),{},{file:n.file.videoFile})):Ke?this.handleVideoUpload(n):void 0)}},{key:"handleVideoUpload",value:function(n){var a=this;return new Promise(function(s,h){a.uploadByCOS(n).then(function(m){s(m)}).catch(function(){a.uploadByCOS(n).then(function(m){s(m)}).catch(function(){h(new po({code:Je.MSG_V_UPLOAD_FAIL}))})})})}},{key:"doUploadAudio",value:function(n){return n.file?n.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):n.file.size===0?De({code:Je.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(n)):De({code:Je.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(n){var a,s,h,m,I=this;return No(this._cosUploadMethod)?this.timUploadPlugin?this._uploadWithPreSigUrl(n):(a=new ct("upload"),s="".concat(this._n,".uploadByCOS"),h=Date.now(),m=this._getFile(n),new Promise(function(T,D){var V=_e?I._createCosOptionsWXMiniApp(n):I._createCosOptionsWeb(n),$=I;I._cosUploadMethod(V,function(q,se){var me,fe,He=Object.create(null);se?q||wt(se.files)&&se.files[0].error?(me=new po({code:Je.MSG_F_UPLOAD_FAIL}),a.setError(me).end(),K.l("".concat(s," failed. error:"),se.files[0].error),se.files[0].error.statusCode===403&&I._getAuthorizationKey(),D(me)):(He.fileName=m.name,He.fileSize=m.size,He.fileType=m.type.slice(m.type.indexOf("/")+1).toLowerCase(),He.location=(_e?se:se.files[0].data).Location,me=Date.now()-h,se=$._formatFileSize(m.size),fe=$._formatSpeed(1e3*m.size/me),se="size:".concat(se," time:").concat(me,"ms speed:").concat(fe),K.l("".concat(s," success. name:").concat(m.name," ").concat(se)),T(He),(fe=I.get(26)).addCost(Si,me),fe.addFileSize(Si,m.size),a.setMessage(se).end()):(He=new po({code:Je.MSG_F_UPLOAD_FAIL}),a.setError(He).end(),K.w("".concat(s," failed. error:"),q),q.statusCode===403&&I._getAuthorizationKey(),D(He))})})):(this.warn("PluginUndetected"),De({code:Je.COS_UNDETECTED}))}},{key:"_uploadWithPreSigUrl",value:function(n){var a=this,s="".concat(this._n,"._uploadWithPreSigUrl"),h=this._getFile(n);return this._createCosOptionsPreSigUrl(n).then(function(m){return new Promise(function(I,T){var D=new ct("upload"),V=m.requestSnapshotUrl,$=V===void 0?void 0:V,q=N(m,D1),se=Date.now();a._cosUploadMethod(q,function(me,fe){if(me||fe.statusCode===403)D.setError(new po(me)).end(),Xe={HttpStatusCode:9999,CostTime:br(se,!1),error:me,url:m.url},fe.data&&fe.data.uploadIP&&(Xe.uploadIP=fe.data.uploadIP),a._uploadSSOLog(Xe),K.l("".concat(s," failed, error:"),me),T(new po({code:Je.MSG_F_UPLOAD_FAIL}));else{var He=Object.create(null),Xe=fe.data.location||"",me=(a.isPrivateNetWork()||Xe.indexOf("https://")!==0&&Xe.indexOf("http://")!==0||(Xe=Xe.split("//")[1]),He.fileName=h.name,He.fileSize=h.size,He.fileType=h.type.slice(h.type.indexOf("/")+1).toLowerCase(),He.location=Xe,br(se,!1)),Xe=a._formatFileSize(h.size),Ye=a._formatSpeed(1e3*h.size/me),Xe="size:".concat(Xe," time:").concat(me,"ms speed:").concat(Ye," res:").concat(JSON.stringify(fe.data)),Ye=(K.l("".concat(s," ok. name:").concat(h.name," ").concat(Xe)),D.setMessage(Xe).end(),{HttpStatusCode:fe.statusCode,FileSize:h.size,CostTime:me,url:m.url}),Xe=(fe.data&&fe.data.uploadIP&&(Ye.uploadIP=fe.data.uploadIP),a._uploadSSOLog(Ye),a.get(26)),Ye=(Xe.addCost(Si,me),Xe.addFileSize(Si,h.size),[]);if(q.thumbUrl&&q.largeUrl&&Ye.push.apply(Ye,[a._getSmallImageInfoByUrl(q.thumbUrl,He),a._getLargeImageInfoByUrl(q.largeUrl,He)]),a.uploadFileType===1&&a.isSimpleCos&&!a.isPrivateNetWork()&&(Ye.push(a._getImageInfoArray(q.downloadUrl,He)),fe.data.uploadIP)&&Ye.push(a._getDownloadIP(q.downloadUrl.split("//")[1].split("/")[0],He)),$&&Ye.push(a._getSnapshotInfoByUrl($,He)),0<Ye.length)return Promise.all(Ye).then(function(){I(He)});I(He)}})})})}},{key:"_getDownloadIP",value:function(n,a){var s="".concat(this._n,"._getDownloadIP"),h=Date.now();return this.req({P:de.GET_IP,data:{domainName:n}}).then(function(m){var I;m.data&&m.data.ip&&(K.l("".concat(s," ok. downloadIP:").concat(m.data.ip," cost:").concat(br(h))),(I=a.location.split("/"))[0]=m.data.ip,a.location=I.join("/"))}).catch(function(m){})}},{key:"_getImageInfoArray",value:function(n,a){var s=this,h="".concat(this._n,"._getImageInfoArray"),m=Date.now();return this.req({P:de.GET_IMAGE_INFO,data:{imageUrl:n}}).then(function(I){return I=I.data||{},K.l("".concat(h," ok. data: ").concat(JSON.stringify(I)," cost:").concat(br(m))),a.imageInfoArray=I.imageInfoArray,I}).catch(function(I){a.imageInfoArray=void 0,s._uploadSSOLog({HttpStatusCode:1e4,CostTime:br(m,!1),url:n})})}},{key:"_uploadSSOLog",value:function(n){var a,s;this.isSimpleCos&&((a=new ct).setEventType(18),n.error&&a.setError(new po(n.error)),s="HttpStatusCode:".concat(n.HttpStatusCode,"|CosRequestId:").concat(n.CosRequestId||"","|")+"FileAlreadyExist:".concat(n.FileAlreadyExist||0,"|FileSize:").concat(n.FileSize||0,"|CostTime:").concat(n.CostTime),n.uploadIP&&(s+="|FinalIP:".concat(n.uploadIP)),a.setMessage("OK").setMoreMessage(n.url).setExtension(s).end())}},{key:"_getRawOrUploadProxyUrl",value:function(n){var a=this.get(12).getFileUploadProxy(),s=n;return s=a?n.replace(/^https:\/\/[^/]+/,a):s}},{key:"_getFile",value:function(n){return wt(n.file.files)||La(n.file.files)?n.file.files[0]:n.file}},{key:"_formatFileSize",value:function(n){return n<1024?n+"B":n<1048576?Math.floor(n/1024)+"KB":Math.floor(n/1048576)+"MB"}},{key:"_formatSpeed",value:function(n){return n<=1048576?Xi(n/1024,1)+"KB/s":Xi(n/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(n){var a=this._getFile(n),s=a.name,s=s.slice(s.lastIndexOf(".")),s=this._genFileName("".concat(hn(999999)).concat(s));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(s),Body:a}],SliceSize:1048576,onProgress:function(h){if(typeof n.onProgress=="function")try{n.onProgress(h.percent)}catch(m){K.w("onProgress callback error:",m)}},onFileFinish:function(h,m,I){}}}},{key:"_createCosOptionsWXMiniApp",value:function(n){var s=this._getFile(n),a=this._genFileName(s.name),s=s.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(a),FilePath:s,onProgress:function(h){if(K.l(JSON.stringify(h)),typeof n.onProgress=="function")try{n.onProgress(h.percent)}catch(m){K.w("onProgress callback error:",m)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(n){var a,s=this,h="",m="",T=0,I=this._getFile(n),T=_e||Re?(h=n.message.type===O.MSG_FILE?(a=(a=I.name).slice(a.lastIndexOf(".")),this._genFileName("".concat(hn(999999)).concat(a))):this._genFileName(I.name),m=I.url,1):(a=(a=I.name).slice(a.lastIndexOf(".")),h=this._genFileName("".concat(hn(999999)).concat(a)),m=I,0);return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:h,uploadMethod:T,duration:this.duration,userID:n.message.from,conversationType:Gr(n.message.conversationID)?1:2}).then(function(He){var fe=s.isSimpleCos?He.preSig[0]:He,V=fe.uploadUrl,$=fe.downloadUrl,q=fe.requestSnapshotUrl,q=q===void 0?void 0:q,se=fe.thumbUrl,me=fe.largeUrl,fe=fe.fileKey,He=He.uploadIP,He=He===void 0?"":He;return{url:s._getRawOrUploadProxyUrl(V),fileType:s.uploadFileType,fileName:h,resources:m,downloadUrl:$,requestSnapshotUrl:q,thumbUrl:se,largeUrl:me,fileKey:fe,uploadIP:!s.isPrivateNetWork()&&He,onProgress:function(Xe){if(typeof n.onProgress=="function")try{n.onProgress(Xe.percent)}catch(Ye){K.w("onProgress callback error:",Ye),K.e(Ye)}}}})}},{key:"_genFileName",value:function(n){return"".concat(hh(),"-").concat(n)}},{key:"_setUploadFileType",value:function(n){this.uploadFileType=n}},{key:"_getSnapshotInfoByUrl",value:function(n,a){var s=this,h="_getSnapshotInfoByUrl",m=new ct(h);return this.req({P:de.VIDEO_COVER,data:{platform:this.getPlatform(),coverName:this._genFileName(hn(99999)),requestSnapshotUrl:n}}).then(function(D){var T,D=(D.data||{}).snapshotUrl;return K.l("".concat(s._n,".").concat(h," ok. snapshotUrl:").concat(D)),m.setMessage("snapshotUrl:".concat(D)).end(),Tt(D)?{}:_u(T=Xo(D,s._fileDownloadProxy,s._authKey,s._fileDNList)).then(function(V){a.snapshotInfo={snapshotUrl:T,snapshotWidth:V.width,snapshotHeight:V.height}})}).catch(function(I){return K.w("".concat(s._n,".").concat(h," failed. error:"),I),m.setCode(I.errorCode).setMessage(I.errorInfo).end(),{}})}},{key:"_getSmallImageInfoByUrl",value:function(n,a){return _u(Xo(n,this._fileDownloadProxy,this._authKey,this._fileDNList)).then(function(s){a.smallImageUrl=n,a.smallImageWidth=s.width,a.smallImageHeight=s.height})}},{key:"_getLargeImageInfoByUrl",value:function(n,a){return _u(Xo(n,this._fileDownloadProxy,this._authKey,this._fileDNList)).then(function(s){a.largeImageUrl=n,a.largeImageWidth=s.width,a.largeImageHeight=s.height})}},{key:"_isEmptyFileList",value:function(n){return!(!La(n)||n.length!==0)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}])),Bv=["downloadKey","pbDownloadKey","messageList"],Hv=p(function n(a){u(this,n),this._n="MergerMessageHandler",this._msgM=a},[{key:"uploadMergerMessage",value:function(h,a){var s="".concat(this._n,".").concat("uploadMergerMessage"),h=(K.d("".concat(s," message:"),h,"messageBytes:".concat(a)),JSON.parse(JSON.stringify(h.payload)).messageList),m=h.length,I=this._msgM.get(17).getFileDNList(),T=new ct("uploadMergerMessage");return h.forEach(function(D){Rp(D.messageBody[0].type,D.messageBody,I)}),this._msgM.req({P:de.UPLOAD_MERGER_MSG,data:{messageList:h}}).then(function(V){K.d("".concat(s," ok. response:"),V.data);var V=V.data,$=V.pbDownloadKey,V=V.downloadKey,$={pbDownloadKey:$,downloadKey:V,messageNumber:m};return T.setMessage("".concat(m,"-").concat(a,"-").concat(V)).end(),$}).catch(function(D){throw K.w("".concat(s," failed. error:"),D),T.setError(D).end(),D})}},{key:"downloadMergerMessage",value:function(n){var a=this,s="".concat(this._n,".").concat("downloadMergerMessage"),h=(K.d("".concat(s," message:"),n),n.payload.downloadKey),m=this._msgM.getFileDownloadProxy(),I=this._msgM.getDownloadFileAuthKey(),T=new ct("downloadMergerMessage");return T.setMessage("downloadKey:".concat(h)),this._msgM.req({P:de.DOWNLOAD_MERGER_MSG,data:{downloadKey:h}}).then(function(D){K.d("".concat(s," ok. response:"),D.data);var V,$,q=a._msgM.get(17).getFileDNList();return No(n.clearElement)?((V=n.payload).downloadKey,V.pbDownloadKey,V.messageList,V=N(V,Bv),n.clearElement(),n.setElement({type:n.type,content:E({messageList:D.data.messageList},V)},m,I,q)):($=[],D.data.messageList.forEach(function(se){Tt(se)||(se=new AI(se,m,I,q),$.push(se))}),n.payload.messageList=$,n.payload.downloadKey="",n.payload.pbDownloadKey=""),T.end(),n}).catch(function(D){throw K.w("".concat(s," failed. key:").concat(h," error:"),D),T.setError(D).end(),D})}},{key:"createMergerMessagePack",value:function(n,a,s){return n.conversationType===O.CONV_C2C?this._createC2CMergerMessagePack(n,a,s):this._createGroupMergerMessagePack(n,a,s)}},{key:"_createC2CMergerMessagePack",value:function(n,a,V){var h=null,m=(a&&(a.offlinePushInfo&&(h=a.offlinePushInfo),a.onlineUserOnly===!0)&&(h?h.disablePush=!0:h={disablePush:!0}),[]),I=(On(a)&&On(a.messageControlInfo)&&(I=(D=a.messageControlInfo).excludedFromUnreadCount,T=D.excludedFromLastMessage,D=D.excludedFromContentModeration,I===!0&&m.push("NoUnread"),T===!0&&m.push("NoLastMsg"),D===!0)&&m.push("NoMsgCheck"),""),T=(_n(n.cloudCustomData)&&0<n.cloudCustomData.length&&(I=n.cloudCustomData),V.pbDownloadKey),D=V.downloadKey,V=V.messageNumber,se=n.payload,$=se.title,q=se.abstractList,se=se.compatibleText,me=this._msgM.get(6),me=me&&me.isOnlineMessage(n,a)?0:void 0;return{P:de.SEND_C2C_MSG,data:{fromAccount:this._msgM.getMyUserID(),toAccount:n.to,msgBody:[{msgType:n.type,msgContent:{pbDownloadKey:T,downloadKey:D,title:$,abstractList:q,compatibleText:se,messageNumber:V}}],cloudCustomData:I,clientTime:n.clientTime,msgSeq:n.sequence,msgRandom:n.random,msgLifeTime:me,offlinePushInfo:Np(h),messageControlInfo:me!==0?m:void 0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(n,fe,V){var h=null,m=(fe&&fe.offlinePushInfo&&(h=fe.offlinePushInfo),[]),I=(On(fe)&&On(fe.messageControlInfo)&&(I=(D=fe.messageControlInfo).excludedFromUnreadCount,T=D.excludedFromLastMessage,D=D.excludedFromContentModeration,I===!0&&m.push("NoUnread"),T===!0&&m.push("NoLastMsg"),D===!0)&&m.push("NoMsgCheck"),""),T=(_n(n.cloudCustomData)&&0<n.cloudCustomData.length&&(I=n.cloudCustomData),V.pbDownloadKey),D=V.downloadKey,V=V.messageNumber,se=n.payload,$=se.title,q=se.abstractList,se=se.compatibleText,me=this._msgM.get(7),fe=me&&me.isOnlineMessage(n,fe)?1:0;return{P:de.SEND_GRP_MSG,data:{fromAccount:this._msgM.getMyUserID(),groupID:n.to,msgBody:[{msgType:n.type,msgContent:{pbDownloadKey:T,downloadKey:D,title:$,abstractList:q,compatibleText:se,messageNumber:V}}],random:n.random,priority:n.priority,clientSequence:n.clientSequence,groupAtInfo:void 0,cloudCustomData:I,onlineOnlyFlag:fe,offlinePushInfo:Np(h),clientTime:n.clientTime,needReadReceipt:n.needReadReceipt!==!0||me.isMessageFromOrToAVChatroom(n.to)?0:1,messageControlInfo:fe==0?m:void 0,isSupportExtension:n.isSupportExtension===!0?1:0,isRelayMessage:n._relayFlag===!0?1:0}}}}]),L1={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},N1=[Je.MSG_ONPROGRESS_ERR,Je.MSG_I_SELECT_F_FIRST,Je.MSG_I_TYPES_LIMIT,Je.MSG_F_IS_EMPTY,Je.MSG_I_SIZE_LIMIT,Je.MSG_F_SELECT_F_FIRST,Je.MSG_F_SIZE_LIMIT,Je.MSG_V_SIZE_LIMIT,Je.MSG_V_TYPES_LIMIT,Je.MSG_A_UPLOAD_FAIL,Je.MSG_A_SIZE_LIMIT,Je.COS_UNDETECTED];function Wp(n){u(this,Wp),(n=c(this,Wp,[n]))._n="UploadModule",n.TIMUploadPlugin=null,n.timUploadPlugin=null,n.COSSDK=null,n._cosUploadMethod=null,n.expiredTimeLimit=600,n.appid=0,n.bucketName="",n.ciUrl="",n.directory="",n.downloadUrl="",n.uploadUrl="",n.region="ap-shanghai",n.cos=null,n.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},n.uploadFileType="",n.duration=900,n.tryCount=0,n.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},n.isSimpleCos=!1,n._fileDownloadProxy="",n._authKey="",n._fileDNList=A1;var a=n.getIEmitInst();return a.on(So.A2KEY_AND_TINYID_UPDATED,n._init,n),a.on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function UI(n){var a=!1;return Object.values(L1).includes(n)&&(a=!0),a=120001<=n&&n<=13e4||10100<=n&&n<=10200?!0:a}S(Xp,$o);var P1=p(Xp,[{key:"createTextMessage",value:function(s){var h=this.getMyUserID(),a=(s.currentUser=h,s.senderTinyID=this.getMyTinyID(),new _r(s)),s=_n(s.payload)?s.payload:s.payload.text,s=new Dv({text:s}),h=this._getNickAndAvatarByUserID(h);return a.setElement(s),a.setNickAndAvatar(h),a.setNameCard(this._getNameCardByGroupID(a)),a}},{key:"createImageMessage",value:function(n){var a=this.getMyUserID(),s=(n.currentUser=a,n.senderTinyID=this.getMyTinyID(),new _r(n));if(_e){var m=n.payload.file;if(_t(m))return void this.warn("FileUnsupportedInMP","createImageMessage");var h=m.tempFiles[0].path||m.tempFiles[0].tempFilePath,m={url:h,name:h.slice(h.lastIndexOf("/")+1),size:m.tempFiles&&m.tempFiles[0].size||1,type:h.slice(h.lastIndexOf(".")+1).toLowerCase()};n.payload.file=m}else Re?(m={url:(h=n.payload.file).uri,name:h.fileName,size:h.fileSize||1,type:h.type,width:h.width,height:h.height},n.payload.file=m):Ke&&(_t(n.payload.file)?(h=n.payload.file,n.payload.file={files:[h]}):On(n.payload.file)&&typeof uni<"u"&&(m=n.payload.file.tempFiles[0],n.payload.file={files:[m]}));return h=this.get(17).getFileDNList(),m=new ku({imageFormat:ri.UNKNOWN,uuid:this._generateUUID(n.payload.file),file:n.payload.file},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),h),h=this._getNickAndAvatarByUserID(a),s.setElement(m),s.setNickAndAvatar(h),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,n),s}},{key:"createAudioMessage",value:function(n){var h=n.payload.file,a=(_e&&(a={url:h.tempFilePath,name:h.tempFilePath.slice(h.tempFilePath.lastIndexOf("/")+1),size:h.fileSize,second:parseInt(h.duration)/1e3,type:h.tempFilePath.slice(h.tempFilePath.lastIndexOf(".")+1).toLowerCase()},n.payload.file=a),Re&&(a={url:h.uri,name:h.uri.slice(h.uri.lastIndexOf("/")+1),size:h.fileSize||1,second:Math.floor(h.duration/1e3),type:h.uri.slice(h.uri.lastIndexOf(".")+1).toLowerCase()},n.payload.file=a,Tt(h.uri))&&this.warn("VoiceFileInRN"),this.getMyUserID()),m=(n.currentUser=a,n.senderTinyID=this.getMyTinyID(),this.get(17).getFileDNList()),s=new _r(n),h=new Qi({second:Math.floor(h.duration/1e3),size:h.fileSize||h.size||1,url:h.tempFilePath||h.uri,uuid:this._generateUUID(n.payload.file)},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),m),m=this._getNickAndAvatarByUserID(a);return s.setElement(h),s.setNickAndAvatar(m),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,n),s}},{key:"createVideoMessage",value:function(n){var a=this.getMyUserID(),h=(n.currentUser=a,n.senderTinyID=this.getMyTinyID(),n.payload.file.thumbUrl="",n.payload.file.thumbSize=0,{});if(_e){if(rt)return void this.warn("VideoUnsupportedInAlipay");if(_t(n.payload.file))return void this.warn("FileUnsupportedInMP","createVideoMessage");var m=n.payload.file;wt(m.tempFiles)&&(m=m.tempFiles[0]),h.url=m.tempFilePath,h.name=m.tempFilePath.slice(m.tempFilePath.lastIndexOf("/")+1),h.size=m.size||1,h.second=m.duration||0,h.type=m.tempFilePath.slice(m.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else Re?(m=n.payload.file,h.url=m.uri,h.name=m.fileName,h.size=m.fileSize||1,h.second=m.duration||0,h.type=m.type.split("/")[1]):Ke&&(_t(n.payload.file)?(m=n.payload.file,n.payload.file.files=[m]):On(n.payload.file)&&typeof uni<"u"&&(m=n.payload.file.tempFile,n.payload.file.files=[m]),m=n.payload.file,h.url=window.URL.createObjectURL(m.files[0]),h.name=m.files[0].name,h.size=m.files[0].size||1,h.second=m.files[0].duration||0,h.type=m.files[0].type.split("/")[1]);n.payload.file.videoFile=h;var m=this.get(17).getFileDNList(),s=new _r(n),h=new Op({videoFormat:h.type,videoSecond:Xi(h.second,0),videoSize:h.size,remoteVideoUrl:"",videoUrl:h.url,videoUUID:this._generateUUID(n.payload.file.videoFile),thumbUUID:this._generateUUID(n.payload.file.videoFile,"jpg"),thumbWidth:n.payload.file.width||200,thumbHeight:n.payload.file.height||200,thumbUrl:n.payload.file.thumbUrl,thumbSize:n.payload.file.thumbSize,thumbFormat:"jpg"},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),m),m=this._getNickAndAvatarByUserID(a);return s.setElement(h),s.setNickAndAvatar(m),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,n),s}},{key:"createCustomMessage",value:function(s){var h=this.getMyUserID(),a=(s.currentUser=h,s.senderTinyID=this.getMyTinyID(),new _r(s)),s=new Dp({data:s.payload.data,description:s.payload.description,extension:s.payload.extension}),h=this._getNickAndAvatarByUserID(h);return a.setElement(s),a.setNickAndAvatar(h),a.setNameCard(this._getNameCardByGroupID(a)),a}},{key:"createFaceMessage",value:function(s){var h=this.getMyUserID(),a=(s.currentUser=h,s.senderTinyID=this.getMyTinyID(),new _r(s)),s=new Ov(s.payload),h=this._getNickAndAvatarByUserID(h);return a.setElement(s),a.setNickAndAvatar(h),a.setNameCard(this._getNameCardByGroupID(a)),a}},{key:"createMergerMessage",value:function(h){var a=this.getMyUserID(),a=(h.currentUser=a,h.senderTinyID=this.getMyTinyID(),this._getNickAndAvatarByUserID(a)),s=new _r(h),h=new Lp(h.payload);return s.setElement(h),s.setNickAndAvatar(a),s.setNameCard(this._getNameCardByGroupID(s)),s.setRelayFlag(!0),s}},{key:"createForwardMessage",value:function(n){var a,s,h=n.to,m=n.conversationType,I=n.priority,T=n.payload,D=n.needReadReceipt,V=n.receiverList;return wt(T._elements)?(a=this.getMyUserID(),s=this._getNickAndAvatarByUserID(a),T.type===O.MSG_GRP_TIP?De({code:Je.MSG_FORWARD_TYPE_INVALID}):(m={to:h,conversationType:m,conversationID:"".concat(m).concat(h),priority:I,isPlaceMessage:0,status:Tp,currentUser:a,senderTinyID:this.getMyTinyID(),cloudCustomData:n.cloudCustomData||T.cloudCustomData||"",needReadReceipt:D,receiverList:V,isSupportExtension:n.isSupportExtension||!1},(h=new _r(m)).setElement(T._elements[0]),h.setNickAndAvatar(s),h.setNameCard(this._getNameCardByGroupID(T)),h.setRelayFlag(!0),h)):De({code:Je.MSG_FORWARD_INVALID_ELEMENTS})}},{key:"downloadMergerMessage",value:function(n){return this._mergerMessageHandler.downloadMergerMessage(n)}},{key:"createFileMessage",value:function(n){if(_e){if(!Fe&&!be&&!Qe)return;var h=je.getSystemInfoSync().SDKVersion;if(Fe&&bI(h,"2.5.0")<0)return void this.warn("WXChooseMessageFile");if(be&&bI(h,"1.18.0")<0)return void this.warn("QQChooseMessageFile")}Ke||Qe?_t(n.payload.file)?(h=n.payload.file,n.payload.file={files:[h]}):On(n.payload.file)&&typeof uni<"u"&&(s=(h=n.payload.file).tempFiles,h=h.files,a=null,wt(s)?a=s[0]:wt(h)&&(a=h[0]),n.payload.file={files:[a]}):Fe||be?(h=E(E({},(s=n.payload.file.tempFiles)[0]),{},{url:s[0].path}),n.payload.file={files:[h]}):Re&&(s=E(E({},a=n.payload.file),{},{url:a.uri}),n.payload.file={files:[s]});var h=this.getMyUserID(),a=(n.currentUser=h,n.senderTinyID=this.getMyTinyID(),new _r(n)),s=new Ch({uuid:this._generateUUID(n.payload.file),file:n.payload.file}),h=this._getNickAndAvatarByUserID(h);return a.setElement(s),a.setNickAndAvatar(h),a.setNameCard(this._getNameCardByGroupID(a)),this._messageOptionsMap.set(a.clientSequence,n),a}},{key:"createLocationMessage",value:function(s){var h=this.getMyUserID(),a=(s.currentUser=h,s.senderTinyID=this.getMyTinyID(),new _r(s)),s=new Lv(s.payload),h=this._getNickAndAvatarByUserID(h);return a.setElement(s),a.setNickAndAvatar(h),a.setNameCard(this._getNameCardByGroupID(a)),a}},{key:"_onNoModule",value:function(){return De({code:Je.NO_MODULE})}},{key:"sendMessageInstance",value:function(n,a){var s=this;if(this.get(29).filterMessage(n,a)===!1)return n.hasRiskContent=!0,this._onSendMessageFailed(n,new po({code:Je.PROFANITY_FOUND}));var h,m,I,T,D=null;if(n.conversationType===O.CONV_C2C)D=this.get(6);else{if(n.conversationType!==O.CONV_GROUP)return De({code:Je.MSG_INVALID_CONV_TYPE});D=this.get(7)}return D?(m="".concat(this._n,".sendMessageInstance"),I=this.get(11),T=D.isOnlineMessage(n,a),this.get(17).upload(n).then(function(){return s._getSendMessageSpecifiedKey(n)===Fa&&s.get(26).addSuccessCount(Si),s._guardForGroup(n).then(function(){if(!n.isSendable())return De({code:Je.MSG_F_URL_IS_EMPTY});s._addSendMessageTotalCount(n),h=Date.now();var V=function($){var q="utf-8";Ke&&document&&(q=document.charset.toLowerCase());var se,me=0,fe=$.length;if(q==="utf-8"||q==="utf8")for(var He=0;He<fe;He++)(se=$.codePointAt(He))<=127?me+=1:se<=2047?me+=2:se<=65535?me+=3:(me+=4,He++);else if(q==="utf-16"||q==="utf16")for(var Xe=0;Xe<fe;Xe++)(se=$.codePointAt(Xe))<=65535?me+=2:(me+=4,Xe++);else me=$.replace(/[^\x00-\xff]/g,"aa").length;return me}(JSON.stringify(n));return n.type===O.MSG_MERGER&&11264<V?s._mergerMessageHandler.uploadMergerMessage(n,V).then(function($){return $=s._mergerMessageHandler.createMergerMessagePack(n,a,$),s.req($)}):(I.setMessageRandom(n),D.sendMessage(n,a))}).then(function(me){var me=me.data,$=me.time,q=me.sequence,se=me.readReceiptCode,me=me.messageDropReason,me=(It(se)&&se!==0&&(new ct("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(q," readReceiptCode:").concat(se)).end(),K.w("".concat(m," readReceiptCode:").concat(se," message:").concat(s.getErrMsg(se)))),me&&(se=new ct("messageDropReason"),me="from:".concat(n.from," to:").concat(n.to," sequence:").concat(q," messageDropReason:").concat(me),se.setMessage(me).end(),K.w("".concat(m," ").concat(me))),s._addSendMessageSuccessCount(n,h),s._messageOptionsMap.delete(n.clientSequence),n.isResend===!0&&(se=I.findMessage(n.ID))&&(K.l("".concat(m," resend ok. ID:").concat(se.ID)),I.deleteLocalMessage(se)),n.status=Fi,n.time=$,!1);return n.conversationType===O.CONV_GROUP?n.sequence=q:n.conversationType===O.CONV_C2C&&(se=I.getLatestMessageSentByMe(n.conversationID))&&($=se.nick,q=se.avatar,$===n.nick&&q===n.avatar||(me=!0)),me&&I.modifyMessageSentByMe({conversationID:n.conversationID,latestNick:n.nick,latestAvatar:n.avatar}),T===!0?n._onlineOnlyFlag=!0:(I.appendToMessageList(n),se=n,On(a)&&On(a.messageControlInfo)&&(a.messageControlInfo.excludedFromLastMessage===!0&&(n._isExcludedFromLastMessage=!0,se=""),a.messageControlInfo.excludedFromUnreadCount===!0)&&(n._isExcludedFromUnreadCount=!0),$=n.conversationType,vr(n.to)&&($=O.CONV_TOPIC,s.get(10).onMessageSent({groupID:pr(n.to),topicID:n.to,lastMessage:se})),I.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:$,subType:n.conversationSubType,lastMessage:se}]})),n._relayFlag||n.type!=="TIMImageElem"||CI(n.payload.imageInfoArray),Kt({message:n})})}).catch(function(V){return s._onSendMessageFailed(n,V,T)})):this._onNoModule()}},{key:"_guardForGroup",value:function(n){if(n.conversationType!==O.CONV_GROUP)return Promise.resolve();var a=this.get(7);if(!a)return this._onNoModule();if(Yr({groupID:n.to})){var s=a.getLocalGroupProfile(n.to);if(s&&s.isSupportTopic)return De({code:Je.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return a.guardForAVChatRoom(n)}},{key:"_onSendMessageFailed",value:function(n,a){var m=2<arguments.length&&arguments[2]!==void 0&&arguments[2],s="".concat(this._n,"._onSendMessageFailed"),h=(n.status=Mp,a.code!==80001&&a.code!==80004||(n.hasRiskContent=!0),this.get(11)),I=(h.deleteMessageRandom(n),10100<=a.code&&a.code<=10200||120001<=a.code&&a.code<=13e4),m=(m||I||h.appendToMessageList(n)===!0&&K.l("".concat(s," message stored, ID:").concat(n.ID)),this._addSendMessageFailCountOnUser(n,a),new ct("sendMessage")),I="head.seq:".concat(a.data.headSeq," type:").concat(n.type," from:").concat(n.from," to:").concat(n.to);return Ke&&("connection"in navigator&&(h=navigator.connection,I+=" downlink:".concat(h.downlink," effectiveType:").concat(h.effectiveType," rtt:").concat(h.rtt)),"memory"in window.performance)&&(h=window.performance.memory,I+=" usedJSHeapSize:".concat(h.usedJSHeapSize," totalJSHeapSize:").concat(h.totalJSHeapSize," jsHeapSizeLimit:").concat(h.jsHeapSizeLimit)),m.setMessage(I).setError(a).end(),K.e("".concat(s," ").concat(I," error:"),a),De(new po({code:a&&a.code?a.code:Je.MSG_SEND_FAIL,message:a&&a.message?a.message:void 0,data:{message:n}}))}},{key:"_getSendMessageSpecifiedKey",value:function(n){if([O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_VIDEO,O.MSG_FILE].includes(n.type))return Fa;if(n.conversationType===O.CONV_C2C)return as;if(n.conversationType===O.CONV_GROUP){var a=this.get(7);if(a&&(a=a.getLocalGroupProfile(n.to),a))return n=a.type,jr(n)?uc:Gs}}},{key:"_addSendMessageTotalCount",value:function(n){n=this._getSendMessageSpecifiedKey(n),n&&this.get(26).addTotalCount(n)}},{key:"_addSendMessageSuccessCount",value:function(h,a){var s,h=this._getSendMessageSpecifiedKey(h);h&&((s=this.get(26)).addSuccessCount(h),s.addCost(h,br(a,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(I,h){var s,h=h.code,h=h===void 0?-1:h,m=this.get(26),I=this._getSendMessageSpecifiedKey(I);I===Fa&&(s=!1,s=N1.includes(h)?!0:s)?m.addFailedCountOfUserSide(Si):UI(h)&&I&&m.addFailedCountOfUserSide(I)}},{key:"resendMessage",value:function(n,a){return n.isResend=!0,n.status=Tp,this.sendMessageInstance(n,a)}},{key:"revokeMessage",value:function(n){var a,s,h=this,m=null;return n.conversationType===O.CONV_C2C?m=this.get(6):n.conversationType===O.CONV_GROUP&&(m=this.get(7)),m?((a=new ct("revokeMessage")).setMessage("type:".concat(n.type," from:").concat(n.from," to:").concat(n.to)),s="".concat(this._n,".").concat("revokeMessage"),m.revokeMessage(n).then(function(T){var T=T.data.recallRetList;return Tt(T)||T[0].retCode===0?(K.i("".concat(s," ok. ID:").concat(n.ID)),n.isRevoked=!0,a.end(),h.get(11).onMessageRevoked([n]),Kt({message:n})):(T=new po({code:T[0].retCode,data:{message:n}}),a.setCode(T.code).setMoreMessage(T.message).end(),De(T))}).catch(function(I){a.setError(I).end();var T=new po({code:I&&I.code?I.code:Je.MSG_REVOKE_FAIL,message:I&&I.message?I.message:void 0,data:{message:n}});return K.w("".concat(s," failed. error:"),I),De(T)})):this._onNoModule()}},{key:"deleteMessage",value:function(n){var a=this,s=null,h=n[0],m=h.conversationID,I="",T=[],D=[];if(h.conversationType===O.CONV_C2C)s=this.get(6),I=m.replace(O.CONV_C2C,""),n.forEach(function(q){q&&q.status===Fi&&q.conversationID===m&&(q._onlineOnlyFlag||T.push("".concat(q.sequence,"_").concat(q.random,"_").concat(q.time)),D.push(q))});else if(h.conversationType===O.CONV_GROUP)s=this.get(7),I=m.replace(O.CONV_GROUP,""),n.forEach(function(q){q&&q.status===Fi&&q.conversationID===m&&(q._onlineOnlyFlag||T.push("".concat(q.sequence)),D.push(q))});else if(h.conversationType===O.CONV_SYSTEM)return De({code:Je.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!s)return this._onNoModule();if(T.length===0)return this._onMessageDeleted(D);30<T.length&&(T=T.slice(0,30),D=D.slice(0,30));var V=new ct("deleteMessage"),$=(V.setMessage("to:".concat(I," count:").concat(T.length)),"".concat(this._n,".").concat("deleteMessage"));return s.deleteMessage({to:I,keyList:T}).then(function(q){return V.end(),K.i("".concat($," ok")),a._onMessageDeleted(D)}).catch(function(q){return V.setError(q).end(),K.w("".concat($," failed. error:"),q),q=new po({code:q&&q.code?q.code:Je.MSG_DELETE_FAIL,message:q&&q.message?q.message:void 0}),De(q)})}},{key:"_onMessageDeleted",value:function(n){return this.get(11).onMessageDeleted(n),ln({messageList:n})}},{key:"translateText",value:function(m){var a="".concat(this._n,".").concat("translateText"),s=m.sourceTextList,h=m.sourceLanguage,m=m.targetLanguage,I=new ct("translateText");return I.setMessage("sourceLanguage:".concat(h," targetLanguage:").concat(m)),this.req({P:de.TRANSLATE_TEXT,data:{sourceTextList:s,source:h||"auto",target:m,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then(function($){var $=$.data,D=$.error,V=$.requestID,$=$.translatedTextList;if(D.code===0)return I.end(),K.i("".concat(a," ok. requestID:").concat(V)),Kt({translatedTextList:$});throw E(E({},D),{},{requestID:V})}).catch(function(T){return I.setCode(T.code).setMoreMessage(T.requestID).end(),K.w("".concat(a," failed. error:"),T),De({code:T.code||Je.TRANSLATE_TEXT_FAIL,message:T.message})})}},{key:"convertVoiceToText",value:function(m){var a,s,h,T=m.message,m=m.language,I=T.payload.url,T=(T.from===this.getMyUserID()&&T.flow==="out"&&(I=T.payload.remoteAudioUrl),/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/);return T.test(I)?(T=T.exec(I)[1]||"mp3",a="16k_zh-PY",m?m==="zh (cmn-Hans-CN)"?a="16k_zh":m==="en-US"?a="16k_en":m==="yue-Hant-HK"?a="16k_yue":m==="ja-JP"&&(a="16k_ja"):a="16k_zh-PY",m="serviceType:".concat(a," url:").concat(I),s="".concat(this._n,".").concat("convertVoiceToText"),K.i("".concat(s," ").concat(m)),(h=new ct("convertVoiceToText")).setMessage(m),this.req({P:de.VOICE_TO_TEXT,data:{url:I,language:a,SDKAppID:this.getSDKAppID(),format:T}}).then(function(q){var q=q.data,V=q.error,$=q.requestID,q=q.result;if(V.code===0)return h.end(),K.i("".concat(s," ok. requestID:").concat($)),Kt({result:q});throw E(E({},V),{},{requestID:$})}).catch(function(D){return h.setCode(D.code).setMoreMessage(D.requestID||"").end(),K.w("".concat(s," failed. error:"),D),De({code:Je.VOICE_TO_TEXT_FAIL})})):De({code:Je.UNSUPPORTED_VOICE_FORMAT})}},{key:"modifyRemoteMessage",value:function(n){var a=this;if(this.get(29).filterMessage(n)===!1)return n.hasRiskContent=!0,De({code:Je.PROFANITY_FOUND,data:{message:n}});var s=null,h=n.conversationType,m=n.to;if(h===O.CONV_C2C)s=this.get(6);else if(h===O.CONV_GROUP){if(!(s=this.get(7)))return this._onNoModule();if(s.isMessageFromOrToAVChatroom(m))return De({code:Je.MSG_MODIFY_DISABLED_IN_AV,data:{message:n}})}var I=new ct("modifyMessage"),T=(I.setMessage("to:".concat(m)),"".concat(this._n,".modifyRemoteMessage"));return s.modifyRemoteMessage(n).then(function(D){return I.end(),K.i("".concat(T," ok")),D=a._onModifyRemoteMessageResp(n,D.data),Kt({message:D})}).catch(function(D){var V;return I.setCode(D.code).setMoreMessage(D.message).end(),K.w("".concat(T," failed. error:"),D),D.code===20027?(V=a._onModifyRemoteMessageResp(n,D.data),De({code:Je.MSG_MODIFY_CONFLICT,data:{message:V}})):De({code:D.code,message:D.message,data:{message:n}})})}},{key:"_onModifyRemoteMessageResp",value:function(D,q){K.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),q);var s=D.conversationType,h=D.from,m=D.to,I=D.random,T=D.sequence,D=D.time,V=q.elements,$=q.messageVersion,q=q.cloudCustomData,q=q===void 0?"":q;return this.get(11).onMessageModified({conversationType:s,from:h,to:m,time:D,random:I,sequence:T,elements:V,cloudCustomData:q,messageVersion:$})}},{key:"_generateUUID",value:function(n,a){var s=this.get(12),s="".concat(s.getSDKAppID(),"-").concat(s.getUserID(),"-").concat(Yn());return a?"".concat(s,".").concat(a):(n=(a=n.name||n.value||n.url||n.tempFilePath)&&a.slice(a.lastIndexOf(".")+1))?"".concat(s,".").concat(n):s}},{key:"getMessageOption",value:function(n){return this._messageOptionsMap.get(n)}},{key:"_getNickAndAvatarByUserID",value:function(n){return this.get(4).getNickAndAvatarByUserID(n)}},{key:"_getNameCardByGroupID",value:function(n){if(n.conversationType===O.CONV_GROUP){var a=this.get(7);if(a)return a.getMyNameCardByGroupID(n.to)}return""}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),x1=(S(mc,$o),p(mc,[{key:"onMsgExtNotify",value:function(I){var a=this,I=I.dataList,D=I.messageInfo,s=I.operateType,h=I.operateResultList,m=I.tinyID,I=I.globalSequence,T=D.clientTime,D=D.random,V="".concat(m,"-").concat(T,"-").concat(D),$=[],q=[],se=(K.l("".concat(this._n,".onMsgExtNotify messageID:").concat(V," operateType:").concat(s," globalSequence:").concat(I)),this._updateGlobalSeq(V,I),!1),me=!1;h.forEach(function(fe){var He=fe.extensions,He=He===void 0?[]:He,Xe=fe.clearSequence;s===1?(se=!0,He.forEach(function(Ye){$.push({key:Ye.key,value:Ye.value})}),a._updateLocalExt(V,He)):s===2?(me=!0,He.forEach(function(Ye){q.push(Ye.key)}),a._updateLocalExt(V,He)):s===3&&(me=!0,a._hasLocalExt(V)&&a._getLocalExt(V).forEach(function(Ye,Lt){Ye.seq<=Xe&&!Tt(Ye.value)&&q.push(Lt)}),a._clearLocalExt(V,Xe))}),se&&this.emitOEvt(W.MESSAGE_EXTENSIONS_UPDATED,{messageID:V,extensions:$}),me&&this.emitOEvt(W.MESSAGE_EXTENSIONS_DELETED,{messageID:V,keyList:q})}},{key:"setMessageExtensions",value:function(n,a){var s,h,m,I,T,D,V,$="setMessageExtensions";return this.canIUse(ye.MSG_EXT)?(s="".concat(this._n,".").concat($),h=n.ID,m=n.conversationID,I=n.sequence,T=n.time,D=P(a),20<a.length&&(D=a.slice(0,20),K.w("".concat(s,". the length of extensions cannot exceed 20."))),a="convID:".concat(m," messageID:").concat(h," sequence:").concat(I," time:").concat(T," count:").concat(D.length),(V=new ct($)).setMessage(a),K.l("".concat(s," ").concat(a)),this._modifyMsgExts(n,D).then(function(me){var se=me.resultList,fe=me.successCount,me=me.failureCount,fe="successCount:".concat(fe," failCount:").concat(me);return V.setMoreMessage(fe).end(),K.l("".concat(s," ok. ").concat(fe)),Kt({extensions:se})}).catch(function(q){return V.setError(q).end(),K.e("".concat(s," failed. error:"),q),De(q)})):this.noUse($)}},{key:"getMessageExtensions",value:function(n){var a,s,h,m,I,T,D,V=this,$="getMessageExtensions";return this.canIUse(ye.MSG_EXT)?(a="".concat(this._n,".").concat($),s=n.ID,I=n.conversationID,h=n.sequence,m=n.time,I="convID:".concat(I," messageID:").concat(s," sequence:").concat(h," time:").concat(m),(T=new ct($)).setMessage(I),D=void K.l("".concat(a," ").concat(I)),this.getMsgExtsMap.has(s)&&(D=this._getGlobalSeq(s)),this._getMsgExts(n,D).then(function(q){return T.end(),K.l("".concat(a," ok. extCount:").concat(q.length)),et(D)&&0<q.length&&V.getMsgExtsMap.set(s,1),Kt({extensions:q})}).catch(function(q){return T.setError(q).end(),K.e("".concat(a," failed. error:"),q),De(q)})):this.noUse($)}},{key:"deleteMessageExtensions",value:function(n,a){var s,h,m,I,T,D,V,$="deleteMessageExtensions";return this.canIUse(ye.MSG_EXT)?(s="".concat(this._n,".").concat($),h=[],m=3,Tt(a)||(m=2,a.forEach(function(q){h.push({key:q,value:"",seq:0})})),a=n.ID,D=n.conversationID,I=n.sequence,T=n.time,D="convID:".concat(D," messageID:").concat(a," sequence:").concat(I," time:").concat(T," operateType:").concat(m),(V=new ct($)).setMessage(D),K.l("".concat(s," ").concat(D)),this._modifyMsgExts(n,h,m).then(function(fe){var se=fe.resultList,me=fe.successCount,fe=fe.failureCount,He="";return m===2&&(He="success count:".concat(me," fail count:").concat(fe)),V.setMoreMessage("".concat(He)).end(),K.l("".concat(s," ok. ").concat(He)),Kt({extensions:se})}).catch(function(q){return V.setError(q).end(),K.e("".concat(s," failed. error:"),q),De(q)})):this.noUse($)}},{key:"_modifyMsgExts",value:function(n,a){var s=this,h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,m=vr(n.to)?O.CONV_TOPIC:n.conversationType,I=void 0,T=(h!==3&&(I=this._getReqExts(n,a)),null);switch(m){case O.CONV_C2C:T=this.get(6);break;case O.CONV_GROUP:T=this.get(7);break;case O.CONV_TOPIC:T=this.get(10);break;default:return De({code:Je.NO_MODULE})}return T.modifyMsgExts(n,I,h).then(function($){var $=$.data,V=$.extensions,$=$.seq,q=[],se=0,me=0,fe=[];return(V=Tt(V)?[]:V).forEach(function(yt){var Xe=yt.errorCode,yt=yt.extension,Ye=yt.key,Lt=yt.value,yt=yt.seq;q.push({code:Xe,key:Ye,value:Lt}),Xe===0?se++:me++,fe.push({key:Ye,value:Lt,seq:yt})}),s._updateGlobalSeq(n.ID,$),0<fe.length&&(s._updateLocalExt(n.ID,fe),fe=null),{resultList:q,successCount:se,failureCount:me}}).catch(function(D){return De(D)})}},{key:"_getReqExts",value:function(n,a){var s,h=[];return this._hasLocalExt(n.ID)?(s=this._getLocalExt(n.ID),a.forEach(function(T){var I=T.key,T=T.value,D=0;s.has(I)&&(D=s.get(I).seq),h.push({key:I,value:T,seq:D})})):a.forEach(function(T){var I=T.key,T=T.value;h.push({key:I,value:T,seq:0})}),h}},{key:"_getMsgExts",value:function(n,a){var s=this,h="".concat(this._n,"._getMsgExts"),m=n.ID,I=n.to,T=null;switch(vr(I)?O.CONV_TOPIC:n.conversationType){case O.CONV_C2C:T=this.get(6);break;case O.CONV_GROUP:T=this.get(7);break;case O.CONV_TOPIC:T=this.get(10);break;default:return De({code:Je.NO_MODULE})}return T.getMessageExtensions(n,a).then(function(q){var q=q.data,se=q.extensions,V=q.completeFlag,$=q.globalSequence,q=q.clearSequence,se=Tt(se)?[]:se;return K.l("".concat(h," ok. completeFlag:").concat(V," globalSequence:").concat($," clearSequence:").concat(q," count:").concat(se.length)),s._updateLocalExt(m,se),s._clearLocalExt(m,q),s._updateGlobalSeq(m,$),V!==1?(q=se.slice(-1)[0].seq+1,s._getMsgExts(n,q)):s._getLocalExtList(m)}).catch(function(D){return De(D)})}},{key:"_hasLocalExt",value:function(n){return this.msgExtMap.has(n)}},{key:"_getLocalExt",value:function(n){return this.msgExtMap.get(n)}},{key:"_updateLocalExt",value:function(n,a){this._hasLocalExt(n)||this.msgExtMap.set(n,new Map);var s=this._getLocalExt(n);a.forEach(function(T){var m=T.key,I=T.value,T=T.seq;s.set(m,{value:I===void 0?"":I,seq:T})})}},{key:"_clearLocalExt",value:function(n,a){var s;a<=0||!this._hasLocalExt(n)||(s=this._getLocalExt(n)).forEach(function(h,m){h.seq<=a&&s.delete(m)})}},{key:"_getLocalExtList",value:function(n){var a=[];return this._hasLocalExt(n)&&this._getLocalExt(n).forEach(function(s,h){s=s.value,Tt(s)||a.push({key:h,value:s})}),a}},{key:"_getGlobalSeq",value:function(n){return this.globalSeqMap.get(n)}},{key:"_updateGlobalSeq",value:function(n,a){this.globalSeqMap.set(n,a)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this.msgExtMap.clear(),this.globalSeqMap.clear(),this.getMsgExtsMap.clear()}}])),Cr=(S(Jp,$o),p(Jp,[{key:"onReactionNotifyList",value:function(s){var a=this,s=(s||{}).dataList;(s===void 0?[]:s).forEach(function(m){var T=m.C2CMessageInfo,D=m.groupMessageInfo,D=D===void 0?{}:D,m=m.reactionList,m=m===void 0?[]:m,T=E(E({},T===void 0?{}:T),D),D=T.tinyID,I=T.clientTime,T=T.random,D="".concat(D,"-").concat(I,"-").concat(T),V=[];m.forEach(function($){et($.userIDList)&&($.userIDList=[],$.count=0),V.push.apply(V,P($.userIDList))}),K.l("".concat(a._n,".onReactionNotifyList messageID:").concat(D," reactionList:").concat(m.length)),a._handleReactionSummary([{messageID:D,reactionList:m}],V).then(function($){a.emitOEvt(W.MESSAGE_REACTIONS_UPDATED,E({},$[0]))})})}},{key:"onReactionNotify",value:function(s){var s=s.dataList||{},h=s.C2CMessageInfo,m=s.groupMessageInfo,m=m===void 0?{}:m,a=s.reactionID,s=s.operateType,h=E(E({},h===void 0?{}:h),m),m=h.tinyID,I=h.clientTime,h=h.random,m="".concat(m,"-").concat(I,"-").concat(h),I=(K.l("".concat(this._n,".onReactionNotify messageID:").concat(m," reactionID:").concat(a," operateType:").concat(s)),s===1?this._addReactedByMyselfMap(m,a):this._removeReactedByMyselfMap(m,a),"".concat(m,"-").concat(a));this._reactionInfoMap.has(I)&&((h=this._reactionInfoMap.get(I)).reactedByMyself=s===1,this.emitOEvt(W.MESSAGE_REACTIONS_UPDATED,{messageID:m,reactionList:[h]}))}},{key:"addMessageReaction",value:function(n,a){var s,h,m,I,T=this,D="addMessageReaction";return this.canIUse(ye.MSG_REACTION)?(s="".concat(this._n,".").concat(D),I=n.ID,h=n.conversationID,h="convID:".concat(h," messageID:").concat(I," reactionID:").concat(a),(m=new ct(D)).setMessage(h),K.l("".concat(s," ").concat(h)),I=this._createReactionOperationPack(n,a,1),this._addReactedByMyselfMap(n.ID,a),this.req(I).then(function(){return m.end(),K.l("".concat(s," ok.")),Kt()}).catch(function(V){return T._removeReactedByMyselfMap(n.ID,a),m.setError(V).end(),K.e("".concat(s," failed. error:"),V),De(V)})):this.noUse(D)}},{key:"removeMessageReaction",value:function(n,a){var s,h,m,I,T="removeMessageReaction";return this.canIUse(ye.MSG_REACTION)?(s="".concat(this._n,".").concat(T),I=n.ID,h=n.conversationID,h="convID:".concat(h," messageID:").concat(I," reactionID:").concat(a),(m=new ct(T)).setMessage(h),K.l("".concat(s," ").concat(h)),I=this._createReactionOperationPack(n,a,2),this._removeReactedByMyselfMap(n.ID,a),this.req(I).then(function(){return m.end(),K.l("".concat(s," ok.")),Kt()}).catch(function(D){return m.setError(D).end(),K.e("".concat(s," failed. error:"),D),De(D)})):this.noUse(T)}},{key:"getMessageReactions",value:function(n){var a,s,h,m,I,T,D=this,V="getMessageReactions";return this.canIUse(ye.MSG_REACTION)?(a="".concat(this._n,".").concat(V),s=n.messageList,T=n.maxUserCountPerReaction,h=s[0].conversationID,h="convID:".concat(h," maxUserCountPerReaction:").concat(T," msgCount:").concat(s.length),(m=new ct(V)).setMessage(h),K.l("".concat(a," ").concat(h)),I=new Map,T=this._createReactionSummaryPack(E(E({},n),{},{messageIDMap:I})),this.req(T).then(function(q){var q=q.data.resultList,se=[],me=[];return(q===void 0?[]:q).forEach(function(Xe){var He=Xe.messageKey,He=He===void 0?void 0:He,Ye=Xe.messageSequence,Ye=Ye===void 0?void 0:Ye,Xe=Xe.reactionList,Xe=Xe===void 0?[]:Xe,Ye=et(He)?I.get(Ye):I.get(He);se.push({messageID:Ye,reactionList:Xe}),Xe.forEach(function(Lt){me.push.apply(me,P(Lt.userIDList))})}),D._handleReactionSummary(se,me)}).then(function($){return m.end(),K.l("".concat(a," ok.")),I.clear(),Kt({resultList:$})}).catch(function($){return m.setError($).end(),K.e("".concat(a," failed. error:"),$),De($)})):this.noUse(V)}},{key:"getAllUserListOfMessageReaction",value:function(n){var a,s,h,m,I,T,D,V,$=this,q="getAllUserListOfMessageReaction";return this.canIUse(ye.MSG_REACTION)?(a="".concat(this._n,".").concat(q),I=n.message,s=n.reactionID,h=n.nextSeq,m=n.count,V=I.ID,I=I.conversationID,I="convID:".concat(I," messageID:").concat(V," reactionID:").concat(s," nextSeq:").concat(h," count:").concat(m),(T=new ct(q)).setMessage(I),K.l("".concat(a," ").concat(I)),D={userList:[],nextSeq:0,isCompleted:!1},V=this._createReactionUserListPack(n),this.req(V).then(function(fe){var fe=fe.data,me=fe.userIDList,me=me===void 0?[]:me,fe=fe.nextSeq,fe=fe===void 0?0:fe;return D.nextSeq=fe,D.isCompleted=fe===0,$.get(4).getUserNickAndAvatar(me)}).then(function(se){return D.userList=se,T.end(),K.l("".concat(a," ok.")),Kt(D)}).catch(function(se){return T.setError(se).end(),K.e("".concat(a," failed. error:"),se),De(se)})):this.noUse(q)}},{key:"_createReactionOperationPack",value:function(n,T,s){var h,m,I=void 0,T={reactionID:T,userIDList:[this.getMyUserID()]};return n.conversationType===O.CONV_C2C&&(h=this.get(6),I=s===1?de.ADD_C2C_MSG_REACTION:de.RM_C2C_MSG_REACTION,T.from=n.from,T.to=n.to,T.messageKey=h.getMessageKey(n)),n.conversationType===O.CONV_GROUP&&(h=void 0,m=n.to,vr(n.to)&&(m=pr(h=n.to)),I=s===1?de.ADD_GRP_MSG_REACTION:de.RM_GRP_MSG_REACTION,T.groupID=m,T.topicID=h,T.messageSequence=n.sequence),{P:I,data:T}}},{key:"_createReactionSummaryPack",value:function(D){var a,s,h,m=D.messageList,I=D.maxUserCountPerReaction,I=I===void 0?10:I,T=D.messageIDMap,D=m[0],V=void 0,$=void 0;return D.conversationType===O.CONV_C2C&&(a=this.get(6),s=m.map(function(q){var se=a.getMessageKey(q);return T.set(se,q.ID),se}),V=de.GET_C2C_MSG_REACTIONS,$={from:D.from,to:D.to,messageKeyList:s,count:I}),D.conversationType===O.CONV_GROUP&&(s=void 0,h=D.to,vr(D.to)&&(h=pr(s=D.to)),D=m.map(function(q){return T.set(q.sequence,q.ID),q.sequence}),V=de.GET_GRP_MSG_REACTIONS,$={groupID:h,topicID:s,messageSequenceList:D,count:I}),{P:V,data:$}}},{key:"_createReactionUserListPack",value:function(h){var a=h.message,I=h.reactionID,s=h.nextSeq,h=h.count,h=h===void 0?100:h,m=void 0,I={reactionID:I,nextSeq:s===void 0?0:s,count:100<h?100:h};return a.conversationType===O.CONV_C2C&&(s=this.get(6),m=de.GET_C2C_MSG_REACTION_USER_LIST,I.from=a.from,I.to=a.to,I.messageKey=s.getMessageKey(a)),a.conversationType===O.CONV_GROUP&&(h=void 0,s=a.to,vr(a.to)&&(s=pr(h=a.to)),m=de.GET_GRP_MSG_REACTION_USER_LIST,I.groupID=s,I.topicID=h,I.messageSequence=a.sequence),{P:m,data:I}}},{key:"_handleReactionSummary",value:function(n,a){var s=this;return this.get(4).getUserNickAndAvatar(a).then(function(h){var m=[];return n.forEach(function(I){var T=[];I.reactionList.forEach(function(q){var V=q.reactionID,$=q.count,me=q.userIDList,q=q.reactedByMyself,q=q===void 0?void 0:q,se=[],me=(me.forEach(function(fe){h.forEach(function(He){fe===He.userID&&se.push(He)})}),{reactionID:V,totalUserCount:$,partialUserList:se,reactedByMyself:s._computeReactedByMyself({reactedByMyself:q,messageID:I.messageID,reactionID:V})});T.push(me),et(q)&&!s._reactedByMyselfMap.has(I.messageID)&&($="".concat(I.messageID,"-").concat(V),s._reactionInfoMap.set($,me))}),m.push({messageID:I.messageID,reactionList:T})}),m})}},{key:"_addReactedByMyselfMap",value:function(n,a){this._reactedByMyselfMap.has(n)||this._reactedByMyselfMap.set(n,[]),n=this._reactedByMyselfMap.get(n),n.indexOf(a)===-1&&n.push(a)}},{key:"_removeReactedByMyselfMap",value:function(n,a){this._reactedByMyselfMap.has(n)&&-1<(a=(n=this._reactedByMyselfMap.get(n)).indexOf(a))&&n.splice(a,1)}},{key:"_computeReactedByMyself",value:function(h){var a=h.reactedByMyself,s=h.messageID,h=h.reactionID;return et(a)?!!this._reactedByMyselfMap.has(s)&&this._reactedByMyselfMap.get(s).includes(h):a===1}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}])),U1=(S(Du,$o),p(Du,[{key:"sendMessage",value:function(n){var a=this,s=this._createMsg(n);if(s===null)return De({code:Je.MSG_SEND_FAIL});this._addSendMessageTotalCount(s);var h=Date.now();return this.get(11).setMessageRandom(s),this._sendComboMessage(s,n).then(function(T){var T=T.data,D=T.time,I=T.sequence,T=T.readReceiptCode,T=(It(T)&&T!==0&&(new ct("sendMessageWithReceipt").setMessage("from:".concat(s.from," to:").concat(s.to," sequence:").concat(I," readReceiptCode:").concat(T)).end(),K.w("".concat(a._n,".sendMessage readReceiptCode:").concat(T," message:").concat(a.getErrMsg(T)))),a._addSendMessageSuccessCount(s,h),a.get(11)),D=(s.status=Fi,s.time=D,s.conversationType===O.CONV_GROUP&&(s.sequence=I),T.appendToMessageList(s),s);return s._isExcludedFromLastMessage===!0&&(D=""),T.onMessageSent({conversationOptionsList:[{conversationID:s.conversationID,unreadCount:0,type:s.conversationType,subType:s.conversationSubType,lastMessage:D}]}),Kt({message:s})}).catch(function(m){return a._onSendMessageFailed(s,m)})}},{key:"_sendComboMessage",value:function(n,a){var s=this._m.get(20),h="";return n.conversationType===O.CONV_C2C&&(h="".concat(X.NAME.OPEN_IM,".").concat(de.SEND_C2C_MSG)),n.conversationType===O.CONV_GROUP&&(h="".concat(X.NAME.GRP,".").concat(de.SEND_GRP_MSG)),s.sendComboMessage({servcmd:h,data:a})}},{key:"_createMsg",value:function(n){var a="".concat(this._n,"._createMsg"),s=null;try{var h,m=this.getMyUserID(),I={};I.senderTinyID=this.getMyTinyID(),I.currentUser=m,I.from=n.From_Account||m,n.GroupId?(I.conversationID="".concat(O.CONV_GROUP).concat(n.GroupId),I.conversationType=O.CONV_GROUP,I.to=n.GroupId):n.To_Account&&(I.conversationID="".concat(O.CONV_C2C).concat(n.To_Account),I.conversationType=O.CONV_C2C,I.to=n.To_Account),I.time=n.MsgTimeStamp||0,I.random=n.Random||n.MsgRandom||0,I.priority=n.MsgPriority,_n(n.CloudCustomData)&&0<n.CloudCustomData.length&&(I.cloudCustomData=n.CloudCustomData),wt(n.SendMsgControl)&&(I.messageControlInfo={},n.SendMsgControl.includes("NoUnread")&&(I.messageControlInfo.excludedFromUnreadCount=1),n.SendMsgControl.includes("NoLastMsg"))&&(I.messageControlInfo.excludedFromLastMessage=1),I.conversationType===O.CONV_GROUP&&wt(n.To_Account)&&0<n.To_Account.length&&(h=n.To_Account,50<n.To_Account.length&&(h=n.To_Account.slice(0,50),K.w("".concat(a," To_Account must be less than or equal to 50."))),I.receiverList=P(h),n.To_Account=P(h)),n.IsNeedReadReceipt!==1&&n.NeedReadReceipt!==1||(I.needReadReceipt=!0),n.SupportMessageExtension===1&&(I.isSupportExtension=!0),(s=new _r(I)).status=Tp,n.MsgClientTime=s.clientTime,s.conversationType===O.CONV_C2C&&(n.MsgSeq=s.sequence);for(var T,D=n.MsgBody.length,V=0;V<D;V++)(T=n.MsgBody[V]).MsgType==="TIMTextElem"?s.setTextElement(T.MsgContent.Text):T.MsgType==="TIMCustomElem"?s.setCustomElement({data:T.MsgContent.Data||"",description:T.MsgContent.Desc||"",extension:T.MsgContent.Ext||""}):T.MsgType==="TIMFaceElem"&&s.setFaceElement({index:T.MsgContent.Index,data:T.MsgContent.Data});var $=s.getElements();s.payload=$[0].content,s.type=$[0].type}catch(q){s=null,K.e("".concat(a," failed. error:"),q)}return s}},{key:"_onSendMessageFailed",value:function(n,a){n.status=Mp,this.get(11).deleteMessageRandom(n),this._addSendMessageFailCountOnUser(n,a);var s=new ct("sendMessage"),h="head.seq:".concat(a.data.headSeq,"  type:").concat(n.type," from:").concat(n.from," to:").concat(n.to);return s.setMessage(h).setError(a).end(),K.e("".concat(this._n,"._onSendMessageFailed ").concat(h," error:"),a),De(new po({code:a&&a.code?a.code:Je.MSG_SEND_FAIL,message:a&&a.message?a.message:void 0,data:{message:n}}))}},{key:"_getSendMessageSpecifiedKey",value:function(n){if(n.conversationType===O.CONV_C2C)return as;if(n.conversationType===O.CONV_GROUP){var n=this.get(7).getLocalGroupProfile(n.to);if(n)return n=n.type,jr(n)?uc:Gs}}},{key:"_addSendMessageTotalCount",value:function(n){n=this._getSendMessageSpecifiedKey(n),n&&this.get(26).addTotalCount(n)}},{key:"_addSendMessageSuccessCount",value:function(h,a){var s,h=this._getSendMessageSpecifiedKey(h);h&&((s=this.get(26)).addSuccessCount(h),s.addCost(h,br(a,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(m,s){var s=s.code,s=s===void 0?-1:s,h=this.get(26),m=this._getSendMessageSpecifiedKey(m);UI(s)&&m&&h.addFailedCountOfUserSide(m)}}])),F1=(S(wh,$o),p(wh,[{key:"registerPlugin",value:function(n){var a=this,s="0";Object.keys(n).forEach(function(h){a.plugins[h]=n[h],h==="tim-upload-plugin"&&typeof n[h].getVersion=="function"&&(s=n[h].getVersion())}),new ct("registerPlugin").setMessage("".concat(Object.keys(n))).setMoreMessage("version:".concat(s)).end()}},{key:"getPlugin",value:function(n){return this.plugins[n]}},{key:"reset",value:function(){}}])),V1=(S(Yp,$o),p(Yp,[{key:"_init",value:function(){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(n){var a=this,s=n.cookie,h=n.syncFlag,m=n.isOnlineSync,I="".concat(this._n,"._startSync"),T=(K.l("".concat(I," options:"),n),new ct("syncUnread"));T.setMessage(JSON.stringify(n)),this.req({P:de.SYNC_UNREAD_MSG,data:{cookie:s,syncFlag:h,isOnlineSync:m}}).then(function(D){var $=D.data,V=$.cookie,$=$.syncFlag,q="$cookie:".concat(V," syncFlag:").concat($);K.l("".concat(I," ok. ").concat(q)),a._cookie=V,T.setMoreMessage(q).end(),Tt(V)||($===0||$===1?(a._dispatch(E(E({},D.data),{},{isSyncingEnded:!1})),a._startSync({cookie:V,syncFlag:$,isOnlineSync:0})):$===2&&a._dispatch(E(E({},D.data),{},{isSyncingEnded:!0})))}).catch(function(D){T.setError(D).end(),K.e("".concat(I," failed. error:"),D)})}},{key:"_dispatch",value:function(n){n.eventArray&&this.get(20).onMessage({head:{},body:{eventArray:n.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:n.isSyncingEnded}}),this.get(6).onNewMessage({dataList:n.messageList,isInstantMessage:!!n.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:n.C2CRemainingUnreadList,C2CPairUnreadList:n.C2CPairUnreadList,isSyncingEnded:n.isSyncingEnded})}},{key:"syncOnNeed",value:function(){K.l("".concat(this._n,".syncOnNeed cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"syncOnReconnected",value:function(){K.l("".concat(this._n,".syncOnReconnected cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}])),jp={req:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList",cmConfigID:"CustomModerationConfigID"},res:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself",Level:"messageRemindType",PeerReadTime:"timestamp",NoUnreadSeqList:"excludedUnreadSequenceList",NewMsg:"topicLatestMessage"},ignoreKeyWord:["C2C","ID","USP"]};function Yp(n){return u(this,Yp),(n=c(this,Yp,[n]))._n="SyncUnreadMsgModule",n._cookie="",n._onlineSyncFlag=!1,n.getIEmitInst().on(So.A2KEY_AND_TINYID_UPDATED,n._init,n),n}function wh(n){return u(this,wh),(n=c(this,wh,[n]))._n="PluginModule",n.plugins={},n}function Du(n){return u(this,Du),(n=c(this,Du,[n]))._n="ComboMsgModule",n}function Jp(n){return u(this,Jp),(n=c(this,Jp,[n]))._n="MsgReactionModule",n._reactedByMyselfMap=new Map,n._reactionInfoMap=new Map,n}function mc(n){return u(this,mc),(n=c(this,mc,[n]))._n="MsgExtModule",n.msgExtMap=new Map,n.globalSeqMap=new Map,n.getMsgExtsMap=new Map,n}function Xp(n){return u(this,Xp),(n=c(this,Xp,[n]))._n="MessageModule",n._messageOptionsMap=new Map,n._mergerMessageHandler=new Hv(n),n}function $v(n,a){if(typeof n=="string"||Array.isArray(n))return a=Object.assign({pascalCase:!1},a),(n=Array.isArray(n)?n.map(function(s){return s.trim()}).filter(function(s){return s.length}).join("-"):n.trim()).length===0?"":n.length===1?a.pascalCase?n.toUpperCase():n.toLowerCase():(n=n=(n=n!==n.toLowerCase()?G1(n):n).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(s,h){return h.toUpperCase()}).replace(/\d+(\w|$)/g,function(s){return s.toUpperCase()}),a.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n);throw new TypeError("Expected the input to be `string | string[]`")}var G1=function(n){for(var a=!1,s=!1,h=!1,m=0;m<n.length;m++){var I=n[m];a&&/[a-zA-Z]/.test(I)&&I.toUpperCase()===I?(n=n.slice(0,m)+"-"+n.slice(m),h=s,s=!(a=!1),m++):s&&h&&/[a-zA-Z]/.test(I)&&I.toLowerCase()===I?(n=n.slice(0,m-1)+"-"+n.slice(m-1),h=s,a=!(s=!1)):(a=I.toLowerCase()===I&&I.toUpperCase()!==I,h=s,s=I.toUpperCase()===I&&I.toLowerCase()!==I)}return n};function FI(n,a){var s=0;return function h(m,I){var T,D,V,$;return 100<++s?(s--,m):wt(m)?(T=m.map(function(q){return Vn(q)?h(q,I):q}),s--,T):Vn(m)?(D=m,V=function(q,se){if(!Na(se))return!1;if(se!==$v(se))for(var me=0;me<jp.ignoreKeyWord.length&&!se.includes(jp.ignoreKeyWord[me]);me++);var fe;return et(I[se])?(fe=se)[0].toUpperCase()+$v(fe).slice(1):I[se]},$=Object.create(null),Object.keys(D).forEach(function(q){var se=V(D[q],q);se&&($[se]=D[q])}),T=II(T=$,function(q,se){return wt(q)||Vn(q)?h(q,I):q}),s--,T):void 0}(n,a)}for(var qv=String.fromCharCode,Kv=function(n){var a=0|n.charCodeAt(0);if(55296<=a)if(a<56320)if(n=0|n.charCodeAt(1),56320<=n&&n<=57343){if(65535<(a=(a<<10)+n-56613888|0))return qv(240|a>>>18,128|a>>>12&63,128|a>>>6&63,128|63&a)}else a=65533;else a<=57343&&(a=65533);return a<=2047?qv(192|a>>>6,128|63&a):qv(224|a>>>12,128|a>>>6&63,128|63&a)},Rh=function(n){for(var a=n===void 0?"":(""+n).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,Kv),s=0|a.length,h=new Uint8Array(s),m=0;m<s;m=m+1|0)h[m]=0|a.charCodeAt(m);return h},B1=p(function n(a){u(this,n);var s,h,m=(this._handler=a).getURL();this._socket=null,this._workerSocket=null,this._id=hn(),this._handler.getIsWorkerEnabled()?(s=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"})),this._workerSocket=new Worker(s),(h=this)._workerSocket.onmessage=function(I){var V=I.data,T=V.callback,D=V.e,V=V.extensions;T==="onOpen"?h._onOpen(V):T==="onClose"?h._onClose(D):T==="onError"?h._onError(D):T==="onMessage"&&h._onMessage(I.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:m})):_e?rt?(je.connectSocket({url:m,header:{"content-type":"application/json"}}),je.onSocketClose(this._onClose.bind(this)),je.onSocketOpen(this._onOpen.bind(this)),je.onSocketMessage(this._onMessage.bind(this)),je.onSocketError(this._onError.bind(this))):(this._socket=je.connectSocket({url:m,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):(this._socket=new WebSocket(m),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this)),this._canIUseBinaryFrame=a.canIUseBinaryFrame()},[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(n){this._handler.onOpen({id:this._id,res:JSON.stringify(n)})}},{key:"_onClose",value:function(n){this._handler.onClose({id:this._id,e:n})}},{key:"_onMessage",value:function(n){n=this._canIUseBinaryFrame?this._isAppCompressedData(n.data)?this._handler.inflate(n.data):function(a){for(var s=new Uint8Array(a),h="",m=0,I=s.length;m<I;){var T=s[m],D=0,V=0;if(T<=127?(D=0,V=255&T):T<=223?(D=1,V=31&T):T<=239?(D=2,V=15&T):T<=244&&(D=3,V=7&T),0<I-m-D)for(var $=0;$<D;)V=V<<6|63&(T=s[m+$+1]),$+=1;else V=65533,D=I-m;h+=String.fromCodePoint(V),m+=D+1}return h}(n.data):n.data,this._handler.onMessage({data:n})}},{key:"_isAppCompressedData",value:function(n){return n=new Uint8Array(n),n[0]===67&&n[1]===79&&n[2]===77&&n[3]===80}},{key:"_onError",value:function(n){this._handler.onError({id:this._id,e:n})}},{key:"setIsWorkerEnabled",value:function(n){this._isWorkerEnabled=!0}},{key:"close",value:function(n){this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:n}),this._workerSocket.terminate(),this._workerSocket=null),rt?(je.offSocketClose(),je.offSocketMessage(),je.offSocketOpen(),je.offSocketError(),je.closeSocket()):this._socket&&(_e?(this._socket.onClose(function(){}),this._socket.onOpen(function(){}),this._socket.onMessage(function(){}),this._socket.onError(function(){})):(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),Le?this._socket.close({code:n}):this._socket.close(n),this._socket=null)}},{key:"send",value:function(n){this._workerSocket?this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?Rh(n.data).buffer:n.data}):rt?je.sendSocketMessage({data:n.data,fail:function(){n.fail&&n.requestID&&n.fail(n.requestID)}}):this._socket&&(_e?this._socket.send({data:this._canIUseBinaryFrame?Rh(n.data).buffer:n.data,fail:function(){n.fail&&n.requestID&&n.fail(n.requestID)}}):this._socket.send(this._canIUseBinaryFrame?Rh(n.data):n.data))}}]),zv=["keyMap"],H1=["keyMap"],Ou="connected",Zp="connecting",Va="disconnected",$1=p(function n(a){u(this,n),this._chM=a,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=Va,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=hn(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._currentSite=re,this._setWebsocketHost(),this._initConnection()},[{key:"_setWebsocketHost",value:function(){var n=this._chM.get(12);this._currentSite=re,this._chM.isOversea()&&(this._currentSite="OVERSEA"),n.isSingaporeSite()?this._currentSite="SINGAPORE":n.isKoreaSite()?this._currentSite="KOREA":n.isGermanySite()?this._currentSite="GERMANY":n.isIndiaSite()?this._currentSite="IND":n.isJapanSite()?this._currentSite="JPN":n.isUSASite()?this._currentSite="USA":n.isIndonesiaSite()&&(this._currentSite="INDONESIA"),X.HOST.setCurrent(this._currentSite)}},{key:"_initConnection",value:function(){var a=this._chM.get(12).getSDKAppID()+"",n=this._chM.get(12).isIndependentDomainDisabled(),n=(et(X.HOST.CURRENT.BACKUP)?this._url=X.HOST.CURRENT.DEFAULT:this._url===""?this._url=n?X.HOST.CURRENT.DEFAULT:X.HOST.CURRENT.DEFAULT0.replace("*",a):-1<this._url.indexOf(a)?this._url=X.HOST.CURRENT.DEFAULT:this._url===X.HOST.CURRENT.DEFAULT?this._url=X.HOST.CURRENT.IPV6:this._url===X.HOST.CURRENT.IPV6?this._url=Ke?this._genRandomDomain():X.HOST.CURRENT.BACKUP:this._isWebBackupUrl(this._url)||this._url===X.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?X.HOST.CURRENT.ANYCAST:X.HOST.CURRENT.DEFAULT:this._url===X.HOST.CURRENT.ANYCAST&&(X.HOST.CURRENT.ANYCAST="",this._url=X.HOST.CURRENT.DEFAULT),this._chM.get(12)),a=n.getProxyServer();Tt(a)||(this._url=a),n.isTestEnv()&&(this._url=pe.TEST[this._currentSite].DEFAULT),this._connect(),this._nextPingTs=0}},{key:"_genRandomDomain",value:function(){var n=Math.floor(10001*Math.random())+1e4;return X.HOST.CURRENT.BACKUP_WEB.replace("*",n)}},{key:"_isWebBackupUrl",value:function(n){return n.includes("my-cpaas.com")}},{key:"_canIUseAnyCast",value:function(){return Ke&&X.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(n){n%1==0&&(this._checkPromiseMap(),this._checkNativeAppWS())}},{key:"_checkPromiseMap",value:function(){var n=this;this._promiseMap.size!==0&&this._promiseMap.forEach(function(I,s){var h=I.reject,m=I.timestamp,I=I.headSeq,T=15e3;s.indexOf(de.LOGIN)!==-1?T=9e4:s.indexOf(de.PING)!==-1&&(T=3e3),Date.now()-m>=T&&(K.l("".concat(n._n,"._checkPromiseMap request timeout, delete requestID:").concat(s)),n._promiseMap.delete(s),h(new po({code:Je.NETWORK_TIMEOUT,data:{headSeq:I}})),n._chM.onRequestTimeout())})}},{key:"_checkNativeAppWS",value:function(){Qe&&!this.isConnected()&&this._reConnect()}},{key:"onOpen",value:function(n){var a,s;this._readyState!==Va&&(this._onOpenTs=Date.now(),s=n.id,n=n.res,this._socketID=s,a=br(this._startTs,!1),s="socketID:".concat(s," res:").concat(n),K.l("".concat(this._n,"._onOpen cost:").concat(a," ms. ").concat(s)),new ct("wsOnOpen").setMessage(a).setCostTime(a).setMoreMessage(s).end(),this._readyState=Ou,this._reConnectCount=0,this._resend(),this._reConnectFlag===!0&&(this._chM.onReconnected(),this._reConnectFlag=!1),this._chM.onOpen())}},{key:"onClose",value:function(h){var a=new ct("wsOnClose"),s=h.id,h=h.e,m="sourceSocketID:".concat(s," currentSocketID:").concat(this._socketID," code:").concat(h.code," reason:").concat(h.reason),I=0;this._onOpenTs!==0&&(I=Date.now()-this._onOpenTs),a.setMessage(I).setCostTime(I).setMoreMessage(m).setCode(h.code).end(!0),K.l("".concat(this._n,"._onClose ").concat(m," onlineTime:").concat(I)),s===this._socketID&&(this._readyState=Va,I<1e3?this._chM.onReconnectFailed():this._chM.onClose())}},{key:"onError",value:function(s){var a=s.id,s=s.e,h="sourceSocketID:".concat(a," currentSocketID:").concat(this._socketID);new ct("wsOnError").setMessage(s.errMsg||JSON.stringify(s,["message","code"])).setMoreMessage(h).setLevel("error").end(!0),K.w("".concat(this._n,"._onError"),s,h),a===this._socketID&&(this._readyState=Va,this._chM.onError())}},{key:"onMessage",value:function(n){var a,s,h,m,I,T;try{a=JSON.parse(n.data)}catch{new ct("jsonParseError").setMessage(n.data).end()}a&&a.head&&(n=this._getRequestIDFromHead(a.head),s=a.body,this._chM.get(30).isTRTCCommand(n)||(T=ph(a.head),s=function D(V,$){var q,se,me;return wt(V)?V.map(function(fe){return Vn(fe)?D(fe,$):fe}):Vn(V)?(q=V,se=function(fe,He){return et($[He])?$v(He):$[He]},me={},Object.keys(q).forEach(function(fe){me[se(q[fe],fe)]=q[fe]}),II(me,function(fe){return wt(fe)||Vn(fe)?D(fe,$):fe})):void 0}(a.body,this._getResKeyMap(T))),K.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(s)," requestID:").concat(n," has:").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n)?(h=(T=this._promiseMap.get(n)).resolve,m=T.reject,I=T.timestamp,T=T.headSeq,this._promiseMap.delete(n),this._calcRTT(I),s.errorCode&&s.errorCode!==0?(this._chM.onErrorCodeNotZero(s),m(new po({code:s.errorCode,message:s.errorInfo||"",data:n.includes(de.MODIFY_C2C_MSG)||n.includes(de.MODIFY_GRP_MSG)?{elements:s.elements,messageVersion:s.messageVersion,cloudCustomData:s.cloudCustomData,headSeq:T}:{headSeq:T}}))):h(Kt(s))):this._chM.onMessage({head:a.head,body:s}))}},{key:"_calcRTT",value:function(n){n=Date.now()-n,this._chM.get(26).addRTT(n)}},{key:"_connect",value:function(){this._readyState!==Zp&&this._readyState!==Ou&&(this._startTs=Date.now(),this._onOpenTs=0,this._readyState=Zp,this._socket=new B1(this),this._socketID=this._socket.getID(),K.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new ct("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end())}},{key:"getURL",value:function(){this._chM.isDevMode()&&(this._canIUseBinaryFrame=!1);var n=Ev(),a=((rt||Fe&&n==="windows"||Qe)&&(this._canIUseBinaryFrame=!1),-1),h=(n==="ios"?a=dt||-1:n==="android"&&(a=ft||-1),this._chM.get(12)),s=this._chM.getPlatform(),m=h.getSDKAppID(),h=h.getInstanceID(),m="sdkappid=".concat(m,"&instanceid=").concat(h,"&random=").concat(this._getRandom(),"&platform=").concat(s,"&host=").concat(n)+"&version=".concat(a,"&sdkversion=").concat("3.5.4");return Oe&&(m+="&isminigame=1"),this._chM.canIUseInflate()&&(m+="&compress=gzip"),(this._canIUseBinaryFrame?"".concat(this._url,"/binfo?"):"".concat(this._url,"/info?")).concat(m)}},{key:"_closeConnection",value:function(n){K.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(n),this._socketID=-1,this._socket=null,this._readyState=Va)}},{key:"_resend",value:function(){var n=this;if(K.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),0<this._promiseMap.size&&this._promiseMap.forEach(function(q,D){var V=q.uplinkData,$=q.resolve,q=q.reject;D.indexOf(de.AV_POLLING)!==-1?n._promiseMap.delete(D):(n._promiseMap.set(D,{resolve:$,reject:q,timestamp:Date.now(),uplinkData:V}),n._execute(D,V))}),0<this._simpleRequestMap.size){var a,s=v(this._simpleRequestMap);try{for(s.s();!(a=s.n()).done;){var h=x(a.value,2),m=h[0],I=h[1];this._execute(m,I)}}catch(T){s.e(T)}finally{s.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(n){var a=this,s=(n.head.seq=this._getSequence(),n.head.reqtime=Math.floor(Date.now()/1e3),n.head.cs=this._calcCheckSum(n.head.servcmd,n.body),n.keyMap,N(n,zv)),h=this._getRequestIDFromHead(n.head),m=JSON.stringify(s);return new Promise(function(I,T){a._promiseMap.set(h,{resolve:I,reject:T,timestamp:Date.now(),uplinkData:m,headSeq:n.head.seq}),K.d("".concat(a._n,".send uplinkData:").concat(JSON.stringify(s)," requestID:").concat(h," readyState:").concat(a._readyState)),a._readyState!==Ou?a._reConnect():(a._execute(h,m),a._chM.get(26).addRequestCount())})}},{key:"simplySend",value:function(a){a.head.seq=this._getSequence(),a.head.reqtime=Math.floor(Date.now()/1e3),a.keyMap;var s=N(a,H1),a=this._getRequestIDFromHead(a.head),s=JSON.stringify(s);this._readyState!==Ou?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(a,s):K.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(a,s)}},{key:"_execute",value:function(n,a){this._socket.send({data:a,fail:_e?this._onSendFail.bind(this):void 0,requestID:n})}},{key:"_onSendFail",value:function(n){K.l("".concat(this._n,"._onSendFail requestID:").concat(n)),this._chM.onSendFail()}},{key:"_getSequence",value:function(){var n;if(this._startSequence<2415919103)return n=this._startSequence,this._startSequence+=1,this._startSequence===2415919103&&(this._startSequence=hn()),n}},{key:"_getRequestIDFromHead",value:function(n){return n.servcmd+n.seq}},{key:"_getResKeyMap",value:function(n){return n=this._chM.getKeyMap(n),E(E({},jp.res),n.res)}},{key:"_reConnect",value:function(){this._readyState!==Ou&&this._readyState!==Zp&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var n="".concat(this._n,".forcedReconnect");K.l("".concat(n," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._chM.get(15).isOnline()?(K.w("".concat(n," disconnected from wsserver but network is ok, continue...")),this._closeConnection(4001),this._initConnection()):this._chM.onReconnectFailed())}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=Qe?Date.now()+5e3:Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===Ou}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"getSocketID",value:function(){return this._socketID}},{key:"inflate",value:function(n){if(this._chM.canIUseInflate())return this._chM.get(37).inflate(n)}},{key:"setIsWorkerEnabled",value:function(n){K.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(n)),this._isWorkerEnabled=n}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&sn}},{key:"_getRandom",value:function(){return this._random===0&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"_calcCheckSum",value:function(n,a){if(n.indexOf(de.PING)!==-1||n.indexOf(de.LOGIN)!==-1||n.indexOf(de.LOGOUT)!==-1||n.indexOf(de.AV_POLLING)!==-1||n.indexOf(de.AV_NOAUTH_POLLING)!==-1)return 0;for(var s=Rh(JSON.stringify(a)),h=4294967295,m=0,I=s.length;m<I;m++){h^=s[m];for(var T=0;T<8;T++)(1&h)==1?h=h>>>1^3988292384:h>>>=1}return(4294967295^h)>>>0}},{key:"close",value:function(){K.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=hn(),this._readyState=Va,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),Wv=function(n,a,s){return new Promise(function(h,m){var I,T,D="application/x-www-form-urlencoded;charset=UTF-8";_e?je.request({url:a,data:s,method:n,timeout:3e3,header:{"content-type":D},success:function(V){V&&V.data&&V.data.NetCheckInfo&&K.l("".concat("getconninfo ok in"," miniapp. ret:"),V.data),h()},fail:function(){m(new po({code:Je.NETWORK_ERROR}))}}):(I=new XMLHttpRequest,T=setTimeout(function(){I.abort(),m(new po({code:Je.NETWORK_TIMEOUT}))},3e3),I.onreadystatechange=function(){I.readyState===4&&(T&&clearTimeout(T),I.status===200||I.status===304?(I.responseText&&-1<I.responseText.indexOf("NetCheckInfo")&&K.l("".concat("getconninfo ok in"," web. ret:"),JSON.parse(I.responseText)),h()):m(new po({code:Je.NETWORK_ERROR})))},I.open(n,a,!0),I.setRequestHeader("Content-type",D),s?I.send(s):I.send())})},q1=(S(em,$o),p(em,[{key:"onCheckTimer",value:function(n){this._socketHandler&&(this.isLoggedIn()?(0<this._timerForNotLoggedIn&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(n)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(n){this.get(20).onErrorCodeNotZero(n)}},{key:"onMessage",value:function(n){this.get(20).onMessage(n)}},{key:"send",value:function(n){return this._socketHandler?this._previousState!==O.NET_STATE_CONNECTED&&n.head.servcmd.includes(de.SSO_STAT)?(this.reConnect(),this.isPrivateNetWork()?Promise.resolve():this._sendLogViaHTTP(n)):this._socketHandler.send(n):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(s){var a=X.HOST.CURRENT.STAT,a="".concat(a,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(s.head.sdkappid,"&reqtime=").concat(Date.now()),s=JSON.stringify(s.body);return Wv("POST",a,s)}},{key:"simplySend",value:function(n){return this._socketHandler?this._socketHandler.simplySend(n):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){_e&&!Qe&&this.warn("DomainNameInMP"),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(n){return this.get(20).getKeyMap(n)}},{key:"onRequestTimeout",value:function(){3e4<=Date.now()-this._lastDiagnoseTS&&this.diagnose()}},{key:"onSendFail",value:function(){this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"onReconnected",value:function(){K.l("".concat(this._n,".onReconnected cost:").concat(br(this._disconnectedTS,!0,!0))),this._m.restartTimer(),this.get(20).onReconnected(br(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(O.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){K.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(n){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var n=0<arguments.length&&arguments[0]!==void 0&&arguments[0],a=!1,s=(this._socketHandler&&(a=this._socketHandler.getReconnectFlag()),"forcedFlag:".concat(n," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(a));K.l("".concat(this._n,".reConnect ").concat(s)),this._fatalErrorFlag||!this._socketHandler||n!==!0&&this._previousState===O.NET_STATE_CONNECTING&&a||(this._socketHandler.forcedReconnect(),this._emitNetStateChangeEvent(O.NET_STATE_CONNECTING))}},{key:"_emitNetStateChangeEvent",value:function(n){this._previousState!==n&&(K.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(n)),n===O.NET_STATE_DISCONNECTED&&this._disconnectedTS===0&&(this._disconnectedTS=Date.now(),this.diagnose()),this._previousState=n,this.emitOEvt(W.NET_STATE_CHANGE,{state:n}))}},{key:"_ping",value:function(){var n,a=this;this._probing!==!0&&(this._probing=!0,n=this.get(20).getProtocolData({P:de.PING}),this.send(n).then(function(){a._probing=!1}).catch(function(s){a._probing=!1;var h=a.get(15).isOnline();K.w("".concat(a._n,"._ping failed. bOnline:").concat(h," error:"),s),s&&s.code===60002?(new ct("error").setMessage("code:".concat(s.code," message:").concat(s.message)).end(),a._fatalErrorFlag=!0,a._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)):h?a.reConnect():a._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}))}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),-1<this._timerForNotLoggedIn&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"canIUseInflate",value:function(){return this._m.canIUseInflate()}},{key:"getSocketID",value:function(){if(this._socketHandler)return this._socketHandler.getSocketID()}},{key:"diagnose",value:function(){this.isPrivateNetWork()||(this._lastDiagnoseTS=Date.now(),this._diagnoseBySSO(),this._diagnoseByCDN())}},{key:"_diagnoseBySSO",value:function(){var n=this,a=this._socketHandler.getURL(),s=a.split("/")[2];s.startsWith("ws")&&(a=a.slice(a.indexOf("info?")+5),s="https://".concat(s,"/v3/netcheck/getconninfo?").concat(a,"&reqtime=").concat(Date.now()),Wv("GET",s).catch(function(h){K.w("".concat(n._n,"._diagnoseBySSO failed. error:"),h)}))}},{key:"_diagnoseByCDN",value:function(){var n=this,a=this._socketHandler.getURL(),a=a.slice(a.indexOf("info?")+5),a="https://boce-cdn.my-imcloud.com/v3/netcheck/getconninfo?".concat(a,"&reqtime=").concat(Date.now());Wv("GET",a).catch(function(s){K.w("".concat(n._n,"._diagnoseByCDN failed. error:"),s)})}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._previousState=O.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0,this._lastDiagnoseTS=0}}])),K1=["a2","tinyid"],z1=["a2","tinyid"],W1=p(function n(a){u(this,n),this._n="PHandler",this._sessionM=a,this._map=new Map,this._fillMap()},[{key:"_fillMap",value:function(){this._map.clear();var n=this._sessionM.genCommonHead(),a=this._sessionM.genCosSpecifiedHead(),s=this._sessionM.genSSOReportHead();this._map.set(de.LOGIN,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0,customInfo:""},keyMap:{req:{deviceBrand:"InstType"},res:{InstId:"instanceID",HelloInterval:"helloInterval",RichMsgAuthKey:"authKey"}}}),this._map.set(de.LOGOUT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.LOGOUT)}),body:{type:0,isWebUniapp:0},keyMap:{req:{type:"wslogout_type"}}}),this._map.set(de.HELLO,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.HELLO)}),body:{isWebUniapp:0},keyMap:{res:{NewInstInfo:"newInstanceInfo"}}}),this._map.set(de.KICK_OTHER,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.STAT_SERVICE,".").concat(de.KICK_OTHER)}),body:{}}),this._map.set(de.COS_SIGN,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.IM_COS_SIGN,".").concat(de.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{req:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},res:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}),this._map.set(de.COS_PRE_SIG,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.CUSTOM_UPLOAD,".").concat(de.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{req:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},res:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}),this._map.set(de.SIMPLE_COS_PRE_SIG,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.CUSTOM_UPLOAD,".").concat(de.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{req:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},res:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}),this._map.set(de.GET_IMAGE_INFO,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.CUSTOM_UPLOAD,".").concat(de.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{req:{imageUrl:"str_image_url"},res:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}),this._map.set(de.GET_IP,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.CUSTOM_UPLOAD,".").concat(de.GET_IP)}),body:{domainName:""},keyMap:{req:{domainName:"str_domain"},res:{str_final_ip:"ip"}}}),this._map.set(de.VIDEO_COVER,{head:E(E({},a),{},{servcmd:"".concat(X.NAME.CUSTOM_UPLOAD,".").concat(de.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{req:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},res:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}),this._map.set(de.FETCH_COMMERCIAL_CONFIG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_CONFIG_MANAGER,".").concat(de.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{req:{SDKAppID:"uint32_sdkappid"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(de.PUSHED_COMMERCIAL_CONFIG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_CONFIG_MANAGER,".").concat(de.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(de.FETCH_CLOUD_CTRL_CONFIG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_CONFIG_MANAGER,".").concat(de.FETCH_CLOUD_CTRL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{req:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(de.PUSHED_CLOUD_CTRL_CONFIG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_CONFIG_MANAGER,".").concat(de.PUSHED_CLOUD_CTRL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(de.OVERLOAD_NOTIFY,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OVERLOAD_PUSH,".").concat(de.OVERLOAD_NOTIFY)}),body:{},keyMap:{res:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}),this._map.set(de.SYNC_UNREAD_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SYNC_UNREAD_MSG)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1,needCachedMsg:1},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},res:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}),this._map.set(de.GET_PROFANITY_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_MSG_AUDIT_MGR,".").concat(de.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{req:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},res:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}),this._map.set(de.SEND_C2C_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SEND_C2C_MSG)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"}}}),this._map.set(de.SEND_GRP_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.SEND_GRP_MSG)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"},res:{MsgTime:"time",MsgSeq:"sequence"}}}),this._map.set(de.REVOKE_C2C_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.REVOKE_C2C_MSG)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{req:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}),this._map.set(de.REVOKE_GRP_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.REVOKE_GRP_MSG)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{req:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}),this._map.set(de.GET_C2C_ROAMING_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.GET_C2C_ROAMING_MSG)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{req:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},res:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}),this._map.set(de.MODIFY_C2C_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.MODIFY_C2C_MSG)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(de.GET_GRP_ROAMING_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_ROAMING_MSG)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{req:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},res:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}),this._map.set(de.SET_C2C_MSG_READ,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SET_C2C_MSG_READ)}),body:{C2CMsgReaded:void 0},keyMap:{req:{lastMessageTime:"LastedMsgTime"}}}),this._map.set(de.SET_C2C_PEER_MUTE_NOTIFICATIONS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{req:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}),this._map.set(de.GET_C2C_PEER_MUTE_NOTIFICATIONS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Peer_Account"},res:{MuteNotificationsList:"muteFlagList"}}}),this._map.set(de.SET_GRP_MSG_READ,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.SET_GRP_MSG_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{req:{messageReadSeq:"MsgReadedSeq"}}}),this._map.set(de.SET_ALL_MSG_READ,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SET_ALL_MSG_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{req:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},res:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}),this._map.set(de.DEL_C2C_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.DEL_C2C_MSG)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{req:{keyList:"MsgKeyList"}}}),this._map.set(de.DEL_GRP_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.DEL_GRP_MSG)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{req:{deleter:"Deleter_Account",keyList:"Seqs"}}}),this._map.set(de.TRANSLATE_TEXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_TRANSLATE,".").concat(de.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{req:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},res:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(de.VOICE_TO_TEXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_SPEECH,".").concat(de.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{req:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},res:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(de.MODIFY_GRP_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.MODIFY_GRP_MSG)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(de.GET_READ_RECEIPT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequence:"MsgSeq"}}}),this._map.set(de.SEND_C2C_READ_RECEIPT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{req:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}),this._map.set(de.SEND_READ_RECEIPT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}),this._map.set(de.GET_READ_RECEIPT_DETAIL,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{req:{sequence:"MsgSeq",count:"Num"},res:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}),this._map.set(de.GET_GRP_RECEIPTS_BY_USERS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_RECEIPTS_BY_USERS)}),body:{groupID:"",dataList:void 0},keyMap:{req:{dataList:"MemberReadMsgList",sequence:"MsgSeq",userIDList:"MemberList_Account"},res:{MsgReadList:"dataList",Read_Account:"userID",Read_Time:"readTime"}}}),this._map.set(de.MODIFY_C2C_MSG_EXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.MODIFY_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(de.GET_C2C_MSG_EXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}),this._map.set(de.MODIFY_GRP_MSG_EXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.MODIFY_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(de.GET_GRP_MSG_EXT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}),this._map.set(de.ADD_C2C_MSG_REACTION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(de.RM_C2C_MSG_REACTION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.RM_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(de.GET_C2C_MSG_REACTIONS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}),this._map.set(de.GET_C2C_MSG_REACTION_USER_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}),this._map.set(de.ADD_GRP_MSG_REACTION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(de.RM_GRP_MSG_REACTION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.RM_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(de.GET_GRP_MSG_REACTIONS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{res:{MsgSeq:"messageSequence"}}}),this._map.set(de.GET_GRP_MSG_REACTION_USER_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM_MSG_EXT,".").concat(de.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}),this._map.set(de.GET_C2C_PEER_READ_TIME,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{req:{userIDList:"To_Account"},res:{ReadTime:"peerReadTimeList"}}}),this._map.set(de.PAGING_GET_CONV_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.PAGING_GET_CONV_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{req:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},res:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}),this._map.set(de.DEL_CONV,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.DEL_CONV)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{req:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},res:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}),this._map.set(de.CLEAR_HISTORY_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.CLEAR_HISTORY_MSG)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{req:{toGroupID:"ToGroupid"}}}),this._map.set(de.PIN_CONV,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.PIN_CONV)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{req:{itemList:"RecentContactItem"}}}),this._map.set(de.DEL_GROUP_AT_TIPS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.DEL_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(de.SET_CONV_CUSTOM_DATA,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(de.MARK_CONV,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(de.CREATE_CONV_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.CREATE_CONV_GRP)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"GroupContactItem",groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(de.DEL_CONV_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.DEL_CONV_GRP)}),body:{fromAccount:"",groupName:void 0},keyMap:{res:{GroupId:"convGroupID"}}}),this._map.set(de.RENAME_CONV_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{req:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},res:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}),this._map.set(de.ADD_CONV_TO_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}}}),this._map.set(de.DEL_CONV_FROM_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0}}),this._map.set(de.GET_CONV_GRP_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.GET_CONV_GRP_LIST)}),body:{fromAccount:"",startIndex:void 0},keyMap:{res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}),this._map.set(de.SEARCH_CONV_GRP_MARK,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.RECENT_CONTACT,".").concat(de.SEARCH_CONV_GRP_MARK)}),body:{fromAccount:"",contactItem:void 0},keyMap:{req:{groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList",ContactResultItem:"contactItem"}}}),this._map.set(de.GET_USER_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.PROFILE,".").concat(de.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(de.UPDATE_MY_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.PROFILE,".").concat(de.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:Gt.NICK,value:""},{tag:Gt.GENDER,value:""},{tag:Gt.ALLOWTYPE,value:""},{tag:Gt.AVATAR,value:""}]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(de.GET_BL,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.GET_BL)}),body:{fromAccount:"",startIndex:0,maxLimited:30}}),this._map.set(de.ADD_TO_BL,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.ADD_TO_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(de.RM_FROM_BL,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.RM_FROM_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(de.SET_SELF_STATUS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.SET_SELF_STATUS)}),body:{customStatus:""}}),this._map.set(de.GET_USER_STATUS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}),this._map.set(de.SUB_USER_STATUS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.SUB_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(de.UNSUB_USER_STATUS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.UNSUB_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(de.GET_FD_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.GET_FD_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{res:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}),this._map.set(de.ADD_FD,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.ADD_FD)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{req:{source:"AddSource",wording:"AddWording",type:"AddType"},res:{ResultItem:"resultList"}}}),this._map.set(de.UPDATE_FD,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.UPDATE_FD)}),body:{fromAccount:"",updateItem:void 0},keyMap:{req:{snsItem:"SnsItem"},res:{ResultItem:"resultList"}}}),this._map.set(de.DEL_FD,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.DEL_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"DeleteType"},res:{ResultItem:"resultList"}}}),this._map.set(de.GET_FD_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.GET_FD_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{res:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}),this._map.set(de.CHECK_FD,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.CHECK_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"CheckType"},res:{InfoItem:"resultList"}}}),this._map.set(de.GET_FD_APPLICATION_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.GET_FD_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{res:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}),this._map.set(de.RESPOND_FD_APPLICATION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.RESPOND_FD_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{req:{tag:"TagName",action:"ResponseAction"},res:{ResultItem:"resultList"}}}),this._map.set(de.DEL_FD_APPLICATION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.DEL_FD_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{req:{type:"PendencyType",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(de.REPORT_FD_APPLICATION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.REPORT_FD_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{req:{latestTimeStamp:"LatestPendencyTimeStamp"}}}),this._map.set(de.CREATE_FD_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.CREATE_FD_GRP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{req:{groupName:"GroupName",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(de.DEL_FD_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.DEL_FD_GRP)}),body:{fromAccount:"",nameList:void 0},keyMap:{req:{nameList:"GroupName"}}}),this._map.set(de.GET_FD_GRP_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.GET_FD_GRP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{res:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}),this._map.set(de.UPDATE_FD_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FD,".").concat(de.UPDATE_FD_GRP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{req:{oldName:"GroupOldName",newName:"GroupNewName"},res:{UpdateType:"type",ResultItem:"resultList"}}}),this._map.set(de.GET_GRP_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0,needAppDefineData:1},keyMap:{req:{memberAccount:"Member_Account"},res:{GroupIdList:"groups",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime",AppDefinedData:"groupCustomField"}}}),this._map.set(de.GET_GRP_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{req:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(de.CREATE_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.CREATE_GRP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{req:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},res:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}),this._map.set(de.DISMISS_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.DISMISS_GRP)}),body:{groupID:void 0}}),this._map.set(de.UPDATE_GRP_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.UPDATE_GRP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{req:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},res:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(de.APPLY_JOIN_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{req:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},res:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}),this._map.set(de.APPLY_JOIN_GRP_NOAUTH,(n.a2,n.tinyid,{head:E(E({},N(n,K1)),{},{servcmd:"".concat(X.NAME.BIG_GRP_NO_AUTH,".").concat(de.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{req:{applyMessage:"ApplyMsg"},res:{HugeGroupFlag:"avChatRoomFlag"}}})),this._map.set(de.QUIT_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.QUIT_GRP)}),body:{groupID:void 0}}),this._map.set(de.SEARCH_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.SEARCH_GRP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}}}),this._map.set(de.CHANGE_GRP_OWNER,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.CHANGE_GRP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{req:{newOwnerID:"NewOwner_Account"}}}),this._map.set(de.HANDLE_GRP_APPLICATION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.HANDLE_GRP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(de.HANDLE_INVITE_JOIN_GRP,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.HANDLE_INVITE_JOIN_GRP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}),this._map.set(de.HANDLE_GRP_INVITATION,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.HANDLE_GRP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(de.GET_GRP_PENDENCY,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{req:{handleAccount:"Handle_Account"},res:{To_Account:"userID",ApplyInviteMsg:"note"}}}),this._map.set(de.DEL_GRP_SYSTEM_NOTICE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.DEL_GRP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(de.AV_POLLING,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.BIG_GRP_POLLING,".").concat(de.AV_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}),this._map.set(de.AV_NOAUTH_POLLING,(n.a2,n.tinyid,{head:E(E({},N(n,z1)),{},{servcmd:"".concat(X.NAME.BIG_GRP_POLLING_NO_AUTH,".").concat(de.AV_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}})),this._map.set(de.GET_ONLINE_MBR_NUM,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_ONLINE_MBR_NUM)}),body:{groupID:void 0},keyMap:{res:{OnlineMemberNum:"memberCount"}}}),this._map.set(de.SET_GRP_ATTR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.SET_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(de.MODIFY_GRP_ATTR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.MODIFY_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(de.DEL_GRP_ATTR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.DEL_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key"}}}),this._map.set(de.CLEAR_GRP_ATTR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.CLEAR_GRP_ATTR)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}),this._map.set(de.GET_GRP_ATTR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_ATTR,".").concat(de.GET_GRP_ATTR)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{req:{avChatRoomKey:"Key",groupType:"GroupType"}}}),this._map.set(de.GET_GRP_NOTIFY,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{req:{notifyReqList:"NotifyReqList"},res:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}),this._map.set(de.UPDATE_GRP_COUNTER,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.UPDATE_GRP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{req:{counterList:"GroupCounter"}}}),this._map.set(de.GET_GRP_COUNTER,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{req:{keyList:"GroupCounterKeys"}}}),this._map.set(de.CREATE_TOPIC,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_COMMUNITY,".").concat(de.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{req:{avatar:"FaceUrl"}}}),this._map.set(de.DEL_TOPIC,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_COMMUNITY,".").concat(de.DEL_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{req:{topicIDList:"TopicIdList"},res:{DestroyResultItem:"resultList"}}}),this._map.set(de.UPDATE_TOPIC_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_COMMUNITY,".").concat(de.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{req:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}),this._map.set(de.GET_TOPIC_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_COMMUNITY,".").concat(de.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{req:{topicIDList:"TopicIdList"},res:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence"}}}),this._map.set(de.GET_GRP_MBR_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_MBR_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}),this._map.set(de.GET_AV_MBR_LIST,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_AV,".").concat(de.GET_AV_MBR_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{req:{offset:"Timestamp",filter:"Mark"},res:{NextTimestamp:"offset"}}}),this._map.set(de.GET_GRP_MBR_PROFILE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.GET_GRP_MBR_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}),this._map.set(de.ADD_GRP_MBR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.ADD_GRP_MBR)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{req:{userID:"Member_Account",userIDList:"MemberList"},res:{MemberList:"members"}}}),this._map.set(de.DEL_GRP_MBR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.DEL_GRP_MBR)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{req:{userIDList:"MemberToDel_Account"}}}),this._map.set(de.BAN_AV_MBR,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.BAN_AV_MBR)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{req:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}),this._map.set(de.MODIFY_GRP_MBR_INFO,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP,".").concat(de.MODIFY_GRP_MBR_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{req:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}),this._map.set(de.MARK_AV_MBR_INFO,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_AV,".").concat(de.MARK_AV_MBR_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{req:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},res:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}),this._map.set(de.CS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.MSG_SEARCH,".").concat(de.CS)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{req:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList",keywords:"Keywords",keywordMatchType:"KeywordMatchType",count:"Count",miniBirthday:"UserBirthStart",maxBirthday:"UserBirthEnd",gender:"UserGenderType",groupTypeList:"GroupType",groupIDList:"GroupIdList"},res:{GroupID:"groupID",UserID:"userID",ErrorCode:"code",ErrorInfo:"message",TotalCount:"totalCount",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",Users:"userList",ProfileItems:"profileItems",StrValue:"value",IntValue:"value",Groups:"groupList",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupOwnerUserID:"ownerID",GroupOwnerUserName:"ownerNick",GroupOwnerTinyID:"ownerTinyID",GroupMemberNum:"memberNum",GroupName:"name",GroupType:"type",GroupMembers:"groupMemberList",GroupMemberUserID:"userID",GroupMemberTinyID:"userTinyID",GroupMemberUserName:"nick",GroupMemberNameCard:"nameCard"}}}),this._map.set(de.USER_CS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.USER_SEARCH,".").concat(de.CS)}),body:{keywords:void 0,keywordMatchType:0,miniBirthday:void 0,maxBirthday:void 0,gender:void 0,count:20,cursor:void 0}}),this._map.set(de.GRP_CS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_SEARCH,".").concat(de.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,count:20,cursor:void 0}}),this._map.set(de.MBR_CS,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.GRP_MEMBER_SEARCH,".").concat(de.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,groupIDList:void 0,count:20,cursor:void 0}}),this._map.set(de.SSO_STAT,{head:E(E({},s),{},{servcmd:"".concat(X.NAME.IM_OPEN_STAT,".").concat(de.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{req:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}),this._map.set(de.PING,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.HEARTBEAT,".").concat(de.PING)}),body:{}}),this._map.set(de.MSG_PUSH,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_PUSH,".").concat(de.MSG_PUSH)}),body:{},keyMap:{res:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType"}}}),this._map.set(de.MULTI_MSG_PUSH,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_PUSH,".").concat(de.MULTI_MSG_PUSH)}),body:{},keyMap:{res:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}),this._map.set(de.MSG_PUSH_ACK,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OPEN_IM,".").concat(de.MSG_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{req:{sessionData:"SessionData"}}}),this._map.set(de.STATUS_FORCE_OFFLINE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{res:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}),this._map.set(de.DOWNLOAD_MERGER_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_LONG_MSG,".").concat(de.DOWNLOAD_MERGER_MSG)}),body:{downloadKey:""},keyMap:{res:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}),this._map.set(de.UPLOAD_MERGER_MSG,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_LONG_MSG,".").concat(de.UPLOAD_MERGER_MSG)}),body:{messageList:[]},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}),this._map.set(de.FOLLOW,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FOLLOW,".").concat(de.FOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"FollowItem"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(de.UNFOLLOW,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FOLLOW,".").concat(de.UNFOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(de.GET_FOLLOW_INFO,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FOLLOW,".").concat(de.GET_FOLLOW_INFO)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{FollowInfo:"followInfoList",To_Account:"userID",FollowerCount:"followersCount",FollowingCount:"followingCount",MutualFollowingCount:"mutualFollowersCount"}}}),this._map.set(de.GET_FOLLOW,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FOLLOW,".").concat(de.GET_FOLLOW)}),body:{fromAccount:"",type:1,nextCursor:"",count:500},keyMap:{req:{type:"FollowType",nextCursor:"StartCursor",count:"WantNum"},res:{FollowItem:"resultList",To_Account:"userID",ProfileItem:"profileList"}}}),this._map.set(de.CHECK_FOLLOW_TYPE,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.FOLLOW,".").concat(de.CHECK_FOLLOW_TYPE)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(de.SET_TOKEN,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0,notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:""},keyMap:{req:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns",notificationStatus:"NotificationStatus",deviceModel:"DeviceModel",systemVersion:"SystemVersion",pushVersion:"PushPluginVersion"}}}),this._map.set(de.STAT_FOREGROUND,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.STAT_FOREGROUND)}),body:{isWebUniapp:0}}),this._map.set(de.STAT_BACKGROUND,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_OPEN_STATUS,".").concat(de.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{req:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}),this._map.set(de.PUSH_REPORT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.OFFLINE_PUSH_REPORT,".").concat(de.PUSH_REPORT)}),body:{eventList:[]},keyMap:{req:{eventList:"UinappPushEvents",type:"EventType",time:"EventTime",pushId:"ClickExt"}}}),this._map.set(de.SET_ALL_RECEIVE_MSG_OPT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_MSG_LOGIC,".").concat(de.SET_ALL_RECEIVE_MSG_OPT)}),body:{startTime:0,endTime:0,isRepeated:0,messageRemindType:0},keyMap:{req:{messageRemindType:"Level"}}}),this._map.set(de.GET_ALL_RECEIVE_MSG_OPT,{head:E(E({},n),{},{servcmd:"".concat(X.NAME.IM_MSG_LOGIC,".").concat(de.GET_ALL_RECEIVE_MSG_OPT)}),body:{toAccount:void 0}})}},{key:"has",value:function(n){return this._map.has(n)}},{key:"get",value:function(n){return this._map.get(n)}},{key:"update",value:function(){this._fillMap()}},{key:"getKeyMap",value:function(n){return this.has(n)?this.get(n).keyMap||{}:(K.w("".concat(this._n,".getKeyMap unknown P:").concat(n)),{})}},{key:"getProtocolData",value:function(s){var h=s.P,a=s.data,s=this.get(h),h=null;if(a){var m,I=this._simpleDeepCopy(s),I=this._updateService(a,I),T=I.body,D=Object.create(null);for(m in T)if(Object.prototype.hasOwnProperty.call(T,m)){if(D[m]=T[m],a[m]===void 0)continue;D[m]=a[m]}I.body=D,h=this._getUplinkData(I)}else h=this._getUplinkData(s);return h}},{key:"_getUplinkData",value:function(a){var a=this._dataCleaner(a),s=ph(a.head),s=FI(a.body,this._getReqKeyMap(s));return a.body=s,a}},{key:"_updateService",value:function(n,a){var s,h,m=ph(a.head);return this._isFromGroupRequest(a)&&(s=n.type,h=n.groupID,n=(n=n.groupIDList)===void 0?[]:n,et(h=h===void 0?void 0:h)&&(h=n[0]||""),Yr({type:s,groupID:h}))&&(a.head.servcmd="".concat(X.NAME.GRP_COMMUNITY,".").concat(m)),a}},{key:"_isFromGroupRequest",value:function(n){return n.head.servcmd.includes(X.NAME.GRP)||n.head.servcmd.includes(X.NAME.GRP_ATTR)}},{key:"_getReqKeyMap",value:function(n){return n=this.getKeyMap(n),E(E({},jp.req),n.req)}},{key:"_dataCleaner",value:function(n){var a,s=Array.isArray(n)?[]:Object.create(null);for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&Na(a)&&n[a]!==null&&n[a]!==void 0&&(H(n[a])!=="object"?s[a]=n[a]:s[a]=this._dataCleaner.bind(this)(n[a]));return s}},{key:"_simpleDeepCopy",value:function(n){for(var a,s=Object.keys(n),h={},m=0,I=s.length;m<I;m++)a=s[m],wt(n[a])?h[a]=Array.from(n[a]):Vn(n[a])?h[a]=this._simpleDeepCopy(n[a]):h[a]=n[a];return h}}]),VI=[de.MSG_PUSH_ACK],j1=p(function n(a){u(this,n),this._sessionM=a,this._n="MsgDispatcher",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._onC2CMsgArray.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._onGroupMsgArray.bind(this)),this._eventHandlerMap.set("groupTips",this._onGroupTips.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._onC2CNotifyMsgArray.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._onC2CReadReceiptArray.bind(this)),this._eventHandlerMap.set("profileModify",this._onProfileModified.bind(this)),this._eventHandlerMap.set("friendListMod",this._onRelationChainModified.bind(this)),this._eventHandlerMap.set("recentContactMod",this._onRecentContact.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._onAllMsgRead.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._onC2CMsgModified.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._onGroupMsgModified.bind(this)),this._eventHandlerMap.set("userStatusList",this._onUserStatusList.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._onMsgExtNotify.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._onMsgReactionNotifyList.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._onMsgReactionNotify.bind(this)),this._eventHandlerMap.set("followChangeList",this._onFollowNotify.bind(this)),this._keys=P(this._eventHandlerMap.keys())},[{key:"_onC2CMsgArray",value:function(n){var a=this._sessionM.get(6);n.dataList.forEach(function(s){var h;s.isSyncMessage===1&&(h=s.from,s.from=s.to,s.to=h)}),n.needSync===1&&this._sessionM.get(19).syncOnNeed(),a.onNewMessage({dataList:n.dataList,isInstantMessage:!0})}},{key:"_onC2CMsgModified",value:function(n){this._sessionM.get(6).onMsgModified(n)}},{key:"_onGroupMsgArray",value:function(n){var a=this._sessionM.get(7);a&&a.onNewMessage({event:n.event,dataList:n.dataList,isInstantMessage:!0})}},{key:"_onGroupMsgModified",value:function(n){var a=this._sessionM.get(7);a&&a.onMsgModified(n)}},{key:"_onGroupTips",value:function(n){var a=this._sessionM.get(7);if(a){var s=n.event,h=n.dataList,m=n.isInstantMessage,I=m===void 0||m,T=n.isSyncingEnded;switch(s){case 4:case 6:a.onNewGroupTips({event:s,dataList:h});break;case 5:for(var D=0;D<h.length;D++)if(wt(h[D].elements.revokedInfos))a.onMsgRevoked({dataList:h});else if(wt(h[D].elements.groupMessageReadNotice))a.onMsgReadNotice({dataList:h});else{if(!wt(h[D].elements.readReceiptList)){a.onNewGroupSystemNotice({dataList:h,isInstantMessage:I,isSyncingEnded:T});break}a.onReadReceiptList({dataList:h})}break;case 12:this._sessionM.get(11).onNewGroupAtTips({dataList:h});break;default:K.l("".concat(this._n,"._onGroupTips unknown event:").concat(s," dataList:"),h)}}}},{key:"_onC2CNotifyMsgArray",value:function(n){var a,s=this,h=n.dataList;wt(h)&&(a=this._sessionM.get(6),h.forEach(function(m){var I,T;On(m)&&(m.hasOwnProperty("kickoutMsgNotify")?(I=(T=m.kickoutMsgNotify).kickType,T=(T=T.newInstanceInfo)===void 0?{}:T,I===1?s._sessionM.onMultipleAccountKickedOut(T):I===2?s._sessionM.onMultipleDeviceKickedOut(T):I===3&&s._sessionM.onRestApiKickedOut(T)):m.hasOwnProperty("c2cMessageRevokedNotify")?a&&a.onMsgRevoked({dataList:h},!0):m.hasOwnProperty("c2cMessageReadReceipt")?a&&a.onMsgReadReceipt({dataList:h}):m.hasOwnProperty("c2cMessageReadNotice")?a&&a.onMsgReadNotice({dataList:h}):m.hasOwnProperty("muteNotificationsSync")&&s._sessionM.get(11).onC2CMsgRemindTypeSynced({dataList:h}))}))}},{key:"_onC2CReadReceiptArray",value:function(n){this._sessionM.get(6).onReadReceiptList(n)}},{key:"_onProfileModified",value:function(n){this._sessionM.get(4).onProfileModified({dataList:n.dataList});var a=this._sessionM.get(8);a&&a.onFriendProfileModified({dataList:n.dataList})}},{key:"_onRelationChainModified",value:function(n){this._sessionM.get(4).onRelationChainModified({dataList:n.dataList});var a=this._sessionM.get(8);a&&a.onRelationChainModified({dataList:n.dataList})}},{key:"_onRecentContact",value:function(s){var a,s=s.dataList;wt(s)&&(a=this._sessionM.get(11))&&s.forEach(function(h){var m,I,T=h.pushType;T===1?(m=h.recentContactDeleteItem,a.onConvDeleted(m.recentContactList)):T===2?(m=h.recentContactTopItem,a.onConvPinnedStatus(m.recentContactList,!0)):T===3?(m=h.recentContactTopItem,a.onConvPinnedStatus(m.recentContactList,!1)):T===4?(m=h.recentContactMarkContact,a.onConvMarkUpdated(m.recentContactMarkContactItem)):T===5?(m=h.recentContactCreateContactGroup,a.onConvGroupCreated(m.msgContactGroupContactItem)):T===6?(m=h.recentContactDelContactGroup,a.onConvGroupDeleted(m.msgGroupItem)):T===7&&(T=(m=h.recentContactUpdateContactGroup).updateType,h=m.msgUpdateGroup,m=m.msgUpdateContact,T===1?(I=h.updateGroupType)===1?a.onConvGroupNameUpdated(h):I===2&&a.onConvInGroupUpdated(h):T===2&&a.onConvAddedToOrDeletedFromGroup(m))})}},{key:"_onAllMsgRead",value:function(a){var a=a.dataList,s=this._sessionM.get(11);s&&s.onPushedAllMessageRead(a)}},{key:"_onUserStatusList",value:function(n){this._sessionM.get(4).onUserStatusUpdated(n)}},{key:"_onMsgExtNotify",value:function(n){this._sessionM.get(3).onMsgExtNotify(n)}},{key:"_onMsgReactionNotifyList",value:function(n){this._sessionM.get(34).onReactionNotifyList(n)}},{key:"_onMsgReactionNotify",value:function(n){this._sessionM.get(34).onReactionNotify(n)}},{key:"_onFollowNotify",value:function(n){this._sessionM.get(35).onFollowNotify(n)}},{key:"_onTopicLatestMsg",value:function(n){this._sessionM.get(10).onTopicLatestMsg(n)}},{key:"onMessage",value:function(n){var a=this,s=n.body;if(this._filterMsgFromIMOpenPush(n)){var h,m=s.eventArray,I=s.isInstantMessage,T=s.isSyncingEnded,D=s.needSync;if(wt(m))for(var V,$,q,se=0,me=m.length;se<me;se++)(q=(V=m[se]).event)!==100?q!==24?q!==26?(h=Object.keys(V).find(function(fe){return a._keys.indexOf(fe)!==-1}))?($=q===14?{readAllC2CMessage:V[h],groupMessageReadInfoList:V.groupMessageReadNotice||[]}:q===16?{userID:V.userID,timestamp:V.timestamp,readReceiptList:V[h]}:V[h],this._eventHandlerMap.get(h)({event:q,dataList:$,isInstantMessage:I,isSyncingEnded:T,needSync:D})):K.l("".concat(this._n,".onMessage unknown eventItem:"),V):this._onTopicLatestMsg(V):this._onAllRcvMsgOptNotify(V):this._onRoomCustomData(V.content)}}},{key:"_onRoomCustomData",value:function(n){this._sessionM.get(30).onRoomCustomDataReceived(n),K.l("".concat(this._n,"._onRoomCustomData data:").concat(n))}},{key:"_onAllRcvMsgOptNotify",value:function(n){this._sessionM.get(11).onAllRcvMsgOptNotify(n)}},{key:"_filterMsgFromIMOpenPush",value:function(a){var s=a.head,a=a.body,s=s.servcmd,h=!1;return!(h=et(s)?h:s.includes(X.NAME.IM_CONFIG_MANAGER)||s.includes(X.NAME.OVERLOAD_PUSH)||s.includes(X.NAME.STAT_SERVICE))||(s.includes(de.PUSHED_CLOUD_CTRL_CONFIG)?this._sessionM.get(23).onPushedConfig(a):s.includes(de.PUSHED_COMMERCIAL_CONFIG)?this._sessionM.get(27).onPushedConfig(a):s.includes(de.OVERLOAD_NOTIFY)?this._sessionM.onPushedServerOverload(a):s.includes(de.KICK_OTHER)&&(h=Date.now(),this._sessionM.reLoginOnKickOther(),a=new ct("kickOther"),h=h-(s=this._sessionM.get(1).getLastWsHelloTs()),a.setMessage("last wshello time:".concat(s," diff:").concat(h,"ms")).end()),!1)}}]),GI=[{cmd:de.GET_GRP_PROFILE,interval:1,count:8},{cmd:de.UPDATE_GRP_PROFILE,interval:1,count:8},{cmd:de.GET_AV_MBR_LIST,interval:3,count:1},{cmd:de.GET_GRP_PENDENCY,interval:1,count:15},{cmd:de.GET_TOPIC_LIST,interval:1,count:10},{cmd:de.SET_GRP_ATTR,interval:5,count:10},{cmd:de.MODIFY_GRP_ATTR,interval:5,count:10},{cmd:de.DEL_GRP_ATTR,interval:5,count:10},{cmd:de.CLEAR_GRP_ATTR,interval:5,count:10},{cmd:de.GET_GRP_ATTR,interval:5,count:20},{cmd:de.UPDATE_GRP_COUNTER,interval:5,count:20},{cmd:de.GET_GRP_COUNTER,interval:5,count:20},{cmd:de.SET_ALL_MSG_READ,interval:1,count:1},{cmd:de.GET_USER_STATUS,interval:5,count:20},{cmd:de.SUB_USER_STATUS,interval:5,count:20},{cmd:de.UNSUB_USER_STATUS,interval:5,count:20},{cmd:de.CS,interval:5,count:20},{cmd:de.GRP_CS,interval:5,count:20},{cmd:de.MBR_CS,interval:5,count:20},{cmd:de.USER_CS,interval:5,count:20},{cmd:de.CHECK_FOLLOW_TYPE,interval:5,count:20},{cmd:de.GET_GRP_ROAMING_MSG,interval:1,count:20},{cmd:de.GET_C2C_ROAMING_MSG,interval:1,count:20}],jv=new Map,BI=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],Qp=0,Y1=BI.length;Qp<Y1;Qp++)jv.set(Qp,BI[Qp]);function em(n){return u(this,em),(n=c(this,em,[n]))._n="ChannelModule",n._socketHandler=new $1(n),n._probing=!1,n._isAppShowing=!0,n._previousState=O.NET_STATE_CONNECTED,n._timerForNotLoggedIn=-1,n._timerForNotLoggedIn=setInterval(n.onCheckTimer.bind(n),1e3),n._fatalErrorFlag=!1,n._disconnectedTS=0,n._lastDiagnoseTS=0,n}function Yv(n){for(var a,s,h=n,m="",I=0,T=(h=n.length%8!=0?"0".repeat(8-n.length%8)+n:h).length;I<T;I+=8)a=parseInt(h.slice(I,I+4),2),s=parseInt(h.slice(I+4,I+8),2),m+=jv.get(a)+jv.get(s);return m}function Lu(n){var a;return n<0||53<n?NaN:(a=0|1073741824*Math.random(),30<n?a+1073741824*(0|Math.random()*(1<<n-30)):a>>>30-n)}function J1(n,a){for(var s=n.toString(16),h=a-s.length,m="0";0<h;h>>>=1,m+=m)1&h&&(s=m+s);return s}S(xu,$o);var X1=p(xu,[{key:"_init",value:function(){this._updateCmdFreqLimitMap(GI)}},{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("cmd_frequency_limit");et(n)||(n=JSON.parse(n),this._updateCmdFreqLimitMap(n))}},{key:"_updateCmdFreqLimitMap",value:function(n){var a=this;n.forEach(function(s){a._cmdFreqLimitMap.set(s.cmd,{interval:s.interval,count:s.count})})}},{key:"updateProtocolConfig",value:function(){this._pHandler.update()}},{key:"req",value:function(n){K.d("".concat(this._n,".req options:"),n);var a,s,h=n.P;return this._pHandler.has(h)?(a=(n=this.getProtocolData(n)).head.servcmd,this._isFreqOverLimit(a)?De({code:s=Je.OVER_FREQUENCY_LIMIT,message:this.getErrMsg(s,this._getCmd(a))}):this._isServerOverload(a)?De({code:s=Je.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrMsg(s,this._getCmd(a))}):(s=this.get(21),VI.includes(h)?s.simplySend(n):s.send(n))):(K.w("".concat(this._n,".req unknown P:").concat(h)),De({code:Je.NO_PROTOCOL}))}},{key:"getKeyMap",value:function(n){return this._pHandler.getKeyMap(n)}},{key:"genCommonHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:he,websdkversion:te,a2:n.getA2Key()||void 0,tinyid:n.getTinyID()||void 0,status_instid:n.getStatusInstanceID(),sdkappid:n.getSDKAppID(),contenttype:n.getContentType(),reqtime:0,identifier:n.getA2Key()?void 0:n.getUserID(),usersig:n.getA2Key()?void 0:n.getUserSig(),sdkability:75689843,sdkability_ext:Yv(""),cappid:n.getApplicationID(),cs:0}}},{key:"genCosSpecifiedHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:he,websdkversion:te,sdkappid:n.getSDKAppID(),contenttype:n.getContentType(),reqtime:0,identifier:n.getUserID(),usersig:n.getUserSig(),status_instid:n.getStatusInstanceID(),sdkability:75689843,sdkability_ext:Yv(""),cappid:n.getApplicationID(),cs:0}}},{key:"genSSOReportHead",value:function(){var n=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:he,websdkversion:te,sdkappid:n.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:n.getStatusInstanceID(),sdkability:75689843,sdkability_ext:Yv(""),cappid:n.getApplicationID(),cs:0}}},{key:"getProtocolData",value:function(n){return this._pHandler.getProtocolData(n)}},{key:"trans",value:function(a){var s=a.servcmd,a=a.data,s={head:E(E({},this.genCommonHead()),{},{servcmd:s}),body:a};return this.get(21).send(s)}},{key:"sendComboMessage",value:function(a){var s=a.servcmd,a=a.data,s={head:E(E({},this.genCommonHead()),{},{servcmd:s}),body:a};return this.get(21).send(s)}},{key:"onErrorCodeNotZero",value:function(n){var a,s=n.errorCode;s===Je.HELLO_ANSWER_KICKED_OUT&&(a=n.kickType,n=(n=n.newInstanceInfo)===void 0?{}:n,a===1?this.onMultipleAccountKickedOut(n):a===2?this.onMultipleDeviceKickedOut(n):a===3&&this.onRestApiKickedOut(n)),s!==Je.MSG_A2KEY_EXPIRED&&s!==Je.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.get(21).reConnect())}},{key:"onMessage",value:function(n){var s=n.body,a=s.needAck,s=s.sessionData;(a===void 0?0:a)===1&&this._sendACK(s),this._msgDispatcher.onMessage(n)}},{key:"onReconnected",value:function(n){this._incrementalPullContactFlag=n<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){K.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){K.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var n,a,s,h=this,m="".concat(this._n,"._reLogin");this.isLoggedIn()&&(n=0,(a=this.get(1).getPushModule())&&(n=a.getUniAppPlatform()),s=new ct("reLogin"),this.req({P:de.LOGIN,data:{isWebUniapp:n,customInfo:this.get(12).getCustomLoginInfo()}}).then(function(T){var T=T.data,$=T.instanceID,T=T.customStatus,se=h.get(12),D=Up(T),V=(se.setStatusInstanceID($),h.get(21)),q=V.getSocketID(),q="socketID:".concat(q," instanceID:").concat($," customStatus:").concat(D),$=(s.setMessage(q).end(!0),K.l("".concat(m," ok. ").concat(q)),se.getCustomStatus()!==D&&h.get(4).onUserStatusUpdated({dataList:[{to:h.getMyUserID(),statusType:O.USER_STATUS_ONLINE,customStatus:T}]}),V.diagnose(),h.get(11).syncConvList(h._incrementalPullContactFlag).then(function(){K.l("".concat(m,", sync conv list ok.")),h.get(25).start()}),h.get(7)),q=($&&$.updateLocalMainSequenceOnReconnected(),h.get(10)),se=(q.resetGetTopicTime(),q.getTopicListOnReconnected(),h.get(35));se&&se.clearCacheOnReconnected()}))}},{key:"onMultipleAccountKickedOut",value:function(n){this.get(1).onMultipleAccountKickedOut(n)}},{key:"onMultipleDeviceKickedOut",value:function(n){this.get(1).onMultipleDeviceKickedOut(n)}},{key:"_onUserSigExpired",value:function(){this.get(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(n){this.get(1).onRestApiKickedOut(n)}},{key:"_sendACK",value:function(n){this.req({P:de.MSG_PUSH_ACK,data:{sessionData:n}})}},{key:"_isFreqOverLimit",value:function(I){var a,s,h,m,I=I.split(".")[1];return!!this._cmdFreqLimitMap.has(I)&&(!this._cmdReqInfoMap.has(I)||(a=(s=this._cmdFreqLimitMap.get(I)).count,s=s.interval,h=(m=this._cmdReqInfoMap.get(I)).startTime,m=m.requestCount,Date.now()-h>1e3*s)?(this._cmdReqInfoMap.set(I,{startTime:Date.now(),requestCount:1}),!1):(this._cmdReqInfoMap.set(I,{startTime:h,requestCount:m+=1}),a<m))}},{key:"_isServerOverload",value:function(n){var a,s;return!!this._serverOverloadInfoMap.has(n)&&(a=(s=this._serverOverloadInfoMap.get(n)).overloadTime,s=s.waitingTime,Date.now()-a<=1e3*s||(this._serverOverloadInfoMap.delete(n),!1))}},{key:"_getCmd",value:function(n){var a="";if(n.includes(".")){var s,h=n.split(".")[1];for(s in de)if(de[s]===h){a=s;break}}return a}},{key:"onPushedServerOverload",value:function(s){var a=s.overloadCommand,s=s.waitingTime;this._serverOverloadInfoMap.set(a,{overloadTime:Date.now(),waitingTime:s}),K.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(s,"s cmd:").concat(this._getCmd(a)))}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._updateCmdFreqLimitMap(GI),this._cmdReqInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]),Z1=(S(Fh,$o),p(Fh,[{key:"getCloudConfig",value:function(n){return et(n)?this._cloudConfig:this._cloudConfig.has(n)?this._cloudConfig.get(n):void 0}},{key:"getServerConfig",value:function(n){var a={code:0,data:""};return!et(n)&&this._cloudConfig.has(n)&&(a.data=this._cloudConfig.get(n)),Promise.resolve(a)}},{key:"_canFetch",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var n,a=this,s="".concat(this._n,".fetchConfig"),h=this._canFetch();K.l("".concat(s," canFetch:").concat(h)),h&&(n=new ct("fetchCloudCtrlConfig"),h=this.get(12).getSDKAppID(),this._isFetching=!0,this.req({P:de.FETCH_CLOUD_CTRL_CONFIG,data:{SDKAppID:h,version:this._version}}).then(function(m){a._isFetching=!1;var T=m.data,I=T.version,T=T.cloudControlConfig;n.setMessage("version:".concat(a._version," newVersion:").concat(I," config:").concat(T)).end(),K.l("".concat(s," ok")),a._parse(m.data)}).catch(function(m){a._isFetching=!1,n.setError(m).end(),K.l("".concat(s," failed. error:"),m),a._setExpiredTime(12e4)}))}},{key:"onPushedConfig",value:function(n){K.l("".concat(this._n,".onPushedConfig config:"),n),new ct("pushedCloudCtrlConfig").setMessage("newVersion:".concat(n.version," config:").concat(n.cloudControlConfig)).end(),this._parse(n)}},{key:"onCheckTimer",value:function(n){this._canFetch()&&this.fetchConfig()}},{key:"_parse",value:function(n){var a=this,s="".concat(this._n,"._parse"),h=n.errorCode,m=n.errorMessage,I=n.cloudControlConfig,T=n.version,D=n.expiredTime;if(h===0){if(this._version!==T){var V=null;try{V=JSON.parse(I)}catch{this.isPrivateNetWork()||K.e("".concat(s," failed. config:"),I)}V&&(this._cloudConfig.clear(),Object.keys(V).forEach(function($){a._cloudConfig.set($,V[$])}),this._version=T,this.emitIEvt(So.CLOUD_CONFIG))}this._setExpiredTime(1e3*D)}else et(h)?(K.l("".concat(s," failed. Invalid message format:"),n),this._setExpiredTime(36e5)):(K.e("".concat(s," errorCode:").concat(h," errorMessage:").concat(m)),this._setExpiredTime(12e4))}},{key:"_setExpiredTime",value:function(n){this._expiredTime=Date.now()+n}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}])),Q1=(S(Pu,$o),p(Pu,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var n,a,s,h,m=this,I=this._getLocalConvList().filter(function(V){return V.type===O.CONV_GROUP&&V.groupProfile.type!==O.GRP_AVCHATROOM}),T=this.get(11),D=[];I.forEach(function(q){var $=q.conversationID,q=q.lastMessage;n=$.replace(O.CONV_GROUP,""),a=T.getLocalLastMessage($),q&&q.lastSequence!==0&&a&&(s=q.lastSequence,a=a.sequence,h=s-a,0<a)&&1<=h&&h<300?m._recoverGroupMsg({groupID:n,localLastMessageSequence:a,remoteLastMessageSequence:s}):D.push(n)}),this._getGroupNotice(D)}},{key:"_recoverC2CChat",value:function(){var n,a,s,h=this,m=this._getLocalConvList().filter(function(V){return V.type===O.CONV_C2C}),I=this.get(11),T=[Promise.resolve()],D=[];m.forEach(function(q){var $=q.conversationID,q=q.lastMessage;n=I.getLocalLastMessage($),q&&q.lastTime!==0&&n&&(a=q.lastTime,n=n.time,s=a-n,0<n)&&1<=s&&s<=600&&(T.push(h._recoverC2CMsg({conversationID:$,localLastMessageTime:n,remoteLastMessageTime:a})),D.push($))}),Promise.all(T).then(function(){K.l("".concat(h._n,"._recoverC2CChat all done, convIDList:"),D),h.get(19).syncOnReconnected()})}},{key:"_getLocalConvList",value:function(){return this.get(11).getLocalConvList()}},{key:"_recoverGroupMsg",value:function(n){var a=this,s="".concat(this._n,".").concat("_recoverGroupMsg"),h=(K.l("".concat(s," options:"),n),n.groupID),m=n.localLastMessageSequence,I=n.remoteLastMessageSequence,T=JSON.stringify(n),D=new ct("_recoverGroupMsg");D.setMessage(T),this._getGroupRoamingMsg({groupID:h,sequence:m}).then(function($){var $=$.data,q=$.complete,se=$.messageList;if(!et(se)){var $=se[0].sequence,me=se.map(function(Pn){return Pn.sequence}),me="".concat(T," complete:").concat(q," sequenceList:").concat(me),fe=(K.l("".concat(s," ").concat(me)),$!==m&&$<I&&q!==2&&a._recoverGroupMsg({groupID:h,localLastMessageSequence:$,remoteLastMessageSequence:I}),D.setMessage(me).end(),a.get(7));1<se.length&&se.sort(function(Pn,Gn){return Pn.sequence-Gn.sequence});for(var He=!1,Xe=0,Ye=se.length;Xe<Ye;Xe++)if(se[Xe].from===O.CONV_SYSTEM){He=!0;break}if(He)for(var Lt=0,yt=se.length;Lt<yt;Lt++){var rn=se[Lt];rn.from!==O.CONV_SYSTEM?fe.onNewMessage({dataList:[rn],isInstantMessage:!1,updateUnreadCount:!1}):fe.onNewGroupTips({event:rn.event,dataList:[rn]})}else fe.onNewMessage({dataList:se,isInstantMessage:!1,updateUnreadCount:!1})}}).catch(function(V){D.setError(V).end(),K.w("".concat(s," failed. error:"),V)})}},{key:"_getGroupNotice",value:function(n){var a=n.length;if(K.l("".concat(this._n,"._getGroupNotice length:").concat(a)),a!==0){var s=this.get(7);if(a<=10)s.getNotice(n);else{var h=Math.floor(a/10);5<=h&&(h=5);for(var m=0;m<=h;m++)s.getNotice(n.slice(10*m,10*(m+1)))}}}},{key:"_getGroupRoamingMsg",value:function(s){var a=s.groupID,s=s.sequence;return this.req({P:de.GET_GRP_ROAMING_MSG,data:{groupID:a,count:this.PULL_LIMIT_COUNT,sequence:s+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMsg",value:function(n){var a=this,s="".concat(this._n,".").concat("_recoverC2CMsg"),h=(K.l("".concat(s," options:"),n),n.conversationID),m=n.localLastMessageTime,I=n.remoteLastMessageTime,T=JSON.stringify(n),D=new ct("_recoverC2CMsg");return D.setMessage(T),this._getC2CRoamingMsg({conversationID:h,time:m}).then(function(q){var q=q.data,$=q.complete,q=q.messageList;if(!et(q)){var se=q.length,se=(a.get(6).onNewMessage({dataList:q,isInstantMessage:!0}),q[se-1].time),q=q.map(function(fe){return fe.random}),q="".concat(T," complete:").concat($," randomList:").concat(q);if(K.l("".concat(s," ").concat(q)),D.setMessage(q).end(),se<I&&$!==1)return a._recoverC2CMsg({conversationID:h,localLastMessageTime:se,remoteLastMessageTime:I})}}).catch(function(V){D.setError(V).end(),K.w("".concat(s," failed. error:"),V)})}},{key:"_getC2CRoamingMsg",value:function(s){var a=s.conversationID,s=s.time;return this.req({P:de.GET_C2C_ROAMING_MSG,data:{peerAccount:a.replace(O.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:s,direction:1}})}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}])),HI=p(function n(){u(this,n),this._n="AvgE2EDelay",this._e2eDelayArray=[]},[{key:"addMessageDelay",value:function(n){n=ot()-n,0<=n&&this._e2eDelayArray.push(n)}},{key:"_calcAvg",value:function(n,a){var s;return a===0?0:(s=0,n.forEach(function(h){s+=h}),Xi(s/a,1))}},{key:"_calcCountWithLimit",value:function(n){var a=n.e2eDelayArray,s=n.min,h=n.max;return a.filter(function(m){return s<=m&&m<h}).length}},{key:"_calcPercent",value:function(n,a){return n=Xi(n/a*100,2),n=100<n?100:n}},{key:"_checkE2EDelayException",value:function(n,a){var s,h,m,I=n.filter(function(T){return a<T});0<I.length&&(s=I.length,h=Math.min.apply(Math,P(I)),m=Math.max.apply(Math,P(I)),I=this._calcAvg(I,s),50<(n=Xi(s/n.length*100,2)))&&new ct("messageE2EDelayException").setMessage("count:".concat(s," min:").concat(h," max:").concat(m," avg:").concat(I," percent:").concat(n)).setLevel("warning").end()}},{key:"getStatResult",value:function(){var n,a,s,h,m,I,T=this._e2eDelayArray.length;return T===0?null:(n=P(this._e2eDelayArray),a=this._calcCountWithLimit({e2eDelayArray:n,min:0,max:1}),s=this._calcCountWithLimit({e2eDelayArray:n,min:1,max:3}),h=this._calcPercent(a,T),m=this._calcPercent(s,T),I=this._calcAvg(n,T),this._checkE2EDelayException(n,3),n.length=0,this.reset(),{totalCount:T,countLessThan1Second:a,percentOfCountLessThan1Second:h,countLessThan3Second:s,percentOfCountLessThan3Second:m,avgDelay:I})}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),$I=p(function n(){u(this,n),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]},[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(n){this._rttArray.push(n)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(n){return n.length}},{key:"_calcSuccessRateOfRequest",value:function(n,a){return a===0?0:100<(n=Xi(n/a*100,2))?100:n}},{key:"_calcAvg",value:function(n,a){var s;return a===0?0:(s=0,n.forEach(function(h){s+=h}),parseInt(s/a))}},{key:"_calcMax",value:function(){return Math.max.apply(Math,P(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,P(this._rttArray))}},{key:"getStatResult",value:function(){var n,a,s=this._calcTotalCount(),h=P(this._rttArray);return s===0?null:(n=this._calcRTTCount(h),a=this._calcSuccessRateOfRequest(n,s),h=this._calcAvg(h,n),K.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(h)),this.reset(),{totalCount:s,rttCount:n,successRateOfRequest:a,avgRTT:h})}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),eM=p(function n(){u(this,n),this._map=new Map},[{key:"initMap",value:function(n){var a=this;n.forEach(function(s){a._map.set(s,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})})}},{key:"addTotalCount",value:function(n){return!(et(n)||!this._map.has(n)||(this._map.get(n).totalCount+=1,0))}},{key:"addSuccessCount",value:function(n){return!(et(n)||!this._map.has(n)||(this._map.get(n).successCount+=1,0))}},{key:"addFailedCountOfUserSide",value:function(n){return!(et(n)||!this._map.has(n)||(this._map.get(n).failedCountOfUserSide+=1,0))}},{key:"addCost",value:function(n,a){return!(et(n)||!this._map.has(n)||(this._map.get(n).costArray.push(a),0))}},{key:"addFileSize",value:function(n,a){return!(et(n)||!this._map.has(n)||(this._map.get(n).fileSizeArray.push(a),0))}},{key:"_calcSuccessRateOfBusiness",value:function(n){return et(n)||!this._map.has(n)?-1:100<(n=Xi((n=this._map.get(n)).successCount/n.totalCount*100,2))?100:n}},{key:"_calcSuccessRateOfPlatform",value:function(n){var a;return et(n)||!this._map.has(n)?-1:(a=this._map.get(n),100<(n=Xi(n=this._calcSuccessCountOfPlatform(n)/a.totalCount*100,2))?100:n)}},{key:"_calcTotalCount",value:function(n){return et(n)||!this._map.has(n)?-1:this._map.get(n).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(n){return et(n)||!this._map.has(n)?-1:this._map.get(n).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(n){return et(n)||!this._map.has(n)?-1:(n=this._map.get(n)).successCount+n.failedCountOfUserSide}},{key:"_calcAvg",value:function(n){return et(n)||!this._map.has(n)?-1:n===Si?this._calcAvgSpeed(n):this._calcAvgCost(n)}},{key:"_calcAvgCost",value:function(n){var a,s=this._map.get(n).costArray.length;return s===0?0:(a=0,this._map.get(n).costArray.forEach(function(h){a+=h}),parseInt(a/s))}},{key:"_calcAvgSpeed",value:function(n){var a=0,s=0;return this._map.get(n).costArray.forEach(function(h){a+=h}),this._map.get(n).fileSizeArray.forEach(function(h){s+=h}),parseInt(1e3*s/a)}},{key:"getStatResult",value:function(n){var a,s,h,m,I,T=this._calcTotalCount(n);return T===0?null:(a=this._calcSuccessCountOfBusiness(n),s=this._calcSuccessRateOfBusiness(n),h=this._calcSuccessCountOfPlatform(n),m=this._calcSuccessRateOfPlatform(n),I=this._calcAvg(n),this.reset(n),{totalCount:T,successCountOfBusiness:a,successRateOfBusiness:s,successCountOfPlatform:h,successRateOfPlatform:m,avgValue:I})}},{key:"reset",value:function(n){et(n)?this._map.clear():this._map.set(n,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),tM=p(function n(){u(this,n),this._lastMap=new Map,this._currentMap=new Map},[{key:"initMap",value:function(n){var a=this;n.forEach(function(s){a._lastMap.set(s,new Map),a._currentMap.set(s,new Map)})}},{key:"addMessageSequence",value:function(n){var a,s,h,m=n.key,I=n.message;return!(et(m)||!this._lastMap.has(m)||!this._currentMap.has(m)||(a=I.conversationID,I=I.sequence,a=a.replace(O.CONV_GROUP,""),this._lastMap.get(m).size!==0&&this._lastMap.get(m).has(a)&&(h=(s=this._lastMap.get(m).get(a)).length-1,I>s[0])&&I<s[h]?(s.push(I),s.sort(),this._lastMap.get(m).set(a,s)):this._addCurrentMap(n),0))}},{key:"_addCurrentMap",value:function(s){var a=s.key,s=s.message,h=s.conversationID,s=s.sequence,h=h.replace(O.CONV_GROUP,"");this._currentMap.get(a).has(h)||this._currentMap.get(a).set(h,[]),this._currentMap.get(a).get(h).push(s)}},{key:"_copyData",value:function(n){if(!et(n)){this._lastMap.set(n,new Map);var a,s=this._lastMap.get(n),h=v(this._currentMap.get(n));try{for(h.s();!(a=h.n()).done;){var m=x(a.value,2),I=m[0],T=m[1];s.set(I,T)}}catch(D){h.e(D)}finally{h.f()}s=null,this._currentMap.set(n,new Map)}}},{key:"getStatResult",value:function(n){var a,s,h;return et(this._currentMap.get(n))||et(this._lastMap.get(n))?null:this._lastMap.get(n).size===0?(this._copyData(n),null):(s=a=0,this._lastMap.get(n).forEach(function(D,I){var D=P(D.values()),T=D.length,D=D[T-1]-D[0]+1;a+=D,s+=T}),a===0?null:(100<(h=Xi(s/a*100,2))&&(h=100),this._copyData(n),{totalCount:a,successCountOfMessageReceived:s,successRateOfMessageReceived:h}))}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),Jv=(S(Uh,$o),p(Uh,[{key:"_onLoginSuccess",value:function(){var n=this,a=(this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems),this.get(13)),s=a.getItem(this.TAG,!1);!Tt(s)&&No(s.forEach)&&(K.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(s.length)),s.forEach(function(h){n._statInfoArr.push(h)}),a.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("q_rpt_interval"),a=this.getCloudConfig("q_rpt_sdkappid_bl"),s=this.getCloudConfig("q_rpt_tinyid_wl");et(n)||(this.REPORT_INTERVAL=Number(n)),et(a)||(this.REPORT_SDKAPPID_BLACKLIST=a.split(",").map(function(h){return Number(h)})),et(s)||(this.REPORT_TINYID_WHITELIST=s.split(","))}},{key:"onCheckTimer",value:function(n){this.isLoggedIn()&&n%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(n){this._avgRTT.addRTT(n)}},{key:"addMessageDelay",value:function(n){this._avgE2EDelay.addMessageDelay(n)}},{key:"addTotalCount",value:function(n){this._rateMessageSent.addTotalCount(n)||K.w("".concat(this._n,".addTotalCount invalid key:"),n)}},{key:"addSuccessCount",value:function(n){this._rateMessageSent.addSuccessCount(n)||K.w("".concat(this._n,".addSuccessCount invalid key:"),n)}},{key:"addFailedCountOfUserSide",value:function(n){this._rateMessageSent.addFailedCountOfUserSide(n)||K.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),n)}},{key:"addCost",value:function(n,a){this._rateMessageSent.addCost(n,a)||K.w("".concat(this._n,".addCost invalid key or cost:"),n,a)}},{key:"addFileSize",value:function(n,a){this._rateMessageSent.addFileSize(n,a)||K.w("".concat(this._n,".addFileSize invalid key or size:"),n,a)}},{key:"addMessageSequence",value:function(n){this._rateMessageReceived.addMessageSequence(n)||K.w("".concat(this._n,".addMessageSequence invalid key:"),n.key)}},{key:"_getQualityItem",value:function(n){var a={},s=ls[this.get(15).getNetworkType()],s=(et(s)&&(s=8),{qualityType:o1[n],timestamp:Dn(),networkType:s,extension:""});switch(n){case yh:a=this._avgRTT.getStatResult();break;case Eu:a=this._avgE2EDelay.getStatResult();break;case as:case Gs:case uc:case Fa:case Si:a=this._rateMessageSent.getStatResult(n);break;case dc:case Ih:case ss:a=this._rateMessageReceived.getStatResult(n)}return a===null?null:E(E({},s),a)}},{key:"_report",value:function(I){var a=this,s=[],h=null,I=(et(I)?this._qualityItems.forEach(function(T){(h=a._getQualityItem(T))!==null&&(h.reportIndex=a.reportIndex,h.wholePeriod=a.wholePeriod,s.push(h))}):(h=this._getQualityItem(I))!==null&&(h.reportIndex=this.reportIndex,h.wholePeriod=this.wholePeriod,s.push(h)),K.d("".concat(this._n,"._report"),s),0<this._statInfoArr.length&&(s=s.concat(this._statInfoArr),this._statInfoArr=[]),this.get(12)),m=I.getSDKAppID(),I=I.getTinyID();0<(s=yp(this.REPORT_SDKAPPID_BLACKLIST,m)&&!SI(this.REPORT_TINYID_WHITELIST,I)?[]:s).length&&this._doReport(s)}},{key:"_doReport",value:function(n){var a=this,s={header:Vv(this),quality:n};this.req({P:de.SSO_STAT,data:E({},s)}).then(function(){a.reportIndex++,a.wholePeriod=!1}).catch(function(h){K.w("".concat(a._n,"._doReport failed. error:"),h),a._statInfoArr=a._statInfoArr.concat(n),a._flushAtOnce()})}},{key:"_flushAtOnce",value:function(){var n=this.get(13),a=n.getItem(this.TAG,!1),s=this._statInfoArr,h="".concat(this._n,"._flushAtOnce");Tt(a)?(K.l("".concat(h," count:").concat(s.length)),n.setItem(this.TAG,s,!0,!1)):(10<(s=s.concat(a)).length&&(s=s.slice(0,10)),K.l("".concat(h," count:").concat(s.length)),n.setItem(this.TAG,s,!0,!1)),this._statInfoArr=[]}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}])),qI=p(function n(a){u(this,n),Tt(a)||(this.userID=a.userID||"",this.nick=a.nick||"",this.avatar=a.avatar||"",this.time=a.time||0,this.source=a.source||"",this.wording=a.wording||"",this.type=a.type||"")}),nM=p(function n(a){u(this,n),this._snsM=a,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSeq=0,this._map=new Map,this._unreadCount=0},[{key:"getLocalApplicationList",value:function(){return{friendApplicationList:P(this._map.values()),unreadCount:this._unreadCount}}},{key:"_onApplicationListUpdated",value:function(){this._snsM.emitOEvt(W.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:P(this._map.values()),unreadCount:this._unreadCount})}},{key:"onApplicationRead",value:function(){this._unreadCount=0,this._onApplicationListUpdated()}},{key:"onApplicationAdded",value:function(n,a){var s,h,m=this;Tt(n)||(s="",s=a===this._snsM.getMyUserID()?O.SNS_APPLICATION_SENT_BY_ME:O.SNS_APPLICATION_SENT_TO_ME,h=!1,n.forEach(function(I){var T="".concat(I.userID,"_").concat(s);s!==O.SNS_APPLICATION_SENT_TO_ME||m._map.has(T)||(m._unreadCount+=1),m._map.set(T,new qI(E(E({},I),{},{type:s}))),h=!0}),h&&this._onApplicationListUpdated())}},{key:"onApplicationDeleted",value:function(n){Tt(n)||(this._startTime=0,this._currentSeq=0,this.getApplicationList())}},{key:"getApplicationList",value:function(){var n=this,a="".concat(this._n,".").concat("getApplicationList"),s=new ct("getApplicationList");return this._snsM.req({P:de.GET_FD_APPLICATION_LIST,data:{applicationType:O.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsM.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSeq}}).then(function(D){var D=D.data,m=D.resultList,I=D.unreadCount,T=D.startTime,D=D.currentSequence,V=(n._startTime=T,n._currentSeq=D,n._unreadCount=I,wt(m)?m.length:0),V="applicationCount:".concat(V," unreadCount:").concat(I," startTime:").concat(T," currentSequence:").concat(D);s.setMessage(V).end(),K.i("".concat(a," ok. ").concat(V)),n._map.clear(),wt(m)&&m.forEach(function(me){var q=me.userID,se=me.type,me=new qI(me);n._map.set("".concat(q,"_").concat(se),me)}),n._onApplicationListUpdated()}).catch(function(h){return s.setError(h).end(),K.w("".concat(a," failed. error:"),h),De(h)})}},{key:"deleteApplication",value:function(n){var a,s="".concat(this._n,".").concat("deleteApplication"),h=n.userID,m=n.type;return m&&(m===O.SNS_APPLICATION_SENT_BY_ME||m===O.SNS_APPLICATION_SENT_TO_ME)||(m=O.SNS_APPLICATION_SENT_TO_ME),this._map.has("".concat(h,"_").concat(m))?((a=new ct("deleteApplication")).setMessage("userID:".concat(h," type:").concat(m)),this._snsM.req({P:de.DEL_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),userIDList:[h],type:m}}).then(function(T){var T=T.data.resultList,$=T[0],D=$.to,V=$.resultCode,$=$.resultInfo;return a.setMoreMessage("resultList:".concat(JSON.stringify(T))).end(),K.i("".concat(s," ok. userID:").concat(h," type:").concat(m)),V===0?Kt():De({userID:D,code:V,message:$})}).catch(function(I){return a.setError(I).end(),K.w("".concat(s," failed. error:"),I),De(I)})):De({code:Je.FRIEND_APPLICATION_NOT_EXIST})}},{key:"acceptApplication",value:function(n){var a="".concat(this._n,".").concat("acceptApplication"),s=n.userID,h=n.remark,m=n.tag,I=n.type,T=(I&&(I===O.SNS_APPLICATION_AGREE||I===O.SNS_APPLICATION_AGREE_AND_ADD)||(I=O.SNS_APPLICATION_AGREE_AND_ADD),new ct("acceptApplication"));return T.setMessage("userID:".concat(s," type:").concat(I)),this._snsM.req({P:de.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:s,remark:h,tag:m,action:I}]}}).then(function($){T.end();var $=$.data.resultList[0],V=$.resultCode,$=$.resultInfo;if(V!==0)return De({code:V,message:$});K.i("".concat(a," ok. userID:").concat(s," type:").concat(I))}).catch(function(D){return T.setError(D).end(),K.w("".concat(a," failed. error:"),D),De(D)})}},{key:"refuseApplication",value:function(n){var a="".concat(this._n,".").concat("refuseApplication"),s=n.userID,h=new ct("refuseApplication");return h.setMessage("userID:".concat(s)),this._snsM.req({P:de.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:s,action:"Response_Action_Reject"}]}}).then(function(T){h.end();var T=T.data.resultList[0],I=T.resultCode,T=T.resultInfo;if(I!==0)return De({code:I,message:T});K.i("".concat(a," ok. userID:").concat(s))}).catch(function(m){return h.setError(m).end(),K.w("".concat(a," failed. error:"),m),De(m)})}},{key:"setApplicationRead",value:function(){var n=this,a="".concat(this._n,".").concat("setApplicationRead"),s=new ct("setApplicationRead");return this._snsM.req({P:de.REPORT_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),latestTimeStamp:Xi(Dn()/1e3,0)}}).then(function(h){s.end(),K.i("".concat(a," ok")),n._unreadCount=0}).catch(function(h){return s.setError(h).end(),K.w("".concat(a," failed. error:"),h),De(h)})}},{key:"reset",value:function(){this._maxLimited=100,this._currentSeq=0,this._unreadCount=0,this._map.clear()}}]),Xv=p(function n(a,s){u(this,n),this.userID=a,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var h={},m=[];if(h.userID=a,!Tt(s))for(var I,T="",D=0,V=s.length;D<V;D++)if(T=s[D].tag,I=s[D].value,-1<T.indexOf("Tag_SNS_Custom"))this.friendCustomField.push({key:T,value:I});else if(-1<T.indexOf("Tag_Profile_Custom"))m.push({key:T,value:I});else switch(T){case Gt.NICK:h.nick=I;break;case Gt.GENDER:h.gender=I;break;case Gt.BIRTHDAY:h.birthday=I;break;case Gt.LOCATION:h.location=I;break;case Gt.SELFSIGNATURE:h.selfSignature=I;break;case Gt.ALLOWTYPE:h.allowType=I;break;case Gt.LANGUAGE:h.language=I;break;case Gt.AVATAR:h.avatar=I;break;case Gt.MESSAGESETTINGS:h.messageSettings=I;break;case Gt.ADMINFORBIDTYPE:h.adminForbidType=I;break;case Gt.LEVEL:h.level=I;break;case Gt.ROLE:h.role=I;break;case Ho.REMARK:this.remark=I;break;case Ho.ADDTIME:this.addTime=I;break;case Ho.GROUP:this.groupList=JSON.parse(JSON.stringify(I));break;case Ho.ADDSOURCE:this.source=I;break;case Ho.ADDWORDING:break;default:K.l("snsProfileItem unknown tag->",s[D].tag)}this.profile=new Th(E(E({},h),{},{profileCustomField:m}))},[{key:"validate",value:function(n){var a,s=!0,h="";if(Tt(n))return{valid:!1,tips:"empty options"};if(n.profileCustomField)for(var m=n.profileCustomField.length,I=null,T=0;T<m;T++){if(I=n.profileCustomField[T],!_n(I.key)||I.key.indexOf("Tag_Profile_Custom")===-1)return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!_n(I.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(a in n)if(Object.prototype.hasOwnProperty.call(n,a)){if(a==="profileCustomField")continue;if(Tt(n[a])&&!_n(n[a])&&!It(n[a])){h="key:"+a+", invalid value:"+n[a],s=!1;continue}switch(a){case"nick":_n(n[a])||(s=!(h="nick must be a string")),500<Qt(n[a])&&(h="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(Qt(n[a])," bytes"),s=!1);break;case"gender":fr(jo,n.gender)||(h="key:gender, invalid value:"+n.gender,s=!1);break;case"birthday":It(n.birthday)||(s=!(h="birthday must be a number"));break;case"location":_n(n.location)||(s=!(h="location must be a string"));break;case"selfSignature":_n(n.selfSignature)||(s=!(h="selfSignature must be a string"));break;case"allowType":fr(Vr,n.allowType)||(h="key:allowType, invalid value:"+n.allowType,s=!1);break;case"language":It(n.language)||(s=!(h="language must be a number"));break;case"avatar":_n(n.avatar)||(s=!(h="avatar must be a string"));break;case"messageSettings":n.messageSettings!==0&&n.messageSettings!==1&&(s=!(h="messageSettings must be 0 or 1"));break;case"adminForbidType":fr(xi,n.adminForbidType)||(h="key:adminForbidType, invalid value:"+n.adminForbidType,s=!1);break;case"level":It(n.level)||(s=!(h="level must be a number"));break;case"role":It(n.role)||(s=!(h="role must be a number"));break;default:h="unknown key:"+a+"  "+n[a],s=!1}}return{valid:s,tips:h}}},{key:"update",value:function(n){var a=this,s="",h="",m=[];this.friendCustomField.forEach(function(D){m.push(D.key)});for(var I=0,T=n.length;I<T;I++)(function(){if(s=n[I].tag,h=n[I].value,-1<s.indexOf("Tag_SNS_Custom"))-1<m.indexOf(s)?a.friendCustomField.forEach(function(V){V.key===s&&(V.value=h)}):a.friendCustomField.push({key:s,value:h});else if(-1<s.indexOf("Tag_Profile_Custom")){var D=!1;a.profile.profileCustomField.forEach(function(V){V.key===s&&(V.value=h,D=!0)}),D||a.profile.profileCustomField.push({key:s,value:h})}else switch(s){case Gt.NICK:a.profile.nick=h;break;case Gt.GENDER:a.profile.gender=h;break;case Gt.BIRTHDAY:a.profile.birthday=h;break;case Gt.LOCATION:a.profile.location=h;break;case Gt.SELFSIGNATURE:a.profile.selfSignature=h;break;case Gt.ALLOWTYPE:a.profile.allowType=h;break;case Gt.LANGUAGE:a.profile.language=h;break;case Gt.AVATAR:a.profile.avatar=h;break;case Gt.MESSAGESETTINGS:a.profile.messageSettings=h;break;case Gt.ADMINFORBIDTYPE:a.profile.adminForbidType=h;break;case Gt.LEVEL:a.profile.level=h;break;case Gt.ROLE:a.profile.role=h;break;case Ho.REMARK:a.remark=h;break;case Ho.ADDTIME:a.addTime=h;break;case Ho.GROUP:a.groupList=JSON.parse(JSON.stringify(h));break;case Ho.ADDSOURCE:a.source=h;break;case Ho.ADDWORDING:break;default:K.d("snsProfileItem unkown tag->",n[I].tag)}})();this.timestamp=Date.now(),m.length=0}},{key:"updateProfile",value:function(n){this.profile=JSON.parse(JSON.stringify(n)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(n){this.groupList.indexOf(n)===-1&&(this.groupList.push(n),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(n){n=this.groupList.indexOf(n),-1<n&&(this.groupList.splice(n,1),this.count=this.groupList.length)}}]),KI=p(function n(a){u(this,n),this._snsM=a,this._n="FriendHandler",this._map=new Map,this._startIdx=0,this._standardSeq=0,this._customSeq=0,this._expirationTime=18e4},[{key:"getLocalFriendList",value:function(){return P(this._map.values())}},{key:"getFriendRemark",value:function(n){return this._map.has(n)?this._map.get(n).remark:""}},{key:"onFriendProfileModified",value:function(h){var a,s=this,h=h.dataList;Tt(h)||(a=this._snsM.get(11),h.forEach(function(D){var I,T=D.userID,D=D.profileList;s.isMyFriend(T)&&(K.l("".concat(s._n,".onFriendProfileModified. friend account:").concat(T,", profileList:").concat(JSON.stringify(D))),(I=s._map.get(T)).update(D),a.modifyMessageSentByPeer({conversationID:"".concat(O.CONV_C2C).concat(T),latestNick:I.profile.nick,latestAvatar:I.profile.avatar}))}),this._onFriendListUpdated())}},{key:"onFriendAdded",value:function(n){var a=this;n.length!==0&&(K.l("".concat(this._n,".onFriendAdded userIDList:").concat(n)),n.forEach(function(s){a._map.set(s,new Xv(s))}),this.getFriendProfile({userIDList:n}).then(function(s){n.forEach(function(h){var m=a._map.get(h);0<m.groupList.length&&a._snsM.updateWhenFriendAdded({nameList:m.groupList,userID:h})}),a._onFriendListUpdated()}))}},{key:"onFriendDeleted",value:function(n){var a=this;n.length!==0&&(K.l("".concat(this._n,".onFriendDeleted userIDList:").concat(n)),n.forEach(function(s){var h=a._map.get(s);0<h.groupList.length&&a._snsM.updateWhenFriendDeleted({nameList:h.groupList,userID:s}),a._map.delete(s)}),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsM.emitOEvt(W.FRIEND_LIST_UPDATED),this._snsM.get(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(m){var a,s=this,h="".concat(this._n,".").concat("getFriendProfile"),m=m.userIDList,I=[],T=[],D=[];return m.forEach(function(V){var $;s._map.has(V)?($=s._map.get(V),Date.now()-$.timestamp<s._expirationTime?T.push($):D.push(V)):I.push({userID:V,code:Je.NOT_MY_FRIEND,message:s._snsM.getErrMsg(Je.NOT_MY_FRIEND)})}),D.length===0?(K.i("".concat(h," newUserIDList is empty")),ln({friendList:T,failureUserIDList:I})):((a=new ct("getFriendProfile")).setMessage("userIDList:".concat(D)),K.i("".concat(h," userIDList:").concat(D)),this._snsM.req({P:de.GET_FD_PROFILE,data:{fromAccount:this._snsM.getMyUserID(),userIDList:D}}).then(function(V){return a.end(),K.i("".concat(h," ok")),V.data.resultList.forEach(function(He){var q,se=He.to,me=He.resultCode,fe=He.resultInfo,He=He.tagValueList;et(me)||me===0?(s._map.has(se)?(q=s._map.get(se)).update(He):(q=new Xv(se,He),s._map.set(se,q)),T.push(q)):I.push({userID:se,code:me,message:fe})}),Kt({friendList:T,failureUserIDList:I})}).catch(function(V){return a.setError(V).end(),K.w("".concat(h," failed. error:"),V),De(V)}))}},{key:"isMyFriend",value:function(n){return this._map.has(n)}},{key:"pagingGetFriendList",value:function(){var n=this,a="".concat(this._n,".").concat("getFriendList"),s=new ct("getFriendList"),h=Date.now();this._snsM.req({P:de.GET_FD_LIST,data:{fromAccount:this._snsM.getMyUserID(),startIndex:this._startIdx,standardSequence:this._standardSeq,customSequence:this._customSeq}}).then(function($){var $=$.data,q=$.friendCount,I=$.resultList,T=$.nextStartIndex,D=$.standardSequence,V=$.customSequence,$=$.completeFlag,q=(n._startIdx=T,n._standardSeq=D,n._customSeq=V,"friendCount:".concat(q," nextStartIndex:").concat(T," standardSequence:").concat(D," ")+"customSequence:".concat(V," completeFlag:").concat($," cost:").concat(br(h)));s.setMessage(q).end(),K.i("".concat(a," ok."),q),Tt(I)||I.forEach(function(fe){var me=fe.to,fe=fe.tagValueList;n._map.set(me,new Xv(me,fe))}),$===0?n.pagingGetFriendList():(n._snsM.emitOEvt(W.FRIEND_LIST_UPDATED),n._pagingGetFriendProfile())}).catch(function(m){return s.setError(m).end(),K.w("".concat(a," failed. error:"),m),De(m)})}},{key:"_pagingGetFriendProfile",value:function(){var n=this,a=P(this._map.keys()),s=this._snsM.get(4),h=a.length,m=h<=100?1:Math.ceil(h/100);K.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(h," pageCount:").concat(m));for(var I=0;I<m;I++)s.getUserProfile({userIDList:a.slice(100*I,100*(I+1))}).then(function(T){T.data.forEach(function(D){var V=n._map.get(D.userID);V&&V.updateProfile(D)}),n._onFriendListUpdated()})}},{key:"addFriend",value:function(n){var a,s,h,m,I,T,D,V=this,$="".concat(this._n,".").concat("addFriend");return n.wording&&this._snsM.filterProfanity("wording",n)===!1?De({code:Je.PROFANITY_FOUND}):(a=n.to,s=n.source,h=n.type,m=n.wording,I=n.remark,n=n.groupName,(T=h)&&(T===O.SNS_ADD_TYPE_SINGLE||T===O.SNS_ADD_TYPE_BOTH)||(T=O.SNS_ADD_TYPE_BOTH),(D=new ct("addFriend")).setMessage("to:".concat(a," source:").concat(s," type:").concat(T)),this._snsM.req({P:de.ADD_FD,data:{fromAccount:this._snsM.getMyUserID(),addFriendItem:[{to:a,source:s,wording:m,remark:I,groupName:n}],type:T}}).then(function(fe){var fe=fe.data.resultList,fe=(D.setMoreMessage("resultList:".concat(JSON.stringify(fe))).end(),fe[0]),se=fe.to,me=fe.resultCode,fe=fe.resultInfo;return K.i("".concat($," ok. to:").concat(se," type:").concat(T," code:").concat(me)),et(me)||me===0?Kt({userID:se,code:0}):me===30539?Kt({userID:se,code:me,message:V._snsM.getErrMsg(me)}):De({userID:se,code:me,message:V._snsM.getErrMsg(me)||fe})}).catch(function(q){return D.setError(q).end(),K.w("".concat($," failed. error:"),q),De(q)}))}},{key:"deleteFriend",value:function(I){var a,s=this,h="".concat(this._n,".").concat("deleteFriend"),m=I.userIDList,I=I.type,T=(1e3<m.length&&(K.w("".concat(h," ").concat(lc(1e3))),m.length=1e3),[]),D=[],V=[];return m.forEach(function($){s._map.has($)?V.push($):T.push({userID:$,code:Je.NOT_MY_FRIEND,message:s._snsM.getErrMsg(Je.NOT_MY_FRIEND)})}),V.length===0?ln({successUserIDList:D,failureUserIDList:T}):((m=I)&&(m===O.SNS_DELETE_TYPE_SINGLE||m===O.SNS_DELETE_TYPE_BOTH)||(m=O.SNS_DELETE_TYPE_BOTH),(a=new ct("deleteFriend")).setMessage("userIDList:".concat(V," type:").concat(m)),this._snsM.req({P:de.DEL_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:V,type:m}}).then(function($){return a.end(),K.i("".concat(h," ok")),$=$.data.resultList,Tt($)||$.forEach(function(fe){var se=fe.to,me=fe.resultCode,fe=fe.resultInfo;et(me)||me===0?D.push({userID:se}):T.push({userID:se,code:me,message:fe})}),Kt({successUserIDList:D,failureUserIDList:T})}).catch(function($){return a.setError($).end(),K.w("".concat(h," error:"),$),De($)}))}},{key:"updateFriend",value:function(n){var a,s,h,m=this,I=n.userID,T=n.remark,D=n.friendCustomField;return this._map.has(I)?(a="".concat(this._n,".").concat("updateFriend"),(s=new ct("updateFriend")).setMessage("userID:".concat(I," remark:").concat(T," friendCustomField:").concat(D)),h=[],et(T)||h.push({tag:Ho.REMARK,value:T}),wt(D)&&0<D.length&&D.forEach(function(V){h.push({tag:V.key,value:V.value})}),this._snsM.req({P:de.UPDATE_FD,data:{fromAccount:this._snsM.getMyUserID(),updateItem:[{to:I,snsItem:h}]}}).then(function(se){s.end(),K.i("".concat(a," ok"));var se=se.data.resultList[0],$=se.to,q=se.resultCode,se=se.resultInfo;return et(q)||q===0?(($=m._map.get($))&&(et(T)||($.remark=T),wt(D)&&0<D.length&&vu($.friendCustomField,D),m._onFriendListUpdated()),Kt($)):De({code:q,message:se})}).catch(function(V){return s.setError(V).end(),K.w("".concat(a," failed. error:"),V),De(V)})):De({code:Je.NOT_MY_FRIEND})}},{key:"checkFriend",value:function(n){var a="".concat(this._n,".").concat("checkFriend"),s=n.userIDList,h=n.type,m=(h&&(h===O.SNS_CHECK_TYPE_SINGLE||h===O.SNS_CHECK_TYPE_BOTH)||(h=O.SNS_CHECK_TYPE_BOTH),new ct("checkFriend"));return m.setMessage("userIDList:".concat(s," type:").concat(h)),this._snsM.req({P:de.CHECK_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:s,type:h}}).then(function(V){m.end(),K.i("".concat(a," ok. userIDList:").concat(s," type:").concat(h));var T=[],D=[],V=V.data.resultList;return wt(V)&&V.forEach(function(fe){var q=fe.to,se=fe.relation,me=fe.resultCode,fe=fe.resultInfo;et(me)||me===0?T.push({userID:q,code:0,relation:se}):D.push({userID:q,code:me,message:fe})}),Kt({successUserIDList:T,failureUserIDList:D})}).catch(function(I){return m.setError(I).end(),K.w("".concat(a," failed. error:"),I),De(I)})}},{key:"onAddedToFriendGroup",value:function(h){var a=this,s=h.name,h=h.userIDList;K.l("".concat(this._n,".onAddedToFriendGroup groupName:").concat(s," userIDList:").concat(h)),s&&!Tt(h)&&h.forEach(function(m){a._map.has(m)&&a._map.get(m).addToGroupList(s)})}},{key:"onRemovedFromFriendGroup",value:function(h){var a=this,s=h.name,h=h.userIDList;K.l("".concat(this._n,".onRemovedFromFriendGroup groupName:").concat(s," userIDList:").concat(h)),s&&!Tt(h)&&h.forEach(function(m){a._map.has(m)&&a._map.get(m).removeFromGroupList(s)})}},{key:"reset",value:function(){this._map.clear(),this._startIdx=0,this._standardSeq=0,this._customSeq=0}}]),Ah=p(function n(a){u(this,n),Tt(a)||(this.name=a.name||"",this.userIDList=a.userIDList||[],this.count=this.userIDList.length||0)},[{key:"addToUserIDList",value:function(n){this.userIDList.indexOf(n)===-1&&(this.userIDList.push(n),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(n){n=this.userIDList.indexOf(n),-1<n&&(this.userIDList.splice(n,1),this.count=this.userIDList.length)}}]),Dh=p(function n(a){u(this,n),this._snsM=a,this._n="FriendGroupHandler",this._map=new Map},[{key:"getLocalGroupList",value:function(){return P(this._map.values())}},{key:"_onGroupListUpdated",value:function(){var n=P(this._map.values());this._snsM.emitOEvt(W.FRIEND_GROUP_LIST_UPDATED,n)}},{key:"getGroupList",value:function(){var n=this,a="".concat(this._n,".").concat("getGroupList"),s=new ct("getGroupList");return this._snsM.req({P:de.GET_FD_GRP_LIST,data:{fromAccount:this._snsM.getMyUserID()}}).then(function(h){s.end(),h=h.data.resultList,Tt(h)?K.i("".concat(a," ok. count:0")):(K.i("".concat(a," ok. count:").concat(h.length)),n._map.clear(),h.forEach(function(m){var I=new Ah(m);n._map.set(m.name,I)}),n._onGroupListUpdated())}).catch(function(h){return s.setError(h).end(),K.w("".concat(a," error:"),h),De(h)})}},{key:"createGroup",value:function(T){var a,s,h=this,m="".concat(this._n,".").concat("createGroup"),I=T.name,T=T.userIDList;return this._map.has(I)?De({code:Je.FRIEND_GRP_EXISTED}):(a="name:".concat(I," userIDList:").concat(T),(s=new ct("createGroup")).setMessage(a),this._snsM.req({P:de.CREATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),groupName:[I],userIDList:wt(T)?T:void 0}}).then(function(q){s.end(),K.l("".concat(m," ok. ").concat(a));var q=q.data.resultList,V=[],$=[],q=(q&&q.forEach(function(se){var me=se.to,fe=se.resultCode,He=se.resultInfo;et(fe)||fe===0?V.push(me):(me={userID:se.to,code:fe,message:He},$.push(me))}),new Ah({name:I,userIDList:V}));return h._map.set(I,q),h._snsM.onAddedToFriendGroup({name:I,userIDList:V}),h._onGroupListUpdated(),Kt({friendGroup:q,failureUserIDList:$})}).catch(function(D){return s.setError(D).end(),K.w("".concat(m," failed. error:"),D),De(D)}))}},{key:"deleteGroup",value:function(n){var a,s,h=this,m="".concat(this._n,".").concat("deleteGroup"),I=n.name;return this._map.has(I)?(a="name:".concat(I),(s=new ct("deleteGroup")).setMessage(a),this._snsM.req({P:de.DEL_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),nameList:[I]}}).then(function(T){s.end(),K.l("".concat(m," ok. ").concat(a));var D=h._map.get(I);return D&&(h._snsM.onRemovedFromFriendGroup({name:I,userIDList:D.userIDList}),h._map.delete(I),D.userIDList.length=0),h._onGroupListUpdated(),Kt(D)}).catch(function(T){return s.setError(T).end(),K.w("".concat(m," failed. error:"),T),De(T)})):this._onGroupNotExist()}},{key:"renameGroup",value:function(n){var a,s,h=this,m="".concat(this._n,".").concat("renameGroup"),I=n.oldName,T=n.newName;return this._map.has(I)?(a="oldName:".concat(I," newName:").concat(T),(s=new ct("renameGroup")).setMessage(a),this._snsM.req({P:de.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:I,newName:T}}).then(function(){var D;return s.end(),K.l("".concat(m," ok. ").concat(a)),h._map.has(I)?((D=h._map.get(I)).name=T,h._map.delete(I),h._map.set(T,D),h._snsM.onRemovedFromFriendGroup({name:I,userIDList:D.userIDList}),h._snsM.onAddedToFriendGroup({name:T,userIDList:D.userIDList}),h._onGroupListUpdated(),Kt(D)):Kt()}).catch(function(D){return s.setError(D).end(),K.w("".concat(m," failed. error:"),D),De(D)})):this._onGroupNotExist()}},{key:"addToGroup",value:function(T){var a,s,h=this,m="".concat(this._n,".").concat("addToGroup"),I=T.name,T=T.userIDList;return this._map.has(I)?(a="name:".concat(I," userIDList:").concat(T),(s=new ct("addToGroup")).setMessage(a),this._snsM.req({P:de.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:I,updateGroupItem:T.filter(function(D){return h._snsM.isMyFriend(D)}).map(function(D){return{to:D,updateType:"Update_Type_Add"}})}}).then(function(D){return s.end(),K.l("".concat(m," ok. ").concat(a)),h._onGroupUpdated(I,D)}).catch(function(D){return s.setError(D).end(),K.w("".concat(m," failed. error:"),D),De(D)})):this._onGroupNotExist()}},{key:"removeFromGroup",value:function(T){var a,s,h=this,m="".concat(this._n,".").concat("removeFromGroup"),I=T.name,T=T.userIDList;return this._map.has(I)?(a="name:".concat(I," userIDList:").concat(T),(s=new ct("removeFromGroup")).setMessage(a),this._snsM.req({P:de.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:I,updateGroupItem:T.filter(function(D){return h._snsM.isMyFriend(D)}).map(function(D){return{to:D,updateType:"Update_Type_Delete"}})}}).then(function(D){return s.end(),K.l("".concat(m," ok. ").concat(a)),h._onGroupUpdated(I,D)}).catch(function(D){return s.setError(D).end(),K.w("".concat(m," failed. error:"),D),De(D)})):this._onGroupNotExist()}},{key:"_onGroupUpdated",value:function(n,s){var s=s.data.resultList,h=this._map.get(n),m=[],I=[],T=[];return wt(s)&&s.forEach(function(D){var V=D.to,$=D.resultCode,q=D.resultInfo,se=D.type;$===0?se==="Update_Type_Add"?h&&(h.addToUserIDList(V),I.push(V)):se==="Update_Type_Delete"&&h&&(h.removeFromUserIDList(V),T.push(V)):m.push({to:D.to,code:$,message:q})}),K.l("".concat(this._n,"._onGroupUpdated name:").concat(n," userIDList:").concat(h.userIDList)),0<I.length&&this._snsM.onAddedToFriendGroup({name:n,userIDList:I}),0<T.length&&this._snsM.onRemovedFromFriendGroup({name:n,userIDList:T}),Kt({friendGroup:h,failureUserIDList:m})}},{key:"updateWhenFriendAdded",value:function(n){var a=this,s=n.nameList,h=n.userID;K.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(h," nameList:").concat(s)),Tt(s)||s.forEach(function(m){a._map.has(m)&&a._map.get(m).addToUserIDList(h)})}},{key:"updateWhenFriendDeleted",value:function(n){var a=this,s=n.nameList,h=n.userID;K.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(h," nameList:").concat(s)),Tt(s)||s.forEach(function(m){a._map.has(m)&&a._map.get(m).removeFromUserIDList(h)})}},{key:"_onGroupNotExist",value:function(n){return De({code:Je.FRIEND_GRP_NOT_EXIST})}},{key:"reset",value:function(){this._map.clear()}}]),zI=(S(Nu,$o),p(Nu,[{key:"onContextUpdated",value:function(n){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getGroupList(),this._friendApplicationHandler.getApplicationList()}},{key:"onRelationChainModified",value:function(V){var a,s,h,m,I,T,D=this,V=V.dataList;Tt(V)||(a=[],s=[],h=[],I=!(m=[]),T="",V.forEach(function($){var q;$.pushType!==3&&$.pushType!==4||!$.from||(T=$.from),$.friendAddAccount&&(a.push.apply(a,P($.friendAddAccount)),m.push.apply(m,P($.friendAddAccount))),$.friendDelAccount&&s.push.apply(s,P($.friendDelAccount)),$.friendApplicationAdded&&h.push.apply(h,P($.friendApplicationAdded)),$.friendApplicationDeletedUserIDList&&m.push.apply(m,P($.friendApplicationDeletedUserIDList)),$.reportTime&&$.pushType===7&&(I=!0),$.friendUpInfo&&(q={dataList:[]},$.friendUpInfo.forEach(function(se){q.dataList.push({userID:se.friendAccount,profileList:P(se.sns)})}),D.onFriendProfileModified(q))}),I&&this._friendApplicationHandler.onApplicationRead(),this._friendApplicationHandler.onApplicationAdded(h,T),this._friendApplicationHandler.onApplicationDeleted(m),this._friendHandler.onFriendAdded(a),this._friendHandler.onFriendDeleted(s))}},{key:"isMyFriend",value:function(n){return this._friendHandler.isMyFriend(n)}},{key:"filterProfanity",value:function(n,a){var s,h=this.get(29);return!h||(s=(h=h.filterText(a[n],"sns")).isAllowedToSend,h=h.modifiedText,s===!0&&(a[n]=h,!0))}},{key:"onFriendProfileModified",value:function(n){this._friendHandler.onFriendProfileModified(n)}},{key:"getLocalFriendList",value:function(){var n=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],a=this._friendHandler.getLocalFriendList();return n?ln(a):a}},{key:"getFriendRemark",value:function(n){return this._friendHandler.getFriendRemark(n)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(n){return this._friendHandler.addFriend(n)}},{key:"deleteFriend",value:function(n){return this._friendHandler.deleteFriend(n)}},{key:"checkFriend",value:function(n){return this._friendHandler.checkFriend(n)}},{key:"getFriendProfile",value:function(n){return this._friendHandler.getFriendProfile(n)}},{key:"updateFriend",value:function(n){return this._friendHandler.updateFriend(n)}},{key:"onAddedToFriendGroup",value:function(n){this._friendHandler.onAddedToFriendGroup(n)}},{key:"onRemovedFromFriendGroup",value:function(n){this._friendHandler.onRemovedFromFriendGroup(n)}},{key:"getLocalFriendApplicationList",value:function(){var n=this._friendApplicationHandler.getLocalApplicationList();return ln(n)}},{key:"deleteFriendApplication",value:function(n){return this._friendApplicationHandler.deleteApplication(n)}},{key:"refuseFriendApplication",value:function(n){return this._friendApplicationHandler.refuseApplication(n)}},{key:"acceptFriendApplication",value:function(n){return this._friendApplicationHandler.acceptApplication(n)}},{key:"setFriendApplicationRead",value:function(n){return this._friendApplicationHandler.setApplicationRead(n)}},{key:"getLocalFriendGroupList",value:function(){var n=this._friendGroupHandler.getLocalGroupList();return ln(n)}},{key:"createFriendGroup",value:function(n){return this._friendGroupHandler.createGroup(n)}},{key:"deleteFriendGroup",value:function(n){return this._friendGroupHandler.deleteGroup(n)}},{key:"addToFriendGroup",value:function(n){return this._friendGroupHandler.addToGroup(n)}},{key:"removeFromFriendGroup",value:function(n){return this._friendGroupHandler.removeFromGroup(n)}},{key:"renameFriendGroup",value:function(n){return this._friendGroupHandler.renameGroup(n)}},{key:"updateWhenFriendAdded",value:function(n){this._friendGroupHandler.updateWhenFriendAdded(n)}},{key:"updateWhenFriendDeleted",value:function(n){this._friendGroupHandler.updateWhenFriendDeleted(n)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}])),Oh=(S(Cl,$o),p(Cl,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&sn}},{key:"startWorkerTimer",value:function(){K.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){K.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){var n,a;sn&&(n=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"})),this._workerTimer=new Worker(n),(a=this)._workerTimer.onmessage=function(s){s.data?(a._timerID=s.data,K.l("".concat(a._n,"._init seed:").concat(a._timerID))):a._m.onCheckTimer()})}},{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("enable_worker");K.l("".concat(this._n,"._onCloudConfig enableWorker:").concat(n)),et(n)||n==="1"?!this._isWorkerEnabled&&sn&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&sn&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){K.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}])),WI=p(function n(a){u(this,n),this._commercialConfigM=a,this._n="PurchasedFeatureHandler",this._isCSPluginReported=!1,this._featureMap=new Map},[{key:"isValidPurchaseBits",value:function(n){return n&&typeof n=="string"&&1<=n.length&&n.length<=64&&/[01]{1,64}/.test(n)}},{key:"parsePurchaseBits",value:function(n){if(this.isValidPurchaseBits(n)){this._featureMap.clear();for(var a,s=n.length-1,h=0;0<=s;s--,h++)a=(h<32?new oe(0,Math.pow(2,h)):new oe(Math.pow(2,h-32),0)).toString(),n[s]==="1"?this._featureMap.set(a,!0):this._featureMap.set(a,!1)}else K.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(n))}},{key:"hasPurchasedFeature",value:function(n){return!!this._featureMap.get(n)}},{key:"isFeatureEnabled",value:function(n){for(var a=parseInt(n).toString(2),s=void 0,h=!0,m=a.length-1,I=0;0<=m;m--,I++)if(a.charAt(m)==="1"&&(s=(I<32?new oe(0,Math.pow(2,I)):new oe(Math.pow(2,I-32),0)).toString(),!this._featureMap.get(s))){h=!1;break}return K.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(n," key:").concat(s," ret:").concat(h)),ln({enabled:h})}},{key:"isFeatureEnabledForStat",value:function(n){for(var a=parseInt(n).toString(2),s=a.length-1,h=0;0<=s;s--,h++)if(a.charAt(s)==="1"){if(m=(h<32?new oe(0,Math.pow(2,h)):new oe(Math.pow(2,h-32),0)).toString(),!this._featureMap.get(m))break;var m,I="",T=0;m===ye.PLUGIN_TRANSLATE?(I="plugin_translate",T=16):m===ye.PLUGIN_VOICE_TO_TEXT?(I="plugin_voice_to_text",T=17):m===ye.PLUGIN_CS?(I="plugin_cs",T=14):m===ye.PLUGIN_PUSH?(I="plugin_push",T=13):m===ye.PLUGIN_BOT?(I="plugin_bot",T=15):m===ye.MSG_REACTION&&(I="plugin_emoji_reaction",T=18),I!==""&&(m=this._commercialConfigM.get(12).getUIPlatform(),new ct(I).setCode(T).setUIPlatform(m).end(),K.l("".concat(this._n,".isFeatureEnabledForStat ").concat(I," code:").concat(T," uiPlatform:").concat(m)))}}},{key:"isCSPluginEnabled",value:function(){var n;this._isCSPluginReported||(n=this._commercialConfigM.get(12).getUIPlatform(),new ct("plugin_search").setCode(6).setUIPlatform(n).end(),this._isCSPluginReported=!0)}},{key:"clear",value:function(){this._featureMap.clear(),this._isCSPluginReported=!1}}]),oM=p(function n(a){u(this,n),this._m=a,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new WI(this)},[{key:"_canFetch",value:function(){return this.get(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(n){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var n,a,s=this,h=this._canFetch(),m="".concat(this._n,".fetchConfig");K.l("".concat(m," canFetch:").concat(h)),h&&(n=new ct("fetchCommercialConfig"),h=this.get(12).getSDKAppID(),a=this.get(20),this._isFetching=!0,a.req({P:de.FETCH_COMMERCIAL_CONFIG,data:{SDKAppID:h}}).then(function(I){n.setMessage("purchaseBits:".concat(I.data.purchaseBits)).end(),K.l("".concat(m," ok.")),s._parseConfig(I.data),s._isFetching=!1}).catch(function(I){n.setError(I).end(),s._isFetching=!1}))}},{key:"onPushedConfig",value:function(n){var a="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(n));K.l("".concat(a)),new ct("pushedCommercialConfig").setMessage("purchaseBits:".concat(n.purchaseBits)).end(),this._parseConfig(n)}},{key:"_parseConfig",value:function(n){var a="".concat(this._n,"._parseConfig"),s=n.errorCode,h=n.errorMessage,m=n.purchaseBits,I=n.expiredTime;s===0?(this._purchasedFeatureHandler.parsePurchaseBits(m),this._expiredTime=Date.now()+1e3*I):et(s)?(K.l("".concat(a," failed. Invalid message format:"),n),this._setExpiredTimeOnResponseError(36e5)):(K.e("".concat(a," errorCode:").concat(s," errorMessage:").concat(h)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(n){this._expiredTime=Date.now()+n}},{key:"canIUse",value:function(n){return this._purchasedFeatureHandler.hasPurchasedFeature(n)}},{key:"isFeatureEnabled",value:function(n){return this._purchasedFeatureHandler.isFeatureEnabled(n)}},{key:"isFeatureEnabledForStat",value:function(n){this._purchasedFeatureHandler.isFeatureEnabledForStat(n)}},{key:"isCSPluginEnabled",value:function(){this._purchasedFeatureHandler.isCSPluginEnabled()}},{key:"get",value:function(n){return this._m.get(n)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),jI=(S(tm,$o),p(tm,[{key:"registerPlugin",value:function(n){var a,s,h,m,I,T,D,V,$,q,se,me,fe;Qe?(this._offlinePushPlugin=n["tim-offline-push-plugin"],a=(fe=n.offlinePushConfig||{}).huaweiBusinessID,s=fe.xiaomiBusinessID,h=fe.xiaomiAppID,m=fe.xiaomiAppKey,I=fe.meizuBusinessID,T=fe.meizuAppID,D=fe.meizuAppKey,V=fe.vivoBusinessID,$=fe.oppoBusinessID,q=fe.oppoAppKey,se=fe.oppoAppSecret,me=fe.honorBusinessID,fe=fe.iosBusinessID,this._androidPushConfig.huaweiPushBussinessId=a,this._androidPushConfig.xiaomiPushBussinessId=s,this._androidPushConfig.xiaomiPushAppId=h,this._androidPushConfig.xiaomiPushAppKey=m,this._androidPushConfig.meizuPushBussinessId=I,this._androidPushConfig.meizuPushAppId=T,this._androidPushConfig.meizuPushAppKey=D,this._androidPushConfig.vivoPushBussinessId=V,this._androidPushConfig.oppoPushBussinessId=$,this._androidPushConfig.oppoPushAppKey=q,this._androidPushConfig.oppoPushAppSecret=se,this._androidPushConfig.honorPushBussinessId=me,new ct("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!et(this._offlinePushPlugin))).end(!0),K.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(n.offlinePushConfig))),this._iosBusinessID=fe,this._setAppShowListener()):this.warn("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var n,a=this,s="".concat(this._n,".").concat("_getDeviceToken");No(this._offlinePushPlugin.getDeviceToken)?(n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID),K.l("".concat(s," start. ").concat(n)),new ct("_getDeviceToken").setMessage("".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,function(h){var m,I,T,D,V=new ct("getDeviceTokenRes"),$=h.code,q=h.msg;$===0?(m=(D=h.data).deviceToken,I=D.deviceBrand,T=D.deviceType,D=D.bussinessId,a._deviceToken=m,a._businessID=D||a._iosBusinessID,n="deviceToken:".concat(m,", deviceBrand:").concat(I||T,", businessID:").concat(a._businessID),K.l("".concat(s," ok. ").concat(n)),V.setMessage(n).end(!0),a._setToken()):(V.setMessage("code:".concat($,", msg:").concat(q)).end(!0),K.e("".concat(s," failed. error:"),h))})):K.e("".concat(s," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return Qe&&!et(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var n=this,a="".concat(this._n,".").concat("_setAppShowListener");et(this._offlinePushPlugin)?K.e("".concat(a," offlinePushPlugin is undefined")):No(this._offlinePushPlugin.setAppShowListener)?(new ct("_setAppShowListener").end(!0),K.l("".concat(a," start")),this._offlinePushPlugin.setAppShowListener(function(s){s=(s||{}).appShow,new ct("setAppShowListenerRes").setMessage("appShow:".concat(s)).end(!0),K.l("".concat(a," ok. appShow:").concat(s)),n._m.isReady()&&(s===0?(n._getConvUnreadCount(),n._onBackground()):s===1&&n._onForeground())})):K.e("".concat(a," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){var n;if(!et(this._offlinePushPlugin)&&No(this._offlinePushPlugin.getDeviceType))return n=(this._offlinePushPlugin.getDeviceType()||{}).deviceType,K.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(n)),n}},{key:"_setToken",value:function(){var n="".concat(this._n,"._setToken"),a=this.get(12),s=1,h="",m="",D=(Tt(this._deviceToken)&&(s=0),this.getUniAppPlatform()),I=this.getDeviceBrand(),T=(D===ie.IOS||D===ie.IPAD||D===ie.MAC?m=this._deviceToken:D===ie.ANDROID&&(h=this._deviceToken),new ct("offlinePushSetToken")),D="deviceToken:".concat(m||h,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(I,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(s,", platform:").concat(D);return T.setMessage("".concat(D)),K.l("".concat(n," ").concat(D)),this.req({P:de.SET_TOKEN,data:{tokenID:h,pushMsg:s,sdkAppID:a.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:I,deviceToken:m,isWebUniapp:this._isWebUniapp}}).then(function(V){return T.end(),K.l("".concat(n," ok")),V}).catch(function(V){return T.setError(V).end(),K.e("".concat(n," failed. error:"),V),De(V)})}},{key:"_getConvUnreadCount",value:function(){var n=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach(function(a){a.type===O.CONV_C2C&&(n._c2cUnreadCount+=a.unreadCount),a.type===O.CONV_GROUP&&(n._groupUnreadCount+=a.unreadCount)})}},{key:"_onBackground",value:function(){var n=this,a="".concat(this._n,".").concat("_onBackground"),s=new ct("_onBackground");this.req({P:de.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(h){return s.setMessage("c2cUnreadCount: ".concat(n._c2cUnreadCount,", groupUnreadCount: ").concat(n._groupUnreadCount)).end(),K.l("".concat(a," ok")),h}).catch(function(h){s.setError(h).end(),K.e("".concat(a," failed. error:"),h)})}},{key:"_onForeground",value:function(){var n="".concat(this._n,".").concat("_onForeground"),a=new ct("_onForeground");this.req({P:de.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(s){return a.end(),K.l("".concat(n," ok")),s}).catch(function(s){a.setError(s).end(),K.e("".concat(n," failed. error:"),s)})}},{key:"getUniAppPlatform",value:function(){var n=uni.getSystemInfoSync().platform,a=this.getDeviceBrand();return n==="ios"?ie.IOS:n==="android"?ie.ANDROID:a===1002?ie.IPAD:a===1001?ie.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,K.l("".concat(this._n,".reset"))}}])),YI=(S(xh,$o),p(xh,[{key:"registerPlugin",value:function(n){var a,s,h;Qe?(a="".concat(this._n,".").concat("registerPlugin"),this._pushPlugin=n["tim-push"],this._getDeviceInfo(),s=(h=n.pushConfig||{}).androidConfig,h=h.iOSConfig,Vn(s)&&(this._androidPushConfig=s[this._deviceInfo.packageName]),s=(h||{}).iOSBusinessID,this._iOSBusinessID=s,h=!et(this._pushPlugin),new ct("registerPlugin").setMessage(this._pluginName).setMoreMessage("isExisted:".concat(h)).end(!0),K.l("".concat(a," ok. pushConfig:").concat(JSON.stringify(n.pushConfig))),h?(this._setAppShowListener(),this._setPushEventReportListener()):K.e("".concat(a," ").concat(this._pluginName," is undefined"))):this.warn("TIMPushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._reportEventCacheList(),this._getDeviceToken(),this.get(27).isFeatureEnabledForStat(Math.pow(2,41))}},{key:"_reportEventCacheList",value:function(){var n=this,a="".concat(this._n,".").concat("_reportEventCacheList");No(this._pushPlugin.getPushEventCacheList)?(new ct("_reportEventCacheList").end(!0),this._pushPlugin.getPushEventCacheList(function(s){var h=s.code,m=s.data.eventList,I=new ct("getPushEventCacheListRes");if(I.setCode(h),h!==0)I.setMessage("res:".concat(JSON.stringify(s))).end(!0),K.e("".concat(a," failed. error:").concat(JSON.stringify(s)));else{h=m.length<10?"eventList:".concat(JSON.stringify(m)):"eventList.length:".concat(m.length),K.l("".concat(a," ok. ").concat(h)),I.setMessage(h).end(!0);for(var T=E(E({},s.data),{},{eventList:[]});0<m.length;)T.eventList=m.splice(0,40),n._pushReport(T)}})):K.e("".concat(this._pluginName,".getPushEventCacheList is not a function"))}},{key:"_getDeviceToken",value:function(){var n,a=this,s="".concat(this._n,".").concat("_getDeviceToken");No(this._pushPlugin.getDeviceToken)?(n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig)," iOSBusinessID:").concat(this._iOSBusinessID),K.l("".concat(s," start. ").concat(n)),new ct("_getDeviceToken").setMessage("".concat(n)).end(!0),this._pushPlugin.getDeviceToken(this._androidPushConfig,function(h){var m,I,T,D=h.code,V=h.msg,$=new ct("getDeviceTokenRes");$.setCode(D),D===0?(m=(D=h.data).deviceToken,I=D.deviceBrand,T=D.deviceType,D=D.bussinessId,a._deviceToken=m,a._businessID=D||a._iOSBusinessID,n="deviceToken:".concat(m," deviceBrand:").concat(I||T," businessID:").concat(a._businessID),K.l("".concat(s," ok. ").concat(n)),$.setMessage(n).end(!0),a._setToken()):($.setMessage(V).end(!0),K.e("".concat(s," failed. error:").concat(JSON.stringify(h))))})):K.e("".concat(this._pluginName,".getDeviceToken is not a function"))}},{key:"_getDeviceInfo",value:function(){var n,a,s,h,m="".concat(this._n,".").concat("_getDeviceInfo");No(this._pushPlugin.getDeviceInfo)?(h=(n=this._pushPlugin.getDeviceInfo()).code,a=n.data,(s=new ct("_getDeviceInfo")).setCode(h),h===0?(this._deviceInfo=E(E({},this._deviceInfo),a),this._deviceInfo.pushVersion||(this._deviceInfo.pushVersion="1.0.1"),h="deviceInfo:".concat(JSON.stringify(this._deviceInfo)),K.l("".concat(m," ok. ").concat(h)),s.setMessage(h).end(!0)):(s.setMessage("deviceInfoRes:".concat(JSON.stringify(n))).end(!0),K.e("".concat(m," failed. error:").concat(JSON.stringify(n))))):K.e("".concat(this._pluginName,".getDeviceInfo is not a function"))}},{key:"canIUseTIMPush",value:function(){return Qe&&!et(this._pushPlugin)}},{key:"_setAppShowListener",value:function(){var n=this,a="".concat(this._n,".").concat("_setAppShowListener");No(this._pushPlugin.setAppShowListener)?(new ct("_setAppShowListener").end(!0),K.l("".concat(a," start")),this._pushPlugin.setAppShowListener(function(s){s=(s||{}).appShow,new ct("setAppShowListenerRes").setMessage("appShow:".concat(s)).end(!0),K.l("".concat(a," ok. appShow:").concat(s)),n._m.isReady()&&(s===0?(n._getConvUnreadCount(),n._onBackground()):s===1&&n._onForeground())})):K.e("".concat(this._pluginName,".setAppShowListener is not a function"))}},{key:"_setPushEventReportListener",value:function(){var n=this,a="".concat(this._n,".").concat("_setPushEventReportListener");No(this._pushPlugin.setPushEventReportListener)?(new ct("_setPushEventReportListener").end(!0),this._pushPlugin.setPushEventReportListener(function(s){var h=s.code,m=s.data,I=m.eventList,T=new ct("setPushEventReportListenerRes");T.setCode(h),h===0?(h="eventList:".concat(JSON.stringify(I)),K.l("".concat(a," ok. ").concat(h)),T.setMessage(h).end(!0),n._m.isReady()&&wt(I)&&0<I.length&&n._pushReport(m)):(T.setMessage("res:".concat(JSON.stringify(s))).end(!0),K.e("".concat(a," failed. error:").concat(JSON.stringify(s))))})):K.e("".concat(this._pluginName,".setPushEventReportListener is not a function"))}},{key:"getDeviceBrand",value:function(){var n;if(!et(this._pushPlugin)&&No(this._pushPlugin.getDeviceType))return n=(this._pushPlugin.getDeviceType()||{}).deviceType,K.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(n)),n}},{key:"_setToken",value:function(){var n="".concat(this._n,".").concat("_setToken"),a=this.get(12),s=1,D="",h="",I=(Tt(this._deviceToken)&&(s=0),this.getUniAppPlatform()),m=this.getDeviceBrand(),I=(I===ie.IOS||I===ie.IPAD||I===ie.MAC?h=this._deviceToken:I===ie.ANDROID&&(D=this._deviceToken),E({tokenID:D,pushMsg:s,sdkAppID:a.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:m,deviceToken:h,isWebUniapp:this._isWebUniapp},this._deviceInfo)),T=new ct("_setToken"),D="data:".concat(JSON.stringify(I));T.setMessage("".concat(D)),K.l("".concat(n," ").concat(D)),this.req({P:de.SET_TOKEN,data:I}).then(function(){T.end(),K.w("".concat(n," ok"))}).catch(function(V){T.setError(V).end(),K.e("".concat(n," failed. error:"),V),De(V)})}},{key:"_getConvUnreadCount",value:function(){var n=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach(function(a){a.type===O.CONV_C2C&&(n._c2cUnreadCount+=a.unreadCount),a.type===O.CONV_GROUP&&(n._groupUnreadCount+=a.unreadCount)})}},{key:"_onBackground",value:function(){var n=this,a="".concat(this._n,".").concat("_onBackground"),s=new ct("_onBackground");this.req({P:de.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then(function(){s.setMessage("c2cUnreadCount:".concat(n._c2cUnreadCount," groupUnreadCount:").concat(n._groupUnreadCount)).end(),K.l("".concat(a," ok"))}).catch(function(h){s.setError(h).end(),K.e("".concat(a," failed. error:"),h)})}},{key:"_onForeground",value:function(){var n="".concat(this._n,".").concat("_onForeground"),a=new ct("_onForeground");this.req({P:de.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then(function(){a.end(),K.l("".concat(n," ok"))}).catch(function(s){a.setError(s).end(),K.e("".concat(n," failed. error:"),s)})}},{key:"_pushReport",value:function(n){var a=this,s="".concat(this._n,".").concat("_pushReport"),h=new ct("_pushReport");this.req({P:de.PUSH_REPORT,data:{eventList:n.eventList}}).then(function(){h.end(),a._notifyReportSuccess(n)}).catch(function(m){h.setError(m).end(),K.e("".concat(s," failed. error:"),m)})}},{key:"_notifyReportSuccess",value:function(n){!et(this._pushPlugin)&&No(this._pushPlugin.notifyReportSuccess)&&(this._pushPlugin.notifyReportSuccess(n),K.l("".concat(this._n,"._notifyReportSuccess ok")))}},{key:"getUniAppPlatform",value:function(){var n=uni.getSystemInfoSync().platform,a=this.getDeviceBrand();return n==="ios"?ie.IOS:n==="android"?ie.ANDROID:a===1002?ie.IPAD:a===1001?ie.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,K.l("".concat(this._n,".reset"))}}])),rM=(S(Ph,$o),p(Ph,[{key:"init",value:function(){var n=this.get(18).getPlugin("tim-profanity-filter-plugin");n&&(this._plugin=new n({logger:K,isArray:wt,isMap:sc,isDevMode:this.isDevMode()}),this._getLexicon())}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(n,a){var s=!0;if(this._plugin&&this._canIUseLexicon&&(!a||!a.messageControlInfo||a.messageControlInfo.excludedFromContentModeration!==!0)){var a=n.type,h=n.conversationType;if(a===O.MSG_TEXT||a===O.MSG_CUSTOM){var m,I="".concat(this._n,".filterMessage");if(K.l("".concat(I)),a===O.MSG_TEXT){if(h===O.CONV_C2C?m="c2c_text_message":h===O.CONV_GROUP&&(m="group_text_message"),!this._isConfigOn(m))return s;var D=this._plugin.filter(n.payload.text),T=D.type,D=D.modifiedText;T===1?s=!1:T===2&&(n.payload.text=D)}else if(a===O.MSG_CUSTOM){if(h===O.CONV_C2C?m="c2c_custom_message":h===O.CONV_GROUP&&(m="group_custom_message"),!this._isConfigOn(m))return s;T=this._plugin.filter(n.payload.data),D=this._plugin.filter(n.payload.description),a=this._plugin.filter(n.payload.extension),T.type===1||D.type===1||a.type===1?s=!1:(T.type===2&&(n.payload.data=T.modifiedText),D.type===2&&(n.payload.description=D.modifiedText),a.type===2&&(n.payload.extension=a.modifiedText))}K.l("".concat(I," done. isAllowedToSend:").concat(s))}}return s}},{key:"filterText",value:function(n,a){var s="".concat(this._n,".filterText"),h={isAllowedToSend:!0,modifiedText:n};return this._plugin&&this._canIUseLexicon&&this._isConfigOn(a)&&(K.l("".concat(s)),n=(a=this._plugin.filter(n)).type,a=a.modifiedText,n===1?h.isAllowedToSend=!1:n===2&&(h.modifiedText=a),K.l("".concat(s," done. ret:"),h)),h}},{key:"_getLexicon",value:function(){var n=this,a=new ct("profanityFilter"),s="".concat(this._n,"._getLexicon");this._isFetching=!0,this.req({P:de.GET_PROFANITY_LIST,data:{startIndex:this._startIndex,version:this._version}}).then(function(se){var se=se.data,m=se.errorInfo,I=se.filterConfig,T=se.lexicon,D=se.strToken,V=se.completeFlag,$=se.nextStartIndex,q=se.version,se=se.expiredTime,me=m.errorCode,fe=m.errorMessage;return me!==0?(n._isFetching=!1,K.w("".concat(s," failed. error:"),m),void a.setCode(me).setMessage(fe).end()):(n._onFilterConfig(I),n._getToken(D),V===1?(K.l("".concat(s," done. version:").concat(q," expiredTime:").concat(se)),n._version=q,n._canIUseLexicon=!0,n._isFetching=!1,n._expiredTime=Date.now()+1e3*se,void n._plugin.onLexiconCompleted(T)):(n._startIndex=$,n._plugin.onLexiconSliced(T),void n._getLexicon()))}).catch(function(h){a.setError(h).end(),n._isFetching=!1,K.l("".concat(s," failed. error:"),h)})}},{key:"_onFilterConfig",value:function(n){var a=this;Tt(n)||(this._filterConfigMap.clear(),Object.keys(n).forEach(function(s){a._filterConfigMap.set(s,n[s])}),K.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(n){return this._filterConfigMap.get(n)===1}},{key:"_getToken",value:function(n){if(_n(n)){var a=n.length,s="";if(a%2==0)for(var h=0;h<=a-1;h+=2)s=(s+=n[h+1])+n[h];else{for(var m=0;m<a-1;m+=2)s=(s+=n[m+1])+n[m];s+=n[a-1]}this._plugin.onToken(s)}}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}])),Zv=p(function n(a){u(this,n),this._m=a,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*","live_engine_srv.*","live_engine_http_srv.*","live_engine_pk.*","trtc_ai_service.*","call_engine_srv.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getIEmitInst().on(So.CLOUD_CONFIG,this._onCloudConfig,this)},[{key:"_onCloudConfig",value:function(){var n=this,a=this._m.get(23).getCloudConfig("rtc_cmd");et(a)||((a=JSON.parse(a)).forEach(function(s){n._TRTCCommandList.includes(s)||n._TRTCCommandList.push(s)}),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var n,a=0,s=this._TRTCCommandList.length;a<s;a++)n=this._TRTCCommandList[a].split(".")[0],this._TRTCCommandMap.set(n,1)}},{key:"onRoomCustomDataReceived",value:function(n){this._m.getOEmitInst().emit(W.ROOM_CUSTOM_DATA_RECEIVED,n)}},{key:"sendTRTCCustomData",value:function(s){var a=s.serviceCommand,s=s.data,h="".concat(X.NAME.TUIROOM_SVR,".*");return et(a)||(h=a),this._isValidServiceCommand(h)?this._trans({servcmd:h,data:s}):De({code:Je.INVALID_TRTC_CMD})}},{key:"_trans",value:function(s){K.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(s)));var a=s.servcmd,s=s.data;return this._m.get(20).trans({servcmd:a,data:_n(s)?JSON.parse(s):s})}},{key:"_isValidServiceCommand",value:function(n){return n.endsWith(".*")?this._TRTCCommandList.includes(n):(n=n.split(".")[0],this._TRTCCommandMap.has(n))}},{key:"isTRTCCommand",value:function(n){return n=n.split(".")[0],this._TRTCCommandMap.has(n)}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}]),JI=p(function n(a){u(this,n),this._m=a,this._n="ErrMsgModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()},[{key:"_init",value:function(){var n,a=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(a){try{n=JSON.parse(a)}catch(s){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),K.w("".concat(this._n,"._init error:"),s)}n&&(this._needToUpdate(n)?this._fetch():this._fillMap(n.message))}else this._fetch()}},{key:"_needToUpdate",value:function(s){var a=s.localSavedTime,s=s.localSavedVersion,a=a&&new Date().getTime()-a>=this.STORAGE_EXPIRES_TIME,s=!s||s!=="3.5.4";return K.l("".concat(this._n,"._needToUpdate isTimeout:").concat(a," isDifferentVersion:").concat(s)),a||s}},{key:"_fetch",value:function(){var n,a,s,h,m,I;this._m.get(12).isPrivateNetWork()||(n="https://web.sdk.qcloud.com/im/download/error-message/v3/0.0.7/tim-error-message.txt",a="application/x-www-form-urlencoded;charset=UTF-8",s="".concat(this._n,"._fetch ok in"),h=this,_e?je.request({url:n,method:"GET",timeout:3e3,header:{"content-type":a},dataType:"text",success:function(T){h._fillAndSave(T.data),K.l("".concat(s," mini program"))},fail:function(){}}):(m=new XMLHttpRequest,I=setTimeout(function(){m.abort()},3e3),m.onreadystatechange=function(){m.readyState===4&&(I&&clearTimeout(I),m.status!==200&&m.status!==304||(K.l("".concat(s," browser")),h._fillAndSave(m.responseText)))},m.open("GET",n,!0),m.setRequestHeader("Content-type",a),m.send()))}},{key:"_fillAndSave",value:function(n){this._fillMap(n),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:n,localSavedTime:new Date().getTime(),localSavedVersion:"3.5.4"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.get(13)}},{key:"_fillMap",value:function(n){this._map.clear();for(var a,s,h=n.split(`;
`),m=h.length,I=new RegExp(/'/g),T=0;T<m;T++)if(s=h[T].indexOf(":"),a=h[T].slice(0,s),s=h[T].slice(s+1,h[T].length),!a.startsWith("//")){if(et(s))continue;this._map.set(a,s.replace(I,""))}}},{key:"get",value:function(s){var h=s.isIntl,m=s.key,a=s.replacement1,s=s.replacement2,h="".concat(m,h?"_en":"_cn"),m=(!this._map.has(h)&&this._map.has(m)&&(h=m),"");return this._map.has(h)&&(m=this._map.get(h),et(a)||(m=m.replace("$replacement1",a)),et(s)||(m=m.replace("$replacement2",s))),m}},{key:"reset",value:function(){K.l("".concat(this._n,".reset"))}}]),XI=p(function n(a){u(this,n),this._n="RemoteSignalingHandler",this._sigM=a},[{key:"onNewMessageList",value:function(n){var a=this;n.forEach(function(s){var h=a.getPayloadData(s);h&&a._handleActionType(h,s)})}},{key:"onMessageModified",value:function(n){var a=this;n.forEach(function(s){var h=a.getPayloadData(s);h&&a._onInvitationModified(h,s)})}},{key:"getPayloadData",value:function(s){var a="".concat(this._n,".getPayloadData"),s=s.payload.data;try{return JSON.parse(s)}catch{return K.e("".concat(a," JSON parse error. signalingData:").concat(s)),null}}},{key:"_handleActionType",value:function(n,a){switch(n.actionType){case Q.ACTION_TYPE_INVITE:this._onNewInvitationReceived(n,a);break;case Q.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(n);break;case Q.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(n);break;case Q.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(n);break;case Q.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(n)}}},{key:"_genBaseEmitData",value:function(n){return{inviteID:n.inviteID,inviter:n.inviter,groupID:n.groupID,data:n.data||""}}},{key:"_onNewInvitationReceived",value:function(n,a){var q="".concat(this._n,"._onNewInvitationReceived"),s=n.inviteID,h=n.inviteeList,m=n.groupID,I=n.inviter,T=this._sigM.getMyUserID(),D=h.includes(T),V=n.timeout,$=(qe().getTime()-1e3*a.time)/1e3,q=(0<V&&0<$&&$<V&&(V-=$),"".concat(q," myselfIncluded:").concat(D," groupID:").concat(m," signalObj:").concat(JSON.stringify(n)));K.l("".concat(q," timeout:").concat(V,"s delta:").concat($,"s")),!(m&&D||!m)||(q=this._sigM.getInviteInfo(s))&&q===n||(q||this._sigM.setInviteInfo(s,E(E({},n),{},{message:a})),this._sigM.emitEvent(Q.NEW_INVITATION_RECEIVED,E(E({},this._genBaseEmitData(n)),{},{inviteeList:h})),I!==T&&this._sigM.startTimer(E(E({},n),{},{timeout:V})))}},{key:"_onInviteeRejected",value:function(n){var a="".concat(this._n,"._onInviteeRejected"),s=n.inviteID,h=n.inviter,m=n.groupID,I=this._sigM.hasInviteInfo(s);K.l("".concat(a," inviteID:").concat(s," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(m)),I&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(Q.INVITEE_REJECTED,E(E({},this._genBaseEmitData(n)),{},{invitee:n.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(n){var a="".concat(this._n,"._onInviteeAccepted"),s=n.inviteID,h=n.inviter,m=n.groupID,I=this._sigM.hasInviteInfo(s);K.l("".concat(a," inviteID:").concat(s," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(m)),I&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(Q.INVITEE_ACCEPTED,E(E({},this._genBaseEmitData(n)),{},{invitee:n.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(n){var a="".concat(this._n,"._onInvitationCancelled"),s=n.inviteID,h=n.inviter,m=n.groupID,I=this._sigM.hasInviteInfo(s);K.l("".concat(a," inviteID:").concat(s," hasInviteID:").concat(I," inviter:").concat(h," groupID:").concat(m)),I&&(this._sigM.deleteInviteInfo(s),this._sigM.emitEvent(Q.INVITATION_CANCELLED,this._genBaseEmitData(n)))}},{key:"_onInvitationTimeout",value:function(n){var a="".concat(this._n,"._onInvitationTimeout"),s=n.inviteID,h=n.inviter,m=n.groupID,I=n.inviteeList,T=this._sigM.hasInviteInfo(s);K.l("".concat(a," inviteID:").concat(s," hasInviteID:").concat(T," inviter:").concat(h," groupID:").concat(m,"  data:").concat(n.data)),T&&(this._sigM.updateInviteInfo(n),this._sigM.emitEvent(Q.INVITATION_TIMEOUT,E(E({},this._genBaseEmitData(n)),{},{inviteeList:I,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(n,a){var s="".concat(this._n,"._onInvitationModified"),h=n.inviteID,m=n.data,I=this._sigM.hasInviteInfo(h);K.l("".concat(s," inviteID:").concat(h," hasInviteID:").concat(I," data:").concat(m)),I&&(this._sigM.setInviteInfo(h,E(E({},n),{},{message:a})),this._sigM.emitEvent(Q.INVITATION_MODIFIED,{inviteID:h,data:m}))}}]),iM=p(function n(a){u(this,n),this._n="LocalSignalingHandler",this._sigM=a},[{key:"generateInviteID",value:function(){var n,a=(a=J1)((n=Lu)(32),8)+"-"+a(n(16),4)+"-"+a(16384|n(12),4)+"-"+a(32768|n(14),4)+"-"+a(n(48),12);return K.l("".concat(this._n,".generateInviteID inviteID:").concat(a)),a}},{key:"createInviteInfo",value:function(s){var a=this.generateInviteID(),s=this.createInviteCustomData(E(E({},s),{},{inviteID:a})),m=s.groupID,h=s.inviteeList,m=m||h[0];return{customData:s,message:this._sigM.createSignaling(s,m),inviteID:a}}},{key:"_genBaseCustomData",value:function(h){var a=h.data,s=h.inviteID,h=h.groupID;return{businessID:1,timeout:0,data:a===void 0?"":a,inviteID:s===void 0?"":s,groupID:h===void 0?"":h}}},{key:"createInviteCustomData",value:function(n){var a=n.userID,s=n.timeout,s=s===void 0?0:s,h=n.groupID,h=h===void 0?"":h,m=this._sigM.getMyUserID(),m=E(E({},this._genBaseCustomData(n)),{},{actionType:Q.ACTION_TYPE_INVITE,inviter:m,inviteeList:h?n.inviteeList:[a],timeout:s});return K.l("".concat(this._n,".createInviteCustomData customData:"),m),m}},{key:"createCancelCustomData",value:function(n){var a,s="".concat(this._n,".createCancelCustomData"),T=n.inviteID,h=this._sigM.getMyUserID(),T=this._sigM.getInviteInfo(T),m=T.inviteeList,I=T.groupID,T=T.inviter;return T===h?a=E(E({},this._genBaseCustomData(n)),{},{actionType:Q.ACTION_TYPE_CANCEL_INVITE,groupID:I,inviter:h,inviteeList:m}):K.e("".concat(s," unmatched inviter:").concat(T," and my userID:").concat(h)),K.l("".concat(s," customData:"),a),a}},{key:"createAcceptCustomData",value:function(n){var a,s="".concat(this._n,".createAcceptCustomData"),h=n.inviteID,m=this._sigM.getMyUserID(),I=this._sigM.getInviteInfo(h),T=I.inviter,D=I.groupID;return I.inviteeList.includes(m)?a=E(E({},this._genBaseCustomData(n)),{},{actionType:Q.ACTION_TYPE_ACCEPT_INVITE,groupID:D,inviter:T,inviteeList:[m]}):K.e("".concat(s," userID:").concat(m," not in inviteeList. inviteID:").concat(h," groupID:").concat(D)),K.l("".concat(s," customData:"),a),a}},{key:"createRejectCustomData",value:function(n){var a,s="".concat(this._n,".createRejectCustomData"),h=n.inviteID,m=this._sigM.getMyUserID(),I=this._sigM.getInviteInfo(h),T=I.inviter,D=I.groupID;return I.inviteeList.includes(m)?a=E(E({},this._genBaseCustomData(n)),{},{actionType:Q.ACTION_TYPE_REJECT_INVITE,groupID:D,inviter:T,inviteeList:[m]}):K.e("".concat(s," userID:").concat(m," not in inviteeList. inviteID:").concat(h," groupID:").concat(D)),K.l("".concat(s," customData:"),a),a}},{key:"createTimeoutCustomData",value:function(T){var a="".concat(this._n,".createTimeoutCustomData"),s=T.inviteeList,h=T.inviter,m=T.isInviter,m=m!==void 0&&m,I=this._sigM.getMyUserID(),T=E(E({},this._genBaseCustomData(T)),{},{actionType:Q.ACTION_TYPE_INVITE_TIMEOUT,inviter:h,inviteeList:m?s:[I]});return K.l("".concat(a," customData:"),T),T}}]),aM=p(function n(a){u(this,n),this._n="HistorySignalingHandler",this._sigM=a,this.COUNT=20,this.EXPIRED_TIME=300,this._map=new Map,this._relatedToMeMap=new Map},[{key:"setCloudConfig",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:20,a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:300;this.COUNT=n,this.EXPIRED_TIME=a,K.l("".concat(this._n,".setCloudConfig count:").concat(n,", time:").concat(a))}},{key:"getHistorySignaling",value:function(){var n=this,a=this._sigM.get(11).getLocalConvList();Tt(a)||(this._getC2CSignalingList(),a=this._getValidGroupConvList(a),this._getGroupSignalingList(a).then(function(s){n._handleSignalingList(s)}))}},{key:"_getC2CSignalingList",value:function(){var n=this._sigM.get(6).getMessageListFromUnreadDB(),n=this._sigM.filterMessageList(n);this._getRelatedToMeMap(n)}},{key:"_getGroupSignalingList",value:function(s){var a=this,s=this._createPromiseList(s);return s.length===0?Promise.resolve(this._sortSignaling(this._relatedToMeMap)):this._concurrentGetMessageList(s).then(function(h){var m=new Map;return h.forEach(function(I){I=I.list,I=a._getRelatedToMeMap(I),m=new Map([].concat(P(m),P(I)))}),a._sortSignaling(m)})}},{key:"_handleSignalingList",value:function(n){Tt(n)||this._sigM.onNewMessageList(n)}},{key:"_getValidGroupConvList",value:function(n){for(var a=[],s=0,h=n.length;s<h;s++){var T=n[s],I=T.type,m=T.unreadCount,T=T.lastMessage,I=I===O.CONV_GROUP,T=this._isNotExpired(T);I&&m&&T&&a.push(n[s])}return a}},{key:"_isNotExpired",value:function(n){return!(!n||!n.lastTime)&&n.lastTime>ot()-this.EXPIRED_TIME}},{key:"_createPromiseList",value:function(n){for(var a=[],s=0;s<n.length;s++){var m=n[s],h=m.conversationID,m=m.unreadCount,m=m<this.COUNT?m:this.COUNT,m=(this._map.set(h,{msgCount:m,list:[]}),this._sigM.get(11).getMessageList({conversationID:h}));a.push(m)}return a}},{key:"_concurrentGetMessageList",value:function(n){var a=this,s=[];return Promise.all(n).then(function(h){for(var m=0;m<h.length;m++){var T=h[m],I=T.code,T=T.data;I===0&&T.messageList.length!==0&&(a._handleMessageList(T.messageList),I=a._relayGetMessageList(T))&&s.push(I)}return 0<s.length?a._concurrentGetMessageList(s):a._map})}},{key:"_relayGetMessageList",value:function(m){var a,s=m.messageList,h=m.nextReqMessageID,m=m.isCompleted;return s.length===0||(s=s[0].conversationID,(a=this._map.get(s).msgCount)===0)||m?null:this._sigM.get(11).getMessageList({conversationID:s,nextReqMessageID:h,count:a})}},{key:"_handleMessageList",value:function(n){var a=n.length,s=n[0].conversationID,m=this._map.get(s),h=m.msgCount,m=m.list;this._map.set(s,{msgCount:0<h-a?h-a:0,list:m.concat(this._sigM.filterMessageList(n))})}},{key:"_getRelatedToMeMap",value:function(n){for(var a=0;a<n.length;a++){var s=n[a];this._saveRelatedToMe(s)}return this._relatedToMeMap}},{key:"_saveRelatedToMe",value:function(n){var s=this._sigM.getPayloadData(n)||{},a=s.actionType,s=s.inviteID,h=s===void 0?"":s;switch(a===void 0?"":a){case Q.ACTION_TYPE_INVITE:this._setHistoryInvite(n);break;case Q.ACTION_TYPE_REJECT_INVITE:case Q.ACTION_TYPE_ACCEPT_INVITE:this._updateHistoryInvite(n);break;case Q.ACTION_TYPE_CANCEL_INVITE:this._delHistoryInvite(h);break;case Q.ACTION_TYPE_INVITE_TIMEOUT:this._updateHistoryInvite(n)}}},{key:"_setHistoryInvite",value:function(n){var a=this._sigM.getPayloadData(n)||{},s=a.inviteID,s=s===void 0?"":s,h=a.inviteeList,h=h===void 0?[]:h,m=a.timeout,m=m===void 0?0:m,I=this._sigM.getMyUserID();h.includes(I)&&(h=ot()-n.time,0<m&&m<h&&m!==0||this._relatedToMeMap.set(s,E(E({},a),{},{messageList:[n]})))}},{key:"_delHistoryInvite",value:function(n){this._relatedToMeMap.has(n)&&this._relatedToMeMap.delete(n)}},{key:"_updateHistoryInvite",value:function(n){var s=this._sigM.getPayloadData(n)||{},a=s.inviteID,a=a===void 0?"":a,s=s.inviteeList,h=s===void 0?[]:s;if(this._relatedToMeMap.has(a)){for(var s=this._relatedToMeMap.get(a),m=s.inviteeList,s=s.messageList,I=0;I<h.length;I++){var T=h[I];m.includes(T)&&m.splice(m.indexOf(T),1)}m.length===0?this._delHistoryInvite(a):s.push(n)}else this._delHistoryInvite(a)}},{key:"_sortSignaling",value:function(n){var a=[];return n.forEach(function(s){a=[].concat(P(a),P(s.messageList))}),a.sort(function(s,h){return s.time-h.time})}},{key:"reset",value:function(){this._map.clear(),this._relatedToMeMap.clear()}}]),ZI=p(function n(a,s){u(this,n),this.businessID=a.businessID||1,this.inviteID=a.inviteID,this.groupID=a.groupID||"",this.inviter=a.inviter||"",this.inviteeList=a.inviteeList||[],this.data=a.data||"",this.actionType=a.actionType||Q.ACTION_TYPE_INVITE,this.timeout=a.timeout||0}),sM=["message"],QI=["message"],lM=(S(Nh,$o),p(Nh,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isCloudConfigCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isCloudConfigCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onCloudConfig",value:function(){this._isCloudConfigCompleted=!0;var n=this.getCloudConfig("history_s_count"),a=this.getCloudConfig("history_s_time");et(n)||(n=Number(n)),et(a)||(a=Number(a)),this._historySignalingHandler.setCloudConfig(n,a),this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"_isListenerExisted",value:function(){return-1<this._m.getOEmitInst().eventNames().indexOf(Q.NEW_INVITATION_RECEIVED)}},{key:"onReady",value:function(){this._isSyncCompleted=!0;var n=this._isListenerExisted();K.l("".concat(this._n,".onReady. isListenerExisted: ").concat(n)),n&&this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(n){if(n=this.filterMessageList(n),0<n.length)return this._remoteSignalingHandler.onNewMessageList(n)}},{key:"onMessageModified",value:function(n){if(n=this.filterMessageList(n),0<n.length)return this._remoteSignalingHandler.onMessageModified(n)}},{key:"hasInviteInfo",value:function(n){return this._inviteInfoMap.has(n)}},{key:"getInviteInfo",value:function(n){return this._inviteInfoMap.get(n)}},{key:"setInviteInfo",value:function(n,h){var s=h.message,h=N(h,sM);K.l("".concat(this._n,".setInviteInfo inviteID:").concat(n," data:"),h),this._inviteInfoMap.set(n,E(E({},h),{},{message:s}))}},{key:"deleteInviteInfo",value:function(n){this.hasInviteInfo(n)&&(K.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(n,".")),this._inviteInfoMap.delete(n))}},{key:"updateInviteInfo",value:function(I){var a="".concat(this._n,".updateInviteInfo"),s=I.inviteID,h=I.inviter,m=I.inviteeList,I=I.groupID;K.l("".concat(a," inviteID:").concat(s," inviter:").concat(h," groupID:").concat(I)),I&&this.hasInviteInfo(s)&&(h=m[0],(I=this.getInviteInfo(s).inviteeList).includes(h)&&(I.splice(I.indexOf(h),1),K.l("".concat(a," remove ").concat(h,". localInviteeList.length:").concat(I.length))),I.length!==0)||this.deleteInviteInfo(s)}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(n,a){this.emitOEvt(n,a)}},{key:"addSignalingListener",value:function(n,a,s){this._canIUseSignaling||(this._canIUseSignaling=!0),this._m.getOEmitInst().on(n,a,s)}},{key:"removeSignalingListener",value:function(n,a,s){this._m.getOEmitInst().off(n,a,s),this._isListenerExisted()||(this._canIUseSignaling=!1)}},{key:"invite",value:function(n){var a=this,s="".concat(this._n,".").concat("invite"),h=this._localSignalingHandler.createInviteInfo(n),m=h.message,I=h.customData,T=h.inviteID;return K.l("".concat(s," options:").concat(JSON.stringify(n)," inviteID:").concat(T)),this.sendSignaling(m,n).then(function(D){return D&&D.code===0?(a.setInviteInfo(T,E(E({},I),{},{message:m})),a.startTimer(E(E({},I),{},{inviteID:T})),E(E({},D),{},{inviteID:T})):D}).catch(function(D){return De(D)})}},{key:"inviteSync",value:function(n,a,s){var h=this,m="".concat(this._n,".").concat("inviteSync"),I=this._localSignalingHandler.createInviteInfo(n),T=I.message,D=I.customData,V=I.inviteID;return K.l("".concat(m," options:").concat(JSON.stringify(n)," inviteID:").concat(V)),this.sendSignaling(T,n).then(function($){if($&&$.code===0)return h.setInviteInfo(V,E(E({},D),{},{message:T})),h.startTimer(E(E({},D),{},{inviteID:V})),a&&a({inviteID:V}),{inviteID:V};s&&s($.code===0,$.message||"")}).catch(function($){return s&&s($.code,$.message),De($)}),V}},{key:"_handleImResponse",value:function(n,a,s){a&&a.code===0&&(this._isHandling=!1,s?this.deleteInviteInfo(n.inviteID):this.updateInviteInfo(n))}},{key:"cancel",value:function(n){var a=this,s="".concat(this._n,".").concat("cancel");if(K.l("".concat(s," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return De({code:Je.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var h,m=this._localSignalingHandler.createCancelCustomData(n);return m?(s=m.groupID,h=m.inviteeList,s=s||h[0],h=this.createSignaling(m,s),this.sendSignaling(h,n).then(function(I){return a._handleImResponse(m,I,!0),I.code===0?E(E({},I),{},{inviteID:n.inviteID}):I}).catch(function(I){return De(I)})):(this._isHandling=!1,De({code:Je.SIGNALING_NO_PERMISSION}))}},{key:"accept",value:function(n){var a=this,s="".concat(this._n,".").concat("accept");if(K.l("".concat(s," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return De({code:Je.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var h=this._localSignalingHandler.createAcceptCustomData(n);return h?(s=this.createSignaling(h),this.sendSignaling(s,n).then(function(m){return a._handleImResponse(h,m),m.code===0?E(E({},m),{},{inviteID:n.inviteID}):m}).catch(function(m){return De(m)})):(this._isHandling=!1,De({code:Je.SIGNALING_NO_PERMISSION}))}},{key:"reject",value:function(n){var a=this,s="".concat(this._n,".").concat("reject");if(K.l("".concat(s," options:").concat(JSON.stringify(n))),!this.hasInviteInfo(n.inviteID)||this._isHandling)return De({code:Je.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var h=this._localSignalingHandler.createRejectCustomData(n);return h?(s=this.createSignaling(h),this.sendSignaling(s,n).then(function(m){return a._handleImResponse(h,m,!0),m.code===0?E(E({},m),{},{inviteID:n.inviteID}):m}).catch(function(m){return De(m)})):(this._isHandling=!1,De({code:Je.SIGNALING_NO_PERMISSION}))}},{key:"getSignalingInfo",value:function(D){var a="".concat(this._n,".getSignalingInfo"),s=D.ID,h=D.from,m=D.to,I=this._filterSignaling(D),T=null,D=(I&&(D=this.getPayloadData(D),T=new ZI(D)),I?"actionType:".concat(T.actionType):"");return K.l("".concat(a," messageID:").concat(s," from:").concat(h," to:").concat(m," ")+"".concat(D," isSignaling:").concat(I)),T}},{key:"modifyInvitation",value:function(D){var a,s,h,m,I=this,T=D.inviteID,D=D.data;return this.hasInviteInfo(T)?(a=this.getInviteInfo(T),s=a.message,h=N(a,QI),m=s.payload.data,h.data=D,s.payload.data=JSON.stringify(h),this.get(2).modifyRemoteMessage(s).then(function(V){return I.hasInviteInfo(T)&&I.setInviteInfo(T,E(E({},h),{},{message:s})),V}).catch(function(V){return s.payload.data=m,De(V)})):De({code:Je.SIGNALING_INVALID_INVITE_ID})}},{key:"_genMsgCtrlInfo",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},n=h.data,n=n===void 0?"":n,a=h.onlineUserOnly,I=h.inviteID,I=I===void 0?"":I,s=h.offlinePushInfo,h=h.actionType,m={_onlineOnlyFlag:!1},I={onlineUserOnly:(m=I&&this.getInviteInfo(I)?this.getInviteInfo(I).message:m)._onlineOnlyFlag||a||!1,offlinePushInfo:s,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}};return h===Q.ACTION_TYPE_INVITE_TIMEOUT?(m=!!n.match(/excludeTimeoutSignalingFromHistoryMessage/),I.messageControlInfo.excludedFromUnreadCount=m,I.messageControlInfo.excludedFromLastMessage=m):(a=!!n.match(/excludeFromHistoryMessage/),s=!!n.match(/excludeOriginalSignalingFromHistoryMessage/),I.messageControlInfo.excludedFromUnreadCount=a||s,I.messageControlInfo.excludedFromLastMessage=a||s),I}},{key:"sendSignaling",value:function(n,a){var s=this;return this.get(2).sendMessageInstance(n,this._genMsgCtrlInfo(a)).catch(function(h){return s._isHandling=!1,De(h)})}},{key:"filterMessageList",value:function(n){var a=this;return n.filter(function(s){return a._filterSignaling(s)})}},{key:"getPayloadData",value:function(n){return this._remoteSignalingHandler.getPayloadData(n)}},{key:"createSignaling",value:function(n,h){var s=n.groupID,m=n.inviter,h={to:h||s||m,conversationType:s?O.CONV_GROUP:O.CONV_C2C,priority:O.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(n)}},m=this.get(2).createCustomMessage(h);return K.l("".concat(this._n,".createSignaling. message:"),m),m}},{key:"_filterSignaling",value:function(n){var a,s,h=!1;return n.type&&n.type===O.MSG_CUSTOM&&(a=n.cloudCustomData,n=(n=n.payload.data)===void 0?"":n,a=(a===void 0?"":a).match(/"type":"tsignaling"/),s=n.match(/inviteID/),n=n.match(/actionType/),h=a||s&&n),!!h}},{key:"startTimer",value:function(n){var a,s,h,m=this,I="".concat(this._n,".startTimer"),T=n.timeout,D=n.inviteID,V=n.inviter,$=n.groupID,q=V===this.getMyUserID();K.l("".concat(I," timeout:").concat(T," isInviter:").concat(q," groupID:").concat($)),T<=0||(a=q?T+5:T,s=1,h=setInterval(function(){var se=m._hasLocalInviteInfo(n,q);s<a&&se?++s:(se&&m._sendTimeoutNotice(D,q),K.l("".concat(I," end.")),clearInterval(h))},1e3))}},{key:"_hasLocalInviteInfo",value:function(I,a){var s,h,m=I.inviteID,I=I.groupID;return!!this.hasInviteInfo(m)&&(s="".concat(this._n,"._hasLocalInviteInfo"),h=this.getInviteInfo(m).inviteeList,K.l("".concat(s," inviteID:").concat(m," inviteeList:").concat(h," groupID:").concat(I)),!I||(a?0<h.length:0<h.length&&h.includes(this.getMyUserID())))}},{key:"_getReceiver",value:function(n,m){var s=m.groupID,h=m.inviteeList,m=m.inviter;return n?s||h[0]:s||m}},{key:"_sendTimeoutNotice",value:function(n,a){var s=this,h=this.getInviteInfo(n),m=this._getReceiver(a,h),I=(K.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(n," to:").concat(m," isInviter:").concat(a)),this._localSignalingHandler.createTimeoutCustomData(E(E({},h),{},{isInviter:a}))),T=this.createSignaling(I,m);return this.sendSignaling(T,I).then(function(D){var V,$,q;D&&D.code===0&&(D=I.data,V=I.groupID,$=I.inviteeList,q=I.inviter,s.emitEvent(Q.INVITATION_TIMEOUT,{data:D,groupID:V,inviteID:n,inviteeList:$,inviter:q,isSelfTimeout:!0,message:T}),a?s.deleteInviteInfo(n):s.updateInviteInfo(I))})}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1,this._isCloudConfigCompleted=!1}}])),cM=["followDiffList"],uM=["from"],Ei={NONE:0,FOLLOWERS:1,FOLLOWING:2,MUTUAL:3},eb=(S(Lh,$o),p(Lh,[{key:"_onCloudConfig",value:function(){var n=this.getCloudConfig("follow_req_count");et(n)||(n=Number(n),this.DEFAULT_COUNT=n>this.MAX_COUNT?this.MAX_COUNT:n,this._clearFollowList())}},{key:"clearCacheOnReconnected",value:function(){this._clearFollowList()}},{key:"onFollowNotify",value:function(s){var a=this,s=s.dataList||[];K.l("".concat(this._n,".onFollowNotify followChangeList:").concat(s.length)),s.forEach(function(I){var m=I.followDiffList,m=m===void 0?[]:m,I=N(I,cM),T=I.from,D=N(I,uM);m.forEach(function(q){var $=q.isAdd,q=q.followType,q=q===void 0?0:q,se=a._initFollowInfo();$===1?(D.userID=T,se[q].userInfoList.push(D),se[q].isAdd=!0):(se[q].userInfoList.push(T),se[q].isAdd=!1),a._emitEvent(se)})})}},{key:"_initFollowInfo",value:function(){var n={};return Object.values(Ei).forEach(function(a){a!==Ei.NONE&&(n[a]={userInfoList:[],isAdd:!1})}),n}},{key:"_emitEvent",value:function(n){var a=this;Object.keys(n).forEach(function(h){var h=Number(h),m=n[h];0<m.userInfoList.length&&(h===Ei.FOLLOWERS&&(a._clearFollowList(Ei.FOLLOWERS),a.emitOEvt(W.MY_FOLLOWERS_LIST_UPDATED,m)),h===Ei.FOLLOWING&&(a._clearFollowList(Ei.FOLLOWING),a.emitOEvt(W.MY_FOLLOWING_LIST_UPDATED,m)),h===Ei.MUTUAL)&&(a._clearFollowList(Ei.MUTUAL),a.emitOEvt(W.MUTUAL_FOLLOWERS_LIST_UPDATED,m))})}},{key:"followUser",value:function(n){var a,s,h;return this.canIUse(ye.FOLLOW)?(a="".concat(this._n,".").concat("followUser"),s="userIDList:".concat(n.length),(h=new ct("followUser")).setMessage(s),K.l("".concat(a," ").concat(s)),this.req({P:de.FOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:n.map(function(m){return{userID:m}})}}).then(function(m){return h.end(),K.l("".concat(a," ok.")),Kt(m.data.resultList)}).catch(function(m){return h.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})):this.noUse("followUser")}},{key:"unfollowUser",value:function(n){var a,s,h;return this.canIUse(ye.FOLLOW)?(a="".concat(this._n,".").concat("unfollowUser"),s="userIDList:".concat(n.length),(h=new ct("unfollowUser")).setMessage(s),K.l("".concat(a," ").concat(s)),this.req({P:de.UNFOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:n}}).then(function(m){return h.end(),K.l("".concat(a," ok.")),Kt(m.data.resultList)}).catch(function(m){return h.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})):this.noUse("unfollowUser")}},{key:"getMyFollowersList",value:function(){var n=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",s="getMyFollowersList";if(!this.canIUse(ye.FOLLOW))return this.noUse(s);var h=a||this.FIRST_PAGE_INDEX;if(this._myFollowersList.has(h)){var T=this._myFollowersList.get(h),m=T.resultList,I=T.nextCursor,T=T.lastUpdateTime;if(Date.now()-T<this.MAX_CATCH_TIME&&0<m.length)return K.l("".concat(this._n,".").concat(s," nextCursor:").concat(a," from local.")),ln({resultList:m,nextCursor:I})}return this._getFollowList(a,Ei.FOLLOWERS).then(function(D){return n._myFollowersList.set(h,E(E({},D),{},{lastUpdateTime:Date.now()})),K.l("".concat(n._n,".").concat(s," nextCursor:").concat(a," from remote.")),Kt(D)})}},{key:"getMyFollowingList",value:function(){var n=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",s="getMyFollowingList";if(!this.canIUse(ye.FOLLOW))return this.noUse(s);var h=a||this.FIRST_PAGE_INDEX;if(this._myFollowingList.has(h)){var T=this._myFollowingList.get(h),m=T.resultList,I=T.nextCursor,T=T.lastUpdateTime;if(Date.now()-T<this.MAX_CATCH_TIME&&0<m.length)return K.l("".concat(this._n,".").concat(s," nextCursor:").concat(a," from local.")),ln({resultList:m,nextCursor:I})}return this._getFollowList(a,Ei.FOLLOWING).then(function(D){return n._myFollowingList.set(h,E(E({},D),{},{lastUpdateTime:Date.now()})),K.l("".concat(n._n,".").concat(s," nextCursor:").concat(a," from remote.")),Kt(D)})}},{key:"getMutualFollowersList",value:function(){var n=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",s="getMutualFollowersList";if(!this.canIUse(ye.FOLLOW))return this.noUse(s);var h=a||this.FIRST_PAGE_INDEX;if(this._myMutualFollowersList.has(h)){var T=this._myMutualFollowersList.get(h),m=T.resultList,I=T.nextCursor,T=T.lastUpdateTime;if(Date.now()-T<this.MAX_CATCH_TIME&&0<m.length)return K.l("".concat(this._n,".").concat(s," nextCursor:").concat(a," from local.")),ln({resultList:m,nextCursor:I})}return this._getFollowList(a,Ei.MUTUAL).then(function(D){return n._myMutualFollowersList.set(h,E(E({},D),{},{lastUpdateTime:Date.now()})),K.l("".concat(n._n,".").concat(s," nextCursor:").concat(a," from remote.")),Kt(D)})}},{key:"_getFollowList",value:function(n,a){var s=this,h=new ct("_getFollowList");return h.setMessage("nextCursor:".concat(n," type:").concat(a)),this.req({P:de.GET_FOLLOW,data:{fromAccount:this.getMyUserID(),count:this.DEFAULT_COUNT,nextCursor:n,type:a}}).then(function(T){h.end();var T=T.data,I=T.resultList,I=I===void 0?[]:I,T=T.nextCursor,T=T===void 0?"":T,D=[];return I.forEach(function(se){var $=se.userID,q=se.followTime,se=se.profileList;D.push(E({userID:$,followTime:q},s._handleProfileItem(se===void 0?[]:se)))}),{resultList:D,nextCursor:T}}).catch(function(m){return h.setError(m).end(),K.e("".concat(s._n,"._getFollowList failed. error:"),m),De(m)})}},{key:"_handleProfileItem",value:function(n){var a={};return n.forEach(function(s){switch(s.tag){case Gt.NICK:a.nick=s.value;break;case Gt.GENDER:a.gender=s.value;break;case Gt.BIRTHDAY:a.birthday=s.value;break;case Gt.LOCATION:a.location=s.value;break;case Gt.SELFSIGNATURE:a.selfSignature=s.value;break;case Gt.ALLOWTYPE:a.allowType=s.value;break;case Gt.LANGUAGE:a.language=s.value;break;case Gt.AVATAR:a.avatar=s.value;break;case Gt.MESSAGESETTINGS:a.messageSettings=s.value;break;case Gt.ADMINFORBIDTYPE:a.adminForbidType=s.value;break;case Gt.LEVEL:a.level=s.value;break;case Gt.ROLE:a.role=s.value;break;default:a[s.tag]=s.value}}),a}},{key:"getUserFollowInfo",value:function(n){var a,s,h;return this.canIUse(ye.FOLLOW)?(s=!1,et(n=n)&&(n=[this.getMyUserID()],s=!0),a="".concat(this._n,".").concat("getUserFollowInfo"),s="userIDList:".concat(n.length," isGetMyFollowInfo:").concat(s),(h=new ct("getUserFollowInfo")).setMessage(s),K.l("".concat(a," ").concat(s)),this.req({P:de.GET_FOLLOW_INFO,data:{fromAccount:this.getMyUserID(),userIDList:n}}).then(function(I){h.end(),K.l("".concat(a," ok."));var I=I.data.followInfoList,T=[];return(I===void 0?[]:I).forEach(function(q){var V=q.followersCount,$=q.followingCount,q=q.mutualFollowersCount;T.push({followersCount:V,followingCount:$,mutualFollowersCount:q})}),Kt(T)}).catch(function(m){return h.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})):this.noUse("getUserFollowInfo")}},{key:"checkFollowType",value:function(n){if(!this.canIUse(ye.FOLLOW))return this.noUse("checkFollowType");100<n.length&&(n=n.slice(0,100),K.w("".concat(a," ").concat(lc(100))));var a="".concat(this._n,".").concat("checkFollowType"),s="userIDList length:".concat(n.length," "),h=new ct("checkFollowType");return h.setMessage(s),K.l("".concat(a," ").concat(s)),this.req({P:de.CHECK_FOLLOW_TYPE,data:{fromAccount:this.getMyUserID(),userIDList:n}}).then(function(I){h.end(),K.l("".concat(a," ok."));var I=I.data.resultList,T=[];return(I===void 0?[]:I).forEach(function($){var V=$.userID,$=$.followType;T.push({userID:V,followType:$})}),Kt(T)}).catch(function(m){return h.setError(m).end(),K.e("".concat(a," failed. error:"),m),De(m)})}},{key:"_clearFollowList",value:function(n){et(n)?(this._myFollowersList.clear(),this._myFollowingList.clear(),this._myMutualFollowersList.clear()):n!==Ei.FOLLOWERS?n!==Ei.FOLLOWING?n===Ei.MUTUAL&&this._myMutualFollowersList.clear():this._myFollowingList.clear():this._myFollowersList.clear()}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._clearFollowList()}}])),Ao=Au(function(n,a){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(I){for(var T,D,V=Array.prototype.slice.call(arguments,1);V.length;){var $=V.shift();if($){if(H($)!=="object")throw new TypeError($+"must be non-object");for(var q in $)T=$,D=q,Object.prototype.hasOwnProperty.call(T,D)&&(I[q]=$[q])}}return I},a.shrinkBuf=function(I,T){return I.length===T?I:I.subarray?I.subarray(0,T):(I.length=T,I)};var h={arraySet:function(I,T,D,V,$){if(T.subarray&&I.subarray)I.set(T.subarray(D,D+V),$);else for(var q=0;q<V;q++)I[$+q]=T[D+q]},flattenChunks:function(I){for(var T,D,V,$=0,q=0,se=I.length;q<se;q++)$+=I[q].length;for(V=new Uint8Array($),q=T=0,se=I.length;q<se;q++)D=I[q],V.set(D,T),T+=D.length;return V}},m={arraySet:function(I,T,D,V,$){for(var q=0;q<V;q++)I[$+q]=T[D+q]},flattenChunks:function(I){return[].concat.apply([],I)}};a.setTyped=function(I){I?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,h)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,m))},a.setTyped(s)});function Lh(n){return u(this,Lh),(n=c(this,Lh,[n]))._n="FollowModule",n._myFollowersList=new Map,n._myFollowingList=new Map,n._myMutualFollowersList=new Map,n.MAX_CATCH_TIME=6e5,n.FIRST_PAGE_INDEX=Yn(),n.DEFAULT_COUNT=500,n.MAX_COUNT=1e3,n.getIEmitInst().on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function Nh(n){u(this,Nh),(n=c(this,Nh,[n]))._n="SignalingModule",n._inviteInfoMap=new Map,n._canIUseSignaling=!1,n._isHandling=!1,n._remoteSignalingHandler=new XI(n),n._localSignalingHandler=new iM(n),n._historySignalingHandler=new aM(n),n._isC2CUnreadHandleCompleted=!1,n._isConvSyncCompleted=!1,n._isSyncCompleted=!1,n._isCloudConfigCompleted=!1;var a=n.getIEmitInst();return a.on(So.C2C_UNREAD_HANDLE_COMPLETED,n.onC2CUnreadHandleCompleted,n),a.on(So.CONV_SYNC_COMPLETED,n.onConvSyncCompleted,n),a.on(So.CLOUD_CONFIG,n.onCloudConfig,n),n}function Ph(n){return u(this,Ph),(n=c(this,Ph,[n]))._n="ProfanityFilterModule",n._plugin=null,n._filterConfigMap=new Map,n._startIndex=0,n._version=0,n._canIUseLexicon=!1,n._isFetching=!1,n._expiredTime=0,n}function xh(n){var a;return u(this,xh),(a=c(this,xh,[n]))._m=n,a._n="TIMPushModule",a._pluginName="TIMPush",a._pushPlugin=void 0,a._androidPushConfig={},a._deviceToken="",a._businessID=0,a._iOSBusinessID=0,a._c2cUnreadCount=0,a._groupUnreadCount=0,a._isWebUniapp=0,a._deviceInfo={notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:"1.0.1",packageName:""},a}function tm(n){var a;return u(this,tm),(a=c(this,tm,[n]))._m=n,a._n="OfflinePushModule",a._offlinePushPlugin=void 0,a._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},a._deviceToken="",a._businessID=0,a._iosBusinessID=0,a._c2cUnreadCount=0,a._groupUnreadCount=0,a._isWebUniapp=0,a}function Cl(n){return u(this,Cl),(n=c(this,Cl,[n]))._n="WorkerTimerModule",n._isWorkerEnabled=!0,n._workerTimer=null,n._timerID=-1,n._init(),n.getIEmitInst().on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function Nu(n){return u(this,Nu),(n=c(this,Nu,[n]))._n="SnsModule",n._friendHandler=new KI(n),n._friendApplicationHandler=new nM(n),n._friendGroupHandler=new Dh(n),n.getIEmitInst().on(So.A2KEY_AND_TINYID_UPDATED,n.onContextUpdated,n),n}function Uh(n){u(this,Uh),(n=c(this,Uh,[n]))._n="QualityStatModule",n.TAG="im-ssolog-quality-stat",n.reportIndex=0,n.wholePeriod=!1,n._qualityItems=[yh,Eu,as,Gs,uc,Fa,Si,dc,Ih,ss],n._messageSentItems=[as,Gs,uc,Fa,Si],n._messageReceivedItems=[dc,Ih,ss],n.REPORT_INTERVAL=120,n.REPORT_SDKAPPID_BLACKLIST=[],n.REPORT_TINYID_WHITELIST=[],n._statInfoArr=[],n._avgRTT=new $I,n._avgE2EDelay=new HI,n._rateMessageSent=new eM,n._rateMessageReceived=new tM;var a=n.getIEmitInst();return a.on(So.A2KEY_AND_TINYID_UPDATED,n._onLoginSuccess,n),a.on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}function Pu(n){return u(this,Pu),(n=c(this,Pu,[n]))._n="RecoverMsgModule",n.PULL_LIMIT_COUNT=15,n}function Fh(n){return u(this,Fh),(n=c(this,Fh,[n]))._n="CloudControlModule",n._cloudConfig=new Map,n._expiredTime=0,n._version=0,n._isFetching=!1,n}function xu(n){return u(this,xu),(n=c(this,xu,[n]))._n="SessionModule",n._platform=n.getPlatform(),n._pHandler=new W1(n),n._msgDispatcher=new j1(n),n._cmdFreqLimitMap=new Map,n._cmdReqInfoMap=new Map,n._serverOverloadInfoMap=new Map,n._incrementalPullContactFlag=!0,n._init(),n.getIEmitInst().on(So.CLOUD_CONFIG,n._onCloudConfig,n),n}Ao.assign,Ao.shrinkBuf,Ao.setTyped,Ao.Buf8,Ao.Buf16,Ao.Buf32;function nm(n,a,s,h){for(var m=65535&n|0,I=n>>>16&65535|0,T=0;s!==0;){for(s-=T=2e3<s?2e3:s;I=I+(m=m+a[h++]|0)|0,--T;);m%=65521,I%=65521}return m|I<<16|0}function ma(n,a,s,h){var m=tb,I=h+s;n^=-1;for(var T=h;T<I;T++)n=n>>>8^m[255&(n^a[T])];return-1^n}function Bs(n,a,s,h,m,I,T,D){for(var V,$,q,se,me,fe,He,Xe,Ye,Lt=D.bits,Qn=0,yt=0,rn=0,on=0,Pn=0,Gn=0,Jn=0,qo=0,ko=0,yo=0,Ko=null,$s=0,Po=new Ao.Buf16(16),tr=new Ao.Buf16(16),Dr=null,Xn=0,Qn=0;Qn<=15;Qn++)Po[Qn]=0;for(yt=0;yt<h;yt++)Po[a[s+yt]]++;for(Pn=Lt,on=15;1<=on&&Po[on]===0;on--);if(on<Pn&&(Pn=on),on===0)m[I++]=20971520,m[I++]=20971520,D.bits=1;else{for(rn=1;rn<on&&Po[rn]===0;rn++);for(Pn<rn&&(Pn=rn),Qn=qo=1;Qn<=15;Qn++)if((qo=(qo<<1)-Po[Qn])<0)return-1;if(0<qo&&(n===0||on!==1))return-1;for(tr[1]=0,Qn=1;Qn<15;Qn++)tr[Qn+1]=tr[Qn]+Po[Qn];for(yt=0;yt<h;yt++)a[s+yt]!==0&&(T[tr[a[s+yt]]++]=yt);if(fe=n===0?(Ko=Dr=T,19):n===1?(Ko=dM,$s-=257,Dr=gc,Xn-=257,256):(Ko=hM,Dr=fM,-1),Qn=rn,me=I,Jn=yt=yo=0,q=-1,se=(ko=1<<(Gn=Pn))-1,n===1&&852<ko||n===2&&592<ko)return 1;for(;;){for(Ye=T[yt]<fe?(Xe=0,T[yt]):T[yt]>fe?(Xe=Dr[Xn+T[yt]],Ko[$s+T[yt]]):(Xe=96,0),V=1<<(He=Qn-Jn),rn=$=1<<Gn;m[me+(yo>>Jn)+($-=V)]=He<<24|Xe<<16|Ye|0,$!==0;);for(V=1<<Qn-1;yo&V;)V>>=1;if(V!==0?yo=(yo&V-1)+V:yo=0,yt++,--Po[Qn]==0){if(Qn===on)break;Qn=a[s+T[yt]]}if(Pn<Qn&&(yo&se)!==q){for(me+=rn,qo=1<<(Gn=Qn-(Jn=Jn===0?Pn:Jn));Gn+Jn<on&&!((qo-=Po[Gn+Jn])<=0);)Gn++,qo<<=1;if(ko+=1<<Gn,n===1&&852<ko||n===2&&592<ko)return 1;m[q=yo&se]=Pn<<24|Gn<<16|me-I|0}}yo!==0&&(m[me+yo]=Qn-Jn<<24|64<<16|0),D.bits=Pn}return 0}var tb=function(){for(var n=[],a=0;a<256;a++){for(var s=a,h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;n[a]=s}return n}(),dM=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],gc=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],hM=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],fM=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function nb(n){return(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24)}function ob(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ao.Buf16(320),this.work=new Ao.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Vh(n){var a;return n&&n.state?(a=n.state,n.total_in=n.total_out=a.total=0,n.msg="",a.wrap&&(n.adler=1&a.wrap),a.mode=1,a.last=0,a.havedict=0,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Ao.Buf32(852),a.distcode=a.distdyn=new Ao.Buf32(592),a.sane=1,a.back=-1,0):-2}function rb(n){var a;return n&&n.state?((a=n.state).wsize=0,a.whave=0,a.wnext=0,Vh(n)):-2}function ib(n,a){var s,h;return!n||!n.state||(h=n.state,a<0?(s=0,a=-a):(s=1+(a>>4),a<48&&(a&=15)),a&&(a<8||15<a))?-2:(h.window!==null&&h.wbits!==a&&(h.window=null),h.wrap=s,h.wbits=a,rb(n))}function Uu(n,a){var s;return n?(s=new ob,(n.state=s).window=null,(s=ib(n,a))!==0&&(n.state=null),s):-2}var om,Qv,ab=!0;function Gh(I,a,s,h){var m,I=I.state;return I.window===null&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new Ao.Buf8(I.wsize)),h>=I.wsize?(Ao.arraySet(I.window,a,s-I.wsize,I.wsize,0),I.wnext=0,I.whave=I.wsize):((m=I.wsize-I.wnext)>h&&(m=h),Ao.arraySet(I.window,a,s-h,m,I.wnext),(h-=m)?(Ao.arraySet(I.window,a,s-h,h,0),I.wnext=h,I.whave=I.wsize):(I.wnext+=m,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=m))),0}var Fu={inflateReset:rb,inflateReset2:ib,inflateResetKeep:Vh,inflateInit:function(n){return Uu(n,15)},inflateInit2:Uu,inflate:function(n,a){var s,h,m,I,T,D,V,$,q,se,me,fe,He,Xe,Ye,Lt,yt,rn,on,Pn,Gn,Jn,qo,ko,yo=0,Ko=new Ao.Buf8(4),$s=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return-2;(s=n.state).mode===12&&(s.mode=13),T=n.next_out,m=n.output,V=n.avail_out,I=n.next_in,h=n.input,D=n.avail_in,$=s.hold,q=s.bits,se=D,me=V,Jn=0;e:for(;;)switch(s.mode){case 1:if(s.wrap===0)s.mode=13;else{for(;q<16;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(2&s.wrap&&$===35615)Ko[s.check=0]=255&$,Ko[1]=$>>>8&255,s.check=ma(s.check,Ko,2,0),q=$=0,s.mode=2;else if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&$)<<8)+($>>8))%31)n.msg="incorrect header check",s.mode=30;else if((15&$)!=8)n.msg="unknown compression method",s.mode=30;else{if(q-=4,Gn=8+(15&($>>>=4)),s.wbits===0)s.wbits=Gn;else if(Gn>s.wbits){n.msg="invalid window size",s.mode=30;break}s.dmax=1<<Gn,n.adler=s.check=1,s.mode=512&$?10:12,q=$=0}}break;case 2:for(;q<16;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(s.flags=$,(255&s.flags)!=8){n.msg="unknown compression method",s.mode=30;break}if(57344&s.flags){n.msg="unknown header flags set",s.mode=30;break}s.head&&(s.head.text=$>>8&1),512&s.flags&&(Ko[0]=255&$,Ko[1]=$>>>8&255,s.check=ma(s.check,Ko,2,0)),q=$=0,s.mode=3;case 3:for(;q<32;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.head&&(s.head.time=$),512&s.flags&&(Ko[0]=255&$,Ko[1]=$>>>8&255,Ko[2]=$>>>16&255,Ko[3]=$>>>24&255,s.check=ma(s.check,Ko,4,0)),q=$=0,s.mode=4;case 4:for(;q<16;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.head&&(s.head.xflags=255&$,s.head.os=$>>8),512&s.flags&&(Ko[0]=255&$,Ko[1]=$>>>8&255,s.check=ma(s.check,Ko,2,0)),q=$=0,s.mode=5;case 5:if(1024&s.flags){for(;q<16;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.length=$,s.head&&(s.head.extra_len=$),512&s.flags&&(Ko[0]=255&$,Ko[1]=$>>>8&255,s.check=ma(s.check,Ko,2,0)),q=$=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&((fe=(fe=s.length)>D?D:fe)&&(s.head&&(Gn=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Array(s.head.extra_len)),Ao.arraySet(s.head.extra,h,I,fe,Gn)),512&s.flags&&(s.check=ma(s.check,h,fe,I)),D-=fe,I+=fe,s.length-=fe),s.length))break e;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(D===0)break e;for(fe=0;Gn=h[I+fe++],s.head&&Gn&&s.length<65536&&(s.head.name+=String.fromCharCode(Gn)),Gn&&fe<D;);if(512&s.flags&&(s.check=ma(s.check,h,fe,I)),D-=fe,I+=fe,Gn)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(D===0)break e;for(fe=0;Gn=h[I+fe++],s.head&&Gn&&s.length<65536&&(s.head.comment+=String.fromCharCode(Gn)),Gn&&fe<D;);if(512&s.flags&&(s.check=ma(s.check,h,fe,I)),D-=fe,I+=fe,Gn)break e}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;q<16;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if($!==(65535&s.check)){n.msg="header crc mismatch",s.mode=30;break}q=$=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),n.adler=s.check=0,s.mode=12;break;case 10:for(;q<32;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}n.adler=s.check=nb($),q=$=0,s.mode=11;case 11:if(s.havedict===0)return n.next_out=T,n.avail_out=V,n.next_in=I,n.avail_in=D,s.hold=$,s.bits=q,2;n.adler=s.check=1,s.mode=12;case 12:if(a===5||a===6)break e;case 13:if(s.last)$>>>=7&q,q-=7&q,s.mode=27;else{for(;q<3;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}switch(s.last=1&$,--q,3&($>>>=1)){case 0:s.mode=14;break;case 1:Po=tr=void 0;var Po,tr=s;if(ab){for(om=new Ao.Buf32(512),Qv=new Ao.Buf32(32),Po=0;Po<144;)tr.lens[Po++]=8;for(;Po<256;)tr.lens[Po++]=9;for(;Po<280;)tr.lens[Po++]=7;for(;Po<288;)tr.lens[Po++]=8;for(Bs(1,tr.lens,0,288,om,0,tr.work,{bits:9}),Po=0;Po<32;)tr.lens[Po++]=5;Bs(2,tr.lens,0,32,Qv,0,tr.work,{bits:5}),ab=!1}if(tr.lencode=om,tr.lenbits=9,tr.distcode=Qv,tr.distbits=5,s.mode=20,a!==6)break;$>>>=2,q-=2;break e;case 2:s.mode=17;break;case 3:n.msg="invalid block type",s.mode=30}$>>>=2,q-=2}break;case 14:for($>>>=7&q,q-=7&q;q<32;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if((65535&$)!=($>>>16^65535)){n.msg="invalid stored block lengths",s.mode=30;break}if(s.length=65535&$,q=$=0,s.mode=15,a===6)break e;case 15:s.mode=16;case 16:if(fe=s.length){if((fe=V<(fe=D<fe?D:fe)?V:fe)===0)break e;Ao.arraySet(m,h,I,fe,T),D-=fe,I+=fe,V-=fe,T+=fe,s.length-=fe}else s.mode=12;break;case 17:for(;q<14;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(s.nlen=257+(31&$),$>>>=5,q-=5,s.ndist=1+(31&$),$>>>=5,q-=5,s.ncode=4+(15&$),$>>>=4,q-=4,286<s.nlen||30<s.ndist){n.msg="too many length or distance symbols",s.mode=30;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;q<3;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.lens[$s[s.have++]]=7&$,$>>>=3,q-=3}for(;s.have<19;)s.lens[$s[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,qo={bits:s.lenbits},Jn=Bs(0,s.lens,0,19,s.lencode,0,s.work,qo),s.lenbits=qo.bits,Jn){n.msg="invalid code lengths set",s.mode=30;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;Lt=(yo=s.lencode[$&(1<<s.lenbits)-1])>>>16&255,yt=65535&yo,!((Ye=yo>>>24)<=q);){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(yt<16)$>>>=Ye,q-=Ye,s.lens[s.have++]=yt;else{if(yt===16){for(ko=Ye+2;q<ko;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if($>>>=Ye,q-=Ye,s.have===0){n.msg="invalid bit length repeat",s.mode=30;break}Gn=s.lens[s.have-1],fe=3+(3&$),$>>>=2,q-=2}else if(yt===17){for(ko=Ye+3;q<ko;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}Gn=0,fe=3+(7&($>>>=Ye)),$>>>=3,q=q-Ye-3}else{for(ko=Ye+7;q<ko;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}Gn=0,fe=11+(127&($>>>=Ye)),$>>>=7,q=q-Ye-7}if(s.have+fe>s.nlen+s.ndist){n.msg="invalid bit length repeat",s.mode=30;break}for(;fe--;)s.lens[s.have++]=Gn}}if(s.mode===30)break;if(s.lens[256]===0){n.msg="invalid code -- missing end-of-block",s.mode=30;break}if(s.lenbits=9,qo={bits:s.lenbits},Jn=Bs(1,s.lens,0,s.nlen,s.lencode,0,s.work,qo),s.lenbits=qo.bits,Jn){n.msg="invalid literal/lengths set",s.mode=30;break}if(s.distbits=6,s.distcode=s.distdyn,qo={bits:s.distbits},Jn=Bs(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,qo),s.distbits=qo.bits,Jn){n.msg="invalid distances set",s.mode=30;break}if(s.mode=20,a===6)break e;case 20:s.mode=21;case 21:if(6<=D&&258<=V){n.next_out=T,n.avail_out=V,n.next_in=I,n.avail_in=D,s.hold=$,s.bits=q,nr=qs=Ba=Yo=Ga=Qn=Xn=Dr=mb=pb=r_=$h=or=Lr=va=kl=fb=lm=o_=_c=sm=Do=Gu=mi=Or=void 0;var Dr,Xn,Qn,Ga,Yo,Ba,ti=n,n_=me,Or=ti.state,mi=ti.next_in,qs=ti.input,Gu=mi+(ti.avail_in-5),Do=ti.next_out,nr=ti.output,sm=Do-(n_-ti.avail_out),_c=Do+(ti.avail_out-257),o_=Or.dmax,lm=Or.wsize,fb=Or.whave,kl=Or.wnext,va=Or.window,Lr=Or.hold,or=Or.bits,$h=Or.lencode,r_=Or.distcode,pb=(1<<Or.lenbits)-1,mb=(1<<Or.distbits)-1;t:do for(or<15&&(Lr+=qs[mi++]<<or,or+=8,Lr+=qs[mi++]<<or,or+=8),Dr=$h[Lr&pb];;){if(Lr>>>=Xn=Dr>>>24,or-=Xn,(Xn=Dr>>>16&255)==0)nr[Do++]=65535&Dr;else{if(!(16&Xn)){if(!(64&Xn)){Dr=$h[(65535&Dr)+(Lr&(1<<Xn)-1)];continue}if(32&Xn){Or.mode=12;break t}ti.msg="invalid literal/length code",Or.mode=30;break t}for(Qn=65535&Dr,(Xn&=15)&&(or<Xn&&(Lr+=qs[mi++]<<or,or+=8),Qn+=Lr&(1<<Xn)-1,Lr>>>=Xn,or-=Xn),or<15&&(Lr+=qs[mi++]<<or,or+=8,Lr+=qs[mi++]<<or,or+=8),Dr=r_[Lr&mb];;){if(Lr>>>=Xn=Dr>>>24,or-=Xn,!(16&(Xn=Dr>>>16&255))){if(!(64&Xn)){Dr=r_[(65535&Dr)+(Lr&(1<<Xn)-1)];continue}ti.msg="invalid distance code",Or.mode=30;break t}if(Ga=65535&Dr,or<(Xn&=15)&&(Lr+=qs[mi++]<<or,(or+=8)<Xn)&&(Lr+=qs[mi++]<<or,or+=8),(Ga+=Lr&(1<<Xn)-1)>o_){ti.msg="invalid distance too far back",Or.mode=30;break t}if(Lr>>>=Xn,or-=Xn,Ga>(Xn=Do-sm)){if((Xn=Ga-Xn)>fb&&Or.sane){ti.msg="invalid distance too far back",Or.mode=30;break t}if(Ba=va,(Yo=0)===kl){if(Yo+=lm-Xn,Xn<Qn){for(Qn-=Xn;nr[Do++]=va[Yo++],--Xn;);Yo=Do-Ga,Ba=nr}}else if(kl<Xn){if(Yo+=lm+kl-Xn,(Xn-=kl)<Qn){for(Qn-=Xn;nr[Do++]=va[Yo++],--Xn;);if(Yo=0,kl<Qn){for(Qn-=Xn=kl;nr[Do++]=va[Yo++],--Xn;);Yo=Do-Ga,Ba=nr}}}else if(Yo+=kl-Xn,Xn<Qn){for(Qn-=Xn;nr[Do++]=va[Yo++],--Xn;);Yo=Do-Ga,Ba=nr}for(;2<Qn;)nr[Do++]=Ba[Yo++],nr[Do++]=Ba[Yo++],nr[Do++]=Ba[Yo++],Qn-=3;Qn&&(nr[Do++]=Ba[Yo++],1<Qn)&&(nr[Do++]=Ba[Yo++])}else{for(Yo=Do-Ga;nr[Do++]=nr[Yo++],nr[Do++]=nr[Yo++],nr[Do++]=nr[Yo++],2<(Qn-=3););Qn&&(nr[Do++]=nr[Yo++],1<Qn)&&(nr[Do++]=nr[Yo++])}break}}break}while(mi<Gu&&Do<_c);mi-=Qn=or>>3,Lr&=(1<<(or-=Qn<<3))-1,ti.next_in=mi,ti.next_out=Do,ti.avail_in=mi<Gu?Gu-mi+5:5-(mi-Gu),ti.avail_out=Do<_c?_c-Do+257:257-(Do-_c),Or.hold=Lr,Or.bits=or,T=n.next_out,m=n.output,V=n.avail_out,I=n.next_in,h=n.input,D=n.avail_in,$=s.hold,q=s.bits,s.mode===12&&(s.back=-1);break}for(s.back=0;Lt=(yo=s.lencode[$&(1<<s.lenbits)-1])>>>16&255,yt=65535&yo,!((Ye=yo>>>24)<=q);){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(Lt&&!(240&Lt)){for(rn=Ye,on=Lt,Pn=yt;Lt=(yo=s.lencode[Pn+(($&(1<<rn+on)-1)>>rn)])>>>16&255,yt=65535&yo,!(rn+(Ye=yo>>>24)<=q);){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}$>>>=rn,q-=rn,s.back+=rn}if($>>>=Ye,q-=Ye,s.back+=Ye,s.length=yt,Lt===0){s.mode=26;break}if(32&Lt){s.back=-1,s.mode=12;break}if(64&Lt){n.msg="invalid literal/length code",s.mode=30;break}s.extra=15&Lt,s.mode=22;case 22:if(s.extra){for(ko=s.extra;q<ko;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.length+=$&(1<<s.extra)-1,$>>>=s.extra,q-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;Lt=(yo=s.distcode[$&(1<<s.distbits)-1])>>>16&255,yt=65535&yo,!((Ye=yo>>>24)<=q);){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if(!(240&Lt)){for(rn=Ye,on=Lt,Pn=yt;Lt=(yo=s.distcode[Pn+(($&(1<<rn+on)-1)>>rn)])>>>16&255,yt=65535&yo,!(rn+(Ye=yo>>>24)<=q);){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}$>>>=rn,q-=rn,s.back+=rn}if($>>>=Ye,q-=Ye,s.back+=Ye,64&Lt){n.msg="invalid distance code",s.mode=30;break}s.offset=yt,s.extra=15&Lt,s.mode=24;case 24:if(s.extra){for(ko=s.extra;q<ko;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}s.offset+=$&(1<<s.extra)-1,$>>>=s.extra,q-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){n.msg="invalid distance too far back",s.mode=30;break}s.mode=25;case 25:if(V===0)break e;if(s.offset>(fe=me-V)){if((fe=s.offset-fe)>s.whave&&s.sane){n.msg="invalid distance too far back",s.mode=30;break}He=fe>s.wnext?(fe-=s.wnext,s.wsize-fe):s.wnext-fe,fe>s.length&&(fe=s.length),Xe=s.window}else Xe=m,He=T-s.offset,fe=s.length;for(V-=fe=V<fe?V:fe,s.length-=fe;m[T++]=Xe[He++],--fe;);s.length===0&&(s.mode=21);break;case 26:if(V===0)break e;m[T++]=s.length,V--,s.mode=21;break;case 27:if(s.wrap){for(;q<32;){if(D===0)break e;D--,$|=h[I++]<<q,q+=8}if(me-=V,n.total_out+=me,s.total+=me,me&&(n.adler=s.check=(s.flags?ma:nm)(s.check,m,me,T-me)),me=V,(s.flags?$:nb($))!==s.check){n.msg="incorrect data check",s.mode=30;break}q=$=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;q<32;){if(D===0)break e;D--,$+=h[I++]<<q,q+=8}if($!==(4294967295&s.total)){n.msg="incorrect length check",s.mode=30;break}q=$=0}s.mode=29;case 29:Jn=1;break e;case 30:Jn=-3;break e;case 31:return-4;default:return-2}return n.next_out=T,n.avail_out=V,n.next_in=I,n.avail_in=D,s.hold=$,s.bits=q,(s.wsize||me!==n.avail_out&&s.mode<30&&(s.mode<27||a!==4))&&Gh(n,n.output,n.next_out,me-n.avail_out),se-=n.avail_in,me-=n.avail_out,n.total_in+=se,n.total_out+=me,s.total+=me,s.wrap&&me&&(n.adler=s.check=(s.flags?ma:nm)(s.check,m,me,n.next_out-me)),n.data_type=s.bits+(s.last?64:0)+(s.mode===12?128:0)+(s.mode===20||s.mode===15?256:0),Jn=(se==0&&me===0||a===4)&&Jn===0?-5:Jn},inflateEnd:function(n){var a;return n&&n.state?((a=n.state).window&&(a.window=null),n.state=null,0):-2},inflateGetHeader:function(n,a){return!n||!n.state||!(2&(n=n.state).wrap)?-2:((n.head=a).done=!1,0)},inflateSetDictionary:function(n,a){var s,h=a.length;return!n||!n.state||(s=n.state).wrap!==0&&s.mode!==11?-2:s.mode===11&&nm(1,a,h,0)!==s.check?-3:Gh(n,a,h,h)?(s.mode=31,-4):(s.havedict=1,0)},inflateInfo:"pako inflate (from Nodeca project)"},sb=!0,lb=!0;try{String.fromCharCode.apply(null,[0])}catch{sb=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{lb=!1}for(var ga=new Ao.Buf8(256),Sl=0;Sl<256;Sl++)ga[Sl]=252<=Sl?6:248<=Sl?5:240<=Sl?4:224<=Sl?3:192<=Sl?2:1;ga[254]=ga[254]=1;function pM(n,a){for(var s,h,m=a||n.length,I=new Array(2*m),T=0,D=0;D<m;)if((s=n[D++])<128)I[T++]=s;else if(4<(h=ga[s]))I[T++]=65533,D+=h-1;else{for(s&=h===2?31:h===3?15:7;1<h&&D<m;)s=s<<6|63&n[D++],h--;1<h?I[T++]=65533:s<65536?I[T++]=s:(s-=65536,I[T++]=55296|s>>10&1023,I[T++]=56320|1023&s)}var V=I,$=T;if($<65534&&(V.subarray&&lb||!V.subarray&&sb))return String.fromCharCode.apply(null,Ao.shrinkBuf(V,$));for(var q="",se=0;se<$;se++)q+=String.fromCharCode(V[se]);return q}function cb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function mM(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Sr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},rm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ub=Object.prototype.toString;function El(s){if(!(this instanceof El))return new El(s);this.options=Ao.assign({chunkSize:16384,windowBits:0,to:""},s||{});var a=this.options,s=(a.raw&&0<=a.windowBits&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0)&&(a.windowBits=-15),!(0<=a.windowBits&&a.windowBits<16)||s&&s.windowBits||(a.windowBits+=32),15<a.windowBits&&a.windowBits<48&&!(15&a.windowBits)&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cb,this.strm.avail_out=0,Fu.inflateInit2(this.strm,a.windowBits));if(s!==Sr.Z_OK)throw new Error(rm[s]);if(this.header=new mM,Fu.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=function(h){for(var m,I,T,D,V=h.length,$=0,q=0;q<V;q++)(64512&(I=h.charCodeAt(q)))==55296&&q+1<V&&(64512&(T=h.charCodeAt(q+1)))==56320&&(I=65536+(I-55296<<10)+(T-56320),q++),$+=I<128?1:I<2048?2:I<65536?3:4;for(m=new Ao.Buf8($),q=D=0;D<$;q++)(64512&(I=h.charCodeAt(q)))==55296&&q+1<V&&(64512&(T=h.charCodeAt(q+1)))==56320&&(I=65536+(I-55296<<10)+(T-56320),q++),I<128?m[D++]=I:(I<2048?m[D++]=192|I>>>6:(I<65536?m[D++]=224|I>>>12:(m[D++]=240|I>>>18,m[D++]=128|I>>>12&63),m[D++]=128|I>>>6&63),m[D++]=128|63&I);return m}(a.dictionary):ub.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw)&&(s=Fu.inflateSetDictionary(this.strm,a.dictionary))!==Sr.Z_OK)throw new Error(rm[s])}function Bh(n,a){if(a=new El(a),a.push(n,!0),a.err)throw a.msg||rm[a.err];return a.result}El.prototype.push=function(n,a){var s,h,m,I,T,D=this.strm,V=this.options.chunkSize,$=this.options.dictionary,q=!1;if(this.ended)return!1;h=a===~~a?a:a===!0?Sr.Z_FINISH:Sr.Z_NO_FLUSH,typeof n=="string"?D.input=function(se){for(var me=new Ao.Buf8(se.length),fe=0,He=me.length;fe<He;fe++)me[fe]=se.charCodeAt(fe);return me}(n):ub.call(n)==="[object ArrayBuffer]"?D.input=new Uint8Array(n):D.input=n,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new Ao.Buf8(V),D.next_out=0,D.avail_out=V),(s=(s=Fu.inflate(D,Sr.Z_NO_FLUSH))===Sr.Z_NEED_DICT&&$?Fu.inflateSetDictionary(this.strm,$):s)===Sr.Z_BUF_ERROR&&q===!0&&(s=Sr.Z_OK,q=!1),s!==Sr.Z_STREAM_END&&s!==Sr.Z_OK)return this.onEnd(s),!(this.ended=!0);!D.next_out||D.avail_out!==0&&s!==Sr.Z_STREAM_END&&(D.avail_in!==0||h!==Sr.Z_FINISH&&h!==Sr.Z_SYNC_FLUSH)||(this.options.to==="string"?(m=function(se,me){for(var fe=(me=(me=me||se.length)>se.length?se.length:me)-1;0<=fe&&(192&se[fe])==128;)fe--;return!(fe<0||fe===0)&&fe+ga[se[fe]]>me?fe:me}(D.output,D.next_out),I=D.next_out-m,T=pM(D.output,m),D.next_out=I,D.avail_out=V-I,I&&Ao.arraySet(D.output,D.output,m,I,0),this.onData(T)):this.onData(Ao.shrinkBuf(D.output,D.next_out))),D.avail_in===0&&D.avail_out===0&&(q=!0)}while((0<D.avail_in||D.avail_out===0)&&s!==Sr.Z_STREAM_END);return(h=s===Sr.Z_STREAM_END?Sr.Z_FINISH:h)===Sr.Z_FINISH?(s=Fu.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Sr.Z_OK):h!==Sr.Z_SYNC_FLUSH||(this.onEnd(Sr.Z_OK),!(D.avail_out=0))},El.prototype.onData=function(n){this.chunks.push(n)},El.prototype.onEnd=function(n){n===Sr.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ao.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var Vu={},gM=((0,Ao.assign)(Vu,{Inflate:El,inflate:Bh,inflateRaw:function(n,a){return(a=a||{}).raw=!0,Bh(n,a)},ungzip:Bh},Sr),Vu),Hh=p(function n(a){u(this,n),this._m=a,this._n="InflateModule",this._bLogForInflateOK=!1,this._bLogForInflateError=!1},[{key:"inflate",value:function(h){var a,h=new Uint8Array(h).slice(4),s=Date.now();try{a=gM.inflate(h,{to:"string"}),this._bLogForInflateOK||(this._bLogForInflateOK=!0,new ct("inflateOK").end())}catch(I){return this._bLogForInflateError?void 0:(this._bLogForInflateError=!0,void new ct("inflateError").setMessage(I).end())}var h=h.length+4,m=a.length;return K.d("inflate ok. zipped:".concat(h," unzipped:").concat(m)+" compression ratio:".concat(Math.round(100*(m-h)/m),"% cost:").concat(Date.now()-s)),a}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._bLogForInflateOK=!1,this._bLogForInflateError=!1}}]),Hs="Message",Tl="User",Ml="Group",im="GroupMember",e_=["count"],t_=["conversationID","timePosition","timePeriod"],vM=["miniBirthday","maxBirthday"],_M=_(_(_(_({},Hs,de.CS),Tl,de.USER_CS),Ml,de.GRP_CS),im,de.MBR_CS),yM=(S(am,$o),p(am,[{key:"searchCloudMessages",value:function(n){return this.search(Hs,n)}},{key:"searchCloudUsers",value:function(n){return this.search(Tl,n)}},{key:"searchCloudGroups",value:function(n){return this.search(Ml,n)}},{key:"searchCloudGroupMembers",value:function(n){return this.search(im,n)}},{key:"search",value:function(n,a){var s=this,h="searchCloud".concat(n,"s"),m="".concat(this._n,".").concat(h);if(!a)return De({code:Je.OPTIONS_IS_EMPTY,message:this.getErrMsg(Je.OPTIONS_IS_EMPTY,h)});var I=a.keywordList,T=zr(I),D=a.count;if(a.count&&(D=parseInt(D)),n===Hs&&!T&&!zr(a.senderUserIDList)&&!zr(a.messageTypeList)||n!==Hs&&!T)throw K.e("[".concat(h,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var V=Date.now(),$=new ct(h),q="keywordList:".concat(I," keywordListMatchType:").concat(a.keywordListMatchType," cursor:").concat(a.cursor," count:").concat(D);return K.l("".concat(m," ").concat(q)),this.req({P:_M[n],data:this._genParams(n,a)}).then(function(se){var me=se.data,He=me.code,me=me.message;if(He!==0)return(fe=He)===60020?fe="SearchUnable":n!==Hs&&He===27003?fe="SearchParamsError":n!==Hs&&He===60018&&(fe="SearchOverLimit"),fe=s.getErrMsg(fe)||me,me=new po({code:He,message:fe}),$.setMessage(q).setError(me).end(),De(me);s.get(27).isCSPluginEnabled();var He=se.data,fe=He.cursor,me=fe===void 0?"":fe,fe=He.totalCount,He="totalCount:".concat(fe," cost:").concat(br(V)),He=(K.l("".concat(m," ok. cursor:").concat(me," ").concat(He)),$.setMessage("".concat(q," ").concat(He)).end(),s._genRes(n,a,se.data));return Kt({searchResultList:He,cursor:me,totalCount:fe})}).catch(function(se){return $.setMessage(q).setError(se).end(),De(se)})}},{key:"_genParams",value:function(n,a){var s=a.count,h=N(a,e_);return s&&(h.count=parseInt(s)),n===Hs?this._genMsgParams(h):(s=a.keywordList,a=a.keywordListMatchType,h.keywords=s,h.keywordMatchType=a==="and"?1:0,n===Tl?this._genUserParams(h):h)}},{key:"_genMsgParams",value:function(m){var a=m.conversationID,s=m.timePosition,h=m.timePeriod,m=N(m,t_);return et(a)||(Gr(a)&&(m.account=a.replace(O.CONV_C2C,"")),Br(a)&&(m.groupID=a.replace(O.CONV_GROUP,""))),It(h)&&0<h&&(It(s)&&0<s?m.startTime=s-h:m.startTime=ot()-h),m.startTime&&m.startTime<0&&(m.startTime=void 0),It(s)&&0<s&&(m.endTime=s),m}},{key:"_genUserParams",value:function(h){var a=h.miniBirthday,s=h.maxBirthday,h=N(h,vM);return It(a)&&(h.miniBirthday=parseInt(a),It(s)||(h.maxBirthday=4294967295)),It(s)&&(h.maxBirthday=parseInt(s)),h}},{key:"_genRes",value:function(n,a,s){switch(n){case Hs:return this._genMsgRes(s.searchResult,!a.conversationID);case Tl:return this._genUserRes(s.userList);case Ml:return this._genGrpRes(s.groupList);case im:return this._genMemberRes(s.groupMemberList);default:return[]}}},{key:"_genMsgRes",value:function(n,a){var s=this.get(11);return wt(n)&&n.length!==0?n.map(function(T){var m=T.groupID,D=T.userID,I=T.messageCount,T=T.messageList,T=T===void 0?[]:T,D=m?"".concat(O.CONV_GROUP).concat(m):"".concat(O.CONV_C2C).concat(D),V={conversationID:D,messageCount:I,messageList:[]};return a&&1<I||0<(I=T.filter(function($){return!!$})).length&&(T=s.onRoamingMessage(I,D,!1),m&&T.reverse(),V.messageList=T,V.messageCount=T.length),V}):[]}},{key:"_genUserRes",value:function(n){var a=this.get(4)._profileHandler;if(!wt(n))return[];for(var s=[],h=0,m=n.length;h<m;h++){var T=n[h],I=T.userID,T=T.profileItems;I!=="@TLS#NOT_FOUND"&&I!==""&&(I=a._update(I,a._getLatestProfileFromResponse(I,T)).latestProfile,s.push(I))}return s}},{key:"_genGrpRes",value:function(n){if(!wt(n))return[];for(var a=[],s=0,h=n.length;s<h;s++)n[s]&&n[s].groupID&&a.push(new fa(n[s]));return a}},{key:"_genMemberRes",value:function(n){if(!wt(n))return[];for(var a,s,h,m,I,T,D=new Map,V=0,$=n.length;V<$;V++)n[V]&&n[V].userID&&n[V].groupID&&(s=(a=n[V]).groupID,m=a.name,I=a.type,T=a.avatar,h=a.nick,m={groupID:s,name:m,type:I,avatar:T},I={userID:a.userID,nick:h,nameCard:a.nameCard},D.has(s)?((T=D.get(s)).memberList.push(I),D.set(s,T)):D.set(s,{groupInfo:m,memberList:[I]}));return P(D.values())}}])),db=p(function n(a){var s=this;u(this,n);var h,m=new ct("sdkConstruct"),V=(this._n="ModuleManager",this._isReady=!1,this._reason=Je.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._map=new Map,this._optionalModuleMap=new Map,this._codeMsgForTUIMap=new Map,this._iEmitter=null,this._oEmitter=null,this._checkCount=0,this._checkTimer=-1,this._map.set(12,new pc(this,a)),this._map.set(37,new Hh(this)),this._map.set(15,new R1(this)),this._map.set(27,new oM(this)),this._map.set(23,new Z1(this)),this._map.set(24,new Oh(this)),this._map.set(26,new Jv(this)),this._map.set(21,new q1(this)),this._map.set(20,new X1(this)),this._map.set(1,new PI(this)),this._map.set(2,new P1(this)),this._map.set(3,new x1(this)),this._map.set(34,new Cr(this)),this._map.set(31,new U1(this)),this._map.set(4,new Fv(this)),this._map.set(6,new s1(this)),this._map.set(11,new Uv(this)),this._map.set(7,new I1(this)),this._map.set(10,new S1(this)),this._map.set(13,new M1(this)),this._map.set(32,new JI(this)),this._map.set(14,new w1(this)),this._map.set(17,new O1(this)),this._map.set(18,new F1(this)),this._map.set(19,new V1(this)),this._map.set(25,new Q1(this)),this._map.set(8,new zI(this)),this._map.set(28,new jI(this)),this._map.set(36,new YI(this)),this._map.set(29,new rM(this)),this._map.set(30,new Zv(this)),this._map.set(33,new lM(this)),this._map.set(35,new eb(this)),this._map.set(38,new yM(this)),this._eventThrottleMap=new Map,this._eventThrottling=a.eventThrottling,this._map.get(12).isPartialUpdatedConvs()&&(this._eventThrottling=!1),On(a.modules)?(Object.keys(a.modules).forEach(function($){h=a.modules[$],$==="group-module"?s._map.set(7,new h(s)):$==="relationship-module"?s._map.set(8,new h(s)):$==="signaling-module"?s._map.set(33,new h(s)):$==="follow-module"?s._map.set(35,new h(s)):$==="cloud-search-module"&&s._map.set(38,new h(s)),s._optionalModuleMap.set($,1)}),this._map.get(12).setUsingChatCore(!0)):this._map.has(7)||this._map.get(12).setUsingChatCore(!0),a.instanceID),I=a.SDKAppID,T=this._map.get(12).isIntl(),D=this._map.get(12).isUsingChatCore(),V="instanceID:".concat(V," SDKAppID:").concat(I," isIntl:").concat(T," isUsingChatCore:").concat(D," host:").concat(Ev())+" isIOSWebView:".concat(yn," platform:").concat(nt," canIUseInflate:").concat(this.canIUseInflate())+" workerAvailable:".concat(sn," eventThrottling:").concat(this._eventThrottling," UserAgent:").concat(ze);ct.bindEventStatModule(this._map.get(14)),ct.bindNetMonitorModule(this._map.get(15)),m.setMessage("".concat(V," ").concat(function(){var $="";if(_e)try{var q=je.getSystemInfoSync(),se=q.model,me=q.version,fe=q.system,He=q.platform,Xe=q.SDKVersion,$="model:".concat(se," version:").concat(me," system:").concat(fe," platform:").concat(He," SDKVersion:").concat(Xe)}catch{$=""}return $}())).end(),K.i("SDK ".concat(V)),po.prototype._getErrMsg=this.getErrMsg.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()},[{key:"_startTimer",value:function(){var n=this._map.get(24),a=n.isWorkerEnabled();K.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(a," seed:").concat(this._checkTimer)),a?n.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),K.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var n=this._map.get(24),a=n.isWorkerEnabled();K.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(a," seed:").concat(this._checkTimer)),a?n.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){K.l("".concat(this._n,"._stopMainThreadTimer")),0<this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){K.l("".concat(this._n,"._stopMainThreadSocket"));var n=this._map.get(21);n.setIsWorkerEnabled(!0),n.reConnect()}},{key:"_startMainThreadSocket",value:function(){K.l("".concat(this._n,"._startMainThreadSocket"));var n=this._map.get(21);n.setIsWorkerEnabled(!1),n.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){K.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){K.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var n,a=v(this._map);try{for(a.s();!(n=a.n()).done;){var s=x(n.value,2)[1];s.onCheckTimer&&s.onCheckTimer(this._checkCount)}}catch(h){a.e(h)}finally{a.f()}}},{key:"_initReadyList",value:function(){var n=this;this._readyList=[this._map.get(1)],this._readyList.forEach(function(a){a.ready(function(){return n._onModuleReady()})})}},{key:"_onModuleReady",value:function(){var n,a,s=!0;this._readyList.forEach(function(h){h.isReady()||(s=!1)}),s&&!this._isReady&&(this._isReady=!0,this._oEmitter.emit(W.SDK_READY),n=Date.now()-this._startLoginTs,K.w("SDK is ready. cost ".concat(n," ms")),this._startLoginTs=Date.now(),a=this._ssoLogForReady.getStartTs()+Nt,this._ssoLogForReady.setMessage(n).start(a).end())}},{key:"login",value:function(){this._startLoginTs===0&&(ke(),this._startLoginTs=Date.now(),this._startTimer(),this._map.get(15).start(),this._ssoLogForReady=new ct("sdkReady"),this._reason=Je.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOEmitInst",value:function(){return this._oEmitter===null&&(this._oEmitter=new xI,n=this._oEmitter,cc=n,this._oEmitter._emit=this._oEmitter.emit,this._oEmitter.emit=(function(a,s){var h,m,I=this;this._canIUseSignaling()&&(a===W.MESSAGE_RECEIVED&&this.get(33).onNewMessageList(s),a===W.MESSAGE_MODIFIED)&&this.get(33).onMessageModified(s),a===W.CONVERSATION_LIST_UPDATED||a===W.FRIEND_LIST_UPDATED||a===W.GROUP_LIST_UPDATED||a===W.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._eventThrottling!==!1?this._eventThrottleMap.has(a)?(h=Date.now())-(m=this._eventThrottleMap.get(a)).last<=1e3?(-1<m.timeoutID&&clearTimeout(m.timeoutID),m.timeoutID=setTimeout(function(){m.last=Date.now(),I._oEmitter._emit.apply(I._oEmitter,[a,{name:a,data:I._getEventData(a)}])},1e3)):(m.last=h,this._oEmitter._emit.apply(this._oEmitter,[a,{name:a,data:this._getEventData(a)}])):(this._eventThrottleMap.set(a,{last:Date.now(),timeoutID:-1}),this._oEmitter._emit.apply(this._oEmitter,[a,{name:a,data:this._getEventData(a)}])):this._oEmitter._emit.apply(this._oEmitter,[a,{name:a,data:this._getEventData(a)}]):this._oEmitter._emit.apply(this._oEmitter,[a,{name:a,data:s}])}).bind(this)),this._oEmitter;var n}},{key:"_canIUseSignaling",value:function(){var n=this.get(33);return!!n&&n.canIUseSignaling()}},{key:"_getEventData",value:function(n){return n===W.CONVERSATION_LIST_UPDATED?this._map.get(12).isPartialUpdatedConvs()?this._map.get(11).getPartialUpdatedConvs():this._map.get(11).getLocalConvList():n===W.FRIEND_LIST_UPDATED?this._map.get(8).getLocalFriendList(!1):n===W.GROUP_LIST_UPDATED?this._map.get(7).getLocalGroupList():n===W.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._map.get(11).getTotalUnreadCount():n===W.CONVERSATION_ID_LIST_UPDATED?this._map.get(11).getUpdatedConvIDList():void 0}},{key:"getIEmitInst",value:function(){return this._iEmitter===null&&(this._iEmitter=new xI,this._iEmitter._emit=this._iEmitter.emit,this._iEmitter.emit=(function(n,a){n=On(a)&&a.data?[n,{name:n,data:a.data}]:[n,{name:n,data:a}],this._iEmitter._emit.apply(this._iEmitter,n)}).bind(this)),this._iEmitter}},{key:"hasModule",value:function(n){return this._map.has(n)}},{key:"get",value:function(n){return this._map.get(n)}},{key:"canIUseModule",value:function(n){return!this._map.get(12).isUsingChatCore()||this._optionalModuleMap.has(n)}},{key:"canIUseInflate",value:function(){return!!this._map.get(37)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.get(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(n){this._reason=n}},{key:"getErrMsg",value:function(n,a,s){return this._map.get(32).get({key:n,replacement1:a,replacement2:s,isIntl:this.isIntl()})}},{key:"warn",value:function(n,a,s){n=this.getErrMsg(n,a,s),n&&K.w(n)}},{key:"onError",value:function(n){var a="code:".concat(n.code," message:").concat(n.message);K.w("Oops! ".concat(a)),new ct("error").setMessage(a).setLevel("error").end(),this.getOEmitInst().emit(W.ERROR,n)}},{key:"restartTimer",value:function(){K.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var n=this.get(7);n&&n.restartPolling()}},{key:"getTimerID",value:function(){var n=this._map.get(24);return n.isWorkerEnabled()?n.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(n){return this._map.get(7).getPollingTimerID(n)}},{key:"statTUIKeyFeatures",value:function(s){var a=s.code,s=s.msg,s=s===void 0?"":s,h=a+s;this._codeMsgForTUIMap.has(h)||(this._codeMsgForTUIMap.set(h,1),h=this.get(12).getUIPlatform(),new ct("tui_key_features").setCode(a).setMessage(s).setUIPlatform(h).end())}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),ke();var n,a=v(this._map);try{for(a.s();!(n=a.n()).done;){var s=x(n.value,2)[1];s.reset&&s.reset()}}catch(T){a.e(T)}finally{a.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._oEmitter.emit(W.SDK_NOT_READY);var h,m=v(this._eventThrottleMap);try{for(m.s();!(h=m.n()).done;){var I=x(h.value,2)[1];-1<I.timeoutID&&clearTimeout(I.timeoutID)}}catch(T){m.e(T)}finally{m.f()}this._eventThrottleMap.clear(),this._codeMsgForTUIMap.clear()}}]),hb=p(function n(a){u(this,n),this._funcMap=new Map,this._m=a,this._n="SafetyCallback",this._reportCount=0},[{key:"defense",value:function(n,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0;if(typeof n!="string"||n.length===0||typeof a!="function")return null;if(this._funcMap.has(n)&&this._funcMap.get(n).has(a))return this._funcMap.get(n).get(a);this._funcMap.has(n)||this._funcMap.set(n,new Map);var h=null;return this._funcMap.get(n).has(a)?h=this._funcMap.get(n).get(a):(h=this._pack(n,a,s),this._funcMap.get(n).set(a,h)),h}},{key:"defenseOnce",value:function(n,a){return typeof a!="function"?null:this._pack(n,a,2<arguments.length&&arguments[2]!==void 0?arguments[2]:void 0)}},{key:"find",value:function(n,a){return typeof n!="string"||n.length===0||typeof a!="function"?null:this._funcMap.has(n)&&this._funcMap.get(n).has(a)?this._funcMap.get(n).get(a):(this._m.warn("ListenerFnNotFound",n),null)}},{key:"delete",value:function(n,a){return typeof a=="function"&&!!this._funcMap.has(n)&&!!this._funcMap.get(n).has(a)&&(this._funcMap.get(n).delete(a),this._funcMap.get(n).size===0&&this._funcMap.delete(n),!0)}},{key:"_pack",value:function(n,a,s){var h=this;return function(){try{a.apply(s,Array.from(arguments))}catch(T){var m=Object.values(W).indexOf(n),I="CallbackError";m!==-1&&(m=Object.keys(W)[m],h._m.warn(I,m,T)),h._reportCount<5&&(new ct(I).setMessage("eventName:".concat(n)).setMoreMessage(T.message).end(),h._reportCount+=1)}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){K.l("".concat(this._n,".reset")),this._reportCount=0}}]),IM=p(function n(a){u(this,n),a={SDKAppID:a.SDKAppID,unlimitedAVChatRoom:a.unlimitedAVChatRoom||!1,scene:a.scene||"",oversea:a.oversea||!1,instanceID:hh(),devMode:a.devMode||!1,testEnv:a.testEnv||!1,proxyServer:a.proxyServer||void 0,fileUploadProxy:a.fileUploadProxy||void 0,fileDownloadProxy:a.fileDownloadProxy||a.fileUploadProxy||void 0,eventThrottling:a.eventThrottling!==!1,partialUpdatedConversations:a.partialUpdatedConversations===!0,disableIndependentDomain:a.disableIndependentDomain===!0,modules:a.modules||void 0},this._m=new db(a),this._safetyCallbackFactory=new hb(this._m)},[{key:"onError",value:function(n){this._m.onError(n)}},{key:"login",value:function(n){return this._m.login(),this._get(1).login(n)}},{key:"logout",value:function(){var n=this;return this._get(1).logout().then(function(a){return n._safetyCallbackFactory.reset(),n._m.reset(),a})}},{key:"getLoginUser",value:function(){return this._get(1).getLoginUser()}},{key:"getServerTime",value:function(){return Dn()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrMsg",value:function(n,a,s){return this._m.getErrMsg(n,a,s)}},{key:"_get",value:function(n){return this._m.get(n)}},{key:"destroy",value:function(){var n=this,a=this._get(12),s=a.getSDKAppID();return K.w("destroy ".concat(s," ").concat(a.getInstanceID())),this.logout().finally(function(){n._safetyCallbackFactory.destroy(),n._m.stopTimer(),n._get(24).terminate(),n._get(21).dealloc(),n._m.getOEmitInst().emit(W.SDK_DESTROY,{SDKAppID:s})})}},{key:"on",value:function(n,a,s){K.d("on","eventName:".concat(n)),this._m.getOEmitInst().on(n,this._safetyCallbackFactory.defense(n,a,s),s)}},{key:"once",value:function(n,a,s){K.d("once","eventName:".concat(n)),this._m.getOEmitInst().once(n,this._safetyCallbackFactory.defenseOnce(n,a,s),s||this)}},{key:"off",value:function(n,a,s,h){K.d("off","eventName:".concat(n));var m=this._safetyCallbackFactory.find(n,a);m!==null&&(this._m.getOEmitInst().off(n,m,s,h),this._safetyCallbackFactory.delete(n,a))}},{key:"registerPlugin",value:function(n){(et(n["tim-push"])?et(n["tim-offline-push-plugin"])?this._get(18):this._get(28):this._get(36)).registerPlugin(n)}},{key:"setLogLevel",value:function(n){var a;n<=0&&((a=this.getErrMsg("TIM_ASCII_ART"))&&console.log(a),(a=this.getErrMsg("API_REFER"))&&(Tv()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",a):console.log("IM SDK API ->",a)),(a=this.getErrMsg("DOCS_GUIDE"))&&console.log(a),a=this.getErrMsg("IOS_WEBVIEW_WARNING"),yn)&&a&&console.warn(a),K.setLevel(n)}},{key:"createTextMessage",value:function(n){return this._get(2).createTextMessage(n)}},{key:"createTextAtMessage",value:function(n){return this._get(2).createTextMessage(n)}},{key:"createImageMessage",value:function(n){return this._get(2).createImageMessage(n)}},{key:"createAudioMessage",value:function(n){return this._get(2).createAudioMessage(n)}},{key:"createVideoMessage",value:function(n){return this._get(2).createVideoMessage(n)}},{key:"createCustomMessage",value:function(n){return this._get(2).createCustomMessage(n)}},{key:"createFaceMessage",value:function(n){return this._get(2).createFaceMessage(n)}},{key:"createFileMessage",value:function(n){return this._get(2).createFileMessage(n)}},{key:"createLocationMessage",value:function(n){return this._get(2).createLocationMessage(n)}},{key:"createMergerMessage",value:function(n){return this._get(2).createMergerMessage(n)}},{key:"downloadMergerMessage",value:function(n){return n.type!==O.MSG_MERGER?De({code:Je.MSG_MERGER_TYPE_INVALID}):Tt(n.payload.downloadKey)?De({code:Je.MSG_MERGER_KEY_INVALID}):this._get(2).downloadMergerMessage(n).catch(function(a){return De({code:Je.MSG_MERGER_DOWNLOAD_FAIL})})}},{key:"createForwardMessage",value:function(n){return this._get(2).createForwardMessage(n)}},{key:"sendMessage",value:function(n,a){return n instanceof _r?this._get(2).sendMessageInstance(n,a):De({code:Je.MSG_INSTANCE_REQUIRED})}},{key:"callExperimentalAPI",value:function(n,a){return n==="sendComboMessage"?this._get(31).sendMessage(a):n==="handleGroupInvitation"?this._get(7).handleGroupInvitation(a):n==="isCommercialAbilityEnabled"?this._get(27).isFeatureEnabled(a):n==="isFeatureEnabledForStat"?this._get(27).isFeatureEnabledForStat(a):n==="isIntl"?this.isIntl():n==="sendTRTCCustomData"||n==="sendRoomCustomData"?this._get(30).sendTRTCCustomData(a):n==="getTimerID"?this._m.getTimerID():n==="getPollingTimerID"?this._m.getPollingTimerID(a):n==="setApplicationID"?(this._get(12).setApplicationID(a),void this._get(20).updateProtocolConfig()):n==="getServerConfig"?this._get(23).getServerConfig(a):n==="canIUseModule"?this._m.canIUseModule(a):n==="startMessageLongPolling"?this._get(7).startMessageLongPolling(a):n==="stopMessageLongPolling"?this._get(7).stopMessageLongPolling(a):n==="disableMessagePullOnInvite"?this._get(11).disableMsgPullOnInvite(a):n==="clearLocalMessage"?this._get(11).clearMemMsg(a,!1):n==="setCustomLoginInfo"?this._get(12).setCustomLoginInfo(a):n==="statTUIKeyFeatures"?this._m.statTUIKeyFeatures(a):n==="getGroupReceiptsByUsers"?this._get(7).getGroupReceiptsByUsers(a):De({code:Je.INVALID_OPERATION})}},{key:"revokeMessage",value:function(n){return this._get(2).revokeMessage(n)}},{key:"resendMessage",value:function(n,a){return n instanceof _r?this._get(2).resendMessage(n,a):De({code:Je.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(n){return this._get(2).deleteMessage(n)}},{key:"translateText",value:function(n){return this._get(2).translateText(n)}},{key:"convertVoiceToText",value:function(n){return this._get(2).convertVoiceToText(n)}},{key:"setMessageExtensions",value:function(n,a){return this._get(3).setMessageExtensions(n,a)}},{key:"getMessageExtensions",value:function(n){return this._get(3).getMessageExtensions(n)}},{key:"deleteMessageExtensions",value:function(n,a){return this._get(3).deleteMessageExtensions(n,a)}},{key:"addMessageReaction",value:function(n,a){return this._get(34).addMessageReaction(n,a)}},{key:"removeMessageReaction",value:function(n,a){return this._get(34).removeMessageReaction(n,a)}},{key:"getMessageReactions",value:function(n){return this._get(34).getMessageReactions(n)}},{key:"getAllUserListOfMessageReaction",value:function(n){return this._get(34).getAllUserListOfMessageReaction(n)}},{key:"modifyMessage",value:function(n){return this._get(2).modifyRemoteMessage(n)}},{key:"getMessageList",value:function(n){return this._get(11).getMessageList(n)}},{key:"getMessageListHopping",value:function(n){return this._get(11).getMessageListHopping(n)}},{key:"sendMessageReadReceipt",value:function(n){return this._get(11).sendReadReceipt(n)}},{key:"getMessageReadReceiptList",value:function(n){return this._get(11).getReadReceiptList(n)}},{key:"getGroupMessageReadMemberList",value:function(n){var a=this._get(7);return a?a.getReadReceiptDetail(n):De({code:Je.NO_MODULE})}},{key:"findMessage",value:function(n){return this._get(11).findMessage(n)}},{key:"setMessageRead",value:function(n){return this._get(11).setMessageRead(n)}},{key:"getConversationList",value:function(n){return this._get(11).getConvList(n)}},{key:"getConversationProfile",value:function(n){return this._get(11).getConversationProfile(n)}},{key:"deleteConversation",value:function(n){return this._get(11).deleteConversation(n)}},{key:"setConversationDraft",value:function(n){return this._get(11).setConvDraft(n)}},{key:"clearHistoryMessage",value:function(n){return this._get(11).clearHistoryMessage(n)}},{key:"pinConversation",value:function(n){return this._get(11).pinConversation(n)}},{key:"setAllMessageRead",value:function(n){return this._get(11).setAllMessageRead(n)}},{key:"setMessageRemindType",value:function(n){return this._get(11).setMessageRemindType(n)}},{key:"setAllReceiveMessageOpt",value:function(n){return this._get(11).setAllRcvMsgOpt(n)}},{key:"getAllReceiveMessageOpt",value:function(){return this._get(11).getAllRcvMsgOpt()}},{key:"getTotalUnreadMessageCount",value:function(){return this._get(11).getTotalUnreadCount()}},{key:"setConversationCustomData",value:function(n){return this._get(11).setConvCustomData(n)}},{key:"markConversation",value:function(n){return this._get(11).markConv(n)}},{key:"getConversationGroupList",value:function(){return this._get(11).getConvGroupList()}},{key:"createConversationGroup",value:function(n){return this._get(11).createConvGroup(n)}},{key:"deleteConversationGroup",value:function(n){return this._get(11).deleteConvGroup(n)}},{key:"renameConversationGroup",value:function(n){return this._get(11).renameConvGroup(n)}},{key:"addConversationsToGroup",value:function(n){return this._get(11).addConvsToGroup(n)}},{key:"deleteConversationsFromGroup",value:function(n){return this._get(11).deleteConvsFromGroup(n)}},{key:"searchCloudMessages",value:function(n){var a=this._get(38);return a?a.searchCloudMessages(n):De({code:Je.NO_MODULE})}},{key:"searchCloudUsers",value:function(n){var a=this._get(38);return a?a.searchCloudUsers(n):De({code:Je.NO_MODULE})}},{key:"searchCloudGroups",value:function(n){var a=this._get(38);return a?a.searchCloudGroups(n):De({code:Je.NO_MODULE})}},{key:"searchCloudGroupMembers",value:function(n){var a=this._get(38);return a?a.searchCloudGroupMembers(n):De({code:Je.NO_MODULE})}},{key:"getMyProfile",value:function(){return this._get(4).getMyProfile()}},{key:"getUserProfile",value:function(n){return this._get(4).getUserProfile(n)}},{key:"updateMyProfile",value:function(n){return this._get(4).updateMyProfile(n)}},{key:"getBlacklist",value:function(){return this._get(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(n){return this._get(4).addBlacklist(n)}},{key:"removeFromBlacklist",value:function(n){return this._get(4).deleteBlacklist(n)}},{key:"setSelfStatus",value:function(n){return this._get(4).setSelfStatus(n)}},{key:"getUserStatus",value:function(n){return this._get(4).getUserStatus(n)}},{key:"subscribeUserStatus",value:function(n){return this._get(4).subscribeUserStatus(n)}},{key:"unsubscribeUserStatus",value:function(n){return this._get(4).unsubscribeUserStatus(n)}},{key:"getFriendList",value:function(){var n=this._get(8);return n?n.getLocalFriendList():De({code:Je.NO_MODULE})}},{key:"addFriend",value:function(n){var a=this._get(8);return a?a.addFriend(n):De({code:Je.NO_MODULE})}},{key:"deleteFriend",value:function(n){var a=this._get(8);return a?a.deleteFriend(n):De({code:Je.NO_MODULE})}},{key:"checkFriend",value:function(n){var a=this._get(8);return a?a.checkFriend(n):De({code:Je.NO_MODULE})}},{key:"getFriendProfile",value:function(n){var a=this._get(8);return a?a.getFriendProfile(n):De({code:Je.NO_MODULE})}},{key:"updateFriend",value:function(n){var a=this._get(8);return a?a.updateFriend(n):De({code:Je.NO_MODULE})}},{key:"getFriendApplicationList",value:function(){var n=this._get(8);return n?n.getLocalFriendApplicationList():De({code:Je.NO_MODULE})}},{key:"acceptFriendApplication",value:function(n){var a=this._get(8);return a?a.acceptFriendApplication(n):De({code:Je.NO_MODULE})}},{key:"refuseFriendApplication",value:function(n){var a=this._get(8);return a?a.refuseFriendApplication(n):De({code:Je.NO_MODULE})}},{key:"deleteFriendApplication",value:function(n){var a=this._get(8);return a?a.deleteFriendApplication(n):De({code:Je.NO_MODULE})}},{key:"setFriendApplicationRead",value:function(){var n=this._get(8);return n?n.setFriendApplicationRead():De({code:Je.NO_MODULE})}},{key:"getFriendGroupList",value:function(){var n=this._get(8);return n?n.getLocalFriendGroupList():De({code:Je.NO_MODULE})}},{key:"createFriendGroup",value:function(n){var a=this._get(8);return a?a.createFriendGroup(n):De({code:Je.NO_MODULE})}},{key:"deleteFriendGroup",value:function(n){var a=this._get(8);return a?a.deleteFriendGroup(n):De({code:Je.NO_MODULE})}},{key:"addToFriendGroup",value:function(n){var a=this._get(8);return a?a.addToFriendGroup(n):De({code:Je.NO_MODULE})}},{key:"removeFromFriendGroup",value:function(n){var a=this._get(8);return a?a.removeFromFriendGroup(n):De({code:Je.NO_MODULE})}},{key:"renameFriendGroup",value:function(n){var a=this._get(8);return a?a.renameFriendGroup(n):De({code:Je.NO_MODULE})}},{key:"followUser",value:function(n){var a=this._get(35);return a?a.followUser(n):De({code:Je.NO_MODULE})}},{key:"unfollowUser",value:function(n){var a=this._get(35);return a?a.unfollowUser(n):De({code:Je.NO_MODULE})}},{key:"getMyFollowersList",value:function(n){var a=this._get(35);return a?a.getMyFollowersList(n):De({code:Je.NO_MODULE})}},{key:"getMyFollowingList",value:function(n){var a=this._get(35);return a?a.getMyFollowingList(n):De({code:Je.NO_MODULE})}},{key:"getMutualFollowersList",value:function(n){var a=this._get(35);return a?a.getMutualFollowersList(n):De({code:Je.NO_MODULE})}},{key:"getUserFollowInfo",value:function(n){var a=this._get(35);return a?a.getUserFollowInfo(n):De({code:Je.NO_MODULE})}},{key:"checkFollowType",value:function(n){var a=this._get(35);return a?a.checkFollowType(n):De({code:Je.NO_MODULE})}},{key:"getGroupList",value:function(){var n=this._get(7);return n?n.getGroupList():De({code:Je.NO_MODULE})}},{key:"getGroupProfile",value:function(n){var a=this._get(7);return a?a.getGroupProfile(n):De({code:Je.NO_MODULE})}},{key:"createGroup",value:function(n){var a=this._get(7);return a?a.createGroup(n):De({code:Je.NO_MODULE})}},{key:"dismissGroup",value:function(n){var a=this._get(7);return a?a.dismissGroup(n):De({code:Je.NO_MODULE})}},{key:"updateGroupProfile",value:function(n){var a=this._get(7);return a?a.updateGroupProfile(n):De({code:Je.NO_MODULE})}},{key:"joinGroup",value:function(n){var a=this._get(7);return a?a.joinGroup(n):De({code:Je.NO_MODULE})}},{key:"quitGroup",value:function(n){var a=this._get(7);return a?a.quitGroup(n):De({code:Je.NO_MODULE})}},{key:"searchGroupByID",value:function(n){var a=this._get(7);return a?a.searchGroupByID(n):De({code:Je.NO_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(n){var a=this._get(7);return a?a.getGroupOnlineMemberCount(n):De({code:Je.NO_MODULE})}},{key:"changeGroupOwner",value:function(n){var a=this._get(7);return a?a.changeGroupOwner(n):De({code:Je.NO_MODULE})}},{key:"getGroupApplicationList",value:function(){var n=this._get(7);return n?n.getGroupApplicationList():De({code:Je.NO_MODULE})}},{key:"handleGroupApplication",value:function(n){var a=this._get(7);return a?a.handleGroupApplication(n):De({code:Je.NO_MODULE})}},{key:"initGroupAttributes",value:function(n){var a=this._get(7);return a?a.initGroupAttributes(n):De({code:Je.NO_MODULE})}},{key:"setGroupAttributes",value:function(n){var a=this._get(7);return a?a.setGroupAttributes(n):De({code:Je.NO_MODULE})}},{key:"deleteGroupAttributes",value:function(n){var a=this._get(7);return a?a.deleteGroupAttributes(n):De({code:Je.NO_MODULE})}},{key:"getGroupAttributes",value:function(n){var a=this._get(7);return a?a.getGroupAttributes(n):De({code:Je.NO_MODULE})}},{key:"setGroupCounters",value:function(n){var a=this._get(7);return a?a.setGroupCounters(n):De({code:Je.NO_MODULE})}},{key:"increaseGroupCounter",value:function(n){var a=this._get(7);return a?a.increaseGroupCounter(n):De({code:Je.NO_MODULE})}},{key:"decreaseGroupCounter",value:function(n){var a=this._get(7);return a?a.decreaseGroupCounter(n):De({code:Je.NO_MODULE})}},{key:"getGroupCounters",value:function(n){var a=this._get(7);return a?a.getGroupCounters(n):De({code:Je.NO_MODULE})}},{key:"getGroupMemberList",value:function(n){var a=this._get(7);return a?a.getGroupMemberList(n):De({code:Je.NO_MODULE})}},{key:"getGroupMemberProfile",value:function(n){var a=this._get(7);return a?a.getGroupMemberProfile(n):De({code:Je.NO_MODULE})}},{key:"addGroupMember",value:function(n){var a=this._get(7);return a?a.addGroupMember(n):De({code:Je.NO_MODULE})}},{key:"deleteGroupMember",value:function(n){var a=this._get(7);return a?a.deleteGroupMember(n):De({code:Je.NO_MODULE})}},{key:"setGroupMemberMuteTime",value:function(n){var a=this._get(7);return a?a.setGroupMemberMuteTime(n):De({code:Je.NO_MODULE})}},{key:"setGroupMemberRole",value:function(n){var a=this._get(7);return a?a.setGroupMemberRole(n):De({code:Je.NO_MODULE})}},{key:"setGroupMemberNameCard",value:function(n){var a=this._get(7);return a?a.setGroupMemberNameCard(n):De({code:Je.NO_MODULE})}},{key:"setGroupMemberCustomField",value:function(n){var a=this._get(7);return a?a.setGroupMemberCustomField(n):De({code:Je.NO_MODULE})}},{key:"markGroupMemberList",value:function(n){var a=this._get(7);return a?a.markGroupMemberList(n):De({code:Je.NO_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._get(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(n){return this._get(10).createTopicInCommunity(n)}},{key:"deleteTopicFromCommunity",value:function(n){return this._get(10).deleteTopicFromCommunity(n)}},{key:"updateTopicProfile",value:function(n){return this._get(10).updateTopicProfile(n)}},{key:"getTopicList",value:function(n){return this._get(10).getTopicList(n)}},{key:"addSignalingListener",value:function(n,a,s){var h=this._get(33);h&&h.addSignalingListener(n,this._safetyCallbackFactory.defense(n,a,s),s)}},{key:"removeSignalingListener",value:function(n,a,s){var h,m=this._safetyCallbackFactory.find(n,a);m!==null&&(h=this._get(33))&&(h.removeSignalingListener(n,m,s),this._safetyCallbackFactory.delete(n,a))}},{key:"invite",value:function(n){var a=this._get(33);return a?a.invite(n):De({code:Je.NO_MODULE})}},{key:"inviteSync",value:function(n,a,s){var h=this._get(33);return h?h.inviteSync(n,a,s):""}},{key:"inviteInGroup",value:function(n){var a=this._get(33);return a?a.invite(n):De({code:Je.NO_MODULE})}},{key:"inviteInGroupSync",value:function(n,a,s){var h=this._get(33);return h?h.inviteSync(n,a,s):""}},{key:"cancel",value:function(n){var a=this._get(33);return a?a.cancel(n):De({code:Je.NO_MODULE})}},{key:"accept",value:function(n){var a=this._get(33);return a?a.accept(n):De({code:Je.NO_MODULE})}},{key:"reject",value:function(n){var a=this._get(33);return a?a.reject(n):De({code:Je.NO_MODULE})}},{key:"getSignalingInfo",value:function(n){var a=this._get(33);return a?a.getSignalingInfo(n):null}},{key:"modifyInvitation",value:function(n){var a=this._get(33);return a?a.modifyInvitation(n):De({code:Je.NO_MODULE})}}]),bM={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function am(n){return u(this,am),(n=c(this,am,[n]))._n="CSModule",n}var vc={},cr={};return cr.create=function(T){var a="TencentCloudChat.create",s=0,I=T.SDKAppID;if(It(I))s=I;else if(s=parseInt(I),isNaN(I))return K.e("".concat(a," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(s&&vc[s])return vc[s];K.l("".concat(a));var h,m,I=new IM(E(E({},T),{},{SDKAppID:s})),T=(I.on(W.SDK_DESTROY,function(D){vc[D.data.SDKAppID]=null,delete vc[D.data.SDKAppID]}),h=I,m=Object.create(null),Object.keys(kp).forEach(function(D){var V;h[D]&&(V=new J,m[D]=function(){var $=Array.from(arguments);return V.use(function(q,se){He=D;var me,fe,He=!(!(me=h).isReady()&&bM[He]!==1)||(fe={code:fe=me.getNotReadyReason(),message:"".concat(me.getErrMsg(fe)," | ").concat(He," | ").concat(me.getErrMsg(Je.SDK_IS_NOT_READY))},me.onError(fe),fe);return He===!0?se():De(He)}).use(function(q,se){if(function(me,fe,He){if(fe===void 0)return!0;var Xe=!0;if(On(fe))Object.keys(fe).forEach(function(Lt){var yt=me.length===1?me[0][Lt]:void 0;Xe=!!vl(yt,fe[Lt],He,Lt)&&Xe});else if(wt(fe))for(var Ye=0;Ye<fe.length;Ye++)Xe=!!vl(me[Ye],fe[Ye],He,fe[Ye].name)&&Xe;if(Xe)return Xe;throw new Error("Params validate failed.")}(q,Av[D],D)===!0)return se()}).use(function(q,se){return h[D].apply(h,q)}),V.run($)})}),m);return vc[s]=T,Av.hookGetAPITips(I.getErrMsg.bind(I)),K.l("".concat(a," ok")),T},cr.TYPES=O,cr.EVENT=W,cr.TSignaling=Q,cr.VERSION="3.5.4",K.l("TencentCloudChat.VERSION:".concat(cr.VERSION)),cr})})(j7);var Mde=j7.exports;const sg=Ns(Mde);var Y7={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){function o(J,oe){var pe=Object.keys(J);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(J);oe&&(ie=ie.filter(function(te){return Object.getOwnPropertyDescriptor(J,te).enumerable})),pe.push.apply(pe,ie)}return pe}function i(J){for(var oe=1;oe<arguments.length;oe++){var pe=arguments[oe]!=null?arguments[oe]:{};oe%2?o(Object(pe),!0).forEach(function(ie){v(J,ie,pe[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(pe)):o(Object(pe)).forEach(function(ie){Object.defineProperty(J,ie,Object.getOwnPropertyDescriptor(pe,ie))})}return J}function c(J){return(c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe})(J)}function u(J,oe){if(!(J instanceof oe))throw new TypeError("Cannot call a class as a function")}function f(J,oe){for(var pe=0;pe<oe.length;pe++){var ie=oe[pe];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(J,ie.key,ie)}}function p(J,oe,pe){return oe&&f(J.prototype,oe),pe&&f(J,pe),Object.defineProperty(J,"prototype",{writable:!1}),J}function v(J,oe,pe){return oe in J?Object.defineProperty(J,oe,{value:pe,enumerable:!0,configurable:!0,writable:!0}):J[oe]=pe,J}function _(J,oe){if(J==null)return{};var pe,ie,te=function(re,X){if(re==null)return{};var ye,ue,Ie={},ve=Object.keys(re);for(ue=0;ue<ve.length;ue++)ye=ve[ue],X.indexOf(ye)>=0||(Ie[ye]=re[ye]);return Ie}(J,oe);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(J);for(ie=0;ie<he.length;ie++)pe=he[ie],oe.indexOf(pe)>=0||Object.prototype.propertyIsEnumerable.call(J,pe)&&(te[pe]=J[pe])}return te}var b=typeof wr<"u"?wr:typeof self<"u"?self:typeof window<"u"?window:{},S=typeof wx<"u"&&typeof wx.getSystemInfoSync=="function"&&!!wx.getSystemInfoSync().fontSizeSetting,k=typeof qq<"u"&&typeof qq.getSystemInfoSync=="function"&&!!qq.getSystemInfoSync().fontSizeSetting,M=typeof tt<"u"&&typeof tt.getSystemInfoSync=="function"&&!!tt.getSystemInfoSync().fontSizeSetting,R=typeof swan<"u"&&typeof swan.getSystemInfoSync=="function"&&!!swan.getSystemInfoSync().fontSizeSetting,w=typeof my<"u"&&typeof my.getSystemInfoSync=="function"&&!!my.getSystemInfoSync().fontSizeSetting,E=typeof uni<"u"&&typeof window>"u"&&typeof uni.requireNativePlugin=="function",N=E&&uni.getDeviceInfo().platform.toLocaleLowerCase()==="ios",F=(E&&uni.getDeviceInfo().platform.toLocaleLowerCase(),S||k||M||R||w||E),x=b!==void 0&&(b.nativeModuleProxy!==void 0||b.ReactNative!==void 0),P=k?qq:M?tt:R?swan:w?my:S?wx:E?uni:{},G=function(J){if(c(J)!=="object"||J===null)return!1;var oe=Object.getPrototypeOf(J);if(oe===null)return!0;for(var pe=oe;Object.getPrototypeOf(pe)!==null;)pe=Object.getPrototypeOf(pe);return oe===pe};function H(J){if(J==null)return!0;if(typeof J=="boolean")return!1;if(typeof J=="number")return J===0;if(typeof J=="string"||typeof J=="function"||Array.isArray(J))return J.length===0;if(J instanceof Error)return J.message==="";if(G(J)){for(var oe in J)if(Object.prototype.hasOwnProperty.call(J,oe))return!1;return!0}return!1}var Y=function(){function J(){u(this,J),this._n="WebRequest"}return p(J,[{key:"request",value:function(oe,pe){var ie=this,te="".concat(this._n,".request"),he=oe.downloadUrl||"",re=(oe.method||"PUT").toUpperCase(),X=oe.url;if(console.log("%c tim-upload-plugin %c","background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent","".concat(te," URL:").concat(X)),oe.qs){var ye=function(Ce){var Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",Oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"=";return H(Ce)?"":G(Ce)?Object.keys(Ce).map(function(be){var xe=encodeURIComponent(be)+Oe;return Array.isArray(Ce[be])?Ce[be].map(function(Le){return xe+encodeURIComponent(Le)}).join(Fe):xe+encodeURIComponent(Ce[be])}).filter(Boolean).join(Fe):void 0}(oe.qs);ye&&(X+="".concat(X.indexOf("?")===-1?"?":"&").concat(ye))}var ue=new XMLHttpRequest;ue.open(re,X,!0),ue.responseType=oe.dataType||"text";var Ie=oe.headers||{};if(oe.uploadByIP&&(Ie=i(i({},Ie),{},{host:oe.uploadIP})),!H(Ie))for(var ve in Ie)Ie.hasOwnProperty(ve)&&ve.toLowerCase()!=="content-length"&&ve.toLowerCase()!=="user-agent"&&ve.toLowerCase()!=="origin"&&ve.toLowerCase()!=="host"&&ue.setRequestHeader(ve,Ie[ve]);return ue.onload=function(){if(ue.status===200)pe(null,ie._xhrRes(ue,ie._xhrBody(ue,he,oe.uploadByIP&&oe.uploadIP),Ie));else{if(oe.uploadIP&&oe.url.indexOf(oe.uploadIP)===-1)return oe.url=function(Fe,Oe){return Fe.replace(/^http(s)?:\/\/(.*?)\//,"https://".concat(Oe,"/"))}(oe.url,oe.uploadIP),oe.uploadByIP=!0,ie.request(oe,pe);var Ce={code:ue.status,message:JSON.stringify(ue.responseText)};pe(Ce,ie._xhrRes(ue,ie._xhrBody(ue,he,oe.uploadByIP&&oe.uploadIP),Ie))}},ue.onerror=function(Ce){var Fe=ie._xhrBody(ue,he,oe.uploadByIP&&oe.uploadIP),Oe={code:ue.status,message:JSON.stringify(ue.responseText)};Fe||ue.statusText||ue.status!==0||(Ce.message="CORS blocked or network error"),pe(Oe,ie._xhrRes(ue,Fe)),Oe=null},oe.onProgress&&ue.upload&&(ue.upload.onprogress=function(Ce){var Fe=Ce.total,Oe=Ce.loaded,be=Math.floor(100*Oe/Fe);oe.onProgress({total:Fe,loaded:Oe,percent:(be>=100?100:be)/100})}),ue.send(oe.resources),ue}},{key:"_xhrRes",value:function(oe,pe){var ie={};return oe.getAllResponseHeaders().trim().split(`
`).forEach(function(te){if(te){var he=te.indexOf(":"),re=te.substr(0,he).trim().toLowerCase(),X=te.substr(he+1).trim();ie[re]=X}}),{statusCode:oe.status,statusMessage:oe.statusText,headers:ie,data:pe}}},{key:"_xhrBody",value:function(oe,pe,ie){return oe.status===200&&pe?{location:pe,uploadIP:ie}:{response:oe.responseText,uploadIP:ie}}}]),J}(),j=["unknown","image","video","audio","log"],W=["name"],O=function(){function J(){u(this,J)}return p(J,[{key:"request",value:function(oe,pe){var ie=this,te=oe.resources,he=te===void 0?"":te,re=oe.headers,X=re===void 0?{}:re,ye=oe.url,ue=oe.downloadUrl,Ie=ue===void 0?"":ue,ve=ye,Ce=null,Fe=Ie.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),Oe=decodeURIComponent(Fe[3]),be=Oe.indexOf("?")>-1?Oe.split("?")[0]:Oe,xe={key:oe.fileKey?oe.fileKey:be,success_action_status:200,"Content-Type":""},Le={};if(N){var rt=ye.split("?sign=");if(rt.length>1){var Qe=rt[1];ve="".concat(rt[0],"?sign=").concat(encodeURIComponent("".concat(Qe))),Le.sign=decodeURIComponent(Qe),Le.signature=decodeURIComponent(Qe)}}var Ge={url:ve,header:X,name:"file",filePath:he,formData:i(i({},xe),Le),timeout:oe.timeout||3e5};if(w){var _e=Ge;_e.name,Ge=i(i({},_(_e,W)),{},{fileName:"file",fileType:j[oe.fileType]})}return(Ce=P.uploadFile(i(i({},Ge),{},{success:function(Re){ie._handleResponse({response:Re,downloadUrl:Ie,callback:pe})},fail:function(Re){ie._handleResponse({response:Re,downloadUrl:Ie,callback:pe})}}))).onProgressUpdate&&Ce.onProgressUpdate(function(Re){oe.onProgress&&oe.onProgress({total:Re.totalBytesExpectedToSend,loaded:Re.totalBytesSent,percent:Math.floor(Re.progress)/100})}),Ce}},{key:"_handleResponse",value:function(oe){var pe=oe.downloadUrl,ie=oe.response,te=oe.callback,he=ie.header,re={};if(he)for(var X in he)he.hasOwnProperty(X)&&(re[X.toLowerCase()]=he[X]);var ye=+ie.statusCode;ye===200?te(null,{statusCode:ye,headers:re,data:i(i({},ie.data),{},{location:pe})}):te({code:ye,message:JSON.stringify(ie.data)},{statusCode:ye,headers:re,data:void 0})}}]),J}(),Q=function(){function J(){u(this,J)}return p(J,[{key:"request",value:function(oe,pe){var ie=this,te=oe.resources,he=te===void 0?"":te,re=oe.fileKey,X=re===void 0?"":re,ye=oe.url,ue=oe.downloadUrl,Ie=ue===void 0?"":ue,ve=new FormData;ve.append("key",X),ve.append("success_action_status",200),ve.append("file",{uri:he,type:"application/octet-stream",name:"uploaded_file"}),fetch(ye,{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:ve}).then(function(Ce){ie._handleResponse({response:Ce,downloadUrl:Ie,callback:pe})}).catch(function(Ce){ie._handleResponse({response:Ce,downloadUrl:Ie,callback:pe})})}},{key:"_handleResponse",value:function(oe){var pe=oe.downloadUrl,ie=oe.response,te=oe.callback,he=ie.headers,re=ie.status,X=he&&he.map||{};re===200?te(null,{statusCode:200,headers:X,data:{location:pe}}):te({code:re,message:JSON.stringify(ie)},{statusCode:re,headers:X,data:void 0})}}]),J}();return function(){function J(){u(this,J),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=F?new O:x?new Q:new Y,console.log("TIMUploadPlugin.VERSION: ".concat("1.4.2"))}return p(J,[{key:"uploadFile",value:function(oe,pe){var ie=this;return this.httpRequest.request(oe,function(te,he){te&&ie.tryCount<ie.retry&&ie.allowRetry(te)?(ie.tryCount++,ie.uploadFile(oe,pe)):(ie.tryCount=0,pe(te,he))})}},{key:"allowRetry",value:function(oe){var pe=!1,ie=!1;if(oe){var te=oe.headers&&(oe.headers.date||oe.headers.Date)||oe.error&&oe.error.ServerTime;try{var he=oe.error&&oe.error.Code,re=oe.error&&oe.error.Message;(he==="RequestTimeTooSkewed"||he==="AccessDenied"&&re==="Request has expired")&&(ie=!0)}catch{}if(ie&&te){var X=Date.now(),ye=Date.parse(te);Math.abs(X+this.systemClockOffset-ye)>=3e4&&(this.systemClockOffset=ye-X,pe=!0)}else Math.floor(oe.statusCode/100)===5&&(pe=!0)}return pe}}],[{key:"getVersion",value:function(){return"1.4.2"}}]),J}()})})(Y7);var kde=Y7.exports;const wde=Ns(kde),Rde="2.9.9",$5=Symbol("INSTALLED_KEY"),J7=Symbol(),r0="el",Ade="is-",wf=(e,t,o,i,c)=>{let u=`${e}-${t}`;return o&&(u+=`-${o}`),i&&(u+=`__${i}`),c&&(u+=`--${c}`),u},X7=Symbol("namespaceContextKey"),xL=e=>{const t=e||(kn()?Rt(X7,le(r0)):le(r0));return z(()=>y(t)||r0)},ut=(e,t)=>{const o=xL(t);return{namespace:o,b:(w="")=>wf(o.value,e,w,"",""),e:w=>w?wf(o.value,e,"",w,""):"",m:w=>w?wf(o.value,e,"","",w):"",be:(w,E)=>w&&E?wf(o.value,e,w,E,""):"",em:(w,E)=>w&&E?wf(o.value,e,"",w,E):"",bm:(w,E)=>w&&E?wf(o.value,e,w,"",E):"",bem:(w,E,N)=>w&&E&&N?wf(o.value,e,w,E,N):"",is:(w,...E)=>{const N=E.length>=1?E[0]:!0;return w&&N?`${Ade}${w}`:""},cssVar:w=>{const E={};for(const N in w)w[N]&&(E[`--${o.value}-${N}`]=w[N]);return E},cssVarName:w=>`--${o.value}-${w}`,cssVarBlock:w=>{const E={};for(const N in w)w[N]&&(E[`--${o.value}-${e}-${N}`]=w[N]);return E},cssVarBlockName:w=>`--${o.value}-${e}-${w}`}};var Z7=typeof global=="object"&&global&&global.Object===Object&&global,Dde=typeof self=="object"&&self&&self.Object===Object&&self,hl=Z7||Dde||Function("return this")(),Rs=hl.Symbol,Q7=Object.prototype,Ode=Q7.hasOwnProperty,Lde=Q7.toString,Dy=Rs?Rs.toStringTag:void 0;function Nde(e){var t=Ode.call(e,Dy),o=e[Dy];try{e[Dy]=void 0;var i=!0}catch{}var c=Lde.call(e);return i&&(t?e[Dy]=o:delete e[Dy]),c}var Pde=Object.prototype,xde=Pde.toString;function Ude(e){return xde.call(e)}var Fde="[object Null]",Vde="[object Undefined]",q5=Rs?Rs.toStringTag:void 0;function mp(e){return e==null?e===void 0?Vde:Fde:q5&&q5 in Object(e)?Nde(e):Ude(e)}function Ql(e){return e!=null&&typeof e=="object"}var Gde="[object Symbol]";function kT(e){return typeof e=="symbol"||Ql(e)&&mp(e)==Gde}function UL(e,t){for(var o=-1,i=e==null?0:e.length,c=Array(i);++o<i;)c[o]=t(e[o],o,e);return c}var ua=Array.isArray,Bde=1/0,K5=Rs?Rs.prototype:void 0,z5=K5?K5.toString:void 0;function eq(e){if(typeof e=="string")return e;if(ua(e))return UL(e,eq)+"";if(kT(e))return z5?z5.call(e):"";var t=e+"";return t=="0"&&1/e==-Bde?"-0":t}var Hde=/\s/;function $de(e){for(var t=e.length;t--&&Hde.test(e.charAt(t)););return t}var qde=/^\s+/;function Kde(e){return e&&e.slice(0,$de(e)+1).replace(qde,"")}function da(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var W5=NaN,zde=/^[-+]0x[0-9a-f]+$/i,Wde=/^0b[01]+$/i,jde=/^0o[0-7]+$/i,Yde=parseInt;function j5(e){if(typeof e=="number")return e;if(kT(e))return W5;if(da(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=da(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Kde(e);var o=Wde.test(e);return o||jde.test(e)?Yde(e.slice(2),o?2:8):zde.test(e)?W5:+e}function FL(e){return e}var Jde="[object AsyncFunction]",Xde="[object Function]",Zde="[object GeneratorFunction]",Qde="[object Proxy]";function VL(e){if(!da(e))return!1;var t=mp(e);return t==Xde||t==Zde||t==Jde||t==Qde}var $A=hl["__core-js_shared__"],Y5=function(){var e=/[^.]+$/.exec($A&&$A.keys&&$A.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ehe(e){return!!Y5&&Y5 in e}var the=Function.prototype,nhe=the.toString;function gp(e){if(e!=null){try{return nhe.call(e)}catch{}try{return e+""}catch{}}return""}var ohe=/[\\^$.*+?()[\]{}|]/g,rhe=/^\[object .+?Constructor\]$/,ihe=Function.prototype,ahe=Object.prototype,she=ihe.toString,lhe=ahe.hasOwnProperty,che=RegExp("^"+she.call(lhe).replace(ohe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uhe(e){if(!da(e)||ehe(e))return!1;var t=VL(e)?che:rhe;return t.test(gp(e))}function dhe(e,t){return e==null?void 0:e[t]}function vp(e,t){var o=dhe(e,t);return uhe(o)?o:void 0}var $D=vp(hl,"WeakMap"),J5=Object.create,hhe=function(){function e(){}return function(t){if(!da(t))return{};if(J5)return J5(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();function fhe(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function phe(){}function tq(e,t){var o=-1,i=e.length;for(t||(t=Array(i));++o<i;)t[o]=e[o];return t}var mhe=800,ghe=16,vhe=Date.now;function _he(e){var t=0,o=0;return function(){var i=vhe(),c=ghe-(i-o);if(o=i,c>0){if(++t>=mhe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function yhe(e){return function(){return e}}var GE=function(){try{var e=vp(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ihe=GE?function(e,t){return GE(e,"toString",{configurable:!0,enumerable:!1,value:yhe(t),writable:!0})}:FL,nq=_he(Ihe);function bhe(e,t){for(var o=-1,i=e==null?0:e.length;++o<i&&t(e[o],o,e)!==!1;);return e}function oq(e,t,o,i){for(var c=e.length,u=o+(i?1:-1);i?u--:++u<c;)if(t(e[u],u,e))return u;return-1}function Che(e){return e!==e}function She(e,t,o){for(var i=o-1,c=e.length;++i<c;)if(e[i]===t)return i;return-1}function Ehe(e,t,o){return t===t?She(e,t,o):oq(e,Che,o)}function The(e,t){var o=e==null?0:e.length;return!!o&&Ehe(e,t,0)>-1}var Mhe=9007199254740991,khe=/^(?:0|[1-9]\d*)$/;function wT(e,t){var o=typeof e;return t=t??Mhe,!!t&&(o=="number"||o!="symbol"&&khe.test(e))&&e>-1&&e%1==0&&e<t}function GL(e,t,o){t=="__proto__"&&GE?GE(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function tI(e,t){return e===t||e!==e&&t!==t}var whe=Object.prototype,Rhe=whe.hasOwnProperty;function BL(e,t,o){var i=e[t];(!(Rhe.call(e,t)&&tI(i,o))||o===void 0&&!(t in e))&&GL(e,t,o)}function uv(e,t,o,i){var c=!o;o||(o={});for(var u=-1,f=t.length;++u<f;){var p=t[u],v=void 0;v===void 0&&(v=e[p]),c?GL(o,p,v):BL(o,p,v)}return o}var X5=Math.max;function rq(e,t,o){return t=X5(t===void 0?e.length-1:t,0),function(){for(var i=arguments,c=-1,u=X5(i.length-t,0),f=Array(u);++c<u;)f[c]=i[t+c];c=-1;for(var p=Array(t+1);++c<t;)p[c]=i[c];return p[t]=o(f),fhe(e,this,p)}}function iq(e,t){return nq(rq(e,t,FL),e+"")}var Ahe=9007199254740991;function HL(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ahe}function dv(e){return e!=null&&HL(e.length)&&!VL(e)}function Dhe(e,t,o){if(!da(o))return!1;var i=typeof t;return(i=="number"?dv(o)&&wT(t,o.length):i=="string"&&t in o)?tI(o[t],e):!1}function Ohe(e){return iq(function(t,o){var i=-1,c=o.length,u=c>1?o[c-1]:void 0,f=c>2?o[2]:void 0;for(u=e.length>3&&typeof u=="function"?(c--,u):void 0,f&&Dhe(o[0],o[1],f)&&(u=c<3?void 0:u,c=1),t=Object(t);++i<c;){var p=o[i];p&&e(t,p,i,u)}return t})}var Lhe=Object.prototype;function $L(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||Lhe;return e===o}function Nhe(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}var Phe="[object Arguments]";function Z5(e){return Ql(e)&&mp(e)==Phe}var aq=Object.prototype,xhe=aq.hasOwnProperty,Uhe=aq.propertyIsEnumerable,w0=Z5(function(){return arguments}())?Z5:function(e){return Ql(e)&&xhe.call(e,"callee")&&!Uhe.call(e,"callee")};function Fhe(){return!1}var sq=typeof es=="object"&&es&&!es.nodeType&&es,Q5=sq&&typeof ts=="object"&&ts&&!ts.nodeType&&ts,Vhe=Q5&&Q5.exports===sq,e8=Vhe?hl.Buffer:void 0,Ghe=e8?e8.isBuffer:void 0,R0=Ghe||Fhe,Bhe="[object Arguments]",Hhe="[object Array]",$he="[object Boolean]",qhe="[object Date]",Khe="[object Error]",zhe="[object Function]",Whe="[object Map]",jhe="[object Number]",Yhe="[object Object]",Jhe="[object RegExp]",Xhe="[object Set]",Zhe="[object String]",Qhe="[object WeakMap]",efe="[object ArrayBuffer]",tfe="[object DataView]",nfe="[object Float32Array]",ofe="[object Float64Array]",rfe="[object Int8Array]",ife="[object Int16Array]",afe="[object Int32Array]",sfe="[object Uint8Array]",lfe="[object Uint8ClampedArray]",cfe="[object Uint16Array]",ufe="[object Uint32Array]",yr={};yr[nfe]=yr[ofe]=yr[rfe]=yr[ife]=yr[afe]=yr[sfe]=yr[lfe]=yr[cfe]=yr[ufe]=!0;yr[Bhe]=yr[Hhe]=yr[efe]=yr[$he]=yr[tfe]=yr[qhe]=yr[Khe]=yr[zhe]=yr[Whe]=yr[jhe]=yr[Yhe]=yr[Jhe]=yr[Xhe]=yr[Zhe]=yr[Qhe]=!1;function dfe(e){return Ql(e)&&HL(e.length)&&!!yr[mp(e)]}function qL(e){return function(t){return e(t)}}var lq=typeof es=="object"&&es&&!es.nodeType&&es,i0=lq&&typeof ts=="object"&&ts&&!ts.nodeType&&ts,hfe=i0&&i0.exports===lq,qA=hfe&&Z7.process,qg=function(){try{var e=i0&&i0.require&&i0.require("util").types;return e||qA&&qA.binding&&qA.binding("util")}catch{}}(),t8=qg&&qg.isTypedArray,KL=t8?qL(t8):dfe,ffe=Object.prototype,pfe=ffe.hasOwnProperty;function cq(e,t){var o=ua(e),i=!o&&w0(e),c=!o&&!i&&R0(e),u=!o&&!i&&!c&&KL(e),f=o||i||c||u,p=f?Nhe(e.length,String):[],v=p.length;for(var _ in e)(t||pfe.call(e,_))&&!(f&&(_=="length"||c&&(_=="offset"||_=="parent")||u&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||wT(_,v)))&&p.push(_);return p}function uq(e,t){return function(o){return e(t(o))}}var mfe=uq(Object.keys,Object),gfe=Object.prototype,vfe=gfe.hasOwnProperty;function _fe(e){if(!$L(e))return mfe(e);var t=[];for(var o in Object(e))vfe.call(e,o)&&o!="constructor"&&t.push(o);return t}function nI(e){return dv(e)?cq(e):_fe(e)}function yfe(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var Ife=Object.prototype,bfe=Ife.hasOwnProperty;function Cfe(e){if(!da(e))return yfe(e);var t=$L(e),o=[];for(var i in e)i=="constructor"&&(t||!bfe.call(e,i))||o.push(i);return o}function oI(e){return dv(e)?cq(e,!0):Cfe(e)}var Sfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Efe=/^\w*$/;function zL(e,t){if(ua(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||kT(e)?!0:Efe.test(e)||!Sfe.test(e)||t!=null&&e in Object(t)}var A0=vp(Object,"create");function Tfe(){this.__data__=A0?A0(null):{},this.size=0}function Mfe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var kfe="__lodash_hash_undefined__",wfe=Object.prototype,Rfe=wfe.hasOwnProperty;function Afe(e){var t=this.__data__;if(A0){var o=t[e];return o===kfe?void 0:o}return Rfe.call(t,e)?t[e]:void 0}var Dfe=Object.prototype,Ofe=Dfe.hasOwnProperty;function Lfe(e){var t=this.__data__;return A0?t[e]!==void 0:Ofe.call(t,e)}var Nfe="__lodash_hash_undefined__";function Pfe(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=A0&&t===void 0?Nfe:t,this}function lp(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}lp.prototype.clear=Tfe;lp.prototype.delete=Mfe;lp.prototype.get=Afe;lp.prototype.has=Lfe;lp.prototype.set=Pfe;function xfe(){this.__data__=[],this.size=0}function RT(e,t){for(var o=e.length;o--;)if(tI(e[o][0],t))return o;return-1}var Ufe=Array.prototype,Ffe=Ufe.splice;function Vfe(e){var t=this.__data__,o=RT(t,e);if(o<0)return!1;var i=t.length-1;return o==i?t.pop():Ffe.call(t,o,1),--this.size,!0}function Gfe(e){var t=this.__data__,o=RT(t,e);return o<0?void 0:t[o][1]}function Bfe(e){return RT(this.__data__,e)>-1}function Hfe(e,t){var o=this.__data__,i=RT(o,e);return i<0?(++this.size,o.push([e,t])):o[i][1]=t,this}function du(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}du.prototype.clear=xfe;du.prototype.delete=Vfe;du.prototype.get=Gfe;du.prototype.has=Bfe;du.prototype.set=Hfe;var D0=vp(hl,"Map");function $fe(){this.size=0,this.__data__={hash:new lp,map:new(D0||du),string:new lp}}function qfe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function AT(e,t){var o=e.__data__;return qfe(t)?o[typeof t=="string"?"string":"hash"]:o.map}function Kfe(e){var t=AT(this,e).delete(e);return this.size-=t?1:0,t}function zfe(e){return AT(this,e).get(e)}function Wfe(e){return AT(this,e).has(e)}function jfe(e,t){var o=AT(this,e),i=o.size;return o.set(e,t),this.size+=o.size==i?0:1,this}function hu(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}hu.prototype.clear=$fe;hu.prototype.delete=Kfe;hu.prototype.get=zfe;hu.prototype.has=Wfe;hu.prototype.set=jfe;var Yfe="Expected a function";function DT(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Yfe);var o=function(){var i=arguments,c=t?t.apply(this,i):i[0],u=o.cache;if(u.has(c))return u.get(c);var f=e.apply(this,i);return o.cache=u.set(c,f)||u,f};return o.cache=new(DT.Cache||hu),o}DT.Cache=hu;var Jfe=500;function Xfe(e){var t=DT(e,function(i){return o.size===Jfe&&o.clear(),i}),o=t.cache;return t}var Zfe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qfe=/\\(\\)?/g,epe=Xfe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Zfe,function(o,i,c,u){t.push(c?u.replace(Qfe,"$1"):i||o)}),t});function tpe(e){return e==null?"":eq(e)}function hv(e,t){return ua(e)?e:zL(e,t)?[e]:epe(tpe(e))}var npe=1/0;function fv(e){if(typeof e=="string"||kT(e))return e;var t=e+"";return t=="0"&&1/e==-npe?"-0":t}function OT(e,t){t=hv(t,e);for(var o=0,i=t.length;e!=null&&o<i;)e=e[fv(t[o++])];return o&&o==i?e:void 0}function Rr(e,t,o){var i=e==null?void 0:OT(e,t);return i===void 0?o:i}function WL(e,t){for(var o=-1,i=t.length,c=e.length;++o<i;)e[c+o]=t[o];return e}var n8=Rs?Rs.isConcatSpreadable:void 0;function ope(e){return ua(e)||w0(e)||!!(n8&&e&&e[n8])}function rI(e,t,o,i,c){var u=-1,f=e.length;for(o||(o=ope),c||(c=[]);++u<f;){var p=e[u];t>0&&o(p)?t>1?rI(p,t-1,o,i,c):WL(c,p):i||(c[c.length]=p)}return c}function dq(e){var t=e==null?0:e.length;return t?rI(e,1):[]}function hq(e){return nq(rq(e,void 0,dq),e+"")}var jL=uq(Object.getPrototypeOf,Object),rpe="[object Object]",ipe=Function.prototype,ape=Object.prototype,fq=ipe.toString,spe=ape.hasOwnProperty,lpe=fq.call(Object);function pq(e){if(!Ql(e)||mp(e)!=rpe)return!1;var t=jL(e);if(t===null)return!0;var o=spe.call(t,"constructor")&&t.constructor;return typeof o=="function"&&o instanceof o&&fq.call(o)==lpe}function cpe(e,t,o){var i=-1,c=e.length;t<0&&(t=-t>c?0:c+t),o=o>c?c:o,o<0&&(o+=c),c=t>o?0:o-t>>>0,t>>>=0;for(var u=Array(c);++i<c;)u[i]=e[i+t];return u}function Wi(){if(!arguments.length)return[];var e=arguments[0];return ua(e)?e:[e]}function upe(){this.__data__=new du,this.size=0}function dpe(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function hpe(e){return this.__data__.get(e)}function fpe(e){return this.__data__.has(e)}var ppe=200;function mpe(e,t){var o=this.__data__;if(o instanceof du){var i=o.__data__;if(!D0||i.length<ppe-1)return i.push([e,t]),this.size=++o.size,this;o=this.__data__=new hu(i)}return o.set(e,t),this.size=o.size,this}function ll(e){var t=this.__data__=new du(e);this.size=t.size}ll.prototype.clear=upe;ll.prototype.delete=dpe;ll.prototype.get=hpe;ll.prototype.has=fpe;ll.prototype.set=mpe;function gpe(e,t){return e&&uv(t,nI(t),e)}function vpe(e,t){return e&&uv(t,oI(t),e)}var mq=typeof es=="object"&&es&&!es.nodeType&&es,o8=mq&&typeof ts=="object"&&ts&&!ts.nodeType&&ts,_pe=o8&&o8.exports===mq,r8=_pe?hl.Buffer:void 0,i8=r8?r8.allocUnsafe:void 0;function gq(e,t){if(t)return e.slice();var o=e.length,i=i8?i8(o):new e.constructor(o);return e.copy(i),i}function ype(e,t){for(var o=-1,i=e==null?0:e.length,c=0,u=[];++o<i;){var f=e[o];t(f,o,e)&&(u[c++]=f)}return u}function vq(){return[]}var Ipe=Object.prototype,bpe=Ipe.propertyIsEnumerable,a8=Object.getOwnPropertySymbols,YL=a8?function(e){return e==null?[]:(e=Object(e),ype(a8(e),function(t){return bpe.call(e,t)}))}:vq;function Cpe(e,t){return uv(e,YL(e),t)}var Spe=Object.getOwnPropertySymbols,_q=Spe?function(e){for(var t=[];e;)WL(t,YL(e)),e=jL(e);return t}:vq;function Epe(e,t){return uv(e,_q(e),t)}function yq(e,t,o){var i=t(e);return ua(e)?i:WL(i,o(e))}function qD(e){return yq(e,nI,YL)}function Iq(e){return yq(e,oI,_q)}var KD=vp(hl,"DataView"),zD=vp(hl,"Promise"),Ag=vp(hl,"Set"),s8="[object Map]",Tpe="[object Object]",l8="[object Promise]",c8="[object Set]",u8="[object WeakMap]",d8="[object DataView]",Mpe=gp(KD),kpe=gp(D0),wpe=gp(zD),Rpe=gp(Ag),Ape=gp($D),ol=mp;(KD&&ol(new KD(new ArrayBuffer(1)))!=d8||D0&&ol(new D0)!=s8||zD&&ol(zD.resolve())!=l8||Ag&&ol(new Ag)!=c8||$D&&ol(new $D)!=u8)&&(ol=function(e){var t=mp(e),o=t==Tpe?e.constructor:void 0,i=o?gp(o):"";if(i)switch(i){case Mpe:return d8;case kpe:return s8;case wpe:return l8;case Rpe:return c8;case Ape:return u8}return t});var Dpe=Object.prototype,Ope=Dpe.hasOwnProperty;function Lpe(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&Ope.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var BE=hl.Uint8Array;function JL(e){var t=new e.constructor(e.byteLength);return new BE(t).set(new BE(e)),t}function Npe(e,t){var o=t?JL(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var Ppe=/\w*$/;function xpe(e){var t=new e.constructor(e.source,Ppe.exec(e));return t.lastIndex=e.lastIndex,t}var h8=Rs?Rs.prototype:void 0,f8=h8?h8.valueOf:void 0;function Upe(e){return f8?Object(f8.call(e)):{}}function bq(e,t){var o=t?JL(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var Fpe="[object Boolean]",Vpe="[object Date]",Gpe="[object Map]",Bpe="[object Number]",Hpe="[object RegExp]",$pe="[object Set]",qpe="[object String]",Kpe="[object Symbol]",zpe="[object ArrayBuffer]",Wpe="[object DataView]",jpe="[object Float32Array]",Ype="[object Float64Array]",Jpe="[object Int8Array]",Xpe="[object Int16Array]",Zpe="[object Int32Array]",Qpe="[object Uint8Array]",eme="[object Uint8ClampedArray]",tme="[object Uint16Array]",nme="[object Uint32Array]";function ome(e,t,o){var i=e.constructor;switch(t){case zpe:return JL(e);case Fpe:case Vpe:return new i(+e);case Wpe:return Npe(e,o);case jpe:case Ype:case Jpe:case Xpe:case Zpe:case Qpe:case eme:case tme:case nme:return bq(e,o);case Gpe:return new i;case Bpe:case qpe:return new i(e);case Hpe:return xpe(e);case $pe:return new i;case Kpe:return Upe(e)}}function Cq(e){return typeof e.constructor=="function"&&!$L(e)?hhe(jL(e)):{}}var rme="[object Map]";function ime(e){return Ql(e)&&ol(e)==rme}var p8=qg&&qg.isMap,ame=p8?qL(p8):ime,sme="[object Set]";function lme(e){return Ql(e)&&ol(e)==sme}var m8=qg&&qg.isSet,cme=m8?qL(m8):lme,ume=1,dme=2,hme=4,Sq="[object Arguments]",fme="[object Array]",pme="[object Boolean]",mme="[object Date]",gme="[object Error]",Eq="[object Function]",vme="[object GeneratorFunction]",_me="[object Map]",yme="[object Number]",Tq="[object Object]",Ime="[object RegExp]",bme="[object Set]",Cme="[object String]",Sme="[object Symbol]",Eme="[object WeakMap]",Tme="[object ArrayBuffer]",Mme="[object DataView]",kme="[object Float32Array]",wme="[object Float64Array]",Rme="[object Int8Array]",Ame="[object Int16Array]",Dme="[object Int32Array]",Ome="[object Uint8Array]",Lme="[object Uint8ClampedArray]",Nme="[object Uint16Array]",Pme="[object Uint32Array]",mr={};mr[Sq]=mr[fme]=mr[Tme]=mr[Mme]=mr[pme]=mr[mme]=mr[kme]=mr[wme]=mr[Rme]=mr[Ame]=mr[Dme]=mr[_me]=mr[yme]=mr[Tq]=mr[Ime]=mr[bme]=mr[Cme]=mr[Sme]=mr[Ome]=mr[Lme]=mr[Nme]=mr[Pme]=!0;mr[gme]=mr[Eq]=mr[Eme]=!1;function Dg(e,t,o,i,c,u){var f,p=t&ume,v=t&dme,_=t&hme;if(o&&(f=c?o(e,i,c,u):o(e)),f!==void 0)return f;if(!da(e))return e;var b=ua(e);if(b){if(f=Lpe(e),!p)return tq(e,f)}else{var S=ol(e),k=S==Eq||S==vme;if(R0(e))return gq(e,p);if(S==Tq||S==Sq||k&&!c){if(f=v||k?{}:Cq(e),!p)return v?Epe(e,vpe(f,e)):Cpe(e,gpe(f,e))}else{if(!mr[S])return c?e:{};f=ome(e,S,p)}}u||(u=new ll);var M=u.get(e);if(M)return M;u.set(e,f),cme(e)?e.forEach(function(E){f.add(Dg(E,t,o,E,e,u))}):ame(e)&&e.forEach(function(E,N){f.set(N,Dg(E,t,o,N,e,u))});var R=_?v?Iq:qD:v?oI:nI,w=b?void 0:R(e);return bhe(w||e,function(E,N){w&&(N=E,E=e[N]),BL(f,N,Dg(E,t,o,N,e,u))}),f}var xme=4;function g8(e){return Dg(e,xme)}var Ume=1,Fme=4;function HE(e){return Dg(e,Ume|Fme)}var Vme="__lodash_hash_undefined__";function Gme(e){return this.__data__.set(e,Vme),this}function Bme(e){return this.__data__.has(e)}function O0(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new hu;++t<o;)this.add(e[t])}O0.prototype.add=O0.prototype.push=Gme;O0.prototype.has=Bme;function Hme(e,t){for(var o=-1,i=e==null?0:e.length;++o<i;)if(t(e[o],o,e))return!0;return!1}function Mq(e,t){return e.has(t)}var $me=1,qme=2;function kq(e,t,o,i,c,u){var f=o&$me,p=e.length,v=t.length;if(p!=v&&!(f&&v>p))return!1;var _=u.get(e),b=u.get(t);if(_&&b)return _==t&&b==e;var S=-1,k=!0,M=o&qme?new O0:void 0;for(u.set(e,t),u.set(t,e);++S<p;){var R=e[S],w=t[S];if(i)var E=f?i(w,R,S,t,e,u):i(R,w,S,e,t,u);if(E!==void 0){if(E)continue;k=!1;break}if(M){if(!Hme(t,function(N,F){if(!Mq(M,F)&&(R===N||c(R,N,o,i,u)))return M.push(F)})){k=!1;break}}else if(!(R===w||c(R,w,o,i,u))){k=!1;break}}return u.delete(e),u.delete(t),k}function Kme(e){var t=-1,o=Array(e.size);return e.forEach(function(i,c){o[++t]=[c,i]}),o}function XL(e){var t=-1,o=Array(e.size);return e.forEach(function(i){o[++t]=i}),o}var zme=1,Wme=2,jme="[object Boolean]",Yme="[object Date]",Jme="[object Error]",Xme="[object Map]",Zme="[object Number]",Qme="[object RegExp]",ege="[object Set]",tge="[object String]",nge="[object Symbol]",oge="[object ArrayBuffer]",rge="[object DataView]",v8=Rs?Rs.prototype:void 0,KA=v8?v8.valueOf:void 0;function ige(e,t,o,i,c,u,f){switch(o){case rge:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case oge:return!(e.byteLength!=t.byteLength||!u(new BE(e),new BE(t)));case jme:case Yme:case Zme:return tI(+e,+t);case Jme:return e.name==t.name&&e.message==t.message;case Qme:case tge:return e==t+"";case Xme:var p=Kme;case ege:var v=i&zme;if(p||(p=XL),e.size!=t.size&&!v)return!1;var _=f.get(e);if(_)return _==t;i|=Wme,f.set(e,t);var b=kq(p(e),p(t),i,c,u,f);return f.delete(e),b;case nge:if(KA)return KA.call(e)==KA.call(t)}return!1}var age=1,sge=Object.prototype,lge=sge.hasOwnProperty;function cge(e,t,o,i,c,u){var f=o&age,p=qD(e),v=p.length,_=qD(t),b=_.length;if(v!=b&&!f)return!1;for(var S=v;S--;){var k=p[S];if(!(f?k in t:lge.call(t,k)))return!1}var M=u.get(e),R=u.get(t);if(M&&R)return M==t&&R==e;var w=!0;u.set(e,t),u.set(t,e);for(var E=f;++S<v;){k=p[S];var N=e[k],F=t[k];if(i)var x=f?i(F,N,k,t,e,u):i(N,F,k,e,t,u);if(!(x===void 0?N===F||c(N,F,o,i,u):x)){w=!1;break}E||(E=k=="constructor")}if(w&&!E){var P=e.constructor,G=t.constructor;P!=G&&"constructor"in e&&"constructor"in t&&!(typeof P=="function"&&P instanceof P&&typeof G=="function"&&G instanceof G)&&(w=!1)}return u.delete(e),u.delete(t),w}var uge=1,_8="[object Arguments]",y8="[object Array]",PS="[object Object]",dge=Object.prototype,I8=dge.hasOwnProperty;function hge(e,t,o,i,c,u){var f=ua(e),p=ua(t),v=f?y8:ol(e),_=p?y8:ol(t);v=v==_8?PS:v,_=_==_8?PS:_;var b=v==PS,S=_==PS,k=v==_;if(k&&R0(e)){if(!R0(t))return!1;f=!0,b=!1}if(k&&!b)return u||(u=new ll),f||KL(e)?kq(e,t,o,i,c,u):ige(e,t,v,o,i,c,u);if(!(o&uge)){var M=b&&I8.call(e,"__wrapped__"),R=S&&I8.call(t,"__wrapped__");if(M||R){var w=M?e.value():e,E=R?t.value():t;return u||(u=new ll),c(w,E,o,i,u)}}return k?(u||(u=new ll),cge(e,t,o,i,c,u)):!1}function LT(e,t,o,i,c){return e===t?!0:e==null||t==null||!Ql(e)&&!Ql(t)?e!==e&&t!==t:hge(e,t,o,i,LT,c)}var fge=1,pge=2;function mge(e,t,o,i){var c=o.length,u=c;if(e==null)return!u;for(e=Object(e);c--;){var f=o[c];if(f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++c<u;){f=o[c];var p=f[0],v=e[p],_=f[1];if(f[2]){if(v===void 0&&!(p in e))return!1}else{var b=new ll,S;if(!(S===void 0?LT(_,v,fge|pge,i,b):S))return!1}}return!0}function wq(e){return e===e&&!da(e)}function gge(e){for(var t=nI(e),o=t.length;o--;){var i=t[o],c=e[i];t[o]=[i,c,wq(c)]}return t}function Rq(e,t){return function(o){return o==null?!1:o[e]===t&&(t!==void 0||e in Object(o))}}function vge(e){var t=gge(e);return t.length==1&&t[0][2]?Rq(t[0][0],t[0][1]):function(o){return o===e||mge(o,e,t)}}function _ge(e,t){return e!=null&&t in Object(e)}function yge(e,t,o){t=hv(t,e);for(var i=-1,c=t.length,u=!1;++i<c;){var f=fv(t[i]);if(!(u=e!=null&&o(e,f)))break;e=e[f]}return u||++i!=c?u:(c=e==null?0:e.length,!!c&&HL(c)&&wT(f,c)&&(ua(e)||w0(e)))}function Aq(e,t){return e!=null&&yge(e,t,_ge)}var Ige=1,bge=2;function Cge(e,t){return zL(e)&&wq(t)?Rq(fv(e),t):function(o){var i=Rr(o,e);return i===void 0&&i===t?Aq(o,e):LT(t,i,Ige|bge)}}function Sge(e){return function(t){return t==null?void 0:t[e]}}function Ege(e){return function(t){return OT(t,e)}}function Tge(e){return zL(e)?Sge(fv(e)):Ege(e)}function Dq(e){return typeof e=="function"?e:e==null?FL:typeof e=="object"?ua(e)?Cge(e[0],e[1]):vge(e):Tge(e)}function Mge(e){return function(t,o,i){for(var c=-1,u=Object(t),f=i(t),p=f.length;p--;){var v=f[++c];if(o(u[v],v,u)===!1)break}return t}}var Oq=Mge();function kge(e,t){return e&&Oq(e,t,nI)}function wge(e,t){return function(o,i){if(o==null)return o;if(!dv(o))return e(o,i);for(var c=o.length,u=-1,f=Object(o);++u<c&&i(f[u],u,f)!==!1;);return o}}var Rge=wge(kge),zA=function(){return hl.Date.now()},Age="Expected a function",Dge=Math.max,Oge=Math.min;function Oa(e,t,o){var i,c,u,f,p,v,_=0,b=!1,S=!1,k=!0;if(typeof e!="function")throw new TypeError(Age);t=j5(t)||0,da(o)&&(b=!!o.leading,S="maxWait"in o,u=S?Dge(j5(o.maxWait)||0,t):u,k="trailing"in o?!!o.trailing:k);function M(H){var Y=i,j=c;return i=c=void 0,_=H,f=e.apply(j,Y),f}function R(H){return _=H,p=setTimeout(N,t),b?M(H):f}function w(H){var Y=H-v,j=H-_,W=t-Y;return S?Oge(W,u-j):W}function E(H){var Y=H-v,j=H-_;return v===void 0||Y>=t||Y<0||S&&j>=u}function N(){var H=zA();if(E(H))return F(H);p=setTimeout(N,w(H))}function F(H){return p=void 0,k&&i?M(H):(i=c=void 0,f)}function x(){p!==void 0&&clearTimeout(p),_=0,i=v=c=p=void 0}function P(){return p===void 0?f:F(zA())}function G(){var H=zA(),Y=E(H);if(i=arguments,c=this,v=H,Y){if(p===void 0)return R(v);if(S)return clearTimeout(p),p=setTimeout(N,t),M(v)}return p===void 0&&(p=setTimeout(N,t)),f}return G.cancel=x,G.flush=P,G}function WD(e,t,o){(o!==void 0&&!tI(e[t],o)||o===void 0&&!(t in e))&&GL(e,t,o)}function Lq(e){return Ql(e)&&dv(e)}function jD(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function Lge(e){return uv(e,oI(e))}function Nge(e,t,o,i,c,u,f){var p=jD(e,o),v=jD(t,o),_=f.get(v);if(_){WD(e,o,_);return}var b=u?u(p,v,o+"",e,t,f):void 0,S=b===void 0;if(S){var k=ua(v),M=!k&&R0(v),R=!k&&!M&&KL(v);b=v,k||M||R?ua(p)?b=p:Lq(p)?b=tq(p):M?(S=!1,b=gq(v,!0)):R?(S=!1,b=bq(v,!0)):b=[]:pq(v)||w0(v)?(b=p,w0(p)?b=Lge(p):(!da(p)||VL(p))&&(b=Cq(v))):S=!1}S&&(f.set(v,b),c(b,v,i,u,f),f.delete(v)),WD(e,o,b)}function Nq(e,t,o,i,c){e!==t&&Oq(t,function(u,f){if(c||(c=new ll),da(u))Nge(e,t,f,o,Nq,i,c);else{var p=i?i(jD(e,f),u,f+"",e,t,c):void 0;p===void 0&&(p=u),WD(e,f,p)}},oI)}function Pge(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function Pq(e,t,o){var i=e==null?0:e.length;if(!i)return-1;var c=i-1;return oq(e,Dq(t),c,!0)}function xge(e,t){var o=-1,i=dv(e)?Array(e.length):[];return Rge(e,function(c,u,f){i[++o]=t(c,u,f)}),i}function Uge(e,t){var o=ua(e)?UL:xge;return o(e,Dq(t))}function Fge(e,t){return rI(Uge(e,t),1)}var Vge=1/0;function Gge(e){var t=e==null?0:e.length;return t?rI(e,Vge):[]}function L0(e){for(var t=-1,o=e==null?0:e.length,i={};++t<o;){var c=e[t];i[c[0]]=c[1]}return i}function Bge(e,t){return t.length<2?e:OT(e,cpe(t,0,-1))}function ui(e,t){return LT(e,t)}function oi(e){return e==null}function iI(e){return e===null}function xq(e){return e===void 0}var Uq=Ohe(function(e,t,o){Nq(e,t,o)});function Hge(e,t){return t=hv(t,e),e=Bge(e,t),e==null||delete e[fv(Pge(t))]}function $ge(e){return pq(e)?void 0:e}var qge=1,Kge=2,zge=4,Wge=hq(function(e,t){var o={};if(e==null)return o;var i=!1;t=UL(t,function(u){return u=hv(u,e),i||(i=u.length>1),u}),uv(e,Iq(e),o),i&&(o=Dg(o,qge|Kge|zge,$ge));for(var c=t.length;c--;)Hge(o,t[c]);return o});function Fq(e,t,o,i){if(!da(e))return e;t=hv(t,e);for(var c=-1,u=t.length,f=u-1,p=e;p!=null&&++c<u;){var v=fv(t[c]),_=o;if(v==="__proto__"||v==="constructor"||v==="prototype")return e;if(c!=f){var b=p[v];_=void 0,_===void 0&&(_=da(b)?b:wT(t[c+1])?[]:{})}BL(p,v,_),p=p[v]}return e}function jge(e,t,o){for(var i=-1,c=t.length,u={};++i<c;){var f=t[i],p=OT(e,f);o(p,f)&&Fq(u,hv(f,e),p)}return u}function Yge(e,t){return jge(e,t,function(o,i){return Aq(e,i)})}var il=hq(function(e,t){return e==null?{}:Yge(e,t)});function Jge(e,t,o){return e==null?e:Fq(e,t,o)}var Xge="Expected a function";function rp(e,t,o){var i=!0,c=!0;if(typeof e!="function")throw new TypeError(Xge);return da(o)&&(i="leading"in o?!!o.leading:i,c="trailing"in o?!!o.trailing:c),Oa(e,t,{leading:i,maxWait:t,trailing:c})}var Zge=1/0,Qge=Ag&&1/XL(new Ag([,-0]))[1]==Zge?function(e){return new Ag(e)}:phe,eve=200;function tve(e,t,o){var i=-1,c=The,u=e.length,f=!0,p=[],v=p;if(u>=eve){var _=Qge(e);if(_)return XL(_);f=!1,c=Mq,v=new O0}else v=p;e:for(;++i<u;){var b=e[i],S=b;if(b=b!==0?b:0,f&&S===S){for(var k=v.length;k--;)if(v[k]===S)continue e;p.push(b)}else c(v,S,o)||(v!==p&&v.push(S),p.push(b))}return p}var WA=iq(function(e){return tve(rI(e,1,Lq,!0))});const qn=e=>e===void 0,vo=e=>typeof e=="boolean",jt=e=>typeof e=="number",Xa=e=>!e&&e!==0||ht(e)&&e.length===0||gn(e)&&!Object.keys(e).length,la=e=>typeof Element>"u"?!1:e instanceof Element,ks=e=>oi(e),nve=e=>Ut(e)?!Number.isNaN(Number(e)):!1,NT=e=>e===window;var ove=Object.defineProperty,rve=Object.defineProperties,ive=Object.getOwnPropertyDescriptors,b8=Object.getOwnPropertySymbols,ave=Object.prototype.hasOwnProperty,sve=Object.prototype.propertyIsEnumerable,C8=(e,t,o)=>t in e?ove(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,lve=(e,t)=>{for(var o in t||(t={}))ave.call(t,o)&&C8(e,o,t[o]);if(b8)for(var o of b8(t))sve.call(t,o)&&C8(e,o,t[o]);return e},cve=(e,t)=>rve(e,ive(t));function $E(e,t){var o;const i=Go();return Di(()=>{i.value=e()},cve(lve({},t),{flush:(o=void 0)!=null?o:"sync"})),sv(i)}var S8;const $n=typeof window<"u",uve=e=>typeof e<"u",YD=e=>typeof e=="function",dve=e=>typeof e=="string",Kg=()=>{},qE=$n&&((S8=window==null?void 0:window.navigator)==null?void 0:S8.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function zd(e){return typeof e=="function"?e():y(e)}function Vq(e,t){function o(...i){return new Promise((c,u)=>{Promise.resolve(e(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(c).catch(u)})}return o}function hve(e,t={}){let o,i,c=Kg;const u=p=>{clearTimeout(p),c(),c=Kg};return p=>{const v=zd(e),_=zd(t.maxWait);return o&&u(o),v<=0||_!==void 0&&_<=0?(i&&(u(i),i=null),Promise.resolve(p())):new Promise((b,S)=>{c=t.rejectOnCancel?S:b,_&&!i&&(i=setTimeout(()=>{o&&u(o),i=null,b(p())},_)),o=setTimeout(()=>{i&&u(i),i=null,b(p())},v)})}}function fve(e,t=!0,o=!0,i=!1){let c=0,u,f=!0,p=Kg,v;const _=()=>{u&&(clearTimeout(u),u=void 0,p(),p=Kg)};return S=>{const k=zd(e),M=Date.now()-c,R=()=>v=S();return _(),k<=0?(c=Date.now(),R()):(M>k&&(o||!f)?(c=Date.now(),R()):t&&(v=new Promise((w,E)=>{p=i?E:w,u=setTimeout(()=>{c=Date.now(),f=!0,w(R()),_()},Math.max(0,k-M))})),!o&&!u&&(u=setTimeout(()=>f=!0,k)),f=!1,v)}}function pve(e){return e}function mve(e,t){let o,i,c;const u=le(!0),f=()=>{u.value=!0,c()};st(e,f,{flush:"sync"});const p=YD(t)?t:t.get,v=YD(t)?void 0:t.set,_=$ae((b,S)=>(i=b,c=S,{get(){return u.value&&(o=p(),u.value=!1),i(),o},set(k){v==null||v(k)}}));return Object.isExtensible(_)&&(_.trigger=f),_}function aI(e){return UH()?(FH(e),!0):!1}function gve(e,t=200,o={}){return Vq(hve(t,o),e)}function vve(e,t=200,o={}){const i=le(e.value),c=gve(()=>{i.value=e.value},t,o);return st(e,()=>c()),i}function Gq(e,t=200,o=!1,i=!0,c=!1){return Vq(fve(t,o,i,c),e)}function ZL(e,t=!0){kn()?mn(e):t?e():Vt(e)}function cp(e,t,o={}){const{immediate:i=!0}=o,c=le(!1);let u=null;function f(){u&&(clearTimeout(u),u=null)}function p(){c.value=!1,f()}function v(..._){f(),c.value=!0,u=setTimeout(()=>{c.value=!1,u=null,e(..._)},zd(t))}return i&&(c.value=!0,$n&&v()),aI(p),{isPending:sv(c),start:v,stop:p}}function sa(e){var t;const o=zd(e);return(t=o==null?void 0:o.$el)!=null?t:o}const ih=$n?window:void 0,_ve=$n?window.document:void 0;function _o(...e){let t,o,i,c;if(dve(e[0])||Array.isArray(e[0])?([o,i,c]=e,t=ih):[t,o,i,c]=e,!t)return Kg;Array.isArray(o)||(o=[o]),Array.isArray(i)||(i=[i]);const u=[],f=()=>{u.forEach(b=>b()),u.length=0},p=(b,S,k,M)=>(b.addEventListener(S,k,M),()=>b.removeEventListener(S,k,M)),v=st(()=>[sa(t),zd(c)],([b,S])=>{f(),b&&u.push(...o.flatMap(k=>i.map(M=>p(b,k,M,S))))},{immediate:!0,flush:"post"}),_=()=>{v(),f()};return aI(_),_}let E8=!1;function QL(e,t,o={}){const{window:i=ih,ignore:c=[],capture:u=!0,detectIframe:f=!1}=o;if(!i)return;qE&&!E8&&(E8=!0,Array.from(i.document.body.children).forEach(k=>k.addEventListener("click",Kg)));let p=!0;const v=k=>c.some(M=>{if(typeof M=="string")return Array.from(i.document.querySelectorAll(M)).some(R=>R===k.target||k.composedPath().includes(R));{const R=sa(M);return R&&(k.target===R||k.composedPath().includes(R))}}),b=[_o(i,"click",k=>{const M=sa(e);if(!(!M||M===k.target||k.composedPath().includes(M))){if(k.detail===0&&(p=!v(k)),!p){p=!0;return}t(k)}},{passive:!0,capture:u}),_o(i,"pointerdown",k=>{const M=sa(e);M&&(p=!k.composedPath().includes(M)&&!v(k))},{passive:!0}),f&&_o(i,"blur",k=>{var M;const R=sa(e);((M=i.document.activeElement)==null?void 0:M.tagName)==="IFRAME"&&!(R!=null&&R.contains(i.document.activeElement))&&t(k)})].filter(Boolean);return()=>b.forEach(k=>k())}function yve(e={}){var t;const{window:o=ih}=e,i=(t=e.document)!=null?t:o==null?void 0:o.document,c=mve(()=>null,()=>i==null?void 0:i.activeElement);return o&&(_o(o,"blur",u=>{u.relatedTarget===null&&c.trigger()},!0),_o(o,"focus",c.trigger,!0)),c}function Bq(e,t=!1){const o=le(),i=()=>o.value=!!e();return i(),ZL(i,t),o}function Ive(e){return JSON.parse(JSON.stringify(e))}const T8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M8="__vueuse_ssr_handlers__";T8[M8]=T8[M8]||{};function bve(e,t,{window:o=ih,initialValue:i=""}={}){const c=le(i),u=z(()=>{var f;return sa(t)||((f=o==null?void 0:o.document)==null?void 0:f.documentElement)});return st([u,()=>zd(e)],([f,p])=>{var v;if(f&&o){const _=(v=o.getComputedStyle(f).getPropertyValue(p))==null?void 0:v.trim();c.value=_||i}},{immediate:!0}),st(c,f=>{var p;(p=u.value)!=null&&p.style&&u.value.style.setProperty(zd(e),f)}),c}function Cve({document:e=_ve}={}){if(!e)return le("visible");const t=le(e.visibilityState);return _o(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var k8=Object.getOwnPropertySymbols,Sve=Object.prototype.hasOwnProperty,Eve=Object.prototype.propertyIsEnumerable,Tve=(e,t)=>{var o={};for(var i in e)Sve.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(e!=null&&k8)for(var i of k8(e))t.indexOf(i)<0&&Eve.call(e,i)&&(o[i]=e[i]);return o};function ar(e,t,o={}){const i=o,{window:c=ih}=i,u=Tve(i,["window"]);let f;const p=Bq(()=>c&&"ResizeObserver"in c),v=()=>{f&&(f.disconnect(),f=void 0)},_=st(()=>sa(e),S=>{v(),p.value&&c&&S&&(f=new ResizeObserver(t),f.observe(S,u))},{immediate:!0,flush:"post"}),b=()=>{v(),_()};return aI(b),{isSupported:p,stop:b}}function w8(e,t={}){const{reset:o=!0,windowResize:i=!0,windowScroll:c=!0,immediate:u=!0}=t,f=le(0),p=le(0),v=le(0),_=le(0),b=le(0),S=le(0),k=le(0),M=le(0);function R(){const w=sa(e);if(!w){o&&(f.value=0,p.value=0,v.value=0,_.value=0,b.value=0,S.value=0,k.value=0,M.value=0);return}const E=w.getBoundingClientRect();f.value=E.height,p.value=E.bottom,v.value=E.left,_.value=E.right,b.value=E.top,S.value=E.width,k.value=E.x,M.value=E.y}return ar(e,R),st(()=>sa(e),w=>!w&&R()),c&&_o("scroll",R,{capture:!0,passive:!0}),i&&_o("resize",R,{passive:!0}),ZL(()=>{u&&R()}),{height:f,bottom:p,left:v,right:_,top:b,width:S,x:k,y:M,update:R}}var R8=Object.getOwnPropertySymbols,Mve=Object.prototype.hasOwnProperty,kve=Object.prototype.propertyIsEnumerable,wve=(e,t)=>{var o={};for(var i in e)Mve.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(e!=null&&R8)for(var i of R8(e))t.indexOf(i)<0&&kve.call(e,i)&&(o[i]=e[i]);return o};function Hq(e,t,o={}){const i=o,{window:c=ih}=i,u=wve(i,["window"]);let f;const p=Bq(()=>c&&"MutationObserver"in c),v=()=>{f&&(f.disconnect(),f=void 0)},_=st(()=>sa(e),S=>{v(),p.value&&c&&S&&(f=new MutationObserver(t),f.observe(S,u))},{immediate:!0}),b=()=>{v(),_()};return aI(b),{isSupported:p,stop:b}}var A8;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(A8||(A8={}));var Rve=Object.defineProperty,D8=Object.getOwnPropertySymbols,Ave=Object.prototype.hasOwnProperty,Dve=Object.prototype.propertyIsEnumerable,O8=(e,t,o)=>t in e?Rve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ove=(e,t)=>{for(var o in t||(t={}))Ave.call(t,o)&&O8(e,o,t[o]);if(D8)for(var o of D8(t))Dve.call(t,o)&&O8(e,o,t[o]);return e};const Lve={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};Ove({linear:pve},Lve);function $q(e,t,o,i={}){var c,u,f;const{clone:p=!1,passive:v=!1,eventName:_,deep:b=!1,defaultValue:S}=i,k=kn(),M=o||(k==null?void 0:k.emit)||((c=k==null?void 0:k.$emit)==null?void 0:c.bind(k))||((f=(u=k==null?void 0:k.proxy)==null?void 0:u.$emit)==null?void 0:f.bind(k==null?void 0:k.proxy));let R=_;t||(t="modelValue"),R=_||R||`update:${t.toString()}`;const w=N=>p?YD(p)?p(N):Ive(N):N,E=()=>uve(e[t])?w(e[t]):S;if(v){const N=E(),F=le(N);return st(()=>e[t],x=>F.value=w(x)),st(F,x=>{(x!==e[t]||b)&&M(R,x)},{deep:b}),F}else return z({get(){return E()},set(N){M(R,N)}})}function Nve({window:e=ih}={}){if(!e)return le(!1);const t=le(e.document.hasFocus());return _o(e,"blur",()=>{t.value=!1}),_o(e,"focus",()=>{t.value=!0}),t}function Pve(e={}){const{window:t=ih,initialWidth:o=1/0,initialHeight:i=1/0,listenOrientation:c=!0,includeScrollbar:u=!0}=e,f=le(o),p=le(i),v=()=>{t&&(u?(f.value=t.innerWidth,p.value=t.innerHeight):(f.value=t.document.documentElement.clientWidth,p.value=t.document.documentElement.clientHeight))};return v(),ZL(v),_o("resize",v,{passive:!0}),c&&_o("orientationchange",v,{passive:!0}),{width:f,height:p}}class xve extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function qr(e,t){throw new xve(`[${e}] ${t}`)}const L8={current:0},N8=le(0),Kq=2e3,P8=Symbol("elZIndexContextKey"),zq=Symbol("zIndexContextKey"),pv=e=>{const t=kn()?Rt(P8,L8):L8,o=e||(kn()?Rt(zq,void 0):void 0),i=z(()=>{const f=y(o);return jt(f)?f:Kq}),c=z(()=>i.value+N8.value),u=()=>(t.current++,N8.value=t.current,c.value);return!$n&&Rt(P8),{initialZIndex:i,currentZIndex:c,nextZIndex:u}};var Uve={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const Fve=e=>(t,o)=>Vve(t,o,y(e)),Vve=(e,t,o)=>Rr(o,e,e).replace(/\{(\w+)\}/g,(i,c)=>{var u;return`${(u=t==null?void 0:t[c])!=null?u:`{${c}}`}`}),Gve=e=>{const t=z(()=>y(e).name),o=Bo(e)?e:le(e);return{lang:t,locale:o,t:Fve(e)}},Wq=Symbol("localeContextKey"),Kn=e=>{const t=e||Rt(Wq,le());return Gve(z(()=>t.value||Uve))},jq="__epPropKey",Ue=e=>e,Bve=e=>gn(e)&&!!e[jq],fl=(e,t)=>{if(!gn(e)||Bve(e))return e;const{values:o,required:i,default:c,type:u,validator:f}=e,v={type:u,required:!!i,validator:o||f?_=>{let b=!1,S=[];if(o&&(S=Array.from(o),jn(e,"default")&&S.push(c),b||(b=S.includes(_))),f&&(b||(b=f(_))),!b&&S.length>0){const k=[...new Set(S)].map(M=>JSON.stringify(M)).join(", ");jse(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${k}], got value ${JSON.stringify(_)}.`)}return b}:void 0,[jq]:!0};return jn(e,"default")&&(v.default=c),v},pt=e=>L0(Object.entries(e).map(([t,o])=>[t,fl(o,t)])),ic=["","default","small","large"],Kr=fl({type:String,values:ic,required:!1}),Yq=Symbol("size"),Jq=()=>{const e=Rt(Yq,{});return z(()=>y(e.size)||"")},Xq=Symbol("emptyValuesContextKey"),Hve=["",void 0,null],$ve=void 0,mv=pt({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>zt(e)?!e():!e}}),PT=(e,t)=>{const o=kn()?Rt(Xq,le({})):le({}),i=z(()=>e.emptyValues||o.value.emptyValues||Hve),c=z(()=>zt(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:zt(o.value.valueOnClear)?o.value.valueOnClear():o.value.valueOnClear!==void 0?o.value.valueOnClear:t!==void 0?t:$ve),u=f=>i.value.includes(f);return i.value.includes(c.value),{emptyValues:i,valueOnClear:c,isEmptyValue:u}},zg=e=>Object.keys(e),Zq=e=>Object.entries(e),a0=(e,t,o)=>({get value(){return Rr(e,t,o)},set value(i){Jge(e,t,i)}}),KE=le();function xT(e,t=void 0){const o=kn()?Rt(J7,KE):KE;return e?z(()=>{var i,c;return(c=(i=o.value)==null?void 0:i[e])!=null?c:t}):o}function UT(e,t){const o=xT(),i=ut(e,z(()=>{var p;return((p=o.value)==null?void 0:p.namespace)||r0})),c=Kn(z(()=>{var p;return(p=o.value)==null?void 0:p.locale})),u=pv(z(()=>{var p;return((p=o.value)==null?void 0:p.zIndex)||Kq})),f=z(()=>{var p;return y(t)||((p=o.value)==null?void 0:p.size)||""});return eN(z(()=>y(o)||{})),{ns:i,locale:c,zIndex:u,size:f}}const eN=(e,t,o=!1)=>{var i;const c=!!kn(),u=c?xT():void 0,f=(i=t==null?void 0:t.provide)!=null?i:c?Nn:void 0;if(!f)return;const p=z(()=>{const v=y(e);return u!=null&&u.value?qve(u.value,v):v});return f(J7,p),f(Wq,z(()=>p.value.locale)),f(X7,z(()=>p.value.namespace)),f(zq,z(()=>p.value.zIndex)),f(Yq,{size:z(()=>p.value.size||"")}),f(Xq,z(()=>({emptyValues:p.value.emptyValues,valueOnClear:p.value.valueOnClear}))),(o||!KE.value)&&(KE.value=p.value),p},qve=(e,t)=>{const o=[...new Set([...zg(e),...zg(t)])],i={};for(const c of o)i[c]=t[c]!==void 0?t[c]:e[c];return i},Kve=(e=[])=>({version:Rde,install:(o,i)=>{o[$5]||(o[$5]=!0,e.forEach(c=>o.use(c)),i&&eN(i,o,!0))}}),nn="update:modelValue",wn="change",Jr="input",zve=pt({zIndex:{type:Ue([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),Wve={scroll:({scrollTop:e,fixed:t})=>jt(e)&&vo(t),[wn]:e=>vo(e)};var vt=(e,t)=>{const o=e.__vccOpts||e;for(const[i,c]of t)o[i]=c;return o};function jve(e,t,o,i){const c=o-t;return e/=i/2,e<1?c/2*e*e*e+t:c/2*((e-=2)*e*e+2)+t}const Wd=e=>$n?window.requestAnimationFrame(e):setTimeout(e,16),up=e=>$n?window.cancelAnimationFrame(e):clearTimeout(e),Qq=(e="")=>e.split(" ").filter(t=>!!t.trim()),wa=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Ss=(e,t)=>{!e||!t.trim()||e.classList.add(...Qq(t))},Ji=(e,t)=>{!e||!t.trim()||e.classList.remove(...Qq(t))},Yc=(e,t)=>{var o;if(!$n||!e||!t)return"";let i=os(t);i==="float"&&(i="cssFloat");try{const c=e.style[i];if(c)return c;const u=(o=document.defaultView)==null?void 0:o.getComputedStyle(e,"");return u?u[i]:""}catch{return e.style[i]}},eK=(e,t,o)=>{if(!(!e||!t))if(gn(t))Zq(t).forEach(([i,c])=>eK(e,i,c));else{const i=os(t);e.style[i]=o}};function ur(e,t="px"){if(!e)return"";if(jt(e)||nve(e))return`${e}${t}`;if(Ut(e))return e}const Yve=(e,t)=>{if(!$n)return!1;const o={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],i=Yc(e,o);return["scroll","auto","overlay"].some(c=>i.includes(c))},tN=(e,t)=>{if(!$n)return;let o=e;for(;o;){if([window,document,document.documentElement].includes(o))return window;if(Yve(o,t))return o;o=o.parentNode}return o};let xS;const tK=e=>{var t;if(!$n)return 0;if(xS!==void 0)return xS;const o=document.createElement("div");o.className=`${e}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const i=o.offsetWidth;o.style.overflow="scroll";const c=document.createElement("div");c.style.width="100%",o.appendChild(c);const u=c.offsetWidth;return(t=o.parentNode)==null||t.removeChild(o),xS=i-u,xS};function nN(e,t){if(!$n)return;if(!t){e.scrollTop=0;return}const o=[];let i=t.offsetParent;for(;i!==null&&e!==i&&e.contains(i);)o.push(i),i=i.offsetParent;const c=t.offsetTop+o.reduce((v,_)=>v+_.offsetTop,0),u=c+t.offsetHeight,f=e.scrollTop,p=f+e.clientHeight;c<f?e.scrollTop=c:u>p&&(e.scrollTop=u-e.clientHeight)}function Jve(e,t,o,i,c){const u=Date.now();let f;const p=()=>{const _=Date.now()-u,b=jve(_>i?i:_,t,o,i);NT(e)?e.scrollTo(window.pageXOffset,b):e.scrollTop=b,_<i?f=Wd(p):zt(c)&&c()};return p(),()=>{f&&up(f)}}const x8=(e,t)=>NT(t)?e.ownerDocument.documentElement:t,U8=e=>NT(e)?window.scrollY:e.scrollTop,nK="ElAffix",Xve=Te({name:nK}),Zve=Te({...Xve,props:zve,emits:Wve,setup(e,{expose:t,emit:o}){const i=e,c=ut("affix"),u=Go(),f=Go(),p=Go(),{height:v}=Pve(),{height:_,width:b,top:S,bottom:k,update:M}=w8(f,{windowScroll:!1}),R=w8(u),w=le(!1),E=le(0),N=le(0),F=z(()=>({height:w.value?`${_.value}px`:"",width:w.value?`${b.value}px`:""})),x=z(()=>{if(!w.value)return{};const H=i.offset?ur(i.offset):0;return{height:`${_.value}px`,width:`${b.value}px`,top:i.position==="top"?H:"",bottom:i.position==="bottom"?H:"",transform:N.value?`translateY(${N.value}px)`:"",zIndex:i.zIndex}}),P=()=>{if(!p.value)return;E.value=p.value instanceof Window?document.documentElement.scrollTop:p.value.scrollTop||0;const{position:H,target:Y,offset:j}=i,W=j+_.value;if(H==="top")if(Y){const O=R.bottom.value-W;w.value=j>S.value&&R.bottom.value>0,N.value=O<0?O:0}else w.value=j>S.value;else if(Y){const O=v.value-R.top.value-W;w.value=v.value-j<k.value&&v.value>R.top.value,N.value=O<0?-O:0}else w.value=v.value-j<k.value},G=async()=>{M(),await Vt(),o("scroll",{scrollTop:E.value,fixed:w.value})};return st(w,H=>o(wn,H)),mn(()=>{var H;i.target?(u.value=(H=document.querySelector(i.target))!=null?H:void 0,u.value||qr(nK,`Target does not exist: ${i.target}`)):u.value=document.documentElement,p.value=tN(f.value,!0),M()}),_o(p,"scroll",G),Di(P),t({update:P,updateRoot:M}),(H,Y)=>(ee(),ge("div",{ref_key:"root",ref:f,class:ne(y(c).b()),style:qt(y(F))},[Ee("div",{class:ne({[y(c).m("fixed")]:w.value}),style:qt(y(x))},[Ve(H.$slots,"default")],6)],6))}});var Qve=vt(Zve,[["__file","affix.vue"]]);const un=(e,t)=>{if(e.install=o=>{for(const i of[e,...Object.values(t??{})])o.component(i.name,i)},t)for(const[o,i]of Object.entries(t))e[o]=i;return e},oK=(e,t)=>(e.install=o=>{e._context=o._context,o.config.globalProperties[t]=e},e),e_e=(e,t)=>(e.install=o=>{o.directive(t,e)},e),lr=e=>(e.install=lo,e),t_e=un(Qve),n_e=pt({size:{type:Ue([Number,String])},color:{type:String}}),o_e=Te({name:"ElIcon",inheritAttrs:!1}),r_e=Te({...o_e,props:n_e,setup(e){const t=e,o=ut("icon"),i=z(()=>{const{size:c,color:u}=t;return!c&&!u?{}:{fontSize:qn(c)?void 0:ur(c),"--color":u}});return(c,u)=>(ee(),ge("i",An({class:y(o).b(),style:y(i)},c.$attrs),[Ve(c.$slots,"default")],16))}});var i_e=vt(r_e,[["__file","icon.vue"]]);const Pt=un(i_e);/*! Element Plus Icons Vue v2.3.1 */var a_e=Te({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),fu=a_e,s_e=Te({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),Yd=s_e,l_e=Te({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),ca=l_e,c_e=Te({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),oN=c_e,u_e=Te({name:"Back",__name:"back",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ee("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),d_e=u_e,h_e=Te({name:"Calendar",__name:"calendar",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),f_e=h_e,p_e=Te({name:"CaretRight",__name:"caret-right",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),rK=p_e,m_e=Te({name:"CaretTop",__name:"caret-top",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),g_e=m_e,v_e=Te({name:"Check",__name:"check",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),sI=v_e,__e=Te({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),y_e=__e,I_e=Te({name:"CircleCheck",__name:"circle-check",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ee("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),rN=I_e,b_e=Te({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),iN=b_e,C_e=Te({name:"CircleClose",__name:"circle-close",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ee("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),pu=C_e,S_e=Te({name:"Clock",__name:"clock",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ee("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ee("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),iK=S_e,E_e=Te({name:"Close",__name:"close",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),As=E_e,T_e=Te({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Jd=T_e,M_e=Te({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),Xd=M_e,k_e=Te({name:"Delete",__name:"delete",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),w_e=k_e,R_e=Te({name:"Document",__name:"document",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),A_e=R_e,D_e=Te({name:"FullScreen",__name:"full-screen",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),O_e=D_e,L_e=Te({name:"Hide",__name:"hide",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ee("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),N_e=L_e,P_e=Te({name:"InfoFilled",__name:"info-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),aN=P_e,x_e=Te({name:"Loading",__name:"loading",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),ec=x_e,U_e=Te({name:"Minus",__name:"minus",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),F_e=U_e,V_e=Te({name:"MoreFilled",__name:"more-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),F8=V_e,G_e=Te({name:"More",__name:"more",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),B_e=G_e,H_e=Te({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),$_e=H_e,q_e=Te({name:"Plus",__name:"plus",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),aK=q_e,K_e=Te({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),z_e=K_e,W_e=Te({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),j_e=W_e,Y_e=Te({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),J_e=Y_e,X_e=Te({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),Z_e=X_e,Q_e=Te({name:"Search",__name:"search",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),eye=Q_e,tye=Te({name:"SortDown",__name:"sort-down",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),nye=tye,oye=Te({name:"SortUp",__name:"sort-up",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),rye=oye,iye=Te({name:"StarFilled",__name:"star-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),US=iye,aye=Te({name:"Star",__name:"star",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),sye=aye,lye=Te({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),sK=lye,cye=Te({name:"View",__name:"view",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),uye=cye,dye=Te({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),FT=dye,hye=Te({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),lK=hye,fye=Te({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,o)=>(ee(),ge("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ee("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),pye=fye;const ho=Ue([String,Object,Function]),cK={Close:As},sN={Close:As,SuccessFilled:sK,InfoFilled:aN,WarningFilled:FT,CircleCloseFilled:iN},Zd={success:sK,warning:FT,error:iN,info:aN},VT={validating:ec,success:rN,error:pu},mye=["light","dark"],gye=pt({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:zg(Zd),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:mye,default:"light"}}),vye={close:e=>e instanceof MouseEvent},_ye=Te({name:"ElAlert"}),yye=Te({..._ye,props:gye,emits:vye,setup(e,{emit:t}){const o=e,{Close:i}=sN,c=Qr(),u=ut("alert"),f=le(!0),p=z(()=>Zd[o.type]),v=z(()=>!!(o.description||c.default)),_=b=>{f.value=!1,t("close",b)};return(b,S)=>(ee(),We(Zr,{name:y(u).b("fade"),persisted:""},{default:Ae(()=>[fn(Ee("div",{class:ne([y(u).b(),y(u).m(b.type),y(u).is("center",b.center),y(u).is(b.effect)]),role:"alert"},[b.showIcon&&(b.$slots.icon||y(p))?(ee(),We(y(Pt),{key:0,class:ne([y(u).e("icon"),{[y(u).is("big")]:y(v)}])},{default:Ae(()=>[Ve(b.$slots,"icon",{},()=>[(ee(),We(Tn(y(p))))])]),_:3},8,["class"])):$e("v-if",!0),Ee("div",{class:ne(y(u).e("content"))},[b.title||b.$slots.title?(ee(),ge("span",{key:0,class:ne([y(u).e("title"),{"with-description":y(v)}])},[Ve(b.$slots,"title",{},()=>[Mn(mt(b.title),1)])],2)):$e("v-if",!0),y(v)?(ee(),ge("p",{key:1,class:ne(y(u).e("description"))},[Ve(b.$slots,"default",{},()=>[Mn(mt(b.description),1)])],2)):$e("v-if",!0),b.closable?(ee(),ge(Ht,{key:2},[b.closeText?(ee(),ge("div",{key:0,class:ne([y(u).e("close-btn"),y(u).is("customed")]),onClick:_},mt(b.closeText),3)):(ee(),We(y(Pt),{key:1,class:ne(y(u).e("close-btn")),onClick:_},{default:Ae(()=>[Me(y(i))]),_:1},8,["class"]))],64)):$e("v-if",!0)],2)],2),[[Zn,f.value]])]),_:3},8,["name"]))}});var Iye=vt(yye,[["__file","alert.vue"]]);const bye=un(Iye),GT=()=>$n&&/firefox/i.test(window.navigator.userAgent);let Ca;const Cye={height:"0",visibility:"hidden",overflow:GT()?"":"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},Sye=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Eye(e){const t=window.getComputedStyle(e),o=t.getPropertyValue("box-sizing"),i=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),c=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:Sye.map(f=>[f,t.getPropertyValue(f)]),paddingSize:i,borderSize:c,boxSizing:o}}function V8(e,t=1,o){var i;Ca||(Ca=document.createElement("textarea"),document.body.appendChild(Ca));const{paddingSize:c,borderSize:u,boxSizing:f,contextStyle:p}=Eye(e);p.forEach(([S,k])=>Ca==null?void 0:Ca.style.setProperty(S,k)),Object.entries(Cye).forEach(([S,k])=>Ca==null?void 0:Ca.style.setProperty(S,k,"important")),Ca.value=e.value||e.placeholder||"";let v=Ca.scrollHeight;const _={};f==="border-box"?v=v+u:f==="content-box"&&(v=v-c),Ca.value="";const b=Ca.scrollHeight-c;if(jt(t)){let S=b*t;f==="border-box"&&(S=S+c+u),v=Math.max(S,v),_.minHeight=`${S}px`}if(jt(o)){let S=b*o;f==="border-box"&&(S=S+c+u),v=Math.min(S,v)}return _.height=`${v}px`,(i=Ca.parentNode)==null||i.removeChild(Ca),Ca=void 0,_}const sr=e=>e,Tye=pt({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Ci=e=>il(Tye,e),lN=pt({id:{type:String,default:void 0},size:Kr,disabled:Boolean,modelValue:{type:Ue([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Ue([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:ho},prefixIcon:{type:ho},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:Ue([Object,Array,String]),default:()=>sr({})},autofocus:Boolean,rows:{type:Number,default:2},...Ci(["ariaLabel"])}),Mye={[nn]:e=>Ut(e),input:e=>Ut(e),change:e=>Ut(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},kye=["class","style"],wye=/^on[A-Z]/,lI=(e={})=>{const{excludeListeners:t=!1,excludeKeys:o}=e,i=z(()=>((o==null?void 0:o.value)||[]).concat(kye)),c=kn();return z(c?()=>{var u;return L0(Object.entries((u=c.proxy)==null?void 0:u.$attrs).filter(([f])=>!i.value.includes(f)&&!(t&&wye.test(f))))}:()=>({}))},_p=Symbol("formContextKey"),tc=Symbol("formItemContextKey"),G8={prefix:Math.floor(Math.random()*1e4),current:0},Rye=Symbol("elIdInjection"),cN=()=>kn()?Rt(Rye,G8):G8,bi=e=>{const t=cN(),o=xL();return $E(()=>y(e)||`${o.value}-id-${t.prefix}-${t.current++}`)},Ni=()=>{const e=Rt(_p,void 0),t=Rt(tc,void 0);return{form:e,formItem:t}},Ps=(e,{formItemContext:t,disableIdGeneration:o,disableIdManagement:i})=>{o||(o=le(!1)),i||(i=le(!1));const c=le();let u;const f=z(()=>{var p;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((p=t.inputIds)==null?void 0:p.length)<=1)});return mn(()=>{u=st([uo(e,"id"),o],([p,v])=>{const _=p??(v?void 0:bi().value);_!==c.value&&(t!=null&&t.removeInputId&&(c.value&&t.removeInputId(c.value),!(i!=null&&i.value)&&!v&&_&&t.addInputId(_)),c.value=_)},{immediate:!0})}),rh(()=>{u&&u(),t!=null&&t.removeInputId&&c.value&&t.removeInputId(c.value)}),{isLabeledByFormItem:f,inputId:c}},uN=e=>{const t=kn();return z(()=>{var o,i;return(i=(o=t==null?void 0:t.proxy)==null?void 0:o.$props)==null?void 0:i[e]})},Fr=(e,t={})=>{const o=le(void 0),i=t.prop?o:uN("size"),c=t.global?o:Jq(),u=t.form?{size:void 0}:Rt(_p,void 0),f=t.formItem?{size:void 0}:Rt(tc,void 0);return z(()=>i.value||y(e)||(f==null?void 0:f.size)||(u==null?void 0:u.size)||c.value||"")},Pi=e=>{const t=uN("disabled"),o=Rt(_p,void 0);return z(()=>t.value||y(e)||(o==null?void 0:o.disabled)||!1)};function ah(e,{beforeFocus:t,afterFocus:o,beforeBlur:i,afterBlur:c}={}){const u=kn(),{emit:f}=u,p=Go(),v=uN("disabled"),_=le(!1),b=M=>{zt(t)&&t(M)||_.value||(_.value=!0,f("focus",M),o==null||o())},S=M=>{var R;zt(i)&&i(M)||M.relatedTarget&&((R=p.value)!=null&&R.contains(M.relatedTarget))||(_.value=!1,f("blur",M),c==null||c())},k=()=>{var M,R;(M=p.value)!=null&&M.contains(document.activeElement)&&p.value!==document.activeElement||v.value||(R=e.value)==null||R.focus()};return st([p,v],([M,R])=>{M&&(R?M.removeAttribute("tabindex"):M.setAttribute("tabindex","-1"))}),_o(p,"focus",b,!0),_o(p,"blur",S,!0),_o(p,"click",k,!0),{isFocused:_,wrapperRef:p,handleFocus:b,handleBlur:S}}const Aye=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function cI({afterComposition:e,emit:t}){const o=le(!1),i=p=>{t==null||t("compositionstart",p),o.value=!0},c=p=>{var v;t==null||t("compositionupdate",p);const _=(v=p.target)==null?void 0:v.value,b=_[_.length-1]||"";o.value=!Aye(b)},u=p=>{t==null||t("compositionend",p),o.value&&(o.value=!1,Vt(()=>e(p)))};return{isComposing:o,handleComposition:p=>{p.type==="compositionend"?u(p):c(p)},handleCompositionStart:i,handleCompositionUpdate:c,handleCompositionEnd:u}}function Dye(e){let t;function o(){if(e.value==null)return;const{selectionStart:c,selectionEnd:u,value:f}=e.value;if(c==null||u==null)return;const p=f.slice(0,Math.max(0,c)),v=f.slice(Math.max(0,u));t={selectionStart:c,selectionEnd:u,value:f,beforeTxt:p,afterTxt:v}}function i(){if(e.value==null||t==null)return;const{value:c}=e.value,{beforeTxt:u,afterTxt:f,selectionStart:p}=t;if(u==null||f==null||p==null)return;let v=c.length;if(c.endsWith(f))v=c.length-f.length;else if(c.startsWith(u))v=u.length;else{const _=u[p-1],b=c.indexOf(_,p-1);b!==-1&&(v=b+1)}e.value.setSelectionRange(v,v)}return[o,i]}const Oye="ElInput",Lye=Te({name:Oye,inheritAttrs:!1}),Nye=Te({...Lye,props:lN,emits:Mye,setup(e,{expose:t,emit:o}){const i=e,c=uu(),u=lI(),f=Qr(),p=z(()=>[i.type==="textarea"?w.b():R.b(),R.m(k.value),R.is("disabled",M.value),R.is("exceed",Ie.value),{[R.b("group")]:f.prepend||f.append,[R.m("prefix")]:f.prefix||i.prefixIcon,[R.m("suffix")]:f.suffix||i.suffixIcon||i.clearable||i.showPassword,[R.bm("suffix","password-clear")]:re.value&&X.value,[R.b("hidden")]:i.type==="hidden"},c.class]),v=z(()=>[R.e("wrapper"),R.is("focus",j.value)]),{form:_,formItem:b}=Ni(),{inputId:S}=Ps(i,{formItemContext:b}),k=Fr(),M=Pi(),R=ut("input"),w=ut("textarea"),E=Go(),N=Go(),F=le(!1),x=le(!1),P=le(),G=Go(i.inputStyle),H=z(()=>E.value||N.value),{wrapperRef:Y,isFocused:j,handleFocus:W,handleBlur:O}=ah(H,{beforeFocus(){return M.value},afterBlur(){var lt;i.validateEvent&&((lt=b==null?void 0:b.validate)==null||lt.call(b,"blur").catch(Et=>void 0))}}),Q=z(()=>{var lt;return(lt=_==null?void 0:_.statusIcon)!=null?lt:!1}),J=z(()=>(b==null?void 0:b.validateState)||""),oe=z(()=>J.value&&VT[J.value]),pe=z(()=>x.value?uye:N_e),ie=z(()=>[c.style]),te=z(()=>[i.inputStyle,G.value,{resize:i.resize}]),he=z(()=>oi(i.modelValue)?"":String(i.modelValue)),re=z(()=>i.clearable&&!M.value&&!i.readonly&&!!he.value&&(j.value||F.value)),X=z(()=>i.showPassword&&!M.value&&!!he.value&&(!!he.value||j.value)),ye=z(()=>i.showWordLimit&&!!i.maxlength&&(i.type==="text"||i.type==="textarea")&&!M.value&&!i.readonly&&!i.showPassword),ue=z(()=>he.value.length),Ie=z(()=>!!ye.value&&ue.value>Number(i.maxlength)),ve=z(()=>!!f.suffix||!!i.suffixIcon||re.value||i.showPassword||ye.value||!!J.value&&Q.value),[Ce,Fe]=Dye(E);ar(N,lt=>{if(xe(),!ye.value||i.resize!=="both")return;const Et=lt[0],{width:Yt}=Et.contentRect;P.value={right:`calc(100% - ${Yt+15+6}px)`}});const Oe=()=>{const{type:lt,autosize:Et}=i;if(!(!$n||lt!=="textarea"||!N.value))if(Et){const Yt=gn(Et)?Et.minRows:void 0,sn=gn(Et)?Et.maxRows:void 0,dn=V8(N.value,Yt,sn);G.value={overflowY:"hidden",...dn},Vt(()=>{N.value.offsetHeight,G.value=dn})}else G.value={minHeight:V8(N.value).minHeight}},xe=(lt=>{let Et=!1;return()=>{var Yt;if(Et||!i.autosize)return;((Yt=N.value)==null?void 0:Yt.offsetParent)===null||(lt(),Et=!0)}})(Oe),Le=()=>{const lt=H.value,Et=i.formatter?i.formatter(he.value):he.value;!lt||lt.value===Et||(lt.value=Et)},rt=async lt=>{Ce();let{value:Et}=lt.target;if(i.formatter&&i.parser&&(Et=i.parser(Et)),!Ge.value){if(Et===he.value){Le();return}o(nn,Et),o(Jr,Et),await Vt(),Le(),Fe()}},Qe=lt=>{let{value:Et}=lt.target;i.formatter&&i.parser&&(Et=i.parser(Et)),o(wn,Et)},{isComposing:Ge,handleCompositionStart:_e,handleCompositionUpdate:Re,handleCompositionEnd:Ke}=cI({emit:o,afterComposition:rt}),je=()=>{Ce(),x.value=!x.value,setTimeout(Fe)},ze=()=>{var lt;return(lt=H.value)==null?void 0:lt.focus()},nt=()=>{var lt;return(lt=H.value)==null?void 0:lt.blur()},it=lt=>{F.value=!1,o("mouseleave",lt)},dt=lt=>{F.value=!0,o("mouseenter",lt)},gt=lt=>{o("keydown",lt)},ft=()=>{var lt;(lt=H.value)==null||lt.select()},Mt=()=>{o(nn,""),o(wn,""),o("clear"),o(Jr,"")};return st(()=>i.modelValue,()=>{var lt;Vt(()=>Oe()),i.validateEvent&&((lt=b==null?void 0:b.validate)==null||lt.call(b,"change").catch(Et=>void 0))}),st(he,()=>Le()),st(()=>i.type,async()=>{await Vt(),Le(),Oe()}),mn(()=>{!i.formatter&&i.parser,Le(),Vt(Oe)}),t({input:E,textarea:N,ref:H,textareaStyle:te,autosize:uo(i,"autosize"),isComposing:Ge,focus:ze,blur:nt,select:ft,clear:Mt,resizeTextarea:Oe}),(lt,Et)=>(ee(),ge("div",{class:ne([y(p),{[y(R).bm("group","append")]:lt.$slots.append,[y(R).bm("group","prepend")]:lt.$slots.prepend}]),style:qt(y(ie)),onMouseenter:dt,onMouseleave:it},[$e(" input "),lt.type!=="textarea"?(ee(),ge(Ht,{key:0},[$e(" prepend slot "),lt.$slots.prepend?(ee(),ge("div",{key:0,class:ne(y(R).be("group","prepend"))},[Ve(lt.$slots,"prepend")],2)):$e("v-if",!0),Ee("div",{ref_key:"wrapperRef",ref:Y,class:ne(y(v))},[$e(" prefix slot "),lt.$slots.prefix||lt.prefixIcon?(ee(),ge("span",{key:0,class:ne(y(R).e("prefix"))},[Ee("span",{class:ne(y(R).e("prefix-inner"))},[Ve(lt.$slots,"prefix"),lt.prefixIcon?(ee(),We(y(Pt),{key:0,class:ne(y(R).e("icon"))},{default:Ae(()=>[(ee(),We(Tn(lt.prefixIcon)))]),_:1},8,["class"])):$e("v-if",!0)],2)],2)):$e("v-if",!0),Ee("input",An({id:y(S),ref_key:"input",ref:E,class:y(R).e("inner")},y(u),{minlength:lt.minlength,maxlength:lt.maxlength,type:lt.showPassword?x.value?"text":"password":lt.type,disabled:y(M),readonly:lt.readonly,autocomplete:lt.autocomplete,tabindex:lt.tabindex,"aria-label":lt.ariaLabel,placeholder:lt.placeholder,style:lt.inputStyle,form:lt.form,autofocus:lt.autofocus,role:lt.containerRole,onCompositionstart:y(_e),onCompositionupdate:y(Re),onCompositionend:y(Ke),onInput:rt,onChange:Qe,onKeydown:gt}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),$e(" suffix slot "),y(ve)?(ee(),ge("span",{key:1,class:ne(y(R).e("suffix"))},[Ee("span",{class:ne(y(R).e("suffix-inner"))},[!y(re)||!y(X)||!y(ye)?(ee(),ge(Ht,{key:0},[Ve(lt.$slots,"suffix"),lt.suffixIcon?(ee(),We(y(Pt),{key:0,class:ne(y(R).e("icon"))},{default:Ae(()=>[(ee(),We(Tn(lt.suffixIcon)))]),_:1},8,["class"])):$e("v-if",!0)],64)):$e("v-if",!0),y(re)?(ee(),We(y(Pt),{key:1,class:ne([y(R).e("icon"),y(R).e("clear")]),onMousedown:Zt(y(lo),["prevent"]),onClick:Mt},{default:Ae(()=>[Me(y(pu))]),_:1},8,["class","onMousedown"])):$e("v-if",!0),y(X)?(ee(),We(y(Pt),{key:2,class:ne([y(R).e("icon"),y(R).e("password")]),onClick:je},{default:Ae(()=>[(ee(),We(Tn(y(pe))))]),_:1},8,["class"])):$e("v-if",!0),y(ye)?(ee(),ge("span",{key:3,class:ne(y(R).e("count"))},[Ee("span",{class:ne(y(R).e("count-inner"))},mt(y(ue))+" / "+mt(lt.maxlength),3)],2)):$e("v-if",!0),y(J)&&y(oe)&&y(Q)?(ee(),We(y(Pt),{key:4,class:ne([y(R).e("icon"),y(R).e("validateIcon"),y(R).is("loading",y(J)==="validating")])},{default:Ae(()=>[(ee(),We(Tn(y(oe))))]),_:1},8,["class"])):$e("v-if",!0)],2)],2)):$e("v-if",!0)],2),$e(" append slot "),lt.$slots.append?(ee(),ge("div",{key:1,class:ne(y(R).be("group","append"))},[Ve(lt.$slots,"append")],2)):$e("v-if",!0)],64)):(ee(),ge(Ht,{key:1},[$e(" textarea "),Ee("textarea",An({id:y(S),ref_key:"textarea",ref:N,class:[y(w).e("inner"),y(R).is("focus",y(j))]},y(u),{minlength:lt.minlength,maxlength:lt.maxlength,tabindex:lt.tabindex,disabled:y(M),readonly:lt.readonly,autocomplete:lt.autocomplete,style:y(te),"aria-label":lt.ariaLabel,placeholder:lt.placeholder,form:lt.form,autofocus:lt.autofocus,rows:lt.rows,role:lt.containerRole,onCompositionstart:y(_e),onCompositionupdate:y(Re),onCompositionend:y(Ke),onInput:rt,onFocus:y(W),onBlur:y(O),onChange:Qe,onKeydown:gt}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),y(ye)?(ee(),ge("span",{key:0,style:qt(P.value),class:ne(y(R).e("count"))},mt(y(ue))+" / "+mt(lt.maxlength),7)):$e("v-if",!0)],64))],38))}});var Pye=vt(Nye,[["__file","input.vue"]]);const Yi=un(Pye),lg=4,uK={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},xye=({move:e,size:t,bar:o})=>({[o.size]:t,transform:`translate${o.axis}(${e}%)`}),dN=Symbol("scrollbarContextKey"),Uye=pt({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),Fye="Thumb",Vye=Te({__name:"thumb",props:Uye,setup(e){const t=e,o=Rt(dN),i=ut("scrollbar");o||qr(Fye,"can not inject scrollbar context");const c=le(),u=le(),f=le({}),p=le(!1);let v=!1,_=!1,b=$n?document.onselectstart:null;const S=z(()=>uK[t.vertical?"vertical":"horizontal"]),k=z(()=>xye({size:t.size,move:t.move,bar:S.value})),M=z(()=>c.value[S.value.offset]**2/o.wrapElement[S.value.scrollSize]/t.ratio/u.value[S.value.offset]),R=H=>{var Y;if(H.stopPropagation(),H.ctrlKey||[1,2].includes(H.button))return;(Y=window.getSelection())==null||Y.removeAllRanges(),E(H);const j=H.currentTarget;j&&(f.value[S.value.axis]=j[S.value.offset]-(H[S.value.client]-j.getBoundingClientRect()[S.value.direction]))},w=H=>{if(!u.value||!c.value||!o.wrapElement)return;const Y=Math.abs(H.target.getBoundingClientRect()[S.value.direction]-H[S.value.client]),j=u.value[S.value.offset]/2,W=(Y-j)*100*M.value/c.value[S.value.offset];o.wrapElement[S.value.scroll]=W*o.wrapElement[S.value.scrollSize]/100},E=H=>{H.stopImmediatePropagation(),v=!0,document.addEventListener("mousemove",N),document.addEventListener("mouseup",F),b=document.onselectstart,document.onselectstart=()=>!1},N=H=>{if(!c.value||!u.value||v===!1)return;const Y=f.value[S.value.axis];if(!Y)return;const j=(c.value.getBoundingClientRect()[S.value.direction]-H[S.value.client])*-1,W=u.value[S.value.offset]-Y,O=(j-W)*100*M.value/c.value[S.value.offset];o.wrapElement[S.value.scroll]=O*o.wrapElement[S.value.scrollSize]/100},F=()=>{v=!1,f.value[S.value.axis]=0,document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",F),G(),_&&(p.value=!1)},x=()=>{_=!1,p.value=!!t.size},P=()=>{_=!0,p.value=v};Co(()=>{G(),document.removeEventListener("mouseup",F)});const G=()=>{document.onselectstart!==b&&(document.onselectstart=b)};return _o(uo(o,"scrollbarElement"),"mousemove",x),_o(uo(o,"scrollbarElement"),"mouseleave",P),(H,Y)=>(ee(),We(Zr,{name:y(i).b("fade"),persisted:""},{default:Ae(()=>[fn(Ee("div",{ref_key:"instance",ref:c,class:ne([y(i).e("bar"),y(i).is(y(S).key)]),onMousedown:w,onClick:Zt(()=>{},["stop"])},[Ee("div",{ref_key:"thumb",ref:u,class:ne(y(i).e("thumb")),style:qt(y(k)),onMousedown:R},null,38)],42,["onClick"]),[[Zn,H.always||p.value]])]),_:1},8,["name"]))}});var B8=vt(Vye,[["__file","thumb.vue"]]);const Gye=pt({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),Bye=Te({__name:"bar",props:Gye,setup(e,{expose:t}){const o=e,i=Rt(dN),c=le(0),u=le(0),f=le(""),p=le(""),v=le(1),_=le(1);return t({handleScroll:k=>{if(k){const M=k.offsetHeight-lg,R=k.offsetWidth-lg;u.value=k.scrollTop*100/M*v.value,c.value=k.scrollLeft*100/R*_.value}},update:()=>{const k=i==null?void 0:i.wrapElement;if(!k)return;const M=k.offsetHeight-lg,R=k.offsetWidth-lg,w=M**2/k.scrollHeight,E=R**2/k.scrollWidth,N=Math.max(w,o.minSize),F=Math.max(E,o.minSize);v.value=w/(M-w)/(N/(M-N)),_.value=E/(R-E)/(F/(R-F)),p.value=N+lg<M?`${N}px`:"",f.value=F+lg<R?`${F}px`:""}}),(k,M)=>(ee(),ge(Ht,null,[Me(B8,{move:c.value,ratio:_.value,size:f.value,always:k.always},null,8,["move","ratio","size","always"]),Me(B8,{move:u.value,ratio:v.value,size:p.value,vertical:"",always:k.always},null,8,["move","ratio","size","always"])],64))}});var Hye=vt(Bye,[["__file","bar.vue"]]);const $ye=pt({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Ue([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...Ci(["ariaLabel","ariaOrientation"])}),dK={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(jt)},qye="ElScrollbar",Kye=Te({name:qye}),zye=Te({...Kye,props:$ye,emits:dK,setup(e,{expose:t,emit:o}){const i=e,c=ut("scrollbar");let u,f,p=0,v=0;const _=le(),b=le(),S=le(),k=le(),M=z(()=>{const G={};return i.height&&(G.height=ur(i.height)),i.maxHeight&&(G.maxHeight=ur(i.maxHeight)),[i.wrapStyle,G]}),R=z(()=>[i.wrapClass,c.e("wrap"),{[c.em("wrap","hidden-default")]:!i.native}]),w=z(()=>[c.e("view"),i.viewClass]),E=()=>{var G;b.value&&((G=k.value)==null||G.handleScroll(b.value),p=b.value.scrollTop,v=b.value.scrollLeft,o("scroll",{scrollTop:b.value.scrollTop,scrollLeft:b.value.scrollLeft}))};function N(G,H){gn(G)?b.value.scrollTo(G):jt(G)&&jt(H)&&b.value.scrollTo(G,H)}const F=G=>{jt(G)&&(b.value.scrollTop=G)},x=G=>{jt(G)&&(b.value.scrollLeft=G)},P=()=>{var G;(G=k.value)==null||G.update()};return st(()=>i.noresize,G=>{G?(u==null||u(),f==null||f()):({stop:u}=ar(S,P),f=_o("resize",P))},{immediate:!0}),st(()=>[i.maxHeight,i.height],()=>{i.native||Vt(()=>{var G;P(),b.value&&((G=k.value)==null||G.handleScroll(b.value))})}),Nn(dN,eo({scrollbarElement:_,wrapElement:b})),vL(()=>{b.value&&(b.value.scrollTop=p,b.value.scrollLeft=v)}),mn(()=>{i.native||Vt(()=>{P()})}),dl(()=>P()),t({wrapRef:b,update:P,scrollTo:N,setScrollTop:F,setScrollLeft:x,handleScroll:E}),(G,H)=>(ee(),ge("div",{ref_key:"scrollbarRef",ref:_,class:ne(y(c).b())},[Ee("div",{ref_key:"wrapRef",ref:b,class:ne(y(R)),style:qt(y(M)),tabindex:G.tabindex,onScroll:E},[(ee(),We(Tn(G.tag),{id:G.id,ref_key:"resizeRef",ref:S,class:ne(y(w)),style:qt(G.viewStyle),role:G.role,"aria-label":G.ariaLabel,"aria-orientation":G.ariaOrientation},{default:Ae(()=>[Ve(G.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),G.native?$e("v-if",!0):(ee(),We(Hye,{key:0,ref_key:"barRef",ref:k,always:G.always,"min-size":G.minSize},null,8,["always","min-size"]))],2))}});var Wye=vt(zye,[["__file","scrollbar.vue"]]);const ac=un(Wye),hN=Symbol("popper"),hK=Symbol("popperContent"),fK=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],pK=pt({role:{type:String,values:fK,default:"tooltip"}}),jye=Te({name:"ElPopper",inheritAttrs:!1}),Yye=Te({...jye,props:pK,setup(e,{expose:t}){const o=e,i=le(),c=le(),u=le(),f=le(),p=z(()=>o.role),v={triggerRef:i,popperInstanceRef:c,contentRef:u,referenceRef:f,role:p};return t(v),Nn(hN,v),(_,b)=>Ve(_.$slots,"default")}});var Jye=vt(Yye,[["__file","popper.vue"]]);const mK=pt({arrowOffset:{type:Number,default:5}}),Xye=Te({name:"ElPopperArrow",inheritAttrs:!1}),Zye=Te({...Xye,props:mK,setup(e,{expose:t}){const o=e,i=ut("popper"),{arrowOffset:c,arrowRef:u,arrowStyle:f}=Rt(hK,void 0);return st(()=>o.arrowOffset,p=>{c.value=p}),Co(()=>{u.value=void 0}),t({arrowRef:u}),(p,v)=>(ee(),ge("span",{ref_key:"arrowRef",ref:u,class:ne(y(i).e("arrow")),style:qt(y(f)),"data-popper-arrow":""},null,6))}});var Qye=vt(Zye,[["__file","arrow.vue"]]);const gK=pt({virtualRef:{type:Ue(Object)},virtualTriggering:Boolean,onMouseenter:{type:Ue(Function)},onMouseleave:{type:Ue(Function)},onClick:{type:Ue(Function)},onKeydown:{type:Ue(Function)},onFocus:{type:Ue(Function)},onBlur:{type:Ue(Function)},onContextmenu:{type:Ue(Function)},id:String,open:Boolean}),vK=Symbol("elForwardRef"),e0e=e=>{Nn(vK,{setForwardRef:o=>{e.value=o}})},t0e=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),n0e='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',o0e=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,H8=e=>Array.from(e.querySelectorAll(n0e)).filter(t=>zE(t)&&o0e(t)),zE=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},cE=function(e,t,...o){let i;t.includes("mouse")||t.includes("click")?i="MouseEvents":t.includes("key")?i="KeyboardEvent":i="HTMLEvents";const c=document.createEvent(i);return c.initEvent(t,...o),e.dispatchEvent(c),e},_K=e=>!e.getAttribute("aria-owns"),yK=(e,t,o)=>{const{parentNode:i}=e;if(!i)return null;const c=i.querySelectorAll(o),u=Array.prototype.indexOf.call(c,e);return c[u+t]||null},uE=e=>{e&&(e.focus(),!_K(e)&&e.click())},r0e="ElOnlyChild",IK=Te({name:r0e,setup(e,{slots:t,attrs:o}){var i;const c=Rt(vK),u=t0e((i=c==null?void 0:c.setForwardRef)!=null?i:lo);return()=>{var f;const p=(f=t.default)==null?void 0:f.call(t,o);if(!p||p.length>1)return null;const v=bK(p);return v?fn(iu(v,o),[[u]]):null}}});function bK(e){if(!e)return null;const t=e;for(const o of t){if(gn(o))switch(o.type){case Ai:continue;case lv:case"svg":return $8(o);case Ht:return bK(o.children);default:return o}return $8(o)}return null}function $8(e){const t=ut("only-child");return Me("span",{class:t.e("content")},[e])}const i0e=Te({name:"ElPopperTrigger",inheritAttrs:!1}),a0e=Te({...i0e,props:gK,setup(e,{expose:t}){const o=e,{role:i,triggerRef:c}=Rt(hN,void 0);e0e(c);const u=z(()=>p.value?o.id:void 0),f=z(()=>{if(i&&i.value==="tooltip")return o.open&&o.id?o.id:void 0}),p=z(()=>{if(i&&i.value!=="tooltip")return i.value}),v=z(()=>p.value?`${o.open}`:void 0);let _;const b=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return mn(()=>{st(()=>o.virtualRef,S=>{S&&(c.value=sa(S))},{immediate:!0}),st(c,(S,k)=>{_==null||_(),_=void 0,la(S)&&(b.forEach(M=>{var R;const w=o[M];w&&(S.addEventListener(M.slice(2).toLowerCase(),w),(R=k==null?void 0:k.removeEventListener)==null||R.call(k,M.slice(2).toLowerCase(),w))}),zE(S)&&(_=st([u,f,p,v],M=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((R,w)=>{oi(M[w])?S.removeAttribute(R):S.setAttribute(R,M[w])})},{immediate:!0}))),la(k)&&zE(k)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(M=>k.removeAttribute(M))},{immediate:!0})}),Co(()=>{if(_==null||_(),_=void 0,c.value&&la(c.value)){const S=c.value;b.forEach(k=>{const M=o[k];M&&S.removeEventListener(k.slice(2).toLowerCase(),M)}),c.value=void 0}}),t({triggerRef:c}),(S,k)=>S.virtualTriggering?$e("v-if",!0):(ee(),We(y(IK),An({key:0},S.$attrs,{"aria-controls":y(u),"aria-describedby":y(f),"aria-expanded":y(v),"aria-haspopup":y(p)}),{default:Ae(()=>[Ve(S.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var s0e=vt(a0e,[["__file","trigger.vue"]]);const jA="focus-trap.focus-after-trapped",YA="focus-trap.focus-after-released",l0e="focus-trap.focusout-prevented",q8={cancelable:!0,bubbles:!1},c0e={cancelable:!0,bubbles:!1},K8="focusAfterTrapped",z8="focusAfterReleased",fN=Symbol("elFocusTrap"),pN=le(),BT=le(0),mN=le(0);let FS=0;const CK=e=>{const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const c=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||c?NodeFilter.FILTER_SKIP:i.tabIndex>=0||i===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t},W8=(e,t)=>{for(const o of e)if(!u0e(o,t))return o},u0e=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},d0e=e=>{const t=CK(e),o=W8(t,e),i=W8(t.reverse(),e);return[o,i]},h0e=e=>e instanceof HTMLInputElement&&"select"in e,Kc=(e,t)=>{if(e&&e.focus){const o=document.activeElement;let i=!1;la(e)&&!zE(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),i=!0),e.focus({preventScroll:!0}),mN.value=window.performance.now(),e!==o&&h0e(e)&&t&&e.select(),la(e)&&i&&e.removeAttribute("tabindex")}};function j8(e,t){const o=[...e],i=e.indexOf(t);return i!==-1&&o.splice(i,1),o}const f0e=()=>{let e=[];return{push:i=>{const c=e[0];c&&i!==c&&c.pause(),e=j8(e,i),e.unshift(i)},remove:i=>{var c,u;e=j8(e,i),(u=(c=e[0])==null?void 0:c.resume)==null||u.call(c)}}},p0e=(e,t=!1)=>{const o=document.activeElement;for(const i of e)if(Kc(i,t),document.activeElement!==o)return},Y8=f0e(),m0e=()=>BT.value>mN.value,VS=()=>{pN.value="pointer",BT.value=window.performance.now()},J8=()=>{pN.value="keyboard",BT.value=window.performance.now()},g0e=()=>(mn(()=>{FS===0&&(document.addEventListener("mousedown",VS),document.addEventListener("touchstart",VS),document.addEventListener("keydown",J8)),FS++}),Co(()=>{FS--,FS<=0&&(document.removeEventListener("mousedown",VS),document.removeEventListener("touchstart",VS),document.removeEventListener("keydown",J8))}),{focusReason:pN,lastUserFocusTimestamp:BT,lastAutomatedFocusTimestamp:mN}),GS=e=>new CustomEvent(l0e,{...c0e,detail:e}),At={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let mg=[];const X8=e=>{e.code===At.esc&&mg.forEach(t=>t(e))},v0e=e=>{mn(()=>{mg.length===0&&document.addEventListener("keydown",X8),$n&&mg.push(e)}),Co(()=>{mg=mg.filter(t=>t!==e),mg.length===0&&$n&&document.removeEventListener("keydown",X8)})},_0e=Te({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[K8,z8,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const o=le();let i,c;const{focusReason:u}=g0e();v0e(R=>{e.trapped&&!f.paused&&t("release-requested",R)});const f={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=R=>{if(!e.loop&&!e.trapped||f.paused)return;const{code:w,altKey:E,ctrlKey:N,metaKey:F,currentTarget:x,shiftKey:P}=R,{loop:G}=e,H=w===At.tab&&!E&&!N&&!F,Y=document.activeElement;if(H&&Y){const j=x,[W,O]=d0e(j);if(W&&O){if(!P&&Y===O){const J=GS({focusReason:u.value});t("focusout-prevented",J),J.defaultPrevented||(R.preventDefault(),G&&Kc(W,!0))}else if(P&&[W,j].includes(Y)){const J=GS({focusReason:u.value});t("focusout-prevented",J),J.defaultPrevented||(R.preventDefault(),G&&Kc(O,!0))}}else if(Y===j){const J=GS({focusReason:u.value});t("focusout-prevented",J),J.defaultPrevented||R.preventDefault()}}};Nn(fN,{focusTrapRef:o,onKeydown:p}),st(()=>e.focusTrapEl,R=>{R&&(o.value=R)},{immediate:!0}),st([o],([R],[w])=>{R&&(R.addEventListener("keydown",p),R.addEventListener("focusin",b),R.addEventListener("focusout",S)),w&&(w.removeEventListener("keydown",p),w.removeEventListener("focusin",b),w.removeEventListener("focusout",S))});const v=R=>{t(K8,R)},_=R=>t(z8,R),b=R=>{const w=y(o);if(!w)return;const E=R.target,N=R.relatedTarget,F=E&&w.contains(E);e.trapped||N&&w.contains(N)||(i=N),F&&t("focusin",R),!f.paused&&e.trapped&&(F?c=E:Kc(c,!0))},S=R=>{const w=y(o);if(!(f.paused||!w))if(e.trapped){const E=R.relatedTarget;!oi(E)&&!w.contains(E)&&setTimeout(()=>{if(!f.paused&&e.trapped){const N=GS({focusReason:u.value});t("focusout-prevented",N),N.defaultPrevented||Kc(c,!0)}},0)}else{const E=R.target;E&&w.contains(E)||t("focusout",R)}};async function k(){await Vt();const R=y(o);if(R){Y8.push(f);const w=R.contains(document.activeElement)?i:document.activeElement;if(i=w,!R.contains(w)){const N=new Event(jA,q8);R.addEventListener(jA,v),R.dispatchEvent(N),N.defaultPrevented||Vt(()=>{let F=e.focusStartEl;Ut(F)||(Kc(F),document.activeElement!==F&&(F="first")),F==="first"&&p0e(CK(R),!0),(document.activeElement===w||F==="container")&&Kc(R)})}}}function M(){const R=y(o);if(R){R.removeEventListener(jA,v);const w=new CustomEvent(YA,{...q8,detail:{focusReason:u.value}});R.addEventListener(YA,_),R.dispatchEvent(w),!w.defaultPrevented&&(u.value=="keyboard"||!m0e()||R.contains(document.activeElement))&&Kc(i??document.body),R.removeEventListener(YA,_),Y8.remove(f)}}return mn(()=>{e.trapped&&k(),st(()=>e.trapped,R=>{R?k():M()})}),Co(()=>{e.trapped&&M(),o.value&&(o.value.removeEventListener("keydown",p),o.value.removeEventListener("focusin",b),o.value.removeEventListener("focusout",S),o.value=void 0)}),{onKeydown:p}}});function y0e(e,t,o,i,c,u){return Ve(e.$slots,"default",{handleKeydown:e.onKeydown})}var gv=vt(_0e,[["render",y0e],["__file","focus-trap.vue"]]),Ra="top",Ds="bottom",Os="right",Aa="left",gN="auto",uI=[Ra,Ds,Os,Aa],Wg="start",N0="end",I0e="clippingParents",SK="viewport",Oy="popper",b0e="reference",Z8=uI.reduce(function(e,t){return e.concat([t+"-"+Wg,t+"-"+N0])},[]),mu=[].concat(uI,[gN]).reduce(function(e,t){return e.concat([t,t+"-"+Wg,t+"-"+N0])},[]),C0e="beforeRead",S0e="read",E0e="afterRead",T0e="beforeMain",M0e="main",k0e="afterMain",w0e="beforeWrite",R0e="write",A0e="afterWrite",D0e=[C0e,S0e,E0e,T0e,M0e,k0e,w0e,R0e,A0e];function nc(e){return e?(e.nodeName||"").toLowerCase():null}function pl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function jg(e){var t=pl(e).Element;return e instanceof t||e instanceof Element}function ws(e){var t=pl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function vN(e){if(typeof ShadowRoot>"u")return!1;var t=pl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function O0e(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var i=t.styles[o]||{},c=t.attributes[o]||{},u=t.elements[o];!ws(u)||!nc(u)||(Object.assign(u.style,i),Object.keys(c).forEach(function(f){var p=c[f];p===!1?u.removeAttribute(f):u.setAttribute(f,p===!0?"":p)}))})}function L0e(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(i){var c=t.elements[i],u=t.attributes[i]||{},f=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:o[i]),p=f.reduce(function(v,_){return v[_]="",v},{});!ws(c)||!nc(c)||(Object.assign(c.style,p),Object.keys(u).forEach(function(v){c.removeAttribute(v)}))})}}var EK={name:"applyStyles",enabled:!0,phase:"write",fn:O0e,effect:L0e,requires:["computeStyles"]};function Xl(e){return e.split("-")[0]}var ip=Math.max,WE=Math.min,Yg=Math.round;function Jg(e,t){t===void 0&&(t=!1);var o=e.getBoundingClientRect(),i=1,c=1;if(ws(e)&&t){var u=e.offsetHeight,f=e.offsetWidth;f>0&&(i=Yg(o.width)/f||1),u>0&&(c=Yg(o.height)/u||1)}return{width:o.width/i,height:o.height/c,top:o.top/c,right:o.right/i,bottom:o.bottom/c,left:o.left/i,x:o.left/i,y:o.top/c}}function _N(e){var t=Jg(e),o=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:i}}function TK(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&vN(o)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function au(e){return pl(e).getComputedStyle(e)}function N0e(e){return["table","td","th"].indexOf(nc(e))>=0}function sh(e){return((jg(e)?e.ownerDocument:e.document)||window.document).documentElement}function HT(e){return nc(e)==="html"?e:e.assignedSlot||e.parentNode||(vN(e)?e.host:null)||sh(e)}function Q8(e){return!ws(e)||au(e).position==="fixed"?null:e.offsetParent}function P0e(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,o=navigator.userAgent.indexOf("Trident")!==-1;if(o&&ws(e)){var i=au(e);if(i.position==="fixed")return null}var c=HT(e);for(vN(c)&&(c=c.host);ws(c)&&["html","body"].indexOf(nc(c))<0;){var u=au(c);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||t&&u.willChange==="filter"||t&&u.filter&&u.filter!=="none")return c;c=c.parentNode}return null}function dI(e){for(var t=pl(e),o=Q8(e);o&&N0e(o)&&au(o).position==="static";)o=Q8(o);return o&&(nc(o)==="html"||nc(o)==="body"&&au(o).position==="static")?t:o||P0e(e)||t}function yN(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function s0(e,t,o){return ip(e,WE(t,o))}function x0e(e,t,o){var i=s0(e,t,o);return i>o?o:i}function MK(){return{top:0,right:0,bottom:0,left:0}}function kK(e){return Object.assign({},MK(),e)}function wK(e,t){return t.reduce(function(o,i){return o[i]=e,o},{})}var U0e=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,kK(typeof e!="number"?e:wK(e,uI))};function F0e(e){var t,o=e.state,i=e.name,c=e.options,u=o.elements.arrow,f=o.modifiersData.popperOffsets,p=Xl(o.placement),v=yN(p),_=[Aa,Os].indexOf(p)>=0,b=_?"height":"width";if(!(!u||!f)){var S=U0e(c.padding,o),k=_N(u),M=v==="y"?Ra:Aa,R=v==="y"?Ds:Os,w=o.rects.reference[b]+o.rects.reference[v]-f[v]-o.rects.popper[b],E=f[v]-o.rects.reference[v],N=dI(u),F=N?v==="y"?N.clientHeight||0:N.clientWidth||0:0,x=w/2-E/2,P=S[M],G=F-k[b]-S[R],H=F/2-k[b]/2+x,Y=s0(P,H,G),j=v;o.modifiersData[i]=(t={},t[j]=Y,t.centerOffset=Y-H,t)}}function V0e(e){var t=e.state,o=e.options,i=o.element,c=i===void 0?"[data-popper-arrow]":i;c!=null&&(typeof c=="string"&&(c=t.elements.popper.querySelector(c),!c)||!TK(t.elements.popper,c)||(t.elements.arrow=c))}var G0e={name:"arrow",enabled:!0,phase:"main",fn:F0e,effect:V0e,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Xg(e){return e.split("-")[1]}var B0e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function H0e(e){var t=e.x,o=e.y,i=window,c=i.devicePixelRatio||1;return{x:Yg(t*c)/c||0,y:Yg(o*c)/c||0}}function eB(e){var t,o=e.popper,i=e.popperRect,c=e.placement,u=e.variation,f=e.offsets,p=e.position,v=e.gpuAcceleration,_=e.adaptive,b=e.roundOffsets,S=e.isFixed,k=f.x,M=k===void 0?0:k,R=f.y,w=R===void 0?0:R,E=typeof b=="function"?b({x:M,y:w}):{x:M,y:w};M=E.x,w=E.y;var N=f.hasOwnProperty("x"),F=f.hasOwnProperty("y"),x=Aa,P=Ra,G=window;if(_){var H=dI(o),Y="clientHeight",j="clientWidth";if(H===pl(o)&&(H=sh(o),au(H).position!=="static"&&p==="absolute"&&(Y="scrollHeight",j="scrollWidth")),H=H,c===Ra||(c===Aa||c===Os)&&u===N0){P=Ds;var W=S&&H===G&&G.visualViewport?G.visualViewport.height:H[Y];w-=W-i.height,w*=v?1:-1}if(c===Aa||(c===Ra||c===Ds)&&u===N0){x=Os;var O=S&&H===G&&G.visualViewport?G.visualViewport.width:H[j];M-=O-i.width,M*=v?1:-1}}var Q=Object.assign({position:p},_&&B0e),J=b===!0?H0e({x:M,y:w}):{x:M,y:w};if(M=J.x,w=J.y,v){var oe;return Object.assign({},Q,(oe={},oe[P]=F?"0":"",oe[x]=N?"0":"",oe.transform=(G.devicePixelRatio||1)<=1?"translate("+M+"px, "+w+"px)":"translate3d("+M+"px, "+w+"px, 0)",oe))}return Object.assign({},Q,(t={},t[P]=F?w+"px":"",t[x]=N?M+"px":"",t.transform="",t))}function $0e(e){var t=e.state,o=e.options,i=o.gpuAcceleration,c=i===void 0?!0:i,u=o.adaptive,f=u===void 0?!0:u,p=o.roundOffsets,v=p===void 0?!0:p,_={placement:Xl(t.placement),variation:Xg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:c,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,eB(Object.assign({},_,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:f,roundOffsets:v})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,eB(Object.assign({},_,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:v})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var RK={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:$0e,data:{}},BS={passive:!0};function q0e(e){var t=e.state,o=e.instance,i=e.options,c=i.scroll,u=c===void 0?!0:c,f=i.resize,p=f===void 0?!0:f,v=pl(t.elements.popper),_=[].concat(t.scrollParents.reference,t.scrollParents.popper);return u&&_.forEach(function(b){b.addEventListener("scroll",o.update,BS)}),p&&v.addEventListener("resize",o.update,BS),function(){u&&_.forEach(function(b){b.removeEventListener("scroll",o.update,BS)}),p&&v.removeEventListener("resize",o.update,BS)}}var AK={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:q0e,data:{}},K0e={left:"right",right:"left",bottom:"top",top:"bottom"};function dE(e){return e.replace(/left|right|bottom|top/g,function(t){return K0e[t]})}var z0e={start:"end",end:"start"};function tB(e){return e.replace(/start|end/g,function(t){return z0e[t]})}function IN(e){var t=pl(e),o=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:o,scrollTop:i}}function bN(e){return Jg(sh(e)).left+IN(e).scrollLeft}function W0e(e){var t=pl(e),o=sh(e),i=t.visualViewport,c=o.clientWidth,u=o.clientHeight,f=0,p=0;return i&&(c=i.width,u=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(f=i.offsetLeft,p=i.offsetTop)),{width:c,height:u,x:f+bN(e),y:p}}function j0e(e){var t,o=sh(e),i=IN(e),c=(t=e.ownerDocument)==null?void 0:t.body,u=ip(o.scrollWidth,o.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),f=ip(o.scrollHeight,o.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),p=-i.scrollLeft+bN(e),v=-i.scrollTop;return au(c||o).direction==="rtl"&&(p+=ip(o.clientWidth,c?c.clientWidth:0)-u),{width:u,height:f,x:p,y:v}}function CN(e){var t=au(e),o=t.overflow,i=t.overflowX,c=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+c+i)}function DK(e){return["html","body","#document"].indexOf(nc(e))>=0?e.ownerDocument.body:ws(e)&&CN(e)?e:DK(HT(e))}function l0(e,t){var o;t===void 0&&(t=[]);var i=DK(e),c=i===((o=e.ownerDocument)==null?void 0:o.body),u=pl(i),f=c?[u].concat(u.visualViewport||[],CN(i)?i:[]):i,p=t.concat(f);return c?p:p.concat(l0(HT(f)))}function JD(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Y0e(e){var t=Jg(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function nB(e,t){return t===SK?JD(W0e(e)):jg(t)?Y0e(t):JD(j0e(sh(e)))}function J0e(e){var t=l0(HT(e)),o=["absolute","fixed"].indexOf(au(e).position)>=0,i=o&&ws(e)?dI(e):e;return jg(i)?t.filter(function(c){return jg(c)&&TK(c,i)&&nc(c)!=="body"}):[]}function X0e(e,t,o){var i=t==="clippingParents"?J0e(e):[].concat(t),c=[].concat(i,[o]),u=c[0],f=c.reduce(function(p,v){var _=nB(e,v);return p.top=ip(_.top,p.top),p.right=WE(_.right,p.right),p.bottom=WE(_.bottom,p.bottom),p.left=ip(_.left,p.left),p},nB(e,u));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function OK(e){var t=e.reference,o=e.element,i=e.placement,c=i?Xl(i):null,u=i?Xg(i):null,f=t.x+t.width/2-o.width/2,p=t.y+t.height/2-o.height/2,v;switch(c){case Ra:v={x:f,y:t.y-o.height};break;case Ds:v={x:f,y:t.y+t.height};break;case Os:v={x:t.x+t.width,y:p};break;case Aa:v={x:t.x-o.width,y:p};break;default:v={x:t.x,y:t.y}}var _=c?yN(c):null;if(_!=null){var b=_==="y"?"height":"width";switch(u){case Wg:v[_]=v[_]-(t[b]/2-o[b]/2);break;case N0:v[_]=v[_]+(t[b]/2-o[b]/2);break}}return v}function P0(e,t){t===void 0&&(t={});var o=t,i=o.placement,c=i===void 0?e.placement:i,u=o.boundary,f=u===void 0?I0e:u,p=o.rootBoundary,v=p===void 0?SK:p,_=o.elementContext,b=_===void 0?Oy:_,S=o.altBoundary,k=S===void 0?!1:S,M=o.padding,R=M===void 0?0:M,w=kK(typeof R!="number"?R:wK(R,uI)),E=b===Oy?b0e:Oy,N=e.rects.popper,F=e.elements[k?E:b],x=X0e(jg(F)?F:F.contextElement||sh(e.elements.popper),f,v),P=Jg(e.elements.reference),G=OK({reference:P,element:N,strategy:"absolute",placement:c}),H=JD(Object.assign({},N,G)),Y=b===Oy?H:P,j={top:x.top-Y.top+w.top,bottom:Y.bottom-x.bottom+w.bottom,left:x.left-Y.left+w.left,right:Y.right-x.right+w.right},W=e.modifiersData.offset;if(b===Oy&&W){var O=W[c];Object.keys(j).forEach(function(Q){var J=[Os,Ds].indexOf(Q)>=0?1:-1,oe=[Ra,Ds].indexOf(Q)>=0?"y":"x";j[Q]+=O[oe]*J})}return j}function Z0e(e,t){t===void 0&&(t={});var o=t,i=o.placement,c=o.boundary,u=o.rootBoundary,f=o.padding,p=o.flipVariations,v=o.allowedAutoPlacements,_=v===void 0?mu:v,b=Xg(i),S=b?p?Z8:Z8.filter(function(R){return Xg(R)===b}):uI,k=S.filter(function(R){return _.indexOf(R)>=0});k.length===0&&(k=S);var M=k.reduce(function(R,w){return R[w]=P0(e,{placement:w,boundary:c,rootBoundary:u,padding:f})[Xl(w)],R},{});return Object.keys(M).sort(function(R,w){return M[R]-M[w]})}function Q0e(e){if(Xl(e)===gN)return[];var t=dE(e);return[tB(e),t,tB(t)]}function eIe(e){var t=e.state,o=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var c=o.mainAxis,u=c===void 0?!0:c,f=o.altAxis,p=f===void 0?!0:f,v=o.fallbackPlacements,_=o.padding,b=o.boundary,S=o.rootBoundary,k=o.altBoundary,M=o.flipVariations,R=M===void 0?!0:M,w=o.allowedAutoPlacements,E=t.options.placement,N=Xl(E),F=N===E,x=v||(F||!R?[dE(E)]:Q0e(E)),P=[E].concat(x).reduce(function(Ce,Fe){return Ce.concat(Xl(Fe)===gN?Z0e(t,{placement:Fe,boundary:b,rootBoundary:S,padding:_,flipVariations:R,allowedAutoPlacements:w}):Fe)},[]),G=t.rects.reference,H=t.rects.popper,Y=new Map,j=!0,W=P[0],O=0;O<P.length;O++){var Q=P[O],J=Xl(Q),oe=Xg(Q)===Wg,pe=[Ra,Ds].indexOf(J)>=0,ie=pe?"width":"height",te=P0(t,{placement:Q,boundary:b,rootBoundary:S,altBoundary:k,padding:_}),he=pe?oe?Os:Aa:oe?Ds:Ra;G[ie]>H[ie]&&(he=dE(he));var re=dE(he),X=[];if(u&&X.push(te[J]<=0),p&&X.push(te[he]<=0,te[re]<=0),X.every(function(Ce){return Ce})){W=Q,j=!1;break}Y.set(Q,X)}if(j)for(var ye=R?3:1,ue=function(Ce){var Fe=P.find(function(Oe){var be=Y.get(Oe);if(be)return be.slice(0,Ce).every(function(xe){return xe})});if(Fe)return W=Fe,"break"},Ie=ye;Ie>0;Ie--){var ve=ue(Ie);if(ve==="break")break}t.placement!==W&&(t.modifiersData[i]._skip=!0,t.placement=W,t.reset=!0)}}var tIe={name:"flip",enabled:!0,phase:"main",fn:eIe,requiresIfExists:["offset"],data:{_skip:!1}};function oB(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function rB(e){return[Ra,Os,Ds,Aa].some(function(t){return e[t]>=0})}function nIe(e){var t=e.state,o=e.name,i=t.rects.reference,c=t.rects.popper,u=t.modifiersData.preventOverflow,f=P0(t,{elementContext:"reference"}),p=P0(t,{altBoundary:!0}),v=oB(f,i),_=oB(p,c,u),b=rB(v),S=rB(_);t.modifiersData[o]={referenceClippingOffsets:v,popperEscapeOffsets:_,isReferenceHidden:b,hasPopperEscaped:S},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":S})}var oIe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:nIe};function rIe(e,t,o){var i=Xl(e),c=[Aa,Ra].indexOf(i)>=0?-1:1,u=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,f=u[0],p=u[1];return f=f||0,p=(p||0)*c,[Aa,Os].indexOf(i)>=0?{x:p,y:f}:{x:f,y:p}}function iIe(e){var t=e.state,o=e.options,i=e.name,c=o.offset,u=c===void 0?[0,0]:c,f=mu.reduce(function(b,S){return b[S]=rIe(S,t.rects,u),b},{}),p=f[t.placement],v=p.x,_=p.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=v,t.modifiersData.popperOffsets.y+=_),t.modifiersData[i]=f}var aIe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:iIe};function sIe(e){var t=e.state,o=e.name;t.modifiersData[o]=OK({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var LK={name:"popperOffsets",enabled:!0,phase:"read",fn:sIe,data:{}};function lIe(e){return e==="x"?"y":"x"}function cIe(e){var t=e.state,o=e.options,i=e.name,c=o.mainAxis,u=c===void 0?!0:c,f=o.altAxis,p=f===void 0?!1:f,v=o.boundary,_=o.rootBoundary,b=o.altBoundary,S=o.padding,k=o.tether,M=k===void 0?!0:k,R=o.tetherOffset,w=R===void 0?0:R,E=P0(t,{boundary:v,rootBoundary:_,padding:S,altBoundary:b}),N=Xl(t.placement),F=Xg(t.placement),x=!F,P=yN(N),G=lIe(P),H=t.modifiersData.popperOffsets,Y=t.rects.reference,j=t.rects.popper,W=typeof w=="function"?w(Object.assign({},t.rects,{placement:t.placement})):w,O=typeof W=="number"?{mainAxis:W,altAxis:W}:Object.assign({mainAxis:0,altAxis:0},W),Q=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,J={x:0,y:0};if(H){if(u){var oe,pe=P==="y"?Ra:Aa,ie=P==="y"?Ds:Os,te=P==="y"?"height":"width",he=H[P],re=he+E[pe],X=he-E[ie],ye=M?-j[te]/2:0,ue=F===Wg?Y[te]:j[te],Ie=F===Wg?-j[te]:-Y[te],ve=t.elements.arrow,Ce=M&&ve?_N(ve):{width:0,height:0},Fe=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:MK(),Oe=Fe[pe],be=Fe[ie],xe=s0(0,Y[te],Ce[te]),Le=x?Y[te]/2-ye-xe-Oe-O.mainAxis:ue-xe-Oe-O.mainAxis,rt=x?-Y[te]/2+ye+xe+be+O.mainAxis:Ie+xe+be+O.mainAxis,Qe=t.elements.arrow&&dI(t.elements.arrow),Ge=Qe?P==="y"?Qe.clientTop||0:Qe.clientLeft||0:0,_e=(oe=Q==null?void 0:Q[P])!=null?oe:0,Re=he+Le-_e-Ge,Ke=he+rt-_e,je=s0(M?WE(re,Re):re,he,M?ip(X,Ke):X);H[P]=je,J[P]=je-he}if(p){var ze,nt=P==="x"?Ra:Aa,it=P==="x"?Ds:Os,dt=H[G],gt=G==="y"?"height":"width",ft=dt+E[nt],Mt=dt-E[it],lt=[Ra,Aa].indexOf(N)!==-1,Et=(ze=Q==null?void 0:Q[G])!=null?ze:0,Yt=lt?ft:dt-Y[gt]-j[gt]-Et+O.altAxis,sn=lt?dt+Y[gt]+j[gt]-Et-O.altAxis:Mt,dn=M&&lt?x0e(Yt,dt,sn):s0(M?Yt:ft,dt,M?sn:Mt);H[G]=dn,J[G]=dn-dt}t.modifiersData[i]=J}}var uIe={name:"preventOverflow",enabled:!0,phase:"main",fn:cIe,requiresIfExists:["offset"]};function dIe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function hIe(e){return e===pl(e)||!ws(e)?IN(e):dIe(e)}function fIe(e){var t=e.getBoundingClientRect(),o=Yg(t.width)/e.offsetWidth||1,i=Yg(t.height)/e.offsetHeight||1;return o!==1||i!==1}function pIe(e,t,o){o===void 0&&(o=!1);var i=ws(t),c=ws(t)&&fIe(t),u=sh(t),f=Jg(e,c),p={scrollLeft:0,scrollTop:0},v={x:0,y:0};return(i||!i&&!o)&&((nc(t)!=="body"||CN(u))&&(p=hIe(t)),ws(t)?(v=Jg(t,!0),v.x+=t.clientLeft,v.y+=t.clientTop):u&&(v.x=bN(u))),{x:f.left+p.scrollLeft-v.x,y:f.top+p.scrollTop-v.y,width:f.width,height:f.height}}function mIe(e){var t=new Map,o=new Set,i=[];e.forEach(function(u){t.set(u.name,u)});function c(u){o.add(u.name);var f=[].concat(u.requires||[],u.requiresIfExists||[]);f.forEach(function(p){if(!o.has(p)){var v=t.get(p);v&&c(v)}}),i.push(u)}return e.forEach(function(u){o.has(u.name)||c(u)}),i}function gIe(e){var t=mIe(e);return D0e.reduce(function(o,i){return o.concat(t.filter(function(c){return c.phase===i}))},[])}function vIe(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function _Ie(e){var t=e.reduce(function(o,i){var c=o[i.name];return o[i.name]=c?Object.assign({},c,i,{options:Object.assign({},c.options,i.options),data:Object.assign({},c.data,i.data)}):i,o},{});return Object.keys(t).map(function(o){return t[o]})}var iB={placement:"bottom",modifiers:[],strategy:"absolute"};function aB(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function SN(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,i=o===void 0?[]:o,c=t.defaultOptions,u=c===void 0?iB:c;return function(f,p,v){v===void 0&&(v=u);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},iB,u),modifiersData:{},elements:{reference:f,popper:p},attributes:{},styles:{}},b=[],S=!1,k={state:_,setOptions:function(w){var E=typeof w=="function"?w(_.options):w;R(),_.options=Object.assign({},u,_.options,E),_.scrollParents={reference:jg(f)?l0(f):f.contextElement?l0(f.contextElement):[],popper:l0(p)};var N=gIe(_Ie([].concat(i,_.options.modifiers)));return _.orderedModifiers=N.filter(function(F){return F.enabled}),M(),k.update()},forceUpdate:function(){if(!S){var w=_.elements,E=w.reference,N=w.popper;if(aB(E,N)){_.rects={reference:pIe(E,dI(N),_.options.strategy==="fixed"),popper:_N(N)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(j){return _.modifiersData[j.name]=Object.assign({},j.data)});for(var F=0;F<_.orderedModifiers.length;F++){if(_.reset===!0){_.reset=!1,F=-1;continue}var x=_.orderedModifiers[F],P=x.fn,G=x.options,H=G===void 0?{}:G,Y=x.name;typeof P=="function"&&(_=P({state:_,options:H,name:Y,instance:k})||_)}}}},update:vIe(function(){return new Promise(function(w){k.forceUpdate(),w(_)})}),destroy:function(){R(),S=!0}};if(!aB(f,p))return k;k.setOptions(v).then(function(w){!S&&v.onFirstUpdate&&v.onFirstUpdate(w)});function M(){_.orderedModifiers.forEach(function(w){var E=w.name,N=w.options,F=N===void 0?{}:N,x=w.effect;if(typeof x=="function"){var P=x({state:_,name:E,instance:k,options:F}),G=function(){};b.push(P||G)}})}function R(){b.forEach(function(w){return w()}),b=[]}return k}}SN();var yIe=[AK,LK,RK,EK];SN({defaultModifiers:yIe});var IIe=[AK,LK,RK,EK,aIe,tIe,uIe,G0e,oIe],bIe=SN({defaultModifiers:IIe});const CIe=["fixed","absolute"],SIe=pt({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Ue(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:mu,default:"bottom"},popperOptions:{type:Ue(Object),default:()=>({})},strategy:{type:String,values:CIe,default:"absolute"}}),NK=pt({...SIe,id:String,style:{type:Ue([String,Array,Object])},className:{type:Ue([String,Array,Object])},effect:{type:Ue(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:Ue([String,Array,Object])},popperStyle:{type:Ue([String,Array,Object])},referenceEl:{type:Ue(Object)},triggerTargetEl:{type:Ue(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...Ci(["ariaLabel"])}),EIe={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},TIe=(e,t)=>{const o=le(!1),i=le();return{focusStartRef:i,trapped:o,onFocusAfterReleased:_=>{var b;((b=_.detail)==null?void 0:b.focusReason)!=="pointer"&&(i.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:_=>{e.visible&&!o.value&&(_.target&&(i.value=_.target),o.value=!0)},onFocusoutPrevented:_=>{e.trapping||(_.detail.focusReason==="pointer"&&_.preventDefault(),o.value=!1)},onReleaseRequested:()=>{o.value=!1,t("close")}}},MIe=(e,t=[])=>{const{placement:o,strategy:i,popperOptions:c}=e,u={placement:o,strategy:i,...c,modifiers:[...wIe(e),...t]};return RIe(u,c==null?void 0:c.modifiers),u},kIe=e=>{if($n)return sa(e)};function wIe(e){const{offset:t,gpuAcceleration:o,fallbackPlacements:i}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:i}},{name:"computeStyles",options:{gpuAcceleration:o}}]}function RIe(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const AIe=(e,t,o={})=>{const i={name:"updateState",enabled:!0,phase:"write",fn:({state:v})=>{const _=DIe(v);Object.assign(f.value,_)},requires:["computeStyles"]},c=z(()=>{const{onFirstUpdate:v,placement:_,strategy:b,modifiers:S}=y(o);return{onFirstUpdate:v,placement:_||"bottom",strategy:b||"absolute",modifiers:[...S||[],i,{name:"applyStyles",enabled:!1}]}}),u=Go(),f=le({styles:{popper:{position:y(c).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),p=()=>{u.value&&(u.value.destroy(),u.value=void 0)};return st(c,v=>{const _=y(u);_&&_.setOptions(v)},{deep:!0}),st([e,t],([v,_])=>{p(),!(!v||!_)&&(u.value=bIe(v,_,y(c)))}),Co(()=>{p()}),{state:z(()=>{var v;return{...((v=y(u))==null?void 0:v.state)||{}}}),styles:z(()=>y(f).styles),attributes:z(()=>y(f).attributes),update:()=>{var v;return(v=y(u))==null?void 0:v.update()},forceUpdate:()=>{var v;return(v=y(u))==null?void 0:v.forceUpdate()},instanceRef:z(()=>y(u))}};function DIe(e){const t=Object.keys(e.elements),o=L0(t.map(c=>[c,e.styles[c]||{}])),i=L0(t.map(c=>[c,e.attributes[c]]));return{styles:o,attributes:i}}const OIe=0,LIe=e=>{const{popperInstanceRef:t,contentRef:o,triggerRef:i,role:c}=Rt(hN,void 0),u=le(),f=le(),p=z(()=>({name:"eventListeners",enabled:!!e.visible})),v=z(()=>{var N;const F=y(u),x=(N=y(f))!=null?N:OIe;return{name:"arrow",enabled:!xq(F),options:{element:F,padding:x}}}),_=z(()=>({onFirstUpdate:()=>{R()},...MIe(e,[y(v),y(p)])})),b=z(()=>kIe(e.referenceEl)||y(i)),{attributes:S,state:k,styles:M,update:R,forceUpdate:w,instanceRef:E}=AIe(b,o,_);return st(E,N=>t.value=N,{flush:"sync"}),mn(()=>{st(()=>{var N;return(N=y(b))==null?void 0:N.getBoundingClientRect()},()=>{R()})}),{attributes:S,arrowRef:u,contentRef:o,instanceRef:E,state:k,styles:M,role:c,forceUpdate:w,update:R}},NIe=(e,{attributes:t,styles:o,role:i})=>{const{nextZIndex:c}=pv(),u=ut("popper"),f=z(()=>y(t).popper),p=le(jt(e.zIndex)?e.zIndex:c()),v=z(()=>[u.b(),u.is("pure",e.pure),u.is(e.effect),e.popperClass]),_=z(()=>[{zIndex:y(p)},y(o).popper,e.popperStyle||{}]),b=z(()=>i.value==="dialog"?"false":void 0),S=z(()=>y(o).arrow||{});return{ariaModal:b,arrowStyle:S,contentAttrs:f,contentClass:v,contentStyle:_,contentZIndex:p,updateZIndex:()=>{p.value=jt(e.zIndex)?e.zIndex:c()}}},PIe=Te({name:"ElPopperContent"}),xIe=Te({...PIe,props:NK,emits:EIe,setup(e,{expose:t,emit:o}){const i=e,{focusStartRef:c,trapped:u,onFocusAfterReleased:f,onFocusAfterTrapped:p,onFocusInTrap:v,onFocusoutPrevented:_,onReleaseRequested:b}=TIe(i,o),{attributes:S,arrowRef:k,contentRef:M,styles:R,instanceRef:w,role:E,update:N}=LIe(i),{ariaModal:F,arrowStyle:x,contentAttrs:P,contentClass:G,contentStyle:H,updateZIndex:Y}=NIe(i,{styles:R,attributes:S,role:E}),j=Rt(tc,void 0),W=le();Nn(hK,{arrowStyle:x,arrowRef:k,arrowOffset:W}),j&&Nn(tc,{...j,addInputId:lo,removeInputId:lo});let O;const Q=(oe=!0)=>{N(),oe&&Y()},J=()=>{Q(!1),i.visible&&i.focusOnShow?u.value=!0:i.visible===!1&&(u.value=!1)};return mn(()=>{st(()=>i.triggerTargetEl,(oe,pe)=>{O==null||O(),O=void 0;const ie=y(oe||M.value),te=y(pe||M.value);la(ie)&&(O=st([E,()=>i.ariaLabel,F,()=>i.id],he=>{["role","aria-label","aria-modal","id"].forEach((re,X)=>{oi(he[X])?ie.removeAttribute(re):ie.setAttribute(re,he[X])})},{immediate:!0})),te!==ie&&la(te)&&["role","aria-label","aria-modal","id"].forEach(he=>{te.removeAttribute(he)})},{immediate:!0}),st(()=>i.visible,J,{immediate:!0})}),Co(()=>{O==null||O(),O=void 0}),t({popperContentRef:M,popperInstanceRef:w,updatePopper:Q,contentStyle:H}),(oe,pe)=>(ee(),ge("div",An({ref_key:"contentRef",ref:M},y(P),{style:y(H),class:y(G),tabindex:"-1",onMouseenter:ie=>oe.$emit("mouseenter",ie),onMouseleave:ie=>oe.$emit("mouseleave",ie)}),[Me(y(gv),{trapped:y(u),"trap-on-focus-in":!0,"focus-trap-el":y(M),"focus-start-el":y(c),onFocusAfterTrapped:y(p),onFocusAfterReleased:y(f),onFocusin:y(v),onFocusoutPrevented:y(_),onReleaseRequested:y(b)},{default:Ae(()=>[Ve(oe.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var UIe=vt(xIe,[["__file","content.vue"]]);const PK=un(Jye),$T=Symbol("elTooltip");function sB(){let e;const t=(i,c)=>{o(),e=window.setTimeout(i,c)},o=()=>window.clearTimeout(e);return aI(()=>o()),{registerTimeout:t,cancelTimeout:o}}const FIe=pt({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),VIe=({showAfter:e,hideAfter:t,autoClose:o,open:i,close:c})=>{const{registerTimeout:u}=sB(),{registerTimeout:f,cancelTimeout:p}=sB();return{onOpen:b=>{u(()=>{i(b);const S=y(o);jt(S)&&S>0&&f(()=>{c(b)},S)},y(e))},onClose:b=>{p(),u(()=>{c(b)},y(t))}}},qT=pt({to:{type:Ue([String,Object]),required:!0},disabled:Boolean}),Ur=pt({...FIe,...NK,appendTo:{type:qT.to.type},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:Ue(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...Ci(["ariaLabel"])}),Og=pt({...gK,disabled:Boolean,trigger:{type:Ue([String,Array]),default:"hover"},triggerKeys:{type:Ue(Array),default:()=>[At.enter,At.numpadEnter,At.space]}}),GIe=fl({type:Ue(Boolean),default:null}),BIe=fl({type:Ue(Function)}),xK=e=>{const t=`update:${e}`,o=`onUpdate:${e}`,i=[t],c={[e]:GIe,[o]:BIe};return{useModelToggle:({indicator:f,toggleReason:p,shouldHideWhenRouteChanges:v,shouldProceed:_,onShow:b,onHide:S})=>{const k=kn(),{emit:M}=k,R=k.props,w=z(()=>zt(R[o])),E=z(()=>R[e]===null),N=Y=>{f.value!==!0&&(f.value=!0,p&&(p.value=Y),zt(b)&&b(Y))},F=Y=>{f.value!==!1&&(f.value=!1,p&&(p.value=Y),zt(S)&&S(Y))},x=Y=>{if(R.disabled===!0||zt(_)&&!_())return;const j=w.value&&$n;j&&M(t,!0),(E.value||!j)&&N(Y)},P=Y=>{if(R.disabled===!0||!$n)return;const j=w.value&&$n;j&&M(t,!1),(E.value||!j)&&F(Y)},G=Y=>{vo(Y)&&(R.disabled&&Y?w.value&&M(t,!1):f.value!==Y&&(Y?N():F()))},H=()=>{f.value?P():x()};return st(()=>R[e],G),v&&k.appContext.config.globalProperties.$route!==void 0&&st(()=>({...k.proxy.$route}),()=>{v.value&&f.value&&P()}),mn(()=>{G(R[e])}),{hide:P,show:x,toggle:H,hasUpdateHandler:w}},useModelToggleProps:c,useModelToggleEmits:i}};xK("modelValue");const{useModelToggleProps:HIe,useModelToggleEmits:$Ie,useModelToggle:qIe}=xK("visible"),KIe=pt({...pK,...HIe,...Ur,...Og,...mK,showArrow:{type:Boolean,default:!0}}),zIe=[...$Ie,"before-show","before-hide","show","hide","open","close"],WIe=(e,t)=>ht(e)?e.includes(t):e===t,cg=(e,t,o)=>i=>{WIe(y(e),t)&&o(i)},gr=(e,t,{checkForDefaultPrevented:o=!0}={})=>c=>{const u=e==null?void 0:e(c);if(o===!1||!u)return t==null?void 0:t(c)},lB=e=>t=>t.pointerType==="mouse"?e(t):void 0,jIe=Te({name:"ElTooltipTrigger"}),YIe=Te({...jIe,props:Og,setup(e,{expose:t}){const o=e,i=ut("tooltip"),{controlled:c,id:u,open:f,onOpen:p,onClose:v,onToggle:_}=Rt($T,void 0),b=le(null),S=()=>{if(y(c)||o.disabled)return!0},k=uo(o,"trigger"),M=gr(S,cg(k,"hover",p)),R=gr(S,cg(k,"hover",v)),w=gr(S,cg(k,"click",P=>{P.button===0&&_(P)})),E=gr(S,cg(k,"focus",p)),N=gr(S,cg(k,"focus",v)),F=gr(S,cg(k,"contextmenu",P=>{P.preventDefault(),_(P)})),x=gr(S,P=>{const{code:G}=P;o.triggerKeys.includes(G)&&(P.preventDefault(),_(P))});return t({triggerRef:b}),(P,G)=>(ee(),We(y(s0e),{id:y(u),"virtual-ref":P.virtualRef,open:y(f),"virtual-triggering":P.virtualTriggering,class:ne(y(i).e("trigger")),onBlur:y(N),onClick:y(w),onContextmenu:y(F),onFocus:y(E),onMouseenter:y(M),onMouseleave:y(R),onKeydown:y(x)},{default:Ae(()=>[Ve(P.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var JIe=vt(YIe,[["__file","trigger.vue"]]);const XIe=Te({__name:"teleport",props:qT,setup(e){return(t,o)=>t.disabled?Ve(t.$slots,"default",{key:0}):(ee(),We(xse,{key:1,to:t.to},[Ve(t.$slots,"default")],8,["to"]))}});var ZIe=vt(XIe,[["__file","teleport.vue"]]);const vv=un(ZIe),UK=()=>{const e=xL(),t=cN(),o=z(()=>`${e.value}-popper-container-${t.prefix}`),i=z(()=>`#${o.value}`);return{id:o,selector:i}},QIe=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},ebe=()=>{const{id:e,selector:t}=UK();return bT(()=>{$n&&(document.body.querySelector(t.value)||QIe(e.value))}),{id:e,selector:t}},tbe=Te({name:"ElTooltipContent",inheritAttrs:!1}),nbe=Te({...tbe,props:Ur,setup(e,{expose:t}){const o=e,{selector:i}=UK(),c=ut("tooltip"),u=le(),f=$E(()=>{var re;return(re=u.value)==null?void 0:re.popperContentRef});let p;const{controlled:v,id:_,open:b,trigger:S,onClose:k,onOpen:M,onShow:R,onHide:w,onBeforeShow:E,onBeforeHide:N}=Rt($T,void 0),F=z(()=>o.transition||`${c.namespace.value}-fade-in-linear`),x=z(()=>o.persistent);Co(()=>{p==null||p()});const P=z(()=>y(x)?!0:y(b)),G=z(()=>o.disabled?!1:y(b)),H=z(()=>o.appendTo||i.value),Y=z(()=>{var re;return(re=o.style)!=null?re:{}}),j=le(!0),W=()=>{w(),he()&&Kc(document.body),j.value=!0},O=()=>{if(y(v))return!0},Q=gr(O,()=>{o.enterable&&y(S)==="hover"&&M()}),J=gr(O,()=>{y(S)==="hover"&&k()}),oe=()=>{var re,X;(X=(re=u.value)==null?void 0:re.updatePopper)==null||X.call(re),E==null||E()},pe=()=>{N==null||N()},ie=()=>{R(),p=QL(f,()=>{if(y(v))return;y(S)!=="hover"&&k()})},te=()=>{o.virtualTriggering||k()},he=re=>{var X;const ye=(X=u.value)==null?void 0:X.popperContentRef,ue=(re==null?void 0:re.relatedTarget)||document.activeElement;return ye==null?void 0:ye.contains(ue)};return st(()=>y(b),re=>{re?j.value=!1:p==null||p()},{flush:"post"}),st(()=>o.content,()=>{var re,X;(X=(re=u.value)==null?void 0:re.updatePopper)==null||X.call(re)}),t({contentRef:u,isFocusInsideContent:he}),(re,X)=>(ee(),We(y(vv),{disabled:!re.teleported,to:y(H)},{default:Ae(()=>[Me(Zr,{name:y(F),onAfterLeave:W,onBeforeEnter:oe,onAfterEnter:ie,onBeforeLeave:pe},{default:Ae(()=>[y(P)?fn((ee(),We(y(UIe),An({key:0,id:y(_),ref_key:"contentRef",ref:u},re.$attrs,{"aria-label":re.ariaLabel,"aria-hidden":j.value,"boundaries-padding":re.boundariesPadding,"fallback-placements":re.fallbackPlacements,"gpu-acceleration":re.gpuAcceleration,offset:re.offset,placement:re.placement,"popper-options":re.popperOptions,strategy:re.strategy,effect:re.effect,enterable:re.enterable,pure:re.pure,"popper-class":re.popperClass,"popper-style":[re.popperStyle,y(Y)],"reference-el":re.referenceEl,"trigger-target-el":re.triggerTargetEl,visible:y(G),"z-index":re.zIndex,onMouseenter:y(Q),onMouseleave:y(J),onBlur:te,onClose:y(k)}),{default:Ae(()=>[Ve(re.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Zn,y(G)]]):$e("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var obe=vt(nbe,[["__file","content.vue"]]);const rbe=Te({name:"ElTooltip"}),ibe=Te({...rbe,props:KIe,emits:zIe,setup(e,{expose:t,emit:o}){const i=e;ebe();const c=ut("tooltip"),u=bi(),f=le(),p=le(),v=()=>{var x;const P=y(f);P&&((x=P.popperInstanceRef)==null||x.update())},_=le(!1),b=le(),{show:S,hide:k,hasUpdateHandler:M}=qIe({indicator:_,toggleReason:b}),{onOpen:R,onClose:w}=VIe({showAfter:uo(i,"showAfter"),hideAfter:uo(i,"hideAfter"),autoClose:uo(i,"autoClose"),open:S,close:k}),E=z(()=>vo(i.visible)&&!M.value),N=z(()=>[c.b(),i.popperClass]);Nn($T,{controlled:E,id:u,open:sv(_),trigger:uo(i,"trigger"),onOpen:x=>{R(x)},onClose:x=>{w(x)},onToggle:x=>{y(_)?w(x):R(x)},onShow:()=>{o("show",b.value)},onHide:()=>{o("hide",b.value)},onBeforeShow:()=>{o("before-show",b.value)},onBeforeHide:()=>{o("before-hide",b.value)},updatePopper:v}),st(()=>i.disabled,x=>{x&&_.value&&(_.value=!1)});const F=x=>{var P;return(P=p.value)==null?void 0:P.isFocusInsideContent(x)};return h$(()=>_.value&&k()),t({popperRef:f,contentRef:p,isFocusInsideContent:F,updatePopper:v,onOpen:R,onClose:w,hide:k}),(x,P)=>(ee(),We(y(PK),{ref_key:"popperRef",ref:f,role:x.role},{default:Ae(()=>[Me(JIe,{disabled:x.disabled,trigger:x.trigger,"trigger-keys":x.triggerKeys,"virtual-ref":x.virtualRef,"virtual-triggering":x.virtualTriggering},{default:Ae(()=>[x.$slots.default?Ve(x.$slots,"default",{key:0}):$e("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Me(obe,{ref_key:"contentRef",ref:p,"aria-label":x.ariaLabel,"boundaries-padding":x.boundariesPadding,content:x.content,disabled:x.disabled,effect:x.effect,enterable:x.enterable,"fallback-placements":x.fallbackPlacements,"hide-after":x.hideAfter,"gpu-acceleration":x.gpuAcceleration,offset:x.offset,persistent:x.persistent,"popper-class":y(N),"popper-style":x.popperStyle,placement:x.placement,"popper-options":x.popperOptions,pure:x.pure,"raw-content":x.rawContent,"reference-el":x.referenceEl,"trigger-target-el":x.triggerTargetEl,"show-after":x.showAfter,strategy:x.strategy,teleported:x.teleported,transition:x.transition,"virtual-triggering":x.virtualTriggering,"z-index":x.zIndex,"append-to":x.appendTo},{default:Ae(()=>[Ve(x.$slots,"content",{},()=>[x.rawContent?(ee(),ge("span",{key:0,innerHTML:x.content},null,8,["innerHTML"])):(ee(),ge("span",{key:1},mt(x.content),1))]),x.showArrow?(ee(),We(y(Qye),{key:0,"arrow-offset":x.arrowOffset},null,8,["arrow-offset"])):$e("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var abe=vt(ibe,[["__file","tooltip.vue"]]);const Li=un(abe),sbe=pt({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:Ue(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:Ue([Function,Array]),default:lo},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Ur.teleported,appendTo:Ur.appendTo,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Ci(["ariaLabel"])}),lbe={[nn]:e=>Ut(e),[Jr]:e=>Ut(e),[wn]:e=>Ut(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>gn(e)},FK="ElAutocomplete",cbe=Te({name:FK,inheritAttrs:!1}),ube=Te({...cbe,props:sbe,emits:lbe,setup(e,{expose:t,emit:o}){const i=e,c=lI(),u=uu(),f=Pi(),p=ut("autocomplete"),v=le(),_=le(),b=le(),S=le();let k=!1,M=!1;const R=le([]),w=le(-1),E=le(""),N=le(!1),F=le(!1),x=le(!1),P=bi(),G=z(()=>u.style),H=z(()=>(R.value.length>0||x.value)&&N.value),Y=z(()=>!i.hideLoading&&x.value),j=z(()=>v.value?Array.from(v.value.$el.querySelectorAll("input")):[]),W=()=>{H.value&&(E.value=`${v.value.$el.offsetWidth}px`)},O=()=>{w.value=-1},Q=async be=>{if(F.value)return;const xe=Le=>{x.value=!1,!F.value&&(ht(Le)?(R.value=Le,w.value=i.highlightFirstItem?0:-1):qr(FK,"autocomplete suggestions must be an array"))};if(x.value=!0,ht(i.fetchSuggestions))xe(i.fetchSuggestions);else{const Le=await i.fetchSuggestions(be,xe);ht(Le)&&xe(Le)}},J=Oa(Q,i.debounce),oe=be=>{const xe=!!be;if(o(Jr,be),o(nn,be),F.value=!1,N.value||(N.value=xe),!i.triggerOnFocus&&!be){F.value=!0,R.value=[];return}J(be)},pe=be=>{var xe;f.value||(((xe=be.target)==null?void 0:xe.tagName)!=="INPUT"||j.value.includes(document.activeElement))&&(N.value=!0)},ie=be=>{o(wn,be)},te=be=>{var xe;if(M)M=!1;else{N.value=!0,o("focus",be);const Le=(xe=i.modelValue)!=null?xe:"";i.triggerOnFocus&&!k&&J(String(Le))}},he=be=>{setTimeout(()=>{var xe;if((xe=b.value)!=null&&xe.isFocusInsideContent()){M=!0;return}N.value&&ue(),o("blur",be)})},re=()=>{N.value=!1,o(nn,""),o("clear")},X=async()=>{H.value&&w.value>=0&&w.value<R.value.length?Ce(R.value[w.value]):i.selectWhenUnmatched&&(o("select",{value:i.modelValue}),R.value=[],w.value=-1)},ye=be=>{H.value&&(be.preventDefault(),be.stopPropagation(),ue())},ue=()=>{N.value=!1},Ie=()=>{var be;(be=v.value)==null||be.focus()},ve=()=>{var be;(be=v.value)==null||be.blur()},Ce=async be=>{o(Jr,be[i.valueKey]),o(nn,be[i.valueKey]),o("select",be),R.value=[],w.value=-1},Fe=be=>{if(!H.value||x.value)return;if(be<0){w.value=-1;return}be>=R.value.length&&(be=R.value.length-1);const xe=_.value.querySelector(`.${p.be("suggestion","wrap")}`),rt=xe.querySelectorAll(`.${p.be("suggestion","list")} li`)[be],Qe=xe.scrollTop,{offsetTop:Ge,scrollHeight:_e}=rt;Ge+_e>Qe+xe.clientHeight&&(xe.scrollTop+=_e),Ge<Qe&&(xe.scrollTop-=_e),w.value=be,v.value.ref.setAttribute("aria-activedescendant",`${P.value}-item-${w.value}`)},Oe=QL(S,()=>{var be;(be=b.value)!=null&&be.isFocusInsideContent()||H.value&&ue()});return Co(()=>{Oe==null||Oe()}),mn(()=>{v.value.ref.setAttribute("role","textbox"),v.value.ref.setAttribute("aria-autocomplete","list"),v.value.ref.setAttribute("aria-controls","id"),v.value.ref.setAttribute("aria-activedescendant",`${P.value}-item-${w.value}`),k=v.value.ref.hasAttribute("readonly")}),t({highlightedIndex:w,activated:N,loading:x,inputRef:v,popperRef:b,suggestions:R,handleSelect:Ce,handleKeyEnter:X,focus:Ie,blur:ve,close:ue,highlight:Fe,getData:Q}),(be,xe)=>(ee(),We(y(Li),{ref_key:"popperRef",ref:b,visible:y(H),placement:be.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(p).e("popper"),be.popperClass],teleported:be.teleported,"append-to":be.appendTo,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(p).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:W,onHide:O},{content:Ae(()=>[Ee("div",{ref_key:"regionRef",ref:_,class:ne([y(p).b("suggestion"),y(p).is("loading",y(Y))]),style:qt({[be.fitInputWidth?"width":"minWidth"]:E.value,outline:"none"}),role:"region"},[Me(y(ac),{id:y(P),tag:"ul","wrap-class":y(p).be("suggestion","wrap"),"view-class":y(p).be("suggestion","list"),role:"listbox"},{default:Ae(()=>[y(Y)?(ee(),ge("li",{key:0},[Ve(be.$slots,"loading",{},()=>[Me(y(Pt),{class:ne(y(p).is("loading"))},{default:Ae(()=>[Me(y(ec))]),_:1},8,["class"])])])):(ee(!0),ge(Ht,{key:1},Un(R.value,(Le,rt)=>(ee(),ge("li",{id:`${y(P)}-item-${rt}`,key:rt,class:ne({highlighted:w.value===rt}),role:"option","aria-selected":w.value===rt,onClick:Qe=>Ce(Le)},[Ve(be.$slots,"default",{item:Le},()=>[Mn(mt(Le[be.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:Ae(()=>[Ee("div",{ref_key:"listboxRef",ref:S,class:ne([y(p).b(),be.$attrs.class]),style:qt(y(G)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(H),"aria-owns":y(P)},[Me(y(Yi),An({ref_key:"inputRef",ref:v},y(c),{clearable:be.clearable,disabled:y(f),name:be.name,"model-value":be.modelValue,"aria-label":be.ariaLabel,onInput:oe,onChange:ie,onFocus:te,onBlur:he,onClear:re,onKeydown:[To(Zt(Le=>Fe(w.value-1),["prevent"]),["up"]),To(Zt(Le=>Fe(w.value+1),["prevent"]),["down"]),To(X,["enter"]),To(ue,["tab"]),To(ye,["esc"])],onMousedown:pe}),rs({_:2},[be.$slots.prepend?{name:"prepend",fn:Ae(()=>[Ve(be.$slots,"prepend")])}:void 0,be.$slots.append?{name:"append",fn:Ae(()=>[Ve(be.$slots,"append")])}:void 0,be.$slots.prefix?{name:"prefix",fn:Ae(()=>[Ve(be.$slots,"prefix")])}:void 0,be.$slots.suffix?{name:"suffix",fn:Ae(()=>[Ve(be.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","append-to","transition"]))}});var dbe=vt(ube,[["__file","autocomplete.vue"]]);const hbe=un(dbe),fbe=pt({size:{type:[Number,String],values:ic,default:"",validator:e=>jt(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:ho},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:Ue(String),default:"cover"}}),pbe={error:e=>e instanceof Event},mbe=Te({name:"ElAvatar"}),gbe=Te({...mbe,props:fbe,emits:pbe,setup(e,{emit:t}){const o=e,i=ut("avatar"),c=le(!1),u=z(()=>{const{size:_,icon:b,shape:S}=o,k=[i.b()];return Ut(_)&&k.push(i.m(_)),b&&k.push(i.m("icon")),S&&k.push(i.m(S)),k}),f=z(()=>{const{size:_}=o;return jt(_)?i.cssVarBlock({size:ur(_)||""}):void 0}),p=z(()=>({objectFit:o.fit}));st(()=>o.src,()=>c.value=!1);function v(_){c.value=!0,t("error",_)}return(_,b)=>(ee(),ge("span",{class:ne(y(u)),style:qt(y(f))},[(_.src||_.srcSet)&&!c.value?(ee(),ge("img",{key:0,src:_.src,alt:_.alt,srcset:_.srcSet,style:qt(y(p)),onError:v},null,44,["src","alt","srcset"])):_.icon?(ee(),We(y(Pt),{key:1},{default:Ae(()=>[(ee(),We(Tn(_.icon)))]),_:1})):Ve(_.$slots,"default",{key:2})],6))}});var vbe=vt(gbe,[["__file","avatar.vue"]]);const _be=un(vbe),ybe={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},Ibe={click:e=>e instanceof MouseEvent},bbe=(e,t,o)=>{const i=Go(),c=Go(),u=le(!1),f=()=>{i.value&&(u.value=i.value.scrollTop>=e.visibilityHeight)},p=_=>{var b;(b=i.value)==null||b.scrollTo({top:0,behavior:"smooth"}),t("click",_)},v=Gq(f,300,!0);return _o(c,"scroll",v),mn(()=>{var _;c.value=document,i.value=document.documentElement,e.target&&(i.value=(_=document.querySelector(e.target))!=null?_:void 0,i.value||qr(o,`target does not exist: ${e.target}`),c.value=i.value),f()}),{visible:u,handleClick:p}},VK="ElBacktop",Cbe=Te({name:VK}),Sbe=Te({...Cbe,props:ybe,emits:Ibe,setup(e,{emit:t}){const o=e,i=ut("backtop"),{handleClick:c,visible:u}=bbe(o,t,VK),f=z(()=>({right:`${o.right}px`,bottom:`${o.bottom}px`}));return(p,v)=>(ee(),We(Zr,{name:`${y(i).namespace.value}-fade-in`},{default:Ae(()=>[y(u)?(ee(),ge("div",{key:0,style:qt(y(f)),class:ne(y(i).b()),onClick:Zt(y(c),["stop"])},[Ve(p.$slots,"default",{},()=>[Me(y(Pt),{class:ne(y(i).e("icon"))},{default:Ae(()=>[Me(y(g_e))]),_:1},8,["class"])])],14,["onClick"])):$e("v-if",!0)]),_:3},8,["name"]))}});var Ebe=vt(Sbe,[["__file","backtop.vue"]]);const Tbe=un(Ebe),Mbe=pt({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:Ue([String,Object,Array])},offset:{type:Ue(Array),default:[0,0]},badgeClass:{type:String}}),kbe=Te({name:"ElBadge"}),wbe=Te({...kbe,props:Mbe,setup(e,{expose:t}){const o=e,i=ut("badge"),c=z(()=>o.isDot?"":jt(o.value)&&jt(o.max)?o.max<o.value?`${o.max}+`:`${o.value}`:`${o.value}`),u=z(()=>{var f,p,v,_,b;return[{backgroundColor:o.color,marginRight:ur(-((p=(f=o.offset)==null?void 0:f[0])!=null?p:0)),marginTop:ur((_=(v=o.offset)==null?void 0:v[1])!=null?_:0)},(b=o.badgeStyle)!=null?b:{}]});return t({content:c}),(f,p)=>(ee(),ge("div",{class:ne(y(i).b())},[Ve(f.$slots,"default"),Me(Zr,{name:`${y(i).namespace.value}-zoom-in-center`,persisted:""},{default:Ae(()=>[fn(Ee("sup",{class:ne([y(i).e("content"),y(i).em("content",f.type),y(i).is("fixed",!!f.$slots.default),y(i).is("dot",f.isDot),y(i).is("hide-zero",!f.showZero&&o.value===0),f.badgeClass]),style:qt(y(u))},[Ve(f.$slots,"content",{value:y(c)},()=>[Mn(mt(y(c)),1)])],6),[[Zn,!f.hidden&&(y(c)||f.isDot||f.$slots.content)]])]),_:3},8,["name"])],2))}});var Rbe=vt(wbe,[["__file","badge.vue"]]);const GK=un(Rbe),BK=Symbol("breadcrumbKey"),Abe=pt({separator:{type:String,default:"/"},separatorIcon:{type:ho}}),Dbe=Te({name:"ElBreadcrumb"}),Obe=Te({...Dbe,props:Abe,setup(e){const t=e,{t:o}=Kn(),i=ut("breadcrumb"),c=le();return Nn(BK,t),mn(()=>{const u=c.value.querySelectorAll(`.${i.e("item")}`);u.length&&u[u.length-1].setAttribute("aria-current","page")}),(u,f)=>(ee(),ge("div",{ref_key:"breadcrumb",ref:c,class:ne(y(i).b()),"aria-label":y(o)("el.breadcrumb.label"),role:"navigation"},[Ve(u.$slots,"default")],10,["aria-label"]))}});var Lbe=vt(Obe,[["__file","breadcrumb.vue"]]);const Nbe=pt({to:{type:Ue([String,Object]),default:""},replace:Boolean}),Pbe=Te({name:"ElBreadcrumbItem"}),xbe=Te({...Pbe,props:Nbe,setup(e){const t=e,o=kn(),i=Rt(BK,void 0),c=ut("breadcrumb"),u=o.appContext.config.globalProperties.$router,f=le(),p=()=>{!t.to||!u||(t.replace?u.replace(t.to):u.push(t.to))};return(v,_)=>{var b,S;return ee(),ge("span",{class:ne(y(c).e("item"))},[Ee("span",{ref_key:"link",ref:f,class:ne([y(c).e("inner"),y(c).is("link",!!v.to)]),role:"link",onClick:p},[Ve(v.$slots,"default")],2),(b=y(i))!=null&&b.separatorIcon?(ee(),We(y(Pt),{key:0,class:ne(y(c).e("separator"))},{default:Ae(()=>[(ee(),We(Tn(y(i).separatorIcon)))]),_:1},8,["class"])):(ee(),ge("span",{key:1,class:ne(y(c).e("separator")),role:"presentation"},mt((S=y(i))==null?void 0:S.separator),3))],2)}}});var HK=vt(xbe,[["__file","breadcrumb-item.vue"]]);const Ube=un(Lbe,{BreadcrumbItem:HK}),Fbe=lr(HK),$K=Symbol("buttonGroupContextKey"),ou=({from:e,replacement:t,scope:o,version:i,ref:c,type:u="API"},f)=>{st(()=>y(f),p=>{},{immediate:!0})},Vbe=(e,t)=>{ou({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},z(()=>e.type==="text"));const o=Rt($K,void 0),i=xT("button"),{form:c}=Ni(),u=Fr(z(()=>o==null?void 0:o.size)),f=Pi(),p=le(),v=Qr(),_=z(()=>e.type||(o==null?void 0:o.type)||""),b=z(()=>{var R,w,E;return(E=(w=e.autoInsertSpace)!=null?w:(R=i.value)==null?void 0:R.autoInsertSpace)!=null?E:!1}),S=z(()=>e.tag==="button"?{ariaDisabled:f.value||e.loading,disabled:f.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),k=z(()=>{var R;const w=(R=v.default)==null?void 0:R.call(v);if(b.value&&(w==null?void 0:w.length)===1){const E=w[0];if((E==null?void 0:E.type)===lv){const N=E.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(N.trim())}}return!1});return{_disabled:f,_size:u,_type:_,_ref:p,_props:S,shouldAddSpace:k,handleClick:R=>{if(f.value||e.loading){R.stopPropagation();return}e.nativeType==="reset"&&(c==null||c.resetFields()),t("click",R)}}},XD=["default","primary","success","warning","info","danger","text",""],Gbe=["button","submit","reset"],ZD=pt({size:Kr,disabled:Boolean,type:{type:String,values:XD,default:""},icon:{type:ho},nativeType:{type:String,values:Gbe,default:"button"},loading:Boolean,loadingIcon:{type:ho,default:()=>ec},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Ue([String,Object]),default:"button"}}),Bbe={click:e=>e instanceof MouseEvent};function Oi(e,t){Hbe(e)&&(e="100%");var o=$be(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function HS(e){return Math.min(1,Math.max(0,e))}function Hbe(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function $be(e){return typeof e=="string"&&e.indexOf("%")!==-1}function qK(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function $S(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Yf(e){return e.length===1?"0"+e:String(e)}function qbe(e,t,o){return{r:Oi(e,255)*255,g:Oi(t,255)*255,b:Oi(o,255)*255}}function cB(e,t,o){e=Oi(e,255),t=Oi(t,255),o=Oi(o,255);var i=Math.max(e,t,o),c=Math.min(e,t,o),u=0,f=0,p=(i+c)/2;if(i===c)f=0,u=0;else{var v=i-c;switch(f=p>.5?v/(2-i-c):v/(i+c),i){case e:u=(t-o)/v+(t<o?6:0);break;case t:u=(o-e)/v+2;break;case o:u=(e-t)/v+4;break}u/=6}return{h:u,s:f,l:p}}function JA(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(t-e)*(6*o):o<1/2?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function Kbe(e,t,o){var i,c,u;if(e=Oi(e,360),t=Oi(t,100),o=Oi(o,100),t===0)c=o,u=o,i=o;else{var f=o<.5?o*(1+t):o+t-o*t,p=2*o-f;i=JA(p,f,e+1/3),c=JA(p,f,e),u=JA(p,f,e-1/3)}return{r:i*255,g:c*255,b:u*255}}function uB(e,t,o){e=Oi(e,255),t=Oi(t,255),o=Oi(o,255);var i=Math.max(e,t,o),c=Math.min(e,t,o),u=0,f=i,p=i-c,v=i===0?0:p/i;if(i===c)u=0;else{switch(i){case e:u=(t-o)/p+(t<o?6:0);break;case t:u=(o-e)/p+2;break;case o:u=(e-t)/p+4;break}u/=6}return{h:u,s:v,v:f}}function zbe(e,t,o){e=Oi(e,360)*6,t=Oi(t,100),o=Oi(o,100);var i=Math.floor(e),c=e-i,u=o*(1-t),f=o*(1-c*t),p=o*(1-(1-c)*t),v=i%6,_=[o,f,u,u,p,o][v],b=[p,o,o,f,u,u][v],S=[u,u,p,o,o,f][v];return{r:_*255,g:b*255,b:S*255}}function dB(e,t,o,i){var c=[Yf(Math.round(e).toString(16)),Yf(Math.round(t).toString(16)),Yf(Math.round(o).toString(16))];return i&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function Wbe(e,t,o,i,c){var u=[Yf(Math.round(e).toString(16)),Yf(Math.round(t).toString(16)),Yf(Math.round(o).toString(16)),Yf(jbe(i))];return c&&u[0].startsWith(u[0].charAt(1))&&u[1].startsWith(u[1].charAt(1))&&u[2].startsWith(u[2].charAt(1))&&u[3].startsWith(u[3].charAt(1))?u[0].charAt(0)+u[1].charAt(0)+u[2].charAt(0)+u[3].charAt(0):u.join("")}function jbe(e){return Math.round(parseFloat(e)*255).toString(16)}function hB(e){return Ya(e)/255}function Ya(e){return parseInt(e,16)}function Ybe(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var QD={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Jbe(e){var t={r:0,g:0,b:0},o=1,i=null,c=null,u=null,f=!1,p=!1;return typeof e=="string"&&(e=Qbe(e)),typeof e=="object"&&($c(e.r)&&$c(e.g)&&$c(e.b)?(t=qbe(e.r,e.g,e.b),f=!0,p=String(e.r).substr(-1)==="%"?"prgb":"rgb"):$c(e.h)&&$c(e.s)&&$c(e.v)?(i=$S(e.s),c=$S(e.v),t=zbe(e.h,i,c),f=!0,p="hsv"):$c(e.h)&&$c(e.s)&&$c(e.l)&&(i=$S(e.s),u=$S(e.l),t=Kbe(e.h,i,u),f=!0,p="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=qK(o),{ok:f,format:e.format||p,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:o}}var Xbe="[-\\+]?\\d+%?",Zbe="[-\\+]?\\d*\\.\\d+%?",Pd="(?:".concat(Zbe,")|(?:").concat(Xbe,")"),XA="[\\s|\\(]+(".concat(Pd,")[,|\\s]+(").concat(Pd,")[,|\\s]+(").concat(Pd,")\\s*\\)?"),ZA="[\\s|\\(]+(".concat(Pd,")[,|\\s]+(").concat(Pd,")[,|\\s]+(").concat(Pd,")[,|\\s]+(").concat(Pd,")\\s*\\)?"),tl={CSS_UNIT:new RegExp(Pd),rgb:new RegExp("rgb"+XA),rgba:new RegExp("rgba"+ZA),hsl:new RegExp("hsl"+XA),hsla:new RegExp("hsla"+ZA),hsv:new RegExp("hsv"+XA),hsva:new RegExp("hsva"+ZA),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Qbe(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(QD[e])e=QD[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=tl.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=tl.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=tl.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=tl.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=tl.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=tl.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=tl.hex8.exec(e),o?{r:Ya(o[1]),g:Ya(o[2]),b:Ya(o[3]),a:hB(o[4]),format:t?"name":"hex8"}:(o=tl.hex6.exec(e),o?{r:Ya(o[1]),g:Ya(o[2]),b:Ya(o[3]),format:t?"name":"hex"}:(o=tl.hex4.exec(e),o?{r:Ya(o[1]+o[1]),g:Ya(o[2]+o[2]),b:Ya(o[3]+o[3]),a:hB(o[4]+o[4]),format:t?"name":"hex8"}:(o=tl.hex3.exec(e),o?{r:Ya(o[1]+o[1]),g:Ya(o[2]+o[2]),b:Ya(o[3]+o[3]),format:t?"name":"hex"}:!1)))))))))}function $c(e){return!!tl.CSS_UNIT.exec(String(e))}var KK=function(){function e(t,o){t===void 0&&(t=""),o===void 0&&(o={});var i;if(t instanceof e)return t;typeof t=="number"&&(t=Ybe(t)),this.originalInput=t;var c=Jbe(t);this.originalInput=t,this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=o.format)!==null&&i!==void 0?i:c.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=c.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),o,i,c,u=t.r/255,f=t.g/255,p=t.b/255;return u<=.03928?o=u/12.92:o=Math.pow((u+.055)/1.055,2.4),f<=.03928?i=f/12.92:i=Math.pow((f+.055)/1.055,2.4),p<=.03928?c=p/12.92:c=Math.pow((p+.055)/1.055,2.4),.2126*o+.7152*i+.0722*c},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=qK(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=uB(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=uB(this.r,this.g,this.b),o=Math.round(t.h*360),i=Math.round(t.s*100),c=Math.round(t.v*100);return this.a===1?"hsv(".concat(o,", ").concat(i,"%, ").concat(c,"%)"):"hsva(".concat(o,", ").concat(i,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=cB(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=cB(this.r,this.g,this.b),o=Math.round(t.h*360),i=Math.round(t.s*100),c=Math.round(t.l*100);return this.a===1?"hsl(".concat(o,", ").concat(i,"%, ").concat(c,"%)"):"hsla(".concat(o,", ").concat(i,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),dB(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),Wbe(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),o=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(o,", ").concat(i,")"):"rgba(".concat(t,", ").concat(o,", ").concat(i,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(o){return"".concat(Math.round(Oi(o,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(o){return Math.round(Oi(o,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+dB(this.r,this.g,this.b,!1),o=0,i=Object.entries(QD);o<i.length;o++){var c=i[o],u=c[0],f=c[1];if(t===f)return u}return!1},e.prototype.toString=function(t){var o=!!t;t=t??this.format;var i=!1,c=this.a<1&&this.a>=0,u=!o&&c&&(t.startsWith("hex")||t==="name");return u?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l+=t/100,o.l=HS(o.l),new e(o)},e.prototype.brighten=function(t){t===void 0&&(t=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(t/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(t/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(t/100)))),new e(o)},e.prototype.darken=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l-=t/100,o.l=HS(o.l),new e(o)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s-=t/100,o.s=HS(o.s),new e(o)},e.prototype.saturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s+=t/100,o.s=HS(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var o=this.toHsl(),i=(o.h+t)%360;return o.h=i<0?360+i:i,new e(o)},e.prototype.mix=function(t,o){o===void 0&&(o=50);var i=this.toRgb(),c=new e(t).toRgb(),u=o/100,f={r:(c.r-i.r)*u+i.r,g:(c.g-i.g)*u+i.g,b:(c.b-i.b)*u+i.b,a:(c.a-i.a)*u+i.a};return new e(f)},e.prototype.analogous=function(t,o){t===void 0&&(t=6),o===void 0&&(o=30);var i=this.toHsl(),c=360/o,u=[this];for(i.h=(i.h-(c*t>>1)+720)%360;--t;)i.h=(i.h+c)%360,u.push(new e(i));return u},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var o=this.toHsv(),i=o.h,c=o.s,u=o.v,f=[],p=1/t;t--;)f.push(new e({h:i,s:c,v:u})),u=(u+p)%1;return f},e.prototype.splitcomplement=function(){var t=this.toHsl(),o=t.h;return[this,new e({h:(o+72)%360,s:t.s,l:t.l}),new e({h:(o+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var o=this.toRgb(),i=new e(t).toRgb(),c=o.a+i.a*(1-o.a);return new e({r:(o.r*o.a+i.r*i.a*(1-o.a))/c,g:(o.g*o.a+i.g*i.a*(1-o.a))/c,b:(o.b*o.a+i.b*i.a*(1-o.a))/c,a:c})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var o=this.toHsl(),i=o.h,c=[this],u=360/t,f=1;f<t;f++)c.push(new e({h:(i+f*u)%360,s:o.s,l:o.l}));return c},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function vd(e,t=20){return e.mix("#141414",t).toString()}function eCe(e){const t=Pi(),o=ut("button");return z(()=>{let i={},c=e.color;if(c){const u=c.match(/var\((.*?)\)/);u&&(c=window.getComputedStyle(window.document.documentElement).getPropertyValue(u[1]));const f=new KK(c),p=e.dark?f.tint(20).toString():vd(f,20);if(e.plain)i=o.cssVarBlock({"bg-color":e.dark?vd(f,90):f.tint(90).toString(),"text-color":c,"border-color":e.dark?vd(f,50):f.tint(50).toString(),"hover-text-color":`var(${o.cssVarName("color-white")})`,"hover-bg-color":c,"hover-border-color":c,"active-bg-color":p,"active-text-color":`var(${o.cssVarName("color-white")})`,"active-border-color":p}),t.value&&(i[o.cssVarBlockName("disabled-bg-color")]=e.dark?vd(f,90):f.tint(90).toString(),i[o.cssVarBlockName("disabled-text-color")]=e.dark?vd(f,50):f.tint(50).toString(),i[o.cssVarBlockName("disabled-border-color")]=e.dark?vd(f,80):f.tint(80).toString());else{const v=e.dark?vd(f,30):f.tint(30).toString(),_=f.isDark()?`var(${o.cssVarName("color-white")})`:`var(${o.cssVarName("color-black")})`;if(i=o.cssVarBlock({"bg-color":c,"text-color":_,"border-color":c,"hover-bg-color":v,"hover-text-color":_,"hover-border-color":v,"active-bg-color":p,"active-border-color":p}),t.value){const b=e.dark?vd(f,50):f.tint(50).toString();i[o.cssVarBlockName("disabled-bg-color")]=b,i[o.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${o.cssVarName("color-white")})`,i[o.cssVarBlockName("disabled-border-color")]=b}}}return i})}const tCe=Te({name:"ElButton"}),nCe=Te({...tCe,props:ZD,emits:Bbe,setup(e,{expose:t,emit:o}){const i=e,c=eCe(i),u=ut("button"),{_ref:f,_size:p,_type:v,_disabled:_,_props:b,shouldAddSpace:S,handleClick:k}=Vbe(i,o),M=z(()=>[u.b(),u.m(v.value),u.m(p.value),u.is("disabled",_.value),u.is("loading",i.loading),u.is("plain",i.plain),u.is("round",i.round),u.is("circle",i.circle),u.is("text",i.text),u.is("link",i.link),u.is("has-bg",i.bg)]);return t({ref:f,size:p,type:v,disabled:_,shouldAddSpace:S}),(R,w)=>(ee(),We(Tn(R.tag),An({ref_key:"_ref",ref:f},y(b),{class:y(M),style:y(c),onClick:y(k)}),{default:Ae(()=>[R.loading?(ee(),ge(Ht,{key:0},[R.$slots.loading?Ve(R.$slots,"loading",{key:0}):(ee(),We(y(Pt),{key:1,class:ne(y(u).is("loading"))},{default:Ae(()=>[(ee(),We(Tn(R.loadingIcon)))]),_:1},8,["class"]))],64)):R.icon||R.$slots.icon?(ee(),We(y(Pt),{key:1},{default:Ae(()=>[R.icon?(ee(),We(Tn(R.icon),{key:0})):Ve(R.$slots,"icon",{key:1})]),_:3})):$e("v-if",!0),R.$slots.default?(ee(),ge("span",{key:2,class:ne({[y(u).em("text","expand")]:y(S)})},[Ve(R.$slots,"default")],2)):$e("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var oCe=vt(nCe,[["__file","button.vue"]]);const rCe={size:ZD.size,type:ZD.type},iCe=Te({name:"ElButtonGroup"}),aCe=Te({...iCe,props:rCe,setup(e){const t=e;Nn($K,eo({size:uo(t,"size"),type:uo(t,"type")}));const o=ut("button");return(i,c)=>(ee(),ge("div",{class:ne(y(o).b("group"))},[Ve(i.$slots,"default")],2))}});var zK=vt(aCe,[["__file","button-group.vue"]]);const di=un(oCe,{ButtonGroup:zK}),WK=lr(zK);var jK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){var o=1e3,i=6e4,c=36e5,u="millisecond",f="second",p="minute",v="hour",_="day",b="week",S="month",k="quarter",M="year",R="date",w="Invalid Date",E=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,F={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(pe){var ie=["th","st","nd","rd"],te=pe%100;return"["+pe+(ie[(te-20)%10]||ie[te]||ie[0])+"]"}},x=function(pe,ie,te){var he=String(pe);return!he||he.length>=ie?pe:""+Array(ie+1-he.length).join(te)+pe},P={s:x,z:function(pe){var ie=-pe.utcOffset(),te=Math.abs(ie),he=Math.floor(te/60),re=te%60;return(ie<=0?"+":"-")+x(he,2,"0")+":"+x(re,2,"0")},m:function pe(ie,te){if(ie.date()<te.date())return-pe(te,ie);var he=12*(te.year()-ie.year())+(te.month()-ie.month()),re=ie.clone().add(he,S),X=te-re<0,ye=ie.clone().add(he+(X?-1:1),S);return+(-(he+(te-re)/(X?re-ye:ye-re))||0)},a:function(pe){return pe<0?Math.ceil(pe)||0:Math.floor(pe)},p:function(pe){return{M:S,y:M,w:b,d:_,D:R,h:v,m:p,s:f,ms:u,Q:k}[pe]||String(pe||"").toLowerCase().replace(/s$/,"")},u:function(pe){return pe===void 0}},G="en",H={};H[G]=F;var Y="$isDayjsObject",j=function(pe){return pe instanceof J||!(!pe||!pe[Y])},W=function pe(ie,te,he){var re;if(!ie)return G;if(typeof ie=="string"){var X=ie.toLowerCase();H[X]&&(re=X),te&&(H[X]=te,re=X);var ye=ie.split("-");if(!re&&ye.length>1)return pe(ye[0])}else{var ue=ie.name;H[ue]=ie,re=ue}return!he&&re&&(G=re),re||!he&&G},O=function(pe,ie){if(j(pe))return pe.clone();var te=typeof ie=="object"?ie:{};return te.date=pe,te.args=arguments,new J(te)},Q=P;Q.l=W,Q.i=j,Q.w=function(pe,ie){return O(pe,{locale:ie.$L,utc:ie.$u,x:ie.$x,$offset:ie.$offset})};var J=function(){function pe(te){this.$L=W(te.locale,null,!0),this.parse(te),this.$x=this.$x||te.x||{},this[Y]=!0}var ie=pe.prototype;return ie.parse=function(te){this.$d=function(he){var re=he.date,X=he.utc;if(re===null)return new Date(NaN);if(Q.u(re))return new Date;if(re instanceof Date)return new Date(re);if(typeof re=="string"&&!/Z$/i.test(re)){var ye=re.match(E);if(ye){var ue=ye[2]-1||0,Ie=(ye[7]||"0").substring(0,3);return X?new Date(Date.UTC(ye[1],ue,ye[3]||1,ye[4]||0,ye[5]||0,ye[6]||0,Ie)):new Date(ye[1],ue,ye[3]||1,ye[4]||0,ye[5]||0,ye[6]||0,Ie)}}return new Date(re)}(te),this.init()},ie.init=function(){var te=this.$d;this.$y=te.getFullYear(),this.$M=te.getMonth(),this.$D=te.getDate(),this.$W=te.getDay(),this.$H=te.getHours(),this.$m=te.getMinutes(),this.$s=te.getSeconds(),this.$ms=te.getMilliseconds()},ie.$utils=function(){return Q},ie.isValid=function(){return this.$d.toString()!==w},ie.isSame=function(te,he){var re=O(te);return this.startOf(he)<=re&&re<=this.endOf(he)},ie.isAfter=function(te,he){return O(te)<this.startOf(he)},ie.isBefore=function(te,he){return this.endOf(he)<O(te)},ie.$g=function(te,he,re){return Q.u(te)?this[he]:this.set(re,te)},ie.unix=function(){return Math.floor(this.valueOf()/1e3)},ie.valueOf=function(){return this.$d.getTime()},ie.startOf=function(te,he){var re=this,X=!!Q.u(he)||he,ye=Q.p(te),ue=function(Le,rt){var Qe=Q.w(re.$u?Date.UTC(re.$y,rt,Le):new Date(re.$y,rt,Le),re);return X?Qe:Qe.endOf(_)},Ie=function(Le,rt){return Q.w(re.toDate()[Le].apply(re.toDate("s"),(X?[0,0,0,0]:[23,59,59,999]).slice(rt)),re)},ve=this.$W,Ce=this.$M,Fe=this.$D,Oe="set"+(this.$u?"UTC":"");switch(ye){case M:return X?ue(1,0):ue(31,11);case S:return X?ue(1,Ce):ue(0,Ce+1);case b:var be=this.$locale().weekStart||0,xe=(ve<be?ve+7:ve)-be;return ue(X?Fe-xe:Fe+(6-xe),Ce);case _:case R:return Ie(Oe+"Hours",0);case v:return Ie(Oe+"Minutes",1);case p:return Ie(Oe+"Seconds",2);case f:return Ie(Oe+"Milliseconds",3);default:return this.clone()}},ie.endOf=function(te){return this.startOf(te,!1)},ie.$set=function(te,he){var re,X=Q.p(te),ye="set"+(this.$u?"UTC":""),ue=(re={},re[_]=ye+"Date",re[R]=ye+"Date",re[S]=ye+"Month",re[M]=ye+"FullYear",re[v]=ye+"Hours",re[p]=ye+"Minutes",re[f]=ye+"Seconds",re[u]=ye+"Milliseconds",re)[X],Ie=X===_?this.$D+(he-this.$W):he;if(X===S||X===M){var ve=this.clone().set(R,1);ve.$d[ue](Ie),ve.init(),this.$d=ve.set(R,Math.min(this.$D,ve.daysInMonth())).$d}else ue&&this.$d[ue](Ie);return this.init(),this},ie.set=function(te,he){return this.clone().$set(te,he)},ie.get=function(te){return this[Q.p(te)]()},ie.add=function(te,he){var re,X=this;te=Number(te);var ye=Q.p(he),ue=function(Ce){var Fe=O(X);return Q.w(Fe.date(Fe.date()+Math.round(Ce*te)),X)};if(ye===S)return this.set(S,this.$M+te);if(ye===M)return this.set(M,this.$y+te);if(ye===_)return ue(1);if(ye===b)return ue(7);var Ie=(re={},re[p]=i,re[v]=c,re[f]=o,re)[ye]||1,ve=this.$d.getTime()+te*Ie;return Q.w(ve,this)},ie.subtract=function(te,he){return this.add(-1*te,he)},ie.format=function(te){var he=this,re=this.$locale();if(!this.isValid())return re.invalidDate||w;var X=te||"YYYY-MM-DDTHH:mm:ssZ",ye=Q.z(this),ue=this.$H,Ie=this.$m,ve=this.$M,Ce=re.weekdays,Fe=re.months,Oe=re.meridiem,be=function(rt,Qe,Ge,_e){return rt&&(rt[Qe]||rt(he,X))||Ge[Qe].slice(0,_e)},xe=function(rt){return Q.s(ue%12||12,rt,"0")},Le=Oe||function(rt,Qe,Ge){var _e=rt<12?"AM":"PM";return Ge?_e.toLowerCase():_e};return X.replace(N,function(rt,Qe){return Qe||function(Ge){switch(Ge){case"YY":return String(he.$y).slice(-2);case"YYYY":return Q.s(he.$y,4,"0");case"M":return ve+1;case"MM":return Q.s(ve+1,2,"0");case"MMM":return be(re.monthsShort,ve,Fe,3);case"MMMM":return be(Fe,ve);case"D":return he.$D;case"DD":return Q.s(he.$D,2,"0");case"d":return String(he.$W);case"dd":return be(re.weekdaysMin,he.$W,Ce,2);case"ddd":return be(re.weekdaysShort,he.$W,Ce,3);case"dddd":return Ce[he.$W];case"H":return String(ue);case"HH":return Q.s(ue,2,"0");case"h":return xe(1);case"hh":return xe(2);case"a":return Le(ue,Ie,!0);case"A":return Le(ue,Ie,!1);case"m":return String(Ie);case"mm":return Q.s(Ie,2,"0");case"s":return String(he.$s);case"ss":return Q.s(he.$s,2,"0");case"SSS":return Q.s(he.$ms,3,"0");case"Z":return ye}return null}(rt)||ye.replace(":","")})},ie.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ie.diff=function(te,he,re){var X,ye=this,ue=Q.p(he),Ie=O(te),ve=(Ie.utcOffset()-this.utcOffset())*i,Ce=this-Ie,Fe=function(){return Q.m(ye,Ie)};switch(ue){case M:X=Fe()/12;break;case S:X=Fe();break;case k:X=Fe()/3;break;case b:X=(Ce-ve)/6048e5;break;case _:X=(Ce-ve)/864e5;break;case v:X=Ce/c;break;case p:X=Ce/i;break;case f:X=Ce/o;break;default:X=Ce}return re?X:Q.a(X)},ie.daysInMonth=function(){return this.endOf(S).$D},ie.$locale=function(){return H[this.$L]},ie.locale=function(te,he){if(!te)return this.$L;var re=this.clone(),X=W(te,he,!0);return X&&(re.$L=X),re},ie.clone=function(){return Q.w(this.$d,this)},ie.toDate=function(){return new Date(this.valueOf())},ie.toJSON=function(){return this.isValid()?this.toISOString():null},ie.toISOString=function(){return this.$d.toISOString()},ie.toString=function(){return this.$d.toUTCString()},pe}(),oe=J.prototype;return O.prototype=oe,[["$ms",u],["$s",f],["$m",p],["$H",v],["$W",_],["$M",S],["$y",M],["$D",R]].forEach(function(pe){oe[pe[1]]=function(ie){return this.$g(ie,pe[0],pe[1])}}),O.extend=function(pe,ie){return pe.$i||(pe(ie,J,O),pe.$i=!0),O},O.locale=W,O.isDayjs=j,O.unix=function(pe){return O(1e3*pe)},O.en=H[G],O.Ls=H,O.p={},O})})(jK);var sCe=jK.exports;const cn=Ns(sCe),QA=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],Hd=e=>Array.from(Array.from({length:e}).keys()),YK=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),JK=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),fB=function(e,t){const o=$d(e),i=$d(t);return o&&i?e.getTime()===t.getTime():!o&&!i?e===t:!1},pB=function(e,t){const o=ht(e),i=ht(t);return o&&i?e.length!==t.length?!1:e.every((c,u)=>fB(c,t[u])):!o&&!i?fB(e,t):!1},mB=function(e,t,o){const i=Xa(t)||t==="x"?cn(e).locale(o):cn(e,t).locale(o);return i.isValid()?i:void 0},gB=function(e,t,o){return Xa(t)?e:t==="x"?+e:cn(e).locale(o).format(t)},eD=(e,t)=>{var o;const i=[],c=t==null?void 0:t();for(let u=0;u<e;u++)i.push((o=c==null?void 0:c.includes(u))!=null?o:!1);return i},qS=e=>ht(e)?e.map(t=>t.toDate()):e.toDate(),lCe=(e,t)=>{const o=e.subtract(1,"month").endOf("month").date();return Hd(t).map((i,c)=>o-(t-c-1))},cCe=e=>{const t=e.daysInMonth();return Hd(t).map((o,i)=>i+1)},uCe=e=>Hd(e.length/7).map(t=>{const o=t*7;return e.slice(o,o+7)}),dCe=pt({selectedDay:{type:Ue(Object)},range:{type:Ue(Array)},date:{type:Ue(Object),required:!0},hideHeader:{type:Boolean}}),hCe={pick:e=>gn(e)};var XK={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i,c){var u=i.prototype,f=function(S){return S&&(S.indexOf?S:S.s)},p=function(S,k,M,R,w){var E=S.name?S:S.$locale(),N=f(E[k]),F=f(E[M]),x=N||F.map(function(G){return G.slice(0,R)});if(!w)return x;var P=E.weekStart;return x.map(function(G,H){return x[(H+(P||0))%7]})},v=function(){return c.Ls[c.locale()]},_=function(S,k){return S.formats[k]||function(M){return M.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(R,w,E){return w||E.slice(1)})}(S.formats[k.toUpperCase()])},b=function(){var S=this;return{months:function(k){return k?k.format("MMMM"):p(S,"months")},monthsShort:function(k){return k?k.format("MMM"):p(S,"monthsShort","months",3)},firstDayOfWeek:function(){return S.$locale().weekStart||0},weekdays:function(k){return k?k.format("dddd"):p(S,"weekdays")},weekdaysMin:function(k){return k?k.format("dd"):p(S,"weekdaysMin","weekdays",2)},weekdaysShort:function(k){return k?k.format("ddd"):p(S,"weekdaysShort","weekdays",3)},longDateFormat:function(k){return _(S.$locale(),k)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};u.localeData=function(){return b.bind(this)()},c.localeData=function(){var S=v();return{firstDayOfWeek:function(){return S.weekStart||0},weekdays:function(){return c.weekdays()},weekdaysShort:function(){return c.weekdaysShort()},weekdaysMin:function(){return c.weekdaysMin()},months:function(){return c.months()},monthsShort:function(){return c.monthsShort()},longDateFormat:function(k){return _(S,k)},meridiem:S.meridiem,ordinal:S.ordinal}},c.months=function(){return p(v(),"months")},c.monthsShort=function(){return p(v(),"monthsShort","months",3)},c.weekdays=function(S){return p(v(),"weekdays",null,null,S)},c.weekdaysShort=function(S){return p(v(),"weekdaysShort","weekdays",3,S)},c.weekdaysMin=function(S){return p(v(),"weekdaysMin","weekdays",2,S)}}})})(XK);var fCe=XK.exports;const ZK=Ns(fCe),pCe=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],tD=["sun","mon","tue","wed","thu","fri","sat"],mCe=(e,t)=>{cn.extend(ZK);const o=cn.localeData().firstDayOfWeek(),{t:i,lang:c}=Kn(),u=cn().locale(c.value),f=z(()=>!!e.range&&!!e.range.length),p=z(()=>{let k=[];if(f.value){const[M,R]=e.range,w=Hd(R.date()-M.date()+1).map(F=>({text:M.date()+F,type:"current"}));let E=w.length%7;E=E===0?0:7-E;const N=Hd(E).map((F,x)=>({text:x+1,type:"next"}));k=w.concat(N)}else{const M=e.date.startOf("month").day(),R=lCe(e.date,(M-o+7)%7).map(F=>({text:F,type:"prev"})),w=cCe(e.date).map(F=>({text:F,type:"current"}));k=[...R,...w];const E=7-(k.length%7||7),N=Hd(E).map((F,x)=>({text:x+1,type:"next"}));k=k.concat(N)}return uCe(k)}),v=z(()=>{const k=o;return k===0?tD.map(M=>i(`el.datepicker.weeks.${M}`)):tD.slice(k).concat(tD.slice(0,k)).map(M=>i(`el.datepicker.weeks.${M}`))}),_=(k,M)=>{switch(M){case"prev":return e.date.startOf("month").subtract(1,"month").date(k);case"next":return e.date.startOf("month").add(1,"month").date(k);case"current":return e.date.date(k)}};return{now:u,isInRange:f,rows:p,weekDays:v,getFormattedDate:_,handlePickDay:({text:k,type:M})=>{const R=_(k,M);t("pick",R)},getSlotData:({text:k,type:M})=>{const R=_(k,M);return{isSelected:R.isSame(e.selectedDay),type:`${M}-month`,day:R.format("YYYY-MM-DD"),date:R.toDate()}}}},gCe=Te({name:"DateTable"}),vCe=Te({...gCe,props:dCe,emits:hCe,setup(e,{expose:t,emit:o}){const i=e,{isInRange:c,now:u,rows:f,weekDays:p,getFormattedDate:v,handlePickDay:_,getSlotData:b}=mCe(i,o),S=ut("calendar-table"),k=ut("calendar-day"),M=({text:R,type:w})=>{const E=[w];if(w==="current"){const N=v(R,w);N.isSame(i.selectedDay,"day")&&E.push(k.is("selected")),N.isSame(u,"day")&&E.push(k.is("today"))}return E};return t({getFormattedDate:v}),(R,w)=>(ee(),ge("table",{class:ne([y(S).b(),y(S).is("range",y(c))]),cellspacing:"0",cellpadding:"0"},[R.hideHeader?$e("v-if",!0):(ee(),ge("thead",{key:0},[Ee("tr",null,[(ee(!0),ge(Ht,null,Un(y(p),E=>(ee(),ge("th",{key:E,scope:"col"},mt(E),1))),128))])])),Ee("tbody",null,[(ee(!0),ge(Ht,null,Un(y(f),(E,N)=>(ee(),ge("tr",{key:N,class:ne({[y(S).e("row")]:!0,[y(S).em("row","hide-border")]:N===0&&R.hideHeader})},[(ee(!0),ge(Ht,null,Un(E,(F,x)=>(ee(),ge("td",{key:x,class:ne(M(F)),onClick:P=>y(_)(F)},[Ee("div",{class:ne(y(k).b())},[Ve(R.$slots,"date-cell",{data:y(b)(F)},()=>[Ee("span",null,mt(F.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var vB=vt(vCe,[["__file","date-table.vue"]]);const _Ce=(e,t)=>{const o=e.endOf("month"),i=t.startOf("month"),u=o.isSame(i,"week")?i.add(1,"week"):i;return[[e,o],[u.startOf("week"),t]]},yCe=(e,t)=>{const o=e.endOf("month"),i=e.add(1,"month").startOf("month"),c=o.isSame(i,"week")?i.add(1,"week"):i,u=c.endOf("month"),f=t.startOf("month"),p=u.isSame(f,"week")?f.add(1,"week"):f;return[[e,o],[c.startOf("week"),u],[p.startOf("week"),t]]},ICe=(e,t,o)=>{const{lang:i}=Kn(),c=le(),u=cn().locale(i.value),f=z({get(){return e.modelValue?v.value:c.value},set(E){if(!E)return;c.value=E;const N=E.toDate();t(Jr,N),t(nn,N)}}),p=z(()=>{if(!e.range||!ht(e.range)||e.range.length!==2||e.range.some(x=>!$d(x)))return[];const E=e.range.map(x=>cn(x).locale(i.value)),[N,F]=E;return N.isAfter(F)?[]:N.isSame(F,"month")?M(N,F):N.add(1,"month").month()!==F.month()?[]:M(N,F)}),v=z(()=>e.modelValue?cn(e.modelValue).locale(i.value):f.value||(p.value.length?p.value[0][0]:u)),_=z(()=>v.value.subtract(1,"month").date(1)),b=z(()=>v.value.add(1,"month").date(1)),S=z(()=>v.value.subtract(1,"year").date(1)),k=z(()=>v.value.add(1,"year").date(1)),M=(E,N)=>{const F=E.startOf("week"),x=N.endOf("week"),P=F.get("month"),G=x.get("month");return P===G?[[F,x]]:(P+1)%12===G?_Ce(F,x):P+2===G||(P+1)%11===G?yCe(F,x):[]},R=E=>{f.value=E};return{calculateValidatedDateRange:M,date:v,realSelectedDay:f,pickDay:R,selectDate:E=>{const F={"prev-month":_.value,"next-month":b.value,"prev-year":S.value,"next-year":k.value,today:u}[E];F.isSame(v.value,"day")||R(F)},validatedRange:p}},bCe=e=>ht(e)&&e.length===2&&e.every(t=>$d(t)),CCe=pt({modelValue:{type:Date},range:{type:Ue(Array),validator:bCe}}),SCe={[nn]:e=>$d(e),[Jr]:e=>$d(e)},ECe="ElCalendar",TCe=Te({name:ECe}),MCe=Te({...TCe,props:CCe,emits:SCe,setup(e,{expose:t,emit:o}){const i=e,c=ut("calendar"),{calculateValidatedDateRange:u,date:f,pickDay:p,realSelectedDay:v,selectDate:_,validatedRange:b}=ICe(i,o),{t:S}=Kn(),k=z(()=>{const M=`el.datepicker.month${f.value.format("M")}`;return`${f.value.year()} ${S("el.datepicker.year")} ${S(M)}`});return t({selectedDay:v,pickDay:p,selectDate:_,calculateValidatedDateRange:u}),(M,R)=>(ee(),ge("div",{class:ne(y(c).b())},[Ee("div",{class:ne(y(c).e("header"))},[Ve(M.$slots,"header",{date:y(k)},()=>[Ee("div",{class:ne(y(c).e("title"))},mt(y(k)),3),y(b).length===0?(ee(),ge("div",{key:0,class:ne(y(c).e("button-group"))},[Me(y(WK),null,{default:Ae(()=>[Me(y(di),{size:"small",onClick:w=>y(_)("prev-month")},{default:Ae(()=>[Mn(mt(y(S)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),Me(y(di),{size:"small",onClick:w=>y(_)("today")},{default:Ae(()=>[Mn(mt(y(S)("el.datepicker.today")),1)]),_:1},8,["onClick"]),Me(y(di),{size:"small",onClick:w=>y(_)("next-month")},{default:Ae(()=>[Mn(mt(y(S)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):$e("v-if",!0)])],2),y(b).length===0?(ee(),ge("div",{key:0,class:ne(y(c).e("body"))},[Me(vB,{date:y(f),"selected-day":y(v),onPick:y(p)},rs({_:2},[M.$slots["date-cell"]?{name:"date-cell",fn:Ae(w=>[Ve(M.$slots,"date-cell",Za(Zl(w)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(ee(),ge("div",{key:1,class:ne(y(c).e("body"))},[(ee(!0),ge(Ht,null,Un(y(b),(w,E)=>(ee(),We(vB,{key:E,date:w[0],"selected-day":y(v),range:w,"hide-header":E!==0,onPick:y(p)},rs({_:2},[M.$slots["date-cell"]?{name:"date-cell",fn:Ae(N=>[Ve(M.$slots,"date-cell",Za(Zl(N)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var kCe=vt(MCe,[["__file","calendar.vue"]]);const wCe=un(kCe),RCe=pt({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Ue([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),ACe=Te({name:"ElCard"}),DCe=Te({...ACe,props:RCe,setup(e){const t=ut("card");return(o,i)=>(ee(),ge("div",{class:ne([y(t).b(),y(t).is(`${o.shadow}-shadow`)])},[o.$slots.header||o.header?(ee(),ge("div",{key:0,class:ne([y(t).e("header"),o.headerClass])},[Ve(o.$slots,"header",{},()=>[Mn(mt(o.header),1)])],2)):$e("v-if",!0),Ee("div",{class:ne([y(t).e("body"),o.bodyClass]),style:qt(o.bodyStyle)},[Ve(o.$slots,"default")],6),o.$slots.footer||o.footer?(ee(),ge("div",{key:1,class:ne([y(t).e("footer"),o.footerClass])},[Ve(o.$slots,"footer",{},()=>[Mn(mt(o.footer),1)])],2)):$e("v-if",!0)],2))}});var OCe=vt(DCe,[["__file","card.vue"]]);const LCe=un(OCe),NCe=pt({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),PCe={change:(e,t)=>[e,t].every(jt)},QK=Symbol("carouselContextKey"),eO="ElCarouselItem";var ys=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(ys||{});function tO(e){return Wo(e)&&e.type===Ht}function xCe(e){return Wo(e)&&e.type===Ai}function UCe(e){return Wo(e)&&!tO(e)&&!xCe(e)}const FCe=e=>{if(!Wo(e))return{};const t=e.props||{},o=(Wo(e.type)?e.type.props:void 0)||{},i={};return Object.keys(o).forEach(c=>{jn(o[c],"default")&&(i[c]=o[c].default)}),Object.keys(t).forEach(c=>{i[os(c)]=t[c]}),i},VCe=e=>{if(!ht(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},Qc=e=>{const t=ht(e)?e:[e],o=[];return t.forEach(i=>{var c;ht(i)?o.push(...Qc(i)):Wo(i)&&((c=i.component)!=null&&c.subTree)?o.push(i,...Qc(i.component.subTree)):Wo(i)&&ht(i.children)?o.push(...Qc(i.children)):Wo(i)&&i.shapeFlag===2?o.push(...Qc(i.type())):o.push(i)}),o},GCe=(e,t,o)=>Qc(e.subTree).filter(u=>{var f;return Wo(u)&&((f=u.type)==null?void 0:f.name)===t&&!!u.component}).map(u=>u.component.uid).map(u=>o[u]).filter(u=>!!u),EN=(e,t)=>{const o={},i=Go([]);return{children:i,addChild:f=>{o[f.uid]=f,i.value=GCe(e,t,o)},removeChild:f=>{delete o[f],i.value=i.value.filter(p=>p.uid!==f)}}},_B=300,BCe=(e,t,o)=>{const{children:i,addChild:c,removeChild:u}=EN(kn(),eO),f=Qr(),p=le(-1),v=le(null),_=le(!1),b=le(),S=le(0),k=le(!0),M=le(!0),R=le(!1),w=z(()=>e.arrow!=="never"&&!y(F)),E=z(()=>i.value.some(Oe=>Oe.props.label.toString().length>0)),N=z(()=>e.type==="card"),F=z(()=>e.direction==="vertical"),x=z(()=>e.height!=="auto"?{height:e.height}:{height:`${S.value}px`,overflow:"hidden"}),P=rp(Oe=>{O(Oe)},_B,{trailing:!0}),G=rp(Oe=>{X(Oe)},_B),H=Oe=>k.value?p.value<=1?Oe<=1:Oe>1:!0;function Y(){v.value&&(clearInterval(v.value),v.value=null)}function j(){e.interval<=0||!e.autoplay||v.value||(v.value=setInterval(()=>W(),e.interval))}const W=()=>{M.value||(R.value=!0),M.value=!1,p.value<i.value.length-1?p.value=p.value+1:e.loop?p.value=0:R.value=!1};function O(Oe){if(M.value||(R.value=!0),M.value=!1,Ut(Oe)){const Le=i.value.filter(rt=>rt.props.name===Oe);Le.length>0&&(Oe=i.value.indexOf(Le[0]))}if(Oe=Number(Oe),Number.isNaN(Oe)||Oe!==Math.floor(Oe))return;const be=i.value.length,xe=p.value;Oe<0?p.value=e.loop?be-1:0:Oe>=be?p.value=e.loop?0:be-1:p.value=Oe,xe===p.value&&Q(xe),Ie()}function Q(Oe){i.value.forEach((be,xe)=>{be.translateItem(xe,p.value,Oe)})}function J(Oe,be){var xe,Le,rt,Qe;const Ge=y(i),_e=Ge.length;if(_e===0||!Oe.states.inStage)return!1;const Re=be+1,Ke=be-1,je=_e-1,ze=Ge[je].states.active,nt=Ge[0].states.active,it=(Le=(xe=Ge[Re])==null?void 0:xe.states)==null?void 0:Le.active,dt=(Qe=(rt=Ge[Ke])==null?void 0:rt.states)==null?void 0:Qe.active;return be===je&&nt||it?"left":be===0&&ze||dt?"right":!1}function oe(){_.value=!0,e.pauseOnHover&&Y()}function pe(){_.value=!1,j()}function ie(){R.value=!1}function te(Oe){y(F)||i.value.forEach((be,xe)=>{Oe===J(be,xe)&&(be.states.hover=!0)})}function he(){y(F)||i.value.forEach(Oe=>{Oe.states.hover=!1})}function re(Oe){Oe!==p.value&&(M.value||(R.value=!0)),p.value=Oe}function X(Oe){e.trigger==="hover"&&Oe!==p.value&&(p.value=Oe,M.value||(R.value=!0))}function ye(){O(p.value-1)}function ue(){O(p.value+1)}function Ie(){Y(),e.pauseOnHover||j()}function ve(Oe){e.height==="auto"&&(S.value=Oe)}function Ce(){var Oe;const be=(Oe=f.default)==null?void 0:Oe.call(f);if(!be)return null;const Le=Qc(be).filter(rt=>Wo(rt)&&rt.type.name===eO);return(Le==null?void 0:Le.length)===2&&e.loop&&!N.value?(k.value=!0,Le):(k.value=!1,null)}st(()=>p.value,(Oe,be)=>{Q(be),k.value&&(Oe=Oe%2,be=be%2),be>-1&&t(wn,Oe,be)}),st(()=>e.autoplay,Oe=>{Oe?j():Y()}),st(()=>e.loop,()=>{O(p.value)}),st(()=>e.interval,()=>{Ie()});const Fe=Go();return mn(()=>{st(()=>i.value,()=>{i.value.length>0&&O(e.initialIndex)},{immediate:!0}),Fe.value=ar(b.value,()=>{Q()}),j()}),Co(()=>{Y(),b.value&&Fe.value&&Fe.value.stop()}),Nn(QK,{root:b,isCardType:N,isVertical:F,items:i,loop:e.loop,cardScale:e.cardScale,addItem:c,removeItem:u,setActiveItem:O,setContainerHeight:ve}),{root:b,activeIndex:p,arrowDisplay:w,hasLabel:E,hover:_,isCardType:N,isTransitioning:R,items:i,isVertical:F,containerStyle:x,isItemsTwoLength:k,handleButtonEnter:te,handleTransitionEnd:ie,handleButtonLeave:he,handleIndicatorClick:re,handleMouseEnter:oe,handleMouseLeave:pe,setActiveItem:O,prev:ye,next:ue,PlaceholderItem:Ce,isTwoLengthShow:H,throttledArrowClick:P,throttledIndicatorHover:G}},HCe="ElCarousel",$Ce=Te({name:HCe}),qCe=Te({...$Ce,props:NCe,emits:PCe,setup(e,{expose:t,emit:o}){const i=e,{root:c,activeIndex:u,arrowDisplay:f,hasLabel:p,hover:v,isCardType:_,items:b,isVertical:S,containerStyle:k,handleButtonEnter:M,handleButtonLeave:R,isTransitioning:w,handleIndicatorClick:E,handleMouseEnter:N,handleMouseLeave:F,handleTransitionEnd:x,setActiveItem:P,prev:G,next:H,PlaceholderItem:Y,isTwoLengthShow:j,throttledArrowClick:W,throttledIndicatorHover:O}=BCe(i,o),Q=ut("carousel"),{t:J}=Kn(),oe=z(()=>{const te=[Q.b(),Q.m(i.direction)];return y(_)&&te.push(Q.m("card")),te}),pe=z(()=>{const te=[Q.e("container")];return i.motionBlur&&y(w)&&b.value.length>1&&te.push(y(S)?`${Q.namespace.value}-transitioning-vertical`:`${Q.namespace.value}-transitioning`),te}),ie=z(()=>{const te=[Q.e("indicators"),Q.em("indicators",i.direction)];return y(p)&&te.push(Q.em("indicators","labels")),i.indicatorPosition==="outside"&&te.push(Q.em("indicators","outside")),y(S)&&te.push(Q.em("indicators","right")),te});return t({activeIndex:u,setActiveItem:P,prev:G,next:H}),(te,he)=>(ee(),ge("div",{ref_key:"root",ref:c,class:ne(y(oe)),onMouseenter:Zt(y(N),["stop"]),onMouseleave:Zt(y(F),["stop"])},[y(f)?(ee(),We(Zr,{key:0,name:"carousel-arrow-left",persisted:""},{default:Ae(()=>[fn(Ee("button",{type:"button",class:ne([y(Q).e("arrow"),y(Q).em("arrow","left")]),"aria-label":y(J)("el.carousel.leftArrow"),onMouseenter:re=>y(M)("left"),onMouseleave:y(R),onClick:Zt(re=>y(W)(y(u)-1),["stop"])},[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Zn,(te.arrow==="always"||y(v))&&(i.loop||y(u)>0)]])]),_:1})):$e("v-if",!0),y(f)?(ee(),We(Zr,{key:1,name:"carousel-arrow-right",persisted:""},{default:Ae(()=>[fn(Ee("button",{type:"button",class:ne([y(Q).e("arrow"),y(Q).em("arrow","right")]),"aria-label":y(J)("el.carousel.rightArrow"),onMouseenter:re=>y(M)("right"),onMouseleave:y(R),onClick:Zt(re=>y(W)(y(u)+1),["stop"])},[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Zn,(te.arrow==="always"||y(v))&&(i.loop||y(u)<y(b).length-1)]])]),_:1})):$e("v-if",!0),Ee("div",{class:ne(y(pe)),style:qt(y(k)),onTransitionend:y(x)},[Me(y(Y)),Ve(te.$slots,"default")],46,["onTransitionend"]),te.indicatorPosition!=="none"?(ee(),ge("ul",{key:2,class:ne(y(ie))},[(ee(!0),ge(Ht,null,Un(y(b),(re,X)=>fn((ee(),ge("li",{key:X,class:ne([y(Q).e("indicator"),y(Q).em("indicator",te.direction),y(Q).is("active",X===y(u))]),onMouseenter:ye=>y(O)(X),onClick:Zt(ye=>y(E)(X),["stop"])},[Ee("button",{class:ne(y(Q).e("button")),"aria-label":y(J)("el.carousel.indicator",{index:X+1})},[y(p)?(ee(),ge("span",{key:0},mt(re.props.label),1)):$e("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[Zn,y(j)(X)]])),128))],2)):$e("v-if",!0),i.motionBlur?(ee(),ge("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[Ee("defs",null,[Ee("filter",{id:"elCarouselHorizontal"},[Ee("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ee("filter",{id:"elCarouselVertical"},[Ee("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):$e("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var KCe=vt(qCe,[["__file","carousel.vue"]]);const zCe=pt({name:{type:String,default:""},label:{type:[String,Number],default:""}}),WCe=e=>{const t=Rt(QK),o=kn(),i=le(),c=le(!1),u=le(0),f=le(1),p=le(!1),v=le(!1),_=le(!1),b=le(!1),{isCardType:S,isVertical:k,cardScale:M}=t;function R(x,P,G){const H=G-1,Y=P-1,j=P+1,W=G/2;return P===0&&x===H?-1:P===H&&x===0?G:x<Y&&P-x>=W?G+1:x>j&&x-P>=W?-2:x}function w(x,P){var G,H;const Y=y(k)?((G=t.root.value)==null?void 0:G.offsetHeight)||0:((H=t.root.value)==null?void 0:H.offsetWidth)||0;return _.value?Y*((2-M)*(x-P)+1)/4:x<P?-(1+M)*Y/4:(3+M)*Y/4}function E(x,P,G){const H=t.root.value;return H?((G?H.offsetHeight:H.offsetWidth)||0)*(x-P):0}const N=(x,P,G)=>{var H;const Y=y(S),j=(H=t.items.value.length)!=null?H:Number.NaN,W=x===P;!Y&&!qn(G)&&(b.value=W||x===G),!W&&j>2&&t.loop&&(x=R(x,P,j));const O=y(k);p.value=W,Y?(_.value=Math.round(Math.abs(x-P))<=1,u.value=w(x,P),f.value=y(p)?1:M):u.value=E(x,P,O),v.value=!0,W&&i.value&&t.setContainerHeight(i.value.offsetHeight)};function F(){if(t&&y(S)){const x=t.items.value.findIndex(({uid:P})=>P===o.uid);t.setActiveItem(x)}}return mn(()=>{t.addItem({props:e,states:eo({hover:c,translate:u,scale:f,active:p,ready:v,inStage:_,animating:b}),uid:o.uid,translateItem:N})}),rh(()=>{t.removeItem(o.uid)}),{carouselItemRef:i,active:p,animating:b,hover:c,inStage:_,isVertical:k,translate:u,isCardType:S,scale:f,ready:v,handleItemClick:F}},jCe=Te({name:eO}),YCe=Te({...jCe,props:zCe,setup(e){const t=e,o=ut("carousel"),{carouselItemRef:i,active:c,animating:u,hover:f,inStage:p,isVertical:v,translate:_,isCardType:b,scale:S,ready:k,handleItemClick:M}=WCe(t),R=z(()=>[o.e("item"),o.is("active",c.value),o.is("in-stage",p.value),o.is("hover",f.value),o.is("animating",u.value),{[o.em("item","card")]:b.value,[o.em("item","card-vertical")]:b.value&&v.value}]),w=z(()=>{const N=`${`translate${y(v)?"Y":"X"}`}(${y(_)}px)`,F=`scale(${y(S)})`;return{transform:[N,F].join(" ")}});return(E,N)=>fn((ee(),ge("div",{ref_key:"carouselItemRef",ref:i,class:ne(y(R)),style:qt(y(w)),onClick:y(M)},[y(b)?fn((ee(),ge("div",{key:0,class:ne(y(o).e("mask"))},null,2)),[[Zn,!y(c)]]):$e("v-if",!0),Ve(E.$slots,"default")],14,["onClick"])),[[Zn,y(k)]])}});var e9=vt(YCe,[["__file","carousel-item.vue"]]);const JCe=un(KCe,{CarouselItem:e9}),XCe=lr(e9),t9={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:Kr,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...Ci(["ariaControls"])},n9={[nn]:e=>Ut(e)||jt(e)||vo(e),change:e=>Ut(e)||jt(e)||vo(e)},_v=Symbol("checkboxGroupContextKey"),ZCe=({model:e,isChecked:t})=>{const o=Rt(_v,void 0),i=z(()=>{var u,f;const p=(u=o==null?void 0:o.max)==null?void 0:u.value,v=(f=o==null?void 0:o.min)==null?void 0:f.value;return!qn(p)&&e.value.length>=p&&!t.value||!qn(v)&&e.value.length<=v&&t.value});return{isDisabled:Pi(z(()=>(o==null?void 0:o.disabled.value)||i.value)),isLimitDisabled:i}},QCe=(e,{model:t,isLimitExceeded:o,hasOwnLabel:i,isDisabled:c,isLabeledByFormItem:u})=>{const f=Rt(_v,void 0),{formItem:p}=Ni(),{emit:v}=kn();function _(R){var w,E,N,F;return[!0,e.trueValue,e.trueLabel].includes(R)?(E=(w=e.trueValue)!=null?w:e.trueLabel)!=null?E:!0:(F=(N=e.falseValue)!=null?N:e.falseLabel)!=null?F:!1}function b(R,w){v(wn,_(R),w)}function S(R){if(o.value)return;const w=R.target;v(wn,_(w.checked),R)}async function k(R){o.value||!i.value&&!c.value&&u.value&&(R.composedPath().some(N=>N.tagName==="LABEL")||(t.value=_([!1,e.falseValue,e.falseLabel].includes(t.value)),await Vt(),b(t.value,R)))}const M=z(()=>(f==null?void 0:f.validateEvent)||e.validateEvent);return st(()=>e.modelValue,()=>{M.value&&(p==null||p.validate("change").catch(R=>void 0))}),{handleChange:S,onClickRoot:k}},eSe=e=>{const t=le(!1),{emit:o}=kn(),i=Rt(_v,void 0),c=z(()=>qn(i)===!1),u=le(!1),f=z({get(){var p,v;return c.value?(p=i==null?void 0:i.modelValue)==null?void 0:p.value:(v=e.modelValue)!=null?v:t.value},set(p){var v,_;c.value&&ht(p)?(u.value=((v=i==null?void 0:i.max)==null?void 0:v.value)!==void 0&&p.length>(i==null?void 0:i.max.value)&&p.length>f.value.length,u.value===!1&&((_=i==null?void 0:i.changeEvent)==null||_.call(i,p))):(o(nn,p),t.value=p)}});return{model:f,isGroup:c,isLimitExceeded:u}},tSe=(e,t,{model:o})=>{const i=Rt(_v,void 0),c=le(!1),u=z(()=>ks(e.value)?e.label:e.value),f=z(()=>{const b=o.value;return vo(b)?b:ht(b)?gn(u.value)?b.map(Mo).some(S=>ui(S,u.value)):b.map(Mo).includes(u.value):b!=null?b===e.trueValue||b===e.trueLabel:!!b}),p=Fr(z(()=>{var b;return(b=i==null?void 0:i.size)==null?void 0:b.value}),{prop:!0}),v=Fr(z(()=>{var b;return(b=i==null?void 0:i.size)==null?void 0:b.value})),_=z(()=>!!t.default||!ks(u.value));return{checkboxButtonSize:p,isChecked:f,isFocused:c,checkboxSize:v,hasOwnLabel:_,actualValue:u}},o9=(e,t)=>{const{formItem:o}=Ni(),{model:i,isGroup:c,isLimitExceeded:u}=eSe(e),{isFocused:f,isChecked:p,checkboxButtonSize:v,checkboxSize:_,hasOwnLabel:b,actualValue:S}=tSe(e,t,{model:i}),{isDisabled:k}=ZCe({model:i,isChecked:p}),{inputId:M,isLabeledByFormItem:R}=Ps(e,{formItemContext:o,disableIdGeneration:b,disableIdManagement:c}),{handleChange:w,onClickRoot:E}=QCe(e,{model:i,isLimitExceeded:u,hasOwnLabel:b,isDisabled:k,isLabeledByFormItem:R});return(()=>{function F(){var x,P;ht(i.value)&&!i.value.includes(S.value)?i.value.push(S.value):i.value=(P=(x=e.trueValue)!=null?x:e.trueLabel)!=null?P:!0}e.checked&&F()})(),ou({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},z(()=>c.value&&ks(e.value))),ou({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},z(()=>!!e.trueLabel)),ou({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},z(()=>!!e.falseLabel)),{inputId:M,isLabeledByFormItem:R,isChecked:p,isDisabled:k,isFocused:f,checkboxButtonSize:v,checkboxSize:_,hasOwnLabel:b,model:i,actualValue:S,handleChange:w,onClickRoot:E}},nSe=Te({name:"ElCheckbox"}),oSe=Te({...nSe,props:t9,emits:n9,setup(e){const t=e,o=Qr(),{inputId:i,isLabeledByFormItem:c,isChecked:u,isDisabled:f,isFocused:p,checkboxSize:v,hasOwnLabel:_,model:b,actualValue:S,handleChange:k,onClickRoot:M}=o9(t,o),R=ut("checkbox"),w=z(()=>[R.b(),R.m(v.value),R.is("disabled",f.value),R.is("bordered",t.border),R.is("checked",u.value)]),E=z(()=>[R.e("input"),R.is("disabled",f.value),R.is("checked",u.value),R.is("indeterminate",t.indeterminate),R.is("focus",p.value)]);return(N,F)=>(ee(),We(Tn(!y(_)&&y(c)?"span":"label"),{class:ne(y(w)),"aria-controls":N.indeterminate?N.ariaControls:null,onClick:y(M)},{default:Ae(()=>{var x,P,G,H;return[Ee("span",{class:ne(y(E))},[N.trueValue||N.falseValue||N.trueLabel||N.falseLabel?fn((ee(),ge("input",{key:0,id:y(i),"onUpdate:modelValue":Y=>Bo(b)?b.value=Y:null,class:ne(y(R).e("original")),type:"checkbox",indeterminate:N.indeterminate,name:N.name,tabindex:N.tabindex,disabled:y(f),"true-value":(P=(x=N.trueValue)!=null?x:N.trueLabel)!=null?P:!0,"false-value":(H=(G=N.falseValue)!=null?G:N.falseLabel)!=null?H:!1,onChange:y(k),onFocus:Y=>p.value=!0,onBlur:Y=>p.value=!1,onClick:Zt(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[OE,y(b)]]):fn((ee(),ge("input",{key:1,id:y(i),"onUpdate:modelValue":Y=>Bo(b)?b.value=Y:null,class:ne(y(R).e("original")),type:"checkbox",indeterminate:N.indeterminate,disabled:y(f),value:y(S),name:N.name,tabindex:N.tabindex,onChange:y(k),onFocus:Y=>p.value=!0,onBlur:Y=>p.value=!1,onClick:Zt(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[OE,y(b)]]),Ee("span",{class:ne(y(R).e("inner"))},null,2)],2),y(_)?(ee(),ge("span",{key:0,class:ne(y(R).e("label"))},[Ve(N.$slots,"default"),N.$slots.default?$e("v-if",!0):(ee(),ge(Ht,{key:0},[Mn(mt(N.label),1)],64))],2)):$e("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var rSe=vt(oSe,[["__file","checkbox.vue"]]);const iSe=Te({name:"ElCheckboxButton"}),aSe=Te({...iSe,props:t9,emits:n9,setup(e){const t=e,o=Qr(),{isFocused:i,isChecked:c,isDisabled:u,checkboxButtonSize:f,model:p,actualValue:v,handleChange:_}=o9(t,o),b=Rt(_v,void 0),S=ut("checkbox"),k=z(()=>{var R,w,E,N;const F=(w=(R=b==null?void 0:b.fill)==null?void 0:R.value)!=null?w:"";return{backgroundColor:F,borderColor:F,color:(N=(E=b==null?void 0:b.textColor)==null?void 0:E.value)!=null?N:"",boxShadow:F?`-1px 0 0 0 ${F}`:void 0}}),M=z(()=>[S.b("button"),S.bm("button",f.value),S.is("disabled",u.value),S.is("checked",c.value),S.is("focus",i.value)]);return(R,w)=>{var E,N,F,x;return ee(),ge("label",{class:ne(y(M))},[R.trueValue||R.falseValue||R.trueLabel||R.falseLabel?fn((ee(),ge("input",{key:0,"onUpdate:modelValue":P=>Bo(p)?p.value=P:null,class:ne(y(S).be("button","original")),type:"checkbox",name:R.name,tabindex:R.tabindex,disabled:y(u),"true-value":(N=(E=R.trueValue)!=null?E:R.trueLabel)!=null?N:!0,"false-value":(x=(F=R.falseValue)!=null?F:R.falseLabel)!=null?x:!1,onChange:y(_),onFocus:P=>i.value=!0,onBlur:P=>i.value=!1,onClick:Zt(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[OE,y(p)]]):fn((ee(),ge("input",{key:1,"onUpdate:modelValue":P=>Bo(p)?p.value=P:null,class:ne(y(S).be("button","original")),type:"checkbox",name:R.name,tabindex:R.tabindex,disabled:y(u),value:y(v),onChange:y(_),onFocus:P=>i.value=!0,onBlur:P=>i.value=!1,onClick:Zt(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[OE,y(p)]]),R.$slots.default||R.label?(ee(),ge("span",{key:2,class:ne(y(S).be("button","inner")),style:qt(y(c)?y(k):void 0)},[Ve(R.$slots,"default",{},()=>[Mn(mt(R.label),1)])],6)):$e("v-if",!0)],2)}}});var r9=vt(aSe,[["__file","checkbox-button.vue"]]);const sSe=pt({modelValue:{type:Ue(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Kr,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...Ci(["ariaLabel"])}),lSe={[nn]:e=>ht(e),change:e=>ht(e)},cSe=Te({name:"ElCheckboxGroup"}),uSe=Te({...cSe,props:sSe,emits:lSe,setup(e,{emit:t}){const o=e,i=ut("checkbox"),{formItem:c}=Ni(),{inputId:u,isLabeledByFormItem:f}=Ps(o,{formItemContext:c}),p=async _=>{t(nn,_),await Vt(),t(wn,_)},v=z({get(){return o.modelValue},set(_){p(_)}});return Nn(_v,{...il(hi(o),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:v,changeEvent:p}),st(()=>o.modelValue,()=>{o.validateEvent&&(c==null||c.validate("change").catch(_=>void 0))}),(_,b)=>{var S;return ee(),We(Tn(_.tag),{id:y(u),class:ne(y(i).b("group")),role:"group","aria-label":y(f)?void 0:_.ariaLabel||"checkbox-group","aria-labelledby":y(f)?(S=y(c))==null?void 0:S.labelId:void 0},{default:Ae(()=>[Ve(_.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var i9=vt(uSe,[["__file","checkbox-group.vue"]]);const Ls=un(rSe,{CheckboxButton:r9,CheckboxGroup:i9}),dSe=lr(r9),a9=lr(i9),s9=pt({modelValue:{type:[String,Number,Boolean],default:void 0},size:Kr,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),hSe=pt({...s9,border:Boolean}),l9={[nn]:e=>Ut(e)||jt(e)||vo(e),[wn]:e=>Ut(e)||jt(e)||vo(e)},c9=Symbol("radioGroupKey"),u9=(e,t)=>{const o=le(),i=Rt(c9,void 0),c=z(()=>!!i),u=z(()=>ks(e.value)?e.label:e.value),f=z({get(){return c.value?i.modelValue:e.modelValue},set(S){c.value?i.changeEvent(S):t&&t(nn,S),o.value.checked=e.modelValue===u.value}}),p=Fr(z(()=>i==null?void 0:i.size)),v=Pi(z(()=>i==null?void 0:i.disabled)),_=le(!1),b=z(()=>v.value||c.value&&f.value!==u.value?-1:0);return ou({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},z(()=>c.value&&ks(e.value))),{radioRef:o,isGroup:c,radioGroup:i,focus:_,size:p,disabled:v,tabIndex:b,modelValue:f,actualValue:u}},fSe=Te({name:"ElRadio"}),pSe=Te({...fSe,props:hSe,emits:l9,setup(e,{emit:t}){const o=e,i=ut("radio"),{radioRef:c,radioGroup:u,focus:f,size:p,disabled:v,modelValue:_,actualValue:b}=u9(o,t);function S(){Vt(()=>t(wn,_.value))}return(k,M)=>{var R;return ee(),ge("label",{class:ne([y(i).b(),y(i).is("disabled",y(v)),y(i).is("focus",y(f)),y(i).is("bordered",k.border),y(i).is("checked",y(_)===y(b)),y(i).m(y(p))])},[Ee("span",{class:ne([y(i).e("input"),y(i).is("disabled",y(v)),y(i).is("checked",y(_)===y(b))])},[fn(Ee("input",{ref_key:"radioRef",ref:c,"onUpdate:modelValue":w=>Bo(_)?_.value=w:null,class:ne(y(i).e("original")),value:y(b),name:k.name||((R=y(u))==null?void 0:R.name),disabled:y(v),checked:y(_)===y(b),type:"radio",onFocus:w=>f.value=!0,onBlur:w=>f.value=!1,onChange:S,onClick:Zt(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[$$,y(_)]]),Ee("span",{class:ne(y(i).e("inner"))},null,2)],2),Ee("span",{class:ne(y(i).e("label")),onKeydown:Zt(()=>{},["stop"])},[Ve(k.$slots,"default",{},()=>[Mn(mt(k.label),1)])],42,["onKeydown"])],2)}}});var mSe=vt(pSe,[["__file","radio.vue"]]);const gSe=pt({...s9}),vSe=Te({name:"ElRadioButton"}),_Se=Te({...vSe,props:gSe,setup(e){const t=e,o=ut("radio"),{radioRef:i,focus:c,size:u,disabled:f,modelValue:p,radioGroup:v,actualValue:_}=u9(t),b=z(()=>({backgroundColor:(v==null?void 0:v.fill)||"",borderColor:(v==null?void 0:v.fill)||"",boxShadow:v!=null&&v.fill?`-1px 0 0 0 ${v.fill}`:"",color:(v==null?void 0:v.textColor)||""}));return(S,k)=>{var M;return ee(),ge("label",{class:ne([y(o).b("button"),y(o).is("active",y(p)===y(_)),y(o).is("disabled",y(f)),y(o).is("focus",y(c)),y(o).bm("button",y(u))])},[fn(Ee("input",{ref_key:"radioRef",ref:i,"onUpdate:modelValue":R=>Bo(p)?p.value=R:null,class:ne(y(o).be("button","original-radio")),value:y(_),type:"radio",name:S.name||((M=y(v))==null?void 0:M.name),disabled:y(f),onFocus:R=>c.value=!0,onBlur:R=>c.value=!1,onClick:Zt(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[$$,y(p)]]),Ee("span",{class:ne(y(o).be("button","inner")),style:qt(y(p)===y(_)?y(b):{}),onKeydown:Zt(()=>{},["stop"])},[Ve(S.$slots,"default",{},()=>[Mn(mt(S.label),1)])],46,["onKeydown"])],2)}}});var d9=vt(_Se,[["__file","radio-button.vue"]]);const ySe=pt({id:{type:String,default:void 0},size:Kr,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...Ci(["ariaLabel"])}),ISe=l9,bSe=Te({name:"ElRadioGroup"}),CSe=Te({...bSe,props:ySe,emits:ISe,setup(e,{emit:t}){const o=e,i=ut("radio"),c=bi(),u=le(),{formItem:f}=Ni(),{inputId:p,isLabeledByFormItem:v}=Ps(o,{formItemContext:f}),_=S=>{t(nn,S),Vt(()=>t(wn,S))};mn(()=>{const S=u.value.querySelectorAll("[type=radio]"),k=S[0];!Array.from(S).some(M=>M.checked)&&k&&(k.tabIndex=0)});const b=z(()=>o.name||c.value);return Nn(c9,eo({...hi(o),changeEvent:_,name:b})),st(()=>o.modelValue,()=>{o.validateEvent&&(f==null||f.validate("change").catch(S=>void 0))}),(S,k)=>(ee(),ge("div",{id:y(p),ref_key:"radioGroupRef",ref:u,class:ne(y(i).b("group")),role:"radiogroup","aria-label":y(v)?void 0:S.ariaLabel||"radio-group","aria-labelledby":y(v)?y(f).labelId:void 0},[Ve(S.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var h9=vt(CSe,[["__file","radio-group.vue"]]);const f9=un(mSe,{RadioButton:d9,RadioGroup:h9}),SSe=lr(h9),ESe=lr(d9);var TSe=Te({name:"NodeContent",setup(){return{ns:ut("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:o}=this.$parent,{data:i,label:c}=t,{renderLabelFn:u}=o;return Jt("span",{class:e.e("label")},u?u({node:t,data:i}):c)}});const TN=Symbol(),MSe=Te({name:"ElCascaderNode",components:{ElCheckbox:Ls,ElRadio:f9,NodeContent:TSe,ElIcon:Pt,Check:sI,Loading:ec,ArrowRight:ca},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const o=Rt(TN),i=ut("cascader-node"),c=z(()=>o.isHoverMenu),u=z(()=>o.config.multiple),f=z(()=>o.config.checkStrictly),p=z(()=>{var H;return(H=o.checkedNodes[0])==null?void 0:H.uid}),v=z(()=>e.node.isDisabled),_=z(()=>e.node.isLeaf),b=z(()=>f.value&&!_.value||!v.value),S=z(()=>M(o.expandingNode)),k=z(()=>f.value&&o.checkedNodes.some(M)),M=H=>{var Y;const{level:j,uid:W}=e.node;return((Y=H==null?void 0:H.pathNodes[j-1])==null?void 0:Y.uid)===W},R=()=>{S.value||o.expandNode(e.node)},w=H=>{const{node:Y}=e;H!==Y.checked&&o.handleCheckChange(Y,H)},E=()=>{o.lazyLoad(e.node,()=>{_.value||R()})},N=H=>{c.value&&(F(),!_.value&&t("expand",H))},F=()=>{const{node:H}=e;!b.value||H.loading||(H.loaded?R():E())},x=()=>{c.value&&!_.value||(_.value&&!v.value&&!f.value&&!u.value?G(!0):F())},P=H=>{f.value?(w(H),e.node.loaded&&R()):G(H)},G=H=>{e.node.loaded?(w(H),!f.value&&R()):E()};return{panel:o,isHoverMenu:c,multiple:u,checkStrictly:f,checkedNodeId:p,isDisabled:v,isLeaf:_,expandable:b,inExpandingPath:S,inCheckedPath:k,ns:i,handleHoverExpand:N,handleExpand:F,handleClick:x,handleCheck:G,handleSelectCheck:P}}});function kSe(e,t,o,i,c,u){const f=Cn("el-checkbox"),p=Cn("el-radio"),v=Cn("check"),_=Cn("el-icon"),b=Cn("node-content"),S=Cn("loading"),k=Cn("arrow-right");return ee(),ge("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?void 0:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:ne([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[$e(" prefix "),e.multiple?(ee(),We(f,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:Zt(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(ee(),We(p,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:Zt(()=>{},["stop"])},{default:Ae(()=>[$e(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ee("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(ee(),We(_,{key:2,class:ne(e.ns.e("prefix"))},{default:Ae(()=>[Me(v)]),_:1},8,["class"])):$e("v-if",!0),$e(" content "),Me(b),$e(" postfix "),e.isLeaf?$e("v-if",!0):(ee(),ge(Ht,{key:3},[e.node.loading?(ee(),We(_,{key:0,class:ne([e.ns.is("loading"),e.ns.e("postfix")])},{default:Ae(()=>[Me(S)]),_:1},8,["class"])):(ee(),We(_,{key:1,class:ne(["arrow-right",e.ns.e("postfix")])},{default:Ae(()=>[Me(k)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var wSe=vt(MSe,[["render",kSe],["__file","node.vue"]]);const RSe=Te({name:"ElCascaderMenu",components:{Loading:ec,ElIcon:Pt,ElScrollbar:ac,ElCascaderNode:wSe},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=kn(),o=ut("cascader-menu"),{t:i}=Kn(),c=bi();let u=null,f=null;const p=Rt(TN),v=le(null),_=z(()=>!e.nodes.length),b=z(()=>!p.initialLoaded),S=z(()=>`${c.value}-${e.index}`),k=E=>{u=E.target},M=E=>{if(!(!p.isHoverMenu||!u||!v.value))if(u.contains(E.target)){R();const N=t.vnode.el,{left:F}=N.getBoundingClientRect(),{offsetWidth:x,offsetHeight:P}=N,G=E.clientX-F,H=u.offsetTop,Y=H+u.offsetHeight;v.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${G} ${H} L${x} 0 V${H} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${G} ${Y} L${x} ${P} V${Y} Z" />
        `}else f||(f=window.setTimeout(w,p.config.hoverThreshold))},R=()=>{f&&(clearTimeout(f),f=null)},w=()=>{v.value&&(v.value.innerHTML="",R())};return{ns:o,panel:p,hoverZone:v,isEmpty:_,isLoading:b,menuId:S,t:i,handleExpand:k,handleMouseMove:M,clearHoverZone:w}}});function ASe(e,t,o,i,c,u){const f=Cn("el-cascader-node"),p=Cn("loading"),v=Cn("el-icon"),_=Cn("el-scrollbar");return ee(),We(_,{key:e.menuId,tag:"ul",role:"menu",class:ne(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:Ae(()=>{var b;return[(ee(!0),ge(Ht,null,Un(e.nodes,S=>(ee(),We(f,{key:S.uid,node:S,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(ee(),ge("div",{key:0,class:ne(e.ns.e("empty-text"))},[Me(v,{size:"14",class:ne(e.ns.is("loading"))},{default:Ae(()=>[Me(p)]),_:1},8,["class"]),Mn(" "+mt(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(ee(),ge("div",{key:1,class:ne(e.ns.e("empty-text"))},[Ve(e.$slots,"empty",{},()=>[Mn(mt(e.t("el.cascader.noData")),1)])],2)):(b=e.panel)!=null&&b.isHoverMenu?(ee(),ge(Ht,{key:2},[$e(" eslint-disable-next-line vue/html-self-closing "),(ee(),ge("svg",{ref:"hoverZone",class:ne(e.ns.e("hover-zone"))},null,2))],2112)):$e("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var DSe=vt(RSe,[["render",ASe],["__file","menu.vue"]]);const MN=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Yl=e=>Y0(e);let OSe=0;const LSe=e=>{const t=[e];let{parent:o}=e;for(;o;)t.unshift(o),o=o.parent;return t};let nO=class oO{constructor(t,o,i,c=!1){this.data=t,this.config=o,this.parent=i,this.root=c,this.uid=OSe++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:u,label:f,children:p}=o,v=t[p],_=LSe(this);this.level=c?0:i?i.level+1:1,this.value=t[u],this.label=t[f],this.pathNodes=_,this.pathValues=_.map(b=>b.value),this.pathLabels=_.map(b=>b.label),this.childrenData=v,this.children=(v||[]).map(b=>new oO(b,o,this)),this.loaded=!o.lazy||this.isLeaf||!Xa(v)}get isDisabled(){const{data:t,parent:o,config:i}=this,{disabled:c,checkStrictly:u}=i;return(zt(c)?c(t,this):!!t[c])||!u&&(o==null?void 0:o.isDisabled)}get isLeaf(){const{data:t,config:o,childrenData:i,loaded:c}=this,{lazy:u,leaf:f}=o,p=zt(f)?f(t,this):t[f];return qn(p)?u&&!c?!1:!(ht(i)&&i.length):!!p}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:o,children:i}=this,c=new oO(t,this.config,this);return ht(o)?o.push(t):this.childrenData=[t],i.push(c),c}calcText(t,o){const i=t?this.pathLabels.join(o):this.label;return this.text=i,i}broadcast(t,...o){const i=`onParent${Yl(t)}`;this.children.forEach(c=>{c&&(c.broadcast(t,...o),c[i]&&c[i](...o))})}emit(t,...o){const{parent:i}=this,c=`onChild${Yl(t)}`;i&&(i[c]&&i[c](...o),i.emit(t,...o))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,o=t.filter(c=>!c.isDisabled),i=o.length?o.every(c=>c.checked):!1;this.setCheckState(i)}setCheckState(t){const o=this.children.length,i=this.children.reduce((c,u)=>{const f=u.checked?1:u.indeterminate?.5:0;return c+f},0);this.checked=this.loaded&&this.children.filter(c=>!c.isDisabled).every(c=>c.loaded&&c.checked)&&t,this.indeterminate=this.loaded&&i!==o&&i>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:o,multiple:i}=this.config;o||!i?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const rO=(e,t)=>e.reduce((o,i)=>(i.isLeaf?o.push(i):(!t&&o.push(i),o=o.concat(rO(i.children,t))),o),[]);class yB{constructor(t,o){this.config=o;const i=(t||[]).map(c=>new nO(c,this.config));this.nodes=i,this.allNodes=rO(i,!1),this.leafNodes=rO(i,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,o){const i=o?o.appendChild(t):new nO(t,this.config);o||this.nodes.push(i),this.appendAllNodesAndLeafNodes(i)}appendNodes(t,o){t.forEach(i=>this.appendNode(i,o))}appendAllNodesAndLeafNodes(t){this.allNodes.push(t),t.isLeaf&&this.leafNodes.push(t),t.children&&t.children.forEach(o=>{this.appendAllNodesAndLeafNodes(o)})}getNodeByValue(t,o=!1){return!t&&t!==0?null:this.getFlattedNodes(o).find(c=>ui(c.value,t)||ui(c.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:i,level:c})=>ui(t.value,i)&&t.level===c)||null}}const p9=pt({modelValue:{type:Ue([Number,String,Array])},options:{type:Ue(Array),default:()=>[]},props:{type:Ue(Object),default:()=>({})}}),NSe={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:lo,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},PSe=e=>z(()=>({...NSe,...e.props})),IB=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},xSe=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():_K(e)&&e.click()},USe=(e,t)=>{const o=t.slice(0),i=o.map(u=>u.uid),c=e.reduce((u,f)=>{const p=i.indexOf(f.uid);return p>-1&&(u.push(f),o.splice(p,1),i.splice(p,1)),u},[]);return c.push(...o),c},bB=e=>[...new Set(e)],aa=e=>!e&&e!==0?[]:ht(e)?e:[e],FSe=Te({name:"ElCascaderPanel",components:{ElCascaderMenu:DSe},props:{...p9,border:{type:Boolean,default:!0},renderLabel:Function},emits:[nn,wn,"close","expand-change"],setup(e,{emit:t,slots:o}){let i=!1;const c=ut("cascader"),u=PSe(e);let f=null;const p=le(!0),v=le([]),_=le(null),b=le([]),S=le(null),k=le([]),M=z(()=>u.value.expandTrigger==="hover"),R=z(()=>e.renderLabel||o.default),w=()=>{const{options:J}=e,oe=u.value;i=!1,f=new yB(J,oe),b.value=[f.getNodes()],oe.lazy&&Xa(e.options)?(p.value=!1,E(void 0,pe=>{pe&&(f=new yB(pe,oe),b.value=[f.getNodes()]),p.value=!0,j(!1,!0)})):j(!1,!0)},E=(J,oe)=>{const pe=u.value;J=J||new nO({},pe,void 0,!0),J.loading=!0;const ie=te=>{const he=J,re=he.root?null:he;te&&(f==null||f.appendNodes(te,re)),he.loading=!1,he.loaded=!0,he.childrenData=he.childrenData||[],oe&&oe(te)};pe.lazyLoad(J,ie)},N=(J,oe)=>{var pe;const{level:ie}=J,te=b.value.slice(0,ie);let he;J.isLeaf?he=J.pathNodes[ie-2]:(he=J,te.push(J.children)),((pe=S.value)==null?void 0:pe.uid)!==(he==null?void 0:he.uid)&&(S.value=J,b.value=te,!oe&&t("expand-change",(J==null?void 0:J.pathValues)||[]))},F=(J,oe,pe=!0)=>{const{checkStrictly:ie,multiple:te}=u.value,he=k.value[0];i=!0,!te&&(he==null||he.doCheck(!1)),J.doCheck(oe),Y(),pe&&!te&&!ie&&t("close"),!pe&&!te&&!ie&&x(J)},x=J=>{J&&(J=J.parent,x(J),J&&N(J))},P=J=>f==null?void 0:f.getFlattedNodes(J),G=J=>{var oe;return(oe=P(J))==null?void 0:oe.filter(pe=>pe.checked!==!1)},H=()=>{k.value.forEach(J=>J.doCheck(!1)),Y(),b.value=b.value.slice(0,1),S.value=null,t("expand-change",[])},Y=()=>{var J;const{checkStrictly:oe,multiple:pe}=u.value,ie=k.value,te=G(!oe),he=USe(ie,te),re=he.map(X=>X.valueByOption);k.value=he,_.value=pe?re:(J=re[0])!=null?J:null},j=(J=!1,oe=!1)=>{const{modelValue:pe}=e,{lazy:ie,multiple:te,checkStrictly:he}=u.value,re=!he;if(!(!p.value||i||!oe&&ui(pe,_.value)))if(ie&&!J){const ye=bB(Gge(aa(pe))).map(ue=>f==null?void 0:f.getNodeByValue(ue)).filter(ue=>!!ue&&!ue.loaded&&!ue.loading);ye.length?ye.forEach(ue=>{E(ue,()=>j(!1,oe))}):j(!0,oe)}else{const X=te?aa(pe):[pe],ye=bB(X.map(ue=>f==null?void 0:f.getNodeByValue(ue,re)));W(ye,oe),_.value=HE(pe)}},W=(J,oe=!0)=>{const{checkStrictly:pe}=u.value,ie=k.value,te=J.filter(X=>!!X&&(pe||X.isLeaf)),he=f==null?void 0:f.getSameNode(S.value),re=oe&&he||te[0];re?re.pathNodes.forEach(X=>N(X,!0)):S.value=null,ie.forEach(X=>X.doCheck(!1)),eo(te).forEach(X=>X.doCheck(!0)),k.value=te,Vt(O)},O=()=>{$n&&v.value.forEach(J=>{const oe=J==null?void 0:J.$el;if(oe){const pe=oe.querySelector(`.${c.namespace.value}-scrollbar__wrap`),ie=oe.querySelector(`.${c.b("node")}.${c.is("active")}`)||oe.querySelector(`.${c.b("node")}.in-active-path`);nN(pe,ie)}})},Q=J=>{const oe=J.target,{code:pe}=J;switch(pe){case At.up:case At.down:{J.preventDefault();const ie=pe===At.up?-1:1;uE(yK(oe,ie,`.${c.b("node")}[tabindex="-1"]`));break}case At.left:{J.preventDefault();const ie=v.value[IB(oe)-1],te=ie==null?void 0:ie.$el.querySelector(`.${c.b("node")}[aria-expanded="true"]`);uE(te);break}case At.right:{J.preventDefault();const ie=v.value[IB(oe)+1],te=ie==null?void 0:ie.$el.querySelector(`.${c.b("node")}[tabindex="-1"]`);uE(te);break}case At.enter:case At.numpadEnter:xSe(oe);break}};return Nn(TN,eo({config:u,expandingNode:S,checkedNodes:k,isHoverMenu:M,initialLoaded:p,renderLabelFn:R,lazyLoad:E,expandNode:N,handleCheckChange:F})),st([u,()=>e.options],w,{deep:!0,immediate:!0}),st(()=>e.modelValue,()=>{i=!1,j()},{deep:!0}),st(()=>_.value,J=>{ui(J,e.modelValue)||(t(nn,J),t(wn,J))}),p$(()=>v.value=[]),mn(()=>!Xa(e.modelValue)&&j()),{ns:c,menuList:v,menus:b,checkedNodes:k,handleKeyDown:Q,handleCheckChange:F,getFlattedNodes:P,getCheckedNodes:G,clearCheckedNodes:H,calculateCheckedValue:Y,scrollToExpandingNode:O}}});function VSe(e,t,o,i,c,u){const f=Cn("el-cascader-menu");return ee(),ge("div",{class:ne([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(ee(!0),ge(Ht,null,Un(e.menus,(p,v)=>(ee(),We(f,{key:v,ref_for:!0,ref:_=>e.menuList[v]=_,index:v,nodes:[...p]},{empty:Ae(()=>[Ve(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var GSe=vt(FSe,[["render",VSe],["__file","index.vue"]]);const m9=un(GSe),su=pt({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:ic},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),BSe={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},HSe=Te({name:"ElTag"}),$Se=Te({...HSe,props:su,emits:BSe,setup(e,{emit:t}){const o=e,i=Fr(),c=ut("tag"),u=z(()=>{const{type:_,hit:b,effect:S,closable:k,round:M}=o;return[c.b(),c.is("closable",k),c.m(_||"primary"),c.m(i.value),c.m(S),c.is("hit",b),c.is("round",M)]}),f=_=>{t("close",_)},p=_=>{t("click",_)},v=_=>{var b,S,k;(k=(S=(b=_==null?void 0:_.component)==null?void 0:b.subTree)==null?void 0:S.component)!=null&&k.bum&&(_.component.subTree.component.bum=null)};return(_,b)=>_.disableTransitions?(ee(),ge("span",{key:0,class:ne(y(u)),style:qt({backgroundColor:_.color}),onClick:p},[Ee("span",{class:ne(y(c).e("content"))},[Ve(_.$slots,"default")],2),_.closable?(ee(),We(y(Pt),{key:0,class:ne(y(c).e("close")),onClick:Zt(f,["stop"])},{default:Ae(()=>[Me(y(As))]),_:1},8,["class","onClick"])):$e("v-if",!0)],6)):(ee(),We(Zr,{key:1,name:`${y(c).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:v},{default:Ae(()=>[Ee("span",{class:ne(y(u)),style:qt({backgroundColor:_.color}),onClick:p},[Ee("span",{class:ne(y(c).e("content"))},[Ve(_.$slots,"default")],2),_.closable?(ee(),We(y(Pt),{key:0,class:ne(y(c).e("close")),onClick:Zt(f,["stop"])},{default:Ae(()=>[Me(y(As))]),_:1},8,["class","onClick"])):$e("v-if",!0)],6)]),_:3},8,["name"]))}});var qSe=vt($Se,[["__file","tag.vue"]]);const Zg=un(qSe),KSe=pt({...p9,size:Kr,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Ue(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Ue(Function),default:()=>!0},placement:{type:Ue(String),values:mu,default:"bottom-start"},fallbackPlacements:{type:Ue(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:Ur.teleported,tagType:{...su.type,default:"info"},tagEffect:{...su.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...mv}),zSe={[nn]:e=>!0,[wn]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>vo(e),expandChange:e=>!!e,removeTag:e=>!!e},Sd=new Map;if($n){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const o of Sd.values())for(const{documentHandler:i}of o)i(t,e);e=void 0}})}function CB(e,t){let o=[];return ht(t.arg)?o=t.arg:la(t.arg)&&o.push(t.arg),function(i,c){const u=t.instance.popperRef,f=i.target,p=c==null?void 0:c.target,v=!t||!t.instance,_=!f||!p,b=e.contains(f)||e.contains(p),S=e===f,k=o.length&&o.some(R=>R==null?void 0:R.contains(f))||o.length&&o.includes(p),M=u&&(u.contains(f)||u.contains(p));v||_||b||S||k||M||t.value(i,c)}}const lu={beforeMount(e,t){Sd.has(e)||Sd.set(e,[]),Sd.get(e).push({documentHandler:CB(e,t),bindingFn:t.value})},updated(e,t){Sd.has(e)||Sd.set(e,[]);const o=Sd.get(e),i=o.findIndex(u=>u.bindingFn===t.oldValue),c={documentHandler:CB(e,t),bindingFn:t.value};i>=0?o.splice(i,1,c):o.push(c)},unmounted(e){Sd.delete(e)}},WSe="ElCascader",jSe=Te({name:WSe}),YSe=Te({...jSe,props:KSe,emits:zSe,setup(e,{expose:t,emit:o}){const i=e,c={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:Ne})=>{const{modifiersData:qe,placement:ke}=Ne;["right","left","bottom","top"].includes(ke)||(qe.arrow.x=35)},requires:["arrow"]}]},u=uu();let f=0,p=0;const v=ut("cascader"),_=ut("input"),{t:b}=Kn(),{form:S,formItem:k}=Ni(),{valueOnClear:M}=PT(i),{isComposing:R,handleComposition:w}=cI({afterComposition(Ne){var qe;const ke=(qe=Ne.target)==null?void 0:qe.value;Xt(ke)}}),E=le(null),N=le(null),F=le(null),x=le(null),P=le(null),G=le(!1),H=le(!1),Y=le(!1),j=le(!1),W=le(""),O=le(""),Q=le([]),J=le([]),oe=le([]),pe=z(()=>u.style),ie=z(()=>i.disabled||(S==null?void 0:S.disabled)),te=z(()=>i.placeholder||b("el.cascader.placeholder")),he=z(()=>O.value||Q.value.length>0||R.value?"":te.value),re=Fr(),X=z(()=>re.value==="small"?"small":"default"),ye=z(()=>!!i.props.multiple),ue=z(()=>!i.filterable||ye.value),Ie=z(()=>ye.value?O.value:W.value),ve=z(()=>{var Ne;return((Ne=x.value)==null?void 0:Ne.checkedNodes)||[]}),Ce=z(()=>!i.clearable||ie.value||Y.value||!H.value?!1:!!ve.value.length),Fe=z(()=>{const{showAllLevels:Ne,separator:qe}=i,ke=ve.value;return ke.length?ye.value?"":ke[0].calcText(Ne,qe):""}),Oe=z(()=>(k==null?void 0:k.validateState)||""),be=z({get(){return HE(i.modelValue)},set(Ne){const qe=Ne??M.value;o(nn,qe),o(wn,qe),i.validateEvent&&(k==null||k.validate("change").catch(ke=>void 0))}}),xe=z(()=>[v.b(),v.m(re.value),v.is("disabled",ie.value),u.class]),Le=z(()=>[_.e("icon"),"icon-arrow-down",v.is("reverse",G.value)]),rt=z(()=>v.is("focus",G.value||j.value)),Qe=z(()=>{var Ne,qe;return(qe=(Ne=E.value)==null?void 0:Ne.popperRef)==null?void 0:qe.contentRef}),Ge=Ne=>{var qe,ke,ot;ie.value||(Ne=Ne??!G.value,Ne!==G.value&&(G.value=Ne,(ke=(qe=N.value)==null?void 0:qe.input)==null||ke.setAttribute("aria-expanded",`${Ne}`),Ne?(_e(),Vt((ot=x.value)==null?void 0:ot.scrollToExpandingNode)):i.filterable&&Et(),o("visibleChange",Ne)))},_e=()=>{Vt(()=>{var Ne;(Ne=E.value)==null||Ne.updatePopper()})},Re=()=>{Y.value=!1},Ke=Ne=>{const{showAllLevels:qe,separator:ke}=i;return{node:Ne,key:Ne.uid,text:Ne.calcText(qe,ke),hitState:!1,closable:!ie.value&&!Ne.isDisabled,isCollapseTag:!1}},je=Ne=>{var qe;const ke=Ne.node;ke.doCheck(!1),(qe=x.value)==null||qe.calculateCheckedValue(),o("removeTag",ke.valueByOption)},ze=()=>{if(!ye.value)return;const Ne=ve.value,qe=[],ke=[];if(Ne.forEach(ot=>ke.push(Ke(ot))),J.value=ke,Ne.length){Ne.slice(0,i.maxCollapseTags).forEach(Nt=>qe.push(Ke(Nt)));const ot=Ne.slice(i.maxCollapseTags),tn=ot.length;tn&&(i.collapseTags?qe.push({key:-1,text:`+ ${tn}`,closable:!1,isCollapseTag:!0}):ot.forEach(Nt=>qe.push(Ke(Nt))))}Q.value=qe},nt=()=>{var Ne,qe;const{filterMethod:ke,showAllLevels:ot,separator:tn}=i,Nt=(qe=(Ne=x.value)==null?void 0:Ne.getFlattedNodes(!i.props.checkStrictly))==null?void 0:qe.filter(Dn=>Dn.isDisabled?!1:(Dn.calcText(ot,tn),ke(Dn,Ie.value)));ye.value&&(Q.value.forEach(Dn=>{Dn.hitState=!1}),J.value.forEach(Dn=>{Dn.hitState=!1})),Y.value=!0,oe.value=Nt,_e()},it=()=>{var Ne;let qe;Y.value&&P.value?qe=P.value.$el.querySelector(`.${v.e("suggestion-item")}`):qe=(Ne=x.value)==null?void 0:Ne.$el.querySelector(`.${v.b("node")}[tabindex="-1"]`),qe&&(qe.focus(),!Y.value&&qe.click())},dt=()=>{var Ne,qe;const ke=(Ne=N.value)==null?void 0:Ne.input,ot=F.value,tn=(qe=P.value)==null?void 0:qe.$el;if(!(!$n||!ke)){if(tn){const Nt=tn.querySelector(`.${v.e("suggestion-list")}`);Nt.style.minWidth=`${ke.offsetWidth}px`}if(ot){const{offsetHeight:Nt}=ot,Dn=Q.value.length>0?`${Math.max(Nt,f)-2}px`:`${f}px`;ke.style.height=Dn,_e()}}},gt=Ne=>{var qe;return(qe=x.value)==null?void 0:qe.getCheckedNodes(Ne)},ft=Ne=>{_e(),o("expandChange",Ne)},Mt=Ne=>{if(!R.value)switch(Ne.code){case At.enter:case At.numpadEnter:Ge();break;case At.down:Ge(!0),Vt(it),Ne.preventDefault();break;case At.esc:G.value===!0&&(Ne.preventDefault(),Ne.stopPropagation(),Ge(!1));break;case At.tab:Ge(!1);break}},lt=()=>{var Ne;(Ne=x.value)==null||Ne.clearCheckedNodes(),!G.value&&i.filterable&&Et(),Ge(!1),o("clear")},Et=()=>{const{value:Ne}=Fe;W.value=Ne,O.value=Ne},Yt=Ne=>{var qe,ke;const{checked:ot}=Ne;ye.value?(qe=x.value)==null||qe.handleCheckChange(Ne,!ot,!1):(!ot&&((ke=x.value)==null||ke.handleCheckChange(Ne,!0,!1)),Ge(!1))},sn=Ne=>{const qe=Ne.target,{code:ke}=Ne;switch(ke){case At.up:case At.down:{Ne.preventDefault();const ot=ke===At.up?-1:1;uE(yK(qe,ot,`.${v.e("suggestion-item")}[tabindex="-1"]`));break}case At.enter:case At.numpadEnter:qe.click();break}},dn=()=>{const Ne=Q.value,qe=Ne[Ne.length-1];p=O.value?0:p+1,!(!qe||!p||i.collapseTags&&Ne.length>1)&&(qe.hitState?je(qe):qe.hitState=!0)},Sn=Ne=>{const qe=Ne.target,ke=v.e("search-input");qe.className===ke&&(j.value=!0),o("focus",Ne)},yn=Ne=>{j.value=!1,o("blur",Ne)},fo=Oa(()=>{const{value:Ne}=Ie;if(!Ne)return;const qe=i.beforeFilter(Ne);h0(qe)?qe.then(nt).catch(()=>{}):qe!==!1?nt():Re()},i.debounce),Xt=(Ne,qe)=>{!G.value&&Ge(!0),!(qe!=null&&qe.isComposing)&&(Ne?fo():Re())},vn=Ne=>Number.parseFloat(bve(_.cssVarName("input-height"),Ne).value)-2;return st(Y,_e),st([ve,ie,()=>i.collapseTags],ze),st(Q,()=>{Vt(()=>dt())}),st(re,async()=>{await Vt();const Ne=N.value.input;f=vn(Ne)||f,dt()}),st(Fe,Et,{immediate:!0}),mn(()=>{const Ne=N.value.input,qe=vn(Ne);f=Ne.offsetHeight||qe,ar(Ne,dt)}),t({getCheckedNodes:gt,cascaderPanelRef:x,togglePopperVisible:Ge,contentRef:Qe,presentText:Fe}),(Ne,qe)=>(ee(),We(y(Li),{ref_key:"tooltipRef",ref:E,visible:G.value,teleported:Ne.teleported,"popper-class":[y(v).e("dropdown"),Ne.popperClass],"popper-options":c,"fallback-placements":Ne.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:Ne.placement,transition:`${y(v).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:Ne.persistent,onHide:Re},{default:Ae(()=>[fn((ee(),ge("div",{class:ne(y(xe)),style:qt(y(pe)),onClick:()=>Ge(y(ue)?void 0:!0),onKeydown:Mt,onMouseenter:ke=>H.value=!0,onMouseleave:ke=>H.value=!1},[Me(y(Yi),{ref_key:"input",ref:N,modelValue:W.value,"onUpdate:modelValue":ke=>W.value=ke,placeholder:y(he),readonly:y(ue),disabled:y(ie),"validate-event":!1,size:y(re),class:ne(y(rt)),tabindex:y(ye)&&Ne.filterable&&!y(ie)?-1:void 0,onCompositionstart:y(w),onCompositionupdate:y(w),onCompositionend:y(w),onFocus:Sn,onBlur:yn,onInput:Xt},rs({suffix:Ae(()=>[y(Ce)?(ee(),We(y(Pt),{key:"clear",class:ne([y(_).e("icon"),"icon-circle-close"]),onClick:Zt(lt,["stop"])},{default:Ae(()=>[Me(y(pu))]),_:1},8,["class","onClick"])):(ee(),We(y(Pt),{key:"arrow-down",class:ne(y(Le)),onClick:Zt(ke=>Ge(),["stop"])},{default:Ae(()=>[Me(y(fu))]),_:1},8,["class","onClick"]))]),_:2},[Ne.$slots.prefix?{name:"prefix",fn:Ae(()=>[Ve(Ne.$slots,"prefix")])}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),y(ye)?(ee(),ge("div",{key:0,ref_key:"tagWrapper",ref:F,class:ne([y(v).e("tags"),y(v).is("validate",!!y(Oe))])},[(ee(!0),ge(Ht,null,Un(Q.value,ke=>(ee(),We(y(Zg),{key:ke.key,type:Ne.tagType,size:y(X),effect:Ne.tagEffect,hit:ke.hitState,closable:ke.closable,"disable-transitions":"",onClose:ot=>je(ke)},{default:Ae(()=>[ke.isCollapseTag===!1?(ee(),ge("span",{key:0},mt(ke.text),1)):(ee(),We(y(Li),{key:1,disabled:G.value||!Ne.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:Ae(()=>[Ee("span",null,mt(ke.text),1)]),content:Ae(()=>[Ee("div",{class:ne(y(v).e("collapse-tags"))},[(ee(!0),ge(Ht,null,Un(J.value.slice(Ne.maxCollapseTags),(ot,tn)=>(ee(),ge("div",{key:tn,class:ne(y(v).e("collapse-tag"))},[(ee(),We(y(Zg),{key:ot.key,class:"in-tooltip",type:Ne.tagType,size:y(X),effect:Ne.tagEffect,hit:ot.hitState,closable:ot.closable,"disable-transitions":"",onClose:Nt=>je(ot)},{default:Ae(()=>[Ee("span",null,mt(ot.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),Ne.filterable&&!y(ie)?fn((ee(),ge("input",{key:0,"onUpdate:modelValue":ke=>O.value=ke,type:"text",class:ne(y(v).e("search-input")),placeholder:y(Fe)?"":y(te),onInput:ke=>Xt(O.value,ke),onClick:Zt(ke=>Ge(!0),["stop"]),onKeydown:To(dn,["delete"]),onCompositionstart:y(w),onCompositionupdate:y(w),onCompositionend:y(w),onFocus:Sn,onBlur:yn},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[ET,O.value]]):$e("v-if",!0)],2)):$e("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[y(lu),()=>Ge(!1),y(Qe)]])]),content:Ae(()=>[fn(Me(y(m9),{ref_key:"cascaderPanelRef",ref:x,modelValue:y(be),"onUpdate:modelValue":ke=>Bo(be)?be.value=ke:null,options:Ne.options,props:i.props,border:!1,"render-label":Ne.$slots.default,onExpandChange:ft,onClose:ke=>Ne.$nextTick(()=>Ge(!1))},{empty:Ae(()=>[Ve(Ne.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[Zn,!Y.value]]),Ne.filterable?fn((ee(),We(y(ac),{key:0,ref_key:"suggestionPanel",ref:P,tag:"ul",class:ne(y(v).e("suggestion-panel")),"view-class":y(v).e("suggestion-list"),onKeydown:sn},{default:Ae(()=>[oe.value.length?(ee(!0),ge(Ht,{key:0},Un(oe.value,ke=>(ee(),ge("li",{key:ke.uid,class:ne([y(v).e("suggestion-item"),y(v).is("checked",ke.checked)]),tabindex:-1,onClick:ot=>Yt(ke)},[Ve(Ne.$slots,"suggestion-item",{item:ke},()=>[Ee("span",null,mt(ke.text),1),ke.checked?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[Me(y(sI))]),_:1})):$e("v-if",!0)])],10,["onClick"]))),128)):Ve(Ne.$slots,"empty",{key:1},()=>[Ee("li",{class:ne(y(v).e("empty-text"))},mt(y(b)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Zn,Y.value]]):$e("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var JSe=vt(YSe,[["__file","cascader.vue"]]);const XSe=un(JSe),ZSe=pt({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),QSe={"update:checked":e=>vo(e),[wn]:e=>vo(e)},eEe=Te({name:"ElCheckTag"}),tEe=Te({...eEe,props:ZSe,emits:QSe,setup(e,{emit:t}){const o=e,i=ut("check-tag"),c=z(()=>o.disabled),u=z(()=>[i.b(),i.is("checked",o.checked),i.is("disabled",c.value),i.m(o.type||"primary")]),f=()=>{if(c.value)return;const p=!o.checked;t(wn,p),t("update:checked",p)};return(p,v)=>(ee(),ge("span",{class:ne(y(u)),onClick:f},[Ve(p.$slots,"default")],2))}});var nEe=vt(tEe,[["__file","check-tag.vue"]]);const oEe=un(nEe),rEe=pt({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Ue([Number,Object]),default:()=>sr({})},sm:{type:Ue([Number,Object]),default:()=>sr({})},md:{type:Ue([Number,Object]),default:()=>sr({})},lg:{type:Ue([Number,Object]),default:()=>sr({})},xl:{type:Ue([Number,Object]),default:()=>sr({})}}),g9=Symbol("rowContextKey"),iEe=Te({name:"ElCol"}),aEe=Te({...iEe,props:rEe,setup(e){const t=e,{gutter:o}=Rt(g9,{gutter:z(()=>0)}),i=ut("col"),c=z(()=>{const f={};return o.value&&(f.paddingLeft=f.paddingRight=`${o.value/2}px`),f}),u=z(()=>{const f=[];return["span","offset","pull","push"].forEach(_=>{const b=t[_];jt(b)&&(_==="span"?f.push(i.b(`${t[_]}`)):b>0&&f.push(i.b(`${_}-${t[_]}`)))}),["xs","sm","md","lg","xl"].forEach(_=>{jt(t[_])?f.push(i.b(`${_}-${t[_]}`)):gn(t[_])&&Object.entries(t[_]).forEach(([b,S])=>{f.push(b!=="span"?i.b(`${_}-${b}-${S}`):i.b(`${_}-${S}`))})}),o.value&&f.push(i.is("guttered")),[i.b(),f]});return(f,p)=>(ee(),We(Tn(f.tag),{class:ne(y(u)),style:qt(y(c))},{default:Ae(()=>[Ve(f.$slots,"default")]),_:3},8,["class","style"]))}});var sEe=vt(aEe,[["__file","col.vue"]]);const lEe=un(sEe),SB=e=>jt(e)||Ut(e)||ht(e),cEe=pt({accordion:Boolean,modelValue:{type:Ue([Array,String,Number]),default:()=>sr([])}}),uEe={[nn]:SB,[wn]:SB},v9=Symbol("collapseContextKey"),dEe=(e,t)=>{const o=le(Wi(e.modelValue)),i=u=>{o.value=u;const f=e.accordion?o.value[0]:o.value;t(nn,f),t(wn,f)},c=u=>{if(e.accordion)i([o.value[0]===u?"":u]);else{const f=[...o.value],p=f.indexOf(u);p>-1?f.splice(p,1):f.push(u),i(f)}};return st(()=>e.modelValue,()=>o.value=Wi(e.modelValue),{deep:!0}),Nn(v9,{activeNames:o,handleItemClick:c}),{activeNames:o,setActiveNames:i}},hEe=()=>{const e=ut("collapse");return{rootKls:z(()=>e.b())}},fEe=Te({name:"ElCollapse"}),pEe=Te({...fEe,props:cEe,emits:uEe,setup(e,{expose:t,emit:o}){const i=e,{activeNames:c,setActiveNames:u}=dEe(i,o),{rootKls:f}=hEe();return t({activeNames:c,setActiveNames:u}),(p,v)=>(ee(),ge("div",{class:ne(y(f))},[Ve(p.$slots,"default")],2))}});var mEe=vt(pEe,[["__file","collapse.vue"]]);const gEe=Te({name:"ElCollapseTransition"}),vEe=Te({...gEe,setup(e){const t=ut("collapse-transition"),o=c=>{c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom},i={beforeEnter(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.style.height&&(c.dataset.elExistsHeight=c.style.height),c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0},enter(c){requestAnimationFrame(()=>{c.dataset.oldOverflow=c.style.overflow,c.dataset.elExistsHeight?c.style.maxHeight=c.dataset.elExistsHeight:c.scrollHeight!==0?c.style.maxHeight=`${c.scrollHeight}px`:c.style.maxHeight=0,c.style.paddingTop=c.dataset.oldPaddingTop,c.style.paddingBottom=c.dataset.oldPaddingBottom,c.style.overflow="hidden"})},afterEnter(c){c.style.maxHeight="",c.style.overflow=c.dataset.oldOverflow},enterCancelled(c){o(c)},beforeLeave(c){c.dataset||(c.dataset={}),c.dataset.oldPaddingTop=c.style.paddingTop,c.dataset.oldPaddingBottom=c.style.paddingBottom,c.dataset.oldOverflow=c.style.overflow,c.style.maxHeight=`${c.scrollHeight}px`,c.style.overflow="hidden"},leave(c){c.scrollHeight!==0&&(c.style.maxHeight=0,c.style.paddingTop=0,c.style.paddingBottom=0)},afterLeave(c){o(c)},leaveCancelled(c){o(c)}};return(c,u)=>(ee(),We(Zr,An({name:y(t).b()},mse(i)),{default:Ae(()=>[Ve(c.$slots,"default")]),_:3},16,["name"]))}});var _Ee=vt(vEe,[["__file","collapse-transition.vue"]]);const KT=un(_Ee),yEe=pt({title:{type:String,default:""},name:{type:Ue([String,Number]),default:void 0},icon:{type:ho,default:ca},disabled:Boolean}),IEe=e=>{const t=Rt(v9),{namespace:o}=ut("collapse"),i=le(!1),c=le(!1),u=cN(),f=z(()=>u.current++),p=z(()=>{var k;return(k=e.name)!=null?k:`${o.value}-id-${u.prefix}-${y(f)}`}),v=z(()=>t==null?void 0:t.activeNames.value.includes(y(p)));return{focusing:i,id:f,isActive:v,handleFocus:()=>{setTimeout(()=>{c.value?c.value=!1:i.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(p)),i.value=!1,c.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(p))}}},bEe=(e,{focusing:t,isActive:o,id:i})=>{const c=ut("collapse"),u=z(()=>[c.b("item"),c.is("active",y(o)),c.is("disabled",e.disabled)]),f=z(()=>[c.be("item","header"),c.is("active",y(o)),{focusing:y(t)&&!e.disabled}]),p=z(()=>[c.be("item","arrow"),c.is("active",y(o))]),v=z(()=>c.be("item","wrap")),_=z(()=>c.be("item","content")),b=z(()=>c.b(`content-${y(i)}`)),S=z(()=>c.b(`head-${y(i)}`));return{arrowKls:p,headKls:f,rootKls:u,itemWrapperKls:v,itemContentKls:_,scopedContentId:b,scopedHeadId:S}},CEe=Te({name:"ElCollapseItem"}),SEe=Te({...CEe,props:yEe,setup(e,{expose:t}){const o=e,{focusing:i,id:c,isActive:u,handleFocus:f,handleHeaderClick:p,handleEnterClick:v}=IEe(o),{arrowKls:_,headKls:b,rootKls:S,itemWrapperKls:k,itemContentKls:M,scopedContentId:R,scopedHeadId:w}=bEe(o,{focusing:i,isActive:u,id:c});return t({isActive:u}),(E,N)=>(ee(),ge("div",{class:ne(y(S))},[Ee("button",{id:y(w),class:ne(y(b)),"aria-expanded":y(u),"aria-controls":y(R),"aria-describedby":y(R),tabindex:E.disabled?-1:0,type:"button",onClick:y(p),onKeydown:To(Zt(y(v),["stop","prevent"]),["space","enter"]),onFocus:y(f),onBlur:F=>i.value=!1},[Ve(E.$slots,"title",{},()=>[Mn(mt(E.title),1)]),Ve(E.$slots,"icon",{isActive:y(u)},()=>[Me(y(Pt),{class:ne(y(_))},{default:Ae(()=>[(ee(),We(Tn(E.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),Me(y(KT),null,{default:Ae(()=>[fn(Ee("div",{id:y(R),role:"region",class:ne(y(k)),"aria-hidden":!y(u),"aria-labelledby":y(w)},[Ee("div",{class:ne(y(M))},[Ve(E.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Zn,y(u)]])]),_:3})],2))}});var _9=vt(SEe,[["__file","collapse-item.vue"]]);const EEe=un(mEe,{CollapseItem:_9}),TEe=lr(_9),MEe=pt({color:{type:Ue(Object),required:!0},vertical:{type:Boolean,default:!1}});let nD=!1;function x0(e,t){if(!$n)return;const o=function(u){var f;(f=t.drag)==null||f.call(t,u)},i=function(u){var f;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",i),document.onselectstart=null,document.ondragstart=null,nD=!1,(f=t.end)==null||f.call(t,u)},c=function(u){var f;nD||(u.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",i),document.addEventListener("touchmove",o),document.addEventListener("touchend",i),nD=!0,(f=t.start)==null||f.call(t,u))};e.addEventListener("mousedown",c),e.addEventListener("touchstart",c,{passive:!1})}const kEe=(e,t)=>{if(!$n||!e||!t)return!1;const o=e.getBoundingClientRect();let i;return t instanceof Element?i=t.getBoundingClientRect():i={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},o.top<i.bottom&&o.bottom>i.top&&o.right>i.left&&o.left<i.right},EB=e=>{let t=0,o=e;for(;o;)t+=o.offsetTop,o=o.offsetParent;return t},iO=(e,t)=>Math.abs(EB(e)-EB(t)),kN=e=>{let t,o;return e.type==="touchend"?(o=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(o=e.touches[0].clientY,t=e.touches[0].clientX):(o=e.clientY,t=e.clientX),{clientX:t,clientY:o}},wEe=e=>{const t=kn(),{t:o}=Kn(),i=Go(),c=Go(),u=z(()=>e.color.get("alpha")),f=z(()=>o("el.colorpicker.alphaLabel"));function p(S){var k;S.target!==i.value&&v(S),(k=i.value)==null||k.focus()}function v(S){if(!c.value||!i.value)return;const M=t.vnode.el.getBoundingClientRect(),{clientX:R,clientY:w}=kN(S);if(e.vertical){let E=w-M.top;E=Math.max(i.value.offsetHeight/2,E),E=Math.min(E,M.height-i.value.offsetHeight/2),e.color.set("alpha",Math.round((E-i.value.offsetHeight/2)/(M.height-i.value.offsetHeight)*100))}else{let E=R-M.left;E=Math.max(i.value.offsetWidth/2,E),E=Math.min(E,M.width-i.value.offsetWidth/2),e.color.set("alpha",Math.round((E-i.value.offsetWidth/2)/(M.width-i.value.offsetWidth)*100))}}function _(S){const{code:k,shiftKey:M}=S,R=M?10:1;switch(k){case At.left:case At.down:S.preventDefault(),S.stopPropagation(),b(-R);break;case At.right:case At.up:S.preventDefault(),S.stopPropagation(),b(R);break}}function b(S){let k=u.value+S;k=k<0?0:k>100?100:k,e.color.set("alpha",k)}return{thumb:i,bar:c,alpha:u,alphaLabel:f,handleDrag:v,handleClick:p,handleKeydown:_}},REe=(e,{bar:t,thumb:o,handleDrag:i})=>{const c=kn(),u=ut("color-alpha-slider"),f=le(0),p=le(0),v=le();function _(){if(!o.value||e.vertical)return 0;const F=c.vnode.el,x=e.color.get("alpha");return F?Math.round(x*(F.offsetWidth-o.value.offsetWidth/2)/100):0}function b(){if(!o.value)return 0;const F=c.vnode.el;if(!e.vertical)return 0;const x=e.color.get("alpha");return F?Math.round(x*(F.offsetHeight-o.value.offsetHeight/2)/100):0}function S(){if(e.color&&e.color.value){const{r:F,g:x,b:P}=e.color.toRgb();return`linear-gradient(to right, rgba(${F}, ${x}, ${P}, 0) 0%, rgba(${F}, ${x}, ${P}, 1) 100%)`}return""}function k(){f.value=_(),p.value=b(),v.value=S()}mn(()=>{if(!t.value||!o.value)return;const F={drag:x=>{i(x)},end:x=>{i(x)}};x0(t.value,F),x0(o.value,F),k()}),st(()=>e.color.get("alpha"),()=>k()),st(()=>e.color.value,()=>k());const M=z(()=>[u.b(),u.is("vertical",e.vertical)]),R=z(()=>u.e("bar")),w=z(()=>u.e("thumb")),E=z(()=>({background:v.value})),N=z(()=>({left:ur(f.value),top:ur(p.value)}));return{rootKls:M,barKls:R,barStyle:E,thumbKls:w,thumbStyle:N,update:k}},AEe="ElColorAlphaSlider",DEe=Te({name:AEe}),OEe=Te({...DEe,props:MEe,setup(e,{expose:t}){const o=e,{alpha:i,alphaLabel:c,bar:u,thumb:f,handleDrag:p,handleClick:v,handleKeydown:_}=wEe(o),{rootKls:b,barKls:S,barStyle:k,thumbKls:M,thumbStyle:R,update:w}=REe(o,{bar:u,thumb:f,handleDrag:p});return t({update:w,bar:u,thumb:f}),(E,N)=>(ee(),ge("div",{class:ne(y(b))},[Ee("div",{ref_key:"bar",ref:u,class:ne(y(S)),style:qt(y(k)),onClick:y(v)},null,14,["onClick"]),Ee("div",{ref_key:"thumb",ref:f,class:ne(y(M)),style:qt(y(R)),"aria-label":y(c),"aria-valuenow":y(i),"aria-orientation":E.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:y(_)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var LEe=vt(OEe,[["__file","alpha-slider.vue"]]);const NEe=Te({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=ut("color-hue-slider"),o=kn(),i=le(),c=le(),u=le(0),f=le(0),p=z(()=>e.color.get("hue"));st(()=>p.value,()=>{k()});function v(M){M.target!==i.value&&_(M)}function _(M){if(!c.value||!i.value)return;const w=o.vnode.el.getBoundingClientRect(),{clientX:E,clientY:N}=kN(M);let F;if(e.vertical){let x=N-w.top;x=Math.min(x,w.height-i.value.offsetHeight/2),x=Math.max(i.value.offsetHeight/2,x),F=Math.round((x-i.value.offsetHeight/2)/(w.height-i.value.offsetHeight)*360)}else{let x=E-w.left;x=Math.min(x,w.width-i.value.offsetWidth/2),x=Math.max(i.value.offsetWidth/2,x),F=Math.round((x-i.value.offsetWidth/2)/(w.width-i.value.offsetWidth)*360)}e.color.set("hue",F)}function b(){if(!i.value)return 0;const M=o.vnode.el;if(e.vertical)return 0;const R=e.color.get("hue");return M?Math.round(R*(M.offsetWidth-i.value.offsetWidth/2)/360):0}function S(){if(!i.value)return 0;const M=o.vnode.el;if(!e.vertical)return 0;const R=e.color.get("hue");return M?Math.round(R*(M.offsetHeight-i.value.offsetHeight/2)/360):0}function k(){u.value=b(),f.value=S()}return mn(()=>{if(!c.value||!i.value)return;const M={drag:R=>{_(R)},end:R=>{_(R)}};x0(c.value,M),x0(i.value,M),k()}),{bar:c,thumb:i,thumbLeft:u,thumbTop:f,hueValue:p,handleClick:v,update:k,ns:t}}});function PEe(e,t,o,i,c,u){return ee(),ge("div",{class:ne([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ee("div",{ref:"bar",class:ne(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),Ee("div",{ref:"thumb",class:ne(e.ns.e("thumb")),style:qt({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var xEe=vt(NEe,[["render",PEe],["__file","hue-slider.vue"]]);const UEe=pt({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Kr,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Ur.teleported,predefine:{type:Ue(Array)},validateEvent:{type:Boolean,default:!0},...Ci(["ariaLabel"])}),FEe={[nn]:e=>Ut(e)||oi(e),[wn]:e=>Ut(e)||oi(e),activeChange:e=>Ut(e)||oi(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},y9=Symbol("colorPickerContextKey"),TB=function(e,t,o){return[e,t*o/((e=(2-t)*o)<1?e:2-e)||0,e/2]},VEe=function(e){return Ut(e)&&e.includes(".")&&Number.parseFloat(e)===1},GEe=function(e){return Ut(e)&&e.includes("%")},Lg=function(e,t){VEe(e)&&(e="100%");const o=GEe(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),o&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},MB={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},hE=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),o=e%16;return`${MB[t]||t}${MB[o]||o}`},kB=function({r:e,g:t,b:o}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+o)?"":`#${hE(e)}${hE(t)}${hE(o)}`},oD={A:10,B:11,C:12,D:13,E:14,F:15},Rf=function(e){return e.length===2?(oD[e[0].toUpperCase()]||+e[0])*16+(oD[e[1].toUpperCase()]||+e[1]):oD[e[1].toUpperCase()]||+e[1]},BEe=function(e,t,o){t=t/100,o=o/100;let i=t;const c=Math.max(o,.01);o*=2,t*=o<=1?o:2-o,i*=c<=1?c:2-c;const u=(o+t)/2,f=o===0?2*i/(c+i):2*t/(o+t);return{h:e,s:f*100,v:u*100}},wB=(e,t,o)=>{e=Lg(e,255),t=Lg(t,255),o=Lg(o,255);const i=Math.max(e,t,o),c=Math.min(e,t,o);let u;const f=i,p=i-c,v=i===0?0:p/i;if(i===c)u=0;else{switch(i){case e:{u=(t-o)/p+(t<o?6:0);break}case t:{u=(o-e)/p+2;break}case o:{u=(e-t)/p+4;break}}u/=6}return{h:u*360,s:v*100,v:f*100}},Ly=function(e,t,o){e=Lg(e,360)*6,t=Lg(t,100),o=Lg(o,100);const i=Math.floor(e),c=e-i,u=o*(1-t),f=o*(1-c*t),p=o*(1-(1-c)*t),v=i%6,_=[o,f,u,u,p,o][v],b=[p,o,o,f,u,u][v],S=[u,u,p,o,o,f][v];return{r:Math.round(_*255),g:Math.round(b*255),b:Math.round(S*255)}};class c0{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in t)jn(t,o)&&(this[o]=t[o]);t.value?this.fromString(t.value):this.doOnChange()}set(t,o){if(arguments.length===1&&typeof t=="object"){for(const i in t)jn(t,i)&&this.set(i,t[i]);return}this[`_${t}`]=o,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Ly(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(i,c,u)=>{this._hue=Math.max(0,Math.min(360,i)),this._saturation=Math.max(0,Math.min(100,c)),this._value=Math.max(0,Math.min(100,u)),this.doOnChange()};if(t.includes("hsl")){const i=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));if(i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3){const{h:c,s:u,v:f}=BEe(i[0],i[1],i[2]);o(c,u,f)}}else if(t.includes("hsv")){const i=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3&&o(i[0],i[1],i[2])}else if(t.includes("rgb")){const i=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(c=>c!=="").map((c,u)=>u>2?Number.parseFloat(c):Number.parseInt(c,10));if(i.length===4?this._alpha=Number.parseFloat(i[3])*100:i.length===3&&(this._alpha=100),i.length>=3){const{h:c,s:u,v:f}=wB(i[0],i[1],i[2]);o(c,u,f)}}else if(t.includes("#")){const i=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(i))return;let c,u,f;i.length===3?(c=Rf(i[0]+i[0]),u=Rf(i[1]+i[1]),f=Rf(i[2]+i[2])):(i.length===6||i.length===8)&&(c=Rf(i.slice(0,2)),u=Rf(i.slice(2,4)),f=Rf(i.slice(4,6))),i.length===8?this._alpha=Rf(i.slice(6))/255*100:(i.length===3||i.length===6)&&(this._alpha=100);const{h:p,s:v,v:_}=wB(c,u,f);o(p,v,_)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:o,_value:i,_alpha:c,format:u}=this;if(this.enableAlpha)switch(u){case"hsl":{const f=TB(t,o/100,i/100);this.value=`hsla(${t}, ${Math.round(f[1]*100)}%, ${Math.round(f[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(o)}%, ${Math.round(i)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${kB(Ly(t,o,i))}${hE(c*255/100)}`;break}default:{const{r:f,g:p,b:v}=Ly(t,o,i);this.value=`rgba(${f}, ${p}, ${v}, ${this.get("alpha")/100})`}}else switch(u){case"hsl":{const f=TB(t,o/100,i/100);this.value=`hsl(${t}, ${Math.round(f[1]*100)}%, ${Math.round(f[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(o)}%, ${Math.round(i)}%)`;break}case"rgb":{const{r:f,g:p,b:v}=Ly(t,o,i);this.value=`rgb(${f}, ${p}, ${v})`;break}default:this.value=kB(Ly(t,o,i))}}}const HEe=Te({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=ut("color-predefine"),{currentColor:o}=Rt(y9),i=le(u(e.colors,e.color));st(()=>o.value,f=>{const p=new c0;p.fromString(f),i.value.forEach(v=>{v.selected=p.compare(v)})}),Di(()=>{i.value=u(e.colors,e.color)});function c(f){e.color.fromString(e.colors[f])}function u(f,p){return f.map(v=>{const _=new c0;return _.enableAlpha=e.enableAlpha,_.format="rgba",_.fromString(v),_.selected=_.value===p.value,_})}return{rgbaColors:i,handleSelect:c,ns:t}}});function $Ee(e,t,o,i,c,u){return ee(),ge("div",{class:ne(e.ns.b())},[Ee("div",{class:ne(e.ns.e("colors"))},[(ee(!0),ge(Ht,null,Un(e.rgbaColors,(f,p)=>(ee(),ge("div",{key:e.colors[p],class:ne([e.ns.e("color-selector"),e.ns.is("alpha",f._alpha<100),{selected:f.selected}]),onClick:v=>e.handleSelect(p)},[Ee("div",{style:qt({backgroundColor:f.value})},null,4)],10,["onClick"]))),128))],2)],2)}var qEe=vt(HEe,[["render",$Ee],["__file","predefine.vue"]]);const KEe=Te({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=ut("color-svpanel"),o=kn(),i=le(0),c=le(0),u=le("hsl(0, 100%, 50%)"),f=z(()=>{const _=e.color.get("hue"),b=e.color.get("value");return{hue:_,value:b}});function p(){const _=e.color.get("saturation"),b=e.color.get("value"),S=o.vnode.el,{clientWidth:k,clientHeight:M}=S;c.value=_*k/100,i.value=(100-b)*M/100,u.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function v(_){const S=o.vnode.el.getBoundingClientRect(),{clientX:k,clientY:M}=kN(_);let R=k-S.left,w=M-S.top;R=Math.max(0,R),R=Math.min(R,S.width),w=Math.max(0,w),w=Math.min(w,S.height),c.value=R,i.value=w,e.color.set({saturation:R/S.width*100,value:100-w/S.height*100})}return st(()=>f.value,()=>{p()}),mn(()=>{x0(o.vnode.el,{drag:_=>{v(_)},end:_=>{v(_)}}),p()}),{cursorTop:i,cursorLeft:c,background:u,colorValue:f,handleDrag:v,update:p,ns:t}}});function zEe(e,t,o,i,c,u){return ee(),ge("div",{class:ne(e.ns.b()),style:qt({backgroundColor:e.background})},[Ee("div",{class:ne(e.ns.e("white"))},null,2),Ee("div",{class:ne(e.ns.e("black"))},null,2),Ee("div",{class:ne(e.ns.e("cursor")),style:qt({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[Ee("div")],6)],6)}var WEe=vt(KEe,[["render",zEe],["__file","sv-panel.vue"]]);const jEe=Te({name:"ElColorPicker"}),YEe=Te({...jEe,props:UEe,emits:FEe,setup(e,{expose:t,emit:o}){const i=e,{t:c}=Kn(),u=ut("color"),{formItem:f}=Ni(),p=Fr(),v=Pi(),{inputId:_,isLabeledByFormItem:b}=Ps(i,{formItemContext:f}),S=le(),k=le(),M=le(),R=le(),w=le(),E=le(),{isFocused:N,handleFocus:F,handleBlur:x}=ah(w,{beforeFocus(){return v.value},beforeBlur(Le){var rt;return(rt=R.value)==null?void 0:rt.isFocusInsideContent(Le)},afterBlur(){ie(!1),X()}});let P=!0;const G=eo(new c0({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue})),H=le(!1),Y=le(!1),j=le(""),W=z(()=>!i.modelValue&&!Y.value?"transparent":pe(G,i.showAlpha)),O=z(()=>!i.modelValue&&!Y.value?"":G.value),Q=z(()=>b.value?void 0:i.ariaLabel||c("el.colorpicker.defaultLabel")),J=z(()=>b.value?f==null?void 0:f.labelId:void 0),oe=z(()=>[u.b("picker"),u.is("disabled",v.value),u.bm("picker",p.value),u.is("focused",N.value)]);function pe(Le,rt){if(!(Le instanceof c0))throw new TypeError("color should be instance of _color Class");const{r:Qe,g:Ge,b:_e}=Le.toRgb();return rt?`rgba(${Qe}, ${Ge}, ${_e}, ${Le.get("alpha")/100})`:`rgb(${Qe}, ${Ge}, ${_e})`}function ie(Le){H.value=Le}const te=Oa(ie,100,{leading:!0});function he(){v.value||ie(!0)}function re(){te(!1),X()}function X(){Vt(()=>{i.modelValue?G.fromString(i.modelValue):(G.value="",Vt(()=>{Y.value=!1}))})}function ye(){v.value||(H.value&&X(),te(!H.value))}function ue(){G.fromString(j.value)}function Ie(){const Le=G.value;o(nn,Le),o(wn,Le),i.validateEvent&&(f==null||f.validate("change").catch(rt=>void 0)),te(!1),Vt(()=>{const rt=new c0({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue});G.compare(rt)||X()})}function ve(){te(!1),o(nn,null),o(wn,null),i.modelValue!==null&&i.validateEvent&&(f==null||f.validate("change").catch(Le=>void 0)),X()}function Ce(){H.value&&(re(),N.value&&be())}function Fe(Le){Le.preventDefault(),Le.stopPropagation(),ie(!1),X()}function Oe(Le){switch(Le.code){case At.enter:case At.numpadEnter:case At.space:Le.preventDefault(),Le.stopPropagation(),he(),E.value.focus();break;case At.esc:Fe(Le);break}}function be(){w.value.focus()}function xe(){w.value.blur()}return mn(()=>{i.modelValue&&(j.value=O.value)}),st(()=>i.modelValue,Le=>{Le?Le&&Le!==G.value&&(P=!1,G.fromString(Le)):Y.value=!1}),st(()=>[i.colorFormat,i.showAlpha],()=>{G.enableAlpha=i.showAlpha,G.format=i.colorFormat||G.format,G.doOnChange(),o(nn,G.value)}),st(()=>O.value,Le=>{j.value=Le,P&&o("activeChange",Le),P=!0}),st(()=>G.value,()=>{!i.modelValue&&!Y.value&&(Y.value=!0)}),st(()=>H.value,()=>{Vt(()=>{var Le,rt,Qe;(Le=S.value)==null||Le.update(),(rt=k.value)==null||rt.update(),(Qe=M.value)==null||Qe.update()})}),Nn(y9,{currentColor:O}),t({color:G,show:he,hide:re,focus:be,blur:xe}),(Le,rt)=>(ee(),We(y(Li),{ref_key:"popper",ref:R,visible:H.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(u).be("picker","panel"),y(u).b("dropdown"),Le.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Le.teleported,transition:`${y(u).namespace.value}-zoom-in-top`,persistent:"",onHide:Qe=>ie(!1)},{content:Ae(()=>[fn((ee(),ge("div",{onKeydown:To(Fe,["esc"])},[Ee("div",{class:ne(y(u).be("dropdown","main-wrapper"))},[Me(xEe,{ref_key:"hue",ref:S,class:"hue-slider",color:y(G),vertical:""},null,8,["color"]),Me(WEe,{ref_key:"sv",ref:k,color:y(G)},null,8,["color"])],2),Le.showAlpha?(ee(),We(LEe,{key:0,ref_key:"alpha",ref:M,color:y(G)},null,8,["color"])):$e("v-if",!0),Le.predefine?(ee(),We(qEe,{key:1,ref:"predefine","enable-alpha":Le.showAlpha,color:y(G),colors:Le.predefine},null,8,["enable-alpha","color","colors"])):$e("v-if",!0),Ee("div",{class:ne(y(u).be("dropdown","btns"))},[Ee("span",{class:ne(y(u).be("dropdown","value"))},[Me(y(Yi),{ref_key:"inputRef",ref:E,modelValue:j.value,"onUpdate:modelValue":Qe=>j.value=Qe,"validate-event":!1,size:"small",onKeyup:To(ue,["enter"]),onBlur:ue},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Me(y(di),{class:ne(y(u).be("dropdown","link-btn")),text:"",size:"small",onClick:ve},{default:Ae(()=>[Mn(mt(y(c)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Me(y(di),{plain:"",size:"small",class:ne(y(u).be("dropdown","btn")),onClick:Ie},{default:Ae(()=>[Mn(mt(y(c)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[y(lu),Ce,w.value]])]),default:Ae(()=>[Ee("div",An({id:y(_),ref_key:"triggerRef",ref:w},Le.$attrs,{class:y(oe),role:"button","aria-label":y(Q),"aria-labelledby":y(J),"aria-description":y(c)("el.colorpicker.description",{color:Le.modelValue||""}),"aria-disabled":y(v),tabindex:y(v)?void 0:Le.tabindex,onKeydown:Oe,onFocus:y(F),onBlur:y(x)}),[y(v)?(ee(),ge("div",{key:0,class:ne(y(u).be("picker","mask"))},null,2)):$e("v-if",!0),Ee("div",{class:ne(y(u).be("picker","trigger")),onClick:ye},[Ee("span",{class:ne([y(u).be("picker","color"),y(u).is("alpha",Le.showAlpha)])},[Ee("span",{class:ne(y(u).be("picker","color-inner")),style:qt({backgroundColor:y(W)})},[fn(Me(y(Pt),{class:ne([y(u).be("picker","icon"),y(u).is("icon-arrow-down")])},{default:Ae(()=>[Me(y(fu))]),_:1},8,["class"]),[[Zn,Le.modelValue||Y.value]]),fn(Me(y(Pt),{class:ne([y(u).be("picker","empty"),y(u).is("icon-close")])},{default:Ae(()=>[Me(y(As))]),_:1},8,["class"]),[[Zn,!Le.modelValue&&!Y.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var JEe=vt(YEe,[["__file","color-picker.vue"]]);const XEe=un(JEe),ZEe=pt({a11y:{type:Boolean,default:!0},locale:{type:Ue(Object)},size:Kr,button:{type:Ue(Object)},experimentalFeatures:{type:Ue(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:Ue(Object)},zIndex:Number,namespace:{type:String,default:"el"},...mv}),nl={},QEe=Te({name:"ElConfigProvider",props:ZEe,setup(e,{slots:t}){st(()=>e.message,i=>{Object.assign(nl,i??{})},{immediate:!0,deep:!0});const o=eN(e);return()=>Ve(t,"default",{config:o==null?void 0:o.value})}}),eTe=un(QEe),tTe=Te({name:"ElContainer"}),nTe=Te({...tTe,props:{direction:{type:String}},setup(e){const t=e,o=Qr(),i=ut("container"),c=z(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:o&&o.default?o.default().some(f=>{const p=f.type.name;return p==="ElHeader"||p==="ElFooter"}):!1);return(u,f)=>(ee(),ge("section",{class:ne([y(i).b(),y(i).is("vertical",y(c))])},[Ve(u.$slots,"default")],2))}});var oTe=vt(nTe,[["__file","container.vue"]]);const rTe=Te({name:"ElAside"}),iTe=Te({...rTe,props:{width:{type:String,default:null}},setup(e){const t=e,o=ut("aside"),i=z(()=>t.width?o.cssVarBlock({width:t.width}):{});return(c,u)=>(ee(),ge("aside",{class:ne(y(o).b()),style:qt(y(i))},[Ve(c.$slots,"default")],6))}});var I9=vt(iTe,[["__file","aside.vue"]]);const aTe=Te({name:"ElFooter"}),sTe=Te({...aTe,props:{height:{type:String,default:null}},setup(e){const t=e,o=ut("footer"),i=z(()=>t.height?o.cssVarBlock({height:t.height}):{});return(c,u)=>(ee(),ge("footer",{class:ne(y(o).b()),style:qt(y(i))},[Ve(c.$slots,"default")],6))}});var b9=vt(sTe,[["__file","footer.vue"]]);const lTe=Te({name:"ElHeader"}),cTe=Te({...lTe,props:{height:{type:String,default:null}},setup(e){const t=e,o=ut("header"),i=z(()=>t.height?o.cssVarBlock({height:t.height}):{});return(c,u)=>(ee(),ge("header",{class:ne(y(o).b()),style:qt(y(i))},[Ve(c.$slots,"default")],6))}});var C9=vt(cTe,[["__file","header.vue"]]);const uTe=Te({name:"ElMain"}),dTe=Te({...uTe,setup(e){const t=ut("main");return(o,i)=>(ee(),ge("main",{class:ne(y(t).b())},[Ve(o.$slots,"default")],2))}});var S9=vt(dTe,[["__file","main.vue"]]);const hTe=un(oTe,{Aside:I9,Footer:b9,Header:C9,Main:S9}),fTe=lr(I9),pTe=lr(b9),mTe=lr(C9),gTe=lr(S9);var E9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},i=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,c=/\d/,u=/\d\d/,f=/\d\d?/,p=/\d*[^-_:/,()\s\d]+/,v={},_=function(E){return(E=+E)+(E>68?1900:2e3)},b=function(E){return function(N){this[E]=+N}},S=[/[+-]\d\d:?(\d\d)?|Z/,function(E){(this.zone||(this.zone={})).offset=function(N){if(!N||N==="Z")return 0;var F=N.match(/([+-]|\d\d)/g),x=60*F[1]+(+F[2]||0);return x===0?0:F[0]==="+"?-x:x}(E)}],k=function(E){var N=v[E];return N&&(N.indexOf?N:N.s.concat(N.f))},M=function(E,N){var F,x=v.meridiem;if(x){for(var P=1;P<=24;P+=1)if(E.indexOf(x(P,0,N))>-1){F=P>12;break}}else F=E===(N?"pm":"PM");return F},R={A:[p,function(E){this.afternoon=M(E,!1)}],a:[p,function(E){this.afternoon=M(E,!0)}],Q:[c,function(E){this.month=3*(E-1)+1}],S:[c,function(E){this.milliseconds=100*+E}],SS:[u,function(E){this.milliseconds=10*+E}],SSS:[/\d{3}/,function(E){this.milliseconds=+E}],s:[f,b("seconds")],ss:[f,b("seconds")],m:[f,b("minutes")],mm:[f,b("minutes")],H:[f,b("hours")],h:[f,b("hours")],HH:[f,b("hours")],hh:[f,b("hours")],D:[f,b("day")],DD:[u,b("day")],Do:[p,function(E){var N=v.ordinal,F=E.match(/\d+/);if(this.day=F[0],N)for(var x=1;x<=31;x+=1)N(x).replace(/\[|\]/g,"")===E&&(this.day=x)}],w:[f,b("week")],ww:[u,b("week")],M:[f,b("month")],MM:[u,b("month")],MMM:[p,function(E){var N=k("months"),F=(k("monthsShort")||N.map(function(x){return x.slice(0,3)})).indexOf(E)+1;if(F<1)throw new Error;this.month=F%12||F}],MMMM:[p,function(E){var N=k("months").indexOf(E)+1;if(N<1)throw new Error;this.month=N%12||N}],Y:[/[+-]?\d+/,b("year")],YY:[u,function(E){this.year=_(E)}],YYYY:[/\d{4}/,b("year")],Z:S,ZZ:S};function w(E){var N,F;N=E,F=v&&v.formats;for(var x=(E=N.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(O,Q,J){var oe=J&&J.toUpperCase();return Q||F[J]||o[J]||F[oe].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(pe,ie,te){return ie||te.slice(1)})})).match(i),P=x.length,G=0;G<P;G+=1){var H=x[G],Y=R[H],j=Y&&Y[0],W=Y&&Y[1];x[G]=W?{regex:j,parser:W}:H.replace(/^\[|\]$/g,"")}return function(O){for(var Q={},J=0,oe=0;J<P;J+=1){var pe=x[J];if(typeof pe=="string")oe+=pe.length;else{var ie=pe.regex,te=pe.parser,he=O.slice(oe),re=ie.exec(he)[0];te.call(Q,re),O=O.replace(re,"")}}return function(X){var ye=X.afternoon;if(ye!==void 0){var ue=X.hours;ye?ue<12&&(X.hours+=12):ue===12&&(X.hours=0),delete X.afternoon}}(Q),Q}}return function(E,N,F){F.p.customParseFormat=!0,E&&E.parseTwoDigitYear&&(_=E.parseTwoDigitYear);var x=N.prototype,P=x.parse;x.parse=function(G){var H=G.date,Y=G.utc,j=G.args;this.$u=Y;var W=j[1];if(typeof W=="string"){var O=j[2]===!0,Q=j[3]===!0,J=O||Q,oe=j[2];Q&&(oe=j[2]),v=this.$locale(),!O&&oe&&(v=F.Ls[oe]),this.$d=function(he,re,X,ye){try{if(["x","X"].indexOf(re)>-1)return new Date((re==="X"?1e3:1)*he);var ue=w(re)(he),Ie=ue.year,ve=ue.month,Ce=ue.day,Fe=ue.hours,Oe=ue.minutes,be=ue.seconds,xe=ue.milliseconds,Le=ue.zone,rt=ue.week,Qe=new Date,Ge=Ce||(Ie||ve?1:Qe.getDate()),_e=Ie||Qe.getFullYear(),Re=0;Ie&&!ve||(Re=ve>0?ve-1:Qe.getMonth());var Ke,je=Fe||0,ze=Oe||0,nt=be||0,it=xe||0;return Le?new Date(Date.UTC(_e,Re,Ge,je,ze,nt,it+60*Le.offset*1e3)):X?new Date(Date.UTC(_e,Re,Ge,je,ze,nt,it)):(Ke=new Date(_e,Re,Ge,je,ze,nt,it),rt&&(Ke=ye(Ke).week(rt).toDate()),Ke)}catch{return new Date("")}}(H,W,Y,F),this.init(),oe&&oe!==!0&&(this.$L=this.locale(oe).$L),J&&H!=this.format(W)&&(this.$d=new Date("")),v={}}else if(W instanceof Array)for(var pe=W.length,ie=1;ie<=pe;ie+=1){j[1]=W[ie-1];var te=F.apply(this,j);if(te.isValid()){this.$d=te.$d,this.$L=te.$L,this.init();break}ie===pe&&(this.$d=new Date(""))}else P.call(this,G)}}})})(E9);var vTe=E9.exports;const wN=Ns(vTe);var T9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i){var c=i.prototype,u=c.format;c.format=function(f){var p=this,v=this.$locale();if(!this.isValid())return u.bind(this)(f);var _=this.$utils(),b=(f||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(S){switch(S){case"Q":return Math.ceil((p.$M+1)/3);case"Do":return v.ordinal(p.$D);case"gggg":return p.weekYear();case"GGGG":return p.isoWeekYear();case"wo":return v.ordinal(p.week(),"W");case"w":case"ww":return _.s(p.week(),S==="w"?1:2,"0");case"W":case"WW":return _.s(p.isoWeek(),S==="W"?1:2,"0");case"k":case"kk":return _.s(String(p.$H===0?24:p.$H),S==="k"?1:2,"0");case"X":return Math.floor(p.$d.getTime()/1e3);case"x":return p.$d.getTime();case"z":return"["+p.offsetName()+"]";case"zzz":return"["+p.offsetName("long")+"]";default:return S}});return u.bind(this)(b)}}})})(T9);var _Te=T9.exports;const yTe=Ns(_Te);var M9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){var o="week",i="year";return function(c,u,f){var p=u.prototype;p.week=function(v){if(v===void 0&&(v=null),v!==null)return this.add(7*(v-this.week()),"day");var _=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var b=f(this).startOf(i).add(1,i).date(_),S=f(this).endOf(o);if(b.isBefore(S))return 1}var k=f(this).startOf(i).date(_).startOf(o).subtract(1,"millisecond"),M=this.diff(k,o,!0);return M<0?f(this).startOf("week").week():Math.ceil(M)},p.weeks=function(v){return v===void 0&&(v=null),this.week(v)}}})})(M9);var ITe=M9.exports;const bTe=Ns(ITe);var k9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i){i.prototype.weekYear=function(){var c=this.month(),u=this.week(),f=this.year();return u===1&&c===11?f+1:c===0&&u>=52?f-1:f}}})})(k9);var CTe=k9.exports;const STe=Ns(CTe);var w9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i,c){i.prototype.dayOfYear=function(u){var f=Math.round((c(this).startOf("day")-c(this).startOf("year"))/864e5)+1;return u==null?f:this.add(u-f,"day")}}})})(w9);var ETe=w9.exports;const TTe=Ns(ETe);var R9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i){i.prototype.isSameOrAfter=function(c,u){return this.isSame(c,u)||this.isAfter(c,u)}}})})(R9);var MTe=R9.exports;const kTe=Ns(MTe);var A9={exports:{}};(function(e,t){(function(o,i){e.exports=i()})(wr,function(){return function(o,i){i.prototype.isSameOrBefore=function(c,u){return this.isSame(c,u)||this.isBefore(c,u)}}})})(A9);var wTe=A9.exports;const RTe=Ns(wTe),RB=["hours","minutes","seconds"],jE="HH:mm:ss",gg="YYYY-MM-DD",ATe={date:gg,dates:gg,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${gg} ${jE}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:gg,datetimerange:`${gg} ${jE}`},D9=pt({disabledHours:{type:Ue(Function)},disabledMinutes:{type:Ue(Function)},disabledSeconds:{type:Ue(Function)}}),O9=pt({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),RN=pt({id:{type:Ue([Array,String])},name:{type:Ue([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:Ue([String,Object]),default:pu},editable:{type:Boolean,default:!0},prefixIcon:{type:Ue([String,Object]),default:""},size:Kr,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:Ue(Object),default:()=>({})},modelValue:{type:Ue([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:Ue([Date,Array])},defaultTime:{type:Ue([Date,Array])},isRange:Boolean,...D9,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:Ue([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:Ue(String),values:mu,default:"bottom"},fallbackPlacements:{type:Ue(Array),default:["bottom","top","right","left"]},...mv,...Ci(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),DTe=pt({id:{type:Ue(Array)},name:{type:Ue(Array)},modelValue:{type:Ue([Array,String])},startPlaceholder:String,endPlaceholder:String,disabled:Boolean}),OTe=Te({name:"PickerRangeTrigger",inheritAttrs:!1}),LTe=Te({...OTe,props:DTe,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:o}){const i=lI(),c=ut("date"),u=ut("range"),f=le(),p=le(),{wrapperRef:v,isFocused:_}=ah(f),b=P=>{o("click",P)},S=P=>{o("mouseenter",P)},k=P=>{o("mouseleave",P)},M=P=>{o("mouseenter",P)},R=P=>{o("startInput",P)},w=P=>{o("endInput",P)},E=P=>{o("startChange",P)},N=P=>{o("endChange",P)};return t({focus:()=>{var P;(P=f.value)==null||P.focus()},blur:()=>{var P,G;(P=f.value)==null||P.blur(),(G=p.value)==null||G.blur()}}),(P,G)=>(ee(),ge("div",{ref_key:"wrapperRef",ref:v,class:ne([y(c).is("active",y(_)),P.$attrs.class]),style:qt(P.$attrs.style),onClick:b,onMouseenter:S,onMouseleave:k,onTouchstartPassive:M},[Ve(P.$slots,"prefix"),Ee("input",An(y(i),{id:P.id&&P.id[0],ref_key:"inputRef",ref:f,name:P.name&&P.name[0],placeholder:P.startPlaceholder,value:P.modelValue&&P.modelValue[0],class:y(u).b("input"),disabled:P.disabled,onInput:R,onChange:E}),null,16,["id","name","placeholder","value","disabled"]),Ve(P.$slots,"range-separator"),Ee("input",An(y(i),{id:P.id&&P.id[1],ref_key:"endInputRef",ref:p,name:P.name&&P.name[1],placeholder:P.endPlaceholder,value:P.modelValue&&P.modelValue[1],class:y(u).b("input"),disabled:P.disabled,onInput:w,onChange:N}),null,16,["id","name","placeholder","value","disabled"]),Ve(P.$slots,"suffix")],38))}});var NTe=vt(LTe,[["__file","picker-range-trigger.vue"]]);const PTe=Te({name:"Picker"}),xTe=Te({...PTe,props:RN,emits:[nn,wn,"focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:o}){const i=e,c=uu(),{lang:u}=Kn(),f=ut("date"),p=ut("input"),v=ut("range"),{form:_,formItem:b}=Ni(),S=Rt("ElPopperOptions",{}),{valueOnClear:k}=PT(i,null),M=le(),R=le(),w=le(!1),E=le(!1),N=le(null);let F=!1;const{isFocused:x,handleFocus:P,handleBlur:G}=ah(R,{beforeFocus(){return i.readonly||X.value},afterFocus(){w.value=!0},beforeBlur(ke){var ot;return!F&&((ot=M.value)==null?void 0:ot.isFocusInsideContent(ke))},afterBlur(){dt(),w.value=!1,F=!1,i.validateEvent&&(b==null||b.validate("blur").catch(ke=>void 0))}}),H=z(()=>[f.b("editor"),f.bm("editor",i.type),p.e("wrapper"),f.is("disabled",X.value),f.is("active",w.value),v.b("editor"),je?v.bm("editor",je.value):"",c.class]),Y=z(()=>[p.e("icon"),v.e("close-icon"),xe.value?"":v.e("close-icon--hidden")]);st(w,ke=>{ke?Vt(()=>{ke&&(N.value=i.modelValue)}):(it.value=null,Vt(()=>{j(i.modelValue)}))});const j=(ke,ot)=>{(ot||!pB(ke,N.value))&&(o(wn,ke),ot&&(N.value=ke),i.validateEvent&&(b==null||b.validate("change").catch(tn=>void 0)))},W=ke=>{if(!pB(i.modelValue,ke)){let ot;ht(ke)?ot=ke.map(tn=>gB(tn,i.valueFormat,u.value)):ke&&(ot=gB(ke,i.valueFormat,u.value)),o(nn,ke&&ot,u.value)}},O=ke=>{o("keydown",ke)},Q=z(()=>R.value?Array.from(R.value.$el.querySelectorAll("input")):[]),J=(ke,ot,tn)=>{const Nt=Q.value;Nt.length&&(!tn||tn==="min"?(Nt[0].setSelectionRange(ke,ot),Nt[0].focus()):tn==="max"&&(Nt[1].setSelectionRange(ke,ot),Nt[1].focus()))},oe=(ke="",ot=!1)=>{w.value=ot;let tn;ht(ke)?tn=ke.map(Nt=>Nt.toDate()):tn=ke&&ke.toDate(),it.value=null,W(tn)},pe=()=>{E.value=!0},ie=()=>{o("visible-change",!0)},te=()=>{E.value=!1,w.value=!1,o("visible-change",!1)},he=()=>{w.value=!0},re=()=>{w.value=!1},X=z(()=>i.disabled||(_==null?void 0:_.disabled)),ye=z(()=>{let ke;if(rt.value?yn.value.getDefaultValue&&(ke=yn.value.getDefaultValue()):ht(i.modelValue)?ke=i.modelValue.map(ot=>mB(ot,i.valueFormat,u.value)):ke=mB(i.modelValue,i.valueFormat,u.value),yn.value.getRangeAvailableTime){const ot=yn.value.getRangeAvailableTime(ke);ui(ot,ke)||(ke=ot,rt.value||W(qS(ke)))}return ht(ke)&&ke.some(ot=>!ot)&&(ke=[]),ke}),ue=z(()=>{if(!yn.value.panelReady)return"";const ke=ft(ye.value);return ht(it.value)?[it.value[0]||ke&&ke[0]||"",it.value[1]||ke&&ke[1]||""]:it.value!==null?it.value:!ve.value&&rt.value||!w.value&&rt.value?"":ke?Ce.value||Fe.value||Oe.value?ke.join(", "):ke:""}),Ie=z(()=>i.type.includes("time")),ve=z(()=>i.type.startsWith("time")),Ce=z(()=>i.type==="dates"),Fe=z(()=>i.type==="months"),Oe=z(()=>i.type==="years"),be=z(()=>i.prefixIcon||(Ie.value?iK:f_e)),xe=le(!1),Le=ke=>{i.readonly||X.value||(xe.value&&(ke.stopPropagation(),yn.value.handleClear?yn.value.handleClear():W(k.value),j(k.value,!0),xe.value=!1,te()),o("clear"))},rt=z(()=>{const{modelValue:ke}=i;return!ke||ht(ke)&&!ke.filter(Boolean).length}),Qe=async ke=>{var ot;i.readonly||X.value||(((ot=ke.target)==null?void 0:ot.tagName)!=="INPUT"||x.value)&&(w.value=!0)},Ge=()=>{i.readonly||X.value||!rt.value&&i.clearable&&(xe.value=!0)},_e=()=>{xe.value=!1},Re=ke=>{var ot;i.readonly||X.value||(((ot=ke.touches[0].target)==null?void 0:ot.tagName)!=="INPUT"||x.value)&&(w.value=!0)},Ke=z(()=>i.type.includes("range")),je=Fr(),ze=z(()=>{var ke,ot;return(ot=(ke=y(M))==null?void 0:ke.popperRef)==null?void 0:ot.contentRef}),nt=QL(R,ke=>{const ot=y(ze),tn=sa(R);ot&&(ke.target===ot||ke.composedPath().includes(ot))||ke.target===tn||tn&&ke.composedPath().includes(tn)||(w.value=!1)});Co(()=>{nt==null||nt()});const it=le(null),dt=()=>{if(it.value){const ke=gt(ue.value);ke&&Mt(ke)&&(W(qS(ke)),it.value=null)}it.value===""&&(W(k.value),j(k.value,!0),it.value=null)},gt=ke=>ke?yn.value.parseUserInput(ke):null,ft=ke=>ke?yn.value.formatToString(ke):null,Mt=ke=>yn.value.isValidValue(ke),lt=async ke=>{if(i.readonly||X.value)return;const{code:ot}=ke;if(O(ke),ot===At.esc){w.value===!0&&(w.value=!1,ke.preventDefault(),ke.stopPropagation());return}if(ot===At.down&&(yn.value.handleFocusPicker&&(ke.preventDefault(),ke.stopPropagation()),w.value===!1&&(w.value=!0,await Vt()),yn.value.handleFocusPicker)){yn.value.handleFocusPicker();return}if(ot===At.tab){F=!0;return}if(ot===At.enter||ot===At.numpadEnter){(it.value===null||it.value===""||Mt(gt(ue.value)))&&(dt(),w.value=!1),ke.stopPropagation();return}if(it.value){ke.stopPropagation();return}yn.value.handleKeydownInput&&yn.value.handleKeydownInput(ke)},Et=ke=>{it.value=ke,w.value||(w.value=!0)},Yt=ke=>{const ot=ke.target;it.value?it.value=[ot.value,it.value[1]]:it.value=[ot.value,null]},sn=ke=>{const ot=ke.target;it.value?it.value=[it.value[0],ot.value]:it.value=[null,ot.value]},dn=()=>{var ke;const ot=it.value,tn=gt(ot&&ot[0]),Nt=y(ye);if(tn&&tn.isValid()){it.value=[ft(tn),((ke=ue.value)==null?void 0:ke[1])||null];const Dn=[tn,Nt&&(Nt[1]||null)];Mt(Dn)&&(W(qS(Dn)),it.value=null)}},Sn=()=>{var ke;const ot=y(it),tn=gt(ot&&ot[1]),Nt=y(ye);if(tn&&tn.isValid()){it.value=[((ke=y(ue))==null?void 0:ke[0])||null,ft(tn)];const Dn=[Nt&&Nt[0],tn];Mt(Dn)&&(W(qS(Dn)),it.value=null)}},yn=le({}),fo=ke=>{yn.value[ke[0]]=ke[1],yn.value.panelReady=!0},Xt=ke=>{o("calendar-change",ke)},vn=(ke,ot,tn)=>{o("panel-change",ke,ot,tn)},Ne=()=>{var ke;(ke=R.value)==null||ke.focus()},qe=()=>{var ke;(ke=R.value)==null||ke.blur()};return Nn("EP_PICKER_BASE",{props:i}),t({focus:Ne,blur:qe,handleOpen:he,handleClose:re,onPick:oe}),(ke,ot)=>(ee(),We(y(Li),An({ref_key:"refPopper",ref:M,visible:w.value,effect:"light",pure:"",trigger:"click"},ke.$attrs,{role:"dialog",teleported:"",transition:`${y(f).namespace.value}-zoom-in-top`,"popper-class":[`${y(f).namespace.value}-picker__popper`,ke.popperClass],"popper-options":y(S),"fallback-placements":ke.fallbackPlacements,"gpu-acceleration":!1,placement:ke.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:pe,onShow:ie,onHide:te}),{default:Ae(()=>[y(Ke)?(ee(),We(NTe,{key:1,id:ke.id,ref_key:"inputRef",ref:R,"model-value":y(ue),name:ke.name,disabled:y(X),readonly:!ke.editable||ke.readonly,"start-placeholder":ke.startPlaceholder,"end-placeholder":ke.endPlaceholder,class:ne(y(H)),style:qt(ke.$attrs.style),"aria-label":ke.ariaLabel,tabindex:ke.tabindex,autocomplete:"off",role:"combobox",onClick:Qe,onFocus:y(P),onBlur:y(G),onStartInput:Yt,onStartChange:dn,onEndInput:sn,onEndChange:Sn,onMousedown:Qe,onMouseenter:Ge,onMouseleave:_e,onTouchstartPassive:Re,onKeydown:lt},{prefix:Ae(()=>[y(be)?(ee(),We(y(Pt),{key:0,class:ne([y(p).e("icon"),y(v).e("icon")])},{default:Ae(()=>[(ee(),We(Tn(y(be))))]),_:1},8,["class"])):$e("v-if",!0)]),"range-separator":Ae(()=>[Ve(ke.$slots,"range-separator",{},()=>[Ee("span",{class:ne(y(v).b("separator"))},mt(ke.rangeSeparator),3)])]),suffix:Ae(()=>[ke.clearIcon?(ee(),We(y(Pt),{key:0,class:ne(y(Y)),onMousedown:Zt(y(lo),["prevent"]),onClick:Le},{default:Ae(()=>[(ee(),We(Tn(ke.clearIcon)))]),_:1},8,["class","onMousedown"])):$e("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(ee(),We(y(Yi),{key:0,id:ke.id,ref_key:"inputRef",ref:R,"container-role":"combobox","model-value":y(ue),name:ke.name,size:y(je),disabled:y(X),placeholder:ke.placeholder,class:ne([y(f).b("editor"),y(f).bm("editor",ke.type),ke.$attrs.class]),style:qt(ke.$attrs.style),readonly:!ke.editable||ke.readonly||y(Ce)||y(Fe)||y(Oe)||ke.type==="week","aria-label":ke.ariaLabel,tabindex:ke.tabindex,"validate-event":!1,onInput:Et,onFocus:y(P),onBlur:y(G),onKeydown:lt,onChange:dt,onMousedown:Qe,onMouseenter:Ge,onMouseleave:_e,onTouchstartPassive:Re,onClick:Zt(()=>{},["stop"])},{prefix:Ae(()=>[y(be)?(ee(),We(y(Pt),{key:0,class:ne(y(p).e("icon")),onMousedown:Zt(Qe,["prevent"]),onTouchstartPassive:Re},{default:Ae(()=>[(ee(),We(Tn(y(be))))]),_:1},8,["class","onMousedown"])):$e("v-if",!0)]),suffix:Ae(()=>[xe.value&&ke.clearIcon?(ee(),We(y(Pt),{key:0,class:ne(`${y(p).e("icon")} clear-icon`),onMousedown:Zt(y(lo),["prevent"]),onClick:Le},{default:Ae(()=>[(ee(),We(Tn(ke.clearIcon)))]),_:1},8,["class","onMousedown"])):$e("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:Ae(()=>[Ve(ke.$slots,"default",{visible:w.value,actualVisible:E.value,parsedValue:y(ye),format:ke.format,dateFormat:ke.dateFormat,timeFormat:ke.timeFormat,unlinkPanels:ke.unlinkPanels,type:ke.type,defaultValue:ke.defaultValue,showNow:ke.showNow,onPick:oe,onSelectRange:J,onSetPickerOption:fo,onCalendarChange:Xt,onPanelChange:vn,onMousedown:Zt(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var L9=vt(xTe,[["__file","picker.vue"]]);const UTe=pt({...O9,datetimeRole:String,parsedValue:{type:Ue(Object)}}),N9=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:o})=>{const i=(f,p,v,_)=>{const b={hour:e,minute:t,second:o};let S=f;return["hour","minute","second"].forEach(k=>{if(b[k]){let M;const R=b[k];switch(k){case"minute":{M=R(S.hour(),p,_);break}case"second":{M=R(S.hour(),S.minute(),p,_);break}default:{M=R(p,_);break}}if(M!=null&&M.length&&!M.includes(S[k]())){const w=v?0:M.length-1;S=S[k](M[w])}}}),S},c={};return{timePickerOptions:c,getAvailableTime:i,onSetOption:([f,p])=>{c[f]=p}}},rD=e=>{const t=(i,c)=>i||c,o=i=>i!==!0;return e.map(t).filter(o)},P9=(e,t,o)=>({getHoursList:(f,p)=>eD(24,e&&(()=>e==null?void 0:e(f,p))),getMinutesList:(f,p,v)=>eD(60,t&&(()=>t==null?void 0:t(f,p,v))),getSecondsList:(f,p,v,_)=>eD(60,o&&(()=>o==null?void 0:o(f,p,v,_)))}),x9=(e,t,o)=>{const{getHoursList:i,getMinutesList:c,getSecondsList:u}=P9(e,t,o);return{getAvailableHours:(_,b)=>rD(i(_,b)),getAvailableMinutes:(_,b,S)=>rD(c(_,b,S)),getAvailableSeconds:(_,b,S,k)=>rD(u(_,b,S,k))}},U9=e=>{const t=le(e.parsedValue);return st(()=>e.visible,o=>{o||(t.value=e.parsedValue)}),t},FTe=pt({role:{type:String,required:!0},spinnerDate:{type:Ue(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:Ue(String),default:""},...D9}),VTe=100,GTe=600,YE={beforeMount(e,t){const o=t.value,{interval:i=VTe,delay:c=GTe}=zt(o)?{}:o;let u,f;const p=()=>zt(o)?o():o.handler(),v=()=>{f&&(clearTimeout(f),f=void 0),u&&(clearInterval(u),u=void 0)};e.addEventListener("mousedown",_=>{_.button===0&&(v(),p(),document.addEventListener("mouseup",()=>v(),{once:!0}),f=setTimeout(()=>{u=setInterval(()=>{p()},i)},c))})}},BTe=Te({__name:"basic-time-spinner",props:FTe,emits:[wn,"select-range","set-option"],setup(e,{emit:t}){const o=e,i=Rt("EP_PICKER_BASE"),{isRange:c,format:u}=i.props,f=ut("time"),{getHoursList:p,getMinutesList:v,getSecondsList:_}=P9(o.disabledHours,o.disabledMinutes,o.disabledSeconds);let b=!1;const S=le(),k=le(),M=le(),R=le(),w={hours:k,minutes:M,seconds:R},E=z(()=>o.showSeconds?RB:RB.slice(0,2)),N=z(()=>{const{spinnerDate:Ie}=o,ve=Ie.hour(),Ce=Ie.minute(),Fe=Ie.second();return{hours:ve,minutes:Ce,seconds:Fe}}),F=z(()=>{const{hours:Ie,minutes:ve}=y(N),{role:Ce,spinnerDate:Fe}=o,Oe=c?void 0:Fe;return{hours:p(Ce,Oe),minutes:v(Ie,Ce,Oe),seconds:_(Ie,ve,Ce,Oe)}}),x=z(()=>{const{hours:Ie,minutes:ve,seconds:Ce}=y(N);return{hours:QA(Ie,23),minutes:QA(ve,59),seconds:QA(Ce,59)}}),P=Oa(Ie=>{b=!1,Y(Ie)},200),G=Ie=>{if(!!!o.amPmMode)return"";const Ce=o.amPmMode==="A";let Fe=Ie<12?" am":" pm";return Ce&&(Fe=Fe.toUpperCase()),Fe},H=Ie=>{let ve=[0,0];if(!u||u===jE)switch(Ie){case"hours":ve=[0,2];break;case"minutes":ve=[3,5];break;case"seconds":ve=[6,8];break}const[Ce,Fe]=ve;t("select-range",Ce,Fe),S.value=Ie},Y=Ie=>{O(Ie,y(N)[Ie])},j=()=>{Y("hours"),Y("minutes"),Y("seconds")},W=Ie=>Ie.querySelector(`.${f.namespace.value}-scrollbar__wrap`),O=(Ie,ve)=>{if(o.arrowControl)return;const Ce=y(w[Ie]);Ce&&Ce.$el&&(W(Ce.$el).scrollTop=Math.max(0,ve*Q(Ie)))},Q=Ie=>{const ve=y(w[Ie]),Ce=ve==null?void 0:ve.$el.querySelector("li");return Ce&&Number.parseFloat(Yc(Ce,"height"))||0},J=()=>{pe(1)},oe=()=>{pe(-1)},pe=Ie=>{S.value||H("hours");const ve=S.value,Ce=y(N)[ve],Fe=S.value==="hours"?24:60,Oe=ie(ve,Ce,Ie,Fe);te(ve,Oe),O(ve,Oe),Vt(()=>H(ve))},ie=(Ie,ve,Ce,Fe)=>{let Oe=(ve+Ce+Fe)%Fe;const be=y(F)[Ie];for(;be[Oe]&&Oe!==ve;)Oe=(Oe+Ce+Fe)%Fe;return Oe},te=(Ie,ve)=>{if(y(F)[Ie][ve])return;const{hours:Oe,minutes:be,seconds:xe}=y(N);let Le;switch(Ie){case"hours":Le=o.spinnerDate.hour(ve).minute(be).second(xe);break;case"minutes":Le=o.spinnerDate.hour(Oe).minute(ve).second(xe);break;case"seconds":Le=o.spinnerDate.hour(Oe).minute(be).second(ve);break}t(wn,Le)},he=(Ie,{value:ve,disabled:Ce})=>{Ce||(te(Ie,ve),H(Ie),O(Ie,ve))},re=Ie=>{const ve=y(w[Ie]);if(!ve)return;b=!0,P(Ie);const Ce=Math.min(Math.round((W(ve.$el).scrollTop-(X(Ie)*.5-10)/Q(Ie)+3)/Q(Ie)),Ie==="hours"?23:59);te(Ie,Ce)},X=Ie=>y(w[Ie]).$el.offsetHeight,ye=()=>{const Ie=ve=>{const Ce=y(w[ve]);Ce&&Ce.$el&&(W(Ce.$el).onscroll=()=>{re(ve)})};Ie("hours"),Ie("minutes"),Ie("seconds")};mn(()=>{Vt(()=>{!o.arrowControl&&ye(),j(),o.role==="start"&&H("hours")})});const ue=(Ie,ve)=>{w[ve].value=Ie??void 0};return t("set-option",[`${o.role}_scrollDown`,pe]),t("set-option",[`${o.role}_emitSelectRange`,H]),st(()=>o.spinnerDate,()=>{b||j()}),(Ie,ve)=>(ee(),ge("div",{class:ne([y(f).b("spinner"),{"has-seconds":Ie.showSeconds}])},[Ie.arrowControl?$e("v-if",!0):(ee(!0),ge(Ht,{key:0},Un(y(E),Ce=>(ee(),We(y(ac),{key:Ce,ref_for:!0,ref:Fe=>ue(Fe,Ce),class:ne(y(f).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(f).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Fe=>H(Ce),onMousemove:Fe=>Y(Ce)},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(y(F)[Ce],(Fe,Oe)=>(ee(),ge("li",{key:Oe,class:ne([y(f).be("spinner","item"),y(f).is("active",Oe===y(N)[Ce]),y(f).is("disabled",Fe)]),onClick:be=>he(Ce,{value:Oe,disabled:Fe})},[Ce==="hours"?(ee(),ge(Ht,{key:0},[Mn(mt(("0"+(Ie.amPmMode?Oe%12||12:Oe)).slice(-2))+mt(G(Oe)),1)],64)):(ee(),ge(Ht,{key:1},[Mn(mt(("0"+Oe).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Ie.arrowControl?(ee(!0),ge(Ht,{key:1},Un(y(E),Ce=>(ee(),ge("div",{key:Ce,class:ne([y(f).be("spinner","wrapper"),y(f).is("arrow")]),onMouseenter:Fe=>H(Ce)},[fn((ee(),We(y(Pt),{class:ne(["arrow-up",y(f).be("spinner","arrow")])},{default:Ae(()=>[Me(y(oN))]),_:1},8,["class"])),[[y(YE),oe]]),fn((ee(),We(y(Pt),{class:ne(["arrow-down",y(f).be("spinner","arrow")])},{default:Ae(()=>[Me(y(fu))]),_:1},8,["class"])),[[y(YE),J]]),Ee("ul",{class:ne(y(f).be("spinner","list"))},[(ee(!0),ge(Ht,null,Un(y(x)[Ce],(Fe,Oe)=>(ee(),ge("li",{key:Oe,class:ne([y(f).be("spinner","item"),y(f).is("active",Fe===y(N)[Ce]),y(f).is("disabled",y(F)[Ce][Fe])])},[y(jt)(Fe)?(ee(),ge(Ht,{key:0},[Ce==="hours"?(ee(),ge(Ht,{key:0},[Mn(mt(("0"+(Ie.amPmMode?Fe%12||12:Fe)).slice(-2))+mt(G(Fe)),1)],64)):(ee(),ge(Ht,{key:1},[Mn(mt(("0"+Fe).slice(-2)),1)],64))],64)):$e("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):$e("v-if",!0)],2))}});var aO=vt(BTe,[["__file","basic-time-spinner.vue"]]);const HTe=Te({__name:"panel-time-pick",props:UTe,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,i=Rt("EP_PICKER_BASE"),{arrowControl:c,disabledHours:u,disabledMinutes:f,disabledSeconds:p,defaultValue:v}=i.props,{getAvailableHours:_,getAvailableMinutes:b,getAvailableSeconds:S}=x9(u,f,p),k=ut("time"),{t:M,lang:R}=Kn(),w=le([0,2]),E=U9(o),N=z(()=>qn(o.actualVisible)?`${k.namespace.value}-zoom-in-top`:""),F=z(()=>o.format.includes("ss")),x=z(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),P=re=>{const X=cn(re).locale(R.value),ye=pe(X);return X.isSame(ye)},G=()=>{t("pick",E.value,!1)},H=(re=!1,X=!1)=>{X||t("pick",o.parsedValue,re)},Y=re=>{if(!o.visible)return;const X=pe(re).millisecond(0);t("pick",X,!0)},j=(re,X)=>{t("select-range",re,X),w.value=[re,X]},W=re=>{const X=[0,3].concat(F.value?[6]:[]),ye=["hours","minutes"].concat(F.value?["seconds"]:[]),Ie=(X.indexOf(w.value[0])+re+X.length)%X.length;Q.start_emitSelectRange(ye[Ie])},O=re=>{const X=re.code,{left:ye,right:ue,up:Ie,down:ve}=At;if([ye,ue].includes(X)){W(X===ye?-1:1),re.preventDefault();return}if([Ie,ve].includes(X)){const Ce=X===Ie?-1:1;Q.start_scrollDown(Ce),re.preventDefault();return}},{timePickerOptions:Q,onSetOption:J,getAvailableTime:oe}=N9({getAvailableHours:_,getAvailableMinutes:b,getAvailableSeconds:S}),pe=re=>oe(re,o.datetimeRole||"",!0),ie=re=>re?cn(re,o.format).locale(R.value):null,te=re=>re?re.format(o.format):null,he=()=>cn(v).locale(R.value);return t("set-picker-option",["isValidValue",P]),t("set-picker-option",["formatToString",te]),t("set-picker-option",["parseUserInput",ie]),t("set-picker-option",["handleKeydownInput",O]),t("set-picker-option",["getRangeAvailableTime",pe]),t("set-picker-option",["getDefaultValue",he]),(re,X)=>(ee(),We(Zr,{name:y(N)},{default:Ae(()=>[re.actualVisible||re.visible?(ee(),ge("div",{key:0,class:ne(y(k).b("panel"))},[Ee("div",{class:ne([y(k).be("panel","content"),{"has-seconds":y(F)}])},[Me(aO,{ref:"spinner",role:re.datetimeRole||"start","arrow-control":y(c),"show-seconds":y(F),"am-pm-mode":y(x),"spinner-date":re.parsedValue,"disabled-hours":y(u),"disabled-minutes":y(f),"disabled-seconds":y(p),onChange:Y,onSetOption:y(J),onSelectRange:j},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ee("div",{class:ne(y(k).be("panel","footer"))},[Ee("button",{type:"button",class:ne([y(k).be("panel","btn"),"cancel"]),onClick:G},mt(y(M)("el.datepicker.cancel")),3),Ee("button",{type:"button",class:ne([y(k).be("panel","btn"),"confirm"]),onClick:ye=>H()},mt(y(M)("el.datepicker.confirm")),11,["onClick"])],2)],2)):$e("v-if",!0)]),_:1},8,["name"]))}});var JE=vt(HTe,[["__file","panel-time-pick.vue"]]);const $Te=pt({...O9,parsedValue:{type:Ue(Array)}}),qTe=Te({__name:"panel-time-range",props:$Te,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,i=(Qe,Ge)=>{const _e=[];for(let Re=Qe;Re<=Ge;Re++)_e.push(Re);return _e},{t:c,lang:u}=Kn(),f=ut("time"),p=ut("picker"),v=Rt("EP_PICKER_BASE"),{arrowControl:_,disabledHours:b,disabledMinutes:S,disabledSeconds:k,defaultValue:M}=v.props,R=z(()=>[f.be("range-picker","body"),f.be("panel","content"),f.is("arrow",_),P.value?"has-seconds":""]),w=z(()=>[f.be("range-picker","body"),f.be("panel","content"),f.is("arrow",_),P.value?"has-seconds":""]),E=z(()=>o.parsedValue[0]),N=z(()=>o.parsedValue[1]),F=U9(o),x=()=>{t("pick",F.value,!1)},P=z(()=>o.format.includes("ss")),G=z(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),H=(Qe=!1)=>{t("pick",[E.value,N.value],Qe)},Y=Qe=>{O(Qe.millisecond(0),N.value)},j=Qe=>{O(E.value,Qe.millisecond(0))},W=Qe=>{const Ge=Qe.map(Re=>cn(Re).locale(u.value)),_e=ue(Ge);return Ge[0].isSame(_e[0])&&Ge[1].isSame(_e[1])},O=(Qe,Ge)=>{o.visible&&t("pick",[Qe,Ge],!0)},Q=z(()=>E.value>N.value),J=le([0,2]),oe=(Qe,Ge)=>{t("select-range",Qe,Ge,"min"),J.value=[Qe,Ge]},pe=z(()=>P.value?11:8),ie=(Qe,Ge)=>{t("select-range",Qe,Ge,"max");const _e=y(pe);J.value=[Qe+_e,Ge+_e]},te=Qe=>{const Ge=P.value?[0,3,6,11,14,17]:[0,3,8,11],_e=["hours","minutes"].concat(P.value?["seconds"]:[]),Ke=(Ge.indexOf(J.value[0])+Qe+Ge.length)%Ge.length,je=Ge.length/2;Ke<je?Fe.start_emitSelectRange(_e[Ke]):Fe.end_emitSelectRange(_e[Ke-je])},he=Qe=>{const Ge=Qe.code,{left:_e,right:Re,up:Ke,down:je}=At;if([_e,Re].includes(Ge)){te(Ge===_e?-1:1),Qe.preventDefault();return}if([Ke,je].includes(Ge)){const ze=Ge===Ke?-1:1,nt=J.value[0]<pe.value?"start":"end";Fe[`${nt}_scrollDown`](ze),Qe.preventDefault();return}},re=(Qe,Ge)=>{const _e=b?b(Qe):[],Re=Qe==="start",je=(Ge||(Re?N.value:E.value)).hour(),ze=Re?i(je+1,23):i(0,je-1);return WA(_e,ze)},X=(Qe,Ge,_e)=>{const Re=S?S(Qe,Ge):[],Ke=Ge==="start",je=_e||(Ke?N.value:E.value),ze=je.hour();if(Qe!==ze)return Re;const nt=je.minute(),it=Ke?i(nt+1,59):i(0,nt-1);return WA(Re,it)},ye=(Qe,Ge,_e,Re)=>{const Ke=k?k(Qe,Ge,_e):[],je=_e==="start",ze=Re||(je?N.value:E.value),nt=ze.hour(),it=ze.minute();if(Qe!==nt||Ge!==it)return Ke;const dt=ze.second(),gt=je?i(dt+1,59):i(0,dt-1);return WA(Ke,gt)},ue=([Qe,Ge])=>[Oe(Qe,"start",!0,Ge),Oe(Ge,"end",!1,Qe)],{getAvailableHours:Ie,getAvailableMinutes:ve,getAvailableSeconds:Ce}=x9(re,X,ye),{timePickerOptions:Fe,getAvailableTime:Oe,onSetOption:be}=N9({getAvailableHours:Ie,getAvailableMinutes:ve,getAvailableSeconds:Ce}),xe=Qe=>Qe?ht(Qe)?Qe.map(Ge=>cn(Ge,o.format).locale(u.value)):cn(Qe,o.format).locale(u.value):null,Le=Qe=>Qe?ht(Qe)?Qe.map(Ge=>Ge.format(o.format)):Qe.format(o.format):null,rt=()=>{if(ht(M))return M.map(Ge=>cn(Ge).locale(u.value));const Qe=cn(M).locale(u.value);return[Qe,Qe.add(60,"m")]};return t("set-picker-option",["formatToString",Le]),t("set-picker-option",["parseUserInput",xe]),t("set-picker-option",["isValidValue",W]),t("set-picker-option",["handleKeydownInput",he]),t("set-picker-option",["getDefaultValue",rt]),t("set-picker-option",["getRangeAvailableTime",ue]),(Qe,Ge)=>Qe.actualVisible?(ee(),ge("div",{key:0,class:ne([y(f).b("range-picker"),y(p).b("panel")])},[Ee("div",{class:ne(y(f).be("range-picker","content"))},[Ee("div",{class:ne(y(f).be("range-picker","cell"))},[Ee("div",{class:ne(y(f).be("range-picker","header"))},mt(y(c)("el.datepicker.startTime")),3),Ee("div",{class:ne(y(R))},[Me(aO,{ref:"minSpinner",role:"start","show-seconds":y(P),"am-pm-mode":y(G),"arrow-control":y(_),"spinner-date":y(E),"disabled-hours":re,"disabled-minutes":X,"disabled-seconds":ye,onChange:Y,onSetOption:y(be),onSelectRange:oe},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ee("div",{class:ne(y(f).be("range-picker","cell"))},[Ee("div",{class:ne(y(f).be("range-picker","header"))},mt(y(c)("el.datepicker.endTime")),3),Ee("div",{class:ne(y(w))},[Me(aO,{ref:"maxSpinner",role:"end","show-seconds":y(P),"am-pm-mode":y(G),"arrow-control":y(_),"spinner-date":y(N),"disabled-hours":re,"disabled-minutes":X,"disabled-seconds":ye,onChange:j,onSetOption:y(be),onSelectRange:ie},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ee("div",{class:ne(y(f).be("panel","footer"))},[Ee("button",{type:"button",class:ne([y(f).be("panel","btn"),"cancel"]),onClick:_e=>x()},mt(y(c)("el.datepicker.cancel")),11,["onClick"]),Ee("button",{type:"button",class:ne([y(f).be("panel","btn"),"confirm"]),disabled:y(Q),onClick:_e=>H()},mt(y(c)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):$e("v-if",!0)}});var KTe=vt(qTe,[["__file","panel-time-range.vue"]]);cn.extend(wN);var zTe=Te({name:"ElTimePicker",install:null,props:{...RN,isRange:{type:Boolean,default:!1}},emits:[nn],setup(e,t){const o=le(),[i,c]=e.isRange?["timerange",KTe]:["time",JE],u=f=>t.emit(nn,f);return Nn("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var f;(f=o.value)==null||f.focus()},blur:()=>{var f;(f=o.value)==null||f.blur()},handleOpen:()=>{var f;(f=o.value)==null||f.handleOpen()},handleClose:()=>{var f;(f=o.value)==null||f.handleClose()}}),()=>{var f;const p=(f=e.format)!=null?f:jE;return Me(L9,An(e,{ref:o,type:i,format:p,"onUpdate:modelValue":u}),{default:v=>Me(c,v,null)})}}});const WTe=un(zTe),zT=Symbol(),jTe=pt({...RN,type:{type:Ue(String),default:"date"}}),YTe=["date","dates","year","years","month","months","week","range"],AN=pt({disabledDate:{type:Ue(Function)},date:{type:Ue(Object),required:!0},minDate:{type:Ue(Object)},maxDate:{type:Ue(Object)},parsedValue:{type:Ue([Object,Array])},rangeState:{type:Ue(Object),default:()=>({endDate:null,selecting:!1})}}),F9=pt({type:{type:Ue(String),required:!0,values:pCe},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),DN=pt({unlinkPanels:Boolean,parsedValue:{type:Ue(Array)}}),ON=e=>({type:String,values:YTe,default:e}),JTe=pt({...F9,parsedValue:{type:Ue([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),Qg=e=>{if(!ht(e))return!1;const[t,o]=e;return cn.isDayjs(t)&&cn.isDayjs(o)&&cn(t).isValid()&&cn(o).isValid()&&t.isSameOrBefore(o)},LN=(e,{lang:t,unit:o,unlinkPanels:i})=>{let c;if(ht(e)){let[u,f]=e.map(p=>cn(p).locale(t));return i||(f=u.add(1,o)),[u,f]}else e?c=cn(e):c=cn();return c=c.locale(t),[c,c.add(1,o)]},XTe=(e,t,{columnIndexOffset:o,startDate:i,nextEndDate:c,now:u,unit:f,relativeDateGetter:p,setCellMetadata:v,setRowMetadata:_})=>{for(let b=0;b<e.row;b++){const S=t[b];for(let k=0;k<e.column;k++){let M=S[k+o];M||(M={row:b,column:k,type:"normal",inRange:!1,start:!1,end:!1});const R=b*e.column+k,w=p(R);M.dayjs=w,M.date=w.toDate(),M.timestamp=w.valueOf(),M.type="normal",M.inRange=!!(i&&w.isSameOrAfter(i,f)&&c&&w.isSameOrBefore(c,f))||!!(i&&w.isSameOrBefore(i,f)&&c&&w.isSameOrAfter(c,f)),i!=null&&i.isSameOrAfter(c)?(M.start=!!c&&w.isSame(c,f),M.end=i&&w.isSame(i,f)):(M.start=!!i&&w.isSame(i,f),M.end=!!c&&w.isSame(c,f)),w.isSame(u,f)&&(M.type="today"),v==null||v(M,{rowIndex:b,columnIndex:k}),S[k+o]=M}_==null||_(S)}},XE=(e,t,o)=>{const i=cn().locale(o).startOf("month").month(t).year(e),c=i.daysInMonth();return Hd(c).map(u=>i.add(u,"day").toDate())},U0=(e,t,o,i)=>{const c=cn().year(e).month(t).startOf("month"),u=XE(e,t,o).find(f=>!(i!=null&&i(f)));return u?cn(u).locale(o):c.locale(o)},sO=(e,t,o)=>{const i=e.year();if(!(o!=null&&o(e.toDate())))return e.locale(t);const c=e.month();if(!XE(i,c,t).every(o))return U0(i,c,t,o);for(let u=0;u<12;u++)if(!XE(i,u,t).every(o))return U0(i,u,t,o);return e},ev=(e,t,o,i)=>{if(ht(e))return e.map(c=>ev(c,t,o,i));if(Ut(e)){const c=i.value?cn(e):cn(e,t);if(!c.isValid())return c}return cn(e,t).locale(o)},ZTe=pt({...AN,cellClassName:{type:Ue(Function)},showWeekNumber:Boolean,selectionMode:ON("date")}),QTe=["changerange","pick","select"],lO=(e="")=>["normal","today"].includes(e),e1e=(e,t)=>{const{lang:o}=Kn(),i=le(),c=le(),u=le(),f=le(),p=le([[],[],[],[],[],[]]);let v=!1;const _=e.date.$locale().weekStart||7,b=e.date.locale("en").localeData().weekdaysShort().map(X=>X.toLowerCase()),S=z(()=>_>3?7-_:-_),k=z(()=>{const X=e.date.startOf("month");return X.subtract(X.day()||7,"day")}),M=z(()=>b.concat(b).slice(_,_+7)),R=z(()=>dq(y(P)).some(X=>X.isCurrent)),w=z(()=>{const X=e.date.startOf("month"),ye=X.day()||7,ue=X.daysInMonth(),Ie=X.subtract(1,"month").daysInMonth();return{startOfMonthDay:ye,dateCountOfMonth:ue,dateCountOfLastMonth:Ie}}),E=z(()=>e.selectionMode==="dates"?aa(e.parsedValue):[]),N=(X,{count:ye,rowIndex:ue,columnIndex:Ie})=>{const{startOfMonthDay:ve,dateCountOfMonth:Ce,dateCountOfLastMonth:Fe}=y(w),Oe=y(S);if(ue>=0&&ue<=1){const be=ve+Oe<0?7+ve+Oe:ve+Oe;if(Ie+ue*7>=be)return X.text=ye,!0;X.text=Fe-(be-Ie%7)+1+ue*7,X.type="prev-month"}else return ye<=Ce?X.text=ye:(X.text=ye-Ce,X.type="next-month"),!0;return!1},F=(X,{columnIndex:ye,rowIndex:ue},Ie)=>{const{disabledDate:ve,cellClassName:Ce}=e,Fe=y(E),Oe=N(X,{count:Ie,rowIndex:ue,columnIndex:ye}),be=X.dayjs.toDate();return X.selected=Fe.find(xe=>xe.isSame(X.dayjs,"day")),X.isSelected=!!X.selected,X.isCurrent=H(X),X.disabled=ve==null?void 0:ve(be),X.customClass=Ce==null?void 0:Ce(be),Oe},x=X=>{if(e.selectionMode==="week"){const[ye,ue]=e.showWeekNumber?[1,7]:[0,6],Ie=re(X[ye+1]);X[ye].inRange=Ie,X[ye].start=Ie,X[ue].inRange=Ie,X[ue].end=Ie}},P=z(()=>{const{minDate:X,maxDate:ye,rangeState:ue,showWeekNumber:Ie}=e,ve=y(S),Ce=y(p),Fe="day";let Oe=1;if(Ie)for(let be=0;be<6;be++)Ce[be][0]||(Ce[be][0]={type:"week",text:y(k).add(be*7+1,Fe).week()});return XTe({row:6,column:7},Ce,{startDate:X,columnIndexOffset:Ie?1:0,nextEndDate:ue.endDate||ye||ue.selecting&&X||null,now:cn().locale(y(o)).startOf(Fe),unit:Fe,relativeDateGetter:be=>y(k).add(be-ve,Fe),setCellMetadata:(...be)=>{F(...be,Oe)&&(Oe+=1)},setRowMetadata:x}),Ce});st(()=>e.date,async()=>{var X;(X=y(i))!=null&&X.contains(document.activeElement)&&(await Vt(),await G())});const G=async()=>{var X;return(X=y(c))==null?void 0:X.focus()},H=X=>e.selectionMode==="date"&&lO(X.type)&&Y(X,e.parsedValue),Y=(X,ye)=>ye?cn(ye).locale(y(o)).isSame(e.date.date(Number(X.text)),"day"):!1,j=(X,ye)=>{const ue=X*7+(ye-(e.showWeekNumber?1:0))-y(S);return y(k).add(ue,"day")},W=X=>{var ye;if(!e.rangeState.selecting)return;let ue=X.target;if(ue.tagName==="SPAN"&&(ue=(ye=ue.parentNode)==null?void 0:ye.parentNode),ue.tagName==="DIV"&&(ue=ue.parentNode),ue.tagName!=="TD")return;const Ie=ue.parentNode.rowIndex-1,ve=ue.cellIndex;y(P)[Ie][ve].disabled||(Ie!==y(u)||ve!==y(f))&&(u.value=Ie,f.value=ve,t("changerange",{selecting:!0,endDate:j(Ie,ve)}))},O=X=>!y(R)&&(X==null?void 0:X.text)===1&&X.type==="normal"||X.isCurrent,Q=X=>{v||y(R)||e.selectionMode!=="date"||he(X,!0)},J=X=>{X.target.closest("td")&&(v=!0)},oe=X=>{X.target.closest("td")&&(v=!1)},pe=X=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:X,maxDate:null}),t("select",!0)):(X>=e.minDate?t("pick",{minDate:e.minDate,maxDate:X}):t("pick",{minDate:X,maxDate:e.minDate}),t("select",!1))},ie=X=>{const ye=X.week(),ue=`${X.year()}w${ye}`;t("pick",{year:X.year(),week:ye,value:ue,date:X.startOf("week")})},te=(X,ye)=>{const ue=ye?aa(e.parsedValue).filter(Ie=>(Ie==null?void 0:Ie.valueOf())!==X.valueOf()):aa(e.parsedValue).concat([X]);t("pick",ue)},he=(X,ye=!1)=>{const ue=X.target.closest("td");if(!ue)return;const Ie=ue.parentNode.rowIndex-1,ve=ue.cellIndex,Ce=y(P)[Ie][ve];if(Ce.disabled||Ce.type==="week")return;const Fe=j(Ie,ve);switch(e.selectionMode){case"range":{pe(Fe);break}case"date":{t("pick",Fe,ye);break}case"week":{ie(Fe);break}case"dates":{te(Fe,!!Ce.selected);break}}},re=X=>{if(e.selectionMode!=="week")return!1;let ye=e.date.startOf("day");if(X.type==="prev-month"&&(ye=ye.subtract(1,"month")),X.type==="next-month"&&(ye=ye.add(1,"month")),ye=ye.date(Number.parseInt(X.text,10)),e.parsedValue&&!ht(e.parsedValue)){const ue=(e.parsedValue.day()-_+7)%7-1;return e.parsedValue.subtract(ue,"day").isSame(ye,"day")}return!1};return{WEEKS:M,rows:P,tbodyRef:i,currentCellRef:c,focus:G,isCurrent:H,isWeekActive:re,isSelectedCell:O,handlePickDate:he,handleMouseUp:oe,handleMouseDown:J,handleMouseMove:W,handleFocus:Q}},t1e=(e,{isCurrent:t,isWeekActive:o})=>{const i=ut("date-table"),{t:c}=Kn(),u=z(()=>[i.b(),{"is-week-mode":e.selectionMode==="week"}]),f=z(()=>c("el.datepicker.dateTablePrompt")),p=z(()=>c("el.datepicker.week"));return{tableKls:u,tableLabel:f,weekLabel:p,getCellClasses:b=>{const S=[];return lO(b.type)&&!b.disabled?(S.push("available"),b.type==="today"&&S.push("today")):S.push(b.type),t(b)&&S.push("current"),b.inRange&&(lO(b.type)||e.selectionMode==="week")&&(S.push("in-range"),b.start&&S.push("start-date"),b.end&&S.push("end-date")),b.disabled&&S.push("disabled"),b.selected&&S.push("selected"),b.customClass&&S.push(b.customClass),S.join(" ")},getRowKls:b=>[i.e("row"),{current:o(b)}],t:c}},n1e=pt({cell:{type:Ue(Object)}});var NN=Te({name:"ElDatePickerCell",props:n1e,setup(e){const t=ut("date-table-cell"),{slots:o}=Rt(zT);return()=>{const{cell:i}=e;return Ve(o,"default",{...i},()=>{var c;return[Me("div",{class:t.b()},[Me("span",{class:t.e("text")},[(c=i==null?void 0:i.renderText)!=null?c:i==null?void 0:i.text])])]})}}});const o1e=Te({__name:"basic-date-table",props:ZTe,emits:QTe,setup(e,{expose:t,emit:o}){const i=e,{WEEKS:c,rows:u,tbodyRef:f,currentCellRef:p,focus:v,isCurrent:_,isWeekActive:b,isSelectedCell:S,handlePickDate:k,handleMouseUp:M,handleMouseDown:R,handleMouseMove:w,handleFocus:E}=e1e(i,o),{tableLabel:N,tableKls:F,weekLabel:x,getCellClasses:P,getRowKls:G,t:H}=t1e(i,{isCurrent:_,isWeekActive:b});let Y=!1;return Co(()=>{Y=!0}),t({focus:v}),(j,W)=>(ee(),ge("table",{"aria-label":y(N),class:ne(y(F)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:y(k),onMousemove:y(w),onMousedown:Zt(y(R),["prevent"]),onMouseup:y(M)},[Ee("tbody",{ref_key:"tbodyRef",ref:f},[Ee("tr",null,[j.showWeekNumber?(ee(),ge("th",{key:0,scope:"col"},mt(y(x)),1)):$e("v-if",!0),(ee(!0),ge(Ht,null,Un(y(c),(O,Q)=>(ee(),ge("th",{key:Q,"aria-label":y(H)("el.datepicker.weeksFull."+O),scope:"col"},mt(y(H)("el.datepicker.weeks."+O)),9,["aria-label"]))),128))]),(ee(!0),ge(Ht,null,Un(y(u),(O,Q)=>(ee(),ge("tr",{key:Q,class:ne(y(G)(O[1]))},[(ee(!0),ge(Ht,null,Un(O,(J,oe)=>(ee(),ge("td",{key:`${Q}.${oe}`,ref_for:!0,ref:pe=>!y(Y)&&y(S)(J)&&(p.value=pe),class:ne(y(P)(J)),"aria-current":J.isCurrent?"date":void 0,"aria-selected":J.isCurrent,tabindex:y(S)(J)?0:-1,onFocus:y(E)},[Me(y(NN),{cell:J},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var cO=vt(o1e,[["__file","basic-date-table.vue"]]);const r1e=pt({...AN,selectionMode:ON("month")}),i1e=Te({__name:"basic-month-table",props:r1e,emits:["changerange","pick","select"],setup(e,{expose:t,emit:o}){const i=e,c=ut("month-table"),{t:u,lang:f}=Kn(),p=le(),v=le(),_=le(i.date.locale("en").localeData().monthsShort().map(x=>x.toLowerCase())),b=le([[],[],[]]),S=le(),k=le(),M=z(()=>{var x,P;const G=b.value,H=cn().locale(f.value).startOf("month");for(let Y=0;Y<3;Y++){const j=G[Y];for(let W=0;W<4;W++){const O=j[W]||(j[W]={row:Y,column:W,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});O.type="normal";const Q=Y*4+W,J=i.date.startOf("year").month(Q),oe=i.rangeState.endDate||i.maxDate||i.rangeState.selecting&&i.minDate||null;O.inRange=!!(i.minDate&&J.isSameOrAfter(i.minDate,"month")&&oe&&J.isSameOrBefore(oe,"month"))||!!(i.minDate&&J.isSameOrBefore(i.minDate,"month")&&oe&&J.isSameOrAfter(oe,"month")),(x=i.minDate)!=null&&x.isSameOrAfter(oe)?(O.start=!!(oe&&J.isSame(oe,"month")),O.end=i.minDate&&J.isSame(i.minDate,"month")):(O.start=!!(i.minDate&&J.isSame(i.minDate,"month")),O.end=!!(oe&&J.isSame(oe,"month"))),H.isSame(J)&&(O.type="today"),O.text=Q,O.disabled=((P=i.disabledDate)==null?void 0:P.call(i,J.toDate()))||!1}}return G}),R=()=>{var x;(x=v.value)==null||x.focus()},w=x=>{const P={},G=i.date.year(),H=new Date,Y=x.text;return P.disabled=i.disabledDate?XE(G,Y,f.value).every(i.disabledDate):!1,P.current=aa(i.parsedValue).findIndex(j=>cn.isDayjs(j)&&j.year()===G&&j.month()===Y)>=0,P.today=H.getFullYear()===G&&H.getMonth()===Y,x.inRange&&(P["in-range"]=!0,x.start&&(P["start-date"]=!0),x.end&&(P["end-date"]=!0)),P},E=x=>{const P=i.date.year(),G=x.text;return aa(i.date).findIndex(H=>H.year()===P&&H.month()===G)>=0},N=x=>{var P;if(!i.rangeState.selecting)return;let G=x.target;if(G.tagName==="SPAN"&&(G=(P=G.parentNode)==null?void 0:P.parentNode),G.tagName==="DIV"&&(G=G.parentNode),G.tagName!=="TD")return;const H=G.parentNode.rowIndex,Y=G.cellIndex;M.value[H][Y].disabled||(H!==S.value||Y!==k.value)&&(S.value=H,k.value=Y,o("changerange",{selecting:!0,endDate:i.date.startOf("year").month(H*4+Y)}))},F=x=>{var P;const G=(P=x.target)==null?void 0:P.closest("td");if((G==null?void 0:G.tagName)!=="TD"||wa(G,"disabled"))return;const H=G.cellIndex,j=G.parentNode.rowIndex*4+H,W=i.date.startOf("year").month(j);if(i.selectionMode==="months"){if(x.type==="keydown"){o("pick",aa(i.parsedValue),!1);return}const O=U0(i.date.year(),j,f.value,i.disabledDate),Q=wa(G,"current")?aa(i.parsedValue).filter(J=>(J==null?void 0:J.year())!==O.year()||(J==null?void 0:J.month())!==O.month()):aa(i.parsedValue).concat([cn(O)]);o("pick",Q)}else i.selectionMode==="range"?i.rangeState.selecting?(i.minDate&&W>=i.minDate?o("pick",{minDate:i.minDate,maxDate:W}):o("pick",{minDate:W,maxDate:i.minDate}),o("select",!1)):(o("pick",{minDate:W,maxDate:null}),o("select",!0)):o("pick",j)};return st(()=>i.date,async()=>{var x,P;(x=p.value)!=null&&x.contains(document.activeElement)&&(await Vt(),(P=v.value)==null||P.focus())}),t({focus:R}),(x,P)=>(ee(),ge("table",{role:"grid","aria-label":y(u)("el.datepicker.monthTablePrompt"),class:ne(y(c).b()),onClick:F,onMousemove:N},[Ee("tbody",{ref_key:"tbodyRef",ref:p},[(ee(!0),ge(Ht,null,Un(y(M),(G,H)=>(ee(),ge("tr",{key:H},[(ee(!0),ge(Ht,null,Un(G,(Y,j)=>(ee(),ge("td",{key:j,ref_for:!0,ref:W=>E(Y)&&(v.value=W),class:ne(w(Y)),"aria-selected":`${E(Y)}`,"aria-label":y(u)(`el.datepicker.month${+Y.text+1}`),tabindex:E(Y)?0:-1,onKeydown:[To(Zt(F,["prevent","stop"]),["space"]),To(Zt(F,["prevent","stop"]),["enter"])]},[Me(y(NN),{cell:{...Y,renderText:y(u)("el.datepicker.months."+_.value[Y.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var uO=vt(i1e,[["__file","basic-month-table.vue"]]);const a1e=pt({...AN,selectionMode:ON("year")}),s1e=Te({__name:"basic-year-table",props:a1e,emits:["changerange","pick","select"],setup(e,{expose:t,emit:o}){const i=e,c=(P,G)=>{const H=cn(String(P)).locale(G).startOf("year"),j=H.endOf("year").dayOfYear();return Hd(j).map(W=>H.add(W,"day").toDate())},u=ut("year-table"),{t:f,lang:p}=Kn(),v=le(),_=le(),b=z(()=>Math.floor(i.date.year()/10)*10),S=le([[],[],[]]),k=le(),M=le(),R=z(()=>{var P;const G=S.value,H=cn().locale(p.value).startOf("year");for(let Y=0;Y<3;Y++){const j=G[Y];for(let W=0;W<4&&!(Y*4+W>=10);W++){let O=j[W];O||(O={row:Y,column:W,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),O.type="normal";const Q=Y*4+W+b.value,J=cn().year(Q),oe=i.rangeState.endDate||i.maxDate||i.rangeState.selecting&&i.minDate||null;O.inRange=!!(i.minDate&&J.isSameOrAfter(i.minDate,"year")&&oe&&J.isSameOrBefore(oe,"year"))||!!(i.minDate&&J.isSameOrBefore(i.minDate,"year")&&oe&&J.isSameOrAfter(oe,"year")),(P=i.minDate)!=null&&P.isSameOrAfter(oe)?(O.start=!!(oe&&J.isSame(oe,"year")),O.end=!!(i.minDate&&J.isSame(i.minDate,"year"))):(O.start=!!(i.minDate&&J.isSame(i.minDate,"year")),O.end=!!(oe&&J.isSame(oe,"year"))),H.isSame(J)&&(O.type="today"),O.text=Q;const ie=J.toDate();O.disabled=i.disabledDate&&i.disabledDate(ie)||!1,j[W]=O}}return G}),w=()=>{var P;(P=_.value)==null||P.focus()},E=P=>{const G={},H=cn().locale(p.value),Y=P.text;return G.disabled=i.disabledDate?c(Y,p.value).every(i.disabledDate):!1,G.today=H.year()===Y,G.current=aa(i.parsedValue).findIndex(j=>j.year()===Y)>=0,P.inRange&&(G["in-range"]=!0,P.start&&(G["start-date"]=!0),P.end&&(G["end-date"]=!0)),G},N=P=>{const G=P.text;return aa(i.date).findIndex(H=>H.year()===G)>=0},F=P=>{var G;const H=(G=P.target)==null?void 0:G.closest("td");if(!H||!H.textContent||wa(H,"disabled"))return;const Y=H.cellIndex,W=H.parentNode.rowIndex*4+Y+b.value,O=cn().year(W);if(i.selectionMode==="range")i.rangeState.selecting?(i.minDate&&O>=i.minDate?o("pick",{minDate:i.minDate,maxDate:O}):o("pick",{minDate:O,maxDate:i.minDate}),o("select",!1)):(o("pick",{minDate:O,maxDate:null}),o("select",!0));else if(i.selectionMode==="years"){if(P.type==="keydown"){o("pick",aa(i.parsedValue),!1);return}const Q=sO(O.startOf("year"),p.value,i.disabledDate),J=wa(H,"current")?aa(i.parsedValue).filter(oe=>(oe==null?void 0:oe.year())!==W):aa(i.parsedValue).concat([Q]);o("pick",J)}else o("pick",W)},x=P=>{var G;if(!i.rangeState.selecting)return;const H=(G=P.target)==null?void 0:G.closest("td");if(!H)return;const Y=H.parentNode.rowIndex,j=H.cellIndex;R.value[Y][j].disabled||(Y!==k.value||j!==M.value)&&(k.value=Y,M.value=j,o("changerange",{selecting:!0,endDate:cn().year(b.value).add(Y*4+j,"year")}))};return st(()=>i.date,async()=>{var P,G;(P=v.value)!=null&&P.contains(document.activeElement)&&(await Vt(),(G=_.value)==null||G.focus())}),t({focus:w}),(P,G)=>(ee(),ge("table",{role:"grid","aria-label":y(f)("el.datepicker.yearTablePrompt"),class:ne(y(u).b()),onClick:F,onMousemove:x},[Ee("tbody",{ref_key:"tbodyRef",ref:v},[(ee(!0),ge(Ht,null,Un(y(R),(H,Y)=>(ee(),ge("tr",{key:Y},[(ee(!0),ge(Ht,null,Un(H,(j,W)=>(ee(),ge("td",{key:`${Y}_${W}`,ref_for:!0,ref:O=>N(j)&&(_.value=O),class:ne(["available",E(j)]),"aria-selected":N(j),"aria-label":String(j.text),tabindex:N(j)?0:-1,onKeydown:[To(Zt(F,["prevent","stop"]),["space"]),To(Zt(F,["prevent","stop"]),["enter"])]},[Me(y(NN),{cell:j},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var dO=vt(s1e,[["__file","basic-year-table.vue"]]);const l1e=Te({__name:"panel-date-pick",props:JTe,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const o=e,i=(Ne,qe,ke)=>!0,c=ut("picker-panel"),u=ut("date-picker"),f=uu(),p=Qr(),{t:v,lang:_}=Kn(),b=Rt("EP_PICKER_BASE"),S=Rt("ElIsDefaultFormat"),k=Rt($T),{shortcuts:M,disabledDate:R,cellClassName:w,defaultTime:E}=b.props,N=uo(b.props,"defaultValue"),F=le(),x=le(cn().locale(_.value)),P=le(!1);let G=!1;const H=z(()=>cn(E).locale(_.value)),Y=z(()=>x.value.month()),j=z(()=>x.value.year()),W=le([]),O=le(null),Q=le(null),J=Ne=>W.value.length>0?i(Ne,W.value,o.format||"HH:mm:ss"):!0,oe=Ne=>E&&!je.value&&!P.value&&!G?H.value.year(Ne.year()).month(Ne.month()).date(Ne.date()):xe.value?Ne.millisecond(0):Ne.startOf("day"),pe=(Ne,...qe)=>{if(!Ne)t("pick",Ne,...qe);else if(ht(Ne)){const ke=Ne.map(oe);t("pick",ke,...qe)}else t("pick",oe(Ne),...qe);O.value=null,Q.value=null,P.value=!1,G=!1},ie=async(Ne,qe)=>{if(ue.value==="date"){Ne=Ne;let ke=o.parsedValue?o.parsedValue.year(Ne.year()).month(Ne.month()).date(Ne.date()):Ne;J(ke)||(ke=W.value[0][0].year(Ne.year()).month(Ne.month()).date(Ne.date())),x.value=ke,pe(ke,xe.value||qe),o.type==="datetime"&&(await Vt(),Sn())}else ue.value==="week"?pe(Ne.date):ue.value==="dates"&&pe(Ne,!0)},te=Ne=>{const qe=Ne?"add":"subtract";x.value=x.value[qe](1,"month"),vn("month")},he=Ne=>{const qe=x.value,ke=Ne?"add":"subtract";x.value=re.value==="year"?qe[ke](10,"year"):qe[ke](1,"year"),vn("year")},re=le("date"),X=z(()=>{const Ne=v("el.datepicker.year");if(re.value==="year"){const qe=Math.floor(j.value/10)*10;return Ne?`${qe} ${Ne} - ${qe+9} ${Ne}`:`${qe} - ${qe+9}`}return`${j.value} ${Ne}`}),ye=Ne=>{const qe=zt(Ne.value)?Ne.value():Ne.value;if(qe){G=!0,pe(cn(qe).locale(_.value));return}Ne.onClick&&Ne.onClick({attrs:f,slots:p,emit:t})},ue=z(()=>{const{type:Ne}=o;return["week","month","months","year","years","dates"].includes(Ne)?Ne:"date"}),Ie=z(()=>ue.value==="dates"||ue.value==="months"||ue.value==="years"),ve=z(()=>ue.value==="date"?re.value:ue.value),Ce=z(()=>!!M.length),Fe=async(Ne,qe)=>{ue.value==="month"?(x.value=U0(x.value.year(),Ne,_.value,R),pe(x.value,!1)):ue.value==="months"?pe(Ne,qe??!0):(x.value=U0(x.value.year(),Ne,_.value,R),re.value="date",["month","year","date","week"].includes(ue.value)&&(pe(x.value,!0),await Vt(),Sn())),vn("month")},Oe=async(Ne,qe)=>{if(ue.value==="year"){const ke=x.value.startOf("year").year(Ne);x.value=sO(ke,_.value,R),pe(x.value,!1)}else if(ue.value==="years")pe(Ne,qe??!0);else{const ke=x.value.year(Ne);x.value=sO(ke,_.value,R),re.value="month",["month","year","date","week"].includes(ue.value)&&(pe(x.value,!0),await Vt(),Sn())}vn("year")},be=async Ne=>{re.value=Ne,await Vt(),Sn()},xe=z(()=>o.type==="datetime"||o.type==="datetimerange"),Le=z(()=>{const Ne=xe.value||ue.value==="dates",qe=ue.value==="years",ke=ue.value==="months",ot=re.value==="date",tn=re.value==="year",Nt=re.value==="month";return Ne&&ot||qe&&tn||ke&&Nt}),rt=z(()=>R?o.parsedValue?ht(o.parsedValue)?R(o.parsedValue[0].toDate()):R(o.parsedValue.toDate()):!0:!1),Qe=()=>{if(Ie.value)pe(o.parsedValue);else{let Ne=o.parsedValue;if(!Ne){const qe=cn(E).locale(_.value),ke=dn();Ne=qe.year(ke.year()).month(ke.month()).date(ke.date())}x.value=Ne,pe(Ne)}},Ge=z(()=>R?R(cn().locale(_.value).toDate()):!1),_e=()=>{const qe=cn().locale(_.value).toDate();P.value=!0,(!R||!R(qe))&&J(qe)&&(x.value=cn().locale(_.value),pe(x.value))},Re=z(()=>o.timeFormat||JK(o.format)),Ke=z(()=>o.dateFormat||YK(o.format)),je=z(()=>{if(Q.value)return Q.value;if(!(!o.parsedValue&&!N.value))return(o.parsedValue||x.value).format(Re.value)}),ze=z(()=>{if(O.value)return O.value;if(!(!o.parsedValue&&!N.value))return(o.parsedValue||x.value).format(Ke.value)}),nt=le(!1),it=()=>{nt.value=!0},dt=()=>{nt.value=!1},gt=Ne=>({hour:Ne.hour(),minute:Ne.minute(),second:Ne.second(),year:Ne.year(),month:Ne.month(),date:Ne.date()}),ft=(Ne,qe,ke)=>{const{hour:ot,minute:tn,second:Nt}=gt(Ne),Dn=o.parsedValue?o.parsedValue.hour(ot).minute(tn).second(Nt):Ne;x.value=Dn,pe(x.value,!0),ke||(nt.value=qe)},Mt=Ne=>{const qe=cn(Ne,Re.value).locale(_.value);if(qe.isValid()&&J(qe)){const{year:ke,month:ot,date:tn}=gt(x.value);x.value=qe.year(ke).month(ot).date(tn),Q.value=null,nt.value=!1,pe(x.value,!0)}},lt=Ne=>{const qe=ev(Ne,Ke.value,_.value,S);if(qe.isValid()){if(R&&R(qe.toDate()))return;const{hour:ke,minute:ot,second:tn}=gt(x.value);x.value=qe.hour(ke).minute(ot).second(tn),O.value=null,pe(x.value,!0)}},Et=Ne=>cn.isDayjs(Ne)&&Ne.isValid()&&(R?!R(Ne.toDate()):!0),Yt=Ne=>ht(Ne)?Ne.map(qe=>qe.format(o.format)):Ne.format(o.format),sn=Ne=>ev(Ne,o.format,_.value,S),dn=()=>{const Ne=cn(N.value).locale(_.value);if(!N.value){const qe=H.value;return cn().hour(qe.hour()).minute(qe.minute()).second(qe.second()).locale(_.value)}return Ne},Sn=()=>{var Ne;["week","month","year","date"].includes(ue.value)&&((Ne=F.value)==null||Ne.focus())},yn=()=>{Sn(),ue.value==="week"&&Xt(At.down)},fo=Ne=>{const{code:qe}=Ne;[At.up,At.down,At.left,At.right,At.home,At.end,At.pageUp,At.pageDown].includes(qe)&&(Xt(qe),Ne.stopPropagation(),Ne.preventDefault()),[At.enter,At.space,At.numpadEnter].includes(qe)&&O.value===null&&Q.value===null&&(Ne.preventDefault(),pe(x.value,!1))},Xt=Ne=>{var qe;const{up:ke,down:ot,left:tn,right:Nt,home:Dn,end:dr,pageUp:io,pageDown:hr}=At,K={year:{[ke]:-4,[ot]:4,[tn]:-1,[Nt]:1,offset:(Gt,Ho)=>Gt.setFullYear(Gt.getFullYear()+Ho)},month:{[ke]:-4,[ot]:4,[tn]:-1,[Nt]:1,offset:(Gt,Ho)=>Gt.setMonth(Gt.getMonth()+Ho)},week:{[ke]:-1,[ot]:1,[tn]:-1,[Nt]:1,offset:(Gt,Ho)=>Gt.setDate(Gt.getDate()+Ho*7)},date:{[ke]:-7,[ot]:7,[tn]:-1,[Nt]:1,[Dn]:Gt=>-Gt.getDay(),[dr]:Gt=>-Gt.getDay()+6,[io]:Gt=>-new Date(Gt.getFullYear(),Gt.getMonth(),0).getDate(),[hr]:Gt=>new Date(Gt.getFullYear(),Gt.getMonth()+1,0).getDate(),offset:(Gt,Ho)=>Gt.setDate(Gt.getDate()+Ho)}},ri=x.value.toDate();for(;Math.abs(x.value.diff(ri,"year",!0))<1;){const Gt=K[ve.value];if(!Gt)return;if(Gt.offset(ri,zt(Gt[Ne])?Gt[Ne](ri):(qe=Gt[Ne])!=null?qe:0),R&&R(ri))break;const Ho=cn(ri).locale(_.value);x.value=Ho,t("pick",Ho,!0);break}},vn=Ne=>{t("panel-change",x.value.toDate(),Ne,re.value)};return st(()=>ue.value,Ne=>{if(["month","year"].includes(Ne)){re.value=Ne;return}else if(Ne==="years"){re.value="year";return}else if(Ne==="months"){re.value="month";return}re.value="date"},{immediate:!0}),st(()=>re.value,()=>{k==null||k.updatePopper()}),st(()=>N.value,Ne=>{Ne&&(x.value=dn())},{immediate:!0}),st(()=>o.parsedValue,Ne=>{if(Ne){if(Ie.value||ht(Ne))return;x.value=Ne}else x.value=dn()},{immediate:!0}),t("set-picker-option",["isValidValue",Et]),t("set-picker-option",["formatToString",Yt]),t("set-picker-option",["parseUserInput",sn]),t("set-picker-option",["handleFocusPicker",yn]),(Ne,qe)=>(ee(),ge("div",{class:ne([y(c).b(),y(u).b(),{"has-sidebar":Ne.$slots.sidebar||y(Ce),"has-time":y(xe)}])},[Ee("div",{class:ne(y(c).e("body-wrapper"))},[Ve(Ne.$slots,"sidebar",{class:ne(y(c).e("sidebar"))}),y(Ce)?(ee(),ge("div",{key:0,class:ne(y(c).e("sidebar"))},[(ee(!0),ge(Ht,null,Un(y(M),(ke,ot)=>(ee(),ge("button",{key:ot,type:"button",class:ne(y(c).e("shortcut")),onClick:tn=>ye(ke)},mt(ke.text),11,["onClick"]))),128))],2)):$e("v-if",!0),Ee("div",{class:ne(y(c).e("body"))},[y(xe)?(ee(),ge("div",{key:0,class:ne(y(u).e("time-header"))},[Ee("span",{class:ne(y(u).e("editor-wrap"))},[Me(y(Yi),{placeholder:y(v)("el.datepicker.selectDate"),"model-value":y(ze),size:"small","validate-event":!1,onInput:ke=>O.value=ke,onChange:lt},null,8,["placeholder","model-value","onInput"])],2),fn((ee(),ge("span",{class:ne(y(u).e("editor-wrap"))},[Me(y(Yi),{placeholder:y(v)("el.datepicker.selectTime"),"model-value":y(je),size:"small","validate-event":!1,onFocus:it,onInput:ke=>Q.value=ke,onChange:Mt},null,8,["placeholder","model-value","onInput"]),Me(y(JE),{visible:nt.value,format:y(Re),"parsed-value":x.value,onPick:ft},null,8,["visible","format","parsed-value"])],2)),[[y(lu),dt]])],2)):$e("v-if",!0),fn(Ee("div",{class:ne([y(u).e("header"),(re.value==="year"||re.value==="month")&&y(u).e("header--bordered")])},[Ee("span",{class:ne(y(u).e("prev-btn"))},[Ee("button",{type:"button","aria-label":y(v)("el.datepicker.prevYear"),class:ne(["d-arrow-left",y(c).e("icon-btn")]),onClick:ke=>he(!1)},[Ve(Ne.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["aria-label","onClick"]),fn(Ee("button",{type:"button","aria-label":y(v)("el.datepicker.prevMonth"),class:ne([y(c).e("icon-btn"),"arrow-left"]),onClick:ke=>te(!1)},[Ve(Ne.$slots,"prev-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1})])],10,["aria-label","onClick"]),[[Zn,re.value==="date"]])],2),Ee("span",{role:"button",class:ne(y(u).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:To(ke=>be("year"),["enter"]),onClick:ke=>be("year")},mt(y(X)),43,["onKeydown","onClick"]),fn(Ee("span",{role:"button","aria-live":"polite",tabindex:"0",class:ne([y(u).e("header-label"),{active:re.value==="month"}]),onKeydown:To(ke=>be("month"),["enter"]),onClick:ke=>be("month")},mt(y(v)(`el.datepicker.month${y(Y)+1}`)),43,["onKeydown","onClick"]),[[Zn,re.value==="date"]]),Ee("span",{class:ne(y(u).e("next-btn"))},[fn(Ee("button",{type:"button","aria-label":y(v)("el.datepicker.nextMonth"),class:ne([y(c).e("icon-btn"),"arrow-right"]),onClick:ke=>te(!0)},[Ve(Ne.$slots,"next-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})])],10,["aria-label","onClick"]),[[Zn,re.value==="date"]]),Ee("button",{type:"button","aria-label":y(v)("el.datepicker.nextYear"),class:ne([y(c).e("icon-btn"),"d-arrow-right"]),onClick:ke=>he(!0)},[Ve(Ne.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[Zn,re.value!=="time"]]),Ee("div",{class:ne(y(c).e("content")),onKeydown:fo},[re.value==="date"?(ee(),We(cO,{key:0,ref_key:"currentViewRef",ref:F,"selection-mode":y(ue),date:x.value,"parsed-value":Ne.parsedValue,"disabled-date":y(R),"cell-class-name":y(w),onPick:ie},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):$e("v-if",!0),re.value==="year"?(ee(),We(dO,{key:1,ref_key:"currentViewRef",ref:F,"selection-mode":y(ue),date:x.value,"disabled-date":y(R),"parsed-value":Ne.parsedValue,onPick:Oe},null,8,["selection-mode","date","disabled-date","parsed-value"])):$e("v-if",!0),re.value==="month"?(ee(),We(uO,{key:2,ref_key:"currentViewRef",ref:F,"selection-mode":y(ue),date:x.value,"parsed-value":Ne.parsedValue,"disabled-date":y(R),onPick:Fe},null,8,["selection-mode","date","parsed-value","disabled-date"])):$e("v-if",!0)],34)],2)],2),fn(Ee("div",{class:ne(y(c).e("footer"))},[fn(Me(y(di),{text:"",size:"small",class:ne(y(c).e("link-btn")),disabled:y(Ge),onClick:_e},{default:Ae(()=>[Mn(mt(y(v)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[Zn,!y(Ie)&&Ne.showNow]]),Me(y(di),{plain:"",size:"small",class:ne(y(c).e("link-btn")),disabled:y(rt),onClick:Qe},{default:Ae(()=>[Mn(mt(y(v)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[Zn,y(Le)]])],2))}});var c1e=vt(l1e,[["__file","panel-date-pick.vue"]]);const u1e=pt({...F9,...DN,visible:Boolean}),V9=e=>{const{emit:t}=kn(),o=uu(),i=Qr();return u=>{const f=zt(u.value)?u.value():u.value;if(f){t("pick",[cn(f[0]).locale(e.value),cn(f[1]).locale(e.value)]);return}u.onClick&&u.onClick({attrs:o,slots:i,emit:t})}},G9=(e,{defaultValue:t,leftDate:o,rightDate:i,unit:c,onParsedValueChanged:u})=>{const{emit:f}=kn(),{pickerNs:p}=Rt(zT),v=ut("date-range-picker"),{t:_,lang:b}=Kn(),S=V9(b),k=le(),M=le(),R=le({endDate:null,selecting:!1}),w=P=>{R.value=P},E=(P=!1)=>{const G=y(k),H=y(M);Qg([G,H])&&f("pick",[G,H],P)},N=P=>{R.value.selecting=P,P||(R.value.endDate=null)},F=P=>{if(ht(P)&&P.length===2){const[G,H]=P;k.value=G,o.value=G,M.value=H,u(y(k),y(M))}else x()},x=()=>{const[P,G]=LN(y(t),{lang:y(b),unit:c,unlinkPanels:e.unlinkPanels});k.value=void 0,M.value=void 0,o.value=P,i.value=G};return st(t,P=>{P&&x()},{immediate:!0}),st(()=>e.parsedValue,F,{immediate:!0}),{minDate:k,maxDate:M,rangeState:R,lang:b,ppNs:p,drpNs:v,handleChangeRange:w,handleRangeConfirm:E,handleShortcutClick:S,onSelect:N,onReset:F,t:_}},KS="month",d1e=Te({__name:"panel-date-range",props:u1e,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const o=e,i=Rt("EP_PICKER_BASE"),c=Rt("ElIsDefaultFormat"),{disabledDate:u,cellClassName:f,defaultTime:p,clearable:v}=i.props,_=uo(i.props,"format"),b=uo(i.props,"shortcuts"),S=uo(i.props,"defaultValue"),{lang:k}=Kn(),M=le(cn().locale(k.value)),R=le(cn().locale(k.value).add(1,KS)),{minDate:w,maxDate:E,rangeState:N,ppNs:F,drpNs:x,handleChangeRange:P,handleRangeConfirm:G,handleShortcutClick:H,onSelect:Y,onReset:j,t:W}=G9(o,{defaultValue:S,leftDate:M,rightDate:R,unit:KS,onParsedValueChanged:Ne});st(()=>o.visible,qe=>{!qe&&N.value.selecting&&(j(o.parsedValue),Y(!1))});const O=le({min:null,max:null}),Q=le({min:null,max:null}),J=z(()=>`${M.value.year()} ${W("el.datepicker.year")} ${W(`el.datepicker.month${M.value.month()+1}`)}`),oe=z(()=>`${R.value.year()} ${W("el.datepicker.year")} ${W(`el.datepicker.month${R.value.month()+1}`)}`),pe=z(()=>M.value.year()),ie=z(()=>M.value.month()),te=z(()=>R.value.year()),he=z(()=>R.value.month()),re=z(()=>!!b.value.length),X=z(()=>O.value.min!==null?O.value.min:w.value?w.value.format(Ce.value):""),ye=z(()=>O.value.max!==null?O.value.max:E.value||w.value?(E.value||w.value).format(Ce.value):""),ue=z(()=>Q.value.min!==null?Q.value.min:w.value?w.value.format(ve.value):""),Ie=z(()=>Q.value.max!==null?Q.value.max:E.value||w.value?(E.value||w.value).format(ve.value):""),ve=z(()=>o.timeFormat||JK(_.value)),Ce=z(()=>o.dateFormat||YK(_.value)),Fe=qe=>Qg(qe)&&(u?!u(qe[0].toDate())&&!u(qe[1].toDate()):!0),Oe=()=>{M.value=M.value.subtract(1,"year"),o.unlinkPanels||(R.value=M.value.add(1,"month")),Re("year")},be=()=>{M.value=M.value.subtract(1,"month"),o.unlinkPanels||(R.value=M.value.add(1,"month")),Re("month")},xe=()=>{o.unlinkPanels?R.value=R.value.add(1,"year"):(M.value=M.value.add(1,"year"),R.value=M.value.add(1,"month")),Re("year")},Le=()=>{o.unlinkPanels?R.value=R.value.add(1,"month"):(M.value=M.value.add(1,"month"),R.value=M.value.add(1,"month")),Re("month")},rt=()=>{M.value=M.value.add(1,"year"),Re("year")},Qe=()=>{M.value=M.value.add(1,"month"),Re("month")},Ge=()=>{R.value=R.value.subtract(1,"year"),Re("year")},_e=()=>{R.value=R.value.subtract(1,"month"),Re("month")},Re=qe=>{t("panel-change",[M.value.toDate(),R.value.toDate()],qe)},Ke=z(()=>{const qe=(ie.value+1)%12,ke=ie.value+1>=12?1:0;return o.unlinkPanels&&new Date(pe.value+ke,qe)<new Date(te.value,he.value)}),je=z(()=>o.unlinkPanels&&te.value*12+he.value-(pe.value*12+ie.value+1)>=12),ze=z(()=>!(w.value&&E.value&&!N.value.selecting&&Qg([w.value,E.value]))),nt=z(()=>o.type==="datetime"||o.type==="datetimerange"),it=(qe,ke)=>{if(qe)return p?cn(p[ke]||p).locale(k.value).year(qe.year()).month(qe.month()).date(qe.date()):qe},dt=(qe,ke=!0)=>{const ot=qe.minDate,tn=qe.maxDate,Nt=it(ot,0),Dn=it(tn,1);E.value===Dn&&w.value===Nt||(t("calendar-change",[ot.toDate(),tn&&tn.toDate()]),E.value=Dn,w.value=Nt,!(!ke||nt.value)&&G())},gt=le(!1),ft=le(!1),Mt=()=>{gt.value=!1},lt=()=>{ft.value=!1},Et=(qe,ke)=>{O.value[ke]=qe;const ot=cn(qe,Ce.value).locale(k.value);if(ot.isValid()){if(u&&u(ot.toDate()))return;ke==="min"?(M.value=ot,w.value=(w.value||M.value).year(ot.year()).month(ot.month()).date(ot.date()),!o.unlinkPanels&&(!E.value||E.value.isBefore(w.value))&&(R.value=ot.add(1,"month"),E.value=w.value.add(1,"month"))):(R.value=ot,E.value=(E.value||R.value).year(ot.year()).month(ot.month()).date(ot.date()),!o.unlinkPanels&&(!w.value||w.value.isAfter(E.value))&&(M.value=ot.subtract(1,"month"),w.value=E.value.subtract(1,"month")))}},Yt=(qe,ke)=>{O.value[ke]=null},sn=(qe,ke)=>{Q.value[ke]=qe;const ot=cn(qe,ve.value).locale(k.value);ot.isValid()&&(ke==="min"?(gt.value=!0,w.value=(w.value||M.value).hour(ot.hour()).minute(ot.minute()).second(ot.second())):(ft.value=!0,E.value=(E.value||R.value).hour(ot.hour()).minute(ot.minute()).second(ot.second()),R.value=E.value))},dn=(qe,ke)=>{Q.value[ke]=null,ke==="min"?(M.value=w.value,gt.value=!1,(!E.value||E.value.isBefore(w.value))&&(E.value=w.value)):(R.value=E.value,ft.value=!1,E.value&&E.value.isBefore(w.value)&&(w.value=E.value))},Sn=(qe,ke,ot)=>{Q.value.min||(qe&&(M.value=qe,w.value=(w.value||M.value).hour(qe.hour()).minute(qe.minute()).second(qe.second())),ot||(gt.value=ke),(!E.value||E.value.isBefore(w.value))&&(E.value=w.value,R.value=qe))},yn=(qe,ke,ot)=>{Q.value.max||(qe&&(R.value=qe,E.value=(E.value||R.value).hour(qe.hour()).minute(qe.minute()).second(qe.second())),ot||(ft.value=ke),E.value&&E.value.isBefore(w.value)&&(w.value=E.value))},fo=()=>{M.value=LN(y(S),{lang:y(k),unit:"month",unlinkPanels:o.unlinkPanels})[0],R.value=M.value.add(1,"month"),E.value=void 0,w.value=void 0,t("pick",null)},Xt=qe=>ht(qe)?qe.map(ke=>ke.format(_.value)):qe.format(_.value),vn=qe=>ev(qe,_.value,k.value,c);function Ne(qe,ke){if(o.unlinkPanels&&ke){const ot=(qe==null?void 0:qe.year())||0,tn=(qe==null?void 0:qe.month())||0,Nt=ke.year(),Dn=ke.month();R.value=ot===Nt&&tn===Dn?ke.add(1,KS):ke}else R.value=M.value.add(1,KS),ke&&(R.value=R.value.hour(ke.hour()).minute(ke.minute()).second(ke.second()))}return t("set-picker-option",["isValidValue",Fe]),t("set-picker-option",["parseUserInput",vn]),t("set-picker-option",["formatToString",Xt]),t("set-picker-option",["handleClear",fo]),(qe,ke)=>(ee(),ge("div",{class:ne([y(F).b(),y(x).b(),{"has-sidebar":qe.$slots.sidebar||y(re),"has-time":y(nt)}])},[Ee("div",{class:ne(y(F).e("body-wrapper"))},[Ve(qe.$slots,"sidebar",{class:ne(y(F).e("sidebar"))}),y(re)?(ee(),ge("div",{key:0,class:ne(y(F).e("sidebar"))},[(ee(!0),ge(Ht,null,Un(y(b),(ot,tn)=>(ee(),ge("button",{key:tn,type:"button",class:ne(y(F).e("shortcut")),onClick:Nt=>y(H)(ot)},mt(ot.text),11,["onClick"]))),128))],2)):$e("v-if",!0),Ee("div",{class:ne(y(F).e("body"))},[y(nt)?(ee(),ge("div",{key:0,class:ne(y(x).e("time-header"))},[Ee("span",{class:ne(y(x).e("editors-wrap"))},[Ee("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Yi),{size:"small",disabled:y(N).selecting,placeholder:y(W)("el.datepicker.startDate"),class:ne(y(x).e("editor")),"model-value":y(X),"validate-event":!1,onInput:ot=>Et(ot,"min"),onChange:ot=>Yt(ot,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),fn((ee(),ge("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Yi),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(W)("el.datepicker.startTime"),"model-value":y(ue),"validate-event":!1,onFocus:ot=>gt.value=!0,onInput:ot=>sn(ot,"min"),onChange:ot=>dn(ot,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),Me(y(JE),{visible:gt.value,format:y(ve),"datetime-role":"start","parsed-value":M.value,onPick:Sn},null,8,["visible","format","parsed-value"])],2)),[[y(lu),Mt]])],2),Ee("span",null,[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})]),Ee("span",{class:ne([y(x).e("editors-wrap"),"is-right"])},[Ee("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Yi),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(W)("el.datepicker.endDate"),"model-value":y(ye),readonly:!y(w),"validate-event":!1,onInput:ot=>Et(ot,"max"),onChange:ot=>Yt(ot,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),fn((ee(),ge("span",{class:ne(y(x).e("time-picker-wrap"))},[Me(y(Yi),{size:"small",class:ne(y(x).e("editor")),disabled:y(N).selecting,placeholder:y(W)("el.datepicker.endTime"),"model-value":y(Ie),readonly:!y(w),"validate-event":!1,onFocus:ot=>y(w)&&(ft.value=!0),onInput:ot=>sn(ot,"max"),onChange:ot=>dn(ot,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),Me(y(JE),{"datetime-role":"end",visible:ft.value,format:y(ve),"parsed-value":R.value,onPick:yn},null,8,["visible","format","parsed-value"])],2)),[[y(lu),lt]])],2)],2)):$e("v-if",!0),Ee("div",{class:ne([[y(F).e("content"),y(x).e("content")],"is-left"])},[Ee("div",{class:ne(y(x).e("header"))},[Ee("button",{type:"button",class:ne([y(F).e("icon-btn"),"d-arrow-left"]),"aria-label":y(W)("el.datepicker.prevYear"),onClick:Oe},[Ve(qe.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["aria-label"]),Ee("button",{type:"button",class:ne([y(F).e("icon-btn"),"arrow-left"]),"aria-label":y(W)("el.datepicker.prevMonth"),onClick:be},[Ve(qe.$slots,"prev-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1})])],10,["aria-label"]),qe.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(je),class:ne([[y(F).e("icon-btn"),{"is-disabled":!y(je)}],"d-arrow-right"]),"aria-label":y(W)("el.datepicker.nextYear"),onClick:rt},[Ve(qe.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["disabled","aria-label"])):$e("v-if",!0),qe.unlinkPanels?(ee(),ge("button",{key:1,type:"button",disabled:!y(Ke),class:ne([[y(F).e("icon-btn"),{"is-disabled":!y(Ke)}],"arrow-right"]),"aria-label":y(W)("el.datepicker.nextMonth"),onClick:Qe},[Ve(qe.$slots,"next-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})])],10,["disabled","aria-label"])):$e("v-if",!0),Ee("div",null,mt(y(J)),1)],2),Me(cO,{"selection-mode":"range",date:M.value,"min-date":y(w),"max-date":y(E),"range-state":y(N),"disabled-date":y(u),"cell-class-name":y(f),onChangerange:y(P),onPick:dt,onSelect:y(Y)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ee("div",{class:ne([[y(F).e("content"),y(x).e("content")],"is-right"])},[Ee("div",{class:ne(y(x).e("header"))},[qe.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(je),class:ne([[y(F).e("icon-btn"),{"is-disabled":!y(je)}],"d-arrow-left"]),"aria-label":y(W)("el.datepicker.prevYear"),onClick:Ge},[Ve(qe.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["disabled","aria-label"])):$e("v-if",!0),qe.unlinkPanels?(ee(),ge("button",{key:1,type:"button",disabled:!y(Ke),class:ne([[y(F).e("icon-btn"),{"is-disabled":!y(Ke)}],"arrow-left"]),"aria-label":y(W)("el.datepicker.prevMonth"),onClick:_e},[Ve(qe.$slots,"prev-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1})])],10,["disabled","aria-label"])):$e("v-if",!0),Ee("button",{type:"button","aria-label":y(W)("el.datepicker.nextYear"),class:ne([y(F).e("icon-btn"),"d-arrow-right"]),onClick:xe},[Ve(qe.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["aria-label"]),Ee("button",{type:"button",class:ne([y(F).e("icon-btn"),"arrow-right"]),"aria-label":y(W)("el.datepicker.nextMonth"),onClick:Le},[Ve(qe.$slots,"next-month",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})])],10,["aria-label"]),Ee("div",null,mt(y(oe)),1)],2),Me(cO,{"selection-mode":"range",date:R.value,"min-date":y(w),"max-date":y(E),"range-state":y(N),"disabled-date":y(u),"cell-class-name":y(f),onChangerange:y(P),onPick:dt,onSelect:y(Y)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(nt)?(ee(),ge("div",{key:0,class:ne(y(F).e("footer"))},[y(v)?(ee(),We(y(di),{key:0,text:"",size:"small",class:ne(y(F).e("link-btn")),onClick:fo},{default:Ae(()=>[Mn(mt(y(W)("el.datepicker.clear")),1)]),_:1},8,["class"])):$e("v-if",!0),Me(y(di),{plain:"",size:"small",class:ne(y(F).e("link-btn")),disabled:y(ze),onClick:ot=>y(G)(!1)},{default:Ae(()=>[Mn(mt(y(W)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):$e("v-if",!0)],2))}});var h1e=vt(d1e,[["__file","panel-date-range.vue"]]);const f1e=pt({...DN}),p1e=["pick","set-picker-option","calendar-change"],m1e=({unlinkPanels:e,leftDate:t,rightDate:o})=>{const{t:i}=Kn(),c=()=>{t.value=t.value.subtract(1,"year"),e.value||(o.value=o.value.subtract(1,"year"))},u=()=>{e.value||(t.value=t.value.add(1,"year")),o.value=o.value.add(1,"year")},f=()=>{t.value=t.value.add(1,"year")},p=()=>{o.value=o.value.subtract(1,"year")},v=z(()=>`${t.value.year()} ${i("el.datepicker.year")}`),_=z(()=>`${o.value.year()} ${i("el.datepicker.year")}`),b=z(()=>t.value.year()),S=z(()=>o.value.year()===t.value.year()?t.value.year()+1:o.value.year());return{leftPrevYear:c,rightNextYear:u,leftNextYear:f,rightPrevYear:p,leftLabel:v,rightLabel:_,leftYear:b,rightYear:S}},zS="year",g1e=Te({name:"DatePickerMonthRange"}),v1e=Te({...g1e,props:f1e,emits:p1e,setup(e,{emit:t}){const o=e,{lang:i}=Kn(),c=Rt("EP_PICKER_BASE"),u=Rt("ElIsDefaultFormat"),{shortcuts:f,disabledDate:p}=c.props,v=uo(c.props,"format"),_=uo(c.props,"defaultValue"),b=le(cn().locale(i.value)),S=le(cn().locale(i.value).add(1,zS)),{minDate:k,maxDate:M,rangeState:R,ppNs:w,drpNs:E,handleChangeRange:N,handleRangeConfirm:F,handleShortcutClick:x,onSelect:P}=G9(o,{defaultValue:_,leftDate:b,rightDate:S,unit:zS,onParsedValueChanged:X}),G=z(()=>!!f.length),{leftPrevYear:H,rightNextYear:Y,leftNextYear:j,rightPrevYear:W,leftLabel:O,rightLabel:Q,leftYear:J,rightYear:oe}=m1e({unlinkPanels:uo(o,"unlinkPanels"),leftDate:b,rightDate:S}),pe=z(()=>o.unlinkPanels&&oe.value>J.value+1),ie=(ye,ue=!0)=>{const Ie=ye.minDate,ve=ye.maxDate;M.value===ve&&k.value===Ie||(t("calendar-change",[Ie.toDate(),ve&&ve.toDate()]),M.value=ve,k.value=Ie,ue&&F())},te=()=>{b.value=LN(y(_),{lang:y(i),unit:"year",unlinkPanels:o.unlinkPanels})[0],S.value=b.value.add(1,"year"),t("pick",null)},he=ye=>ht(ye)?ye.map(ue=>ue.format(v.value)):ye.format(v.value),re=ye=>ev(ye,v.value,i.value,u);function X(ye,ue){if(o.unlinkPanels&&ue){const Ie=(ye==null?void 0:ye.year())||0,ve=ue.year();S.value=Ie===ve?ue.add(1,zS):ue}else S.value=b.value.add(1,zS)}return t("set-picker-option",["isValidValue",Qg]),t("set-picker-option",["formatToString",he]),t("set-picker-option",["parseUserInput",re]),t("set-picker-option",["handleClear",te]),(ye,ue)=>(ee(),ge("div",{class:ne([y(w).b(),y(E).b(),{"has-sidebar":!!ye.$slots.sidebar||y(G)}])},[Ee("div",{class:ne(y(w).e("body-wrapper"))},[Ve(ye.$slots,"sidebar",{class:ne(y(w).e("sidebar"))}),y(G)?(ee(),ge("div",{key:0,class:ne(y(w).e("sidebar"))},[(ee(!0),ge(Ht,null,Un(y(f),(Ie,ve)=>(ee(),ge("button",{key:ve,type:"button",class:ne(y(w).e("shortcut")),onClick:Ce=>y(x)(Ie)},mt(Ie.text),11,["onClick"]))),128))],2)):$e("v-if",!0),Ee("div",{class:ne(y(w).e("body"))},[Ee("div",{class:ne([[y(w).e("content"),y(E).e("content")],"is-left"])},[Ee("div",{class:ne(y(E).e("header"))},[Ee("button",{type:"button",class:ne([y(w).e("icon-btn"),"d-arrow-left"]),onClick:y(H)},[Ve(ye.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["onClick"]),ye.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(pe),class:ne([[y(w).e("icon-btn"),{[y(w).is("disabled")]:!y(pe)}],"d-arrow-right"]),onClick:y(j)},[Ve(ye.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["disabled","onClick"])):$e("v-if",!0),Ee("div",null,mt(y(O)),1)],2),Me(uO,{"selection-mode":"range",date:b.value,"min-date":y(k),"max-date":y(M),"range-state":y(R),"disabled-date":y(p),onChangerange:y(N),onPick:ie,onSelect:y(P)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ee("div",{class:ne([[y(w).e("content"),y(E).e("content")],"is-right"])},[Ee("div",{class:ne(y(E).e("header"))},[ye.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(pe),class:ne([[y(w).e("icon-btn"),{"is-disabled":!y(pe)}],"d-arrow-left"]),onClick:y(W)},[Ve(ye.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["disabled","onClick"])):$e("v-if",!0),Ee("button",{type:"button",class:ne([y(w).e("icon-btn"),"d-arrow-right"]),onClick:y(Y)},[Ve(ye.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["onClick"]),Ee("div",null,mt(y(Q)),1)],2),Me(uO,{"selection-mode":"range",date:S.value,"min-date":y(k),"max-date":y(M),"range-state":y(R),"disabled-date":y(p),onChangerange:y(N),onPick:ie,onSelect:y(P)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var _1e=vt(v1e,[["__file","panel-month-range.vue"]]);const y1e=pt({...DN}),I1e=["pick","set-picker-option","calendar-change"],b1e=({unlinkPanels:e,leftDate:t,rightDate:o})=>{const i=()=>{t.value=t.value.subtract(10,"year"),e.value||(o.value=o.value.subtract(10,"year"))},c=()=>{e.value||(t.value=t.value.add(10,"year")),o.value=o.value.add(10,"year")},u=()=>{t.value=t.value.add(10,"year")},f=()=>{o.value=o.value.subtract(10,"year")},p=z(()=>{const S=Math.floor(t.value.year()/10)*10;return`${S}-${S+9}`}),v=z(()=>{const S=Math.floor(o.value.year()/10)*10;return`${S}-${S+9}`}),_=z(()=>Math.floor(t.value.year()/10)*10+9),b=z(()=>Math.floor(o.value.year()/10)*10);return{leftPrevYear:i,rightNextYear:c,leftNextYear:u,rightPrevYear:f,leftLabel:p,rightLabel:v,leftYear:_,rightYear:b}},AB="year",C1e=Te({name:"DatePickerYearRange"}),S1e=Te({...C1e,props:y1e,emits:I1e,setup(e,{emit:t}){const o=e,{lang:i}=Kn(),c=le(cn().locale(i.value)),u=le(c.value.add(10,"year")),{pickerNs:f}=Rt(zT),p=ut("date-range-picker"),v=Rt("isDefaultFormat"),_=z(()=>!!ie.length),b=z(()=>[f.b(),p.b(),{"has-sidebar":!!Qr().sidebar||_.value}]),S=z(()=>({content:[f.e("content"),p.e("content"),"is-left"],arrowLeftBtn:[f.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[f.e("icon-btn"),{[f.is("disabled")]:!H.value},"d-arrow-right"]})),k=z(()=>({content:[f.e("content"),p.e("content"),"is-right"],arrowLeftBtn:[f.e("icon-btn"),{"is-disabled":!H.value},"d-arrow-left"],arrowRightBtn:[f.e("icon-btn"),"d-arrow-right"]})),M=V9(i),{leftPrevYear:R,rightNextYear:w,leftNextYear:E,rightPrevYear:N,leftLabel:F,rightLabel:x,leftYear:P,rightYear:G}=b1e({unlinkPanels:uo(o,"unlinkPanels"),leftDate:c,rightDate:u}),H=z(()=>o.unlinkPanels&&G.value>P.value+1),Y=le(),j=le(),W=le({endDate:null,selecting:!1}),O=Ce=>{W.value=Ce},Q=(Ce,Fe=!0)=>{const Oe=Ce.minDate,be=Ce.maxDate;j.value===be&&Y.value===Oe||(t("calendar-change",[Oe.toDate(),be&&be.toDate()]),j.value=be,Y.value=Oe,Fe&&J())},J=(Ce=!1)=>{Qg([Y.value,j.value])&&t("pick",[Y.value,j.value],Ce)},oe=Ce=>{W.value.selecting=Ce,Ce||(W.value.endDate=null)},pe=Rt("EP_PICKER_BASE"),{shortcuts:ie,disabledDate:te}=pe.props,he=uo(pe.props,"format"),re=uo(pe.props,"defaultValue"),X=()=>{let Ce;if(ht(re.value)){const Fe=cn(re.value[0]);let Oe=cn(re.value[1]);return o.unlinkPanels||(Oe=Fe.add(10,AB)),[Fe,Oe]}else re.value?Ce=cn(re.value):Ce=cn();return Ce=Ce.locale(i.value),[Ce,Ce.add(10,AB)]};st(()=>re.value,Ce=>{if(Ce){const Fe=X();c.value=Fe[0],u.value=Fe[1]}},{immediate:!0}),st(()=>o.parsedValue,Ce=>{if(Ce&&Ce.length===2)if(Y.value=Ce[0],j.value=Ce[1],c.value=Y.value,o.unlinkPanels&&j.value){const Fe=Y.value.year(),Oe=j.value.year();u.value=Fe===Oe?j.value.add(10,"year"):j.value}else u.value=c.value.add(10,"year");else{const Fe=X();Y.value=void 0,j.value=void 0,c.value=Fe[0],u.value=Fe[1]}},{immediate:!0});const ye=Ce=>ev(Ce,he.value,i.value,v),ue=Ce=>ht(Ce)?Ce.map(Fe=>Fe.format(he.value)):Ce.format(he.value),Ie=Ce=>Qg(Ce)&&(te?!te(Ce[0].toDate())&&!te(Ce[1].toDate()):!0),ve=()=>{const Ce=X();c.value=Ce[0],u.value=Ce[1],j.value=void 0,Y.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",Ie]),t("set-picker-option",["parseUserInput",ye]),t("set-picker-option",["formatToString",ue]),t("set-picker-option",["handleClear",ve]),(Ce,Fe)=>(ee(),ge("div",{class:ne(y(b))},[Ee("div",{class:ne(y(f).e("body-wrapper"))},[Ve(Ce.$slots,"sidebar",{class:ne(y(f).e("sidebar"))}),y(_)?(ee(),ge("div",{key:0,class:ne(y(f).e("sidebar"))},[(ee(!0),ge(Ht,null,Un(y(ie),(Oe,be)=>(ee(),ge("button",{key:be,type:"button",class:ne(y(f).e("shortcut")),onClick:xe=>y(M)(Oe)},mt(Oe.text),11,["onClick"]))),128))],2)):$e("v-if",!0),Ee("div",{class:ne(y(f).e("body"))},[Ee("div",{class:ne(y(S).content)},[Ee("div",{class:ne(y(p).e("header"))},[Ee("button",{type:"button",class:ne(y(S).arrowLeftBtn),onClick:y(R)},[Ve(Ce.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["onClick"]),Ce.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(H),class:ne(y(S).arrowRightBtn),onClick:y(E)},[Ve(Ce.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["disabled","onClick"])):$e("v-if",!0),Ee("div",null,mt(y(F)),1)],2),Me(dO,{"selection-mode":"range",date:c.value,"min-date":Y.value,"max-date":j.value,"range-state":W.value,"disabled-date":y(te),onChangerange:O,onPick:Q,onSelect:oe},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),Ee("div",{class:ne(y(k).content)},[Ee("div",{class:ne(y(p).e("header"))},[Ce.unlinkPanels?(ee(),ge("button",{key:0,type:"button",disabled:!y(H),class:ne(y(k).arrowLeftBtn),onClick:y(N)},[Ve(Ce.$slots,"prev-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Jd))]),_:1})])],10,["disabled","onClick"])):$e("v-if",!0),Ee("button",{type:"button",class:ne(y(k).arrowRightBtn),onClick:y(w)},[Ve(Ce.$slots,"next-year",{},()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Xd))]),_:1})])],10,["onClick"]),Ee("div",null,mt(y(x)),1)],2),Me(dO,{"selection-mode":"range",date:u.value,"min-date":Y.value,"max-date":j.value,"range-state":W.value,"disabled-date":y(te),onChangerange:O,onPick:Q,onSelect:oe},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var E1e=vt(S1e,[["__file","panel-year-range.vue"]]);const T1e=function(e){switch(e){case"daterange":case"datetimerange":return h1e;case"monthrange":return _1e;case"yearrange":return E1e;default:return c1e}};cn.extend(ZK);cn.extend(yTe);cn.extend(wN);cn.extend(bTe);cn.extend(STe);cn.extend(TTe);cn.extend(kTe);cn.extend(RTe);var M1e=Te({name:"ElDatePicker",install:null,props:jTe,emits:[nn],setup(e,{expose:t,emit:o,slots:i}){const c=ut("picker-panel"),u=z(()=>!e.format);Nn("ElIsDefaultFormat",u),Nn("ElPopperOptions",eo(uo(e,"popperOptions"))),Nn(zT,{slots:i,pickerNs:c});const f=le();t({focus:()=>{var _;(_=f.value)==null||_.focus()},blur:()=>{var _;(_=f.value)==null||_.blur()},handleOpen:()=>{var _;(_=f.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=f.value)==null||_.handleClose()}});const v=_=>{o(nn,_)};return()=>{var _;const b=(_=e.format)!=null?_:ATe[e.type]||gg,S=T1e(e.type);return Me(L9,An(e,{format:b,type:e.type,ref:f,"onUpdate:modelValue":v}),{default:k=>Me(S,k,{"prev-month":i["prev-month"],"next-month":i["next-month"],"prev-year":i["prev-year"],"next-year":i["next-year"]}),"range-separator":i["range-separator"]})}}});const k1e=un(M1e),PN=Symbol("elDescriptions");var Ny=Te({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:Rt(PN,{})}},render(){var e;const t=FCe(this.cell),o=(((e=this.cell)==null?void 0:e.dirs)||[]).map(N=>{const{dir:F,arg:x,modifiers:P,value:G}=N;return[F,G,x,P]}),{border:i,direction:c}=this.descriptions,u=c==="vertical",f=()=>{var N,F,x;return((x=(F=(N=this.cell)==null?void 0:N.children)==null?void 0:F.label)==null?void 0:x.call(F))||t.label},p=()=>{var N,F,x;return(x=(F=(N=this.cell)==null?void 0:N.children)==null?void 0:F.default)==null?void 0:x.call(F)},v=t.span,_=t.rowspan,b=t.align?`is-${t.align}`:"",S=t.labelAlign?`is-${t.labelAlign}`:b,k=t.className,M=t.labelClassName,R=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,w={width:ur(R),minWidth:ur(t.minWidth)},E=ut("descriptions");switch(this.type){case"label":return fn(Jt(this.tag,{style:w,class:[E.e("cell"),E.e("label"),E.is("bordered-label",i),E.is("vertical-label",u),S,M],colSpan:u?v:1,rowspan:u?1:_},f()),o);case"content":return fn(Jt(this.tag,{style:w,class:[E.e("cell"),E.e("content"),E.is("bordered-content",i),E.is("vertical-content",u),b,k],colSpan:u?v:v*2-1,rowspan:u?_*2-1:_},p()),o);default:{const N=f(),F={},x=ur(t.labelWidth||this.descriptions.labelWidth);return x&&(F.width=x,F.display="inline-block"),fn(Jt("td",{style:w,class:[E.e("cell"),b],colSpan:v,rowspan:_},[oi(N)?void 0:Jt("span",{style:F,class:[E.e("label"),M]},N),Jt("span",{class:[E.e("content"),k]},p())]),o)}}}});const w1e=pt({row:{type:Ue(Array),default:()=>[]}}),R1e=Te({name:"ElDescriptionsRow"}),A1e=Te({...R1e,props:w1e,setup(e){const t=Rt(PN,{});return(o,i)=>y(t).direction==="vertical"?(ee(),ge(Ht,{key:0},[Ee("tr",null,[(ee(!0),ge(Ht,null,Un(o.row,(c,u)=>(ee(),We(y(Ny),{key:`tr1-${u}`,cell:c,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ee("tr",null,[(ee(!0),ge(Ht,null,Un(o.row,(c,u)=>(ee(),We(y(Ny),{key:`tr2-${u}`,cell:c,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(ee(),ge("tr",{key:1},[(ee(!0),ge(Ht,null,Un(o.row,(c,u)=>(ee(),ge(Ht,{key:`tr3-${u}`},[y(t).border?(ee(),ge(Ht,{key:0},[Me(y(Ny),{cell:c,tag:"td",type:"label"},null,8,["cell"]),Me(y(Ny),{cell:c,tag:"td",type:"content"},null,8,["cell"])],64)):(ee(),We(y(Ny),{key:1,cell:c,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var D1e=vt(A1e,[["__file","descriptions-row.vue"]]);const O1e=pt({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Kr,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),B9="ElDescriptionsItem",L1e=Te({name:"ElDescriptions"}),N1e=Te({...L1e,props:O1e,setup(e){const t=e,o=ut("descriptions"),i=Fr(),c=Qr();Nn(PN,t);const u=z(()=>[o.b(),o.m(i.value)]),f=(v,_,b,S=!1)=>(v.props||(v.props={}),_>b&&(v.props.span=b),S&&(v.props.span=_),v),p=()=>{if(!c.default)return[];const v=Qc(c.default()).filter(R=>{var w;return((w=R==null?void 0:R.type)==null?void 0:w.name)===B9}),_=[];let b=[],S=t.column,k=0;const M=[];return v.forEach((R,w)=>{var E,N,F;const x=((E=R.props)==null?void 0:E.span)||1,P=((N=R.props)==null?void 0:N.rowspan)||1,G=_.length;if(M[G]||(M[G]=0),P>1)for(let H=1;H<P;H++)M[F=G+H]||(M[F]=0),M[G+H]++,k++;if(M[G]>0&&(S-=M[G],M[G]=0),w<v.length-1&&(k+=x>S?S:x),w===v.length-1){const H=t.column-k%t.column;b.push(f(R,H,S,!0)),_.push(b);return}x<S?(S-=x,b.push(R)):(b.push(f(R,x,S)),_.push(b),S=t.column,b=[])}),_};return(v,_)=>(ee(),ge("div",{class:ne(y(u))},[v.title||v.extra||v.$slots.title||v.$slots.extra?(ee(),ge("div",{key:0,class:ne(y(o).e("header"))},[Ee("div",{class:ne(y(o).e("title"))},[Ve(v.$slots,"title",{},()=>[Mn(mt(v.title),1)])],2),Ee("div",{class:ne(y(o).e("extra"))},[Ve(v.$slots,"extra",{},()=>[Mn(mt(v.extra),1)])],2)],2)):$e("v-if",!0),Ee("div",{class:ne(y(o).e("body"))},[Ee("table",{class:ne([y(o).e("table"),y(o).is("bordered",v.border)])},[Ee("tbody",null,[(ee(!0),ge(Ht,null,Un(p(),(b,S)=>(ee(),We(D1e,{key:S,row:b},null,8,["row"]))),128))])],2)],2)],2))}});var P1e=vt(N1e,[["__file","description.vue"]]);const x1e=pt({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),H9=Te({name:B9,props:x1e}),U1e=un(P1e,{DescriptionsItem:H9}),F1e=lr(H9),xN=e=>{if(!e)return{onClick:lo,onMousedown:lo,onMouseup:lo};let t=!1,o=!1;return{onClick:f=>{t&&o&&e(f),t=o=!1},onMousedown:f=>{t=f.target===f.currentTarget},onMouseup:f=>{o=f.target===f.currentTarget}}},V1e=pt({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:Ue([String,Array,Object])},zIndex:{type:Ue([String,Number])}}),G1e={click:e=>e instanceof MouseEvent},B1e="overlay";var H1e=Te({name:"ElOverlay",props:V1e,emits:G1e,setup(e,{slots:t,emit:o}){const i=ut(B1e),c=v=>{o("click",v)},{onClick:u,onMousedown:f,onMouseup:p}=xN(e.customMaskEvent?void 0:c);return()=>e.mask?Me("div",{class:[i.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:u,onMousedown:f,onMouseup:p},[Ve(t,"default")],ys.STYLE|ys.CLASS|ys.PROPS,["onClick","onMouseup","onMousedown"]):Jt("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Ve(t,"default")])}});const UN=H1e,$9=Symbol("dialogInjectionKey"),q9=pt({center:Boolean,alignCenter:Boolean,closeIcon:{type:ho},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),$1e={close:()=>!0},K9=(e,t,o,i)=>{const c={offsetX:0,offsetY:0},u=(S,k)=>{if(e.value){const{offsetX:M,offsetY:R}=c,w=e.value.getBoundingClientRect(),E=w.left,N=w.top,F=w.width,x=w.height,P=document.documentElement.clientWidth,G=document.documentElement.clientHeight,H=-E+M,Y=-N+R,j=P-E-F+M,W=G-N-x+R;i!=null&&i.value||(S=Math.min(Math.max(S,H),j),k=Math.min(Math.max(k,Y),W)),c.offsetX=S,c.offsetY=k,e.value.style.transform=`translate(${ur(S)}, ${ur(k)})`}},f=S=>{const k=S.clientX,M=S.clientY,{offsetX:R,offsetY:w}=c,E=F=>{const x=R+F.clientX-k,P=w+F.clientY-M;u(x,P)},N=()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",N)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",N)},p=()=>{t.value&&e.value&&(t.value.addEventListener("mousedown",f),window.addEventListener("resize",b))},v=()=>{t.value&&e.value&&(t.value.removeEventListener("mousedown",f),window.removeEventListener("resize",b))},_=()=>{c.offsetX=0,c.offsetY=0,e.value&&(e.value.style.transform="")},b=()=>{const{offsetX:S,offsetY:k}=c;u(S,k)};return mn(()=>{Di(()=>{o.value?p():v()})}),Co(()=>{v()}),{resetPosition:_,updatePosition:b}},WT=(...e)=>t=>{e.forEach(o=>{zt(o)?o(t):o.value=t})},q1e=Te({name:"ElDialogContent"}),K1e=Te({...q1e,props:q9,emits:$1e,setup(e,{expose:t}){const o=e,{t:i}=Kn(),{Close:c}=cK,{dialogRef:u,headerRef:f,bodyId:p,ns:v,style:_}=Rt($9),{focusTrapRef:b}=Rt(fN),S=z(()=>[v.b(),v.is("fullscreen",o.fullscreen),v.is("draggable",o.draggable),v.is("align-center",o.alignCenter),{[v.m("center")]:o.center}]),k=WT(b,u),M=z(()=>o.draggable),R=z(()=>o.overflow),{resetPosition:w,updatePosition:E}=K9(u,f,M,R);return t({resetPosition:w,updatePosition:E}),(N,F)=>(ee(),ge("div",{ref:y(k),class:ne(y(S)),style:qt(y(_)),tabindex:"-1"},[Ee("header",{ref_key:"headerRef",ref:f,class:ne([y(v).e("header"),N.headerClass,{"show-close":N.showClose}])},[Ve(N.$slots,"header",{},()=>[Ee("span",{role:"heading","aria-level":N.ariaLevel,class:ne(y(v).e("title"))},mt(N.title),11,["aria-level"])]),N.showClose?(ee(),ge("button",{key:0,"aria-label":y(i)("el.dialog.close"),class:ne(y(v).e("headerbtn")),type:"button",onClick:x=>N.$emit("close")},[Me(y(Pt),{class:ne(y(v).e("close"))},{default:Ae(()=>[(ee(),We(Tn(N.closeIcon||y(c))))]),_:1},8,["class"])],10,["aria-label","onClick"])):$e("v-if",!0)],2),Ee("div",{id:y(p),class:ne([y(v).e("body"),N.bodyClass])},[Ve(N.$slots,"default")],10,["id"]),N.$slots.footer?(ee(),ge("footer",{key:0,class:ne([y(v).e("footer"),N.footerClass])},[Ve(N.$slots,"footer")],2)):$e("v-if",!0)],6))}});var z1e=vt(K1e,[["__file","dialog-content.vue"]]);const z9=pt({...q9,appendToBody:Boolean,appendTo:{type:qT.to.type,default:"body"},beforeClose:{type:Ue(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),W9={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[nn]:e=>vo(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},FN=(e,t={})=>{Bo(e)||qr("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||ut("popup"),i=z(()=>o.bm("parent","hidden"));if(!$n||wa(document.body,i.value))return;let c=0,u=!1,f="0";const p=()=>{setTimeout(()=>{typeof document>"u"||u&&document&&(document.body.style.width=f,Ji(document.body,i.value))},200)};st(e,v=>{if(!v){p();return}u=!wa(document.body,i.value),u&&(f=document.body.style.width,Ss(document.body,i.value)),c=tK(o.namespace.value);const _=document.documentElement.clientHeight<document.body.scrollHeight,b=Yc(document.body,"overflowY");c>0&&(_||b==="scroll")&&u&&(document.body.style.width=`calc(100% - ${c}px)`)}),FH(()=>p())},j9=(e,t)=>{var o;const c=kn().emit,{nextZIndex:u}=pv();let f="";const p=bi(),v=bi(),_=le(!1),b=le(!1),S=le(!1),k=le((o=e.zIndex)!=null?o:u());let M,R;const w=xT("namespace",r0),E=z(()=>{const ie={},te=`--${w.value}-dialog`;return e.fullscreen||(e.top&&(ie[`${te}-margin-top`]=e.top),e.width&&(ie[`${te}-width`]=ur(e.width))),ie}),N=z(()=>e.alignCenter?{display:"flex"}:{});function F(){c("opened")}function x(){c("closed"),c(nn,!1),e.destroyOnClose&&(S.value=!1)}function P(){c("close")}function G(){R==null||R(),M==null||M(),e.openDelay&&e.openDelay>0?{stop:M}=cp(()=>W(),e.openDelay):W()}function H(){M==null||M(),R==null||R(),e.closeDelay&&e.closeDelay>0?{stop:R}=cp(()=>O(),e.closeDelay):O()}function Y(){function ie(te){te||(b.value=!0,_.value=!1)}e.beforeClose?e.beforeClose(ie):H()}function j(){e.closeOnClickModal&&Y()}function W(){$n&&(_.value=!0)}function O(){_.value=!1}function Q(){c("openAutoFocus")}function J(){c("closeAutoFocus")}function oe(ie){var te;((te=ie.detail)==null?void 0:te.focusReason)==="pointer"&&ie.preventDefault()}e.lockScroll&&FN(_);function pe(){e.closeOnPressEscape&&Y()}return st(()=>e.modelValue,ie=>{ie?(b.value=!1,G(),S.value=!0,k.value=xq(e.zIndex)?u():k.value++,Vt(()=>{c("open"),t.value&&(t.value.parentElement.scrollTop=0,t.value.parentElement.scrollLeft=0,t.value.scrollTop=0)})):_.value&&H()}),st(()=>e.fullscreen,ie=>{t.value&&(ie?(f=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=f)}),mn(()=>{e.modelValue&&(_.value=!0,S.value=!0,G())}),{afterEnter:F,afterLeave:x,beforeLeave:P,handleClose:Y,onModalClick:j,close:H,doClose:O,onOpenAutoFocus:Q,onCloseAutoFocus:J,onCloseRequested:pe,onFocusoutPrevented:oe,titleId:p,bodyId:v,closed:b,style:E,overlayDialogStyle:N,rendered:S,visible:_,zIndex:k}},W1e=Te({name:"ElDialog",inheritAttrs:!1}),j1e=Te({...W1e,props:z9,emits:W9,setup(e,{expose:t}){const o=e,i=Qr();ou({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},z(()=>!!i.title));const c=ut("dialog"),u=le(),f=le(),p=le(),{visible:v,titleId:_,bodyId:b,style:S,overlayDialogStyle:k,rendered:M,zIndex:R,afterEnter:w,afterLeave:E,beforeLeave:N,handleClose:F,onModalClick:x,onOpenAutoFocus:P,onCloseAutoFocus:G,onCloseRequested:H,onFocusoutPrevented:Y}=j9(o,u);Nn($9,{dialogRef:u,headerRef:f,bodyId:b,ns:c,rendered:M,style:S});const j=xN(x),W=z(()=>o.draggable&&!o.fullscreen);return t({visible:v,dialogContentRef:p,resetPosition:()=>{var Q;(Q=p.value)==null||Q.resetPosition()},handleClose:F}),(Q,J)=>(ee(),We(y(vv),{to:Q.appendTo,disabled:Q.appendTo!=="body"?!1:!Q.appendToBody},{default:Ae(()=>[Me(Zr,{name:"dialog-fade",onAfterEnter:y(w),onAfterLeave:y(E),onBeforeLeave:y(N),persisted:""},{default:Ae(()=>[fn(Me(y(UN),{"custom-mask-event":"",mask:Q.modal,"overlay-class":Q.modalClass,"z-index":y(R)},{default:Ae(()=>[Ee("div",{role:"dialog","aria-modal":"true","aria-label":Q.title||void 0,"aria-labelledby":Q.title?void 0:y(_),"aria-describedby":y(b),class:ne(`${y(c).namespace.value}-overlay-dialog`),style:qt(y(k)),onClick:y(j).onClick,onMousedown:y(j).onMousedown,onMouseup:y(j).onMouseup},[Me(y(gv),{loop:"",trapped:y(v),"focus-start-el":"container",onFocusAfterTrapped:y(P),onFocusAfterReleased:y(G),onFocusoutPrevented:y(Y),onReleaseRequested:y(H)},{default:Ae(()=>[y(M)?(ee(),We(z1e,An({key:0,ref_key:"dialogContentRef",ref:p},Q.$attrs,{center:Q.center,"align-center":Q.alignCenter,"close-icon":Q.closeIcon,draggable:y(W),overflow:Q.overflow,fullscreen:Q.fullscreen,"header-class":Q.headerClass,"body-class":Q.bodyClass,"footer-class":Q.footerClass,"show-close":Q.showClose,title:Q.title,"aria-level":Q.headerAriaLevel,onClose:y(F)}),rs({header:Ae(()=>[Q.$slots.title?Ve(Q.$slots,"title",{key:1}):Ve(Q.$slots,"header",{key:0,close:y(F),titleId:y(_),titleClass:y(c).e("title")})]),default:Ae(()=>[Ve(Q.$slots,"default")]),_:2},[Q.$slots.footer?{name:"footer",fn:Ae(()=>[Ve(Q.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):$e("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Zn,y(v)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Y1e=vt(j1e,[["__file","dialog.vue"]]);const J1e=un(Y1e),X1e=pt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Ue(String),default:"solid"}}),Z1e=Te({name:"ElDivider"}),Q1e=Te({...Z1e,props:X1e,setup(e){const t=e,o=ut("divider"),i=z(()=>o.cssVar({"border-style":t.borderStyle}));return(c,u)=>(ee(),ge("div",{class:ne([y(o).b(),y(o).m(c.direction)]),style:qt(y(i)),role:"separator"},[c.$slots.default&&c.direction!=="vertical"?(ee(),ge("div",{key:0,class:ne([y(o).e("text"),y(o).is(c.contentPosition)])},[Ve(c.$slots,"default")],2)):$e("v-if",!0)],6))}});var eMe=vt(Q1e,[["__file","divider.vue"]]);const Y9=un(eMe),tMe=pt({...z9,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),nMe=W9,oMe=Te({name:"ElDrawer",inheritAttrs:!1}),rMe=Te({...oMe,props:tMe,emits:nMe,setup(e,{expose:t}){const o=e,i=Qr();ou({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},z(()=>!!i.title));const c=le(),u=le(),f=ut("drawer"),{t:p}=Kn(),{afterEnter:v,afterLeave:_,beforeLeave:b,visible:S,rendered:k,titleId:M,bodyId:R,zIndex:w,onModalClick:E,onOpenAutoFocus:N,onCloseAutoFocus:F,onFocusoutPrevented:x,onCloseRequested:P,handleClose:G}=j9(o,c),H=z(()=>o.direction==="rtl"||o.direction==="ltr"),Y=z(()=>ur(o.size));return t({handleClose:G,afterEnter:v,afterLeave:_}),(j,W)=>(ee(),We(y(vv),{to:j.appendTo,disabled:j.appendTo!=="body"?!1:!j.appendToBody},{default:Ae(()=>[Me(Zr,{name:y(f).b("fade"),onAfterEnter:y(v),onAfterLeave:y(_),onBeforeLeave:y(b),persisted:""},{default:Ae(()=>[fn(Me(y(UN),{mask:j.modal,"overlay-class":j.modalClass,"z-index":y(w),onClick:y(E)},{default:Ae(()=>[Me(y(gv),{loop:"",trapped:y(S),"focus-trap-el":c.value,"focus-start-el":u.value,onFocusAfterTrapped:y(N),onFocusAfterReleased:y(F),onFocusoutPrevented:y(x),onReleaseRequested:y(P)},{default:Ae(()=>[Ee("div",An({ref_key:"drawerRef",ref:c,"aria-modal":"true","aria-label":j.title||void 0,"aria-labelledby":j.title?void 0:y(M),"aria-describedby":y(R)},j.$attrs,{class:[y(f).b(),j.direction,y(S)&&"open"],style:y(H)?"width: "+y(Y):"height: "+y(Y),role:"dialog",onClick:Zt(()=>{},["stop"])}),[Ee("span",{ref_key:"focusStartRef",ref:u,class:ne(y(f).e("sr-focus")),tabindex:"-1"},null,2),j.withHeader?(ee(),ge("header",{key:0,class:ne([y(f).e("header"),j.headerClass])},[j.$slots.title?Ve(j.$slots,"title",{key:1},()=>[$e(" DEPRECATED SLOT ")]):Ve(j.$slots,"header",{key:0,close:y(G),titleId:y(M),titleClass:y(f).e("title")},()=>[j.$slots.title?$e("v-if",!0):(ee(),ge("span",{key:0,id:y(M),role:"heading","aria-level":j.headerAriaLevel,class:ne(y(f).e("title"))},mt(j.title),11,["id","aria-level"]))]),j.showClose?(ee(),ge("button",{key:2,"aria-label":y(p)("el.drawer.close"),class:ne(y(f).e("close-btn")),type:"button",onClick:y(G)},[Me(y(Pt),{class:ne(y(f).e("close"))},{default:Ae(()=>[Me(y(As))]),_:1},8,["class"])],10,["aria-label","onClick"])):$e("v-if",!0)],2)):$e("v-if",!0),y(k)?(ee(),ge("div",{key:1,id:y(R),class:ne([y(f).e("body"),j.bodyClass])},[Ve(j.$slots,"default")],10,["id"])):$e("v-if",!0),j.$slots.footer?(ee(),ge("div",{key:2,class:ne([y(f).e("footer"),j.footerClass])},[Ve(j.$slots,"footer")],2)):$e("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Zn,y(S)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var iMe=vt(rMe,[["__file","drawer.vue"]]);const aMe=un(iMe),sMe=Te({inheritAttrs:!1});function lMe(e,t,o,i,c,u){return Ve(e.$slots,"default")}var cMe=vt(sMe,[["render",lMe],["__file","collection.vue"]]);const uMe=Te({name:"ElCollectionItem",inheritAttrs:!1});function dMe(e,t,o,i,c,u){return Ve(e.$slots,"default")}var hMe=vt(uMe,[["render",dMe],["__file","collection-item.vue"]]);const J9="data-el-collection-item",X9=e=>{const t=`El${e}Collection`,o=`${t}Item`,i=Symbol(t),c=Symbol(o),u={...cMe,name:t,setup(){const p=le(),v=new Map;Nn(i,{itemMap:v,getItems:()=>{const b=y(p);if(!b)return[];const S=Array.from(b.querySelectorAll(`[${J9}]`));return[...v.values()].sort((M,R)=>S.indexOf(M.ref)-S.indexOf(R.ref))},collectionRef:p})}},f={...hMe,name:o,setup(p,{attrs:v}){const _=le(),b=Rt(i,void 0);Nn(c,{collectionItemRef:_}),mn(()=>{const S=y(_);S&&b.itemMap.set(S,{ref:S,...v})}),Co(()=>{const S=y(_);b.itemMap.delete(S)})}};return{COLLECTION_INJECTION_KEY:i,COLLECTION_ITEM_INJECTION_KEY:c,ElCollection:u,ElCollectionItem:f}},fMe=pt({style:{type:Ue([String,Array,Object])},currentTabId:{type:Ue(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:Ue(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:pMe,ElCollectionItem:mMe,COLLECTION_INJECTION_KEY:VN,COLLECTION_ITEM_INJECTION_KEY:gMe}=X9("RovingFocusGroup"),GN=Symbol("elRovingFocusGroup"),Z9=Symbol("elRovingFocusGroupItem"),vMe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},_Me=(e,t)=>e,yMe=(e,t,o)=>{const i=_Me(e.code);return vMe[i]},IMe=(e,t)=>e.map((o,i)=>e[(i+t)%e.length]),BN=e=>{const{activeElement:t}=document;for(const o of e)if(o===t||(o.focus(),t!==document.activeElement))return},DB="currentTabIdChange",OB="rovingFocusGroup.entryFocus",bMe={bubbles:!1,cancelable:!0},CMe=Te({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:fMe,emits:[DB,"entryFocus"],setup(e,{emit:t}){var o;const i=le((o=e.currentTabId||e.defaultCurrentTabId)!=null?o:null),c=le(!1),u=le(!1),f=le(),{getItems:p}=Rt(VN,void 0),v=z(()=>[{outline:"none"},e.style]),_=w=>{t(DB,w)},b=()=>{c.value=!0},S=gr(w=>{var E;(E=e.onMousedown)==null||E.call(e,w)},()=>{u.value=!0}),k=gr(w=>{var E;(E=e.onFocus)==null||E.call(e,w)},w=>{const E=!y(u),{target:N,currentTarget:F}=w;if(N===F&&E&&!y(c)){const x=new Event(OB,bMe);if(F==null||F.dispatchEvent(x),!x.defaultPrevented){const P=p().filter(W=>W.focusable),G=P.find(W=>W.active),H=P.find(W=>W.id===y(i)),j=[G,H,...P].filter(Boolean).map(W=>W.ref);BN(j)}}u.value=!1}),M=gr(w=>{var E;(E=e.onBlur)==null||E.call(e,w)},()=>{c.value=!1}),R=(...w)=>{t("entryFocus",...w)};Nn(GN,{currentTabbedId:sv(i),loop:uo(e,"loop"),tabIndex:z(()=>y(c)?-1:0),rovingFocusGroupRef:f,rovingFocusGroupRootStyle:v,orientation:uo(e,"orientation"),dir:uo(e,"dir"),onItemFocus:_,onItemShiftTab:b,onBlur:M,onFocus:k,onMousedown:S}),st(()=>e.currentTabId,w=>{i.value=w??null}),_o(f,OB,R)}});function SMe(e,t,o,i,c,u){return Ve(e.$slots,"default")}var EMe=vt(CMe,[["render",SMe],["__file","roving-focus-group-impl.vue"]]);const TMe=Te({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:pMe,ElRovingFocusGroupImpl:EMe}});function MMe(e,t,o,i,c,u){const f=Cn("el-roving-focus-group-impl"),p=Cn("el-focus-group-collection");return ee(),We(p,null,{default:Ae(()=>[Me(f,Za(Zl(e.$attrs)),{default:Ae(()=>[Ve(e.$slots,"default")]),_:3},16)]),_:3})}var kMe=vt(TMe,[["render",MMe],["__file","roving-focus-group.vue"]]);const fE=pt({trigger:Og.trigger,triggerKeys:{type:Ue(Array),default:()=>[At.enter,At.numpadEnter,At.space,At.down]},effect:{...Ur.effect,default:"light"},type:{type:Ue(String)},placement:{type:Ue(String),default:"bottom"},popperOptions:{type:Ue(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:Ue([Number,String]),default:0},maxHeight:{type:Ue([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,values:fK,default:"menu"},buttonProps:{type:Ue(Object)},teleported:Ur.teleported,persistent:{type:Boolean,default:!0}}),Q9=pt({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:ho}}),wMe=pt({onKeydown:{type:Ue(Function)}}),RMe=[At.down,At.pageDown,At.home],ez=[At.up,At.pageUp,At.end],AMe=[...RMe,...ez],{ElCollection:DMe,ElCollectionItem:OMe,COLLECTION_INJECTION_KEY:LMe,COLLECTION_ITEM_INJECTION_KEY:NMe}=X9("Dropdown"),jT=Symbol("elDropdown"),{ButtonGroup:PMe}=di,xMe=Te({name:"ElDropdown",components:{ElButton:di,ElButtonGroup:PMe,ElScrollbar:ac,ElDropdownCollection:DMe,ElTooltip:Li,ElRovingFocusGroup:kMe,ElOnlyChild:IK,ElIcon:Pt,ArrowDown:fu},props:fE,emits:["visible-change","click","command"],setup(e,{emit:t}){const o=kn(),i=ut("dropdown"),{t:c}=Kn(),u=le(),f=le(),p=le(),v=le(),_=le(null),b=le(null),S=le(!1),k=z(()=>({maxHeight:ur(e.maxHeight)})),M=z(()=>[i.m(P.value)]),R=z(()=>Wi(e.trigger)),w=bi().value,E=z(()=>e.id||w);st([u,R],([te,he],[re])=>{var X,ye,ue;(X=re==null?void 0:re.$el)!=null&&X.removeEventListener&&re.$el.removeEventListener("pointerenter",H),(ye=te==null?void 0:te.$el)!=null&&ye.removeEventListener&&te.$el.removeEventListener("pointerenter",H),(ue=te==null?void 0:te.$el)!=null&&ue.addEventListener&&he.includes("hover")&&te.$el.addEventListener("pointerenter",H)},{immediate:!0}),Co(()=>{var te,he;(he=(te=u.value)==null?void 0:te.$el)!=null&&he.removeEventListener&&u.value.$el.removeEventListener("pointerenter",H)});function N(){F()}function F(){var te;(te=p.value)==null||te.onClose()}function x(){var te;(te=p.value)==null||te.onOpen()}const P=Fr();function G(...te){t("command",...te)}function H(){var te,he;(he=(te=u.value)==null?void 0:te.$el)==null||he.focus()}function Y(){}function j(){const te=y(v);R.value.includes("hover")&&(te==null||te.focus()),b.value=null}function W(te){b.value=te}function O(te){S.value||(te.preventDefault(),te.stopImmediatePropagation())}function Q(){t("visible-change",!0)}function J(te){var he;(te==null?void 0:te.type)==="keydown"&&((he=v.value)==null||he.focus())}function oe(){t("visible-change",!1)}return Nn(jT,{contentRef:v,role:z(()=>e.role),triggerId:E,isUsingKeyboard:S,onItemEnter:Y,onItemLeave:j}),Nn("elDropdown",{instance:o,dropdownSize:P,handleClick:N,commandHandler:G,trigger:uo(e,"trigger"),hideOnClick:uo(e,"hideOnClick")}),{t:c,ns:i,scrollbar:_,wrapStyle:k,dropdownTriggerKls:M,dropdownSize:P,triggerId:E,currentTabId:b,handleCurrentTabIdChange:W,handlerMainButtonClick:te=>{t("click",te)},handleEntryFocus:O,handleClose:F,handleOpen:x,handleBeforeShowTooltip:Q,handleShowTooltip:J,handleBeforeHideTooltip:oe,onFocusAfterTrapped:te=>{var he,re;te.preventDefault(),(re=(he=v.value)==null?void 0:he.focus)==null||re.call(he,{preventScroll:!0})},popperRef:p,contentRef:v,triggeringElementRef:u,referenceElementRef:f}}});function UMe(e,t,o,i,c,u){var f;const p=Cn("el-dropdown-collection"),v=Cn("el-roving-focus-group"),_=Cn("el-scrollbar"),b=Cn("el-only-child"),S=Cn("el-tooltip"),k=Cn("el-button"),M=Cn("arrow-down"),R=Cn("el-icon"),w=Cn("el-button-group");return ee(),ge("div",{class:ne([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Me(S,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(f=e.referenceElementRef)==null?void 0:f.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:e.persistent,onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},rs({content:Ae(()=>[Me(_,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:Ae(()=>[Me(v,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:Ae(()=>[Me(p,null,{default:Ae(()=>[Ve(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:Ae(()=>[Me(b,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:Ae(()=>[Ve(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","persistent","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(ee(),We(w,{key:0},{default:Ae(()=>[Me(k,An({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:Ae(()=>[Ve(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Me(k,An({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:Ae(()=>[Me(R,{class:ne(e.ns.e("icon"))},{default:Ae(()=>[Me(M)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):$e("v-if",!0)],2)}var FMe=vt(xMe,[["render",UMe],["__file","dropdown.vue"]]);const VMe=Te({components:{ElRovingFocusCollectionItem:mMe},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:o,loop:i,onItemFocus:c,onItemShiftTab:u}=Rt(GN,void 0),{getItems:f}=Rt(VN,void 0),p=bi(),v=le(),_=gr(M=>{t("mousedown",M)},M=>{e.focusable?c(y(p)):M.preventDefault()}),b=gr(M=>{t("focus",M)},()=>{c(y(p))}),S=gr(M=>{t("keydown",M)},M=>{const{code:R,shiftKey:w,target:E,currentTarget:N}=M;if(R===At.tab&&w){u();return}if(E!==N)return;const F=yMe(M);if(F){M.preventDefault();let P=f().filter(G=>G.focusable).map(G=>G.ref);switch(F){case"last":{P.reverse();break}case"prev":case"next":{F==="prev"&&P.reverse();const G=P.indexOf(N);P=i.value?IMe(P,G+1):P.slice(G+1);break}}Vt(()=>{BN(P)})}}),k=z(()=>o.value===y(p));return Nn(Z9,{rovingFocusGroupItemRef:v,tabIndex:z(()=>y(k)?0:-1),handleMousedown:_,handleFocus:b,handleKeydown:S}),{id:p,handleKeydown:S,handleFocus:b,handleMousedown:_}}});function GMe(e,t,o,i,c,u){const f=Cn("el-roving-focus-collection-item");return ee(),We(f,{id:e.id,focusable:e.focusable,active:e.active},{default:Ae(()=>[Ve(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var BMe=vt(VMe,[["render",GMe],["__file","roving-focus-item.vue"]]);const HMe=Te({name:"DropdownItemImpl",components:{ElIcon:Pt},props:Q9,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const o=ut("dropdown"),{role:i}=Rt(jT,void 0),{collectionItemRef:c}=Rt(NMe,void 0),{collectionItemRef:u}=Rt(gMe,void 0),{rovingFocusGroupItemRef:f,tabIndex:p,handleFocus:v,handleKeydown:_,handleMousedown:b}=Rt(Z9,void 0),S=WT(c,u,f),k=z(()=>i.value==="menu"?"menuitem":i.value==="navigation"?"link":"button"),M=gr(R=>{if([At.enter,At.numpadEnter,At.space].includes(R.code))return R.preventDefault(),R.stopImmediatePropagation(),t("clickimpl",R),!0},_);return{ns:o,itemRef:S,dataset:{[J9]:""},role:k,tabIndex:p,handleFocus:v,handleKeydown:M,handleMousedown:b}}});function $Me(e,t,o,i,c,u){const f=Cn("el-icon");return ee(),ge(Ht,null,[e.divided?(ee(),ge("li",{key:0,role:"separator",class:ne(e.ns.bem("menu","item","divided"))},null,2)):$e("v-if",!0),Ee("li",An({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:p=>e.$emit("clickimpl",p),onFocus:e.handleFocus,onKeydown:Zt(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:p=>e.$emit("pointermove",p),onPointerleave:p=>e.$emit("pointerleave",p)}),[e.icon?(ee(),We(f,{key:0},{default:Ae(()=>[(ee(),We(Tn(e.icon)))]),_:1})):$e("v-if",!0),Ve(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var qMe=vt(HMe,[["render",$Me],["__file","dropdown-item-impl.vue"]]);const tz=()=>{const e=Rt("elDropdown",{}),t=z(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},KMe=Te({name:"ElDropdownItem",components:{ElDropdownCollectionItem:OMe,ElRovingFocusItem:BMe,ElDropdownItemImpl:qMe},inheritAttrs:!1,props:Q9,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:o}){const{elDropdown:i}=tz(),c=kn(),u=le(null),f=z(()=>{var M,R;return(R=(M=y(u))==null?void 0:M.textContent)!=null?R:""}),{onItemEnter:p,onItemLeave:v}=Rt(jT,void 0),_=gr(M=>(t("pointermove",M),M.defaultPrevented),lB(M=>{if(e.disabled){v(M);return}const R=M.currentTarget;R===document.activeElement||R.contains(document.activeElement)||(p(M),M.defaultPrevented||R==null||R.focus())})),b=gr(M=>(t("pointerleave",M),M.defaultPrevented),lB(v)),S=gr(M=>{if(!e.disabled)return t("click",M),M.type!=="keydown"&&M.defaultPrevented},M=>{var R,w,E;if(e.disabled){M.stopImmediatePropagation();return}(R=i==null?void 0:i.hideOnClick)!=null&&R.value&&((w=i.handleClick)==null||w.call(i)),(E=i.commandHandler)==null||E.call(i,e.command,c,M)}),k=z(()=>({...e,...o}));return{handleClick:S,handlePointerMove:_,handlePointerLeave:b,textContent:f,propsAndAttrs:k}}});function zMe(e,t,o,i,c,u){var f;const p=Cn("el-dropdown-item-impl"),v=Cn("el-roving-focus-item"),_=Cn("el-dropdown-collection-item");return ee(),We(_,{disabled:e.disabled,"text-value":(f=e.textValue)!=null?f:e.textContent},{default:Ae(()=>[Me(v,{focusable:!e.disabled},{default:Ae(()=>[Me(p,An(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:Ae(()=>[Ve(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var nz=vt(KMe,[["render",zMe],["__file","dropdown-item.vue"]]);const WMe=Te({name:"ElDropdownMenu",props:wMe,setup(e){const t=ut("dropdown"),{_elDropdownSize:o}=tz(),i=o.value,{focusTrapRef:c,onKeydown:u}=Rt(fN,void 0),{contentRef:f,role:p,triggerId:v}=Rt(jT,void 0),{collectionRef:_,getItems:b}=Rt(LMe,void 0),{rovingFocusGroupRef:S,rovingFocusGroupRootStyle:k,tabIndex:M,onBlur:R,onFocus:w,onMousedown:E}=Rt(GN,void 0),{collectionRef:N}=Rt(VN,void 0),F=z(()=>[t.b("menu"),t.bm("menu",i==null?void 0:i.value)]),x=WT(f,_,c,S,N),P=gr(H=>{var Y;(Y=e.onKeydown)==null||Y.call(e,H)},H=>{const{currentTarget:Y,code:j,target:W}=H;if(Y.contains(W),At.tab===j&&H.stopImmediatePropagation(),H.preventDefault(),W!==y(f)||!AMe.includes(j))return;const Q=b().filter(J=>!J.disabled).map(J=>J.ref);ez.includes(j)&&Q.reverse(),BN(Q)});return{size:i,rovingFocusGroupRootStyle:k,tabIndex:M,dropdownKls:F,role:p,triggerId:v,dropdownListWrapperRef:x,handleKeydown:H=>{P(H),u(H)},onBlur:R,onFocus:w,onMousedown:E}}});function jMe(e,t,o,i,c,u){return ee(),ge("ul",{ref:e.dropdownListWrapperRef,class:ne(e.dropdownKls),style:qt(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:Zt(e.handleKeydown,["self"]),onMousedown:Zt(e.onMousedown,["self"])},[Ve(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var oz=vt(WMe,[["render",jMe],["__file","dropdown-menu.vue"]]);const YMe=un(FMe,{DropdownItem:nz,DropdownMenu:oz}),JMe=lr(nz),XMe=lr(oz),ZMe=Te({name:"ImgEmpty"}),QMe=Te({...ZMe,setup(e){const t=ut("empty"),o=bi();return(i,c)=>(ee(),ge("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Ee("defs",null,[Ee("linearGradient",{id:`linearGradient-1-${y(o)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ee("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ee("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ee("linearGradient",{id:`linearGradient-2-${y(o)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ee("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ee("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ee("rect",{id:`path-3-${y(o)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),Ee("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[Ee("g",{transform:"translate(-1268.000000, -535.000000)"},[Ee("g",{transform:"translate(1268.000000, 535.000000)"},[Ee("path",{d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),Ee("g",{transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),Ee("rect",{fill:`url(#linearGradient-1-${y(o)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),Ee("rect",{fill:`url(#linearGradient-2-${y(o)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),Ee("g",{transform:"translate(53.000000, 45.000000)"},[Ee("use",{fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(o)}`},null,8,["fill","xlink:href"]),Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(o)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),Ee("polygon",{fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var eke=vt(QMe,[["__file","img-empty.vue"]]);const tke=pt({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),nke=Te({name:"ElEmpty"}),oke=Te({...nke,props:tke,setup(e){const t=e,{t:o}=Kn(),i=ut("empty"),c=z(()=>t.description||o("el.table.emptyText")),u=z(()=>({width:ur(t.imageSize)}));return(f,p)=>(ee(),ge("div",{class:ne(y(i).b())},[Ee("div",{class:ne(y(i).e("image")),style:qt(y(u))},[f.image?(ee(),ge("img",{key:0,src:f.image,ondragstart:"return false"},null,8,["src"])):Ve(f.$slots,"image",{key:1},()=>[Me(eke)])],6),Ee("div",{class:ne(y(i).e("description"))},[f.$slots.description?Ve(f.$slots,"description",{key:0}):(ee(),ge("p",{key:1},mt(y(c)),1))],2),f.$slots.default?(ee(),ge("div",{key:0,class:ne(y(i).e("bottom"))},[Ve(f.$slots,"default")],2)):$e("v-if",!0)],2))}});var rke=vt(oke,[["__file","empty.vue"]]);const rz=un(rke),ike=pt({size:{type:String,values:ic},disabled:Boolean}),ake=pt({...ike,model:Object,rules:{type:Ue(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),ske={validate:(e,t,o)=>(ht(e)||Ut(e))&&vo(t)&&Ut(o)};function lke(){const e=le([]),t=z(()=>{if(!e.value.length)return"0";const u=Math.max(...e.value);return u?`${u}px`:""});function o(u){const f=e.value.indexOf(u);return f===-1&&t.value,f}function i(u,f){if(u&&f){const p=o(f);e.value.splice(p,1,u)}else u&&e.value.push(u)}function c(u){const f=o(u);f>-1&&e.value.splice(f,1)}return{autoLabelWidth:t,registerLabelWidth:i,deregisterLabelWidth:c}}const WS=(e,t)=>{const o=Wi(t);return o.length>0?e.filter(i=>i.prop&&o.includes(i.prop)):e},cke="ElForm",uke=Te({name:cke}),dke=Te({...uke,props:ake,emits:ske,setup(e,{expose:t,emit:o}){const i=e,c=[],u=Fr(),f=ut("form"),p=z(()=>{const{labelPosition:x,inline:P}=i;return[f.b(),f.m(u.value||"default"),{[f.m(`label-${x}`)]:x,[f.m("inline")]:P}]}),v=x=>c.find(P=>P.prop===x),_=x=>{c.push(x)},b=x=>{x.prop&&c.splice(c.indexOf(x),1)},S=(x=[])=>{i.model&&WS(c,x).forEach(P=>P.resetField())},k=(x=[])=>{WS(c,x).forEach(P=>P.clearValidate())},M=z(()=>!!i.model),R=x=>{if(c.length===0)return[];const P=WS(c,x);return P.length?P:[]},w=async x=>N(void 0,x),E=async(x=[])=>{if(!M.value)return!1;const P=R(x);if(P.length===0)return!0;let G={};for(const H of P)try{await H.validate(""),H.validateState==="error"&&H.resetField()}catch(Y){G={...G,...Y}}return Object.keys(G).length===0?!0:Promise.reject(G)},N=async(x=[],P)=>{const G=!zt(P);try{const H=await E(x);return H===!0&&await(P==null?void 0:P(H)),H}catch(H){if(H instanceof Error)throw H;const Y=H;return i.scrollToError&&F(Object.keys(Y)[0]),await(P==null?void 0:P(!1,Y)),G&&Promise.reject(Y)}},F=x=>{var P;const G=WS(c,x)[0];G&&((P=G.$el)==null||P.scrollIntoView(i.scrollIntoViewOptions))};return st(()=>i.rules,()=>{i.validateOnRuleChange&&w().catch(x=>void 0)},{deep:!0,flush:"post"}),Nn(_p,eo({...hi(i),emit:o,resetFields:S,clearValidate:k,validateField:N,getField:v,addField:_,removeField:b,...lke()})),t({validate:w,validateField:N,resetFields:S,clearValidate:k,scrollToField:F,fields:c}),(x,P)=>(ee(),ge("form",{class:ne(y(p))},[Ve(x.$slots,"default")],2))}});var hke=vt(dke,[["__file","form.vue"]]);function Jf(){return Jf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},Jf.apply(this,arguments)}function fke(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,F0(e,t)}function hO(e){return hO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},hO(e)}function F0(e,t){return F0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},F0(e,t)}function pke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pE(e,t,o){return pke()?pE=Reflect.construct.bind():pE=function(c,u,f){var p=[null];p.push.apply(p,u);var v=Function.bind.apply(c,p),_=new v;return f&&F0(_,f.prototype),_},pE.apply(null,arguments)}function mke(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function fO(e){var t=typeof Map=="function"?new Map:void 0;return fO=function(i){if(i===null||!mke(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,c)}function c(){return pE(i,arguments,hO(this).constructor)}return c.prototype=Object.create(i.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),F0(c,i)},fO(e)}var gke=/%[sdj%]/g,vke=function(){};function pO(e){if(!e||!e.length)return null;var t={};return e.forEach(function(o){var i=o.field;t[i]=t[i]||[],t[i].push(o)}),t}function Qa(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var c=0,u=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var f=e.replace(gke,function(p){if(p==="%%")return"%";if(c>=u)return p;switch(p){case"%s":return String(o[c++]);case"%d":return Number(o[c++]);case"%j":try{return JSON.stringify(o[c++])}catch{return"[Circular]"}break;default:return p}});return f}return e}function _ke(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function fi(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||_ke(t)&&typeof e=="string"&&!e)}function yke(e,t,o){var i=[],c=0,u=e.length;function f(p){i.push.apply(i,p||[]),c++,c===u&&o(i)}e.forEach(function(p){t(p,f)})}function LB(e,t,o){var i=0,c=e.length;function u(f){if(f&&f.length){o(f);return}var p=i;i=i+1,p<c?t(e[p],u):o([])}u([])}function Ike(e){var t=[];return Object.keys(e).forEach(function(o){t.push.apply(t,e[o]||[])}),t}var NB=function(e){fke(t,e);function t(o,i){var c;return c=e.call(this,"Async Validation Error")||this,c.errors=o,c.fields=i,c}return t}(fO(Error));function bke(e,t,o,i,c){if(t.first){var u=new Promise(function(k,M){var R=function(N){return i(N),N.length?M(new NB(N,pO(N))):k(c)},w=Ike(e);LB(w,o,R)});return u.catch(function(k){return k}),u}var f=t.firstFields===!0?Object.keys(e):t.firstFields||[],p=Object.keys(e),v=p.length,_=0,b=[],S=new Promise(function(k,M){var R=function(E){if(b.push.apply(b,E),_++,_===v)return i(b),b.length?M(new NB(b,pO(b))):k(c)};p.length||(i(b),k(c)),p.forEach(function(w){var E=e[w];f.indexOf(w)!==-1?LB(E,o,R):yke(E,o,R)})});return S.catch(function(k){return k}),S}function Cke(e){return!!(e&&e.message!==void 0)}function Ske(e,t){for(var o=e,i=0;i<t.length;i++){if(o==null)return o;o=o[t[i]]}return o}function PB(e,t){return function(o){var i;return e.fullFields?i=Ske(t,e.fullFields):i=t[o.field||e.fullField],Cke(o)?(o.field=o.field||e.fullField,o.fieldValue=i,o):{message:typeof o=="function"?o():o,fieldValue:i,field:o.field||e.fullField}}}function xB(e,t){if(t){for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];typeof i=="object"&&typeof e[o]=="object"?e[o]=Jf({},e[o],i):e[o]=i}}return e}var iz=function(t,o,i,c,u,f){t.required&&(!i.hasOwnProperty(t.field)||fi(o,f||t.type))&&c.push(Qa(u.messages.required,t.fullField))},Eke=function(t,o,i,c,u){(/^\s+$/.test(o)||o==="")&&c.push(Qa(u.messages.whitespace,t.fullField))},jS,Tke=function(){if(jS)return jS;var e="[a-fA-F\\d:]",t=function(P){return P&&P.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",c=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+o+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+o+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+o+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+o+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+o+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+o+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+o+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),u=new RegExp("(?:^"+o+"$)|(?:^"+c+"$)"),f=new RegExp("^"+o+"$"),p=new RegExp("^"+c+"$"),v=function(P){return P&&P.exact?u:new RegExp("(?:"+t(P)+o+t(P)+")|(?:"+t(P)+c+t(P)+")","g")};v.v4=function(x){return x&&x.exact?f:new RegExp(""+t(x)+o+t(x),"g")},v.v6=function(x){return x&&x.exact?p:new RegExp(""+t(x)+c+t(x),"g")};var _="(?:(?:[a-z]+:)?//)",b="(?:\\S+(?::\\S*)?@)?",S=v.v4().source,k=v.v6().source,M="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",R="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",w="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",E="(?::\\d{2,5})?",N='(?:[/?#][^\\s"]*)?',F="(?:"+_+"|www\\.)"+b+"(?:localhost|"+S+"|"+k+"|"+M+R+w+")"+E+N;return jS=new RegExp("(?:^"+F+"$)","i"),jS},UB={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Fy={integer:function(t){return Fy.number(t)&&parseInt(t,10)===t},float:function(t){return Fy.number(t)&&!Fy.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!Fy.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(UB.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(Tke())},hex:function(t){return typeof t=="string"&&!!t.match(UB.hex)}},Mke=function(t,o,i,c,u){if(t.required&&o===void 0){iz(t,o,i,c,u);return}var f=["integer","float","array","regexp","object","method","email","number","date","url","hex"],p=t.type;f.indexOf(p)>-1?Fy[p](o)||c.push(Qa(u.messages.types[p],t.fullField,t.type)):p&&typeof o!==t.type&&c.push(Qa(u.messages.types[p],t.fullField,t.type))},kke=function(t,o,i,c,u){var f=typeof t.len=="number",p=typeof t.min=="number",v=typeof t.max=="number",_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b=o,S=null,k=typeof o=="number",M=typeof o=="string",R=Array.isArray(o);if(k?S="number":M?S="string":R&&(S="array"),!S)return!1;R&&(b=o.length),M&&(b=o.replace(_,"_").length),f?b!==t.len&&c.push(Qa(u.messages[S].len,t.fullField,t.len)):p&&!v&&b<t.min?c.push(Qa(u.messages[S].min,t.fullField,t.min)):v&&!p&&b>t.max?c.push(Qa(u.messages[S].max,t.fullField,t.max)):p&&v&&(b<t.min||b>t.max)&&c.push(Qa(u.messages[S].range,t.fullField,t.min,t.max))},ug="enum",wke=function(t,o,i,c,u){t[ug]=Array.isArray(t[ug])?t[ug]:[],t[ug].indexOf(o)===-1&&c.push(Qa(u.messages[ug],t.fullField,t[ug].join(", ")))},Rke=function(t,o,i,c,u){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(o)||c.push(Qa(u.messages.pattern.mismatch,t.fullField,o,t.pattern));else if(typeof t.pattern=="string"){var f=new RegExp(t.pattern);f.test(o)||c.push(Qa(u.messages.pattern.mismatch,t.fullField,o,t.pattern))}}},Ro={required:iz,whitespace:Eke,type:Mke,range:kke,enum:wke,pattern:Rke},Ake=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o,"string")&&!t.required)return i();Ro.required(t,o,c,f,u,"string"),fi(o,"string")||(Ro.type(t,o,c,f,u),Ro.range(t,o,c,f,u),Ro.pattern(t,o,c,f,u),t.whitespace===!0&&Ro.whitespace(t,o,c,f,u))}i(f)},Dke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&Ro.type(t,o,c,f,u)}i(f)},Oke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(o===""&&(o=void 0),fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&(Ro.type(t,o,c,f,u),Ro.range(t,o,c,f,u))}i(f)},Lke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&Ro.type(t,o,c,f,u)}i(f)},Nke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),fi(o)||Ro.type(t,o,c,f,u)}i(f)},Pke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&(Ro.type(t,o,c,f,u),Ro.range(t,o,c,f,u))}i(f)},xke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&(Ro.type(t,o,c,f,u),Ro.range(t,o,c,f,u))}i(f)},Uke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(o==null&&!t.required)return i();Ro.required(t,o,c,f,u,"array"),o!=null&&(Ro.type(t,o,c,f,u),Ro.range(t,o,c,f,u))}i(f)},Fke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&Ro.type(t,o,c,f,u)}i(f)},Vke="enum",Gke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u),o!==void 0&&Ro[Vke](t,o,c,f,u)}i(f)},Bke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o,"string")&&!t.required)return i();Ro.required(t,o,c,f,u),fi(o,"string")||Ro.pattern(t,o,c,f,u)}i(f)},Hke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o,"date")&&!t.required)return i();if(Ro.required(t,o,c,f,u),!fi(o,"date")){var v;o instanceof Date?v=o:v=new Date(o),Ro.type(t,v,c,f,u),v&&Ro.range(t,v.getTime(),c,f,u)}}i(f)},$ke=function(t,o,i,c,u){var f=[],p=Array.isArray(o)?"array":typeof o;Ro.required(t,o,c,f,u,p),i(f)},iD=function(t,o,i,c,u){var f=t.type,p=[],v=t.required||!t.required&&c.hasOwnProperty(t.field);if(v){if(fi(o,f)&&!t.required)return i();Ro.required(t,o,c,p,u,f),fi(o,f)||Ro.type(t,o,c,p,u)}i(p)},qke=function(t,o,i,c,u){var f=[],p=t.required||!t.required&&c.hasOwnProperty(t.field);if(p){if(fi(o)&&!t.required)return i();Ro.required(t,o,c,f,u)}i(f)},u0={string:Ake,method:Dke,number:Oke,boolean:Lke,regexp:Nke,integer:Pke,float:xke,array:Uke,object:Fke,enum:Gke,pattern:Bke,date:Hke,url:iD,hex:iD,email:iD,required:$ke,any:qke};function mO(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var gO=mO(),hI=function(){function e(o){this.rules=null,this._messages=gO,this.define(o)}var t=e.prototype;return t.define=function(i){var c=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(u){var f=i[u];c.rules[u]=Array.isArray(f)?f:[f]})},t.messages=function(i){return i&&(this._messages=xB(mO(),i)),this._messages},t.validate=function(i,c,u){var f=this;c===void 0&&(c={}),u===void 0&&(u=function(){});var p=i,v=c,_=u;if(typeof v=="function"&&(_=v,v={}),!this.rules||Object.keys(this.rules).length===0)return _&&_(null,p),Promise.resolve(p);function b(w){var E=[],N={};function F(P){if(Array.isArray(P)){var G;E=(G=E).concat.apply(G,P)}else E.push(P)}for(var x=0;x<w.length;x++)F(w[x]);E.length?(N=pO(E),_(E,N)):_(null,p)}if(v.messages){var S=this.messages();S===gO&&(S=mO()),xB(S,v.messages),v.messages=S}else v.messages=this.messages();var k={},M=v.keys||Object.keys(this.rules);M.forEach(function(w){var E=f.rules[w],N=p[w];E.forEach(function(F){var x=F;typeof x.transform=="function"&&(p===i&&(p=Jf({},p)),N=p[w]=x.transform(N)),typeof x=="function"?x={validator:x}:x=Jf({},x),x.validator=f.getValidationMethod(x),x.validator&&(x.field=w,x.fullField=x.fullField||w,x.type=f.getType(x),k[w]=k[w]||[],k[w].push({rule:x,value:N,source:p,field:w}))})});var R={};return bke(k,v,function(w,E){var N=w.rule,F=(N.type==="object"||N.type==="array")&&(typeof N.fields=="object"||typeof N.defaultField=="object");F=F&&(N.required||!N.required&&w.value),N.field=w.field;function x(H,Y){return Jf({},Y,{fullField:N.fullField+"."+H,fullFields:N.fullFields?[].concat(N.fullFields,[H]):[H]})}function P(H){H===void 0&&(H=[]);var Y=Array.isArray(H)?H:[H];!v.suppressWarning&&Y.length&&e.warning("async-validator:",Y),Y.length&&N.message!==void 0&&(Y=[].concat(N.message));var j=Y.map(PB(N,p));if(v.first&&j.length)return R[N.field]=1,E(j);if(!F)E(j);else{if(N.required&&!w.value)return N.message!==void 0?j=[].concat(N.message).map(PB(N,p)):v.error&&(j=[v.error(N,Qa(v.messages.required,N.field))]),E(j);var W={};N.defaultField&&Object.keys(w.value).map(function(J){W[J]=N.defaultField}),W=Jf({},W,w.rule.fields);var O={};Object.keys(W).forEach(function(J){var oe=W[J],pe=Array.isArray(oe)?oe:[oe];O[J]=pe.map(x.bind(null,J))});var Q=new e(O);Q.messages(v.messages),w.rule.options&&(w.rule.options.messages=v.messages,w.rule.options.error=v.error),Q.validate(w.value,w.rule.options||v,function(J){var oe=[];j&&j.length&&oe.push.apply(oe,j),J&&J.length&&oe.push.apply(oe,J),E(oe.length?oe:null)})}}var G;if(N.asyncValidator)G=N.asyncValidator(N,w.value,P,w.source,v);else if(N.validator){try{G=N.validator(N,w.value,P,w.source,v)}catch(H){console.error==null||console.error(H),v.suppressValidatorError||setTimeout(function(){throw H},0),P(H.message)}G===!0?P():G===!1?P(typeof N.message=="function"?N.message(N.fullField||N.field):N.message||(N.fullField||N.field)+" fails"):G instanceof Array?P(G):G instanceof Error&&P(G.message)}G&&G.then&&G.then(function(){return P()},function(H){return P(H)})},function(w){b(w)},p)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!u0.hasOwnProperty(i.type))throw new Error(Qa("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var c=Object.keys(i),u=c.indexOf("message");return u!==-1&&c.splice(u,1),c.length===1&&c[0]==="required"?u0.required:u0[this.getType(i)]||void 0},e}();hI.register=function(t,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");u0[t]=o};hI.warning=vke;hI.messages=gO;hI.validators=u0;const Kke=["","error","validating","success"],zke=pt({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:Ue([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Ue([Object,Array])},error:String,validateStatus:{type:String,values:Kke},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:ic}}),FB="ElLabelWrap";var Wke=Te({name:FB,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const o=Rt(_p,void 0),i=Rt(tc);i||qr(FB,"usage: <el-form-item><label-wrap /></el-form-item>");const c=ut("form"),u=le(),f=le(0),p=()=>{var b;if((b=u.value)!=null&&b.firstElementChild){const S=window.getComputedStyle(u.value.firstElementChild).width;return Math.ceil(Number.parseFloat(S))}else return 0},v=(b="update")=>{Vt(()=>{t.default&&e.isAutoWidth&&(b==="update"?f.value=p():b==="remove"&&(o==null||o.deregisterLabelWidth(f.value)))})},_=()=>v("update");return mn(()=>{_()}),Co(()=>{v("remove")}),dl(()=>_()),st(f,(b,S)=>{e.updateAll&&(o==null||o.registerLabelWidth(b,S))}),ar(z(()=>{var b,S;return(S=(b=u.value)==null?void 0:b.firstElementChild)!=null?S:null}),_),()=>{var b,S;if(!t)return null;const{isAutoWidth:k}=e;if(k){const M=o==null?void 0:o.autoLabelWidth,R=i==null?void 0:i.hasLabel,w={};if(R&&M&&M!=="auto"){const E=Math.max(0,Number.parseInt(M,10)-f.value),F=(i.labelPosition||o.labelPosition)==="left"?"marginRight":"marginLeft";E&&(w[F]=`${E}px`)}return Me("div",{ref:u,class:[c.be("item","label-wrap")],style:w},[(b=t.default)==null?void 0:b.call(t)])}else return Me(Ht,{ref:u},[(S=t.default)==null?void 0:S.call(t)])}}});const jke=Te({name:"ElFormItem"}),Yke=Te({...jke,props:zke,setup(e,{expose:t}){const o=e,i=Qr(),c=Rt(_p,void 0),u=Rt(tc,void 0),f=Fr(void 0,{formItem:!1}),p=ut("form-item"),v=bi().value,_=le([]),b=le(""),S=vve(b,100),k=le(""),M=le();let R,w=!1;const E=z(()=>o.labelPosition||(c==null?void 0:c.labelPosition)),N=z(()=>{if(E.value==="top")return{};const xe=ur(o.labelWidth||(c==null?void 0:c.labelWidth)||"");return xe?{width:xe}:{}}),F=z(()=>{if(E.value==="top"||c!=null&&c.inline)return{};if(!o.label&&!o.labelWidth&&O)return{};const xe=ur(o.labelWidth||(c==null?void 0:c.labelWidth)||"");return!o.label&&!i.label?{marginLeft:xe}:{}}),x=z(()=>[p.b(),p.m(f.value),p.is("error",b.value==="error"),p.is("validating",b.value==="validating"),p.is("success",b.value==="success"),p.is("required",ie.value||o.required),p.is("no-asterisk",c==null?void 0:c.hideRequiredAsterisk),(c==null?void 0:c.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[p.m("feedback")]:c==null?void 0:c.statusIcon,[p.m(`label-${E.value}`)]:E.value}]),P=z(()=>vo(o.inlineMessage)?o.inlineMessage:(c==null?void 0:c.inlineMessage)||!1),G=z(()=>[p.e("error"),{[p.em("error","inline")]:P.value}]),H=z(()=>o.prop?Ut(o.prop)?o.prop:o.prop.join("."):""),Y=z(()=>!!(o.label||i.label)),j=z(()=>o.for||(_.value.length===1?_.value[0]:void 0)),W=z(()=>!j.value&&Y.value),O=!!u,Q=z(()=>{const xe=c==null?void 0:c.model;if(!(!xe||!o.prop))return a0(xe,o.prop).value}),J=z(()=>{const{required:xe}=o,Le=[];o.rules&&Le.push(...Wi(o.rules));const rt=c==null?void 0:c.rules;if(rt&&o.prop){const Qe=a0(rt,o.prop).value;Qe&&Le.push(...Wi(Qe))}if(xe!==void 0){const Qe=Le.map((Ge,_e)=>[Ge,_e]).filter(([Ge])=>Object.keys(Ge).includes("required"));if(Qe.length>0)for(const[Ge,_e]of Qe)Ge.required!==xe&&(Le[_e]={...Ge,required:xe});else Le.push({required:xe})}return Le}),oe=z(()=>J.value.length>0),pe=xe=>J.value.filter(rt=>!rt.trigger||!xe?!0:ht(rt.trigger)?rt.trigger.includes(xe):rt.trigger===xe).map(({trigger:rt,...Qe})=>Qe),ie=z(()=>J.value.some(xe=>xe.required)),te=z(()=>{var xe;return S.value==="error"&&o.showMessage&&((xe=c==null?void 0:c.showMessage)!=null?xe:!0)}),he=z(()=>`${o.label||""}${(c==null?void 0:c.labelSuffix)||""}`),re=xe=>{b.value=xe},X=xe=>{var Le,rt;const{errors:Qe,fields:Ge}=xe;(!Qe||!Ge)&&console.error(xe),re("error"),k.value=Qe?(rt=(Le=Qe==null?void 0:Qe[0])==null?void 0:Le.message)!=null?rt:`${o.prop} is required`:"",c==null||c.emit("validate",o.prop,!1,k.value)},ye=()=>{re("success"),c==null||c.emit("validate",o.prop,!0,"")},ue=async xe=>{const Le=H.value;return new hI({[Le]:xe}).validate({[Le]:Q.value},{firstFields:!0}).then(()=>(ye(),!0)).catch(Qe=>(X(Qe),Promise.reject(Qe)))},Ie=async(xe,Le)=>{if(w||!o.prop)return!1;const rt=zt(Le);if(!oe.value)return Le==null||Le(!1),!1;const Qe=pe(xe);return Qe.length===0?(Le==null||Le(!0),!0):(re("validating"),ue(Qe).then(()=>(Le==null||Le(!0),!0)).catch(Ge=>{const{fields:_e}=Ge;return Le==null||Le(!1,_e),rt?!1:Promise.reject(_e)}))},ve=()=>{re(""),k.value="",w=!1},Ce=async()=>{const xe=c==null?void 0:c.model;if(!xe||!o.prop)return;const Le=a0(xe,o.prop);w=!0,Le.value=g8(R),await Vt(),ve(),w=!1},Fe=xe=>{_.value.includes(xe)||_.value.push(xe)},Oe=xe=>{_.value=_.value.filter(Le=>Le!==xe)};st(()=>o.error,xe=>{k.value=xe||"",re(xe?"error":"")},{immediate:!0}),st(()=>o.validateStatus,xe=>re(xe||""));const be=eo({...hi(o),$el:M,size:f,validateState:b,labelId:v,inputIds:_,isGroup:W,hasLabel:Y,fieldValue:Q,addInputId:Fe,removeInputId:Oe,resetField:Ce,clearValidate:ve,validate:Ie});return Nn(tc,be),mn(()=>{o.prop&&(c==null||c.addField(be),R=g8(Q.value))}),Co(()=>{c==null||c.removeField(be)}),t({size:f,validateMessage:k,validateState:b,validate:Ie,clearValidate:ve,resetField:Ce}),(xe,Le)=>{var rt;return ee(),ge("div",{ref_key:"formItemRef",ref:M,class:ne(y(x)),role:y(W)?"group":void 0,"aria-labelledby":y(W)?y(v):void 0},[Me(y(Wke),{"is-auto-width":y(N).width==="auto","update-all":((rt=y(c))==null?void 0:rt.labelWidth)==="auto"},{default:Ae(()=>[y(Y)?(ee(),We(Tn(y(j)?"label":"div"),{key:0,id:y(v),for:y(j),class:ne(y(p).e("label")),style:qt(y(N))},{default:Ae(()=>[Ve(xe.$slots,"label",{label:y(he)},()=>[Mn(mt(y(he)),1)])]),_:3},8,["id","for","class","style"])):$e("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ee("div",{class:ne(y(p).e("content")),style:qt(y(F))},[Ve(xe.$slots,"default"),Me(H$,{name:`${y(p).namespace.value}-zoom-in-top`},{default:Ae(()=>[y(te)?Ve(xe.$slots,"error",{key:0,error:k.value},()=>[Ee("div",{class:ne(y(G))},mt(k.value),3)]):$e("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var az=vt(Yke,[["__file","form-item.vue"]]);const Jke=un(hke,{FormItem:az}),Xke=lr(az),Zke=pt({urlList:{type:Ue(Array),default:()=>sr([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Ue(String)}}),Qke={close:()=>!0,switch:e=>jt(e),rotate:e=>jt(e)},ewe=Te({name:"ElImageViewer"}),twe=Te({...ewe,props:Zke,emits:Qke,setup(e,{expose:t,emit:o}){var i;const c=e,u={CONTAIN:{name:"contain",icon:tu(O_e)},ORIGINAL:{name:"original",icon:tu(Z_e)}};let f,p="";const{t:v}=Kn(),_=ut("image-viewer"),{nextZIndex:b}=pv(),S=le(),k=le([]),M=vae(),R=le(!0),w=le(c.initialIndex),E=Go(u.CONTAIN),N=le({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),F=le((i=c.zIndex)!=null?i:b()),x=z(()=>{const{urlList:Oe}=c;return Oe.length<=1}),P=z(()=>w.value===0),G=z(()=>w.value===c.urlList.length-1),H=z(()=>c.urlList[w.value]),Y=z(()=>[_.e("btn"),_.e("prev"),_.is("disabled",!c.infinite&&P.value)]),j=z(()=>[_.e("btn"),_.e("next"),_.is("disabled",!c.infinite&&G.value)]),W=z(()=>{const{scale:Oe,deg:be,offsetX:xe,offsetY:Le,enableTransition:rt}=N.value;let Qe=xe/Oe,Ge=Le/Oe;const _e=be*Math.PI/180,Re=Math.cos(_e),Ke=Math.sin(_e);Qe=Qe*Re+Ge*Ke,Ge=Ge*Re-xe/Oe*Ke;const je={transform:`scale(${Oe}) rotate(${be}deg) translate(${Qe}px, ${Ge}px)`,transition:rt?"transform .3s":""};return E.value.name===u.CONTAIN.name&&(je.maxWidth=je.maxHeight="100%"),je}),O=z(()=>`${w.value+1} / ${c.urlList.length}`);function Q(){oe(),f==null||f(),document.body.style.overflow=p,o("close")}function J(){const Oe=rp(xe=>{switch(xe.code){case At.esc:c.closeOnPressEscape&&Q();break;case At.space:re();break;case At.left:ye();break;case At.up:Ie("zoomIn");break;case At.right:ue();break;case At.down:Ie("zoomOut");break}}),be=rp(xe=>{const Le=xe.deltaY||xe.deltaX;Ie(Le<0?"zoomIn":"zoomOut",{zoomRate:c.zoomRate,enableTransition:!1})});M.run(()=>{_o(document,"keydown",Oe),_o(document,"wheel",be)})}function oe(){M.stop()}function pe(){R.value=!1}function ie(Oe){R.value=!1,Oe.target.alt=v("el.image.error")}function te(Oe){if(R.value||Oe.button!==0||!S.value)return;N.value.enableTransition=!1;const{offsetX:be,offsetY:xe}=N.value,Le=Oe.pageX,rt=Oe.pageY,Qe=rp(_e=>{N.value={...N.value,offsetX:be+_e.pageX-Le,offsetY:xe+_e.pageY-rt}}),Ge=_o(document,"mousemove",Qe);_o(document,"mouseup",()=>{Ge()}),Oe.preventDefault()}function he(){N.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function re(){if(R.value)return;const Oe=zg(u),be=Object.values(u),xe=E.value.name,rt=(be.findIndex(Qe=>Qe.name===xe)+1)%Oe.length;E.value=u[Oe[rt]],he()}function X(Oe){const be=c.urlList.length;w.value=(Oe+be)%be}function ye(){P.value&&!c.infinite||X(w.value-1)}function ue(){G.value&&!c.infinite||X(w.value+1)}function Ie(Oe,be={}){if(R.value)return;const{minScale:xe,maxScale:Le}=c,{zoomRate:rt,rotateDeg:Qe,enableTransition:Ge}={zoomRate:c.zoomRate,rotateDeg:90,enableTransition:!0,...be};switch(Oe){case"zoomOut":N.value.scale>xe&&(N.value.scale=Number.parseFloat((N.value.scale/rt).toFixed(3)));break;case"zoomIn":N.value.scale<Le&&(N.value.scale=Number.parseFloat((N.value.scale*rt).toFixed(3)));break;case"clockwise":N.value.deg+=Qe,o("rotate",N.value.deg);break;case"anticlockwise":N.value.deg-=Qe,o("rotate",N.value.deg);break}N.value.enableTransition=Ge}function ve(Oe){var be;((be=Oe.detail)==null?void 0:be.focusReason)==="pointer"&&Oe.preventDefault()}function Ce(){c.closeOnPressEscape&&Q()}function Fe(Oe){if(Oe.ctrlKey){if(Oe.deltaY<0)return Oe.preventDefault(),!1;if(Oe.deltaY>0)return Oe.preventDefault(),!1}}return st(H,()=>{Vt(()=>{const Oe=k.value[0];Oe!=null&&Oe.complete||(R.value=!0)})}),st(w,Oe=>{he(),o("switch",Oe)}),mn(()=>{J(),f=_o("wheel",Fe,{passive:!1}),p=document.body.style.overflow,document.body.style.overflow="hidden"}),t({setActiveItem:X}),(Oe,be)=>(ee(),We(y(vv),{to:"body",disabled:!Oe.teleported},{default:Ae(()=>[Me(Zr,{name:"viewer-fade",appear:""},{default:Ae(()=>[Ee("div",{ref_key:"wrapper",ref:S,tabindex:-1,class:ne(y(_).e("wrapper")),style:qt({zIndex:F.value})},[Me(y(gv),{loop:"",trapped:"","focus-trap-el":S.value,"focus-start-el":"container",onFocusoutPrevented:ve,onReleaseRequested:Ce},{default:Ae(()=>[Ee("div",{class:ne(y(_).e("mask")),onClick:Zt(xe=>Oe.hideOnClickModal&&Q(),["self"])},null,10,["onClick"]),$e(" CLOSE "),Ee("span",{class:ne([y(_).e("btn"),y(_).e("close")]),onClick:Q},[Me(y(Pt),null,{default:Ae(()=>[Me(y(As))]),_:1})],2),$e(" ARROW "),y(x)?$e("v-if",!0):(ee(),ge(Ht,{key:0},[Ee("span",{class:ne(y(Y)),onClick:ye},[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1})],2),Ee("span",{class:ne(y(j)),onClick:ue},[Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})],2)],64)),Oe.$slots.progress||Oe.showProgress?(ee(),ge("div",{key:1,class:ne([y(_).e("btn"),y(_).e("progress")])},[Ve(Oe.$slots,"progress",{activeIndex:w.value,total:Oe.urlList.length},()=>[Mn(mt(y(O)),1)])],2)):$e("v-if",!0),$e(" ACTIONS "),Ee("div",{class:ne([y(_).e("btn"),y(_).e("actions")])},[Ee("div",{class:ne(y(_).e("actions__inner"))},[Ve(Oe.$slots,"toolbar",{actions:Ie,prev:ye,next:ue,reset:re,activeIndex:w.value,setActiveItem:X},()=>[Me(y(Pt),{onClick:xe=>Ie("zoomOut")},{default:Ae(()=>[Me(y(pye))]),_:1},8,["onClick"]),Me(y(Pt),{onClick:xe=>Ie("zoomIn")},{default:Ae(()=>[Me(y(lK))]),_:1},8,["onClick"]),Ee("i",{class:ne(y(_).e("actions__divider"))},null,2),Me(y(Pt),{onClick:re},{default:Ae(()=>[(ee(),We(Tn(y(E).icon)))]),_:1}),Ee("i",{class:ne(y(_).e("actions__divider"))},null,2),Me(y(Pt),{onClick:xe=>Ie("anticlockwise")},{default:Ae(()=>[Me(y(j_e))]),_:1},8,["onClick"]),Me(y(Pt),{onClick:xe=>Ie("clockwise")},{default:Ae(()=>[Me(y(J_e))]),_:1},8,["onClick"])])],2)],2),$e(" CANVAS "),Ee("div",{class:ne(y(_).e("canvas"))},[(ee(!0),ge(Ht,null,Un(Oe.urlList,(xe,Le)=>fn((ee(),ge("img",{ref_for:!0,ref:rt=>k.value[Le]=rt,key:xe,src:xe,style:qt(y(W)),class:ne(y(_).e("img")),crossorigin:Oe.crossorigin,onLoad:pe,onError:ie,onMousedown:te},null,46,["src","crossorigin"])),[[Zn,Le===w.value]])),128))],2),Ve(Oe.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var nwe=vt(twe,[["__file","image-viewer.vue"]]);const sz=un(nwe),owe=pt({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Ue([String,Object])},previewSrcList:{type:Ue(Array),default:()=>sr([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Ue(String)}}),rwe={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>jt(e),close:()=>!0,show:()=>!0},iwe=Te({name:"ElImage",inheritAttrs:!1}),awe=Te({...iwe,props:owe,emits:rwe,setup(e,{expose:t,emit:o}){const i=e,{t:c}=Kn(),u=ut("image"),f=uu(),p=z(()=>L0(Object.entries(f).filter(([te])=>/^(data-|on[A-Z])/i.test(te)||["id","style"].includes(te)))),v=lI({excludeListeners:!0,excludeKeys:z(()=>Object.keys(p.value))}),_=le(),b=le(!1),S=le(!0),k=le(!1),M=le(),R=le(),w=$n&&"loading"in HTMLImageElement.prototype;let E;const N=z(()=>[u.e("inner"),x.value&&u.e("preview"),S.value&&u.is("loading")]),F=z(()=>{const{fit:te}=i;return $n&&te?{objectFit:te}:{}}),x=z(()=>{const{previewSrcList:te}=i;return ht(te)&&te.length>0}),P=z(()=>{const{previewSrcList:te,initialIndex:he}=i;let re=he;return he>te.length-1&&(re=0),re}),G=z(()=>i.loading==="eager"?!1:!w&&i.loading==="lazy"||i.lazy),H=()=>{$n&&(S.value=!0,b.value=!1,_.value=i.src)};function Y(te){S.value=!1,b.value=!1,o("load",te)}function j(te){S.value=!1,b.value=!0,o("error",te)}function W(){kEe(M.value,R.value)&&(H(),J())}const O=Gq(W,200,!0);async function Q(){var te;if(!$n)return;await Vt();const{scrollContainer:he}=i;la(he)?R.value=he:Ut(he)&&he!==""?R.value=(te=document.querySelector(he))!=null?te:void 0:M.value&&(R.value=tN(M.value)),R.value&&(E=_o(R,"scroll",O),setTimeout(()=>W(),100))}function J(){!$n||!R.value||!O||(E==null||E(),R.value=void 0)}function oe(){x.value&&(k.value=!0,o("show"))}function pe(){k.value=!1,o("close")}function ie(te){o("switch",te)}return st(()=>i.src,()=>{G.value?(S.value=!0,b.value=!1,J(),Q()):H()}),mn(()=>{G.value?Q():H()}),t({showPreview:oe}),(te,he)=>(ee(),ge("div",An({ref_key:"container",ref:M},y(p),{class:[y(u).b(),te.$attrs.class]}),[b.value?Ve(te.$slots,"error",{key:0},()=>[Ee("div",{class:ne(y(u).e("error"))},mt(y(c)("el.image.error")),3)]):(ee(),ge(Ht,{key:1},[_.value!==void 0?(ee(),ge("img",An({key:0},y(v),{src:_.value,loading:te.loading,style:y(F),class:y(N),crossorigin:te.crossorigin,onClick:oe,onLoad:Y,onError:j}),null,16,["src","loading","crossorigin"])):$e("v-if",!0),S.value?(ee(),ge("div",{key:1,class:ne(y(u).e("wrapper"))},[Ve(te.$slots,"placeholder",{},()=>[Ee("div",{class:ne(y(u).e("placeholder"))},null,2)])],2)):$e("v-if",!0)],64)),y(x)?(ee(),ge(Ht,{key:2},[k.value?(ee(),We(y(sz),{key:0,"z-index":te.zIndex,"initial-index":y(P),infinite:te.infinite,"zoom-rate":te.zoomRate,"min-scale":te.minScale,"max-scale":te.maxScale,"show-progress":te.showProgress,"url-list":te.previewSrcList,crossorigin:te.crossorigin,"hide-on-click-modal":te.hideOnClickModal,teleported:te.previewTeleported,"close-on-press-escape":te.closeOnPressEscape,onClose:pe,onSwitch:ie},{progress:Ae(re=>[Ve(te.$slots,"progress",Za(Zl(re)))]),toolbar:Ae(re=>[Ve(te.$slots,"toolbar",Za(Zl(re)))]),default:Ae(()=>[te.$slots.viewer?(ee(),ge("div",{key:0},[Ve(te.$slots,"viewer")])):$e("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):$e("v-if",!0)],64)):$e("v-if",!0)],16))}});var swe=vt(awe,[["__file","image.vue"]]);const lwe=un(swe),cwe=pt({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Kr,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||jt(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...Ci(["ariaLabel"])}),uwe={[wn]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Jr]:e=>jt(e)||oi(e),[nn]:e=>jt(e)||oi(e)},dwe=Te({name:"ElInputNumber"}),hwe=Te({...dwe,props:cwe,emits:uwe,setup(e,{expose:t,emit:o}){const i=e,{t:c}=Kn(),u=ut("input-number"),f=le(),p=eo({currentValue:i.modelValue,userInput:null}),{formItem:v}=Ni(),_=z(()=>jt(i.modelValue)&&i.modelValue<=i.min),b=z(()=>jt(i.modelValue)&&i.modelValue>=i.max),S=z(()=>{const ie=N(i.step);return qn(i.precision)?Math.max(N(i.modelValue),ie):(ie>i.precision,i.precision)}),k=z(()=>i.controls&&i.controlsPosition==="right"),M=Fr(),R=Pi(),w=z(()=>{if(p.userInput!==null)return p.userInput;let ie=p.currentValue;if(oi(ie))return"";if(jt(ie)){if(Number.isNaN(ie))return"";qn(i.precision)||(ie=ie.toFixed(i.precision))}return ie}),E=(ie,te)=>{if(qn(te)&&(te=S.value),te===0)return Math.round(ie);let he=String(ie);const re=he.indexOf(".");if(re===-1||!he.replace(".","").split("")[re+te])return ie;const ue=he.length;return he.charAt(ue-1)==="5"&&(he=`${he.slice(0,Math.max(0,ue-1))}6`),Number.parseFloat(Number(he).toFixed(te))},N=ie=>{if(oi(ie))return 0;const te=ie.toString(),he=te.indexOf(".");let re=0;return he!==-1&&(re=te.length-he-1),re},F=(ie,te=1)=>jt(ie)?E(ie+i.step*te):p.currentValue,x=()=>{if(i.readonly||R.value||b.value)return;const ie=Number(w.value)||0,te=F(ie);H(te),o(Jr,p.currentValue),oe()},P=()=>{if(i.readonly||R.value||_.value)return;const ie=Number(w.value)||0,te=F(ie,-1);H(te),o(Jr,p.currentValue),oe()},G=(ie,te)=>{const{max:he,min:re,step:X,precision:ye,stepStrictly:ue,valueOnClear:Ie}=i;he<re&&qr("InputNumber","min should not be greater than max.");let ve=Number(ie);if(oi(ie)||Number.isNaN(ve))return null;if(ie===""){if(Ie===null)return null;ve=Ut(Ie)?{min:re,max:he}[Ie]:Ie}return ue&&(ve=E(Math.round(ve/X)*X,ye),ve!==ie&&te&&o(nn,ve)),qn(ye)||(ve=E(ve,ye)),(ve>he||ve<re)&&(ve=ve>he?he:re,te&&o(nn,ve)),ve},H=(ie,te=!0)=>{var he;const re=p.currentValue,X=G(ie);if(!te){o(nn,X);return}re===X&&ie||(p.userInput=null,o(nn,X),re!==X&&o(wn,X,re),i.validateEvent&&((he=v==null?void 0:v.validate)==null||he.call(v,"change").catch(ye=>void 0)),p.currentValue=X)},Y=ie=>{p.userInput=ie;const te=ie===""?null:Number(ie);o(Jr,te),H(te,!1)},j=ie=>{const te=ie!==""?Number(ie):"";(jt(te)&&!Number.isNaN(te)||ie==="")&&H(te),oe(),p.userInput=null},W=()=>{var ie,te;(te=(ie=f.value)==null?void 0:ie.focus)==null||te.call(ie)},O=()=>{var ie,te;(te=(ie=f.value)==null?void 0:ie.blur)==null||te.call(ie)},Q=ie=>{o("focus",ie)},J=ie=>{var te,he;p.userInput=null,GT()&&p.currentValue===null&&((te=f.value)!=null&&te.input)&&(f.value.input.value=""),o("blur",ie),i.validateEvent&&((he=v==null?void 0:v.validate)==null||he.call(v,"blur").catch(re=>void 0))},oe=()=>{p.currentValue!==i.modelValue&&(p.currentValue=i.modelValue)},pe=ie=>{document.activeElement===ie.target&&ie.preventDefault()};return st(()=>i.modelValue,(ie,te)=>{const he=G(ie,!0);p.userInput===null&&he!==te&&(p.currentValue=he)},{immediate:!0}),mn(()=>{var ie;const{min:te,max:he,modelValue:re}=i,X=(ie=f.value)==null?void 0:ie.input;if(X.setAttribute("role","spinbutton"),Number.isFinite(he)?X.setAttribute("aria-valuemax",String(he)):X.removeAttribute("aria-valuemax"),Number.isFinite(te)?X.setAttribute("aria-valuemin",String(te)):X.removeAttribute("aria-valuemin"),X.setAttribute("aria-valuenow",p.currentValue||p.currentValue===0?String(p.currentValue):""),X.setAttribute("aria-disabled",String(R.value)),!jt(re)&&re!=null){let ye=Number(re);Number.isNaN(ye)&&(ye=null),o(nn,ye)}X.addEventListener("wheel",pe,{passive:!1})}),dl(()=>{var ie,te;const he=(ie=f.value)==null?void 0:ie.input;he==null||he.setAttribute("aria-valuenow",`${(te=p.currentValue)!=null?te:""}`)}),t({focus:W,blur:O}),(ie,te)=>(ee(),ge("div",{class:ne([y(u).b(),y(u).m(y(M)),y(u).is("disabled",y(R)),y(u).is("without-controls",!ie.controls),y(u).is("controls-right",y(k))]),onDragstart:Zt(()=>{},["prevent"])},[ie.controls?fn((ee(),ge("span",{key:0,role:"button","aria-label":y(c)("el.inputNumber.decrease"),class:ne([y(u).e("decrease"),y(u).is("disabled",y(_))]),onKeydown:To(P,["enter"])},[Ve(ie.$slots,"decrease-icon",{},()=>[Me(y(Pt),null,{default:Ae(()=>[y(k)?(ee(),We(y(fu),{key:0})):(ee(),We(y(F_e),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(YE),P]]):$e("v-if",!0),ie.controls?fn((ee(),ge("span",{key:1,role:"button","aria-label":y(c)("el.inputNumber.increase"),class:ne([y(u).e("increase"),y(u).is("disabled",y(b))]),onKeydown:To(x,["enter"])},[Ve(ie.$slots,"increase-icon",{},()=>[Me(y(Pt),null,{default:Ae(()=>[y(k)?(ee(),We(y(oN),{key:0})):(ee(),We(y(aK),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(YE),x]]):$e("v-if",!0),Me(y(Yi),{id:ie.id,ref_key:"input",ref:f,type:"number",step:ie.step,"model-value":y(w),placeholder:ie.placeholder,readonly:ie.readonly,disabled:y(R),size:y(M),max:ie.max,min:ie.min,name:ie.name,"aria-label":ie.ariaLabel,"validate-event":!1,onKeydown:[To(Zt(x,["prevent"]),["up"]),To(Zt(P,["prevent"]),["down"])],onBlur:J,onFocus:Q,onInput:Y,onChange:j},rs({_:2},[ie.$slots.prefix?{name:"prefix",fn:Ae(()=>[Ve(ie.$slots,"prefix")])}:void 0,ie.$slots.suffix?{name:"suffix",fn:Ae(()=>[Ve(ie.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var fwe=vt(hwe,[["__file","input-number.vue"]]);const lz=un(fwe),pwe=pt({modelValue:{type:Ue(Array)},max:Number,tagType:{...su.type,default:"info"},tagEffect:su.effect,trigger:{type:Ue(String),default:At.enter},draggable:{type:Boolean,default:!1},delimiter:{type:[String,RegExp],default:""},size:Kr,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),mwe={[nn]:e=>ht(e)||qn(e),[wn]:e=>ht(e)||qn(e),[Jr]:e=>Ut(e),"add-tag":e=>Ut(e),"remove-tag":e=>Ut(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function gwe({props:e,emit:t,formItem:o}){const i=Pi(),c=Fr(),u=Go(),f=le(),p=z(()=>["small"].includes(c.value)?"small":"default"),v=z(()=>{var W;return(W=e.modelValue)!=null&&W.length?void 0:e.placeholder}),_=z(()=>!(e.readonly||i.value)),b=z(()=>{var W,O;return qn(e.max)?!1:((O=(W=e.modelValue)==null?void 0:W.length)!=null?O:0)>=e.max}),S=W=>{var O,Q;if(b.value){f.value=void 0;return}if(!G.value){if(e.delimiter){const J=(O=f.value)==null?void 0:O.replace(e.delimiter,"");(J==null?void 0:J.length)!==((Q=f.value)==null?void 0:Q.length)&&(f.value=J,M())}t(Jr,W.target.value)}},k=W=>{var O;if(!G.value)switch(W.code){case e.trigger:W.preventDefault(),W.stopPropagation(),M();break;case At.numpadEnter:e.trigger===At.enter&&(W.preventDefault(),W.stopPropagation(),M());break;case At.backspace:!f.value&&((O=e.modelValue)!=null&&O.length)&&(W.preventDefault(),W.stopPropagation(),R(e.modelValue.length-1));break}},M=()=>{var W,O;const Q=(W=f.value)==null?void 0:W.trim();if(!Q||b.value)return;const J=[...(O=e.modelValue)!=null?O:[],Q];t(nn,J),t(wn,J),t("add-tag",Q),f.value=void 0},R=W=>{var O;const Q=((O=e.modelValue)!=null?O:[]).slice(),[J]=Q.splice(W,1);t(nn,Q),t(wn,Q),t("remove-tag",J)},w=()=>{f.value=void 0,t(nn,void 0),t(wn,void 0),t("clear")},E=(W,O,Q)=>{var J;const oe=((J=e.modelValue)!=null?J:[]).slice(),[pe]=oe.splice(W,1),ie=O>W&&Q==="before"?-1:O<W&&Q==="after"?1:0;oe.splice(O+ie,0,pe),t(nn,oe),t(wn,oe)},N=()=>{var W;(W=u.value)==null||W.focus()},F=()=>{var W;(W=u.value)==null||W.blur()},{wrapperRef:x,isFocused:P}=ah(u,{beforeFocus(){return i.value},afterBlur(){var W;e.saveOnBlur?M():f.value=void 0,e.validateEvent&&((W=o==null?void 0:o.validate)==null||W.call(o,"blur").catch(O=>void 0))}}),{isComposing:G,handleCompositionStart:H,handleCompositionUpdate:Y,handleCompositionEnd:j}=cI({afterComposition:S});return st(()=>e.modelValue,()=>{var W;e.validateEvent&&((W=o==null?void 0:o.validate)==null||W.call(o,wn).catch(O=>void 0))}),{inputRef:u,wrapperRef:x,isFocused:P,isComposing:G,inputValue:f,size:c,tagSize:p,placeholder:v,closable:_,disabled:i,inputLimit:b,handleDragged:E,handleInput:S,handleKeydown:k,handleAddTag:M,handleRemoveTag:R,handleClear:w,handleCompositionStart:H,handleCompositionUpdate:Y,handleCompositionEnd:j,focus:N,blur:F}}function vwe(){const e=le(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function HN(){const e=Go(),t=le(0),o=11,i=z(()=>({minWidth:`${Math.max(t.value,o)}px`}));return ar(e,()=>{var u,f;t.value=(f=(u=e.value)==null?void 0:u.getBoundingClientRect().width)!=null?f:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:i}}function _we({wrapperRef:e,handleDragged:t,afterDragged:o}){const i=ut("input-tag"),c=Go(),u=le(!1);let f,p,v,_;function b(R){return`.${i.e("inner")} .${i.namespace.value}-tag:nth-child(${R+1})`}function S(R,w){f=w,p=e.value.querySelector(b(w)),p&&(p.style.opacity="0.5"),R.dataTransfer.effectAllowed="move"}function k(R,w){if(v=w,R.preventDefault(),R.dataTransfer.dropEffect="move",qn(f)||f===w){u.value=!1;return}const E=e.value.querySelector(b(w)).getBoundingClientRect(),N=f+1!==w,F=f-1!==w,x=R.clientX-E.left,P=N?F?.5:1:-1,G=F?N?.5:0:1;x<=E.width*P?_="before":x>E.width*G?_="after":_=void 0;const H=e.value.querySelector(`.${i.e("inner")}`),Y=H.getBoundingClientRect(),j=Number.parseFloat(Yc(H,"gap"))/2,W=E.top-Y.top;let O=-9999;if(_==="before")O=Math.max(E.left-Y.left-j,Math.floor(-j/2));else if(_==="after"){const Q=E.right-Y.left;O=Q+(Y.width===Q?Math.floor(j/2):j)}eK(c.value,{top:`${W}px`,left:`${O}px`}),u.value=!!_}function M(R){R.preventDefault(),p&&(p.style.opacity=""),_&&!qn(f)&&!qn(v)&&f!==v&&t(f,v,_),u.value=!1,f=void 0,p=null,v=void 0,_=void 0,o==null||o()}return{dropIndicatorRef:c,showDropIndicator:u,handleDragStart:S,handleDragOver:k,handleDragEnd:M}}function ywe({props:e,isFocused:t,hovering:o,disabled:i,inputValue:c,size:u,validateState:f,validateIcon:p,needStatusIcon:v}){const _=uu(),b=Qr(),S=ut("input-tag"),k=ut("input"),M=z(()=>[S.b(),S.is("focused",t.value),S.is("hovering",o.value),S.is("disabled",i.value),S.m(u.value),S.e("wrapper"),_.class]),R=z(()=>[_.style]),w=z(()=>{var F,x;return[S.e("inner"),S.is("draggable",e.draggable),S.is("left-space",!((F=e.modelValue)!=null&&F.length)&&!b.prefix),S.is("right-space",!((x=e.modelValue)!=null&&x.length)&&!N.value)]}),E=z(()=>{var F;return e.clearable&&!i.value&&!e.readonly&&(((F=e.modelValue)==null?void 0:F.length)||c.value)&&(t.value||o.value)}),N=z(()=>b.suffix||E.value||f.value&&p.value&&v.value);return{ns:S,nsInput:k,containerKls:M,containerStyle:R,innerKls:w,showClear:E,showSuffix:N}}const Iwe=Te({name:"ElInputTag",inheritAttrs:!1}),bwe=Te({...Iwe,props:pwe,emits:mwe,setup(e,{expose:t,emit:o}){const i=e,c=lI(),u=Qr(),{form:f,formItem:p}=Ni(),{inputId:v}=Ps(i,{formItemContext:p}),_=z(()=>{var Ge;return(Ge=f==null?void 0:f.statusIcon)!=null?Ge:!1}),b=z(()=>(p==null?void 0:p.validateState)||""),S=z(()=>b.value&&VT[b.value]),{inputRef:k,wrapperRef:M,isFocused:R,inputValue:w,size:E,tagSize:N,placeholder:F,closable:x,disabled:P,handleDragged:G,handleInput:H,handleKeydown:Y,handleRemoveTag:j,handleClear:W,handleCompositionStart:O,handleCompositionUpdate:Q,handleCompositionEnd:J,focus:oe,blur:pe}=gwe({props:i,emit:o,formItem:p}),{hovering:ie,handleMouseEnter:te,handleMouseLeave:he}=vwe(),{calculatorRef:re,inputStyle:X}=HN(),{dropIndicatorRef:ye,showDropIndicator:ue,handleDragStart:Ie,handleDragOver:ve,handleDragEnd:Ce}=_we({wrapperRef:M,handleDragged:G,afterDragged:oe}),{ns:Fe,nsInput:Oe,containerKls:be,containerStyle:xe,innerKls:Le,showClear:rt,showSuffix:Qe}=ywe({props:i,hovering:ie,isFocused:R,inputValue:w,disabled:P,size:E,validateState:b,validateIcon:S,needStatusIcon:_});return t({focus:oe,blur:pe}),(Ge,_e)=>(ee(),ge("div",{ref_key:"wrapperRef",ref:M,class:ne(y(be)),style:qt(y(xe)),onMouseenter:y(te),onMouseleave:y(he)},[y(u).prefix?(ee(),ge("div",{key:0,class:ne(y(Fe).e("prefix"))},[Ve(Ge.$slots,"prefix")],2)):$e("v-if",!0),Ee("div",{class:ne(y(Le))},[(ee(!0),ge(Ht,null,Un(Ge.modelValue,(Re,Ke)=>(ee(),We(y(Zg),{key:Ke,size:y(N),closable:y(x),type:Ge.tagType,effect:Ge.tagEffect,draggable:y(x)&&Ge.draggable,"disable-transitions":"",onClose:je=>y(j)(Ke),onDragstart:je=>y(Ie)(je,Ke),onDragover:je=>y(ve)(je,Ke),onDragend:y(Ce),onDrop:Zt(()=>{},["stop"])},{default:Ae(()=>[Ve(Ge.$slots,"tag",{value:Re,index:Ke},()=>[Mn(mt(Re),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),Ee("div",{class:ne(y(Fe).e("input-wrapper"))},[fn(Ee("input",An({id:y(v),ref_key:"inputRef",ref:k,"onUpdate:modelValue":Re=>Bo(w)?w.value=Re:null},y(c),{type:"text",minlength:Ge.minlength,maxlength:Ge.maxlength,disabled:y(P),readonly:Ge.readonly,autocomplete:Ge.autocomplete,tabindex:Ge.tabindex,placeholder:y(F),autofocus:Ge.autofocus,ariaLabel:Ge.ariaLabel,class:y(Fe).e("input"),style:y(X),onCompositionstart:y(O),onCompositionupdate:y(Q),onCompositionend:y(J),onInput:y(H),onKeydown:y(Y)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[ET,y(w)]]),Ee("span",{ref_key:"calculatorRef",ref:re,"aria-hidden":"true",class:ne(y(Fe).e("input-calculator")),textContent:mt(y(w))},null,10,["textContent"])],2),fn(Ee("div",{ref_key:"dropIndicatorRef",ref:ye,class:ne(y(Fe).e("drop-indicator"))},null,2),[[Zn,y(ue)]])],2),y(Qe)?(ee(),ge("div",{key:1,class:ne(y(Fe).e("suffix"))},[Ve(Ge.$slots,"suffix"),y(rt)?(ee(),We(y(Pt),{key:0,class:ne([y(Fe).e("icon"),y(Fe).e("clear")]),onMousedown:Zt(y(lo),["prevent"]),onClick:y(W)},{default:Ae(()=>[Me(y(pu))]),_:1},8,["class","onMousedown","onClick"])):$e("v-if",!0),y(b)&&y(S)&&y(_)?(ee(),We(y(Pt),{key:1,class:ne([y(Oe).e("icon"),y(Oe).e("validateIcon"),y(Oe).is("loading",y(b)==="validating")])},{default:Ae(()=>[(ee(),We(Tn(y(S))))]),_:1},8,["class"])):$e("v-if",!0)],2)):$e("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var Cwe=vt(bwe,[["__file","input-tag.vue"]]);const Swe=un(Cwe),Ewe=pt({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:[Boolean,String],values:[!0,!1,"always","never","hover"],default:"hover"},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:ho}}),Twe={click:e=>e instanceof MouseEvent},Mwe=Te({name:"ElLink"}),kwe=Te({...Mwe,props:Ewe,emits:Twe,setup(e,{emit:t}){const o=e;ou({scope:"el-link",from:"The underline option (boolean)",replacement:"'always' | 'hover' | 'never'",version:"3.0.0",ref:"https://element-plus.org/en-US/component/link.html#underline"},z(()=>vo(o.underline)));const i=ut("link"),c=z(()=>[i.b(),i.m(o.type),i.is("disabled",o.disabled),i.is("underline",u.value==="always"),i.is("hover-underline",u.value==="hover"&&!o.disabled)]),u=z(()=>vo(o.underline)?o.underline?"hover":"never":o.underline);function f(p){o.disabled||t("click",p)}return(p,v)=>(ee(),ge("a",{class:ne(y(c)),href:p.disabled||!p.href?void 0:p.href,target:p.disabled||!p.href?void 0:p.target,onClick:f},[p.icon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(p.icon)))]),_:1})):$e("v-if",!0),p.$slots.default?(ee(),ge("span",{key:1,class:ne(y(i).e("inner"))},[Ve(p.$slots,"default")],2)):$e("v-if",!0),p.$slots.icon?Ve(p.$slots,"icon",{key:2}):$e("v-if",!0)],10,["href","target"]))}});var wwe=vt(kwe,[["__file","link.vue"]]);const Rwe=un(wwe);let Awe=class{constructor(t,o){this.parent=t,this.domNode=o,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,o=>{o.addEventListener("keydown",i=>{let c=!1;switch(i.code){case At.down:{this.gotoSubIndex(this.subIndex+1),c=!0;break}case At.up:{this.gotoSubIndex(this.subIndex-1),c=!0;break}case At.tab:{cE(t,"mouseleave");break}case At.enter:case At.numpadEnter:case At.space:{c=!0,i.currentTarget.click();break}}return c&&(i.preventDefault(),i.stopPropagation()),!1})})}},Dwe=class{constructor(t,o){this.domNode=t,this.submenu=null,this.submenu=null,this.init(o)}init(t){this.domNode.setAttribute("tabindex","0");const o=this.domNode.querySelector(`.${t}-menu`);o&&(this.submenu=new Awe(this,o)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let o=!1;switch(t.code){case At.down:{cE(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),o=!0;break}case At.up:{cE(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),o=!0;break}case At.tab:{cE(t.currentTarget,"mouseleave");break}case At.enter:case At.numpadEnter:case At.space:{o=!0,t.currentTarget.click();break}}o&&t.preventDefault()})}},Owe=class{constructor(t,o){this.domNode=t,this.init(o)}init(t){const o=this.domNode.childNodes;Array.from(o).forEach(i=>{i.nodeType===1&&new Dwe(i,t)})}};const Lwe=Te({name:"ElMenuCollapseTransition"}),Nwe=Te({...Lwe,setup(e){const t=ut("menu"),o={onBeforeEnter:i=>i.style.opacity="0.2",onEnter(i,c){Ss(i,`${t.namespace.value}-opacity-transition`),i.style.opacity="1",c()},onAfterEnter(i){Ji(i,`${t.namespace.value}-opacity-transition`),i.style.opacity=""},onBeforeLeave(i){i.dataset||(i.dataset={}),wa(i,t.m("collapse"))?(Ji(i,t.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Ss(i,t.m("collapse"))):(Ss(i,t.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Ji(i,t.m("collapse"))),i.style.width=`${i.scrollWidth}px`,i.style.overflow="hidden"},onLeave(i){Ss(i,"horizontal-collapse-transition"),i.style.width=`${i.dataset.scrollWidth}px`}};return(i,c)=>(ee(),We(Zr,An({mode:"out-in"},y(o)),{default:Ae(()=>[Ve(i.$slots,"default")]),_:3},16))}});var Pwe=vt(Nwe,[["__file","menu-collapse-transition.vue"]]);function cz(e,t){const o=z(()=>{let c=e.parent;const u=[t.value];for(;c.type.name!=="ElMenu";)c.props.index&&u.unshift(c.props.index),c=c.parent;return u});return{parentMenu:z(()=>{let c=e.parent;for(;c&&!["ElMenu","ElSubMenu"].includes(c.type.name);)c=c.parent;return c}),indexPath:o}}function xwe(e){return z(()=>{const o=e.backgroundColor;return o?new KK(o).shade(20).toString():""})}const uz=(e,t)=>{const o=ut("menu");return z(()=>o.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":xwe(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},Uwe=pt({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:ho},expandOpenIcon:{type:ho},collapseCloseIcon:{type:ho},collapseOpenIcon:{type:ho}}),aD="ElSubMenu";var $N=Te({name:aD,props:Uwe,setup(e,{slots:t,expose:o}){const i=kn(),{indexPath:c,parentMenu:u}=cz(i,z(()=>e.index)),f=ut("menu"),p=ut("sub-menu"),v=Rt("rootMenu");v||qr(aD,"can not inject root menu");const _=Rt(`subMenu:${u.value.uid}`);_||qr(aD,"can not inject sub menu");const b=le({}),S=le({});let k;const M=le(!1),R=le(),w=le(),E=z(()=>j.value==="horizontal"&&F.value?"bottom-start":"right-start"),N=z(()=>j.value==="horizontal"&&F.value||j.value==="vertical"&&!v.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?H.value?e.expandOpenIcon:e.expandCloseIcon:fu:e.collapseCloseIcon&&e.collapseOpenIcon?H.value?e.collapseOpenIcon:e.collapseCloseIcon:ca),F=z(()=>_.level===0),x=z(()=>{const ue=e.teleported;return qn(ue)?F.value:ue}),P=z(()=>v.props.collapse?`${f.namespace.value}-zoom-in-left`:`${f.namespace.value}-zoom-in-top`),G=z(()=>j.value==="horizontal"&&F.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),H=z(()=>v.openedMenus.includes(e.index)),Y=z(()=>[...Object.values(b.value),...Object.values(S.value)].some(({active:ue})=>ue)),j=z(()=>v.props.mode),W=z(()=>v.props.persistent),O=eo({index:e.index,indexPath:c,active:Y}),Q=uz(v.props,_.level+1),J=z(()=>{var ue;return(ue=e.popperOffset)!=null?ue:v.props.popperOffset}),oe=z(()=>{var ue;return(ue=e.popperClass)!=null?ue:v.props.popperClass}),pe=z(()=>{var ue;return(ue=e.showTimeout)!=null?ue:v.props.showTimeout}),ie=z(()=>{var ue;return(ue=e.hideTimeout)!=null?ue:v.props.hideTimeout}),te=()=>{var ue,Ie,ve;return(ve=(Ie=(ue=w.value)==null?void 0:ue.popperRef)==null?void 0:Ie.popperInstanceRef)==null?void 0:ve.destroy()},he=ue=>{ue||te()},re=()=>{v.props.menuTrigger==="hover"&&v.props.mode==="horizontal"||v.props.collapse&&v.props.mode==="vertical"||e.disabled||v.handleSubMenuClick({index:e.index,indexPath:c.value,active:Y.value})},X=(ue,Ie=pe.value)=>{var ve;if(ue.type!=="focus"){if(v.props.menuTrigger==="click"&&v.props.mode==="horizontal"||!v.props.collapse&&v.props.mode==="vertical"||e.disabled){_.mouseInChild.value=!0;return}_.mouseInChild.value=!0,k==null||k(),{stop:k}=cp(()=>{v.openMenu(e.index,c.value)},Ie),x.value&&((ve=u.value.vnode.el)==null||ve.dispatchEvent(new MouseEvent("mouseenter")))}},ye=(ue=!1)=>{var Ie;if(v.props.menuTrigger==="click"&&v.props.mode==="horizontal"||!v.props.collapse&&v.props.mode==="vertical"){_.mouseInChild.value=!1;return}k==null||k(),_.mouseInChild.value=!1,{stop:k}=cp(()=>!M.value&&v.closeMenu(e.index,c.value),ie.value),x.value&&ue&&((Ie=_.handleMouseleave)==null||Ie.call(_,!0))};st(()=>v.props.collapse,ue=>he(!!ue));{const ue=ve=>{S.value[ve.index]=ve},Ie=ve=>{delete S.value[ve.index]};Nn(`subMenu:${i.uid}`,{addSubMenu:ue,removeSubMenu:Ie,handleMouseleave:ye,mouseInChild:M,level:_.level+1})}return o({opened:H}),mn(()=>{v.addSubMenu(O),_.addSubMenu(O)}),Co(()=>{_.removeSubMenu(O),v.removeSubMenu(O)}),()=>{var ue;const Ie=[(ue=t.title)==null?void 0:ue.call(t),Jt(Pt,{class:p.e("icon-arrow"),style:{transform:H.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&v.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Ut(N.value)?Jt(i.appContext.components[N.value]):Jt(N.value)})],ve=v.isMenuPopup?Jt(Li,{ref:w,visible:H.value,effect:"light",pure:!0,offset:J.value,showArrow:!1,persistent:W.value,popperClass:oe.value,placement:E.value,teleported:x.value,fallbackPlacements:G.value,transition:P.value,gpuAcceleration:!1},{content:()=>{var Ce;return Jt("div",{class:[f.m(j.value),f.m("popup-container"),oe.value],onMouseenter:Fe=>X(Fe,100),onMouseleave:()=>ye(!0),onFocus:Fe=>X(Fe,100)},[Jt("ul",{class:[f.b(),f.m("popup"),f.m(`popup-${E.value}`)],style:Q.value},[(Ce=t.default)==null?void 0:Ce.call(t)])])},default:()=>Jt("div",{class:p.e("title"),onClick:re},Ie)}):Jt(Ht,{},[Jt("div",{class:p.e("title"),ref:R,onClick:re},Ie),Jt(KT,{},{default:()=>{var Ce;return fn(Jt("ul",{role:"menu",class:[f.b(),f.m("inline")],style:Q.value},[(Ce=t.default)==null?void 0:Ce.call(t)]),[[Zn,H.value]])}})]);return Jt("li",{class:[p.b(),p.is("active",Y.value),p.is("opened",H.value),p.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:H.value,onMouseenter:X,onMouseleave:()=>ye(),onFocus:X},[ve])}}});const Fwe=pt({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:Ue(Array),default:()=>sr([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:ho,default:()=>B_e},popperEffect:{type:Ue(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},persistent:{type:Boolean,default:!0}}),sD=e=>ht(e)&&e.every(t=>Ut(t)),Vwe={close:(e,t)=>Ut(e)&&sD(t),open:(e,t)=>Ut(e)&&sD(t),select:(e,t,o,i)=>Ut(e)&&sD(t)&&gn(o)&&(qn(i)||i instanceof Promise)};var Gwe=Te({name:"ElMenu",props:Fwe,emits:Vwe,setup(e,{emit:t,slots:o,expose:i}){const c=kn(),u=c.appContext.config.globalProperties.$router,f=le(),p=ut("menu"),v=ut("sub-menu"),_=le(-1),b=le(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),S=le(e.defaultActive),k=le({}),M=le({}),R=z(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),w=()=>{const ie=S.value&&k.value[S.value];if(!ie||e.mode==="horizontal"||e.collapse)return;ie.indexPath.forEach(he=>{const re=M.value[he];re&&E(he,re.indexPath)})},E=(ie,te)=>{b.value.includes(ie)||(e.uniqueOpened&&(b.value=b.value.filter(he=>te.includes(he))),b.value.push(ie),t("open",ie,te))},N=ie=>{const te=b.value.indexOf(ie);te!==-1&&b.value.splice(te,1)},F=(ie,te)=>{N(ie),t("close",ie,te)},x=({index:ie,indexPath:te})=>{b.value.includes(ie)?F(ie,te):E(ie,te)},P=ie=>{(e.mode==="horizontal"||e.collapse)&&(b.value=[]);const{index:te,indexPath:he}=ie;if(!(oi(te)||oi(he)))if(e.router&&u){const re=ie.route||te,X=u.push(re).then(ye=>(ye||(S.value=te),ye));t("select",te,he,{index:te,indexPath:he,route:re},X)}else S.value=te,t("select",te,he,{index:te,indexPath:he})},G=ie=>{var te;const he=k.value,re=he[ie]||S.value&&he[S.value]||he[e.defaultActive];S.value=(te=re==null?void 0:re.index)!=null?te:ie},H=ie=>{const te=getComputedStyle(ie),he=Number.parseInt(te.marginLeft,10),re=Number.parseInt(te.marginRight,10);return ie.offsetWidth+he+re||0},Y=()=>{var ie,te;if(!f.value)return-1;const he=Array.from((te=(ie=f.value)==null?void 0:ie.childNodes)!=null?te:[]).filter(Fe=>Fe.nodeName!=="#text"||Fe.nodeValue),re=64,X=getComputedStyle(f.value),ye=Number.parseInt(X.paddingLeft,10),ue=Number.parseInt(X.paddingRight,10),Ie=f.value.clientWidth-ye-ue;let ve=0,Ce=0;return he.forEach((Fe,Oe)=>{Fe.nodeName!=="#comment"&&(ve+=H(Fe),ve<=Ie-re&&(Ce=Oe+1))}),Ce===he.length?-1:Ce},j=ie=>M.value[ie].indexPath,W=(ie,te=33.34)=>{let he;return()=>{he&&clearTimeout(he),he=setTimeout(()=>{ie()},te)}};let O=!0;const Q=()=>{if(_.value===Y())return;const ie=()=>{_.value=-1,Vt(()=>{_.value=Y()})};O?ie():W(ie)(),O=!1};st(()=>e.defaultActive,ie=>{k.value[ie]||(S.value=""),G(ie)}),st(()=>e.collapse,ie=>{ie&&(b.value=[])}),st(k.value,w);let J;Di(()=>{e.mode==="horizontal"&&e.ellipsis?J=ar(f,Q).stop:J==null||J()});const oe=le(!1);{const ie=X=>{M.value[X.index]=X},te=X=>{delete M.value[X.index]};Nn("rootMenu",eo({props:e,openedMenus:b,items:k,subMenus:M,activeIndex:S,isMenuPopup:R,addMenuItem:X=>{k.value[X.index]=X},removeMenuItem:X=>{delete k.value[X.index]},addSubMenu:ie,removeSubMenu:te,openMenu:E,closeMenu:F,handleMenuItemClick:P,handleSubMenuClick:x})),Nn(`subMenu:${c.uid}`,{addSubMenu:ie,removeSubMenu:te,mouseInChild:oe,level:0})}mn(()=>{e.mode==="horizontal"&&new Owe(c.vnode.el,p.namespace.value)}),i({open:te=>{const{indexPath:he}=M.value[te];he.forEach(re=>E(re,he))},close:N,updateActiveIndex:G,handleResize:Q});const pe=uz(e,0);return()=>{var ie,te;let he=(te=(ie=o.default)==null?void 0:ie.call(o))!=null?te:[];const re=[];if(e.mode==="horizontal"&&f.value){const ue=Qc(he),Ie=_.value===-1?ue:ue.slice(0,_.value),ve=_.value===-1?[]:ue.slice(_.value);ve!=null&&ve.length&&e.ellipsis&&(he=Ie,re.push(Jt($N,{index:"sub-menu-more",class:v.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Jt(Pt,{class:v.e("icon-more")},{default:()=>Jt(e.ellipsisIcon)}),default:()=>ve})))}const X=e.closeOnClickOutside?[[lu,()=>{b.value.length&&(oe.value||(b.value.forEach(ue=>t("close",ue,j(ue))),b.value=[]))}]]:[],ye=fn(Jt("ul",{key:String(e.collapse),role:"menubar",ref:f,style:pe.value,class:{[p.b()]:!0,[p.m(e.mode)]:!0,[p.m("collapse")]:e.collapse}},[...he,...re]),X);return e.collapseTransition&&e.mode==="vertical"?Jt(Pwe,()=>ye):ye}}});const Bwe=pt({index:{type:Ue([String,null]),default:null},route:{type:Ue([String,Object])},disabled:Boolean}),Hwe={click:e=>Ut(e.index)&&ht(e.indexPath)},vO="ElMenuItem",$we=Te({name:vO}),qwe=Te({...$we,props:Bwe,emits:Hwe,setup(e,{expose:t,emit:o}){const i=e,c=kn(),u=Rt("rootMenu"),f=ut("menu"),p=ut("menu-item");u||qr(vO,"can not inject root menu");const{parentMenu:v,indexPath:_}=cz(c,uo(i,"index")),b=Rt(`subMenu:${v.value.uid}`);b||qr(vO,"can not inject sub menu");const S=z(()=>i.index===u.activeIndex),k=eo({index:i.index,indexPath:_,active:S}),M=()=>{i.disabled||(u.handleMenuItemClick({index:i.index,indexPath:_.value,route:i.route}),o("click",k))};return mn(()=>{b.addSubMenu(k),u.addMenuItem(k)}),Co(()=>{b.removeSubMenu(k),u.removeMenuItem(k)}),t({parentMenu:v,rootMenu:u,active:S,nsMenu:f,nsMenuItem:p,handleClick:M}),(R,w)=>(ee(),ge("li",{class:ne([y(p).b(),y(p).is("active",y(S)),y(p).is("disabled",R.disabled)]),role:"menuitem",tabindex:"-1",onClick:M},[y(v).type.name==="ElMenu"&&y(u).props.collapse&&R.$slots.title?(ee(),We(y(Li),{key:0,effect:y(u).props.popperEffect,placement:"right","fallback-placements":["left"],persistent:y(u).props.persistent},{content:Ae(()=>[Ve(R.$slots,"title")]),default:Ae(()=>[Ee("div",{class:ne(y(f).be("tooltip","trigger"))},[Ve(R.$slots,"default")],2)]),_:3},8,["effect","persistent"])):(ee(),ge(Ht,{key:1},[Ve(R.$slots,"default"),Ve(R.$slots,"title")],64))],2))}});var dz=vt(qwe,[["__file","menu-item.vue"]]);const Kwe={title:String},zwe=Te({name:"ElMenuItemGroup"}),Wwe=Te({...zwe,props:Kwe,setup(e){const t=ut("menu-item-group");return(o,i)=>(ee(),ge("li",{class:ne(y(t).b())},[Ee("div",{class:ne(y(t).e("title"))},[o.$slots.title?Ve(o.$slots,"title",{key:1}):(ee(),ge(Ht,{key:0},[Mn(mt(o.title),1)],64))],2),Ee("ul",null,[Ve(o.$slots,"default")])],2))}});var hz=vt(Wwe,[["__file","menu-item-group.vue"]]);const jwe=un(Gwe,{MenuItem:dz,MenuItemGroup:hz,SubMenu:$N}),Ywe=lr(dz),Jwe=lr(hz),Xwe=lr($N),Zwe=pt({icon:{type:ho,default:()=>d_e},title:String,content:{type:String,default:""}}),Qwe={back:()=>!0},eRe=Te({name:"ElPageHeader"}),tRe=Te({...eRe,props:Zwe,emits:Qwe,setup(e,{emit:t}){const{t:o}=Kn(),i=ut("page-header");function c(){t("back")}return(u,f)=>(ee(),ge("div",{class:ne([y(i).b(),{[y(i).m("has-breadcrumb")]:!!u.$slots.breadcrumb,[y(i).m("has-extra")]:!!u.$slots.extra,[y(i).is("contentful")]:!!u.$slots.default}])},[u.$slots.breadcrumb?(ee(),ge("div",{key:0,class:ne(y(i).e("breadcrumb"))},[Ve(u.$slots,"breadcrumb")],2)):$e("v-if",!0),Ee("div",{class:ne(y(i).e("header"))},[Ee("div",{class:ne(y(i).e("left"))},[Ee("div",{class:ne(y(i).e("back")),role:"button",tabindex:"0",onClick:c},[u.icon||u.$slots.icon?(ee(),ge("div",{key:0,"aria-label":u.title||y(o)("el.pageHeader.title"),class:ne(y(i).e("icon"))},[Ve(u.$slots,"icon",{},()=>[u.icon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(u.icon)))]),_:1})):$e("v-if",!0)])],10,["aria-label"])):$e("v-if",!0),Ee("div",{class:ne(y(i).e("title"))},[Ve(u.$slots,"title",{},()=>[Mn(mt(u.title||y(o)("el.pageHeader.title")),1)])],2)],2),Me(y(Y9),{direction:"vertical"}),Ee("div",{class:ne(y(i).e("content"))},[Ve(u.$slots,"content",{},()=>[Mn(mt(u.content),1)])],2)],2),u.$slots.extra?(ee(),ge("div",{key:0,class:ne(y(i).e("extra"))},[Ve(u.$slots,"extra")],2)):$e("v-if",!0)],2),u.$slots.default?(ee(),ge("div",{key:1,class:ne(y(i).e("main"))},[Ve(u.$slots,"default")],2)):$e("v-if",!0)],2))}});var nRe=vt(tRe,[["__file","page-header.vue"]]);const oRe=un(nRe),fz=Symbol("elPaginationKey"),rRe=pt({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:ho}}),iRe={click:e=>e instanceof MouseEvent},aRe=Te({name:"ElPaginationPrev"}),sRe=Te({...aRe,props:rRe,emits:iRe,setup(e){const t=e,{t:o}=Kn(),i=z(()=>t.disabled||t.currentPage<=1);return(c,u)=>(ee(),ge("button",{type:"button",class:"btn-prev",disabled:y(i),"aria-label":c.prevText||y(o)("el.pagination.prev"),"aria-disabled":y(i),onClick:f=>c.$emit("click",f)},[c.prevText?(ee(),ge("span",{key:0},mt(c.prevText),1)):(ee(),We(y(Pt),{key:1},{default:Ae(()=>[(ee(),We(Tn(c.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var lRe=vt(sRe,[["__file","prev.vue"]]);const cRe=pt({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:ho}}),uRe=Te({name:"ElPaginationNext"}),dRe=Te({...uRe,props:cRe,emits:["click"],setup(e){const t=e,{t:o}=Kn(),i=z(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(c,u)=>(ee(),ge("button",{type:"button",class:"btn-next",disabled:y(i),"aria-label":c.nextText||y(o)("el.pagination.next"),"aria-disabled":y(i),onClick:f=>c.$emit("click",f)},[c.nextText?(ee(),ge("span",{key:0},mt(c.nextText),1)):(ee(),We(y(Pt),{key:1},{default:Ae(()=>[(ee(),We(Tn(c.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var hRe=vt(dRe,[["__file","next.vue"]]);const pz=Symbol("ElSelectGroup"),yv=Symbol("ElSelect"),_O="ElOption",fRe=pt({value:{type:[String,Number,Boolean,Object],required:!0},label:{type:[String,Number]},created:Boolean,disabled:Boolean});function pRe(e,t){const o=Rt(yv);o||qr(_O,"usage: <el-select><el-option /></el-select/>");const i=Rt(pz,{disabled:!1}),c=z(()=>b(Wi(o.props.modelValue),e.value)),u=z(()=>{var M;if(o.props.multiple){const R=Wi((M=o.props.modelValue)!=null?M:[]);return!c.value&&R.length>=o.props.multipleLimit&&o.props.multipleLimit>0}else return!1}),f=z(()=>e.label||(gn(e.value)?"":e.value)),p=z(()=>e.value||e.label||""),v=z(()=>e.disabled||t.groupDisabled||u.value),_=kn(),b=(M=[],R)=>{if(gn(e.value)){const w=o.props.valueKey;return M&&M.some(E=>Mo(Rr(E,w))===Rr(R,w))}else return M&&M.includes(R)},S=()=>{!e.disabled&&!i.disabled&&(o.states.hoveringIndex=o.optionsArray.indexOf(_.proxy))},k=M=>{const R=new RegExp(MN(M),"i");t.visible=R.test(String(f.value))||e.created};return st(()=>f.value,()=>{!e.created&&!o.props.remote&&o.setSelected()}),st(()=>e.value,(M,R)=>{const{remote:w,valueKey:E}=o.props;if((w?M!==R:!ui(M,R))&&(o.onOptionDestroy(R,_.proxy),o.onOptionCreate(_.proxy)),!e.created&&!w){if(E&&gn(M)&&gn(R)&&M[E]===R[E])return;o.setSelected()}}),st(()=>i.disabled,()=>{t.groupDisabled=i.disabled},{immediate:!0}),{select:o,currentLabel:f,currentValue:p,itemSelected:c,isDisabled:v,hoverItem:S,updateOption:k}}const mRe=Te({name:_O,componentName:_O,props:fRe,setup(e){const t=ut("select"),o=bi(),i=z(()=>[t.be("dropdown","item"),t.is("disabled",y(p)),t.is("selected",y(f)),t.is("hovering",y(k))]),c=eo({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:u,itemSelected:f,isDisabled:p,select:v,hoverItem:_,updateOption:b}=pRe(e,c),{visible:S,hover:k}=hi(c),M=kn().proxy;v.onOptionCreate(M),Co(()=>{const w=M.value,{selected:E}=v.states,N=E.some(F=>F.value===M.value);Vt(()=>{v.states.cachedOptions.get(w)===M&&!N&&v.states.cachedOptions.delete(w)}),v.onOptionDestroy(w,M)});function R(){p.value||v.handleOptionSelect(M)}return{ns:t,id:o,containerKls:i,currentLabel:u,itemSelected:f,isDisabled:p,select:v,visible:S,hover:k,states:c,hoverItem:_,updateOption:b,selectOptionClick:R}}});function gRe(e,t){return fn((ee(),ge("li",{id:e.id,class:ne(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:Zt(e.selectOptionClick,["stop"])},[Ve(e.$slots,"default",{},()=>[Ee("span",null,mt(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[Zn,e.visible]])}var qN=vt(mRe,[["render",gRe],["__file","option.vue"]]);const vRe=Te({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Rt(yv),t=ut("select"),o=z(()=>e.props.popperClass),i=z(()=>e.props.multiple),c=z(()=>e.props.fitInputWidth),u=le("");function f(){var p;u.value=`${(p=e.selectRef)==null?void 0:p.offsetWidth}px`}return mn(()=>{f(),ar(e.selectRef,f)}),{ns:t,minWidth:u,popperClass:o,isMultiple:i,isFitInputWidth:c}}});function _Re(e,t,o,i,c,u){return ee(),ge("div",{class:ne([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:qt({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(ee(),ge("div",{key:0,class:ne(e.ns.be("dropdown","header"))},[Ve(e.$slots,"header")],2)):$e("v-if",!0),Ve(e.$slots,"default"),e.$slots.footer?(ee(),ge("div",{key:1,class:ne(e.ns.be("dropdown","footer"))},[Ve(e.$slots,"footer")],2)):$e("v-if",!0)],6)}var yRe=vt(vRe,[["render",_Re],["__file","select-dropdown.vue"]]);const IRe=(e,t)=>{const{t:o}=Kn(),i=bi(),c=ut("select"),u=ut("input"),f=eo({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),p=le(),v=le(),_=le(),b=le(),S=le(),k=le(),M=le(),R=le(),w=le(),E=le(),N=le(),{isComposing:F,handleCompositionStart:x,handleCompositionUpdate:P,handleCompositionEnd:G}=cI({afterComposition:_t=>dn(_t)}),{wrapperRef:H,isFocused:Y,handleBlur:j}=ah(S,{beforeFocus(){return te.value},afterFocus(){e.automaticDropdown&&!W.value&&(W.value=!0,f.menuVisibleOnFocus=!0)},beforeBlur(_t){var It,Vn;return((It=_.value)==null?void 0:It.isFocusInsideContent(_t))||((Vn=b.value)==null?void 0:Vn.isFocusInsideContent(_t))},afterBlur(){var _t;W.value=!1,f.menuVisibleOnFocus=!1,e.validateEvent&&((_t=J==null?void 0:J.validate)==null||_t.call(J,"blur").catch(It=>void 0))}}),W=le(!1),O=le(),{form:Q,formItem:J}=Ni(),{inputId:oe}=Ps(e,{formItemContext:J}),{valueOnClear:pe,isEmptyValue:ie}=PT(e),te=z(()=>e.disabled||(Q==null?void 0:Q.disabled)),he=z(()=>ht(e.modelValue)?e.modelValue.length>0:!ie(e.modelValue)),re=z(()=>{var _t;return(_t=Q==null?void 0:Q.statusIcon)!=null?_t:!1}),X=z(()=>e.clearable&&!te.value&&f.inputHovering&&he.value),ye=z(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),ue=z(()=>c.is("reverse",!!(ye.value&&W.value))),Ie=z(()=>(J==null?void 0:J.validateState)||""),ve=z(()=>Ie.value&&VT[Ie.value]),Ce=z(()=>e.remote?300:0),Fe=z(()=>e.remote&&!f.inputValue&&f.options.size===0),Oe=z(()=>e.loading?e.loadingText||o("el.select.loading"):e.filterable&&f.inputValue&&f.options.size>0&&be.value===0?e.noMatchText||o("el.select.noMatch"):f.options.size===0?e.noDataText||o("el.select.noData"):null),be=z(()=>xe.value.filter(_t=>_t.visible).length),xe=z(()=>{const _t=Array.from(f.options.values()),It=[];return f.optionValues.forEach(Vn=>{const On=_t.findIndex(wt=>wt.value===Vn);On>-1&&It.push(_t[On])}),It.length>=_t.length?It:_t}),Le=z(()=>Array.from(f.cachedOptions.values())),rt=z(()=>{const _t=xe.value.filter(It=>!It.created).some(It=>It.currentLabel===f.inputValue);return e.filterable&&e.allowCreate&&f.inputValue!==""&&!_t}),Qe=()=>{e.filterable&&zt(e.filterMethod)||e.filterable&&e.remote&&zt(e.remoteMethod)||xe.value.forEach(_t=>{var It;(It=_t.updateOption)==null||It.call(_t,f.inputValue)})},Ge=Fr(),_e=z(()=>["small"].includes(Ge.value)?"small":"default"),Re=z({get(){return W.value&&!Fe.value},set(_t){W.value=_t}}),Ke=z(()=>{if(e.multiple&&!qn(e.modelValue))return Wi(e.modelValue).length===0&&!f.inputValue;const _t=ht(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||qn(_t)?!f.inputValue:!0}),je=z(()=>{var _t;const It=(_t=e.placeholder)!=null?_t:o("el.select.placeholder");return e.multiple||!he.value?It:f.selectedLabel}),ze=z(()=>qE?null:"mouseenter");st(()=>e.modelValue,(_t,It)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(f.inputValue="",nt("")),dt(),!ui(_t,It)&&e.validateEvent&&(J==null||J.validate("change").catch(Vn=>void 0))},{flush:"post",deep:!0}),st(()=>W.value,_t=>{_t?nt(f.inputValue):(f.inputValue="",f.previousQuery=null,f.isBeforeHide=!0),t("visible-change",_t)}),st(()=>f.options.entries(),()=>{$n&&(dt(),e.defaultFirstOption&&(e.filterable||e.remote)&&be.value&&it())},{flush:"post"}),st([()=>f.hoveringIndex,xe],([_t])=>{jt(_t)&&_t>-1?O.value=xe.value[_t]||{}:O.value={},xe.value.forEach(It=>{It.hover=O.value===It})}),Di(()=>{f.isBeforeHide||Qe()});const nt=_t=>{f.previousQuery===_t||F.value||(f.previousQuery=_t,e.filterable&&zt(e.filterMethod)?e.filterMethod(_t):e.filterable&&e.remote&&zt(e.remoteMethod)&&e.remoteMethod(_t),e.defaultFirstOption&&(e.filterable||e.remote)&&be.value?Vt(it):Vt(ft))},it=()=>{const _t=xe.value.filter(wt=>wt.visible&&!wt.disabled&&!wt.states.groupDisabled),It=_t.find(wt=>wt.created),Vn=_t[0],On=xe.value.map(wt=>wt.value);f.hoveringIndex=ke(On,It||Vn)},dt=()=>{if(e.multiple)f.selectedLabel="";else{const It=ht(e.modelValue)?e.modelValue[0]:e.modelValue,Vn=gt(It);f.selectedLabel=Vn.currentLabel,f.selected=[Vn];return}const _t=[];qn(e.modelValue)||Wi(e.modelValue).forEach(It=>{_t.push(gt(It))}),f.selected=_t},gt=_t=>{let It;const Vn=f0(_t);for(let zr=f.cachedOptions.size-1;zr>=0;zr--){const No=Le.value[zr];if(Vn?Rr(No.value,e.valueKey)===Rr(_t,e.valueKey):No.value===_t){It={value:_t,currentLabel:No.currentLabel,get isDisabled(){return No.isDisabled}};break}}if(It)return It;const On=Vn?_t.label:_t??"";return{value:_t,currentLabel:On}},ft=()=>{f.hoveringIndex=xe.value.findIndex(_t=>f.selected.some(It=>xi(It)===xi(_t)))},Mt=()=>{f.selectionWidth=v.value.getBoundingClientRect().width},lt=()=>{f.collapseItemWidth=E.value.getBoundingClientRect().width},Et=()=>{var _t,It;(It=(_t=_.value)==null?void 0:_t.updatePopper)==null||It.call(_t)},Yt=()=>{var _t,It;(It=(_t=b.value)==null?void 0:_t.updatePopper)==null||It.call(_t)},sn=()=>{f.inputValue.length>0&&!W.value&&(W.value=!0),nt(f.inputValue)},dn=_t=>{if(f.inputValue=_t.target.value,e.remote)Sn();else return sn()},Sn=Oa(()=>{sn()},Ce.value),yn=_t=>{ui(e.modelValue,_t)||t(wn,_t)},fo=_t=>Pq(_t,It=>{const Vn=f.cachedOptions.get(It);return Vn&&!Vn.disabled&&!Vn.states.groupDisabled}),Xt=_t=>{if(e.multiple&&_t.code!==At.delete&&_t.target.value.length<=0){const It=Wi(e.modelValue).slice(),Vn=fo(It);if(Vn<0)return;const On=It[Vn];It.splice(Vn,1),t(nn,It),yn(It),t("remove-tag",On)}},vn=(_t,It)=>{const Vn=f.selected.indexOf(It);if(Vn>-1&&!te.value){const On=Wi(e.modelValue).slice();On.splice(Vn,1),t(nn,On),yn(On),t("remove-tag",It.value)}_t.stopPropagation(),io()},Ne=_t=>{_t.stopPropagation();const It=e.multiple?[]:pe.value;if(e.multiple)for(const Vn of f.selected)Vn.isDisabled&&It.push(Vn.value);t(nn,It),yn(It),f.hoveringIndex=-1,W.value=!1,t("clear"),io()},qe=_t=>{var It;if(e.multiple){const Vn=Wi((It=e.modelValue)!=null?It:[]).slice(),On=ke(Vn,_t);On>-1?Vn.splice(On,1):(e.multipleLimit<=0||Vn.length<e.multipleLimit)&&Vn.push(_t.value),t(nn,Vn),yn(Vn),_t.created&&nt(""),e.filterable&&!e.reserveKeyword&&(f.inputValue="")}else t(nn,_t.value),yn(_t.value),W.value=!1;io(),!W.value&&Vt(()=>{ot(_t)})},ke=(_t,It)=>qn(It)?-1:gn(It.value)?_t.findIndex(Vn=>ui(Rr(Vn,e.valueKey),xi(It))):_t.indexOf(It.value),ot=_t=>{var It,Vn,On,wt,zr;const No=ht(_t)?_t[0]:_t;let La=null;if(No!=null&&No.value){const Na=xe.value.filter(ei=>ei.value===No.value);Na.length>0&&(La=Na[0].$el)}if(_.value&&La){const Na=(wt=(On=(Vn=(It=_.value)==null?void 0:It.popperRef)==null?void 0:Vn.contentRef)==null?void 0:On.querySelector)==null?void 0:wt.call(On,`.${c.be("dropdown","wrap")}`);Na&&nN(Na,La)}(zr=N.value)==null||zr.handleScroll()},tn=_t=>{f.options.set(_t.value,_t),f.cachedOptions.set(_t.value,_t)},Nt=(_t,It)=>{f.options.get(_t)===It&&f.options.delete(_t)},Dn=z(()=>{var _t,It;return(It=(_t=_.value)==null?void 0:_t.popperRef)==null?void 0:It.contentRef}),dr=()=>{f.isBeforeHide=!1,Vt(()=>{var _t;(_t=N.value)==null||_t.update(),ot(f.selected)})},io=()=>{var _t;(_t=S.value)==null||_t.focus()},hr=()=>{var _t;if(W.value){W.value=!1,Vt(()=>{var It;return(It=S.value)==null?void 0:It.blur()});return}(_t=S.value)==null||_t.blur()},K=_t=>{Ne(_t)},ri=_t=>{if(W.value=!1,Y.value){const It=new FocusEvent("focus",_t);Vt(()=>j(It))}},Gt=()=>{f.inputValue.length>0?f.inputValue="":W.value=!1},Ho=()=>{te.value||(qE&&(f.inputHovering=!0),f.menuVisibleOnFocus?f.menuVisibleOnFocus=!1:W.value=!W.value)},jo=()=>{if(!W.value)Ho();else{const _t=xe.value[f.hoveringIndex];_t&&!_t.isDisabled&&qe(_t)}},xi=_t=>gn(_t.value)?Rr(_t.value,e.valueKey):_t.value,Vr=z(()=>xe.value.filter(_t=>_t.visible).every(_t=>_t.isDisabled)),Ui=z(()=>e.multiple?e.collapseTags?f.selected.slice(0,e.maxCollapseTags):f.selected:[]),ii=z(()=>e.multiple?e.collapseTags?f.selected.slice(e.maxCollapseTags):[]:[]),ha=_t=>{if(!W.value){W.value=!0;return}if(!(f.options.size===0||be.value===0||F.value)&&!Vr.value){_t==="next"?(f.hoveringIndex++,f.hoveringIndex===f.options.size&&(f.hoveringIndex=0)):_t==="prev"&&(f.hoveringIndex--,f.hoveringIndex<0&&(f.hoveringIndex=f.options.size-1));const It=xe.value[f.hoveringIndex];(It.isDisabled||!It.visible)&&ha(_t),Vt(()=>ot(O.value))}},gl=()=>{if(!v.value)return 0;const _t=window.getComputedStyle(v.value);return Number.parseFloat(_t.gap||"6px")},Tt=z(()=>{const _t=gl();return{maxWidth:`${E.value&&e.maxCollapseTags===1?f.selectionWidth-f.collapseItemWidth-_t:f.selectionWidth}px`}}),sc=z(()=>({maxWidth:`${f.selectionWidth}px`})),lh=_t=>{t("popup-scroll",_t)};return ar(v,Mt),ar(R,Et),ar(H,Et),ar(w,Yt),ar(E,lt),mn(()=>{dt()}),{inputId:oe,contentId:i,nsSelect:c,nsInput:u,states:f,isFocused:Y,expanded:W,optionsArray:xe,hoverOption:O,selectSize:Ge,filteredOptionsCount:be,updateTooltip:Et,updateTagTooltip:Yt,debouncedOnInputChange:Sn,onInput:dn,deletePrevTag:Xt,deleteTag:vn,deleteSelected:Ne,handleOptionSelect:qe,scrollToOption:ot,hasModelValue:he,shouldShowPlaceholder:Ke,currentPlaceholder:je,mouseEnterEventName:ze,needStatusIcon:re,showClose:X,iconComponent:ye,iconReverse:ue,validateState:Ie,validateIcon:ve,showNewOption:rt,updateOptions:Qe,collapseTagSize:_e,setSelected:dt,selectDisabled:te,emptyText:Oe,handleCompositionStart:x,handleCompositionUpdate:P,handleCompositionEnd:G,onOptionCreate:tn,onOptionDestroy:Nt,handleMenuEnter:dr,focus:io,blur:hr,handleClearClick:K,handleClickOutside:ri,handleEsc:Gt,toggleMenu:Ho,selectOption:jo,getValueKey:xi,navigateOptions:ha,dropdownMenuVisible:Re,showTagList:Ui,collapseTagList:ii,popupScroll:lh,tagStyle:Tt,collapseTagStyle:sc,popperRef:Dn,inputRef:S,tooltipRef:_,tagTooltipRef:b,prefixRef:k,suffixRef:M,selectRef:p,wrapperRef:H,selectionRef:v,scrollbarRef:N,menuRef:R,tagMenuRef:w,collapseItemRef:E}};var bRe=Te({name:"ElOptions",setup(e,{slots:t}){const o=Rt(yv);let i=[];return()=>{var c,u;const f=(c=t.default)==null?void 0:c.call(t),p=[];function v(_){ht(_)&&_.forEach(b=>{var S,k,M,R;const w=(S=(b==null?void 0:b.type)||{})==null?void 0:S.name;w==="ElOptionGroup"?v(!Ut(b.children)&&!ht(b.children)&&zt((k=b.children)==null?void 0:k.default)?(M=b.children)==null?void 0:M.default():b.children):w==="ElOption"?p.push((R=b.props)==null?void 0:R.value):ht(b.children)&&v(b.children)})}return f.length&&v((u=f[0])==null?void 0:u.children),ui(p,i)||(i=p,o&&(o.states.optionValues=p)),f}}});const CRe=pt({name:String,id:String,modelValue:{type:Ue([Array,String,Number,Boolean,Object]),default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Kr,effect:{type:Ue(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Ue(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Ur.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:ho,default:pu},fitInputWidth:Boolean,suffixIcon:{type:ho,default:fu},tagType:{...su.type,default:"info"},tagEffect:{...su.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:Ue(String),values:mu,default:"bottom-start"},fallbackPlacements:{type:Ue(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:Ur.appendTo,...mv,...Ci(["ariaLabel"])});nn+"",wn+"",dK.scroll;const VB="ElSelect",SRe=Te({name:VB,componentName:VB,components:{ElSelectMenu:yRe,ElOption:qN,ElOptions:bRe,ElTag:Zg,ElScrollbar:ac,ElTooltip:Li,ElIcon:Pt},directives:{ClickOutside:lu},props:CRe,emits:[nn,wn,"remove-tag","clear","visible-change","focus","blur","popup-scroll"],setup(e,{emit:t}){const o=z(()=>{const{modelValue:v,multiple:_}=e,b=_?[]:void 0;return ht(v)?_?v:b:_?b:v}),i=eo({...hi(e),modelValue:o}),c=IRe(i,t),{calculatorRef:u,inputStyle:f}=HN();Nn(yv,eo({props:i,states:c.states,selectRef:c.selectRef,optionsArray:c.optionsArray,setSelected:c.setSelected,handleOptionSelect:c.handleOptionSelect,onOptionCreate:c.onOptionCreate,onOptionDestroy:c.onOptionDestroy}));const p=z(()=>e.multiple?c.states.selected.map(v=>v.currentLabel):c.states.selectedLabel);return{...c,modelValue:o,selectedLabel:p,calculatorRef:u,inputStyle:f}}});function ERe(e,t){const o=Cn("el-tag"),i=Cn("el-tooltip"),c=Cn("el-icon"),u=Cn("el-option"),f=Cn("el-options"),p=Cn("el-scrollbar"),v=Cn("el-select-menu"),_=_T("click-outside");return fn((ee(),ge("div",{ref:"selectRef",class:ne([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[Hy(e.mouseEnterEventName)]:b=>e.states.inputHovering=!0,onMouseleave:b=>e.states.inputHovering=!1},[Me(i,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:b=>e.states.isBeforeHide=!1},{default:Ae(()=>{var b;return[Ee("div",{ref:"wrapperRef",class:ne([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Zt(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ee(),ge("div",{key:0,ref:"prefixRef",class:ne(e.nsSelect.e("prefix"))},[Ve(e.$slots,"prefix")],2)):$e("v-if",!0),Ee("div",{ref:"selectionRef",class:ne([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?Ve(e.$slots,"tag",{key:0},()=>[(ee(!0),ge(Ht,null,Un(e.showTagList,S=>(ee(),ge("div",{key:e.getValueKey(S),class:ne(e.nsSelect.e("selected-item"))},[Me(o,{closable:!e.selectDisabled&&!S.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:qt(e.tagStyle),onClose:k=>e.deleteTag(k,S)},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))},[Ve(e.$slots,"label",{label:S.currentLabel,value:S.value},()=>[Mn(mt(S.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(ee(),We(i,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:Ae(()=>[Ee("div",{ref:"collapseItemRef",class:ne(e.nsSelect.e("selected-item"))},[Me(o,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:qt(e.collapseTagStyle)},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))}," + "+mt(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:Ae(()=>[Ee("div",{ref:"tagMenuRef",class:ne(e.nsSelect.e("selection"))},[(ee(!0),ge(Ht,null,Un(e.collapseTagList,S=>(ee(),ge("div",{key:e.getValueKey(S),class:ne(e.nsSelect.e("selected-item"))},[Me(o,{class:"in-tooltip",closable:!e.selectDisabled&&!S.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:k=>e.deleteTag(k,S)},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))},[Ve(e.$slots,"label",{label:S.currentLabel,value:S.value},()=>[Mn(mt(S.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):$e("v-if",!0)]):$e("v-if",!0),Ee("div",{class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[fn(Ee("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":S=>e.states.inputValue=S,type:"text",name:e.name,class:ne([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:qt(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((b=e.hoverOption)==null?void 0:b.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[To(Zt(S=>e.navigateOptions("next"),["stop","prevent"]),["down"]),To(Zt(S=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),To(Zt(e.handleEsc,["stop","prevent"]),["esc"]),To(Zt(e.selectOption,["stop","prevent"]),["enter"]),To(Zt(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:Zt(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[ET,e.states.inputValue]]),e.filterable?(ee(),ge("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ne(e.nsSelect.e("input-calculator")),textContent:mt(e.states.inputValue)},null,10,["textContent"])):$e("v-if",!0)],2),e.shouldShowPlaceholder?(ee(),ge("div",{key:1,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?Ve(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ee("span",null,mt(e.currentPlaceholder),1)]):(ee(),ge("span",{key:1},mt(e.currentPlaceholder),1))],2)):$e("v-if",!0)],2),Ee("div",{ref:"suffixRef",class:ne(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(ee(),We(c,{key:0,class:ne([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:Ae(()=>[(ee(),We(Tn(e.iconComponent)))]),_:1},8,["class"])):$e("v-if",!0),e.showClose&&e.clearIcon?(ee(),We(c,{key:1,class:ne([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:Ae(()=>[(ee(),We(Tn(e.clearIcon)))]),_:1},8,["class","onClick"])):$e("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ee(),We(c,{key:2,class:ne([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:Ae(()=>[(ee(),We(Tn(e.validateIcon)))]),_:1},8,["class"])):$e("v-if",!0)],2)],10,["onClick"])]}),content:Ae(()=>[Me(v,{ref:"menuRef"},{default:Ae(()=>[e.$slots.header?(ee(),ge("div",{key:0,class:ne(e.nsSelect.be("dropdown","header")),onClick:Zt(()=>{},["stop"])},[Ve(e.$slots,"header")],10,["onClick"])):$e("v-if",!0),fn(Me(p,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:ne([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical",onScroll:e.popupScroll},{default:Ae(()=>[e.showNewOption?(ee(),We(u,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):$e("v-if",!0),Me(f,null,{default:Ae(()=>[Ve(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label","onScroll"]),[[Zn,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(ee(),ge("div",{key:1,class:ne(e.nsSelect.be("dropdown","loading"))},[Ve(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(ee(),ge("div",{key:2,class:ne(e.nsSelect.be("dropdown","empty"))},[Ve(e.$slots,"empty",{},()=>[Ee("span",null,mt(e.emptyText),1)])],2)):$e("v-if",!0),e.$slots.footer?(ee(),ge("div",{key:3,class:ne(e.nsSelect.be("dropdown","footer")),onClick:Zt(()=>{},["stop"])},[Ve(e.$slots,"footer")],10,["onClick"])):$e("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[_,e.handleClickOutside,e.popperRef]])}var TRe=vt(SRe,[["render",ERe],["__file","select.vue"]]);const MRe=Te({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=ut("select"),o=le(),i=kn(),c=le([]);Nn(pz,eo({...hi(e)}));const u=z(()=>c.value.some(_=>_.visible===!0)),f=_=>{var b;return _.type.name==="ElOption"&&!!((b=_.component)!=null&&b.proxy)},p=_=>{const b=Wi(_),S=[];return b.forEach(k=>{var M;Wo(k)&&(f(k)?S.push(k.component.proxy):ht(k.children)&&k.children.length?S.push(...p(k.children)):(M=k.component)!=null&&M.subTree&&S.push(...p(k.component.subTree)))}),S},v=()=>{c.value=p(i.subTree)};return mn(()=>{v()}),Hq(o,v,{attributes:!0,subtree:!0,childList:!0}),{groupRef:o,visible:u,ns:t}}});function kRe(e,t,o,i,c,u){return fn((ee(),ge("ul",{ref:"groupRef",class:ne(e.ns.be("group","wrap"))},[Ee("li",{class:ne(e.ns.be("group","title"))},mt(e.label),3),Ee("li",null,[Ee("ul",{class:ne(e.ns.b("group"))},[Ve(e.$slots,"default")],2)])],2)),[[Zn,e.visible]])}var mz=vt(MRe,[["render",kRe],["__file","option-group.vue"]]);const dp=un(TRe,{Option:qN,OptionGroup:mz}),ZE=lr(qN),wRe=lr(mz),KN=()=>Rt(fz,{}),RRe=pt({pageSize:{type:Number,required:!0},pageSizes:{type:Ue(Array),default:()=>sr([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:ic},appendSizeTo:String}),ARe=Te({name:"ElPaginationSizes"}),DRe=Te({...ARe,props:RRe,emits:["page-size-change"],setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=ut("pagination"),u=KN(),f=le(o.pageSize);st(()=>o.pageSizes,(_,b)=>{if(!ui(_,b)&&ht(_)){const S=_.includes(o.pageSize)?o.pageSize:o.pageSizes[0];t("page-size-change",S)}}),st(()=>o.pageSize,_=>{f.value=_});const p=z(()=>o.pageSizes);function v(_){var b;_!==f.value&&(f.value=_,(b=u.handleSizeChange)==null||b.call(u,Number(_)))}return(_,b)=>(ee(),ge("span",{class:ne(y(c).e("sizes"))},[Me(y(dp),{"model-value":f.value,disabled:_.disabled,"popper-class":_.popperClass,size:_.size,teleported:_.teleported,"validate-event":!1,"append-to":_.appendSizeTo,onChange:v},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(y(p),S=>(ee(),We(y(ZE),{key:S,value:S,label:S+y(i)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var ORe=vt(DRe,[["__file","sizes.vue"]]);const LRe=pt({size:{type:String,values:ic}}),NRe=Te({name:"ElPaginationJumper"}),PRe=Te({...NRe,props:LRe,setup(e){const{t}=Kn(),o=ut("pagination"),{pageCount:i,disabled:c,currentPage:u,changeEvent:f}=KN(),p=le(),v=z(()=>{var S;return(S=p.value)!=null?S:u==null?void 0:u.value});function _(S){p.value=S?+S:""}function b(S){S=Math.trunc(+S),f==null||f(S),p.value=void 0}return(S,k)=>(ee(),ge("span",{class:ne(y(o).e("jump")),disabled:y(c)},[Ee("span",{class:ne([y(o).e("goto")])},mt(y(t)("el.pagination.goto")),3),Me(y(Yi),{size:S.size,class:ne([y(o).e("editor"),y(o).is("in-pagination")]),min:1,max:y(i),disabled:y(c),"model-value":y(v),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":_,onChange:b},null,8,["size","class","max","disabled","model-value","aria-label"]),Ee("span",{class:ne([y(o).e("classifier")])},mt(y(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var xRe=vt(PRe,[["__file","jumper.vue"]]);const URe=pt({total:{type:Number,default:1e3}}),FRe=Te({name:"ElPaginationTotal"}),VRe=Te({...FRe,props:URe,setup(e){const{t}=Kn(),o=ut("pagination"),{disabled:i}=KN();return(c,u)=>(ee(),ge("span",{class:ne(y(o).e("total")),disabled:y(i)},mt(y(t)("el.pagination.total",{total:c.total})),11,["disabled"]))}});var GRe=vt(VRe,[["__file","total.vue"]]);const BRe=pt({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),HRe=Te({name:"ElPaginationPager"}),$Re=Te({...HRe,props:BRe,emits:[wn],setup(e,{emit:t}){const o=e,i=ut("pager"),c=ut("icon"),{t:u}=Kn(),f=le(!1),p=le(!1),v=le(!1),_=le(!1),b=le(!1),S=le(!1),k=z(()=>{const P=o.pagerCount,G=(P-1)/2,H=Number(o.currentPage),Y=Number(o.pageCount);let j=!1,W=!1;Y>P&&(H>P-G&&(j=!0),H<Y-G&&(W=!0));const O=[];if(j&&!W){const Q=Y-(P-2);for(let J=Q;J<Y;J++)O.push(J)}else if(!j&&W)for(let Q=2;Q<P;Q++)O.push(Q);else if(j&&W){const Q=Math.floor(P/2)-1;for(let J=H-Q;J<=H+Q;J++)O.push(J)}else for(let Q=2;Q<Y;Q++)O.push(Q);return O}),M=z(()=>["more","btn-quickprev",c.b(),i.is("disabled",o.disabled)]),R=z(()=>["more","btn-quicknext",c.b(),i.is("disabled",o.disabled)]),w=z(()=>o.disabled?-1:0);Di(()=>{const P=(o.pagerCount-1)/2;f.value=!1,p.value=!1,o.pageCount>o.pagerCount&&(o.currentPage>o.pagerCount-P&&(f.value=!0),o.currentPage<o.pageCount-P&&(p.value=!0))});function E(P=!1){o.disabled||(P?v.value=!0:_.value=!0)}function N(P=!1){P?b.value=!0:S.value=!0}function F(P){const G=P.target;if(G.tagName.toLowerCase()==="li"&&Array.from(G.classList).includes("number")){const H=Number(G.textContent);H!==o.currentPage&&t(wn,H)}else G.tagName.toLowerCase()==="li"&&Array.from(G.classList).includes("more")&&x(P)}function x(P){const G=P.target;if(G.tagName.toLowerCase()==="ul"||o.disabled)return;let H=Number(G.textContent);const Y=o.pageCount,j=o.currentPage,W=o.pagerCount-2;G.className.includes("more")&&(G.className.includes("quickprev")?H=j-W:G.className.includes("quicknext")&&(H=j+W)),Number.isNaN(+H)||(H<1&&(H=1),H>Y&&(H=Y)),H!==j&&t(wn,H)}return(P,G)=>(ee(),ge("ul",{class:ne(y(i).b()),onClick:x,onKeyup:To(F,["enter"])},[P.pageCount>0?(ee(),ge("li",{key:0,class:ne([[y(i).is("active",P.currentPage===1),y(i).is("disabled",P.disabled)],"number"]),"aria-current":P.currentPage===1,"aria-label":y(u)("el.pagination.currentPage",{pager:1}),tabindex:y(w)}," 1 ",10,["aria-current","aria-label","tabindex"])):$e("v-if",!0),f.value?(ee(),ge("li",{key:1,class:ne(y(M)),tabindex:y(w),"aria-label":y(u)("el.pagination.prevPages",{pager:P.pagerCount-2}),onMouseenter:H=>E(!0),onMouseleave:H=>v.value=!1,onFocus:H=>N(!0),onBlur:H=>b.value=!1},[(v.value||b.value)&&!P.disabled?(ee(),We(y(Jd),{key:0})):(ee(),We(y(F8),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):$e("v-if",!0),(ee(!0),ge(Ht,null,Un(y(k),H=>(ee(),ge("li",{key:H,class:ne([[y(i).is("active",P.currentPage===H),y(i).is("disabled",P.disabled)],"number"]),"aria-current":P.currentPage===H,"aria-label":y(u)("el.pagination.currentPage",{pager:H}),tabindex:y(w)},mt(H),11,["aria-current","aria-label","tabindex"]))),128)),p.value?(ee(),ge("li",{key:2,class:ne(y(R)),tabindex:y(w),"aria-label":y(u)("el.pagination.nextPages",{pager:P.pagerCount-2}),onMouseenter:H=>E(),onMouseleave:H=>_.value=!1,onFocus:H=>N(),onBlur:H=>S.value=!1},[(_.value||S.value)&&!P.disabled?(ee(),We(y(Xd),{key:0})):(ee(),We(y(F8),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):$e("v-if",!0),P.pageCount>1?(ee(),ge("li",{key:3,class:ne([[y(i).is("active",P.currentPage===P.pageCount),y(i).is("disabled",P.disabled)],"number"]),"aria-current":P.currentPage===P.pageCount,"aria-label":y(u)("el.pagination.currentPage",{pager:P.pageCount}),tabindex:y(w)},mt(P.pageCount),11,["aria-current","aria-label","tabindex"])):$e("v-if",!0)],42,["onKeyup"]))}});var qRe=vt($Re,[["__file","pager.vue"]]);const oa=e=>typeof e!="number",KRe=pt({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>jt(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:Ue(Array),default:()=>sr([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:ho,default:()=>Yd},nextText:{type:String,default:""},nextIcon:{type:ho,default:()=>ca},teleported:{type:Boolean,default:!0},small:Boolean,size:Kr,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),zRe={"update:current-page":e=>jt(e),"update:page-size":e=>jt(e),"size-change":e=>jt(e),change:(e,t)=>jt(e)&&jt(t),"current-change":e=>jt(e),"prev-click":e=>jt(e),"next-click":e=>jt(e)},GB="ElPagination";var WRe=Te({name:GB,props:KRe,emits:zRe,setup(e,{emit:t,slots:o}){const{t:i}=Kn(),c=ut("pagination"),u=kn().vnode.props||{},f=Jq(),p=z(()=>{var G;return e.small?"small":(G=e.size)!=null?G:f.value});ou({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},z(()=>!!e.small));const v="onUpdate:currentPage"in u||"onUpdate:current-page"in u||"onCurrentChange"in u,_="onUpdate:pageSize"in u||"onUpdate:page-size"in u||"onSizeChange"in u,b=z(()=>{if(oa(e.total)&&oa(e.pageCount)||!oa(e.currentPage)&&!v)return!1;if(e.layout.includes("sizes")){if(oa(e.pageCount)){if(!oa(e.total)&&!oa(e.pageSize)&&!_)return!1}else if(!_)return!1}return!0}),S=le(oa(e.defaultPageSize)?10:e.defaultPageSize),k=le(oa(e.defaultCurrentPage)?1:e.defaultCurrentPage),M=z({get(){return oa(e.pageSize)?S.value:e.pageSize},set(G){oa(e.pageSize)&&(S.value=G),_&&(t("update:page-size",G),t("size-change",G))}}),R=z(()=>{let G=0;return oa(e.pageCount)?oa(e.total)||(G=Math.max(1,Math.ceil(e.total/M.value))):G=e.pageCount,G}),w=z({get(){return oa(e.currentPage)?k.value:e.currentPage},set(G){let H=G;G<1?H=1:G>R.value&&(H=R.value),oa(e.currentPage)&&(k.value=H),v&&(t("update:current-page",H),t("current-change",H))}});st(R,G=>{w.value>G&&(w.value=G)}),st([w,M],G=>{t(wn,...G)},{flush:"post"});function E(G){w.value=G}function N(G){M.value=G;const H=R.value;w.value>H&&(w.value=H)}function F(){e.disabled||(w.value-=1,t("prev-click",w.value))}function x(){e.disabled||(w.value+=1,t("next-click",w.value))}function P(G,H){G&&(G.props||(G.props={}),G.props.class=[G.props.class,H].join(" "))}return Nn(fz,{pageCount:R,disabled:z(()=>e.disabled),currentPage:w,changeEvent:E,handleSizeChange:N}),()=>{var G,H;if(!b.value)return i("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&R.value<=1)return null;const Y=[],j=[],W=Jt("div",{class:c.e("rightwrapper")},j),O={prev:Jt(lRe,{disabled:e.disabled,currentPage:w.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:F}),jumper:Jt(xRe,{size:p.value}),pager:Jt(qRe,{currentPage:w.value,pageCount:R.value,pagerCount:e.pagerCount,onChange:E,disabled:e.disabled}),next:Jt(hRe,{disabled:e.disabled,currentPage:w.value,pageCount:R.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:x}),sizes:Jt(ORe,{pageSize:M.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:p.value,appendSizeTo:e.appendSizeTo}),slot:(H=(G=o==null?void 0:o.default)==null?void 0:G.call(o))!=null?H:null,total:Jt(GRe,{total:oa(e.total)?0:e.total})},Q=e.layout.split(",").map(oe=>oe.trim());let J=!1;return Q.forEach(oe=>{if(oe==="->"){J=!0;return}J?j.push(O[oe]):Y.push(O[oe])}),P(Y[0],c.is("first")),P(Y[Y.length-1],c.is("last")),J&&j.length>0&&(P(j[0],c.is("first")),P(j[j.length-1],c.is("last")),Y.push(W)),Jt("div",{class:[c.b(),c.is("background",e.background),c.m(p.value)]},Y)}}});const jRe=un(WRe),YRe=pt({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:XD,default:"primary"},cancelButtonType:{type:String,values:XD,default:"text"},icon:{type:ho,default:()=>z_e},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Ur.teleported,persistent:Ur.persistent,width:{type:[String,Number],default:150}}),JRe={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},XRe=Te({name:"ElPopconfirm"}),ZRe=Te({...XRe,props:YRe,emits:JRe,setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=ut("popconfirm"),u=le(),f=()=>{var k,M;(M=(k=u.value)==null?void 0:k.onClose)==null||M.call(k)},p=z(()=>({width:ur(o.width)})),v=k=>{t("confirm",k),f()},_=k=>{t("cancel",k),f()},b=z(()=>o.confirmButtonText||i("el.popconfirm.confirmButtonText")),S=z(()=>o.cancelButtonText||i("el.popconfirm.cancelButtonText"));return(k,M)=>(ee(),We(y(Li),An({ref_key:"tooltipRef",ref:u,trigger:"click",effect:"light"},k.$attrs,{"popper-class":`${y(c).namespace.value}-popover`,"popper-style":y(p),teleported:k.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":k.hideAfter,persistent:k.persistent}),{content:Ae(()=>[Ee("div",{class:ne(y(c).b())},[Ee("div",{class:ne(y(c).e("main"))},[!k.hideIcon&&k.icon?(ee(),We(y(Pt),{key:0,class:ne(y(c).e("icon")),style:qt({color:k.iconColor})},{default:Ae(()=>[(ee(),We(Tn(k.icon)))]),_:1},8,["class","style"])):$e("v-if",!0),Mn(" "+mt(k.title),1)],2),Ee("div",{class:ne(y(c).e("action"))},[Ve(k.$slots,"actions",{confirm:v,cancel:_},()=>[Me(y(di),{size:"small",type:k.cancelButtonType==="text"?"":k.cancelButtonType,text:k.cancelButtonType==="text",onClick:_},{default:Ae(()=>[Mn(mt(y(S)),1)]),_:1},8,["type","text"]),Me(y(di),{size:"small",type:k.confirmButtonType==="text"?"":k.confirmButtonType,text:k.confirmButtonType==="text",onClick:v},{default:Ae(()=>[Mn(mt(y(b)),1)]),_:1},8,["type","text"])])],2)],2)]),default:Ae(()=>[k.$slots.reference?Ve(k.$slots,"reference",{key:0}):$e("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var QRe=vt(ZRe,[["__file","popconfirm.vue"]]);const eAe=un(QRe),tAe=pt({trigger:Og.trigger,triggerKeys:Og.triggerKeys,placement:fE.placement,disabled:Og.disabled,visible:Ur.visible,transition:Ur.transition,popperOptions:fE.popperOptions,tabindex:fE.tabindex,content:Ur.content,popperStyle:Ur.popperStyle,popperClass:Ur.popperClass,enterable:{...Ur.enterable,default:!0},effect:{...Ur.effect,default:"light"},teleported:Ur.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),nAe={"update:visible":e=>vo(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},oAe="onUpdate:visible",rAe=Te({name:"ElPopover"}),iAe=Te({...rAe,props:tAe,emits:nAe,setup(e,{expose:t,emit:o}){const i=e,c=z(()=>i[oAe]),u=ut("popover"),f=le(),p=z(()=>{var E;return(E=y(f))==null?void 0:E.popperRef}),v=z(()=>[{width:ur(i.width)},i.popperStyle]),_=z(()=>[u.b(),i.popperClass,{[u.m("plain")]:!!i.content}]),b=z(()=>i.transition===`${u.namespace.value}-fade-in-linear`),S=()=>{var E;(E=f.value)==null||E.hide()},k=()=>{o("before-enter")},M=()=>{o("before-leave")},R=()=>{o("after-enter")},w=()=>{o("update:visible",!1),o("after-leave")};return t({popperRef:p,hide:S}),(E,N)=>(ee(),We(y(Li),An({ref_key:"tooltipRef",ref:f},E.$attrs,{trigger:E.trigger,"trigger-keys":E.triggerKeys,placement:E.placement,disabled:E.disabled,visible:E.visible,transition:E.transition,"popper-options":E.popperOptions,tabindex:E.tabindex,content:E.content,offset:E.offset,"show-after":E.showAfter,"hide-after":E.hideAfter,"auto-close":E.autoClose,"show-arrow":E.showArrow,"aria-label":E.title,effect:E.effect,enterable:E.enterable,"popper-class":y(_),"popper-style":y(v),teleported:E.teleported,persistent:E.persistent,"gpu-acceleration":y(b),"onUpdate:visible":y(c),onBeforeShow:k,onBeforeHide:M,onShow:R,onHide:w}),{content:Ae(()=>[E.title?(ee(),ge("div",{key:0,class:ne(y(u).e("title")),role:"title"},mt(E.title),3)):$e("v-if",!0),Ve(E.$slots,"default",{},()=>[Mn(mt(E.content),1)])]),default:Ae(()=>[E.$slots.reference?Ve(E.$slots,"reference",{key:0}):$e("v-if",!0)]),_:3},16,["trigger","trigger-keys","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var aAe=vt(iAe,[["__file","popover.vue"]]);const BB=(e,t)=>{const o=t.arg||t.value,i=o==null?void 0:o.popperRef;i&&(i.triggerRef=e)};var sAe={mounted(e,t){BB(e,t)},updated(e,t){BB(e,t)}};const lAe="popover",gz=e_e(sAe,lAe),cAe=un(aAe,{directive:gz}),uAe=pt({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Ue(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Ue([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Ue(Function),default:e=>`${e}%`}}),dAe=Te({name:"ElProgress"}),hAe=Te({...dAe,props:uAe,setup(e){const t=e,o={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},i=ut("progress"),c=z(()=>{const x={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},P=F(t.percentage);return P.includes("gradient")?x.background=P:x.backgroundColor=P,x}),u=z(()=>(t.strokeWidth/t.width*100).toFixed(1)),f=z(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(u.value)/2}`,10):0),p=z(()=>{const x=f.value,P=t.type==="dashboard";return`
          M 50 50
          m 0 ${P?"":"-"}${x}
          a ${x} ${x} 0 1 1 0 ${P?"-":""}${x*2}
          a ${x} ${x} 0 1 1 0 ${P?"":"-"}${x*2}
          `}),v=z(()=>2*Math.PI*f.value),_=z(()=>t.type==="dashboard"?.75:1),b=z(()=>`${-1*v.value*(1-_.value)/2}px`),S=z(()=>({strokeDasharray:`${v.value*_.value}px, ${v.value}px`,strokeDashoffset:b.value})),k=z(()=>({strokeDasharray:`${v.value*_.value*(t.percentage/100)}px, ${v.value}px`,strokeDashoffset:b.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),M=z(()=>{let x;return t.color?x=F(t.percentage):x=o[t.status]||o.default,x}),R=z(()=>t.status==="warning"?FT:t.type==="line"?t.status==="success"?rN:pu:t.status==="success"?sI:As),w=z(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),E=z(()=>t.format(t.percentage));function N(x){const P=100/x.length;return x.map((H,Y)=>Ut(H)?{color:H,percentage:(Y+1)*P}:H).sort((H,Y)=>H.percentage-Y.percentage)}const F=x=>{var P;const{color:G}=t;if(zt(G))return G(x);if(Ut(G))return G;{const H=N(G);for(const Y of H)if(Y.percentage>x)return Y.color;return(P=H[H.length-1])==null?void 0:P.color}};return(x,P)=>(ee(),ge("div",{class:ne([y(i).b(),y(i).m(x.type),y(i).is(x.status),{[y(i).m("without-text")]:!x.showText,[y(i).m("text-inside")]:x.textInside}]),role:"progressbar","aria-valuenow":x.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[x.type==="line"?(ee(),ge("div",{key:0,class:ne(y(i).b("bar"))},[Ee("div",{class:ne(y(i).be("bar","outer")),style:qt({height:`${x.strokeWidth}px`})},[Ee("div",{class:ne([y(i).be("bar","inner"),{[y(i).bem("bar","inner","indeterminate")]:x.indeterminate},{[y(i).bem("bar","inner","striped")]:x.striped},{[y(i).bem("bar","inner","striped-flow")]:x.stripedFlow}]),style:qt(y(c))},[(x.showText||x.$slots.default)&&x.textInside?(ee(),ge("div",{key:0,class:ne(y(i).be("bar","innerText"))},[Ve(x.$slots,"default",{percentage:x.percentage},()=>[Ee("span",null,mt(y(E)),1)])],2)):$e("v-if",!0)],6)],6)],2)):(ee(),ge("div",{key:1,class:ne(y(i).b("circle")),style:qt({height:`${x.width}px`,width:`${x.width}px`})},[(ee(),ge("svg",{viewBox:"0 0 100 100"},[Ee("path",{class:ne(y(i).be("circle","track")),d:y(p),stroke:`var(${y(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":x.strokeLinecap,"stroke-width":y(u),fill:"none",style:qt(y(S))},null,14,["d","stroke","stroke-linecap","stroke-width"]),Ee("path",{class:ne(y(i).be("circle","path")),d:y(p),stroke:y(M),fill:"none",opacity:x.percentage?1:0,"stroke-linecap":x.strokeLinecap,"stroke-width":y(u),style:qt(y(k))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(x.showText||x.$slots.default)&&!x.textInside?(ee(),ge("div",{key:2,class:ne(y(i).e("text")),style:qt({fontSize:`${y(w)}px`})},[Ve(x.$slots,"default",{percentage:x.percentage},()=>[x.status?(ee(),We(y(Pt),{key:1},{default:Ae(()=>[(ee(),We(Tn(y(R))))]),_:1})):(ee(),ge("span",{key:0},mt(y(E)),1))])],6)):$e("v-if",!0)],10,["aria-valuenow"]))}});var fAe=vt(hAe,[["__file","progress.vue"]]);const vz=un(fAe),pAe=pt({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:Ue([Array,Object]),default:()=>sr(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:Ue([Array,Object]),default:()=>[US,US,US]},voidIcon:{type:ho,default:()=>sye},disabledVoidIcon:{type:ho,default:()=>US},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:Ue(Array),default:()=>sr(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Kr,clearable:Boolean,...Ci(["ariaLabel"])}),mAe={[wn]:e=>jt(e),[nn]:e=>jt(e)},gAe=Te({name:"ElRate"}),vAe=Te({...gAe,props:pAe,emits:mAe,setup(e,{expose:t,emit:o}){const i=e;function c(te,he){const re=ue=>gn(ue),X=Object.keys(he).map(ue=>+ue).filter(ue=>{const Ie=he[ue];return(re(Ie)?Ie.excluded:!1)?te<ue:te<=ue}).sort((ue,Ie)=>ue-Ie),ye=he[X[0]];return re(ye)&&ye.value||ye}const u=Rt(_p,void 0),f=Rt(tc,void 0),p=Fr(),v=ut("rate"),{inputId:_,isLabeledByFormItem:b}=Ps(i,{formItemContext:f}),S=le(i.modelValue),k=le(-1),M=le(!0),R=z(()=>[v.b(),v.m(p.value)]),w=z(()=>i.disabled||(u==null?void 0:u.disabled)),E=z(()=>v.cssVarBlock({"void-color":i.voidColor,"disabled-void-color":i.disabledVoidColor,"fill-color":P.value})),N=z(()=>{let te="";return i.showScore?te=i.scoreTemplate.replace(/\{\s*value\s*\}/,w.value?`${i.modelValue}`:`${S.value}`):i.showText&&(te=i.texts[Math.ceil(S.value)-1]),te}),F=z(()=>i.modelValue*100-Math.floor(i.modelValue)*100),x=z(()=>ht(i.colors)?{[i.lowThreshold]:i.colors[0],[i.highThreshold]:{value:i.colors[1],excluded:!0},[i.max]:i.colors[2]}:i.colors),P=z(()=>{const te=c(S.value,x.value);return gn(te)?"":te}),G=z(()=>{let te="";return w.value?te=`${F.value}%`:i.allowHalf&&(te="50%"),{color:P.value,width:te}}),H=z(()=>{let te=ht(i.icons)?[...i.icons]:{...i.icons};return te=tu(te),ht(te)?{[i.lowThreshold]:te[0],[i.highThreshold]:{value:te[1],excluded:!0},[i.max]:te[2]}:te}),Y=z(()=>c(i.modelValue,H.value)),j=z(()=>w.value?Ut(i.disabledVoidIcon)?i.disabledVoidIcon:tu(i.disabledVoidIcon):Ut(i.voidIcon)?i.voidIcon:tu(i.voidIcon)),W=z(()=>c(S.value,H.value));function O(te){const he=w.value&&F.value>0&&te-1<i.modelValue&&te>i.modelValue,re=i.allowHalf&&M.value&&te-.5<=S.value&&te>S.value;return he||re}function Q(te){i.clearable&&te===i.modelValue&&(te=0),o(nn,te),i.modelValue!==te&&o(wn,te)}function J(te){w.value||(i.allowHalf&&M.value?Q(S.value):Q(te))}function oe(te){if(w.value)return;let he=S.value;const re=te.code;return re===At.up||re===At.right?(i.allowHalf?he+=.5:he+=1,te.stopPropagation(),te.preventDefault()):(re===At.left||re===At.down)&&(i.allowHalf?he-=.5:he-=1,te.stopPropagation(),te.preventDefault()),he=he<0?0:he,he=he>i.max?i.max:he,o(nn,he),o(wn,he),he}function pe(te,he){if(!w.value){if(i.allowHalf&&he){let re=he.target;wa(re,v.e("item"))&&(re=re.querySelector(`.${v.e("icon")}`)),(re.clientWidth===0||wa(re,v.e("decimal")))&&(re=re.parentNode),M.value=he.offsetX*2<=re.clientWidth,S.value=M.value?te-.5:te}else S.value=te;k.value=te}}function ie(){w.value||(i.allowHalf&&(M.value=i.modelValue!==Math.floor(i.modelValue)),S.value=i.modelValue,k.value=-1)}return st(()=>i.modelValue,te=>{S.value=te,M.value=i.modelValue!==Math.floor(i.modelValue)}),i.modelValue||o(nn,0),t({setCurrentValue:pe,resetCurrentValue:ie}),(te,he)=>{var re;return ee(),ge("div",{id:y(_),class:ne([y(R),y(v).is("disabled",y(w))]),role:"slider","aria-label":y(b)?void 0:te.ariaLabel||"rating","aria-labelledby":y(b)?(re=y(f))==null?void 0:re.labelId:void 0,"aria-valuenow":S.value,"aria-valuetext":y(N)||void 0,"aria-valuemin":"0","aria-valuemax":te.max,tabindex:"0",style:qt(y(E)),onKeydown:oe},[(ee(!0),ge(Ht,null,Un(te.max,(X,ye)=>(ee(),ge("span",{key:ye,class:ne(y(v).e("item")),onMousemove:ue=>pe(X,ue),onMouseleave:ie,onClick:ue=>J(X)},[Me(y(Pt),{class:ne([y(v).e("icon"),{hover:k.value===X},y(v).is("active",X<=S.value)])},{default:Ae(()=>[O(X)?$e("v-if",!0):(ee(),ge(Ht,{key:0},[fn((ee(),We(Tn(y(W)),null,null,512)),[[Zn,X<=S.value]]),fn((ee(),We(Tn(y(j)),null,null,512)),[[Zn,!(X<=S.value)]])],64)),O(X)?(ee(),ge(Ht,{key:1},[(ee(),We(Tn(y(j)),{class:ne([y(v).em("decimal","box")])},null,8,["class"])),Me(y(Pt),{style:qt(y(G)),class:ne([y(v).e("icon"),y(v).e("decimal")])},{default:Ae(()=>[(ee(),We(Tn(y(Y))))]),_:1},8,["style","class"])],64)):$e("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),te.showText||te.showScore?(ee(),ge("span",{key:0,class:ne(y(v).e("text")),style:qt({color:te.textColor})},mt(y(N)),7)):$e("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var _Ae=vt(vAe,[["__file","rate.vue"]]);const yAe=un(_Ae),bg={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},HB={[bg.success]:y_e,[bg.warning]:FT,[bg.error]:iN,[bg.info]:aN},IAe=pt({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),bAe=Te({name:"ElResult"}),CAe=Te({...bAe,props:IAe,setup(e){const t=e,o=ut("result"),i=z(()=>{const c=t.icon,u=c&&bg[c]?bg[c]:"icon-info",f=HB[u]||HB["icon-info"];return{class:u,component:f}});return(c,u)=>(ee(),ge("div",{class:ne(y(o).b())},[Ee("div",{class:ne(y(o).e("icon"))},[Ve(c.$slots,"icon",{},()=>[y(i).component?(ee(),We(Tn(y(i).component),{key:0,class:ne(y(i).class)},null,8,["class"])):$e("v-if",!0)])],2),c.title||c.$slots.title?(ee(),ge("div",{key:0,class:ne(y(o).e("title"))},[Ve(c.$slots,"title",{},()=>[Ee("p",null,mt(c.title),1)])],2)):$e("v-if",!0),c.subTitle||c.$slots["sub-title"]?(ee(),ge("div",{key:1,class:ne(y(o).e("subtitle"))},[Ve(c.$slots,"sub-title",{},()=>[Ee("p",null,mt(c.subTitle),1)])],2)):$e("v-if",!0),c.$slots.extra?(ee(),ge("div",{key:2,class:ne(y(o).e("extra"))},[Ve(c.$slots,"extra")],2)):$e("v-if",!0)],2))}});var SAe=vt(CAe,[["__file","result.vue"]]);const EAe=un(SAe),TAe=["start","center","end","space-around","space-between","space-evenly"],MAe=["top","middle","bottom"],kAe=pt({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:TAe,default:"start"},align:{type:String,values:MAe}}),wAe=Te({name:"ElRow"}),RAe=Te({...wAe,props:kAe,setup(e){const t=e,o=ut("row"),i=z(()=>t.gutter);Nn(g9,{gutter:i});const c=z(()=>{const f={};return t.gutter&&(f.marginRight=f.marginLeft=`-${t.gutter/2}px`),f}),u=z(()=>[o.b(),o.is(`justify-${t.justify}`,t.justify!=="start"),o.is(`align-${t.align}`,!!t.align)]);return(f,p)=>(ee(),We(Tn(f.tag),{class:ne(y(u)),style:qt(y(c))},{default:Ae(()=>[Ve(f.$slots,"default")]),_:3},8,["class","style"]))}});var AAe=vt(RAe,[["__file","row.vue"]]);const DAe=un(AAe),OAe=Te({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:ut("select")}}});function LAe(e,t,o,i,c,u){return ee(),ge("div",{class:ne(e.ns.be("group","title")),style:qt({...e.style,lineHeight:`${e.height}px`})},mt(e.item.label),7)}var NAe=vt(OAe,[["render",LAe],["__file","group-item.vue"]]);function PAe(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const _z={label:"label",value:"value",disabled:"disabled",options:"options"};function YT(e){const t=z(()=>({..._z,...e.props}));return{aliasProps:t,getLabel:f=>Rr(f,t.value.label),getValue:f=>Rr(f,t.value.value),getDisabled:f=>Rr(f,t.value.disabled),getOptions:f=>Rr(f,t.value.options)}}const xAe=pt({allowCreate:Boolean,autocomplete:{type:Ue(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:ho,default:pu},effect:{type:Ue(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:Ue([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Ue(Array),required:!0},placeholder:{type:String},teleported:Ur.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Ue(Object),default:()=>({})},remote:Boolean,size:Kr,props:{type:Ue(Object),default:()=>_z},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:Ue(String),values:mu,default:"bottom-start"},fallbackPlacements:{type:Ue(Array),default:["bottom-start","top-start","right","left"]},tagType:{...su.type,default:"info"},tagEffect:{...su.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:Ur.appendTo,fitInputWidth:{type:[Boolean,Number],default:!0,validator(e){return vo(e)||jt(e)}},suffixIcon:{type:ho,default:fu},...mv,...Ci(["ariaLabel"])}),UAe=pt({data:Array,disabled:Boolean,hovering:Boolean,item:{type:Ue(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),FAe={[nn]:e=>!0,[wn]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},VAe={hover:e=>jt(e),select:(e,t)=>!0},zN=Symbol("ElSelectV2Injection"),GAe=Te({props:UAe,emits:VAe,setup(e,{emit:t}){const o=Rt(zN),i=ut("select"),{hoverItem:c,selectOptionClick:u}=PAe(e,{emit:t}),{getLabel:f}=YT(o.props);return{ns:i,hoverItem:c,selectOptionClick:u,getLabel:f}}});function BAe(e,t,o,i,c,u){return ee(),ge("li",{"aria-selected":e.selected,style:qt(e.style),class:ne([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:Zt(e.selectOptionClick,["stop"])},[Ve(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ee("span",null,mt(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var HAe=vt(GAe,[["render",BAe],["__file","option-item.vue"]]),$B=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function $Ae(e,t){return!!(e===t||$B(e)&&$B(t))}function qAe(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!$Ae(e[o],t[o]))return!1;return!0}function KAe(e,t){t===void 0&&(t=qAe);var o=null;function i(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];if(o&&o.lastThis===this&&t(c,o.lastArgs))return o.lastResult;var f=e.apply(this,c);return o={lastResult:f,lastArgs:c,lastThis:this},f}return i.clear=function(){o=null},i}const yz=()=>{const t=kn().proxy.$props;return z(()=>{const o=(i,c,u)=>({});return t.perfMode?DT(o):KAe(o)})},yO=50,QE="itemRendered",eT="scroll",Cg="forward",tT="backward",Es="auto",JT="smart",V0="start",Jl="center",G0="end",tv="horizontal",WN="vertical",zAe="ltr",Ng="rtl",B0="negative",jN="positive-ascending",YN="positive-descending",WAe={[tv]:"left",[WN]:"top"},jAe=20,YAe={[tv]:"deltaX",[WN]:"deltaY"},JAe=({atEndEdge:e,atStartEdge:t,layout:o},i)=>{let c,u=0;const f=v=>v<0&&t.value||v>0&&e.value;return{hasReachedEdge:f,onWheel:v=>{up(c);const _=v[YAe[o.value]];f(u)&&f(u+_)||(u+=_,GT()||v.preventDefault(),c=Wd(()=>{i(u),u=0}))}}},IO=fl({type:Ue([Number,Function]),required:!0}),bO=fl({type:Number}),CO=fl({type:Number,default:2}),XAe=fl({type:String,values:["ltr","rtl"],default:"ltr"}),SO=fl({type:Number,default:0}),nT=fl({type:Number,required:!0}),Iz=fl({type:String,values:["horizontal","vertical"],default:WN}),bz=pt({className:{type:String,default:""},containerElement:{type:Ue([String,Object]),default:"div"},data:{type:Ue(Array),default:()=>sr([])},direction:XAe,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:Ue([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),Cz=pt({cache:CO,estimatedItemSize:bO,layout:Iz,initScrollOffset:SO,total:nT,itemSize:IO,...bz}),EO={type:Number,default:6},Sz={type:Number,default:0},Ez={type:Number,default:2},ap=pt({columnCache:CO,columnWidth:IO,estimatedColumnWidth:bO,estimatedRowHeight:bO,initScrollLeft:SO,initScrollTop:SO,itemKey:{type:Ue(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:CO,rowHeight:IO,totalColumn:nT,totalRow:nT,hScrollbarSize:EO,vScrollbarSize:EO,scrollbarStartGap:Sz,scrollbarEndGap:Ez,role:String,...bz}),Tz=pt({alwaysOn:Boolean,class:String,layout:Iz,total:nT,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:EO,startGap:Sz,endGap:Ez,visible:Boolean}),Xf=(e,t)=>e<t?Cg:tT,H0=e=>e===zAe||e===Ng||e===tv,qB=e=>e===Ng;let dg=null;function oT(e=!1){if(dg===null||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";const i=document.createElement("div"),c=i.style;return c.width="100px",c.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?dg=YN:(t.scrollLeft=1,t.scrollLeft===0?dg=B0:dg=jN),document.body.removeChild(t),dg}return dg}function ZAe({move:e,size:t,bar:o},i){const c={},u=`translate${o.axis}(${e}px)`;return c[o.size]=t,c.transform=u,i==="horizontal"?c.height="100%":c.width="100%",c}const TO=Te({name:"ElVirtualScrollBar",props:Tz,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const o=z(()=>e.startGap+e.endGap),i=ut("virtual-scrollbar"),c=ut("scrollbar"),u=le(),f=le();let p=null,v=null;const _=eo({isDragging:!1,traveled:0}),b=z(()=>uK[e.layout]),S=z(()=>e.clientSize-y(o)),k=z(()=>({position:"absolute",width:`${tv===e.layout?S.value:e.scrollbarSize}px`,height:`${tv===e.layout?e.scrollbarSize:S.value}px`,[WAe[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),M=z(()=>{const H=e.ratio,Y=e.clientSize;if(H>=100)return Number.POSITIVE_INFINITY;if(H>=50)return H*Y/100;const j=Y/3;return Math.floor(Math.min(Math.max(H*Y,jAe),j))}),R=z(()=>{if(!Number.isFinite(M.value))return{display:"none"};const H=`${M.value}px`;return ZAe({bar:b.value,size:H,move:_.traveled},e.layout)}),w=z(()=>Math.floor(e.clientSize-M.value-y(o))),E=()=>{window.addEventListener("mousemove",P),window.addEventListener("mouseup",x);const H=y(f);H&&(v=document.onselectstart,document.onselectstart=()=>!1,H.addEventListener("touchmove",P,{passive:!0}),H.addEventListener("touchend",x))},N=()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",x),document.onselectstart=v,v=null;const H=y(f);H&&(H.removeEventListener("touchmove",P),H.removeEventListener("touchend",x))},F=H=>{H.stopImmediatePropagation(),!(H.ctrlKey||[1,2].includes(H.button))&&(_.isDragging=!0,_[b.value.axis]=H.currentTarget[b.value.offset]-(H[b.value.client]-H.currentTarget.getBoundingClientRect()[b.value.direction]),t("start-move"),E())},x=()=>{_.isDragging=!1,_[b.value.axis]=0,t("stop-move"),N()},P=H=>{const{isDragging:Y}=_;if(!Y||!f.value||!u.value)return;const j=_[b.value.axis];if(!j)return;up(p);const W=(u.value.getBoundingClientRect()[b.value.direction]-H[b.value.client])*-1,O=f.value[b.value.offset]-j,Q=W-O;p=Wd(()=>{_.traveled=Math.max(e.startGap,Math.min(Q,w.value)),t("scroll",Q,w.value)})},G=H=>{const Y=Math.abs(H.target.getBoundingClientRect()[b.value.direction]-H[b.value.client]),j=f.value[b.value.offset]/2,W=Y-j;_.traveled=Math.max(0,Math.min(W,w.value)),t("scroll",W,w.value)};return st(()=>e.scrollFrom,H=>{_.isDragging||(_.traveled=Math.ceil(H*w.value))}),Co(()=>{N()}),()=>Jt("div",{role:"presentation",ref:u,class:[i.b(),e.class,(e.alwaysOn||_.isDragging)&&"always-on"],style:k.value,onMousedown:Zt(G,["stop","prevent"]),onTouchstartPrevent:F},Jt("div",{ref:f,class:c.e("thumb"),style:R.value,onMousedown:F},[]))}}),Mz=({name:e,getOffset:t,getItemSize:o,getItemOffset:i,getEstimatedTotalSize:c,getStartIndexForOffset:u,getStopIndexForStartIndex:f,initCache:p,clearCache:v,validateProps:_})=>Te({name:e??"ElVirtualList",props:Cz,emits:[QE,eT],setup(b,{emit:S,expose:k}){_(b);const M=kn(),R=ut("vl"),w=le(p(b,M)),E=yz(),N=le(),F=le(),x=le(),P=le({isScrolling:!1,scrollDir:"forward",scrollOffset:jt(b.initScrollOffset)?b.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:b.scrollbarAlwaysOn}),G=z(()=>{const{total:ve,cache:Ce}=b,{isScrolling:Fe,scrollDir:Oe,scrollOffset:be}=y(P);if(ve===0)return[0,0,0,0];const xe=u(b,be,y(w)),Le=f(b,xe,be,y(w)),rt=!Fe||Oe===tT?Math.max(1,Ce):1,Qe=!Fe||Oe===Cg?Math.max(1,Ce):1;return[Math.max(0,xe-rt),Math.max(0,Math.min(ve-1,Le+Qe)),xe,Le]}),H=z(()=>c(b,y(w))),Y=z(()=>H0(b.layout)),j=z(()=>[{position:"relative",[`overflow-${Y.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:b.direction,height:jt(b.height)?`${b.height}px`:b.height,width:jt(b.width)?`${b.width}px`:b.width},b.style]),W=z(()=>{const ve=y(H),Ce=y(Y);return{height:Ce?"100%":`${ve}px`,pointerEvents:y(P).isScrolling?"none":void 0,width:Ce?`${ve}px`:"100%"}}),O=z(()=>Y.value?b.width:b.height),{onWheel:Q}=JAe({atStartEdge:z(()=>P.value.scrollOffset<=0),atEndEdge:z(()=>P.value.scrollOffset>=H.value),layout:z(()=>b.layout)},ve=>{var Ce,Fe;(Fe=(Ce=x.value).onMouseUp)==null||Fe.call(Ce),he(Math.min(P.value.scrollOffset+ve,H.value-O.value))});_o(N,"wheel",Q,{passive:!1});const J=()=>{const{total:ve}=b;if(ve>0){const[be,xe,Le,rt]=y(G);S(QE,be,xe,Le,rt)}const{scrollDir:Ce,scrollOffset:Fe,updateRequested:Oe}=y(P);S(eT,Ce,Fe,Oe)},oe=ve=>{const{clientHeight:Ce,scrollHeight:Fe,scrollTop:Oe}=ve.currentTarget,be=y(P);if(be.scrollOffset===Oe)return;const xe=Math.max(0,Math.min(Oe,Fe-Ce));P.value={...be,isScrolling:!0,scrollDir:Xf(be.scrollOffset,xe),scrollOffset:xe,updateRequested:!1},Vt(ye)},pe=ve=>{const{clientWidth:Ce,scrollLeft:Fe,scrollWidth:Oe}=ve.currentTarget,be=y(P);if(be.scrollOffset===Fe)return;const{direction:xe}=b;let Le=Fe;if(xe===Ng)switch(oT()){case B0:{Le=-Fe;break}case YN:{Le=Oe-Ce-Fe;break}}Le=Math.max(0,Math.min(Le,Oe-Ce)),P.value={...be,isScrolling:!0,scrollDir:Xf(be.scrollOffset,Le),scrollOffset:Le,updateRequested:!1},Vt(ye)},ie=ve=>{y(Y)?pe(ve):oe(ve),J()},te=(ve,Ce)=>{const Fe=(H.value-O.value)/Ce*ve;he(Math.min(H.value-O.value,Fe))},he=ve=>{ve=Math.max(ve,0),ve!==y(P).scrollOffset&&(P.value={...y(P),scrollOffset:ve,scrollDir:Xf(y(P).scrollOffset,ve),updateRequested:!0},Vt(ye))},re=(ve,Ce=Es)=>{const{scrollOffset:Fe}=y(P);ve=Math.max(0,Math.min(ve,b.total-1)),he(t(b,ve,Ce,Fe,y(w)))},X=ve=>{const{direction:Ce,itemSize:Fe,layout:Oe}=b,be=E.value(v&&Fe,v&&Oe,v&&Ce);let xe;if(jn(be,String(ve)))xe=be[ve];else{const Le=i(b,ve,y(w)),rt=o(b,ve,y(w)),Qe=y(Y),Ge=Ce===Ng,_e=Qe?Le:0;be[ve]=xe={position:"absolute",left:Ge?void 0:`${_e}px`,right:Ge?`${_e}px`:void 0,top:Qe?0:`${Le}px`,height:Qe?"100%":`${rt}px`,width:Qe?`${rt}px`:"100%"}}return xe},ye=()=>{P.value.isScrolling=!1,Vt(()=>{E.value(-1,null,null)})},ue=()=>{const ve=N.value;ve&&(ve.scrollTop=0)};mn(()=>{if(!$n)return;const{initScrollOffset:ve}=b,Ce=y(N);jt(ve)&&Ce&&(y(Y)?Ce.scrollLeft=ve:Ce.scrollTop=ve),J()}),dl(()=>{const{direction:ve,layout:Ce}=b,{scrollOffset:Fe,updateRequested:Oe}=y(P),be=y(N);if(Oe&&be)if(Ce===tv)if(ve===Ng)switch(oT()){case B0:{be.scrollLeft=-Fe;break}case jN:{be.scrollLeft=Fe;break}default:{const{clientWidth:xe,scrollWidth:Le}=be;be.scrollLeft=Le-xe-Fe;break}}else be.scrollLeft=Fe;else be.scrollTop=Fe}),vL(()=>{y(N).scrollTop=y(P).scrollOffset});const Ie={ns:R,clientSize:O,estimatedTotalSize:H,windowStyle:j,windowRef:N,innerRef:F,innerStyle:W,itemsToRender:G,scrollbarRef:x,states:P,getItemStyle:X,onScroll:ie,onScrollbarScroll:te,onWheel:Q,scrollTo:he,scrollToItem:re,resetScrollTop:ue};return k({windowRef:N,innerRef:F,getItemStyleCache:E,scrollTo:he,scrollToItem:re,resetScrollTop:ue,states:P}),Ie},render(b){var S;const{$slots:k,className:M,clientSize:R,containerElement:w,data:E,getItemStyle:N,innerElement:F,itemsToRender:x,innerStyle:P,layout:G,total:H,onScroll:Y,onScrollbarScroll:j,states:W,useIsScrolling:O,windowStyle:Q,ns:J}=b,[oe,pe]=x,ie=Tn(w),te=Tn(F),he=[];if(H>0)for(let ue=oe;ue<=pe;ue++)he.push(Jt(Ht,{key:ue},(S=k.default)==null?void 0:S.call(k,{data:E,index:ue,isScrolling:O?W.isScrolling:void 0,style:N(ue)})));const re=[Jt(te,{style:P,ref:"innerRef"},Ut(te)?he:{default:()=>he})],X=Jt(TO,{ref:"scrollbarRef",clientSize:R,layout:G,onScroll:j,ratio:R*100/this.estimatedTotalSize,scrollFrom:W.scrollOffset/(this.estimatedTotalSize-R),total:H}),ye=Jt(ie,{class:[J.e("window"),M],style:Q,onScroll:Y,ref:"windowRef",key:0},Ut(ie)?[re]:{default:()=>[re]});return Jt("div",{key:0,class:[J.e("wrapper"),W.scrollbarAlwaysOn?"always-on":""]},[ye,X])}}),kz=Mz({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:o,layout:i,width:c},u,f,p)=>{const v=H0(i)?c:e,_=Math.max(0,t*o-v),b=Math.min(_,u*o),S=Math.max(0,(u+1)*o-v);switch(f===JT&&(p>=S-v&&p<=b+v?f=Es:f=Jl),f){case V0:return b;case G0:return S;case Jl:{const k=Math.round(S+(b-S)/2);return k<Math.ceil(v/2)?0:k>_+Math.floor(v/2)?_:k}case Es:default:return p>=S&&p<=b?p:p<S?S:b}},getStartIndexForOffset:({total:e,itemSize:t},o)=>Math.max(0,Math.min(e-1,Math.floor(o/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:o,layout:i,width:c},u,f)=>{const p=u*o,v=H0(i)?c:e,_=Math.ceil((v+f-p)/o);return Math.max(0,Math.min(t-1,u+_-1))},initCache(){},clearCache:!0,validateProps(){}}),Sg=(e,t,o)=>{const{itemSize:i}=e,{items:c,lastVisitedIndex:u}=o;if(t>u){let f=0;if(u>=0){const p=c[u];f=p.offset+p.size}for(let p=u+1;p<=t;p++){const v=i(p);c[p]={offset:f,size:v},f+=v}o.lastVisitedIndex=t}return c[t]},QAe=(e,t,o)=>{const{items:i,lastVisitedIndex:c}=t;return(c>0?i[c].offset:0)>=o?wz(e,t,0,c,o):eDe(e,t,Math.max(0,c),o)},wz=(e,t,o,i,c)=>{for(;o<=i;){const u=o+Math.floor((i-o)/2),f=Sg(e,u,t).offset;if(f===c)return u;f<c?o=u+1:f>c&&(i=u-1)}return Math.max(0,o-1)},eDe=(e,t,o,i)=>{const{total:c}=e;let u=1;for(;o<c&&Sg(e,o,t).offset<i;)o+=u,u*=2;return wz(e,t,Math.floor(o/2),Math.min(o,c-1),i)},KB=({total:e},{items:t,estimatedItemSize:o,lastVisitedIndex:i})=>{let c=0;if(i>=e&&(i=e-1),i>=0){const p=t[i];c=p.offset+p.size}const f=(e-i-1)*o;return c+f},tDe=Mz({name:"ElDynamicSizeList",getItemOffset:(e,t,o)=>Sg(e,t,o).offset,getItemSize:(e,t,{items:o})=>o[t].size,getEstimatedTotalSize:KB,getOffset:(e,t,o,i,c)=>{const{height:u,layout:f,width:p}=e,v=H0(f)?p:u,_=Sg(e,t,c),b=KB(e,c),S=Math.max(0,Math.min(b-v,_.offset)),k=Math.max(0,_.offset-v+_.size);switch(o===JT&&(i>=k-v&&i<=S+v?o=Es:o=Jl),o){case V0:return S;case G0:return k;case Jl:return Math.round(k+(S-k)/2);case Es:default:return i>=k&&i<=S?i:i<k?k:S}},getStartIndexForOffset:(e,t,o)=>QAe(e,o,t),getStopIndexForStartIndex:(e,t,o,i)=>{const{height:c,total:u,layout:f,width:p}=e,v=H0(f)?p:c,_=Sg(e,t,i),b=o+v;let S=_.offset+_.size,k=t;for(;k<u-1&&S<b;)k++,S+=Sg(e,k,i).size;return k},initCache({estimatedItemSize:e=yO},t){const o={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return o.clearCacheAfterIndex=(i,c=!0)=>{var u,f;o.lastVisitedIndex=Math.min(o.lastVisitedIndex,i-1),(u=t.exposed)==null||u.getItemStyleCache(-1),c&&((f=t.proxy)==null||f.$forceUpdate())},o},clearCache:!1,validateProps:({itemSize:e})=>{}}),nDe={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var oDe=Te({name:"ElSelectDropdown",props:nDe,setup(e,{slots:t,expose:o}){const i=Rt(zN),c=ut("select"),{getLabel:u,getValue:f,getDisabled:p}=YT(i.props),v=le([]),_=le(),b=z(()=>e.data.length);st(()=>b.value,()=>{var Q,J;(J=(Q=i.tooltipRef.value).updatePopper)==null||J.call(Q)});const S=z(()=>qn(i.props.estimatedOptionHeight)),k=z(()=>S.value?{itemSize:i.props.itemHeight}:{estimatedSize:i.props.estimatedOptionHeight,itemSize:Q=>v.value[Q]}),M=(Q=[],J)=>{const{props:{valueKey:oe}}=i;return gn(J)?Q&&Q.some(pe=>Mo(Rr(pe,oe))===Rr(J,oe)):Q.includes(J)},R=(Q,J)=>{if(gn(J)){const{valueKey:oe}=i.props;return Rr(Q,oe)===Rr(J,oe)}else return Q===J},w=(Q,J)=>i.props.multiple?M(Q,f(J)):R(Q,f(J)),E=(Q,J)=>{const{disabled:oe,multiple:pe,multipleLimit:ie}=i.props;return oe||!J&&(pe?ie>0&&Q.length>=ie:!1)},N=Q=>e.hoveringIndex===Q;o({listRef:_,isSized:S,isItemDisabled:E,isItemHovering:N,isItemSelected:w,scrollToItem:Q=>{const J=_.value;J&&J.scrollToItem(Q)},resetScrollTop:()=>{const Q=_.value;Q&&Q.resetScrollTop()}});const G=Q=>{const{index:J,data:oe,style:pe}=Q,ie=y(S),{itemSize:te,estimatedSize:he}=y(k),{modelValue:re}=i.props,{onSelect:X,onHover:ye}=i,ue=oe[J];if(ue.type==="Group")return Me(NAe,{item:ue,style:pe,height:ie?te:he},null);const Ie=w(re,ue),ve=E(re,Ie),Ce=N(J);return Me(HAe,An(Q,{selected:Ie,disabled:p(ue)||ve,created:!!ue.created,hovering:Ce,item:ue,onSelect:X,onHover:ye}),{default:Fe=>{var Oe;return((Oe=t.default)==null?void 0:Oe.call(t,Fe))||Me("span",null,[u(ue)])}})},{onKeyboardNavigate:H,onKeyboardSelect:Y}=i,j=()=>{H("forward")},W=()=>{H("backward")},O=Q=>{const{code:J}=Q,{tab:oe,esc:pe,down:ie,up:te,enter:he,numpadEnter:re}=At;switch([pe,ie,te,he,re].includes(J)&&(Q.preventDefault(),Q.stopPropagation()),J){case oe:case pe:break;case ie:j();break;case te:W();break;case he:case re:Y();break}};return()=>{var Q,J,oe,pe;const{data:ie,width:te}=e,{height:he,multiple:re,scrollbarAlwaysOn:X}=i.props,ye=z(()=>qE?!0:X),ue=y(S)?kz:tDe;return Me("div",{class:[c.b("dropdown"),c.is("multiple",re)],style:{width:`${te}px`}},[(Q=t.header)==null?void 0:Q.call(t),((J=t.loading)==null?void 0:J.call(t))||((oe=t.empty)==null?void 0:oe.call(t))||Me(ue,An({ref:_},y(k),{className:c.be("dropdown","list"),scrollbarAlwaysOn:ye.value,data:ie,height:he,width:te,total:ie.length,onKeydown:O}),{default:Ie=>Me(G,Ie,null)}),(pe=t.footer)==null?void 0:pe.call(t)])}}});function rDe(e,t){const{aliasProps:o,getLabel:i,getValue:c}=YT(e),u=le(0),f=le(),p=z(()=>e.allowCreate&&e.filterable);function v(M){const R=w=>i(w)===M;return e.options&&e.options.some(R)||t.createdOptions.some(R)}function _(M){p.value&&(e.multiple&&M.created?u.value++:f.value=M)}function b(M){if(p.value)if(M&&M.length>0){if(v(M))return;const R={[o.value.value]:M,[o.value.label]:M,created:!0,[o.value.disabled]:!1};t.createdOptions.length>=u.value?t.createdOptions[u.value]=R:t.createdOptions.push(R)}else if(e.multiple)t.createdOptions.length=u.value;else{const R=f.value;t.createdOptions.length=0,R&&R.created&&t.createdOptions.push(R)}}function S(M){if(!p.value||!M||!M.created||M.created&&e.reserveKeyword&&t.inputValue===i(M))return;const R=t.createdOptions.findIndex(w=>c(w)===c(M));~R&&(t.createdOptions.splice(R,1),u.value--)}function k(){p.value&&(t.createdOptions.length=0,u.value=0)}return{createNewOption:b,removeNewOption:S,selectNewOption:_,clearAllNewOption:k}}const iDe=(e,t)=>{const{t:o}=Kn(),i=ut("select"),c=ut("input"),{form:u,formItem:f}=Ni(),{inputId:p}=Ps(e,{formItemContext:f}),{aliasProps:v,getLabel:_,getValue:b,getDisabled:S,getOptions:k}=YT(e),{valueOnClear:M,isEmptyValue:R}=PT(e),w=eo({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),E=le(-1),N=le(),F=le(),x=le(),P=le(),G=le(),H=le(),Y=le(),j=le(),W=le(),O=le(),{isComposing:Q,handleCompositionStart:J,handleCompositionEnd:oe,handleCompositionUpdate:pe}=cI({afterComposition:bt=>wt(bt)}),{wrapperRef:ie,isFocused:te,handleBlur:he}=ah(G,{beforeFocus(){return Ie.value},afterFocus(){e.automaticDropdown&&!ue.value&&(ue.value=!0,w.menuVisibleOnFocus=!0)},beforeBlur(bt){var Qt,hn;return((Qt=x.value)==null?void 0:Qt.isFocusInsideContent(bt))||((hn=P.value)==null?void 0:hn.isFocusInsideContent(bt))},afterBlur(){var bt;ue.value=!1,w.menuVisibleOnFocus=!1,e.validateEvent&&((bt=f==null?void 0:f.validate)==null||bt.call(f,"blur").catch(Qt=>void 0))}}),re=z(()=>_e("")),X=z(()=>e.loading?!1:e.options.length>0||w.createdOptions.length>0),ye=le([]),ue=le(!1),Ie=z(()=>e.disabled||(u==null?void 0:u.disabled)),ve=z(()=>{var bt;return(bt=u==null?void 0:u.statusIcon)!=null?bt:!1}),Ce=z(()=>{const bt=ye.value.length*e.itemHeight;return bt>e.height?e.height:bt}),Fe=z(()=>e.multiple?ht(e.modelValue)&&e.modelValue.length>0:!R(e.modelValue)),Oe=z(()=>e.clearable&&!Ie.value&&w.inputHovering&&Fe.value),be=z(()=>e.remote&&e.filterable?"":e.suffixIcon),xe=z(()=>be.value&&i.is("reverse",ue.value)),Le=z(()=>(f==null?void 0:f.validateState)||""),rt=z(()=>{if(Le.value)return VT[Le.value]}),Qe=z(()=>e.remote?300:0),Ge=z(()=>e.loading?e.loadingText||o("el.select.loading"):e.remote&&!w.inputValue&&!X.value?!1:e.filterable&&w.inputValue&&X.value&&ye.value.length===0?e.noMatchText||o("el.select.noMatch"):X.value?null:e.noDataText||o("el.select.noData")),_e=bt=>{const Qt=new RegExp(MN(bt),"i"),hn=e.filterable&&zt(e.filterMethod),Yn=e.filterable&&e.remote&&zt(e.remoteMethod),fr=Wr=>hn||Yn?!0:bt?Qt.test(_(Wr)||""):!0;return e.loading?[]:[...w.createdOptions,...e.options].reduce((Wr,Ar)=>{const xs=k(Ar);if(ht(xs)){const _n=xs.filter(fr);_n.length>0&&Wr.push({label:_(Ar),type:"Group"},..._n)}else(e.remote||fr(Ar))&&Wr.push(Ar);return Wr},[])},Re=()=>{ye.value=_e(w.inputValue)},Ke=z(()=>{const bt=new Map;return re.value.forEach((Qt,hn)=>{bt.set(K(b(Qt)),{option:Qt,index:hn})}),bt}),je=z(()=>{const bt=new Map;return ye.value.forEach((Qt,hn)=>{bt.set(K(b(Qt)),{option:Qt,index:hn})}),bt}),ze=z(()=>ye.value.every(bt=>S(bt))),nt=Fr(),it=z(()=>nt.value==="small"?"small":"default"),dt=()=>{var bt;if(jt(e.fitInputWidth)){E.value=e.fitInputWidth;return}const Qt=((bt=N.value)==null?void 0:bt.offsetWidth)||200;!e.fitInputWidth&&X.value?Vt(()=>{E.value=Math.max(Qt,gt())}):E.value=Qt},gt=()=>{var bt,Qt;const Yn=document.createElement("canvas").getContext("2d"),fr=i.be("dropdown","item"),Ar=(((Qt=(bt=j.value)==null?void 0:bt.listRef)==null?void 0:Qt.innerRef)||document).querySelector(`.${fr}`);if(Ar===null||Yn===null)return 0;const xs=getComputedStyle(Ar),_n=Number.parseFloat(xs.paddingLeft)+Number.parseFloat(xs.paddingRight);return Yn.font=`bold ${xs.font.replace(new RegExp(`\\b${xs.fontWeight}\\b`),"")}`,ye.value.reduce((Us,ch)=>{const is=Yn.measureText(_(ch));return Math.max(is.width,Us)},0)+_n},ft=()=>{if(!F.value)return 0;const bt=window.getComputedStyle(F.value);return Number.parseFloat(bt.gap||"6px")},Mt=z(()=>{const bt=ft();return{maxWidth:`${O.value&&e.maxCollapseTags===1?w.selectionWidth-w.collapseItemWidth-bt:w.selectionWidth}px`}}),lt=z(()=>({maxWidth:`${w.selectionWidth}px`})),Et=z(()=>ht(e.modelValue)?e.modelValue.length===0&&!w.inputValue:e.filterable?!w.inputValue:!0),Yt=z(()=>{var bt;const Qt=(bt=e.placeholder)!=null?bt:o("el.select.placeholder");return e.multiple||!Fe.value?Qt:w.selectedLabel}),sn=z(()=>{var bt,Qt;return(Qt=(bt=x.value)==null?void 0:bt.popperRef)==null?void 0:Qt.contentRef}),dn=z(()=>{if(e.multiple){const bt=e.modelValue.length;if(e.modelValue.length>0&&je.value.has(e.modelValue[bt-1])){const{index:Qt}=je.value.get(e.modelValue[bt-1]);return Qt}}else if(!R(e.modelValue)&&je.value.has(e.modelValue)){const{index:bt}=je.value.get(e.modelValue);return bt}return-1}),Sn=z({get(){return ue.value&&Ge.value!==!1},set(bt){ue.value=bt}}),yn=z(()=>e.multiple?e.collapseTags?w.cachedOptions.slice(0,e.maxCollapseTags):w.cachedOptions:[]),fo=z(()=>e.multiple?e.collapseTags?w.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Xt,removeNewOption:vn,selectNewOption:Ne,clearAllNewOption:qe}=rDe(e,w),ke=()=>{Ie.value||(w.menuVisibleOnFocus?w.menuVisibleOnFocus=!1:ue.value=!ue.value)},ot=()=>{w.inputValue.length>0&&!ue.value&&(ue.value=!0),Xt(w.inputValue),Nt(w.inputValue)},tn=Oa(ot,Qe.value),Nt=bt=>{w.previousQuery===bt||Q.value||(w.previousQuery=bt,e.filterable&&zt(e.filterMethod)?e.filterMethod(bt):e.filterable&&e.remote&&zt(e.remoteMethod)&&e.remoteMethod(bt),e.defaultFirstOption&&(e.filterable||e.remote)&&ye.value.length?Vt(Dn):Vt(On))},Dn=()=>{const bt=ye.value.filter(Yn=>!Yn.disabled&&Yn.type!=="Group"),Qt=bt.find(Yn=>Yn.created),hn=bt[0];w.hoveringIndex=hr(ye.value,Qt||hn)},dr=bt=>{ui(e.modelValue,bt)||t(wn,bt)},io=bt=>{t(nn,bt),dr(bt),w.previousValue=e.multiple?String(bt):bt,Vt(()=>{if(e.multiple&&ht(e.modelValue)){const Qt=e.modelValue.map(hn=>Na(hn));ui(w.cachedOptions,Qt)||(w.cachedOptions=Qt)}else ei(!0)})},hr=(bt=[],Qt)=>{if(!gn(Qt))return bt.indexOf(Qt);const hn=e.valueKey;let Yn=-1;return bt.some((fr,Wr)=>Rr(fr,hn)===Rr(Qt,hn)?(Yn=Wr,!0):!1),Yn},K=bt=>gn(bt)?Rr(bt,e.valueKey):bt,ri=()=>{dt()},Gt=()=>{w.selectionWidth=F.value.getBoundingClientRect().width},Ho=()=>{w.collapseItemWidth=O.value.getBoundingClientRect().width},jo=()=>{var bt,Qt;(Qt=(bt=x.value)==null?void 0:bt.updatePopper)==null||Qt.call(bt)},xi=()=>{var bt,Qt;(Qt=(bt=P.value)==null?void 0:bt.updatePopper)==null||Qt.call(bt)},Vr=bt=>{if(e.multiple){let Qt=e.modelValue.slice();const hn=hr(Qt,b(bt));hn>-1?(Qt=[...Qt.slice(0,hn),...Qt.slice(hn+1)],w.cachedOptions.splice(hn,1),vn(bt)):(e.multipleLimit<=0||Qt.length<e.multipleLimit)&&(Qt=[...Qt,b(bt)],w.cachedOptions.push(bt),Ne(bt)),io(Qt),bt.created&&Nt(""),e.filterable&&!e.reserveKeyword&&(w.inputValue="")}else w.selectedLabel=_(bt),io(b(bt)),ue.value=!1,Ne(bt),bt.created||qe();ii()},Ui=(bt,Qt)=>{let hn=e.modelValue.slice();const Yn=hr(hn,b(Qt));Yn>-1&&!Ie.value&&(hn=[...e.modelValue.slice(0,Yn),...e.modelValue.slice(Yn+1)],w.cachedOptions.splice(Yn,1),io(hn),t("remove-tag",b(Qt)),vn(Qt)),bt.stopPropagation(),ii()},ii=()=>{var bt;(bt=G.value)==null||bt.focus()},ha=()=>{var bt;if(ue.value){ue.value=!1,Vt(()=>{var Qt;return(Qt=G.value)==null?void 0:Qt.blur()});return}(bt=G.value)==null||bt.blur()},gl=()=>{w.inputValue.length>0?w.inputValue="":ue.value=!1},Tt=bt=>Pq(bt,Qt=>!w.cachedOptions.some(hn=>b(hn)===Qt&&S(hn))),sc=bt=>{if(e.multiple&&bt.code!==At.delete&&w.inputValue.length===0){bt.preventDefault();const Qt=e.modelValue.slice(),hn=Tt(Qt);if(hn<0)return;const Yn=Qt[hn];Qt.splice(hn,1);const fr=w.cachedOptions[hn];w.cachedOptions.splice(hn,1),vn(fr),io(Qt),t("remove-tag",Yn)}},lh=()=>{let bt;ht(e.modelValue)?bt=[]:bt=M.value,w.selectedLabel="",ue.value=!1,io(bt),t("clear"),qe(),ii()},_t=(bt,Qt=void 0)=>{const hn=ye.value;if(!["forward","backward"].includes(bt)||Ie.value||hn.length<=0||ze.value||Q.value)return;if(!ue.value)return ke();qn(Qt)&&(Qt=w.hoveringIndex);let Yn=-1;bt==="forward"?(Yn=Qt+1,Yn>=hn.length&&(Yn=0)):bt==="backward"&&(Yn=Qt-1,(Yn<0||Yn>=hn.length)&&(Yn=hn.length-1));const fr=hn[Yn];if(S(fr)||fr.type==="Group")return _t(bt,Yn);w.hoveringIndex=Yn,La(Yn)},It=()=>{if(ue.value)~w.hoveringIndex&&ye.value[w.hoveringIndex]&&Vr(ye.value[w.hoveringIndex]);else return ke()},Vn=bt=>{w.hoveringIndex=bt??-1},On=()=>{e.multiple?w.hoveringIndex=ye.value.findIndex(bt=>e.modelValue.some(Qt=>K(Qt)===K(bt))):w.hoveringIndex=ye.value.findIndex(bt=>K(bt)===K(e.modelValue))},wt=bt=>{if(w.inputValue=bt.target.value,e.remote)tn();else return ot()},zr=bt=>{if(ue.value=!1,te.value){const Qt=new FocusEvent("focus",bt);he(Qt)}},No=()=>(w.isBeforeHide=!1,Vt(()=>{~dn.value&&La(w.hoveringIndex)})),La=bt=>{j.value.scrollToItem(bt)},Na=(bt,Qt)=>{const hn=K(bt);if(Ke.value.has(hn)){const{option:Yn}=Ke.value.get(hn);return Yn}if(Qt&&Qt.length){const Yn=Qt.find(fr=>K(b(fr))===hn);if(Yn)return Yn}return{[v.value.value]:bt,[v.value.label]:bt}},ei=(bt=!1)=>{if(e.multiple)if(e.modelValue.length>0){const Qt=w.cachedOptions.slice();w.cachedOptions.length=0,w.previousValue=e.modelValue.toString();for(const hn of e.modelValue){const Yn=Na(hn,Qt);w.cachedOptions.push(Yn)}}else w.cachedOptions=[],w.previousValue=void 0;else if(Fe.value){w.previousValue=e.modelValue;const Qt=ye.value,hn=Qt.findIndex(Yn=>K(b(Yn))===K(e.modelValue));~hn?w.selectedLabel=_(Qt[hn]):(!w.selectedLabel||bt)&&(w.selectedLabel=K(e.modelValue))}else w.selectedLabel="",w.previousValue=void 0;qe(),dt()};return st(()=>e.fitInputWidth,()=>{dt()}),st(ue,bt=>{bt?(e.persistent||dt(),Nt("")):(w.inputValue="",w.previousQuery=null,w.isBeforeHide=!0,Xt("")),t("visible-change",bt)}),st(()=>e.modelValue,(bt,Qt)=>{var hn;(!bt||ht(bt)&&bt.length===0||e.multiple&&!ui(bt.toString(),w.previousValue)||!e.multiple&&K(bt)!==K(w.previousValue))&&ei(!0),!ui(bt,Qt)&&e.validateEvent&&((hn=f==null?void 0:f.validate)==null||hn.call(f,"change").catch(fr=>void 0))},{deep:!0}),st(()=>e.options,()=>{const bt=G.value;(!bt||bt&&document.activeElement!==bt)&&ei()},{deep:!0,flush:"post"}),st(()=>ye.value,()=>(dt(),j.value&&Vt(j.value.resetScrollTop))),Di(()=>{w.isBeforeHide||Re()}),Di(()=>{const{valueKey:bt,options:Qt}=e,hn=new Map;for(const Yn of Qt){const fr=b(Yn);let Wr=fr;if(gn(Wr)&&(Wr=Rr(fr,bt)),hn.get(Wr))break;hn.set(Wr,!0)}}),mn(()=>{ei()}),ar(N,ri),ar(F,Gt),ar(j,jo),ar(ie,jo),ar(W,xi),ar(O,Ho),{inputId:p,collapseTagSize:it,currentPlaceholder:Yt,expanded:ue,emptyText:Ge,popupHeight:Ce,debounce:Qe,allOptions:re,filteredOptions:ye,iconComponent:be,iconReverse:xe,tagStyle:Mt,collapseTagStyle:lt,popperSize:E,dropdownMenuVisible:Sn,hasModelValue:Fe,shouldShowPlaceholder:Et,selectDisabled:Ie,selectSize:nt,needStatusIcon:ve,showClearBtn:Oe,states:w,isFocused:te,nsSelect:i,nsInput:c,inputRef:G,menuRef:j,tagMenuRef:W,tooltipRef:x,tagTooltipRef:P,selectRef:N,wrapperRef:ie,selectionRef:F,prefixRef:H,suffixRef:Y,collapseItemRef:O,popperRef:sn,validateState:Le,validateIcon:rt,showTagList:yn,collapseTagList:fo,debouncedOnInputChange:tn,deleteTag:Ui,getLabel:_,getValue:b,getDisabled:S,getValueKey:K,handleClear:lh,handleClickOutside:zr,handleDel:sc,handleEsc:gl,focus:ii,blur:ha,handleMenuEnter:No,handleResize:ri,resetSelectionWidth:Gt,updateTooltip:jo,updateTagTooltip:xi,updateOptions:Re,toggleMenu:ke,scrollTo:La,onInput:wt,onKeyboardNavigate:_t,onKeyboardSelect:It,onSelect:Vr,onHover:Vn,handleCompositionStart:J,handleCompositionEnd:oe,handleCompositionUpdate:pe}},aDe=Te({name:"ElSelectV2",components:{ElSelectMenu:oDe,ElTag:Zg,ElTooltip:Li,ElIcon:Pt},directives:{ClickOutside:lu},props:xAe,emits:FAe,setup(e,{emit:t}){const o=z(()=>{const{modelValue:p,multiple:v}=e,_=v?[]:void 0;return ht(p)?v?p:_:v?_:p}),i=iDe(eo({...hi(e),modelValue:o}),t),{calculatorRef:c,inputStyle:u}=HN();Nn(zN,{props:eo({...hi(e),height:i.popupHeight,modelValue:o}),expanded:i.expanded,tooltipRef:i.tooltipRef,onSelect:i.onSelect,onHover:i.onHover,onKeyboardNavigate:i.onKeyboardNavigate,onKeyboardSelect:i.onKeyboardSelect});const f=z(()=>e.multiple?i.states.cachedOptions.map(p=>p.label):i.states.selectedLabel);return{...i,modelValue:o,selectedLabel:f,calculatorRef:c,inputStyle:u}}});function sDe(e,t,o,i,c,u){const f=Cn("el-tag"),p=Cn("el-tooltip"),v=Cn("el-icon"),_=Cn("el-select-menu"),b=_T("click-outside");return fn((ee(),ge("div",{ref:"selectRef",class:ne([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:S=>e.states.inputHovering=!0,onMouseleave:S=>e.states.inputHovering=!1},[Me(p,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:S=>e.states.isBeforeHide=!1},{default:Ae(()=>[Ee("div",{ref:"wrapperRef",class:ne([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Zt(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ee(),ge("div",{key:0,ref:"prefixRef",class:ne(e.nsSelect.e("prefix"))},[Ve(e.$slots,"prefix")],2)):$e("v-if",!0),Ee("div",{ref:"selectionRef",class:ne([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?Ve(e.$slots,"tag",{key:0},()=>[(ee(!0),ge(Ht,null,Un(e.showTagList,S=>(ee(),ge("div",{key:e.getValueKey(e.getValue(S)),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!e.selectDisabled&&!e.getDisabled(S),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:qt(e.tagStyle),onClose:k=>e.deleteTag(k,S)},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))},[Ve(e.$slots,"label",{label:e.getLabel(S),value:e.getValue(S)},()=>[Mn(mt(e.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(ee(),We(p,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:Ae(()=>[Ee("div",{ref:"collapseItemRef",class:ne(e.nsSelect.e("selected-item"))},[Me(f,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:qt(e.collapseTagStyle),"disable-transitions":""},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))}," + "+mt(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:Ae(()=>[Ee("div",{ref:"tagMenuRef",class:ne(e.nsSelect.e("selection"))},[(ee(!0),ge(Ht,null,Un(e.collapseTagList,S=>(ee(),ge("div",{key:e.getValueKey(e.getValue(S)),class:ne(e.nsSelect.e("selected-item"))},[Me(f,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(S),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:k=>e.deleteTag(k,S)},{default:Ae(()=>[Ee("span",{class:ne(e.nsSelect.e("tags-text"))},[Ve(e.$slots,"label",{label:e.getLabel(S),value:e.getValue(S)},()=>[Mn(mt(e.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):$e("v-if",!0)]):$e("v-if",!0),Ee("div",{class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[fn(Ee("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":S=>e.states.inputValue=S,style:qt(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:ne([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[To(Zt(S=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),To(Zt(S=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),To(Zt(e.onKeyboardSelect,["stop","prevent"]),["enter"]),To(Zt(e.handleEsc,["stop","prevent"]),["esc"]),To(Zt(e.handleDel,["stop"]),["delete"])],onClick:Zt(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[ET,e.states.inputValue]]),e.filterable?(ee(),ge("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ne(e.nsSelect.e("input-calculator")),textContent:mt(e.states.inputValue)},null,10,["textContent"])):$e("v-if",!0)],2),e.shouldShowPlaceholder?(ee(),ge("div",{key:1,class:ne([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?Ve(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ee("span",null,mt(e.currentPlaceholder),1)]):(ee(),ge("span",{key:1},mt(e.currentPlaceholder),1))],2)):$e("v-if",!0)],2),Ee("div",{ref:"suffixRef",class:ne(e.nsSelect.e("suffix"))},[e.iconComponent?fn((ee(),We(v,{key:0,class:ne([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:Ae(()=>[(ee(),We(Tn(e.iconComponent)))]),_:1},8,["class"])),[[Zn,!e.showClearBtn]]):$e("v-if",!0),e.showClearBtn&&e.clearIcon?(ee(),We(v,{key:1,class:ne([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:Zt(e.handleClear,["prevent","stop"])},{default:Ae(()=>[(ee(),We(Tn(e.clearIcon)))]),_:1},8,["class","onClick"])):$e("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ee(),We(v,{key:2,class:ne([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:Ae(()=>[(ee(),We(Tn(e.validateIcon)))]),_:1},8,["class"])):$e("v-if",!0)],2)],10,["onClick"])]),content:Ae(()=>[Me(_,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},rs({default:Ae(S=>[Ve(e.$slots,"default",Za(Zl(S)))]),_:2},[e.$slots.header?{name:"header",fn:Ae(()=>[Ee("div",{class:ne(e.nsSelect.be("dropdown","header"))},[Ve(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:Ae(()=>[Ee("div",{class:ne(e.nsSelect.be("dropdown","loading"))},[Ve(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:Ae(()=>[Ee("div",{class:ne(e.nsSelect.be("dropdown","empty"))},[Ve(e.$slots,"empty",{},()=>[Ee("span",null,mt(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:Ae(()=>[Ee("div",{class:ne(e.nsSelect.be("dropdown","footer"))},[Ve(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[b,e.handleClickOutside,e.popperRef]])}var lDe=vt(aDe,[["render",sDe],["__file","select.vue"]]);const cDe=un(lDe),uDe=pt({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Ue([Number,Object])}}),dDe=pt({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),hDe=Te({name:"ElSkeletonItem"}),fDe=Te({...hDe,props:dDe,setup(e){const t=ut("skeleton");return(o,i)=>(ee(),ge("div",{class:ne([y(t).e("item"),y(t).e(o.variant)])},[o.variant==="image"?(ee(),We(y($_e),{key:0})):$e("v-if",!0)],2))}});var rT=vt(fDe,[["__file","skeleton-item.vue"]]);const pDe=(e,t=0)=>{if(t===0)return e;const o=gn(t)&&!!t.initVal,i=le(o);let c=null;const u=p=>{if(qn(p)){i.value=e.value;return}c&&clearTimeout(c),c=setTimeout(()=>{i.value=e.value},p)},f=p=>{p==="leading"?jt(t)?u(t):u(t.leading):gn(t)?u(t.trailing):i.value=!1};return mn(()=>f("leading")),st(()=>e.value,p=>{f(p?"leading":"trailing")}),i},mDe=Te({name:"ElSkeleton"}),gDe=Te({...mDe,props:uDe,setup(e,{expose:t}){const o=e,i=ut("skeleton"),c=pDe(uo(o,"loading"),o.throttle);return t({uiLoading:c}),(u,f)=>y(c)?(ee(),ge("div",An({key:0,class:[y(i).b(),y(i).is("animated",u.animated)]},u.$attrs),[(ee(!0),ge(Ht,null,Un(u.count,p=>(ee(),ge(Ht,{key:p},[y(c)?Ve(u.$slots,"template",{key:p},()=>[Me(rT,{class:ne(y(i).is("first")),variant:"p"},null,8,["class"]),(ee(!0),ge(Ht,null,Un(u.rows,v=>(ee(),We(rT,{key:v,class:ne([y(i).e("paragraph"),y(i).is("last",v===u.rows&&u.rows>1)]),variant:"p"},null,8,["class"]))),128))]):$e("v-if",!0)],64))),128))],16)):Ve(u.$slots,"default",Za(An({key:1},u.$attrs)))}});var vDe=vt(gDe,[["__file","skeleton.vue"]]);const _De=un(vDe,{SkeletonItem:rT}),yDe=lr(rT),Rz=Symbol("sliderContextKey"),IDe=pt({modelValue:{type:Ue([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Kr,inputSize:Kr,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:Ue(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:Ue(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:mu,default:"top"},marks:{type:Ue(Object)},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Ci(["ariaLabel"])}),lD=e=>jt(e)||ht(e)&&e.every(jt),bDe={[nn]:lD,[Jr]:lD,[wn]:lD},CDe=pt({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:mu,default:"top"}}),SDe={[nn]:e=>jt(e)},EDe=(e,t,o)=>{const i=le(),c=le(!1),u=z(()=>t.value instanceof Function),f=z(()=>u.value&&t.value(e.modelValue)||e.modelValue),p=Oa(()=>{o.value&&(c.value=!0)},50),v=Oa(()=>{o.value&&(c.value=!1)},50);return{tooltip:i,tooltipVisible:c,formatValue:f,displayTooltip:p,hideTooltip:v}},TDe=(e,t,o)=>{const{disabled:i,min:c,max:u,step:f,showTooltip:p,persistent:v,precision:_,sliderSize:b,formatTooltip:S,emitChange:k,resetSize:M,updateDragging:R}=Rt(Rz),{tooltip:w,tooltipVisible:E,formatValue:N,displayTooltip:F,hideTooltip:x}=EDe(e,S,p),P=le(),G=z(()=>`${(e.modelValue-c.value)/(u.value-c.value)*100}%`),H=z(()=>e.vertical?{bottom:G.value}:{left:G.value}),Y=()=>{t.hovering=!0,F()},j=()=>{t.hovering=!1,t.dragging||x()},W=ve=>{i.value||(ve.preventDefault(),X(ve),window.addEventListener("mousemove",ye),window.addEventListener("touchmove",ye),window.addEventListener("mouseup",ue),window.addEventListener("touchend",ue),window.addEventListener("contextmenu",ue),P.value.focus())},O=ve=>{i.value||(t.newPosition=Number.parseFloat(G.value)+ve/(u.value-c.value)*100,Ie(t.newPosition),k())},Q=()=>{O(-f.value)},J=()=>{O(f.value)},oe=()=>{O(-f.value*4)},pe=()=>{O(f.value*4)},ie=()=>{i.value||(Ie(0),k())},te=()=>{i.value||(Ie(100),k())},he=ve=>{let Ce=!0;switch(ve.code){case At.left:case At.down:Q();break;case At.right:case At.up:J();break;case At.home:ie();break;case At.end:te();break;case At.pageDown:oe();break;case At.pageUp:pe();break;default:Ce=!1;break}Ce&&ve.preventDefault()},re=ve=>{let Ce,Fe;return ve.type.startsWith("touch")?(Fe=ve.touches[0].clientY,Ce=ve.touches[0].clientX):(Fe=ve.clientY,Ce=ve.clientX),{clientX:Ce,clientY:Fe}},X=ve=>{t.dragging=!0,t.isClick=!0;const{clientX:Ce,clientY:Fe}=re(ve);e.vertical?t.startY=Fe:t.startX=Ce,t.startPosition=Number.parseFloat(G.value),t.newPosition=t.startPosition},ye=ve=>{if(t.dragging){t.isClick=!1,F(),M();let Ce;const{clientX:Fe,clientY:Oe}=re(ve);e.vertical?(t.currentY=Oe,Ce=(t.startY-t.currentY)/b.value*100):(t.currentX=Fe,Ce=(t.currentX-t.startX)/b.value*100),t.newPosition=t.startPosition+Ce,Ie(t.newPosition)}},ue=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||x(),t.isClick||Ie(t.newPosition),k()},0),window.removeEventListener("mousemove",ye),window.removeEventListener("touchmove",ye),window.removeEventListener("mouseup",ue),window.removeEventListener("touchend",ue),window.removeEventListener("contextmenu",ue))},Ie=async ve=>{if(ve===null||Number.isNaN(+ve))return;ve<0?ve=0:ve>100&&(ve=100);const Ce=100/((u.value-c.value)/f.value);let Oe=Math.round(ve/Ce)*Ce*(u.value-c.value)*.01+c.value;Oe=Number.parseFloat(Oe.toFixed(_.value)),Oe!==e.modelValue&&o(nn,Oe),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await Vt(),t.dragging&&F(),w.value.updatePopper()};return st(()=>t.dragging,ve=>{R(ve)}),_o(P,"touchstart",W,{passive:!1}),{disabled:i,button:P,tooltip:w,tooltipVisible:E,showTooltip:p,persistent:v,wrapperStyle:H,formatValue:N,handleMouseEnter:Y,handleMouseLeave:j,onButtonDown:W,onKeyDown:he,setPosition:Ie}},MDe=Te({name:"ElSliderButton"}),kDe=Te({...MDe,props:CDe,emits:SDe,setup(e,{expose:t,emit:o}){const i=e,c=ut("slider"),u=eo({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:i.modelValue}),f=z(()=>b.value?S.value:!1),{disabled:p,button:v,tooltip:_,showTooltip:b,persistent:S,tooltipVisible:k,wrapperStyle:M,formatValue:R,handleMouseEnter:w,handleMouseLeave:E,onButtonDown:N,onKeyDown:F,setPosition:x}=TDe(i,u,o),{hovering:P,dragging:G}=hi(u);return t({onButtonDown:N,onKeyDown:F,setPosition:x,hovering:P,dragging:G}),(H,Y)=>(ee(),ge("div",{ref_key:"button",ref:v,class:ne([y(c).e("button-wrapper"),{hover:y(P),dragging:y(G)}]),style:qt(y(M)),tabindex:y(p)?-1:0,onMouseenter:y(w),onMouseleave:y(E),onMousedown:y(N),onFocus:y(w),onBlur:y(E),onKeydown:y(F)},[Me(y(Li),{ref_key:"tooltip",ref:_,visible:y(k),placement:H.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":H.tooltipClass,disabled:!y(b),persistent:y(f)},{content:Ae(()=>[Ee("span",null,mt(y(R)),1)]),default:Ae(()=>[Ee("div",{class:ne([y(c).e("button"),{hover:y(P),dragging:y(G)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var zB=vt(kDe,[["__file","button.vue"]]);const wDe=pt({mark:{type:Ue([String,Object]),default:void 0}});var RDe=Te({name:"ElSliderMarker",props:wDe,setup(e){const t=ut("slider"),o=z(()=>Ut(e.mark)?e.mark:e.mark.label),i=z(()=>Ut(e.mark)?void 0:e.mark.style);return()=>Jt("div",{class:t.e("marks-text"),style:i.value},o.value)}});const ADe=(e,t,o)=>{const{form:i,formItem:c}=Ni(),u=Go(),f=le(),p=le(),v={firstButton:f,secondButton:p},_=z(()=>e.disabled||(i==null?void 0:i.disabled)||!1),b=z(()=>Math.min(t.firstValue,t.secondValue)),S=z(()=>Math.max(t.firstValue,t.secondValue)),k=z(()=>e.range?`${100*(S.value-b.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),M=z(()=>e.range?`${100*(b.value-e.min)/(e.max-e.min)}%`:"0%"),R=z(()=>e.vertical?{height:e.height}:{}),w=z(()=>e.vertical?{height:k.value,bottom:M.value}:{width:k.value,left:M.value}),E=()=>{u.value&&(t.sliderSize=u.value[`client${e.vertical?"Height":"Width"}`])},N=J=>{const oe=e.min+J*(e.max-e.min)/100;if(!e.range)return f;let pe;return Math.abs(b.value-oe)<Math.abs(S.value-oe)?pe=t.firstValue<t.secondValue?"firstButton":"secondButton":pe=t.firstValue>t.secondValue?"firstButton":"secondButton",v[pe]},F=J=>{const oe=N(J);return oe.value.setPosition(J),oe},x=J=>{t.firstValue=J??e.min,G(e.range?[b.value,S.value]:J??e.min)},P=J=>{t.secondValue=J,e.range&&G([b.value,S.value])},G=J=>{o(nn,J),o(Jr,J)},H=async()=>{await Vt(),o(wn,e.range?[b.value,S.value]:e.modelValue)},Y=J=>{var oe,pe,ie,te,he,re;if(_.value||t.dragging)return;E();let X=0;if(e.vertical){const ye=(ie=(pe=(oe=J.touches)==null?void 0:oe.item(0))==null?void 0:pe.clientY)!=null?ie:J.clientY;X=(u.value.getBoundingClientRect().bottom-ye)/t.sliderSize*100}else{const ye=(re=(he=(te=J.touches)==null?void 0:te.item(0))==null?void 0:he.clientX)!=null?re:J.clientX,ue=u.value.getBoundingClientRect().left;X=(ye-ue)/t.sliderSize*100}if(!(X<0||X>100))return F(X)};return{elFormItem:c,slider:u,firstButton:f,secondButton:p,sliderDisabled:_,minValue:b,maxValue:S,runwayStyle:R,barStyle:w,resetSize:E,setPosition:F,emitChange:H,onSliderWrapperPrevent:J=>{var oe,pe;((oe=v.firstButton.value)!=null&&oe.dragging||(pe=v.secondButton.value)!=null&&pe.dragging)&&J.preventDefault()},onSliderClick:J=>{Y(J)&&H()},onSliderDown:async J=>{const oe=Y(J);oe&&(await Vt(),oe.value.onButtonDown(J))},onSliderMarkerDown:J=>{if(_.value||t.dragging)return;F(J)&&H()},setFirstValue:x,setSecondValue:P}},DDe=(e,t,o,i)=>({stops:z(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const f=(e.max-e.min)/e.step,p=100*e.step/(e.max-e.min),v=Array.from({length:f-1}).map((_,b)=>(b+1)*p);return e.range?v.filter(_=>_<100*(o.value-e.min)/(e.max-e.min)||_>100*(i.value-e.min)/(e.max-e.min)):v.filter(_=>_>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:f=>e.vertical?{bottom:`${f}%`}:{left:`${f}%`}}),ODe=e=>z(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((o,i)=>o-i).filter(o=>o<=e.max&&o>=e.min).map(o=>({point:o,position:(o-e.min)*100/(e.max-e.min),mark:e.marks[o]})):[]),LDe=(e,t,o,i,c,u)=>{const f=_=>{c(nn,_),c(Jr,_)},p=()=>e.range?![o.value,i.value].every((_,b)=>_===t.oldValue[b]):e.modelValue!==t.oldValue,v=()=>{var _,b;e.min>e.max&&qr("Slider","min should not be greater than max.");const S=e.modelValue;e.range&&ht(S)?S[1]<e.min?f([e.min,e.min]):S[0]>e.max?f([e.max,e.max]):S[0]<e.min?f([e.min,S[1]]):S[1]>e.max?f([S[0],e.max]):(t.firstValue=S[0],t.secondValue=S[1],p()&&(e.validateEvent&&((_=u==null?void 0:u.validate)==null||_.call(u,"change").catch(k=>void 0)),t.oldValue=S.slice())):!e.range&&jt(S)&&!Number.isNaN(S)&&(S<e.min?f(e.min):S>e.max?f(e.max):(t.firstValue=S,p()&&(e.validateEvent&&((b=u==null?void 0:u.validate)==null||b.call(u,"change").catch(k=>void 0)),t.oldValue=S)))};v(),st(()=>t.dragging,_=>{_||v()}),st(()=>e.modelValue,(_,b)=>{t.dragging||ht(_)&&ht(b)&&_.every((S,k)=>S===b[k])&&t.firstValue===_[0]&&t.secondValue===_[1]||v()},{deep:!0}),st(()=>[e.min,e.max],()=>{v()})},NDe=(e,t,o)=>{const i=le();return mn(async()=>{e.range?(ht(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!jt(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),_o(window,"resize",o),await Vt(),o()}),{sliderWrapper:i}},PDe=Te({name:"ElSlider"}),xDe=Te({...PDe,props:IDe,emits:bDe,setup(e,{expose:t,emit:o}){const i=e,c=ut("slider"),{t:u}=Kn(),f=eo({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:p,slider:v,firstButton:_,secondButton:b,sliderDisabled:S,minValue:k,maxValue:M,runwayStyle:R,barStyle:w,resetSize:E,emitChange:N,onSliderWrapperPrevent:F,onSliderClick:x,onSliderDown:P,onSliderMarkerDown:G,setFirstValue:H,setSecondValue:Y}=ADe(i,f,o),{stops:j,getStopStyle:W}=DDe(i,f,k,M),{inputId:O,isLabeledByFormItem:Q}=Ps(i,{formItemContext:p}),J=Fr(),oe=z(()=>i.inputSize||J.value),pe=z(()=>i.ariaLabel||u("el.slider.defaultLabel",{min:i.min,max:i.max})),ie=z(()=>i.range?i.rangeStartLabel||u("el.slider.defaultRangeStartLabel"):pe.value),te=z(()=>i.formatValueText?i.formatValueText(ve.value):`${ve.value}`),he=z(()=>i.rangeEndLabel||u("el.slider.defaultRangeEndLabel")),re=z(()=>i.formatValueText?i.formatValueText(Ce.value):`${Ce.value}`),X=z(()=>[c.b(),c.m(J.value),c.is("vertical",i.vertical),{[c.m("with-input")]:i.showInput}]),ye=ODe(i);LDe(i,f,k,M,o,p);const ue=z(()=>{const be=[i.min,i.max,i.step].map(xe=>{const Le=`${xe}`.split(".")[1];return Le?Le.length:0});return Math.max.apply(null,be)}),{sliderWrapper:Ie}=NDe(i,f,E),{firstValue:ve,secondValue:Ce,sliderSize:Fe}=hi(f),Oe=be=>{f.dragging=be};return _o(Ie,"touchstart",F,{passive:!1}),_o(Ie,"touchmove",F,{passive:!1}),Nn(Rz,{...hi(i),sliderSize:Fe,disabled:S,precision:ue,emitChange:N,resetSize:E,updateDragging:Oe}),t({onSliderClick:x}),(be,xe)=>{var Le,rt;return ee(),ge("div",{id:be.range?y(O):void 0,ref_key:"sliderWrapper",ref:Ie,class:ne(y(X)),role:be.range?"group":void 0,"aria-label":be.range&&!y(Q)?y(pe):void 0,"aria-labelledby":be.range&&y(Q)?(Le=y(p))==null?void 0:Le.labelId:void 0},[Ee("div",{ref_key:"slider",ref:v,class:ne([y(c).e("runway"),{"show-input":be.showInput&&!be.range},y(c).is("disabled",y(S))]),style:qt(y(R)),onMousedown:y(P),onTouchstartPassive:y(P)},[Ee("div",{class:ne(y(c).e("bar")),style:qt(y(w))},null,6),Me(zB,{id:be.range?void 0:y(O),ref_key:"firstButton",ref:_,"model-value":y(ve),vertical:be.vertical,"tooltip-class":be.tooltipClass,placement:be.placement,role:"slider","aria-label":be.range||!y(Q)?y(ie):void 0,"aria-labelledby":!be.range&&y(Q)?(rt=y(p))==null?void 0:rt.labelId:void 0,"aria-valuemin":be.min,"aria-valuemax":be.range?y(Ce):be.max,"aria-valuenow":y(ve),"aria-valuetext":y(te),"aria-orientation":be.vertical?"vertical":"horizontal","aria-disabled":y(S),"onUpdate:modelValue":y(H)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),be.range?(ee(),We(zB,{key:0,ref_key:"secondButton",ref:b,"model-value":y(Ce),vertical:be.vertical,"tooltip-class":be.tooltipClass,placement:be.placement,role:"slider","aria-label":y(he),"aria-valuemin":y(ve),"aria-valuemax":be.max,"aria-valuenow":y(Ce),"aria-valuetext":y(re),"aria-orientation":be.vertical?"vertical":"horizontal","aria-disabled":y(S),"onUpdate:modelValue":y(Y)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):$e("v-if",!0),be.showStops?(ee(),ge("div",{key:1},[(ee(!0),ge(Ht,null,Un(y(j),(Qe,Ge)=>(ee(),ge("div",{key:Ge,class:ne(y(c).e("stop")),style:qt(y(W)(Qe))},null,6))),128))])):$e("v-if",!0),y(ye).length>0?(ee(),ge(Ht,{key:2},[Ee("div",null,[(ee(!0),ge(Ht,null,Un(y(ye),(Qe,Ge)=>(ee(),ge("div",{key:Ge,style:qt(y(W)(Qe.position)),class:ne([y(c).e("stop"),y(c).e("marks-stop")])},null,6))),128))]),Ee("div",{class:ne(y(c).e("marks"))},[(ee(!0),ge(Ht,null,Un(y(ye),(Qe,Ge)=>(ee(),We(y(RDe),{key:Ge,mark:Qe.mark,style:qt(y(W)(Qe.position)),onMousedown:Zt(_e=>y(G)(Qe.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):$e("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),be.showInput&&!be.range?(ee(),We(y(lz),{key:0,ref:"input","model-value":y(ve),class:ne(y(c).e("input")),step:be.step,disabled:y(S),controls:be.showInputControls,min:be.min,max:be.max,precision:y(ue),debounce:be.debounce,size:y(oe),"onUpdate:modelValue":y(H),onChange:y(N)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):$e("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var UDe=vt(xDe,[["__file","slider.vue"]]);const FDe=un(UDe),VDe=pt({prefixCls:{type:String}}),WB=Te({name:"ElSpaceItem",props:VDe,setup(e,{slots:t}){const o=ut("space"),i=z(()=>`${e.prefixCls||o.b()}__item`);return()=>Jt("div",{class:i.value},Ve(t,"default"))}}),jB={small:8,default:12,large:16};function GDe(e){const t=ut("space"),o=z(()=>[t.b(),t.m(e.direction),e.class]),i=le(0),c=le(0),u=z(()=>{const p=e.wrap||e.fill?{flexWrap:"wrap"}:{},v={alignItems:e.alignment},_={rowGap:`${c.value}px`,columnGap:`${i.value}px`};return[p,v,_,e.style]}),f=z(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return Di(()=>{const{size:p="small",wrap:v,direction:_,fill:b}=e;if(ht(p)){const[S=0,k=0]=p;i.value=S,c.value=k}else{let S;jt(p)?S=p:S=jB[p||"small"]||jB.small,(v||b)&&_==="horizontal"?i.value=c.value=S:_==="horizontal"?(i.value=S,c.value=0):(c.value=S,i.value=0)}}),{classes:o,containerStyle:u,itemStyle:f}}const BDe=pt({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:Ue([String,Object,Array]),default:""},style:{type:Ue([String,Array,Object]),default:""},alignment:{type:Ue(String),default:"center"},prefixCls:{type:String},spacer:{type:Ue([Object,String,Number,Array]),default:null,validator:e=>Wo(e)||jt(e)||Ut(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:ic,validator:e=>jt(e)||ht(e)&&e.length===2&&e.every(jt)}}),HDe=Te({name:"ElSpace",props:BDe,setup(e,{slots:t}){const{classes:o,containerStyle:i,itemStyle:c}=GDe(e);function u(f,p="",v=[]){const{prefixCls:_}=e;return f.forEach((b,S)=>{tO(b)?ht(b.children)&&b.children.forEach((k,M)=>{tO(k)&&ht(k.children)?u(k.children,`${p+M}-`,v):v.push(Me(WB,{style:c.value,prefixCls:_,key:`nested-${p+M}`},{default:()=>[k]},ys.PROPS|ys.STYLE,["style","prefixCls"]))}):UCe(b)&&v.push(Me(WB,{style:c.value,prefixCls:_,key:`LoopKey${p+S}`},{default:()=>[b]},ys.PROPS|ys.STYLE,["style","prefixCls"]))}),v}return()=>{var f;const{spacer:p,direction:v}=e,_=Ve(t,"default",{key:0},()=>[]);if(((f=_.children)!=null?f:[]).length===0)return null;if(ht(_.children)){let b=u(_.children);if(p){const S=b.length-1;b=b.reduce((k,M,R)=>{const w=[...k,M];return R!==S&&w.push(Me("span",{style:[c.value,v==="vertical"?"width: 100%":null],key:R},[Wo(p)?p:Mn(p,ys.TEXT)],ys.STYLE)),w},[])}return Me("div",{class:o.value,style:i.value},b,ys.STYLE|ys.CLASS)}return _.children}}}),$De=un(HDe),qDe=pt({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:Ue([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:Ue([String,Object,Array])}}),KDe=Te({name:"ElStatistic"}),zDe=Te({...KDe,props:qDe,setup(e,{expose:t}){const o=e,i=ut("statistic"),c=z(()=>{const{value:u,formatter:f,precision:p,decimalSeparator:v,groupSeparator:_}=o;if(zt(f))return f(u);if(!jt(u)||Number.isNaN(u))return u;let[b,S=""]=String(u).split(".");return S=S.padEnd(p,"0").slice(0,p>0?p:0),b=b.replace(/\B(?=(\d{3})+(?!\d))/g,_),[b,S].join(S?v:"")});return t({displayValue:c}),(u,f)=>(ee(),ge("div",{class:ne(y(i).b())},[u.$slots.title||u.title?(ee(),ge("div",{key:0,class:ne(y(i).e("head"))},[Ve(u.$slots,"title",{},()=>[Mn(mt(u.title),1)])],2)):$e("v-if",!0),Ee("div",{class:ne(y(i).e("content"))},[u.$slots.prefix||u.prefix?(ee(),ge("div",{key:0,class:ne(y(i).e("prefix"))},[Ve(u.$slots,"prefix",{},()=>[Ee("span",null,mt(u.prefix),1)])],2)):$e("v-if",!0),Ee("span",{class:ne(y(i).e("number")),style:qt(u.valueStyle)},mt(y(c)),7),u.$slots.suffix||u.suffix?(ee(),ge("div",{key:1,class:ne(y(i).e("suffix"))},[Ve(u.$slots,"suffix",{},()=>[Ee("span",null,mt(u.suffix),1)])],2)):$e("v-if",!0)],2)],2))}});var WDe=vt(zDe,[["__file","statistic.vue"]]);const Az=un(WDe),jDe=pt({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:Ue([Number,Object]),default:0},valueStyle:{type:Ue([String,Object,Array])}}),YDe={finish:()=>!0,[wn]:e=>jt(e)},JDe=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],YB=e=>jt(e)?new Date(e).getTime():e.valueOf(),JB=(e,t)=>{let o=e;const i=/\[([^\]]*)]/g;return JDe.reduce((u,[f,p])=>{const v=new RegExp(`${f}+(?![^\\[\\]]*\\])`,"g");if(v.test(u)){const _=Math.floor(o/p);return o-=_*p,u.replace(v,b=>String(_).padStart(b.length,"0"))}return u},t).replace(i,"$1")},XDe=Te({name:"ElCountdown"}),ZDe=Te({...XDe,props:jDe,emits:YDe,setup(e,{expose:t,emit:o}){const i=e;let c;const u=le(0),f=z(()=>JB(u.value,i.format)),p=b=>JB(b,i.format),v=()=>{c&&(up(c),c=void 0)},_=()=>{const b=YB(i.value),S=()=>{let k=b-Date.now();o(wn,k),k<=0?(k=0,v(),o("finish")):c=Wd(S),u.value=k};c=Wd(S)};return mn(()=>{u.value=YB(i.value)-Date.now(),st(()=>[i.value,i.format],()=>{v(),_()},{immediate:!0})}),Co(()=>{v()}),t({displayValue:f}),(b,S)=>(ee(),We(y(Az),{value:u.value,title:b.title,prefix:b.prefix,suffix:b.suffix,"value-style":b.valueStyle,formatter:p},rs({_:2},[Un(b.$slots,(k,M)=>({name:M,fn:Ae(()=>[Ve(b.$slots,M)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var QDe=vt(ZDe,[["__file","countdown.vue"]]);const eOe=un(QDe),tOe=pt({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),nOe={[wn]:(e,t)=>[e,t].every(jt)},oOe=Te({name:"ElSteps"}),rOe=Te({...oOe,props:tOe,emits:nOe,setup(e,{emit:t}){const o=e,i=ut("steps"),{children:c,addChild:u,removeChild:f}=EN(kn(),"ElStep");return st(c,()=>{c.value.forEach((p,v)=>{p.setIndex(v)})}),Nn("ElSteps",{props:o,steps:c,addStep:u,removeStep:f}),st(()=>o.active,(p,v)=>{t(wn,p,v)}),(p,v)=>(ee(),ge("div",{class:ne([y(i).b(),y(i).m(p.simple?"simple":p.direction)])},[Ve(p.$slots,"default")],2))}});var iOe=vt(rOe,[["__file","steps.vue"]]);const aOe=pt({title:{type:String,default:""},icon:{type:ho},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),sOe=Te({name:"ElStep"}),lOe=Te({...sOe,props:aOe,setup(e){const t=e,o=ut("step"),i=le(-1),c=le({}),u=le(""),f=Rt("ElSteps"),p=kn();mn(()=>{st([()=>f.props.active,()=>f.props.processStatus,()=>f.props.finishStatus],([H])=>{P(H)},{immediate:!0})}),Co(()=>{f.removeStep(G.uid)});const v=z(()=>t.status||u.value),_=z(()=>{const H=f.steps.value[i.value-1];return H?H.currentStatus:"wait"}),b=z(()=>f.props.alignCenter),S=z(()=>f.props.direction==="vertical"),k=z(()=>f.props.simple),M=z(()=>f.steps.value.length),R=z(()=>{var H;return((H=f.steps.value[M.value-1])==null?void 0:H.uid)===(p==null?void 0:p.uid)}),w=z(()=>k.value?"":f.props.space),E=z(()=>[o.b(),o.is(k.value?"simple":f.props.direction),o.is("flex",R.value&&!w.value&&!b.value),o.is("center",b.value&&!S.value&&!k.value)]),N=z(()=>{const H={flexBasis:jt(w.value)?`${w.value}px`:w.value?w.value:`${100/(M.value-(b.value?0:1))}%`};return S.value||R.value&&(H.maxWidth=`${100/M.value}%`),H}),F=H=>{i.value=H},x=H=>{const Y=H==="wait",j={transitionDelay:`${Y?"-":""}${150*i.value}ms`},W=H===f.props.processStatus||Y?0:100;j.borderWidth=W&&!k.value?"1px":0,j[f.props.direction==="vertical"?"height":"width"]=`${W}%`,c.value=j},P=H=>{H>i.value?u.value=f.props.finishStatus:H===i.value&&_.value!=="error"?u.value=f.props.processStatus:u.value="wait";const Y=f.steps.value[i.value-1];Y&&Y.calcProgress(u.value)},G=eo({uid:p.uid,currentStatus:v,setIndex:F,calcProgress:x});return f.addStep(G),(H,Y)=>(ee(),ge("div",{style:qt(y(N)),class:ne(y(E))},[$e(" icon & line "),Ee("div",{class:ne([y(o).e("head"),y(o).is(y(v))])},[y(k)?$e("v-if",!0):(ee(),ge("div",{key:0,class:ne(y(o).e("line"))},[Ee("i",{class:ne(y(o).e("line-inner")),style:qt(c.value)},null,6)],2)),Ee("div",{class:ne([y(o).e("icon"),y(o).is(H.icon||H.$slots.icon?"icon":"text")])},[Ve(H.$slots,"icon",{},()=>[H.icon?(ee(),We(y(Pt),{key:0,class:ne(y(o).e("icon-inner"))},{default:Ae(()=>[(ee(),We(Tn(H.icon)))]),_:1},8,["class"])):y(v)==="success"?(ee(),We(y(Pt),{key:1,class:ne([y(o).e("icon-inner"),y(o).is("status")])},{default:Ae(()=>[Me(y(sI))]),_:1},8,["class"])):y(v)==="error"?(ee(),We(y(Pt),{key:2,class:ne([y(o).e("icon-inner"),y(o).is("status")])},{default:Ae(()=>[Me(y(As))]),_:1},8,["class"])):y(k)?$e("v-if",!0):(ee(),ge("div",{key:3,class:ne(y(o).e("icon-inner"))},mt(i.value+1),3))])],2)],2),$e(" title & description "),Ee("div",{class:ne(y(o).e("main"))},[Ee("div",{class:ne([y(o).e("title"),y(o).is(y(v))])},[Ve(H.$slots,"title",{},()=>[Mn(mt(H.title),1)])],2),y(k)?(ee(),ge("div",{key:0,class:ne(y(o).e("arrow"))},null,2)):(ee(),ge("div",{key:1,class:ne([y(o).e("description"),y(o).is(y(v))])},[Ve(H.$slots,"description",{},()=>[Mn(mt(H.description),1)])],2))],2)],6))}});var Dz=vt(lOe,[["__file","item.vue"]]);const cOe=un(iOe,{Step:Dz}),uOe=lr(Dz),Oz=e=>["",...ic].includes(e),dOe=pt({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Oz},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:ho},activeActionIcon:{type:ho},activeIcon:{type:ho},inactiveIcon:{type:ho},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Ue(Function)},id:String,tabindex:{type:[String,Number]},...Ci(["ariaLabel"])}),hOe={[nn]:e=>vo(e)||Ut(e)||jt(e),[wn]:e=>vo(e)||Ut(e)||jt(e),[Jr]:e=>vo(e)||Ut(e)||jt(e)},Lz="ElSwitch",fOe=Te({name:Lz}),pOe=Te({...fOe,props:dOe,emits:hOe,setup(e,{expose:t,emit:o}){const i=e,{formItem:c}=Ni(),u=Fr(),f=ut("switch"),{inputId:p}=Ps(i,{formItemContext:c}),v=Pi(z(()=>i.loading)),_=le(i.modelValue!==!1),b=le(),S=le(),k=z(()=>[f.b(),f.m(u.value),f.is("disabled",v.value),f.is("checked",N.value)]),M=z(()=>[f.e("label"),f.em("label","left"),f.is("active",!N.value)]),R=z(()=>[f.e("label"),f.em("label","right"),f.is("active",N.value)]),w=z(()=>({width:ur(i.width)}));st(()=>i.modelValue,()=>{_.value=!0});const E=z(()=>_.value?i.modelValue:!1),N=z(()=>E.value===i.activeValue);[i.activeValue,i.inactiveValue].includes(E.value)||(o(nn,i.inactiveValue),o(wn,i.inactiveValue),o(Jr,i.inactiveValue)),st(N,G=>{var H;b.value.checked=G,i.validateEvent&&((H=c==null?void 0:c.validate)==null||H.call(c,"change").catch(Y=>void 0))});const F=()=>{const G=N.value?i.inactiveValue:i.activeValue;o(nn,G),o(wn,G),o(Jr,G),Vt(()=>{b.value.checked=N.value})},x=()=>{if(v.value)return;const{beforeChange:G}=i;if(!G){F();return}const H=G();[h0(H),vo(H)].includes(!0)||qr(Lz,"beforeChange must return type `Promise<boolean>` or `boolean`"),h0(H)?H.then(j=>{j&&F()}).catch(j=>{}):H&&F()},P=()=>{var G,H;(H=(G=b.value)==null?void 0:G.focus)==null||H.call(G)};return mn(()=>{b.value.checked=N.value}),t({focus:P,checked:N}),(G,H)=>(ee(),ge("div",{class:ne(y(k)),onClick:Zt(x,["prevent"])},[Ee("input",{id:y(p),ref_key:"input",ref:b,class:ne(y(f).e("input")),type:"checkbox",role:"switch","aria-checked":y(N),"aria-disabled":y(v),"aria-label":G.ariaLabel,name:G.name,"true-value":G.activeValue,"false-value":G.inactiveValue,disabled:y(v),tabindex:G.tabindex,onChange:F,onKeydown:To(x,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!G.inlinePrompt&&(G.inactiveIcon||G.inactiveText)?(ee(),ge("span",{key:0,class:ne(y(M))},[G.inactiveIcon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(G.inactiveIcon)))]),_:1})):$e("v-if",!0),!G.inactiveIcon&&G.inactiveText?(ee(),ge("span",{key:1,"aria-hidden":y(N)},mt(G.inactiveText),9,["aria-hidden"])):$e("v-if",!0)],2)):$e("v-if",!0),Ee("span",{ref_key:"core",ref:S,class:ne(y(f).e("core")),style:qt(y(w))},[G.inlinePrompt?(ee(),ge("div",{key:0,class:ne(y(f).e("inner"))},[G.activeIcon||G.inactiveIcon?(ee(),We(y(Pt),{key:0,class:ne(y(f).is("icon"))},{default:Ae(()=>[(ee(),We(Tn(y(N)?G.activeIcon:G.inactiveIcon)))]),_:1},8,["class"])):G.activeText||G.inactiveText?(ee(),ge("span",{key:1,class:ne(y(f).is("text")),"aria-hidden":!y(N)},mt(y(N)?G.activeText:G.inactiveText),11,["aria-hidden"])):$e("v-if",!0)],2)):$e("v-if",!0),Ee("div",{class:ne(y(f).e("action"))},[G.loading?(ee(),We(y(Pt),{key:0,class:ne(y(f).is("loading"))},{default:Ae(()=>[Me(y(ec))]),_:1},8,["class"])):y(N)?Ve(G.$slots,"active-action",{key:1},()=>[G.activeActionIcon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(G.activeActionIcon)))]),_:1})):$e("v-if",!0)]):y(N)?$e("v-if",!0):Ve(G.$slots,"inactive-action",{key:2},()=>[G.inactiveActionIcon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(G.inactiveActionIcon)))]),_:1})):$e("v-if",!0)])],2)],6),!G.inlinePrompt&&(G.activeIcon||G.activeText)?(ee(),ge("span",{key:1,class:ne(y(R))},[G.activeIcon?(ee(),We(y(Pt),{key:0},{default:Ae(()=>[(ee(),We(Tn(G.activeIcon)))]),_:1})):$e("v-if",!0),!G.activeIcon&&G.activeText?(ee(),ge("span",{key:1,"aria-hidden":!y(N)},mt(G.activeText),9,["aria-hidden"])):$e("v-if",!0)],2)):$e("v-if",!0)],10,["onClick"]))}});var mOe=vt(pOe,[["__file","switch.vue"]]);const gOe=un(mOe),cD=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},vOe=function(e,t,o,i,c){if(!t&&!i&&(!c||ht(c)&&!c.length))return e;Ut(o)?o=o==="descending"?-1:1:o=o&&o<0?-1:1;const u=i?null:function(p,v){return c?(ht(c)||(c=[c]),c.map(_=>Ut(_)?Rr(p,_):_(p,v,e))):(t!=="$key"&&gn(p)&&"$value"in p&&(p=p.$value),[gn(p)?Rr(p,t):p])},f=function(p,v){if(i)return i(p.value,v.value);for(let _=0,b=p.key.length;_<b;_++){if(p.key[_]<v.key[_])return-1;if(p.key[_]>v.key[_])return 1}return 0};return e.map((p,v)=>({value:p,index:v,key:u?u(p,v):null})).sort((p,v)=>{let _=f(p,v);return _||(_=p.index-v.index),_*+o}).map(p=>p.value)},Nz=function(e,t){let o=null;return e.columns.forEach(i=>{i.id===t&&(o=i)}),o},_Oe=function(e,t){let o=null;for(let i=0;i<e.columns.length;i++){const c=e.columns[i];if(c.columnKey===t){o=c;break}}return o||qr("ElTable",`No column matching with column-key: ${t}`),o},XB=function(e,t,o){const i=(t.className||"").match(new RegExp(`${o}-table_[^\\s]+`,"gm"));return i?Nz(e,i[0]):null},ji=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Ut(t)){if(!t.includes("."))return`${e[t]}`;const o=t.split(".");let i=e;for(const c of o)i=i[c];return`${i}`}else if(zt(t))return t.call(null,e)},Pg=function(e,t,o=!1,i="children"){const c=e||[],u={};return c.forEach((f,p)=>{if(u[ji(f,t)]={row:f,index:p},o){const v=f[i];ht(v)&&Object.assign(u,Pg(v,t,!0,i))}}),u};function yOe(e,t){const o={};let i;for(i in e)o[i]=e[i];for(i in t)if(jn(t,i)){const c=t[i];qn(c)||(o[i]=c)}return o}function JN(e){return e===""||qn(e)||(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function Pz(e){return e===""||qn(e)||(e=JN(e),Number.isNaN(e)&&(e=80)),e}function IOe(e){return jt(e)?e:Ut(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function bOe(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,o)=>(...i)=>t(o(...i)))}function iT(e,t,o,i,c,u){let f=u??0,p=!1;const v=e.indexOf(t),_=v!==-1,b=c==null?void 0:c.call(null,t,f),S=M=>{M==="add"?e.push(t):e.splice(v,1),p=!0},k=M=>{let R=0;const w=(i==null?void 0:i.children)&&M[i.children];return w&&ht(w)&&(R+=w.length,w.forEach(E=>{R+=k(E)})),R};return(!c||b)&&(vo(o)?o&&!_?S("add"):!o&&_&&S("remove"):S(_?"remove":"add")),!(i!=null&&i.checkStrictly)&&(i!=null&&i.children)&&ht(t[i.children])&&t[i.children].forEach(M=>{const R=iT(e,M,o??!_,i,c,f+1);f+=k(M)+1,R&&(p=R)}),p}function COe(e,t,o="children",i="hasChildren"){const c=f=>!(ht(f)&&f.length);function u(f,p,v){t(f,p,v),p.forEach(_=>{if(_[i]){t(_,null,v+1);return}const b=_[o];c(b)||u(_,b,v+1)})}e.forEach(f=>{if(f[i]){t(f,null,0);return}const p=f[o];c(p)||u(f,p,0)})}const SOe=(e,t,o,i)=>{const c={strategy:"fixed",...e.popperOptions},u=zt(i.tooltipFormatter)?i.tooltipFormatter({row:o,column:i,cellValue:a0(o,i.property).value}):void 0;return Wo(u)?{slotContent:u,content:null,...e,popperOptions:c}:{slotContent:null,content:u??t,...e,popperOptions:c}};let Ta=null;function EOe(e,t,o,i,c,u){const f=SOe(e,t,o,i),p={...f,slotContent:void 0};if((Ta==null?void 0:Ta.trigger)===c){const M=Ta.vm.component;Uq(M.props,p),f.slotContent&&(M.slots.content=()=>[f.slotContent]);return}Ta==null||Ta();const v=u==null?void 0:u.refs.tableWrapper,_=v==null?void 0:v.dataset.prefix,b=Me(Li,{virtualTriggering:!0,virtualRef:c,appendTo:v,placement:"top",transition:"none",offset:0,hideAfter:0,...p},f.slotContent?{content:()=>f.slotContent}:void 0);b.appContext={...u.appContext,...u};const S=document.createElement("div");Kd(b,S),b.component.exposed.onOpen();const k=v==null?void 0:v.querySelector(`.${_}-scrollbar__wrap`);Ta=()=>{Kd(null,S),k==null||k.removeEventListener("scroll",Ta),Ta=null},Ta.trigger=c,Ta.vm=b,k==null||k.addEventListener("scroll",Ta)}function xz(e){return e.children?Fge(e.children,xz):[e]}function ZB(e,t){return e+t.colSpan}const Uz=(e,t,o,i)=>{let c=0,u=e;const f=o.states.columns.value;if(i){const v=xz(i[e]);c=f.slice(0,f.indexOf(v[0])).reduce(ZB,0),u=c+v.reduce(ZB,0)-1}else c=e;let p;switch(t){case"left":u<o.states.fixedLeafColumnsLength.value&&(p="left");break;case"right":c>=f.length-o.states.rightFixedLeafColumnsLength.value&&(p="right");break;default:u<o.states.fixedLeafColumnsLength.value?p="left":c>=f.length-o.states.rightFixedLeafColumnsLength.value&&(p="right")}return p?{direction:p,start:c,after:u}:{}},XN=(e,t,o,i,c,u=0)=>{const f=[],{direction:p,start:v,after:_}=Uz(t,o,i,c);if(p){const b=p==="left";f.push(`${e}-fixed-column--${p}`),b&&_+u===i.states.fixedLeafColumnsLength.value-1?f.push("is-last-column"):!b&&v-u===i.states.columns.value.length-i.states.rightFixedLeafColumnsLength.value&&f.push("is-first-column")}return f};function QB(e,t){return e+(iI(t.realWidth)||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const ZN=(e,t,o,i)=>{const{direction:c,start:u=0,after:f=0}=Uz(e,t,o,i);if(!c)return;const p={},v=c==="left",_=o.states.columns.value;return v?p.left=_.slice(0,u).reduce(QB,0):p.right=_.slice(f+1).reverse().reduce(QB,0),p},nv=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function TOe(e){const t=kn(),o=le(!1),i=le([]);return{updateExpandRows:()=>{const v=e.data.value||[],_=e.rowKey.value;if(o.value)i.value=v.slice();else if(_){const b=Pg(i.value,_);i.value=v.reduce((S,k)=>{const M=ji(k,_);return b[M]&&S.push(k),S},[])}else i.value=[]},toggleRowExpansion:(v,_)=>{iT(i.value,v,_)&&t.emit("expand-change",v,i.value.slice())},setExpandRowKeys:v=>{t.store.assertRowKey();const _=e.data.value||[],b=e.rowKey.value,S=Pg(_,b);i.value=v.reduce((k,M)=>{const R=S[M];return R&&k.push(R.row),k},[])},isRowExpanded:v=>{const _=e.rowKey.value;return _?!!Pg(i.value,_)[ji(v,_)]:i.value.includes(v)},states:{expandRows:i,defaultExpandAll:o}}}function MOe(e){const t=kn(),o=le(null),i=le(null),c=_=>{t.store.assertRowKey(),o.value=_,f(_)},u=()=>{o.value=null},f=_=>{const{data:b,rowKey:S}=e;let k=null;S.value&&(k=(y(b)||[]).find(M=>ji(M,S.value)===_)),i.value=k,t.emit("current-change",i.value,null)};return{setCurrentRowKey:c,restoreCurrentRowKey:u,setCurrentRowByKey:f,updateCurrentRow:_=>{const b=i.value;if(_&&_!==b){i.value=_,t.emit("current-change",i.value,b);return}!_&&b&&(i.value=null,t.emit("current-change",null,b))},updateCurrentRowData:()=>{const _=e.rowKey.value,b=e.data.value||[],S=i.value;if(!b.includes(S)&&S){if(_){const k=ji(S,_);f(k)}else i.value=null;iI(i.value)&&t.emit("current-change",null,S)}else o.value&&(f(o.value),u())},states:{_currentRowKey:o,currentRow:i}}}function kOe(e){const t=le([]),o=le({}),i=le(16),c=le(!1),u=le({}),f=le("hasChildren"),p=le("children"),v=le(!1),_=kn(),b=z(()=>{if(!e.rowKey.value)return{};const P=e.data.value||[];return k(P)}),S=z(()=>{const P=e.rowKey.value,G=Object.keys(u.value),H={};return G.length&&G.forEach(Y=>{if(u.value[Y].length){const j={children:[]};u.value[Y].forEach(W=>{const O=ji(W,P);j.children.push(O),W[f.value]&&!H[O]&&(H[O]={children:[]})}),H[Y]=j}}),H}),k=P=>{const G=e.rowKey.value,H={};return COe(P,(Y,j,W)=>{const O=ji(Y,G);ht(j)?H[O]={children:j.map(Q=>ji(Q,G)),level:W}:c.value&&(H[O]={children:[],lazy:!0,level:W})},p.value,f.value),H},M=(P=!1,G=(H=>(H=_.store)==null?void 0:H.states.defaultExpandAll.value)())=>{var H;const Y=b.value,j=S.value,W=Object.keys(Y),O={};if(W.length){const Q=y(o),J=[],oe=(ie,te)=>{if(P)return t.value?G||t.value.includes(te):!!(G||ie!=null&&ie.expanded);{const he=G||t.value&&t.value.includes(te);return!!(ie!=null&&ie.expanded||he)}};W.forEach(ie=>{const te=Q[ie],he={...Y[ie]};if(he.expanded=oe(te,ie),he.lazy){const{loaded:re=!1,loading:X=!1}=te||{};he.loaded=!!re,he.loading=!!X,J.push(ie)}O[ie]=he});const pe=Object.keys(j);c.value&&pe.length&&J.length&&pe.forEach(ie=>{const te=Q[ie],he=j[ie].children;if(J.includes(ie)){if(O[ie].children.length!==0)throw new Error("[ElTable]children must be an empty array.");O[ie].children=he}else{const{loaded:re=!1,loading:X=!1}=te||{};O[ie]={lazy:!0,loaded:!!re,loading:!!X,expanded:oe(te,ie),children:he,level:""}}})}o.value=O,(H=_.store)==null||H.updateTableScrollY()};st(()=>t.value,()=>{M(!0)}),st(()=>b.value,()=>{M()}),st(()=>S.value,()=>{M()});const R=P=>{t.value=P,M()},w=P=>c.value&&P&&"loaded"in P&&!P.loaded,E=(P,G)=>{_.store.assertRowKey();const H=e.rowKey.value,Y=ji(P,H),j=Y&&o.value[Y];if(Y&&j&&"expanded"in j){const W=j.expanded;G=qn(G)?!j.expanded:G,o.value[Y].expanded=G,W!==G&&_.emit("expand-change",P,G),w(j)&&F(P,Y,j),_.store.updateTableScrollY()}},N=P=>{_.store.assertRowKey();const G=e.rowKey.value,H=ji(P,G),Y=o.value[H];w(Y)?F(P,H,Y):E(P,void 0)},F=(P,G,H)=>{const{load:Y}=_.props;Y&&!o.value[G].loaded&&(o.value[G].loading=!0,Y(P,H,j=>{if(!ht(j))throw new TypeError("[ElTable] data must be an array");o.value[G].loading=!1,o.value[G].loaded=!0,o.value[G].expanded=!0,j.length&&(u.value[G]=j),_.emit("expand-change",P,!0)}))};return{loadData:F,loadOrToggle:N,toggleTreeExpansion:E,updateTreeExpandKeys:R,updateTreeData:M,updateKeyChildren:(P,G)=>{const{lazy:H,rowKey:Y}=_.props;if(H){if(!Y)throw new Error("[Table] rowKey is required in updateKeyChild");u.value[P]&&(u.value[P]=G)}},normalize:k,states:{expandRowKeys:t,treeData:o,indent:i,lazy:c,lazyTreeNodeMap:u,lazyColumnIdentifier:f,childrenColumnName:p,checkStrictly:v}}}const wOe=(e,t)=>{const o=t.sortingColumn;return!o||Ut(o.sortable)?e:vOe(e,t.sortProp,t.sortOrder,o.sortMethod,o.sortBy)},mE=e=>{const t=[];return e.forEach(o=>{o.children&&o.children.length>0?t.push.apply(t,mE(o.children)):t.push(o)}),t};function ROe(){var e;const t=kn(),{size:o}=hi((e=t.proxy)==null?void 0:e.$props),i=le(null),c=le([]),u=le([]),f=le(!1),p=le([]),v=le([]),_=le([]),b=le([]),S=le([]),k=le([]),M=le([]),R=le([]),w=[],E=le(0),N=le(0),F=le(0),x=le(!1),P=le([]),G=le(!1),H=le(!1),Y=le(null),j=le({}),W=le(null),O=le(null),Q=le(null),J=le(null),oe=le(null),pe=z(()=>i.value?Pg(P.value,i.value):void 0);st(c,()=>{var Xt;t.state&&(re(!1),t.props.tableLayout==="auto"&&((Xt=t.refs.tableHeaderRef)==null||Xt.updateFixedColumnStyle()))},{deep:!0});const ie=()=>{if(!i.value)throw new Error("[ElTable] prop row-key is required")},te=Xt=>{var vn;(vn=Xt.children)==null||vn.forEach(Ne=>{Ne.fixed=Xt.fixed,te(Ne)})},he=()=>{var Xt,vn;p.value.forEach(Nt=>{te(Nt)}),b.value=p.value.filter(Nt=>Nt.type!=="selection"&&[!0,"left"].includes(Nt.fixed));let Ne;if(((vn=(Xt=p.value)==null?void 0:Xt[0])==null?void 0:vn.type)==="selection"){const Nt=p.value[0];Ne=[!0,"left"].includes(Nt.fixed)||b.value.length&&Nt.fixed!=="right",Ne&&b.value.unshift(Nt)}S.value=p.value.filter(Nt=>Nt.fixed==="right");const qe=p.value.filter(Nt=>(Ne?Nt.type!=="selection":!0)&&!Nt.fixed);v.value=[].concat(b.value).concat(qe).concat(S.value);const ke=mE(qe),ot=mE(b.value),tn=mE(S.value);E.value=ke.length,N.value=ot.length,F.value=tn.length,_.value=[].concat(ot).concat(ke).concat(tn),f.value=b.value.length>0||S.value.length>0},re=(Xt,vn=!1)=>{Xt&&he(),vn?t.state.doLayout():t.state.debouncedUpdateLayout()},X=Xt=>pe.value?!!pe.value[ji(Xt,i.value)]:P.value.includes(Xt),ye=()=>{x.value=!1;const Xt=P.value;P.value=[],Xt.length&&t.emit("selection-change",[])},ue=()=>{var Xt,vn;let Ne;if(i.value){Ne=[];const qe=(vn=(Xt=t==null?void 0:t.store)==null?void 0:Xt.states)==null?void 0:vn.childrenColumnName.value,ke=Pg(c.value,i.value,!0,qe);for(const ot in pe.value)jn(pe.value,ot)&&!ke[ot]&&Ne.push(pe.value[ot].row)}else Ne=P.value.filter(qe=>!c.value.includes(qe));if(Ne.length){const qe=P.value.filter(ke=>!Ne.includes(ke));P.value=qe,t.emit("selection-change",qe.slice())}},Ie=()=>(P.value||[]).slice(),ve=(Xt,vn,Ne=!0,qe=!1)=>{var ke,ot,tn,Nt;const Dn={children:(ot=(ke=t==null?void 0:t.store)==null?void 0:ke.states)==null?void 0:ot.childrenColumnName.value,checkStrictly:(Nt=(tn=t==null?void 0:t.store)==null?void 0:tn.states)==null?void 0:Nt.checkStrictly.value};if(iT(P.value,Xt,vn,Dn,qe?void 0:Y.value,c.value.indexOf(Xt))){const io=(P.value||[]).slice();Ne&&t.emit("select",io,Xt),t.emit("selection-change",io)}},Ce=()=>{var Xt,vn;const Ne=H.value?!x.value:!(x.value||P.value.length);x.value=Ne;let qe=!1,ke=0;const ot=(vn=(Xt=t==null?void 0:t.store)==null?void 0:Xt.states)==null?void 0:vn.rowKey.value,{childrenColumnName:tn}=t.store.states,Nt={children:tn.value,checkStrictly:!1};c.value.forEach((Dn,dr)=>{const io=dr+ke;iT(P.value,Dn,Ne,Nt,Y.value,io)&&(qe=!0),ke+=be(ji(Dn,ot))}),qe&&t.emit("selection-change",P.value?P.value.slice():[]),t.emit("select-all",(P.value||[]).slice())},Fe=()=>{c.value.forEach(Xt=>{const vn=ji(Xt,i.value),Ne=pe.value[vn];Ne&&(P.value[Ne.index]=Xt)})},Oe=()=>{var Xt;if(((Xt=c.value)==null?void 0:Xt.length)===0){x.value=!1;return}const{childrenColumnName:vn}=t.store.states;let Ne=0,qe=0;const ke=tn=>{var Nt;for(const Dn of tn){const dr=Y.value&&Y.value.call(null,Dn,Ne);if(X(Dn))qe++;else if(!Y.value||dr)return!1;if(Ne++,(Nt=Dn[vn.value])!=null&&Nt.length&&!ke(Dn[vn.value]))return!1}return!0},ot=ke(c.value||[]);x.value=qe===0?!1:ot},be=Xt=>{var vn;if(!t||!t.store)return 0;const{treeData:Ne}=t.store.states;let qe=0;const ke=(vn=Ne.value[Xt])==null?void 0:vn.children;return ke&&(qe+=ke.length,ke.forEach(ot=>{qe+=be(ot)})),qe},xe=(Xt,vn)=>{ht(Xt)||(Xt=[Xt]);const Ne={};return Xt.forEach(qe=>{j.value[qe.id]=vn,Ne[qe.columnKey||qe.id]=vn}),Ne},Le=(Xt,vn,Ne)=>{O.value&&O.value!==Xt&&(O.value.order=null),O.value=Xt,Q.value=vn,J.value=Ne},rt=()=>{let Xt=y(u);Object.keys(j.value).forEach(vn=>{const Ne=j.value[vn];if(!Ne||Ne.length===0)return;const qe=Nz({columns:_.value},vn);qe&&qe.filterMethod&&(Xt=Xt.filter(ke=>Ne.some(ot=>qe.filterMethod.call(null,ot,ke,qe))))}),W.value=Xt},Qe=()=>{c.value=wOe(W.value,{sortingColumn:O.value,sortProp:Q.value,sortOrder:J.value})},Ge=(Xt=void 0)=>{Xt&&Xt.filter||rt(),Qe()},_e=Xt=>{const{tableHeaderRef:vn}=t.refs;if(!vn)return;const Ne=Object.assign({},vn.filterPanels),qe=Object.keys(Ne);if(qe.length)if(Ut(Xt)&&(Xt=[Xt]),ht(Xt)){const ke=Xt.map(ot=>_Oe({columns:_.value},ot));qe.forEach(ot=>{const tn=ke.find(Nt=>Nt.id===ot);tn&&(tn.filteredValue=[])}),t.store.commit("filterChange",{column:ke,values:[],silent:!0,multi:!0})}else qe.forEach(ke=>{const ot=_.value.find(tn=>tn.id===ke);ot&&(ot.filteredValue=[])}),j.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Re=()=>{O.value&&(Le(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Ke,toggleRowExpansion:je,updateExpandRows:ze,states:nt,isRowExpanded:it}=TOe({data:c,rowKey:i}),{updateTreeExpandKeys:dt,toggleTreeExpansion:gt,updateTreeData:ft,updateKeyChildren:Mt,loadOrToggle:lt,states:Et}=kOe({data:c,rowKey:i}),{updateCurrentRowData:Yt,updateCurrentRow:sn,setCurrentRowKey:dn,states:Sn}=MOe({data:c,rowKey:i});return{assertRowKey:ie,updateColumns:he,scheduleLayout:re,isSelected:X,clearSelection:ye,cleanSelection:ue,getSelectionRows:Ie,toggleRowSelection:ve,_toggleAllSelection:Ce,toggleAllSelection:null,updateSelectionByRowKey:Fe,updateAllSelected:Oe,updateFilters:xe,updateCurrentRow:sn,updateSort:Le,execFilter:rt,execSort:Qe,execQuery:Ge,clearFilter:_e,clearSort:Re,toggleRowExpansion:je,setExpandRowKeysAdapter:Xt=>{Ke(Xt),dt(Xt)},setCurrentRowKey:dn,toggleRowExpansionAdapter:(Xt,vn)=>{_.value.some(({type:qe})=>qe==="expand")?je(Xt,vn):gt(Xt,vn)},isRowExpanded:it,updateExpandRows:ze,updateCurrentRowData:Yt,loadOrToggle:lt,updateTreeData:ft,updateKeyChildren:Mt,states:{tableSize:o,rowKey:i,data:c,_data:u,isComplex:f,_columns:p,originColumns:v,columns:_,fixedColumns:b,rightFixedColumns:S,leafColumns:k,fixedLeafColumns:M,rightFixedLeafColumns:R,updateOrderFns:w,leafColumnsLength:E,fixedLeafColumnsLength:N,rightFixedLeafColumnsLength:F,isAllSelected:x,selection:P,reserveSelection:G,selectOnIndeterminate:H,selectable:Y,filters:j,filteredData:W,sortingColumn:O,sortProp:Q,sortOrder:J,hoverRow:oe,...nt,...Et,...Sn}}}function MO(e,t){return e.map(o=>{var i;return o.id===t.id?t:((i=o.children)!=null&&i.length&&(o.children=MO(o.children,t)),o)})}function kO(e){e.forEach(t=>{var o,i;t.no=(o=t.getColumnIndex)==null?void 0:o.call(t),(i=t.children)!=null&&i.length&&kO(t.children)}),e.sort((t,o)=>t.no-o.no)}function AOe(){const e=kn(),t=ROe();return{ns:ut("table"),...t,mutations:{setData(f,p){const v=y(f._data)!==p;f.data.value=p,f._data.value=p,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(f.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):v?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(f,p,v,_){const b=y(f._columns);let S=[];v?(v&&!v.children&&(v.children=[]),v.children.push(p),S=MO(b,v)):(b.push(p),S=b),kO(S),f._columns.value=S,f.updateOrderFns.push(_),p.type==="selection"&&(f.selectable.value=p.selectable,f.reserveSelection.value=p.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(f,p){var v;((v=p.getColumnIndex)==null?void 0:v.call(p))!==p.no&&(kO(f._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(f,p,v,_){const b=y(f._columns)||[];if(v)v.children.splice(v.children.findIndex(k=>k.id===p.id),1),Vt(()=>{var k;((k=v.children)==null?void 0:k.length)===0&&delete v.children}),f._columns.value=MO(b,v);else{const k=b.indexOf(p);k>-1&&(b.splice(k,1),f._columns.value=b)}const S=f.updateOrderFns.indexOf(_);S>-1&&f.updateOrderFns.splice(S,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(f,p){const{prop:v,order:_,init:b}=p;if(v){const S=y(f.columns).find(k=>k.property===v);S&&(S.order=_,e.store.updateSort(S,v,_),e.store.commit("changeSortCondition",{init:b}))}},changeSortCondition(f,p){const{sortingColumn:v,sortProp:_,sortOrder:b}=f,S=y(v),k=y(_),M=y(b);iI(M)&&(f.sortingColumn.value=null,f.sortProp.value=null);const R={filter:!0};e.store.execQuery(R),(!p||!(p.silent||p.init))&&e.emit("sort-change",{column:S,prop:k,order:M}),e.store.updateTableScrollY()},filterChange(f,p){const{column:v,values:_,silent:b}=p,S=e.store.updateFilters(v,_);e.store.execQuery(),b||e.emit("filter-change",S),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(f,p){e.store.toggleRowSelection(p),e.store.updateAllSelected()},setHoverRow(f,p){f.hoverRow.value=p},setCurrentRow(f,p){e.store.updateCurrentRow(p)}},commit:function(f,...p){const v=e.store.mutations;if(v[f])v[f].apply(e,[e.store.states].concat(p));else throw new Error(`Action not found: ${f}`)},updateTableScrollY:function(){Vt(()=>e.layout.updateScrollY.apply(e.layout))}}}const d0={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function DOe(e,t){if(!e)throw new Error("Table is required.");const o=AOe();return o.toggleAllSelection=Oa(o._toggleAllSelection,10),Object.keys(d0).forEach(i=>{Fz(Vz(t,i),i,o)}),OOe(o,t),o}function OOe(e,t){Object.keys(d0).forEach(o=>{st(()=>Vz(t,o),i=>{Fz(i,o,e)})})}function Fz(e,t,o){let i=e,c=d0[t];gn(d0[t])&&(c=c.key,i=i||d0[t].default),o.states[c].value=i}function Vz(e,t){if(t.includes(".")){const o=t.split(".");let i=e;return o.forEach(c=>{i=i[c]}),i}else return e[t]}class LOe{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=le(null),this.scrollX=le(!1),this.scrollY=le(!1),this.bodyWidth=le(null),this.fixedWidth=le(null),this.rightFixedWidth=le(null),this.gutterWidth=0;for(const o in t)jn(t,o)&&(Bo(this[o])?this[o].value=t[o]:this[o]=t[o]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){const t=this.height.value;if(iI(t))return!1;const o=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(o!=null&&o.wrapRef)){let i=!0;const c=this.scrollY.value;return i=o.wrapRef.scrollHeight>o.wrapRef.clientHeight,this.scrollY.value=i,c!==i}return!1}setHeight(t,o="height"){if(!$n)return;const i=this.table.vnode.el;if(t=IOe(t),this.height.value=Number(t),!i&&(t||t===0))return Vt(()=>this.setHeight(t,o));jt(t)?(i.style[o]=`${t}px`,this.updateElsHeight()):Ut(t)&&(i.style[o]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(i=>{i.isColumnGroup?t.push.apply(t,i.columns):t.push(i)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let o=t;for(;o.tagName!=="DIV";){if(getComputedStyle(o).display==="none")return!0;o=o.parentElement}return!1}updateColumnsWidth(){if(!$n)return;const t=this.fit,o=this.table.vnode.el.clientWidth;let i=0;const c=this.getFlattenColumns(),u=c.filter(v=>!jt(v.width));if(c.forEach(v=>{jt(v.width)&&v.realWidth&&(v.realWidth=null)}),u.length>0&&t){if(c.forEach(v=>{i+=Number(v.width||v.minWidth||80)}),i<=o){this.scrollX.value=!1;const v=o-i;if(u.length===1)u[0].realWidth=Number(u[0].minWidth||80)+v;else{const _=u.reduce((k,M)=>k+Number(M.minWidth||80),0),b=v/_;let S=0;u.forEach((k,M)=>{if(M===0)return;const R=Math.floor(Number(k.minWidth||80)*b);S+=R,k.realWidth=Number(k.minWidth||80)+R}),u[0].realWidth=Number(u[0].minWidth||80)+v-S}}else this.scrollX.value=!0,u.forEach(v=>{v.realWidth=Number(v.minWidth)});this.bodyWidth.value=Math.max(i,o),this.table.state.resizeState.value.width=this.bodyWidth.value}else c.forEach(v=>{!v.width&&!v.minWidth?v.realWidth=80:v.realWidth=Number(v.width||v.minWidth),i+=v.realWidth}),this.scrollX.value=i>o,this.bodyWidth.value=i;const f=this.store.states.fixedColumns.value;if(f.length>0){let v=0;f.forEach(_=>{v+=Number(_.realWidth||_.width)}),this.fixedWidth.value=v}const p=this.store.states.rightFixedColumns.value;if(p.length>0){let v=0;p.forEach(_=>{v+=Number(_.realWidth||_.width)}),this.rightFixedWidth.value=v}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const o=this.observers.indexOf(t);o!==-1&&this.observers.splice(o,1)}notifyObservers(t){this.observers.forEach(i=>{var c,u;switch(t){case"columns":(c=i.state)==null||c.onColumnsChange(this);break;case"scrollable":(u=i.state)==null||u.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:NOe}=Ls,POe=Te({name:"ElTableFilterPanel",components:{ElCheckbox:Ls,ElCheckboxGroup:NOe,ElScrollbar:ac,ElTooltip:Li,ElIcon:Pt,ArrowDown:fu,ArrowUp:oN},directives:{ClickOutside:lu},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:Ur.appendTo},setup(e){const t=kn(),{t:o}=Kn(),i=ut("table-filter"),c=t==null?void 0:t.parent;c.filterPanels.value[e.column.id]||(c.filterPanels.value[e.column.id]=t);const u=le(!1),f=le(null),p=z(()=>e.column&&e.column.filters),v=z(()=>e.column.filterClassName?`${i.b()} ${e.column.filterClassName}`:i.b()),_=z({get:()=>{var G;return(((G=e.column)==null?void 0:G.filteredValue)||[])[0]},set:G=>{b.value&&(ks(G)?b.value.splice(0,1):b.value.splice(0,1,G))}}),b=z({get(){return e.column?e.column.filteredValue||[]:[]},set(G){e.column&&e.upDataColumn("filteredValue",G)}}),S=z(()=>e.column?e.column.filterMultiple:!0),k=G=>G.value===_.value,M=()=>{u.value=!1},R=G=>{G.stopPropagation(),u.value=!u.value},w=()=>{u.value=!1},E=()=>{x(b.value),M()},N=()=>{b.value=[],x(b.value),M()},F=G=>{_.value=G,ks(G)?x([]):x(b.value),M()},x=G=>{e.store.commit("filterChange",{column:e.column,values:G}),e.store.updateAllSelected()};st(u,G=>{e.column&&e.upDataColumn("filterOpened",G)},{immediate:!0});const P=z(()=>{var G,H;return(H=(G=f.value)==null?void 0:G.popperRef)==null?void 0:H.contentRef});return{tooltipVisible:u,multiple:S,filterClassName:v,filteredValue:b,filterValue:_,filters:p,handleConfirm:E,handleReset:N,handleSelect:F,isPropAbsent:ks,isActive:k,t:o,ns:i,showFilterPanel:R,hideFilterPanel:w,popperPaneRef:P,tooltip:f}}});function xOe(e,t,o,i,c,u){const f=Cn("el-checkbox"),p=Cn("el-checkbox-group"),v=Cn("el-scrollbar"),_=Cn("arrow-up"),b=Cn("arrow-down"),S=Cn("el-icon"),k=Cn("el-tooltip"),M=_T("click-outside");return ee(),We(k,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:Ae(()=>[e.multiple?(ee(),ge("div",{key:0},[Ee("div",{class:ne(e.ns.e("content"))},[Me(v,{"wrap-class":e.ns.e("wrap")},{default:Ae(()=>[Me(p,{modelValue:e.filteredValue,"onUpdate:modelValue":R=>e.filteredValue=R,class:ne(e.ns.e("checkbox-group"))},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(e.filters,R=>(ee(),We(f,{key:R.value,value:R.value},{default:Ae(()=>[Mn(mt(R.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),Ee("div",{class:ne(e.ns.e("bottom"))},[Ee("button",{class:ne({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},mt(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),Ee("button",{type:"button",onClick:e.handleReset},mt(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(ee(),ge("ul",{key:1,class:ne(e.ns.e("list"))},[Ee("li",{class:ne([e.ns.e("list-item"),{[e.ns.is("active")]:e.isPropAbsent(e.filterValue)}]),onClick:R=>e.handleSelect(null)},mt(e.t("el.table.clearFilter")),11,["onClick"]),(ee(!0),ge(Ht,null,Un(e.filters,R=>(ee(),ge("li",{key:R.value,class:ne([e.ns.e("list-item"),e.ns.is("active",e.isActive(R))]),label:R.value,onClick:w=>e.handleSelect(R.value)},mt(R.text),11,["label","onClick"]))),128))],2))]),default:Ae(()=>[fn((ee(),ge("span",{class:ne([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[Me(S,null,{default:Ae(()=>[Ve(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(ee(),We(_,{key:0})):(ee(),We(b,{key:1}))])]),_:3})],10,["onClick"])),[[M,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var UOe=vt(POe,[["render",xOe],["__file","filter-panel.vue"]]);function QN(e){const t=kn();bT(()=>{o.value.addObserver(t)}),mn(()=>{i(o.value),c(o.value)}),dl(()=>{i(o.value),c(o.value)}),rh(()=>{o.value.removeObserver(t)});const o=z(()=>{const u=e.layout;if(!u)throw new Error("Can not find table layout.");return u}),i=u=>{var f;const p=((f=e.vnode.el)==null?void 0:f.querySelectorAll("colgroup > col"))||[];if(!p.length)return;const v=u.getFlattenColumns(),_={};v.forEach(b=>{_[b.id]=b});for(let b=0,S=p.length;b<S;b++){const k=p[b],M=k.getAttribute("name"),R=_[M];R&&k.setAttribute("width",R.realWidth||R.width)}},c=u=>{var f,p;const v=((f=e.vnode.el)==null?void 0:f.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let b=0,S=v.length;b<S;b++)v[b].setAttribute("width",u.scrollY.value?u.gutterWidth:"0");const _=((p=e.vnode.el)==null?void 0:p.querySelectorAll("th.gutter"))||[];for(let b=0,S=_.length;b<S;b++){const k=_[b];k.style.width=u.scrollY.value?`${u.gutterWidth}px`:"0",k.style.display=u.scrollY.value?"":"none"}};return{tableLayout:o.value,onColumnsChange:i,onScrollableChange:c}}const ml=Symbol("ElTable");function FOe(e,t){const o=kn(),i=Rt(ml),c=w=>{w.stopPropagation()},u=(w,E)=>{!E.filters&&E.sortable?R(w,E,!1):E.filterable&&!E.sortable&&c(w),i==null||i.emit("header-click",E,w)},f=(w,E)=>{i==null||i.emit("header-contextmenu",E,w)},p=le(null),v=le(!1),_=le({}),b=(w,E)=>{if($n&&!(E.children&&E.children.length>0)&&p.value&&e.border){v.value=!0;const N=i;t("set-drag-visible",!0);const x=(N==null?void 0:N.vnode.el).getBoundingClientRect().left,P=o.vnode.el.querySelector(`th.${E.id}`),G=P.getBoundingClientRect(),H=G.left-x+30;Ss(P,"noclick"),_.value={startMouseLeft:w.clientX,startLeft:G.right-x,startColumnLeft:G.left-x,tableLeft:x};const Y=N==null?void 0:N.refs.resizeProxy;Y.style.left=`${_.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const j=O=>{const Q=O.clientX-_.value.startMouseLeft,J=_.value.startLeft+Q;Y.style.left=`${Math.max(H,J)}px`},W=()=>{if(v.value){const{startColumnLeft:O,startLeft:Q}=_.value,oe=Number.parseInt(Y.style.left,10)-O;E.width=E.realWidth=oe,N==null||N.emit("header-dragend",E.width,Q-O,E,w),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",v.value=!1,p.value=null,_.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",W),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{Ji(P,"noclick")},0)};document.addEventListener("mousemove",j),document.addEventListener("mouseup",W)}},S=(w,E)=>{var N;if(E.children&&E.children.length>0)return;const F=w.target;if(!la(F))return;const x=F==null?void 0:F.closest("th");if(!(!E||!E.resizable||!x)&&!v.value&&e.border){const P=x.getBoundingClientRect(),G=document.body.style,H=((N=x.parentNode)==null?void 0:N.lastElementChild)===x,Y=e.allowDragLastColumn||!H;P.width>12&&P.right-w.clientX<8&&Y?(G.cursor="col-resize",wa(x,"is-sortable")&&(x.style.cursor="col-resize"),p.value=E):v.value||(G.cursor="",wa(x,"is-sortable")&&(x.style.cursor="pointer"),p.value=null)}},k=()=>{$n&&(document.body.style.cursor="")},M=({order:w,sortOrders:E})=>{if(w==="")return E[0];const N=E.indexOf(w||null);return E[N>E.length-2?0:N+1]},R=(w,E,N)=>{var F;w.stopPropagation();const x=E.order===N?null:N||M(E),P=(F=w.target)==null?void 0:F.closest("th");if(P&&wa(P,"noclick")){Ji(P,"noclick");return}if(!E.sortable)return;const G=w.currentTarget;if(["ascending","descending"].some(O=>wa(G,O)&&!E.sortOrders.includes(O)))return;const H=e.store.states;let Y=H.sortProp.value,j;const W=H.sortingColumn.value;(W!==E||W===E&&iI(W.order))&&(W&&(W.order=null),H.sortingColumn.value=E,Y=E.property),x?j=E.order=x:j=E.order=null,H.sortProp.value=Y,H.sortOrder.value=j,i==null||i.store.commit("changeSortCondition")};return{handleHeaderClick:u,handleHeaderContextMenu:f,handleMouseDown:b,handleMouseMove:S,handleMouseOut:k,handleSortClick:R,handleFilterClick:c}}function VOe(e){const t=Rt(ml),o=ut("table");return{getHeaderRowStyle:p=>{const v=t==null?void 0:t.props.headerRowStyle;return zt(v)?v.call(null,{rowIndex:p}):v},getHeaderRowClass:p=>{const v=[],_=t==null?void 0:t.props.headerRowClassName;return Ut(_)?v.push(_):zt(_)&&v.push(_.call(null,{rowIndex:p})),v.join(" ")},getHeaderCellStyle:(p,v,_,b)=>{var S;let k=(S=t==null?void 0:t.props.headerCellStyle)!=null?S:{};zt(k)&&(k=k.call(null,{rowIndex:p,columnIndex:v,row:_,column:b}));const M=ZN(v,b.fixed,e.store,_);return nv(M,"left"),nv(M,"right"),Object.assign({},k,M)},getHeaderCellClass:(p,v,_,b)=>{const S=XN(o.b(),v,b.fixed,e.store,_),k=[b.id,b.order,b.headerAlign,b.className,b.labelClassName,...S];b.children||k.push("is-leaf"),b.sortable&&k.push("is-sortable");const M=t==null?void 0:t.props.headerCellClassName;return Ut(M)?k.push(M):zt(M)&&k.push(M.call(null,{rowIndex:p,columnIndex:v,row:_,column:b})),k.push(o.e("cell")),k.filter(R=>!!R).join(" ")}}}const Gz=e=>{const t=[];return e.forEach(o=>{o.children?(t.push(o),t.push.apply(t,Gz(o.children))):t.push(o)}),t},Bz=e=>{let t=1;const o=(u,f)=>{if(f&&(u.level=f.level+1,t<u.level&&(t=u.level)),u.children){let p=0;u.children.forEach(v=>{o(v,u),p+=v.colSpan}),u.colSpan=p}else u.colSpan=1};e.forEach(u=>{u.level=1,o(u,void 0)});const i=[];for(let u=0;u<t;u++)i.push([]);return Gz(e).forEach(u=>{u.children?(u.rowSpan=1,u.children.forEach(f=>f.isSubColumn=!0)):u.rowSpan=t-u.level+1,i[u.level-1].push(u)}),i};function GOe(e){const t=Rt(ml),o=z(()=>Bz(e.store.states.originColumns.value));return{isGroup:z(()=>{const u=o.value.length>1;return u&&t&&(t.state.isGroup.value=!0),u}),toggleAllSelection:u=>{u.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:o}}var BOe=Te({name:"ElTableHeader",components:{ElCheckbox:Ls},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String},allowDragLastColumn:{type:Boolean}},setup(e,{emit:t}){const o=kn(),i=Rt(ml),c=ut("table"),u=le({}),{onColumnsChange:f,onScrollableChange:p}=QN(i),v=(i==null?void 0:i.props.tableLayout)==="auto",_=eo(new Map),b=le(),S=()=>{setTimeout(()=>{_.size>0&&(_.forEach((O,Q)=>{const J=b.value.querySelector(`.${Q.replace(/\s/g,".")}`);if(J){const oe=J.getBoundingClientRect().width;O.width=oe}}),_.clear())})};st(_,S),mn(async()=>{await Vt(),await Vt();const{prop:O,order:Q}=e.defaultSort;i==null||i.store.commit("sort",{prop:O,order:Q,init:!0}),S()});const{handleHeaderClick:k,handleHeaderContextMenu:M,handleMouseDown:R,handleMouseMove:w,handleMouseOut:E,handleSortClick:N,handleFilterClick:F}=FOe(e,t),{getHeaderRowStyle:x,getHeaderRowClass:P,getHeaderCellStyle:G,getHeaderCellClass:H}=VOe(e),{isGroup:Y,toggleAllSelection:j,columnRows:W}=GOe(e);return o.state={onColumnsChange:f,onScrollableChange:p},o.filterPanels=u,{ns:c,filterPanels:u,onColumnsChange:f,onScrollableChange:p,columnRows:W,getHeaderRowClass:P,getHeaderRowStyle:x,getHeaderCellClass:H,getHeaderCellStyle:G,handleHeaderClick:k,handleHeaderContextMenu:M,handleMouseDown:R,handleMouseMove:w,handleMouseOut:E,handleSortClick:N,handleFilterClick:F,isGroup:Y,toggleAllSelection:j,saveIndexSelection:_,isTableLayoutAuto:v,theadRef:b,updateFixedColumnStyle:S}},render(){const{ns:e,isGroup:t,columnRows:o,getHeaderCellStyle:i,getHeaderCellClass:c,getHeaderRowClass:u,getHeaderRowStyle:f,handleHeaderClick:p,handleHeaderContextMenu:v,handleMouseDown:_,handleMouseMove:b,handleSortClick:S,handleMouseOut:k,store:M,$parent:R,saveIndexSelection:w,isTableLayoutAuto:E}=this;let N=1;return Jt("thead",{ref:"theadRef",class:{[e.is("group")]:t}},o.map((F,x)=>Jt("tr",{class:u(x),key:x,style:f(x)},F.map((P,G)=>{P.rowSpan>N&&(N=P.rowSpan);const H=c(x,G,F,P);return E&&P.fixed&&w.set(H,P),Jt("th",{class:H,colspan:P.colSpan,key:`${P.id}-thead`,rowspan:P.rowSpan,style:i(x,G,F,P),onClick:Y=>{Y.currentTarget.classList.contains("noclick")||p(Y,P)},onContextmenu:Y=>v(Y,P),onMousedown:Y=>_(Y,P),onMousemove:Y=>b(Y,P),onMouseout:k},[Jt("div",{class:["cell",P.filteredValue&&P.filteredValue.length>0?"highlight":""]},[P.renderHeader?P.renderHeader({column:P,$index:G,store:M,_self:R}):P.label,P.sortable&&Jt("span",{onClick:Y=>S(Y,P),class:"caret-wrapper"},[Jt("i",{onClick:Y=>S(Y,P,"ascending"),class:"sort-caret ascending"}),Jt("i",{onClick:Y=>S(Y,P,"descending"),class:"sort-caret descending"})]),P.filterable&&Jt(UOe,{store:M,placement:P.filterPlacement||"bottom-start",appendTo:R.appendFilterPanelTo,column:P,upDataColumn:(Y,j)=>{P[Y]=j}},{"filter-icon":()=>P.renderFilterIcon?P.renderFilterIcon({filterOpened:P.filterOpened}):null})])])}))))}});function uD(e,t,o=.03){return e-t>o}function HOe(e){const t=Rt(ml),o=le(""),i=le(Jt("div")),c=(R,w,E)=>{var N;const F=t,x=cD(R);let P;const G=(N=F==null?void 0:F.vnode.el)==null?void 0:N.dataset.prefix;x&&(P=XB({columns:e.store.states.columns.value},x,G),P&&(F==null||F.emit(`cell-${E}`,w,P,x,R))),F==null||F.emit(`row-${E}`,w,P,R)},u=(R,w)=>{c(R,w,"dblclick")},f=(R,w)=>{e.store.commit("setCurrentRow",w),c(R,w,"click")},p=(R,w)=>{c(R,w,"contextmenu")},v=Oa(R=>{e.store.commit("setHoverRow",R)},30),_=Oa(()=>{e.store.commit("setHoverRow",null)},30),b=R=>{const w=window.getComputedStyle(R,null),E=Number.parseInt(w.paddingLeft,10)||0,N=Number.parseInt(w.paddingRight,10)||0,F=Number.parseInt(w.paddingTop,10)||0,x=Number.parseInt(w.paddingBottom,10)||0;return{left:E,right:N,top:F,bottom:x}},S=(R,w,E)=>{let N=w.target.parentNode;for(;R>1&&(N=N==null?void 0:N.nextSibling,!(!N||N.nodeName!=="TR"));)E(N,"hover-row hover-fixed-row"),R--};return{handleDoubleClick:u,handleClick:f,handleContextMenu:p,handleMouseEnter:v,handleMouseLeave:_,handleCellMouseEnter:(R,w,E)=>{var N,F,x;const P=t,G=cD(R),H=(N=P==null?void 0:P.vnode.el)==null?void 0:N.dataset.prefix;let Y;if(G){Y=XB({columns:e.store.states.columns.value},G,H),G.rowSpan>1&&S(G.rowSpan,R,Ss);const ye=P.hoverState={cell:G,column:Y,row:w};P==null||P.emit("cell-mouse-enter",ye.row,ye.column,ye.cell,R)}if(!E)return;const j=R.target.querySelector(".cell");if(!(wa(j,`${H}-tooltip`)&&j.childNodes.length))return;const W=document.createRange();W.setStart(j,0),W.setEnd(j,j.childNodes.length);const{width:O,height:Q}=W.getBoundingClientRect(),{width:J,height:oe}=j.getBoundingClientRect(),{top:pe,left:ie,right:te,bottom:he}=b(j),re=ie+te,X=pe+he;uD(O+re,J)||uD(Q+X,oe)||uD(j.scrollWidth,J)?EOe(E,G.innerText||G.textContent,w,Y,G,P):((F=Ta)==null?void 0:F.trigger)===G&&((x=Ta)==null||x())},handleCellMouseLeave:R=>{const w=cD(R);if(!w)return;w.rowSpan>1&&S(w.rowSpan,R,Ji);const E=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",E==null?void 0:E.row,E==null?void 0:E.column,E==null?void 0:E.cell,R)},tooltipContent:o,tooltipTrigger:i}}function $Oe(e){const t=Rt(ml),o=ut("table");return{getRowStyle:(_,b)=>{const S=t==null?void 0:t.props.rowStyle;return zt(S)?S.call(null,{row:_,rowIndex:b}):S||null},getRowClass:(_,b)=>{const S=[o.e("row")];t!=null&&t.props.highlightCurrentRow&&_===e.store.states.currentRow.value&&S.push("current-row"),e.stripe&&b%2===1&&S.push(o.em("row","striped"));const k=t==null?void 0:t.props.rowClassName;return Ut(k)?S.push(k):zt(k)&&S.push(k.call(null,{row:_,rowIndex:b})),S},getCellStyle:(_,b,S,k)=>{const M=t==null?void 0:t.props.cellStyle;let R=M??{};zt(M)&&(R=M.call(null,{rowIndex:_,columnIndex:b,row:S,column:k}));const w=ZN(b,e==null?void 0:e.fixed,e.store);return nv(w,"left"),nv(w,"right"),Object.assign({},R,w)},getCellClass:(_,b,S,k,M)=>{const R=XN(o.b(),b,e==null?void 0:e.fixed,e.store,void 0,M),w=[k.id,k.align,k.className,...R],E=t==null?void 0:t.props.cellClassName;return Ut(E)?w.push(E):zt(E)&&w.push(E.call(null,{rowIndex:_,columnIndex:b,row:S,column:k})),w.push(o.e("cell")),w.filter(N=>!!N).join(" ")},getSpan:(_,b,S,k)=>{let M=1,R=1;const w=t==null?void 0:t.props.spanMethod;if(zt(w)){const E=w({row:_,column:b,rowIndex:S,columnIndex:k});ht(E)?(M=E[0],R=E[1]):gn(E)&&(M=E.rowspan,R=E.colspan)}return{rowspan:M,colspan:R}},getColspanRealWidth:(_,b,S)=>{if(b<1)return _[S].realWidth;const k=_.map(({realWidth:M,width:R})=>M||R).slice(S,S+b);return Number(k.reduce((M,R)=>Number(M)+Number(R),-1))}}}const qOe=Te({name:"TableTdWrapper"}),KOe=Te({...qOe,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,o)=>(ee(),ge("td",{colspan:e.colspan,rowspan:e.rowspan},[Ve(t.$slots,"default")],8,["colspan","rowspan"]))}});var zOe=vt(KOe,[["__file","td-wrapper.vue"]]);function WOe(e){const t=Rt(ml),o=ut("table"),{handleDoubleClick:i,handleClick:c,handleContextMenu:u,handleMouseEnter:f,handleMouseLeave:p,handleCellMouseEnter:v,handleCellMouseLeave:_,tooltipContent:b,tooltipTrigger:S}=HOe(e),{getRowStyle:k,getRowClass:M,getCellStyle:R,getCellClass:w,getSpan:E,getColspanRealWidth:N}=$Oe(e),F=z(()=>e.store.states.columns.value.findIndex(({type:Y})=>Y==="default")),x=(Y,j)=>{const W=t.props.rowKey;return W?ji(Y,W):j},P=(Y,j,W,O=!1)=>{const{tooltipEffect:Q,tooltipOptions:J,store:oe}=e,{indent:pe,columns:ie}=oe.states,te=M(Y,j);let he=!0;return W&&(te.push(o.em("row",`level-${W.level}`)),he=W.display),Jt("tr",{style:[he?null:{display:"none"},k(Y,j)],class:te,key:x(Y,j),onDblclick:X=>i(X,Y),onClick:X=>c(X,Y),onContextmenu:X=>u(X,Y),onMouseenter:()=>f(j),onMouseleave:p},ie.value.map((X,ye)=>{const{rowspan:ue,colspan:Ie}=E(Y,X,j,ye);if(!ue||!Ie)return null;const ve=Object.assign({},X);ve.realWidth=N(ie.value,Ie,ye);const Ce={store:e.store,_self:e.context||t,column:ve,row:Y,$index:j,cellIndex:ye,expanded:O};ye===F.value&&W&&(Ce.treeNode={indent:W.level*pe.value,level:W.level},vo(W.expanded)&&(Ce.treeNode.expanded=W.expanded,"loading"in W&&(Ce.treeNode.loading=W.loading),"noLazyChildren"in W&&(Ce.treeNode.noLazyChildren=W.noLazyChildren)));const Fe=`${x(Y,j)},${ye}`,Oe=ve.columnKey||ve.rawColumnKey||"",be=X.showOverflowTooltip&&Uq({effect:Q},J,X.showOverflowTooltip);return Jt(zOe,{style:R(j,ye,Y,X),class:w(j,ye,Y,X,Ie-1),key:`${Oe}${Fe}`,rowspan:ue,colspan:Ie,onMouseenter:xe=>v(xe,Y,be),onMouseleave:_},{default:()=>G(ye,X,Ce)})}))},G=(Y,j,W)=>j.renderCell(W);return{wrappedRowRender:(Y,j)=>{const W=e.store,{isRowExpanded:O,assertRowKey:Q}=W,{treeData:J,lazyTreeNodeMap:oe,childrenColumnName:pe,rowKey:ie}=W.states,te=W.states.columns.value;if(te.some(({type:re})=>re==="expand")){const re=O(Y),X=P(Y,j,void 0,re),ye=t.renderExpanded;if(!ye)return console.error("[Element Error]renderExpanded is required."),X;const ue=[[X]];return(t.props.preserveExpandedContent||re)&&ue[0].push(Jt("tr",{key:`expanded-row__${X.key}`,style:{display:re?"":"none"}},[Jt("td",{colspan:te.length,class:`${o.e("cell")} ${o.e("expanded-cell")}`},[ye({row:Y,$index:j,store:W,expanded:re})])])),ue}else if(Object.keys(J.value).length){Q();const re=ji(Y,ie.value);let X=J.value[re],ye=null;X&&(ye={expanded:X.expanded,level:X.level,display:!0},vo(X.lazy)&&(vo(X.loaded)&&X.loaded&&(ye.noLazyChildren=!(X.children&&X.children.length)),ye.loading=X.loading));const ue=[P(Y,j,ye)];if(X){let Ie=0;const ve=(Fe,Oe)=>{Fe&&Fe.length&&Oe&&Fe.forEach(be=>{const xe={display:Oe.display&&Oe.expanded,level:Oe.level+1,expanded:!1,noLazyChildren:!1,loading:!1},Le=ji(be,ie.value);if(ks(Le))throw new Error("For nested data item, row-key is required.");if(X={...J.value[Le]},X&&(xe.expanded=X.expanded,X.level=X.level||xe.level,X.display=!!(X.expanded&&xe.display),vo(X.lazy)&&(vo(X.loaded)&&X.loaded&&(xe.noLazyChildren=!(X.children&&X.children.length)),xe.loading=X.loading)),Ie++,ue.push(P(be,j+Ie,xe)),X){const rt=oe.value[Le]||be[pe.value];ve(rt,X)}})};X.display=!0;const Ce=oe.value[re]||Y[pe.value];ve(Ce,X)}return ue}else return P(Y,j,void 0)},tooltipContent:b,tooltipTrigger:S}}const jOe={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var YOe=Te({name:"ElTableBody",props:jOe,setup(e){const t=kn(),o=Rt(ml),i=ut("table"),{wrappedRowRender:c,tooltipContent:u,tooltipTrigger:f}=WOe(e),{onColumnsChange:p,onScrollableChange:v}=QN(o),_=[];return st(e.store.states.hoverRow,(b,S)=>{var k;const M=t==null?void 0:t.vnode.el,R=Array.from((M==null?void 0:M.children)||[]).filter(N=>N==null?void 0:N.classList.contains(`${i.e("row")}`));let w=b;const E=(k=R[w])==null?void 0:k.childNodes;if(E!=null&&E.length){let N=0;Array.from(E).reduce((x,P,G)=>{var H,Y;return((H=E[G])==null?void 0:H.colSpan)>1&&(N=(Y=E[G])==null?void 0:Y.colSpan),P.nodeName!=="TD"&&N===0&&x.push(G),N>0&&N--,x},[]).forEach(x=>{var P;for(w=b;w>0;){const G=(P=R[w-1])==null?void 0:P.childNodes;if(G[x]&&G[x].nodeName==="TD"&&G[x].rowSpan>1){Ss(G[x],"hover-cell"),_.push(G[x]);break}w--}})}else _.forEach(N=>Ji(N,"hover-cell")),_.length=0;!e.store.states.isComplex.value||!$n||Wd(()=>{const N=R[S],F=R[b];N&&!N.classList.contains("hover-fixed-row")&&Ji(N,"hover-row"),F&&Ss(F,"hover-row")})}),rh(()=>{var b;(b=Ta)==null||b()}),{ns:i,onColumnsChange:p,onScrollableChange:v,wrappedRowRender:c,tooltipContent:u,tooltipTrigger:f}},render(){const{wrappedRowRender:e,store:t}=this,o=t.states.data.value||[];return Jt("tbody",{tabIndex:-1},[o.reduce((i,c)=>i.concat(e(c,i.length)),[])])}});function JOe(){const e=Rt(ml),t=e==null?void 0:e.store,o=z(()=>t.states.fixedLeafColumnsLength.value),i=z(()=>t.states.rightFixedColumns.value.length),c=z(()=>t.states.columns.value.length),u=z(()=>t.states.fixedColumns.value.length),f=z(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:o,rightFixedLeafCount:i,columnsCount:c,leftFixedCount:u,rightFixedCount:f,columns:t.states.columns}}function XOe(e){const{columns:t}=JOe(),o=ut("table");return{getCellClasses:(u,f)=>{const p=u[f],v=[o.e("cell"),p.id,p.align,p.labelClassName,...XN(o.b(),f,p.fixed,e.store)];return p.className&&v.push(p.className),p.children||v.push(o.is("leaf")),v},getCellStyles:(u,f)=>{const p=ZN(f,u.fixed,e.store);return nv(p,"left"),nv(p,"right"),p},columns:t}}var ZOe=Te({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const t=Rt(ml),o=ut("table"),{getCellClasses:i,getCellStyles:c,columns:u}=XOe(e),{onScrollableChange:f,onColumnsChange:p}=QN(t);return{ns:o,onScrollableChange:f,onColumnsChange:p,getCellClasses:i,getCellStyles:c,columns:u}},render(){const{columns:e,getCellStyles:t,getCellClasses:o,summaryMethod:i,sumText:c}=this,u=this.store.states.data.value;let f=[];return i?f=i({columns:e,data:u}):e.forEach((p,v)=>{if(v===0){f[v]=c;return}const _=u.map(M=>Number(M[p.property])),b=[];let S=!0;_.forEach(M=>{if(!Number.isNaN(+M)){S=!1;const R=`${M}`.split(".")[1];b.push(R?R.length:0)}});const k=Math.max.apply(null,b);S?f[v]="":f[v]=_.reduce((M,R)=>{const w=Number(R);return Number.isNaN(+w)?M:Number.parseFloat((M+R).toFixed(Math.min(k,20)))},0)}),Jt(Jt("tfoot",[Jt("tr",{},[...e.map((p,v)=>Jt("td",{key:v,colspan:p.colSpan,rowspan:p.rowSpan,class:o(e,v),style:t(p,v)},[Jt("div",{class:["cell",p.labelClassName]},[f[v]])]))])]))}});function QOe(e){return{setCurrentRow:S=>{e.commit("setCurrentRow",S)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(S,k,M=!0)=>{e.toggleRowSelection(S,k,!1,M),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:S=>{e.clearFilter(S)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(S,k)=>{e.toggleRowExpansionAdapter(S,k)},clearSort:()=>{e.clearSort()},sort:(S,k)=>{e.commit("sort",{prop:S,order:k})},updateKeyChildren:(S,k)=>{e.updateKeyChildren(S,k)}}}function eLe(e,t,o,i){const c=le(!1),u=le(null),f=le(!1),p=re=>{f.value=re},v=le({width:null,height:null,headerHeight:null}),_=le(!1),b={display:"inline-block",verticalAlign:"middle"},S=le(),k=le(0),M=le(0),R=le(0),w=le(0),E=le(0);Di(()=>{t.setHeight(e.height)}),Di(()=>{t.setMaxHeight(e.maxHeight)}),st(()=>[e.currentRowKey,o.states.rowKey],([re,X])=>{!y(X)||!y(re)||o.setCurrentRowKey(`${re}`)},{immediate:!0}),st(()=>e.data,re=>{i.store.commit("setData",re)},{immediate:!0,deep:!0}),Di(()=>{e.expandRowKeys&&o.setExpandRowKeysAdapter(e.expandRowKeys)});const N=()=>{i.store.commit("setHoverRow",null),i.hoverState&&(i.hoverState=null)},F=(re,X)=>{const{pixelX:ye,pixelY:ue}=X;Math.abs(ye)>=Math.abs(ue)&&(i.refs.bodyWrapper.scrollLeft+=X.pixelX/5)},x=z(()=>e.height||e.maxHeight||o.states.fixedColumns.value.length>0||o.states.rightFixedColumns.value.length>0),P=z(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),G=()=>{x.value&&t.updateElsHeight(),t.updateColumnsWidth(),!(typeof window>"u")&&requestAnimationFrame(W)};mn(async()=>{await Vt(),o.updateColumns(),O(),requestAnimationFrame(G);const re=i.vnode.el,X=i.refs.headerWrapper;e.flexible&&re&&re.parentElement&&(re.parentElement.style.minWidth="0"),v.value={width:S.value=re.offsetWidth,height:re.offsetHeight,headerHeight:e.showHeader&&X?X.offsetHeight:null},o.states.columns.value.forEach(ye=>{ye.filteredValue&&ye.filteredValue.length&&i.store.commit("filterChange",{column:ye,values:ye.filteredValue,silent:!0})}),i.$ready=!0});const H=(re,X)=>{if(!re)return;const ye=Array.from(re.classList).filter(ue=>!ue.startsWith("is-scrolling-"));ye.push(t.scrollX.value?X:"is-scrolling-none"),re.className=ye.join(" ")},Y=re=>{const{tableWrapper:X}=i.refs;H(X,re)},j=re=>{const{tableWrapper:X}=i.refs;return!!(X&&X.classList.contains(re))},W=function(){if(!i.refs.scrollBarRef)return;if(!t.scrollX.value){const Fe="is-scrolling-none";j(Fe)||Y(Fe);return}const re=i.refs.scrollBarRef.wrapRef;if(!re)return;const{scrollLeft:X,offsetWidth:ye,scrollWidth:ue}=re,{headerWrapper:Ie,footerWrapper:ve}=i.refs;Ie&&(Ie.scrollLeft=X),ve&&(ve.scrollLeft=X);const Ce=ue-ye-1;X>=Ce?Y("is-scrolling-right"):Y(X===0?"is-scrolling-left":"is-scrolling-middle")},O=()=>{i.refs.scrollBarRef&&(i.refs.scrollBarRef.wrapRef&&_o(i.refs.scrollBarRef.wrapRef,"scroll",W,{passive:!0}),e.fit?ar(i.vnode.el,Q):_o(window,"resize",Q),ar(i.refs.bodyWrapper,()=>{var re,X;Q(),(X=(re=i.refs)==null?void 0:re.scrollBarRef)==null||X.update()}))},Q=()=>{var re,X,ye,ue;const Ie=i.vnode.el;if(!i.$ready||!Ie)return;let ve=!1;const{width:Ce,height:Fe,headerHeight:Oe}=v.value,be=S.value=Ie.offsetWidth;Ce!==be&&(ve=!0);const xe=Ie.offsetHeight;(e.height||x.value)&&Fe!==xe&&(ve=!0);const Le=e.tableLayout==="fixed"?i.refs.headerWrapper:(re=i.refs.tableHeaderRef)==null?void 0:re.$el;e.showHeader&&(Le==null?void 0:Le.offsetHeight)!==Oe&&(ve=!0),k.value=((X=i.refs.tableWrapper)==null?void 0:X.scrollHeight)||0,R.value=(Le==null?void 0:Le.scrollHeight)||0,w.value=((ye=i.refs.footerWrapper)==null?void 0:ye.offsetHeight)||0,E.value=((ue=i.refs.appendWrapper)==null?void 0:ue.offsetHeight)||0,M.value=k.value-R.value-w.value-E.value,ve&&(v.value={width:be,height:xe,headerHeight:e.showHeader&&(Le==null?void 0:Le.offsetHeight)||0},G())},J=Fr(),oe=z(()=>{const{bodyWidth:re,scrollY:X,gutterWidth:ye}=t;return re.value?`${re.value-(X.value?ye:0)}px`:""}),pe=z(()=>e.maxHeight?"fixed":e.tableLayout),ie=z(()=>{if(e.data&&e.data.length)return null;let re="100%";e.height&&M.value&&(re=`${M.value}px`);const X=S.value;return{width:X?`${X}px`:"",height:re}}),te=z(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${R.value+w.value}px)`}:{maxHeight:`${e.maxHeight-R.value-w.value}px`}:{});return{isHidden:c,renderExpanded:u,setDragVisible:p,isGroup:_,handleMouseLeave:N,handleHeaderFooterMousewheel:F,tableSize:J,emptyBlockStyle:ie,handleFixedMousewheel:(re,X)=>{const ye=i.refs.bodyWrapper;if(Math.abs(X.spinY)>0){const ue=ye.scrollTop;X.pixelY<0&&ue!==0&&re.preventDefault(),X.pixelY>0&&ye.scrollHeight-ye.clientHeight>ue&&re.preventDefault(),ye.scrollTop+=Math.ceil(X.pixelY/5)}else ye.scrollLeft+=Math.ceil(X.pixelX/5)},resizeProxyVisible:f,bodyWidth:oe,resizeState:v,doLayout:G,tableBodyStyles:P,tableLayout:pe,scrollbarViewStyle:b,scrollbarStyle:te}}function tLe(e){const t=le(),o=()=>{const c=e.vnode.el.querySelector(".hidden-columns"),u={childList:!0,subtree:!0},f=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{f.forEach(p=>p())}),t.value.observe(c,u)};mn(()=>{o()}),rh(()=>{var i;(i=t.value)==null||i.disconnect()})}var nLe={data:{type:Array,default:()=>[]},size:Kr,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],tooltipFormatter:Function,appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0},allowDragLastColumn:{type:Boolean,default:!0},preserveExpandedContent:{type:Boolean,default:!1}};function Hz(e){const t=e.tableLayout==="auto";let o=e.columns||[];t&&o.every(({width:c})=>qn(c))&&(o=[]);const i=c=>{const u={key:`${e.tableLayout}_${c.id}`,style:{},name:void 0};return t?u.style={width:`${c.width}px`}:u.name=c.id,u};return Jt("colgroup",{},o.map(c=>Jt("col",i(c))))}Hz.props=["columns","tableLayout"];const oLe=()=>{const e=le(),t=(u,f)=>{const p=e.value;p&&p.scrollTo(u,f)},o=(u,f)=>{const p=e.value;p&&jt(f)&&["Top","Left"].includes(u)&&p[`setScroll${u}`](f)};return{scrollBarRef:e,scrollTo:t,setScrollTop:u=>o("Top",u),setScrollLeft:u=>o("Left",u)}};var eH=!1,Pf,wO,RO,gE,vE,$z,_E,AO,DO,OO,qz,LO,NO,Kz,zz;function Sa(){if(!eH){eH=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),o=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(LO=/\b(iPhone|iP[ao]d)/.exec(e),NO=/\b(iP[ao]d)/.exec(e),OO=/Android/i.exec(e),Kz=/FBAN\/\w+;/i.exec(e),zz=/Mobile/i.exec(e),qz=!!/Win64/.exec(e),t){Pf=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,Pf&&document&&document.documentMode&&(Pf=document.documentMode);var i=/(?:Trident\/(\d+.\d+))/.exec(e);$z=i?parseFloat(i[1])+4:Pf,wO=t[2]?parseFloat(t[2]):NaN,RO=t[3]?parseFloat(t[3]):NaN,gE=t[4]?parseFloat(t[4]):NaN,gE?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),vE=t&&t[1]?parseFloat(t[1]):NaN):vE=NaN}else Pf=wO=RO=vE=gE=NaN;if(o){if(o[1]){var c=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);_E=c?parseFloat(c[1].replace("_",".")):!0}else _E=!1;AO=!!o[2],DO=!!o[3]}else _E=AO=DO=!1}}var PO={ie:function(){return Sa()||Pf},ieCompatibilityMode:function(){return Sa()||$z>Pf},ie64:function(){return PO.ie()&&qz},firefox:function(){return Sa()||wO},opera:function(){return Sa()||RO},webkit:function(){return Sa()||gE},safari:function(){return PO.webkit()},chrome:function(){return Sa()||vE},windows:function(){return Sa()||AO},osx:function(){return Sa()||_E},linux:function(){return Sa()||DO},iphone:function(){return Sa()||LO},mobile:function(){return Sa()||LO||NO||OO||zz},nativeApp:function(){return Sa()||Kz},android:function(){return Sa()||OO},ipad:function(){return Sa()||NO}},rLe=PO,YS=!!(typeof window<"u"&&window.document&&window.document.createElement),iLe={canUseDOM:YS,canUseWorkers:typeof Worker<"u",canUseEventListeners:YS&&!!(window.addEventListener||window.attachEvent),canUseViewport:YS&&!!window.screen,isInWorker:!YS},Wz=iLe,jz;Wz.canUseDOM&&(jz=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function aLe(e,t){if(!Wz.canUseDOM||t&&!("addEventListener"in document))return!1;var o="on"+e,i=o in document;if(!i){var c=document.createElement("div");c.setAttribute(o,"return;"),i=typeof c[o]=="function"}return!i&&jz&&e==="wheel"&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var sLe=aLe,tH=10,nH=40,oH=800;function Yz(e){var t=0,o=0,i=0,c=0;return"detail"in e&&(o=e.detail),"wheelDelta"in e&&(o=-e.wheelDelta/120),"wheelDeltaY"in e&&(o=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=o,o=0),i=t*tH,c=o*tH,"deltaY"in e&&(c=e.deltaY),"deltaX"in e&&(i=e.deltaX),(i||c)&&e.deltaMode&&(e.deltaMode==1?(i*=nH,c*=nH):(i*=oH,c*=oH)),i&&!t&&(t=i<1?-1:1),c&&!o&&(o=c<1?-1:1),{spinX:t,spinY:o,pixelX:i,pixelY:c}}Yz.getEventType=function(){return rLe.firefox()?"DOMMouseScroll":sLe("wheel")?"wheel":"mousewheel"};var lLe=Yz;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const cLe=function(e,t){if(e&&e.addEventListener){const o=function(i){const c=lLe(i);t&&Reflect.apply(t,this,[i,c])};e.addEventListener("wheel",o,{passive:!0})}},uLe={beforeMount(e,t){cLe(e,t.value)}};let dLe=1;const hLe=Te({name:"ElTable",directives:{Mousewheel:uLe},components:{TableHeader:BOe,TableBody:YOe,TableFooter:ZOe,ElScrollbar:ac,hColgroup:Hz},props:nLe,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(e){const{t}=Kn(),o=ut("table"),i=kn();Nn(ml,i);const c=DOe(i,e);i.store=c;const u=new LOe({store:i.store,table:i,fit:e.fit,showHeader:e.showHeader});i.layout=u;const f=z(()=>(c.states.data.value||[]).length===0),{setCurrentRow:p,getSelectionRows:v,toggleRowSelection:_,clearSelection:b,clearFilter:S,toggleAllSelection:k,toggleRowExpansion:M,clearSort:R,sort:w,updateKeyChildren:E}=QOe(c),{isHidden:N,renderExpanded:F,setDragVisible:x,isGroup:P,handleMouseLeave:G,handleHeaderFooterMousewheel:H,tableSize:Y,emptyBlockStyle:j,handleFixedMousewheel:W,resizeProxyVisible:O,bodyWidth:Q,resizeState:J,doLayout:oe,tableBodyStyles:pe,tableLayout:ie,scrollbarViewStyle:te,scrollbarStyle:he}=eLe(e,u,c,i),{scrollBarRef:re,scrollTo:X,setScrollLeft:ye,setScrollTop:ue}=oLe(),Ie=Oa(oe,50),ve=`${o.namespace.value}-table_${dLe++}`;i.tableId=ve,i.state={isGroup:P,resizeState:J,doLayout:oe,debouncedUpdateLayout:Ie};const Ce=z(()=>{var be;return(be=e.sumText)!=null?be:t("el.table.sumText")}),Fe=z(()=>{var be;return(be=e.emptyText)!=null?be:t("el.table.emptyText")}),Oe=z(()=>Bz(c.states.originColumns.value)[0]);return tLe(i),Co(()=>{Ie.cancel()}),{ns:o,layout:u,store:c,columns:Oe,handleHeaderFooterMousewheel:H,handleMouseLeave:G,tableId:ve,tableSize:Y,isHidden:N,isEmpty:f,renderExpanded:F,resizeProxyVisible:O,resizeState:J,isGroup:P,bodyWidth:Q,tableBodyStyles:pe,emptyBlockStyle:j,debouncedUpdateLayout:Ie,handleFixedMousewheel:W,setCurrentRow:p,getSelectionRows:v,toggleRowSelection:_,clearSelection:b,clearFilter:S,toggleAllSelection:k,toggleRowExpansion:M,clearSort:R,doLayout:oe,sort:w,updateKeyChildren:E,t,setDragVisible:x,context:i,computedSumText:Ce,computedEmptyText:Fe,tableLayout:ie,scrollbarViewStyle:te,scrollbarStyle:he,scrollBarRef:re,scrollTo:X,setScrollLeft:ye,setScrollTop:ue,allowDragLastColumn:e.allowDragLastColumn}}});function fLe(e,t,o,i,c,u){const f=Cn("hColgroup"),p=Cn("table-header"),v=Cn("table-body"),_=Cn("table-footer"),b=Cn("el-scrollbar"),S=_T("mousewheel");return ee(),ge("div",{ref:"tableWrapper",class:ne([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:qt(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[Ee("div",{class:ne(e.ns.e("inner-wrapper"))},[Ee("div",{ref:"hiddenColumns",class:"hidden-columns"},[Ve(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?fn((ee(),ge("div",{key:0,ref:"headerWrapper",class:ne(e.ns.e("header-wrapper"))},[Ee("table",{ref:"tableHeader",class:ne(e.ns.e("header")),style:qt(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Me(p,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,"allow-drag-last-column":e.allowDragLastColumn,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","allow-drag-last-column","onSetDragVisible"])],6)],2)),[[S,e.handleHeaderFooterMousewheel]]):$e("v-if",!0),Ee("div",{ref:"bodyWrapper",class:ne(e.ns.e("body-wrapper"))},[Me(b,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex,onScroll:k=>e.$emit("scroll",k)},{default:Ae(()=>[Ee("table",{ref:"tableBody",class:ne(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:qt({width:e.bodyWidth,tableLayout:e.tableLayout})},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(ee(),We(p,{key:0,ref:"tableHeaderRef",class:ne(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):$e("v-if",!0),Me(v,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(ee(),We(_,{key:1,class:ne(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):$e("v-if",!0)],6),e.isEmpty?(ee(),ge("div",{key:0,ref:"emptyBlock",style:qt(e.emptyBlockStyle),class:ne(e.ns.e("empty-block"))},[Ee("span",{class:ne(e.ns.e("empty-text"))},[Ve(e.$slots,"empty",{},()=>[Mn(mt(e.computedEmptyText),1)])],2)],6)):$e("v-if",!0),e.$slots.append?(ee(),ge("div",{key:1,ref:"appendWrapper",class:ne(e.ns.e("append-wrapper"))},[Ve(e.$slots,"append")],2)):$e("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),e.showSummary&&e.tableLayout==="fixed"?fn((ee(),ge("div",{key:1,ref:"footerWrapper",class:ne(e.ns.e("footer-wrapper"))},[Ee("table",{class:ne(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:qt(e.tableBodyStyles)},[Me(f,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Me(_,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[Zn,!e.isEmpty],[S,e.handleHeaderFooterMousewheel]]):$e("v-if",!0),e.border||e.isGroup?(ee(),ge("div",{key:2,class:ne(e.ns.e("border-left-patch"))},null,2)):$e("v-if",!0)],2),fn(Ee("div",{ref:"resizeProxy",class:ne(e.ns.e("column-resize-proxy"))},null,2),[[Zn,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var pLe=vt(hLe,[["render",fLe],["__file","table.vue"]]);const mLe={selection:"table-column--selection",expand:"table__expand-column"},gLe={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},vLe=e=>mLe[e]||"",_Le={selection:{renderHeader({store:e,column:t}){function o(){return e.states.data.value&&e.states.data.value.length===0}return Jt(Ls,{disabled:o(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:o,$index:i}){return Jt(Ls,{disabled:t.selectable?!t.selectable.call(null,e,i):!1,size:o.states.tableSize.value,onChange:()=>{o.commit("rowSelectedChanged",e)},onClick:c=>c.stopPropagation(),modelValue:o.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let o=t+1;const i=e.index;return jt(i)?o=t+i:zt(i)&&(o=i(t)),Jt("div",{},[o])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:o}){const{ns:i}=t,c=[i.e("expand-icon")];return o&&c.push(i.em("expand-icon","expanded")),Jt("div",{class:c,onClick:function(f){f.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Jt(Pt,null,{default:()=>[Jt(ca)]})]})},sortable:!1,resizable:!1}};function yLe({row:e,column:t,$index:o}){var i;const c=t.property,u=c&&a0(e,c).value;return t&&t.formatter?t.formatter(e,t,u,o):((i=u==null?void 0:u.toString)==null?void 0:i.call(u))||""}function ILe({row:e,treeNode:t,store:o},i=!1){const{ns:c}=o;if(!t)return i?[Jt("span",{class:c.e("placeholder")})]:null;const u=[],f=function(p){p.stopPropagation(),!t.loading&&o.loadOrToggle(e)};if(t.indent&&u.push(Jt("span",{class:c.e("indent"),style:{"padding-left":`${t.indent}px`}})),vo(t.expanded)&&!t.noLazyChildren){const p=[c.e("expand-icon"),t.expanded?c.em("expand-icon","expanded"):""];let v=ca;t.loading&&(v=ec),u.push(Jt("div",{class:p,onClick:f},{default:()=>[Jt(Pt,{class:{[c.is("loading")]:t.loading}},{default:()=>[Jt(v)]})]}))}else u.push(Jt("span",{class:c.e("placeholder")}));return u}function rH(e,t){return e.reduce((o,i)=>(o[i]=i,o),t)}function bLe(e,t){const o=kn();return{registerComplexWatchers:()=>{const u=["fixed"],f={realWidth:"width",realMinWidth:"minWidth"},p=rH(u,f);Object.keys(p).forEach(v=>{const _=f[v];jn(t,_)&&st(()=>t[_],b=>{let S=b;_==="width"&&v==="realWidth"&&(S=JN(b)),_==="minWidth"&&v==="realMinWidth"&&(S=Pz(b)),o.columnConfig.value[_]=S,o.columnConfig.value[v]=S;const k=_==="fixed";e.value.store.scheduleLayout(k)})})},registerNormalWatchers:()=>{const u=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip","tooltipFormatter"],f={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},p=rH(u,f);Object.keys(p).forEach(v=>{const _=f[v];jn(t,_)&&st(()=>t[_],b=>{o.columnConfig.value[v]=b})})}}}function CLe(e,t,o){const i=kn(),c=le(""),u=le(!1),f=le(),p=le(),v=ut("table");Di(()=>{f.value=e.align?`is-${e.align}`:null,f.value}),Di(()=>{p.value=e.headerAlign?`is-${e.headerAlign}`:f.value,p.value});const _=z(()=>{let P=i.vnode.vParent||i.parent;for(;P&&!P.tableId&&!P.columnId;)P=P.vnode.vParent||P.parent;return P}),b=z(()=>{const{store:P}=i.parent;if(!P)return!1;const{treeData:G}=P.states,H=G.value;return H&&Object.keys(H).length>0}),S=le(JN(e.width)),k=le(Pz(e.minWidth)),M=P=>(S.value&&(P.width=S.value),k.value&&(P.minWidth=k.value),!S.value&&k.value&&(P.width=void 0),P.minWidth||(P.minWidth=80),P.realWidth=Number(qn(P.width)?P.minWidth:P.width),P),R=P=>{const G=P.type,H=_Le[G]||{};Object.keys(H).forEach(j=>{const W=H[j];j!=="className"&&!qn(W)&&(P[j]=W)});const Y=vLe(G);if(Y){const j=`${y(v.namespace)}-${Y}`;P.className=P.className?`${P.className} ${j}`:j}return P},w=P=>{ht(P)?P.forEach(H=>G(H)):G(P);function G(H){var Y;((Y=H==null?void 0:H.type)==null?void 0:Y.name)==="ElTableColumn"&&(H.vParent=i)}};return{columnId:c,realAlign:f,isSubColumn:u,realHeaderAlign:p,columnOrTableParent:_,setColumnWidth:M,setColumnForcedProps:R,setColumnRenders:P=>{e.renderHeader||P.type!=="selection"&&(P.renderHeader=H=>(i.columnConfig.value.label,Ve(t,"header",H,()=>[P.label]))),t["filter-icon"]&&(P.renderFilterIcon=H=>Ve(t,"filter-icon",H));let G=P.renderCell;return P.type==="expand"?(P.renderCell=H=>Jt("div",{class:"cell"},[G(H)]),o.value.renderExpanded=H=>t.default?t.default(H):t.default):(G=G||yLe,P.renderCell=H=>{let Y=null;if(t.default){const oe=t.default(H);Y=oe.some(pe=>pe.type!==Ai)?oe:G(H)}else Y=G(H);const{columns:j}=o.value.store.states,W=j.value.findIndex(oe=>oe.type==="default"),O=b.value&&H.cellIndex===W,Q=ILe(H,O),J={class:"cell",style:{}};return P.showOverflowTooltip&&(J.class=`${J.class} ${y(v.namespace)}-tooltip`,J.style={width:`${(H.column.realWidth||Number(H.column.width))-1}px`}),w(Y),Jt("div",J,[Q,Y])}),P},getPropsData:(...P)=>P.reduce((G,H)=>(ht(H)&&H.forEach(Y=>{G[Y]=e[Y]}),G),{}),getColumnElIndex:(P,G)=>Array.prototype.indexOf.call(P,G),updateColumnOrder:()=>{o.value.store.commit("updateColumnOrder",i.columnConfig.value)}}}var SLe={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},tooltipFormatter:Function,fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let ELe=1;var Jz=Te({name:"ElTableColumn",components:{ElCheckbox:Ls},props:SLe,setup(e,{slots:t}){const o=kn(),i=le({}),c=z(()=>{let x=o.parent;for(;x&&!x.tableId;)x=x.parent;return x}),{registerNormalWatchers:u,registerComplexWatchers:f}=bLe(c,e),{columnId:p,isSubColumn:v,realHeaderAlign:_,columnOrTableParent:b,setColumnWidth:S,setColumnForcedProps:k,setColumnRenders:M,getPropsData:R,getColumnElIndex:w,realAlign:E,updateColumnOrder:N}=CLe(e,t,c),F=b.value;p.value=`${F.tableId||F.columnId}_column_${ELe++}`,bT(()=>{v.value=c.value!==F;const x=e.type||"default",P=e.sortable===""?!0:e.sortable,G=x==="selection"?!1:qn(e.showOverflowTooltip)?F.props.showOverflowTooltip:e.showOverflowTooltip,H=qn(e.tooltipFormatter)?F.props.tooltipFormatter:e.tooltipFormatter,Y={...gLe[x],id:p.value,type:x,property:e.prop||e.property,align:E,headerAlign:_,showOverflowTooltip:G,tooltipFormatter:H,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:P,index:e.index,rawColumnKey:o.vnode.key};let J=R(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);J=yOe(Y,J),J=bOe(M,S,k)(J),i.value=J,u(),f()}),mn(()=>{var x;const P=b.value,G=v.value?P.vnode.el.children:(x=P.refs.hiddenColumns)==null?void 0:x.children,H=()=>w(G||[],o.vnode.el);i.value.getColumnIndex=H,H()>-1&&c.value.store.commit("insertColumn",i.value,v.value?P.columnConfig.value:null,N)}),Co(()=>{const x=i.value.getColumnIndex;(x?x():-1)>-1&&c.value.store.commit("removeColumn",i.value,v.value?F.columnConfig.value:null,N)}),o.columnId=p.value,o.columnConfig=i},render(){var e,t,o;try{const i=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),c=[];if(ht(i))for(const f of i)((o=f.type)==null?void 0:o.name)==="ElTableColumn"||f.shapeFlag&2?c.push(f):f.type===Ht&&ht(f.children)&&f.children.forEach(p=>{(p==null?void 0:p.patchFlag)!==1024&&!Ut(p==null?void 0:p.children)&&c.push(p)});return Jt("div",c)}catch{return Jt("div",[])}}});const TLe=un(pLe,{TableColumn:Jz}),MLe=lr(Jz);var $0=(e=>(e.ASC="asc",e.DESC="desc",e))($0||{}),q0=(e=>(e.CENTER="center",e.RIGHT="right",e))(q0||{}),Xz=(e=>(e.LEFT="left",e.RIGHT="right",e))(Xz||{});const xO={asc:"desc",desc:"asc"},K0=Symbol("placeholder"),kLe=(e,t,o)=>{var i;const c={flexGrow:0,flexShrink:0,...o?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};o||(c.flexShrink=1);const u={...(i=e.style)!=null?i:{},...c,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(u.maxWidth=e.maxWidth),e.minWidth&&(u.minWidth=e.minWidth)),u};function wLe(e,t,o){const i=z(()=>y(t).map((E,N)=>{var F,x;return{...E,key:(x=(F=E.key)!=null?F:E.dataKey)!=null?x:N}})),c=z(()=>y(i).filter(E=>!E.hidden)),u=z(()=>y(c).filter(E=>E.fixed==="left"||E.fixed===!0)),f=z(()=>y(c).filter(E=>E.fixed==="right")),p=z(()=>y(c).filter(E=>!E.fixed)),v=z(()=>{const E=[];return y(u).forEach(N=>{E.push({...N,placeholderSign:K0})}),y(p).forEach(N=>{E.push(N)}),y(f).forEach(N=>{E.push({...N,placeholderSign:K0})}),E}),_=z(()=>y(u).length||y(f).length),b=z(()=>y(i).reduce((E,N)=>(E[N.key]=kLe(N,y(o),e.fixed),E),{})),S=z(()=>y(c).reduce((E,N)=>E+N.width,0)),k=E=>y(i).find(N=>N.key===E),M=E=>y(b)[E],R=(E,N)=>{E.width=N};function w(E){var N;const{key:F}=E.currentTarget.dataset;if(!F)return;const{sortState:x,sortBy:P}=e;let G=$0.ASC;gn(x)?G=xO[x[F]]:G=xO[P.order],(N=e.onColumnSort)==null||N.call(e,{column:k(F),key:F,order:G})}return{columns:i,columnsStyles:b,columnsTotalWidth:S,fixedColumnsOnLeft:u,fixedColumnsOnRight:f,hasFixedColumns:_,mainColumns:v,normalColumns:p,visibleColumns:c,getColumn:k,getColumnStyle:M,updateColumnWidth:R,onColumnSorted:w}}const RLe=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,onMaybeEndReached:c})=>{const u=le({scrollLeft:0,scrollTop:0});function f(M){var R,w,E;const{scrollTop:N}=M;(R=t.value)==null||R.scrollTo(M),(w=o.value)==null||w.scrollToTop(N),(E=i.value)==null||E.scrollToTop(N)}function p(M){u.value=M,f(M)}function v(M){u.value.scrollTop=M,f(y(u))}function _(M){var R,w;u.value.scrollLeft=M,(w=(R=t.value)==null?void 0:R.scrollTo)==null||w.call(R,y(u))}function b(M){var R;p(M),(R=e.onScroll)==null||R.call(e,M)}function S({scrollTop:M}){const{scrollTop:R}=y(u);M!==R&&v(M)}function k(M,R="auto"){var w;(w=t.value)==null||w.scrollToRow(M,R)}return st(()=>y(u).scrollTop,(M,R)=>{M>R&&c()}),{scrollPos:u,scrollTo:p,scrollToLeft:_,scrollToTop:v,scrollToRow:k,onScroll:b,onVerticalScroll:S}},ALe=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,tableInstance:c,ns:u,isScrolling:f})=>{const p=kn(),{emit:v}=p,_=Go(!1),b=le(e.defaultExpandedRowKeys||[]),S=le(-1),k=Go(null),M=le({}),R=le({}),w=Go({}),E=Go({}),N=Go({}),F=z(()=>jt(e.estimatedRowHeight));function x(O){var Q;(Q=e.onRowsRendered)==null||Q.call(e,O),O.rowCacheEnd>y(S)&&(S.value=O.rowCacheEnd)}function P({hovered:O,rowKey:Q}){if(f.value)return;c.vnode.el.querySelectorAll(`[rowkey="${String(Q)}"]`).forEach(pe=>{O?pe.classList.add(u.is("hovered")):pe.classList.remove(u.is("hovered"))})}function G({expanded:O,rowData:Q,rowIndex:J,rowKey:oe}){var pe,ie;const te=[...y(b)],he=te.indexOf(oe);O?he===-1&&te.push(oe):he>-1&&te.splice(he,1),b.value=te,v("update:expandedRowKeys",te),(pe=e.onRowExpand)==null||pe.call(e,{expanded:O,rowData:Q,rowIndex:J,rowKey:oe}),(ie=e.onExpandedRowsChange)==null||ie.call(e,te)}const H=Oa(()=>{var O,Q,J,oe;_.value=!0,M.value={...y(M),...y(R)},Y(y(k),!1),R.value={},k.value=null,(O=t.value)==null||O.forceUpdate(),(Q=o.value)==null||Q.forceUpdate(),(J=i.value)==null||J.forceUpdate(),(oe=p.proxy)==null||oe.$forceUpdate(),_.value=!1},0);function Y(O,Q=!1){y(F)&&[t,o,i].forEach(J=>{const oe=y(J);oe&&oe.resetAfterRowIndex(O,Q)})}function j(O,Q,J){const oe=y(k);(oe===null||oe>J)&&(k.value=J),R.value[O]=Q}function W({rowKey:O,height:Q,rowIndex:J},oe){oe?oe===Xz.RIGHT?N.value[O]=Q:w.value[O]=Q:E.value[O]=Q;const pe=Math.max(...[w,N,E].map(ie=>ie.value[O]||0));y(M)[O]!==pe&&(j(O,pe,J),H())}return{expandedRowKeys:b,lastRenderedRowIndex:S,isDynamic:F,isResetting:_,rowHeights:M,resetAfterIndex:Y,onRowExpanded:G,onRowHovered:P,onRowsRendered:x,onRowHeightChange:W}},DLe=(e,{expandedRowKeys:t,lastRenderedRowIndex:o,resetAfterIndex:i})=>{const c=le({}),u=z(()=>{const p={},{data:v,rowKey:_}=e,b=y(t);if(!b||!b.length)return v;const S=[],k=new Set;b.forEach(R=>k.add(R));let M=v.slice();for(M.forEach(R=>p[R[_]]=0);M.length>0;){const R=M.shift();S.push(R),k.has(R[_])&&ht(R.children)&&R.children.length>0&&(M=[...R.children,...M],R.children.forEach(w=>p[w[_]]=p[R[_]]+1))}return c.value=p,S}),f=z(()=>{const{data:p,expandColumnKey:v}=e;return v?y(u):p});return st(f,(p,v)=>{p!==v&&(o.value=-1,i(0,!0))}),{data:f,depthMap:c}},OLe=(e,t)=>e+t,yE=e=>ht(e)?e.reduce(OLe,0):e,hp=(e,t,o={})=>zt(e)?e(t):e??o,xd=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=ur(e[t])}),e),Zz=e=>Wo(e)?t=>Jt(e,t):e,LLe=(e,{columnsTotalWidth:t,rowsHeight:o,fixedColumnsOnLeft:i,fixedColumnsOnRight:c})=>{const u=z(()=>{const{fixed:F,width:x,vScrollbarSize:P}=e,G=x-P;return F?Math.max(Math.round(y(t)),G):G}),f=z(()=>y(u)+e.vScrollbarSize),p=z(()=>{const{height:F=0,maxHeight:x=0,footerHeight:P,hScrollbarSize:G}=e;if(x>0){const H=y(M),Y=y(o),W=y(k)+H+Y+G;return Math.min(W,x-P)}return F-P}),v=z(()=>{const{maxHeight:F}=e,x=y(p);if(jt(F)&&F>0)return x;const P=y(o)+y(k)+y(M);return Math.min(x,P)}),_=F=>F.width,b=z(()=>yE(y(i).map(_))),S=z(()=>yE(y(c).map(_))),k=z(()=>yE(e.headerHeight)),M=z(()=>{var F;return(((F=e.fixedData)==null?void 0:F.length)||0)*e.rowHeight}),R=z(()=>y(p)-y(k)-y(M)),w=z(()=>{const{style:F={},height:x,width:P}=e;return xd({...F,height:x,width:P})}),E=z(()=>xd({height:e.footerHeight})),N=z(()=>({top:ur(y(k)),bottom:ur(e.footerHeight),width:ur(e.width)}));return{bodyWidth:u,fixedTableHeight:v,mainTableHeight:p,leftTableWidth:b,rightTableWidth:S,headerWidth:f,windowHeight:R,footerHeight:E,emptyStyle:N,rootStyle:w,headerHeight:k}};function NLe(e){const t=le(),o=le(),i=le(),{columns:c,columnsStyles:u,columnsTotalWidth:f,fixedColumnsOnLeft:p,fixedColumnsOnRight:v,hasFixedColumns:_,mainColumns:b,onColumnSorted:S}=wLe(e,uo(e,"columns"),uo(e,"fixed")),{scrollTo:k,scrollToLeft:M,scrollToTop:R,scrollToRow:w,onScroll:E,onVerticalScroll:N,scrollPos:F}=RLe(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,onMaybeEndReached:Re}),x=ut("table-v2"),P=kn(),G=Go(!1),{expandedRowKeys:H,lastRenderedRowIndex:Y,isDynamic:j,isResetting:W,rowHeights:O,resetAfterIndex:Q,onRowExpanded:J,onRowHeightChange:oe,onRowHovered:pe,onRowsRendered:ie}=ALe(e,{mainTableRef:t,leftTableRef:o,rightTableRef:i,tableInstance:P,ns:x,isScrolling:G}),{data:te,depthMap:he}=DLe(e,{expandedRowKeys:H,lastRenderedRowIndex:Y,resetAfterIndex:Q}),re=z(()=>{const{estimatedRowHeight:Ke,rowHeight:je}=e,ze=y(te);return jt(Ke)?Object.values(y(O)).reduce((nt,it)=>nt+it,0):ze.length*je}),{bodyWidth:X,fixedTableHeight:ye,mainTableHeight:ue,leftTableWidth:Ie,rightTableWidth:ve,headerWidth:Ce,windowHeight:Fe,footerHeight:Oe,emptyStyle:be,rootStyle:xe,headerHeight:Le}=LLe(e,{columnsTotalWidth:f,fixedColumnsOnLeft:p,fixedColumnsOnRight:v,rowsHeight:re}),rt=le(),Qe=z(()=>{const Ke=y(te).length===0;return ht(e.fixedData)?e.fixedData.length===0&&Ke:Ke});function Ge(Ke){const{estimatedRowHeight:je,rowHeight:ze,rowKey:nt}=e;return je?y(O)[y(te)[Ke][nt]]||je:ze}const _e=le(!1);function Re(){const{onEndReached:Ke}=e;if(!Ke)return;const{scrollTop:je}=y(F),ze=y(re),nt=y(Fe),it=ze-(je+nt)+e.hScrollbarSize;!_e.value&&y(Y)>=0&&ze<=je+y(ue)-y(Le)?(_e.value=!0,Ke(it)):_e.value=!1}return st(()=>y(re),()=>_e.value=!1),st(()=>e.expandedRowKeys,Ke=>H.value=Ke,{deep:!0}),{columns:c,containerRef:rt,mainTableRef:t,leftTableRef:o,rightTableRef:i,isDynamic:j,isResetting:W,isScrolling:G,hasFixedColumns:_,columnsStyles:u,columnsTotalWidth:f,data:te,expandedRowKeys:H,depthMap:he,fixedColumnsOnLeft:p,fixedColumnsOnRight:v,mainColumns:b,bodyWidth:X,emptyStyle:be,rootStyle:xe,headerWidth:Ce,footerHeight:Oe,mainTableHeight:ue,fixedTableHeight:ye,leftTableWidth:Ie,rightTableWidth:ve,showEmpty:Qe,getRowHeight:Ge,onColumnSorted:S,onRowHovered:pe,onRowExpanded:J,onRowsRendered:ie,onRowHeightChange:oe,scrollTo:k,scrollToLeft:M,scrollToTop:R,scrollToRow:w,onScroll:E,onVerticalScroll:N}}const e2=Symbol("tableV2"),Qz=String,fI={type:Ue(Array),required:!0},t2={type:Ue(Array)},eW={...t2,required:!0},PLe=String,iH={type:Ue(Array),default:()=>sr([])},xf={type:Number,required:!0},tW={type:Ue([String,Number,Symbol]),default:"id"},aH={type:Ue(Object)},Zf=pt({class:String,columns:fI,columnsStyles:{type:Ue(Object),required:!0},depth:Number,expandColumnKey:PLe,estimatedRowHeight:{...ap.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:Ue(Function)},onRowHover:{type:Ue(Function)},onRowHeightChange:{type:Ue(Function)},rowData:{type:Ue(Object),required:!0},rowEventHandlers:{type:Ue(Object)},rowIndex:{type:Number,required:!0},rowKey:tW,style:{type:Ue(Object)}}),dD={type:Number,required:!0},n2=pt({class:String,columns:fI,fixedHeaderData:{type:Ue(Array)},headerData:{type:Ue(Array),required:!0},headerHeight:{type:Ue([Number,Array]),default:50},rowWidth:dD,rowHeight:{type:Number,default:50},height:dD,width:dD}),IE=pt({columns:fI,data:eW,fixedData:t2,estimatedRowHeight:Zf.estimatedRowHeight,width:xf,height:xf,headerWidth:xf,headerHeight:n2.headerHeight,bodyWidth:xf,rowHeight:xf,cache:Cz.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:ap.scrollbarAlwaysOn,scrollbarStartGap:ap.scrollbarStartGap,scrollbarEndGap:ap.scrollbarEndGap,class:Qz,style:aH,containerStyle:aH,getRowHeight:{type:Ue(Function),required:!0},rowKey:Zf.rowKey,onRowsRendered:{type:Ue(Function)},onScroll:{type:Ue(Function)}}),xLe=pt({cache:IE.cache,estimatedRowHeight:Zf.estimatedRowHeight,rowKey:tW,headerClass:{type:Ue([String,Function])},headerProps:{type:Ue([Object,Function])},headerCellProps:{type:Ue([Object,Function])},headerHeight:n2.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:Ue([String,Function])},rowProps:{type:Ue([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:Ue([Object,Function])},columns:fI,data:eW,dataGetter:{type:Ue(Function)},fixedData:t2,expandColumnKey:Zf.expandColumnKey,expandedRowKeys:iH,defaultExpandedRowKeys:iH,class:Qz,fixed:Boolean,style:{type:Ue(Object)},width:xf,height:xf,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:ap.hScrollbarSize,vScrollbarSize:ap.vScrollbarSize,scrollbarAlwaysOn:Tz.alwaysOn,sortBy:{type:Ue(Object),default:()=>({})},sortState:{type:Ue(Object),default:void 0},onColumnSort:{type:Ue(Function)},onExpandedRowsChange:{type:Ue(Function)},onEndReached:{type:Ue(Function)},onRowExpand:Zf.onRowExpand,onScroll:IE.onScroll,onRowsRendered:IE.onRowsRendered,rowEventHandlers:Zf.rowEventHandlers}),ULe="ElTableV2Header",FLe=Te({name:ULe,props:n2,setup(e,{slots:t,expose:o}){const i=ut("table-v2"),c=Rt("tableV2GridScrollLeft"),u=le(),f=z(()=>xd({width:e.width,height:e.height})),p=z(()=>xd({width:e.rowWidth,height:e.height})),v=z(()=>Wi(y(e.headerHeight))),_=k=>{const M=y(u);Vt(()=>{M!=null&&M.scroll&&M.scroll({left:k})})},b=()=>{const k=i.e("fixed-header-row"),{columns:M,fixedHeaderData:R,rowHeight:w}=e;return R==null?void 0:R.map((E,N)=>{var F;const x=xd({height:w,width:"100%"});return(F=t.fixed)==null?void 0:F.call(t,{class:k,columns:M,rowData:E,rowIndex:-(N+1),style:x})})},S=()=>{const k=i.e("dynamic-header-row"),{columns:M}=e;return y(v).map((R,w)=>{var E;const N=xd({width:"100%",height:R});return(E=t.dynamic)==null?void 0:E.call(t,{class:k,columns:M,headerIndex:w,style:N})})};return dl(()=>{c!=null&&c.value&&_(c.value)}),o({scrollToLeft:_}),()=>{if(!(e.height<=0))return Me("div",{ref:u,class:e.class,style:y(f),role:"rowgroup"},[Me("div",{style:y(p),class:i.e("header")},[S(),b()])])}}});var VLe=FLe;const GLe=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:o,atYStartEdge:i},c)=>{let u=null,f=0,p=0;const v=(b,S)=>{const k=b<=0&&t.value||b>=0&&e.value,M=S<=0&&i.value||S>=0&&o.value;return k&&M};return{hasReachedEdge:v,onWheel:b=>{up(u);let S=b.deltaX,k=b.deltaY;Math.abs(S)>Math.abs(k)?k=0:S=0,b.shiftKey&&k!==0&&(S=k,k=0),!(v(f,p)&&v(f+S,p+k))&&(f+=S,p+=k,b.preventDefault(),u=Wd(()=>{c(f,p),f=0,p=0}))}}},nW=({name:e,clearCache:t,getColumnPosition:o,getColumnStartIndexForOffset:i,getColumnStopIndexForStartIndex:c,getEstimatedTotalHeight:u,getEstimatedTotalWidth:f,getColumnOffset:p,getRowOffset:v,getRowPosition:_,getRowStartIndexForOffset:b,getRowStopIndexForStartIndex:S,initCache:k,injectToInstance:M,validateProps:R})=>Te({name:e??"ElVirtualList",props:ap,emits:[QE,eT],setup(w,{emit:E,expose:N,slots:F}){const x=ut("vl");R(w);const P=kn(),G=le(k(w,P));M==null||M(P,G);const H=le(),Y=le(),j=le(),W=le(null),O=le({isScrolling:!1,scrollLeft:jt(w.initScrollLeft)?w.initScrollLeft:0,scrollTop:jt(w.initScrollTop)?w.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Cg,yAxisScrollDir:Cg}),Q=yz(),J=z(()=>Number.parseInt(`${w.height}`,10)),oe=z(()=>Number.parseInt(`${w.width}`,10)),pe=z(()=>{const{totalColumn:ze,totalRow:nt,columnCache:it}=w,{isScrolling:dt,xAxisScrollDir:gt,scrollLeft:ft}=y(O);if(ze===0||nt===0)return[0,0,0,0];const Mt=i(w,ft,y(G)),lt=c(w,Mt,ft,y(G)),Et=!dt||gt===tT?Math.max(1,it):1,Yt=!dt||gt===Cg?Math.max(1,it):1;return[Math.max(0,Mt-Et),Math.max(0,Math.min(ze-1,lt+Yt)),Mt,lt]}),ie=z(()=>{const{totalColumn:ze,totalRow:nt,rowCache:it}=w,{isScrolling:dt,yAxisScrollDir:gt,scrollTop:ft}=y(O);if(ze===0||nt===0)return[0,0,0,0];const Mt=b(w,ft,y(G)),lt=S(w,Mt,ft,y(G)),Et=!dt||gt===tT?Math.max(1,it):1,Yt=!dt||gt===Cg?Math.max(1,it):1;return[Math.max(0,Mt-Et),Math.max(0,Math.min(nt-1,lt+Yt)),Mt,lt]}),te=z(()=>u(w,y(G))),he=z(()=>f(w,y(G))),re=z(()=>{var ze;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:w.direction,height:jt(w.height)?`${w.height}px`:w.height,width:jt(w.width)?`${w.width}px`:w.width},(ze=w.style)!=null?ze:{}]}),X=z(()=>{const ze=`${y(he)}px`;return{height:`${y(te)}px`,pointerEvents:y(O).isScrolling?"none":void 0,width:ze}}),ye=()=>{const{totalColumn:ze,totalRow:nt}=w;if(ze>0&&nt>0){const[lt,Et,Yt,sn]=y(pe),[dn,Sn,yn,fo]=y(ie);E(QE,{columnCacheStart:lt,columnCacheEnd:Et,rowCacheStart:dn,rowCacheEnd:Sn,columnVisibleStart:Yt,columnVisibleEnd:sn,rowVisibleStart:yn,rowVisibleEnd:fo})}const{scrollLeft:it,scrollTop:dt,updateRequested:gt,xAxisScrollDir:ft,yAxisScrollDir:Mt}=y(O);E(eT,{xAxisScrollDir:ft,scrollLeft:it,yAxisScrollDir:Mt,scrollTop:dt,updateRequested:gt})},ue=ze=>{const{clientHeight:nt,clientWidth:it,scrollHeight:dt,scrollLeft:gt,scrollTop:ft,scrollWidth:Mt}=ze.currentTarget,lt=y(O);if(lt.scrollTop===ft&&lt.scrollLeft===gt)return;let Et=gt;if(qB(w.direction))switch(oT()){case B0:Et=-gt;break;case YN:Et=Mt-it-gt;break}O.value={...lt,isScrolling:!0,scrollLeft:Et,scrollTop:Math.max(0,Math.min(ft,dt-nt)),updateRequested:!0,xAxisScrollDir:Xf(lt.scrollLeft,Et),yAxisScrollDir:Xf(lt.scrollTop,ft)},Vt(()=>xe()),Le(),ye()},Ie=(ze,nt)=>{const it=y(J),dt=(te.value-it)/nt*ze;Fe({scrollTop:Math.min(te.value-it,dt)})},ve=(ze,nt)=>{const it=y(oe),dt=(he.value-it)/nt*ze;Fe({scrollLeft:Math.min(he.value-it,dt)})},{onWheel:Ce}=GLe({atXStartEdge:z(()=>O.value.scrollLeft<=0),atXEndEdge:z(()=>O.value.scrollLeft>=he.value-y(oe)),atYStartEdge:z(()=>O.value.scrollTop<=0),atYEndEdge:z(()=>O.value.scrollTop>=te.value-y(J))},(ze,nt)=>{var it,dt,gt,ft;(dt=(it=Y.value)==null?void 0:it.onMouseUp)==null||dt.call(it),(ft=(gt=j.value)==null?void 0:gt.onMouseUp)==null||ft.call(gt);const Mt=y(oe),lt=y(J);Fe({scrollLeft:Math.min(O.value.scrollLeft+ze,he.value-Mt),scrollTop:Math.min(O.value.scrollTop+nt,te.value-lt)})});_o(H,"wheel",Ce,{passive:!1});const Fe=({scrollLeft:ze=O.value.scrollLeft,scrollTop:nt=O.value.scrollTop})=>{ze=Math.max(ze,0),nt=Math.max(nt,0);const it=y(O);nt===it.scrollTop&&ze===it.scrollLeft||(O.value={...it,xAxisScrollDir:Xf(it.scrollLeft,ze),yAxisScrollDir:Xf(it.scrollTop,nt),scrollLeft:ze,scrollTop:nt,updateRequested:!0},Vt(()=>xe()),Le(),ye())},Oe=(ze=0,nt=0,it=Es)=>{const dt=y(O);nt=Math.max(0,Math.min(nt,w.totalColumn-1)),ze=Math.max(0,Math.min(ze,w.totalRow-1));const gt=tK(x.namespace.value),ft=y(G),Mt=u(w,ft),lt=f(w,ft);Fe({scrollLeft:p(w,nt,it,dt.scrollLeft,ft,lt>w.width?gt:0),scrollTop:v(w,ze,it,dt.scrollTop,ft,Mt>w.height?gt:0)})},be=(ze,nt)=>{const{columnWidth:it,direction:dt,rowHeight:gt}=w,ft=Q.value(t&&it,t&&gt,t&&dt),Mt=`${ze},${nt}`;if(jn(ft,Mt))return ft[Mt];{const[,lt]=o(w,nt,y(G)),Et=y(G),Yt=qB(dt),[sn,dn]=_(w,ze,Et),[Sn]=o(w,nt,Et);return ft[Mt]={position:"absolute",left:Yt?void 0:`${lt}px`,right:Yt?`${lt}px`:void 0,top:`${dn}px`,height:`${sn}px`,width:`${Sn}px`},ft[Mt]}},xe=()=>{O.value.isScrolling=!1,Vt(()=>{Q.value(-1,null,null)})};mn(()=>{if(!$n)return;const{initScrollLeft:ze,initScrollTop:nt}=w,it=y(H);it&&(jt(ze)&&(it.scrollLeft=ze),jt(nt)&&(it.scrollTop=nt)),ye()});const Le=()=>{const{direction:ze}=w,{scrollLeft:nt,scrollTop:it,updateRequested:dt}=y(O),gt=y(H);if(dt&&gt){if(ze===Ng)switch(oT()){case B0:{gt.scrollLeft=-nt;break}case jN:{gt.scrollLeft=nt;break}default:{const{clientWidth:ft,scrollWidth:Mt}=gt;gt.scrollLeft=Mt-ft-nt;break}}else gt.scrollLeft=Math.max(0,nt);gt.scrollTop=Math.max(0,it)}},{resetAfterColumnIndex:rt,resetAfterRowIndex:Qe,resetAfter:Ge}=P.proxy;N({windowRef:H,innerRef:W,getItemStyleCache:Q,scrollTo:Fe,scrollToItem:Oe,states:O,resetAfterColumnIndex:rt,resetAfterRowIndex:Qe,resetAfter:Ge});const _e=()=>{const{scrollbarAlwaysOn:ze,scrollbarStartGap:nt,scrollbarEndGap:it,totalColumn:dt,totalRow:gt}=w,ft=y(oe),Mt=y(J),lt=y(he),Et=y(te),{scrollLeft:Yt,scrollTop:sn}=y(O),dn=Jt(TO,{ref:Y,alwaysOn:ze,startGap:nt,endGap:it,class:x.e("horizontal"),clientSize:ft,layout:"horizontal",onScroll:ve,ratio:ft*100/lt,scrollFrom:Yt/(lt-ft),total:gt,visible:!0}),Sn=Jt(TO,{ref:j,alwaysOn:ze,startGap:nt,endGap:it,class:x.e("vertical"),clientSize:Mt,layout:"vertical",onScroll:Ie,ratio:Mt*100/Et,scrollFrom:sn/(Et-Mt),total:dt,visible:!0});return{horizontalScrollbar:dn,verticalScrollbar:Sn}},Re=()=>{var ze;const[nt,it]=y(pe),[dt,gt]=y(ie),{data:ft,totalColumn:Mt,totalRow:lt,useIsScrolling:Et,itemKey:Yt}=w,sn=[];if(lt>0&&Mt>0)for(let dn=dt;dn<=gt;dn++)for(let Sn=nt;Sn<=it;Sn++){const yn=Yt({columnIndex:Sn,data:ft,rowIndex:dn});sn.push(Jt(Ht,{key:yn},(ze=F.default)==null?void 0:ze.call(F,{columnIndex:Sn,data:ft,isScrolling:Et?y(O).isScrolling:void 0,style:be(dn,Sn),rowIndex:dn})))}return sn},Ke=()=>{const ze=Tn(w.innerElement),nt=Re();return[Jt(ze,{style:y(X),ref:W},Ut(ze)?nt:{default:()=>nt})]};return()=>{const ze=Tn(w.containerElement),{horizontalScrollbar:nt,verticalScrollbar:it}=_e(),dt=Ke();return Jt("div",{key:0,class:x.e("wrapper"),role:w.role},[Jt(ze,{class:w.className,style:y(re),onScroll:ue,ref:H},Ut(ze)?dt:{default:()=>dt}),nt,it])}}}),{max:aT,min:oW,floor:rW}=Math,BLe={column:"columnWidth",row:"rowHeight"},UO={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Wc=(e,t,o,i)=>{const[c,u,f]=[o[i],e[BLe[i]],o[UO[i]]];if(t>f){let p=0;if(f>=0){const v=c[f];p=v.offset+v.size}for(let v=f+1;v<=t;v++){const _=u(v);c[v]={offset:p,size:_},p+=_}o[UO[i]]=t}return c[t]},iW=(e,t,o,i,c,u)=>{for(;o<=i;){const f=o+rW((i-o)/2),p=Wc(e,f,t,u).offset;if(p===c)return f;p<c?o=f+1:i=f-1}return aT(0,o-1)},HLe=(e,t,o,i,c)=>{const u=c==="column"?e.totalColumn:e.totalRow;let f=1;for(;o<u&&Wc(e,o,t,c).offset<i;)o+=f,f*=2;return iW(e,t,rW(o/2),oW(o,u-1),i,c)},sH=(e,t,o,i)=>{const[c,u]=[t[i],t[UO[i]]];return(u>0?c[u].offset:0)>=o?iW(e,t,0,u,o,i):HLe(e,t,aT(0,u),o,i)},aW=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:o,row:i})=>{let c=0;if(o>=e&&(o=e-1),o>=0){const p=i[o];c=p.offset+p.size}const f=(e-o-1)*t;return c+f},sW=({totalColumn:e},{column:t,estimatedColumnWidth:o,lastVisitedColumnIndex:i})=>{let c=0;if(i>e&&(i=e-1),i>=0){const p=t[i];c=p.offset+p.size}const f=(e-i-1)*o;return c+f},$Le={column:sW,row:aW},lH=(e,t,o,i,c,u,f)=>{const[p,v]=[u==="row"?e.height:e.width,$Le[u]],_=Wc(e,t,c,u),b=v(e,c),S=aT(0,oW(b-p,_.offset)),k=aT(0,_.offset-p+f+_.size);switch(o===JT&&(i>=k-p&&i<=S+p?o=Es:o=Jl),o){case V0:return S;case G0:return k;case Jl:return Math.round(k+(S-k)/2);case Es:default:return i>=k&&i<=S?i:k>S||i<k?k:S}},qLe=nW({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,o)=>{const i=Wc(e,t,o,"column");return[i.size,i.offset]},getRowPosition:(e,t,o)=>{const i=Wc(e,t,o,"row");return[i.size,i.offset]},getColumnOffset:(e,t,o,i,c,u)=>lH(e,t,o,i,c,"column",u),getRowOffset:(e,t,o,i,c,u)=>lH(e,t,o,i,c,"row",u),getColumnStartIndexForOffset:(e,t,o)=>sH(e,o,t,"column"),getColumnStopIndexForStartIndex:(e,t,o,i)=>{const c=Wc(e,t,i,"column"),u=o+e.width;let f=c.offset+c.size,p=t;for(;p<e.totalColumn-1&&f<u;)p++,f+=Wc(e,t,i,"column").size;return p},getEstimatedTotalHeight:aW,getEstimatedTotalWidth:sW,getRowStartIndexForOffset:(e,t,o)=>sH(e,o,t,"row"),getRowStopIndexForStartIndex:(e,t,o,i)=>{const{totalRow:c,height:u}=e,f=Wc(e,t,i,"row"),p=o+u;let v=f.size+f.offset,_=t;for(;_<c-1&&v<p;)_++,v+=Wc(e,_,i,"row").size;return _},injectToInstance:(e,t)=>{const o=({columnIndex:u,rowIndex:f},p)=>{var v,_;p=qn(p)?!0:p,jt(u)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,u-1)),jt(f)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,f-1)),(v=e.exposed)==null||v.getItemStyleCache.value(-1,null,null),p&&((_=e.proxy)==null||_.$forceUpdate())},i=(u,f)=>{o({columnIndex:u},f)},c=(u,f)=>{o({rowIndex:u},f)};Object.assign(e.proxy,{resetAfterColumnIndex:i,resetAfterRowIndex:c,resetAfter:o})},initCache:({estimatedColumnWidth:e=yO,estimatedRowHeight:t=yO})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),KLe=nW({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:o},i,c,u,f,p)=>{o=Number(o);const v=Math.max(0,e*t-o),_=Math.min(v,i*t),b=Math.max(0,i*t-o+p+t);switch(c==="smart"&&(u>=b-o&&u<=_+o?c=Es:c=Jl),c){case V0:return _;case G0:return b;case Jl:{const S=Math.round(b+(_-b)/2);return S<Math.ceil(o/2)?0:S>v+Math.floor(o/2)?v:S}case Es:default:return u>=b&&u<=_?u:b>_||u<b?b:_}},getRowOffset:({rowHeight:e,height:t,totalRow:o},i,c,u,f,p)=>{t=Number(t);const v=Math.max(0,o*e-t),_=Math.min(v,i*e),b=Math.max(0,i*e-t+p+e);switch(c===JT&&(u>=b-t&&u<=_+t?c=Es:c=Jl),c){case V0:return _;case G0:return b;case Jl:{const S=Math.round(b+(_-b)/2);return S<Math.ceil(t/2)?0:S>v+Math.floor(t/2)?v:S}case Es:default:return u>=b&&u<=_?u:b>_||u<b?b:_}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:o},i,c)=>{const u=i*e,f=Math.ceil((o+c-u)/e);return Math.max(0,Math.min(t-1,i+f-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:o},i,c)=>{const u=i*e,f=Math.ceil((o+c-u)/e);return Math.max(0,Math.min(t-1,i+f-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),zLe="ElTableV2Grid",WLe=e=>{const t=le(),o=le(),i=le(0),c=z(()=>{const{data:E,rowHeight:N,estimatedRowHeight:F}=e;if(!F)return E.length*N}),u=z(()=>{const{fixedData:E,rowHeight:N}=e;return((E==null?void 0:E.length)||0)*N}),f=z(()=>yE(e.headerHeight)),p=z(()=>{const{height:E}=e;return Math.max(0,E-y(f)-y(u))}),v=z(()=>y(f)+y(u)>0),_=({data:E,rowIndex:N})=>E[N][e.rowKey];function b({rowCacheStart:E,rowCacheEnd:N,rowVisibleStart:F,rowVisibleEnd:x}){var P;(P=e.onRowsRendered)==null||P.call(e,{rowCacheStart:E,rowCacheEnd:N,rowVisibleStart:F,rowVisibleEnd:x})}function S(E,N){var F;(F=o.value)==null||F.resetAfterRowIndex(E,N)}function k(E,N){const F=y(t),x=y(o);gn(E)?(F==null||F.scrollToLeft(E.scrollLeft),i.value=E.scrollLeft,x==null||x.scrollTo(E)):(F==null||F.scrollToLeft(E),i.value=E,x==null||x.scrollTo({scrollLeft:E,scrollTop:N}))}function M(E){var N;(N=y(o))==null||N.scrollTo({scrollTop:E})}function R(E,N){var F;(F=y(o))==null||F.scrollToItem(E,1,N)}function w(){var E,N;(E=y(o))==null||E.$forceUpdate(),(N=y(t))==null||N.$forceUpdate()}return st(()=>e.bodyWidth,()=>{var E;jt(e.estimatedRowHeight)&&((E=o.value)==null||E.resetAfter({columnIndex:0},!1))}),{bodyRef:o,forceUpdate:w,fixedRowHeight:u,gridHeight:p,hasHeader:v,headerHeight:f,headerRef:t,totalHeight:c,itemKey:_,onItemRendered:b,resetAfterRowIndex:S,scrollTo:k,scrollToTop:M,scrollToRow:R,scrollLeft:i}},jLe=Te({name:zLe,props:IE,setup(e,{slots:t,expose:o}){const{ns:i}=Rt(e2),{bodyRef:c,fixedRowHeight:u,gridHeight:f,hasHeader:p,headerRef:v,headerHeight:_,totalHeight:b,forceUpdate:S,itemKey:k,onItemRendered:M,resetAfterRowIndex:R,scrollTo:w,scrollToTop:E,scrollToRow:N,scrollLeft:F}=WLe(e);Nn("tableV2GridScrollLeft",F),o({forceUpdate:S,totalHeight:b,scrollTo:w,scrollToTop:E,scrollToRow:N,resetAfterRowIndex:R});const x=()=>e.bodyWidth;return()=>{const{cache:P,columns:G,data:H,fixedData:Y,useIsScrolling:j,scrollbarAlwaysOn:W,scrollbarEndGap:O,scrollbarStartGap:Q,style:J,rowHeight:oe,bodyWidth:pe,estimatedRowHeight:ie,headerWidth:te,height:he,width:re,getRowHeight:X,onScroll:ye}=e,ue=jt(ie),Ie=ue?qLe:KLe,ve=y(_);return Me("div",{role:"table",class:[i.e("table"),e.class],style:J},[Me(Ie,{ref:c,data:H,useIsScrolling:j,itemKey:k,columnCache:0,columnWidth:ue?x:pe,totalColumn:1,totalRow:H.length,rowCache:P,rowHeight:ue?X:oe,width:re,height:y(f),class:i.e("body"),role:"rowgroup",scrollbarStartGap:Q,scrollbarEndGap:O,scrollbarAlwaysOn:W,onScroll:ye,onItemRendered:M,perfMode:!1},{default:Ce=>{var Fe;const Oe=H[Ce.rowIndex];return(Fe=t.row)==null?void 0:Fe.call(t,{...Ce,columns:G,rowData:Oe})}}),y(p)&&Me(VLe,{ref:v,class:i.e("header-wrapper"),columns:G,headerData:H,headerHeight:e.headerHeight,fixedHeaderData:Y,rowWidth:te,rowHeight:oe,width:re,height:Math.min(ve+y(u),he)},{dynamic:t.header,fixed:t.row})])}}});var o2=jLe;function YLe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const JLe=(e,{slots:t})=>{const{mainTableRef:o,...i}=e;return Me(o2,An({ref:o},i),YLe(t)?t:{default:()=>[t]})};var XLe=JLe;function ZLe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const QLe=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:o,...i}=e;return Me(o2,An({ref:o},i),ZLe(t)?t:{default:()=>[t]})};var eNe=QLe;function tNe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const nNe=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:o,...i}=e;return Me(o2,An({ref:o},i),tNe(t)?t:{default:()=>[t]})};var oNe=nNe;const rNe=e=>{const{isScrolling:t}=Rt(e2),o=le(!1),i=le(),c=z(()=>jt(e.estimatedRowHeight)&&e.rowIndex>=0),u=(v=!1)=>{const _=y(i);if(!_)return;const{columns:b,onRowHeightChange:S,rowKey:k,rowIndex:M,style:R}=e,{height:w}=_.getBoundingClientRect();o.value=!0,Vt(()=>{if(v||w!==Number.parseInt(R.height)){const E=b[0],N=(E==null?void 0:E.placeholderSign)===K0;S==null||S({rowKey:k,height:w,rowIndex:M},E&&!N&&E.fixed)}})},f=z(()=>{const{rowData:v,rowIndex:_,rowKey:b,onRowHover:S}=e,k=e.rowEventHandlers||{},M={};return Object.entries(k).forEach(([R,w])=>{zt(w)&&(M[R]=E=>{w({event:E,rowData:v,rowIndex:_,rowKey:b})})}),S&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:R,hovered:w})=>{const E=M[R];M[R]=N=>{S({event:N,hovered:w,rowData:v,rowIndex:_,rowKey:b}),E==null||E(N)}}),M}),p=v=>{const{onRowExpand:_,rowData:b,rowIndex:S,rowKey:k}=e;_==null||_({expanded:v,rowData:b,rowIndex:S,rowKey:k})};return mn(()=>{y(c)&&u(!0)}),{isScrolling:t,measurable:c,measured:o,rowRef:i,eventHandlers:f,onExpand:p}},iNe="ElTableV2TableRow",aNe=Te({name:iNe,props:Zf,setup(e,{expose:t,slots:o,attrs:i}){const{eventHandlers:c,isScrolling:u,measurable:f,measured:p,rowRef:v,onExpand:_}=rNe(e);return t({onExpand:_}),()=>{const{columns:b,columnsStyles:S,expandColumnKey:k,depth:M,rowData:R,rowIndex:w,style:E}=e;let N=b.map((F,x)=>{const P=ht(R.children)&&R.children.length>0&&F.key===k;return o.cell({column:F,columns:b,columnIndex:x,depth:M,style:S[F.key],rowData:R,rowIndex:w,isScrolling:y(u),expandIconProps:P?{rowData:R,rowIndex:w,onExpand:_}:void 0})});if(o.row&&(N=o.row({cells:N.map(F=>ht(F)&&F.length===1?F[0]:F),style:E,columns:b,depth:M,rowData:R,rowIndex:w,isScrolling:y(u)})),y(f)){const{height:F,...x}=E||{},P=y(p);return Me("div",An({ref:v,class:e.class,style:P?E:x,role:"row"},i,y(c)),[N])}return Me("div",An(i,{ref:v,class:e.class,style:E,role:"row"},y(c)),[N])}}});var sNe=aNe;function lNe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const cNe=(e,{slots:t})=>{const{columns:o,columnsStyles:i,depthMap:c,expandColumnKey:u,expandedRowKeys:f,estimatedRowHeight:p,hasFixedColumns:v,rowData:_,rowIndex:b,style:S,isScrolling:k,rowProps:M,rowClass:R,rowKey:w,rowEventHandlers:E,ns:N,onRowHovered:F,onRowExpanded:x}=e,P=hp(R,{columns:o,rowData:_,rowIndex:b},""),G=hp(M,{columns:o,rowData:_,rowIndex:b}),H=_[w],Y=c[H]||0,j=!!u,W=b<0,O=[N.e("row"),P,{[N.e(`row-depth-${Y}`)]:j&&b>=0,[N.is("expanded")]:j&&f.includes(H),[N.is("fixed")]:!Y&&W,[N.is("customized")]:!!t.row}],Q=v?F:void 0,J={...G,columns:o,columnsStyles:i,class:O,depth:Y,expandColumnKey:u,estimatedRowHeight:W?void 0:p,isScrolling:k,rowIndex:b,rowData:_,rowKey:H,rowEventHandlers:E,style:S};return Me(sNe,An(J,{onRowExpand:x,onMouseenter:ie=>{Q==null||Q({hovered:!0,rowKey:H,event:ie,rowData:_,rowIndex:b})},onMouseleave:ie=>{Q==null||Q({hovered:!1,rowKey:H,event:ie,rowData:_,rowIndex:b})},rowkey:H}),lNe(t)?t:{default:()=>[t]})};var uNe=cNe;const r2=(e,{slots:t})=>{var o;const{cellData:i,style:c}=e,u=((o=i==null?void 0:i.toString)==null?void 0:o.call(i))||"",f=Ve(t,"default",e,()=>[u]);return Me("div",{class:e.class,title:u,style:c},[f])};r2.displayName="ElTableV2Cell";r2.inheritAttrs=!1;var dNe=r2;const hNe=e=>{const{expanded:t,expandable:o,onExpand:i,style:c,size:u}=e,f={onClick:o?()=>i(!t):void 0,class:e.class};return Me(Pt,An(f,{size:u,style:c}),{default:()=>[Me(ca,null,null)]})};var fNe=hNe;const lW=({columns:e,column:t,columnIndex:o,depth:i,expandIconProps:c,isScrolling:u,rowData:f,rowIndex:p,style:v,expandedRowKeys:_,ns:b,cellProps:S,expandColumnKey:k,indentSize:M,iconSize:R,rowKey:w},{slots:E})=>{const N=xd(v);if(t.placeholderSign===K0)return Me("div",{class:b.em("row-cell","placeholder"),style:N},null);const{cellRenderer:F,dataKey:x,dataGetter:P}=t,G=zt(P)?P({columns:e,column:t,columnIndex:o,rowData:f,rowIndex:p}):Rr(f,x??""),H=hp(S,{cellData:G,columns:e,column:t,columnIndex:o,rowIndex:p,rowData:f}),Y={class:b.e("cell-text"),columns:e,column:t,columnIndex:o,cellData:G,isScrolling:u,rowData:f,rowIndex:p},j=Zz(F),W=j?j(Y):Ve(E,"default",Y,()=>[Me(dNe,Y,null)]),O=[b.e("row-cell"),t.class,t.align===q0.CENTER&&b.is("align-center"),t.align===q0.RIGHT&&b.is("align-right")],Q=p>=0&&k&&t.key===k,J=p>=0&&_.includes(f[w]);let oe;const pe=`margin-inline-start: ${i*M}px;`;return Q&&(gn(c)?oe=Me(fNe,An(c,{class:[b.e("expand-icon"),b.is("expanded",J)],size:R,expanded:J,style:pe,expandable:!0}),null):oe=Me("div",{style:[pe,`width: ${R}px; height: ${R}px;`].join(" ")},null)),Me("div",An({class:O,style:N},H,{role:"cell"}),[oe,W])};lW.inheritAttrs=!1;var cH=lW;const pNe=pt({class:String,columns:fI,columnsStyles:{type:Ue(Object),required:!0},headerIndex:Number,style:{type:Ue(Object)}}),mNe=Te({name:"ElTableV2HeaderRow",props:pNe,setup(e,{slots:t}){return()=>{const{columns:o,columnsStyles:i,headerIndex:c,style:u}=e;let f=o.map((p,v)=>t.cell({columns:o,column:p,columnIndex:v,headerIndex:c,style:i[p.key]}));return t.header&&(f=t.header({cells:f.map(p=>ht(p)&&p.length===1?p[0]:p),columns:o,headerIndex:c})),Me("div",{class:e.class,style:u,role:"row"},[f])}}});var gNe=mNe;function vNe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const _Ne=({columns:e,columnsStyles:t,headerIndex:o,style:i,headerClass:c,headerProps:u,ns:f},{slots:p})=>{const v={columns:e,headerIndex:o},_=[f.e("header-row"),hp(c,v,""),{[f.is("customized")]:!!p.header}],b={...hp(u,v),columnsStyles:t,class:_,columns:e,headerIndex:o,style:i};return Me(gNe,b,vNe(p)?p:{default:()=>[p]})};var yNe=_Ne;const i2=(e,{slots:t})=>Ve(t,"default",e,()=>{var o,i;return[Me("div",{class:e.class,title:(o=e.column)==null?void 0:o.title},[(i=e.column)==null?void 0:i.title])]});i2.displayName="ElTableV2HeaderCell";i2.inheritAttrs=!1;var INe=i2;const bNe=e=>{const{sortOrder:t}=e;return Me(Pt,{size:14,class:e.class},{default:()=>[t===$0.ASC?Me(rye,null,null):Me(nye,null,null)]})};var CNe=bNe;const SNe=(e,{slots:t})=>{const{column:o,ns:i,style:c,onColumnSorted:u}=e,f=xd(c);if(o.placeholderSign===K0)return Me("div",{class:i.em("header-row-cell","placeholder"),style:f},null);const{headerCellRenderer:p,headerClass:v,sortable:_}=o,b={...e,class:i.e("header-cell-text")},S=Zz(p),k=S?S(b):Ve(t,"default",b,()=>[Me(INe,b,null)]),{sortBy:M,sortState:R,headerCellProps:w}=e;let E,N;if(R){const P=R[o.key];E=!!xO[P],N=E?P:$0.ASC}else E=o.key===M.key,N=E?M.order:$0.ASC;const F=[i.e("header-cell"),hp(v,e,""),o.align===q0.CENTER&&i.is("align-center"),o.align===q0.RIGHT&&i.is("align-right"),_&&i.is("sortable")],x={...hp(w,e),onClick:o.sortable?u:void 0,class:F,style:f,"data-key":o.key};return Me("div",An(x,{role:"columnheader"}),[k,_&&Me(CNe,{class:[i.e("sort-icon"),E&&i.is("sorting")],sortOrder:N},null)])};var uH=SNe;const cW=(e,{slots:t})=>{var o;return Me("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};cW.displayName="ElTableV2Footer";var ENe=cW;const uW=(e,{slots:t})=>{const o=Ve(t,"default",{},()=>[Me(rz,null,null)]);return Me("div",{class:e.class,style:e.style},[o])};uW.displayName="ElTableV2Empty";var TNe=uW;const dW=(e,{slots:t})=>{var o;return Me("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};dW.displayName="ElTableV2Overlay";var MNe=dW;function Py(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Wo(e)}const kNe="ElTableV2",wNe=Te({name:kNe,props:xLe,setup(e,{slots:t,expose:o}){const i=ut("table-v2"),{columnsStyles:c,fixedColumnsOnLeft:u,fixedColumnsOnRight:f,mainColumns:p,mainTableHeight:v,fixedTableHeight:_,leftTableWidth:b,rightTableWidth:S,data:k,depthMap:M,expandedRowKeys:R,hasFixedColumns:w,mainTableRef:E,leftTableRef:N,rightTableRef:F,isDynamic:x,isResetting:P,isScrolling:G,bodyWidth:H,emptyStyle:Y,rootStyle:j,headerWidth:W,footerHeight:O,showEmpty:Q,scrollTo:J,scrollToLeft:oe,scrollToTop:pe,scrollToRow:ie,getRowHeight:te,onColumnSorted:he,onRowHeightChange:re,onRowHovered:X,onRowExpanded:ye,onRowsRendered:ue,onScroll:Ie,onVerticalScroll:ve}=NLe(e);return o({scrollTo:J,scrollToLeft:oe,scrollToTop:pe,scrollToRow:ie}),Nn(e2,{ns:i,isResetting:P,isScrolling:G}),()=>{const{cache:Ce,cellProps:Fe,estimatedRowHeight:Oe,expandColumnKey:be,fixedData:xe,headerHeight:Le,headerClass:rt,headerProps:Qe,headerCellProps:Ge,sortBy:_e,sortState:Re,rowHeight:Ke,rowClass:je,rowEventHandlers:ze,rowKey:nt,rowProps:it,scrollbarAlwaysOn:dt,indentSize:gt,iconSize:ft,useIsScrolling:Mt,vScrollbarSize:lt,width:Et}=e,Yt=y(k),sn={cache:Ce,class:i.e("main"),columns:y(p),data:Yt,fixedData:xe,estimatedRowHeight:Oe,bodyWidth:y(H)+lt,headerHeight:Le,headerWidth:y(W),height:y(v),mainTableRef:E,rowKey:nt,rowHeight:Ke,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:lt,useIsScrolling:Mt,width:Et,getRowHeight:te,onRowsRendered:ue,onScroll:Ie},dn=y(b),Sn=y(_),yn={cache:Ce,class:i.e("left"),columns:y(u),data:Yt,fixedData:xe,estimatedRowHeight:Oe,leftTableRef:N,rowHeight:Ke,bodyWidth:dn,headerWidth:dn,headerHeight:Le,height:Sn,rowKey:nt,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:lt,useIsScrolling:Mt,width:dn,getRowHeight:te,onScroll:ve},Xt=y(S)+lt,vn={cache:Ce,class:i.e("right"),columns:y(f),data:Yt,fixedData:xe,estimatedRowHeight:Oe,rightTableRef:F,rowHeight:Ke,bodyWidth:Xt,headerWidth:Xt,headerHeight:Le,height:Sn,rowKey:nt,scrollbarAlwaysOn:dt,scrollbarStartGap:2,scrollbarEndGap:lt,width:Xt,style:`--${y(i.namespace)}-table-scrollbar-size: ${lt}px`,useIsScrolling:Mt,getRowHeight:te,onScroll:ve},Ne=y(c),qe={ns:i,depthMap:y(M),columnsStyles:Ne,expandColumnKey:be,expandedRowKeys:y(R),estimatedRowHeight:Oe,hasFixedColumns:y(w),rowProps:it,rowClass:je,rowKey:nt,rowEventHandlers:ze,onRowHovered:X,onRowExpanded:ye,onRowHeightChange:re},ke={cellProps:Fe,expandColumnKey:be,indentSize:gt,iconSize:ft,rowKey:nt,expandedRowKeys:y(R),ns:i},ot={ns:i,headerClass:rt,headerProps:Qe,columnsStyles:Ne},tn={ns:i,sortBy:_e,sortState:Re,headerCellProps:Ge,onColumnSorted:he},Nt={row:io=>Me(uNe,An(io,qe),{row:t.row,cell:hr=>{let K;return t.cell?Me(cH,An(hr,ke,{style:Ne[hr.column.key]}),Py(K=t.cell(hr))?K:{default:()=>[K]}):Me(cH,An(hr,ke,{style:Ne[hr.column.key]}),null)}}),header:io=>Me(yNe,An(io,ot),{header:t.header,cell:hr=>{let K;return t["header-cell"]?Me(uH,An(hr,tn,{style:Ne[hr.column.key]}),Py(K=t["header-cell"](hr))?K:{default:()=>[K]}):Me(uH,An(hr,tn,{style:Ne[hr.column.key]}),null)}})},Dn=[e.class,i.b(),i.e("root"),{[i.is("dynamic")]:y(x)}],dr={class:i.e("footer"),style:y(O)};return Me("div",{class:Dn,style:y(j)},[Me(XLe,sn,Py(Nt)?Nt:{default:()=>[Nt]}),Me(eNe,yn,Py(Nt)?Nt:{default:()=>[Nt]}),Me(oNe,vn,Py(Nt)?Nt:{default:()=>[Nt]}),t.footer&&Me(ENe,dr,{default:t.footer}),y(Q)&&Me(TNe,{class:i.e("empty"),style:y(Y)},{default:t.empty}),t.overlay&&Me(MNe,{class:i.e("overlay")},{default:t.overlay})])}}});var RNe=wNe;const ANe=pt({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:Ue(Function)}}),DNe=e=>{const t=le(),o=le(0),i=le(0);let c;return mn(()=>{c=ar(t,([u])=>{const{width:f,height:p}=u.contentRect,{paddingLeft:v,paddingRight:_,paddingTop:b,paddingBottom:S}=getComputedStyle(u.target),k=Number.parseInt(v)||0,M=Number.parseInt(_)||0,R=Number.parseInt(b)||0,w=Number.parseInt(S)||0;o.value=f-k-M,i.value=p-R-w}).stop}),Co(()=>{c==null||c()}),st([o,i],([u,f])=>{var p;(p=e.onResize)==null||p.call(e,{width:u,height:f})}),{sizer:t,width:o,height:i}},ONe=Te({name:"ElAutoResizer",props:ANe,setup(e,{slots:t}){const o=ut("auto-resizer"),{height:i,width:c,sizer:u}=DNe(e),f={width:"100%",height:"100%"};return()=>{var p;return Me("div",{ref:u,class:o.b(),style:f},[(p=t.default)==null?void 0:p.call(t,{height:i.value,width:c.value})])}}});var LNe=ONe;const NNe=un(RNe),PNe=un(LNe),XT=Symbol("tabsRootContextKey"),xNe=pt({tabs:{type:Ue(Array),default:()=>sr([])}}),hW="ElTabBar",UNe=Te({name:hW}),FNe=Te({...UNe,props:xNe,setup(e,{expose:t}){const o=e,i=kn(),c=Rt(XT);c||qr(hW,"<el-tabs><el-tab-bar /></el-tabs>");const u=ut("tabs"),f=le(),p=le(),v=()=>{let M=0,R=0;const w=["top","bottom"].includes(c.props.tabPosition)?"width":"height",E=w==="width"?"x":"y",N=E==="x"?"left":"top";return o.tabs.every(F=>{var x,P;const G=(P=(x=i.parent)==null?void 0:x.refs)==null?void 0:P[`tab-${F.uid}`];if(!G)return!1;if(!F.active)return!0;M=G[`offset${Yl(N)}`],R=G[`client${Yl(w)}`];const H=window.getComputedStyle(G);return w==="width"&&(R-=Number.parseFloat(H.paddingLeft)+Number.parseFloat(H.paddingRight),M+=Number.parseFloat(H.paddingLeft)),!1}),{[w]:`${R}px`,transform:`translate${Yl(E)}(${M}px)`}},_=()=>p.value=v(),b=[],S=()=>{var M;b.forEach(w=>w.stop()),b.length=0;const R=(M=i.parent)==null?void 0:M.refs;if(R){for(const w in R)if(w.startsWith("tab-")){const E=R[w];E&&b.push(ar(E,_))}}};st(()=>o.tabs,async()=>{await Vt(),_(),S()},{immediate:!0});const k=ar(f,()=>_());return Co(()=>{b.forEach(M=>M.stop()),b.length=0,k.stop()}),t({ref:f,update:_}),(M,R)=>(ee(),ge("div",{ref_key:"barRef",ref:f,class:ne([y(u).e("active-bar"),y(u).is(y(c).props.tabPosition)]),style:qt(p.value)},null,6))}});var VNe=vt(FNe,[["__file","tab-bar.vue"]]);const GNe=pt({panes:{type:Ue(Array),default:()=>sr([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),BNe={tabClick:(e,t,o)=>o instanceof Event,tabRemove:(e,t)=>t instanceof Event},dH="ElTabNav",HNe=Te({name:dH,props:GNe,emits:BNe,setup(e,{expose:t,emit:o}){const i=Rt(XT);i||qr(dH,"<el-tabs><tab-nav /></el-tabs>");const c=ut("tabs"),u=Cve(),f=Nve(),p=le(),v=le(),_=le(),b=le(),S=le(!1),k=le(0),M=le(!1),R=le(!0),w=z(()=>["top","bottom"].includes(i.props.tabPosition)?"width":"height"),E=z(()=>({transform:`translate${w.value==="width"?"X":"Y"}(-${k.value}px)`})),N=()=>{if(!p.value)return;const j=p.value[`offset${Yl(w.value)}`],W=k.value;if(!W)return;const O=W>j?W-j:0;k.value=O},F=()=>{if(!p.value||!v.value)return;const j=v.value[`offset${Yl(w.value)}`],W=p.value[`offset${Yl(w.value)}`],O=k.value;if(j-O<=W)return;const Q=j-O>W*2?O+W:j-W;k.value=Q},x=async()=>{const j=v.value;if(!S.value||!_.value||!p.value||!j)return;await Vt();const W=_.value.querySelector(".is-active");if(!W)return;const O=p.value,Q=["top","bottom"].includes(i.props.tabPosition),J=W.getBoundingClientRect(),oe=O.getBoundingClientRect(),pe=Q?j.offsetWidth-oe.width:j.offsetHeight-oe.height,ie=k.value;let te=ie;Q?(J.left<oe.left&&(te=ie-(oe.left-J.left)),J.right>oe.right&&(te=ie+J.right-oe.right)):(J.top<oe.top&&(te=ie-(oe.top-J.top)),J.bottom>oe.bottom&&(te=ie+(J.bottom-oe.bottom))),te=Math.max(te,0),k.value=Math.min(te,pe)},P=()=>{var j;if(!v.value||!p.value)return;e.stretch&&((j=b.value)==null||j.update());const W=v.value[`offset${Yl(w.value)}`],O=p.value[`offset${Yl(w.value)}`],Q=k.value;O<W?(S.value=S.value||{},S.value.prev=Q,S.value.next=Q+O<W,W-Q<O&&(k.value=W-O)):(S.value=!1,Q>0&&(k.value=0))},G=j=>{let W=0;switch(j.code){case At.left:case At.up:W=-1;break;case At.right:case At.down:W=1;break;default:return}const O=Array.from(j.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let J=O.indexOf(j.target)+W;J<0?J=O.length-1:J>=O.length&&(J=0),O[J].focus({preventScroll:!0}),O[J].click(),H()},H=()=>{R.value&&(M.value=!0)},Y=()=>M.value=!1;return st(u,j=>{j==="hidden"?R.value=!1:j==="visible"&&setTimeout(()=>R.value=!0,50)}),st(f,j=>{j?setTimeout(()=>R.value=!0,50):R.value=!1}),ar(_,P),mn(()=>setTimeout(()=>x(),0)),dl(()=>P()),t({scrollToActiveTab:x,removeFocus:Y}),()=>{const j=S.value?[Me("span",{class:[c.e("nav-prev"),c.is("disabled",!S.value.prev)],onClick:N},[Me(Pt,null,{default:()=>[Me(Yd,null,null)]})]),Me("span",{class:[c.e("nav-next"),c.is("disabled",!S.value.next)],onClick:F},[Me(Pt,null,{default:()=>[Me(ca,null,null)]})])]:null,W=e.panes.map((O,Q)=>{var J,oe,pe,ie;const te=O.uid,he=O.props.disabled,re=(oe=(J=O.props.name)!=null?J:O.index)!=null?oe:`${Q}`,X=!he&&(O.isClosable||e.editable);O.index=`${Q}`;const ye=X?Me(Pt,{class:"is-icon-close",onClick:ve=>o("tabRemove",O,ve)},{default:()=>[Me(As,null,null)]}):null,ue=((ie=(pe=O.slots).label)==null?void 0:ie.call(pe))||O.props.label,Ie=!he&&O.active?0:-1;return Me("div",{ref:`tab-${te}`,class:[c.e("item"),c.is(i.props.tabPosition),c.is("active",O.active),c.is("disabled",he),c.is("closable",X),c.is("focus",M.value)],id:`tab-${re}`,key:`tab-${te}`,"aria-controls":`pane-${re}`,role:"tab","aria-selected":O.active,tabindex:Ie,onFocus:()=>H(),onBlur:()=>Y(),onClick:ve=>{Y(),o("tabClick",O,re,ve)},onKeydown:ve=>{X&&(ve.code===At.delete||ve.code===At.backspace)&&o("tabRemove",O,ve)}},[ue,ye])});return Me("div",{ref:_,class:[c.e("nav-wrap"),c.is("scrollable",!!S.value),c.is(i.props.tabPosition)]},[j,Me("div",{class:c.e("nav-scroll"),ref:p},[Me("div",{class:[c.e("nav"),c.is(i.props.tabPosition),c.is("stretch",e.stretch&&["top","bottom"].includes(i.props.tabPosition))],ref:v,style:E.value,role:"tablist",onKeydown:G},[e.type?null:Me(VNe,{ref:b,tabs:[...e.panes]},null),W])])])}}}),$Ne=pt({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Ue(Function),default:()=>!0},stretch:Boolean}),hD=e=>Ut(e)||jt(e),qNe={[nn]:e=>hD(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>hD(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>hD(e),tabAdd:()=>!0},KNe=Te({name:"ElTabs",props:$Ne,emits:qNe,setup(e,{emit:t,slots:o,expose:i}){var c;const u=ut("tabs"),f=z(()=>["left","right"].includes(e.tabPosition)),{children:p,addChild:v,removeChild:_}=EN(kn(),"ElTabPane"),b=le(),S=le((c=e.modelValue)!=null?c:"0"),k=async(N,F=!1)=>{var x,P;if(!(S.value===N||qn(N)))try{let G;if(e.beforeLeave){const H=e.beforeLeave(N,S.value);G=H instanceof Promise?await H:H}else G=!0;G!==!1&&(S.value=N,F&&(t(nn,N),t("tabChange",N)),(P=(x=b.value)==null?void 0:x.removeFocus)==null||P.call(x))}catch{}},M=(N,F,x)=>{N.props.disabled||(t("tabClick",N,x),k(F,!0))},R=(N,F)=>{N.props.disabled||qn(N.props.name)||(F.stopPropagation(),t("edit",N.props.name,"remove"),t("tabRemove",N.props.name))},w=()=>{t("edit",void 0,"add"),t("tabAdd")};st(()=>e.modelValue,N=>k(N)),st(S,async()=>{var N;await Vt(),(N=b.value)==null||N.scrollToActiveTab()}),Nn(XT,{props:e,currentName:S,registerPane:N=>{p.value.push(N)},sortPane:v,unregisterPane:_}),i({currentName:S});const E=({render:N})=>N();return()=>{const N=o["add-icon"],F=e.editable||e.addable?Me("div",{class:[u.e("new-tab"),f.value&&u.e("new-tab-vertical")],tabindex:"0",onClick:w,onKeydown:G=>{[At.enter,At.numpadEnter].includes(G.code)&&w()}},[N?Ve(o,"add-icon"):Me(Pt,{class:u.is("icon-plus")},{default:()=>[Me(aK,null,null)]})]):null,x=Me("div",{class:[u.e("header"),f.value&&u.e("header-vertical"),u.is(e.tabPosition)]},[Me(E,{render:()=>{const G=p.value.some(H=>H.slots.label);return Me(HNe,{ref:b,currentName:S.value,editable:e.editable,type:e.type,panes:p.value,stretch:e.stretch,onTabClick:M,onTabRemove:R},{$stable:!G})}},null),F]),P=Me("div",{class:u.e("content")},[Ve(o,"default")]);return Me("div",{class:[u.b(),u.m(e.tabPosition),{[u.m("card")]:e.type==="card",[u.m("border-card")]:e.type==="border-card"}]},[P,x])}}});var zNe=KNe;const WNe=pt({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),fW="ElTabPane",jNe=Te({name:fW}),YNe=Te({...jNe,props:WNe,setup(e){const t=e,o=kn(),i=Qr(),c=Rt(XT);c||qr(fW,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const u=ut("tab-pane"),f=le(),p=z(()=>t.closable||c.props.closable),v=$E(()=>{var M;return c.currentName.value===((M=t.name)!=null?M:f.value)}),_=le(v.value),b=z(()=>{var M;return(M=t.name)!=null?M:f.value}),S=$E(()=>!t.lazy||_.value||v.value);st(v,M=>{M&&(_.value=!0)});const k=eo({uid:o.uid,slots:i,props:t,paneName:b,active:v,index:f,isClosable:p});return c.registerPane(k),mn(()=>{c.sortPane(k)}),rh(()=>{c.unregisterPane(k.uid)}),(M,R)=>y(S)?fn((ee(),ge("div",{key:0,id:`pane-${y(b)}`,class:ne(y(u).b()),role:"tabpanel","aria-hidden":!y(v),"aria-labelledby":`tab-${y(b)}`},[Ve(M.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Zn,y(v)]]):$e("v-if",!0)}});var pW=vt(YNe,[["__file","tab-pane.vue"]]);const JNe=un(zNe,{TabPane:pW}),XNe=lr(pW),ZNe=pt({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:ic,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),QNe=Te({name:"ElText"}),e2e=Te({...QNe,props:ZNe,setup(e){const t=e,o=le(),i=Fr(),c=ut("text"),u=z(()=>[c.b(),c.m(t.type),c.m(i.value),c.is("truncated",t.truncated),c.is("line-clamp",!qn(t.lineClamp))]),f=uu().title,p=()=>{var v,_,b,S,k;if(f)return;let M=!1;const R=((v=o.value)==null?void 0:v.textContent)||"";if(t.truncated){const w=(_=o.value)==null?void 0:_.offsetWidth,E=(b=o.value)==null?void 0:b.scrollWidth;w&&E&&E>w&&(M=!0)}else if(!qn(t.lineClamp)){const w=(S=o.value)==null?void 0:S.offsetHeight,E=(k=o.value)==null?void 0:k.scrollHeight;w&&E&&E>w&&(M=!0)}M?o.value.setAttribute("title",R):o.value.removeAttribute("title")};return mn(p),dl(p),(v,_)=>(ee(),We(Tn(v.tag),{ref_key:"textRef",ref:o,class:ne(y(u)),style:qt({"-webkit-line-clamp":v.lineClamp})},{default:Ae(()=>[Ve(v.$slots,"default")]),_:3},8,["class","style"]))}});var t2e=vt(e2e,[["__file","text.vue"]]);const a2=un(t2e),n2e=pt({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:Ue(String),default:"light"},clearable:{type:Boolean,default:!0},size:Kr,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,includeEndTime:{type:Boolean,default:!1},name:String,prefixIcon:{type:Ue([String,Object]),default:()=>iK},clearIcon:{type:Ue([String,Object]),default:()=>pu},...mv}),Jc=e=>{const t=(e||"").split(":");if(t.length>=2){let o=Number.parseInt(t[0],10);const i=Number.parseInt(t[1],10),c=e.toUpperCase();return c.includes("AM")&&o===12?o=0:c.includes("PM")&&o!==12&&(o+=12),{hours:o,minutes:i}}return null},fD=(e,t)=>{const o=Jc(e);if(!o)return-1;const i=Jc(t);if(!i)return-1;const c=o.minutes+o.hours*60,u=i.minutes+i.hours*60;return c===u?0:c>u?1:-1},hH=e=>`${e}`.padStart(2,"0"),vg=e=>`${hH(e.hours)}:${hH(e.minutes)}`,o2e=(e,t)=>{const o=Jc(e);if(!o)return"";const i=Jc(t);if(!i)return"";const c={hours:o.hours,minutes:o.minutes};return c.minutes+=i.minutes,c.hours+=i.hours,c.hours+=Math.floor(c.minutes/60),c.minutes=c.minutes%60,vg(c)},r2e=Te({name:"ElTimeSelect"}),i2e=Te({...r2e,props:n2e,emits:[wn,"blur","focus","clear",nn],setup(e,{expose:t}){const o=e;cn.extend(wN);const{Option:i}=dp,c=ut("input"),u=le(),f=Pi(),{lang:p}=Kn(),v=z(()=>o.modelValue),_=z(()=>{const N=Jc(o.start);return N?vg(N):null}),b=z(()=>{const N=Jc(o.end);return N?vg(N):null}),S=z(()=>{const N=Jc(o.step);return N?vg(N):null}),k=z(()=>{const N=Jc(o.minTime||"");return N?vg(N):null}),M=z(()=>{const N=Jc(o.maxTime||"");return N?vg(N):null}),R=z(()=>{var N;const F=[],x=(P,G)=>{F.push({value:P,disabled:fD(G,k.value||"-1:-1")<=0||fD(G,M.value||"100:100")>=0})};if(o.start&&o.end&&o.step){let P=_.value,G;for(;P&&b.value&&fD(P,b.value)<=0;)G=cn(P,"HH:mm").locale(p.value).format(o.format),x(G,P),P=o2e(P,S.value);if(o.includeEndTime&&b.value&&((N=F[F.length-1])==null?void 0:N.value)!==b.value){const H=cn(b.value,"HH:mm").locale(p.value).format(o.format);x(H,b.value)}}return F});return t({blur:()=>{var N,F;(F=(N=u.value)==null?void 0:N.blur)==null||F.call(N)},focus:()=>{var N,F;(F=(N=u.value)==null?void 0:N.focus)==null||F.call(N)}}),(N,F)=>(ee(),We(y(dp),{ref_key:"select",ref:u,"model-value":y(v),disabled:y(f),clearable:N.clearable,"clear-icon":N.clearIcon,size:N.size,effect:N.effect,placeholder:N.placeholder,"default-first-option":"",filterable:N.editable,"empty-values":N.emptyValues,"value-on-clear":N.valueOnClear,"onUpdate:modelValue":x=>N.$emit(y(nn),x),onChange:x=>N.$emit(y(wn),x),onBlur:x=>N.$emit("blur",x),onFocus:x=>N.$emit("focus",x),onClear:()=>N.$emit("clear")},{prefix:Ae(()=>[N.prefixIcon?(ee(),We(y(Pt),{key:0,class:ne(y(c).e("prefix-icon"))},{default:Ae(()=>[(ee(),We(Tn(N.prefixIcon)))]),_:1},8,["class"])):$e("v-if",!0)]),default:Ae(()=>[(ee(!0),ge(Ht,null,Un(y(R),x=>(ee(),We(y(i),{key:x.value,label:x.value,value:x.value,disabled:x.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var a2e=vt(i2e,[["__file","time-select.vue"]]);const s2e=un(a2e),l2e=Te({name:"ElTimeline",setup(e,{slots:t}){const o=ut("timeline");return Nn("timeline",t),()=>Jt("ul",{class:[o.b()]},[Ve(t,"default")])}}),c2e=pt({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:ho},hollow:Boolean}),u2e=Te({name:"ElTimelineItem"}),d2e=Te({...u2e,props:c2e,setup(e){const t=e,o=ut("timeline-item"),i=z(()=>[o.e("node"),o.em("node",t.size||""),o.em("node",t.type||""),o.is("hollow",t.hollow)]);return(c,u)=>(ee(),ge("li",{class:ne([y(o).b(),{[y(o).e("center")]:c.center}])},[Ee("div",{class:ne(y(o).e("tail"))},null,2),c.$slots.dot?$e("v-if",!0):(ee(),ge("div",{key:0,class:ne(y(i)),style:qt({backgroundColor:c.color})},[c.icon?(ee(),We(y(Pt),{key:0,class:ne(y(o).e("icon"))},{default:Ae(()=>[(ee(),We(Tn(c.icon)))]),_:1},8,["class"])):$e("v-if",!0)],6)),c.$slots.dot?(ee(),ge("div",{key:1,class:ne(y(o).e("dot"))},[Ve(c.$slots,"dot")],2)):$e("v-if",!0),Ee("div",{class:ne(y(o).e("wrapper"))},[!c.hideTimestamp&&c.placement==="top"?(ee(),ge("div",{key:0,class:ne([y(o).e("timestamp"),y(o).is("top")])},mt(c.timestamp),3)):$e("v-if",!0),Ee("div",{class:ne(y(o).e("content"))},[Ve(c.$slots,"default")],2),!c.hideTimestamp&&c.placement==="bottom"?(ee(),ge("div",{key:1,class:ne([y(o).e("timestamp"),y(o).is("bottom")])},mt(c.timestamp),3)):$e("v-if",!0)],2)],2))}});var mW=vt(d2e,[["__file","timeline-item.vue"]]);const h2e=un(l2e,{TimelineItem:mW}),f2e=lr(mW),gW=pt({nowrap:Boolean});var vW=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(vW||{});const p2e=Object.values(vW),s2=pt({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:Ue(Object),default:null}}),m2e=pt({side:{type:Ue(String),values:p2e,required:!0}}),g2e=["absolute","fixed"],v2e=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],l2=pt({arrowPadding:{type:Ue(Number),default:5},effect:{type:Ue(String),default:"light"},contentClass:String,placement:{type:Ue(String),values:v2e,default:"bottom"},reference:{type:Ue(Object),default:null},offset:{type:Number,default:8},strategy:{type:Ue(String),values:g2e,default:"absolute"},showArrow:Boolean,...Ci(["ariaLabel"])}),c2=pt({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:Ue(Function)},"onUpdate:open":{type:Ue(Function)}}),hg={type:Ue(Function)},u2=pt({onBlur:hg,onClick:hg,onFocus:hg,onMouseDown:hg,onMouseEnter:hg,onMouseLeave:hg}),_2e=pt({...c2,...s2,...u2,...l2,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:Ue(Object),default:null},teleported:Boolean,to:{type:Ue(String),default:"body"}}),ZT=Symbol("tooltipV2"),_W=Symbol("tooltipV2Content"),pD="tooltip_v2.open",y2e=Te({name:"ElTooltipV2Root"}),I2e=Te({...y2e,props:c2,setup(e,{expose:t}){const o=e,i=le(o.defaultOpen),c=le(null),u=z({get:()=>ks(o.open)?i.value:o.open,set:E=>{var N;i.value=E,(N=o["onUpdate:open"])==null||N.call(o,E)}}),f=z(()=>jt(o.delayDuration)&&o.delayDuration>0),{start:p,stop:v}=cp(()=>{u.value=!0},z(()=>o.delayDuration),{immediate:!1}),_=ut("tooltip-v2"),b=bi(),S=()=>{v(),u.value=!0},k=()=>{y(f)?p():S()},M=S,R=()=>{v(),u.value=!1};return st(u,E=>{var N;E&&(document.dispatchEvent(new CustomEvent(pD)),M()),(N=o.onOpenChange)==null||N.call(o,E)}),mn(()=>{document.addEventListener(pD,R)}),Co(()=>{v(),document.removeEventListener(pD,R)}),Nn(ZT,{contentId:b,triggerRef:c,ns:_,onClose:R,onDelayOpen:k,onOpen:M}),t({onOpen:M,onClose:R}),(E,N)=>Ve(E.$slots,"default",{open:y(u)})}});var b2e=vt(I2e,[["__file","root.vue"]]);const C2e=Te({name:"ElTooltipV2Arrow"}),S2e=Te({...C2e,props:{...s2,...m2e},setup(e){const t=e,{ns:o}=Rt(ZT),{arrowRef:i}=Rt(_W),c=z(()=>{const{style:u,width:f,height:p}=t,v=o.namespace.value;return{[`--${v}-tooltip-v2-arrow-width`]:`${f}px`,[`--${v}-tooltip-v2-arrow-height`]:`${p}px`,[`--${v}-tooltip-v2-arrow-border-width`]:`${f/2}px`,[`--${v}-tooltip-v2-arrow-cover-width`]:f/2-1,...u||{}}});return(u,f)=>(ee(),ge("span",{ref_key:"arrowRef",ref:i,style:qt(y(c)),class:ne(y(o).e("arrow"))},null,6))}});var fH=vt(S2e,[["__file","arrow.vue"]]);const ov=Math.min,sp=Math.max,sT=Math.round,JS=Math.floor,Qd=e=>({x:e,y:e}),E2e={left:"right",right:"left",bottom:"top",top:"bottom"},T2e={start:"end",end:"start"};function FO(e,t,o){return sp(e,ov(t,o))}function pI(e,t){return typeof e=="function"?e(t):e}function fp(e){return e.split("-")[0]}function mI(e){return e.split("-")[1]}function yW(e){return e==="x"?"y":"x"}function d2(e){return e==="y"?"height":"width"}function QT(e){return["top","bottom"].includes(fp(e))?"y":"x"}function h2(e){return yW(QT(e))}function M2e(e,t,o){o===void 0&&(o=!1);const i=mI(e),c=h2(e),u=d2(c);let f=c==="x"?i===(o?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(f=lT(f)),[f,lT(f)]}function k2e(e){const t=lT(e);return[VO(e),t,VO(t)]}function VO(e){return e.replace(/start|end/g,t=>T2e[t])}function w2e(e,t,o){const i=["left","right"],c=["right","left"],u=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return o?t?c:i:t?i:c;case"left":case"right":return t?u:f;default:return[]}}function R2e(e,t,o,i){const c=mI(e);let u=w2e(fp(e),o==="start",i);return c&&(u=u.map(f=>f+"-"+c),t&&(u=u.concat(u.map(VO)))),u}function lT(e){return e.replace(/left|right|bottom|top/g,t=>E2e[t])}function A2e(e){return{top:0,right:0,bottom:0,left:0,...e}}function IW(e){return typeof e!="number"?A2e(e):{top:e,right:e,bottom:e,left:e}}function cT(e){const{x:t,y:o,width:i,height:c}=e;return{width:i,height:c,top:o,left:t,right:t+i,bottom:o+c,x:t,y:o}}function pH(e,t,o){let{reference:i,floating:c}=e;const u=QT(t),f=h2(t),p=d2(f),v=fp(t),_=u==="y",b=i.x+i.width/2-c.width/2,S=i.y+i.height/2-c.height/2,k=i[p]/2-c[p]/2;let M;switch(v){case"top":M={x:b,y:i.y-c.height};break;case"bottom":M={x:b,y:i.y+i.height};break;case"right":M={x:i.x+i.width,y:S};break;case"left":M={x:i.x-c.width,y:S};break;default:M={x:i.x,y:i.y}}switch(mI(t)){case"start":M[f]-=k*(o&&_?-1:1);break;case"end":M[f]+=k*(o&&_?-1:1);break}return M}const D2e=async(e,t,o)=>{const{placement:i="bottom",strategy:c="absolute",middleware:u=[],platform:f}=o,p=u.filter(Boolean),v=await(f.isRTL==null?void 0:f.isRTL(t));let _=await f.getElementRects({reference:e,floating:t,strategy:c}),{x:b,y:S}=pH(_,i,v),k=i,M={},R=0;for(let w=0;w<p.length;w++){const{name:E,fn:N}=p[w],{x:F,y:x,data:P,reset:G}=await N({x:b,y:S,initialPlacement:i,placement:k,strategy:c,middlewareData:M,rects:_,platform:f,elements:{reference:e,floating:t}});b=F??b,S=x??S,M={...M,[E]:{...M[E],...P}},G&&R<=50&&(R++,typeof G=="object"&&(G.placement&&(k=G.placement),G.rects&&(_=G.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:c}):G.rects),{x:b,y:S}=pH(_,k,v)),w=-1)}return{x:b,y:S,placement:k,strategy:c,middlewareData:M}};async function f2(e,t){var o;t===void 0&&(t={});const{x:i,y:c,platform:u,rects:f,elements:p,strategy:v}=e,{boundary:_="clippingAncestors",rootBoundary:b="viewport",elementContext:S="floating",altBoundary:k=!1,padding:M=0}=pI(t,e),R=IW(M),E=p[k?S==="floating"?"reference":"floating":S],N=cT(await u.getClippingRect({element:(o=await(u.isElement==null?void 0:u.isElement(E)))==null||o?E:E.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(p.floating)),boundary:_,rootBoundary:b,strategy:v})),F=S==="floating"?{x:i,y:c,width:f.floating.width,height:f.floating.height}:f.reference,x=await(u.getOffsetParent==null?void 0:u.getOffsetParent(p.floating)),P=await(u.isElement==null?void 0:u.isElement(x))?await(u.getScale==null?void 0:u.getScale(x))||{x:1,y:1}:{x:1,y:1},G=cT(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:p,rect:F,offsetParent:x,strategy:v}):F);return{top:(N.top-G.top+R.top)/P.y,bottom:(G.bottom-N.bottom+R.bottom)/P.y,left:(N.left-G.left+R.left)/P.x,right:(G.right-N.right+R.right)/P.x}}const O2e=e=>({name:"arrow",options:e,async fn(t){const{x:o,y:i,placement:c,rects:u,platform:f,elements:p,middlewareData:v}=t,{element:_,padding:b=0}=pI(e,t)||{};if(_==null)return{};const S=IW(b),k={x:o,y:i},M=h2(c),R=d2(M),w=await f.getDimensions(_),E=M==="y",N=E?"top":"left",F=E?"bottom":"right",x=E?"clientHeight":"clientWidth",P=u.reference[R]+u.reference[M]-k[M]-u.floating[R],G=k[M]-u.reference[M],H=await(f.getOffsetParent==null?void 0:f.getOffsetParent(_));let Y=H?H[x]:0;(!Y||!await(f.isElement==null?void 0:f.isElement(H)))&&(Y=p.floating[x]||u.floating[R]);const j=P/2-G/2,W=Y/2-w[R]/2-1,O=ov(S[N],W),Q=ov(S[F],W),J=O,oe=Y-w[R]-Q,pe=Y/2-w[R]/2+j,ie=FO(J,pe,oe),te=!v.arrow&&mI(c)!=null&&pe!==ie&&u.reference[R]/2-(pe<J?O:Q)-w[R]/2<0,he=te?pe<J?pe-J:pe-oe:0;return{[M]:k[M]+he,data:{[M]:ie,centerOffset:pe-ie-he,...te&&{alignmentOffset:he}},reset:te}}}),L2e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var o,i;const{placement:c,middlewareData:u,rects:f,initialPlacement:p,platform:v,elements:_}=t,{mainAxis:b=!0,crossAxis:S=!0,fallbackPlacements:k,fallbackStrategy:M="bestFit",fallbackAxisSideDirection:R="none",flipAlignment:w=!0,...E}=pI(e,t);if((o=u.arrow)!=null&&o.alignmentOffset)return{};const N=fp(c),F=fp(p)===p,x=await(v.isRTL==null?void 0:v.isRTL(_.floating)),P=k||(F||!w?[lT(p)]:k2e(p));!k&&R!=="none"&&P.push(...R2e(p,w,R,x));const G=[p,...P],H=await f2(t,E),Y=[];let j=((i=u.flip)==null?void 0:i.overflows)||[];if(b&&Y.push(H[N]),S){const J=M2e(c,f,x);Y.push(H[J[0]],H[J[1]])}if(j=[...j,{placement:c,overflows:Y}],!Y.every(J=>J<=0)){var W,O;const J=(((W=u.flip)==null?void 0:W.index)||0)+1,oe=G[J];if(oe)return{data:{index:J,overflows:j},reset:{placement:oe}};let pe=(O=j.filter(ie=>ie.overflows[0]<=0).sort((ie,te)=>ie.overflows[1]-te.overflows[1])[0])==null?void 0:O.placement;if(!pe)switch(M){case"bestFit":{var Q;const ie=(Q=j.map(te=>[te.placement,te.overflows.filter(he=>he>0).reduce((he,re)=>he+re,0)]).sort((te,he)=>te[1]-he[1])[0])==null?void 0:Q[0];ie&&(pe=ie);break}case"initialPlacement":pe=p;break}if(c!==pe)return{reset:{placement:pe}}}return{}}}};async function N2e(e,t){const{placement:o,platform:i,elements:c}=e,u=await(i.isRTL==null?void 0:i.isRTL(c.floating)),f=fp(o),p=mI(o),v=QT(o)==="y",_=["left","top"].includes(f)?-1:1,b=u&&v?-1:1,S=pI(t,e);let{mainAxis:k,crossAxis:M,alignmentAxis:R}=typeof S=="number"?{mainAxis:S,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...S};return p&&typeof R=="number"&&(M=p==="end"?R*-1:R),v?{x:M*b,y:k*_}:{x:k*_,y:M*b}}const P2e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var o,i;const{x:c,y:u,placement:f,middlewareData:p}=t,v=await N2e(t,e);return f===((o=p.offset)==null?void 0:o.placement)&&(i=p.arrow)!=null&&i.alignmentOffset?{}:{x:c+v.x,y:u+v.y,data:{...v,placement:f}}}}},x2e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:o,y:i,placement:c}=t,{mainAxis:u=!0,crossAxis:f=!1,limiter:p={fn:E=>{let{x:N,y:F}=E;return{x:N,y:F}}},...v}=pI(e,t),_={x:o,y:i},b=await f2(t,v),S=QT(fp(c)),k=yW(S);let M=_[k],R=_[S];if(u){const E=k==="y"?"top":"left",N=k==="y"?"bottom":"right",F=M+b[E],x=M-b[N];M=FO(F,M,x)}if(f){const E=S==="y"?"top":"left",N=S==="y"?"bottom":"right",F=R+b[E],x=R-b[N];R=FO(F,R,x)}const w=p.fn({...t,[k]:M,[S]:R});return{...w,data:{x:w.x-o,y:w.y-i}}}}};function Iv(e){return bW(e)?(e.nodeName||"").toLowerCase():"#document"}function ns(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function gu(e){var t;return(t=(bW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function bW(e){return e instanceof Node||e instanceof ns(e).Node}function oc(e){return e instanceof Element||e instanceof ns(e).Element}function rc(e){return e instanceof HTMLElement||e instanceof ns(e).HTMLElement}function mH(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ns(e).ShadowRoot}function gI(e){const{overflow:t,overflowX:o,overflowY:i,display:c}=ul(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+o)&&!["inline","contents"].includes(c)}function U2e(e){return["table","td","th"].includes(Iv(e))}function p2(e){const t=m2(),o=ul(e);return o.transform!=="none"||o.perspective!=="none"||(o.containerType?o.containerType!=="normal":!1)||!t&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!t&&(o.filter?o.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(o.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(o.contain||"").includes(i))}function F2e(e){let t=eh(e);for(;rc(t)&&!rv(t);){if(p2(t))return t;t=eh(t)}return null}function m2(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function rv(e){return["html","body","#document"].includes(Iv(e))}function ul(e){return ns(e).getComputedStyle(e)}function e1(e){return oc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function eh(e){if(Iv(e)==="html")return e;const t=e.assignedSlot||e.parentNode||mH(e)&&e.host||gu(e);return mH(t)?t.host:t}function CW(e){const t=eh(e);return rv(t)?e.ownerDocument?e.ownerDocument.body:e.body:rc(t)&&gI(t)?t:CW(t)}function z0(e,t,o){var i;t===void 0&&(t=[]),o===void 0&&(o=!0);const c=CW(e),u=c===((i=e.ownerDocument)==null?void 0:i.body),f=ns(c);return u?t.concat(f,f.visualViewport||[],gI(c)?c:[],f.frameElement&&o?z0(f.frameElement):[]):t.concat(c,z0(c,[],o))}function SW(e){const t=ul(e);let o=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const c=rc(e),u=c?e.offsetWidth:o,f=c?e.offsetHeight:i,p=sT(o)!==u||sT(i)!==f;return p&&(o=u,i=f),{width:o,height:i,$:p}}function g2(e){return oc(e)?e:e.contextElement}function xg(e){const t=g2(e);if(!rc(t))return Qd(1);const o=t.getBoundingClientRect(),{width:i,height:c,$:u}=SW(t);let f=(u?sT(o.width):o.width)/i,p=(u?sT(o.height):o.height)/c;return(!f||!Number.isFinite(f))&&(f=1),(!p||!Number.isFinite(p))&&(p=1),{x:f,y:p}}const V2e=Qd(0);function EW(e){const t=ns(e);return!m2()||!t.visualViewport?V2e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function G2e(e,t,o){return t===void 0&&(t=!1),!o||t&&o!==ns(e)?!1:t}function pp(e,t,o,i){t===void 0&&(t=!1),o===void 0&&(o=!1);const c=e.getBoundingClientRect(),u=g2(e);let f=Qd(1);t&&(i?oc(i)&&(f=xg(i)):f=xg(e));const p=G2e(u,o,i)?EW(u):Qd(0);let v=(c.left+p.x)/f.x,_=(c.top+p.y)/f.y,b=c.width/f.x,S=c.height/f.y;if(u){const k=ns(u),M=i&&oc(i)?ns(i):i;let R=k,w=R.frameElement;for(;w&&i&&M!==R;){const E=xg(w),N=w.getBoundingClientRect(),F=ul(w),x=N.left+(w.clientLeft+parseFloat(F.paddingLeft))*E.x,P=N.top+(w.clientTop+parseFloat(F.paddingTop))*E.y;v*=E.x,_*=E.y,b*=E.x,S*=E.y,v+=x,_+=P,R=ns(w),w=R.frameElement}}return cT({width:b,height:S,x:v,y:_})}const B2e=[":popover-open",":modal"];function v2(e){return B2e.some(t=>{try{return e.matches(t)}catch{return!1}})}function H2e(e){let{elements:t,rect:o,offsetParent:i,strategy:c}=e;const u=c==="fixed",f=gu(i),p=t?v2(t.floating):!1;if(i===f||p&&u)return o;let v={scrollLeft:0,scrollTop:0},_=Qd(1);const b=Qd(0),S=rc(i);if((S||!S&&!u)&&((Iv(i)!=="body"||gI(f))&&(v=e1(i)),rc(i))){const k=pp(i);_=xg(i),b.x=k.x+i.clientLeft,b.y=k.y+i.clientTop}return{width:o.width*_.x,height:o.height*_.y,x:o.x*_.x-v.scrollLeft*_.x+b.x,y:o.y*_.y-v.scrollTop*_.y+b.y}}function $2e(e){return Array.from(e.getClientRects())}function TW(e){return pp(gu(e)).left+e1(e).scrollLeft}function q2e(e){const t=gu(e),o=e1(e),i=e.ownerDocument.body,c=sp(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),u=sp(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let f=-o.scrollLeft+TW(e);const p=-o.scrollTop;return ul(i).direction==="rtl"&&(f+=sp(t.clientWidth,i.clientWidth)-c),{width:c,height:u,x:f,y:p}}function K2e(e,t){const o=ns(e),i=gu(e),c=o.visualViewport;let u=i.clientWidth,f=i.clientHeight,p=0,v=0;if(c){u=c.width,f=c.height;const _=m2();(!_||_&&t==="fixed")&&(p=c.offsetLeft,v=c.offsetTop)}return{width:u,height:f,x:p,y:v}}function z2e(e,t){const o=pp(e,!0,t==="fixed"),i=o.top+e.clientTop,c=o.left+e.clientLeft,u=rc(e)?xg(e):Qd(1),f=e.clientWidth*u.x,p=e.clientHeight*u.y,v=c*u.x,_=i*u.y;return{width:f,height:p,x:v,y:_}}function gH(e,t,o){let i;if(t==="viewport")i=K2e(e,o);else if(t==="document")i=q2e(gu(e));else if(oc(t))i=z2e(t,o);else{const c=EW(e);i={...t,x:t.x-c.x,y:t.y-c.y}}return cT(i)}function MW(e,t){const o=eh(e);return o===t||!oc(o)||rv(o)?!1:ul(o).position==="fixed"||MW(o,t)}function W2e(e,t){const o=t.get(e);if(o)return o;let i=z0(e,[],!1).filter(p=>oc(p)&&Iv(p)!=="body"),c=null;const u=ul(e).position==="fixed";let f=u?eh(e):e;for(;oc(f)&&!rv(f);){const p=ul(f),v=p2(f);!v&&p.position==="fixed"&&(c=null),(u?!v&&!c:!v&&p.position==="static"&&!!c&&["absolute","fixed"].includes(c.position)||gI(f)&&!v&&MW(e,f))?i=i.filter(b=>b!==f):c=p,f=eh(f)}return t.set(e,i),i}function j2e(e){let{element:t,boundary:o,rootBoundary:i,strategy:c}=e;const f=[...o==="clippingAncestors"?v2(t)?[]:W2e(t,this._c):[].concat(o),i],p=f[0],v=f.reduce((_,b)=>{const S=gH(t,b,c);return _.top=sp(S.top,_.top),_.right=ov(S.right,_.right),_.bottom=ov(S.bottom,_.bottom),_.left=sp(S.left,_.left),_},gH(t,p,c));return{width:v.right-v.left,height:v.bottom-v.top,x:v.left,y:v.top}}function Y2e(e){const{width:t,height:o}=SW(e);return{width:t,height:o}}function J2e(e,t,o){const i=rc(t),c=gu(t),u=o==="fixed",f=pp(e,!0,u,t);let p={scrollLeft:0,scrollTop:0};const v=Qd(0);if(i||!i&&!u)if((Iv(t)!=="body"||gI(c))&&(p=e1(t)),i){const S=pp(t,!0,u,t);v.x=S.x+t.clientLeft,v.y=S.y+t.clientTop}else c&&(v.x=TW(c));const _=f.left+p.scrollLeft-v.x,b=f.top+p.scrollTop-v.y;return{x:_,y:b,width:f.width,height:f.height}}function mD(e){return ul(e).position==="static"}function vH(e,t){return!rc(e)||ul(e).position==="fixed"?null:t?t(e):e.offsetParent}function kW(e,t){const o=ns(e);if(v2(e))return o;if(!rc(e)){let c=eh(e);for(;c&&!rv(c);){if(oc(c)&&!mD(c))return c;c=eh(c)}return o}let i=vH(e,t);for(;i&&U2e(i)&&mD(i);)i=vH(i,t);return i&&rv(i)&&mD(i)&&!p2(i)?o:i||F2e(e)||o}const X2e=async function(e){const t=this.getOffsetParent||kW,o=this.getDimensions,i=await o(e.floating);return{reference:J2e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Z2e(e){return ul(e).direction==="rtl"}const Q2e={convertOffsetParentRelativeRectToViewportRelativeRect:H2e,getDocumentElement:gu,getClippingRect:j2e,getOffsetParent:kW,getElementRects:X2e,getClientRects:$2e,getDimensions:Y2e,getScale:xg,isElement:oc,isRTL:Z2e};function ePe(e,t){let o=null,i;const c=gu(e);function u(){var p;clearTimeout(i),(p=o)==null||p.disconnect(),o=null}function f(p,v){p===void 0&&(p=!1),v===void 0&&(v=1),u();const{left:_,top:b,width:S,height:k}=e.getBoundingClientRect();if(p||t(),!S||!k)return;const M=JS(b),R=JS(c.clientWidth-(_+S)),w=JS(c.clientHeight-(b+k)),E=JS(_),F={rootMargin:-M+"px "+-R+"px "+-w+"px "+-E+"px",threshold:sp(0,ov(1,v))||1};let x=!0;function P(G){const H=G[0].intersectionRatio;if(H!==v){if(!x)return f();H?f(!1,H):i=setTimeout(()=>{f(!1,1e-7)},1e3)}x=!1}try{o=new IntersectionObserver(P,{...F,root:c.ownerDocument})}catch{o=new IntersectionObserver(P,F)}o.observe(e)}return f(!0),u}function tPe(e,t,o,i){i===void 0&&(i={});const{ancestorScroll:c=!0,ancestorResize:u=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:p=typeof IntersectionObserver=="function",animationFrame:v=!1}=i,_=g2(e),b=c||u?[..._?z0(_):[],...z0(t)]:[];b.forEach(N=>{c&&N.addEventListener("scroll",o,{passive:!0}),u&&N.addEventListener("resize",o)});const S=_&&p?ePe(_,o):null;let k=-1,M=null;f&&(M=new ResizeObserver(N=>{let[F]=N;F&&F.target===_&&M&&(M.unobserve(t),cancelAnimationFrame(k),k=requestAnimationFrame(()=>{var x;(x=M)==null||x.observe(t)})),o()}),_&&!v&&M.observe(_),M.observe(t));let R,w=v?pp(e):null;v&&E();function E(){const N=pp(e);w&&(N.x!==w.x||N.y!==w.y||N.width!==w.width||N.height!==w.height)&&o(),w=N,R=requestAnimationFrame(E)}return o(),()=>{var N;b.forEach(F=>{c&&F.removeEventListener("scroll",o),u&&F.removeEventListener("resize",o)}),S==null||S(),(N=M)==null||N.disconnect(),M=null,v&&cancelAnimationFrame(R)}}const nPe=f2,wW=P2e,oPe=x2e,rPe=L2e,RW=O2e,AW=(e,t,o)=>{const i=new Map,c={platform:Q2e,...o},u={...c.platform,_c:i};return D2e(e,t,{...c,platform:u})},iPe=pt({style:{type:Ue([String,Object,Array]),default:()=>({})}}),aPe=Te({name:"ElVisuallyHidden"}),sPe=Te({...aPe,props:iPe,setup(e){const t=e,o=z(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(i,c)=>(ee(),ge("span",An(i.$attrs,{style:y(o)}),[Ve(i.$slots,"default")],16))}});var lPe=vt(sPe,[["__file","visual-hidden.vue"]]);pt({});const cPe=e=>{if(!$n)return;if(!e)return e;const t=sa(e);return t||(Bo(e)?t:e)},uPe=({middleware:e,placement:t,strategy:o})=>{const i=le(),c=le(),u=le(),f=le(),p=le({}),v={x:u,y:f,placement:t,strategy:o,middlewareData:p},_=async()=>{if(!$n)return;const b=cPe(i),S=sa(c);if(!b||!S)return;const k=await AW(b,S,{placement:y(t),strategy:y(o),middleware:y(e)});zg(v).forEach(M=>{v[M].value=k[M]})};return mn(()=>{Di(()=>{_()})}),{...v,update:_,referenceRef:i,contentRef:c}},dPe=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(o){const i=y(e);return i?RW({element:i,padding:t}).fn(o):{}}}),hPe=Te({name:"ElTooltipV2Content"}),fPe=Te({...hPe,props:{...l2,...gW},setup(e){const t=e,{triggerRef:o,contentId:i}=Rt(ZT),c=le(t.placement),u=le(t.strategy),f=le(null),{referenceRef:p,contentRef:v,middlewareData:_,x:b,y:S,update:k}=uPe({placement:c,strategy:u,middleware:z(()=>{const x=[wW(t.offset)];return t.showArrow&&x.push(dPe({arrowRef:f})),x})}),M=pv().nextZIndex(),R=ut("tooltip-v2"),w=z(()=>c.value.split("-")[0]),E=z(()=>({position:y(u),top:`${y(S)||0}px`,left:`${y(b)||0}px`,zIndex:M})),N=z(()=>{if(!t.showArrow)return{};const{arrow:x}=y(_);return{[`--${R.namespace.value}-tooltip-v2-arrow-x`]:`${x==null?void 0:x.x}px`||"",[`--${R.namespace.value}-tooltip-v2-arrow-y`]:`${x==null?void 0:x.y}px`||""}}),F=z(()=>[R.e("content"),R.is("dark",t.effect==="dark"),R.is(y(u)),t.contentClass]);return st(f,()=>k()),st(()=>t.placement,x=>c.value=x),mn(()=>{st(()=>t.reference||o.value,x=>{p.value=x||void 0},{immediate:!0})}),Nn(_W,{arrowRef:f}),(x,P)=>(ee(),ge("div",{ref_key:"contentRef",ref:v,style:qt(y(E)),"data-tooltip-v2-root":""},[x.nowrap?$e("v-if",!0):(ee(),ge("div",{key:0,"data-side":y(w),class:ne(y(F))},[Ve(x.$slots,"default",{contentStyle:y(E),contentClass:y(F)}),Me(y(lPe),{id:y(i),role:"tooltip"},{default:Ae(()=>[x.ariaLabel?(ee(),ge(Ht,{key:0},[Mn(mt(x.ariaLabel),1)],64)):Ve(x.$slots,"default",{key:1})]),_:3},8,["id"]),Ve(x.$slots,"arrow",{style:qt(y(N)),side:y(w)})],10,["data-side"]))],4))}});var _H=vt(fPe,[["__file","content.vue"]]);const pPe=pt({setRef:{type:Ue(Function),required:!0},onlyChild:Boolean});var mPe=Te({props:pPe,setup(e,{slots:t}){const o=le(),i=WT(o,c=>{c?e.setRef(c.nextElementSibling):e.setRef(null)});return()=>{var c;const[u]=((c=t.default)==null?void 0:c.call(t))||[],f=e.onlyChild?VCe(u.children):u.children;return Me(Ht,{ref:i},[f])}}});const gPe=Te({name:"ElTooltipV2Trigger"}),vPe=Te({...gPe,props:{...gW,...u2},setup(e){const t=e,{onClose:o,onOpen:i,onDelayOpen:c,triggerRef:u,contentId:f}=Rt(ZT);let p=!1;const v=F=>{u.value=F},_=()=>{p=!1},b=gr(t.onMouseEnter,c),S=gr(t.onMouseLeave,o),k=gr(t.onMouseDown,()=>{o(),p=!0,document.addEventListener("mouseup",_,{once:!0})}),M=gr(t.onFocus,()=>{p||i()}),R=gr(t.onBlur,o),w=gr(t.onClick,F=>{F.detail===0&&o()}),E={blur:R,click:w,focus:M,mousedown:k,mouseenter:b,mouseleave:S},N=(F,x,P)=>{F&&Object.entries(x).forEach(([G,H])=>{F[P](G,H)})};return st(u,(F,x)=>{N(F,E,"addEventListener"),N(x,E,"removeEventListener"),F&&F.setAttribute("aria-describedby",f.value)}),Co(()=>{N(u.value,E,"removeEventListener"),document.removeEventListener("mouseup",_)}),(F,x)=>F.nowrap?(ee(),We(y(mPe),{key:0,"set-ref":v,"only-child":""},{default:Ae(()=>[Ve(F.$slots,"default")]),_:3})):(ee(),ge("button",An({key:1,ref_key:"triggerRef",ref:u},F.$attrs),[Ve(F.$slots,"default")],16))}});var _Pe=vt(vPe,[["__file","trigger.vue"]]);const yPe=Te({name:"ElTooltipV2"}),IPe=Te({...yPe,props:_2e,setup(e){const o=hi(e),i=eo(il(o,Object.keys(s2))),c=eo(il(o,Object.keys(l2))),u=eo(il(o,Object.keys(c2))),f=eo(il(o,Object.keys(u2)));return(p,v)=>(ee(),We(b2e,Za(Zl(u)),{default:Ae(({open:_})=>[Me(_Pe,An(f,{nowrap:""}),{default:Ae(()=>[Ve(p.$slots,"trigger")]),_:3},16),Me(y(vv),{to:p.to,disabled:!p.teleported},{default:Ae(()=>[p.fullTransition?(ee(),We(Zr,Za(An({key:0},p.transitionProps)),{default:Ae(()=>[p.alwaysOn||_?(ee(),We(_H,Za(An({key:0},c)),{arrow:Ae(({style:b,side:S})=>[p.showArrow?(ee(),We(fH,An({key:0},i,{style:b,side:S}),null,16,["style","side"])):$e("v-if",!0)]),default:Ae(()=>[Ve(p.$slots,"default")]),_:3},16)):$e("v-if",!0)]),_:2},1040)):(ee(),ge(Ht,{key:1},[p.alwaysOn||_?(ee(),We(_H,Za(An({key:0},c)),{arrow:Ae(({style:b,side:S})=>[p.showArrow?(ee(),We(fH,An({key:0},i,{style:b,side:S}),null,16,["style","side"])):$e("v-if",!0)]),default:Ae(()=>[Ve(p.$slots,"default")]),_:3},16)):$e("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var bPe=vt(IPe,[["__file","tooltip.vue"]]);const CPe=un(bPe),DW="left-check-change",OW="right-check-change",_g=pt({data:{type:Ue(Array),default:()=>[]},titles:{type:Ue(Array),default:()=>[]},buttonTexts:{type:Ue(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:Ue(Function)},leftDefaultChecked:{type:Ue(Array),default:()=>[]},rightDefaultChecked:{type:Ue(Array),default:()=>[]},renderContent:{type:Ue(Function)},modelValue:{type:Ue(Array),default:()=>[]},format:{type:Ue(Object),default:()=>({})},filterable:Boolean,props:{type:Ue(Object),default:()=>sr({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),GO=(e,t)=>[e,t].every(ht)||ht(e)&&oi(t),SPe={[wn]:(e,t,o)=>[e,o].every(ht)&&["left","right"].includes(t),[nn]:e=>ht(e),[DW]:GO,[OW]:GO},BO="checked-change",EPe=pt({data:_g.data,optionRender:{type:Ue(Function)},placeholder:String,title:String,filterable:Boolean,format:_g.format,filterMethod:_g.filterMethod,defaultChecked:_g.leftDefaultChecked,props:_g.props}),TPe={[BO]:GO},vI=e=>{const t={label:"label",key:"key",disabled:"disabled"};return z(()=>({...t,...e.props}))},MPe=(e,t,o)=>{const i=vI(e),c=z(()=>e.data.filter(b=>zt(e.filterMethod)?e.filterMethod(t.query,b):String(b[i.value.label]||b[i.value.key]).toLowerCase().includes(t.query.toLowerCase()))),u=z(()=>c.value.filter(b=>!b[i.value.disabled])),f=z(()=>{const b=t.checked.length,S=e.data.length,{noChecked:k,hasChecked:M}=e.format;return k&&M?b>0?M.replace(/\${checked}/g,b.toString()).replace(/\${total}/g,S.toString()):k.replace(/\${total}/g,S.toString()):`${b}/${S}`}),p=z(()=>{const b=t.checked.length;return b>0&&b<u.value.length}),v=()=>{const b=u.value.map(S=>S[i.value.key]);t.allChecked=b.length>0&&b.every(S=>t.checked.includes(S))},_=b=>{t.checked=b?u.value.map(S=>S[i.value.key]):[]};return st(()=>t.checked,(b,S)=>{if(v(),t.checkChangeByUser){const k=b.concat(S).filter(M=>!b.includes(M)||!S.includes(M));o(BO,b,k)}else o(BO,b),t.checkChangeByUser=!0}),st(u,()=>{v()}),st(()=>e.data,()=>{const b=[],S=c.value.map(k=>k[i.value.key]);t.checked.forEach(k=>{S.includes(k)&&b.push(k)}),t.checkChangeByUser=!1,t.checked=b}),st(()=>e.defaultChecked,(b,S)=>{if(S&&b.length===S.length&&b.every(R=>S.includes(R)))return;const k=[],M=u.value.map(R=>R[i.value.key]);b.forEach(R=>{M.includes(R)&&k.push(R)}),t.checkChangeByUser=!1,t.checked=k},{immediate:!0}),{filteredData:c,checkableData:u,checkedSummary:f,isIndeterminate:p,updateAllChecked:v,handleAllCheckedChange:_}},kPe=Te({name:"ElTransferPanel"}),wPe=Te({...kPe,props:EPe,emits:TPe,setup(e,{expose:t,emit:o}){const i=e,c=Qr(),u=({option:x})=>x,{t:f}=Kn(),p=ut("transfer"),v=eo({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),_=vI(i),{filteredData:b,checkedSummary:S,isIndeterminate:k,handleAllCheckedChange:M}=MPe(i,v,o),R=z(()=>!Xa(v.query)&&Xa(b.value)),w=z(()=>!Xa(c.default()[0].children)),{checked:E,allChecked:N,query:F}=hi(v);return t({query:F}),(x,P)=>(ee(),ge("div",{class:ne(y(p).b("panel"))},[Ee("p",{class:ne(y(p).be("panel","header"))},[Me(y(Ls),{modelValue:y(N),"onUpdate:modelValue":G=>Bo(N)?N.value=G:null,indeterminate:y(k),"validate-event":!1,onChange:y(M)},{default:Ae(()=>[Mn(mt(x.title)+" ",1),Ee("span",null,mt(y(S)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),Ee("div",{class:ne([y(p).be("panel","body"),y(p).is("with-footer",y(w))])},[x.filterable?(ee(),We(y(Yi),{key:0,modelValue:y(F),"onUpdate:modelValue":G=>Bo(F)?F.value=G:null,class:ne(y(p).be("panel","filter")),size:"default",placeholder:x.placeholder,"prefix-icon":y(eye),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):$e("v-if",!0),fn(Me(y(a9),{modelValue:y(E),"onUpdate:modelValue":G=>Bo(E)?E.value=G:null,"validate-event":!1,class:ne([y(p).is("filterable",x.filterable),y(p).be("panel","list")])},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(y(b),G=>(ee(),We(y(Ls),{key:G[y(_).key],class:ne(y(p).be("panel","item")),value:G[y(_).key],disabled:G[y(_).disabled],"validate-event":!1},{default:Ae(()=>{var H;return[Me(u,{option:(H=x.optionRender)==null?void 0:H.call(x,G)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[Zn,!y(R)&&!y(Xa)(x.data)]]),fn(Ee("div",{class:ne(y(p).be("panel","empty"))},[Ve(x.$slots,"empty",{},()=>[Mn(mt(y(R)?y(f)("el.transfer.noMatch"):y(f)("el.transfer.noData")),1)])],2),[[Zn,y(R)||y(Xa)(x.data)]])],2),y(w)?(ee(),ge("p",{key:0,class:ne(y(p).be("panel","footer"))},[Ve(x.$slots,"default")],2)):$e("v-if",!0)],2))}});var yH=vt(wPe,[["__file","transfer-panel.vue"]]);const RPe=e=>{const t=vI(e),o=z(()=>e.data.reduce((u,f)=>(u[f[t.value.key]]=f)&&u,{})),i=z(()=>e.data.filter(u=>!e.modelValue.includes(u[t.value.key]))),c=z(()=>e.targetOrder==="original"?e.data.filter(u=>e.modelValue.includes(u[t.value.key])):e.modelValue.reduce((u,f)=>{const p=o.value[f];return p&&u.push(p),u},[]));return{sourceData:i,targetData:c}},APe=(e,t,o)=>{const i=vI(e),c=(p,v,_)=>{o(nn,p),o(wn,p,v,_)};return{addToLeft:()=>{const p=e.modelValue.slice();t.rightChecked.forEach(v=>{const _=p.indexOf(v);_>-1&&p.splice(_,1)}),c(p,"left",t.rightChecked)},addToRight:()=>{let p=e.modelValue.slice();const v=e.data.filter(_=>{const b=_[i.value.key];return t.leftChecked.includes(b)&&!e.modelValue.includes(b)}).map(_=>_[i.value.key]);p=e.targetOrder==="unshift"?v.concat(p):p.concat(v),e.targetOrder==="original"&&(p=e.data.filter(_=>p.includes(_[i.value.key])).map(_=>_[i.value.key])),c(p,"right",t.leftChecked)}}},DPe=(e,t)=>({onSourceCheckedChange:(c,u)=>{e.leftChecked=c,u&&t(DW,c,u)},onTargetCheckedChange:(c,u)=>{e.rightChecked=c,u&&t(OW,c,u)}}),OPe=Te({name:"ElTransfer"}),LPe=Te({...OPe,props:_g,emits:SPe,setup(e,{expose:t,emit:o}){const i=e,c=Qr(),{t:u}=Kn(),f=ut("transfer"),{formItem:p}=Ni(),v=eo({leftChecked:[],rightChecked:[]}),_=vI(i),{sourceData:b,targetData:S}=RPe(i),{onSourceCheckedChange:k,onTargetCheckedChange:M}=DPe(v,o),{addToLeft:R,addToRight:w}=APe(i,v,o),E=le(),N=le(),F=j=>{switch(j){case"left":E.value.query="";break;case"right":N.value.query="";break}},x=z(()=>i.buttonTexts.length===2),P=z(()=>i.titles[0]||u("el.transfer.titles.0")),G=z(()=>i.titles[1]||u("el.transfer.titles.1")),H=z(()=>i.filterPlaceholder||u("el.transfer.filterPlaceholder"));st(()=>i.modelValue,()=>{var j;i.validateEvent&&((j=p==null?void 0:p.validate)==null||j.call(p,"change").catch(W=>void 0))});const Y=z(()=>j=>{var W;if(i.renderContent)return i.renderContent(Jt,j);const O=(((W=c.default)==null?void 0:W.call(c,{option:j}))||[]).filter(Q=>Q.type!==Ai);return O.length?O:Jt("span",j[_.value.label]||j[_.value.key])});return t({clearQuery:F,leftPanel:E,rightPanel:N}),(j,W)=>(ee(),ge("div",{class:ne(y(f).b())},[Me(yH,{ref_key:"leftPanel",ref:E,data:y(b),"option-render":y(Y),placeholder:y(H),title:y(P),filterable:j.filterable,format:j.format,"filter-method":j.filterMethod,"default-checked":j.leftDefaultChecked,props:i.props,onCheckedChange:y(k)},{empty:Ae(()=>[Ve(j.$slots,"left-empty")]),default:Ae(()=>[Ve(j.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ee("div",{class:ne(y(f).e("buttons"))},[Me(y(di),{type:"primary",class:ne([y(f).e("button"),y(f).is("with-texts",y(x))]),disabled:y(Xa)(v.rightChecked),onClick:y(R)},{default:Ae(()=>[Me(y(Pt),null,{default:Ae(()=>[Me(y(Yd))]),_:1}),y(qn)(j.buttonTexts[0])?$e("v-if",!0):(ee(),ge("span",{key:0},mt(j.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Me(y(di),{type:"primary",class:ne([y(f).e("button"),y(f).is("with-texts",y(x))]),disabled:y(Xa)(v.leftChecked),onClick:y(w)},{default:Ae(()=>[y(qn)(j.buttonTexts[1])?$e("v-if",!0):(ee(),ge("span",{key:0},mt(j.buttonTexts[1]),1)),Me(y(Pt),null,{default:Ae(()=>[Me(y(ca))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Me(yH,{ref_key:"rightPanel",ref:N,data:y(S),"option-render":y(Y),placeholder:y(H),filterable:j.filterable,format:j.format,"filter-method":j.filterMethod,title:y(G),"default-checked":j.rightDefaultChecked,props:i.props,onCheckedChange:y(M)},{empty:Ae(()=>[Ve(j.$slots,"right-empty")]),default:Ae(()=>[Ve(j.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var NPe=vt(LPe,[["__file","transfer.vue"]]);const PPe=un(NPe),Ug="$treeNodeId",IH=function(e,t){!t||t[Ug]||Object.defineProperty(t,Ug,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},_2=(e,t)=>t==null?void 0:t[e||Ug],HO=(e,t,o)=>{const i=e.value.currentNode;o();const c=e.value.currentNode;i!==c&&t("current-change",c?c.data:null,c)},$O=e=>{let t=!0,o=!0,i=!0;for(let c=0,u=e.length;c<u;c++){const f=e[c];(f.checked!==!0||f.indeterminate)&&(t=!1,f.disabled||(i=!1)),(f.checked!==!1||f.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:i,half:!t&&!o}},Vy=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:o,half:i}=$O(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):i?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const c=e.parent;!c||c.level===0||e.store.checkStrictly||Vy(c)},XS=function(e,t){const o=e.store.props,i=e.data||{},c=o[t];if(zt(c))return c(i,e);if(Ut(c))return i[c];if(qn(c)){const u=i[t];return qn(u)?"":u}};let xPe=0,qO=class bE{constructor(t){this.id=xPe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)jn(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf<"u"){const u=XS(this,"isLeaf");vo(u)&&(this.isLeafByUser=u)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),ht(this.data)||IH(this,this.data),!this.data)return;const i=t.defaultExpandedKeys,c=t.key;c&&i&&i.includes(this.key)&&this.expand(null,t.autoExpandParent),c&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){ht(t)||IH(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&ht(this.data)?o=this.data:o=XS(this,"children")||[];for(let i=0,c=o.length;i<c;i++)this.insertChild({data:o[i]})}get label(){return XS(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return XS(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(i=>i===t||o&&i.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,i){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof bE)){if(!i){const c=this.getChildren(!0);c.includes(t.data)||(qn(o)||o<0?c.push(t.data):c.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=eo(new bE(t)),t instanceof bE&&t.initialize()}t.level=this.level+1,qn(o)||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let i;o&&(i=this.childNodes.indexOf(o)),this.insertChild(t,i)}insertAfter(t,o){let i;o&&(i=this.childNodes.indexOf(o),i!==-1&&(i+=1)),this.insertChild(t,i)}removeChild(t){const o=this.getChildren()||[],i=o.indexOf(t.data);i>-1&&o.splice(i,1);const c=this.childNodes.indexOf(t);c>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(c,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let i=0;i<this.childNodes.length;i++)if(this.childNodes[i].data===t){o=this.childNodes[i];break}o&&this.removeChild(o)}expand(t,o){const i=()=>{if(o){let c=this.parent;for(;c.level>0;)c.expanded=!0,c=c.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(c=>{c.canFocus=!0})};this.shouldLoadData()?this.loadData(c=>{ht(c)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Vy(this),i())}):i()}doCreateChildren(t,o={}){t.forEach(i=>{this.insertChild(Object.assign({data:i},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,o,i,c){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:f,allWithoutDisable:p}=$O(this.childNodes);!this.isLeaf&&!f&&p&&(this.checked=!1,t=!1);const v=()=>{if(o){const _=this.childNodes;for(let k=0,M=_.length;k<M;k++){const R=_[k];c=c||t!==!1;const w=R.disabled?R.checked:c;R.setChecked(w,o,!0,c)}const{half:b,all:S}=$O(_);S||(this.checked=S,this.indeterminate=b)}};if(this.shouldLoadData()){this.loadData(()=>{v(),Vy(this)},{checked:t!==!1});return}else v()}const u=this.parent;!u||u.level===0||i||Vy(u)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const i=this.store.props;let c="children";return i&&(c=i.children||"children"),qn(o[c])&&(o[c]=null),t&&!o[c]&&(o[c]=[]),o[c]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(u=>u.data),i={},c=[];t.forEach((u,f)=>{const p=u[Ug];!!p&&o.findIndex(_=>_[Ug]===p)>=0?i[p]={index:f,data:u}:c.push({index:f,data:u})}),this.store.lazy||o.forEach(u=>{i[u[Ug]]||this.removeChildByData(u)}),c.forEach(({index:u,data:f})=>{this.insertChild({data:f},u)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const i=u=>{this.childNodes=[],this.doCreateChildren(u,o),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,u)},c=()=>{this.loading=!1};this.store.load(this,i,c)}else t&&t.call(this)}eachNode(t){const o=[this];for(;o.length;){const i=o.shift();o.unshift(...i.childNodes),t(i)}}reInitChecked(){this.store.checkStrictly||Vy(this)}};class UPe{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const o in t)jn(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){if(this.root=new qO({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,i=this.lazy,c=async function(u){const f=u.root?u.root.childNodes:u.childNodes;for(const[p,v]of f.entries())v.visible=o.call(v,t,v.data,v),p%80===0&&p>0&&await Vt(),await c(v);if(!u.visible&&f.length){let p=!0;p=!f.some(v=>v.visible),u.root?u.root.visible=p===!1:u.visible=p===!1}t&&u.visible&&!u.isLeaf&&(!i||u.loaded)&&u.expand()};c(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof qO)return t;const o=gn(t)?_2(this.key,t):t;return this.nodesMap[o]||null}insertBefore(t,o){const i=this.getNode(o);i.parent.insertBefore({data:t},i)}insertAfter(t,o){const i=this.getNode(o);i.parent.insertAfter({data:t},i)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const i=ks(o)?this.root:this.getNode(o);i&&i.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(i=>{const c=o[i];c&&c.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(i=>{this.deregisterNode(i)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const i=[],c=function(u){(u.root?u.root.childNodes:u.childNodes).forEach(p=>{(p.checked||o&&p.indeterminate)&&(!t||t&&p.isLeaf)&&i.push(p.data),c(p)})};return c(this),i}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(i){(i.root?i.root.childNodes:i.childNodes).forEach(u=>{u.indeterminate&&t.push(u.data),o(u)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const i in o)jn(o,i)&&t.push(o[i]);return t}updateChildren(t,o){const i=this.nodesMap[t];if(!i)return;const c=i.childNodes;for(let u=c.length-1;u>=0;u--){const f=c[u];this.remove(f.data)}for(let u=0,f=o.length;u<f;u++){const p=o[u];this.append(p,i.data)}}_setCheckedKeys(t,o=!1,i){const c=this._getAllNodes().sort((v,_)=>v.level-_.level),u=Object.create(null),f=Object.keys(i);c.forEach(v=>v.setChecked(!1,!1));const p=v=>{v.childNodes.forEach(_=>{var b;u[_.data[t]]=!0,(b=_.childNodes)!=null&&b.length&&p(_)})};for(let v=0,_=c.length;v<_;v++){const b=c[v],S=b.data[t].toString();if(!f.includes(S)){b.checked&&!u[S]&&b.setChecked(!1,!1);continue}if(b.childNodes.length&&p(b),b.isLeaf||this.checkStrictly){b.setChecked(!0,!1);continue}if(b.setChecked(!0,!0),o){b.setChecked(!1,!1);const M=function(R){R.childNodes.forEach(E=>{E.isLeaf||E.setChecked(!1,!1),M(E)})};M(b)}}}setCheckedNodes(t,o=!1){const i=this.key,c={};t.forEach(u=>{c[(u||{})[i]]=!0}),this._setCheckedKeys(i,o,c)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const i=this.key,c={};t.forEach(u=>{c[u]=!0}),this._setCheckedKeys(i,o,c)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const i=this.getNode(o);i&&i.expand(null,this.autoExpandParent)})}setChecked(t,o,i){const c=this.getNode(t);c&&c.setChecked(!!o,i)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const i=t[this.key],c=this.nodesMap[i];this.setCurrentNode(c),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(this.currentNodeKey=t,ks(t)){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const i=this.getNode(t);i&&(this.setCurrentNode(i),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const FPe=Te({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=ut("tree"),o=Rt("NodeInstance"),i=Rt("RootTree");return()=>{const c=e.node,{data:u,store:f}=c;return e.renderContent?e.renderContent(Jt,{_self:o,node:c,data:u,store:f}):Ve(i.ctx.slots,"default",{node:c,data:u},()=>[Jt(a2,{tag:"span",truncated:!0,class:t.be("node","label")},()=>[c.label])])}}});var VPe=vt(FPe,[["__file","tree-node-content.vue"]]);function LW(e){const t=Rt("TreeNodeMap",null),o={treeNodeExpand:i=>{e.node!==i&&e.node.collapse()},children:[]};return t&&t.children.push(o),Nn("TreeNodeMap",o),{broadcastExpanded:i=>{if(e.accordion)for(const c of o.children)c.treeNodeExpand(i)}}}const NW=Symbol("dragEvents");function GPe({props:e,ctx:t,el$:o,dropIndicator$:i,store:c}){const u=ut("tree"),f=le({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Nn(NW,{treeNodeDragStart:({event:b,treeNode:S})=>{if(zt(e.allowDrag)&&!e.allowDrag(S.node))return b.preventDefault(),!1;b.dataTransfer.effectAllowed="move";try{b.dataTransfer.setData("text/plain","")}catch{}f.value.draggingNode=S,t.emit("node-drag-start",S.node,b)},treeNodeDragOver:({event:b,treeNode:S})=>{const k=S,M=f.value.dropNode;M&&M.node.id!==k.node.id&&Ji(M.$el,u.is("drop-inner"));const R=f.value.draggingNode;if(!R||!k)return;let w=!0,E=!0,N=!0,F=!0;zt(e.allowDrop)&&(w=e.allowDrop(R.node,k.node,"prev"),F=E=e.allowDrop(R.node,k.node,"inner"),N=e.allowDrop(R.node,k.node,"next")),b.dataTransfer.dropEffect=E||w||N?"move":"none",(w||E||N)&&(M==null?void 0:M.node.id)!==k.node.id&&(M&&t.emit("node-drag-leave",R.node,M.node,b),t.emit("node-drag-enter",R.node,k.node,b)),w||E||N?f.value.dropNode=k:f.value.dropNode=null,k.node.nextSibling===R.node&&(N=!1),k.node.previousSibling===R.node&&(w=!1),k.node.contains(R.node,!1)&&(E=!1),(R.node===k.node||R.node.contains(k.node))&&(w=!1,E=!1,N=!1);const x=k.$el.querySelector(`.${u.be("node","content")}`).getBoundingClientRect(),P=o.value.getBoundingClientRect();let G;const H=w?E?.25:N?.45:1:-1,Y=N?E?.75:w?.55:0:1;let j=-9999;const W=b.clientY-x.top;W<x.height*H?G="before":W>x.height*Y?G="after":E?G="inner":G="none";const O=k.$el.querySelector(`.${u.be("node","expand-icon")}`).getBoundingClientRect(),Q=i.value;G==="before"?j=O.top-P.top:G==="after"&&(j=O.bottom-P.top),Q.style.top=`${j}px`,Q.style.left=`${O.right-P.left}px`,G==="inner"?Ss(k.$el,u.is("drop-inner")):Ji(k.$el,u.is("drop-inner")),f.value.showDropIndicator=G==="before"||G==="after",f.value.allowDrop=f.value.showDropIndicator||F,f.value.dropType=G,t.emit("node-drag-over",R.node,k.node,b)},treeNodeDragEnd:b=>{const{draggingNode:S,dropType:k,dropNode:M}=f.value;if(b.preventDefault(),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),S&&M){const R={data:S.node.data};k!=="none"&&S.node.remove(),k==="before"?M.node.parent.insertBefore(R,M.node):k==="after"?M.node.parent.insertAfter(R,M.node):k==="inner"&&M.node.insertChild(R),k!=="none"&&(c.value.registerNode(R),c.value.key&&S.node.eachNode(w=>{var E;(E=c.value.nodesMap[w.data[c.value.key]])==null||E.setChecked(w.checked,!c.value.checkStrictly)})),Ji(M.$el,u.is("drop-inner")),t.emit("node-drag-end",S.node,M.node,k,b),k!=="none"&&t.emit("node-drop",S.node,M.node,k,b)}S&&!M&&t.emit("node-drag-end",S.node,null,k,b),f.value.showDropIndicator=!1,f.value.draggingNode=null,f.value.dropNode=null,f.value.allowDrop=!0}}),{dragState:f}}const BPe=Te({name:"ElTreeNode",components:{ElCollapseTransition:KT,ElCheckbox:Ls,NodeContent:VPe,ElIcon:Pt,Loading:ec},props:{node:{type:qO,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=ut("tree"),{broadcastExpanded:i}=LW(e),c=Rt("RootTree"),u=le(!1),f=le(!1),p=le(),v=le(),_=le(),b=Rt(NW),S=kn();Nn("NodeInstance",S),e.node.expanded&&(u.value=!0,f.value=!0);const k=c.props.props.children||"children";st(()=>{var W;const O=(W=e.node.data)==null?void 0:W[k];return O&&[...O]},()=>{e.node.updateChildren()}),st(()=>e.node.indeterminate,W=>{w(e.node.checked,W)}),st(()=>e.node.checked,W=>{w(W,e.node.indeterminate)}),st(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),st(()=>e.node.expanded,W=>{Vt(()=>u.value=W),W&&(f.value=!0)});const M=W=>_2(c.props.nodeKey,W.data),R=W=>{const O=e.props.class;if(!O)return{};let Q;if(zt(O)){const{data:J}=W;Q=O(J,W)}else Q=O;return Ut(Q)?{[Q]:!0}:Q},w=(W,O)=>{(p.value!==W||v.value!==O)&&c.ctx.emit("check-change",e.node.data,W,O),p.value=W,v.value=O},E=W=>{HO(c.store,c.ctx.emit,()=>{var O;if((O=c==null?void 0:c.props)==null?void 0:O.nodeKey){const J=M(e.node);c.store.value.setCurrentNodeKey(J)}else c.store.value.setCurrentNode(e.node)}),c.currentNode.value=e.node,c.props.expandOnClickNode&&F(),(c.props.checkOnClickNode||e.node.isLeaf&&c.props.checkOnClickLeaf&&e.showCheckbox)&&!e.node.disabled&&x(!e.node.checked),c.ctx.emit("node-click",e.node.data,e.node,S,W)},N=W=>{var O;(O=c.instance.vnode.props)!=null&&O.onNodeContextmenu&&(W.stopPropagation(),W.preventDefault()),c.ctx.emit("node-contextmenu",W,e.node.data,e.node,S)},F=()=>{e.node.isLeaf||(u.value?(c.ctx.emit("node-collapse",e.node.data,e.node,S),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,S)}))},x=W=>{e.node.setChecked(W,!(c!=null&&c.props.checkStrictly)),Vt(()=>{const O=c.store.value;c.ctx.emit("check",e.node.data,{checkedNodes:O.getCheckedNodes(),checkedKeys:O.getCheckedKeys(),halfCheckedNodes:O.getHalfCheckedNodes(),halfCheckedKeys:O.getHalfCheckedKeys()})})};return{ns:o,node$:_,tree:c,expanded:u,childNodeRendered:f,oldChecked:p,oldIndeterminate:v,getNodeKey:M,getNodeClass:R,handleSelectChange:w,handleClick:E,handleContextMenu:N,handleExpandIconClick:F,handleCheckChange:x,handleChildNodeExpand:(W,O,Q)=>{i(O),c.ctx.emit("node-expand",W,O,Q)},handleDragStart:W=>{c.props.draggable&&b.treeNodeDragStart({event:W,treeNode:e})},handleDragOver:W=>{W.preventDefault(),c.props.draggable&&b.treeNodeDragOver({event:W,treeNode:{$el:_.value,node:e.node}})},handleDrop:W=>{W.preventDefault()},handleDragEnd:W=>{c.props.draggable&&b.treeNodeDragEnd(W)},CaretRight:rK}}});function HPe(e,t,o,i,c,u){const f=Cn("el-icon"),p=Cn("el-checkbox"),v=Cn("loading"),_=Cn("node-content"),b=Cn("el-tree-node"),S=Cn("el-collapse-transition");return fn((ee(),ge("div",{ref:"node$",class:ne([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:Zt(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:Zt(e.handleDragStart,["stop"]),onDragover:Zt(e.handleDragOver,["stop"]),onDragend:Zt(e.handleDragEnd,["stop"]),onDrop:Zt(e.handleDrop,["stop"])},[Ee("div",{class:ne(e.ns.be("node","content")),style:qt({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(ee(),We(f,{key:0,class:ne([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Zt(e.handleExpandIconClick,["stop"])},{default:Ae(()=>[(ee(),We(Tn(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):$e("v-if",!0),e.showCheckbox?(ee(),We(p,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:Zt(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):$e("v-if",!0),e.node.loading?(ee(),We(f,{key:2,class:ne([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:Ae(()=>[Me(v)]),_:1},8,["class"])):$e("v-if",!0),Me(_,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Me(S,null,{default:Ae(()=>[!e.renderAfterExpand||e.childNodeRendered?fn((ee(),ge("div",{key:0,class:ne(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded,onClick:Zt(()=>{},["stop"])},[(ee(!0),ge(Ht,null,Un(e.node.childNodes,k=>(ee(),We(b,{key:e.getNodeKey(k),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:k,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded","onClick"])),[[Zn,e.expanded]]):$e("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[Zn,e.node.visible]])}var $Pe=vt(BPe,[["render",HPe],["__file","tree-node.vue"]]);function qPe({el$:e},t){const o=ut("tree");mn(()=>{c()}),dl(()=>{Array.from(e.value.querySelectorAll("input[type=checkbox]")).forEach(f=>{f.setAttribute("tabindex","-1")})}),_o(e,"keydown",u=>{const f=u.target;if(!f.className.includes(o.b("node")))return;const p=u.code,v=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),_=v.indexOf(f);let b;if([At.up,At.down].includes(p)){if(u.preventDefault(),p===At.up){b=_===-1?0:_!==0?_-1:v.length-1;const k=b;for(;!t.value.getNode(v[b].dataset.key).canFocus;){if(b--,b===k){b=-1;break}b<0&&(b=v.length-1)}}else{b=_===-1?0:_<v.length-1?_+1:0;const k=b;for(;!t.value.getNode(v[b].dataset.key).canFocus;){if(b++,b===k){b=-1;break}b>=v.length&&(b=0)}}b!==-1&&v[b].focus()}[At.left,At.right].includes(p)&&(u.preventDefault(),f.click());const S=f.querySelector('[type="checkbox"]');[At.enter,At.numpadEnter,At.space].includes(p)&&S&&(u.preventDefault(),S.click())});const c=()=>{var u;const f=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));Array.from(e.value.querySelectorAll("input[type=checkbox]")).forEach(_=>{_.setAttribute("tabindex","-1")});const v=e.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(v.length){v[0].setAttribute("tabindex","0");return}(u=f[0])==null||u.setAttribute("tabindex","0")}}const KPe=Te({name:"ElTree",components:{ElTreeNode:$Pe},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkOnClickLeaf:{type:Boolean,default:!0},checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:ho}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=Kn(),i=ut("tree"),c=Rt(yv,null),u=le(new UPe({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));u.value.initialize();const f=le(u.value.root),p=le(null),v=le(null),_=le(null),{broadcastExpanded:b}=LW(e),{dragState:S}=GPe({props:e,ctx:t,el$:v,dropIndicator$:_,store:u});qPe({el$:v},u);const k=z(()=>{const{childNodes:re}=f.value,X=c?c.hasFilteredOptions!==0:!1;return(!re||re.length===0||re.every(({visible:ye})=>!ye))&&!X});st(()=>e.currentNodeKey,re=>{u.value.setCurrentNodeKey(re)}),st(()=>e.defaultCheckedKeys,re=>{u.value.setDefaultCheckedKey(re)}),st(()=>e.defaultExpandedKeys,re=>{u.value.setDefaultExpandedKeys(re)}),st(()=>e.data,re=>{u.value.setData(re)},{deep:!0}),st(()=>e.checkStrictly,re=>{u.value.checkStrictly=re});const M=re=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");u.value.filter(re)},R=re=>_2(e.nodeKey,re.data),w=re=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const X=u.value.getNode(re);if(!X)return[];const ye=[X.data];let ue=X.parent;for(;ue&&ue!==f.value;)ye.push(ue.data),ue=ue.parent;return ye.reverse()},E=(re,X)=>u.value.getCheckedNodes(re,X),N=re=>u.value.getCheckedKeys(re),F=()=>{const re=u.value.getCurrentNode();return re?re.data:null},x=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const re=F();return re?re[e.nodeKey]:null},P=(re,X)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");u.value.setCheckedNodes(re,X)},G=(re,X)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");u.value.setCheckedKeys(re,X)},H=(re,X,ye)=>{u.value.setChecked(re,X,ye)},Y=()=>u.value.getHalfCheckedNodes(),j=()=>u.value.getHalfCheckedKeys(),W=(re,X=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");HO(u,t.emit,()=>{b(re),u.value.setUserCurrentNode(re,X)})},O=(re,X=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");HO(u,t.emit,()=>{b(),u.value.setCurrentNodeKey(re,X)})},Q=re=>u.value.getNode(re),J=re=>{u.value.remove(re)},oe=(re,X)=>{u.value.append(re,X)},pe=(re,X)=>{u.value.insertBefore(re,X)},ie=(re,X)=>{u.value.insertAfter(re,X)},te=(re,X,ye)=>{b(X),t.emit("node-expand",re,X,ye)},he=(re,X)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");u.value.updateChildren(re,X)};return Nn("RootTree",{ctx:t,props:e,store:u,root:f,currentNode:p,instance:kn()}),Nn(tc,void 0),{ns:i,store:u,root:f,currentNode:p,dragState:S,el$:v,dropIndicator$:_,isEmpty:k,filter:M,getNodeKey:R,getNodePath:w,getCheckedNodes:E,getCheckedKeys:N,getCurrentNode:F,getCurrentKey:x,setCheckedNodes:P,setCheckedKeys:G,setChecked:H,getHalfCheckedNodes:Y,getHalfCheckedKeys:j,setCurrentNode:W,setCurrentKey:O,t:o,getNode:Q,remove:J,append:oe,insertBefore:pe,insertAfter:ie,handleNodeExpand:te,updateKeyChildren:he}}});function zPe(e,t,o,i,c,u){const f=Cn("el-tree-node");return ee(),ge("div",{ref:"el$",class:ne([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(ee(!0),ge(Ht,null,Un(e.root.childNodes,p=>(ee(),We(f,{key:e.getNodeKey(p),node:p,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(ee(),ge("div",{key:0,class:ne(e.ns.e("empty-block"))},[Ve(e.$slots,"empty",{},()=>{var p;return[Ee("span",{class:ne(e.ns.e("empty-text"))},mt((p=e.emptyText)!=null?p:e.t("el.tree.emptyText")),3)]})],2)):$e("v-if",!0),fn(Ee("div",{ref:"dropIndicator$",class:ne(e.ns.e("drop-indicator"))},null,2),[[Zn,e.dragState.showDropIndicator]])],2)}var WPe=vt(KPe,[["render",zPe],["__file","tree.vue"]]);const uT=un(WPe),jPe=(e,{attrs:t,emit:o},{select:i,tree:c,key:u})=>{const f=ut("tree-select");return st(()=>e.data,()=>{e.filterable&&Vt(()=>{var v,_;(_=c.value)==null||_.filter((v=i.value)==null?void 0:v.states.inputValue)})},{flush:"post"}),{...il(hi(e),Object.keys(dp.props)),...t,class:z(()=>t.class),style:z(()=>t.style),"onUpdate:modelValue":v=>o(nn,v),valueKey:u,popperClass:z(()=>{const v=[f.e("popper")];return e.popperClass&&v.push(e.popperClass),v.join(" ")}),filterMethod:(v="")=>{var _;e.filterMethod?e.filterMethod(v):e.remoteMethod?e.remoteMethod(v):(_=c.value)==null||_.filter(v)}}},YPe=Te({extends:ZE,setup(e,t){const o=ZE.setup(e,t);delete o.selectOptionClick;const i=kn().proxy;return Vt(()=>{o.select.states.cachedOptions.get(i.value)||o.select.onOptionCreate(i)}),st(()=>t.attrs.visible,c=>{Vt(()=>{o.states.visible=c})},{immediate:!0}),o},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function KO(e){return e||e===0}function y2(e){return ht(e)&&e.length}function fg(e){return ht(e)?e:KO(e)?[e]:[]}function CE(e,t,o,i,c){for(let u=0;u<e.length;u++){const f=e[u];if(t(f,u,e,c))return i?i(f,u,e,c):f;{const p=o(f);if(y2(p)){const v=CE(p,t,o,i,f);if(v)return v}}}}function SE(e,t,o,i){for(let c=0;c<e.length;c++){const u=e[c];t(u,c,e,i);const f=o(u);y2(f)&&SE(f,t,o,u)}}const JPe=(e,{attrs:t,slots:o,emit:i},{select:c,tree:u,key:f})=>{st(()=>e.modelValue,()=>{e.showCheckbox&&Vt(()=>{const k=u.value;k&&!ui(k.getCheckedKeys(),fg(e.modelValue))&&k.setCheckedKeys(fg(e.modelValue))})},{immediate:!0,deep:!0});const p=z(()=>({value:f.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),v=(k,M)=>{var R;const w=p.value[k];return zt(w)?w(M,(R=u.value)==null?void 0:R.getNode(v("value",M))):M[w]},_=fg(e.modelValue).map(k=>CE(e.data||[],M=>v("value",M)===k,M=>v("children",M),(M,R,w,E)=>E&&v("value",E))).filter(k=>KO(k)),b=z(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const k=[];return SE(e.data.concat(e.cacheData),M=>{const R=v("value",M);k.push({value:R,currentLabel:v("label",M),isDisabled:v("disabled",M)})},M=>v("children",M)),k}),S=()=>{var k;return(k=u.value)==null?void 0:k.getCheckedKeys().filter(M=>{var R;const w=(R=u.value)==null?void 0:R.getNode(M);return!oi(w)&&Xa(w.childNodes)})};return{...il(hi(e),Object.keys(uT.props)),...t,nodeKey:f,expandOnClickNode:z(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:z(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(_):_),renderContent:(k,{node:M,data:R,store:w})=>k(YPe,{value:v("value",R),label:v("label",R),disabled:v("disabled",R),visible:M.visible},e.renderContent?()=>e.renderContent(k,{node:M,data:R,store:w}):o.default?()=>o.default({node:M,data:R,store:w}):void 0),filterNodeMethod:(k,M,R)=>e.filterNodeMethod?e.filterNodeMethod(k,M,R):k?new RegExp(MN(k),"i").test(v("label",M)||""):!0,onNodeClick:(k,M,R)=>{var w,E,N,F;if((w=t.onNodeClick)==null||w.call(t,k,M,R),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||M.isLeaf)){if(!v("disabled",k)){const x=(E=c.value)==null?void 0:E.states.options.get(v("value",k));(N=c.value)==null||N.handleOptionSelect(x)}}else e.expandOnClickNode&&R.proxy.handleExpandIconClick();(F=c.value)==null||F.focus()}},onCheck:(k,M)=>{var R;if(!e.showCheckbox)return;const w=v("value",k),E={};SE([u.value.store.root],P=>E[P.key]=P,P=>P.childNodes);const N=M.checkedKeys,F=e.multiple?fg(e.modelValue).filter(P=>!(P in E)&&!N.includes(P)):[],x=F.concat(N);if(e.checkStrictly)i(nn,e.multiple?x:x.includes(w)?w:void 0);else if(e.multiple){const P=S();i(nn,F.concat(P))}else{const P=CE([k],Y=>!y2(v("children",Y))&&!v("disabled",Y),Y=>v("children",Y)),G=P?v("value",P):void 0,H=KO(e.modelValue)&&!!CE([k],Y=>v("value",Y)===e.modelValue,Y=>v("children",Y));i(nn,G===e.modelValue||H?void 0:G)}Vt(()=>{var P;const G=fg(e.modelValue);u.value.setCheckedKeys(G),(P=t.onCheck)==null||P.call(t,k,{checkedKeys:u.value.getCheckedKeys(),checkedNodes:u.value.getCheckedNodes(),halfCheckedKeys:u.value.getHalfCheckedKeys(),halfCheckedNodes:u.value.getHalfCheckedNodes()})}),(R=c.value)==null||R.focus()},onNodeExpand:(k,M,R)=>{var w;(w=t.onNodeExpand)==null||w.call(t,k,M,R),Vt(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&M.checked){const E={},N=u.value.getCheckedKeys();SE([u.value.store.root],P=>E[P.key]=P,P=>P.childNodes);const F=fg(e.modelValue).filter(P=>!(P in E)&&!N.includes(P)),x=S();i(nn,F.concat(x))}})},cacheOptions:b}};var XPe=Te({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Rt(yv);return st(()=>e.data,()=>{var o;e.data.forEach(c=>{t.states.cachedOptions.has(c.value)||t.states.cachedOptions.set(c.value,c)});const i=((o=t.selectRef)==null?void 0:o.querySelectorAll("input"))||[];$n&&!Array.from(i).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const ZPe=Te({name:"ElTreeSelect",inheritAttrs:!1,props:{...dp.props,...uT.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:o,expose:i}=t,c=le(),u=le(),f=z(()=>e.nodeKey||e.valueKey||"value"),p=jPe(e,t,{select:c,tree:u,key:f}),{cacheOptions:v,..._}=JPe(e,t,{select:c,tree:u,key:f}),b=eo({});return i(b),mn(()=>{Object.assign(b,{...il(u.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...il(c.value,["focus","blur","selectedLabel"])})}),()=>Jt(dp,eo({...p,ref:S=>c.value=S}),{...o,default:()=>[Jt(XPe,{data:v.value}),Jt(uT,eo({..._,ref:S=>u.value=S}))]})}});var QPe=vt(ZPe,[["__file","tree-select.vue"]]);const exe=un(QPe),I2=Symbol(),txe={key:-1,level:-1,data:{}};var Gy=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e.CLASS="",e))(Gy||{}),zO=(e=>(e.ADD="add",e.DELETE="delete",e))(zO||{});const PW={type:Number,default:26},nxe=pt({data:{type:Ue(Array),default:()=>sr([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:Ue(Object),default:()=>sr({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Ue(Array),default:()=>sr([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:Ue(Array),default:()=>sr([])},indent:{type:Number,default:16},itemSize:PW,icon:{type:ho},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},checkOnClickLeaf:{type:Boolean,default:!0},currentNodeKey:{type:Ue([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:Ue(Function)},perfMode:{type:Boolean,default:!0}}),oxe=pt({node:{type:Ue(Object),default:()=>sr(txe)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:PW}),rxe=pt({node:{type:Ue(Object),required:!0}}),xW="node-click",UW="node-drop",FW="node-expand",VW="node-collapse",GW="current-change",BW="check",HW="check-change",$W="node-contextmenu",ixe={[xW]:(e,t,o)=>e&&t&&o,[UW]:(e,t,o)=>e&&t&&o,[FW]:(e,t)=>e&&t,[VW]:(e,t)=>e&&t,[GW]:(e,t)=>e&&t,[BW]:(e,t)=>e&&t,[HW]:(e,t)=>e&&vo(t),[$W]:(e,t,o)=>e&&t&&o},axe={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&vo(t)};function sxe(e,t){const o=le(new Set),i=le(new Set),{emit:c}=kn();st([()=>t.value,()=>e.defaultCheckedKeys],()=>Vt(()=>{F(e.defaultCheckedKeys)}),{immediate:!0});const u=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:x,maxLevel:P}=t.value,G=o.value,H=new Set;for(let Y=P-1;Y>=1;--Y){const j=x.get(Y);j&&j.forEach(W=>{const O=W.children;if(O){let Q=!0,J=!1;for(const oe of O){const pe=oe.key;if(G.has(pe))J=!0;else if(H.has(pe)){Q=!1,J=!0;break}else Q=!1}Q?G.add(W.key):J?(H.add(W.key),G.delete(W.key)):(G.delete(W.key),H.delete(W.key))}})}i.value=H},f=x=>o.value.has(x.key),p=x=>i.value.has(x.key),v=(x,P,G=!0,H=!0)=>{const Y=o.value,j=(W,O)=>{Y[O?zO.ADD:zO.DELETE](W.key);const Q=W.children;!e.checkStrictly&&Q&&Q.forEach(J=>{J.disabled||j(J,O)})};j(x,P),H&&u(),G&&_(x,P)},_=(x,P)=>{const{checkedNodes:G,checkedKeys:H}=R(),{halfCheckedNodes:Y,halfCheckedKeys:j}=w();c(BW,x.data,{checkedKeys:H,checkedNodes:G,halfCheckedKeys:j,halfCheckedNodes:Y}),c(HW,x.data,P)};function b(x=!1){return R(x).checkedKeys}function S(x=!1){return R(x).checkedNodes}function k(){return w().halfCheckedKeys}function M(){return w().halfCheckedNodes}function R(x=!1){const P=[],G=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:H}=t.value;o.value.forEach(Y=>{const j=H.get(Y);j&&(!x||x&&j.isLeaf)&&(G.push(Y),P.push(j.data))})}return{checkedKeys:G,checkedNodes:P}}function w(){const x=[],P=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:G}=t.value;i.value.forEach(H=>{const Y=G.get(H);Y&&(P.push(H),x.push(Y.data))})}return{halfCheckedNodes:x,halfCheckedKeys:P}}function E(x){o.value.clear(),i.value.clear(),Vt(()=>{F(x)})}function N(x,P){if(t!=null&&t.value&&e.showCheckbox){const G=t.value.treeNodeMap.get(x);G&&v(G,P,!1)}}function F(x){if(t!=null&&t.value){const{treeNodeMap:P}=t.value;if(e.showCheckbox&&P&&(x==null?void 0:x.length)>0){for(const G of x){const H=P.get(G);H&&!f(H)&&v(H,!0,!1,!1)}u()}}}return{updateCheckedKeys:u,toggleCheckbox:v,isChecked:f,isIndeterminate:p,getCheckedKeys:b,getCheckedNodes:S,getHalfCheckedKeys:k,getHalfCheckedNodes:M,setChecked:N,setCheckedKeys:E}}function lxe(e,t){const o=le(new Set([])),i=le(new Set([])),c=z(()=>zt(e.filterMethod));function u(p){var v;if(!c.value)return;const _=new Set,b=i.value,S=o.value,k=[],M=((v=t.value)==null?void 0:v.treeNodes)||[],R=e.filterMethod;S.clear();function w(E){E.forEach(N=>{k.push(N),R!=null&&R(p,N.data,N)?k.forEach(x=>{_.add(x.key)}):N.isLeaf&&S.add(N.key);const F=N.children;if(F&&w(F),!N.isLeaf){if(!_.has(N.key))S.add(N.key);else if(F){let x=!0;for(const P of F)if(!S.has(P.key)){x=!1;break}x?b.add(N.key):b.delete(N.key)}}k.pop()})}return w(M),_}function f(p){return i.value.has(p.key)}return{hiddenExpandIconKeySet:i,hiddenNodeKeySet:o,doFilter:u,isForceHiddenExpandIcon:f}}function cxe(e,t){const o=le(new Set(e.defaultExpandedKeys)),i=le(),c=Go(),u=le();st(()=>e.currentNodeKey,Ge=>{i.value=Ge},{immediate:!0}),st(()=>e.data,Ge=>{xe(Ge)},{immediate:!0});const{isIndeterminate:f,isChecked:p,toggleCheckbox:v,getCheckedKeys:_,getCheckedNodes:b,getHalfCheckedKeys:S,getHalfCheckedNodes:k,setChecked:M,setCheckedKeys:R}=sxe(e,c),{doFilter:w,hiddenNodeKeySet:E,isForceHiddenExpandIcon:N}=lxe(e,c),F=z(()=>{var Ge;return((Ge=e.props)==null?void 0:Ge.value)||Gy.KEY}),x=z(()=>{var Ge;return((Ge=e.props)==null?void 0:Ge.children)||Gy.CHILDREN}),P=z(()=>{var Ge;return((Ge=e.props)==null?void 0:Ge.disabled)||Gy.DISABLED}),G=z(()=>{var Ge;return((Ge=e.props)==null?void 0:Ge.label)||Gy.LABEL}),H=z(()=>{var Ge;const _e=o.value,Re=E.value,Ke=[],je=((Ge=c.value)==null?void 0:Ge.treeNodes)||[],ze=[];for(let nt=je.length-1;nt>=0;--nt)ze.push(je[nt]);for(;ze.length;){const nt=ze.pop();if(!Re.has(nt.key)&&(Ke.push(nt),nt.children&&_e.has(nt.key)))for(let it=nt.children.length-1;it>=0;--it)ze.push(nt.children[it])}return Ke}),Y=z(()=>H.value.length>0);function j(Ge){const _e=new Map,Re=new Map;let Ke=1;function je(nt,it=1,dt=void 0){var gt;const ft=[];for(const Mt of nt){const lt=Q(Mt),Et={level:it,key:lt,data:Mt};Et.label=oe(Mt),Et.parent=dt;const Yt=O(Mt);Et.disabled=J(Mt),Et.isLeaf=!Yt||Yt.length===0,Yt&&Yt.length&&(Et.children=je(Yt,it+1,Et)),ft.push(Et),_e.set(lt,Et),Re.has(it)||Re.set(it,[]),(gt=Re.get(it))==null||gt.push(Et)}return it>Ke&&(Ke=it),ft}const ze=je(Ge);return{treeNodeMap:_e,levelTreeNodeMap:Re,maxLevel:Ke,treeNodes:ze}}function W(Ge){const _e=w(Ge);_e&&(o.value=_e)}function O(Ge){return Ge[x.value]}function Q(Ge){return Ge?Ge[F.value]:""}function J(Ge){return Ge[P.value]}function oe(Ge){return Ge[G.value]}function pe(Ge){o.value.has(Ge.key)?ue(Ge):ye(Ge)}function ie(Ge){const _e=new Set,Re=c.value.treeNodeMap;Ge.forEach(Ke=>{let je=Re.get(Ke);for(;je&&!_e.has(je.key);)_e.add(je.key),je=je.parent}),o.value=_e}function te(Ge,_e){t(xW,Ge.data,Ge,_e),re(Ge),e.expandOnClickNode&&pe(Ge),e.showCheckbox&&(e.checkOnClickNode||Ge.isLeaf&&e.checkOnClickLeaf)&&!Ge.disabled&&v(Ge,!p(Ge),!0)}function he(Ge,_e){t(UW,Ge.data,Ge,_e)}function re(Ge){Ce(Ge)||(i.value=Ge.key,t(GW,Ge.data,Ge))}function X(Ge,_e){v(Ge,_e)}function ye(Ge){const _e=o.value;if(c.value&&e.accordion){const{treeNodeMap:Re}=c.value;_e.forEach(Ke=>{const je=Re.get(Ke);Ge&&Ge.level===(je==null?void 0:je.level)&&_e.delete(Ke)})}_e.add(Ge.key),t(FW,Ge.data,Ge)}function ue(Ge){o.value.delete(Ge.key),t(VW,Ge.data,Ge)}function Ie(Ge){return o.value.has(Ge.key)}function ve(Ge){return!!Ge.disabled}function Ce(Ge){const _e=i.value;return _e!==void 0&&_e===Ge.key}function Fe(){var Ge,_e;if(i.value)return(_e=(Ge=c.value)==null?void 0:Ge.treeNodeMap.get(i.value))==null?void 0:_e.data}function Oe(){return i.value}function be(Ge){i.value=Ge}function xe(Ge){Vt(()=>c.value=j(Ge))}function Le(Ge){var _e;const Re=gn(Ge)?Q(Ge):Ge;return(_e=c.value)==null?void 0:_e.treeNodeMap.get(Re)}function rt(Ge,_e="auto"){const Re=Le(Ge);Re&&u.value&&u.value.scrollToItem(H.value.indexOf(Re),_e)}function Qe(Ge){var _e;(_e=u.value)==null||_e.scrollTo(Ge)}return{tree:c,flattenTree:H,isNotEmpty:Y,listRef:u,getKey:Q,getChildren:O,toggleExpand:pe,toggleCheckbox:v,isExpanded:Ie,isChecked:p,isIndeterminate:f,isDisabled:ve,isCurrent:Ce,isForceHiddenExpandIcon:N,handleNodeClick:te,handleNodeDrop:he,handleNodeCheck:X,getCurrentNode:Fe,getCurrentKey:Oe,setCurrentKey:be,getCheckedKeys:_,getCheckedNodes:b,getHalfCheckedKeys:S,getHalfCheckedNodes:k,setChecked:M,setCheckedKeys:R,filter:W,setData:xe,getNode:Le,expandNode:ye,collapseNode:ue,setExpandedKeys:ie,scrollToNode:rt,scrollTo:Qe}}var uxe=Te({name:"ElTreeNodeContent",props:rxe,setup(e){const t=Rt(I2),o=ut("tree");return()=>{const i=e.node,{data:c}=i;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:i,data:c}):Jt(a2,{tag:"span",truncated:!0,class:o.be("node","label")},()=>[i==null?void 0:i.label])}}});const dxe=Te({name:"ElTreeNode"}),hxe=Te({...dxe,props:oxe,emits:axe,setup(e,{emit:t}){const o=e,i=Rt(I2),c=ut("tree"),u=z(()=>{var M;return(M=i==null?void 0:i.props.indent)!=null?M:16}),f=z(()=>{var M;return(M=i==null?void 0:i.props.icon)!=null?M:rK}),p=M=>{const R=i==null?void 0:i.props.props.class;if(!R)return{};let w;if(zt(R)){const{data:E}=M;w=R(E,M)}else w=R;return Ut(w)?{[w]:!0}:w},v=M=>{t("click",o.node,M)},_=M=>{t("drop",o.node,M)},b=()=>{t("toggle",o.node)},S=M=>{t("check",o.node,M)},k=M=>{var R,w,E,N;(E=(w=(R=i==null?void 0:i.instance)==null?void 0:R.vnode)==null?void 0:w.props)!=null&&E.onNodeContextmenu&&(M.stopPropagation(),M.preventDefault()),i==null||i.ctx.emit($W,M,(N=o.node)==null?void 0:N.data,o.node)};return(M,R)=>{var w,E,N;return ee(),ge("div",{ref:"node$",class:ne([y(c).b("node"),y(c).is("expanded",M.expanded),y(c).is("current",M.current),y(c).is("focusable",!M.disabled),y(c).is("checked",!M.disabled&&M.checked),p(M.node)]),role:"treeitem",tabindex:"-1","aria-expanded":M.expanded,"aria-disabled":M.disabled,"aria-checked":M.checked,"data-key":(w=M.node)==null?void 0:w.key,onClick:Zt(v,["stop"]),onContextmenu:k,onDragover:Zt(()=>{},["prevent"]),onDragenter:Zt(()=>{},["prevent"]),onDrop:Zt(_,["stop"])},[Ee("div",{class:ne(y(c).be("node","content")),style:qt({paddingLeft:`${(M.node.level-1)*y(u)}px`,height:M.itemSize+"px"})},[y(f)?(ee(),We(y(Pt),{key:0,class:ne([y(c).is("leaf",!!((E=M.node)!=null&&E.isLeaf)),y(c).is("hidden",M.hiddenExpandIcon),{expanded:!((N=M.node)!=null&&N.isLeaf)&&M.expanded},y(c).be("node","expand-icon")]),onClick:Zt(b,["stop"])},{default:Ae(()=>[(ee(),We(Tn(y(f))))]),_:1},8,["class","onClick"])):$e("v-if",!0),M.showCheckbox?(ee(),We(y(Ls),{key:1,"model-value":M.checked,indeterminate:M.indeterminate,disabled:M.disabled,onChange:S,onClick:Zt(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):$e("v-if",!0),Me(y(uxe),{node:M.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var fxe=vt(hxe,[["__file","tree-node.vue"]]);const pxe=Te({name:"ElTreeV2"}),mxe=Te({...pxe,props:nxe,emits:ixe,setup(e,{expose:t,emit:o}){const i=e,c=Qr(),u=z(()=>i.itemSize);Nn(I2,{ctx:{emit:o,slots:c},props:i,instance:kn()}),Nn(tc,void 0);const{t:f}=Kn(),p=ut("tree"),{flattenTree:v,isNotEmpty:_,listRef:b,toggleExpand:S,isExpanded:k,isIndeterminate:M,isChecked:R,isDisabled:w,isCurrent:E,isForceHiddenExpandIcon:N,handleNodeClick:F,handleNodeDrop:x,handleNodeCheck:P,toggleCheckbox:G,getCurrentNode:H,getCurrentKey:Y,setCurrentKey:j,getCheckedKeys:W,getCheckedNodes:O,getHalfCheckedKeys:Q,getHalfCheckedNodes:J,setChecked:oe,setCheckedKeys:pe,filter:ie,setData:te,getNode:he,expandNode:re,collapseNode:X,setExpandedKeys:ye,scrollToNode:ue,scrollTo:Ie}=cxe(i,o);return t({toggleCheckbox:G,getCurrentNode:H,getCurrentKey:Y,setCurrentKey:j,getCheckedKeys:W,getCheckedNodes:O,getHalfCheckedKeys:Q,getHalfCheckedNodes:J,setChecked:oe,setCheckedKeys:pe,filter:ie,setData:te,getNode:he,expandNode:re,collapseNode:X,setExpandedKeys:ye,scrollToNode:ue,scrollTo:Ie}),(ve,Ce)=>(ee(),ge("div",{class:ne([y(p).b(),{[y(p).m("highlight-current")]:ve.highlightCurrent}]),role:"tree"},[y(_)?(ee(),We(y(kz),{key:0,ref_key:"listRef",ref:b,"class-name":y(p).b("virtual-list"),data:y(v),total:y(v).length,height:ve.height,"item-size":y(u),"perf-mode":ve.perfMode},{default:Ae(({data:Fe,index:Oe,style:be})=>[(ee(),We(fxe,{key:Fe[Oe].key,style:qt(be),node:Fe[Oe],expanded:y(k)(Fe[Oe]),"show-checkbox":ve.showCheckbox,checked:y(R)(Fe[Oe]),indeterminate:y(M)(Fe[Oe]),"item-size":y(u),disabled:y(w)(Fe[Oe]),current:y(E)(Fe[Oe]),"hidden-expand-icon":y(N)(Fe[Oe]),onClick:y(F),onToggle:y(S),onCheck:y(P),onDrop:y(x)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(ee(),ge("div",{key:1,class:ne(y(p).e("empty-block"))},[Ve(ve.$slots,"empty",{},()=>{var Fe;return[Ee("span",{class:ne(y(p).e("empty-text"))},mt((Fe=ve.emptyText)!=null?Fe:y(f)("el.tree.emptyText")),3)]})],2))],2))}});var gxe=vt(mxe,[["__file","tree.vue"]]);const vxe=un(gxe),qW=Symbol("uploadContextKey"),_xe="ElUpload";class yxe extends Error{constructor(t,o,i,c){super(t),this.name="UploadAjaxError",this.status=o,this.method=i,this.url=c}}function bH(e,t,o){let i;return o.response?i=`${o.response.error||o.response}`:o.responseText?i=`${o.responseText}`:i=`fail to ${t.method} ${e} ${o.status}`,new yxe(i,o.status,t.method,e)}function Ixe(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const bxe=e=>{typeof XMLHttpRequest>"u"&&qr(_xe,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,o=e.action;t.upload&&t.upload.addEventListener("progress",u=>{const f=u;f.percent=u.total>0?u.loaded/u.total*100:0,e.onProgress(f)});const i=new FormData;if(e.data)for(const[u,f]of Object.entries(e.data))ht(f)&&f.length?i.append(u,...f):i.append(u,f);i.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(bH(o,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(bH(o,e,t));e.onSuccess(Ixe(t))}),t.open(e.method,o,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const c=e.headers||{};if(c instanceof Headers)c.forEach((u,f)=>t.setRequestHeader(f,u));else for(const[u,f]of Object.entries(c))oi(f)||t.setRequestHeader(u,String(f));return t.send(i),t},KW=["text","picture","picture-card"];let Cxe=1;const WO=()=>Date.now()+Cxe++,zW=pt({action:{type:String,default:"#"},headers:{type:Ue(Object)},method:{type:String,default:"post"},data:{type:Ue([Object,Function,Promise]),default:()=>sr({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Ue(Array),default:()=>sr([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:KW,default:"text"},httpRequest:{type:Ue(Function),default:bxe},disabled:Boolean,limit:Number}),Sxe=pt({...zW,beforeUpload:{type:Ue(Function),default:lo},beforeRemove:{type:Ue(Function)},onRemove:{type:Ue(Function),default:lo},onChange:{type:Ue(Function),default:lo},onPreview:{type:Ue(Function),default:lo},onSuccess:{type:Ue(Function),default:lo},onProgress:{type:Ue(Function),default:lo},onError:{type:Ue(Function),default:lo},onExceed:{type:Ue(Function),default:lo},crossorigin:{type:Ue(String)}}),Exe=pt({files:{type:Ue(Array),default:()=>sr([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Ue(Function),default:lo},listType:{type:String,values:KW,default:"text"},crossorigin:{type:Ue(String)}}),Txe={remove:e=>!!e},Mxe=Te({name:"ElUploadList"}),kxe=Te({...Mxe,props:Exe,emits:Txe,setup(e,{emit:t}){const o=e,{t:i}=Kn(),c=ut("upload"),u=ut("icon"),f=ut("list"),p=Pi(),v=le(!1),_=z(()=>[c.b("list"),c.bm("list",o.listType),c.is("disabled",o.disabled)]),b=S=>{t("remove",S)};return(S,k)=>(ee(),We(H$,{tag:"ul",class:ne(y(_)),name:y(f).b()},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(S.files,(M,R)=>(ee(),ge("li",{key:M.uid||M.name,class:ne([y(c).be("list","item"),y(c).is(M.status),{focusing:v.value}]),tabindex:"0",onKeydown:To(w=>!y(p)&&b(M),["delete"]),onFocus:w=>v.value=!0,onBlur:w=>v.value=!1,onClick:w=>v.value=!1},[Ve(S.$slots,"default",{file:M,index:R},()=>[S.listType==="picture"||M.status!=="uploading"&&S.listType==="picture-card"?(ee(),ge("img",{key:0,class:ne(y(c).be("list","item-thumbnail")),src:M.url,crossorigin:S.crossorigin,alt:""},null,10,["src","crossorigin"])):$e("v-if",!0),M.status==="uploading"||S.listType!=="picture-card"?(ee(),ge("div",{key:1,class:ne(y(c).be("list","item-info"))},[Ee("a",{class:ne(y(c).be("list","item-name")),onClick:Zt(w=>S.handlePreview(M),["prevent"])},[Me(y(Pt),{class:ne(y(u).m("document"))},{default:Ae(()=>[Me(y(A_e))]),_:1},8,["class"]),Ee("span",{class:ne(y(c).be("list","item-file-name")),title:M.name},mt(M.name),11,["title"])],10,["onClick"]),M.status==="uploading"?(ee(),We(y(vz),{key:0,type:S.listType==="picture-card"?"circle":"line","stroke-width":S.listType==="picture-card"?6:2,percentage:Number(M.percentage),style:qt(S.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):$e("v-if",!0)],2)):$e("v-if",!0),Ee("label",{class:ne(y(c).be("list","item-status-label"))},[S.listType==="text"?(ee(),We(y(Pt),{key:0,class:ne([y(u).m("upload-success"),y(u).m("circle-check")])},{default:Ae(()=>[Me(y(rN))]),_:1},8,["class"])):["picture-card","picture"].includes(S.listType)?(ee(),We(y(Pt),{key:1,class:ne([y(u).m("upload-success"),y(u).m("check")])},{default:Ae(()=>[Me(y(sI))]),_:1},8,["class"])):$e("v-if",!0)],2),y(p)?$e("v-if",!0):(ee(),We(y(Pt),{key:2,class:ne(y(u).m("close")),onClick:w=>b(M)},{default:Ae(()=>[Me(y(As))]),_:2},1032,["class","onClick"])),$e(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),$e(" This is a bug which needs to be fixed "),$e(" TODO: Fix the incorrect navigation interaction "),y(p)?$e("v-if",!0):(ee(),ge("i",{key:3,class:ne(y(u).m("close-tip"))},mt(y(i)("el.upload.deleteTip")),3)),S.listType==="picture-card"?(ee(),ge("span",{key:4,class:ne(y(c).be("list","item-actions"))},[Ee("span",{class:ne(y(c).be("list","item-preview")),onClick:w=>S.handlePreview(M)},[Me(y(Pt),{class:ne(y(u).m("zoom-in"))},{default:Ae(()=>[Me(y(lK))]),_:1},8,["class"])],10,["onClick"]),y(p)?$e("v-if",!0):(ee(),ge("span",{key:0,class:ne(y(c).be("list","item-delete")),onClick:w=>b(M)},[Me(y(Pt),{class:ne(y(u).m("delete"))},{default:Ae(()=>[Me(y(w_e))]),_:1},8,["class"])],10,["onClick"]))],2)):$e("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),Ve(S.$slots,"append")]),_:3},8,["class","name"]))}});var CH=vt(kxe,[["__file","upload-list.vue"]]);const wxe=pt({disabled:{type:Boolean,default:!1}}),Rxe={file:e=>ht(e)},WW="ElUploadDrag",Axe=Te({name:WW}),Dxe=Te({...Axe,props:wxe,emits:Rxe,setup(e,{emit:t}){Rt(qW)||qr(WW,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=ut("upload"),c=le(!1),u=Pi(),f=v=>{if(u.value)return;c.value=!1,v.stopPropagation();const _=Array.from(v.dataTransfer.files),b=v.dataTransfer.items||[];_.forEach((S,k)=>{var M;const R=b[k],w=(M=R==null?void 0:R.webkitGetAsEntry)==null?void 0:M.call(R);w&&(S.isDirectory=w.isDirectory)}),t("file",_)},p=()=>{u.value||(c.value=!0)};return(v,_)=>(ee(),ge("div",{class:ne([y(i).b("dragger"),y(i).is("dragover",c.value)]),onDrop:Zt(f,["prevent"]),onDragover:Zt(p,["prevent"]),onDragleave:Zt(b=>c.value=!1,["prevent"])},[Ve(v.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Oxe=vt(Dxe,[["__file","upload-dragger.vue"]]);const Lxe=pt({...zW,beforeUpload:{type:Ue(Function),default:lo},onRemove:{type:Ue(Function),default:lo},onStart:{type:Ue(Function),default:lo},onSuccess:{type:Ue(Function),default:lo},onProgress:{type:Ue(Function),default:lo},onError:{type:Ue(Function),default:lo},onExceed:{type:Ue(Function),default:lo}}),Nxe=Te({name:"ElUploadContent",inheritAttrs:!1}),Pxe=Te({...Nxe,props:Lxe,setup(e,{expose:t}){const o=e,i=ut("upload"),c=Pi(),u=Go({}),f=Go(),p=w=>{if(w.length===0)return;const{autoUpload:E,limit:N,fileList:F,multiple:x,onStart:P,onExceed:G}=o;if(N&&F.length+w.length>N){G(w,F);return}x||(w=w.slice(0,1));for(const H of w){const Y=H;Y.uid=WO(),P(Y),E&&v(Y)}},v=async w=>{if(f.value.value="",!o.beforeUpload)return b(w);let E,N={};try{const x=o.data,P=o.beforeUpload(w);N=f0(o.data)?HE(o.data):o.data,E=await P,f0(o.data)&&ui(x,N)&&(N=HE(o.data))}catch{E=!1}if(E===!1){o.onRemove(w);return}let F=w;E instanceof Blob&&(E instanceof File?F=E:F=new File([E],w.name,{type:w.type})),b(Object.assign(F,{uid:w.uid}),N)},_=async(w,E)=>zt(w)?w(E):w,b=async(w,E)=>{const{headers:N,data:F,method:x,withCredentials:P,name:G,action:H,onProgress:Y,onSuccess:j,onError:W,httpRequest:O}=o;try{E=await _(E??F,w)}catch{o.onRemove(w);return}const{uid:Q}=w,J={headers:N||{},withCredentials:P,file:w,data:E,method:x,filename:G,action:H,onProgress:pe=>{Y(pe,w)},onSuccess:pe=>{j(pe,w),delete u.value[Q]},onError:pe=>{W(pe,w),delete u.value[Q]}},oe=O(J);u.value[Q]=oe,oe instanceof Promise&&oe.then(J.onSuccess,J.onError)},S=w=>{const E=w.target.files;E&&p(Array.from(E))},k=()=>{c.value||(f.value.value="",f.value.click())},M=()=>{k()};return t({abort:w=>{Zq(u.value).filter(w?([N])=>String(w.uid)===N:()=>!0).forEach(([N,F])=>{F instanceof XMLHttpRequest&&F.abort(),delete u.value[N]})},upload:v}),(w,E)=>(ee(),ge("div",{class:ne([y(i).b(),y(i).m(w.listType),y(i).is("drag",w.drag),y(i).is("disabled",y(c))]),tabindex:y(c)?"-1":"0",onClick:k,onKeydown:To(Zt(M,["self"]),["enter","space"])},[w.drag?(ee(),We(Oxe,{key:0,disabled:y(c),onFile:p},{default:Ae(()=>[Ve(w.$slots,"default")]),_:3},8,["disabled"])):Ve(w.$slots,"default",{key:1}),Ee("input",{ref_key:"inputRef",ref:f,class:ne(y(i).e("input")),name:w.name,disabled:y(c),multiple:w.multiple,accept:w.accept,type:"file",onChange:S,onClick:Zt(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var SH=vt(Pxe,[["__file","upload-content.vue"]]);const EH="ElUpload",TH=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},xxe=(e,t)=>{const o=$q(e,"fileList",void 0,{passive:!0}),i=M=>o.value.find(R=>R.uid===M.uid);function c(M){var R;(R=t.value)==null||R.abort(M)}function u(M=["ready","uploading","success","fail"]){o.value=o.value.filter(R=>!M.includes(R.status))}function f(M){o.value=o.value.filter(R=>R.uid!==M.uid)}const p=(M,R)=>{const w=i(R);w&&(console.error(M),w.status="fail",f(w),e.onError(M,w,o.value),e.onChange(w,o.value))},v=(M,R)=>{const w=i(R);w&&(e.onProgress(M,w,o.value),w.status="uploading",w.percentage=Math.round(M.percent))},_=(M,R)=>{const w=i(R);w&&(w.status="success",w.response=M,e.onSuccess(M,w,o.value),e.onChange(w,o.value))},b=M=>{oi(M.uid)&&(M.uid=WO());const R={name:M.name,percentage:0,status:"ready",size:M.size,raw:M,uid:M.uid};if(e.listType==="picture-card"||e.listType==="picture")try{R.url=URL.createObjectURL(M)}catch(w){w.message,e.onError(w,R,o.value)}o.value=[...o.value,R],e.onChange(R,o.value)},S=async M=>{const R=M instanceof File?i(M):M;R||qr(EH,"file to be removed not found");const w=E=>{c(E),f(E),e.onRemove(E,o.value),TH(E)};e.beforeRemove?await e.beforeRemove(R,o.value)!==!1&&w(R):w(R)};function k(){o.value.filter(({status:M})=>M==="ready").forEach(({raw:M})=>{var R;return M&&((R=t.value)==null?void 0:R.upload(M))})}return st(()=>e.listType,M=>{M!=="picture-card"&&M!=="picture"||(o.value=o.value.map(R=>{const{raw:w,url:E}=R;if(!E&&w)try{R.url=URL.createObjectURL(w)}catch(N){e.onError(N,R,o.value)}return R}))}),st(o,M=>{for(const R of M)R.uid||(R.uid=WO()),R.status||(R.status="success")},{immediate:!0,deep:!0}),{uploadFiles:o,abort:c,clearFiles:u,handleError:p,handleProgress:v,handleStart:b,handleSuccess:_,handleRemove:S,submit:k,revokeFileObjectURL:TH}},Uxe=Te({name:"ElUpload"}),Fxe=Te({...Uxe,props:Sxe,setup(e,{expose:t}){const o=e,i=Pi(),c=Go(),{abort:u,submit:f,clearFiles:p,uploadFiles:v,handleStart:_,handleError:b,handleRemove:S,handleSuccess:k,handleProgress:M,revokeFileObjectURL:R}=xxe(o,c),w=z(()=>o.listType==="picture-card"),E=z(()=>({...o,fileList:v.value,onStart:_,onProgress:M,onSuccess:k,onError:b,onRemove:S}));return Co(()=>{v.value.forEach(R)}),Nn(qW,{accept:uo(o,"accept")}),t({abort:u,submit:f,clearFiles:p,handleStart:_,handleRemove:S}),(N,F)=>(ee(),ge("div",null,[y(w)&&N.showFileList?(ee(),We(CH,{key:0,disabled:y(i),"list-type":N.listType,files:y(v),crossorigin:N.crossorigin,"handle-preview":N.onPreview,onRemove:y(S)},rs({append:Ae(()=>[Me(SH,An({ref_key:"uploadRef",ref:c},y(E)),{default:Ae(()=>[N.$slots.trigger?Ve(N.$slots,"trigger",{key:0}):$e("v-if",!0),!N.$slots.trigger&&N.$slots.default?Ve(N.$slots,"default",{key:1}):$e("v-if",!0)]),_:3},16)]),_:2},[N.$slots.file?{name:"default",fn:Ae(({file:x,index:P})=>[Ve(N.$slots,"file",{file:x,index:P})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):$e("v-if",!0),!y(w)||y(w)&&!N.showFileList?(ee(),We(SH,An({key:1,ref_key:"uploadRef",ref:c},y(E)),{default:Ae(()=>[N.$slots.trigger?Ve(N.$slots,"trigger",{key:0}):$e("v-if",!0),!N.$slots.trigger&&N.$slots.default?Ve(N.$slots,"default",{key:1}):$e("v-if",!0)]),_:3},16)):$e("v-if",!0),N.$slots.trigger?Ve(N.$slots,"default",{key:2}):$e("v-if",!0),Ve(N.$slots,"tip"),!y(w)&&N.showFileList?(ee(),We(CH,{key:3,disabled:y(i),"list-type":N.listType,files:y(v),crossorigin:N.crossorigin,"handle-preview":N.onPreview,onRemove:y(S)},rs({_:2},[N.$slots.file?{name:"default",fn:Ae(({file:x,index:P})=>[Ve(N.$slots,"file",{file:x,index:P})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):$e("v-if",!0)]))}});var Vxe=vt(Fxe,[["__file","upload.vue"]]);const Gxe=un(Vxe),Bxe=pt({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:Ue([String,Array]),default:"Element Plus"},font:{type:Ue(Object)},gap:{type:Ue(Array),default:()=>[100,100]},offset:{type:Ue(Array)}});function Hxe(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function $xe(e){return Object.keys(e).map(t=>`${Hxe(t)}: ${e[t]};`).join(" ")}function qxe(){return window.devicePixelRatio||1}const Kxe=(e,t)=>{let o=!1;return e.removedNodes.length&&t&&(o=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(o=!0),o},jW=3;function gD(e,t,o=1){const i=document.createElement("canvas"),c=i.getContext("2d"),u=e*o,f=t*o;return i.setAttribute("width",`${u}px`),i.setAttribute("height",`${f}px`),c.save(),[c,i,u,f]}function zxe(){function e(t,o,i,c,u,f,p,v){const[_,b,S,k]=gD(c,u,i);if(t instanceof HTMLImageElement)_.drawImage(t,0,0,S,k);else{const{color:ue,fontSize:Ie,fontStyle:ve,fontWeight:Ce,fontFamily:Fe,textAlign:Oe,textBaseline:be}=f,xe=Number(Ie)*i;_.font=`${ve} normal ${Ce} ${xe}px/${u}px ${Fe}`,_.fillStyle=ue,_.textAlign=Oe,_.textBaseline=be;const Le=ht(t)?t:[t];Le==null||Le.forEach((rt,Qe)=>{_.fillText(rt??"",S/2,Qe*(xe+jW*i))})}const M=Math.PI/180*Number(o),R=Math.max(c,u),[w,E,N]=gD(R,R,i);w.translate(N/2,N/2),w.rotate(M),S>0&&k>0&&w.drawImage(b,-S/2,-k/2);function F(ue,Ie){const ve=ue*Math.cos(M)-Ie*Math.sin(M),Ce=ue*Math.sin(M)+Ie*Math.cos(M);return[ve,Ce]}let x=0,P=0,G=0,H=0;const Y=S/2,j=k/2;[[0-Y,0-j],[0+Y,0-j],[0+Y,0+j],[0-Y,0+j]].forEach(([ue,Ie])=>{const[ve,Ce]=F(ue,Ie);x=Math.min(x,ve),P=Math.max(P,ve),G=Math.min(G,Ce),H=Math.max(H,Ce)});const O=x+N/2,Q=G+N/2,J=P-x,oe=H-G,pe=p*i,ie=v*i,te=(J+pe)*2,he=oe+ie,[re,X]=gD(te,he);function ye(ue=0,Ie=0){re.drawImage(E,O,Q,J,oe,ue,Ie,J,oe)}return ye(),ye(J+pe,-oe/2-ie/2),ye(J+pe,+oe/2+ie/2),[X.toDataURL(),te/i,he/i]}return e}const Wxe=Te({name:"ElWatermark"}),jxe=Te({...Wxe,props:Bxe,setup(e){const t=e,o={position:"relative"},i=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.color)!=null?Q:"rgba(0,0,0,.15)"}),c=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.fontSize)!=null?Q:16}),u=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.fontWeight)!=null?Q:"normal"}),f=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.fontStyle)!=null?Q:"normal"}),p=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.fontFamily)!=null?Q:"sans-serif"}),v=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.textAlign)!=null?Q:"center"}),_=z(()=>{var O,Q;return(Q=(O=t.font)==null?void 0:O.textBaseline)!=null?Q:"hanging"}),b=z(()=>t.gap[0]),S=z(()=>t.gap[1]),k=z(()=>b.value/2),M=z(()=>S.value/2),R=z(()=>{var O,Q;return(Q=(O=t.offset)==null?void 0:O[0])!=null?Q:k.value}),w=z(()=>{var O,Q;return(Q=(O=t.offset)==null?void 0:O[1])!=null?Q:M.value}),E=()=>{const O={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let Q=R.value-k.value,J=w.value-M.value;return Q>0&&(O.left=`${Q}px`,O.width=`calc(100% - ${Q}px)`,Q=0),J>0&&(O.top=`${J}px`,O.height=`calc(100% - ${J}px)`,J=0),O.backgroundPosition=`${Q}px ${J}px`,O},N=Go(null),F=Go(),x=le(!1),P=()=>{F.value&&(F.value.remove(),F.value=void 0)},G=(O,Q)=>{var J;N.value&&F.value&&(x.value=!0,F.value.setAttribute("style",$xe({...E(),backgroundImage:`url('${O}')`,backgroundSize:`${Math.floor(Q)}px`})),(J=N.value)==null||J.append(F.value),setTimeout(()=>{x.value=!1}))},H=O=>{let Q=120,J=64;const{image:oe,content:pe,width:ie,height:te,rotate:he}=t;if(!oe&&O.measureText){O.font=`${Number(c.value)}px ${p.value}`;const re=ht(pe)?pe:[pe];let X=0,ye=0;re.forEach(ve=>{const{width:Ce,fontBoundingBoxAscent:Fe,fontBoundingBoxDescent:Oe,actualBoundingBoxAscent:be,actualBoundingBoxDescent:xe}=O.measureText(ve),Le=qn(Fe)?be+xe:Fe+Oe;Ce>X&&(X=Math.ceil(Ce)),Le>ye&&(ye=Math.ceil(Le))}),Q=X,J=ye*re.length+(re.length-1)*jW;const ue=Math.PI/180*Number(he),Ie=Math.ceil(Math.abs(Math.sin(ue)*J)/2);Q+=Ie}return[ie??Q,te??J]},Y=zxe(),j=()=>{const Q=document.createElement("canvas").getContext("2d"),J=t.image,oe=t.content,pe=t.rotate;if(Q){F.value||(F.value=document.createElement("div"));const ie=qxe(),[te,he]=H(Q),re=X=>{const[ye,ue]=Y(X||"",pe,ie,te,he,{color:i.value,fontSize:c.value,fontStyle:f.value,fontWeight:u.value,fontFamily:p.value,textAlign:v.value,textBaseline:_.value},b.value,S.value);G(ye,ue)};if(J){const X=new Image;X.onload=()=>{re(X)},X.onerror=()=>{re(oe)},X.crossOrigin="anonymous",X.referrerPolicy="no-referrer",X.src=J}else re(oe)}};return mn(()=>{j()}),st(()=>t,()=>{j()},{deep:!0,flush:"post"}),Co(()=>{P()}),Hq(N,O=>{x.value||O.forEach(Q=>{Kxe(Q,F.value)&&(P(),j())})},{attributes:!0,subtree:!0,childList:!0}),(O,Q)=>(ee(),ge("div",{ref_key:"containerRef",ref:N,style:qt([o])},[Ve(O.$slots,"default")],4))}});var Yxe=vt(jxe,[["__file","watermark.vue"]]);const Jxe=un(Yxe),Xxe=pt({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:Ue(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Zxe=(e,t,o,i,c)=>{const u=le(null),f=()=>{let S;return Ut(e.value)?S=document.querySelector(e.value):zt(e.value)?S=e.value():S=e.value,S},p=()=>{const S=f();if(!S||!t.value){u.value=null;return}Qxe(S)||S.scrollIntoView(c.value);const{left:k,top:M,width:R,height:w}=S.getBoundingClientRect();u.value={left:k,top:M,width:R,height:w,radius:0}};mn(()=>{st([t,e],()=>{p()},{immediate:!0}),window.addEventListener("resize",p)}),Co(()=>{window.removeEventListener("resize",p)});const v=S=>{var k;return(k=ht(o.value.offset)?o.value.offset[S]:o.value.offset)!=null?k:6},_=z(()=>{var S;if(!u.value)return u.value;const k=v(0),M=v(1),R=((S=o.value)==null?void 0:S.radius)||2;return{left:u.value.left-k,top:u.value.top-M,width:u.value.width+k*2,height:u.value.height+M*2,radius:R}}),b=z(()=>{const S=f();return!i.value||!S||!window.DOMRect?S||void 0:{getBoundingClientRect(){var k,M,R,w;return window.DOMRect.fromRect({width:((k=_.value)==null?void 0:k.width)||0,height:((M=_.value)==null?void 0:M.height)||0,x:((R=_.value)==null?void 0:R.left)||0,y:((w=_.value)==null?void 0:w.top)||0})}}});return{mergedPosInfo:_,triggerTarget:b}},t1=Symbol("ElTour");function Qxe(e){const t=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,{top:i,right:c,bottom:u,left:f}=e.getBoundingClientRect();return i>=0&&f>=0&&c<=t&&u<=o}const eUe=(e,t,o,i,c,u,f,p)=>{const v=le(),_=le(),b=le({}),S={x:v,y:_,placement:i,strategy:c,middlewareData:b},k=z(()=>{const N=[wW(y(u)),rPe(),oPe(),tUe()];return y(p)&&y(o)&&N.push(RW({element:y(o)})),N}),M=async()=>{if(!$n)return;const N=y(e),F=y(t);if(!N||!F)return;const x=await AW(N,F,{placement:y(i),strategy:y(c),middleware:y(k)});zg(S).forEach(P=>{S[P].value=x[P]})},R=z(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(f)};const{overflow:N}=y(b);return{position:y(c),zIndex:y(f),top:y(_)!=null?`${y(_)}px`:"",left:y(v)!=null?`${y(v)}px`:"",maxWidth:N!=null&&N.maxWidth?`${N==null?void 0:N.maxWidth}px`:""}}),w=z(()=>{if(!y(p))return{};const{arrow:N}=y(b);return{left:(N==null?void 0:N.x)!=null?`${N==null?void 0:N.x}px`:"",top:(N==null?void 0:N.y)!=null?`${N==null?void 0:N.y}px`:""}});let E;return mn(()=>{const N=y(e),F=y(t);N&&F&&(E=tPe(N,F,M)),Di(()=>{M()})}),Co(()=>{E&&E()}),{update:M,contentStyle:R,arrowStyle:w}},tUe=()=>({name:"overflow",async fn(e){const t=await nPe(e);let o=0;return t.left>0&&(o=t.left),t.right>0&&(o=t.right),{data:{maxWidth:e.rects.floating.width-o}}}}),nUe=Te({name:"ElTourMask",inheritAttrs:!1}),oUe=Te({...nUe,props:Xxe,setup(e){const t=e,{ns:o}=Rt(t1),i=z(()=>{var p,v;return(v=(p=t.pos)==null?void 0:p.radius)!=null?v:2}),c=z(()=>{const p=i.value,v=`a${p},${p} 0 0 1`;return{topRight:`${v} ${p},${p}`,bottomRight:`${v} ${-p},${p}`,bottomLeft:`${v} ${-p},${-p}`,topLeft:`${v} ${p},${-p}`}}),u=z(()=>{const p=window.innerWidth,v=window.innerHeight,_=c.value,b=`M${p},0 L0,0 L0,${v} L${p},${v} L${p},0 Z`,S=i.value;return t.pos?`${b} M${t.pos.left+S},${t.pos.top} h${t.pos.width-S*2} ${_.topRight} v${t.pos.height-S*2} ${_.bottomRight} h${-t.pos.width+S*2} ${_.bottomLeft} v${-t.pos.height+S*2} ${_.topLeft} z`:b}),f=z(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return FN(uo(t,"visible"),{ns:o}),(p,v)=>p.visible?(ee(),ge("div",An({key:0,class:y(o).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:p.zIndex,pointerEvents:p.pos&&p.targetAreaClickable?"none":"auto"}},p.$attrs),[(ee(),ge("svg",{style:{width:"100%",height:"100%"}},[Ee("path",{class:ne(y(o).e("hollow")),style:qt(y(f)),d:y(u)},null,14,["d"])]))],16)):$e("v-if",!0)}});var rUe=vt(oUe,[["__file","mask.vue"]]);const iUe=["absolute","fixed"],aUe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],b2=pt({placement:{type:Ue(String),values:aUe,default:"bottom"},reference:{type:Ue(Object),default:null},strategy:{type:Ue(String),values:iUe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),sUe={close:()=>!0},lUe=Te({name:"ElTourContent"}),cUe=Te({...lUe,props:b2,emits:sUe,setup(e,{emit:t}){const o=e,i=le(o.placement),c=le(o.strategy),u=le(null),f=le(null);st(()=>o.placement,()=>{i.value=o.placement});const{contentStyle:p,arrowStyle:v}=eUe(uo(o,"reference"),u,f,i,c,uo(o,"offset"),uo(o,"zIndex"),uo(o,"showArrow")),_=z(()=>i.value.split("-")[0]),{ns:b}=Rt(t1),S=()=>{t("close")},k=M=>{M.detail.focusReason==="pointer"&&M.preventDefault()};return(M,R)=>(ee(),ge("div",{ref_key:"contentRef",ref:u,style:qt(y(p)),class:ne(y(b).e("content")),"data-side":y(_),tabindex:"-1"},[Me(y(gv),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":u.value||void 0,onReleaseRequested:S,onFocusoutPrevented:k},{default:Ae(()=>[Ve(M.$slots,"default")]),_:3},8,["focus-trap-el"]),M.showArrow?(ee(),ge("span",{key:0,ref_key:"arrowRef",ref:f,style:qt(y(v)),class:ne(y(b).e("arrow"))},null,6)):$e("v-if",!0)],14,["data-side"]))}});var uUe=vt(cUe,[["__file","content.vue"]]),dUe=Te({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:o}){let i=0;return()=>{var c,u;const f=(c=t.default)==null?void 0:c.call(t),p=[];let v=0;function _(b){ht(b)&&b.forEach(S=>{var k;((k=(S==null?void 0:S.type)||{})==null?void 0:k.name)==="ElTourStep"&&(p.push(S),v+=1)})}return f.length&&_(Qc((u=f[0])==null?void 0:u.children)),i!==v&&(i=v,o("update-total",v)),p.length?p[e.current]:null}}});const hUe=pt({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:ho},placement:b2.placement,contentStyle:{type:Ue([Object])},mask:{type:Ue([Boolean,Object]),default:!0},gap:{type:Ue(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:Ue([Boolean,Object]),default:()=>({block:"center"})},type:{type:Ue(String)},appendTo:{type:qT.to.type,default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),fUe={[nn]:e=>vo(e),"update:current":e=>jt(e),close:e=>jt(e),finish:()=>!0,change:e=>jt(e)},pUe=Te({name:"ElTour"}),mUe=Te({...pUe,props:hUe,emits:fUe,setup(e,{emit:t}){const o=e,i=ut("tour"),c=le(0),u=le(),f=$q(o,"current",t,{passive:!0}),p=z(()=>{var W;return(W=u.value)==null?void 0:W.target}),v=z(()=>[i.b(),E.value==="primary"?i.m("primary"):""]),_=z(()=>{var W;return((W=u.value)==null?void 0:W.placement)||o.placement}),b=z(()=>{var W,O;return(O=(W=u.value)==null?void 0:W.contentStyle)!=null?O:o.contentStyle}),S=z(()=>{var W,O;return(O=(W=u.value)==null?void 0:W.mask)!=null?O:o.mask}),k=z(()=>!!S.value&&o.modelValue),M=z(()=>vo(S.value)?void 0:S.value),R=z(()=>{var W,O;return!!p.value&&((O=(W=u.value)==null?void 0:W.showArrow)!=null?O:o.showArrow)}),w=z(()=>{var W,O;return(O=(W=u.value)==null?void 0:W.scrollIntoViewOptions)!=null?O:o.scrollIntoViewOptions}),E=z(()=>{var W,O;return(O=(W=u.value)==null?void 0:W.type)!=null?O:o.type}),{nextZIndex:N}=pv(),F=N(),x=z(()=>{var W;return(W=o.zIndex)!=null?W:F}),{mergedPosInfo:P,triggerTarget:G}=Zxe(p,uo(o,"modelValue"),uo(o,"gap"),S,w);st(()=>o.modelValue,W=>{W||(f.value=0)});const H=()=>{o.closeOnPressEscape&&(t(nn,!1),t("close",f.value))},Y=W=>{c.value=W},j=Qr();return Nn(t1,{currentStep:u,current:f,total:c,showClose:uo(o,"showClose"),closeIcon:uo(o,"closeIcon"),mergedType:E,ns:i,slots:j,updateModelValue(W){t(nn,W)},onClose(){t("close",f.value)},onFinish(){t("finish")},onChange(){t(wn,f.value)}}),(W,O)=>(ee(),ge(Ht,null,[Me(y(vv),{to:W.appendTo},{default:Ae(()=>{var Q,J;return[Ee("div",An({class:y(v)},W.$attrs),[Me(rUe,{visible:y(k),fill:(Q=y(M))==null?void 0:Q.color,style:qt((J=y(M))==null?void 0:J.style),pos:y(P),"z-index":y(x),"target-area-clickable":W.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),W.modelValue?(ee(),We(uUe,{key:y(f),reference:y(G),placement:y(_),"show-arrow":y(R),"z-index":y(x),style:qt(y(b)),onClose:H},{default:Ae(()=>[Me(y(dUe),{current:y(f),onUpdateTotal:Y},{default:Ae(()=>[Ve(W.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):$e("v-if",!0)],16)]}),_:3},8,["to"]),$e(" just for IDE "),$e("v-if",!0)],64))}});var gUe=vt(mUe,[["__file","tour.vue"]]);const vUe=pt({target:{type:Ue([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:ho},showArrow:{type:Boolean,default:void 0},placement:b2.placement,mask:{type:Ue([Boolean,Object]),default:void 0},contentStyle:{type:Ue([Object])},prevButtonProps:{type:Ue(Object)},nextButtonProps:{type:Ue(Object)},scrollIntoViewOptions:{type:Ue([Boolean,Object]),default:void 0},type:{type:Ue(String)}}),_Ue={close:()=>!0},yUe=Te({name:"ElTourStep"}),IUe=Te({...yUe,props:vUe,emits:_Ue,setup(e,{emit:t}){const o=e,{Close:i}=cK,{t:c}=Kn(),{currentStep:u,current:f,total:p,showClose:v,closeIcon:_,mergedType:b,ns:S,slots:k,updateModelValue:M,onClose:R,onFinish:w,onChange:E}=Rt(t1);st(o,j=>{u.value=j},{immediate:!0});const N=z(()=>{var j;return(j=o.showClose)!=null?j:v.value}),F=z(()=>{var j,W;return(W=(j=o.closeIcon)!=null?j:_.value)!=null?W:i}),x=j=>{if(j)return Wge(j,["children","onClick"])},P=()=>{var j,W;f.value-=1,(j=o.prevButtonProps)!=null&&j.onClick&&((W=o.prevButtonProps)==null||W.onClick()),E()},G=()=>{var j;f.value>=p.value-1?H():f.value+=1,(j=o.nextButtonProps)!=null&&j.onClick&&o.nextButtonProps.onClick(),E()},H=()=>{Y(),w()},Y=()=>{M(!1),R(),t("close")};return(j,W)=>(ee(),ge(Ht,null,[y(N)?(ee(),ge("button",{key:0,"aria-label":"Close",class:ne(y(S).e("closebtn")),type:"button",onClick:Y},[Me(y(Pt),{class:ne(y(S).e("close"))},{default:Ae(()=>[(ee(),We(Tn(y(F))))]),_:1},8,["class"])],2)):$e("v-if",!0),Ee("header",{class:ne([y(S).e("header"),{"show-close":y(v)}])},[Ve(j.$slots,"header",{},()=>[Ee("span",{role:"heading",class:ne(y(S).e("title"))},mt(j.title),3)])],2),Ee("div",{class:ne(y(S).e("body"))},[Ve(j.$slots,"default",{},()=>[Ee("span",null,mt(j.description),1)])],2),Ee("footer",{class:ne(y(S).e("footer"))},[Ee("div",{class:ne(y(S).b("indicators"))},[y(k).indicators?(ee(),We(Tn(y(k).indicators),{key:0,current:y(f),total:y(p)},null,8,["current","total"])):(ee(!0),ge(Ht,{key:1},Un(y(p),(O,Q)=>(ee(),ge("span",{key:O,class:ne([y(S).b("indicator"),Q===y(f)?"is-active":""])},null,2))),128))],2),Ee("div",{class:ne(y(S).b("buttons"))},[y(f)>0?(ee(),We(y(di),An({key:0,size:"small",type:y(b)},x(j.prevButtonProps),{onClick:P}),{default:Ae(()=>{var O,Q;return[Mn(mt((Q=(O=j.prevButtonProps)==null?void 0:O.children)!=null?Q:y(c)("el.tour.previous")),1)]}),_:1},16,["type"])):$e("v-if",!0),y(f)<=y(p)-1?(ee(),We(y(di),An({key:1,size:"small",type:y(b)==="primary"?"default":"primary"},x(j.nextButtonProps),{onClick:G}),{default:Ae(()=>{var O,Q;return[Mn(mt((Q=(O=j.nextButtonProps)==null?void 0:O.children)!=null?Q:y(f)===y(p)-1?y(c)("el.tour.finish"):y(c)("el.tour.next")),1)]}),_:1},16,["type"])):$e("v-if",!0)],2)],2)],64))}});var YW=vt(IUe,[["__file","step.vue"]]);const bUe=un(gUe,{TourStep:YW}),CUe=lr(YW),SUe=pt({container:{type:Ue([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:Ue(String),default:"default"},direction:{type:Ue(String),default:"vertical"},selectScrollTop:{type:Boolean,default:!1}}),EUe={change:e=>Ut(e),click:(e,t)=>e instanceof MouseEvent&&(Ut(t)||qn(t))},JW=Symbol("anchor"),ZS=e=>{if(!$n||e==="")return null;if(Ut(e))try{return document.querySelector(e)}catch{return null}return e};function TUe(e){let t=0;const o=(...i)=>{t&&up(t),t=Wd(()=>{e(...i),t=0})};return o.cancel=()=>{up(t),t=0},o}const MUe=Te({name:"ElAnchor"}),kUe=Te({...MUe,props:SUe,emits:EUe,setup(e,{expose:t,emit:o}){const i=e,c=le(""),u=le(null),f=le(null),p=le(),v={};let _=!1,b=0;const S=ut("anchor"),k=z(()=>[S.b(),i.type==="underline"?S.m("underline"):"",S.m(i.direction)]),M=j=>{v[j.href]=j.el},R=j=>{delete v[j]},w=j=>{c.value!==j&&(c.value=j,o(wn,j))};let E=null;const N=j=>{if(!p.value)return;const W=ZS(j);if(!W)return;E&&E(),_=!0;const O=x8(W,p.value),Q=iO(W,O),J=O.scrollHeight-O.clientHeight,oe=Math.min(Q-i.offset,J);E=Jve(p.value,b,oe,i.duration,()=>{setTimeout(()=>{_=!1},20)})},F=j=>{j&&(w(j),N(j))},x=(j,W)=>{o("click",j,W),F(W)},P=TUe(()=>{p.value&&(b=U8(p.value));const j=G();_||qn(j)||w(j)}),G=()=>{if(!p.value)return;const j=U8(p.value),W=[];for(const O of Object.keys(v)){const Q=ZS(O);if(!Q)continue;const J=x8(Q,p.value),oe=iO(Q,J);W.push({top:oe-i.offset-i.bound,href:O})}W.sort((O,Q)=>O.top-Q.top);for(let O=0;O<W.length;O++){const Q=W[O],J=W[O+1];if(O===0&&j===0)return i.selectScrollTop?Q.href:"";if(Q.top<=j&&(!J||J.top>j))return Q.href}},H=()=>{const j=ZS(i.container);!j||NT(j)?p.value=window:p.value=j};_o(p,"scroll",P);const Y=z(()=>{if(!u.value||!f.value||!c.value)return{};const j=v[c.value];if(!j)return{};const W=u.value.getBoundingClientRect(),O=f.value.getBoundingClientRect(),Q=j.getBoundingClientRect();return i.direction==="horizontal"?{left:`${Q.left-W.left}px`,width:`${Q.width}px`,opacity:1}:{top:`${Q.top-W.top+(Q.height-O.height)/2}px`,opacity:1}});return mn(()=>{H();const j=decodeURIComponent(window.location.hash);ZS(j)?F(j):P()}),st(()=>i.container,()=>{H()}),Nn(JW,{ns:S,direction:i.direction,currentAnchor:c,addLink:M,removeLink:R,handleClick:x}),t({scrollTo:F}),(j,W)=>(ee(),ge("div",{ref_key:"anchorRef",ref:u,class:ne(y(k))},[j.marker?(ee(),ge("div",{key:0,ref_key:"markerRef",ref:f,class:ne(y(S).e("marker")),style:qt(y(Y))},null,6)):$e("v-if",!0),Ee("div",{class:ne(y(S).e("list"))},[Ve(j.$slots,"default")],2)],2))}});var wUe=vt(kUe,[["__file","anchor.vue"]]);const RUe=pt({title:String,href:String}),AUe=Te({name:"ElAnchorLink"}),DUe=Te({...AUe,props:RUe,setup(e){const t=e,o=le(null),{ns:i,direction:c,currentAnchor:u,addLink:f,removeLink:p,handleClick:v}=Rt(JW),_=z(()=>[i.e("link"),i.is("active",u.value===t.href)]),b=S=>{v(S,t.href)};return st(()=>t.href,(S,k)=>{Vt(()=>{k&&p(k),S&&f({href:S,el:o.value})})}),mn(()=>{const{href:S}=t;S&&f({href:S,el:o.value})}),Co(()=>{const{href:S}=t;S&&p(S)}),(S,k)=>(ee(),ge("div",{class:ne(y(i).e("item"))},[Ee("a",{ref_key:"linkRef",ref:o,class:ne(y(_)),href:S.href,onClick:b},[Ve(S.$slots,"default",{},()=>[Mn(mt(S.title),1)])],10,["href"]),S.$slots["sub-link"]&&y(c)==="vertical"?(ee(),ge("div",{key:0,class:ne(y(i).e("list"))},[Ve(S.$slots,"sub-link")],2)):$e("v-if",!0)],2))}});var XW=vt(DUe,[["__file","anchor-link.vue"]]);const OUe=un(wUe,{AnchorLink:XW}),LUe=lr(XW),ZW={label:"label",value:"value",disabled:"disabled"},NUe=pt({direction:{type:Ue(String),default:"horizontal"},options:{type:Ue(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},props:{type:Ue(Object),default:()=>ZW},block:Boolean,size:Kr,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...Ci(["ariaLabel"])}),PUe={[nn]:e=>Ut(e)||jt(e)||vo(e),[wn]:e=>Ut(e)||jt(e)||vo(e)},xUe=Te({name:"ElSegmented"}),UUe=Te({...xUe,props:NUe,emits:PUe,setup(e,{emit:t}){const o=e,i=ut("segmented"),c=bi(),u=Fr(),f=Pi(),{formItem:p}=Ni(),{inputId:v,isLabeledByFormItem:_}=Ps(o,{formItemContext:p}),b=le(null),S=yve(),k=eo({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),M=O=>{const Q=w(O);t(nn,Q),t(wn,Q)},R=z(()=>({...ZW,...o.props})),w=O=>gn(O)?O[R.value.value]:O,E=O=>gn(O)?O[R.value.label]:O,N=O=>!!(f.value||gn(O)&&O[R.value.disabled]),F=O=>o.modelValue===w(O),x=O=>o.options.find(Q=>w(Q)===O),P=O=>[i.e("item"),i.is("selected",F(O)),i.is("disabled",N(O))],G=()=>{if(!b.value)return;const O=b.value.querySelector(".is-selected"),Q=b.value.querySelector(".is-selected input");if(!O||!Q){k.width=0,k.height=0,k.translateX=0,k.translateY=0,k.focusVisible=!1;return}const J=O.getBoundingClientRect();k.isInit=!0,o.direction==="vertical"?(k.height=J.height,k.translateY=O.offsetTop):(k.width=J.width,k.translateX=O.offsetLeft);try{k.focusVisible=Q.matches(":focus-visible")}catch{}},H=z(()=>[i.b(),i.m(u.value),i.is("block",o.block)]),Y=z(()=>({width:o.direction==="vertical"?"100%":`${k.width}px`,height:o.direction==="vertical"?`${k.height}px`:"100%",transform:o.direction==="vertical"?`translateY(${k.translateY}px)`:`translateX(${k.translateX}px)`,display:k.isInit?"block":"none"})),j=z(()=>[i.e("item-selected"),i.is("disabled",N(x(o.modelValue))),i.is("focus-visible",k.focusVisible)]),W=z(()=>o.name||c.value);return ar(b,G),st(S,G),st(()=>o.modelValue,()=>{var O;G(),o.validateEvent&&((O=p==null?void 0:p.validate)==null||O.call(p,"change").catch(Q=>void 0))},{flush:"post"}),(O,Q)=>O.options.length?(ee(),ge("div",{key:0,id:y(v),ref_key:"segmentedRef",ref:b,class:ne(y(H)),role:"radiogroup","aria-label":y(_)?void 0:O.ariaLabel||"segmented","aria-labelledby":y(_)?y(p).labelId:void 0},[Ee("div",{class:ne([y(i).e("group"),y(i).m(o.direction)])},[Ee("div",{style:qt(y(Y)),class:ne(y(j))},null,6),(ee(!0),ge(Ht,null,Un(O.options,(J,oe)=>(ee(),ge("label",{key:oe,class:ne(P(J))},[Ee("input",{class:ne(y(i).e("item-input")),type:"radio",name:y(W),disabled:N(J),checked:F(J),onChange:pe=>M(J)},null,42,["name","disabled","checked","onChange"]),Ee("div",{class:ne(y(i).e("item-label"))},[Ve(O.$slots,"default",{item:J},()=>[Mn(mt(E(J)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):$e("v-if",!0)}});var FUe=vt(UUe,[["__file","segmented.vue"]]);const VUe=un(FUe),GUe=(e,t)=>{const o=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(o)},BUe=(e,t,o)=>{const{selectionEnd:i}=e;if(i===null)return;const c=e.value,u=Wi(t);let f=-1,p;for(let v=i-1;v>=0;--v){const _=c[v];if(_===o||_===`
`||_==="\r"){f=v;continue}if(u.includes(_)){const b=f===-1?i:f;p={pattern:c.slice(v+1,b),start:v+1,end:b,prefix:_,prefixIndex:v,splitIndex:f,selectionEnd:i};break}}return p},HUe=(e,t={debug:!1,useSelectionEnd:!1})=>{const o=e.selectionStart!==null?e.selectionStart:0,i=e.selectionEnd!==null?e.selectionEnd:0,c=t.useSelectionEnd?i:o,u=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const k=document.querySelector("#input-textarea-caret-position-mirror-div");k!=null&&k.parentNode&&k.parentNode.removeChild(k)}const f=document.createElement("div");f.id="input-textarea-caret-position-mirror-div",document.body.appendChild(f);const p=f.style,v=window.getComputedStyle(e),_=e.nodeName==="INPUT";p.whiteSpace=_?"nowrap":"pre-wrap",_||(p.wordWrap="break-word"),p.position="absolute",t.debug||(p.visibility="hidden"),u.forEach(k=>{if(_&&k==="lineHeight")if(v.boxSizing==="border-box"){const M=Number.parseInt(v.height),R=Number.parseInt(v.paddingTop)+Number.parseInt(v.paddingBottom)+Number.parseInt(v.borderTopWidth)+Number.parseInt(v.borderBottomWidth),w=R+Number.parseInt(v.lineHeight);M>w?p.lineHeight=`${M-R}px`:M===w?p.lineHeight=v.lineHeight:p.lineHeight="0"}else p.lineHeight=v.height;else p[k]=v[k]}),GT()?e.scrollHeight>Number.parseInt(v.height)&&(p.overflowY="scroll"):p.overflow="hidden",f.textContent=e.value.slice(0,Math.max(0,c)),_&&f.textContent&&(f.textContent=f.textContent.replace(/\s/g," "));const b=document.createElement("span");b.textContent=e.value.slice(Math.max(0,c))||".",b.style.position="relative",b.style.left=`${-e.scrollLeft}px`,b.style.top=`${-e.scrollTop}px`,f.appendChild(b);const S={top:b.offsetTop+Number.parseInt(v.borderTopWidth),left:b.offsetLeft+Number.parseInt(v.borderLeftWidth),height:Number.parseInt(v.fontSize)*1.5};return t.debug?b.style.backgroundColor="#aaa":document.body.removeChild(f),S.left>=e.clientWidth&&(S.left=e.clientWidth),S},$Ue=pt({...lN,options:{type:Ue(Array),default:()=>[]},prefix:{type:Ue([String,Array]),default:"@",validator:e=>Ut(e)?e.length===1:e.every(t=>Ut(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:Ue([Boolean,Function]),default:()=>GUe,validator:e=>e===!1?!0:zt(e)},placement:{type:Ue(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:Ue(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Ue(Object),default:()=>({})}}),qUe={[nn]:e=>Ut(e),input:e=>Ut(e),search:(e,t)=>Ut(e)&&Ut(t),select:(e,t)=>Ut(e.value)&&Ut(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},KUe=pt({options:{type:Ue(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),zUe={select:e=>Ut(e.value)},WUe=Te({name:"ElMentionDropdown"}),jUe=Te({...WUe,props:KUe,emits:zUe,setup(e,{expose:t,emit:o}){const i=e,c=ut("mention"),{t:u}=Kn(),f=le(-1),p=le(),v=le(),_=le(),b=(x,P)=>[c.be("dropdown","item"),c.is("hovering",f.value===P),c.is("disabled",x.disabled||i.disabled)],S=x=>{x.disabled||i.disabled||o("select",x)},k=x=>{f.value=x},M=z(()=>i.disabled||i.options.every(x=>x.disabled)),R=z(()=>i.options[f.value]),w=()=>{R.value&&o("select",R.value)},E=x=>{const{options:P}=i;if(P.length===0||M.value)return;x==="next"?(f.value++,f.value===P.length&&(f.value=0)):x==="prev"&&(f.value--,f.value<0&&(f.value=P.length-1));const G=P[f.value];if(G.disabled){E(x);return}Vt(()=>N(G))},N=x=>{var P,G,H,Y;const{options:j}=i,W=j.findIndex(Q=>Q.value===x.value),O=(P=v.value)==null?void 0:P[W];if(O){const Q=(H=(G=_.value)==null?void 0:G.querySelector)==null?void 0:H.call(G,`.${c.be("dropdown","wrap")}`);Q&&nN(Q,O)}(Y=p.value)==null||Y.handleScroll()};return st(()=>i.options,()=>{M.value||i.options.length===0?f.value=-1:f.value=0},{immediate:!0}),t({hoveringIndex:f,navigateOptions:E,selectHoverOption:w,hoverOption:R}),(x,P)=>(ee(),ge("div",{ref_key:"dropdownRef",ref:_,class:ne(y(c).b("dropdown"))},[x.$slots.header?(ee(),ge("div",{key:0,class:ne(y(c).be("dropdown","header"))},[Ve(x.$slots,"header")],2)):$e("v-if",!0),fn(Me(y(ac),{id:x.contentId,ref_key:"scrollbarRef",ref:p,tag:"ul","wrap-class":y(c).be("dropdown","wrap"),"view-class":y(c).be("dropdown","list"),role:"listbox","aria-label":x.ariaLabel,"aria-orientation":"vertical"},{default:Ae(()=>[(ee(!0),ge(Ht,null,Un(x.options,(G,H)=>(ee(),ge("li",{id:`${x.contentId}-${H}`,ref_for:!0,ref_key:"optionRefs",ref:v,key:H,class:ne(b(G,H)),role:"option","aria-disabled":G.disabled||x.disabled||void 0,"aria-selected":f.value===H,onMousemove:Y=>k(H),onClick:Zt(Y=>S(G),["stop"])},[Ve(x.$slots,"label",{item:G,index:H},()=>{var Y;return[Ee("span",null,mt((Y=G.label)!=null?Y:G.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[Zn,x.options.length>0&&!x.loading]]),x.loading?(ee(),ge("div",{key:1,class:ne(y(c).be("dropdown","loading"))},[Ve(x.$slots,"loading",{},()=>[Mn(mt(y(u)("el.mention.loading")),1)])],2)):$e("v-if",!0),x.$slots.footer?(ee(),ge("div",{key:2,class:ne(y(c).be("dropdown","footer"))},[Ve(x.$slots,"footer")],2)):$e("v-if",!0)],2))}});var YUe=vt(jUe,[["__file","mention-dropdown.vue"]]);const JUe=Te({name:"ElMention",inheritAttrs:!1}),XUe=Te({...JUe,props:$Ue,emits:qUe,setup(e,{expose:t,emit:o}){const i=e,c=z(()=>il(i,Object.keys(lN))),u=ut("mention"),f=Pi(),p=bi(),v=le(),_=le(),b=le(),S=le(!1),k=le(),M=le(),R=z(()=>i.showArrow?i.placement:`${i.placement}-start`),w=z(()=>i.showArrow?["bottom","top"]:["bottom-start","top-start"]),E=z(()=>{const{filterOption:J,options:oe}=i;return!M.value||!J?oe:oe.filter(pe=>J(M.value.pattern,pe))}),N=z(()=>S.value&&(!!E.value.length||i.loading)),F=z(()=>{var J;return`${p.value}-${(J=b.value)==null?void 0:J.hoveringIndex}`}),x=J=>{o(nn,J),o(Jr,J),W()},P=J=>{var oe,pe,ie,te;if(!(!("code"in J)||(oe=v.value)!=null&&oe.isComposing))switch(J.code){case At.left:case At.right:W();break;case At.up:case At.down:if(!S.value)return;J.preventDefault(),(pe=b.value)==null||pe.navigateOptions(J.code===At.up?"prev":"next");break;case At.enter:case At.numpadEnter:if(!S.value)return;J.preventDefault(),(ie=b.value)!=null&&ie.hoverOption?(te=b.value)==null||te.selectHoverOption():S.value=!1;break;case At.esc:if(!S.value)return;J.preventDefault(),S.value=!1;break;case At.backspace:if(i.whole&&M.value){const{splitIndex:he,selectionEnd:re,pattern:X,prefixIndex:ye,prefix:ue}=M.value,Ie=j();if(!Ie)return;const ve=Ie.value,Ce=i.options.find(Oe=>Oe.value===X);if((zt(i.checkIsWhole)?i.checkIsWhole(X,ue):Ce)&&he!==-1&&he+1===re){J.preventDefault();const Oe=ve.slice(0,ye)+ve.slice(he+1);o(nn,Oe);const be=ye;Vt(()=>{Ie.selectionStart=be,Ie.selectionEnd=be,Q()})}}}},{wrapperRef:G}=ah(v,{beforeFocus(){return f.value},afterFocus(){W()},beforeBlur(J){var oe;return(oe=_.value)==null?void 0:oe.isFocusInsideContent(J)},afterBlur(){S.value=!1}}),H=()=>{W()},Y=J=>{if(!M.value)return;const oe=j();if(!oe)return;const pe=oe.value,{split:ie}=i,te=pe.slice(M.value.end),he=te.startsWith(ie),re=`${J.value}${he?"":ie}`,X=pe.slice(0,M.value.start)+re+te;o(nn,X),o(Jr,X),o("select",J,M.value.prefix);const ye=M.value.start+re.length+(he?1:0);Vt(()=>{oe.selectionStart=ye,oe.selectionEnd=ye,oe.focus(),Q()})},j=()=>{var J,oe;return i.type==="textarea"?(J=v.value)==null?void 0:J.textarea:(oe=v.value)==null?void 0:oe.input},W=()=>{setTimeout(()=>{O(),Q(),Vt(()=>{var J;return(J=_.value)==null?void 0:J.updatePopper()})},0)},O=()=>{const J=j();if(!J)return;const oe=HUe(J),pe=J.getBoundingClientRect(),ie=v.value.$el.getBoundingClientRect();k.value={position:"absolute",width:0,height:`${oe.height}px`,left:`${oe.left+pe.left-ie.left}px`,top:`${oe.top+pe.top-ie.top}px`}},Q=()=>{const J=j();if(document.activeElement!==J){S.value=!1;return}const{prefix:oe,split:pe}=i;if(M.value=BUe(J,oe,pe),M.value&&M.value.splitIndex===-1){S.value=!0,o("search",M.value.pattern,M.value.prefix);return}S.value=!1};return t({input:v,tooltip:_,dropdownVisible:N}),(J,oe)=>(ee(),ge("div",{ref_key:"wrapperRef",ref:G,class:ne(y(u).b())},[Me(y(Yi),An(An(y(c),J.$attrs),{ref_key:"elInputRef",ref:v,"model-value":J.modelValue,disabled:y(f),role:y(N)?"combobox":void 0,"aria-activedescendant":y(N)?y(F)||"":void 0,"aria-controls":y(N)?y(p):void 0,"aria-expanded":y(N)||void 0,"aria-label":J.ariaLabel,"aria-autocomplete":y(N)?"none":void 0,"aria-haspopup":y(N)?"listbox":void 0,onInput:x,onKeydown:P,onMousedown:H}),rs({_:2},[Un(J.$slots,(pe,ie)=>({name:ie,fn:Ae(te=>[Ve(J.$slots,ie,Za(Zl(te)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),Me(y(Li),{ref_key:"tooltipRef",ref:_,visible:y(N),"popper-class":[y(u).e("popper"),J.popperClass],"popper-options":J.popperOptions,placement:y(R),"fallback-placements":y(w),effect:"light",pure:"",offset:J.offset,"show-arrow":J.showArrow},{default:Ae(()=>[Ee("div",{style:qt(k.value)},null,4)]),content:Ae(()=>{var pe;return[Me(YUe,{ref_key:"dropdownRef",ref:b,options:y(E),disabled:y(f),loading:J.loading,"content-id":y(p),"aria-label":J.ariaLabel,onSelect:Y,onClick:Zt((pe=v.value)==null?void 0:pe.focus,["stop"])},rs({_:2},[Un(J.$slots,(ie,te)=>({name:te,fn:Ae(he=>[Ve(J.$slots,te,Za(Zl(he)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var ZUe=vt(XUe,[["__file","mention.vue"]]);const QUe=un(ZUe);var e3e=[t_e,bye,hbe,PNe,_be,Tbe,GK,Ube,Fbe,di,WK,wCe,LCe,JCe,XCe,XSe,m9,oEe,Ls,dSe,a9,lEe,EEe,TEe,KT,XEe,eTe,hTe,fTe,pTe,mTe,gTe,k1e,U1e,F1e,J1e,Y9,aMe,YMe,JMe,XMe,rz,Jke,Xke,Pt,lwe,sz,Yi,lz,Swe,Rwe,jwe,Ywe,Jwe,Xwe,oRe,jRe,eAe,cAe,PK,vz,f9,ESe,SSe,yAe,EAe,DAe,ac,dp,ZE,wRe,cDe,_De,yDe,FDe,$De,Az,eOe,cOe,uOe,gOe,TLe,MLe,NNe,JNe,XNe,Zg,a2,WTe,s2e,h2e,f2e,Li,CPe,PPe,uT,exe,vxe,Gxe,Jxe,bUe,CUe,OUe,LUe,VUe,QUe];const bs="ElInfiniteScroll",t3e=50,n3e=200,o3e=0,r3e={delay:{type:Number,default:n3e},distance:{type:Number,default:o3e},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},C2=(e,t)=>Object.entries(r3e).reduce((o,[i,c])=>{var u,f;const{type:p,default:v}=c,_=e.getAttribute(`infinite-scroll-${i}`);let b=(f=(u=t[_])!=null?u:_)!=null?f:v;return b=b==="false"?!1:b,b=p(b),o[i]=Number.isNaN(b)?v:b,o},{}),QW=e=>{const{observer:t}=e[bs];t&&(t.disconnect(),delete e[bs].observer)},i3e=(e,t)=>{const{container:o,containerEl:i,instance:c,observer:u,lastScrollTop:f}=e[bs],{disabled:p,distance:v}=C2(e,c),{clientHeight:_,scrollHeight:b,scrollTop:S}=i,k=S-f;if(e[bs].lastScrollTop=S,u||p||k<0)return;let M=!1;if(o===e)M=b-(_+S)<=v;else{const{clientTop:R,scrollHeight:w}=e,E=iO(e,i);M=S+_>=E+R+w-v}M&&t.call(c)};function vD(e,t){const{containerEl:o,instance:i}=e[bs],{disabled:c}=C2(e,i);c||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?t.call(i):QW(e))}const a3e={async mounted(e,t){const{instance:o,value:i}=t;zt(i)||qr(bs,"'v-infinite-scroll' binding value must be a function"),await Vt();const{delay:c,immediate:u}=C2(e,o),f=tN(e,!0),p=f===window?document.documentElement:f,v=rp(i3e.bind(null,e,i),c);if(f){if(e[bs]={instance:o,container:f,containerEl:p,delay:c,cb:i,onScroll:v,lastScrollTop:p.scrollTop},u){const _=new MutationObserver(rp(vD.bind(null,e,i),t3e));e[bs].observer=_,_.observe(e,{childList:!0,subtree:!0}),vD(e,i)}f.addEventListener("scroll",v)}},unmounted(e){if(!e[bs])return;const{container:t,onScroll:o}=e[bs];t==null||t.removeEventListener("scroll",o),QW(e)},async updated(e){if(!e[bs])await Vt();else{const{containerEl:t,cb:o,observer:i}=e[bs];t.clientHeight&&i&&vD(e,o)}}},jO=a3e;jO.install=e=>{e.directive("InfiniteScroll",jO)};const s3e=jO;function l3e(e){let t;const o=le(!1),i=eo({...e,originalPosition:"",originalOverflow:"",visible:!1});function c(k){i.text=k}function u(){const k=i.parent,M=S.ns;if(!k.vLoadingAddClassList){let R=k.getAttribute("loading-number");R=Number.parseInt(R)-1,R?k.setAttribute("loading-number",R.toString()):(Ji(k,M.bm("parent","relative")),k.removeAttribute("loading-number")),Ji(k,M.bm("parent","hidden"))}f(),b.unmount()}function f(){var k,M;(M=(k=S.$el)==null?void 0:k.parentNode)==null||M.removeChild(S.$el)}function p(){var k;e.beforeClose&&!e.beforeClose()||(o.value=!0,clearTimeout(t),t=setTimeout(v,400),i.visible=!1,(k=e.closed)==null||k.call(e))}function v(){if(!o.value)return;const k=i.parent;o.value=!1,k.vLoadingAddClassList=void 0,u()}const b=W$(Te({name:"ElLoading",setup(k,{expose:M}){const{ns:R,zIndex:w}=UT("loading");return M({ns:R,zIndex:w}),()=>{const E=i.spinner||i.svg,N=Jt("svg",{class:"circular",viewBox:i.svgViewBox?i.svgViewBox:"0 0 50 50",...E?{innerHTML:E}:{}},[Jt("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),F=i.text?Jt("p",{class:R.b("text")},[i.text]):void 0;return Jt(Zr,{name:R.b("fade"),onAfterLeave:v},{default:Ae(()=>[fn(Me("div",{style:{backgroundColor:i.background||""},class:[R.b("mask"),i.customClass,i.fullscreen?"is-fullscreen":""]},[Jt("div",{class:R.b("spinner")},[N,F])]),[[Zn,i.visible]])])})}}})),S=b.mount(document.createElement("div"));return{...hi(i),setText:c,removeElLoadingChild:f,close:p,handleAfterLeave:v,vm:S,get $el(){return S.$el}}}let QS;const YO=function(e={}){if(!$n)return;const t=c3e(e);if(t.fullscreen&&QS)return QS;const o=l3e({...t,closed:()=>{var c;(c=t.closed)==null||c.call(t),t.fullscreen&&(QS=void 0)}});u3e(t,t.parent,o),MH(t,t.parent,o),t.parent.vLoadingAddClassList=()=>MH(t,t.parent,o);let i=t.parent.getAttribute("loading-number");return i?i=`${Number.parseInt(i)+1}`:i="1",t.parent.setAttribute("loading-number",i),t.parent.appendChild(o.$el),Vt(()=>o.visible.value=t.visible),t.fullscreen&&(QS=o),o},c3e=e=>{var t,o,i,c;let u;return Ut(e.target)?u=(t=document.querySelector(e.target))!=null?t:document.body:u=e.target||document.body,{parent:u===document.body||e.body?document.body:u,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:u===document.body&&((o=e.fullscreen)!=null?o:!0),lock:(i=e.lock)!=null?i:!1,customClass:e.customClass||"",visible:(c=e.visible)!=null?c:!0,beforeClose:e.beforeClose,closed:e.closed,target:u}},u3e=async(e,t,o)=>{const{nextZIndex:i}=o.vm.zIndex||o.vm._.exposed.zIndex,c={};if(e.fullscreen)o.originalPosition.value=Yc(document.body,"position"),o.originalOverflow.value=Yc(document.body,"overflow"),c.zIndex=i();else if(e.parent===document.body){o.originalPosition.value=Yc(document.body,"position"),await Vt();for(const u of["top","left"]){const f=u==="top"?"scrollTop":"scrollLeft";c[u]=`${e.target.getBoundingClientRect()[u]+document.body[f]+document.documentElement[f]-Number.parseInt(Yc(document.body,`margin-${u}`),10)}px`}for(const u of["height","width"])c[u]=`${e.target.getBoundingClientRect()[u]}px`}else o.originalPosition.value=Yc(t,"position");for(const[u,f]of Object.entries(c))o.$el.style[u]=f},MH=(e,t,o)=>{const i=o.vm.ns||o.vm._.exposed.ns;["absolute","fixed","sticky"].includes(o.originalPosition.value)?Ji(t,i.bm("parent","relative")):Ss(t,i.bm("parent","relative")),e.fullscreen&&e.lock?Ss(t,i.bm("parent","hidden")):Ji(t,i.bm("parent","hidden"))},EE=Symbol("ElLoading"),kH=(e,t)=>{var o,i,c,u;const f=t.instance,p=k=>gn(t.value)?t.value[k]:void 0,v=k=>{const M=Ut(k)&&(f==null?void 0:f[k])||k;return M&&le(M)},_=k=>v(p(k)||e.getAttribute(`element-loading-${th(k)}`)),b=(o=p("fullscreen"))!=null?o:t.modifiers.fullscreen,S={text:_("text"),svg:_("svg"),svgViewBox:_("svgViewBox"),spinner:_("spinner"),background:_("background"),customClass:_("customClass"),fullscreen:b,target:(i=p("target"))!=null?i:b?void 0:e,body:(c=p("body"))!=null?c:t.modifiers.body,lock:(u=p("lock"))!=null?u:t.modifiers.lock};e[EE]={options:S,instance:YO(S)}},d3e=(e,t)=>{for(const o of Object.keys(t))Bo(t[o])&&(t[o].value=e[o])},wH={mounted(e,t){t.value&&kH(e,t)},updated(e,t){const o=e[EE];t.oldValue!==t.value&&(t.value&&!t.oldValue?kH(e,t):t.value&&t.oldValue?gn(t.value)&&d3e(t.value,o.options):o==null||o.instance.close())},unmounted(e){var t;(t=e[EE])==null||t.instance.close(),e[EE]=null}},h3e={install(e){e.directive("loading",wH),e.config.globalProperties.$loading=YO},directive:wH,service:YO},ej=["success","info","warning","error"],ia=sr({customClass:"",dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:$n?document.body:void 0}),f3e=pt({customClass:{type:String,default:ia.customClass},dangerouslyUseHTMLString:{type:Boolean,default:ia.dangerouslyUseHTMLString},duration:{type:Number,default:ia.duration},icon:{type:ho,default:ia.icon},id:{type:String,default:ia.id},message:{type:Ue([String,Object,Function]),default:ia.message},onClose:{type:Ue(Function),default:ia.onClose},showClose:{type:Boolean,default:ia.showClose},type:{type:String,values:ej,default:ia.type},plain:{type:Boolean,default:ia.plain},offset:{type:Number,default:ia.offset},zIndex:{type:Number,default:ia.zIndex},grouping:{type:Boolean,default:ia.grouping},repeatNum:{type:Number,default:ia.repeatNum}}),p3e={destroy:()=>!0},al=sL([]),m3e=e=>{const t=al.findIndex(c=>c.id===e),o=al[t];let i;return t>0&&(i=al[t-1]),{current:o,prev:i}},g3e=e=>{const{prev:t}=m3e(e);return t?t.vm.exposed.bottom.value:0},v3e=(e,t)=>al.findIndex(i=>i.id===e)>0?16:t,_3e=Te({name:"ElMessage"}),y3e=Te({..._3e,props:f3e,emits:p3e,setup(e,{expose:t,emit:o}){const i=e,{Close:c}=sN,u=le(!1),{ns:f,zIndex:p}=UT("message"),{currentZIndex:v,nextZIndex:_}=p,b=le(),S=le(!1),k=le(0);let M;const R=z(()=>i.type?i.type==="error"?"danger":i.type:"info"),w=z(()=>{const W=i.type;return{[f.bm("icon",W)]:W&&Zd[W]}}),E=z(()=>i.icon||Zd[i.type]||""),N=z(()=>g3e(i.id)),F=z(()=>v3e(i.id,i.offset)+N.value),x=z(()=>k.value+F.value),P=z(()=>({top:`${F.value}px`,zIndex:v.value}));function G(){i.duration!==0&&({stop:M}=cp(()=>{Y()},i.duration))}function H(){M==null||M()}function Y(){S.value=!1,Vt(()=>{var W;u.value||((W=i.onClose)==null||W.call(i),o("destroy"))})}function j({code:W}){W===At.esc&&Y()}return mn(()=>{G(),_(),S.value=!0}),st(()=>i.repeatNum,()=>{H(),G()}),_o(document,"keydown",j),ar(b,()=>{k.value=b.value.getBoundingClientRect().height}),t({visible:S,bottom:x,close:Y}),(W,O)=>(ee(),We(Zr,{name:y(f).b("fade"),onBeforeEnter:Q=>u.value=!0,onBeforeLeave:W.onClose,onAfterLeave:Q=>W.$emit("destroy"),persisted:""},{default:Ae(()=>[fn(Ee("div",{id:W.id,ref_key:"messageRef",ref:b,class:ne([y(f).b(),{[y(f).m(W.type)]:W.type},y(f).is("closable",W.showClose),y(f).is("plain",W.plain),W.customClass]),style:qt(y(P)),role:"alert",onMouseenter:H,onMouseleave:G},[W.repeatNum>1?(ee(),We(y(GK),{key:0,value:W.repeatNum,type:y(R),class:ne(y(f).e("badge"))},null,8,["value","type","class"])):$e("v-if",!0),y(E)?(ee(),We(y(Pt),{key:1,class:ne([y(f).e("icon"),y(w)])},{default:Ae(()=>[(ee(),We(Tn(y(E))))]),_:1},8,["class"])):$e("v-if",!0),Ve(W.$slots,"default",{},()=>[W.dangerouslyUseHTMLString?(ee(),ge(Ht,{key:1},[$e(" Caution here, message could've been compromised, never use user's input as message "),Ee("p",{class:ne(y(f).e("content")),innerHTML:W.message},null,10,["innerHTML"])],2112)):(ee(),ge("p",{key:0,class:ne(y(f).e("content"))},mt(W.message),3))]),W.showClose?(ee(),We(y(Pt),{key:2,class:ne(y(f).e("closeBtn")),onClick:Zt(Y,["stop"])},{default:Ae(()=>[Me(y(c))]),_:1},8,["class","onClick"])):$e("v-if",!0)],46,["id"]),[[Zn,S.value]])]),_:3},8,["name","onBeforeEnter","onBeforeLeave","onAfterLeave"]))}});var I3e=vt(y3e,[["__file","message.vue"]]);let b3e=1;const tj=e=>{const t=!e||Ut(e)||Wo(e)||zt(e)?{message:e}:e,o={...ia,...t};if(!o.appendTo)o.appendTo=document.body;else if(Ut(o.appendTo)){let i=document.querySelector(o.appendTo);la(i)||(i=document.body),o.appendTo=i}return vo(nl.grouping)&&!o.grouping&&(o.grouping=nl.grouping),jt(nl.duration)&&o.duration===3e3&&(o.duration=nl.duration),jt(nl.offset)&&o.offset===16&&(o.offset=nl.offset),vo(nl.showClose)&&!o.showClose&&(o.showClose=nl.showClose),o},C3e=e=>{const t=al.indexOf(e);if(t===-1)return;al.splice(t,1);const{handler:o}=e;o.close()},S3e=({appendTo:e,...t},o)=>{const i=`message_${b3e++}`,c=t.onClose,u=document.createElement("div"),f={...t,id:i,onClose:()=>{c==null||c(),C3e(b)},onDestroy:()=>{Kd(null,u)}},p=Me(I3e,f,zt(f.message)||Wo(f.message)?{default:zt(f.message)?f.message:()=>f.message}:null);p.appContext=o||iv._context,Kd(p,u),e.appendChild(u.firstElementChild);const v=p.component,b={id:i,vnode:p,vm:v,handler:{close:()=>{v.exposed.close()}},props:p.component.props};return b},iv=(e={},t)=>{if(!$n)return{close:()=>{}};const o=tj(e);if(o.grouping&&al.length){const c=al.find(({vnode:u})=>{var f;return((f=u.props)==null?void 0:f.message)===o.message});if(c)return c.props.repeatNum+=1,c.props.type=o.type,c.handler}if(jt(nl.max)&&al.length>=nl.max)return{close:()=>{}};const i=S3e(o,t);return al.push(i),i.handler};ej.forEach(e=>{iv[e]=(t={},o)=>{const i=tj(t);return iv({...i,type:e},o)}});function E3e(e){const t=[...al];for(const o of t)(!e||e===o.props.type)&&o.handler.close()}iv.closeAll=E3e;iv._context=null;const nj=oK(iv,"$message"),JO="_trap-focus-children",Qf=[],RH=e=>{if(Qf.length===0)return;const t=Qf[Qf.length-1][JO];if(t.length>0&&e.code===At.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const o=e.shiftKey,i=e.target===t[0],c=e.target===t[t.length-1];i&&o&&(e.preventDefault(),t[t.length-1].focus()),c&&!o&&(e.preventDefault(),t[0].focus())}},T3e={beforeMount(e){e[JO]=H8(e),Qf.push(e),Qf.length<=1&&document.addEventListener("keydown",RH)},updated(e){Vt(()=>{e[JO]=H8(e)})},unmounted(){Qf.shift(),Qf.length===0&&document.removeEventListener("keydown",RH)}},M3e=Te({name:"ElMessageBox",directives:{TrapFocus:T3e},components:{ElButton:di,ElFocusTrap:gv,ElInput:Yi,ElOverlay:UN,ElIcon:Pt,...sN},inheritAttrs:!1,props:{buttonSize:{type:String,validator:Oz},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:o,zIndex:i,ns:c,size:u}=UT("message-box",z(()=>e.buttonSize)),{t:f}=o,{nextZIndex:p}=i,v=le(!1),_=eo({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:tu(ec),cancelButtonLoadingIcon:tu(ec),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:p()}),b=z(()=>{const te=_.type;return{[c.bm("icon",te)]:te&&Zd[te]}}),S=bi(),k=bi(),M=z(()=>{const te=_.type;return _.icon||te&&Zd[te]||""}),R=z(()=>!!_.message),w=le(),E=le(),N=le(),F=le(),x=le(),P=z(()=>_.confirmButtonClass);st(()=>_.inputValue,async te=>{await Vt(),e.boxType==="prompt"&&te&&J()},{immediate:!0}),st(()=>v.value,te=>{var he,re;te&&(e.boxType!=="prompt"&&(_.autofocus?N.value=(re=(he=x.value)==null?void 0:he.$el)!=null?re:w.value:N.value=w.value),_.zIndex=p()),e.boxType==="prompt"&&(te?Vt().then(()=>{var X;F.value&&F.value.$el&&(_.autofocus?N.value=(X=oe())!=null?X:w.value:N.value=w.value)}):(_.editorErrorMessage="",_.validateError=!1))});const G=z(()=>e.draggable),H=z(()=>e.overflow);K9(w,E,G,H),mn(async()=>{await Vt(),e.closeOnHashChange&&window.addEventListener("hashchange",Y)}),Co(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",Y)});function Y(){v.value&&(v.value=!1,Vt(()=>{_.action&&t("action",_.action)}))}const j=()=>{e.closeOnClickModal&&Q(_.distinguishCancelAndClose?"close":"cancel")},W=xN(j),O=te=>{if(_.inputType!=="textarea")return te.preventDefault(),Q("confirm")},Q=te=>{var he;e.boxType==="prompt"&&te==="confirm"&&!J()||(_.action=te,_.beforeClose?(he=_.beforeClose)==null||he.call(_,te,_,Y):Y())},J=()=>{if(e.boxType==="prompt"){const te=_.inputPattern;if(te&&!te.test(_.inputValue||""))return _.editorErrorMessage=_.inputErrorMessage||f("el.messagebox.error"),_.validateError=!0,!1;const he=_.inputValidator;if(zt(he)){const re=he(_.inputValue);if(re===!1)return _.editorErrorMessage=_.inputErrorMessage||f("el.messagebox.error"),_.validateError=!0,!1;if(Ut(re))return _.editorErrorMessage=re,_.validateError=!0,!1}}return _.editorErrorMessage="",_.validateError=!1,!0},oe=()=>{var te,he;const re=(te=F.value)==null?void 0:te.$refs;return(he=re==null?void 0:re.input)!=null?he:re==null?void 0:re.textarea},pe=()=>{Q("close")},ie=()=>{e.closeOnPressEscape&&pe()};return e.lockScroll&&FN(v),{...hi(_),ns:c,overlayEvent:W,visible:v,hasMessage:R,typeClass:b,contentId:S,inputId:k,btnSize:u,iconComponent:M,confirmButtonClasses:P,rootRef:w,focusStartRef:N,headerRef:E,inputRef:F,confirmRef:x,doClose:Y,handleClose:pe,onCloseRequested:ie,handleWrapperClick:j,handleInputEnter:O,handleAction:Q,t:f}}});function k3e(e,t,o,i,c,u){const f=Cn("el-icon"),p=Cn("el-input"),v=Cn("el-button"),_=Cn("el-focus-trap"),b=Cn("el-overlay");return ee(),We(Zr,{name:"fade-in-linear",onAfterLeave:S=>e.$emit("vanish"),persisted:""},{default:Ae(()=>[fn(Me(b,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:Ae(()=>[Ee("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:ne(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[Me(_,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:Ae(()=>[Ee("div",{ref:"rootRef",class:ne([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:qt(e.customStyle),tabindex:"-1",onClick:Zt(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(ee(),ge("div",{key:0,ref:"headerRef",class:ne([e.ns.e("header"),{"show-close":e.showClose}])},[Ee("div",{class:ne(e.ns.e("title"))},[e.iconComponent&&e.center?(ee(),We(f,{key:0,class:ne([e.ns.e("status"),e.typeClass])},{default:Ae(()=>[(ee(),We(Tn(e.iconComponent)))]),_:1},8,["class"])):$e("v-if",!0),Ee("span",null,mt(e.title),1)],2),e.showClose?(ee(),ge("button",{key:0,type:"button",class:ne(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:S=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:To(Zt(S=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Me(f,{class:ne(e.ns.e("close"))},{default:Ae(()=>[(ee(),We(Tn(e.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):$e("v-if",!0)],2)):$e("v-if",!0),Ee("div",{id:e.contentId,class:ne(e.ns.e("content"))},[Ee("div",{class:ne(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(ee(),We(f,{key:0,class:ne([e.ns.e("status"),e.typeClass])},{default:Ae(()=>[(ee(),We(Tn(e.iconComponent)))]),_:1},8,["class"])):$e("v-if",!0),e.hasMessage?(ee(),ge("div",{key:1,class:ne(e.ns.e("message"))},[Ve(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(ee(),We(Tn(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(ee(),We(Tn(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:Ae(()=>[Mn(mt(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):$e("v-if",!0)],2),fn(Ee("div",{class:ne(e.ns.e("input"))},[Me(p,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":S=>e.inputValue=S,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:ne({invalid:e.validateError}),onKeydown:To(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ee("div",{class:ne(e.ns.e("errormsg")),style:qt({visibility:e.editorErrorMessage?"visible":"hidden"})},mt(e.editorErrorMessage),7)],2),[[Zn,e.showInput]])],10,["id"]),Ee("div",{class:ne(e.ns.e("btns"))},[e.showCancelButton?(ee(),We(v,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:ne([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:S=>e.handleAction("cancel"),onKeydown:To(Zt(S=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:Ae(()=>[Mn(mt(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):$e("v-if",!0),fn(Me(v,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:ne([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:S=>e.handleAction("confirm"),onKeydown:To(Zt(S=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:Ae(()=>[Mn(mt(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Zn,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Zn,e.visible]])]),_:3},8,["onAfterLeave"])}var w3e=vt(M3e,[["render",k3e],["__file","index.vue"]]);const W0=new Map,R3e=e=>{let t=document.body;return e.appendTo&&(Ut(e.appendTo)&&(t=document.querySelector(e.appendTo)),la(e.appendTo)&&(t=e.appendTo),la(t)||(t=document.body)),t},A3e=(e,t,o=null)=>{const i=Me(w3e,e,zt(e.message)||Wo(e.message)?{default:zt(e.message)?e.message:()=>e.message}:null);return i.appContext=o,Kd(i,t),R3e(e).appendChild(t.firstElementChild),i.component},D3e=()=>document.createElement("div"),O3e=(e,t)=>{const o=D3e();e.onVanish=()=>{Kd(null,o),W0.delete(c)},e.onAction=u=>{const f=W0.get(c);let p;e.showInput?p={value:c.inputValue,action:u}:p=u,e.callback?e.callback(p,i.proxy):u==="cancel"||u==="close"?e.distinguishCancelAndClose&&u!=="cancel"?f.reject("close"):f.reject("cancel"):f.resolve(p)};const i=A3e(e,o,t),c=i.proxy;for(const u in e)jn(e,u)&&!jn(c.$props,u)&&(u==="closeIcon"&&gn(e[u])?c[u]=tu(e[u]):c[u]=e[u]);return c.visible=!0,c};function bv(e,t=null){if(!$n)return Promise.reject();let o;return Ut(e)||Wo(e)?e={message:e}:o=e.callback,new Promise((i,c)=>{const u=O3e(e,t??bv._context);W0.set(u,{options:e,callback:o,resolve:i,reject:c})})}const L3e=["alert","confirm","prompt"],N3e={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};L3e.forEach(e=>{bv[e]=P3e(e)});function P3e(e){return(t,o,i,c)=>{let u="";return gn(o)?(i=o,u=""):qn(o)?u="":u=o,bv(Object.assign({title:u,message:t,type:"",...N3e[e]},i,{boxType:e}),c)}}bv.close=()=>{W0.forEach((e,t)=>{t.doClose()}),W0.clear()};bv._context=null;const Ed=bv;Ed.install=e=>{Ed._context=e._context,e.config.globalProperties.$msgbox=Ed,e.config.globalProperties.$messageBox=Ed,e.config.globalProperties.$alert=Ed.alert,e.config.globalProperties.$confirm=Ed.confirm,e.config.globalProperties.$prompt=Ed.prompt};const x3e=Ed,oj=["success","info","warning","error"],U3e=pt({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:ho},id:{type:String,default:""},message:{type:Ue([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:Ue(Function),default:()=>{}},onClose:{type:Ue(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...oj,""],default:""},zIndex:Number,closeIcon:{type:ho,default:As}}),F3e={destroy:()=>!0},V3e=Te({name:"ElNotification"}),G3e=Te({...V3e,props:U3e,emits:F3e,setup(e,{expose:t}){const o=e,{ns:i,zIndex:c}=UT("notification"),{nextZIndex:u,currentZIndex:f}=c,p=le(!1);let v;const _=z(()=>{const F=o.type;return F&&Zd[o.type]?i.m(F):""}),b=z(()=>o.type&&Zd[o.type]||o.icon),S=z(()=>o.position.endsWith("right")?"right":"left"),k=z(()=>o.position.startsWith("top")?"top":"bottom"),M=z(()=>{var F;return{[k.value]:`${o.offset}px`,zIndex:(F=o.zIndex)!=null?F:f.value}});function R(){o.duration>0&&({stop:v}=cp(()=>{p.value&&E()},o.duration))}function w(){v==null||v()}function E(){p.value=!1}function N({code:F}){F===At.delete||F===At.backspace?w():F===At.esc?p.value&&E():R()}return mn(()=>{R(),u(),p.value=!0}),_o(document,"keydown",N),t({visible:p,close:E}),(F,x)=>(ee(),We(Zr,{name:y(i).b("fade"),onBeforeLeave:F.onClose,onAfterLeave:P=>F.$emit("destroy"),persisted:""},{default:Ae(()=>[fn(Ee("div",{id:F.id,class:ne([y(i).b(),F.customClass,y(S)]),style:qt(y(M)),role:"alert",onMouseenter:w,onMouseleave:R,onClick:F.onClick},[y(b)?(ee(),We(y(Pt),{key:0,class:ne([y(i).e("icon"),y(_)])},{default:Ae(()=>[(ee(),We(Tn(y(b))))]),_:1},8,["class"])):$e("v-if",!0),Ee("div",{class:ne(y(i).e("group"))},[Ee("h2",{class:ne(y(i).e("title")),textContent:mt(F.title)},null,10,["textContent"]),fn(Ee("div",{class:ne(y(i).e("content")),style:qt(F.title?void 0:{margin:0})},[Ve(F.$slots,"default",{},()=>[F.dangerouslyUseHTMLString?(ee(),ge(Ht,{key:1},[$e(" Caution here, message could've been compromised, never use user's input as message "),Ee("p",{innerHTML:F.message},null,8,["innerHTML"])],2112)):(ee(),ge("p",{key:0},mt(F.message),1))])],6),[[Zn,F.message]]),F.showClose?(ee(),We(y(Pt),{key:0,class:ne(y(i).e("closeBtn")),onClick:Zt(E,["stop"])},{default:Ae(()=>[(ee(),We(Tn(F.closeIcon)))]),_:1},8,["class","onClick"])):$e("v-if",!0)],2)],46,["id","onClick"]),[[Zn,p.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var B3e=vt(G3e,[["__file","notification.vue"]]);const dT={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},XO=16;let H3e=1;const av=function(e={},t){if(!$n)return{close:()=>{}};(Ut(e)||Wo(e))&&(e={message:e});const o=e.position||"top-right";let i=e.offset||0;dT[o].forEach(({vm:b})=>{var S;i+=(((S=b.el)==null?void 0:S.offsetHeight)||0)+XO}),i+=XO;const c=`notification_${H3e++}`,u=e.onClose,f={...e,offset:i,id:c,onClose:()=>{$3e(c,o,u)}};let p=document.body;la(e.appendTo)?p=e.appendTo:Ut(e.appendTo)&&(p=document.querySelector(e.appendTo)),la(p)||(p=document.body);const v=document.createElement("div"),_=Me(B3e,f,zt(f.message)?f.message:Wo(f.message)?()=>f.message:null);return _.appContext=qn(t)?av._context:t,_.props.onDestroy=()=>{Kd(null,v)},Kd(_,v),dT[o].push({vm:_}),p.appendChild(v.firstElementChild),{close:()=>{_.component.exposed.visible.value=!1}}};oj.forEach(e=>{av[e]=(t={},o)=>((Ut(t)||Wo(t))&&(t={message:t}),av({...t,type:e},o))});function $3e(e,t,o){const i=dT[t],c=i.findIndex(({vm:_})=>{var b;return((b=_.component)==null?void 0:b.props.id)===e});if(c===-1)return;const{vm:u}=i[c];if(!u)return;o==null||o(u);const f=u.el.offsetHeight,p=t.split("-")[0];i.splice(c,1);const v=i.length;if(!(v<1))for(let _=c;_<v;_++){const{el:b,component:S}=i[_].vm,k=Number.parseInt(b.style[p],10)-f-XO;S.props.offset=k}}function q3e(){for(const e of Object.values(dT))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}av.closeAll=q3e;av._context=null;const K3e=oK(av,"$notify");var z3e=[s3e,h3e,nj,x3e,K3e,gz],W3e=Kve([...e3e,...z3e]);const j3e={class:"topClass"},Y3e={class:"container"},J3e={class:"messageList text-center"},X3e={key:0,class:"wholeitem"},Z3e={class:"messageitem"},Q3e={key:1,class:"wholeitem"},e4e={class:"messageitem"},t4e={class:"inputbox"},n4e=Te({__name:"Chat",setup(e){const t=i7(),o=String(t.query.userId);let i=String(t.query.roomId),c=le(""),u=eo([]),f=1600085063;console.log(f+"这是sdkAppId");let p="e7de5690dea59142e08f481af44f6573b5f1f551a58f91bd71cb2a9269a649f6",v={SDKAppID:f},_=sg.create(v);_.setLogLevel(0),_.registerPlugin({"tim-upload-plugin":wde}),_.login({userID:o,userSig:W7({sdkAppId:f,userId:o,sdkSecretKey:p}).userSig}).then(function(M){console.log(M.data),M.data.repeatLogin===!0&&console.log(M.data.errorInfo)}).catch(function(M){console.warn("login error:",M)}),_.on(sg.EVENT.SDK_READY,()=>{alert("chat准备好了")}),_.on(sg.EVENT.SDK_NOT_READY,()=>{alert("chat没准备好")}),mn(()=>{});function S(){let M=_.createTextMessage({to:i,conversationType:sg.TYPES.CONV_C2C,payload:{text:c.value,from:o}});_.sendMessage(M).then(function(w){console.log(w),nj.success(`发送成功，消息为："${c.value+1600085063}"`),u.push({from:o,value:c.value}),c.value=""}).catch(function(w){console.warn("sendMessage error:",w)})}function k(M){M.data.forEach(R=>{R.type===sg.TYPES.MSG_TEXT&&u.push({from:R.from,value:R.payload.text})}),console.log(u)}return _.on(sg.EVENT.MESSAGE_RECEIVED,k),(M,R)=>{const w=Cn("el-input"),E=Cn("el-button");return ee(),ge("div",j3e,[Ee("div",Y3e,[Ee("div",J3e,[(ee(!0),ge(Ht,null,Un(y(u),(N,F)=>(ee(),ge("div",{key:F,class:ne({mine:N.from==y(o),theirs:N.from!=y(o)})},[N.from==y(o)?(ee(),ge("div",X3e,[Mn(mt(N.from)+" ",1),Ee("div",Z3e,mt(N.value),1)])):(ee(),ge("div",Q3e,[Mn(mt(N.from)+" ",1),Ee("div",e4e,mt(N.value),1)]))],2))),128))]),Ee("div",t4e,[Me(w,{modelValue:y(c),"onUpdate:modelValue":R[0]||(R[0]=N=>Bo(c)?c.value=N:c=N),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"]),Me(E,{type:"primary",round:"",onClick:S},{default:Ae(()=>[Mn("发送")]),_:1})])])])}}}),o4e=wce({history:ice(),routes:[{path:"/videoChatByTRTC/",component:Tde},{path:"/videoChatByTRTC/VideoChat",component:Ide},{path:"/videoChatByTRTC/Chat",component:n4e}]}),S2=W$(Ace);S2.use(W3e);S2.use(o4e);S2.mount("#app")});export default r4e();
